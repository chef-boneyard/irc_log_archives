[2013-03-01 00:00:14 -0500] freq47: Yeah?
[2013-03-01 00:01:49 -0500] freq47: What do mean by manage?
[2013-03-01 00:03:56 -0500] znDuff: freq47: Ensure that things are installed consistently on all the machines you want them on; configured identically between QA and production; kept up-to-date; etc.
[2013-03-01 00:04:39 -0500] freq47: OK, sorta acted as a backup
[2013-03-01 00:04:42 -0500] znDuff: freq47: "Lots of moving parts" is a much smaller problem when those parts, their configuration, their operation, &c. aren't prone to human error.
[2013-03-01 00:04:49 -0500] znDuff: Huh?
[2013-03-01 00:05:04 -0500] freq47: A configuration backup
[2013-03-01 00:06:06 -0500] znDuff: freq47: Not really, no -- a source, not a sink. In a backup, the machines drive the idea of truth; in an environment where your configuration is driven by code, that code drives the idea of truth, and the machines are brought into sync with it.
[2013-03-01 00:06:10 -0500] freq47: Thanks gotta go
[2013-03-01 00:06:19 -0500] znDuff: ...it's a very big difference in practice.
[2013-03-01 00:12:24 -0500] faustrol1: znDuff: good points. freq47 may have to learn the hard way
[2013-03-01 00:14:26 -0500] threetee: argh, I hate gem dependency problems
[2013-03-01 00:16:00 -0500] threetee: I sorted out gem dependency conflicts between chef and berkshelf yesterday by using berkshelf 1.2.0.rc1
[2013-03-01 00:16:07 -0500] threetee: and now I'm having issues with vagrant
[2013-03-01 00:16:29 -0500] threetee: specifically, vagrant 1.0.6 and chef 11.4.0 conflict
[2013-03-01 00:17:15 -0500] threetee: and if I don't specify a vagrant version, bundler has to go all the way back to vagrant 0.5.4 to resolve gem dependencies
[2013-03-01 00:17:43 -0500] threetee: and vagrant 0.5.4 blows up when I require berkshelf/vagrant in my Vagrantfile
[2013-03-01 00:17:46 -0500] threetee: oy
[2013-03-01 00:18:45 -0500] kindsol: threetee: welcome to the bleeding edge!
[2013-03-01 00:19:42 -0500] threetee: kindsol: tell me about it :|
[2013-03-01 00:21:10 -0500] threetee: looks like there's a pull request for this: https://github.com/mitchellh/vagrant/pull/1376
[2013-03-01 00:21:44 -0500] maek: anyone using the runit cookbook on platform_family = rhel ? Im using runit_service "geminabox" but not getting the sv-geminabox-run templates created in /etc/service
[2013-03-01 00:21:50 -0500] relevante: hey all, i'm trying to set up a new config with chef, and it seems like my attributes/default.rb files aren't getting loaded.  any ideas?
[2013-03-01 00:22:06 -0500] relevante: at the moment i'm mostly using community cookbooks
[2013-03-01 00:22:23 -0500] ranjibd: relevante, what error you are getting ?
[2013-03-01 00:22:27 -0500] freq47: Znduff:Well I am configuring a new server from an old server, so that is going offline, so if I use chef to configure it in the first place, that would match chef right?
[2013-03-01 00:22:52 -0500] relevante: ranjibd: undefined method `[]' for nil:NilClass
[2013-03-01 00:23:12 -0500] relevante: ranjibd: on this line: unless Ohai::Config[:plugin_path].include?(node['ohai']['plugin_path'])
[2013-03-01 00:23:23 -0500] threetee: "Vagrant after 1.0.x is no longer being distributed as a gem, so these gem conflicts just disappear."
[2013-03-01 00:23:27 -0500] threetee: hmm
[2013-03-01 00:24:16 -0500] relevante: ranjibd: ohai/attributes/default.rb has a call to default["ohai"]["plugin_path"] = "/etc/chef/ohai_plugins"
[2013-03-01 00:24:21 -0500] ranjibd: relevante,  you want to check if the nested attribute is present before accessing it, also have you added the ohai cookbook in path? and its coming before the current cookbook in run list?
[2013-03-01 00:24:56 -0500] ranjibd: use node.attribute?('x')  before grabbing node['x']['y']
[2013-03-01 00:26:12 -0500] relevante: ranjibd: that's in a community cookbook that's required by nginx - i'm thinking the problem is in my stuff, not the cookbook  :)
[2013-03-01 00:26:26 -0500] relevante: ranjibd: what exactly do you mean by adding it to path
[2013-03-01 00:26:33 -0500] relevante: ranjibd: i put it in my cookbooks/ dir
[2013-03-01 00:26:40 -0500] Loadx: agh im gunna have to ask for help with this provider i've spent way too much time on it and I'm still not happy with it.
[2013-03-01 00:27:02 -0500] Loadx: im trying to make a wrapper around the standard python-pip provider but to allow for multiple installs of python on the same node
[2013-03-01 00:27:40 -0500] relevante: ranjibd: i think i may need to look into this run_list
[2013-03-01 00:27:54 -0500] ranjibd: relevante, can you share your runlist/recipe
[2013-03-01 00:27:55 -0500] Loadx: https://gist.github.com/mbrennan-afa/f6069c23f7715862b6d8
[2013-03-01 00:28:11 -0500] Loadx: the siwtching python bit with all of the notifiers and stuff is what's draining me
[2013-03-01 00:29:02 -0500] Loadx: It feels way too hacky, but if i want to use the standard python-pip provider i need to temporarily switch out the python node details to whatever version im trying to install a pip pkg for.
[2013-03-01 00:29:56 -0500] relevante: ranjibd: ok, actually i think the problem was that i wasn't loading it in the run list as you said
[2013-03-01 00:30:04 -0500] ranjibd: ok
[2013-03-01 00:30:06 -0500] relevante: ranjibd: i think i need to go rtfm a bit.  thanks!
[2013-03-01 00:30:35 -0500] relevante: ranjibd: i've been using chef with engine yard and though i knew what i needed to know, but looks like there's a deeper layer that they've been hiding from me
[2013-03-01 00:30:37 -0500] relevante: ranjibd: thanks again
[2013-03-01 00:31:52 -0500] Loadx: oh and the syntax on the gist may be arse, its just to demonstrate what I had in mind.
[2013-03-01 00:38:48 -0500] threetee: relevante: I haven't used chef on engine yard, but IIRC they use chef-solo
[2013-03-01 00:39:06 -0500] threetee: so it wouldn't surprise me if community cookbooks that rely on chef-server functionality don't work
[2013-03-01 00:50:58 -0500] mattupstate: so whats the defacto way of getting the encrypted data bag secret on bootstrapped nodes?
[2013-03-01 00:51:37 -0500] julienphalip: Hi there, I had a question about the nginx recipe, specifically about this line: https://github.com/opscode-cookbooks/nginx/blob/master/templates/default/nginx.conf.erb#L67
[2013-03-01 00:51:57 -0500] mattupstate: actually, for that matter, does the knife ec2 plugin support the method mentioned here: http://docs.opscode.com/essentials_data_bags_encrypt.html
[2013-03-01 00:52:16 -0500] mattupstate: julienphalip: what about it?
[2013-03-01 00:52:23 -0500] julienphalip: The folder conf.d/ contains a default.conf file, which takes precedence over everything in sites-enabled/
[2013-03-01 00:53:07 -0500] julienphalip: So doing "node.set['nginx']['default_site_enabled'] = false"  doesn't in fact disable that default site.
[2013-03-01 00:54:22 -0500] julienphalip: The default nginx site gets served because of that line in nginx.conf
[2013-03-01 00:55:02 -0500] julienphalip: If I comment it out and restart nginx, then my site's configuration (which is in sites-enabled/) takes over and works fine.
[2013-03-01 00:55:32 -0500] julienphalip: mattupstate: Not sure I'm making sense :)
[2013-03-01 00:56:45 -0500] mattupstate: you are, but anything in conf.d shouldn't be related to a site
[2013-03-01 00:56:52 -0500] mattupstate: let me try something
[2013-03-01 00:57:27 -0500] threetee: mattupstate: the bootstrap templates that come with chef push out encrypted data bags by default: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb#L34-L39
[2013-03-01 00:57:44 -0500] threetee: push out encrypted data bag secret, that is
[2013-03-01 00:59:06 -0500] mattupstate: oops, i set it to knife[:encrypted_data_bag_secret]
[2013-03-01 01:00:03 -0500] julienphalip: mattupstate: Here's the content of conf.d/default.conf: http://dpaste.org/vjaIJ/
[2013-03-01 01:00:26 -0500] mattupstate: julienphalip: let me try something out
[2013-03-01 01:00:37 -0500] julienphalip: mattupstate: Sure, thanks!
[2013-03-01 01:01:06 -0500] mattupstate: julienphalip: i just ran the default recipe on a fresh vm with default_site_enabled = false and there's nothing in the /etc/nginx/conf.d folder
[2013-03-01 01:02:54 -0500] relevante: do i need to include included cookbooks and dependencies in my run_list?
[2013-03-01 01:04:25 -0500] relevante: in other words, i have a main default cookbook that includes a cookbook.  when i don't include the included cookbook and its dependencies in run_list, the attributes files don't seem to be loading
[2013-03-01 01:04:54 -0500] relevante: which isn't how it's supposed to work as i understand it
[2013-03-01 01:05:21 -0500] mattupstate: relevante: add a `depends` line in your main cookbook's metadata.rb
[2013-03-01 01:07:06 -0500] relevante: mattupstate: a ha!  thanks.  now i'm getting some other errors, but progress!
[2013-03-01 01:07:21 -0500] jtnz: I was just wondering, if I have a gem installed using chef_gem resource, is that available to use in a cookbook library?
[2013-03-01 01:07:35 -0500] julienphalip: mattupstate: Wow that is really weird...
[2013-03-01 01:07:57 -0500] Loadx: jtnz:  yep
[2013-03-01 01:08:07 -0500] julienphalip: mattupstate: What distribution did you try it with? I'm using CentOS. I didn't have this problem previously when I sued Ubuntu...
[2013-03-01 01:08:09 -0500] mattupstate: and besides, the default site config should reside in /etc/nginx/sites-available
[2013-03-01 01:08:18 -0500] mattupstate: ohhh
[2013-03-01 01:08:22 -0500] mattupstate: yeah, i ran it on ubuntu
[2013-03-01 01:08:40 -0500] mattupstate: not sure i can help with centos
[2013-03-01 01:08:51 -0500] julienphalip: There seem to be 2 "default" conf files: /etc/nginx/sites-available/default and /etc/nginx/conf.d/default.conf
[2013-03-01 01:09:49 -0500] jtnz: Loadx, I'm asking because I've installed pony (to send emails) with chef_gem, but I'm still getting "cannot load such file -- pony" during the run and I'm guessing it's in my library where I "require 'pony'"
[2013-03-01 01:10:15 -0500] fujin: you might have to delay the loading of the pony gem to convergence time instead of compile
[2013-03-01 01:10:22 -0500] fujin: to make sure that the chef_gem is processed first
[2013-03-01 01:11:29 -0500] Loadx: exactly.
[2013-03-01 01:11:36 -0500] julienphalip: mattupstate: A quick Googling seems to indicate it's pretty normal for the default configuration to be /etc/nginx/conf.d/default.conf with CentOS... That means the nginx recipe doesn't quite work with that...
[2013-03-01 01:12:02 -0500] jtnz: fujin, I'm using chef_gem with action :nothing, then end.run_action(:install) so that it'll be there as soon as it's hit in compile
[2013-03-01 01:12:06 -0500] Loadx: fujin: are you able to take a peak at this and offer some direction https://gist.github.com/mbrennan-afa/f6069c23f7715862b6d8.. Im no ruby guru otherwise i'm sure a mixin might fix his whole mess.
[2013-03-01 01:12:27 -0500] jtnz: and the log is saying "DEBUG: chef_gem[pony] found installed gem pony version 1.4 matching pony (>= 0)"
[2013-03-01 01:12:46 -0500] jtnz: that's why I thought that it might not be available to the library
[2013-03-01 01:13:27 -0500] jtnz: In a library, how can I delay the loading of the gem to convergence time?
[2013-03-01 01:14:34 -0500] jtnz: fujin, btw, I'm in NZ too ;)
[2013-03-01 01:14:50 -0500] fujin: jtnz: oh, cool; hehe. you don't need to use the :nothing / run_action trick with chef_gem, that is what it is for.
[2013-03-01 01:14:51 -0500] jtnz: represent lol
[2013-03-01 01:15:04 -0500] fujin: Loadx: sec
[2013-03-01 01:15:14 -0500] jtnz: fujin, oh ok, sweet
[2013-03-01 01:15:57 -0500] fujin: jtnz: like i said libraries are evaluated before cookbook recipes are even compiled
[2013-03-01 01:16:13 -0500] fujin: so unless you toss that require in a method that isn't called until convergence time, it is going to screw up like that, even with chef_gem
[2013-03-01 01:16:27 -0500] fujin: 'cause it'll be eval'd before the recipe compiles (and chef_gem even gets a chance to fire)..
[2013-03-01 01:17:25 -0500] jtnz: fujin, weird though, in trying to fix it I used /opt/chef/embedded/bin/gem install pony, and it didn't fix it
[2013-03-01 01:17:36 -0500] jtnz: aka hack
[2013-03-01 01:18:00 -0500] jtnz: /opt/chef/embedded/bin/gem list - shows pony
[2013-03-01 01:18:13 -0500] fujin: gist full debug log then
[2013-03-01 01:18:18 -0500] fujin: and code
[2013-03-01 01:18:37 -0500] fujin: Loadx: so what's up, what are you trying to do here?
[2013-03-01 01:19:08 -0500] Loadx: jtnz: if you checkout the database cookbook it has a chef_gem "pg"
[2013-03-01 01:19:45 -0500] Loadx: fujin: the comment below wasnt descriptive enough.. sorry not being rude genuinely asking.
[2013-03-01 01:20:09 -0500] fujin: Loadx: you say 'how to make this not suck?'
[2013-03-01 01:20:14 -0500] fujin: what are you having trouble with specifically?
[2013-03-01 01:20:27 -0500] Loadx: fujin: oh ok.. yeah i should say what parts sucks
[2013-03-01 01:20:43 -0500] Loadx: fujin: the whole method of how it works feels wrong to me
[2013-03-01 01:20:52 -0500] fujin: I would probably use a handler to audit and record the contents of virtualenv site packages
[2013-03-01 01:21:35 -0500] Loadx: fujin: If you take a gannder at: https://github.com/opscode-cookbooks/python/blob/master/providers/pip.rb#L164
[2013-03-01 01:22:19 -0500] Loadx: fujin: thats basicly how im tapping in my custom python install what would be better though if i can just extend that same pip resource and override the which_pip function
[2013-03-01 01:22:47 -0500] fujin: ah
[2013-03-01 01:22:48 -0500] Loadx: fujin: then no switching at all is required
[2013-03-01 01:22:53 -0500] Loadx: :)
[2013-03-01 01:22:59 -0500] fujin: I see, this is kind of like the gem_bin problem with gem_package
[2013-03-01 01:22:59 -0500] jtnz: fujin, hmmm seems to have corrected itself. Not sure what happened :S
[2013-03-01 01:23:31 -0500] Loadx: fujin: Yeah the node can have multiple pythons
[2013-03-01 01:25:00 -0500] Loadx: fujin: and unless im not seeing it right, the only place where you can specify 'which' python to use is in virtualenvs
[2013-03-01 01:25:12 -0500] Loadx: fujin: But there are also site packages that id rather inherit
[2013-03-01 01:25:44 -0500] Loadx: fujin: Another option of course is to just bundle them into out afa-python deb's
[2013-03-01 01:25:51 -0500] Loadx: our*
[2013-03-01 01:26:17 -0500] Loadx: fujin: but im a little lost on which way to go from here.
[2013-03-01 01:29:10 -0500] fujin: Loadx: it looks like you should be able to use the 'interpreter' property for python_virtualenv to specify which python interpreter, to use, which as I understand it, should setup bin/pip in the subdirectory, so which_pip would fall in line if you used python_pip and specified virtualenv
[2013-03-01 01:29:27 -0500] fujin: Loadx: in situations like this we'd generally bundle a number of pre-built binary packages that are distributed to the site-packages mechanism of a given language
[2013-03-01 01:29:54 -0500] fujin: especially commonly used stuff like database adapters, serialization, etc
[2013-03-01 01:31:08 -0500] Loadx: fujin: yeah, so fixing the deb by either adding more or splitting out each site-package into its own deb is the better method?
[2013-03-01 01:31:53 -0500] Loadx: fujin: then just manage the virtualenvs normally and collect the node information with a handler
[2013-03-01 01:32:02 -0500] Loadx: whcih im reading that manual on now :P
[2013-03-01 01:35:33 -0500] fujin: i would probably collect with a handler (in chef) or a monitoring system handler, like Sensu, which we do for other stuff
[2013-03-01 01:35:38 -0500] fujin: like gather checksums in a tripwire fashion
[2013-03-01 01:37:13 -0500] Loadx: yeah keeping the information with the node is important because we can check what nodes need package updates etc
[2013-03-01 01:37:38 -0500] fujin: i think adamhjk built something like this in the early days with chef, i forget what we did with it
[2013-03-01 01:37:55 -0500] fujin: it could like tell you when nodes were out of date, and bump the node data so that it would update the OOD packages on next converge
[2013-03-01 01:38:32 -0500] Loadx: so as im understanding the handler runs at the very end. so i'd write soemthing like a loop to look for all python versions, inspect pip freeze for each version and push the data to the appropriate attribute on the node do the same for virtualenvs
[2013-03-01 01:38:46 -0500] fujin: sounds good to me
[2013-03-01 01:38:58 -0500] fujin: I wouldn't recommend using the node for storing a lot of data, so be wary
[2013-03-01 01:39:02 -0500] Loadx: yeah its much better than hackd ruby block's
[2013-03-01 01:39:37 -0500] fujin: Loadx: a good way to do it with the handler would be to map through the updated_resources, looking for python_pip and python_virtualenv, then you only process the resources you are caring about
[2013-03-01 01:39:42 -0500] fujin: I did something like this recently for User resoures
[2013-03-01 01:39:45 -0500] fujin: probably directly translate
[2013-03-01 01:40:12 -0500] fujin: Loadx: https://github.com/heavywater/chef-handler-users/blob/master/lib/chef-handler-users.rb#L42
[2013-03-01 01:40:15 -0500] Loadx: fujin: sounds good. Whats your opposition with storing too much data on the node?
[2013-03-01 01:40:15 -0500] fujin: set you on your merry way ^_^
[2013-03-01 01:40:26 -0500] Loadx: fujin: Ta :)
[2013-03-01 01:41:07 -0500] fujin: Loadx: haha, no real opposition, you just have to be aware of the storage
[2013-03-01 01:41:14 -0500] fujin: if you end up with 10,000 packages and lots of metadata, that could add up
[2013-03-01 01:41:22 -0500] Loadx: oh absolutely
[2013-03-01 01:41:24 -0500] fujin: I guess the node data is gzipped JSON, so you probably don't have to worry too much
[2013-03-01 01:41:28 -0500] Loadx: but it shouldnt be too bad
[2013-03-01 01:41:35 -0500] Loadx: it will only be stored against dev nodes
[2013-03-01 01:41:37 -0500] fujin: no, true :)
[2013-03-01 01:41:43 -0500] Loadx: production we jsut package everything up
[2013-03-01 01:42:58 -0500] Loadx: wish there was a nicer way of doing the site package installs
[2013-03-01 01:42:59 -0500] Loadx: damn
[2013-03-01 01:43:37 -0500] Loadx: my idea was doing exactly what you mentioned wiht bumping the versions
[2013-03-01 01:43:57 -0500] Loadx: so making them into other debs just means a little more legwork.
[2013-03-01 01:46:11 -0500] fujin: hopefully not too much
[2013-03-01 01:46:27 -0500] pwelch: has anyone seen an issue where chef hangs when installing a new package? Loadavg jumps ridiculously high (22.0 on a two core machine) and it never finishes
[2013-03-01 01:46:29 -0500] Loadx: fujin: its deffinately better than my hacks though
[2013-03-01 01:46:43 -0500] Loadx: fujin: Ill update the gist as i tweeted it out to jtimberman also
[2013-03-01 01:46:46 -0500] fujin: pwelch: not me, what platform & pkg provider?
[2013-03-01 01:46:57 -0500] fujin: pwelch: got debug logs at the time of failure?
[2013-03-01 01:47:01 -0500] fujin: pwelch: occur regularly? what package?
[2013-03-01 01:47:13 -0500] pwelch: ubuntu 10.04 (apt provider in chef)
[2013-03-01 01:47:30 -0500] fujin: what version of chef
[2013-03-01 01:47:31 -0500] pwelch: any package recently. newrelic sytem monitorn, now nrpe-nagios
[2013-03-01 01:47:34 -0500] pwelch: 10.24.0
[2013-03-01 01:47:39 -0500] fujin: omnibus installed?
[2013-03-01 01:47:47 -0500] pwelch: system rubygem
[2013-03-01 01:47:52 -0500] pwelch: system runs ruby 1.9
[2013-03-01 01:47:55 -0500] fujin: what system ruby interpreter version
[2013-03-01 01:48:03 -0500] X-Jester: hey, is jruby known to be not supported by the chef-client gems due to the yajl extensions?
[2013-03-01 01:48:06 -0500] X-Jester: or is there another option?
[2013-03-01 01:48:27 -0500] fujin: X-Jester: chef-client does a load of shell outs too, I don't think it will work, not without a lot of work
[2013-03-01 01:48:40 -0500] X-Jester: fujin: fair enough, i appreciate the heads up :)
[2013-03-01 01:48:46 -0500] X-Jester: thanks
[2013-03-01 01:48:46 -0500] pwelch: ruby 1.9.3p327 and ruby REE
[2013-03-01 01:48:59 -0500] fujin: pwelch: two rubies? which one has chef installed to it?
[2013-03-01 01:49:14 -0500] fujin: pwelch: can you try install chef 10.24.0 from Omnibus installion to /opt/chef and see if that exhibits the same failure?
[2013-03-01 01:49:24 -0500] pwelch: no, sorry. its happening on machines running that. one machine is ree one is 1.9.3
[2013-03-01 01:49:59 -0500] fujin: should be able to use the same config files and not conflict anything, uninstalltion is as easy as dpkg -p && rm -rf /opt/chef; too.
[2013-03-01 01:50:26 -0500] fujin: pwelch: try this: http://www.opscode.com/chef/install/
[2013-03-01 01:50:39 -0500] Loadx: fujin: https://gist.github.com/mbrennan-afa/f6069c23f7715862b6d8#comment-785911  i think I captured it all
[2013-03-01 01:52:31 -0500] fujin: looks good -- good luck! let me know how it turns out
[2013-03-01 01:52:43 -0500] Loadx: will do :)
[2013-03-01 01:52:52 -0500] Loadx: once again appreciate your guidance
[2013-03-01 01:53:18 -0500] fujin: we use something like this to build a lot of deb pkgs, might be useful.. check out the whole cookbook. https://github.com/hw-cookbooks/pkg-build/blob/master/recipes/ruby.rb
[2013-03-01 01:53:35 -0500] fujin: it's kind of like pkg definitions for lwrps that wrap FPM driven by Chef
[2013-03-01 01:53:40 -0500] Loadx: oh nice
[2013-03-01 01:53:43 -0500] fujin: instead of Omnibus, bunchr or something like that.
[2013-03-01 01:53:45 -0500] Loadx: im using FPM now anyhow
[2013-03-01 01:54:10 -0500] fujin: yeah fpm is the shit
[2013-03-01 01:57:10 -0500] Loadx: fujin: where is your company heavy water located?
[2013-03-01 01:58:30 -0500] Loadx: fujin: either way locality isnt a big deal i should of just outsourced this to you :P
[2013-03-01 01:58:52 -0500] Loadx: fujin: The only reason im doing it is i'm not sure of the budget it'd require and I like learning new things
[2013-03-01 02:00:01 -0500] fujin: Loadx: hq is Portland, OR
[2013-03-01 02:00:03 -0500] fujin: I'm based in NZ
[2013-03-01 02:00:09 -0500] fujin: we have portertech in Vancouver as well.
[2013-03-01 02:00:17 -0500] fujin: Loadx: entire team is remote
[2013-03-01 02:00:26 -0500] Loadx: fujin: yeah cool, im in aus.
[2013-03-01 02:00:50 -0500] fujin: sweet, we have one pretty massive client in aus
[2013-03-01 02:00:54 -0500] fujin: doing a lot of work for them right now
[2013-03-01 02:00:56 -0500] fujin: Ninefold
[2013-03-01 02:01:11 -0500] Loadx: fujin: Yeah we're only small but basicly we want to automate the entire pipeline
[2013-03-01 02:01:17 -0500] fujin: Loadx: hit up support@hw-ops.com if you want to chat
[2013-03-01 02:01:33 -0500] Loadx: fujin: Will do.. I know of ninefold btw
[2013-03-01 02:01:43 -0500] fujin: we have a new website coming up on mar 7th otherwise I'd point you at that for more details :)
[2013-03-01 02:01:51 -0500] Loadx: hilarious that you are doing work for a company who boasts about being cloud leaders
[2013-03-01 02:02:30 -0500] fujin: Ah, don't underestimate them. We are doing some pretty cool stuff with 'em, of which I cannot speak
[2013-03-01 02:02:44 -0500] Loadx: should i mention your name in the support request?
[2013-03-01 02:02:49 -0500] fujin: I am the Cloud Leader
[2013-03-01 02:02:52 -0500] fujin: Loadx: sure!
[2013-03-01 02:03:05 -0500] fujin: Loadx: I'm on the ML anyway. Caleb will see it and set something up (president)
[2013-03-01 02:03:07 -0500] Loadx: What do you go by in the real world, feel fre to privmsg it
[2013-03-01 02:03:33 -0500] fujin: I'm fujin! AJ Christensen
[2013-03-01 02:03:51 -0500] Loadx: cool, ill pen something through now.. maybe we can talk business
[2013-03-01 02:03:52 -0500] fujin: You are probably using cookbooks I wrote. :D
[2013-03-01 02:03:54 -0500] Loadx: :)
[2013-03-01 02:04:00 -0500] Loadx: more than likely
[2013-03-01 02:04:03 -0500] fujin: hehe
[2013-03-01 02:04:04 -0500] Loadx: atm the run_list is small
[2013-03-01 02:24:58 -0500] benjjj: Hi there. It's my very first steps with chef-solo, and I'm trying to use users cookboks downloaded from the community website, but I get error 'Cannot find a resource for users_manage' when running chef-solo. Help would be greatly appreciated
[2013-03-01 02:25:18 -0500] benjjj: My config is still very simplem I could parse any file asked. Thank you guys
[2013-03-01 02:35:11 -0500] cwj: benjjj: sounds like there is a cookbook in your run list which is trying to call the users_manage resource which is provided by the 'users' cookbook (http://ckbk.it/users)
[2013-03-01 02:36:58 -0500] cwj: so that users cookbook needs to be present, and as a rule any cookbooks which want to utilize the resources the users cookbook provides need to list it as a dependency in their metadata (http://docs.opscode.com/config_rb_metadata.html)
[2013-03-01 02:37:50 -0500] benjjj: Hi cwj :) ok, so I should add user[manage] in my run list? I actually only have this:   "run_list":["recipe[main]"]
[2013-03-01 02:38:37 -0500] cwj: does your 'main' cookbook have a metadata.rb?
[2013-03-01 02:39:28 -0500] benjjj: nop, my main only have one file: default.rb> and in this rb file there is only 2 lines : include_recipe 'users::default' ; include_recipe 'users::default' (i creater a data_bag for this user)
[2013-03-01 02:39:44 -0500] benjjj: *created
[2013-03-01 02:40:11 -0500] benjjj: sorry my copy paste bug sometimes, the 2 lines are:
[2013-03-01 02:40:22 -0500] benjjj: include_recipe 'users::default'
[2013-03-01 02:40:22 -0500] cwj: ok, have you downloaded the users cookbook from the first site i linked?
[2013-03-01 02:40:26 -0500] benjjj: users_manage 'deployer'
[2013-03-01 02:40:27 -0500] cwj: or anywhere else for that matter?
[2013-03-01 02:40:55 -0500] benjjj: I downloaded it from here http://community.opscode.com/cookbooks/users, from the big orange download button :)
[2013-03-01 02:41:01 -0500] cwj: ok
[2013-03-01 02:41:25 -0500] cwj: and its being copied over into your vagrant box along with your 'main' cookbook?
[2013-03-01 02:42:19 -0500] benjjj: I don4t use vagrant, I have a ubuntu in virtual box, ant my cookboox is copied into /var/chef/cookbooks
[2013-03-01 02:42:34 -0500] cwj: oh ok
[2013-03-01 02:43:21 -0500] cwj: when using chef solo you can sometimes  get away without specifying cookbook dependencies in metadata.rb
[2013-03-01 02:43:33 -0500] cwj: but i would suggest that you do so anyway to rule that out as the source of the problem
[2013-03-01 02:44:56 -0500] benjjj: Ok, so I create a metadata.rb with the line depends 'users' in my 'main' directory, let me try that
[2013-03-01 02:46:04 -0500] benjjj: and it WORKS! :)))
[2013-03-01 02:46:07 -0500] cwj: yey
[2013-03-01 02:46:28 -0500] benjjj: well I have other errors, but it's from my data bag, I'll check that later. at least it's calling the user cookbook already
[2013-03-01 02:46:34 -0500] benjjj: thanks a lot for your help :))
[2013-03-01 02:46:39 -0500] benjjj: Cheers
[2013-03-01 02:46:40 -0500] cwj: you're welecome
[2013-03-01 02:46:44 -0500] cwj: good luck :)
[2013-03-01 02:46:50 -0500] benjjj: byebye. Thanks
[2013-03-01 03:05:43 -0500] Loadx: fujin: email s sent :)
[2013-03-01 03:06:34 -0500] Loadx: fujin: now to get even more cluster fucked and go work on realtime push for ember-data
[2013-03-01 03:13:11 -0500] pcn: 1ohai chefs
[2013-03-01 03:13:36 -0500] pcn: Has anyone worked on making the python pip provider check local version vs. pypi latest version to see if they're different?
[2013-03-01 03:13:57 -0500] pcn: Have about 20 checks where we download checks in python from pypi, and each chef run is painfully slow
[2013-03-01 03:16:24 -0500] Loadx: pcn: I too have the same gripe but you can get around it
[2013-03-01 03:20:40 -0500] pcn: I was thinking of updating the LWRP to let me specify the virtualenv I'm in, and check what versions are there, and parse the pypi/simple/<package> listing
[2013-03-01 03:20:56 -0500] pcn: If you have a better way, I'm all ears
[2013-03-01 03:21:34 -0500] Loadx: grep it from pip freeze
[2013-03-01 03:21:57 -0500] Loadx: but the way i was going to do it was.. store the versions against the node
[2013-03-01 03:22:00 -0500] Loadx: and check the node itself
[2013-03-01 03:22:34 -0500] pcn: Ah, yeah.
[2013-03-01 03:22:45 -0500] pcn: I'm looking to float versions against a local pypi repo.
[2013-03-01 03:23:30 -0500] Loadx: pcn: float versions?
[2013-03-01 03:28:09 -0500] pcn: Download the latest version that's in the pypi repo
[2013-03-01 03:28:57 -0500] Loadx: pcn: ylocal pypi repo though? is that just a cache?
[2013-03-01 03:31:39 -0500] Loadx: pcn: The outcome you want is sounding like you have a local cache and you want to check if your cache has the latest version before installing from it. If your version is older than you want to update the cache first
[2013-03-01 03:31:44 -0500] Loadx: pcn: is that right?
[2013-03-01 03:32:36 -0500] pcn: I've got a central repo - an apache that hosts our internal packages and mirrors of packages that we care about
[2013-03-01 03:33:26 -0500] pcn: I want to make sure that what's installed on the node is the most recent version that's on our pypi server, so I want it to upgrade.  But I don't want it to download and re-build dependencies (yaml and pycurl take the moast time)
[2013-03-01 03:34:27 -0500] pcn: Though, thinking about it, I'd need to fix pip.  I can't do that in chef because it's the dependencies that are getting updated.
[2013-03-01 03:34:29 -0500] pcn: Darn.
[2013-03-01 03:35:12 -0500] Loadx: yeah looking at the LWRP
[2013-03-01 03:35:19 -0500] Loadx: it just does upgrade
[2013-03-01 03:36:05 -0500] pcn: Yeah
[2013-03-01 03:38:32 -0500] pcn: Though if I just ignore the upgrade unless the package I care about is upgraded, chef can solve my problem
[2013-03-01 03:39:04 -0500] Loadx: true
[2013-03-01 03:56:48 -0500] pcn: Oghhhh... worse
[2013-03-01 03:57:01 -0500] pcn: We're calling with :install, and passing "-U" so we get the upgrade.
[2013-03-01 03:57:05 -0500] pcn: I need to dig into this a bit more
[2013-03-01 03:59:13 -0500] Loadx: yeah check the lwrp it has an :upgrade action
[2013-03-01 04:15:27 -0500] pcn: Yeah.  It's kind of magical, I need to test that out
[2013-03-01 04:19:16 -0500] pcn: OK, this pushes the problem back to pip.
[2013-03-01 04:19:41 -0500] pcn: :upgrade does check the version, so it's got to be a case of wanting to upgrade dependencies.  Gotta see what we can do here.
[2013-03-01 04:38:26 -0500] wamp3ter: hi. I had a question about attributes. if I want to access an attribute set in cookbook a from cookbook b, and cookbook b depends on cookbook a is there a way to do it?
[2013-03-01 04:41:12 -0500] Loadx: pcn: whats the slow part? compilation, download or checking for the update?
[2013-03-01 04:44:59 -0500] Loadx: wamp3ter:  explain?
[2013-03-01 04:46:15 -0500] wamp3ter: loadx: say CB:2 is dependent on CB:1 and CB:1 declares an attribte node[:foo] and I include the default recipe CB:1:defailt in CB:2::default , can I access node[:foo] in CB:2::default
[2013-03-01 04:47:31 -0500] Loadx: as i understand them attributes are more or less global
[2013-03-01 04:48:38 -0500] wamp3ter: ah cool, thanks a ton
[2013-03-01 05:07:43 -0500] michelsonmartine: Hello guys,, first of all sorry for my ignorance, I have some doubts with chef-solo, I'm trying to run in a ec2 server the same recipes that i have working in a vagrant machine, but when i run chef almost all my recipes fails , because chef don't find some node values, ive note that i have to set up some values in json files, but why it works in vagrant with my default attributes (in ruby) and no in ec2? --
[2013-03-01 07:44:44 -0500] wamp3ter: hi. Is it possible to conditionally override an attribute in a recipe, ala if node[:foo] == 'x'    node[:bar] = y end.?
[2013-03-01 07:49:26 -0500] pcn: wamp3ter: have you tried it?
[2013-03-01 07:49:47 -0500] wamp3ter: pcn :) I am dealing with opsworks, trying means about 20 mins of downtime
[2013-03-01 07:50:13 -0500] wamp3ter: I was hoping someone knew off the top of their head if this was acceptable?
[2013-03-01 07:51:22 -0500] pcn: I'm not familiar with chef 9, but that sort of thing is pretty common
[2013-03-01 07:52:25 -0500] pcn: If you want to make it forward-compatible, you'll do if node[:foo] == 'x' node.set[:bar] = y
[2013-03-01 07:52:58 -0500] wamp3ter: ah great. thanks a ton
[2013-03-01 07:53:38 -0500] pcn: Note: you can probably test opsworks recipes by launching a VM and putting chef 9 on it.
[2013-03-01 07:53:46 -0500] pcn: It'll be a bit of a PITA compared to chef 10 probably
[2013-03-01 07:54:08 -0500] pcn: BTW, really 15 minutes to try?
[2013-03-01 07:54:19 -0500] pcn: I was hoping opsworks was faster than cloudformation for simple things
[2013-03-01 07:56:13 -0500] wamp3ter: well as far as I can tell, it boots a new instance twice
[2013-03-01 07:56:27 -0500] wamp3ter: which because its ec2 easily eats up about 12-14 mins
[2013-03-01 07:57:01 -0500] wamp3ter: also it runs chef-solo so I would have to setup the plumbing to checkout and re-run eveything everytime, but a good idea nevertheless
[2013-03-01 07:57:49 -0500] wamp3ter: finally its peritor/scalarium 's version of patched chef 9 which I am not familiar with at all
[2013-03-01 08:01:26 -0500] pcn: Yeah, that nonsense has gotta end.
[2013-03-01 08:15:32 -0500] wamp3ter: well that does not work, just going to use the stack settings for this crap. thanks for the advice re: vm
[2013-03-01 09:58:09 -0500] Rajeev: When I start the  chef-server-webui, it says " chef-server-webui dead but pid file exists"..Can anyone help me here?
[2013-03-01 10:50:47 -0500] PapaSierra: morning. i'm using the opscode cookbook to install php-fpm. the cookbook is very slim and appears to make no provision for setting attributes. i need to make php-fpm run as a different user/group. what's the recommended way to do this?
[2013-03-01 13:20:35 -0500] Ch00k: After I uploaded the cookbook to the chef server, where do I actually find it on the chef server?
[2013-03-01 13:22:28 -0500] zts: Ch00k: how do you mean?
[2013-03-01 13:23:30 -0500] Ch00k: I want to see what has "knife cookbook upload book1" actually do
[2013-03-01 13:28:55 -0500] zts: ah... well, there will be some things in a database (postgresql or couchdb), and some things on disk.  The exact details/locations depend on whether you are using version 10 or version 11, and how you've installed it
[2013-03-01 13:29:00 -0500] zts: not sure of the details though, sorry
[2013-03-01 13:29:09 -0500] zts: (I just use the API)
[2013-03-01 13:32:18 -0500] Ch00k: zts: so, after uploading the cookbook to the server how do I actually make it executed on my node?
[2013-03-01 13:34:03 -0500] zts: Ch00k: you need to update your node's run_list to include the right recipe from your cookbook.  Using knife, that's something like:  knife node run_list add your_nodename "recipe[yourcookbook::default]"
[2013-03-01 13:34:47 -0500] zts: Ch00k: after you do that, the next time chef-client runs on the node called "your_nodename", it will apply the recipe "default" from the cookbook "yourcookbook"
[2013-03-01 13:36:41 -0500] Ch00k: zts: thanks!
[2013-03-01 13:39:06 -0500] zts: np
[2013-03-01 13:51:36 -0500] erthad: hiall
[2013-03-01 13:52:09 -0500] erthad: is there a way to immediate trigger some action on a resource from the code but not as a notification from some other resource?
[2013-03-01 13:55:51 -0500] zts: erthad: when you say "from the code", do you mean "during compilation of the recipe", "inside a ruby_block", or something else?
[2013-03-01 13:57:12 -0500] erthad: zts: I was looking for sending notification the same way the 'notifies' meta-parameter does but without relation to any specific resource
[2013-03-01 14:00:56 -0500] zts: erthad: okay, if you specifically need to do it the way that 'notifies' works, I'm not sure.  If you just need to invoke an action, you could use the answers here: http://lists.opscode.com/sympa/arc/chef-dev/2011-01/msg00003.html
[2013-03-01 14:00:59 -0500] erthad: zts: yes, I mean sending that during compilation of the recipe
[2013-03-01 14:01:36 -0500] erthad: zts: looks like that is the thing, thank you
[2013-03-01 14:01:55 -0500] zts: erthad: or you might be looking for http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2013-03-01 14:02:03 -0500] zts: np
[2013-03-01 14:04:09 -0500] erthad: actually I was looking for the wiki link you pasted and didn't succeed in googling it =)
[2013-03-01 14:07:05 -0500] zts: erthad: hehe yeah, I recall it is hard to find until you know the magic words :)  For me, it's "chef run at compile time"
[2013-03-01 14:09:16 -0500] erthad: zts: ok, I'll keep that in mind =)
[2013-03-01 14:11:03 -0500] michelsonmartine: guys i have a hard time with Chef, ive it working with vagrant with no problems, but when i upload the cookbooks to an EC2 instance the problem arises, first problem it don't get my attributes (rb) in recipers, so chef fails because it don't find some nodes , then when i configure the json files Chef fails again because it don't find definitions in recipes or resources , why  is this happening ?
[2013-03-01 14:37:46 -0500] maruq: hey chefs
[2013-03-01 14:50:40 -0500] nowthatsamatt: can i put an extraction path on tar -xzvf file.tar.gz ?
[2013-03-01 14:51:47 -0500] znDuff: nowthatsamatt: see the -C argument to GNU tar
[2013-03-01 15:11:15 -0500] yann2: hello ! I have defined a function in a library, and I am trying to call that function from another cookbook. Is this possible? My syntax doesnt seem to work.
[2013-03-01 15:14:50 -0500] znDuff: yann2: Do you have an explicit dependency declared?
[2013-03-01 15:15:04 -0500] yann2: yes
[2013-03-01 15:15:59 -0500] yann2: I got a file in the splunkstorm module: libraries/default.rb , where I have declared one function. I have another module, with depends splunkstorm, and I tried: Splunkstorm.monitor_files_event_hook('setup')
[2013-03-01 15:24:25 -0500] DinMamma: Hiya. THis might be a dump question, but is there any way to include a search inside a role? Like override_attribues.some_app.rabbitmq_server = search(node, recipe:rabbitmq).ip ?
[2013-03-01 15:26:19 -0500] knuckolls: dinmamma, that may be permissable in chef 11. certainly not in chef 10.x. I'd suggest modeling the problem with a wrapper cookbook. you'll certainly have acess to search in a cookbook
[2013-03-01 15:26:50 -0500] DinMamma: knuckolls: Okok, cheers.
[2013-03-01 15:32:00 -0500] DrVonNostren: Can someone help me understand where I find or generate the user.pem file that is required in my knife.rb file?
[2013-03-01 15:32:13 -0500] DrVonNostren: I am using open source chef server
[2013-03-01 15:32:47 -0500] brandocorp: You can do it through the chef server's webui, when you add a new client, I believe
[2013-03-01 15:32:57 -0500] DinMamma: DrVonNostren: go to the webui to creat eyour first user.
[2013-03-01 15:33:28 -0500] DrVonNostren: Lol, theres a web interface!
[2013-03-01 15:33:37 -0500] DinMamma: Ofc :)
[2013-03-01 15:33:42 -0500] brandocorp: lol
[2013-03-01 15:35:22 -0500] znDuff: DrVonNostren: ...you can also use knife to bootstrap (with the files initially under /etc/chef-server/*), but the web interface may be easier.
[2013-03-01 15:35:34 -0500] DrVonNostren: im trying to setup knife though...
[2013-03-01 15:35:46 -0500] DrVonNostren: im trying to setup my workstation (seperate machine from server)
[2013-03-01 15:36:29 -0500] DrVonNostren: znDuff: perhaps you knew that tho
[2013-03-01 15:36:53 -0500] DrVonNostren: ummm, well its not letting me in with the "default" password
[2013-03-01 15:37:27 -0500] znDuff: DrVonNostren: Creating the initial admin user requires access to files only present on the server.
[2013-03-01 15:37:42 -0500] znDuff: DrVonNostren: ...not having that requirement would have the obvious unfortunate security consequences.
[2013-03-01 15:38:33 -0500] znDuff: DrVonNostren: ...if you have access to copy files off of the server, of course, there you are.
[2013-03-01 15:38:40 -0500] DrVonNostren: znDuff: I do have access to any .pem files on the server
[2013-03-01 15:38:43 -0500] DrVonNostren: have root on the server
[2013-03-01 15:38:54 -0500] DrVonNostren: i copied over the webui.pem and validator.pem
[2013-03-01 15:38:58 -0500] DrVonNostren: to my workstation
[2013-03-01 15:39:03 -0500] DrVonNostren: but didnt know where to get the user.pem
[2013-03-01 15:39:06 -0500] aruntomar: hi, is anyone using the keystone cookbook https://github.com/opscode-cookbooks/keystone
[2013-03-01 15:39:07 -0500] DrVonNostren: that the knife.rb seems to want
[2013-03-01 15:40:33 -0500] aruntomar: DrVonNostren: http://www.linuxguy.in/how-to-configure-chef-workstation-with-chef-server-11/
[2013-03-01 15:41:12 -0500] DrVonNostren: thanks aruntomar
[2013-03-01 15:48:46 -0500] cheflevelramen: Quick question. How do you upgrade chef on instances that have been provisioned with knife-ec2?
[2013-03-01 15:51:24 -0500] freezey: trying to run chef solo on a node and for some reason i see it consistently failing on things like WARN: Problem parsing line 'spacenavd 0 0.5 4.el6 x86_64 ['spacenavd(x86-64) = 0.5-4.el6', 'spacenavd' from yum-dump.py! Please check your yum configuration.
[2013-03-01 15:52:01 -0500] knuckolls: cheflevelramen: this is likely what you're looking for: http://wiki.opscode.com/display/chef/Upgrading+Chef+0.10.x+to+the+newest+version+of+Chef
[2013-03-01 15:52:33 -0500] knuckolls: you can use knife ssh to run whatever upgrade command in that document is appropriate for you
[2013-03-01 15:53:19 -0500] knuckolls: i'd do it one machine at a time, then watch your /var/log/chef/client.log to make sure that the upgrade didn't cause anything crazy to happen
[2013-03-01 15:53:35 -0500] knuckolls: one upgrade i did broke the idempotency of some upstream cookbooks
[2013-03-01 15:53:40 -0500] knuckolls: things like that.
[2013-03-01 15:53:43 -0500] aruntomar: cheflevelramen: i would say create a new recipe with execute resource which will run "sudo true && curl -L https://www.opscode.com/chef/install.sh | sudo bash"
[2013-03-01 15:53:44 -0500] cheflevelramen: knuckolls: thanks, I was using that page to no avail. But I just realized that I was trying to follow the omnibus upgrade instructions (thought omnibus was default for provisioned instances), but I have /usr/bin/chef-client, so maybe it's really yum or gem
[2013-03-01 15:54:04 -0500] knuckolls: it might be worth your time to start using the chef_full bootstrap template
[2013-03-01 15:54:11 -0500] knuckolls: as it's become the default, as i understand it
[2013-03-01 15:54:19 -0500] aruntomar: cheflevelramen: depends on how u bootstrapped your ec2 instances
[2013-03-01 15:54:29 -0500] cheflevelramen: aruntomar: I'm not in production yet, so doing it manually is okay for now. But that sudo command downloads chef but doesn't properly install it
[2013-03-01 15:54:36 -0500] cheflevelramen: I bootstrapped using knife ec2 create
[2013-03-01 15:55:03 -0500] aruntomar: cheflevelramen: then it's most  likely bootstrapped via omnibus
[2013-03-01 15:55:11 -0500] aruntomar: cheflevelramen: check /opt/chef
[2013-03-01 15:55:15 -0500] aruntomar: on your instance
[2013-03-01 15:55:35 -0500] aruntomar: cheflevelramen: if /opt/chef is there, that means it's omnichef deployment
[2013-03-01 15:55:43 -0500] knuckolls: if it's not omnibus, here are the other bootstrap templates you may have used
[2013-03-01 15:55:43 -0500] cheflevelramen: chef 11.0.6-alpha.0-4-g5f014b8
[2013-03-01 15:55:44 -0500] knuckolls: https://github.com/opscode/chef/tree/master/lib/chef/knife/bootstrap
[2013-03-01 15:55:57 -0500] cheflevelramen: Looks like it's there
[2013-03-01 15:56:58 -0500] tmichael: i'm thinking of implementing some security hardening standards via a separate cookbook.  Have question regarding convergence that i can't answer from Anatomy of Chef Run doc...
[2013-03-01 15:57:29 -0500] tmichael: if have something like selinux::permissive in this cook....
[2013-03-01 15:57:32 -0500] aruntomar: cheflevelramen: and if you want to upgrade manually using omnibus, just download the deb or rpm packages etc... whatever suits your platform  from http://www.opscode.com/chef/install/ and install it
[2013-03-01 15:57:40 -0500] tmichael: and someone else has selinux::disabled in their cook
[2013-03-01 15:57:45 -0500] tmichael: which takes precedence?
[2013-03-01 15:58:08 -0500] tmichael: is there an override concept with recipes so one always takes precedence regarding of order
[2013-03-01 15:58:21 -0500] tmichael: just using selinux as example.  question is general
[2013-03-01 15:59:00 -0500] aruntomar: tmichael: http://www.opscode.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/
[2013-03-01 15:59:01 -0500] freezey: here is the exact error http://pastebin.ca/2327043
[2013-03-01 15:59:10 -0500] cheflevelramen: aruntomar: Cool, thanks. Looks like it was provisioned with omnibus installer (though I can see chef is installed in yum too for some reason), but when I install using the curl command, it looks like it works, but then knife --version says knife command not found
[2013-03-01 15:59:22 -0500] awgross: cheflevelramen: if you are using omnibus you can use the chef_gem provider to upgrade it, it will find its own embedded install and upgrade itself
[2013-03-01 16:00:29 -0500] cheflevelramen: awgross: Hmm, okay I'll try that, since manually upgrading follow the omnibus instructions seem to bork it
[2013-03-01 16:01:30 -0500] awgross: cheflevelramen: current we use omnibus to install on ec2 via our bootstrap script, then standardize our version with a chef_gem provider
[2013-03-01 16:05:14 -0500] freezey: found the issue nvmd
[2013-03-01 16:05:56 -0500] tmichael: aruntomar: appreciate the link.  helps me to understand attributes, but what about conflicting cookbooks?  sorry if it's in here and i'm missing it.  perhaps i'm just particularly ignorant this AM.
[2013-03-01 16:06:12 -0500] tmichael: sorry - not cookbooks; conflicting recipes within the same cookbook
[2013-03-01 16:06:16 -0500] cheflevelramen: awgross: I see, then using chef_gem provider sounds like it will work
[2013-03-01 16:07:31 -0500] tmichael: e.g. in the run_list of a node i have selinux::permissive and selinux::disabled.  which one wins? assume that latest.  if so, wondering if there's a way to override that such that one always take precedence, regardless of order.
[2013-03-01 16:08:17 -0500] tmichael: need this to try to enforce certain security standards regardless of other recipes folks add to a node.
[2013-03-01 16:08:27 -0500] tmichael: nasty compliance sheeot
[2013-03-01 16:09:12 -0500] aruntomar: tmichael: haven't tried that, but logically. suppose both the attribs have default precedence, then the one that run's last will be effective. if you want to override, then override the attribute and that will always take the precedence.
[2013-03-01 16:10:13 -0500] tmichael: cept not an attribute
[2013-03-01 16:10:25 -0500] tmichael: behavior set via recipe
[2013-03-01 16:10:45 -0500] zts: same thing, what if you have two recipes both setting the same override?  I believe the last will win
[2013-03-01 16:12:14 -0500] zts: so you could try to make sure that the recipe you want runs last, but then the way to subvert that is to disable selinux in your earlier recipe, and then abort the run
[2013-03-01 16:12:17 -0500] tmichael: so no way, given run_list that has selinux::permissive and selinux::disabled, to drive the one that always wins, regardless of order?
[2013-03-01 16:12:52 -0500] zts: not that I'm aware of.  Where would that control exist?  How would you prevent anyone else from touching it?
[2013-03-01 16:13:35 -0500] zts: whatever you do, you'll need to audit what's happened.  You could use report/exception handlers to check the final state, and scream if it's not
[2013-03-01 16:13:41 -0500] tmichael: yeah true, cuz anyone who has perm to control run_list also has perm to remove shit and do what you're saying
[2013-03-01 16:13:47 -0500] tmichael: trust but verify
[2013-03-01 16:13:54 -0500] tmichael: yup!
[2013-03-01 16:13:58 -0500] zts: yeah
[2013-03-01 16:14:34 -0500] tmichael: thx zts.  just wanna make sure i understand.  can then protect via detection process
[2013-03-01 16:14:47 -0500] tmichael: all makes sense now
[2013-03-01 16:14:58 -0500] zts: tmichael: questions are always welcome :)  It'd be great to share what you learn, at some point in the future too
[2013-03-01 16:15:52 -0500] tmichael: absolutely!
[2013-03-01 16:27:01 -0500] faustroll: I have a general question, a request for thoughts
[2013-03-01 16:27:40 -0500] faustroll: what are anyone's thoughts on bash vs. execute?
[2013-03-01 16:28:08 -0500] faustroll: bash looks ideal for a logical grouping of commands that fit together
[2013-03-01 16:28:19 -0500] faustroll: execute for single commands
[2013-03-01 16:28:34 -0500] j^2: yep that's how i see it
[2013-03-01 16:28:37 -0500] faustroll: other use cases?
[2013-03-01 16:28:42 -0500] faustroll: concerns?
[2013-03-01 16:29:06 -0500] blitzrage: I like just running a separate script if things are complicated enough to justify using the bash resource ;)
[2013-03-01 16:29:07 -0500] faustroll: execute looks cleaner
[2013-03-01 16:29:28 -0500] blitzrage: I usually ask myself if I think I should use bash, and if the answer is yes, I write a script and then use execute
[2013-03-01 16:30:56 -0500] faustroll: blitzrage: I've seen a make, make test, make install in a bash
[2013-03-01 16:31:02 -0500] faustroll: thoughts on that?
[2013-03-01 16:31:19 -0500] blitzrage: faustroll: I build RPMs when I get that far :)
[2013-03-01 16:31:39 -0500] faustroll: blitzrage: lol. I like your ethic
[2013-03-01 16:32:33 -0500] faustroll: blitzrage: I'll have to think about the cultural ecosystem I'm working in here as well
[2013-03-01 16:33:28 -0500] blitzrage: faustroll: basically I don't like to force people into working in the chef-repo if they don't need to, so I like to separate things out into scripts and separate repos where it makes sense
[2013-03-01 16:33:32 -0500] blitzrage: and just let chef consume those resources
[2013-03-01 16:33:44 -0500] faustroll: blitzrage: The advantage of putting a logical grouping of commands in a bash method over a script
[2013-03-01 16:33:48 -0500] blitzrage: even configuration files and templates I'll leave in external repos so people can just work where they work
[2013-03-01 16:34:17 -0500] faustroll: blitzrage: I like that thinking
[2013-03-01 16:34:53 -0500] blitzrage: at my last employer I kind of forced people to work in the chef-repo for template and things and it didn't work well because they got frustrated having to learn any new syntax
[2013-03-01 16:35:03 -0500] blitzrage: and working in a repo they didn't understand
[2013-03-01 16:35:06 -0500] faustroll: blitzrage: also keeps the fiddlers away from chef-repo
[2013-03-01 16:35:25 -0500] blitzrage: exactly
[2013-03-01 16:35:35 -0500] blitzrage: don't need to give everyone access to chef-repo just to do their web dev or whatever
[2013-03-01 16:35:50 -0500] faustroll: blitzrage: Yes. I like to isolate the fiddlers and fiddling as well
[2013-03-01 16:36:05 -0500] blitzrage: using gerrit and git helps control some of that still though :)
[2013-03-01 16:40:33 -0500] faustroll: blitzrage: I'm writing a cookbook right now which currently has no use cases where it will be fiddled with by the folks
[2013-03-01 16:42:25 -0500] faustroll: blitzrage: I will keep your advice under advisement for those aspects that may be adjusted
[2013-03-01 16:43:09 -0500] faustroll: blitzrage: so when is one of few times you might use bash in chef recipe?
[2013-03-01 16:43:26 -0500] blitzrage: faustroll: I have never used it :)
[2013-03-01 16:43:36 -0500] blitzrage: I'm sure there are valid reasons to use it
[2013-03-01 16:43:42 -0500] blitzrage: I haven't found one yet though heh
[2013-03-01 16:44:22 -0500] faustroll: blitzrage: my problem here is I'd be introducing bash scripting as well as custom cookbooks to this group
[2013-03-01 16:45:00 -0500] faustroll: blitzrage: or maybe they have some bash scripts, but not policy or thought behind them
[2013-03-01 16:45:44 -0500] blitzrage: faustroll: right, I guess that's why I like the scripts to live outside of chef and let them just work on them, and then use the deploy resource to get the script where it needs to go
[2013-03-01 16:45:55 -0500] blitzrage: guess it depends if the script needs to be "run" by chef or not
[2013-03-01 16:46:11 -0500] blitzrage: but then I like using execute so I can use not_if and only_if sanely
[2013-03-01 16:46:26 -0500] faustroll: blitzrage: Chef is helping them rationalize their integration management
[2013-03-01 16:47:21 -0500] faustroll: they have no such policies or thinking that would tell them to put a bash script outside the repo, etc.
[2013-03-01 16:47:24 -0500] faustroll: not yet
[2013-03-01 16:48:05 -0500] blitzrage: faustroll: right, I guess I just don't like non-chef people writing stuff in chef cookbooks :)
[2013-03-01 16:48:20 -0500] blitzrage: depends on your devs and your environment though
[2013-03-01 16:48:26 -0500] faustroll: blitzrage: exactly. I hear you.
[2013-03-01 16:48:58 -0500] blitzrage: most devs don't want to to deal with that stuff I've found. I usually then just have separate branches in git or svn that match the dev, qa, prod etc environments
[2013-03-01 16:49:08 -0500] blitzrage: in git we follow the branching model outlined by nvie.com
[2013-03-01 16:50:34 -0500] faustroll: blitzrage: right. Chef is their first pass at rationalizing integration management
[2013-03-01 16:50:50 -0500] faustroll: they could have done it with other tools and long ago
[2013-03-01 16:51:11 -0500] Guest59498: hey guys, I'm getting "ERROR: Yajl::ParseError: lexical error: invalid char in json text..." when running "knife download cookbooks". Any ideas where I should be looking for solution?
[2013-03-01 16:51:14 -0500] faustroll: but Chef is what is making that thinking explicit and necessary now
[2013-03-01 16:51:43 -0500] blitzrage: faustroll: well chef is great for continuous integration and integration management, so great choice there :)
[2013-03-01 16:53:41 -0500] faustroll: blitzrage: they have already made the investment in Chef
[2013-03-01 16:53:50 -0500] faustroll: and they made a mess of that as well
[2013-03-01 16:54:35 -0500] faustroll: I'm cleaning it up; I'm rationalizing it, and writing their first complicated cookbooks
[2013-03-01 16:55:04 -0500] blitzrage: faustroll: well good luck to you :)
[2013-03-01 16:55:51 -0500] faustroll: blitzrage: lol. no luck involved. I'm introducing as much determinism as I can. to hell with luck!
[2013-03-01 16:56:31 -0500] blitzrage: :D
[2013-03-01 16:56:31 -0500] faustroll: blitzrage: that was their hold way. type deploy....and pray
[2013-03-01 16:56:37 -0500] faustroll: old
[2013-03-01 16:56:46 -0500] blitzrage: ya, we use vagrant and test/qa environments
[2013-03-01 16:56:56 -0500] blitzrage: everything is tested before it goes to prod
[2013-03-01 16:57:18 -0500] blitzrage: faustroll: the other issue I find a lot is using chef without really using chef.... just using it to basically run the old scripts
[2013-03-01 16:57:37 -0500] blitzrage: which a lot of people make the mistake doing.... just writing all the bash scripts in bash blocks in a chef recipe... which doesn't really get you anywhere
[2013-03-01 16:58:52 -0500] faustroll: blitzrage: lol. old bash scripts moved to bash blocks.
[2013-03-01 17:00:59 -0500] faustroll: blitzrage: even if they just use chef to make the workflow of their old bash scripts explicit, then that is a little something gained
[2013-03-01 17:01:31 -0500] faustroll: what floors me is when they have no idea how anything works together
[2013-03-01 17:01:40 -0500] blitzrage: :)
[2013-03-01 17:02:18 -0500] faustroll: blitzrage: with a nick like that, I gather u understand.
[2013-03-01 17:02:25 -0500] faustroll: they fired the dbas
[2013-03-01 17:02:31 -0500] faustroll: they lost the sysadmins
[2013-03-01 17:02:36 -0500] blitzrage: faustroll: :D I can be kind of ragey
[2013-03-01 17:02:54 -0500] faustroll: now the developers are in over their heads
[2013-03-01 17:03:08 -0500] blitzrage: happens a lot :)
[2013-03-01 17:03:26 -0500] faustroll: blitzrage: good on you. I need a ragey sysadmin around here
[2013-03-01 17:04:14 -0500] faustroll: blitzrage: I'm annoyed by cargo cult integration management
[2013-03-01 17:04:53 -0500] faustroll: the idea seems to be. If I keep typing deploy, maybe it will eventually work!
[2013-03-01 17:05:52 -0500] blitzrage: it might!
[2013-03-01 17:06:06 -0500] blitzrage: welp, lunch!
[2013-03-01 17:06:35 -0500] faustroll: I'll turn into blitzrage and go berzerk if I'm around to see that
[2013-03-01 17:06:44 -0500] blitzrage: faustroll: w00t
[2013-03-01 17:06:48 -0500] blitzrage: sometimes people need to be raged on
[2013-03-01 17:07:10 -0500] blitzrage: I'm usually very calm, but sometimes the rage blitz needs to be executed
[2013-03-01 17:09:37 -0500] faustroll: blitzrage: man, you are hired
[2013-03-01 17:09:48 -0500] blitzrage: faustroll: sure, I am not cheap though :D
[2013-03-01 17:09:52 -0500] faustroll: I'll double your salary
[2013-03-01 17:10:01 -0500] blitzrage: are you sure you want to say that ? :)
[2013-03-01 17:10:50 -0500] faustroll: blitzrage: I need someone to scare these guys before they get into production
[2013-03-01 17:10:57 -0500] faustroll: not after
[2013-03-01 17:14:43 -0500] kryptek: Hey guys, I uploaded a role and decided to move a recipe's position in the run list to the bottom to resolve an issue but each time I run chef-client it seems like the order of the run list hasn't changed -- like it's cached
[2013-03-01 17:14:49 -0500] kryptek: Has anyone ever had this issue?
[2013-03-01 17:15:18 -0500] kryptek: I can see the change through the opscode GUI but whenever I run chef-client it pulls the run list in that cached order
[2013-03-01 17:15:49 -0500] rays: getting "ValidationFailed: Option type must be equal to one of: string, array, hash, symbol!  You passed "boolean"." but it doesn't say were the option is coming from
[2013-03-01 17:16:04 -0500] rays: I feel like I've commented out everything and still getting the error
[2013-03-01 17:16:44 -0500] kryptek: Which cookbook is the last to process before the crash ?
[2013-03-01 17:21:40 -0500] rays: kryptek: i've commented them all out and enabled one by one and get the same error with each
[2013-03-01 17:23:21 -0500] rays: kryptek: here is the stacktrace http://pastebin.com/purjNVqS
[2013-03-01 17:24:02 -0500] rays: looks like its before it loads a cookbook
[2013-03-01 17:37:37 -0500] smdahlen: is it correct that the default attributes of a cookbook are *not* loaded if I am simply including a recipe from it (vs adding it to the run_list)?
[2013-03-01 17:41:23 -0500] zts: smdahlen: no, that is not correct.  If you are able to include_recipe something from a cookbook, _all_ of its attributes will have been loaded
[2013-03-01 17:42:14 -0500] zts: smdahlen: ie, any cookbook that is found in the expanded run list, or that those cookbooks list as dependencies in their metadata.rb
[2013-03-01 17:42:34 -0500] smdahlen: zts: hmm. interesting. I just tried including the default openssh recipe within my base cookbook and it failed to find the openssh package.
[2013-03-01 17:43:12 -0500] smdahlen: zts: perhaps that is it.. I don't believe I established a dependency to the openssh cookbook in my cookbook. i'll give that whirl. thanks.
[2013-03-01 17:51:56 -0500] smdahlen: zts: the cookbook dependecy declaration fixed it. thx.
[2013-03-01 18:07:20 -0500] zts: smdahlen: no problem
[2013-03-01 18:11:00 -0500] rb1980: good morning chefs!
[2013-03-01 18:12:14 -0500] qhartman: I know there's a way to control the chef-client's initial config during bootstrap, for example changing the log settings, but I'm not seeing how to do that in the docs. Any pointers?
[2013-03-01 18:13:44 -0500] rb1980: looking for some suggestions on this: I have a recipe I want to have run on *almost* all of my 1000+ machines, so easiest way would be to add to base role. However, there are a FEW exceptions, but these machines still need base role. What would be the best way to add an exeption into the recipe for those hosts?
[2013-03-01 18:14:37 -0500] rb1980: is there a way to "killswitch" a recipe? to have it meet a condition and bail out, not processing the rest of the recipe? (and do so cleanly without throwing an error)
[2013-03-01 18:15:08 -0500] rb1980: or is there a better approach?
[2013-03-01 18:15:18 -0500] ranjibd: rb1980,  jtimberman has a stack overflow thread on this
[2013-03-01 18:15:33 -0500] rb1980: oh, cool. I'll search for that.
[2013-03-01 18:15:45 -0500] rb1980: (heh prolly shoulda done that first)
[2013-03-01 18:15:52 -0500] ranjibd: rb1980, http://stackoverflow.com/questions/14290397/how-do-you-abort-end-a-chef-run/14290398#14290398
[2013-03-01 18:18:03 -0500] rb1980: hmm, ok it looks like "raise" ends the whole chef run. Not really what I want: I just want to "bypass" a particular recipe. I guess I can just put a big if statement around the whole recipe, but that seems kinda clunky.
[2013-03-01 18:18:24 -0500] qhartman: rb1980, don't call the recipe directly
[2013-03-01 18:18:38 -0500] qhartman: call it from some other recipe, a baseline recipe call it, and have the logic i nthere
[2013-03-01 18:18:41 -0500] Doc_X: when running chef-client 10.24.0, is there a way to set the log level such that it prints INFO statements but doesn't print WARN statements?
[2013-03-01 18:19:05 -0500] Doc_X: i'm finding chef-client runs are quite a bit noisier now with the "YOU NEED TO CHANGE THIS FOR THE UPCOMING RELEASE" warning messages.
[2013-03-01 18:19:22 -0500] rb1980: hmm, ok i'll think on that. Thanks!
[2013-03-01 18:19:38 -0500] qhartman: Doc_X, there's currently no way to suppress those, other than fix the things it's complaining about
[2013-03-01 18:19:44 -0500] ranjibd: Doc_X, logging levels  are hierarchical , not sure you cant do that.
[2013-03-01 18:20:41 -0500] Doc_X: le sigh.  as much as i'd hoped differently, that's pretty much what i feared.
[2013-03-01 18:21:02 -0500] Doc_X: thanks for the info.
[2013-03-01 18:21:49 -0500] rb1980: on a related note: this is something i've been wondering for a while and may as well as since I have your ear: Is there a way to "programattically" control the position of a recipe in the run_list BEFORE the converge operation?
[2013-03-01 18:22:06 -0500] rb1980: like: "I am recipe1 and I must always run first!"
[2013-03-01 18:23:37 -0500] qhartman: rb1980, not that I'm aware of. Short of having it first in the run-list
[2013-03-01 18:24:09 -0500] rb1980: oh, and just re-read the stack post: I missed the "return" the first time... looks like that will work for me.
[2013-03-01 18:25:10 -0500] rb1980: ok, cool. Thanks and have a great day!
[2013-03-01 18:25:19 -0500] qhartman: likewise
[2013-03-01 18:27:35 -0500] ggolin: ohai all
[2013-03-01 18:28:00 -0500] ggolin: question, why does node.chef_environment.to_sym work in shef but not in a recipe?
[2013-03-01 18:28:36 -0500] ranjibd: ggolin, should work in recipe as well
[2013-03-01 18:28:43 -0500] ranjibd: what error you are getting?
[2013-03-01 18:29:13 -0500] ggolin: sec, doublechecking that im not doing something stupid
[2013-03-01 18:29:19 -0500] ggolin: (i usually do something stupid)
[2013-03-01 18:30:16 -0500] ranjibd: we all do :-)
[2013-03-01 18:30:43 -0500] ggolin: sorry, was me doing something totally stupid.
[2013-03-01 18:32:48 -0500] qhartman: I'd like to change the default chef-client config so that the chef-client output is logged to a file, even on the first chef-client run. I think I need to make a change the knife.rb on the machine I'm bootstrapping from, but I've no idea what change to make
[2013-03-01 18:33:00 -0500] qhartman: I'm not seeing anything about this in the docs. Anyone have any ideas?
[2013-03-01 18:34:00 -0500] Doc_X: ok, another question... when running 'chef-client' on the command line i get lots of output.  when i run 'chef-client | grep -v WARN' i get almost no output... that seems non-obvious behavior.
[2013-03-01 18:34:47 -0500] david415: miah: hi
[2013-03-01 18:34:50 -0500] Doc_X: is there a way to get chef-client to work in the obvious fashion when used with grep?
[2013-03-01 18:35:06 -0500] qhartman: Doc_X, IIRC, It's because most of the log output is actually going to STDERR, not STDOUT, and grep is only checking STDOUT.
[2013-03-01 18:35:26 -0500] qhartman: so, issue the command with stderr redirected to stdout, then grep
[2013-03-01 18:37:22 -0500] Doc_X: 'sudo chef-client 2>&1 | grep -v WARN' has the same quiet output.
[2013-03-01 18:38:06 -0500] qhartman: Doc_X, the sudo is probably getting in the way. | acts wierd with sudo
[2013-03-01 18:38:17 -0500] qhartman: go to an actual root shell and try again
[2013-03-01 18:38:20 -0500] drgage: how can i print the date in a template?
[2013-03-01 18:38:25 -0500] qhartman: there is another way to work around that, but I don't recall
[2013-03-01 18:38:34 -0500] qhartman: Doc_X, oh! use tee
[2013-03-01 18:38:45 -0500] qhartman: that gets around the sudo problem
[2013-03-01 18:40:14 -0500] Doc_X: running as root exhibits the same behavior
[2013-03-01 18:40:31 -0500] qhartman: huh, weeeeeel, I'm out of ideas then
[2013-03-01 18:42:10 -0500] ranjibd: drgage, <%=Time.now%>
[2013-03-01 18:44:01 -0500] drgage: thanks ranjibd
[2013-03-01 18:45:15 -0500] jubilo: so I'm installing Chef 11.0.6 "out of the box", following instructions here to set up the management workstation: http://docs.opscode.com/chef/install_workstation.html
[2013-03-01 18:45:24 -0500] miah: david415: hi
[2013-03-01 18:45:35 -0500] jubilo: It gives me the location for the knife.rb and pem files if I'm using hosted chef, but not if I'm using Chef Server
[2013-03-01 18:45:53 -0500] jubilo: and I can't seem to find them on the chef-server box. anyone know where they might be, or if I need to generate them?
[2013-03-01 18:46:00 -0500] jubilo: the documentation isn't entirely clear.
[2013-03-01 18:46:30 -0500] rep0st1: anybody here use the gem knife xenserver?
[2013-03-01 18:47:03 -0500] amrnt: How to use https://github.com/fnichol/chef-ruby_build ? where to put methods like "ruby_build_ruby"? should i make a cookbook to just run a command for ruby_build?
[2013-03-01 18:48:19 -0500] drgage: jubilio: run knife configure client ~/client-config
[2013-03-01 18:48:28 -0500] drgage: then look in that dir :)
[2013-03-01 18:53:59 -0500] jubilo: thanks, drgage
[2013-03-01 19:01:43 -0500] mhalligan: does anyone have any tips for speeding up berks install?
[2013-03-01 19:02:05 -0500] aob: Any idea what the service name would be to enable sshd on OSX ?
[2013-03-01 19:02:18 -0500] aob: remotelogin? ssh? sshd? openssh?
[2013-03-01 19:02:41 -0500] aob: didn't find any clue on teh wiki, or google
[2013-03-01 19:04:52 -0500] miah: mhalligan: make it part of your automatic ci process so you don't notice the speed :P
[2013-03-01 19:05:18 -0500] mhalligan: miah: hah, that sounds like v3, I've never actually used a continuous integration system
[2013-03-01 19:05:33 -0500] mhalligan: I think what I really need is to just skip chef-server entirely and run stuff as chef-solo for testing.
[2013-03-01 19:06:02 -0500] mhalligan: the pain of a 5 minute upload process for a 3-second chef-run to find you have a bug
[2013-03-01 19:09:40 -0500] ranjibd: drgage,  but this will make your template non-idempotent , every time it will rewrite the template
[2013-03-01 19:12:10 -0500] drgage: ranjibd: ah yes, thanks for pointing that out. it's helping me for dev, but i'll take it out for production.
[2013-03-01 19:14:24 -0500] jubilo: has anyone had success installing the knife-rackspace plugin with Chef 11.x?
[2013-03-01 19:17:02 -0500] jordane: jubilo: I haven't personally tried it (we still use chef 10) but there are a few people who idle in this channel that work on the knife rackspace plugin. What issues are you having? cc: bradgignac
[2013-03-01 19:19:07 -0500] miah: mhalligan: use test-kitchen =)
[2013-03-01 19:19:15 -0500] miah: but still, the test process takes several minutes
[2013-03-01 19:19:20 -0500] bradgignac: jubilo: i haven't explicitly heard of any issues.
[2013-03-01 19:19:30 -0500] david415: miah: looking at your redis cookbook; looks pretty slick
[2013-03-01 19:19:31 -0500] mhalligan: that likely won't help me with my specific problems
[2013-03-01 19:19:35 -0500] miah: or, you can write library cookbooks with proper resource providers and then just write unit tests
[2013-03-01 19:19:56 -0500] miah: david415: thanks, it had a rewrite recently from chris lundiquist<sp>. some awesome work on his part.
[2013-03-01 19:19:58 -0500] jubilo: bradgignac: so as far as you know it should work fine with the embedded knife?
[2013-03-01 19:20:15 -0500] mhalligan: my problems are usually due to a lack of familiarty with how certain community cookbooks work, and I need to figure out an easy way to just copy over a cookbook I'm working on and run that
[2013-03-01 19:20:22 -0500] mhalligan: it would save me a good 5-10 hours a week
[2013-03-01 19:20:23 -0500] bradgignac: jubilo: as far as i know.
[2013-03-01 19:20:36 -0500] bradgignac: jubilo: unfortunately, i don't have a chef 11 server that i can test with
[2013-03-01 19:20:36 -0500] mhalligan: maybe I should just do more in shef
[2013-03-01 19:20:52 -0500] jubilo: bradgignac: okay, thanks. I am doing some testing and was running into issues on 10.18 so was trying to look for any gotchas in 11.
[2013-03-01 19:21:07 -0500] bradgignac: i would check the chef jira
[2013-03-01 19:21:30 -0500] faustroll: mhalligan: some kind of unit/integration testing mix should prolly be preferred over shef
[2013-03-01 19:21:50 -0500] mhalligan: faustroll: I'm not quite sure how that would solve this specific problem?
[2013-03-01 19:21:51 -0500] faustroll: unless you disagree!
[2013-03-01 19:21:59 -0500] faustroll: exactly
[2013-03-01 19:22:09 -0500] mhalligan: my real problem is: I need to be able to easily tinker and test until I know how something works
[2013-03-01 19:22:25 -0500] mhalligan: especially with other peoples' cookbooks and their lack of documentation
[2013-03-01 19:22:46 -0500] faustroll: mhalligan: yes. I hear you
[2013-03-01 19:23:02 -0500] mhalligan: is there a better way to solve that specific problem than the shef repl?
[2013-03-01 19:23:03 -0500] miah: dont get me started on this topic :P
[2013-03-01 19:23:16 -0500] mhalligan: because I really don't know, I'm not trolling this
[2013-03-01 19:23:30 -0500] faustroll: miah: please do get started
[2013-03-01 19:23:49 -0500] mhalligan: jtimberman: is ordering important with the firewall cookbook?
[2013-03-01 19:23:53 -0500] miah: no. i need to just write it and post it. because otherwise i'm just pissing people off.
[2013-03-01 19:23:57 -0500] mhalligan: (different question)
[2013-03-01 19:24:13 -0500] faustroll: miah: I find it interesting
[2013-03-01 19:24:34 -0500] faustroll: miah: if that provokes people, that is their issue
[2013-03-01 19:24:48 -0500] miah: agreed
[2013-03-01 19:25:14 -0500] faustroll: miah: I'm interested, because a best practices conversation helps
[2013-03-01 19:25:23 -0500] mattupstate: anyone familiar enough with the application and application_python cookbooks?
[2013-03-01 19:25:23 -0500] miah: ok
[2013-03-01 19:26:11 -0500] faustroll: miah: and here we have mattupstate back again trying to work with a cookbook
[2013-03-01 19:26:35 -0500] faustroll: mattupstate: still wrangling with that cookbook?
[2013-03-01 19:26:37 -0500] mattupstate: i'm curious if/how the gunicorn sub resource lets the application resource know to restart if the gunicorn config happens to change
[2013-03-01 19:27:13 -0500] mattupstate: faustroll: heh, i dont' think i've asked about this one recently
[2013-03-01 19:27:47 -0500] faustroll: mattupstate: my bad. sorry. must have been someone else yesterday
[2013-03-01 19:28:04 -0500] mattupstate: no worries ;)
[2013-03-01 19:28:53 -0500] miah: mattupstate: ya. so. that doesnt do anything _unless_ a deploy action is happening. (it seems)
[2013-03-01 19:28:59 -0500] miah: for fun, rm your unicorn.rb
[2013-03-01 19:29:05 -0500] miah: and watch chef run and not replace it
[2013-03-01 19:29:10 -0500] miah: unless a deploy is taking place
[2013-03-01 19:29:29 -0500] miah: i havent had time to dig into it and fix it
[2013-03-01 19:29:29 -0500] log1kal: I find vagrant + chef-solo a very useful and quick testing tool
[2013-03-01 19:29:38 -0500] miah: i find minitest to be faster
[2013-03-01 19:30:09 -0500] miah: i dont even have to spin up a vm, or run chef.
[2013-03-01 19:30:37 -0500] log1kal: miah: I haven't used minitest yet. You've piqued my interest
[2013-03-01 19:30:47 -0500] ggolin: can i override attributes like so: chef_env => { "name" => "foo", "path" => "/foo" } etc?
[2013-03-01 19:30:47 -0500] mattupstate: miah: got iti'm just curious because i've written my own uwsgi sub resource
[2013-03-01 19:30:55 -0500] faustroll: miah: yes. any tests that can be turned into unit tests, should be
[2013-03-01 19:31:00 -0500] mattupstate: miah: do you know off the top of your head how you might add that?
[2013-03-01 19:31:30 -0500] miah: rspec has more docs.. but minitest is neat and simple.
[2013-03-01 19:31:48 -0500] miah: mattupstate: no. i would have to look at the code again and my brain is concentrating on something else at the moment
[2013-03-01 19:32:15 -0500] mattupstate: no sweat
[2013-03-01 19:32:19 -0500] mattupstate: thanks, though
[2013-03-01 19:33:23 -0500] faustroll: I'm using chefspec, minitest, and test-kitchen
[2013-03-01 19:34:32 -0500] ggolin: no?
[2013-03-01 19:39:45 -0500] leifmadsen: minitest ftw
[2013-03-01 19:42:38 -0500] gchristensen: I could use some Chef wisdom:  I have three hundred machines, and I need one of them to run, what are now, cronjobs, on a regular basis - but I don't want two ore more machines to run the cronjobs. Is there a better solution to this? right now I have a special role, "foobar-crons" that attaches the jobs, but it doesn't feel clean.
[2013-03-01 19:58:49 -0500] ggolin: can someone please share a working role for the application cookbook?
[2013-03-01 20:06:24 -0500] atomic-penguin: gchristensen, have you tried doing a cookbook using cron resources? http://wiki.opscode.com/display/chef/Resources#Resources-Cron
[2013-03-01 20:09:01 -0500] gchristensen: I have, but I was hoping that there might be a better way than Cron directly, given these jobs are sensitive about being run once a day, and this server could go away
[2013-03-01 20:10:22 -0500] miah: why not make the scripts that run via cron a little more intelligent and determine if they need to be run or have already been run?
[2013-03-01 20:13:19 -0500] miah: then you can have the jobs execute on all the relevant systems in the group but not do anything unless something needs doing
[2013-03-01 20:16:00 -0500] gchristensen: that's an idea for sure
[2013-03-01 20:16:35 -0500] miah: i hate cronjobs for exactly that reason
[2013-03-01 20:16:46 -0500] gchristensen: that's what I'm wondering: is there a better system?
[2013-03-01 20:17:46 -0500] miah: certainly, but not really 'easier' =)
[2013-03-01 20:20:03 -0500] matti: :)
[2013-03-01 20:21:29 -0500] drgage: that approach means engineering your own protection against race conditions though, to ensure the task is not started on host2 while already running on host1
[2013-03-01 20:23:55 -0500] solarce: gchristensen: consider moving from cron jobs to using some kind of a worker queue like celeryd
[2013-03-01 20:24:05 -0500] miah: ^
[2013-03-01 20:24:19 -0500] miah: better, but not easier
[2013-03-01 20:27:27 -0500] gchristensen: yeah, those cronjobs put in queue jobs.
[2013-03-01 20:32:36 -0500] solarce: miah: more robust
[2013-03-01 20:33:18 -0500] solarce: gchristensen: http://docs.celeryproject.org/en/latest/reference/celery.schedules.html
[2013-03-01 20:44:58 -0500] miah: solarce: yup. definitely.
[2013-03-01 20:45:03 -0500] miah: 'most things worth doing are hard'
[2013-03-01 20:46:44 -0500] kallan:  Hello #Chef! I wonder if anyone would be willing to help me troubleshoot an error I'm seeing when I use the link resource on a Windows machine. https://gist.github.com/KAllan357/5067652
[2013-03-01 20:47:13 -0500] kallan: action :create can create the link just fine, but when I need to delete / switch the link to another file, I get the error in my gist
[2013-03-01 20:49:04 -0500] vish315: anyone came across this issue Mixlib::ShellOut::ShellCommandFailed: service[chef-solr] (chef-server::rubygems-install line 226) had an error:
[2013-03-01 20:49:26 -0500] qhartman: I'm running to a first-run problem with the community java cookbook, that just recently cropped up
[2013-03-01 20:49:48 -0500] qhartman: the default['java']['java_home'] attribute is not being set
[2013-03-01 20:50:45 -0500] qhartman: This is the code to set it from the default attributes file
[2013-03-01 20:50:46 -0500] qhartman: https://gist.github.com/qhartman/5067692
[2013-03-01 20:51:31 -0500] qhartman: I'm currently testing it on ubuntu, so it should be hitting that else, but when I try to access that attribute on the first run, it's always nil
[2013-03-01 20:52:03 -0500] vish315: anyone came across this issue Mixlib::ShellOut::ShellCommandFailed: service[chef-solr] (chef-server::rubygems-install line 226) had an error:
[2013-03-01 20:52:17 -0500] qhartman: after the first run it works fine
[2013-03-01 20:52:46 -0500] vish315: anyone came across this issue Mixlib::ShellOut::ShellCommandFailed: service[chef-solr] (chef-server::rubygems-install line 226) had an error:
[2013-03-01 20:53:25 -0500] mattupstate: is there an easy-ish way to send all the attributes of a resource to a template without having to do something like this? https://github.com/opscode-cookbooks/gunicorn/blob/master/providers/config.rb#L26
[2013-03-01 20:55:07 -0500] qhartman: mattupstate, not that I'm aware of, I usually spread it out over multiple lines though to make it more readable.
[2013-03-01 20:55:56 -0500] mattupstate: qhartman: got it
[2013-03-01 20:55:59 -0500] mattupstate: thanks
[2013-03-01 21:00:07 -0500] jhayden: I have a question about chef-server's storage of cookbook files:
[2013-03-01 21:00:38 -0500] jhayden: I have a directory tree under files/default
[2013-03-01 21:00:54 -0500] jhayden: but when I view the files through the webui
[2013-03-01 21:01:06 -0500] jhayden: all I see is a flat structure
[2013-03-01 21:01:11 -0500] jhayden: Is this correct?
[2013-03-01 21:04:24 -0500] znDuff: jhayden: chef-server's storage has traditionally been by content hash, not directory/filename at all.
[2013-03-01 21:06:06 -0500] btm: @opscode cookbook code review, join: http://bit.ly/YcXCUU  watch: http://youtu.be/l1RGtTFwyo4 #opschef
[2013-03-01 21:07:10 -0500] jhayden: znDuff: How they store them and how they represent them can be different
[2013-03-01 21:07:41 -0500] jhayden: if my cookbook allows me to set up a directory tree, why downs' the webui, show the same thing?
[2013-03-01 21:07:54 -0500] znDuff: jhayden: Indeed. That said, you asked about storage, and (unlike representation), that's actually something I know the answer to. :)
[2013-03-01 21:08:22 -0500] jhayden: your right, I did not phrase that well
[2013-03-01 21:08:50 -0500] jubilo: anyone know if 11.06 clients are compatible with a 10.18 server?
[2013-03-01 21:09:06 -0500] kderr: Did something change recently about how you manually force attribute values on a particular node using knife?
[2013-03-01 21:11:08 -0500] someara: jubilo no
[2013-03-01 21:11:38 -0500] someara: kderr you're prooooooobably doing it wrong, since you're going to lose the chance to version control this data about your infrastructure
[2013-03-01 21:11:39 -0500] someara: but
[2013-03-01 21:11:48 -0500] someara: knife node edit node-name
[2013-03-01 21:11:58 -0500] jubilo: no as in they are not compatible?
[2013-03-01 21:12:21 -0500] someara: jubilo I honestly haven't checked, but I'd imagine not
[2013-03-01 21:12:24 -0500] kderr: someara: Yeah, that's what I'm doing. And then the next time chef runs it blows away that change I just made. The node only gets set as a cookbook default. knife node edit is a "force default" which should be of higher precedence, right?
[2013-03-01 21:12:41 -0500] kderr: someara: I mean, the "attribute only gets set"
[2013-03-01 21:13:22 -0500] someara: kderr are you trying to set an "automatic" attribute (something ohai sets?)
[2013-03-01 21:13:29 -0500] jubilo: okay, thanks, someara
[2013-03-01 21:13:50 -0500] someara: if you set a default level attribute, and a cookbook loads the same one, it'll get overwritten
[2013-03-01 21:13:54 -0500] kderr: someara: Cookbook default.
[2013-03-01 21:14:07 -0500] someara: set a normal or override level attribute on the node then
[2013-03-01 21:14:23 -0500] kderr: someara: Can you do that? every time I've tried to do "override" it says it can't save my node data.
[2013-03-01 21:14:30 -0500] someara: but be aware that this is usually a bad idea, unless you're doing it progamatically somehow
[2013-03-01 21:15:22 -0500] someara: when chef-client runs, it'll read the node object in chef-server first, then load them from cookbooks, environments, roles, as it builds the node objetc
[2013-03-01 21:15:43 -0500] someara: unless you're setting the same attribute at the same precidence level from some other mechanism, it should be fine
[2013-03-01 21:15:51 -0500] bfrog: so if I just want to use chef as a little program to setup an ec2 instance before imaging it, chef-solo seems good
[2013-03-01 21:16:06 -0500] bfrog: but the docs seem very geared towards this full crazy chef setup
[2013-03-01 21:16:23 -0500] someara: bfrog ?
[2013-03-01 21:16:35 -0500] bfrog: I mean, I just want to install a few things from source, do some sed style config replacement, and image it up
[2013-03-01 21:16:54 -0500] someara: what do you mean "image it up"
[2013-03-01 21:16:56 -0500] bfrog: is that something chef does well or...?
[2013-03-01 21:17:04 -0500] bfrog: like, make an aws ami
[2013-03-01 21:17:19 -0500] someara: ah.
[2013-03-01 21:17:20 -0500] bfrog: I just want to basically build up an ami from one of the base amazon ami's like amazon linux
[2013-03-01 21:17:31 -0500] bfrog: then image it, and deploy it with something like asgard or whatever
[2013-03-01 21:17:39 -0500] bfrog: right now I build that image by hand
[2013-03-01 21:17:46 -0500] bfrog: and its error prone and annoying
[2013-03-01 21:18:05 -0500] bfrog: I could script it out with shell scripts, but checkout out chef/puppet/whatever to see if they offer benefits to that task
[2013-03-01 21:18:09 -0500] someara: chef eats policy in the form of recipes (shipped in cookbooks) and makes sure the machine is up to state
[2013-03-01 21:18:45 -0500] someara: you COULD snapshot the output of that and use asgard if you wanted
[2013-03-01 21:19:00 -0500] someara: but the real power comes from running it in the feedback loop, and using server
[2013-03-01 21:19:36 -0500] someara: so for example, you have a recipe that searches chef-server for nodes matching a certain set of attributes, and use the results to automatically render configuration files
[2013-03-01 21:19:41 -0500] someara: and it runs on a loop
[2013-03-01 21:19:54 -0500] someara: so if you add a new node to your infrastructure, it can be found automatically
[2013-03-01 21:20:29 -0500] someara: changes to those configs can auto-trigger services to restart or re-read their configs
[2013-03-01 21:21:43 -0500] bfrog: thats not really useful though if I just build up an AMI in 10 minutes and get asgard to roll out the new ami
[2013-03-01 21:24:38 -0500] someara: bfrog what happens if you need to change 4 bytes of data on each of your 100 asgard deployed AMIs to run a service on a new port?
[2013-03-01 21:25:27 -0500] bfrog: then I'll need to reimage anyways because the autoscaler demands it
[2013-03-01 21:25:39 -0500] bfrog: unless I'm expecting autoscaled instances to set themselves up I guess right
[2013-03-01 21:25:49 -0500] bfrog: with chef... or puppet
[2013-03-01 21:26:30 -0500] someara: up to you. autoscaler images I'd probably snapshot and feed the new instance
[2013-03-01 21:26:35 -0500] someara: yet still run chef
[2013-03-01 21:43:36 -0500] agrajag: so I'm not sure how deep this problem goes but using the stock opscode/chef-client recipe on Centos6 and Ubuntu12.04  has different things happen http://pastebin.com/SrxCgKTQ
[2013-03-01 21:55:16 -0500] kallan: Anyone have any input on my Windows-specific problem here? https://gist.github.com/KAllan357/5067652. When Chef runs and attempts to delete / recreate the symlink to a different spot, I get a permissions error.
[2013-03-01 21:59:38 -0500] mjreed: shouldn't Chef::Node.load return a Chef::Node instead of a Hash?
[2013-03-01 22:00:08 -0500] mjreed: Chef::Knife::NodeRunListAdd seems to think so..
[2013-03-01 22:08:14 -0500] mjreed: ok, so on a clean box with no rubygems whatsoever, gem install chef fails with a dependency error
[2013-03-01 22:08:48 -0500] mjreed: chef requires net-ssh (~> 2.2.2); net-ssh-multi requires net-ssh (>= 2.1.4); net-ssh-gateway requires net-ssh (>= 2.6.5)
[2013-03-01 22:11:27 -0500] awgross: mjreed: thats a bug with dependencies, they fixed it in newer versions
[2013-03-01 22:11:48 -0500] mjreed: newer than what?
[2013-03-01 22:12:28 -0500] mjreed: gem is grabbing 11.4.0
[2013-03-01 22:12:44 -0500] mjreed: but even if I specify --version='~>10.0' I get the same error.
[2013-03-01 22:15:51 -0500] david415: miah: ugh we use a giant git repo which contains a cookbooks directory...
[2013-03-01 22:16:14 -0500] mjreed: yeah, that doesn't scale
[2013-03-01 22:16:14 -0500] david415: clearly chef-librarian or berkshef is worth using
[2013-03-01 22:16:29 -0500] david415: i already dislike having one giant git repo
[2013-03-01 22:16:30 -0500] mjreed: between those I recommend berkshelf
[2013-03-01 22:16:46 -0500] david415: mjreed: yeah i've heard it's good but i have yet to use it...
[2013-03-01 22:16:48 -0500] mjreed: although it has some room for improvement
[2013-03-01 22:16:54 -0500] mjreed: it's a little . . . too thorough.
[2013-03-01 22:16:59 -0500] mjreed: at least, for our use case.
[2013-03-01 22:17:20 -0500] david415: git submodule for tracking a secondary cookbooks dir e.g. vendor/cookbooks doesn't strike me as a easy way
[2013-03-01 22:17:26 -0500] mjreed: we freeze our cookbooks, always bump versions when they change, always tag the cookbook repos with the version number, etc.  berkshelf could do a lot less work in our case
[2013-03-01 22:17:46 -0500] mjreed: git submodules are not the way to go.  we used braid for a while, which is better than submodules, but it's awfully persnickety.
[2013-03-01 22:18:06 -0500] kindsol: +1 for berkshelf
[2013-03-01 22:18:14 -0500] david415: can you tell me what specific problems git submodules have?
[2013-03-01 22:18:16 -0500] kindsol: and I keep all my cookbooks in one git repo
[2013-03-01 22:18:34 -0500] kindsol: I just use the rel: option
[2013-03-01 22:18:36 -0500] david415: kindsol: ah what? really?
[2013-03-01 22:18:47 -0500] david415: interesting
[2013-03-01 22:19:05 -0500] kindsol: An optional rel key can be specified if your repository contains many cookbooks in a single repository under a sub-directory or at root.
[2013-03-01 22:19:17 -0500] kindsol: (from http://berkshelf.com/)
[2013-03-01 22:19:31 -0500] david415: hmm yeah the problem with that is i want to for instance try out miah's redis cookbook
[2013-03-01 22:19:38 -0500] david415: and perhaps fork it
[2013-03-01 22:19:47 -0500] david415: and perhaps submit pull requests...
[2013-03-01 22:20:19 -0500] kindsol: I would recommend chef-rewind to customize community cookbooks
[2013-03-01 22:20:54 -0500] kindsol: then use a fork to make changes and contribution so you can remove the use of chef-rewind lateer
[2013-03-01 22:21:05 -0500] smdahlen: could someone provide advice/best practice on when to use a data bag vs default attributes in a cookbook? looking to configure ssmtp across all my nodes.
[2013-03-01 22:21:06 -0500] mjreed: the nice thing about berks is that you can combine cookbooks from multiple sources
[2013-03-01 22:21:12 -0500] mjreed: local directory
[2013-03-01 22:21:16 -0500] mjreed: various git repos
[2013-03-01 22:21:22 -0500] mjreed: even download directly from the chef server
[2013-03-01 22:21:49 -0500] mjreed: so you can add a berksfile to your existing infrastructure to try out miah's redis cookbook without having to touch your cookbooks directory
[2013-03-01 22:22:01 -0500] kindsol: mjreed: yep. so if you did want to tweak a fork of someone's cookbook directly, you could use that along side your monolithic cookbook repo
[2013-03-01 22:22:26 -0500] kindsol: david415: https://github.com/bryanwb/chef-rewind
[2013-03-01 22:22:54 -0500] kindsol: david415: here is an example of that idea in a blog post from Brian Berry http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-03-01 22:23:17 -0500] kindsol: (idea = using chef-rewind)
[2013-03-01 22:23:27 -0500] kindsol: which used to be named chef-edit
[2013-03-01 22:23:29 -0500] mjreed: r = resource(:foo => bar); r.attr1 newvalue1; r.attr2 newvalue2;    # who needs chef-rewind? ;-)
[2013-03-01 22:23:54 -0500] mjreed: I'm kidding.  chef-rewind is awesome.
[2013-03-01 22:24:14 -0500] miah: mjreed: indeed.
[2013-03-01 22:24:30 -0500] miah: david415: a Berksfile can point to the cookbooks in your local cookbooks directory, as well as external cookbooks on github.
[2013-03-01 22:24:39 -0500] miah: david415: rtfm. http://berkshelf.com/
[2013-03-01 22:25:02 -0500] kindsol: mjreed: true.  But if you are distributing cookbooks with that type of hackery (which I have to, but I don't recommend it) it is nicer to add a comment to the chef-rewind project to help folks understand what is going on
[2013-03-01 22:26:04 -0500] david415: kindsol: thanks i'll take a look
[2013-03-01 22:26:21 -0500] david415: miah: ok i'll  read up
[2013-03-01 22:26:24 -0500] kindsol: I guess I just do it for the read me.  but mjreed is right, his way is simpler
[2013-03-01 22:27:16 -0500] mjreed: ... and gem update --system gets me rubygems 2.0.0...
[2013-03-01 22:27:19 -0500] kindsol: or, rather, lighter weight
[2013-03-01 22:27:38 -0500] miah: its needed because most cookbooks are crap and you need to modify them =)
[2013-03-01 22:27:40 -0500] mjreed: dll hell, thy name is rubygems
[2013-03-01 22:28:33 -0500] miah: dll hell, meet bundler
[2013-03-01 22:36:46 -0500] micgo: Ohai! I'm running into an error with running 'chef-server-ctl test' on my Chef Server 11.06 after installation... I'm running on an Ubuntu 12.04.1 LTS box on EC2
[2013-03-01 22:37:10 -0500] mjreed: bundler is not a solution, just a containment strategy. :)
[2013-03-01 22:37:10 -0500] micgo: It seems to be having trouble finding pedant_config.rb
[2013-03-01 22:39:38 -0500] miah: mjreed: yup. contain the problem to a smaller segment of your system.
[2013-03-01 22:45:52 -0500] kindsol: mjreed: haha. true
[2013-03-01 22:57:45 -0500] jroberts: I need to install pre v11.0 chef-clients.  Does have a recommendation for the best way to do this is?  Opscode is not making it easy.
[2013-03-01 22:58:36 -0500] j^2: jroberts: the gem?
[2013-03-01 22:59:09 -0500] j^2: gem install chef  --version '10.18.0'
[2013-03-01 22:59:12 -0500] j^2: something like that?
[2013-03-01 22:59:27 -0500] doomviking: then uninstall the 11 gem
[2013-03-01 23:02:50 -0500] jroberts: I tried 10.14, 10.16, 10.18-2.  But 10.18.0 at least exists I need to resolve a del, but it might just work
[2013-03-01 23:05:43 -0500] doomviking: 10.24.0
[2013-03-01 23:07:09 -0500] jroberts: I am happy again.  Thanks!
[2013-03-01 23:45:52 -0500] coderanger: reset_: Woo mac client!
[2013-03-01 23:48:46 -0500] reset_: coderanger: finally! ;)
