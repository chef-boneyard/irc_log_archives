[2013-03-19 00:00:17 -0400] kesor: benkay: you need to use the chef webui.pem as your admin client, to create the first admin client  or something. it was very complex and not intuitive.
[2013-03-19 00:00:30 -0400] benkay: great.
[2013-03-19 00:00:34 -0400] kesor: benkay: during "knife configure -i" give it the webui.pem
[2013-03-19 00:00:41 -0400] benkay: as admin.pem?
[2013-03-19 00:00:52 -0400] kesor: yeah, and your "node name" should probably also be webui.
[2013-03-19 00:01:00 -0400] EJC: kesor: also - re-running your tool spits out the instance in question -
[2013-03-19 00:01:02 -0400] kesor: then you can configure a new client, and use that one from there on.
[2013-03-19 00:01:15 -0400] kesor: EJC: then its def. a bug in fog
[2013-03-19 00:01:40 -0400] benkay: thanks kesor
[2013-03-19 00:01:42 -0400] kesor: EJC: also would explain why so many various ruby tools have the same problem, like knife, puppet, etc.
[2013-03-19 00:01:54 -0400] EJC: kesor suggestions?
[2013-03-19 00:01:55 -0400] kesor: EJC: they all depend on fog.
[2013-03-19 00:02:04 -0400] kesor: EJC: hack fog? :)
[2013-03-19 00:02:48 -0400] kesor: first thing I do when I suspect a project has a bug  I go and check its pull request backlog, https://github.com/fog/fog/pulls.
[2013-03-19 00:04:41 -0400] EJC: kesor - right.....
[2013-03-19 00:04:56 -0400] EJC: fog 1.0.0
[2013-03-19 00:05:04 -0400] EJC: fog 1.9.0
[2013-03-19 00:05:13 -0400] kesor: EJC: you said it shows some of the instances but not all of them?
[2013-03-19 00:05:30 -0400] EJC: no no - your script returns all instances
[2013-03-19 00:05:43 -0400] EJC: including the one that knife ec2 plugin failed to find
[2013-03-19 00:06:05 -0400] kesor: EJC: oh  hmm  the xml doesn't have next_token in the end? :/
[2013-03-19 00:08:15 -0400] EJC: kesor - sorry?
[2013-03-19 00:08:24 -0400] EJC: In the xml output, I don't see next_token anywhere
[2013-03-19 00:08:40 -0400] kesor: pity, if it had next_token then we would have had an excellent (and easy) suspect for the bug  now its actually a bigger haystack and a smaller needle.
[2013-03-19 00:10:14 -0400] rafaelmagu: Shit
[2013-03-19 00:10:28 -0400] rafaelmagu: This Chef server install completely stopped
[2013-03-19 00:10:33 -0400] rafaelmagu: And nothing in the logs
[2013-03-19 00:10:39 -0400] rafaelmagu: I'm at a loss
[2013-03-19 00:10:45 -0400] kesor: rafaelmagu: how much memory do you have on that server?
[2013-03-19 00:10:56 -0400] rafaelmagu: 2GB
[2013-03-19 00:11:03 -0400] rafaelmagu: 1.2GB free
[2013-03-19 00:11:15 -0400] kesor: dmesg doesn't show killed processes?
[2013-03-19 00:11:24 -0400] rafaelmagu: Nope
[2013-03-19 00:11:33 -0400] rafaelmagu: Did a fresh reboot as well
[2013-03-19 00:12:26 -0400] rafaelmagu: Doing a knife status shows a request coming in on server.log
[2013-03-19 00:12:32 -0400] rafaelmagu: But nothing else on Solr or others
[2013-03-19 00:13:19 -0400] rafaelmagu: Maybe couchdb is corrupted?
[2013-03-19 00:13:22 -0400] rafaelmagu: corrupt*
[2013-03-19 00:13:54 -0400] rafaelmagu: Logs are normal as well for Couch
[2013-03-19 00:14:44 -0400] kesor: rafaelmagu: its a 10.x server then?
[2013-03-19 00:14:50 -0400] rafaelmagu: Yup
[2013-03-19 00:16:34 -0400] kesor: EJC: want to test and see if fog is the buggy one?  I made a test-code snipper for you, https://gist.github.com/kesor/5192354
[2013-03-19 00:16:58 -0400] kesor: *snippet
[2013-03-19 00:17:10 -0400] EJC: kesor - I'd have to add this to all my cookbooks?
[2013-03-19 00:17:30 -0400] kesor: no no  just test to see if it works, something like "bundle exec ruby amazon_query.rb"
[2013-03-19 00:17:38 -0400] EJC: sometimes it's the first instance, sometimes it's the last one :-(
[2013-03-19 00:17:41 -0400] kesor: if it works, then the problem is not in fog, it is in knife-ec2
[2013-03-19 00:17:51 -0400] EJC: it happens randomly
[2013-03-19 00:18:32 -0400] kesor: EJC: yeah, i'm using the method of elimination here  we already seen its not the aws api, so now onwards to check if its fog or knife-ec2
[2013-03-19 00:19:06 -0400] kesor: if it is not fog. then the bug must be in knife-ec2, and its a small piece of code so should be easy to find the problem. probably.
[2013-03-19 00:20:48 -0400] rafaelmagu: Here's something from chef-server.log: No routes match the request: /clients/ - (Merb::ControllerExceptions::NotFound)
[2013-03-19 00:20:51 -0400] EJC: I've never used bundler before :-/
[2013-03-19 00:21:27 -0400] rafaelmagu: I want to yank this Chef server away and install using the omnibus
[2013-03-19 00:21:33 -0400] kesor: oh, just run "ruby amazon_query.rb" then ...
[2013-03-19 00:21:50 -0400] kesor: rafaelmagu: sounds like a plan.
[2013-03-19 00:21:58 -0400] kesor: rafaelmagu: is it a production server?
[2013-03-19 00:22:05 -0400] rafaelmagu: Yup
[2013-03-19 00:22:17 -0400] kesor: rafaelmagu: may the force be with you ;)
[2013-03-19 00:22:39 -0400] EJC: kesor: jah, works, spits out all the instance names - again - if there was even a slight delay, we'd be fine
[2013-03-19 00:22:51 -0400] rafaelmagu: kesor: any recommendations on backing things up?
[2013-03-19 00:22:54 -0400] kesor: EJC: even if you run it a couple of times?
[2013-03-19 00:23:09 -0400] EJC: I just uparrowed it a trillion times :-/
[2013-03-19 00:23:24 -0400] benkay: hey kesor, any pointers to a wiki page on creating the initial api user for chef 10?
[2013-03-19 00:23:32 -0400] kesor: rafaelmagu: there are several export scripts out there, for example https://raw.github.com/stevendanna/knife-hacks/master/plugins/backup_export.rb.
[2013-03-19 00:23:45 -0400] rafaelmagu: Yeah, I've got knife-hacks gem
[2013-03-19 00:24:04 -0400] rafaelmagu: Interesting
[2013-03-19 00:24:15 -0400] kesor: rafaelmagu: how to import it back .,.. i have no idea. i never actually worked much with my own chef 10 server.
[2013-03-19 00:24:48 -0400] kesor: rafaelmagu: i suggest you run a new server in vagrant or something, and test importing there.
[2013-03-19 00:25:20 -0400] kesor: EJC: then its most defo a problem with knife-ec2  although it basically uses the same code I wrote in that gist.
[2013-03-19 00:25:36 -0400] EJC: the issue is it doesn't retry
[2013-03-19 00:25:50 -0400] EJC: it gets a slightly flaky response or doesn't wait long enough for soemthing to be created
[2013-03-19 00:26:11 -0400] gyre007: is there a way how I can run multiple omnibus chef installs on my workstation ?
[2013-03-19 00:26:12 -0400] EJC: you ahve an opscode bug: http://tickets.opscode.com/browse/KNIFE-207
[2013-03-19 00:26:54 -0400] kesor: gyre007: omnibus just installs it into /opt/whatever  what would "multiple" of them help anything?
[2013-03-19 00:27:42 -0400] gyre007: well I'd like to mess around with Chef 11 and I'd like to have knife of the same version
[2013-03-19 00:27:59 -0400] gyre007: whilst in production we are running 10.18...so my knife is 10.18 too
[2013-03-19 00:28:18 -0400] gyre007: im talking about workstation
[2013-03-19 00:28:33 -0400] gyre007: ill set up chef server via vagrant and berks
[2013-03-19 00:28:49 -0400] kesor: gyre007: I install my chef with "bundler install --standalone --binstubs", so my chef gems are just in the folder where my Gemfile is at.
[2013-03-19 00:29:16 -0400] kesor: gyre007: then I use bin/knife and its 11.4
[2013-03-19 00:29:19 -0400] gyre007: kesor: so you dont use omnibus then ?
[2013-03-19 00:29:24 -0400] gyre007: I see your point
[2013-03-19 00:29:38 -0400] kesor: gyre007: I do, in the servers that run chef-client  the linux ones. but my workstation is on my os x.
[2013-03-19 00:30:04 -0400] gyre007: kesor: yeah im running os x too
[2013-03-19 00:30:10 -0400] kesor: gyre007: also the .chef/knife.rb in that folder has all the settings and stuff.
[2013-03-19 00:30:32 -0400] kesor: gyre007: want my vagrant file?
[2013-03-19 00:30:41 -0400] gyre007: sure
[2013-03-19 00:31:02 -0400] gyre007: so you have to move between dirs when you want to use different chef conf
[2013-03-19 00:31:40 -0400] kesor: gyre007: yeah, each of my clients has his own dir.
[2013-03-19 00:31:46 -0400] gyre007: I see
[2013-03-19 00:31:48 -0400] gyre007: cool
[2013-03-19 00:31:56 -0400] segv:  NoMethodError: Undefined node attribute or method `load_attribute_by_short_filename' on `node'
[2013-03-19 00:31:59 -0400] segv: wtf
[2013-03-19 00:32:02 -0400] segv: documentation fail
[2013-03-19 00:32:15 -0400] kesor: gyre007: https://gist.github.com/kesor/5192456
[2013-03-19 00:32:29 -0400] segv: e.g. http://docs.opscode.com/essentials_cookbook_attribute_files_reload.html
[2013-03-19 00:33:08 -0400] gyre007: cheers...ill have a poke around kesor
[2013-03-19 00:33:10 -0400] kesor: gyre007: if you have any questions, fire away.
[2013-03-19 00:33:18 -0400] gyre007: sure
[2013-03-19 00:33:36 -0400] rafaelmagu: Wait a second
[2013-03-19 00:33:56 -0400] rafaelmagu: I may be having a blonde moment (with all due respect to blondes)
[2013-03-19 00:34:11 -0400] rafaelmagu: Seem the problem is with the combination of gems I have in my workstations
[2013-03-19 00:36:36 -0400] kesor: anyone knows if opscode has a cookbook that disables AppArmor ?
[2013-03-19 00:36:51 -0400] rafaelmagu: kesor: checkout annoyances
[2013-03-19 00:37:02 -0400] rafaelmagu: It's a cookbook specific for Ubuntu annoyances
[2013-03-19 00:37:08 -0400] kesor: rafaelmagu: thanks
[2013-03-19 00:39:15 -0400] EJC: kesor: so any last thoughts?  I've added a function and if the initial attempt at creation fails, I just retry the creation (and loop until it works now)
[2013-03-19 00:39:43 -0400] EJC: it spawns instances that end up doing nothing, but I can go back through and programattically delete everything that doesn't have a name (we have names for ALL our instancess)
[2013-03-19 00:39:54 -0400] kesor: EJC: sorry, no idea how to help at the moment.
[2013-03-19 00:40:22 -0400] EJC: did you look at the ec2 plugin?
[2013-03-19 00:40:56 -0400] EJC: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb#L228
[2013-03-19 00:43:26 -0400] kesor: EJC: apparently it does have some code that wits for it - https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb#L266
[2013-03-19 00:43:36 -0400] kesor: and wait_for_sshd several lines after that
[2013-03-19 00:43:45 -0400] kesor: *waits
[2013-03-19 00:46:18 -0400] rep0st: anybody know if the git::server recipe is broken with runit?
[2013-03-19 00:46:32 -0400] EJC: kesor: it never gets that far
[2013-03-19 00:46:59 -0400] EJC: gets this far
[2013-03-19 00:47:02 -0400] EJC: from /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/knife-ec2-0.6.2/lib/chef/knife/ec2_server_create.rb:239:in `block in run'
[2013-03-19 00:47:21 -0400] EJC: we create all the instances with names
[2013-03-19 00:47:29 -0400] EJC: it's like it can't attach the name to the instance fast enough
[2013-03-19 00:47:44 -0400] kesor: oh  yeah, probably because @server.id is not there yet.
[2013-03-19 00:48:02 -0400] kesor: you can try and move that wait_for to be right after the create line, maybe that will fix iyt.
[2013-03-19 00:48:03 -0400] kesor: *it
[2013-03-19 00:48:40 -0400] segv: jtimberman: can you have someone edit these docs here http://docs.opscode.com/essentials_cookbook_attribute_files_reload.html
[2013-03-19 00:48:48 -0400] segv: make sure this is documented as a chef 10.x feature only.
[2013-03-19 00:49:00 -0400] EJC: kesor: so move 266 up to just under 228?
[2013-03-19 00:49:09 -0400] kesor: EJC: yep
[2013-03-19 00:49:12 -0400] EJC: lol
[2013-03-19 00:49:21 -0400] EJC: is there an EASY way to do this?
[2013-03-19 00:49:32 -0400] kesor: edit your file?
[2013-03-19 00:49:43 -0400] kesor: EJC: vim /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/knife-ec2-0.6.2/lib/chef/knife/ec2_server_create.rb
[2013-03-19 00:49:48 -0400] EJC: >.<
[2013-03-19 00:49:51 -0400] kesor: just test that it works 
[2013-03-19 00:49:51 -0400] EJC: ok.....
[2013-03-19 00:50:05 -0400] kesor: if it works, you can make a pull request and ask opscode to fix it.
[2013-03-19 00:50:50 -0400] kesor: you know, thats why they give you this code  thats why its called opensource. so when there are problems, you go and fix them yourself :)
[2013-03-19 00:51:26 -0400] EJC: har har har - just tinkering on this stuff makes me squeamish - I'm right on the machine that is part of our bakery
[2013-03-19 00:51:34 -0400] EJC: (hold my hand)
[2013-03-19 00:51:50 -0400] kesor: EJC: you did say it was broken ...
[2013-03-19 00:54:37 -0400] EJC: the ec2 plugin?
[2013-03-19 00:54:41 -0400] EJC: or my hand?
[2013-03-19 00:54:55 -0400] kesor: knife-ec2  in your bakery :)
[2013-03-19 00:55:15 -0400] kesor: well, if it works. you can buy me that flight ticket to boston ;)
[2013-03-19 00:55:15 -0400] EJC: lol
[2013-03-19 00:55:49 -0400] kesor: i remember there is a very nice micro brewery there right in the middle of where all the universities are.
[2013-03-19 00:56:00 -0400] EJC: hahahahahhaha
[2013-03-19 00:56:08 -0400] EJC: there are so many nice microbreweries
[2013-03-19 00:56:26 -0400] EJC: I actually know a place that does scotch/bourbon/whiskey tastings if you prefer ;-)
[2013-03-19 00:56:30 -0400] kesor: actually this one was a rather large one
[2013-03-19 00:56:31 -0400] EJC: well, I prefer
[2013-03-19 00:57:12 -0400] EJC: crap, now I feel like it's doing nothing at all......
[2013-03-19 00:57:45 -0400] kesor: its waiting for the instances, it probably takes time.
[2013-03-19 00:58:06 -0400] kesor: oh, i remembered the name! Cambridge Brewing Co.  it was great.
[2013-03-19 00:58:10 -0400] EJC: nvm - I see it
[2013-03-19 00:58:16 -0400] EJC: cbc is still there
[2013-03-19 00:58:22 -0400] kesor: it better be
[2013-03-19 00:58:24 -0400] EJC: and I'm spitting distance from my office
[2013-03-19 00:58:39 -0400] kesor: you americans have all the fun :)
[2013-03-19 00:59:09 -0400] EJC: cool - so it creates the instance then sets the name
[2013-03-19 00:59:13 -0400] EJC: nvm
[2013-03-19 00:59:28 -0400] EJC: kesor where are you geographically?
[2013-03-19 00:59:33 -0400] kesor: the middle east :)
[2013-03-19 00:59:57 -0400] kesor: http://kesor.net
[2013-03-19 00:59:57 -0400] EJC: the likelihood of me buying you a ticket to the states just dropped exponentially :-(
[2013-03-19 01:00:02 -0400] kesor: :)
[2013-03-19 01:00:07 -0400] kesor: its ok.
[2013-03-19 01:00:38 -0400] EJC: I'll give your beers to sascha_d then
[2013-03-19 01:00:50 -0400] sascha_d: wat!
[2013-03-19 01:01:03 -0400] sascha_d: ohai EJ
[2013-03-19 01:01:12 -0400] EJC: kesor has saved my bacon once then helped me discover a bug in the ec2 knife plugin (maybe)
[2013-03-19 01:01:35 -0400] kesor: EJC: blame the programmers  without them, people like me would be out of a job.
[2013-03-19 01:01:37 -0400] EJC: I essentially came in here with 2 show stoppers and he slapped some sense into me with the first one now we're pinpointing the other one
[2013-03-19 01:01:45 -0400] EJC: lol
[2013-03-19 01:01:50 -0400] EJC: blameops no wait
[2013-03-19 01:02:12 -0400] sascha_d: @kesor I love your homepage icons
[2013-03-19 01:02:18 -0400] eherot: having a chef-server gem dependency issue I was hoping someone could help me with
[2013-03-19 01:02:18 -0400] sascha_d: adorbs
[2013-03-19 01:02:27 -0400] kesor: sascha_d: thanks, I dig them from the internets myself.
[2013-03-19 01:02:33 -0400] eherot: but it's the tricky, ungooglable kind
[2013-03-19 01:02:50 -0400] kesor: eherot: why not use omnibus and chef-server 11 ?
[2013-03-19 01:03:32 -0400] eherot: does chef-server 11 have all the backwards compatibility issues that chef-client 11 does?
[2013-03-19 01:04:02 -0400] sascha_d: @eherot wat's the problem?
[2013-03-19 01:04:15 -0400] kesor: eherot: its documented here - http://docs.opscode.com/breaking_changes_chef_11.html#chef-server
[2013-03-19 01:04:43 -0400] eherot: kesor: I already had a pretty negative experience trying to upgrade the clients so I'm wary...
[2013-03-19 01:05:00 -0400] eherot: here's the dep problem:
[2013-03-19 01:05:00 -0400] eherot: http://pastebin.com/LzE9qiE8
[2013-03-19 01:05:02 -0400] kesor: oh. guess its not something you want to do with your production anyway.
[2013-03-19 01:07:02 -0400] kesor: eherot: is this something that used to work and stopped?
[2013-03-19 01:07:18 -0400] eherot: yeah i broke it by trying to get the server to run on ruby 1.9
[2013-03-19 01:07:20 -0400] eherot: (bad idea)
[2013-03-19 01:07:35 -0400] eherot: now trying to run it on 1.8 again it is not working
[2013-03-19 01:07:39 -0400] kesor: ahh but it looks like merb-core is still trying to use 1.8
[2013-03-19 01:07:50 -0400] kesor: did you remove rubygems by any chance? (its bundled in 1.9)
[2013-03-19 01:08:02 -0400] kesor: it is a separate package in 1.8
[2013-03-19 01:08:15 -0400] eherot: removed the 1.9 apt package
[2013-03-19 01:08:18 -0400] kesor: mm like, do you have the "gem" command?
[2013-03-19 01:08:30 -0400] kesor: is the rubygems apt package installed?
[2013-03-19 01:08:32 -0400] eherot: irb(main):001:0> eherot@chef03:/usr/bin$ gem -v
[2013-03-19 01:08:32 -0400] eherot: 2.0.3
[2013-03-19 01:08:39 -0400] eherot: oops, ignore that irb nonsense
[2013-03-19 01:09:04 -0400] kesor: that doesn't look right  i have 1.8.25 in my ruby 1.9
[2013-03-19 01:09:05 -0400] eherot: it is.  Version: 1.3.5-1ubuntu2
[2013-03-19 01:09:19 -0400] kesor: why does it say 2.0.3 then? :/
[2013-03-19 01:09:39 -0400] eherot: yeah, I believe my destructive mistake was to run the rubygems updater, which breaks the apt gems instlal
[2013-03-19 01:09:40 -0400] kesor: 1.3.5 sounds right, but your command "gem" is not the installed package  its something else.
[2013-03-19 01:09:44 -0400] eherot: now i'm trying to get it back
[2013-03-19 01:09:56 -0400] kesor: which gem?
[2013-03-19 01:10:06 -0400] kesor: i mean, "which gem" ? :)
[2013-03-19 01:10:16 -0400] eherot:  /usr/bin/gem
[2013-03-19 01:10:35 -0400] kesor: is that a link? "ls -altr /usr/bin/gem"
[2013-03-19 01:10:43 -0400] eherot: it's not
[2013-03-19 01:10:56 -0400] kesor: try re-installing the rubygems apt package maybe
[2013-03-19 01:12:37 -0400] eherot: that didn't help
[2013-03-19 01:12:58 -0400] eherot: but there is also this:
[2013-03-19 01:12:58 -0400] eherot: gem list
[2013-03-19 01:12:58 -0400] eherot: rubygems-update (2.0.3, 1.8.24, 1.3.7)
[2013-03-19 01:13:08 -0400] kesor: eherot: remove it! :)
[2013-03-19 01:13:14 -0400] eherot: i can remove that rubygems update, though it still says 2.0.3 when I run gem -v
[2013-03-19 01:15:01 -0400] kesor: eherot: use "gem list -d" to see where its installed, and find the .gemspec file associated with the new-er gems.
[2013-03-19 01:15:38 -0400] eherot: for which gem?
[2013-03-19 01:15:43 -0400] kesor: rubygems-update
[2013-03-19 01:15:47 -0400] eherot: rubygems-update (1.8.24, 1.3.7)
[2013-03-19 01:15:48 -0400] eherot:     Authors: Jim Weirich, Chad Fowler, Eric Hodel
[2013-03-19 01:15:48 -0400] eherot:     Homepage: http://rubygems.org
[2013-03-19 01:15:48 -0400] eherot:     Installed at (1.8.24): /usr/lib/ruby/gems/1.8
[2013-03-19 01:15:48 -0400] eherot:                  (1.3.7): /usr/lib/ruby/gems/1.8
[2013-03-19 01:15:59 -0400] kesor: oh, so you did remove the 2.0.3 version.
[2013-03-19 01:16:03 -0400] eherot: (having uninstalled the 2.0.3 version)
[2013-03-19 01:16:14 -0400] kesor: yeah, 1.8.24 is also too new  its 1.9, not 1.8.
[2013-03-19 01:16:44 -0400] eherot: removed that one too
[2013-03-19 01:17:08 -0400] kesor: try and check in irb if your Gem module has an .activate method
[2013-03-19 01:17:34 -0400] kesor: Gem.methods.grep /activate/
[2013-03-19 01:17:53 -0400] eherot: it has try_activate
[2013-03-19 01:18:07 -0400] kesor: oh, you might need to   require "rubygems" or something.
[2013-03-19 01:18:12 -0400] eherot: did that
[2013-03-19 01:18:43 -0400] kesor: doesn't it have :activate? ...
[2013-03-19 01:18:51 -0400] eherot: apparently not
[2013-03-19 01:19:46 -0400] eherot: sorta makes it seem like it's still using the 1.9 rubygems, huh?
[2013-03-19 01:20:42 -0400] kesor: this is what I got on my mac  https://gist.github.com/kesor/97682168623b201b6cf7   you can try and remove/reinstall the rubygems gem via apt.
[2013-03-19 01:24:01 -0400] ssofos: quick question: I have just converted to Chef 11 server from Chef 10 and when I am trying to upload environments with cookbook versions I am getting this error: Response: Invalid value '0.6.0' for cookbook_versions
[2013-03-19 01:24:27 -0400] ssofos: do I need to change the syntax of my environment file or am I missing something else?
[2013-03-19 01:28:08 -0400] eherot: kesor: which "rubygems version" should it say instead of 2.0.3?
[2013-03-19 01:28:35 -0400] kesor: eherot: 1.3.6 or 1.3.5, as you said your apt says it has 1.3.5 installed.
[2013-03-19 01:29:55 -0400] eherot: is chef-server going to rebuild all of that stuff in /var/lib/chef that it blew away when i uninstalled its package? :-P
[2013-03-19 01:29:57 -0400] eherot: ok, fixed it
[2013-03-19 01:30:06 -0400] eherot: had to run /usr/bin/update_rubygems again
[2013-03-19 01:30:51 -0400] kesor: eherot: coolness! :)
[2013-03-19 01:31:03 -0400] eherot: now to figure out how much i screwed up the data store :-P
[2013-03-19 01:31:06 -0400] kesor: heh
[2013-03-19 01:31:25 -0400] kesor: backup is your friend. especially the "recover from backup" part.
[2013-03-19 01:31:34 -0400] eherot: I do have a backup of couch
[2013-03-19 01:31:42 -0400] eherot: it looks like it didn't delete anything from the db
[2013-03-19 01:31:48 -0400] eherot: thankfully I thought to tar-up /etc/chef first ;-)
[2013-03-19 01:33:19 -0400] eherot: the reason I embarked on this foolish endeavor in the first place was to try to figure out how to squeeze a little better performance out of the chef server (which is pegging the cpu on the box it's on right now with about 150 nodes).
[2013-03-19 01:33:33 -0400] eherot: i came across some advice suggesting performance is better on 1.9
[2013-03-19 01:40:19 -0400] kesor: eherot: might I suggest upgrading to chef server 11?  but not in production directly, naturally. first set it up in some sandboxed environment, like with vagrant.
[2013-03-19 01:41:01 -0400] eherot: kesor: I'm certainly interested to give it a try, especially if it doesn't have all of the backwards compatibility issues that the client does.
[2013-03-19 01:41:18 -0400] kesor: eherot: you familiar with vagrant?
[2013-03-19 01:41:27 -0400] eherot: yeah
[2013-03-19 01:41:32 -0400] eherot: just started playing with it last week
[2013-03-19 01:41:34 -0400] kesor: eherot: here you go, a shortcut -- https://gist.github.com/kesor/5192456
[2013-03-19 01:42:19 -0400] kesor: clone those two files into a folder, "bundle install --standalone --binstubs" and "bin/vagrant up".
[2013-03-19 01:42:35 -0400] kesor: can even use ruby 1.9
[2013-03-19 01:43:40 -0400] eherot1: is it possible to have the 10.18.0 omnibus client installed with the chef 11 server?
[2013-03-19 01:44:07 -0400] kesor: eherot1: idk, could be.
[2013-03-19 01:44:18 -0400] kesor: it should work the same afaik.
[2013-03-19 01:44:23 -0400] eherot1: it will likely hinge on that
[2013-03-19 01:44:45 -0400] kesor: better just upgrade it all  tweak the cookbooks, and be happy.
[2013-03-19 01:44:58 -0400] eherot1: i'm still waiting for a particular pull request to get merged into chef 11 that is required for a lot of our cookbooks to work
[2013-03-19 01:45:29 -0400] eherot1: http://tickets.opscode.com/browse/CHEF-3953
[2013-03-19 01:48:56 -0400] eherot: Kesor: Thank you so much for your guidance.  I always tell people my favorite part about chef is the awesome community.
[2013-03-19 01:48:59 -0400] eherot: Take care
[2013-03-19 01:49:07 -0400] kesor: cya
[2013-03-19 01:49:17 -0400] gchristensen: does anyone know what a file called .chef/virtualresults.rb might do?
[2013-03-19 02:01:26 -0400] gchristensen: when I run librarian install --verbose, it tells me "parser.rb:60:in `parse': undefined method `source' for nil:NilClass (NoMethodError)" but I haven't found any solution on github / google. has anyone found and resolved this issue before? full error: https://gist.github.com/grahamc/7c60fcd2013d5ecac675
[2013-03-19 02:01:55 -0400] ssofos: can anyone confirm if the syntax changed in Chef 11 for cookbook version in environments? Do you have to include the test operator with the version like so: = 0.2.6" ?
[2013-03-19 02:06:00 -0400] kesor: finally!  found the very very silly thing in the application cookbook that made me not sleep tonight ....
[2013-03-19 02:09:09 -0400] kesor: and it worked!!! woowoo! :)
[2013-03-19 02:22:42 -0400] EJC: kesor: grats!
[2013-03-19 02:22:56 -0400] EJC: I'm finally to the point where I can test this change I made to the ec2 plugin :-)
[2013-03-19 02:23:09 -0400] kesor: oh  I thought you already tested it :)
[2013-03-19 02:23:25 -0400] EJC: naw - I have another 10 services to deploy :-)
[2013-03-19 02:23:37 -0400] EJC: somewhere - if it's going to break, it'll let me know
[2013-03-19 02:23:42 -0400] EJC: I shouldn't get any of those "instance not found" errors
[2013-03-19 02:30:14 -0400] rking: I'm a bit confused about how to properly provision a user-owned install of Ruby, one that can 'gem install' from the normal user ('vagrant'), not requiring 'sudo'
[2013-03-19 02:30:38 -0400] rking: There's http://community.opscode.com/cookbooks/ruby_build
[2013-03-19 02:31:03 -0400] rking: But it seems to talk about a system-wide install, which I'm sure would be fine, but I don't want to make people have to use sudo to install.
[2013-03-19 02:31:52 -0400] rking: Oh my. It's right there. (prefix_path + user + group)
[2013-03-19 02:32:12 -0400] rking: Tonight is my night to get serious about Chef+Vagrant, and I done burned my Question Ticket on a lame one.
[2013-03-19 02:32:30 -0400] kesor: rking: here you go, a shortcut -- https://gist.github.com/kesor/5192456
[2013-03-19 02:34:09 -0400] rking: kesor: See, this is where all this chef stuff gets confusing to me. My understanding is that you're not supposed to do OS/distro-specific stuff like that 'apt-get remove', instead relying on some portable chef thingies.
[2013-03-19 02:34:59 -0400] kesor: rking: yeah, but since my vagrant servers are ubuntu preciese  I use a shell provisioner to clean them up before I run chef on them.
[2013-03-19 02:35:05 -0400] rking: kesor: Also, why do you set up the server/client thing instead of using chef-solo>
[2013-03-19 02:35:09 -0400] rking: s/>/?
[2013-03-19 02:35:15 -0400] kesor: I want my ruby to be installed by chef, not to come with the image.
[2013-03-19 02:35:35 -0400] mh`: does anyone know if there's any info on pluggable authentication for the chef-server webui
[2013-03-19 02:35:39 -0400] kesor: rking: because I want a server  my production has a server, thus my tests should include a server.
[2013-03-19 02:35:46 -0400] mh`: like if i wanted to auth against ldap or etc
[2013-03-19 02:36:06 -0400] kesor: rking: this is my sandbox environment where I develop stuff, and when it works I push it to the production server.
[2013-03-19 02:36:16 -0400] rking: kesor: OK, yep.  I still haven't figured out how to rightly draw the line between "It's just like prod!" vs "Aren't you glad it doesn't have to be just like prod!"
[2013-03-19 02:36:18 -0400] mh`: ah k http://tickets.opscode.com/browse/CHEF-541
[2013-03-19 02:36:56 -0400] kesor: rking: chef-solo is a different beast, it works differntly, search api dont work, and it needs all kind of tweaks. so unless I am using chef-solo in production  I rather not use it in my vagrant sandbox.
[2013-03-19 02:40:39 -0400] rking: kesor: Aha, OK. Now I'm tempted to follow suit.
[2013-03-19 02:41:19 -0400] rking: I'll get there. Tonight I'm just dead determined to get "a" working thing so poor, non-technical coworkers can stop following this ridiculous, painful process to get a dev env up (so they can do things like QA and bug hunting)
[2013-03-19 02:41:28 -0400] kesor: rking: if my production was using aws-opsworks for example, I would use that in my sandbox.
[2013-03-19 02:41:47 -0400] rking: Here's a different question. I see that there are a bunch of low-rated cookbooks on: http://community.opscode.com/search?query=redis&scope=cookbook
[2013-03-19 02:42:00 -0400] rking: In my (tiny) experience, they warrant that low rating: they don't work unless you have Ruby 1.9.3
[2013-03-19 02:42:16 -0400] rking: So how bad am I if I just drop in a shell provision to do 'apt-get install redis' ?
[2013-03-19 02:42:21 -0400] kesor: what does redis have to do with ruby versions? :/
[2013-03-19 02:42:40 -0400] kesor: why not just use chef and say -- package "redis"
[2013-03-19 02:42:59 -0400] kesor: thats it. you just say: package "redis"
[2013-03-19 02:43:09 -0400] kesor: in a recipe, inside a cookbook  :)
[2013-03-19 02:44:44 -0400] rking: 1) I found this which is higher-rated: http://community.opscode.com/cookbooks/redisio  2) Actually, I'm not sure what 1.9'ism was involved. It was definitely failing on some non-1.8 syntax somewhere.
[2013-03-19 02:45:17 -0400] rking: kesor: Right, but isn't that what the opscode cookbooks are about? Bundling that stuff up in a pro way so you can learn (and not learn the hard way)?
[2013-03-19 02:46:10 -0400] kesor: rking: they usually involve things that are a bit more complex. redis is too simple for a big opscode cookbook . imho.
[2013-03-19 02:47:09 -0400] rking: OK, but if I get them all to be things that are downloaded from opscode, then I don't have to make any extra dirs, just the Berksfile + Vagrantfile
[2013-03-19 02:47:29 -0400] rking: Perhaps that's an odd thing to optimize for, but I kinda have a long-story reason for it
[2013-03-19 02:49:36 -0400] kesor: rking: sorry to disappoint. but you are too optimistic.
[2013-03-19 02:50:13 -0400] rking: OK, then I'll tell you my "long story"
[2013-03-19 02:50:16 -0400] kesor: rking: most of the cookbooks in-the-wild probably wont work out of the box the way you expect, and you will have to do some cookbook writing of your own.
[2013-03-19 02:50:48 -0400] rking: I'm trying to tiptoe around the existing dev-ops repo, which was originally made very un-idiomatically (like giant blobs of shell scripts, wholly not idempotent)
[2013-03-19 02:51:22 -0400] rking: So if I add any repo to our codebase, it should probably be that one (or else it'll look like I'm completely not trying to work with the dev-ops stuff)
[2013-03-19 02:52:29 -0400] kesor: you can use berkshelf to bring-in opensourced cookbooks that you wrote, the code can be "external" so to speak, but still you wrote it.
[2013-03-19 02:52:53 -0400] rking: Hrm, true.
[2013-03-19 02:53:11 -0400] kesor: this way you dont add new code to your codebase other than the berkshelf and vagrant files ;)
[2013-03-19 02:53:45 -0400] rking: I'll try again with the devops guys repo. IIRC it gave me trouble, though. One thing I'm thinking is that the shell-based 'tmux' recipe preempted the opscode 'tmux' one
[2013-03-19 02:54:15 -0400] rking: Yeah, that sounds like a good way to add this. Git submodules aren't always popular. =)
[2013-03-19 02:55:05 -0400] kesor: git submodules almost never are  git is complex enough for most people, adding the overhead of properly managing submodules just blows minds. i've seen so many blank stares trying to explain how it works  i will not recommend it to anyone.
[2013-03-19 02:56:46 -0400] rking: I think it would work well if the default for 'git clone' was --recursive
[2013-03-19 02:56:53 -0400] rking: And then updates also did similarly
[2013-03-19 02:57:01 -0400] rking: But as it is you're forced to change people's processes.
[2013-03-19 02:57:16 -0400] kesor: mm just try and remember how you actually commit a new-er submodule version.
[2013-03-19 02:57:28 -0400] kesor: then imagine yourself explaining that to someone who barely understands git as it is.
[2013-03-19 02:57:29 -0400] rking: One thing I'm sure of, it's better to submodule than to require people to clone sibling dirs and reference those
[2013-03-19 02:57:55 -0400] kesor: then imagine that person trying to do what you explained from some kind of gui ...
[2013-03-19 02:57:56 -0400] rking: That part's not too hard, I don't think. Just commit the child dir, then come back to the top level and commit the update
[2013-03-19 02:58:02 -0400] rking: Hehe
[2013-03-19 02:58:10 -0400] kesor: you think its not hard? :)
[2013-03-19 02:58:22 -0400] kesor: as I already noted, you are too optimistic :)
[2013-03-19 03:02:04 -0400] bluekelp: i'm trying to get the opsode zookeeper cookbook working. it relies on ebs-snapshopts recipe but i can't find it anywhere.  anyonewhere where to resolve this dependency?
[2013-03-19 03:02:35 -0400] mh`: are you typing it like that
[2013-03-19 03:03:01 -0400] mh`: looks like it was missing a year ago
[2013-03-19 03:03:02 -0400] mh`: http://community.opscode.com/cookbooks/zookeeper/comments
[2013-03-19 03:04:28 -0400] bluekelp: ugh. so this is broken in the repository.  lulz.  this is the modern-day equiv of DLL-hell
[2013-03-19 03:04:46 -0400] bluekelp: mh`: thanks.  i'll kill the cookbook and try and find another
[2013-03-19 03:04:55 -0400] mh`: yeah it is for real
[2013-03-19 03:04:56 -0400] mh`: if you don't find it
[2013-03-19 03:05:03 -0400] mh`: you can see that it got rolled up into here
[2013-03-19 03:05:03 -0400] mh`: https://github.com/opscode-cookbooks/aws/blob/master/providers/ebs_volume.rb
[2013-03-19 03:05:04 -0400] mh`: but
[2013-03-19 03:05:18 -0400] mh`: http://community.opscode.com/cookbooks/zookeeper/source
[2013-03-19 03:05:20 -0400] mh`: they are shipping their own
[2013-03-19 03:06:03 -0400] bluekelp: yeah.  webtrends has another.  i didn't realize "knife cookbook site install" pulled from some crappy non-curated free-for-all repo
[2013-03-19 03:06:06 -0400] mh`: they're not the same at all, just the name is incidental.. but i mean that they're bringing their own ebs stuff instead of using that
[2013-03-19 03:06:10 -0400] mh`: yeap
[2013-03-19 03:06:19 -0400] mh`: eloquently put
[2013-03-19 03:06:41 -0400] bluekelp: things were going so well and i was pretty happy with chef and the community until right about now :)
[2013-03-19 03:07:03 -0400] mh`: that feeling will come and go
[2013-03-19 03:07:13 -0400] bluekelp: oh well. i'll just make it a point to never trust the site installs again, without verifying
[2013-03-19 03:07:39 -0400] mh`: are you using some sort of cookbook/repo manager thing like berkshelf or librarian?
[2013-03-19 03:08:01 -0400] mh`: (asking because i've just undergone the switch to chef, still trying to figure out a workflow that is appealing)
[2013-03-19 03:08:24 -0400] bluekelp: no. i'm figuring everything out as i go.  i prefer less magic so i have some idea what's going on under the commands i type
[2013-03-19 03:09:03 -0400] yfeldblum: bluekelp, doing package-management on 600 servers but not doing package-management in your own infrastructure codebase? :D
[2013-03-19 03:09:33 -0400] mh`: bluekelp: ah, the voice of experience and reason
[2013-03-19 03:09:41 -0400] mh`: bluekelp: sorry that has no place in the ruby community, get out.
[2013-03-19 03:09:42 -0400] EJC: kesor: doooood - totally worked!
[2013-03-19 03:09:51 -0400] kesor: EJC: you kick ass man! :)
[2013-03-19 03:10:15 -0400] yfeldblum: bluekelp, if you've got any questions w.r.t. librarian-chef, i can likely answer them
[2013-03-19 03:10:15 -0400] EJC: kesor: thanks for holding my hand dood - I was a bet meh at the start there but glad we were able to pinpoint the problem....
[2013-03-19 03:10:34 -0400] bluekelp: mh`: that's exactly why i want to know what's going on underneath.  too much is sold as magic and "just type this and it works" - and as i just found out - it ain't and it don't
[2013-03-19 03:10:35 -0400] mh`: yfeldblum: can.. i take you up on that
[2013-03-19 03:10:40 -0400] mh`: or is that an exclusive offer for bluekelp  ;)
[2013-03-19 03:11:00 -0400] yfeldblum: mh`, standing public offer
[2013-03-19 03:11:02 -0400] bluekelp: yfeldblum: i do.  can i setup trusted repos and guarantee i only get curated goodness that works and is tested?
[2013-03-19 03:11:07 -0400] mh`: bluekelp: heh, theres a reason I put off migrating for this long.. not that puppet was any better, just known-problems vs unknowns
[2013-03-19 03:11:36 -0400] mh`: bluekelp: you can scope it to a given site (no)
[2013-03-19 03:11:37 -0400] EJC: kesor: so should I continue testing or should I put in a pull request or <other>?  the fix is so simjple just move that wait on line 266 up to just under the server create...
[2013-03-19 03:11:42 -0400] yfeldblum: bluekelp, yes, but there is no specific software that i know of for setting up trusted repos and curating them, but if you do that somehow, librarian-chef will happily pull from that
[2013-03-19 03:11:45 -0400] bluekelp: yfeldblum: i ran into an issue trusting "knife cookbook site install" and had assumed that was similar to a pkg manager (though turns out no)
[2013-03-19 03:11:57 -0400] mh`: yfeldblum's answer is a more diplomatic one :)
[2013-03-19 03:12:12 -0400] yfeldblum: bluekelp, `knife cookbook site install` is not a package manager; it is a ball-of-mud downloader :D
[2013-03-19 03:12:15 -0400] mh`: technical answer: yes, sure. pragmatic answer: no such curated repository exists, that i've seen
[2013-03-19 03:12:23 -0400] kesor: EJC: I guess if you can explain why its broke, create a ticket on tickets.opscode.com and provide a pull request  it should eventually get in there.
[2013-03-19 03:12:27 -0400] bluekelp: as i just learned the hard way
[2013-03-19 03:12:34 -0400] yfeldblum: bluekelp, librarian-chef and berkshelf are both package managers for cookbooks
[2013-03-19 03:13:00 -0400] bluekelp: yfeldblum: is this the librarian-chef of which you speak? https://github.com/applicationsonline/librarian
[2013-03-19 03:13:02 -0400] yfeldblum: bluekelp, but you have to know what it is you're downloading, hopefully by reading the source; nobody's curating the packages on the other side
[2013-03-19 03:13:07 -0400] mh`: bluekelp: add {,-chef}
[2013-03-19 03:13:09 -0400] mh`: they split the repo
[2013-03-19 03:13:13 -0400] yfeldblum: bluekelp, yes
[2013-03-19 03:13:18 -0400] yfeldblum: mh`, i split the repo
[2013-03-19 03:13:23 -0400] mh`: HE split the repo
[2013-03-19 03:13:46 -0400] mh`: sorry, i didn't recognize your name.. yfeldblum isn't pronounced similar to applicationsonline ;)
[2013-03-19 03:14:17 -0400] yfeldblum: mh`, :D
[2013-03-19 03:14:39 -0400] bluekelp: yfeldblum: is there a "direct from github repo sha1/tag" option for librarian?
[2013-03-19 03:14:45 -0400] mh`: yfeldblum: it confused me a lot.. i starred it one day
[2013-03-19 03:14:49 -0400] mh`: then the next day
[2013-03-19 03:14:51 -0400] mh`: "wait, what"
[2013-03-19 03:14:59 -0400] mh`: bluekelp: yes
[2013-03-19 03:15:00 -0400] yfeldblum: bluekelp, yes
[2013-03-19 03:15:14 -0400] mh`: https://github.com/applicationsonline/librarian-chef#the-cheffile
[2013-03-19 03:15:25 -0400] yfeldblum: bluekelp, cookbook "foobar", :git => "https://github.com/foo/bar", :ref => "v3.1.23"
[2013-03-19 03:15:29 -0400] mh`: that ref is any commitish
[2013-03-19 03:15:37 -0400] mh`: (i would assume?)
[2013-03-19 03:15:50 -0400] bluekelp: oh right. i was even just reading that but my eyes didn't find it.  thanks
[2013-03-19 03:15:54 -0400] yfeldblum: mh`, yes - branches, tags, atags, and SHAs
[2013-03-19 03:15:55 -0400] mh`: bluekelp: fwiw, that's how i'm using it as well
[2013-03-19 03:16:40 -0400] bluekelp: ok, so i blast away all the custom cookbooks i've installed via "cb site install" and replace with aa Cheffile that points to the books directly, yes?
[2013-03-19 03:16:53 -0400] EJC: kesor: that ticket exists here:
[2013-03-19 03:16:56 -0400] EJC: http://tickets.opscode.com/browse/KNIFE-207
[2013-03-19 03:17:11 -0400] bluekelp: then run the cmdline tool and it pulls into my local repo; though i still have to upload them to the server, yes?
[2013-03-19 03:17:19 -0400] mh`: yes
[2013-03-19 03:17:41 -0400] yfeldblum: bluekelp, if you've got stuff downloaded already that you want to keep, be careful: librarian-chef takes over your "cookbooks" directory, deletes what was there before, and puts into there what you've specified in your Cheffile/Cheffile.lock
[2013-03-19 03:17:42 -0400] mh`: librarian-chef install && knife upload .
[2013-03-19 03:17:47 -0400] bluekelp: so my local SCM will have out books only and pull everthing else.  i prefer that
[2013-03-19 03:18:06 -0400] mh`: yes but take heed of  what yfeldblum just said
[2013-03-19 03:19:17 -0400] kesor: EJC: well, then comment on it with the solution! :)
[2013-03-19 03:19:20 -0400] mh`: yfeldblum: [to frame my question(s): i've just started using librarian-chef, and relatively new to chef.. not new to config mgmt or git.]  this is more of a workflow question, was wondering if there's a particular approach you endorse for housing: a) our own cookbooks b) mirrors of public cookbooks
[2013-03-19 03:19:24 -0400] bluekelp: yfeldblum: thanks for the warning.  where do i put our stuff that currently resides in git then?
[2013-03-19 03:19:27 -0400] mh`: i can't rely on random 3rd party repos that may or may not be there day to day
[2013-03-19 03:19:42 -0400] mh`: bluekelp: this readme is worth reading- https://github.com/applicationsonline/librarian-chef
[2013-03-19 03:19:45 -0400] mh`: and i don't often say that
[2013-03-19 03:19:47 -0400] bluekelp: b/c our chef cookbooks are in our own private git repo, do not sure how to pull our custom stuff in via librarian
[2013-03-19 03:19:48 -0400] mh`: its well written
[2013-03-19 03:19:50 -0400] EJC: kesor: I'm gonna submit a pull requst referencing the ticket with the fix
[2013-03-19 03:20:09 -0400] mh`: bluekelp: i'm doing two separate repos and sourcing them in.. like a chef-repo and a cookbooks repo, interested to hear what yfeldblum has to say though
[2013-03-19 03:20:34 -0400] bluekelp: ok ok.  i give up.  i'll read :)
[2013-03-19 03:20:45 -0400] yfeldblum: bluekelp, i put my own private cookbooks into my "site-cookbooks" directory, and leave these out of the Cheffile
[2013-03-19 03:20:49 -0400] kesor: EJC: cool :)
[2013-03-19 03:21:15 -0400] yfeldblum: bluekelp, i add both "cookbooks" (upstream stuff) and "site-cookbooks" (my own stuff) as cookbook_path entries in the knife.rb
[2013-03-19 03:21:30 -0400] kesor: yfeldblum: bluekelp: +1 i also edit my cookbooks in site-cookbooks that is configured in knife.rb in the same array cookbooks is configured in.
[2013-03-19 03:21:30 -0400] yfeldblum: bluekelp, so "knife cookbook upload" knows to look in both places
[2013-03-19 03:21:42 -0400] kesor: yeah, its awesome! :)
[2013-03-19 03:21:55 -0400] bluekelp: conceptually is ther a diff between berkshelf and lib-chef?  obviously you're biased toward lib-chef just wondering if they're similar or philosophically different
[2013-03-19 03:22:13 -0400] yfeldblum: mh`, i keep my custom cookbooks in-repo, and pull in external cookbooks with librarian-chef
[2013-03-19 03:22:31 -0400] ivey: berkshelf uses a central store and doesn't make a cookbooks/ directory
[2013-03-19 03:22:35 -0400] kesor: yfeldblum: only problem is that site-cookbooks dependencies are not recognized
[2013-03-19 03:23:07 -0400] mh`: hrm
[2013-03-19 03:23:07 -0400] mh`: k
[2013-03-19 03:23:08 -0400] mh`: ty
[2013-03-19 03:23:10 -0400] mh`: brb
[2013-03-19 03:23:36 -0400] yfeldblum: kesor, true; but i treat "site-cookbooks" like the app/ dir of a rails app: i also have to put the dependencies of all my code into the Gemfile too
[2013-03-19 03:24:09 -0400] kesor: yfeldblum: yeah. although it would be "nice" if the dependencies would just magically get pulled on their own, without editing the cheffile :)
[2013-03-19 03:24:59 -0400] yfeldblum: bluekelp, there are some practical differences, but share the overall goal of helping your be more rigorous in managing your cookbooks
[2013-03-19 03:25:29 -0400] bluekelp: thanks for the help, this has been quite useful
[2013-03-19 03:26:05 -0400] yfeldblum: bluekelp, ivey can help you with berkshelf, if you go that route; he's biased that way the same way i'm biased towards librarian-chef
[2013-03-19 03:26:53 -0400] kesor: yfeldblum: any idea why berkshelf would install downloaded cookbooks somewhere in my user home? :/
[2013-03-19 03:27:04 -0400] yfeldblum: kesor, it's possible, if a) you add entries to those cookbooks in your Cheffile using the :path source, b) you don't add that directory in your knife.rb, and c) you be sure to run `librarian-chef install` before uploading each time or use the integration
[2013-03-19 03:27:27 -0400] bluekelp: any other pointers to places on the web that are useful for pro-tips and hard-won-wisdom re: chef?  most things i find are java-doc-esque wiki pages on opscode and/or stupid tutorials on getting chef running
[2013-03-19 03:27:28 -0400] yfeldblum: kesor, yes, as a global cache for those people who have multiple chef-repo's (infrastructure codebases)
[2013-03-19 03:28:14 -0400] kesor: yfeldblum: as soon as I noticed that  i removed berkshelf and will never go back. hate it when tools feel free to use my home folder without even a warning.
[2013-03-19 03:28:17 -0400] bluekelp: i'm past that point and would like best-practices and wisdom.  since my general software experience doesn't help avoid pitfalls - just makes my hacked recipes more modular :)
[2013-03-19 03:28:17 -0400] yfeldblum: kesor, berkshelf doesn't yet to a full resolution of all possible cookbook version combinations, and is constrained to what you've got in your global cache
[2013-03-19 03:28:56 -0400] EJC: kesor: done - and dood - thanks a LOT - approaching 12 am here and snowstorm coming in
[2013-03-19 03:28:57 -0400] yfeldblum: kesor, the riotgames guys have an open issue to make some kind of dependencies API, which will hopefully solve some issues ... but it would be really swell if the opscode guys would do that
[2013-03-19 03:30:10 -0400] yfeldblum: kesor, heh ... there's tradeoffs everywhere ... some people don't like that librarian-chef makes "./tmp/librarian/" dirs for caches and scratch and "./.librarian" dir for local config :D
[2013-03-19 03:32:05 -0400] yfeldblum: kesor, but librarian-chef has to cache things somewhere and put local config somewhere
[2013-03-19 03:32:25 -0400] kesor: yeah, which he gracefully does in the same folder where the rest of the project is at.
[2013-03-19 03:32:34 -0400] kesor: and I can .gitignore it.
[2013-03-19 03:35:39 -0400] yfeldblum: bluekelp, hard-won wisdom takes a decade or so ... in the chef world, we've got six more years to go ...
[2013-03-19 03:37:34 -0400] bluekelp: heh.  true. i've run across a few but was hoping there was a secret blog of goodness
[2013-03-19 03:38:42 -0400] yfeldblum: bluekelp, maybe you'll start that blog
[2013-03-19 03:39:18 -0400] bluekelp: perhaps.  writing a blog *has* been on my list for a while.  if nothing else than for the groupies that surely follow
[2013-03-19 03:40:13 -0400] kesor: IT IS ALIVE!!!! muahahahahahahahahaha . and its not even 6 am!
[2013-03-19 03:40:32 -0400] kesor: well, mostly alive  but much more alive than dead for sure.
[2013-03-19 03:40:44 -0400] kesor: Amazeballs!
[2013-03-19 03:43:48 -0400] yfeldblum: mh`, bluekelp, kesor, anyway, for librarian-chef q's, if i'm not active in IRC, i'm @yfeldblum on twitter and github and yfeldblum@gmail.com by email
[2013-03-19 03:44:15 -0400] yfeldblum: ivey, any further word on the dependencies API?
[2013-03-19 03:44:16 -0400] kesor: i don't usually have librarian-chef questions, it just works, and I love it.
[2013-03-19 03:44:26 -0400] yfeldblum: kesor, thanks!
[2013-03-19 03:46:18 -0400] bluekelp: is lib-chef ruby 1.9 only or something?
[2013-03-19 03:46:45 -0400] bluekelp: my gem isn't finding
[2013-03-19 03:47:27 -0400] tigris_: what's the correct way for attributes to interpolate other attributes that may not be set yet?
[2013-03-19 03:47:27 -0400] yfeldblum: bluekelp, the "librarian-chef" gem is not yet released, since it is currently being split out from the "librarian" gem; so for now you can use the "librarian" gem instead
[2013-03-19 03:47:43 -0400] bluekelp: ah, thanks
[2013-03-19 03:48:02 -0400] KarlHungus: % knife omnibus build chef
[2013-03-19 03:48:05 -0400] KarlHungus: wish me luck =)
[2013-03-19 03:48:23 -0400] bluekelp: yfeldblum: is the lib-chef otherwise correct?
[2013-03-19 03:48:31 -0400] bluekelp: lib-chef readme*
[2013-03-19 03:48:42 -0400] yfeldblum: bluekelp, yes
[2013-03-19 03:48:49 -0400] tigris_: e.g. default['something'] = "asdf #{node['otherthing']} asdf" where node['otherthing'] may be .set in a recipe or whatever, or it may have it's own default
[2013-03-19 03:49:24 -0400] yfeldblum: bluekelp, you can also use the latest released readme, which is at https://github.com/applicationsonline/librarian/tree/v0.0.26
[2013-03-19 03:49:29 -0400] kesor: tigris_: I think that .set is "normal", not "default".
[2013-03-19 03:49:59 -0400] yfeldblum: bluekelp, sorry for the temporary confusion about the split though
[2013-03-19 03:50:57 -0400] tigris_: kesor: yes, but i want to set the default for "something" to be "asdf #{otherthing} asdf", where otherthing will hopefully be equal to whatever a recipe sets it to at runtime
[2013-03-19 03:51:05 -0400] kesor: tigris_: but that is the correct way, use node[] to lookup values
[2013-03-19 03:51:24 -0400] kesor: tigris_: yeah  what is "runtime"? :)
[2013-03-19 03:52:08 -0400] kesor: tigris_: thing is, the attribute files are parsed are loaded before the "runtime" happens.
[2013-03-19 03:52:29 -0400] tigris_: kesor: which is why i am asking what the correct approach is :)
[2013-03-19 03:52:30 -0400] bluekelp: yfeldblum: no worries.  got it installed and am trying the cheffile now
[2013-03-19 03:52:51 -0400] kesor: tigris_: I wish to know as well :/
[2013-03-19 03:54:19 -0400] tigris_: kesor: previously i just had default['foo'] = "foo #{node['bar']} bar" and would do a node.set['bar'] = 'something' in my recipe then call `node.load_attribute_by_short_filename` for my attributes file to reload it
[2013-03-19 03:54:31 -0400] tigris_: kesor: but that method has now been removed, so obviously my approach was wrong
[2013-03-19 03:55:10 -0400] yfeldblum: bluekelp, well it is approaching midnight for me, so i'll have to hit the hay shortly; but @yfeldblum on twitter/github and yfeldblum@gmail.com if you run into any problems
[2013-03-19 03:55:59 -0400] bluekelp: yfeldblum: thanks.  much appreciated.
[2013-03-19 03:58:50 -0400] ivey: yfeldblum: it came up in planning today
[2013-03-19 03:59:00 -0400] ivey: just a matter of getting resources on it
[2013-03-19 03:59:19 -0400] ivey: maybe opscode will do it before we get around to it...
[2013-03-19 03:59:20 -0400] yfeldblum: ivey, i think it will require fewer resources to put some pressure on opscode to do it :D
[2013-03-19 03:59:28 -0400] ivey: yeah
[2013-03-19 03:59:35 -0400] ivey: :+1: to that
[2013-03-19 04:00:01 -0400] yfeldblum: ivey, there's no reason you guys should have to do it; in fact, it would be more cumbersome for the rest of us to use
[2013-03-19 04:00:12 -0400] ivey: agreed
[2013-03-19 04:01:16 -0400] ivey: you can tell we don't really want to do it, since it's not done :-)
[2013-03-19 04:01:24 -0400] yfeldblum: ivey, :D
[2013-03-19 04:01:36 -0400] tigris_: basically i am after what Steven Danna said in this comment: http://tickets.opscode.com/browse/CHEF-2936?focusedCommentId=22010&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-22010
[2013-03-19 04:02:13 -0400] tigris_: however lambda's don't seem to be the way to go, since they don't to_s, you need to .call them
[2013-03-19 04:02:37 -0400] yfeldblum: anyway, heading out
[2013-03-19 04:02:39 -0400] kesor: tigris_: you can return a string from inside the lambda maybe?
[2013-03-19 04:03:54 -0400] tigris_: kesor: nah, the only way to exec the lamba block is to call .call on it
[2013-03-19 04:04:02 -0400] tigris_: kesor: then it will return the string
[2013-03-19 04:04:12 -0400] kesor: tigris_: but chef will .call it during convergence.
[2013-03-19 04:04:30 -0400] tigris_: kesor: interesting, i shall try this
[2013-03-19 04:04:53 -0400] kesor: tigris_: if it works, would solve me some problems as well.
[2013-03-19 04:05:00 -0400] mmaleko: Hi all, does anyone have a gist for setting up nginx passenger using the latest cookbook? Thanks heaps
[2013-03-19 04:08:58 -0400] kesor: mmaleko: did you try it and it didn't work?
[2013-03-19 04:09:20 -0400] kesor: mmaleko: think its as simple as having a run_list with "recipe[nginx::passenger],recipe[nginx::source]"
[2013-03-19 04:09:59 -0400] mmaleko: yeah, I'm not too sure if I'm supposed to specify recipe[nginx::passenger] then recipe[nginx::source] or the other way around in the run_list. =(.
[2013-03-19 04:10:17 -0400] mmaleko: kesor: I thought it was, but I'm trying to set up another server again and it failed
[2013-03-19 04:10:42 -0400] gleam: of course, running passenger-install-nginx (or wahtever it is, from the gem) will download+install nginx and build it
[2013-03-19 04:11:06 -0400] kesor: gleam: the cookbook doens't do that.
[2013-03-19 04:11:59 -0400] kesor: gleam: the cookbook adds configure flags for nginx::source to include the passenger module. nginx compiles the passenger, not vice versa.
[2013-03-19 04:12:05 -0400] gleam: sure
[2013-03-19 04:12:13 -0400] gleam: just randomly interjecting
[2013-03-19 04:12:45 -0400] kesor: I never liked the nginx module  its WAY too complex with WAY too many dependencies  just a monster
[2013-03-19 04:12:49 -0400] mmaleko: kesor: so I don't need to add like       "configure_flags" : [ "--add-module=/usr/local/rvm/gems/ruby-1.9.3-p392@global/gems/passenger-3.0.19/ext/nginx" ] ?
[2013-03-19 04:13:12 -0400] kesor: mmaleko: not if you add recipe[nginx::passenger] in your runlist, it does that for you.
[2013-03-19 04:13:34 -0400] kesor: mmaleko: just check the last couple of lines in https://github.com/opscode-cookbooks/nginx/blob/master/recipes/passenger.rb
[2013-03-19 04:13:36 -0400] mmaleko: kesor: hm i'll try that again.
[2013-03-19 04:13:44 -0400] mmaleko: kesor: I got a [2013-03-19T04:11:54+00:00] FATAL: Chef::Exceptions::EnclosingDirectoryDoesNotExist: template[/etc/nginx/conf.d/passenger.conf] (nginx::passenger line 59) had an error: Chef::Exceptions::EnclosingDirectoryDoesNotExist: Parent directory /etc/nginx/conf.d does not exist.
[2013-03-19 04:13:56 -0400] mmaleko: kesor: thanks heaps
[2013-03-19 04:14:39 -0400] kesor: mmaleko: hmm try adding nginx::passenger after nginx::source, might work as well ....
[2013-03-19 04:14:50 -0400] kesor: and probably solves the error you had.
[2013-03-19 04:16:05 -0400] mmaleko: kesor: ah tried that, it failed too. lol. I'll try not specifying the configure flags first
[2013-03-19 04:17:08 -0400] mmaleko: kesor: man I wish there were more doco online on it. i prob. should gist my two cents worth if it works. =).
[2013-03-19 04:17:55 -0400] mh`: yfeldblum: sorry to disappear, uber arrived quicker than i expected and had to migrate home from office.
[2013-03-19 04:17:57 -0400] mh`: yfeldblum: thanks much
[2013-03-19 04:19:07 -0400] mh`: bluekelp: was just reading scrollback, you're gonna be internet famous?
[2013-03-19 04:19:19 -0400] jaryd: hey guys, is there a way to use knife ec2 server create to launch multiple instances of the same type?
[2013-03-19 04:19:40 -0400] jaryd: so like, knife ec2 server create -r "role[base]"
[2013-03-19 04:19:55 -0400] jaryd: -N machine{a,b,c,d} --flavor --region etc
[2013-03-19 04:22:10 -0400] kesor: jaryd: don't think knife-ec2 has that built-in, but it should be easy to script given a list of names to run the command multiple times.
[2013-03-19 04:23:42 -0400] jaryd: kesor: ah ok thanks
[2013-03-19 04:28:25 -0400] mh`: the knife-ec2 plugin is kinda bad
[2013-03-19 04:28:35 -0400] mh`: not entirely by its own doing
[2013-03-19 04:28:38 -0400] segv: yeah
[2013-03-19 04:28:40 -0400] mh`: there's a number of bugs in fog
[2013-03-19 04:28:54 -0400] mh`: it was a bad first impression for me
[2013-03-19 04:28:56 -0400] kesor: ECJ and I found a bug in knife-ec2 today actually
[2013-03-19 04:29:05 -0400] mh`: was the first contrib thing i installed when i started trying out chef
[2013-03-19 04:29:08 -0400] mh`: kesor: yeah?
[2013-03-19 04:29:09 -0400] kesor: it was trying to use @server.id before waiting for it to get created.
[2013-03-19 04:29:14 -0400] kesor: yeap
[2013-03-19 04:29:15 -0400] mh`: hmm
[2013-03-19 04:29:18 -0400] mh`: i've seen that reported i think
[2013-03-19 04:29:25 -0400] mh`: cuz i was recently digging through jira for another issue
[2013-03-19 04:29:27 -0400] segv: knife-ec2 :(
[2013-03-19 04:29:31 -0400] kesor: yeah, think ECJ is pushing a pull request for that
[2013-03-19 04:29:33 -0400] mh`: i have this problem where i get multiple security groups listed for instances for no reason
[2013-03-19 04:29:33 -0400] segv: I love when it hiccups and juist sits
[2013-03-19 04:29:37 -0400] segv: launches the instance
[2013-03-19 04:29:39 -0400] segv: then fails
[2013-03-19 04:29:46 -0400] segv: and the instance is up and running haha
[2013-03-19 04:29:50 -0400] mh`: like.. say i have a SG called 'android' and it's the only SG associated w/ an instance
[2013-03-19 04:30:05 -0400] mh`: for no reason at all, that instance row will have in the SG column: android, android, android, android
[2013-03-19 04:30:13 -0400] mh`: the bug is in fog somewhere
[2013-03-19 04:30:29 -0400] mh`: naturally i fixed it by adding uniq in knife-ec2 ;/
[2013-03-19 04:30:35 -0400] mh`: fog is a cesspool of open tickets
[2013-03-19 04:30:53 -0400] mh`: i saw like 8 other issues about inconsistencies around SGs that have been opened/closed over the last year
[2013-03-19 04:30:57 -0400] mh`: and this bug has been going on for at least 6 months
[2013-03-19 04:31:42 -0400] segv: fog :(
[2013-03-19 04:31:46 -0400] segv: fog blows up randomly so much
[2013-03-19 04:32:10 -0400] mh`: yeah
[2013-03-19 04:32:34 -0400] mh`: i'm not a ruby guy outside of chef and other stuff that i use that is in ruby.. that is, i don't write my own production stuff in ruby if there's not a reason to..
[2013-03-19 04:32:42 -0400] mh`: that said, is fog really the best option in ruby for AWS?
[2013-03-19 04:32:50 -0400] mh`: or is it just the fascination with overabstraction that has us using it for knife-ec2
[2013-03-19 04:32:56 -0400] rking: mh`: SGs == ?
[2013-03-19 04:33:03 -0400] mh`: in pythonland there's boto.. php and java have AWS SDKs
[2013-03-19 04:33:06 -0400] mh`: rking: security groups
[2013-03-19 04:33:09 -0400] rking: Ah
[2013-03-19 04:33:59 -0400] mh`: i have a screenshot of the errant output, sec
[2013-03-19 04:34:05 -0400] mh`: easier than describing it
[2013-03-19 04:34:08 -0400] mh`: sorry, i don't have it in text format
[2013-03-19 04:34:11 -0400] mh`: so here comes screenshots-of-text guy
[2013-03-19 04:35:16 -0400] mh`: k maybe i do..
[2013-03-19 04:35:45 -0400] rking: Haha
[2013-03-19 04:36:04 -0400] kesor: mh`: I think fog is pretty much the only option for aws in ruby-land.
[2013-03-19 04:36:10 -0400] mh`: weird
[2013-03-19 04:36:18 -0400] kesor: just like boto is the only one in python land
[2013-03-19 04:36:23 -0400] mh`: but, it's not
[2013-03-19 04:36:26 -0400] kesor: with the exception of my own small script.
[2013-03-19 04:36:27 -0400] mh`: it's the only good one
[2013-03-19 04:36:28 -0400] mh`: but
[2013-03-19 04:36:34 -0400] mh`: and this is a big but
[2013-03-19 04:36:38 -0400] mh`: it's maintained by an AWS employee
[2013-03-19 04:36:44 -0400] mh`: and has good test coverage
[2013-03-19 04:36:52 -0400] mh`: that's a little easier to swallow
[2013-03-19 04:36:52 -0400] mh`: ;/
[2013-03-19 04:37:27 -0400] kesor: fog has plenty of tests as well btw.
[2013-03-19 04:37:43 -0400] mh`: i was careful to say good test coverage :)
[2013-03-19 04:37:48 -0400] kesor: :)
[2013-03-19 04:37:56 -0400] mh`: but to be fair, i haven't looked at either of their tests in detail
[2013-03-19 04:38:09 -0400] mh`: i just patch bugs i run into.. if they are clean enough fixes to contribute i try to
[2013-03-19 04:38:30 -0400] kesor: I don't trust either of them, I don't even trust the aws command line tools .. only thing I trust, is doing a direct api query and reading the xml output.
[2013-03-19 04:38:33 -0400] mh`: if there's an imbalance in the amount of effort to submit a simple patch
[2013-03-19 04:38:40 -0400] mh`: then i just keep my fork going til someone else fixes it
[2013-03-19 04:38:56 -0400] mh`: shrug, i've never had an issue with the official AWS java CLIs
[2013-03-19 04:39:01 -0400] mh`: i mean, i should say, an unexpected result
[2013-03-19 04:39:06 -0400] kesor: I got my own swiss knife to poke the aws api. https://github.com/kesor/amazon-queries/blob/master/main.py + aws.amazon.com/documentation/
[2013-03-19 04:39:07 -0400] mh`: plenty of issues, like, they suck and they're slow
[2013-03-19 04:39:50 -0400] mh`: kesor: now release a knife plugin that just popen()'s python
[2013-03-19 04:39:56 -0400] mh`: and watch the community's heads asplode
[2013-03-19 04:40:05 -0400] kesor: the documentation API guides have a good list of Actions and parameters, I just feed that into the question = {} part of my script, and thats it.
[2013-03-19 04:40:20 -0400] mh`: kesor: have you seen https://github.com/aws/aws-cli
[2013-03-19 04:40:38 -0400] mh`: dunno if you follow boto dev.. they refactored things into boto vs botocore, for the next release
[2013-03-19 04:40:45 -0400] kesor: mh`: I think I can rewrite the 45 lines of python at https://github.com/kesor/amazon-queries/blob/master/amazon/query.py into the same thing in ruby.
[2013-03-19 04:40:46 -0400] mh`: and aws-cli is a scratch rewrite in python using botocore only
[2013-03-19 04:41:12 -0400] kesor: as I said, only thing I trust is the aws documentation and the xml coming out of their api endpoints.
[2013-03-19 04:41:16 -0400] mh`: kesor: perhaps, but i was going to crib your 'proxy' to have it call boto :)
[2013-03-19 04:41:26 -0400] mh`: mmkay
[2013-03-19 04:42:08 -0400] mh`: i run infrastructure that serves >1b api responses/day, i'm quite sensitive to the risks too
[2013-03-19 04:42:15 -0400] kesor: no no  boto is "outdated", it never uses the latest api version, does not support the latest api actions, etc  it takes them several weeks or months after each new amazon release to add it to the boto api. why have an api wrapping an api? :/
[2013-03-19 04:42:45 -0400] mmaleko: kesor: removing the configure-flags didn't help, neither did specify recipe[nginx::passenger] after recipe[nginx::source] helped. I think it's because it didn't build it with the right configure flags if i specify it after
[2013-03-19 04:43:14 -0400] mmaleko: kesor: and if I specify passenger before source, it can't find the /etc/conf.d directory *groan*
[2013-03-19 04:43:15 -0400] mh`: kesor: i've yet to have a problem resulting from any of those things
[2013-03-19 04:43:43 -0400] mh`: kesor: but just like you don't trust the command line tools, I can't withstand the failures from all of the AWS experiments (their value-add stuff like RDS, autoscaling groups, etc)
[2013-03-19 04:43:52 -0400] mh`: so i pretty much don't care about anything outside of ec2/route53
[2013-03-19 04:43:59 -0400] mh`: and elb to some degree
[2013-03-19 04:44:15 -0400] kesor: mh`: did you take a peek at the code I linked? :)
[2013-03-19 04:44:29 -0400] mh`: no
[2013-03-19 04:44:43 -0400] mh`: haha
[2013-03-19 04:45:16 -0400] mh`: might as well use one of the curl wrappers then
[2013-03-19 04:45:19 -0400] mh`: :)
[2013-03-19 04:45:21 -0400] kesor: :)
[2013-03-19 04:45:31 -0400] kesor: curl would have trouble doing all the signed_request dance.
[2013-03-19 04:45:42 -0400] kesor: the one in here https://github.com/kesor/amazon-queries/blob/master/amazon/query.py
[2013-03-19 04:45:44 -0400] mh`: thats why i said wrappers
[2013-03-19 04:45:55 -0400] mh`: yeah, thats what i was looking at
[2013-03-19 04:45:59 -0400] mh`: i'll link it if i can find it in a min
[2013-03-19 04:46:02 -0400] mh`: just for curiosity's sake
[2013-03-19 04:46:42 -0400] kesor: mmaleko: sorry I can't really help, might be it doesn't really work :/
[2013-03-19 04:47:17 -0400] mmaleko: kesor: lol no worries. I'll hack around it. I think you gave me a couple of ideas of what to do. thanks =)
[2013-03-19 04:50:10 -0400] kesor: gtg. will be back in a couple of hours.   was a pleasure hacking through the night with all you fine folk.
[2013-03-19 05:20:50 -0400] psykidellic: Whats the suggested way to setup dotfiles and ALIASES for a user?
[2013-03-19 05:21:14 -0400] segv: hmm
[2013-03-19 05:25:15 -0400] psykidellic: i could use template.
[2013-03-19 05:27:44 -0400] ranjibd: psykidellic: yup, templates if you have customizations.. run time based
[2013-03-19 05:28:00 -0400] ranjibd: if you want to just drop in stuff.. cookbook_file is good too
[2013-03-19 05:28:05 -0400] ranjibd: even a git repo
[2013-03-19 05:28:10 -0400] ranjibd: with scm resource
[2013-03-19 05:29:00 -0400] psykidellic: I will look into the other two non-template ways..but for now, I dont have it in any SCM.
[2013-03-19 05:45:14 -0400] gad0lin: I started playing with Vagrant + Berksfile, I have set Vagrantfile to provision with Chef Solo however it keeps asking about /etc/chef/client.pem, grep does not show any searches, any simple hint?
[2013-03-19 05:53:48 -0400] gad0lin: fixed
[2013-03-19 07:23:21 -0400] GreatSUN: Good morning folks
[2013-03-19 07:23:38 -0400] GreatSUN: again some attribute topic
[2013-03-19 07:24:27 -0400] GreatSUN: I know that between attributes from cookbooks there can be problems accessing values within the attribute files
[2013-03-19 07:25:08 -0400] GreatSUN: therefore I have been putting the decision stuff into recipes
[2013-03-19 07:41:00 -0400] LeoSh: I feel like this should be super easy but I can't seem to figure it out - how do I load the contents of a cookbook file into a string?
[2013-03-19 07:45:50 -0400] kesor: LeoSh: File.read("some/file/name.ext")
[2013-03-19 07:46:57 -0400] LeoSh: kesor: but that won't use the chef file semantics...? (ie. default, vs. node specific versions)
[2013-03-19 07:47:48 -0400] kesor: LeoSh: sorry, I can't undestrand what you mean or want to achieve.
[2013-03-19 07:48:42 -0400] LeoSh: if I use the chef File or Template resources, they'll load files from the cookbook and pick the appropriate subfolder of /templates/ or /files/ depending on the os of the machine and the node name
[2013-03-19 07:49:02 -0400] LeoSh: File.read is just Ruby - so it won't know about cookbooks or that logic
[2013-03-19 07:50:27 -0400] LeoSh: kesor: so, this - http://docs.opscode.com/chef/essentials_cookbook_templates.html#location-specificity
[2013-03-19 07:53:05 -0400] kesor: LeoSh: so you say that you don't know the full path, is that it?
[2013-03-19 07:53:19 -0400] LeoSh: yes
[2013-03-19 07:53:29 -0400] LeoSh: I'd like to access it using the normal cookbook file semantics
[2013-03-19 07:53:49 -0400] kesor: LeoSh: did you try and check the __FILE__ special variable?
[2013-03-19 07:54:03 -0400] LeoSh: I don't know what that is...
[2013-03-19 07:54:18 -0400] kesor: it is supposed to reference to the current ruby file name.
[2013-03-19 07:54:33 -0400] LeoSh: ok, but I'm not sure how that helps
[2013-03-19 07:54:34 -0400] kesor: since chef is ruby code that is executed, it might work.
[2013-03-19 07:55:07 -0400] GreatSUN: ok... telephones are always disturbing
[2013-03-19 07:55:11 -0400] GreatSUN: again...
[2013-03-19 07:55:57 -0400] GreatSUN: Values between cookbooks within attribute files are not available/accessible/set with chef 10.12
[2013-03-19 07:56:15 -0400] GreatSUN: therefore I am working on them within ruby-scripts in recipes
[2013-03-19 07:56:19 -0400] GreatSUN: but...
[2013-03-19 07:56:39 -0400] GreatSUN: now I can see that they are not even available there
[2013-03-19 08:00:57 -0400] kesor: GreatSUN: you can use "include_attribute 'some_other_cookbook'" afaik
[2013-03-19 08:03:25 -0400] GreatSUN: kesor: I need to check if some node attribute was set by another cookbook
[2013-03-19 08:03:41 -0400] kesor: GreatSUN: why?
[2013-03-19 08:03:43 -0400] GreatSUN: -> if a node attribute has a value set already
[2013-03-19 08:03:56 -0400] GreatSUN: kesor: difficult to describe in short words
[2013-03-19 08:04:05 -0400] kesor: why not use a boolean value?
[2013-03-19 08:04:31 -0400] GreatSUN: kesor: doesn't matter which type of value
[2013-03-19 08:04:45 -0400] GreatSUN: if I am not able to get the value set by another cookbook
[2013-03-19 08:05:01 -0400] kesor: I already told you, use include_attribute for that.
[2013-03-19 08:10:23 -0400] GreatSUN: kesor: ok... whole story
[2013-03-19 08:10:48 -0400] GreatSUN: kesor: I do not know which cookbook is loaded before mine or if there are a couple of
[2013-03-19 08:11:19 -0400] GreatSUN: kesor: but in all cookbooks it could be that someone defines an attribute I have to work with as default or override
[2013-03-19 08:11:47 -0400] GreatSUN: this is why I have to check which values are set before creating the valueset for my working recipes
[2013-03-19 08:13:07 -0400] GreatSUN: since I do not know which attributes from which cookbooks are loaded include_attribute is not the solution I am searching for
[2013-03-19 08:13:42 -0400] GreatSUN: I need some place where I can have some ruby code and have access to the already set attributes
[2013-03-19 08:13:58 -0400] GreatSUN: could this be done by LWRP for example?
[2013-03-19 08:14:11 -0400] GreatSUN: or is that totally impossible with chef 10.12?
[2013-03-19 08:14:49 -0400] kesor: GreatSUN: cookbook attributes in 10.x load in random order, unless you use include_attribute
[2013-03-19 08:15:06 -0400] kesor: GreatSUN: also, to not set values you can use "node.set_unless['something'] = value"
[2013-03-19 08:15:14 -0400] GreatSUN: kesor: I can see recipes working and setting stuff to node
[2013-03-19 08:15:34 -0400] GreatSUN: but in the next call of the ruby-code it doesn't see the values set before
[2013-03-19 08:15:43 -0400] kesor: GreatSUN: lwrps don't have any access to attributes at all
[2013-03-19 08:16:08 -0400] GreatSUN: kesor: but you can send attributes to lwrps
[2013-03-19 08:16:31 -0400] GreatSUN: and if the lwrp is loaded after the attributes are set it gets the values set
[2013-03-19 08:16:38 -0400] kesor: GreatSUN: you can send paramenters, not attributes
[2013-03-19 08:16:44 -0400] GreatSUN: that was what I was thinking about
[2013-03-19 08:16:51 -0400] kesor: parameters != attributes
[2013-03-19 08:16:55 -0400] GreatSUN: kesor: I know that this is different
[2013-03-19 08:17:12 -0400] GreatSUN: kesor: but you can send an attribute-value as parameter
[2013-03-19 08:17:16 -0400] GreatSUN: -value
[2013-03-19 08:17:20 -0400] GreatSUN: that was what I ment
[2013-03-19 08:17:43 -0400] kesor: yeah, but you need to make sure the attribute you use actually has a value  or else you are just passing a "nil"
[2013-03-19 08:18:14 -0400] GreatSUN: kesor: I know that, but anyways is that a point where the values are set?
[2013-03-19 08:18:33 -0400] GreatSUN: if not, a thought about it doesn't even make sense
[2013-03-19 08:19:08 -0400] kesor: say you have attributes in cookbook named AAA, and you want to set the same names in a cookbook named XXX but only if its not set already, right?
[2013-03-19 08:19:39 -0400] GreatSUN: kesor: the node-attributes get set by a ruby-script
[2013-03-19 08:19:52 -0400] GreatSUN: in AAA and XXX
[2013-03-19 08:19:55 -0400] kesor: what kind of ruby script?
[2013-03-19 08:20:07 -0400] kesor: how does a ruby script sets chef node attributes?
[2013-03-19 08:20:08 -0400] GreatSUN: kesor: currently it is a library
[2013-03-19 08:20:38 -0400] GreatSUN: kesor: it's just handling valuesets according to other values set
[2013-03-19 08:21:17 -0400] GreatSUN: kind of loading environments for different attribute-values
[2013-03-19 08:22:29 -0400] kesor: GreatSUN: sorry, i'm confused, not sure I can help :/
[2013-03-19 08:22:41 -0400] GreatSUN: kesor: I will try with an example
[2013-03-19 08:22:52 -0400] GreatSUN: I have some configuration sets
[2013-03-19 08:23:09 -0400] kesor: whats a configuration set?
[2013-03-19 08:23:24 -0400] GreatSUN: if attribute1 is blah, attribute2 is blubb and attribute3 is 12 then the according set of attributes gets set into node
[2013-03-19 08:24:04 -0400] kesor: ok, so you have some complex logic that accepts attributes as input and writes node attributes as its output.
[2013-03-19 08:24:17 -0400] GreatSUN: kind of, yeah
[2013-03-19 08:24:43 -0400] GreatSUN: at least this explanation meats somehow what is done :-)
[2013-03-19 08:25:31 -0400] GreatSUN: but since I need to do this in more than one cookbook, I need to ensure, that I can see the attribute-values from the other cookbook, cause they are dependant
[2013-03-19 08:25:39 -0400] kesor: problem with chef 10.x that during its work, it collects attributes from various cookbooks in a random order. then during the convergence these attributes are kinda merge together into one big blob and available for the actual code in the recipes that runs.
[2013-03-19 08:26:18 -0400] kesor: chef is not a script  it doesn't really help you do this kind of complex processing of state
[2013-03-19 08:28:26 -0400] GreatSUN: kesor: I know
[2013-03-19 08:28:49 -0400] GreatSUN: kesor: I was just wondering why the attributes are not available within the libs already
[2013-03-19 08:29:03 -0400] GreatSUN: cause I thought the attributes get merged before
[2013-03-19 08:29:07 -0400] kesor: lwrps can't see attributes, only recipes can.
[2013-03-19 08:29:14 -0400] kesor: well, and other attributes.
[2013-03-19 08:29:42 -0400] GreatSUN: kesor: I know that lwrps can't see attributes
[2013-03-19 08:30:09 -0400] GreatSUN: kesor: maybe a ruby_block is the solution
[2013-03-19 08:30:29 -0400] kesor: ruby_block creates a disconnected context of ruby  how can that actually help? :/
[2013-03-19 08:30:41 -0400] GreatSUN: yeah, right
[2013-03-19 08:30:49 -0400] GreatSUN: :-(
[2013-03-19 08:31:19 -0400] GreatSUN: maybe if I put the code into a recipe instead of into a lib
[2013-03-19 08:31:24 -0400] GreatSUN: what do you think?
[2013-03-19 08:35:54 -0400] kesor: would certainly make it easier.
[2013-03-19 08:36:04 -0400] kesor: since then you more or less know how it behaves.
[2013-03-19 08:39:50 -0400] linuxboy: hi all
[2013-03-19 08:40:03 -0400] linuxboy: in a recipe can I make something 'notify' an include_recipe?
[2013-03-19 08:59:10 -0400] GreatSUN: hey guys
[2013-03-19 08:59:33 -0400] GreatSUN: is it possible to define a method within a recipe that can be called by other recipe/cookbook?
[2013-03-19 08:59:50 -0400] iroller: Trying to rename node with @jtimberman's script https://gist.github.com/jtimberman/1956556 and getting NoMethodError: undefined method `save' for #<Hash:0x007fec1c62df30>. Any ideas?
[2013-03-19 09:02:08 -0400] lumbendil: hi
[2013-03-19 09:02:41 -0400] lumbendil: anyone arround here uses vagrant and the apt opscode cookbook?
[2013-03-19 09:08:01 -0400] proppen: I'm looking to hammer out a work flow for an open source Chef server, from how Environments/Nodes/Data Bags/cookbooks etc is backed up/version controlled as well as management routines and
[2013-03-19 09:08:08 -0400] proppen: monitoring routines
[2013-03-19 09:08:55 -0400] proppen: is there something like a sysadmins guide to chef that I missed somewhere?
[2013-03-19 09:09:17 -0400] proppen: Chef 11 that is
[2013-03-19 09:26:40 -0400] alex_____: hey guys i have a question
[2013-03-19 09:27:04 -0400] alex_____: in one of my recipes in install the sed package
[2013-03-19 09:27:19 -0400] alex_____: and a few recipes later i want to use it
[2013-03-19 09:27:35 -0400] alex_____: the problem is that it doesn't work
[2013-03-19 09:27:51 -0400] alex_____: it couldnot find sed
[2013-03-19 09:41:26 -0400] ops: Hi guys, i have a problem with Chef 11.4.0. I add "include_recipe 'mysql::server'" in my cookbook, then i get "uninitialized constant Opscode::Mysql". Does anyone have an idea?
[2013-03-19 09:43:23 -0400] proppen: alex_____: are your paths correct?
[2013-03-19 09:45:47 -0400] ops: I only added "include_recipe 'mysql::server'" in the "recipes/default.rb". When i add recipe[mysql::server] to the run_list in my node file, it works.
[2013-03-19 09:49:31 -0400] proppen: ops: what happens if you also add include_recipe "mysql::client"
[2013-03-19 09:49:43 -0400] proppen: in default.rb
[2013-03-19 09:49:59 -0400] nacer: let's do some test-kitchen today
[2013-03-19 09:50:04 -0400] nacer: Yeah \o/
[2013-03-19 09:51:08 -0400] ops: Same error with "mysql::client" -> uninitialized constant Chef::Recipe::Opscode ->  /tmp/chef-solo/cookbooks/mysql/recipes/client.rb:20:in `from_file'
[2013-03-19 09:54:01 -0400] kesor: what could cause a PUT to a chef server of a backup for a file to fail with 403 Forbidden after several other files were putted there without problem?
[2013-03-19 09:54:40 -0400] nacer: kesor: size of the file ?
[2013-03-19 09:55:06 -0400] kesor: nacer: no, i see that its the "Saving the current state of node " in debug log.
[2013-03-19 09:55:16 -0400] kesor: think it might be to do with client.pem or something
[2013-03-19 09:55:28 -0400] nacer: ohh wait
[2013-03-19 09:55:39 -0400] nacer: did you delete this node recently ?
[2013-03-19 09:55:45 -0400] kesor: yep
[2013-03-19 09:56:02 -0400] kesor: and I might have deleted the client on the server, but left the client.pem on the node.
[2013-03-19 09:56:03 -0400] nacer: kesor: yeahh, i'am not sure if it's a bug or a feature
[2013-03-19 09:56:11 -0400] nacer: but save your node important json
[2013-03-19 09:56:11 -0400] kesor: think its a feature
[2013-03-19 09:56:20 -0400] alex_____: proppen: yes because when i run it a second time it works
[2013-03-19 09:56:20 -0400] nacer: delete the node
[2013-03-19 09:56:31 -0400] nacer: kesor: and put you saved json data in your node
[2013-03-19 09:57:03 -0400] kesor: i'll delete the client, and the client.pem, and will re-bootstrap it.
[2013-03-19 09:57:05 -0400] nacer: kesor: i think it;s a bug about link ACL between node data et node auth key
[2013-03-19 09:57:06 -0400] proppen: alex_____: so it works now? Or just every second time you run it?
[2013-03-19 09:57:37 -0400] nacer: kesor: fqdn is not the id of node
[2013-03-19 09:57:48 -0400] kesor: nacer: it is in my case
[2013-03-19 09:58:10 -0400] nacer: kesor: and i think Client have access to a node.id
[2013-03-19 09:58:33 -0400] nacer: kesor: in short delete your node and re-register
[2013-03-19 09:58:47 -0400] kesor: nacer: yes. only not the node, the client.
[2013-03-19 09:59:02 -0400] nacer: kesor: only the node should do it
[2013-03-19 09:59:13 -0400] kesor: only the client should do it. no reason to remove the node.
[2013-03-19 10:00:30 -0400] ops: Same error with "mysql::client" -> uninitialized constant Chef::Recipe::Opscode ->  /tmp/chef-solo/cookbooks/mysql/recipes/client.rb:20:in `from_file'
[2013-03-19 10:01:23 -0400] nacer: kesor: new client don't have access to old node data
[2013-03-19 10:01:31 -0400] kesor: nacer: sure it does.
[2013-03-19 10:01:38 -0400] kesor: nacer: I use that "feature" all the time.
[2013-03-19 10:01:41 -0400] ops: Same error with chef-postgresql https://github.com/coroutine/chef-postgresql/issues/10
[2013-03-19 10:01:55 -0400] nacer: kesor: it looks like it's the error you have
[2013-03-19 10:05:54 -0400] alex_____: proppen: every second time
[2013-03-19 10:06:08 -0400] alex_____: i guess my sed command runs in ruby
[2013-03-19 10:06:09 -0400] kernel_panik: hey guys! is possible installing chef using url -L https://www.opscode.com/chef/install.sh  set the version 10.24 ?
[2013-03-19 10:06:20 -0400] alex_____: and resources are handeld later i thnik
[2013-03-19 10:06:25 -0400] alex_____: think *
[2013-03-19 10:06:53 -0400] alex_____: kernel_pa you can modify the script
[2013-03-19 10:07:16 -0400] kernel_panik: ah ok
[2013-03-19 10:07:32 -0400] alex_____: just download it first :P
[2013-03-19 10:07:59 -0400] alex_____: ivanoats stop leaving and comming back all the time
[2013-03-19 10:11:26 -0400] kesor: kernel_panik: I think you can use something like --    curl -L https://www.opscode.com/chef/install.sh | sudo bash -- -v 10.24
[2013-03-19 10:11:42 -0400] kernel_panik: I try!
[2013-03-19 10:11:44 -0400] kernel_panik: thanks!
[2013-03-19 10:11:49 -0400] alex_____: The ruby_block resource is used to execute Ruby code during a Chef run. Ruby code in the ruby_block resource is evaluated with other resources during convergence, whereas Ruby code outside of a ruby_block resource is evaluated before other resources, as the recipe is compiled.
[2013-03-19 10:12:06 -0400] kesor: kernel_panik: anyway, that install.sh script accepts a "-v" parameter to set the version.
[2013-03-19 10:30:12 -0400] gyre007: what is the default user on Chef server ? I have just installed Erchef ...ie Chef 11 but can't seem to find user/passwd in docs :)
[2013-03-19 10:30:13 -0400] zts: ops: if you want to use include_recipe, you need to be sure that the cookbook is loaded on the node - one way to do that is to use 'depends' in your cookbook's metadata.rb
[2013-03-19 10:30:29 -0400] gyre007: ah
[2013-03-19 10:30:38 -0400] gyre007: its right on the title page :)
[2013-03-19 10:30:39 -0400] zts: ops: if you're using chef-solo, that behaviour changed in version 11 (before, chef-solo would load every cookbook it could see)
[2013-03-19 10:32:00 -0400] gyre007: btw...is Chef ever going to get a nice  facelift in WebUI ? UI looks like it was built in 70s
[2013-03-19 10:35:14 -0400] zts: gyre007: on the mailing list, Opscode said they were planning to drop the WebUI in open source chef 12... so I think it is for the community to build a nice webUI :)
[2013-03-19 10:35:41 -0400] gyre007: I see :)
[2013-03-19 10:35:54 -0400] gyre007: I'm sure some front end dude will do awesome job
[2013-03-19 10:37:30 -0400] zts: yeah, I could get as far as using Bootstrap, but I figure if I wait long enough then someone good will do it :)
[2013-03-19 10:39:42 -0400] gyre007: :)
[2013-03-19 10:41:18 -0400] gyre007: anyone here uses foodcritic ?
[2013-03-19 10:41:47 -0400] gyre007: I am getting a weird error on FC045...that I should set cookbook name in metadata
[2013-03-19 10:42:00 -0400] gyre007: the cookbook name is indeed set
[2013-03-19 10:42:18 -0400] gyre007: ivanoats: FIX YOUR CONNECTION
[2013-03-19 10:56:57 -0400] alex_____: gyre007: /ignore #chef joins quits fixes the problem for you :P
[2013-03-19 11:00:32 -0400] zts: that is pretty bad... but yeah, I had to turn off my filters to see it :)
[2013-03-19 11:03:21 -0400] alex_____: i did also put him in my filter
[2013-03-19 11:10:27 -0400] gyre007: with Vagrant 1.1 and on dropping rubygem support...Berkshelf might become unusable ?
[2013-03-19 11:30:08 -0400] kavi: hi, can anyone helpme, i getting error while logging in chef server webUI (error: We are sorry, But something went wrong)
[2013-03-19 12:11:15 -0400] gyre007: brilliant....channel operators are not here during Europe daily hours..
[2013-03-19 12:13:46 -0400] proppen: guys... how are you version controlling changes to chef configuration (ie Roles, Environments...)? Do you rely on sysops to check in their changes or can it be done automatically as changes are made (with both knife and in WebUI)?
[2013-03-19 12:14:14 -0400] teukka: gyre007: berkshelf is not compatible yet to be used as a vagrant 1.1 plugin, but you can use it standalone. it does not depend on vagrant gem any more
[2013-03-19 12:15:32 -0400] teukka: gyre007: support for vagrant 1.1 is coming, though: https://github.com/RiotGames/berkshelf/issues/416
[2013-03-19 12:15:41 -0400] gyre007: teukka: shame i can't use it as a vagrant plugin...let's home  Jamie et co. will addd support soon
[2013-03-19 12:15:45 -0400] gyre007: yeah
[2013-03-19 12:15:49 -0400] gyre007: i noticed that issue
[2013-03-19 12:17:05 -0400] teukka: gyre007: of course you can clumsily workaroud it runnin `berks install --path=cookbooks` manually and adding "cookbooks" to Vagrant config
[2013-03-19 12:17:58 -0400] pthread: anyone ever run into issues with execute/powershell saying it succeeds but seemingly not doing anything on windows?
[2013-03-19 12:40:51 -0400] Babar: nickel
[2013-03-19 12:41:14 -0400] Babar: sorry about that
[2013-03-19 12:53:01 -0400] denniswisnia: hey guys!
[2013-03-19 13:21:18 -0400] ekristen: anyone know where in the docs the information is about changing run_lists for a role in an environment
[2013-03-19 13:21:26 -0400] ekristen: I can't find anything in these new docs
[2013-03-19 13:22:24 -0400] hikeit: http://docs.opscode.com/chef/essentials_roles.html
[2013-03-19 13:22:31 -0400] hikeit: then look at the env_run_lists attribute
[2013-03-19 13:23:00 -0400] ekristen: hikeit: I should mention I need docs that only apply to .10 not .11
[2013-03-19 13:23:24 -0400] ekristen: is the env_run_lists valid for .10?
[2013-03-19 13:23:48 -0400] hikeit: ekristen: yes, that was added during the 0.9 to 0.10 major upgrade
[2013-03-19 13:24:00 -0400] ekristen: hikeit: sweet thanks
[2013-03-19 13:24:29 -0400] gellanium: hi. I have a strange problem when try config chef-server. When i try do "knife cookbook upload vim" (or another cookbook) i get an error about: ""ERROR: Failed to authenticate to http://IP:4000 as root with key /root/.chef/root.pem Response:  Failed to authenticate. Ensure that your client key is valid. "  But when i try connect to server using this key - all rigth."
[2013-03-19 13:27:28 -0400] denniswisnia: Is there any way to set the internal IP Adress?
[2013-03-19 13:27:31 -0400] denniswisnia: *address
[2013-03-19 13:28:06 -0400] denniswisnia: want to use the webnodes specially only use the internal address to communicate with the database
[2013-03-19 13:28:22 -0400] kesor: denniswisnia: in ec2?
[2013-03-19 13:28:40 -0400] denniswisnia: No, jet another cloud provider
[2013-03-19 13:28:53 -0400] kesor: denniswisnia: put the hostname of the database in your /etc/hosts ?
[2013-03-19 13:29:30 -0400] denniswisnia: yes, sure - thats the easyst way. But want to write the firewall rules and some other stuff with the internal ips
[2013-03-19 13:30:17 -0400] kesor: so?
[2013-03-19 13:31:53 -0400] denniswisnia: dont know how to tell chef in a cookbook "use the another one address" ;)
[2013-03-19 13:32:32 -0400] denniswisnia: for example in the application nginx cookbook:  server <%= node.attribute?('cloud') ? node['cloud']['local_ipv4'] : node['ipaddress'] %>
[2013-03-19 13:34:07 -0400] denniswisnia: or in the mysql cookbook: "default['mysql']['bind_address']               = attribute?('cloud') ? cloud['local_ipv4'] : ipaddress"
[2013-03-19 13:39:25 -0400] kesor: denniswisnia: you can override these attributes, or the nginx template file.
[2013-03-19 13:39:50 -0400] denniswisnia: yes, i know - but i dont want to override that
[2013-03-19 13:40:06 -0400] denniswisnia: i dont want to set it manually
[2013-03-19 13:43:47 -0400] denniswisnia: kesor: want to set it with the script. Or for Version 1 in the application cookbook :)
[2013-03-19 13:52:13 -0400] kesor: denniswisnia: wrapper cookbook, you can have "mycompanycookbook/attributes/default.rb" and set it as normal['mysql']['bind_address']='10.0.0.1' there.
[2013-03-19 13:52:52 -0400] denniswisnia: ah!
[2013-03-19 13:54:28 -0400] kesor: also if you are using application nginx_load_balancer in this cookbook, you can specify a custom template as a parameter in there.
[2013-03-19 14:05:34 -0400] s2r2: Dear chefs, I think I'm a little confused.  The documentation of the 'application' cookbook says that "recipes using configuration stored in the 'apps' data bag are fully removed and deprecated".  Some presentation from 2011, "Infrastructure Automation with Opscode Chef" still mentions having a "Application Data Bag Item" describe your infrastructure in a "data-driven" way.  Are two distinct things meant here?
[2013-03-19 14:06:00 -0400] Sgoettschkes: Hi
[2013-03-19 14:06:47 -0400] Sgoettschkes: I'm playing around with chef right now, having only an empty chef server and one workstation
[2013-03-19 14:06:58 -0400] Sgoettschkes: trying to upload or download with knife does not work at all
[2013-03-19 14:12:01 -0400] petecheslock: Sgoettschkes - are you getting some sort of error when you try?
[2013-03-19 14:12:34 -0400] w6fu: i've got a recipe that needs to install a gem, so I need build essential I thought you could put build_essential higher in the run_list to get it to run first?
[2013-03-19 14:12:42 -0400] w6fu: doesn't seem to be working is why I ask
[2013-03-19 14:12:46 -0400] w6fu:     "recipe[build-essential]", "recipe[install_gem]"
[2013-03-19 14:12:59 -0400] Sgoettschkes: yeah, when I try to upload my clone of apscode/chef-repo I get "ERROR: File remote/ is a directory while file remote/ is a regular file"
[2013-03-19 14:14:36 -0400] Sgoettschkes: I am not sure was the correct workflow is when starting with chef
[2013-03-19 14:14:40 -0400] Sgoettschkes: I set up the server
[2013-03-19 14:14:56 -0400] Sgoettschkes: then I set up my workstation, cloning the opscode sample repo
[2013-03-19 14:15:13 -0400] Sgoettschkes: and then I start writing my coobook?
[2013-03-19 14:15:35 -0400] petecheslock: Sgoettschkes - yea - i believe the chef-repo clone is empty - so there is nothing to actually upload in there
[2013-03-19 14:15:48 -0400] Sgoettschkes: this could be
[2013-03-19 14:16:08 -0400] Sgoettschkes: but I also have the problem that if I type `knife cookbook create main`
[2013-03-19 14:16:22 -0400] Sgoettschkes: it tries to create a cookbook at /var/chef
[2013-03-19 14:16:29 -0400] Sgoettschkes: instead inside of my current repo
[2013-03-19 14:16:33 -0400] knuckolls: w6fu: there's a special provision for having build essential run as early as possible in the chef run
[2013-03-19 14:16:37 -0400] knuckolls: w6fu: let me find it.
[2013-03-19 14:17:03 -0400] dfried: Which is the best cookbook for redis server? I see there are quite a few.
[2013-03-19 14:17:32 -0400] knuckolls: w6fu: https://github.com/opscode-cookbooks/build-essential read that readme, it'll tell you how to get it going at compile time
[2013-03-19 14:17:36 -0400] w6fu: knuckolls: thank you, as you can see it does "look" correct http://pastebin.com/zN2vbh9m
[2013-03-19 14:18:18 -0400] knuckolls: w6fu: i think what's happening there is that chef_gem is running at compile time, and the rest are at convergence time
[2013-03-19 14:18:29 -0400] knuckolls: there was an excellent excellent article about this the other day.
[2013-03-19 14:18:32 -0400] w6fu: right on, i will give that a go
[2013-03-19 14:18:33 -0400] knuckolls: hold on.
[2013-03-19 14:19:45 -0400] knuckolls: w6fu: http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-03-19 14:20:09 -0400] knuckolls: even having felt like an expert at that concept for well over a year now, i got something out of that article
[2013-03-19 14:22:10 -0400] Sgoettschkes: petecheslock: I created a cookbook with knife and added one package command to the recipes/default.rb, but the error stays the same when I try to upload
[2013-03-19 14:22:27 -0400] petecheslock: can you gist your command and result?
[2013-03-19 14:23:07 -0400] knuckolls: Sgoettschkes: do you have a line in your knife.rb that looks like this? cookbook_path             ["#{ENV['CHEF_DIR']}/cookbooks/"]
[2013-03-19 14:23:32 -0400] _dumfries: You'll obviously need the environment variable CHEF_DIR to be set.
[2013-03-19 14:24:05 -0400] knuckolls: or just don't use what i pasted verbatim. it takes a path.
[2013-03-19 14:27:32 -0400] w6fu: knuckolls: you've hit the nail on the head, that was exactly my issue. thank you.
[2013-03-19 14:27:43 -0400] knuckolls: :D
[2013-03-19 14:35:43 -0400] Sgoettschkes: knuckolls: Which knife.rb? The global one (~/.chef/knife.rb) or the chef-repo/.chef/knife.rb one?
[2013-03-19 14:36:25 -0400] dfried: Anyone have any suggestions for which redis cookbook to run? I'm having some issues with the Fewbytes redis2-cookbook
[2013-03-19 14:36:32 -0400] knuckolls: Sgoettschkes: whichever one knife picks up. i think it goes up the folder heirarchy from your pwd and looks for .chef/ folders with knife.rb in them
[2013-03-19 14:36:52 -0400] knuckolls: so if you're in chef-repo
[2013-03-19 14:36:54 -0400] knuckolls: use that
[2013-03-19 14:37:05 -0400] knuckolls: i ln -s my chef-repo/.chef to ~/.chef
[2013-03-19 14:37:11 -0400] knuckolls: so it's all the same.
[2013-03-19 14:37:49 -0400] Sgoettschkes: knuckolls: They both have no cookbook_path
[2013-03-19 14:39:53 -0400] Sgoettschkes: ok
[2013-03-19 14:40:00 -0400] Sgoettschkes: knuckolls Putting it there works
[2013-03-19 14:40:13 -0400] Sgoettschkes: now I get ERROR: Network Error: getaddrinfo: Name or service not known
[2013-03-19 14:42:22 -0400] Sgoettschkes: It tries to upload to https://Ubuntu-1204-precise-64-minimal:443
[2013-03-19 14:42:38 -0400] Sgoettschkes: but I have the chef_server_url defined
[2013-03-19 14:44:22 -0400] robelsner: Getting a 401 Unauthorized when my chef-client (on two different nodes, but no other nodes are affected) tries to do a PUT to save the current state of the node.  Chef 11.04, any one have any thoughts?
[2013-03-19 14:49:33 -0400] Sgoettschkes: Ok, by changing my hosts file it works. Question is why the server_url does not work. Anybody got any idea?
[2013-03-19 14:52:18 -0400] kamabe: does anyone know how to fix this error from the passenger_apache2 cookbook? => Could not find passenger (>= 0) amongst [] (Gem::LoadError)
[2013-03-19 14:52:45 -0400] kamabe: gem list will show passenger, so i'm not sure what the problem is
[2013-03-19 14:56:05 -0400] robelsner: kamabe are you doing a gem list as the same user as chef?
[2013-03-19 14:58:10 -0400] Sgoettschkes: any idea how I configure the chef-server so it returns the correct api endpoints?
[2013-03-19 14:59:10 -0400] Sgoettschkes: well, not endpoints, but base url
[2013-03-19 14:59:22 -0400] kamabe: robelsner: this is happening during the bootstrap, so i'm not positive what user chef runs as when it's starting up. root?
[2013-03-19 15:01:29 -0400] robelsner: kamabe: yes, I'm just curious if it's something with ruby environments, where with a shell ruby gets set up correctly and without ruby is using a different install
[2013-03-19 15:03:08 -0400] kamabe: robelsner: i did a gem list as root, and passenger showed up. i'm also installing ruby before the passenger_apache2 recipe gets run
[2013-03-19 15:04:20 -0400] awgross: kamabe: how do you install chef on the machine
[2013-03-19 15:06:55 -0400] serjs: Hi, i have chef recipe to manager users, and i have two cases, one is that i have some static users like ops and store account info (ssh keys, password, login, home dir) in data bag, and another case is clients with limited permissions on server they account details stored in attributes array. My question is: Can i generate random password for each limited user in attribute when users recipe run first time on server? Currently by default password attribute
[2013-03-19 15:06:55 -0400] serjs:  set as nil and some managers set random password manually.
[2013-03-19 15:07:29 -0400] kamabe: awgross: we use omnibus
[2013-03-19 15:07:51 -0400] awgross: kamabe: chef installs gems to a different place than you do on the command line
[2013-03-19 15:08:25 -0400] awgross: kamabe: check /opt/embedded/chef
[2013-03-19 15:08:34 -0400] awgross: kamabe: or maybe its /opt/chef/embedded
[2013-03-19 15:08:37 -0400] robelsner: Has anyone ever seen a 401 on a PUT request to save the node state?
[2013-03-19 15:08:54 -0400] awgross: either way, to install gem in to there and use it, you need to install it with the chef_gem provider, instead of the gem_package provider
[2013-03-19 15:11:59 -0400] kamabe: awgross: right, i know that. and at first, i thought maybe it wasn't finding the gem because it was using the embedded ruby, but the passenger-install-apache2-module is using the installed ruby in /usr/bin/ruby1.8, and that's where the error is thrown. also, i'm not trying to use the gem. this is just part of opscode's passenger_apache2 cookbook for just setting things up
[2013-03-19 15:12:21 -0400] kamabe: the actual gem files are where i expect them to be
[2013-03-19 15:13:29 -0400] awgross: kamabe: ahh i see, sorry, missed that part
[2013-03-19 15:15:04 -0400] awgross: kamabe: might be pull request time to update the cookbook to search for gems the same way that chef does
[2013-03-19 15:15:47 -0400] kamabe: awgross: what i don't understand is that this has worked for a few months with no issues. but recently we tried to make a new machine and our ruby recipe just started failing. i thought it was just a version issue since rubygems 2 just came out and we weren't specifying a version in our cookbook, but setting things back to the versions on the working machine hasn't solved the problem
[2013-03-19 15:17:59 -0400] awgross: kamabe: have those machines always had chef installed via omnibus?
[2013-03-19 15:18:04 -0400] Liquid--: Hey all, I just made changes on a nodes run list. The chef-server has made note of the changes. However, when I run chef-client on the server I doesn't seem to process the new run_list. Any ideas?
[2013-03-19 15:18:23 -0400] kamabe: awgross: yeah
[2013-03-19 15:18:44 -0400] awgross: kamabe: I know i occasionally see some machines that have artifacts that chef was never told to explicitly remove so they work fine, but when i spin up new machines i get errors
[2013-03-19 15:18:55 -0400] awgross: kamabe: same chef version and all?
[2013-03-19 15:19:37 -0400] kamabe: awgross: yeah, they're both using 10.16.2
[2013-03-19 15:19:59 -0400] awgross: kamabe: hmm
[2013-03-19 15:20:21 -0400] awgross: kamabe: something must have changed, did you change the version of the cookbook?
[2013-03-19 15:20:29 -0400] awgross: kamabe: maybe the previous version installed fine, but not the new one
[2013-03-19 15:21:49 -0400] kamabe: awgross: the cookbook hadn't been updated at all. it just stopped working. i have tried tons of other things, to see if they would fix the errors i'm getting, but everything i fix just causes another error. i'm just out of ideas of what to try
[2013-03-19 15:22:36 -0400] awgross: kamabe: really strange
[2013-03-19 15:23:00 -0400] awgross: can you link the github for the cookbook?
[2013-03-19 15:23:24 -0400] kamabe: awgross: the ruby one?
[2013-03-19 15:23:31 -0400] awgross: the failing one
[2013-03-19 15:24:09 -0400] hikeit: kamabe: between a few months ago and now there were a large number of ruby gems that were updated might be worth trying the install with 10.20.2+ instead of 10.16?
[2013-03-19 15:24:26 -0400] kamabe: awgross: this is what's failing, but i don't necessarily think it's what is causing the problem https://github.com/opscode-cookbooks/passenger_apache2
[2013-03-19 15:24:41 -0400] awgross: ok
[2013-03-19 15:25:12 -0400] robelsner: why would a chef client be able to run all of the cookbooks, and only fail when it tries to PUT its state?
[2013-03-19 15:25:29 -0400] kamabe: hikeit: yeah i might have to do that
[2013-03-19 15:27:00 -0400] hikeit: kamabe: do you have a stack trace?
[2013-03-19 15:27:58 -0400] awgross: robelsner: if it was a 401, that is unauthorized right?  it may have changed its client keys during the run and fails at the end
[2013-03-19 15:28:15 -0400] kamabe: hikeit: https://gist.github.com/kamabe/5197057
[2013-03-19 15:28:39 -0400] robelsner: awgross: I have reregistered the client
[2013-03-19 15:28:55 -0400] robelsner: multiple times, it only gets a 401 on the PUT to save node state
[2013-03-19 15:29:03 -0400] awgross: robelsner: odd, very odd
[2013-03-19 15:29:20 -0400] awgross: robelsner: are you on hosted chef or do you host your own
[2013-03-19 15:29:27 -0400] robelsner: Yes I am pretty confused, because aside from this last put, everything works fine
[2013-03-19 15:29:32 -0400] robelsner: awgross: self-hosted
[2013-03-19 15:30:02 -0400] hikeit: kamabe: when you run gem list as root, can you tell which ruby path it is looking at? /usr/local/lib/site_ruby/1.8 might not be the same rubygems as /usr/bin/gem is pointing to
[2013-03-19 15:30:08 -0400] awgross: robelsner: any more information you can get from your own chef server logs?
[2013-03-19 15:30:55 -0400] robelsner: awgross: i've looked at erchef's logs, and nginx and don't see anything
[2013-03-19 15:30:59 -0400] robelsner: other than the 401 for PUT
[2013-03-19 15:31:07 -0400] awgross: hmm
[2013-03-19 15:38:03 -0400] kamabe: hikeit: i can't tell with a gem list, but opening /usr/bin/gem shows that it's using /usr/bin/ruby1.8
[2013-03-19 15:39:28 -0400] hikeit: if you do a find for gem in /usr/local, is there another bin/gem in there somewhere?
[2013-03-19 15:44:02 -0400] Flex: hey guys, trying to install the flume cookbook using a site install but am receiving this error
[2013-03-19 15:44:31 -0400] Flex: ERROR: IOError: Cannot open or read /Users/josh/chef-repo/cookbooks/flume/metadata.rb!
[2013-03-19 15:49:56 -0400] robelsner: awgross: This is the only thing I can find: erchef@127.0.0.1 INFO req_id=kmyKEnSis6F3nCTxxDJ4GQ==; status=401; method=PUT; path=/nodes/aio01.dev.vw.wayin.us-t; user=aio01_dev_vw_wayin_us-t; msg={not_found,client}; req_time=5; rdbms_time=0; rdbms_count=2
[2013-03-19 15:50:58 -0400] robelsner: Flex do you have a metadata.rb file in that directory?
[2013-03-19 15:51:00 -0400] awgross: robelsner: definitely seems like something is happening with the client during the run itself so when it rereads the client info (keys etc) to put the node data, it fails
[2013-03-19 15:51:18 -0400] robelsner: awgross: hmm ok well I'll keep digging
[2013-03-19 15:51:24 -0400] Flex: no, I don't have the cookbook yet so there is no metadata.rb
[2013-03-19 15:51:37 -0400] awgross: robelsner: sorry, havent seen much like this myself, but I use hosted chef
[2013-03-19 15:51:55 -0400] kamabe: hikeit: nope. i did a locate bin/gem and there's just the embedded ruby gem and the installed ruby gem
[2013-03-19 15:52:06 -0400] robelsner: awgross: No worries, thanks for the attention.
[2013-03-19 16:25:17 -0400] jdelan: When I run the following, it states the fqdn attribute is not present...any ideas why?  It's there on the nodes of that role:  knife winrm "role:Primary" "chef-client"
[2013-03-19 16:25:41 -0400] siezer: jdelan your machine probably can't figure out what its hostname
[2013-03-19 16:25:45 -0400] siezer: er, fqdn is
[2013-03-19 16:25:49 -0400] siezer: hostname / hostname -f
[2013-03-19 16:26:17 -0400] siezer: try chucking the fqdn cookbook into your run_list =)
[2013-03-19 16:26:30 -0400] iamchrisf: Anyone know why fork might not work on chef 10.16.2 for chef-client, see here:  http://pastie.org/pastes/6628727/text ?  Or is this expected behavior? I've enabled fork as any versions past 10.16.2 seem to leak massive amounts of memory after a few hours, figured this might be the solution.
[2013-03-19 16:27:02 -0400] jdelan: will do, thanks
[2013-03-19 16:27:08 -0400] iamchrisf: Specifically I'm seeing memory leaks in 10.22.0 and 10.24.0
[2013-03-19 16:41:54 -0400] Flex: ERROR: Cookbook hadoop_cluster depends on cookbook tuning version >= 0.0.0,
[2013-03-19 16:41:55 -0400] Flex: ERROR: which is not currently being uploaded and cannot be found on the server.
[2013-03-19 16:42:06 -0400] Flex: wtf? is there even a tuning cookbook?
[2013-03-19 16:51:12 -0400] gyre007: in Chef 11...when I have an application cookbook and set some default attributes in it will they override defaults from library cookbook ? ie. library cookbook is a dependancy of application cookbook so it should be loaded before it right ?
[2013-03-19 16:53:15 -0400] faustroll: Flex: i see a tuning cookbook by infochimps on github
[2013-03-19 16:53:44 -0400] Flex: faustroll: ! :)
[2013-03-19 16:54:31 -0400] Flex: link faustroll?
[2013-03-19 16:55:49 -0400] Flex: hmm got it
[2013-03-19 16:56:51 -0400] faustroll: https://github.com/infochimps-labs/ironfan-pantry/tree/master/cookbooks/tuning
[2013-03-19 16:57:32 -0400] faustroll: Flex: infochimps has been reorganizing i gather
[2013-03-19 16:57:42 -0400] faustroll: see the above link
[2013-03-19 16:58:16 -0400] faustroll: or at least since I last checked
[2013-03-19 16:59:03 -0400] ajensen: howdy... if a recipe (like nginx::source) defines a cookbook_file (like mime.types) is there a way for me to override the file it uses? Or prevent that resource from rendering and insert my own?
[2013-03-19 17:01:46 -0400] cwj: ajensen: you might check out http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/ specifically the section on refactoring customization
[2013-03-19 17:02:14 -0400] cwj: before i saw that post i thought my "best" choice was forking every cookbook and modifying it to meet my needs
[2013-03-19 17:02:46 -0400] cwj: now i write wrapper cookbooks that use the #resources method to modify the behavior of another cookbook
[2013-03-19 17:03:10 -0400] ankits: how do you guys prefer working with roles and environments in chef-server?
[2013-03-19 17:03:30 -0400] ankits: via the web console or through local version control and uploading the updated files?
[2013-03-19 17:04:07 -0400] KarlHungus: petecheslock: Self-extractible archive "chef-11.4.0_0.freebsd.9.1-RELEASE.sh" successfully created.
[2013-03-19 17:04:20 -0400] petecheslock: booyea
[2013-03-19 17:04:30 -0400] petecheslock: did you get around that one strange library trusting issue?
[2013-03-19 17:04:43 -0400] karmi: ajensen: check out http://dougireton.com/blog/2013/02/16/chef-cookbook-anti-patterns/
[2013-03-19 17:04:49 -0400] KarlHungus: petecheslock: i created a very quick knife-omnibus plugin to spin up the ami on ec2, build things, move the resulting packages, and terminate the instance
[2013-03-19 17:05:05 -0400] KarlHungus: petecheslock: hookinh that up to vagrant would be more ideal, but that can be step 2
[2013-03-19 17:05:20 -0400] scraplab: quick question: is there a minimum RAM requirement for chef-server?
[2013-03-19 17:05:21 -0400] gyre007: ankits: try to avoid modifying roles via web console...will bite you up your ass..
[2013-03-19 17:05:25 -0400] karmi: ajensen: the "Pattern: Create a wrapper cookbook with your custom recipes and attributes" section
[2013-03-19 17:05:41 -0400] petecheslock: KarlHungus yea - i was actually going that route inside vagrant.  Wanted to start with a somewhat vanilla freebsd box and use chef-solo to install all the Req's for building omnibus
[2013-03-19 17:05:44 -0400] scraplab: ie: if I was going to spin up an Ubuntu VM to try it on, how much RAM do I need?
[2013-03-19 17:05:48 -0400] petecheslock: first i need to document all the req's
[2013-03-19 17:05:51 -0400] cwj: karmi: thanks, thats the one i meant to link but couldn't find
[2013-03-19 17:05:51 -0400] KarlHungus: a few more commits and i'll push the plugin up to github. it contains the required bits to set up the chef server
[2013-03-19 17:05:59 -0400] KarlHungus: err. build server, not chef server
[2013-03-19 17:06:25 -0400] KarlHungus: petecheslock: i can move the node setup to a cookbook and provision with chef-solo. good idea and easy to implement
[2013-03-19 17:06:33 -0400] nkrinner: scraplab, i had problems when running the chef-server vm with 512mb ram - with 1024mb and little load it was fine
[2013-03-19 17:06:40 -0400] ajensen: i see, so you can modify resources via `resources`. ok that's helpful. I also came across this: https://github.com/bryanwb/chef-rewind
[2013-03-19 17:06:48 -0400] ajensen: maybe a heavy weight alternative to a simple thing though
[2013-03-19 17:06:52 -0400] scraplab: nkrinner: thanks!
[2013-03-19 17:07:06 -0400] KarlHungus: give me another hour or so to get that working and i'll push it so you can have a look
[2013-03-19 17:07:10 -0400] ajensen: though it was in teh post karmi suggested apparently.
[2013-03-19 17:07:34 -0400] KarlHungus: petecheslock: i forgot i'd added a patch to the ruby build to simply disable libexecinfo on *bsd
[2013-03-19 17:07:48 -0400] cwj: ajensen: yeah, i havent tried chef-rewind but i am not clear on why it would be better to use that as compared to modifying the resources themselves
[2013-03-19 17:07:53 -0400] KarlHungus: afaict, chef (client, anyhow) isn't using it at all
[2013-03-19 17:08:03 -0400] petecheslock: KarlHungus - awesome sounds great.  let me know when you push and i can see how it goes
[2013-03-19 17:08:15 -0400] ajensen: cwj: looks like it just gives you the dsl syntax... other than that it's probably the same.
[2013-03-19 17:08:16 -0400] petecheslock: going to rebuild my local freebsd vagrant boxes and take  nodes along the way
[2013-03-19 17:08:35 -0400] KarlHungus: petecheslock: did you plan on using the self-extracting .sh archives for install?
[2013-03-19 17:08:44 -0400] petecheslock: yea - that was my plan
[2013-03-19 17:08:47 -0400] KarlHungus: i suppose i should support that
[2013-03-19 17:08:57 -0400] KarlHungus: k, i'll ping you later this afternoon. cheers
[2013-03-19 17:09:01 -0400] petecheslock: although i ran into an odd issue on the md5 check
[2013-03-19 17:09:11 -0400] petecheslock: don't recall it offhand, but if i see it again i'll check it out
[2013-03-19 17:09:20 -0400] petecheslock: probably from my original hacked up build
[2013-03-19 17:09:28 -0400] KarlHungus: its just expecting the md5sum binary, not the bsd md5 binary, iirc
[2013-03-19 17:09:39 -0400] karmi: cwj: yeah, had trouble digging it out as well :)
[2013-03-19 17:10:10 -0400] petecheslock: KarlHungus - agh - yup i think you're right
[2013-03-19 17:10:19 -0400] petecheslock: i just set it to all zero's :D
[2013-03-19 17:16:33 -0400] ankits: gyre007, thanks for the headsup.  Would you mind sharing a scenario where that can happen?
[2013-03-19 17:17:23 -0400] gyre007: where can what happen ?
[2013-03-19 17:17:38 -0400] ankits: I am tyring to get a better understanding of "best practices" around chef-server.  Your reasoning will really help me understand other aspects as well.
[2013-03-19 17:17:57 -0400] ankits: where using web console for roles will bite me in the ass :-p
[2013-03-19 17:18:04 -0400] gyre007: well when you make changes via GUI then they are not versioned
[2013-03-19 17:18:11 -0400] gyre007: basically 10 people will make 20 changes
[2013-03-19 17:18:16 -0400] gyre007: and can breakj things
[2013-03-19 17:18:33 -0400] gyre007: how do you know what the working role was without proper source control versioning ?
[2013-03-19 17:18:41 -0400] gyre007: how do you know what changed when ?
[2013-03-19 17:18:51 -0400] gyre007: in the meantime your infra is broken
[2013-03-19 17:19:11 -0400] gyre007: and youre banging your head against a table trying to figure out what changed when and by whom...
[2013-03-19 17:19:40 -0400] ankits: hmm...gotcha...i guess at present, I am the only one making changes to the roles and stuff so hadn't considered what will happen when multiple people need to make changes
[2013-03-19 17:20:52 -0400] ankits: but that's a very good point.  Are there any gotchas for writing your own role in whatever text editor besides not having a UI?
[2013-03-19 17:23:18 -0400] lazyPower: Is there a good way to enhance your recipe's using librarian or berkshelf without blowing away your recipes first?
[2013-03-19 17:25:06 -0400] lazyPower: i ask because i have an existing open-source chef server running, and when i attempt to revise my cookbooks using librarian it wipes my cookbooks and just vanishes
[2013-03-19 17:25:12 -0400] lazyPower: leaving me to start over
[2013-03-19 17:27:03 -0400] KarlHungus: gyre007: to combat that, we're migrating all of our roles, envs, and unencrypted data bags over to jenkins and removing user access to upload them directly
[2013-03-19 17:27:39 -0400] gyre007: you should version them anyway KarlHungus ...proper dev practice
[2013-03-19 17:28:05 -0400] KarlHungus: gyre007: well, thats sort of a side effect of having jenkins manage them, right?
[2013-03-19 17:28:14 -0400] segv: gyre007, agreed.
[2013-03-19 17:28:22 -0400] segv: All mine are versioned according to commit
[2013-03-19 17:28:24 -0400] KarlHungus: jenkins just acts when the origin repo detects changed files in the path
[2013-03-19 17:28:33 -0400] segv: Just took forever to get my team on the same page.
[2013-03-19 17:29:14 -0400] KarlHungus: the only problem with that is encrypted data bags
[2013-03-19 17:31:37 -0400] miah_: hi
[2013-03-19 17:48:30 -0400] erthad: hiall
[2013-03-19 17:49:18 -0400] erthad: When I check the acls for a node via "knife acl show nodes foobar" I see the actor "pivotal" in the list. What is that about?
[2013-03-19 17:55:14 -0400] ankits: Is it possible to convert roles in chef-server web console in to ruby DSL?
[2013-03-19 17:58:31 -0400] miah: knife role show <role> > foo.rb
[2013-03-19 17:58:53 -0400] Sgoettschkes: Does anybody have a tutorial on how to configure the chef-server? When running `chef-server-ctl show-config` I see some wrong values (nginx url) but don't know how to change them
[2013-03-19 17:59:16 -0400] CharlieSu: Any anyone help me figure out why I can't upload cookbooks on this new chef server?  I can run every other knife command..  https://gist.github.com/CharlieSu/100037f4a47cc85ae397
[2013-03-19 17:59:49 -0400] Sgoettschkes: CharlieSu: try adding -V
[2013-03-19 17:59:58 -0400] Sgoettschkes: this will tell you which url it sends the data to
[2013-03-19 18:00:05 -0400] Sgoettschkes: I'm having the same problem right now
[2013-03-19 18:00:34 -0400] Sgoettschkes: it seems that on the chef-server the URLs are incorrect, so when knife is asking where to send the data it gets the wrong url
[2013-03-19 18:01:40 -0400] ankits: miah, thanks.  Is that the correct DSL as the output doesn't look like ruby code
[2013-03-19 18:02:33 -0400] zts: ankits: I didn't think you could... you can use "knife role show <role> -Fj" to get it in the JSON format though
[2013-03-19 18:02:37 -0400] CharlieSu: Sgoettschkes: looks like a Bookshelf setting..
[2013-03-19 18:02:45 -0400] miah: pretty much just drop the :'s. but I tend to store mine in json so i do -Fj
[2013-03-19 18:03:18 -0400] miah: i stopped using the ruby dsl within days of using chef and only use json
[2013-03-19 18:03:21 -0400] doomviking: CharlieSu: Sgoettschkes: smells like a hostname / fqdn / dns issue to me
[2013-03-19 18:03:32 -0400] miah: i an sitll programatically render my roles if i choose
[2013-03-19 18:04:03 -0400] Sgoettschkes: doomviking: I set the server url to point to an IP and knife works, but when it sends cookbooks it sends them to a Hostname which does not resolve
[2013-03-19 18:05:27 -0400] doomviking: Sgoettschkes: IIRC, chef-server is doing a hostname --fqdn for (I think) nginx config
[2013-03-19 18:05:41 -0400] segv: I am pretty sure as well doomviking
[2013-03-19 18:05:48 -0400] segv: I rewrote it for my own internal use though.
[2013-03-19 18:05:59 -0400] segv: Have an lwrp for site building
[2013-03-19 18:06:12 -0400] ankits: miah and zts thanks
[2013-03-19 18:06:49 -0400] Sgoettschkes: doomviking: Yeah, I see the "wrong" value when running `chef-server-ctl show-config` as nginx url
[2013-03-19 18:07:00 -0400] Sgoettschkes: doomviking: The question is how to change this value
[2013-03-19 18:07:06 -0400] segv: what does hostname -f show?
[2013-03-19 18:07:24 -0400] segv: Does your default route (listen ip) have a different fqdn in hosts?
[2013-03-19 18:07:25 -0400] doomviking: Sgoettschkes: I used a hammer by setting the hostname to the external DNS value
[2013-03-19 18:07:28 -0400] ankits: i guess I can just take the output and update it.  Hopefully it will take me most of the way there.  This is mostly a one time thing as I am thinking about switching to using knife instead of web-console for ongoing updates
[2013-03-19 18:07:37 -0400] Sgoettschkes: doomviking: that could work
[2013-03-19 18:07:44 -0400] doomviking: it does work
[2013-03-19 18:08:09 -0400] spox: doomviking: fwiw, there _are_ attributes you can set to force it to something different
[2013-03-19 18:08:18 -0400] spox: arguable if it's good practice :)
[2013-03-19 18:08:27 -0400] doomviking: spox: did not mean to imply that this is the best way to do it, just one way :)
[2013-03-19 18:08:50 -0400] awgross: anyone know of a good way to denote services in Chef so that I can search them?  Pondering a good way to do some lightweight service registration
[2013-03-19 18:09:12 -0400] spox: oh, doomviking sorry, i guess i meant for that to autocomplete to Sgoettschkes
[2013-03-19 18:09:22 -0400] spox: i wasn't following the backlog very well :P
[2013-03-19 18:09:42 -0400] doomviking: no worries
[2013-03-19 18:15:34 -0400] danielle_: Is the "release" branch the most stable in erchef?
[2013-03-19 18:17:40 -0400] rep0st: seems like spammers got to this page
[2013-03-19 18:17:41 -0400] rep0st: http://community.opscode.com/ideas/6
[2013-03-19 18:17:42 -0400] CharlieSu: Anyone know what this means?  Response: Invalid key 'service[elasticsearch]' for metadata.providing
[2013-03-19 18:23:57 -0400] scraplab: I'm having trouble getting a single environment in an otherwise brand new chef-repo to upload to my new chef-server. I'm getting "No such file or directory - /var/chef/cookbooks/var/chef (Errno::ENOENT)", but this is an OS X workstation, and everything is installed with Chef Omnibus
[2013-03-19 18:24:05 -0400] scraplab: any idea what I should be looking at next?
[2013-03-19 18:24:30 -0400] sunil_: trying to use a cron lwrp, which was working fine before but no longer able to use it, anyone know if cron lwrp had any major changes recently?
[2013-03-19 18:25:04 -0400] freezey: seeing something really funky.. i can run chef-client on the box and everything works as expected. However when chef-client runs from cron it bombs out on an ohai plugin and i am not sure why
[2013-03-19 18:27:01 -0400] rep0st: freezey: what ohai plugin?
[2013-03-19 18:27:25 -0400] eherot: So I have a chef server from which it is taking an *extremely* long time to download cookbook files.  CPU usage also appears to be very high.  Any idea on potential things to look into?
[2013-03-19 18:28:20 -0400] rep0st: eherot: look towards the typical culprit DNS resolutions. I had something similar and it turned out that my node was trying to resolve against DNS servers that were firewalled off.
[2013-03-19 18:28:39 -0400] freezey: rep0st: its a custom plugin
[2013-03-19 18:29:18 -0400] eherot: rep0st: i think I can rule that out because some other kinds of requests to the chef server (like POSTs) don't take as long.  Also many of these servers are in prod and use DNS all the time for lots of things.
[2013-03-19 18:29:52 -0400] eherot: Also haproxy on the chef server comes back with stuff like this:
[2013-03-19 18:29:52 -0400] eherot: [2013-03-19T13:29:28-05:00] DEBUG: HTTP 1.0 504 Gateway Time-out
[2013-03-19 18:30:54 -0400] freezey: eherot: whats the haproxy config look like?
[2013-03-19 18:32:02 -0400] eherot: really simple: http://pastebin.com/5qpQnUzr
[2013-03-19 18:32:07 -0400] freezey: rep0st: any ideas as far as why chef-client run from cron would be causing that?
[2013-03-19 18:32:20 -0400] freezey: eherot: and is that the process thats pegging the cpu?
[2013-03-19 18:32:52 -0400] eherot: chef-server (api) is pegging the cpu
[2013-03-19 18:33:35 -0400] freezey: might want to run it in debug
[2013-03-19 18:33:37 -0400] freezey: to see whats happening
[2013-03-19 18:33:44 -0400] freezey: sounds super odd
[2013-03-19 18:34:20 -0400] rep0st: freezey: nope. sounded like something similar to what happened to me. But it was the passwd ohai plugin. Bad data got entered into Active Directory that wasn't encoded properly and because of the ohai plugin it wouldn't finish the chef-run
[2013-03-19 18:34:34 -0400] CharlieSu: jtimberman:  I'm having issues uplaoding my elasticsearch cookbook to Chef Server 11..   Response: Invalid key 'service[elasticsearch]' for metadata.providing    I've removed that from my metadata.rb file.. any ideas?
[2013-03-19 18:35:05 -0400] freezey: yeah def not the case
[2013-03-19 18:37:22 -0400] sunil_: Anyone know if cron lwrp is now deprecated and we should only use cron_d ?
[2013-03-19 18:37:27 -0400] danielle_: Question: Is the "release" branch the most stable in erchef?
[2013-03-19 18:37:33 -0400] jtimberman: sunil_: what cron lwrp
[2013-03-19 18:38:02 -0400] jtimberman: CharlieSu: do yu have a metadata.json?
[2013-03-19 18:38:09 -0400] eherot: freezey: sooo much logging
[2013-03-19 18:38:35 -0400] freezey: lol
[2013-03-19 18:38:45 -0400] sunil_: jtimberman I am doing something like this using cron resource.
[2013-03-19 18:39:01 -0400] sunil_: https://support.cloud.engineyard.com/entries/21016333-Add-Cron-Jobs
[2013-03-19 18:39:16 -0400] sunil_: in specific   cron "task_name" do
[2013-03-19 18:39:25 -0400] eherot: freezy: it seems to sit on stuff like this for many seconds though: Sending HTTP Request via GET to localhost:5984/chef/_design/data_bags/_view/all_id
[2013-03-19 18:39:40 -0400] sunil_: but chef-client fails to write a cron file ..with an ext 1 and can't make out why, as I have been using this approach for a while with various cookbooks.
[2013-03-19 18:39:52 -0400] jtimberman: sunil_: there are two different resources for different purposes.
[2013-03-19 18:39:55 -0400] danielle_: Is the "release" branch the most stable in erchef?
[2013-03-19 18:40:04 -0400] jtimberman: sunil_: the 'cron' resource, built into core Chef, modifies the crontab.
[2013-03-19 18:40:12 -0400] sunil_: yes thats what I want
[2013-03-19 18:40:16 -0400] sunil_: but it won't work anymore
[2013-03-19 18:40:19 -0400] jtimberman: sunil_: the "cron_d" resource in the cron cookbook adds a new cron job in /etc/cron.d
[2013-03-19 18:40:38 -0400] jtimberman: won't work how?
[2013-03-19 18:40:42 -0400] jtimberman: what version of Chef?
[2013-03-19 18:40:49 -0400] jtimberman: do you have debug output from a Chef run?
[2013-03-19 18:40:59 -0400] miah: are you on EY? because if so, then its chef 0.6 =)
[2013-03-19 18:41:09 -0400] sunil_: Chef: 11.4.0
[2013-03-19 18:41:14 -0400] sunil_: yes I can paste you the debug output
[2013-03-19 18:41:17 -0400] miah: guh. why follow that doc then =)
[2013-03-19 18:41:19 -0400] danielle_: Is the "release" branch the most stable in erchef (chef11)?
[2013-03-19 18:42:32 -0400] eherot: freezey: this sort of makes it look like it's consuming all of that cpu even while doing nothing
[2013-03-19 18:42:35 -0400] eherot: or nothing that it's logging about
[2013-03-19 18:43:10 -0400] sunil_: jtimberman I think i figured out my issue
[2013-03-19 18:43:15 -0400] sunil_: trying a fix now
[2013-03-19 18:47:11 -0400] mml: does the chef-rvm system work these days? i'm having no end of trouble w/ it :/
[2013-03-19 18:47:56 -0400] danielle_: Is the "release" branch the most stable in erchef (chef11)?
[2013-03-19 18:48:07 -0400] vegardx: How do I solve or find out why chef for some reason things I have US-ASCII as encoding?
[2013-03-19 18:58:26 -0400] jtimberman: Chef Cookbook office hours: hangout: https://plus.google.com/hangouts/_/54d4fba0697eb7a62609a64297bf29b2503d147d youtube: http://youtu.be/NazDjrfK7gc
[2013-03-19 18:59:50 -0400] lazyPower: Oh nice! thats today?
[2013-03-19 19:00:49 -0400] eliklein: hola, i'm running into an attribute precedence problem and I'm hoping someone can shed some light on it :)
[2013-03-19 19:00:53 -0400] jtimberman: it's not hte "new user office hours" that Seth Vargo or Nathen Harvey have been running.
[2013-03-19 19:01:28 -0400] eliklein: so i have recipe A which depends on the java cookbook, I then have recipe B that depends on the java cookbook and sets some attributes (in the recipe) before including the java cookbook
[2013-03-19 19:01:44 -0400] eliklein: if i list recipe A before recipe B, the wrong (ie. the default) version of java is installed
[2013-03-19 19:02:05 -0400] eliklein: i'm using node.default['...'] in recipe b to set the attributes
[2013-03-19 19:02:52 -0400] eliklein: if I have recipe B listed before A, everything works fine
[2013-03-19 19:03:12 -0400] bluekelp: yfeldblum: loving librarian. thanks for the sales pitch last night
[2013-03-19 19:03:45 -0400] eliklein: my understanding is that recipe attributes are higher precedence than attribute files, so I'm confused.  I would expect that the attribute files would be overridden by the recipe attributes at resource collection time
[2013-03-19 19:03:57 -0400] CharlieSu: jtimberman: I do, but i've removed it and had it generate again..  same thing..
[2013-03-19 19:05:50 -0400] yfeldblum: bluekelp, happy to hear that, thanks!
[2013-03-19 19:09:58 -0400] bluekelp: yfeldblum: i was pleasantly surprised that you handled the :path case into a github repo. exceeded expectations and save me from brutal hacking something local
[2013-03-19 19:19:44 -0400] brendan6: I'm having some trouble install rbenv on Ubuntu 12.04.  I am getting the error FATAL: NameError: Cannot find a resource for rbenv_root on ubuntu version 12.04  Has anyone else run into this issue?
[2013-03-19 19:30:13 -0400] magoo_: jtimberman: do you have a moment to talk nagios?
[2013-03-19 19:33:19 -0400] vegardx: How would I go forward if I wanted to change attributes based on included recipes?
[2013-03-19 19:34:11 -0400] yfeldblum: bluekelp, heh .... actually, a couple years ago, there were only single repositories containing hundreds of cookbooks, including opscode's and 37signals' ... you sort of needed to have a way to look into a git repository to find the cookbook
[2013-03-19 19:35:33 -0400] beffbernard: I've deployed chef 11 to an AWS ec2 instance and it appeared to be working until I tried to upload a cookbook and it was redirecting to the internal hostname
[2013-03-19 19:36:37 -0400] beffbernard: even though I explicitly set node.default['fqdn'] = 'my.domain' in /etc/chef-server/chef-server.rb
[2013-03-19 19:36:45 -0400] beffbernard: any pointers would be most appreciated
[2013-03-19 19:38:33 -0400] yfeldblum: beffbernard, you may want: echo 'bookshelf["vip"] = node["ipaddress"]' >> /etc/chef-server/chef-server.rb
[2013-03-19 19:39:26 -0400] yfeldblum: beffbernard, also you should probably not be assigning node attributes from that file; you should probably only be assigning to the config object
[2013-03-19 19:40:06 -0400] beffbernard: yfeldblum: thanks mate
[2013-03-19 19:40:37 -0400] yfeldblum: beffbernard, the context in which /etc/chef-server/chef-server.rb is evaluated is: the class (not an instance of the class) defined here: https://github.com/opscode/omnibus-chef/blob/master/files/chef-server-cookbooks/chef-server/libraries/chef_server.rb
[2013-03-19 19:43:30 -0400] beffbernard: yfeldblum: where would the right place be to set the fqdn?
[2013-03-19 19:43:39 -0400] yfeldblum: beffbernard, in /etc/hostname
[2013-03-19 19:44:04 -0400] yfeldblum: beffbernard, the fqdn comes from ohai, which reads the fqdn from the system
[2013-03-19 19:45:18 -0400] yfeldblum: beffbernard, but you can also set api_fqdn in your /etc/chef-server/chef-server.rb and you can also set bookshelf["vip"] from that
[2013-03-19 19:45:25 -0400] yfeldblum: beffbernard, (i'm guessing)
[2013-03-19 19:45:46 -0400] yfeldblum: beffbernard, bookshelf is the internal service where cookbooks get uploaded to
[2013-03-19 19:48:08 -0400] Chris_Woods: Hey all, I'm having an issue with knife ssh returning 'No nodes returned from search!'.  I've tried adding '-a ipaddress' because the node doesn't have FQDN, but it still fails.  Is there something I might have missed during setup?
[2013-03-19 19:52:44 -0400] clundquist: should, https://github.com/miah/chef-redis/pull/26/files#L7R64 and https://github.com/miah/chef-redis/pull/26/files#L13R5 trigger, http://acrmp.github.com/foodcritic/#FC034 ? I feel like I am missing something
[2013-03-19 19:53:57 -0400] bluekelp: Chris_Woods: if you run the search string in "knife search" do you get results? my fqdn's aren't reachable from my workstation but i'm still able to knife ssh to them so i don't think that's it
[2013-03-19 19:56:57 -0400] Chris_Woods: bluekelp: No, knife search failes also.  knife node list shows them, however, and knife node show displays it correctly.
[2013-03-19 19:57:30 -0400] Chris_Woods: All the nodes are on a cloud service, and it looks like the ip chef has for them is the one from behind their firewall, instead of the outward facing ip.  Could that cause the issue?
[2013-03-19 19:57:47 -0400] bluekelp: so it's probably just an error in the search string. i've had issues especially with booleans and negation. reordering the search until it works generally works for me
[2013-03-19 19:58:32 -0400] Chris_Woods: hmm, the search is just 'knife search name:<node_name>'.  I've tried to keep it as simple as possible.
[2013-03-19 19:58:45 -0400] bluekelp: Chris_Woods: that could be. if you're not able to ssh to the IP shown for the node.  but the error string you reported is a search issue.  ip access to the box is another issue
[2013-03-19 19:59:35 -0400] bluekelp: yeah that's about as basic as they come.  if that doesn't work you have something else going on.  the node_name you're using is what "knife node list" shows, not the fqdn right?
[2013-03-19 20:00:59 -0400] gchristensen: has there been any experimentation with how Chef handles writing out thousands (upwards of 8,000) and converging them?
[2013-03-19 20:01:06 -0400] gchristensen: 8,000 files*
[2013-03-19 20:02:14 -0400] Chris_Woods: yeah, is for sure.  Is there a smart place to start debugging what might be wrong?  -VV doesn't seem to give me much to go on as to why the search returns 0 nodes.
[2013-03-19 20:03:19 -0400] vegardx: I'm seeing so many encoding issues lately? Am I the only one with these issues?
[2013-03-19 20:03:24 -0400] yfeldblum: Chris_Woods, you have to specify what kind of thing you're searching for: `knife search $TYPE $QUERY`
[2013-03-19 20:03:25 -0400] gyre007: is there any way how you can list all recipes from all nodes' expanded runlists ?
[2013-03-19 20:03:30 -0400] eherot: should I be suspicious that /var/lib/chef/search_index is empty?
[2013-03-19 20:04:32 -0400] yfeldblum: gyre007, that is the expanded run-list
[2013-03-19 20:04:50 -0400] gleam: sadly the expanded runlist is incorrect right now
[2013-03-19 20:04:51 -0400] gyre007: actually
[2013-03-19 20:04:51 -0400] gleam: in chef 11
[2013-03-19 20:04:59 -0400] Chris_Woods: yfeldblum: Do I have the syntax wrong?  It's not just 'knife search name:<node_name>'
[2013-03-19 20:05:17 -0400] gyre007: I want to see all cookbooks whose recipes are in expnded runlists
[2013-03-19 20:05:26 -0400] gyre007: some cookbooks are loaded in as dependencies and never used
[2013-03-19 20:05:53 -0400] gleam: node.recipes, but again it's incorrect right now in chef 11
[2013-03-19 20:06:35 -0400] yfeldblum: Chris_Woods, you want `knife search node name:<node_name>'
[2013-03-19 20:07:14 -0400] yfeldblum: gleam, chef-client 11 or chef-server 11, and what's wrong with it?
[2013-03-19 20:07:43 -0400] gleam: http://tickets.opscode.com/browse/CHEF-3906
[2013-03-19 20:07:45 -0400] gleam: server 11
[2013-03-19 20:07:51 -0400] gleam: it affects all clients
[2013-03-19 20:08:43 -0400] Chris_Woods: yfeldblum: Hmm, that still returns 0 results.  I'm positive I have the name of the node correct, though.  (It's what shows up in knife node list.)  Is there a change the user in my knife.db profile doesn't have sufficient authority to complete something like this?
[2013-03-19 20:10:28 -0400] yfeldblum: Chris_Woods, any special characters in the name?
[2013-03-19 20:11:10 -0400] Chris_Woods: yfeldblum: name is (without quotes) 'test-01.cloud' -- so, a - and a .
[2013-03-19 20:12:01 -0400] yfeldblum: Chris_Woods, that should work without quotes/escaping etc
[2013-03-19 20:12:13 -0400] yfeldblum: Chris_Woods, are the chef indexing services running and available?
[2013-03-19 20:12:20 -0400] skarufue: hello. we have been trying out chef for a while now. and quite liked it. now without any modification we know of our chef server throws a error when trying to login with webui/do anything wich requires authentification with knife. erchef spams its logfile with: http://pastie.org/6631665. tried to restart to no avail.
[2013-03-19 20:12:56 -0400] yfeldblum: Chris_Woods, is this your own chef-server or hosted-chef? and has the node test-01.cloud completed a first successful bootstrap run?
[2013-03-19 20:13:07 -0400] Chris_Woods: yfeldblum, that is a spectacular question.  I don't know.  :P  Is there an easy way to check?  I setup this server to try to learn chef, so I have admin to everything and it's just a playground.
[2013-03-19 20:13:35 -0400] yfeldblum: Chris_Woods, did you install chef-server or chef-client?
[2013-03-19 20:13:48 -0400] Chris_Woods: I did knife bootstrap test-01.cloud to centos6-gems.  I had to use a modified .erb instead of the distro because of a problem in ruby 2.0.0
[2013-03-19 20:14:56 -0400] Chris_Woods: yfeldblum: chef-server on the server, then bootstrapped the other centos machine for the client.  I ran into this trying to use knife ssh 'chef-client' on it.
[2013-03-19 20:17:37 -0400] skarufue: other maybe related errors in other chef-server services: http://pastie.org/6631736
[2013-03-19 20:19:13 -0400] awgross: anyone else having issues with installing Berkshelf 1.2.1 into Vagrant 1.1?
[2013-03-19 20:19:23 -0400] awgross: getting gem conflict issues in the embedded vagrant
[2013-03-19 20:22:57 -0400] bluekelp: Chris_Woods: i'm at a loss but yfeldblum might be onto something with the indexing service on server being wonky
[2013-03-19 20:23:21 -0400] bluekelp: Chris_Woods: for fun, does a "knife search name:test-01" work?
[2013-03-19 20:23:25 -0400] awgross: manually removing i18n-0.6.1 seems to let vagrant at least complete basic commands, ill see if berkshelf still works
[2013-03-19 20:25:07 -0400] Chris_Woods: bluekelp: No, that failes with 0 items found, unfortunately.  It sounds something could be wrong with the search.  Should I just download the source for knife and debug it?  I had hoped to avoid that, but I can't figure out how to get a reason for the failure.
[2013-03-19 20:25:08 -0400] awgross: aand it fails again
[2013-03-19 20:25:28 -0400] CharlieSu: Anyone having their EC2 instances removing their chef client and node on termination?
[2013-03-19 20:25:55 -0400] Chris_Woods: What's strange is knife node show and knife node edit work fine on the node, just searches fail.
[2013-03-19 20:26:21 -0400] bluekelp: Chris_Woods: it doesn't sound like a knife issue at this point.  it might be the server isn't doing search properly
[2013-03-19 20:27:08 -0400] bluekelp: CharlieSu: I have a script that kills the node/client from server before terminating the instance.  killing an instance shouldn't affect chef
[2013-03-19 20:28:15 -0400] jessicab: CharlieSu: most of the cloud plugins have a purge option with server delete thatll do that.. pretty sure ec2 has it
[2013-03-19 20:30:13 -0400] jessicab: Chris_Woods: searching is normally like 5 minutes or so behind i believe.. if youre on open source you could just force it to rebuild now, knife index rebuild
[2013-03-19 20:30:51 -0400] brendan6: I've been getting lots of undefined method [] for nil:NilClass.  I've read that chef has changed the way attributes work.  Could this be the cause?
[2013-03-19 20:31:57 -0400] hackenschmidt: howdy all. So when you enable a service, with the redhat provider, it calls chkconfig on, which ignores default levels set in the init script for the service. Currently I'm making a bash call to chkconfig and not using the enable action. Is there a chef way of specifying run levels?
[2013-03-19 20:33:03 -0400] yfeldblum: bluekelp, the command needs to be `knife search node name:test-01` (gotta have the "node" argument in there)
[2013-03-19 20:33:49 -0400] bluekelp: yfeldblum: it works for me w/o the node.  i've been trying to see how far i can push it b/c i never want to search anything but nodes.  but ymmv. or perhaps there's a gotcha waiting around the corner for me
[2013-03-19 20:34:02 -0400] awgross: looks like the newest version of vagrant has an issue when installing the newest version of berkshelf.  The activesupport gem installed by berkshelf requires i18n-0.6.1, while the latest Vagrant get i18n-0.6.4
[2013-03-19 20:34:19 -0400] gyre007: awgross: the guys are working on it
[2013-03-19 20:34:32 -0400] gyre007: looks like new Vagarnt broke plugin install in some way
[2013-03-19 20:34:41 -0400] bluekelp: jessicab: i learned two new tips from you just now.  thx
[2013-03-19 20:34:43 -0400] yfeldblum: bluekelp, interesting ... well, that didn't use to work
[2013-03-19 20:34:45 -0400] gyre007: the guys are talking to MitchelH ...so i've heard
[2013-03-19 20:34:48 -0400] yfeldblum: bluekelp, thanks!
[2013-03-19 20:35:23 -0400] bluekelp: yfeldblum: i saw it somewhere and was too noob to know it shouldn't work. but yeah according to tool help and other sources, it shouldn't
[2013-03-19 20:35:31 -0400] async_io: anybody ever try to use ironfan pantry cookbooks with spiceweasel?
[2013-03-19 20:36:00 -0400] awgross: gyre007: yeah just figured it out, vagrant sets a loose constraint while active support sets a precise constraint.  Vagrant floats with the newest i18n version (0.6.4) using ~> 0.6.0, active support is a hard =
[2013-03-19 20:37:13 -0400] awgross: thanks gyre007
[2013-03-19 20:37:34 -0400] awgross: gyre007: simple solution is to just roll back to 1.2.0?
[2013-03-19 20:37:44 -0400] hackenschmidt: anyone know of how to specify run levels for a service with in chef?
[2013-03-19 20:38:42 -0400] skarufue: ok. fixed the problem myself. for some reason chef-server-ctl restart|stop|kill had 0 effect on the running instances of the services (yes i had required permissions....) so i had to kill them the -9 way... so wierd. now its all good again.
[2013-03-19 20:39:29 -0400] awgross: gyre007: err 1.1.1?
[2013-03-19 20:39:47 -0400] bluekelp: Chris_Woods: any luck rebuilding the index? i'm curious to see if that works.  (learning vicariously)
[2013-03-19 20:40:20 -0400] gyre007: awgross: 1.1.*
[2013-03-19 20:40:34 -0400] gyre007: you mean Vagrant right
[2013-03-19 20:40:35 -0400] skarufue: i like how the blog mentioned in the freenode global notice is down. i wonder why that is...
[2013-03-19 20:40:45 -0400] awgross: gyre007: yeah, 1.1.2 is the broken version
[2013-03-19 20:40:57 -0400] Chris_Woods: bluekelp: Unforgettably, no.  I'm in chef 11, and knife claims it's been removed for version 11+.  I ran it anyhow, but it didn't seem to accomplish anything.
[2013-03-19 20:40:58 -0400] awgross: gyre007: is it 1.1.* that is broken?
[2013-03-19 20:41:12 -0400] Chris_Woods: * Unfortunately no.  Also unforgettable for me, though.  :P
[2013-03-19 20:41:23 -0400] jtimberman: magoo_: yo, whats up? (nagios)
[2013-03-19 20:41:36 -0400] gyre007: awgross: yes from 1.1.* up...
[2013-03-19 20:41:49 -0400] awgross: well that puts a damper on my migration
[2013-03-19 20:42:00 -0400] awgross: ill jsut fix it locally for now and keep testing
[2013-03-19 20:45:02 -0400] bluekelp: Chris_Woods: any chance you can blow away and redo the chef-server?
[2013-03-19 20:45:51 -0400] Chris_Woods: bluekelp: Yeah, this is all just experimenting anyhow.  I used a template from a service (JoyEnt will just image you a chef server) and I'm beginning to wonder if their image isn't trustworthy.  What is the correct way to setup a chef server?  Or, at least, the least error prone.
[2013-03-19 20:46:17 -0400] gleam: omnibus
[2013-03-19 20:46:58 -0400] bluekelp: we rolled out own steps.  lemme see if i can find the doc my co-worker made
[2013-03-19 20:46:58 -0400] segv:  use omnibus ftlog
[2013-03-19 20:47:09 -0400] CharlieSu: jessicab: bluekelp:  I'd love to have the server run a script when it changes runlevels.  Something that removes the node and client right from the client itself..
[2013-03-19 20:47:10 -0400] segv: No steps required with omnibus
[2013-03-19 20:47:24 -0400] segv: except roll out "cloud"/bare metal server
[2013-03-19 20:47:41 -0400] segv: deb/rpm install, configure it with the steps on the site
[2013-03-19 20:48:03 -0400] segv: bam, you have a chef instance, login, create your admin user, then grab the client key, generate encrypted data bag secret
[2013-03-19 20:48:06 -0400] segv: and you're off to chefville
[2013-03-19 20:48:43 -0400] Chris_Woods: segv: What's the "encrypted databag secret"?  I don't remember doing anything like that.
[2013-03-19 20:48:55 -0400] segv: So you can create encrypted data bags.
[2013-03-19 20:49:06 -0400] jtimberman: jessicab: the indexing time varies. "usually" its under a minute, but depending on "unknown factors" (like, number of nodes converging across the service) it may take longer.
[2013-03-19 20:49:13 -0400] segv: If you don't use them, don't worry about it.
[2013-03-19 20:49:18 -0400] Chris_Woods: Any particular os I should favor?
[2013-03-19 20:49:27 -0400] segv: I use Ubuntu LTS.
[2013-03-19 20:49:43 -0400] segv: But RHEL/CentOS should be fine, anyone here in the community have any objections?
[2013-03-19 20:49:54 -0400] jtimberman: for what?
[2013-03-19 20:50:02 -0400] jtimberman: running open source chef server?
[2013-03-19 20:50:03 -0400] paigeat: I don't understand something about the erchef source tree that fundamentally I would normally expect.... make rel builds it ... make install?
[2013-03-19 20:50:07 -0400] segv: jtimberman, yeah
[2013-03-19 20:50:09 -0400] DanR_e: I am using vagrant 1.1.0 to create a local virtualbox 4.2.10 VM and get it provisioned by chef cookbooks.  Some success, but also errors (e.g. apache2 fails badly using lucid32 box).  I am attempting to have chef install the R statistical package.   Several  recipes work well, but 'cookbook-r' (by Steven Danna, Opscode or former Opscode engineer) fails fatally with brief message "NameError:...
[2013-03-19 20:50:10 -0400] DanR_e: ...wrong constant name Cookbook-rPackage".  I need some hints as to where to look for the offending constant.  Details are pasted at https://gist.github.com/anonymous/5199681
[2013-03-19 20:50:11 -0400] jtimberman: RHEL / CentOS and Debian / Ubuntu are all supported platforms.
[2013-03-19 20:50:21 -0400] paigeat: cp -R rel/erchef/* / ?
[2013-03-19 20:50:23 -0400] paigeat: um
[2013-03-19 20:50:26 -0400] segv: jtimberman, that's what I thought.
[2013-03-19 20:50:26 -0400] paigeat: *shrug*
[2013-03-19 20:50:31 -0400] Chris_Woods: segv: I've been using CentOS for everything because I'm most familiar with it.  What OS should I pick from the dropdown for that?
[2013-03-19 20:50:34 -0400] segv: I just run ubuntu/debian so never looked into it.
[2013-03-19 20:50:41 -0400] jtimberman: Chris_Woods: "EL"
[2013-03-19 20:50:46 -0400] jtimberman: Chris_Woods: Or "Enterprise Linux"
[2013-03-19 20:50:48 -0400] bluekelp: Chris_Woods: i think this is what we followed http://harish11g.blogspot.com/2013/01/chef-server-installation-amazon-ec2.html
[2013-03-19 20:50:50 -0400] jtimberman: i forget what the dropdown has.
[2013-03-19 20:51:04 -0400] Chris_Woods: @jtimberman: Right, figured.  Just wanted to check.
[2013-03-19 20:51:05 -0400] jedsmith: jtimberman: that threw us, because though we know centos is pretty much RHEL, the download area doesn't make it clear that CentOS counts for Enterprise Linux
[2013-03-19 20:51:13 -0400] segv: jtimberman, "Enterprise Linux"
[2013-03-19 20:51:13 -0400] jtimberman: bluekelp: that uses the apt repository
[2013-03-19 20:51:19 -0400] jedsmith: might be worth a note there or something
[2013-03-19 20:51:36 -0400] segv: Chris_Woods, so "Enterprise Linux" version "6"
[2013-03-19 20:51:38 -0400] segv: (latest)
[2013-03-19 20:51:49 -0400] jtimberman: While I'm totally biased, I recommend this for getting a server up and running: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/
[2013-03-19 20:51:52 -0400] segv: https://opscode-omnitruck-release.s3.amazonaws.com/el/6/x86_64/chef-11.4.0-1.el6.x86_64.rpm
[2013-03-19 20:51:56 -0400] jtimberman: (biased as I wrote that post :))
[2013-03-19 20:52:06 -0400] Chris_Woods: Rodger.  Any reason to use 11.0.4 over 11.0.6?
[2013-03-19 20:52:13 -0400] jtimberman: Chris_Woods: use the latest.
[2013-03-19 20:52:18 -0400] jtimberman: there are security fixes
[2013-03-19 20:52:31 -0400] paigeat: jtimberman: this doesn't seem like it's trivial enough, should I not even bother with this I feel like I might be getting in to deep with trying to keep up (want to start working with chef 11 but 10 as far as just getting the source and working with it seems undercooked and I don't want to get stuck using a platform package again like I did originally with 10 and realize there was a better way ect) so
[2013-03-19 20:52:38 -0400] jtimberman: http://www.opscode.com/blog/2013/02/15/chef-server-11-0-6-and-10-24-0-released/
[2013-03-19 20:53:26 -0400] paigeat: like, I really really need to be able to git clone, git checkout release make rel and work with the build to be comfortable with this and I'm not sure...
[2013-03-19 20:53:59 -0400] segv: paigeat, with chef 11?
[2013-03-19 20:54:09 -0400] segv: mml, rvm :| NEVER.
[2013-03-19 20:54:10 -0400] paigeat: how now because it built but there's nothing but all this info about dpkg or rpm -ivh which .. lets pretend for a second that I don't have because I use LFS
[2013-03-19 20:54:13 -0400] paigeat: lol
[2013-03-19 20:54:20 -0400] mml: segv: getting there
[2013-03-19 20:54:36 -0400] paigeat: segv yep
[2013-03-19 20:54:43 -0400] segv: I am so over RVM I could if technology existed, erase it from existance.
[2013-03-19 20:54:53 -0400] paigeat: I can git clone the repo, I can get through the make rel, now what do I do
[2013-03-19 20:55:05 -0400] jtimberman: paigeat: i'm afraid i don't know much about the build system for the erlang bits.
[2013-03-19 20:55:16 -0400] paigeat: jtimberman: yikes
[2013-03-19 20:55:28 -0400] paigeat: well then
[2013-03-19 20:55:29 -0400] KarlHungus: jtimberman: who should i ping to talk about omnibus workflow?
[2013-03-19 20:55:44 -0400] jtimberman: KarlHungus: in what regard?
[2013-03-19 20:55:48 -0400] paigeat: oh hmmm just thought of something
[2013-03-19 20:55:53 -0400] jtimberman: like making the freebsd packages?
[2013-03-19 20:56:05 -0400] KarlHungus: jtimberman: packaging for freebsd is done and working great
[2013-03-19 20:56:08 -0400] jtimberman: paigeat: it definitely does :)
[2013-03-19 20:56:11 -0400] jtimberman: KarlHungus: sweet.
[2013-03-19 20:56:20 -0400] jtimberman: KarlHungus: paging btm_
[2013-03-19 20:56:28 -0400] jtimberman: or email chef-dev mailing list
[2013-03-19 20:56:41 -0400] KarlHungus: jtimberman: now i need to add the bits to the omnibus-chef packaging stuff so i can add fbsd to the build OS list
[2013-03-19 20:56:43 -0400] jtimberman: paigeat: but i haven't looked at all the things it does.
[2013-03-19 20:56:51 -0400] KarlHungus: it appears to be using vagrant for this
[2013-03-19 20:56:56 -0400] segv: KarlHungus, awesome
[2013-03-19 20:57:09 -0400] KarlHungus: but, 5 minutes with someone who uses it would save me several hours of diving through the sources
[2013-03-19 20:57:17 -0400] segv: I use freebsd for a lot of random shit, and that would be great to have :D
[2013-03-19 20:57:34 -0400] segv: uses vagrant?
[2013-03-19 20:57:37 -0400] segv: for builds?
[2013-03-19 20:57:39 -0400] KarlHungus: segv: we use it pretty much across the board, and have been on chef for a little over a year
[2013-03-19 20:57:51 -0400] paigeat: jtimberman: I'm duhing myself because I didn't even think to look and see if maybe there's a chef-server cookbook recipe now that probably does it there used to be one for gems, and whatever else there was I forgot
[2013-03-19 20:58:08 -0400] segv: KarlHungus, oh, i've been using chef in debian\/ubuntu/rhel/
[2013-03-19 20:58:15 -0400] segv: land for like almost 2 years now
[2013-03-19 20:58:17 -0400] eherot: Is it normal to see "Sending node(cdef3ce0-5fbb-4043-a754-ec1af586c734) to the index queue for addition" for for the same node dozens of times in the chef-server log?
[2013-03-19 20:58:20 -0400] segv: Just haven't ventured outside of that box
[2013-03-19 20:59:40 -0400] jtimberman: eherot: maybe?
[2013-03-19 20:59:40 -0400] KarlHungus: jtimberman: thanks, i'll ping btm_
[2013-03-19 20:59:53 -0400] jtimberman: eherot: every time a node saves, you get a message like that.
[2013-03-19 21:00:00 -0400] eherot: jtimberman: ahh ok
[2013-03-19 21:00:14 -0400] eherot: jtimberman: as in node.save
[2013-03-19 21:00:23 -0400] jtimberman: right
[2013-03-19 21:00:24 -0400] jtimberman: that's done at the end of the chef run by default
[2013-03-19 21:00:29 -0400] jtimberman: but you could always stick that in a recipe
[2013-03-19 21:00:49 -0400] eherot: jtimberman: I have in at least one place.others probably have too
[2013-03-19 21:01:02 -0400] miah: every time a node saves a kitten cries?
[2013-03-19 21:01:09 -0400] jtimberman: miah: no! :(
[2013-03-19 21:01:19 -0400] eherot: should that UUID appear in the node data somewhere?
[2013-03-19 21:01:33 -0400] miah: oh. ok. everytime a node saves a kitten is born!
[2013-03-19 21:02:31 -0400] jtimberman: eherot: i don't think so. is this chef 11?
[2013-03-19 21:02:41 -0400] eherot: jtimberman: no
[2013-03-19 21:02:45 -0400] eherot: 10.18.0
[2013-03-19 21:03:53 -0400] vegardx: Lately I've been seeing fuck-metric-ton of "Encoding::UndefinedConversionError:", but all my editors are UTF-8.
[2013-03-19 21:03:58 -0400] vegardx: Anyone had the same issue?
[2013-03-19 21:04:09 -0400] eherot: jtimberman: i'm trying to diagnose some extreme chef-server slowness and very high cpu usage.
[2013-03-19 21:09:07 -0400] segv: vegardx, I've not seen that error yet
[2013-03-19 21:09:28 -0400] miah: i havent seen that on eeither
[2013-03-19 21:09:49 -0400] paigeat: miah: sounds like a mess.
[2013-03-19 21:10:05 -0400] paigeat: or a memory leak
[2013-03-19 21:10:43 -0400] miah: vegardx: which ruby are you using?
[2013-03-19 21:10:45 -0400] paigeat: http://i.imgur.com/InxiqJ7.jpeg
[2013-03-19 21:10:49 -0400] paigeat: memory leak
[2013-03-19 21:10:55 -0400] vegardx: miah: 1.9
[2013-03-19 21:10:57 -0400] segv: hahaha
[2013-03-19 21:11:11 -0400] jtimberman: eherot: "depends"
[2013-03-19 21:11:47 -0400] eherot: jtimberman: ?
[2013-03-19 21:11:54 -0400] miah: vegardx: can you gist log output?
[2013-03-19 21:12:14 -0400] bluekelp: anyone know how to get an official sun java6 tarball?  they make it incredibly difficult to automate
[2013-03-19 21:12:28 -0400] miah: i wonder if its something being passed around in a recipe rather than anything to do with your editor
[2013-03-19 21:12:50 -0400] miah: bluekelp: download it and put it on a local file repository.
[2013-03-19 21:12:50 -0400] miah: you shouldn't rely on external third party resources in your infrastructure =)
[2013-03-19 21:13:11 -0400] Chris_Woods: jtimberman: Ran into a problem in 'chef-server-ctl reconfigure' -- it runs quite a bit of stuff, before failing with "Error executing action `run` on resource 'execute[verify-system-status]'"
[2013-03-19 21:13:13 -0400] miah: i put mine on S3 and then just reference that in my cooks
[2013-03-19 21:13:24 -0400] paigeat: holy fuck that is a serious can of worms
[2013-03-19 21:13:25 -0400] bluekelp: right but i'm about to hack the self-executing .bin file (shell script) b/c the java recipe wants a tarball
[2013-03-19 21:13:27 -0400] Chris_Woods: I think this centos install is really barebones.  Are there any dependant packages I should have first?
[2013-03-19 21:13:49 -0400] miah: ya. iirc. the bin outputs a rpm or tarball
[2013-03-19 21:13:52 -0400] jtimberman: eherot: as far as what could be causing high cpu use
[2013-03-19 21:13:54 -0400] bluekelp: Chris_Woods: yes - ubuntu or debian :)
[2013-03-19 21:14:09 -0400] eherot: jtimberman: Not even sure where to start
[2013-03-19 21:14:09 -0400] segv: bluekelp, the ombitruck packages supports rhel :p
[2013-03-19 21:14:11 -0400] jtimberman: bluekelp: have you tried opscode's java cookbook, oracle recipe?
[2013-03-19 21:14:12 -0400] bluekelp: miah: yeah that's what i'm hoping for
[2013-03-19 21:14:28 -0400] segv: nm
[2013-03-19 21:14:35 -0400] bluekelp: jtimberman: yes but the latest version requires local repo/url
[2013-03-19 21:14:38 -0400] jtimberman: eherot: usual suspects, top/ps/htop to find out what processes are consuming CPU, iostat/iowait etc.
[2013-03-19 21:14:49 -0400] bluekelp: gone is the "accept cookie" option afaict
[2013-03-19 21:15:10 -0400] miah: local mirror is more reliable anyways
[2013-03-19 21:15:19 -0400] paigeat: Ive been wanting to write clvm/cman/drbd/gfs2/ocfs2/iscsi/distcc cookbooks forever now
[2013-03-19 21:15:51 -0400] eherot: jtimberman: it's all chef-server/merb and couchdb (but mostly chef-server)
[2013-03-19 21:16:34 -0400] vegardx: miah: https://gist.github.com/vegardx/c600e58fc2374af58b8d
[2013-03-19 21:16:43 -0400] threesome: Hello! Question about organizing my workspace. In my main ~/workspace/ directory where I have all my projects, do I need to have at least 2? One chef-repo project which is my local copy of what will get uploaded to the chef server, as well as my actual project (e.g. Vagrant) that will use the cookbooks from my chef-repo project?
[2013-03-19 21:16:46 -0400] jtimberman: bluekelp: again? ffs. :(
[2013-03-19 21:17:06 -0400] jtimberman: bluekelp: there's an attribute you can set that should allow it to work
[2013-03-19 21:17:26 -0400] eherot: jtimberman: it's also verrrry slow to download cookbook files.
[2013-03-19 21:17:35 -0400] paigeat: vegardx: damn
[2013-03-19 21:17:41 -0400] paigeat: @ that gist
[2013-03-19 21:17:52 -0400] vegardx: damn what?
[2013-03-19 21:17:55 -0400] Mithrandir: vegardx: wheezy?
[2013-03-19 21:18:01 -0400] vegardx: Mithrandir: yup
[2013-03-19 21:18:05 -0400] paigeat: looks awesome
[2013-03-19 21:18:07 -0400] jtimberman: eherot: there's a number of factors. such as, what kind of system the server is running on, how many client converges over time interval, etc.
[2013-03-19 21:18:32 -0400] Mithrandir: vegardx: you shouldn't use node directly in the template, you will lose error reporting that way.
[2013-03-19 21:18:39 -0400] Mithrandir: pass in the values as variables.
[2013-03-19 21:19:18 -0400] bluekelp: jtimberman: ah, i didn't check the default attributes.  saw the check for =~ /example.com/ and thought that was default.  thx for questioning me into pushing further into source
[2013-03-19 21:19:59 -0400] paigeat: vegardx: Ive never used varnish, but its pretty attention grabbing
[2013-03-19 21:19:59 -0400] awgross: gyre007: unfortunately it seems that the gem conflict is not the only issue
[2013-03-19 21:20:24 -0400] Mithrandir: vegardx: what is the system default locale?  C?
[2013-03-19 21:20:30 -0400] jtimberman: bluekelp: i thought it was mentioned in the readme too
[2013-03-19 21:20:35 -0400] vegardx: en_US.UTF-8
[2013-03-19 21:20:37 -0400] paigeat: dude man fuck adderall xr my attention span goes to shit this time everyday especially after I eat
[2013-03-19 21:20:41 -0400] vegardx: Or so it reports.
[2013-03-19 21:20:53 -0400] vegardx: let me double check
[2013-03-19 21:21:56 -0400] bluekelp: jtimberman: yes it is but i was diagnosing something else in the source when it defaulted to openjdk and saw that - assumed wrongly the default was not setup to pull from sun directly.  my own damn fault
[2013-03-19 21:22:32 -0400] paigeat: I hate parrots
[2013-03-19 21:22:49 -0400] jtimberman: bluekelp: ah, at least now you have the right thing :D
[2013-03-19 21:23:00 -0400] paigeat: http://uk.answers.yahoo.com/question/index?qid=20120523142238AAOY5Ng
[2013-03-19 21:24:59 -0400] vegardx: Mithrandir: https://gist.github.com/vegardx/e177c2f67888029685be
[2013-03-19 21:25:00 -0400] bluekelp: moral of the story - never trust the source ;)
[2013-03-19 21:26:52 -0400] Mithrandir: vegardx: and if you log the output of execute locale in chef-client, what does it say?
[2013-03-19 21:28:33 -0400] capen: jtimberman: Do you know of any reason why the apache2 cookbook doesn't include node['apache']['version']?  It seems dead simple and makes me wonder if I'm missing context of why it may be omitted intentionally.
[2013-03-19 21:29:19 -0400] vegardx: Mithrandir: I'm not following
[2013-03-19 21:32:05 -0400] tigerjon: capen: I assume the answer to your question is in the code. The recipe uses your distro's package manager to install apache
[2013-03-19 21:33:23 -0400] tigerjon: capen: on https://github.com/opscode-cookbooks/apache2/blob/master/recipes/default.rb#L21 it references package name as provided by default attributes in case statement which can clearly be overwritten if you would like to install a specific package from your package manager
[2013-03-19 21:34:47 -0400] capen: tigerjon: yes, but that would always grab latest in the repo, you may want to lock the version so your web servers don't get out of sync on the version of apache.
[2013-03-19 21:35:24 -0400] tigerjon: capen: why couldn't you override with a version specific for your package manager?
[2013-03-19 21:35:57 -0400] tigerjon: capen: apt-install apache=X.X.X
[2013-03-19 21:36:20 -0400] tigerjon: capen: apt-get install apache2=x.x.x **
[2013-03-19 21:38:12 -0400] bluekelp: can a node's attributes be set with knife? is the "normal" key (which includes tags) when editing a node its attribute overrides?
[2013-03-19 21:38:16 -0400] eherot: is there a "recommended" version of couchdb to be using with chef server 10.18?
[2013-03-19 21:38:40 -0400] tigerjon: capen: although to avoid string interpolation you should use a version param on the package line http://docs.opscode.com/resource_package.html
[2013-03-19 21:38:43 -0400] capen: tigerjon: you can, and we do using the version attribute.  would prefer it in the community cookbook so we can leverage that with berks rather than having to fork and maintain our own.
[2013-03-19 21:38:54 -0400] Chris_Woods: when I run chef-server-ctl test, and it says (in green) things like "should respond with 200 and the updated role body", it's telling me that it did in fact respond with 200, not that it "should have, but didn't".  Correct?
[2013-03-19 21:39:12 -0400] tigerjon: capen: Have you tried doing a pull request to add the functionality?
[2013-03-19 21:39:52 -0400] capen: nope.  that was the plan, but that's also the genesis of my question.
[2013-03-19 21:41:14 -0400] tigerjon: capen: I don't see any reason it would be bad, maybe just most people don't write the recipes with the intent of locking things into versions like that. I would just add functionality that if someone wanted that lock in they could. Generally locked in versions in recipes mean that the recipe has to be updated in the same flow as the software release so just keep that in mind
[2013-03-19 21:43:32 -0400] tigerjon: capen: also keep in mind each distro has different packages for apache so it could be quite tedious to manage. Also keep in mind that because you use an old version of apache does not mean I want to ;-)
[2013-03-19 21:44:13 -0400] tigerjon: capen: in essence sometimes its better to fork, make your changes that fit your environment and use your version
[2013-03-19 21:44:29 -0400] capen: tigerjon: thanks, i'll get the ball rolling. the version would not be locked in the recipe, if it's nil, it takes on the same behavior as it not being specified at all.
[2013-03-19 22:00:42 -0400] jtimberman: capen: what would a version attribute mean?
[2013-03-19 22:02:59 -0400] jtimberman: we've generally only used that in places where we're downloading a source tarball (e.g., nginx cookbook)
[2013-03-19 22:03:02 -0400] tigerjon: jtimberman: he was referring to a package version of apache so that if he launches one server now and one in 6 months they don't get 2 different versions of apache if the version changed on his package manager
[2013-03-19 22:03:12 -0400] capen: jtimberman: for the apache package resource
[2013-03-19 22:03:40 -0400] segv: Just pin a version?
[2013-03-19 22:03:41 -0400] miah: certainly a good idea
[2013-03-19 22:04:11 -0400] jtimberman: well, e.g. on Debian-family and RHEL-family distros, you will have the same "version" other than patches for security issues and other bugs.
[2013-03-19 22:04:32 -0400] jtimberman: I'd imagine you keep the systems launched 6 months ago updated with the current release of the package?
[2013-03-19 22:04:44 -0400] eherot: jtimberman: any downside you know of to increasing the number of merb daemons to match the number of CPUs on the system?
[2013-03-19 22:04:51 -0400] eherot: with chef-server -c that is
[2013-03-19 22:04:56 -0400] jtimberman: eherot: you should do that.
[2013-03-19 22:04:58 -0400] jtimberman: :)
[2013-03-19 22:05:09 -0400] eherot: jtimberman: weird that it's not a property in the config file anywhere
[2013-03-19 22:05:10 -0400] tigerjon: jtimberman: you are reaching :-P
[2013-03-19 22:05:12 -0400] jtimberman: eherot: or rather the number of unicorn workers (or thin workers, whatever you're launching them with)
[2013-03-19 22:05:59 -0400] jtimberman: eherot: chef-server is just a merb/rack app, so it can run on whatever application container you want to use.
[2013-03-19 22:06:00 -0400] miah: i'd be careful with letting the package resource decide when to upgrade a package. packages often have post-install scripts that may restart or modify your service in some way. (it would suck to have mysql randomly restart on a chef run because of a software upgrade)
[2013-03-19 22:06:06 -0400] jtimberman: so you configure it at the application container level
[2013-03-19 22:06:12 -0400] jtimberman: rather than the chef server level
[2013-03-19 22:06:26 -0400] jtimberman: miah: yeah, i definitely don't condone that :)
[2013-03-19 22:06:34 -0400] eherot: jtimberman: aye
[2013-03-19 22:07:00 -0400] jtimberman: The "industry best practice" here is to run your own internally maintained package mirror that has the exact versions of the software you need for your entire stack.
[2013-03-19 22:07:06 -0400] miah: indeed
[2013-03-19 22:07:16 -0400] jtimberman: but that's not always realistic/pragmatic :)
[2013-03-19 22:07:18 -0400] capen: tigerjon: that's one scenario, but our instances are actually highly ephemeral.  let's say we deploy day 1 to dev, do testing, on day 2 the apache version has changed overnight and we don't catch we.  we deploy to prod and it's a diff version and introduces somethings we should have otherwise captured in a preprod environments.  of course, dates, etc, may
[2013-03-19 22:07:19 -0400] capen: not be to scale, but you get the gist.
[2013-03-19 22:07:47 -0400] miah: capen: so fork and fix the cookbook and make it allow users to specify the version via attribute
[2013-03-19 22:07:54 -0400] miah: or roll your own
[2013-03-19 22:07:58 -0400] jtimberman: capen: do version changes in apache's release for the same platform-version introduce incompatibilities with your application?
[2013-03-19 22:08:19 -0400] jmickle: capen: agreed but you need to take into account that your software needs to be updated for security purposes and generally your application should not be hit by an incompatibility of apache upgrade
[2013-03-19 22:08:20 -0400] miah: jtimberman: unlikely. but suits rarely understand anything vaguely technical :P
[2013-03-19 22:09:06 -0400] miah: software updates (including security) should still allow the user some sort of manual floodgate
[2013-03-19 22:09:13 -0400] paigeat: any idea why fastlog in erchef might be causing it to not start?
[2013-03-19 22:09:13 -0400] jmickle: jtimberman: I agree that a package repository is always good when you have 500 systems engineers and 1 person can be devoted to rolling packages all day. Although its unnecesarry
[2013-03-19 22:10:15 -0400] miah: 1 person? just have your CI roll packages :P
[2013-03-19 22:10:27 -0400] miah: wrap that in test and acceptance cases
[2013-03-19 22:11:01 -0400] maplebed: jtimberman: fyi the change to the nagios cookbook we talked about earlier today worked.  Sadly the change to the mongo cookbook didn't, but surrounding each template notifies line with a conditional did.
[2013-03-19 22:11:02 -0400] miah: otherwise how do you ever determine that a point release caused the problem
[2013-03-19 22:11:18 -0400] jmickle: miah: your devops person should generally be your ci/syseng/everything lol
[2013-03-19 22:11:42 -0400] miah: devops is a methodology. not a job title.
[2013-03-19 22:12:19 -0400] capen: jtimberman: not necessarily.  it's more of a consistency thing.  also, agree on a custom repo, but we also want to limit that somewhat based on additional overhead.  we try to only manage custom stuff when absolutely necessarily.
[2013-03-19 22:12:27 -0400] jmickle: and sysops are an archaic resource but it still exists :-P
[2013-03-19 22:12:57 -0400] miah: just saying. hiring somebody to 'devops' does not mean that you do devops
[2013-03-19 22:13:05 -0400] miah: your entire team should take part
[2013-03-19 22:13:16 -0400] pikesley: http://whatisdevops.com/
[2013-03-19 22:13:19 -0400] jmickle: no what it generally should mean is you should take the approach that you shouldn't hire someone who can't write code
[2013-03-19 22:13:40 -0400] miah: surely QA tests your app. but they should also probably make sure that the compenents of that app also work properly.
[2013-03-19 22:14:03 -0400] miah: they can help bless apache 1.1p1 vs 1.1p2
[2013-03-19 22:14:07 -0400] jmickle: hehehe
[2013-03-19 22:14:12 -0400] greenmoss: Is there an accepted "best practice" for wrapping cookbooks? For instance, if I have generic github cookbook "foo", would I make a new cookbook "local-foo" with the parts that should only exist locally?
[2013-03-19 22:14:15 -0400] miah: though this is what integration tests also help to prove
[2013-03-19 22:14:26 -0400] capen: jmickle: agree on the security aspect of upgrading, but we want to manage the consistency and roll in changes with the appropriate testing.  it's very easy to change a version in an override or other and redeploy.
[2013-03-19 22:14:48 -0400] jmickle: capen: I'm all for it i think you should do it, I'm just giving you the different scenarios
[2013-03-19 22:14:58 -0400] miah: downgrading package versions is less trivial =)
[2013-03-19 22:15:05 -0400] capen: miah: spot on.
[2013-03-19 22:15:10 -0400] capen: jmickle: appreciated
[2013-03-19 22:15:22 -0400] paigeat: parrotops
[2013-03-19 22:15:31 -0400] paigeat: "devops borat"
[2013-03-19 22:15:32 -0400] paigeat: ha
[2013-03-19 22:15:35 -0400] yfeldblum: capen, the netflix model, which works for ephemeral VMs, is to build images and only launch instances from prebuilt images
[2013-03-19 22:15:40 -0400] paigeat: https://twitter.com/DEVOPS_BORAT
[2013-03-19 22:16:38 -0400] yfeldblum: capen, that model isn't very chef-server friendly, but you can certainly do a lot of that with chef-solo
[2013-03-19 22:16:55 -0400] capen: yfeldblum: that's a much diff bag.  well aware of that model, but definitely not a path we're interested in right now.
[2013-03-19 22:17:00 -0400] miah: you should certainly pre-bake your instances as much as possible _if_ autoscaling is a requirement, or build time takes too long. but in many cases its tons of extra work to get a specific 'image' to load on various makes/models of hardware.
[2013-03-19 22:18:15 -0400] yfeldblum: miah, i suppose it's appropriate only to build an image from the same type of host that it will be launched on
[2013-03-19 22:18:27 -0400] capen: milage varies on pre-baked instances, but yes, build time is a hugh consideration for what we pre-bake vs not.
[2013-03-19 22:18:56 -0400] miah: yfeldblum: ya. its easier to do that if you have a limited number of host types
[2013-03-19 22:19:02 -0400] jmickle: btw who all is going to chef-conf
[2013-03-19 22:19:04 -0400] miah: some orgs don't have that :/
[2013-03-19 22:19:11 -0400] miah: i guess i'm going to chefconf
[2013-03-19 22:19:24 -0400] cwj: i'll be there
[2013-03-19 22:19:39 -0400] jtimberman: capen: you could make a site-specific cookbook that does something like, resources("package[apache2]").version "2.2.3.x.y.z"
[2013-03-19 22:19:49 -0400] jtimberman: jmickle: i am! :D
[2013-03-19 22:19:55 -0400] jtimberman: miah: aren't you *speaking*?
[2013-03-19 22:19:59 -0400] miah: jtimberman: yes :P
[2013-03-19 22:20:09 -0400] greenmoss: I suspect "vendoring" might be the term for what I'm trying to do, but I have not yet found a definition for that term that is entirely clear to me
[2013-03-19 22:20:11 -0400] capen: i will be there
[2013-03-19 22:20:31 -0400] miah: i'm almost ready to embarass myself more on stage
[2013-03-19 22:21:03 -0400] jtimberman: miah: \o/
[2013-03-19 22:21:07 -0400] jmickle: hehehe
[2013-03-19 22:21:14 -0400] jmickle: jtimberman: we will need to grab a beer
[2013-03-19 22:21:28 -0400] paigeat: where the hell do you report erchef bugs
[2013-03-19 22:21:34 -0400] miah: still have more work to do
[2013-03-19 22:21:35 -0400] jtimberman: paigeat: tickets.opscode.com
[2013-03-19 22:21:38 -0400] jtimberman: CHEF project
[2013-03-19 22:21:45 -0400] jtimberman: Chef Server component
[2013-03-19 22:21:46 -0400] paigeat: kk, sorry lol
[2013-03-19 22:21:48 -0400] jmickle: miah: what are you speaking on?
[2013-03-19 22:21:48 -0400] jtimberman: :)
[2013-03-19 22:21:54 -0400] capen: jtimberman: that's basically what we do now.  would you be interested in a pull request where we specify the version attribute that defaults to nil so the behavior essentially doesn't change as is stands today?
[2013-03-19 22:22:14 -0400] jmickle: miah: il be your guest speaker ;-P
[2013-03-19 22:22:27 -0400] jtimberman: capen: well, the thing is, do we start supporting that across every cookbook?
[2013-03-19 22:22:52 -0400] miah: resources / providers
[2013-03-19 22:23:08 -0400] jmickle: ah
[2013-03-19 22:24:01 -0400] paigeat: http://www.merriam-webster.com/dictionary/pedantic
[2013-03-19 22:24:15 -0400] superbenk: How can I install the chef debian package non-interactively?
[2013-03-19 22:24:26 -0400] paigeat: http://www.merriam-webster.com/dictionary/ostentatiously
[2013-03-19 22:24:29 -0400] superbenk: It uses debconf to ask for the Chef server (which I'm not using)
[2013-03-19 22:26:54 -0400] Chris_Woods: So I had to setup a new chef server, because the ocnfiguration on my last one was invalid.  The new server is on a different IP/Hostname.  Since I bootstrapped the nodes on my old server from my old server, do I need to rebuild those machines from scratch, or is there a way to attach them to this chef server?
[2013-03-19 22:27:35 -0400] jmickle: Chris_Woods: Ive done that in the past, it was simply just a matter of changing a couple attributes in the chef-client configs
[2013-03-19 22:27:53 -0400] jmickle: but if its entirely new
[2013-03-19 22:28:05 -0400] jmickle: Chris_Woods: you may have to re - bootstrap to get new certs and stuff
[2013-03-19 22:28:24 -0400] Chris_Woods: Yeah, probably just smarter to do that anyhow.  I was trying to lazily save myself like 10 minutes of work.
[2013-03-19 22:30:03 -0400] yfeldblum: Chris_Woods, if you lazily give yourself an extra 10 minutes of practice now, you'll save yourself days of hair-pulling when it counts :D
[2013-03-19 22:31:18 -0400] Chris_Woods: yfeldblum, but I'll never have that 10 minutes back!  NEVER!  I could have ended up meeting Angelina Jolie, falling in love, and running off to France together in those 10 minutes.  I'll never now now.  :(
[2013-03-19 22:32:15 -0400] TriangleIL: What is the best solution for handling web service end points which change during each deployment into EC2?  Do we hide them behind DNS or do we register them with a service somewhere or?
[2013-03-19 22:36:04 -0400] rteabeault: Looking at the docs I see the following regarding attribute merging
[2013-03-19 22:36:08 -0400] rteabeault: When an attribute is of the same type of data, such as a hash or an array, the contents are merged. This is true even with different levels of precedence, such as default and override attributes. If the attribute is of a different data type, it is overwritten at higher levels of precedence.
[2013-03-19 22:36:15 -0400] rteabeault: Is this still true?
[2013-03-19 22:36:38 -0400] bluekelp: Chris_Woods: i'm pretty sure the /etc/chef/client.pem will be invalid and you'll have to re-bootstrap the node.  but i've only tested re-bootstrapping a node, not (yet) switching server
[2013-03-19 22:37:02 -0400] bluekelp: well, not invalid, but the new chef-server won't recognize the client as being valid
[2013-03-19 22:37:20 -0400] Chris_Woods: bluekelp, I'm going the hig road and just reprovisioning the machine.  I'll let someone even more lazy then me figure out if there is a faster way.
[2013-03-19 22:37:37 -0400] ephess: I'm having a bit of trouble with cookbook naming, and am looking for some advice. 1) I've got some in house cookbooks that share the name of community cookbooks (tomcat, repository) and I had a few issues when moving to Berkshelf because of this. I'm wondering if it's bad practice to have cookbooks with the same name as community cookbooks? 2) If I need to fork a community cookbook what's the best approach? I read somewhere about wrapping community cookbooks, so I'
[2013-03-19 22:38:41 -0400] greenmoss: ephess: hah, I just asked that very same question not 15 minutes ago
[2013-03-19 22:38:52 -0400] bluekelp: ephess: are these cookbooks specific to your infra or could they be useful to others?
[2013-03-19 22:38:55 -0400] ephess: greenmoss: haha go figure.
[2013-03-19 22:39:14 -0400] ephess: bluekelp: very specific
[2013-03-19 22:39:23 -0400] bluekelp: ehershey: greenmoss: if you're just putting together things the way your org likes, i'd recommend namaspacing with org-name
[2013-03-19 22:39:48 -0400] miah: i typically name org based cookbooks '<org>_<cookbook>'
[2013-03-19 22:39:50 -0400] ephess: bluekelp: tomcat cookbook deploys a specific tomcat package that we use internally for example, rather than the distributions package
[2013-03-19 22:39:56 -0400] greenmoss: bluekelp, you mean like naming a cookbook "myorg_apache" and whatnot
[2013-03-19 22:40:23 -0400] greenmoss: that's the route I'm on right now, though I can't say I'm thrilled about it
[2013-03-19 22:40:51 -0400] ephess: greenmoss: was there any interesting discussion earlier I should go back and read?
[2013-03-19 22:41:05 -0400] greenmoss: I guess it's ok, I just hoped somebody would have come up with something better
[2013-03-19 22:41:08 -0400] bluekelp: greenmoss: yes.  if it's specific stuff i'd recommend not confusing the two.
[2013-03-19 22:41:42 -0400] greenmoss: somehow prefacing a bunch of coookbooks with "myorg_" and then using "include_recipe" seems kind of clumsy to me
[2013-03-19 22:41:43 -0400] bluekelp: i'm getting confused enough just having a bluekelp-roles::zookeeper and zookeeper[::default] recipes
[2013-03-19 22:41:45 -0400] greenmoss: maybe it's just me though
[2013-03-19 22:42:18 -0400] greenmoss: ephess: no discussion until now
[2013-03-19 22:42:31 -0400] bluekelp: greenmoss: http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-03-19 22:42:47 -0400] bluekelp: not sure how the community at large feels about this but i liked the idea of keeping our stuff separate
[2013-03-19 22:42:59 -0400] greenmoss: definitely
[2013-03-19 22:43:15 -0400] greenmoss: I want to be able to push improvements up to github, and accept improvements from others
[2013-03-19 22:43:30 -0400] greenmoss: but I also want to be able to make org-specific changes elegantly
[2013-03-19 22:43:44 -0400] bluekelp: well it depends if you're talking about improvements to the "core" recipe or your org's specifics
[2013-03-19 22:43:52 -0400] greenmoss: org specifics
[2013-03-19 22:44:16 -0400] greenmoss: for instance: use cookbook "foo", but also open up some firewall ports, and create a few local files
[2013-03-19 22:44:23 -0400] greenmoss: change some default attributes
[2013-03-19 22:44:30 -0400] rteabeault: It seems that if you have an array attribute specified twice with the same level of precedence it will merge the value of the arrays.  But if they are are different in precedence the one with the higher precedence will replace the lower one.  The docs seem to indicate that even if they are of different precedence they will be merged.
[2013-03-19 22:44:31 -0400] bluekelp: org specifics are unlikely to be that useful to others.  unless my understanding of "org specific" differs from yours
[2013-03-19 22:44:49 -0400] greenmoss: right, that's exactly the kind of stuff I would want to keep private
[2013-03-19 22:45:00 -0400] rteabeault: Does anyone know?
[2013-03-19 22:45:00 -0400] greenmoss: it's likely to be secret/proprietary anyway
[2013-03-19 22:45:49 -0400] bluekelp: e.g., we're pulling dependencies (zookeeper tarballs, sun jdks) local and so my org-specific recipe has those download paths and versions setup.  no one outside is going to really find much use in knowing where we stash these files in our local VPC
[2013-03-19 22:46:11 -0400] bluekelp: maybe we're saying the same thing then
[2013-03-19 22:47:18 -0400] greenmoss: yeah that's what I was thinking of doing
[2013-03-19 22:47:28 -0400] greenmoss: just that I don't really like the naming schema
[2013-03-19 22:47:33 -0400] jtnz: Hi, if I force an action during compilation (e.g. action :nothing .... end.run_action(:delete) ), will that make it only run once, during compilation?
[2013-03-19 22:47:35 -0400] greenmoss: little things, perhaps inconsequential :)
[2013-03-19 22:48:23 -0400] bluekelp: i also like applying jtimberman's suggesting (i think it was him) to have our roles *only* include a "role-recipe".  i'm redoing the roles to effect that change now
[2013-03-19 22:48:47 -0400] greenmoss: is there a url for that one?
[2013-03-19 22:48:54 -0400] ephess: that's a nice idea, i've been struggling with the versionless roles thing for a while now
[2013-03-19 22:48:54 -0400] greenmoss: I only use one role
[2013-03-19 22:49:36 -0400] greenmoss: it's the "everything that every host should do" role
[2013-03-19 22:50:07 -0400] bluekelp: ephess: yeah, it was almost about to bite me in the butt.  esp since i'm going to want to start versioning different clusters differently for roll-outs
[2013-03-19 22:50:08 -0400] greenmoss: I haven't found any problems with that approach for my setup
[2013-03-19 22:51:47 -0400] ephess: spose i'll have to get over my disgust then and rename my cookbooks to myorg_cookbook :/
[2013-03-19 22:52:25 -0400] greenmoss: yeah, it just seems "wrong" to have 20 or 30 cookbooks named "myorg_apache", "myorg_database", etc etc
[2013-03-19 22:52:53 -0400] ephess: I'm still at odds as to how much of the opscode cookbook to reuse as well
[2013-03-19 22:53:02 -0400] ephess: not all cookbooks are easily extensible..
[2013-03-19 22:53:10 -0400] ephess: suppose i'll have to address that on a case by case basis though
[2013-03-19 22:53:29 -0400] bluekelp: greenmoss: what's the alternative?  do you clone the other recipes and make your changes directly there?  not sure i understand how you're currently doing it
[2013-03-19 22:53:46 -0400] kesor: and different authors have different ideas about how to make a cookbook extensible it seems
[2013-03-19 22:54:28 -0400] greenmoss: bluekelp: I was hoping somebody smarter than me had thought up an alternative
[2013-03-19 22:55:24 -0400] greenmoss: I'm currently not using a lot of upstream cookbooks, so it hasn't been a problem
[2013-03-19 22:55:41 -0400] greenmoss: but I want to move toward upstream cookbooks
[2013-03-19 22:56:03 -0400] greenmoss: and factor out my org-specific stuff so I can push other in-house cookbooks upstream
[2013-03-19 22:56:37 -0400] greenmoss: first one of that effort: http://community.opscode.com/cookbooks/openfire
[2013-03-19 22:59:28 -0400] ephess: bluekelp: was the role-recipe mention in a blogpost or IRC? would like to read it if it was a blogpost.
[2013-03-19 22:59:45 -0400] greenmoss: I see it mentioned lower down in the devopsanywhere url
[2013-03-19 22:59:48 -0400] greenmoss: http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-03-19 23:00:21 -0400] greenmoss: in the comments "Roles that are basically nothing but a name and an attached run list are where its at"
[2013-03-19 23:00:33 -0400] greenmoss: which makes sense to me
[2013-03-19 23:00:44 -0400] greenmoss: and is what I'm doing with my roles :)
[2013-03-19 23:00:49 -0400] greenmoss: *role
[2013-03-19 23:01:01 -0400] bluekelp: ephess: irc.  to recap my understanding: have every role implementation be: "include_recipe 'org-role'" or "include_recipe 'org-roles::role'"
[2013-03-19 23:01:30 -0400] bluekelp: so then the roles can still be used but you don't have the same versioning issue with them being global
[2013-03-19 23:02:10 -0400] ephess: ah okay, so if you need role-level attributes then use a whole recipe as the role, otherwise use a roles cookbook of some sort?
[2013-03-19 23:02:18 -0400] ephess: *whole cookbook
[2013-03-19 23:02:32 -0400] bluekelp: like i said, i wasn't running into issues yet with roles but liked the concept.  the inability to version them differently for clusters/environments was something that bugged me though
[2013-03-19 23:03:01 -0400] greenmoss: bluekelp: did you look at environments too?
[2013-03-19 23:03:05 -0400] greenmoss: I haven't tried them yet
[2013-03-19 23:03:10 -0400] bluekelp: well i'm using an org-roles cookbook with role speific recipes - just to keep all the role stuff in one cb/place
[2013-03-19 23:03:39 -0400] bluekelp: greenmoss: yes but i'm still working on getting our prod cluster into chef.  then i'm doing to setup a QA cluster and lock prod verions
[2013-03-19 23:04:34 -0400] bluekelp: we're doing chef after the fact which is not the best way but at least we're  tackling it now and not two years from now when there's a 2 inch blanket of snow-flakes on the highway, so to speak
[2013-03-19 23:05:45 -0400] ephess: I appreciate the advice bluekelp, you've been really helpful. Thanks a lot. I'm going to grab some lunch then get started on renaming things :)
[2013-03-19 23:49:55 -0400] sascha_d: git, chef and empty directories.  How do you cope?
[2013-03-19 23:50:04 -0400] lumbendil: hi
[2013-03-19 23:51:05 -0400] lumbendil: anyone using vagrant with the opscode apt cookbook?
[2013-03-19 23:52:28 -0400] tomdzk: lumbendil: yep
[2013-03-19 23:52:47 -0400] lumbendil: I'm getting a weird error which I didn't have before
[2013-03-19 23:54:15 -0400] lumbendil: tomdzk, I'm getting the following error:
[2013-03-19 23:54:16 -0400] lumbendil: [2013-03-19T23:53:55+00:00] FATAL: Chef::Exceptions::Exec: package[update-notifier-common] (apt::default line 48) had an error: Chef::Exceptions::Exec: apt-get -q -y install update-notifier-common=0.119ubuntu8.5 returned 100, expected 0
[2013-03-19 23:55:40 -0400] tomdzk: lumbendil: anything else in the stacktrace ?
[2013-03-19 23:56:01 -0400] tomdzk: lumbendil: also generall the simplest way to debug these is to ssh into the vm and just run the command manually
[2013-03-19 23:56:12 -0400] tomdzk: that frequently gives you more info
[2013-03-19 23:57:08 -0400] lumbendil: tomdzk, not much more info in the log: http://pastebin.com/h3HqJDaS
[2013-03-19 23:57:50 -0400] lumbendil: tomdzk, seems like it won't run unless i run it with sudo
[2013-03-19 23:58:37 -0400] tomdzk: lumbendil: yes, apt-get needs sudo/root usually, but chef-solo runs as root so that should be fine
[2013-03-19 23:59:22 -0400] lumbendil: let's see if running it with sudo works well
