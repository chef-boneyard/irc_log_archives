[2013-03-08 00:25:05 -0500] qhartman: I've been using the spice gem to build a REST endpoint that returns information from my Chef server in a format that Rundeck likes
[2013-03-08 00:25:54 -0500] qhartman: But I've been running into trouble with Spice lately in that it is rather slow for large queries, and after updating chef to 10.24, it just completely fails to return information for a couple of my environments
[2013-03-08 00:26:01 -0500] qhartman: does anyone know of a good alternative?
[2013-03-08 00:26:21 -0500] qhartman: (I'm using Sinatra as the REST framework, if that matters)
[2013-03-08 00:30:37 -0500] spheromak: qhartman: ridley may get you what you need https://github.com/reset/ridley
[2013-03-08 00:31:45 -0500] qhartman: spheromak, That looks promising. I will give it a shot. Thanks for the pointer!
[2013-03-08 00:53:44 -0500] cbloss: is there a quickstart guide to get going with chef?
[2013-03-08 00:54:27 -0500] erratic: god I was just thinking a a year ago "this book seems awfully old"
[2013-03-08 00:54:44 -0500] erratic: its like the one orielly book that exists that is anything chef related
[2013-03-08 00:54:56 -0500] erratic: its like test driven infrastructure or something
[2013-03-08 00:55:24 -0500] erratic: but I finally got around to thumbing through it because I wanted to see what they were on about with cucumber
[2013-03-08 00:55:49 -0500] erratic: you can just download it off the pirate bay like I did
[2013-03-08 00:56:00 -0500] erratic: although I have a safari books online account if you wanna use it for a min
[2013-03-08 00:57:44 -0500] erratic: https://soundcloud.com/midland/midland-fact-mix-185-sept-2010
[2013-03-08 00:59:24 -0500] erratic: 35:18
[2013-03-08 00:59:32 -0500] erratic: ugh.
[2013-03-08 01:03:20 -0500] silk: erratic, given that the author is in the channel, is it really the best advice you've ever given?
[2013-03-08 01:03:25 -0500] locochris: How would I include a chef_gem in a library?
[2013-03-08 01:09:33 -0500] tmichael: have a cron entry with lots of special characters in my cron resource. can't seem to get it to pass. berkshelf keeps rejecting it as bad ruby. presumably this will thus cause chef to choke
[2013-03-08 01:09:42 -0500] tmichael:   command [ "$(date '+\%a')" = "Wed" ] script_name
[2013-03-08 01:10:02 -0500] tmichael: tried escaping pretty much everything there and still pukes
[2013-03-08 01:10:31 -0500] tmichael: wondering if i need to move the logic to my script, but this gets a bit confusing for others who see this entry
[2013-03-08 03:03:35 -0500] tmichael: thx spheromak for the assist on my cron/ruby escape character funkage
[2013-03-08 03:03:39 -0500] tmichael:   command %Q![ "$(date '+\\%a')" = "Wed" ] && #{script_file}!
[2013-03-08 03:03:51 -0500] tmichael: did the trick.  %Q is my new best friend
[2013-03-08 03:04:02 -0500] tmichael: gold star brother!  saved my arse.
[2013-03-08 03:04:04 -0500] spheromak: :P
[2013-03-08 03:08:20 -0500] spheromak: ok
[2013-03-08 03:08:22 -0500] spheromak: mt
[2013-03-08 03:09:29 -0500] werdnativ: I'd like to update my workstation to chef 11.4, but vagrant's dependency on net-ssh (2.2.2) keeps me locked at 11.0 wish there were a way to have exclusive Gemfile groups.
[2013-03-08 04:35:06 -0500] ozataman: hi all. when I add a role to a node's run_list, when are the required actions actually run?
[2013-03-08 04:35:28 -0500] ozataman: say I'm adding the mysql role to a running node - how do I actually get it to sync/run/execute the installation action?
[2013-03-08 04:40:48 -0500] werdnativ: ozataman: you can run sudo chef-client on the node, or if the chef-client recipe is added then it will cron update itself.
[2013-03-08 04:41:25 -0500] ozataman: werdnativ: I see. is there a way to auto-include the chef-client recipe on every new node?
[2013-03-08 04:42:19 -0500] werdnativ: ozataman: not really include it in a base role or recipe?
[2013-03-08 04:42:51 -0500] ozataman: werdnativ: yeah, I guess I will configure a base role in any case. and can I specify roles during bootstrap?
[2013-03-08 04:54:21 -0500] spheromak: ozataman: yea in the knife bootstrap you can specify a run_list
[2013-03-08 05:01:42 -0500] knuckolls: ozataman: the chef-client recipe can be configured to run as a daemon on your nodes. i have it running every 20 seconds, checking in with the chef server to see if there's anything new to do.
[2013-03-08 05:02:45 -0500] ozataman: knuckolls: that's great. is it a built-in recipe? which cookbook is it a part of?
[2013-03-08 05:03:08 -0500] knuckolls: ozataman: https://github.com/opscode-cookbooks/
[2013-03-08 05:03:20 -0500] knuckolls: ozataman: https://github.com/opscode-cookbooks/chef-client
[2013-03-08 05:03:41 -0500] knuckolls: ozataman: http://community.opscode.com/
[2013-03-08 05:03:50 -0500] aruntomar: knuckolls: r u pushing so many new changes that you need to run chef-client every 20 seconds?
[2013-03-08 05:04:31 -0500] knuckolls: aruntomar: no, but chef-client is quite lightweight. i just want to be able to push changes out to my infrastructure from my laptop and have them be picked up quickly
[2013-03-08 05:04:41 -0500] knuckolls: ozataman: http://community.opscode.com/cookbooks/chef-client
[2013-03-08 05:04:52 -0500] ozataman: knuckolls: yep, saw that - installing now
[2013-03-08 05:04:55 -0500] judd7: in a recipe, what's the equivalent of "knife node show 'my.node'"
[2013-03-08 05:04:57 -0500] spheromak: as long as your runtimes are < 20s and your chef-server can handle the load :d
[2013-03-08 05:05:11 -0500] spheromak: judd7:  do you want it formatted ?
[2013-03-08 05:05:16 -0500] aruntomar: knuckolls: chef-client is mostly pull based, but there are better ways to push things
[2013-03-08 05:05:21 -0500] judd7: a node object would be nice.
[2013-03-08 05:05:24 -0500] spheromak: judd7: i mean the node object ahs all the data
[2013-03-08 05:05:32 -0500] spheromak: and node is in recipe
[2013-03-08 05:05:52 -0500] judd7: Oh, I mean getting ANOTHER node, not my present node.. and without search. :)
[2013-03-08 05:06:05 -0500] spheromak: you can't
[2013-03-08 05:06:11 -0500] spheromak: gotta use search
[2013-03-08 05:06:14 -0500] knuckolls: aruntomar: i've had it working like this for about a year and a half. pull works very well. it means i only have to work with the chef server
[2013-03-08 05:06:14 -0500] judd7: sadface
[2013-03-08 05:06:42 -0500] knuckolls: spheromak: the chef client won't start a new run until the previous one is finished. it doesn't matter how long a run takes.
[2013-03-08 05:06:50 -0500] judd7: thanks spheromak
[2013-03-08 05:06:58 -0500] spheromak: knuckolls: but you will get a number of chef-clients waiting  :D
[2013-03-08 05:07:13 -0500] knuckolls: spheromak: nope, not as a daemon.
[2013-03-08 05:07:15 -0500] ssd7: Ohai chefs
[2013-03-08 05:07:20 -0500] spheromak: sure sure
[2013-03-08 05:08:10 -0500] ssd7: judd7: You don't /need/ search for that, but typically if you are designing to get a particular node you might want to rethink something.
[2013-03-08 05:08:11 -0500] aruntomar: knuckolls: as alternative, you could use knife ssh "role: <role name> -x <username> "chef-client"  or rundeck . it's good to have options :)
[2013-03-08 05:08:28 -0500] knuckolls: aruntomar: agreed. :)
[2013-03-08 05:08:40 -0500] judd7: ssd7 - i have the name of the node that I want from another attr
[2013-03-08 05:09:34 -0500] ssd7: some_node = Chef::Node.load('node_name')
[2013-03-08 05:09:45 -0500] judd7: hug
[2013-03-08 05:10:40 -0500] ssd7: :)
[2013-03-08 05:12:27 -0500] judd7: and while I'm on a tear - is node[:attr_name] deprecated in favor of node['attr_name'] ?  I seem to recall...
[2013-03-08 05:12:53 -0500] judd7: but it's past midnight in NYC.  so, i'm near braindead.
[2013-03-08 05:13:37 -0500] ssd7: judd7: Latter is indeed prefered now but I know of no plans to remove access via symbols in the near future.
[2013-03-08 05:13:41 -0500] aruntomar: anybody here using chef to deploy openstack?
[2013-03-08 05:13:55 -0500] judd7: aruntomar, yes.
[2013-03-08 05:13:57 -0500] spheromak: aruntomar: yarp
[2013-03-08 05:14:03 -0500] ssd7: aruntomar: Yes, I'm still on essex though
[2013-03-08 05:14:22 -0500] judd7: I'm hacking at the att-cloud cookbooks as we speak.
[2013-03-08 05:14:45 -0500] judd7: and I'm a crowbar hacker.
[2013-03-08 05:14:56 -0500] judd7: But I'm also half-asleep, so YMMV.
[2013-03-08 05:18:20 -0500] judd7: keep it hot.
[2013-03-08 05:19:51 -0500] aruntomar: judd7: ssd7 spheromak . k, great. so i download librarian, updated all the cookbooks, uploaded them using spiceweasel, as suggested in the docs by matt. i tried all in one role, modified the environment also, it fails to run. [2013-03-08T10:48:32+05:30] FATAL: RuntimeError: Can't find address on network nova for node
[2013-03-08 05:21:23 -0500] ssd7: aruntomar: Mind using gist or pastbin to give more of that log? Specifically the bits that show where that error is being generated.
[2013-03-08 05:21:40 -0500] aruntomar: ssd7: sure
[2013-03-08 05:21:46 -0500] judd7: can those recipes do it all with one NIC?
[2013-03-08 05:22:02 -0500] judd7: I thought I just read 2 nics.
[2013-03-08 05:24:58 -0500] aruntomar: ssd7: https://gist.github.com/aruntomar/5114382
[2013-03-08 05:26:50 -0500] judd7: osops? Aren't they using openstack-common now?
[2013-03-08 05:28:07 -0500] ssd7: aruntomar: Not familiar with these particular set of cookbooks (I'm on a pretty early version of these cookbooks), but I can take a look.
[2013-03-08 05:28:12 -0500] spheromak: rcb cooks are still using osops-utils
[2013-03-08 05:28:37 -0500] spheromak: but the openstack-common stuff is, imo, better
[2013-03-08 05:28:38 -0500] spheromak: :D
[2013-03-08 05:28:57 -0500] judd7: I've bene reading it very closely the past few days.  It's great stuff.
[2013-03-08 05:28:58 -0500] aruntomar: ssd7: i'm referring this https://github.com/mattray/openstack-chef-repo
[2013-03-08 05:29:03 -0500] spheromak: looks like you don't have an attrib set for your nova network. Ususlaly set in an env
[2013-03-08 05:29:25 -0500] spheromak: judd7: yes verry good example on how to write that sorta stuff for sure. and good test coverage
[2013-03-08 05:29:29 -0500] aruntomar: spheromak: yes, osops-utils are not there in the community repo. it was suggested to use librarian, so i did.
[2013-03-08 05:29:55 -0500] spheromak: aruntomar: thats old stuff. I would prob try to get the att-cloud or the rcb stacks up
[2013-03-08 05:30:17 -0500] spheromak: oh nvm
[2013-03-08 05:30:21 -0500] spheromak: matts new stuff!
[2013-03-08 05:30:28 -0500] spheromak: i was thinking that was openstack-cooks
[2013-03-08 05:30:48 -0500] spheromak: yea so thats based on the att stuff which was derived from the rcb stuff I think. :D
[2013-03-08 05:30:59 -0500] aruntomar: spheromak: is there any doc i can refer to
[2013-03-08 05:31:00 -0500] judd7: which was drived from the Dell stuff. :)
[2013-03-08 05:31:10 -0500] spheromak: aruntomar: so if you look at the environment files they call out the nova network .
[2013-03-08 05:31:13 -0500] spheromak: judd7: yea lol
[2013-03-08 05:31:50 -0500] spheromak: aruntomar: so you prob either dont have your node set into that environment
[2013-03-08 05:32:00 -0500] judd7: https://github.com/mattray/openstack-chef-repo/blob/master/environments/production.rb
[2013-03-08 05:32:03 -0500] spheromak: or you dont have that network on the node your trying to build
[2013-03-08 05:32:17 -0500] judd7: right about there ^ aruntomar
[2013-03-08 05:33:44 -0500] ssd7: Heh, yup, looks like spheromak and judd7 got there much faster than I did. :)
[2013-03-08 05:34:33 -0500] spheromak: ssd7: just familliar with the codebase and that particular error i think
[2013-03-08 05:34:59 -0500] aruntomar: spheromak: i'm using the correct environment. the documentation was incomplete as to how to use these cookbooks, so that's why i'm a bit confused. looks like, i'll have to setup the bridge and network before running the chef-client
[2013-03-08 07:15:06 -0500] jondavidjohn: I'm having issues with the yum cookbook (https://github.com/opscode-cookbooks/yum) a fully detailed example is here (http://pastie.org/private/sd9qltgzanlutge9f5nsa)
[2013-03-08 07:15:44 -0500] jondavidjohn: In short, the yum::ius recipe is failing because it depends on the yum::epel recipe which is not completing, although it seems like it is.
[2013-03-08 07:22:32 -0500] aruntomar: jondavidjohn: have you included the epel repo?
[2013-03-08 07:26:33 -0500] biswajit: Hi Masters
[2013-03-08 07:27:09 -0500] biswajit: I am new to chef. I dont know ruby scripting.
[2013-03-08 07:27:26 -0500] jondavidjohn: aruntomar: I believe so, you me the yum::epel recipe?
[2013-03-08 07:27:49 -0500] jondavidjohn: my run list goes "yum, yum::epel, yum::ius
[2013-03-08 07:27:55 -0500] aruntomar: jondavidjohn: yes
[2013-03-08 07:27:55 -0500] jondavidjohn: "
[2013-03-08 07:28:06 -0500] jondavidjohn: yes the output from that...
[2013-03-08 07:28:09 -0500] biswajit: can any body help me to get any tutorial for cookbook development
[2013-03-08 07:28:21 -0500] jondavidjohn: [2013-03-08T06:28:24+00:00] INFO: Processing yum_key[RPM-GPG-KEY-EPEL-6] action add (yum::epel line 22)
[2013-03-08 07:28:21 -0500] jondavidjohn: [2013-03-08T06:28:24+00:00] INFO: Processing yum_repository[epel] action add (yum::epel line 27)
[2013-03-08 07:28:34 -0500] aruntomar: biswajit: http://docs.opscode.com/
[2013-03-08 07:28:39 -0500] jondavidjohn: aruntomar: ^
[2013-03-08 07:29:06 -0500] aruntomar: jondavidjohn: so is it adding the epel repo to your system?
[2013-03-08 07:29:14 -0500] jondavidjohn: it doesn't seem to be
[2013-03-08 07:29:25 -0500] jondavidjohn: how would I check?
[2013-03-08 07:29:33 -0500] aruntomar: jondavidjohn: try with chef-client - debug
[2013-03-08 07:29:45 -0500] aruntomar: chef-client -l debug
[2013-03-08 07:30:39 -0500] aruntomar: jondavidjohn: what's ur chef client version?
[2013-03-08 07:30:48 -0500] jondavidjohn: 10.24
[2013-03-08 07:31:47 -0500] jondavidjohn: aruntomar: So what am I looking for in this debug output?
[2013-03-08 07:31:56 -0500] biswajit: Thanks aruntomar. do we have any specific ebook for cookbook development only?
[2013-03-08 07:32:06 -0500] aruntomar: jondavidjohn: upgrade it to the latest chef
[2013-03-08 07:32:14 -0500] aruntomar: 11.4
[2013-03-08 07:32:32 -0500] aruntomar: it gives a very good out of what resource was run or skipped and why ?
[2013-03-08 07:33:06 -0500] jondavidjohn: what if my chef server is 10?
[2013-03-08 07:33:29 -0500] jondavidjohn: Am I opening a whole new can of worms by going from 10 to 11?
[2013-03-08 07:36:05 -0500] aruntomar: jondavidjohn: ur server could be still 10 and updating the client to 11 will not impact that.
[2013-03-08 07:37:26 -0500] jondavidjohn: just my local client? or also the node's client?
[2013-03-08 07:38:18 -0500] aruntomar: jondavidjohn: node's client
[2013-03-08 07:38:43 -0500] jondavidjohn: is there a way to do that without re-bootstraping?
[2013-03-08 07:40:02 -0500] aruntomar: jondavidjohn: how did u deploy chef-client on the node?
[2013-03-08 07:40:32 -0500] jondavidjohn: just sshing into it at this point
[2013-03-08 07:40:48 -0500] jondavidjohn: and manually running 'chef-client'
[2013-03-08 07:41:13 -0500] aruntomar: jondavidjohn: i meant how did u install chef-client on the node
[2013-03-08 07:41:19 -0500] aruntomar: omnibus or rubygems
[2013-03-08 07:41:30 -0500] jondavidjohn: knife bootstrap
[2013-03-08 07:41:45 -0500] aruntomar: k, so that's omnibus package
[2013-03-08 07:41:57 -0500] aruntomar: it's puts everything needed by chef in /opt/chef
[2013-03-08 07:42:01 -0500] aruntomar: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-03-08 07:42:21 -0500] aruntomar: run this on node, it'll download the latest package from opscode and update it
[2013-03-08 07:42:50 -0500] aruntomar: run "chef-client -v" to confirm it
[2013-03-08 07:42:56 -0500] jondavidjohn: would I do the same for the chef server?
[2013-03-08 07:43:07 -0500] aruntomar: no changes to be done no the server
[2013-03-08 07:43:19 -0500] jondavidjohn: I mean, If i'm going to 11, it'd probably be a good idea to upgrade it also no?
[2013-03-08 07:43:23 -0500] jondavidjohn: before I get too far into this?
[2013-03-08 07:43:42 -0500] aruntomar: chef server 10 and 11 are very different
[2013-03-08 07:43:51 -0500] aruntomar: u can't just upgrade it
[2013-03-08 07:43:58 -0500] jondavidjohn: ok
[2013-03-08 07:44:16 -0500] aruntomar: recommended is that you create a new chef server 11 and terminate the old one.
[2013-03-08 07:44:52 -0500] jondavidjohn: are there a lot of recipe breakages because of the behaviour changes now? since 11 is pretty young?
[2013-03-08 07:47:03 -0500] jondavidjohn: ok, upgraded node and workstation to 11.4
[2013-03-08 07:47:08 -0500] jondavidjohn: same result
[2013-03-08 07:47:14 -0500] jondavidjohn: Recipe: yum::epel
[2013-03-08 07:47:15 -0500] jondavidjohn:   * yum_key[RPM-GPG-KEY-EPEL-6] action add[2013-03-08T07:46:03+00:00] INFO: Processing yum_key[RPM-GPG-KEY-EPEL-6] action add (yum::epel line 22)
[2013-03-08 07:47:15 -0500] jondavidjohn:  (up to date)
[2013-03-08 07:47:16 -0500] jondavidjohn:   * yum_repository[epel] action add[2013-03-08T07:46:03+00:00] INFO: Processing yum_repository[epel] action add (yum::epel line 27)
[2013-03-08 07:47:18 -0500] jondavidjohn:  (up to date)
[2013-03-08 07:47:25 -0500] jondavidjohn: still failed here
[2013-03-08 07:47:41 -0500] jondavidjohn: Chef::Exceptions::Exec
[2013-03-08 07:47:41 -0500] jondavidjohn: ----------------------
[2013-03-08 07:47:41 -0500] jondavidjohn: rpm  -U /var/chef/cache/ius-release-1.0-10.ius.el6.noarch.rpm returned 1, expected 0
[2013-03-08 07:47:46 -0500] aruntomar: jondavidjohn: /etc/yum.repos.d/epel.repo does this file exists
[2013-03-08 07:48:15 -0500] jondavidjohn: yes
[2013-03-08 07:48:18 -0500] aruntomar: check whether it's enabled
[2013-03-08 07:48:47 -0500] aruntomar: jondavidjohn: it may be that it was already installed and disabled, so chef will not install it again.
[2013-03-08 07:48:58 -0500] jondavidjohn: # Generated by Chef for chef-test.midwestern.de
[2013-03-08 07:48:58 -0500] jondavidjohn: # Local modifications will be overwritten.
[2013-03-08 07:48:58 -0500] jondavidjohn: [epel]
[2013-03-08 07:48:59 -0500] jondavidjohn: name=Extra Packages for Enterprise Linux
[2013-03-08 07:49:01 -0500] jondavidjohn: mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch
[2013-03-08 07:49:03 -0500] jondavidjohn: gpgcheck=1
[2013-03-08 07:49:06 -0500] jondavidjohn: gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6
[2013-03-08 07:49:08 -0500] jondavidjohn: enabled=1
[2013-03-08 07:49:37 -0500] jondavidjohn: that url doesn't look like it's returning a valid list of mirrors
[2013-03-08 07:49:42 -0500] jondavidjohn: it doesn't like the arch
[2013-03-08 07:50:29 -0500] aruntomar: yum repolist all
[2013-03-08 07:50:48 -0500] aruntomar: paste the long outputs to gist
[2013-03-08 07:51:41 -0500] aruntomar: and no recipes don't break. there have been some changes to the recipes especially to the attributes, but currently they don't break, they just warn.
[2013-03-08 07:53:14 -0500] jondavidjohn: https://gist.github.com/jondavidjohn/5114868
[2013-03-08 07:53:20 -0500] jondavidjohn: thanks for all the help btw
[2013-03-08 07:54:30 -0500] aruntomar: jondavidjohn: u r welcome :)
[2013-03-08 07:54:39 -0500] aruntomar: so ur epel repo looks enabled
[2013-03-08 07:55:25 -0500] jondavidjohn: when I run the command that fails I get this
[2013-03-08 07:55:29 -0500] jondavidjohn: rpm  -U /var/chef/cache/ius-release-1.0-10.ius.el6.noarch.rpm
[2013-03-08 07:55:30 -0500] jondavidjohn: warning: /var/chef/cache/ius-release-1.0-10.ius.el6.noarch.rpm: Header V4 DSA/SHA1 Signature, key ID 9cd4953f: NOKEY
[2013-03-08 07:55:30 -0500] jondavidjohn: error: Failed dependencies:
[2013-03-08 07:55:31 -0500] jondavidjohn: epel-release is needed by ius-release-1.0-10.ius.el6.noarch
[2013-03-08 07:56:04 -0500] aruntomar: jondavidjohn: try disabling the gpgcheck
[2013-03-08 07:56:08 -0500] aruntomar: in epel
[2013-03-08 07:56:22 -0500] jondavidjohn: in the epel.repo file?
[2013-03-08 07:56:26 -0500] aruntomar: yes
[2013-03-08 07:57:28 -0500] aruntomar: rpm -qa|grep epel-release
[2013-03-08 07:57:44 -0500] aruntomar: what the output
[2013-03-08 07:57:51 -0500] jondavidjohn: nothing
[2013-03-08 07:58:15 -0500] jondavidjohn: disabled the gpgcheck and ran rpm -U ...ius-release
[2013-03-08 07:58:17 -0500] jondavidjohn: same error
[2013-03-08 07:58:25 -0500] aruntomar: k, that's weird, you should get something like this [root@router ~]# rpm -qa|grep epel-release
[2013-03-08 07:58:25 -0500] aruntomar: epel-release-6-7.noarch
[2013-03-08 07:58:53 -0500] aruntomar: k, remove the epel.repo file and then run the chef-client again
[2013-03-08 07:58:53 -0500] jondavidjohn: I'm running a 6.3 centos
[2013-03-08 07:58:59 -0500] jondavidjohn: ok
[2013-03-08 07:59:42 -0500] aruntomar: jondavidjohn: is this 6.3 node on aws ec2?
[2013-03-08 08:00:04 -0500] aruntomar: jondavidjohn: i've faced issues, using epel on 6.3 on ec2 instances
[2013-03-08 08:00:13 -0500] jondavidjohn: Rackspace
[2013-03-08 08:01:35 -0500] aruntomar: jondavidjohn: k
[2013-03-08 08:02:22 -0500] jondavidjohn: it re-installed the epel.repo file but same failure if ius
[2013-03-08 08:04:09 -0500] aruntomar: jondavidjohn: does it give you the epel-release version this time
[2013-03-08 08:04:31 -0500] jondavidjohn: nope
[2013-03-08 08:04:57 -0500] aruntomar: jondavidjohn: that's really weird
[2013-03-08 08:05:07 -0500] aruntomar: r u using the latest yum repo?
[2013-03-08 08:05:15 -0500] aruntomar: i meant cookbook
[2013-03-08 08:05:20 -0500] jondavidjohn: yes
[2013-03-08 08:05:26 -0500] jondavidjohn: check out from master tonight
[2013-03-08 08:06:03 -0500] aruntomar: rather use the community "knife cookbook install yum" then "knife cookbook upload yum"
[2013-03-08 08:07:07 -0500] aruntomar: knife cookbook list|grep yum
[2013-03-08 08:07:08 -0500] aruntomar: yum                  2.1.0
[2013-03-08 08:09:41 -0500] jondavidjohn: yum               2.1.0
[2013-03-08 08:10:45 -0500] jondavidjohn: FATAL: Cannot find sub command for: 'cookbook install yum'
[2013-03-08 08:12:51 -0500] aruntomar: jondavidjohn: oh, sorry that one was "knife cookbook site install yum"
[2013-03-08 08:12:58 -0500] aruntomar: anyways, you have the latest one
[2013-03-08 08:13:01 -0500] jondavidjohn: yeah, that's how I did it
[2013-03-08 08:13:06 -0500] aruntomar: can't think of anything else
[2013-03-08 08:13:30 -0500] jondavidjohn: should I use a different OS as a base?
[2013-03-08 08:13:35 -0500] jondavidjohn: is this a CentOS issue?
[2013-03-08 08:13:53 -0500] aruntomar: jondavidjohn: haven't faced this issue on centos till now
[2013-03-08 08:14:14 -0500] aruntomar: the one i got was on ec2 b'cas it was not allowing for certain centos mirrors
[2013-03-08 08:14:26 -0500] aruntomar: so i chose the us one and it worked
[2013-03-08 08:14:44 -0500] jondavidjohn: but it seems to be installing epel fine, rpm -U just doesn't seem to see it
[2013-03-08 08:14:48 -0500] aruntomar: try other distro
[2013-03-08 08:15:09 -0500] aruntomar: or may be terminate this instance, create a new one and see
[2013-03-08 08:15:34 -0500] aruntomar: if u still get this same issue, then try using other distro.
[2013-03-08 08:16:30 -0500] jondavidjohn: Guess I'll give Ubuntu a shot
[2013-03-08 08:32:23 -0500] jondavidjohn: ugh... now it's telling me there's a syntax error in a different recipe
[2013-03-08 08:32:43 -0500] jondavidjohn: any reason `pkgs` on this line https://github.com/opscode-cookbooks/git/blob/master/recipes/source.rb#L29 would be nil for ubuntu?
[2013-03-08 08:51:30 -0500] Tensibai: Hi there
[2013-03-08 09:13:53 -0500] giorgian: hi; having a node in chef-shell, how do I get its attributes (those I'd see with knife node -l NAME)?
[2013-03-08 09:14:20 -0500] giorgian: of course, if this is documented somewhere, just point me there
[2013-03-08 09:53:49 -0500] drrk: on chef11, trying to upload a cookbook with berkshelf, i'm geting a 500 error  /srv/log/chef-server/erchef/current has and aws error of conn_failed enetunreach
[2013-03-08 09:54:30 -0500] drrk: which seems strange as either is't trying to conect to aws, which I didn't reliase, or ti's connectign to bookshelf as I suspect, but that's on localhost so why is net unreachable
[2013-03-08 09:54:34 -0500] drrk: any ideas?
[2013-03-08 10:13:01 -0500] oopsnotworking: hello
[2013-03-08 10:13:37 -0500] oopsnotworking: I'm trying to install chef server 11.06 on a fresg Ubuntu 12.04 and it's failing, ca you help please ?
[2013-03-08 10:13:46 -0500] oopsnotworking: fresh
[2013-03-08 10:18:14 -0500] drrk: what is happening?
[2013-03-08 10:19:14 -0500] oopsnotworking: when I do sudo chef-server-ctl reconfigure
[2013-03-08 10:19:30 -0500] oopsnotworking: I see      Error executing action `start` on resource 'service[procps]'
[2013-03-08 10:19:51 -0500] oopsnotworking: Mixlib::ShellOut::ShellCommandFailed
[2013-03-08 10:19:58 -0500] oopsnotworking: Expected process to exit with [0], but received '1'
[2013-03-08 10:20:55 -0500] drrk: hmm, does it tell you which command it was trying to run?
[2013-03-08 10:21:21 -0500] oopsnotworking: Ran /etc/init.d/procps start returned 1
[2013-03-08 10:26:09 -0500] drrk: hmm, that's unfortunatly not helpful
[2013-03-08 10:26:46 -0500] oopsnotworking: what do you need
[2013-03-08 10:27:12 -0500] drrk: as it's just a generic script for upstart jobs
[2013-03-08 10:27:22 -0500] oopsnotworking: where can I find the error log related to procps ?
[2013-03-08 10:28:58 -0500] drrk: I don't know, I don't have procps running on mine
[2013-03-08 10:29:54 -0500] oopsnotworking: well it's related to postgresql, I can see :
[2013-03-08 10:29:58 -0500] oopsnotworking: Compiled Resource: ------------------ # Declared in /opt/chef-server/embedded/cookbooks/chef-server/recipes/postgresql.rb:61:in `from_file'  service("procps") do   action [:nothing]   supports {:restart=>false, :reload=>false, :status=>false}   retries 0   retry_delay 2   service_name "procps"   pattern "procps"   startup_type :automatic   cookbook_name :"chef-server"   recipe_name "postgresql" end
[2013-03-08 10:32:15 -0500] drrk: hmm
[2013-03-08 10:32:31 -0500] drrk: actually, looks like it's a pretty critical system service
[2013-03-08 10:32:34 -0500] drrk: http://procps.sourceforge.net/
[2013-03-08 10:33:20 -0500] drrk: I can't work out why it needs an initscript though
[2013-03-08 10:34:46 -0500] drrk: ah hah
[2013-03-08 10:34:50 -0500] drrk: http://ubuntuforums.org/showthread.php?t=1505356
[2013-03-08 10:35:07 -0500] drrk: the init script sets up your sysctls
[2013-03-08 10:35:19 -0500] drrk: cat /etc/sysctl.d/*.conf /etc/sysctl.conf | sudo sysctl -p -
[2013-03-08 10:35:28 -0500] drrk: run as root will tell you what's failing
[2013-03-08 10:36:36 -0500] drrk: ah, it has sudo so that overes root
[2013-03-08 10:37:14 -0500] oopsnotworking: Result is
[2013-03-08 10:37:18 -0500] oopsnotworking: kernel.printk = 4 4 1 7
[2013-03-08 10:37:23 -0500] oopsnotworking: net.ipv6.conf.all.use_tempaddr = 2
[2013-03-08 10:37:28 -0500] oopsnotworking: net.ipv6.conf.default.use_tempaddr = 2
[2013-03-08 10:37:33 -0500] oopsnotworking: error: permission denied on key 'kernel.kptr_restrict'
[2013-03-08 10:37:37 -0500] oopsnotworking: net.ipv4.conf.default.rp_filter = 1
[2013-03-08 10:37:41 -0500] oopsnotworking: net.ipv4.conf.all.rp_filter = 1
[2013-03-08 10:37:46 -0500] oopsnotworking: net.ipv4.tcp_syncookies = 1
[2013-03-08 10:37:51 -0500] oopsnotworking: error: "kernel.yama.ptrace_scope" is an unknown key
[2013-03-08 10:37:55 -0500] oopsnotworking: vm.mmap_min_addr = 65536
[2013-03-08 10:37:59 -0500] oopsnotworking: kernel.shmmax = 17179869184
[2013-03-08 10:38:03 -0500] oopsnotworking: kernel.shmall = 4194304
[2013-03-08 10:38:15 -0500] oopsnotworking: that's all
[2013-03-08 10:38:24 -0500] oopsnotworking: so 2 errors
[2013-03-08 10:38:41 -0500] drrk: there you go comment out those lines and it will work
[2013-03-08 10:40:07 -0500] oopsnotworking: hum... I'll try it
[2013-03-08 10:40:15 -0500] oopsnotworking: need to find the files though
[2013-03-08 10:40:53 -0500] drrk: /etc/sysctl.conf  and /etc/sysctl.d/*.conf use grep
[2013-03-08 10:44:23 -0500] Azrael808: Hey, I'm looking at having EC2 instances automatically register themselves when brought online by an Auto Scaling policy. I see that the chef-client binary has the --override-runlist parameter, which I can use to ensure a new node runs the appropriate role.
[2013-03-08 10:44:55 -0500] Azrael808: Does an overridden run list get saved on the Chef server upon successful completion of the run
[2013-03-08 10:44:57 -0500] Azrael808: ?
[2013-03-08 10:46:50 -0500] oopsnotworking: hey drrk I have commented the 2 keys and it's working
[2013-03-08 10:46:59 -0500] drrk: oopsnotworking: good stuff :)
[2013-03-08 10:47:06 -0500] oopsnotworking: thanks a lot
[2013-03-08 10:47:28 -0500] oopsnotworking: I will open a ticket to my hoster to sort the key issue
[2013-03-08 10:47:33 -0500] drrk: no worries, now if only I would workout my problem :(
[2013-03-08 10:47:41 -0500] oopsnotworking: what's yours ?
[2013-03-08 10:47:55 -0500] drrk: 09:53 < drrk> on chef11, trying to upload a cookbook with berkshelf, i'm geting  a 500 error  /srv/log/chef-server/erchef/current has and aws  error of conn_failed enetunreach
[2013-03-08 10:47:55 -0500] drrk: 09:54 < drrk> which seems strange as either is't trying to conect to aws, which  I didn't reliase, or ti's connectign to bookshelf as I suspect,  but that's on localhost so why is net unreachable
[2013-03-08 10:49:02 -0500] oopsnotworking: awww I'm no help with this one
[2013-03-08 10:49:40 -0500] drrk: no, I tink I need to wait for seattle to wake up
[2013-03-08 10:53:42 -0500] oopsnotworking: OK. Thanks again and take care !
[2013-03-08 11:06:23 -0500] AikiLinux: Hello
[2013-03-08 11:06:33 -0500] AikiLinux: what are the files in /var/lib/couchdb/.chef_design used for ?
[2013-03-08 11:12:26 -0500] denniswisnia: How I Define a virtualhost with the opscode-nginx cookbook
[2013-03-08 11:12:27 -0500] denniswisnia: ?
[2013-03-08 11:30:01 -0500] simonmellor: hi guys, i'm having an issue where the remote_file resource is decompressing a gzip
[2013-03-08 11:30:07 -0500] simonmellor: is this expected behaviour?
[2013-03-08 11:30:08 -0500] simonmellor: https://gist.github.com/simonmellor/ed2b3b36ff02e296ef3b
[2013-03-08 11:32:20 -0500] aruntomar: simonmellor: do u have ruby at that location ?  /usr/local/bin/ruby -v
[2013-03-08 11:32:47 -0500] simonmellor: not yet because it doesnt compile
[2013-03-08 11:33:14 -0500] simonmellor: what seems to happen is remote_file downloads the file and ungzips it in transit
[2013-03-08 11:35:23 -0500] simonmellor: on the vagrant box i'm building onto /tmp/vagrant-chef-1/ruby-2.0.0-p0.tar.gz exists but it is actual format is just tar not tar.gz
[2013-03-08 11:35:47 -0500] aruntomar: simonmellor: if u want to install ruby, then why not use rvm?
[2013-03-08 11:36:21 -0500] simonmellor: we dont want rvm on the production boxes we intend using this on
[2013-03-08 11:36:42 -0500] aruntomar: simonmellor: k
[2013-03-08 11:37:40 -0500] aruntomar: simonmellor: what's there in bash[build ruby] resource
[2013-03-08 11:38:02 -0500] simonmellor: one moment i'll gist the recipe
[2013-03-08 11:38:02 -0500] aruntomar: simonmellor: can you paste the code to gist, so that people can help better.
[2013-03-08 11:40:22 -0500] simonmellor: https://gist.github.com/simonmellor/5115873
[2013-03-08 11:40:29 -0500] simonmellor: that is the recipe and attributes
[2013-03-08 11:44:20 -0500] simonmellor: http://tickets.opscode.com/browse/CHEF-3140 looks it put a fix in for it
[2013-03-08 11:46:06 -0500] a_a_g: anyone created a data bag item from a knife plugin?
[2013-03-08 11:46:46 -0500] aruntomar: simonmellor: so what don't you upgrade your chef-client to latest version? i guess, you are still using the old one.
[2013-03-08 11:46:49 -0500] a_a_g: its almost like its designed to be difficult!
[2013-03-08 11:48:09 -0500] aruntomar: a_a_g: hi. so i've created databag item from recipes but not from knife plugin. but i guess, it should be same.
[2013-03-08 11:48:37 -0500] a_a_g: aruntomar: recipes have a very easy dsl for data bags
[2013-03-08 11:49:11 -0500] aruntomar: a_a_g: ya, new_databag = Chef::DataBag.new
[2013-03-08 11:49:56 -0500] a_a_g: data bag item?
[2013-03-08 11:51:08 -0500] simonmellor: good call aruntomar looks like the patch is missing in 0.10.10 https://github.com/opscode/chef/blob/0.10.10/chef/lib/chef/provider/remote_file.rb
[2013-03-08 11:51:23 -0500] simonmellor: i'll upgrade and test
[2013-03-08 12:09:51 -0500] nd__: Installing chef-server according to the documentation and running the test command I get the error that the pedant_config.rb file is missing
[2013-03-08 12:12:21 -0500] aruntomar: nd__: which doc r u referring?
[2013-03-08 12:13:22 -0500] nd__: http://docs.opscode.com/chef/install_server.html
[2013-03-08 12:14:37 -0500] nd__: Is there a separate chef-server .deb for ubuntu 12.10? Because the download configurator gives me the 12.04 even though I selected 12.10 but I went along, guessing that it's the same package
[2013-03-08 12:16:05 -0500] nd__: argh, hmm forget that report. The file is there, but permissions do not allow me to read it :-/ Sorry!
[2013-03-08 12:16:51 -0500] nd__: I figured a normal user should be able to execute the tests (as the documentation seems to use a normal user)
[2013-03-08 12:17:38 -0500] aruntomar: nd__: k
[2013-03-08 12:29:48 -0500] zts: grrr redirects from good pages on the old docs site, to less useful pages on the new one
[2013-03-08 12:30:14 -0500] zts: eg, http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2013-03-08 12:30:37 -0500] zts: compared to, http://webcache.googleusercontent.com/search?q=cache:_juqYDW0cdwJ:wiki.opscode.com/display/chef/Anatomy%2Bof%2Ba%2BChef%2BRun+&cd=1&hl=en&ct=clnk&gl=uk
[2013-03-08 12:54:16 -0500] mixandgo: hello, how would you run and organize settings for different machines and whats the difference between roles and environments
[2013-03-08 13:07:26 -0500] specialsauce: mixandgo: a role might be "webserver" or "db server". An environment might be "live" or "staging".
[2013-03-08 13:07:49 -0500] specialsauce: depending on what you're doing, neither either or both of these concepts might be useful to you
[2013-03-08 13:31:16 -0500] mixandgo: so how do you run separate environments with chef-solo ? I need to set up both a production and a staging server
[2013-03-08 13:34:30 -0500] leifmadsen: Marquis42: o./
[2013-03-08 13:34:34 -0500] Marquis42: :)
[2013-03-08 13:34:59 -0500] leifmadsen: Marquis42: maybe in all this we'll figure out a better way of solving this problem :)
[2013-03-08 13:35:14 -0500] Marquis42: Could be!
[2013-03-08 13:35:34 -0500] Marquis42: Although I'll note that if I specify target_dir with the existing code it definitely works. :)
[2013-03-08 13:37:57 -0500] Marquis42: So I'm having an issue creating an LWRP.  In particular, I'd like for one of the attributes to default to the resource name.  The problem is that rather than defaulting to the value of the resource_name, the attribute is literally getting "resource_name". :/
[2013-03-08 13:38:10 -0500] Marquis42: The relevant lines from resources/default.rb are these:
[2013-03-08 13:38:13 -0500] Marquis42: attribute :resource_name, :name_attribute => true
[2013-03-08 13:38:15 -0500] Marquis42: attribute :target_dir,    :kind_of => [String, FalseClass], :default => :resource_name
[2013-03-08 13:40:33 -0500] specialsauce: mixango: i'm not sure that chef solo uses environments since you have no chef server, i'm not sure how that would even work
[2013-03-08 13:42:36 -0500] mixandgo: I was hoping I could provide some comand line arg or environment variable to run each one
[2013-03-08 13:43:16 -0500] DeadZen: hi
[2013-03-08 13:45:53 -0500] Azrael: i'm in the process of testing out chef, for a deployment that will occur in the next few months, provided the tests go well
[2013-03-08 13:46:00 -0500] Azrael: should i be using chef 11?  or 10?
[2013-03-08 13:46:18 -0500] Azrael: we are a debian shop and unfortunately chef 11 is only supported on ubuntu and rhel
[2013-03-08 13:48:07 -0500] trung_: anybody know about this issue http://community.opscode.com/questions/265
[2013-03-08 13:48:11 -0500] trung_: I use chef-solo
[2013-03-08 13:48:17 -0500] trung_: and I cannot install nginx from source
[2013-03-08 13:48:29 -0500] trung_: something relates to runit_service
[2013-03-08 13:51:20 -0500] zts: Azrael: I understand that server packages only exist for ubuntu and rhel at the moment (I'm not sure what plans exist there), but there appear to be Chef 11 client packages for Debian (or you could install from rubygems)
[2013-03-08 13:51:53 -0500] Azrael: zts: awesome
[2013-03-08 13:52:01 -0500] Azrael: zts: do you know if there will be apt and yum repos for chef 11?
[2013-03-08 13:52:04 -0500] zts: Azrael: you probably want to be targeting 11 for new deployments though, and making noise about the server situation if it's a problem for you
[2013-03-08 13:52:43 -0500] Azrael: how about the chef 11 documentation too?  half of the docs seem to be talking about 10 and the other half about 11
[2013-03-08 13:53:17 -0500] zts: Azrael: I don't know about apt and yum repos, but I'm not holding out hope - packaging efforts seem to be towards the "omnibus" packages now
[2013-03-08 13:53:36 -0500] zts: Azrael: which are debs and rpms, but not available from an opscode-hosted repository
[2013-03-08 13:54:23 -0500] zts: Azrael: I'm not too familiar with the server docs, to be honest - the differences shouldn't be too significant for the client, and there's a project underway to migrate all the documentation into the new site (docs.opscode.com)
[2013-03-08 13:54:37 -0500] Azrael: ok cool
[2013-03-08 13:54:38 -0500] Azrael: thanks zts
[2013-03-08 13:55:12 -0500] zts: Azrael: the easiest option right now would be to start with Hosted Chef as the server.  If that's not an option, the Chef 10 server install might be better documented for the time being
[2013-03-08 13:55:36 -0500] Azrael: yeah
[2013-03-08 13:55:40 -0500] Azrael: hosted isn't an option
[2013-03-08 13:55:40 -0500] zts: Azrael: you should be okay using 11 Client with later versions of 10 Server, so that's also an option
[2013-03-08 13:55:46 -0500] Azrael: hmm
[2013-03-08 13:57:00 -0500] zts: at a previous site, hosted wasn't an option for anything serious, but we did use it for our proof of concept.  When we brought that in-house, we spun up an ubuntu instance for it - despite being a Centos shop - as that was the best supported platform at the time.  After that, we packaged server for Centos in-house
[2013-03-08 13:57:48 -0500] zts: none of which was ideal, but it did let us keep moving (and figure out how much efforts we could afford to spend on the server situation)
[2013-03-08 13:58:11 -0500] Azrael: right
[2013-03-08 13:58:25 -0500] Azrael: seems chef needs a bit more work to get things presented well, but it will happen i'm sure
[2013-03-08 13:58:33 -0500] zts: Azrael: might be worth asking that question again in a few hours, when Opscoders are online though.  Knowing the plans for supported server platform makes a different, I guess :)
[2013-03-08 13:58:40 -0500] zts: *difference
[2013-03-08 13:59:12 -0500] DeadZen: is there a channel for chef coders?
[2013-03-08 13:59:16 -0500] geekbri: Honestly, I would personally go with using chef server 11, even if its not documented as well and may be tougher to setup
[2013-03-08 13:59:25 -0500] geekbri: otherwise you will just be stuck in a position of having to upgrade your server stack eventually
[2013-03-08 13:59:35 -0500] geekbri: which, personally, is something i'd want to avoid
[2013-03-08 14:00:13 -0500] Azrael: opscoders are PST right?
[2013-03-08 14:00:33 -0500] geekbri: I think some are mountain time
[2013-03-08 14:01:28 -0500] Azrael: ok
[2013-03-08 14:01:34 -0500] Azrael: i'm in copenhagen; will have to wait
[2013-03-08 14:02:47 -0500] zts: geekbri: I'd definitely agree with "upgrade before you go into production".
[2013-03-08 14:07:24 -0500] Azrael: ok trying out 11
[2013-03-08 14:07:30 -0500] Azrael: purged the 10 install
[2013-03-08 14:15:19 -0500] raizyr: Can anyone suggest why running 'bundle exec thor foodcritic:lint'  gives different results from running foodcritic by itself 'foodcritic .'  ?
[2013-03-08 14:19:33 -0500] geekbri: raizyr: are you potentially running different versions of food critic?
[2013-03-08 14:22:03 -0500] raizyr: I don't think so,  this is my first time using berkshelf, foodciritic, and writing an LWRP though.   when I do a bundle install  it shows foodcritic as 1.7.0 and thor-foodcritic 0.2.0,  a gem list shows the same versions
[2013-03-08 14:23:37 -0500] raizyr: 'bundle exec thor foodcritic:lint'  gives me FC016, FC017 (both of which were valid, but I've since corrected),  and FC045 which is not correct
[2013-03-08 14:24:06 -0500] raizyr: 'foodcritic .' is currently only giving me FC034  which appears correct at the moment,  I'm fixing the template to see if that one goes away
[2013-03-08 14:28:14 -0500] raizyr: Fixing the template worked,  so foodcritic by itself is giving me no errors, but through bundle exec thor, I'm still getting three false positives
[2013-03-08 14:28:40 -0500] raizyr: I guess I need to figure out what thor actually does.
[2013-03-08 14:37:44 -0500] r00t_: A video created for "Oh! My IT Ops Guy [The song]"  http://youtu.be/Qnp5Jt_HVM8
[2013-03-08 15:07:34 -0500] f1gjam: anyone using chef on ec2 windows nodes
[2013-03-08 15:34:26 -0500] chatov: fresh install of chef 11 on rhel6, 'chef-server-ctl test' completes with no errors, but nothing runs on port 4000 or 4040. what do?
[2013-03-08 15:34:54 -0500] laurent\: grrr giving omnibus builds a try : #<ArgumentError: invalid byte sequence in UTF-8>
[2013-03-08 15:41:51 -0500] Glacee: Hi, I am using the http_request resource to do a get on a Url. That url is good but does not return a valid json response so it Fails.. is there a way around that. I actually just want to get that urll and continue if I get a 200
[2013-03-08 15:42:33 -0500] dotslash: When I run chef-solo I get great logging information that shows exactly what is happening and what is failing. With chef-client--not so much.  Is there a way to get chef-client to give me the same output (or similar) to what I'm getting with chef-solo?
[2013-03-08 15:44:36 -0500] dotslash: Glacee: So you want to just get the header from a urlrather than the json data?
[2013-03-08 15:44:48 -0500] Glacee: dotslash: yes
[2013-03-08 15:45:43 -0500] Glacee: Actually.. I just want to call that url.. its to initialise an asp app on IIS.. it needs an initial call but I want it to fail if it does not return a 200
[2013-03-08 15:45:58 -0500] dotslash: You could write your own provider using open-uri, or just put it in the recipe doing something like:
[2013-03-08 15:46:14 -0500] dotslash: require "open-uri"
[2013-03-08 15:46:43 -0500] dotslash: output = open("http://example.com/page")
[2013-03-08 15:47:59 -0500] Glacee: ok.. thanks.. and add conditions on that I guess
[2013-03-08 15:48:33 -0500] dotslash: Or something like that. I think you'll have the header in there.
[2013-03-08 15:48:51 -0500] Glacee: ok i will try thank you
[2013-03-08 15:49:06 -0500] dotslash: That may not be the best way to do it, but I'm not aware of something built in that will do what you want.
[2013-03-08 15:49:41 -0500] wamcvey: So... I'm retiring my existing chef server and replacing it with a new install. I saw that chef-server cookbook, but the docs seemed to imply that it was best used via chef-solo (including requiring definitions in json). Anyone have any experience in creating a new chef server leveraging existing server resources (e.g. roles).
[2013-03-08 15:51:06 -0500] dotslash: glacee: This might help with the syntax. I think you need a .read at the end of the open. http://stackoverflow.com/questions/4964044/using-open-uri-to-fetch-xml-and-the-best-practice-in-case-of-problems-with-a-rem
[2013-03-08 15:56:07 -0500] dotslash: Glacee: This is probably more of what you want: open("http://www.example.com").status  That should just return the 200 or throw an error.
[2013-03-08 15:56:24 -0500] dotslash: When I run chef-solo I get great logging information that shows exactly what is happening and what is failing. With chef-client--not so much.  Is there a way to get chef-client to give me the same output (or similar) to what I'm getting with chef-solo?
[2013-03-08 15:57:18 -0500] awgross: dotslash: they use the same logging, one is probably running with `-l debug` and the other is not
[2013-03-08 15:59:01 -0500] dotslash: awgross: Hm. I tried turning on debug on the client. I get  lot more info, but it isn't nearly as useful as the chef-solo stuff.
[2013-03-08 15:59:24 -0500] awgross: dotslash: can you post some examples of the difference?
[2013-03-08 16:02:04 -0500] dotslash: awgross: http://pastebin.com/aJK2xzy3 This is from chef-solo. I can't find this output anywhere in the client.log when I run the same cookbooks through chef server on a client.
[2013-03-08 16:03:23 -0500] f1gjam: anyone here using Chef on windows EC2
[2013-03-08 16:03:53 -0500] awgross: hmm k, dotslash, I havent used Chef 11 yet, but do you not even get logs written to STDOUT when running chef-client manually on the client?
[2013-03-08 16:06:49 -0500] dotslash: awgross: So when I turn off the chef-client service and just type chef-client, something runs, but other than the "Starting Chef Client" and "Compiling Cookbooks" nothing seems to look the same.
[2013-03-08 16:07:30 -0500] dotslash: Unless I'm just doing something silly. :)  I'll play around with the debug levels and see if maybe I'm just overlooking something.
[2013-03-08 16:07:42 -0500] awgross: dotslash: hmm, are they using the same version of the Chef gem?  can you do `which chef-solo` and `which chef-client` and make sure if there arent any shenanigans with symlinks?
[2013-03-08 16:09:52 -0500] dotslash: Looks the same.
[2013-03-08 16:11:00 -0500] dotslash: awgross: Running the client by hand seems to be being though. I'm getting better info--even if it is a bit different. I think I can find what I'm looking for with that. Thanks!
[2013-03-08 16:11:12 -0500] awgross: ok
[2013-03-08 16:15:06 -0500] j^2:   :q
[2013-03-08 16:15:33 -0500] zts: dotslash: you could also see whether --force-logger and --force-formatter options toggle the output you're seeing
[2013-03-08 16:17:06 -0500] dotslash: :zts ok I'll try that. Thanks.
[2013-03-08 16:36:15 -0500] geekbri: dotslash: did you try adding -l info
[2013-03-08 16:36:59 -0500] fabio__: hello, im stuck with installing a gem
[2013-03-08 16:37:15 -0500] fabio__: I put build-essential at compiletime true
[2013-03-08 16:37:24 -0500] fabio__: but the gem stills fails with make not found
[2013-03-08 16:37:57 -0500] fabio__: how can I achive that?
[2013-03-08 16:41:39 -0500] f1gjam: is it possible to set the client registration name
[2013-03-08 16:47:21 -0500] f1gjam: is it possible to register a client with a different client name
[2013-03-08 17:07:49 -0500] dotslash: f1gjam: Yes. You can pass in a name parameter as part of the bootstrap process.
[2013-03-08 17:08:01 -0500] f1gjam: im not bootstraping
[2013-03-08 17:08:11 -0500] f1gjam: i am literally running chef-client
[2013-03-08 17:08:24 -0500] f1gjam: and the name parameter in client.rb = node name not he client registration name
[2013-03-08 17:08:33 -0500] f1gjam: i need this because ec2 for windows renames the hosts
[2013-03-08 17:09:06 -0500] dotslash: knife bootstrap ec2-54-235-15-190.compute-1.amazonaws.com -N rh-chef-client-1 -x root -i ~/Server.pem -r "role[chef-client]"
[2013-03-08 17:09:35 -0500] f1gjam: -N = node name not the client registration name
[2013-03-08 17:09:59 -0500] f1gjam: the client registration name is normally the FQDN
[2013-03-08 17:10:04 -0500] f1gjam: the problem is this is changed
[2013-03-08 17:10:38 -0500] zts: fabio__: can you pastebin the chef client log?  Perhaps the gem install is on your run list before the build-essential recipe
[2013-03-08 17:10:51 -0500] dotslash: What changes? The ec2-54 part?
[2013-03-08 17:11:03 -0500] f1gjam: well what happens is that
[2013-03-08 17:11:19 -0500] zts: f1gjam: hm, I thought the node name was also used as the client name
[2013-03-08 17:11:38 -0500] dotslash: Or the internal name which is something like ip-10-232-110-165
[2013-03-08 17:12:23 -0500] dotslash: I set my chef server to use the ec2 name as the hostname and it fixed the problem with it changing all the time.
[2013-03-08 17:12:38 -0500] fabio__: zts i solved it with include_recipe 'build-essential' in the first line
[2013-03-08 17:13:51 -0500] zts: fabio__: yeah, that means it was an ordering issue (and that's the right way of fixing it)
[2013-03-08 17:15:26 -0500] dotslash: I have recipes that need to talk to a nexus server. I want this to be controlled from outside the recipe. I know how to set it using dna.json for chef-solo, but how to I set attributes when using chef-server?
[2013-03-08 17:16:22 -0500] zts: dotslash: you can do the same thing, using chef-client -j
[2013-03-08 17:17:02 -0500] dotslash: zts: Right, but how do I do it if I'm using chef server?
[2013-03-08 17:17:41 -0500] zts: dotslash: not sure I understand - recipes are run by chef-client, not by the server?
[2013-03-08 17:17:50 -0500] dotslash: I need to be able to do something like: Everything in this environment has nexus_url set to http://www.example.com.
[2013-03-08 17:19:41 -0500] dotslash: Right, but the chef client runs automatically on the client machines. I won't even be logging into them. I guess I could rewrite the chef-client install script to point to a file with the settings in it, but then I run into the same problem because that recipe would need to be changed based on the environment.
[2013-03-08 17:20:10 -0500] zts: dotslash: if the nodes are in a chef environment, you just need to set your nexus_url attribute in the environment
[2013-03-08 17:21:40 -0500] dotslash: Ok so just add an attribute under the editor where nexus_url = www.example.com. But then how do I get it from the recipe? Is it just node['nexus_url']?
[2013-03-08 17:22:08 -0500] AntonZ: Hello, can someone give me a hint on the chef run im getting, coudld be i just need to update something, but need someone to have a quick look
[2013-03-08 17:22:32 -0500] AntonZ: here is gist: https://gist.github.com/azavrin/5118148
[2013-03-08 17:23:44 -0500] nlloyds2: AntonZ: it looks like the ruby-shadow package depends on 1.8 versions of the ruby-libs package, but you have 1.9 versions installed.
[2013-03-08 17:24:04 -0500] zts: dotslash: yup, here's a simple example: https://gist.github.com/zts/5118160
[2013-03-08 17:24:28 -0500] AntonZ: hmm, do i uninstall 1.9 or upgrade ruby-shadow to a versiont hat supports 1.9 ?
[2013-03-08 17:24:43 -0500] zts: dotslash: on nodes in the prod environment, recipes can refer to node['mcollective']['package']['version'] and get "2.0.0"
[2013-03-08 17:25:02 -0500] nlloyds2: Looks like there's a fedora package: https://bugzilla.redhat.com/show_bug.cgi?id=801360
[2013-03-08 17:25:34 -0500] AntonZ: well, waht i do is i say: package "ruby-shadow"
[2013-03-08 17:25:47 -0500] AntonZ: and chef used to isntalled on centos prior to version 6
[2013-03-08 17:25:55 -0500] AntonZ: on 6.3 it failed..
[2013-03-08 17:26:45 -0500] nlloyds2: Are the 1.9.3 packages included or do they come from somewhere else?
[2013-03-08 17:27:18 -0500] AntonZ: it looks like there were pre-installed on the image
[2013-03-08 17:27:24 -0500] AntonZ: they*
[2013-03-08 17:27:50 -0500] _ci: Finally advancing to "intermediate" Chef
[2013-03-08 17:27:52 -0500] f1gjam: on first boot,
[2013-03-08 17:27:52 -0500] f1gjam: zts, so yes
[2013-03-08 17:27:55 -0500] AntonZ: i'm using RightScale image
[2013-03-08 17:28:04 -0500] f1gjam: if you create a node definition via json
[2013-03-08 17:28:08 -0500] AntonZ: i guess they put ruby 1.9
[2013-03-08 17:28:16 -0500] _ci: Any suggestions on editing sshd_config
[2013-03-08 17:28:21 -0500] dotslash: zts: When I go into chef server andn edit the environment, it doesn't appear that the editor or json source are editable there. Am I missing something?  When I click to add an attribute, it lets me add it, but won't save.
[2013-03-08 17:28:26 -0500] fabio__: anyone have problems with apt-get packages with ncurses post-installs scripts?
[2013-03-08 17:28:39 -0500] _ci: More specifically, how would I edit sshd_config using chef
[2013-03-08 17:28:44 -0500] fabio__: chef-client is giving me errors in the postfix cookbook
[2013-03-08 17:29:08 -0500] zts: dotslash: through the webui?  I'm not sure, maybe that's a bug.  The file I gisted above, I load in with "knife environment from file prod.json"
[2013-03-08 17:29:45 -0500] dotslash: Ok. I didn't realize I could do it with knife. That makes sense. Thanks!
[2013-03-08 17:29:49 -0500] nlloyds2: AntonZ: Can you do gem_package 'ruby-shadow' instead?
[2013-03-08 17:30:17 -0500] AntonZ: you mean repalce - package "ruby-shadow" with gem_package 'ruby-shadow' ?
[2013-03-08 17:30:27 -0500] egon: Hey guys... What would be the best approach to getting no-proxy support added to knife during bootstrap?
[2013-03-08 17:30:29 -0500] AntonZ: single quotations or double ?
[2013-03-08 17:32:28 -0500] nlloyds2: AntonZ: yes, use the gem (https://rubygems.org/gems/ruby-shadow) instead of the yum package. single/double quotes don't matter in this case. You only need double quotes if you're doing string interpolation like "something-#{variable}"
[2013-03-08 17:32:33 -0500] dotslash: egon: You mean it is using proxy, but you don't want it to?
[2013-03-08 17:32:54 -0500] AntonZ: trying, will report abck shortly
[2013-03-08 17:33:05 -0500] egon: Well, I want it to use the proxy to get software packages, but NOT a proxy when talking with the chef server.
[2013-03-08 17:35:46 -0500] AntonZ:  gem_package[ruby-shadow] installed version 2.2.0
[2013-03-08 17:35:56 -0500] AntonZ: nlloyds2 - that did the trick
[2013-03-08 17:36:01 -0500] AntonZ: thank you kindly
[2013-03-08 17:39:13 -0500] dotslash: egon: Hm. I'm not sure. I didn't realize it would try to go through a proxy when talking to chef.
[2013-03-08 17:39:53 -0500] _ci: Can anyone help me with configuring my sshd_config using chef.  Should I use the openssh cookbook?  Is it smarter to write a local static sshd_config file and just replace the server file?  Better option than those 2?
[2013-03-08 17:39:57 -0500] fabio__: with my ncurses problem I cant find anything in google
[2013-03-08 17:40:04 -0500] fabio__: it tries to do a apt-get -q -y install postfix=2.7.0-1ubuntu0.2
[2013-03-08 17:40:34 -0500] nlloyds2: AntonZ: Awesome. I think I tried to get ruby-shadow working once for and asked a similar question here, but then I discovered passwordless sudo and it changed my life
[2013-03-08 17:41:28 -0500] AntonZ: :))
[2013-03-08 17:41:32 -0500] AntonZ: passwordless sudo :)
[2013-03-08 17:43:40 -0500] faustroll: any test-kitchen 1.0 users in channel now?
[2013-03-08 17:43:53 -0500] faustroll: I just moved from 0.7
[2013-03-08 17:44:04 -0500] faustroll: looks good
[2013-03-08 17:44:10 -0500] faustroll: different config options
[2013-03-08 17:44:21 -0500] faustroll: have a question
[2013-03-08 17:44:41 -0500] faustroll: --teardown is not an option anymore. looks like default
[2013-03-08 17:44:45 -0500] BugBuster_: Hello
[2013-03-08 17:45:01 -0500] BugBuster_: I have a question regarding "include_recipe" - can someone help ?
[2013-03-08 17:45:19 -0500] faustroll: there must be a way in yaml to not teardown
[2013-03-08 17:45:22 -0500] BugBuster_: I have a Application Recipe that does User and SSH Key Management for an Application and
[2013-03-08 17:45:43 -0500] faustroll: BugBuster_: yes?
[2013-03-08 17:45:47 -0500] faustroll: and
[2013-03-08 17:46:17 -0500] BugBuster_: And it should do: 1) Create Group if Not exists 2) Create User if Not Exists 3) Run another Cookbook  that does SSH Key Management (and thus creates the ~/home/.ssh directory) 4) Distribute a private SSH Key so that all machines can auth
[2013-03-08 17:46:24 -0500] faustroll: schisamo: is there a yaml option in test-kitchen to not teardown?
[2013-03-08 17:46:39 -0500] faustroll: schisamo: is there a yaml option in test-kitchen 1.0 to not teardown
[2013-03-08 17:46:45 -0500] BugBuster_: so my recipe goes: for 1) "group groupname do" ...
[2013-03-08 17:46:55 -0500] BugBuster_: fo 2) user username do (manage_home true)
[2013-03-08 17:47:07 -0500] BugBuster_: for 3) include recipe 'chef-ssh-keys'
[2013-03-08 17:47:15 -0500] BugBuster_: for 4) cookbook_file "/home/#{username}/.ssh/id_rsa" do
[2013-03-08 17:47:36 -0500] BugBuster_: however 4) complains that /home/USERNAME/.ssh does not exist
[2013-03-08 17:47:48 -0500] BugBuster_: But the chef-ssh-keys recipy should create that
[2013-03-08 17:48:07 -0500] BugBuster_: Also Debugging reports:
[2013-03-08 17:48:23 -0500] BugBuster_: Recipe: elconas-hadoop::user
[2013-03-08 17:48:26 -0500] BugBuster_: group[hadoop] action create
[2013-03-08 17:48:31 -0500] BugBuster_: user[hadoop] action create
[2013-03-08 17:48:32 -0500] faustroll: schisamo: am looking at code now
[2013-03-08 17:48:35 -0500] BugBuster_: cookbook_file[/home/hadoop/.ssh/id_rsa] action create
[2013-03-08 17:48:50 -0500] BugBuster_: but the include is missing betweegn "user" and "cookbook_file"
[2013-03-08 17:49:20 -0500] BugBuster_: any hints what's missing ?
[2013-03-08 17:50:22 -0500] BugBuster_: I could create the directory in the recipe, however I would like to leave that to the library cookbook "chef-ssh-keys"
[2013-03-08 17:53:19 -0500] BugBuster_: hmmm
[2013-03-08 17:53:23 -0500] j^2: world wide cisco webex connect jabber outage atm
[2013-03-08 17:54:59 -0500] BugBuster_: Also a more general question. Does chef support triggers in a way that if a node is added (e.g. a new node has role "webserver"), all Clients with searches for this node are triggered to run ?
[2013-03-08 17:55:08 -0500] BugBuster_: This would allow much faster convergance speed
[2013-03-08 17:58:22 -0500] jsh: BugBuster_: I'm not aware of any pubsub model like that in chef, but if you need something like that (keep some state, subscribe to changes), you might check out zookeeper
[2013-03-08 17:58:33 -0500] heph: Hey, I'm trying to debug some odd chefspec behavior. If I have two cookbooks in a directory, and execute rspec cookbook1/, it's evaluating the attributes files from cookbook2 at the same time, throwing errors
[2013-03-08 17:58:57 -0500] BugBuster_: ok
[2013-03-08 17:58:59 -0500] heph: cookbook2 isn't included or linked in any way
[2013-03-08 17:59:14 -0500] faustroll: heph: odd
[2013-03-08 17:59:22 -0500] heph: am i missing some command line option that would prevent rspec from traversing up the directory tree?
[2013-03-08 17:59:48 -0500] heph: faustroll: indeed.
[2013-03-08 18:00:10 -0500] faustroll: heph: is this a first run of specs?
[2013-03-08 18:00:42 -0500] heph: in fact, if anyone wants to confirm this behavior, go ahead and throw a 'Chef::Log.warn "told ya so"' in any cookbook's attributes/defaults and then run rspec against a different cookbook
[2013-03-08 18:01:02 -0500] heph: first run? i don't know what you mean by that
[2013-03-08 18:01:31 -0500] faustroll: heph: i mean did you just start developing this cookbook and these specs?
[2013-03-08 18:02:28 -0500] BugBuster_: By the way
[2013-03-08 18:02:34 -0500] BugBuster_: Is there any good chef book ?
[2013-03-08 18:02:48 -0500] BugBuster_: I got the "cucumber-chef" book, however not really that great
[2013-03-08 18:03:37 -0500] heph: faustroll: yeah
[2013-03-08 18:03:44 -0500] nlloyds2: BugBuster_: There was just one published http://www.packtpub.com/chef-starter/book , though it doesn't cover Chef 11 at all
[2013-03-08 18:04:18 -0500] freezey: is there anyway to test an ohai plugin wahtever.rb file on a system before deploying it?
[2013-03-08 18:04:26 -0500] freezey: and not having to commit it to chef server
[2013-03-08 18:04:35 -0500] heph: well, not really, i first noticed the problem when including the community elasticsearch cookbook, it broke rspec against all of my other cookbooks becase they didn't locally define node.memory.total, which is referenced in elasticsearch/attributes/defaults
[2013-03-08 18:04:49 -0500] miah: hi
[2013-03-08 18:04:59 -0500] heph: but i've whittled it down to an easily reproducable state with a couple of dummy cookbooks
[2013-03-08 18:05:13 -0500] miah: im planning on rewriting that cookbook too because im going to implement ES here
[2013-03-08 18:05:41 -0500] heph: all you need to do to prove rspec is traversing up and evaluating the attributes of other cookbooks is to add a Chef::Log.warn in any of the other cookbooks' attributes files
[2013-03-08 18:05:52 -0500] miah: why would you put Chef::Log in an attribute though ?
[2013-03-08 18:06:13 -0500] heph: miah: to prove that rspec is doing unexpected things
[2013-03-08 18:06:19 -0500] miah: i see
[2013-03-08 18:06:22 -0500] BugBuster_: 70 Pages ?
[2013-03-08 18:06:27 -0500] miah: how is your spec written?
[2013-03-08 18:06:37 -0500] heph: one sec, i'm just going to publish the test repo so you guys can see
[2013-03-08 18:06:52 -0500] faustroll: heph: I was going to ask you to do that
[2013-03-08 18:06:57 -0500] miah: at this point im kind of 'fuck attributes and recipes in community cookbooks'
[2013-03-08 18:07:28 -0500] faustroll: miah: and recipes?
[2013-03-08 18:07:33 -0500] miah: yes
[2013-03-08 18:07:34 -0500] nlloyds2: BugBuster_: It does say "Short" right on the cover :)
[2013-03-08 18:08:21 -0500] freezey: does anybody in here know howto use shef?
[2013-03-08 18:08:21 -0500] miah: i see recipes as a way to implement logic around resources. but many cookbooks are trying to be application cookbooks without defining resources
[2013-03-08 18:09:05 -0500] miah: so they have all this crazy logic, case statements, conditionals to try to do the right thing but it ends up forcing a bunch of assumptions that are difficult to change without rewriting the entire cookbook
[2013-03-08 18:09:24 -0500] zts: heph: see https://github.com/acrmp/chefspec/issues/78
[2013-03-08 18:09:25 -0500] judd7: miah - v interesting.
[2013-03-08 18:09:37 -0500] miah: the easiest thing to see is that most cookbook recipes fail single responsibility principal
[2013-03-08 18:09:56 -0500] faustroll: ah i see
[2013-03-08 18:09:58 -0500] nlloyds2: freezey: A little bit. What are you looking for?
[2013-03-08 18:10:27 -0500] judd7: interesting - so if we remove recipes, everything needs to be a resource.
[2013-03-08 18:10:33 -0500] judd7: all interfaces must be declared in advance.
[2013-03-08 18:10:37 -0500] miah: the typical cookbook has a recipe that installs, configures, and does 'search' to modify the configuration.
[2013-03-08 18:10:40 -0500] zts: heph: also, are you using chef 10 or 11?  The chef-solo behaviour they refer to changed, so I'm curious about whether that makes a difference
[2013-03-08 18:10:41 -0500] heph: https://github.com/heph/testing-cookbooks
[2013-03-08 18:10:49 -0500] heph: zts: chef 10
[2013-03-08 18:10:58 -0500] BugBuster_: nlloyds2: right ... :)
[2013-03-08 18:10:59 -0500] miah: judd7: yes. build stable public interfaces and let people write cookbooks that wrap in their business logic around those resources
[2013-03-08 18:11:12 -0500] judd7: miah - but we're sysadmins!
[2013-03-08 18:11:13 -0500] miah: so you dont end up with 'well i have to implement this databag and its schema to do what i want but i dislike it.'
[2013-03-08 18:11:38 -0500] BugBuster_: Still I dont understand the order
[2013-03-08 18:11:40 -0500] miah: if you want to continue being only a sysadmin then /part and stop using a programming framework
[2013-03-08 18:11:41 -0500] faustroll: miah: its the design of recipes
[2013-03-08 18:11:45 -0500] miah: faustroll: yes
[2013-03-08 18:11:46 -0500] judd7: miah - that's what chapped me about the users cookbook.
[2013-03-08 18:11:53 -0500] BugBuster_: Can I simulate a Chef run and keep the resulting recipies ?
[2013-03-08 18:12:04 -0500] miah: you have to write recipes before you can simulate a chef run
[2013-03-08 18:12:08 -0500] BugBuster_: the final execution bits with all include_recipe included ?
[2013-03-08 18:12:22 -0500] BugBuster_: I have a Recipe
[2013-03-08 18:12:28 -0500] BugBuster_: However It does strange things :)
[2013-03-08 18:12:29 -0500] heph: zts: it's not strictly evaluating all the cookbooks in the cookbooks path. in this case, the cookbooks are outside the cookbooks path and i'm sending rspec a specific spec.rb
[2013-03-08 18:12:44 -0500] BugBuster_: I follow the reusability pattern of "library" and "application" cookbooks
[2013-03-08 18:12:55 -0500] faustroll: miah: we need design, as in less is more
[2013-03-08 18:12:55 -0500] BugBuster_: to avoid forking community cookbooks
[2013-03-08 18:13:00 -0500] miah: faustroll: yup
[2013-03-08 18:13:19 -0500] faustroll: miah: I'm with you on that.
[2013-03-08 18:13:19 -0500] judd7: http://newgoliath.wordpress.com/2013/03/08/orchestration-consistency-and-community-cookbooks/
[2013-03-08 18:13:42 -0500] awgross: they should have meetup for Chef Cookbook styleguides at Chef Conf
[2013-03-08 18:14:01 -0500] faustroll: I may not always live up to it
[2013-03-08 18:14:22 -0500] judd7: that blog post is mostly for the newbs.
[2013-03-08 18:14:31 -0500] judd7: but at the end, I start banging on some ideas.
[2013-03-08 18:14:40 -0500] miah: i'll have to give that a full read, but its pretty good
[2013-03-08 18:14:47 -0500] faustroll: awgross: the more we talk about this the better
[2013-03-08 18:14:55 -0500] judd7: I'd like to be able to control the consistency model with, erm, attributes?
[2013-03-08 18:15:09 -0500] miah: awgross: i'm speaking about resource providers and such
[2013-03-08 18:15:12 -0500] miah: on Friday
[2013-03-08 18:15:20 -0500] heph: miah: today is friday
[2013-03-08 18:15:22 -0500] miah: and i think there will be some other good talks about cookbook authoring too
[2013-03-08 18:15:29 -0500] judd7: heph - lolz
[2013-03-08 18:15:30 -0500] miah: heph: yes, but not at chefconf
[2013-03-08 18:15:31 -0500] miah: but also.
[2013-03-08 18:15:33 -0500] heph: ah
[2013-03-08 18:15:36 -0500] miah: https://twitter.com/hangops/status/310039625253146625
[2013-03-08 18:15:37 -0500] BugBuster_: Is there a Chef Conference in EU ?
[2013-03-08 18:15:41 -0500] miah: so i guess i'll be speaking about that in ~1 hour
[2013-03-08 18:16:16 -0500] awgross: cool
[2013-03-08 18:16:21 -0500] awgross: doesnt conflict with my talk either, so bonus
[2013-03-08 18:17:07 -0500] jhayden: Ohai plugin question: I have a custom plugin in /etc/ohai/plugins and have configured my client.rb with Ohai::Config[:plugin_path] << '/etc/ohai/plugins' at the end of the file
[2013-03-08 18:17:43 -0500] jhayden: yet Ohai throws an exception because it can't find the plugin first in the standard location
[2013-03-08 18:18:07 -0500] BugBuster_: Anone read the "Instant Chef Starter" book ?
[2013-03-08 18:18:10 -0500] miah: does ohai expect plugin_path to be an array?
[2013-03-08 18:18:13 -0500] jhayden: but it does find it subsequently in the /etc/ohai/plugins dir
[2013-03-08 18:18:29 -0500] miah: ok apparently
[2013-03-08 18:18:33 -0500] miah: i havent written any ohai plugins yet
[2013-03-08 18:18:43 -0500] heph: jhayden: does it find it if you ohai -d /etc/ohai/plugins from the commandline?
[2013-03-08 18:18:44 -0500] BugBuster_: Does it provide News If I manage do bootstrap servers (knife openstack server ...) and created my first Recipe ?
[2013-03-08 18:18:46 -0500] faustroll: miah: kewl. I'm going to follow u on twitter. I'm @faustroll
[2013-03-08 18:19:36 -0500] jhayden: it finds it eventually but behaves as if it is doing the following:
[2013-03-08 18:19:54 -0500] jhayden: is plugin in standard dir? no - throw exception
[2013-03-08 18:20:12 -0500] jhayden: is plugin in next location ? Yes ok do woek
[2013-03-08 18:20:22 -0500] jhayden: work
[2013-03-08 18:20:29 -0500] miah: cool
[2013-03-08 18:20:59 -0500] jhayden: I believe this is causing a memory leak
[2013-03-08 18:21:37 -0500] faustroll: \window 3
[2013-03-08 18:21:43 -0500] faustroll: lol
[2013-03-08 18:22:28 -0500] miah: you can also do 'esc 3'
[2013-03-08 18:22:29 -0500] miah: :P
[2013-03-08 18:23:42 -0500] heph: does anyone know if it's possible to tell whether a recipe is being evaluated by chefspec rather than an actual chef-solo run?
[2013-03-08 18:24:52 -0500] faustroll: miah: thanks
[2013-03-08 18:25:11 -0500] heph: zts: that bug was helpful, i was able to work around the problem by wrapping the dynamic values in an if Chef::Config[:solo] block, but i'd rather it be a little stricter so it doesn't write static values on a chef-solo run outside of chefspec
[2013-03-08 18:26:18 -0500] miah: i still havent used chefspce and i do all my cookbook testing with minitest
[2013-03-08 18:26:20 -0500] BugBuster_: hm interesting ... is there a way to see the final recipe for a recipe using "include_recipe "NAME"" ?
[2013-03-08 18:26:20 -0500] miah: but it also doesn't run chef or chef-solo
[2013-03-08 18:26:39 -0500] BugBuster_: where is the recipe included ? is this like a C -like include ?
[2013-03-08 18:26:46 -0500] BugBuster_: aka inline text replacement
[2013-03-08 18:26:51 -0500] BugBuster_: or is this more "clever"
[2013-03-08 18:26:55 -0500] miah: BugBuster_: yes. basically.
[2013-03-08 18:27:00 -0500] miah: when it hits include_recipe it executes it
[2013-03-08 18:27:03 -0500] faustroll: right, that's part of the point of chefspec
[2013-03-08 18:27:09 -0500] miah: its more like module inclusion in ruby
[2013-03-08 18:27:15 -0500] BugBuster_: at this point ?
[2013-03-08 18:27:20 -0500] BugBuster_: so ...
[2013-03-08 18:27:28 -0500] Marquis42: So I'm having an issue creating an LWRP.  In particular, I'd like for one of the attributes to default to the resource name.  The problem is that rather than defaulting to the value of the resource_name, the attribute is literally getting "resource_name". :/
[2013-03-08 18:27:29 -0500] Marquis42: The relevant lines from resources/default.rb are these:
[2013-03-08 18:27:31 -0500] Marquis42: attribute :resource_name, :name_attribute => true
[2013-03-08 18:27:32 -0500] Marquis42: attribute :target_dir,    :kind_of => [String, FalseClass], :default => :resource_name
[2013-03-08 18:27:40 -0500] BugBuster_: Say I have a recipy that requires a file
[2013-03-08 18:27:45 -0500] miah: https://github.com/miah/chef_logstash/blob/master/test/spec/libraries/resource_logstash_config_spec.rb
[2013-03-08 18:27:46 -0500] BugBuster_: FILE_NEEDED_FIRST
[2013-03-08 18:27:48 -0500] miah: easy peasy
[2013-03-08 18:27:54 -0500] BugBuster_: does this work:
[2013-03-08 18:28:08 -0500] BugBuster_: #1) cookbook_file "FILE_NEEDE_FIRST" do ....
[2013-03-08 18:28:24 -0500] BugBuster_: #2) include_recipe "Recipy_needing_FILE_NEEDED_FIRST"
[2013-03-08 18:28:43 -0500] miah: Marquis42: yes, dont reuse 'resource_name' in ayour attribute specification
[2013-03-08 18:29:02 -0500] miah: cookbook_file is itself a resource, so you'd be passing include_recipe in a block to it. i think it would just shit itself and do nothing
[2013-03-08 18:29:33 -0500] BugBuster_: I confused
[2013-03-08 18:30:03 -0500] miah: in the recipe that needs the file, why not just have 'cookbook_file' rather than having cookbook_file call include_recipe.
[2013-03-08 18:30:42 -0500] Marquis42: miah: So just use something other than that string?  Like 'my_resource_name' or whatever should work?
[2013-03-08 18:30:44 -0500] BugBuster_: or other way:
[2013-03-08 18:30:50 -0500] BugBuster_: Is this supposed to work? http://codepad.org/Fep4T6iQ
[2013-03-08 18:31:05 -0500] miah: Marquis42: sure
[2013-03-08 18:31:14 -0500] Marquis42: OK, thanks.  I'll give it a go.
[2013-03-08 18:31:25 -0500] miah: BugBuster_: yes
[2013-03-08 18:31:44 -0500] BugBuster_: And this is not supposed to work: http://codepad.org/6yajqv8F ?
[2013-03-08 18:31:54 -0500] BugBuster_: (actually http://codepad.org/6yajqv8F did not work yet ...)
[2013-03-08 18:31:56 -0500] miah: actually
[2013-03-08 18:32:00 -0500] miah: your second option is better
[2013-03-08 18:32:03 -0500] miah: no reason to do ruby_block
[2013-03-08 18:32:22 -0500] BugBuster_: hm, but here the recipe complains about "/home/USER/.ssh" missing
[2013-03-08 18:32:23 -0500] miah: ruby_block changes the scope in which your code ie executing
[2013-03-08 18:32:34 -0500] miah: BugBuster_: try using Dir.exist? rather than File.exist?
[2013-03-08 18:32:50 -0500] BugBuster_: And the whole thing faults if I would not have "File.exists?"
[2013-03-08 18:32:56 -0500] josephholsten: BugBuster_: you probably want a directory "/home/#{username}/.ssh" before your cookbook_file
[2013-03-08 18:33:02 -0500] miah: er, sorry. Dir.directory?
[2013-03-08 18:33:51 -0500] miah: apparently File.exist? also works if its a directory.. thats kinda weird.
[2013-03-08 18:33:52 -0500] miah: but ok.
[2013-03-08 18:33:59 -0500] BugBuster_: Yes .. thats ok
[2013-03-08 18:34:08 -0500] BugBuster_: Actually this would fix it
[2013-03-08 18:34:15 -0500] miah: you could also put 'only_if Dir.directory?('foo')' in your cookbook_file resource
[2013-03-08 18:34:21 -0500] BugBuster_: But the chef-ssh-keys created the directory if it does not exist
[2013-03-08 18:34:35 -0500] BugBuster_: And I wonder why I does not do it
[2013-03-08 18:34:52 -0500] josephholsten: only_if { ::Dir.directory? "/home/#{username}/.ssh" }
[2013-03-08 18:34:55 -0500] miah: is the recipe named 'chef-ssh-keys::default' ?
[2013-03-08 18:35:03 -0500] BugBuster_: yes
[2013-03-08 18:35:14 -0500] miah: josephholsten: yes, sorry. you need to block it :/
[2013-03-08 18:35:17 -0500] BugBuster_: I parametrize via the application cookbook
[2013-03-08 18:35:56 -0500] josephholsten: you want to be sure to use :: before File or Dir, they're very common class names and you'll get really confusing error messages if something goes wrong without doing ::File
[2013-03-08 18:36:13 -0500] miah: indeed. Chef itself has a File class
[2013-03-08 18:36:39 -0500] miah: not sure about a Dir class, but for sure a Directory class
[2013-03-08 18:37:06 -0500] miah: it will find those first in its ancestors list
[2013-03-08 18:38:41 -0500] BugBuster_: hmmm
[2013-03-08 18:39:09 -0500] BugBuster_: Actually I use the recipe "chef-ssh-keys::default" twice for this machine
[2013-03-08 18:39:13 -0500] faustroll: heph: I don't have time to look at your test cookbooks now. but may later
[2013-03-08 18:39:14 -0500] BugBuster_: the machine has two roles
[2013-03-08 18:39:29 -0500] BugBuster_: all_server -> Does SSH Key Management for Admins
[2013-03-08 18:39:52 -0500] BugBuster_: and application specific role "hadoop_all" => Users and SSH Keys for application hadoop
[2013-03-08 18:40:16 -0500] BugBuster_: For the hadoop_role I created a "application cookbook" that includes "library cookbooks"
[2013-03-08 18:40:52 -0500] BugBuster_: And the application cookbooks overwrites attribues used by the included cookbook to perform the SSH Work
[2013-03-08 18:41:14 -0500] BugBuster_: so ... role "all_server" has node["ssh_keys"][...] defined (containing Admin Keys)
[2013-03-08 18:41:42 -0500] BugBuster_: and recipe "hadoop_all" overwrites attributes node[ssh_keys"][ ..]  with application specific ssh keys
[2013-03-08 18:42:02 -0500] BugBuster_: Could it be that "chef-ssh-keys" is not executed ?
[2013-03-08 18:44:03 -0500] BugBuster_: I used the ruby block because of this blog: http://nuknad.com/2011/08/31/chef-recipe-order/
[2013-03-08 18:46:21 -0500] BugBuster_: OK ... hhe ruby block does not work at all
[2013-03-08 18:46:27 -0500] BugBuster_: NoMethodError: undefined method `include_recipe'
[2013-03-08 18:47:00 -0500] josephholsten: BugBuster_: It's hard to write demos of ruby_block. It's rarely the right tool.
[2013-03-08 18:49:07 -0500] BugBuster_: ok
[2013-03-08 18:49:16 -0500] josephholsten: BugBuster_: if you're planning to do stuff with pure ruby, usually it's better to do that in a compile-time context and have it govern the logic of regular resources
[2013-03-08 18:49:20 -0500] BugBuster_: Will try to educate myself here: http://docs.opscode.com/essentials_nodes_chef_run.html
[2013-03-08 18:49:43 -0500] BugBuster_: to unserstand what "include recipe" actually does
[2013-03-08 18:51:50 -0500] BugBuster_: I don't get it ...
[2013-03-08 18:52:04 -0500] BugBuster_: :)
[2013-03-08 18:52:54 -0500] BugBuster_: If I do this: http://codepad.org/MNyu3T3k
[2013-03-08 18:53:28 -0500] josephholsten: BugBuster_: do you have a cookbook named 'chef-ssh-keys' with a recipe named 'default'?
[2013-03-08 18:53:29 -0500] BugBuster_: and chef-ssh-keys creates the directory "/home/#{username}/.ssh"
[2013-03-08 18:53:41 -0500] BugBuster_: why does cookbook_file "/home/#{username}/.ssh/id_rsa" fail with "surrounding directory does not exist" ?
[2013-03-08 18:53:51 -0500] BugBuster_: Yes I have one
[2013-03-08 18:54:21 -0500] BugBuster_: I would expect that the cookbook works ... but what's wrong with my thinking here ?
[2013-03-08 18:55:01 -0500] josephholsten: BugBuster_: what version of chef-client/chef-solo are you using?
[2013-03-08 18:55:05 -0500] BugBuster_: 11.4
[2013-03-08 18:55:15 -0500] josephholsten: kk, let me check how that's implemented
[2013-03-08 18:55:25 -0500] josephholsten: it might be blowing up in compile time
[2013-03-08 18:55:43 -0500] josephholsten: (not that that makes any sense)
[2013-03-08 18:56:05 -0500] BugBuster_: I think it breaks in configure run ...
[2013-03-08 18:56:07 -0500] zts: BugBuster_: can you share the default recipe form chef-ssh-keys ?
[2013-03-08 18:56:36 -0500] awgross: Whats a common reason I wouldnt be able to access node attributes inside an LWRPs resource file
[2013-03-08 18:58:07 -0500] BugBuster_: I used this one: https://github.com/nickola/chef-ssh-keys
[2013-03-08 18:58:54 -0500] BugBuster_: with a little fix (user[uid] insread of user[id]) ..
[2013-03-08 18:59:20 -0500] josephholsten: awgross: two reasons, first that such code is not being evaluated in recipe or attribute context, so there isn't a node object available
[2013-03-08 18:59:45 -0500] awgross: i thought that, but I found http://tickets.opscode.com/browse/CHEF-1946
[2013-03-08 18:59:49 -0500] awgross: so i assumed it was available now
[2013-03-08 19:00:06 -0500] zts: BugBuster_: are you sure that chef-ssh-keys has created the directory you're expecting?  It won't create a .ssh directory unless it finds certain details
[2013-03-08 19:00:15 -0500] solarce: sascha_d: yo
[2013-03-08 19:00:42 -0500] BugBuster_: aehm let me check
[2013-03-08 19:00:47 -0500] BugBuster_: for the second run ...
[2013-03-08 19:00:49 -0500] josephholsten: oh, are you accessing it via @run_context.node['attribute']
[2013-03-08 19:01:05 -0500] awgross: ahh no, ill try that
[2013-03-08 19:01:28 -0500] josephholsten: (but only use that for defaults, pls pls pls)
[2013-03-08 19:01:47 -0500] awgross: hmm, still doesnt like that
[2013-03-08 19:02:04 -0500] awgross: Im trying to do exactly that, have some default attributes that are then used to set the LWRP defaults
[2013-03-08 19:02:17 -0500] awgross: id prefer not to have to merge it myself inside the provider
[2013-03-08 19:03:06 -0500] josephholsten: hmm, maybe it's not @run_context but just regular run_context
[2013-03-08 19:03:13 -0500] awgross: testing
[2013-03-08 19:03:33 -0500] awgross: hmm, no dice
[2013-03-08 19:03:48 -0500] awgross: josephholsten: attribute :version, :kind_of => String, :default => run_context.node['redisio']['version']
[2013-03-08 19:05:29 -0500] awgross: with out without @, no change
[2013-03-08 19:06:29 -0500] BugBuster_: Takes a minute ... need to spin up a new machine
[2013-03-08 19:07:29 -0500] BugBuster_: Hmmm
[2013-03-08 19:07:32 -0500] BugBuster_: I have a idea
[2013-03-08 19:07:58 -0500] BugBuster_: odes "user USERNAME do" resource update the node (node['etc']['passwd']) after it created the user ?
[2013-03-08 19:08:29 -0500] josephholsten: sorry BugBuster_ I'm not even seeing that error message, which indicates that it's a ruby error about the surrounding directory
[2013-03-08 19:08:52 -0500] BugBuster_: it is not surrounding it is .. encapulating ?
[2013-03-08 19:08:56 -0500] BugBuster_: or something like this
[2013-03-08 19:09:23 -0500] BugBuster_: This is it: Chef::Exceptions::EnclosingDirectoryDoesNotExist
[2013-03-08 19:13:43 -0500] blitzrage: So I have a question about using Dir.entries(..).each to wrap a chef resource. I have tried to run it, but it fails because the loop happens at the very start of compile time it seems like. I wonder if maybe I actually just need ::Dir or if that will work? Example usage:  https://gist.github.com/leifmadsen/5073538
[2013-03-08 19:14:03 -0500] benblack: anyone using djbdns cookbook, i have a question
[2013-03-08 19:16:18 -0500] josephholsten: BugBuster_: you want the ohai resource with action :reload http://docs.opscode.com/resource_ohai.html
[2013-03-08 19:17:10 -0500] BugBuster_: ahhh
[2013-03-08 19:17:19 -0500] BugBuster_: Then the node Object is updated
[2013-03-08 19:17:46 -0500] BugBuster_: Otherwise it is clear that the user does not exist and thus the code is not executed ...
[2013-03-08 19:17:54 -0500] BugBuster_: It could also be the run order
[2013-03-08 19:18:05 -0500] BugBuster_: If I have nested roles
[2013-03-08 19:18:12 -0500] BugBuster_: ROLE_A
[2013-03-08 19:18:26 -0500] BugBuster_: and  ROLE_B contains ROLE_A and ROLE_C in run list
[2013-03-08 19:18:32 -0500] BugBuster_: hoes does the final run list look like ?
[2013-03-08 19:20:55 -0500] solarce: we're discussing all things chef on http://youtu.be/jp9D_CFH6UY for today's hangops.com session
[2013-03-08 19:21:40 -0500] josephholsten: solarce: I've got to start setting an alarm for those ;-)
[2013-03-08 19:22:01 -0500] solarce: calendar feed is coming with site v2. real soon now (tm) :)
[2013-03-08 19:26:02 -0500] awgross: josephholsten: it looks like i can reference run_context only in the initialize function, not in the LWRP syntax
[2013-03-08 19:26:54 -0500] josephholsten: hmm, can default accept a block?
[2013-03-08 19:31:07 -0500] awgross: josephholsten: not sure, though now I am having trouble overriding what i set in the initialize block with what i set when I  use the LWRP
[2013-03-08 19:34:00 -0500] BugBuster_: josephholsten: Thanks for the Tipp with the OHAI ressource
[2013-03-08 19:34:37 -0500] BugBuster_: Does the resultion of the runlist follow "include in depth first and avoid double inclusions" ?
[2013-03-08 19:35:40 -0500] j^2: in an attributes/default.rb i have default[:somethnig][:host]=prodhost.example.com
[2013-03-08 19:36:16 -0500] j^2: i'd like to set up a staging host, do i do staging[:somthing][:host]staginghost.example.com ?
[2013-03-08 19:40:02 -0500] jblaine: So 'depends' in metadata.rb does not do anything other than require that the depended-upon cookbook is fetched from the server, correct?
[2013-03-08 19:40:18 -0500] j^2: jblaine: yep
[2013-03-08 19:40:21 -0500] jblaine: It does not, specifically, execute any recipes from the depended-upon cookbook unless told to.
[2013-03-08 19:41:03 -0500] jblaine: So 'depends foo' does not run recipe[foo] unless "include_recipe "foo"" is used
[2013-03-08 19:41:04 -0500] awgross: jblaine: no, but as the 'required' recipes are being loaded things like attributes, library files, LWRPs etc will be read
[2013-03-08 19:41:12 -0500] awgross: jblaine: correct
[2013-03-08 19:41:40 -0500] jblaine: thanks j^2 and awgross
[2013-03-08 19:42:31 -0500] queso: If I have installed an opscode or community cookbook into my chef-repo, is there a convenient way to upgrade it?
[2013-03-08 19:42:53 -0500] j^2: queso: git submodules probably
[2013-03-08 19:43:10 -0500] hatchetation: are there any undocumented tricks to stop the wiki -> docs redirect that's been implemented on many of the pages? (eg, an alternative hostname, query string param, etc)
[2013-03-08 19:43:41 -0500] hatchetation: certainly support the transition effort, but there are a few nuggets of wisdom in there I'd like to get at, even if I have to take 'em with a grain or two of salt
[2013-03-08 19:43:52 -0500] queso: j^2: Whatever I did when I originally set up my repo created "chef-vendor-cookbookname" branches..
[2013-03-08 19:44:06 -0500] queso: j^2: But there's no .gitmodule, so it's not using submodules.
[2013-03-08 19:47:18 -0500] BugBuster_: hmmmm
[2013-03-08 19:47:23 -0500] awgross: anyone have a good example of setting LWRP attribute defaults using node attributes?
[2013-03-08 19:48:17 -0500] BugBuster_: Are included Recipies run multiple times ?
[2013-03-08 19:48:36 -0500] BugBuster_: say I have a Cookbook1 and a Cookbook2 and both include SomeRecipe
[2013-03-08 19:48:38 -0500] awgross: BugBuster_: I dont think so
[2013-03-08 19:48:47 -0500] BugBuster_: Is SomeRecipe executed twice ?
[2013-03-08 19:48:58 -0500] awgross: BugBuster_: as it is compiling the recipes it builds an expanded runlist which should not duplicate
[2013-03-08 19:50:05 -0500] BugBuster_: But this means - e.g. saying I have a cookbook for SSh Key Management ... I can not model a hierarchy where ROLE1/Recipe1 adds SSH Keys to users (e.g. "root") and ROLE2/Recipe2 adds other SSH Keys to a user (e.g. "application") ?
[2013-03-08 19:50:35 -0500] BugBuster_: I mean include a recipy with "include_recipe" within another recipe
[2013-03-08 19:50:36 -0500] freezey: any good way to test custom ohai plugins?
[2013-03-08 20:01:28 -0500] eka: hi all getting "Cannot find a resource for apt_repository on ubuntu version 12.04" on chef-solo for with the apt cookbook any idea? just updated the apt cookbook just in case and the same happened. chef-solo v 11.4.0
[2013-03-08 20:06:55 -0500] awgross: anyone have a good example of setting LWRP attribute defaults using node default attributes?
[2013-03-08 20:12:03 -0500] BugBuster_: When I bootstrap it says "Synchronizing Cookbooks" ...
[2013-03-08 20:12:15 -0500] BugBuster_: Then after the first run it downloads all cookbooks again
[2013-03-08 20:12:21 -0500] BugBuster_: Why is that ?
[2013-03-08 20:13:51 -0500] wamcvey: Is there anything likely to break with running chef 11 clients against a chef 10 server?
[2013-03-08 20:14:28 -0500] wamcvey: (and in a related question, with running chef 11  chef-solo to install a chef 10 server).
[2013-03-08 20:15:38 -0500] qhartman: wamcvey, My understanding is that 11 clients should work fine w/ a 10 server
[2013-03-08 20:18:52 -0500] test__: I've create a chef server (version 11), and i'm able to upload environments and roles, but error out when i attempt to upload a cookbook:  error: network error: get addrinfo: no such host is known
[2013-03-08 20:18:58 -0500] test__: any ideas what that could be?
[2013-03-08 20:19:42 -0500] BugBuster_: byye
[2013-03-08 20:29:17 -0500] queso: How do I set an attribute on a node from within the webui?
[2013-03-08 20:30:06 -0500] freezey: ui never!
[2013-03-08 20:30:35 -0500] queso: If I edit my node, go to the "editor" tab and click the green plus icon, Firebug shows me a JavaScript type error.
[2013-03-08 20:31:20 -0500] test__: inside a recipe, you can do    node.set["yourattribute"] = "something"
[2013-03-08 20:32:07 -0500] test__: anyone know of any reason why I would be able to upload a cookbook or a data bag, but have no problems uploading an environment or role?
[2013-03-08 20:32:24 -0500] erratic: ohai chefs
[2013-03-08 20:32:27 -0500] test__: correction: anyone know of any reason why I would NOT be able to upload a cookbook or a data bag, but have no problems uploading an environment or role?
[2013-03-08 20:33:16 -0500] dotslash: queso: On the right hand side, you'll have defaults and overrides under json. Click on the one you want and then to the right under editor click the + sign. Add the attribute and then click Save Attribute.
[2013-03-08 20:33:17 -0500] wamcvey: So... the docs at http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo  are broken... It ends up trying to install Chef Server 11.x, even though the page says it's for chef server 10.x and that install docs for 11 are elsewhere.
[2013-03-08 20:33:18 -0500] wamcvey: There is a link saying the bootstrap process is broken, pointing to a (broken) link to an email thread discussion, but no resolution for installing a 10.x server (the email thread pointed the person to how to install version 11).
[2013-03-08 20:33:35 -0500] dotslash: queso: the trick is that you have to select whether it is default or override first.
[2013-03-08 20:33:41 -0500] queso: test__: Perhaps your knife config doesn't specify the cookbook location? For data bags and roles you pass in the specific file location.
[2013-03-08 20:33:58 -0500] queso: dotslash: Ah, okay, thank you.
[2013-03-08 20:35:57 -0500] test__: queso: I ran the upload again (cookbook) with -VV, and the correct file is selected...the directory is good...this was the error: C:/opscode/chef/embedded/lib/ruby/1.9.1/net/http.rb:644:in `initialize': getaddrinfo: No such host is known.  (SocketError)
[2013-03-08 20:38:33 -0500] queso: test__: Does your chef server have a resolvable hostname?  If not, add it to /etc/hosts
[2013-03-08 20:38:49 -0500] queso: test__: (On the chef server)
[2013-03-08 20:39:00 -0500] queso: test__: I'm not sure that will fix it, but I've had to do that.
[2013-03-08 20:39:55 -0500] test__: queso: good call...will try
[2013-03-08 20:42:14 -0500] test__: queso: VERY nice, got it
[2013-03-08 20:42:33 -0500] queso: test__: Great!
[2013-03-08 20:42:36 -0500] test__: thanks a ton
[2013-03-08 20:43:00 -0500] awgross: success, I found a way to access node attributes inside a resource definition and use them as defaults.  Downside, its a terrible hack.
[2013-03-08 20:45:20 -0500] rep0st: so is there an ohai expert here?
[2013-03-08 20:45:57 -0500] rep0st: i need to limit what ohai grabs from the node upon bootstrap. I have some AD integration that is causing me head aches.
[2013-03-08 20:46:47 -0500] test__: something about chefignore files, but someone else would need to help you with that
[2013-03-08 20:47:01 -0500] j^2: in an attributes/default.rb i have default[:something][:host]=prodhost.example.com
[2013-03-08 20:47:13 -0500] j^2: i'd like to set up a staging host, do i do staging[:somthing][:host]=staginghost.example.com ?
[2013-03-08 20:49:29 -0500] test__: I use environment attributes for that kind of thing
[2013-03-08 20:50:50 -0500] j^2: test__:
[2013-03-08 20:50:52 -0500] j^2: thanks :D
[2013-03-08 20:51:21 -0500] test__: not sure if that's the best way to do it :)
[2013-03-08 20:51:28 -0500] test__: but, made sense to me
[2013-03-08 21:01:44 -0500] btm_: @opscode cookbook code review, join: http://bit.ly/YIBh1T, watch: http://youtu.be/FSJbYN1KTNk #opschef
[2013-03-08 21:04:03 -0500] test__: note to self, when attempting up create a databag from file, must have databag on the server already
[2013-03-08 21:13:03 -0500] wamcvey: So... anyone know where a bootstrap chef-server tarball for 10.x might be?  http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz  attempts installation of 11.x
[2013-03-08 21:16:02 -0500] nlloyds2: wamcvey: I think if you pass the install.sh script "-v 10.24.0" is will install that.
[2013-03-08 21:16:12 -0500] matticulous: trying to debug a recipe compile error in a postgres cookbook. this is running chef 11. anything blatant why these lines would bomb? interface_node = node['network']['interfaces'][interface]['addresses']
[2013-03-08 21:16:12 -0500] matticulous:   interface_node.select { |address, data| data['family'] == 'inet' }[0][0]
[2013-03-08 21:17:21 -0500] nlloyds2: wamcvey: In that script it has url="http://www.opscode.com/chef/download?v=${version}&prerelease=${prerelease}&p=${platform}&pv=${platform_version}&m=${machine}"
[2013-03-08 21:17:27 -0500] wamcvey: nlloyds2: install.sh? I'm invoking chef-solo with a -r option to the tarball URL. I've tried setting a chef_server  version attribute.
[2013-03-08 21:18:02 -0500] nlloyds2: oh sorry not sure about solo I thought you were working with the omnibus client
[2013-03-08 21:18:35 -0500] wamcvey: omnibus client only seems to support 11.x.
[2013-03-08 21:19:27 -0500] nlloyds2: wamcvey: http://s3.amazonaws.com/chef-solo/bootstrap-10.24.0.tar.gz worked for me, so maybe you can just put in the version instead of latest
[2013-03-08 21:19:50 -0500] wamcvey: nlloyds2: exactly what I was looking for. Thanks!
[2013-03-08 21:21:36 -0500] wamcvey: nlloyds2: no joy. Still getting STDERR: ERROR:  Could not find a valid gem 'chef-server-api' (= 11.4.0) in any repository
[2013-03-08 21:21:37 -0500] wamcvey: ERROR:  Possible alternatives: chef-server-api
[2013-03-08 21:22:36 -0500] nlloyds2: wamcvey: hmmm. I've never really used solo so I'm not sure
[2013-03-08 21:23:23 -0500] wamcvey: yeah... I'm beginning to question the wisdom myself... was under the impression it was the preferred way.
[2013-03-08 21:24:19 -0500] nlloyds2: wamcvey: Any reason you need to use < 11?
[2013-03-08 21:24:41 -0500] matticulous: regarding my compile issue above, more specifically, it looks like "interface_node.select { |address, data| data['family'] == 'inet' }[0][0]" is bombing. if i take it out of the recipe, the chef run proceeds. tips on debugging?
[2013-03-08 21:24:53 -0500] wamcvey: all my clients are 10.x.  My existing server (which I'm retiring) is 10.x...
[2013-03-08 21:26:15 -0500] nlloyds2: wamcvey: Is the chef 11 gem installed locally? (`gem list chef`) If it is could you try uninstalling it?
[2013-03-08 21:27:21 -0500] wamcvey: Am I wrong in thinking that 10.x is still the official recommended version of Chef?
[2013-03-08 21:28:17 -0500] wamcvey: nlloyds2: chef-solo is installed and has 11.4.0 loaded.
[2013-03-08 21:28:31 -0500] rep0st: wamcvey: i dunno. 11.4 makes life a bit easier imho
[2013-03-08 21:29:30 -0500] wamcvey: I kind of dread the "check all our cookbooks for compatibility issues" work associated with jumping to a non-backwards compliant version.
[2013-03-08 21:29:55 -0500] nlloyds2: wamcvey: so maybe it's complaining because it's looking for 10.x stuff and you have 11.x installed. I'd try uninstalling the chef 11 versions of gems.
[2013-03-08 21:30:37 -0500] wamcvey: nlloyds2: yeah... as much as I hate to do it, I think I may just default to installing the code via packages.
[2013-03-08 21:32:40 -0500] josephholsten: wamcvey: the only backwards incompatible stuff I've noticed was due to setting node attributes in a dangerous way
[2013-03-08 21:34:42 -0500] wamcvey: Ok... well, I guess the server migration is as good enough reason to bite the bullet and adopt the latest/greatest. I had hoped for a quick migration, but I can probably stage the migration of clients based on role after testing the necessary cookbooks.
[2013-03-08 21:41:15 -0500] test__: Hmm, my encrypted data bags are no longer decrypting
[2013-03-08 21:41:20 -0500] test__: on chef 11
[2013-03-08 21:41:47 -0500] test__: secret = EncryptedDataBagItem.load_secret(SecretFile)
[2013-03-08 21:42:22 -0500] test__: I'm geting undefined method 'unpack for #<Hash...>
[2013-03-08 21:45:33 -0500] mattray: test__: http://docs.opscode.com/breaking_changes_chef_11.html#changes-for-data-bag-encryption ?
[2013-03-08 21:47:06 -0500] test__: @mattray: thanks, i'll look into it
[2013-03-08 21:49:25 -0500] awgross: it looks like node attributes should be accessible in LWRP's after http://tickets.opscode.com/browse/CHEF-1946.  However it is currently only possible to access them when you define resources manually without using LWRP syntax.  LWRP syntax does not have access to run_context, @run_context, or node as described in the ticket (Chef 10.18.2)
[2013-03-08 21:50:02 -0500] josephholsten: anyone care to explain what btm is saying with you can't notify a resource in the recipe from an LWRP. here: http://tickets.opscode.com/browse/COOK-1928
[2013-03-08 21:51:18 -0500] test__: @mattray, yep, all my clients are 10.16, will update
[2013-03-08 21:56:23 -0500] eka: how to do a chmod on a file in a recipe?
[2013-03-08 22:01:13 -0500] josephholsten: mode attribute of a file resource: http://docs.opscode.com/resource_file.html
[2013-03-08 22:01:17 -0500] josephholsten: eka: ^^
[2013-03-08 22:01:19 -0500] ranjibd: eka use the file resource with mode , owner , group attribute
[2013-03-08 22:01:26 -0500] eka: thanks
[2013-03-08 22:02:50 -0500] test__: just updated to 11, to allow read of encrytped data bag, and now get:  NoMethodError: undefined method 'run_list' for nil:NIlClass
[2013-03-08 22:02:58 -0500] test__: on one of my clients
[2013-03-08 22:04:40 -0500] josephholsten: test__: we'll need more info to help, could you gist/pastie us the logs, relevant cookbook files?
[2013-03-08 22:11:19 -0500] awgross: ahh i see, the run_context is available, but you cannot get anything but ohai data when accessing it with the LWRP syntax
[2013-03-08 22:18:22 -0500] test__: When doing    gem update     where current chef is 10.16 to 11.4, major issues occur
[2013-03-08 22:18:35 -0500] test__: after uninstalling, and reinstalling to 11.4, everything runs fine
[2013-03-08 22:18:45 -0500] test__: (the data bags issue)
[2013-03-08 22:21:03 -0500] josephholsten: test__: could you rephrase that as a question?
[2013-03-08 22:22:53 -0500] kryptek: ohai chefs; anyone that can help me troubleshoot a lwrp issue?  I'm getting a "light-weight provider already initialized -- overriding!" error whenever I run chef-client.  It's complaining about the modules in my LWRP
[2013-03-08 22:22:56 -0500] test__: josephholsten: should "gem update" have any issues when upgrade from chef version 10.16 to 11.4 :)
[2013-03-08 22:23:19 -0500] test__: upgrade => upgrading
[2013-03-08 22:23:52 -0500] josephholsten: I had no issues
[2013-03-08 22:23:58 -0500] test__: interesting
[2013-03-08 22:24:02 -0500] test__: i'll try on another node
[2013-03-08 22:24:11 -0500] josephholsten: are you talking about development machines, or servers running chef-client/chef-solo?
[2013-03-08 22:24:40 -0500] kryptek: servers running chef-client
[2013-03-08 22:26:37 -0500] josephholsten: kryptek: that's basically a spurious warning in chef 11 clients, sorry. I think there's a ticket for it.
[2013-03-08 22:27:15 -0500] kryptek: ahh, cool man.  Thanks
[2013-03-08 22:27:22 -0500] kryptek: I was wondering because I never got any warnings with my LWRP before chef 11
[2013-03-08 22:27:44 -0500] kryptek: it still works fine and all
[2013-03-08 22:28:15 -0500] awgross: josephholsten: figured out part of the run context issue in LWRPs
[2013-03-08 22:29:23 -0500] josephholsten: awgross: did you find any docs or example code doing what you want?
[2013-03-08 22:30:06 -0500] miah: kryptek: https://gist.github.com/danielsdeleo/30a8719901eca6545488
[2013-03-08 22:30:08 -0500] awgross: josephholsten: so, run context is available when using LWRP syntax, however default/normal/override attributes are not, just ohai data
[2013-03-08 22:30:48 -0500] kryptek: miah, thanks :)
[2013-03-08 22:30:50 -0500] miah: attributes are usable by recipes to be passed as arguments to resources. but resources can't source them directly.
[2013-03-08 22:30:50 -0500] awgross: josephholsten: however, if you access run context inside a method (using non LWRP syntax) you get access to the compiled node attributes
[2013-03-08 22:31:14 -0500] awgross: miah: apparently they can, just not easily
[2013-03-08 22:31:17 -0500] josephholsten: miah: ooo, neat
[2013-03-08 22:31:30 -0500] miah: awgross: well ya =)
[2013-03-08 22:31:53 -0500] miah: i wouldn't rely on access to role/environment type attributes inside the code. but i might use 'node.fqdn' etc.
[2013-03-08 22:32:06 -0500] awgross: ive apparently wasted my entire day figuring that out
[2013-03-08 22:32:54 -0500] josephholsten: ugh, that makes it hard for me do have the default user/group pull from node attrs in my rsyslog_conf lwrp
[2013-03-08 22:32:58 -0500] awgross: now do I rewrite my resource to just use the old syntax
[2013-03-08 22:33:26 -0500] awgross: josephholsten: its not super hard, just not pure LWRP
[2013-03-08 22:34:05 -0500] josephholsten: I prefer LWRPs not because I find HWRPs hard, but for readability
[2013-03-08 22:34:26 -0500] awgross: josephholsten:  https://gist.github.com/andrewgross/842194b34a3eb80fafa5
[2013-03-08 22:34:33 -0500] awgross: agreed
[2013-03-08 22:34:47 -0500] awgross: i really wish i could just do what the original ticket supposedly 'solved'
[2013-03-08 22:34:49 -0500] josephholsten: oh, I can do that
[2013-03-08 22:35:03 -0500] josephholsten: rather, am okay with that
[2013-03-08 22:35:07 -0500] awgross: fair enough
[2013-03-08 22:35:38 -0500] awgross: beware if you use run_context outside of the method, it will have different values
[2013-03-08 22:37:52 -0500] awgross: josephholsten: note I am on 10.18.2, havent tried it on other distros yet
[2013-03-08 22:38:53 -0500] DeadZen: I have a code suggestion, who could I run that by?
[2013-03-08 22:40:44 -0500] DeadZen: it's for running --sudo with knife
[2013-03-08 22:40:54 -0500] miah: josephholsten: you can just default it to a string. no need to default to a attribute
[2013-03-08 22:41:56 -0500] miah: i mostly prefer hwrp's because its helping me to get a stronger grasp of ruby
[2013-03-08 22:42:01 -0500] josephholsten: miah: it's got different defaults on different platforms (notably different versions of ubuntu. b/c I don't have reason enough to hate everything)
[2013-03-08 22:42:30 -0500] miah: thats fine
[2013-03-08 22:42:36 -0500] miah: you still work past that
[2013-03-08 22:43:00 -0500] josephholsten: miah: does that mean you can explain how the application_* resources actually work? I know ruby well and those this make my eyes cross.
[2013-03-08 22:45:33 -0500] miah: ya. they make mine cross too. i havent spent much time digging through them. just a little. there are some issues that i definitely need to fix in them though
[2013-03-08 22:47:09 -0500] clojureconner: Hi All, how do I get the ohai system attributes in Chef? I somehow did it in one node a while back. Don't remember how.. I have ohai installed on those machines though
[2013-03-08 22:47:47 -0500] josephholsten: clojureconner: eg node['fqdn']
[2013-03-08 22:50:11 -0500] clojureconner: josephholsten: sorry for not mentioning, but I need the status to show up in the chef webserverUI.. like chefserver:4040/status
[2013-03-08 22:50:15 -0500] clojureconner: how do I configure that
[2013-03-08 22:50:59 -0500] josephholsten: the status page isn't really configurable without just hacking that page
[2013-03-08 22:51:12 -0500] clojureconner: ohh!
[2013-03-08 22:51:33 -0500] clojureconner: so what's the procedure to make the status show?
[2013-03-08 22:52:07 -0500] josephholsten: yeah, some folks at my company are working on a project to make a better webui that's json api driven. nothing easy I know of atm.
[2013-03-08 22:55:23 -0500] clojureconner: oh. yup, I don't even know how I did it, but one node shows ever information about it, but others don't. Chef documentation for the webui isn't good
