[2013-03-13 00:11:43 -0400] _ci: How would I open or close a port in EC2 from a cookbook?  Can anyone help with that?
[2013-03-13 00:12:34 -0400] clundquist: bash do "open port  code `how do you open or close a port from the command line?` end
[2013-03-13 00:13:23 -0400] clundquist: was an attempted clever way to say, use a bash block to do what ever you would do on the command line
[2013-03-13 00:13:30 -0400] doomviking: probably some way to access ec2 cli tools...but, messy.
[2013-03-13 00:13:43 -0400] doomviking: what clundquist said
[2013-03-13 00:14:15 -0400] _ci: Sorry.. I wasn't clear in my question.  How do I add or remove a port from an EC2 security group using a cookbook?
[2013-03-13 00:14:36 -0400] clundquist: how do you do it without a cookbook?
[2013-03-13 00:14:46 -0400] doomviking: I do it without a cookbook
[2013-03-13 00:15:36 -0400] _ci: @clundquist through the EC2 web gui
[2013-03-13 00:15:47 -0400] _ci: I haven't done it via api before
[2013-03-13 00:16:14 -0400] doomviking: thats how you would do it.
[2013-03-13 00:16:21 -0400] clundquist: figure out how to do it from bash on your laptop
[2013-03-13 00:16:29 -0400] clundquist: then wrap that in a bash block
[2013-03-13 00:16:36 -0400] _ci: got it
[2013-03-13 00:16:39 -0400] clundquist: or a language of your choice
[2013-03-13 00:16:39 -0400] _ci: super simple
[2013-03-13 00:16:43 -0400] _ci: thanks for the help
[2013-03-13 00:16:50 -0400] clundquist: figuring out how to hit the API is going to be the hard part, yeah
[2013-03-13 00:17:04 -0400] doomviking: not really
[2013-03-13 00:17:09 -0400] clundquist: compared to the chef part :)
[2013-03-13 00:17:18 -0400] Majost: Has anyone seen this error before: [2013-03-12T17:15:16-07:00] FATAL: Chef::Exceptions::RecipeNotFound: could not find recipe postgresql for cookbook database
[2013-03-13 00:17:31 -0400] clundquist: Majost: yes
[2013-03-13 00:17:39 -0400] Majost: clundquist: how might I fix this?
[2013-03-13 00:17:43 -0400] clundquist: you don't have that cookbook in the search path
[2013-03-13 00:17:46 -0400] clundquist: download the cookbook
[2013-03-13 00:17:54 -0400] clundquist: or adjust your search path so it is visible
[2013-03-13 00:17:59 -0400] doomviking: the postgresql cookbook
[2013-03-13 00:18:19 -0400] Majost: the server has the postgresql cookbook, so how can I check the search path
[2013-03-13 00:18:29 -0400] clundquist: nah, it is looking for database::postgresql
[2013-03-13 00:19:58 -0400] _ci: if anyone has a similar question about adding & removing ports in ec2 security groups, this documentation helped me http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/authorizing-access-to-an-instance.html
[2013-03-13 00:20:34 -0400] clundquist: Majost: it is looking for https://github.com/opscode-cookbooks/database/blob/master/recipes/postgresql.rb and can't find it
[2013-03-13 00:20:51 -0400] clundquist: ensure it is in the cookbook_path in solo.rb
[2013-03-13 00:20:57 -0400] clundquist: or uploaded to your chef-server
[2013-03-13 00:25:10 -0400] Majost: ah, yeah
[2013-03-13 00:25:12 -0400] Majost: thanks
[2013-03-13 00:25:13 -0400] Majost: =)
[2013-03-13 00:25:23 -0400] clundquist: sure thing
[2013-03-13 00:29:29 -0400] clundquist: Is there a good way to export the compiled attributes for a node in a chef-solo context?
[2013-03-13 00:45:35 -0400] log1kal: clundquist: you could print `node` from shef -s
[2013-03-13 00:46:11 -0400] log1kal: or your dna.json may have enough for you (believe dna.json is just the chef.json from your Vagrantfile, though)
[2013-03-13 00:56:55 -0400] timsmith: can anyone tell me the difference between node.environment and node.chef_environment
[2013-03-13 01:01:17 -0400] patcon_: join #jenkins
[2013-03-13 01:12:47 -0400] miah: timsmith: https://github.com/opscode/chef/blob/master/lib/chef/node.rb#L109
[2013-03-13 01:13:01 -0400] miah: thats from master, so it might be different in older releases..
[2013-03-13 01:14:35 -0400] timsmith: that's what I figured
[2013-03-13 01:14:38 -0400] timsmith: thanks for finding it
[2013-03-13 01:32:12 -0400] Majost: Did the pg-gem break again with 10.24?
[2013-03-13 01:33:22 -0400] Majost: with the omnibus version that it
[2013-03-13 01:33:23 -0400] Majost: er is
[2013-03-13 01:42:38 -0400] bluekelp: i was testing "what ifs" today and deleted a node+client from the server. the node itself knew nothing of this and so i re-bootstrapped it to ensure we could recover from this case.  all i did was delete /etc/chef/client.pem and re-bootstrap (via knife).  is this going to cause issues? am i missing anything i need to know if we do this outside of a test environment?
[2013-03-13 01:45:27 -0400] log1kal: bluekelp: I do that in production, without issue
[2013-03-13 01:45:36 -0400] log1kal: assuming it's not a special snowflake
[2013-03-13 01:46:23 -0400] miah: no server should ever be a special snowflake
[2013-03-13 01:46:32 -0400] agoddard: bluekelp remember not to clear the run list when re-bootstrapping
[2013-03-13 01:47:17 -0400] log1kal: miah: I agree, but I didn't want to lead bluekelp into that if he had some snowflakes.
[2013-03-13 01:48:31 -0400] log1kal: I'm still trying to get rid of 4 snowflake boxes :(
[2013-03-13 01:49:05 -0400] miah: its a good goal
[2013-03-13 01:49:15 -0400] log1kal: I can chef a node to become one of those snowflakes, but they're not redundant yet, and would have an impact on my job queues
[2013-03-13 01:50:18 -0400] nathenharvey: Chef meetup in Seattle tonight.  Watch the stream here - http://youtu.be/PpKoOMhWBtE
[2013-03-13 01:50:31 -0400] Blackavar: Chef meetup starting: http://www.youtube.com/watch?v=PpKoOMhWBtE&feature=youtu.be for the stream
[2013-03-13 01:50:47 -0400] Blackavar: Heh.
[2013-03-13 01:50:57 -0400] bluekelp: thanks.  good reminder about the run_list
[2013-03-13 01:51:08 -0400] bluekelp: in this case the node was just a test for bootstrapping
[2013-03-13 01:51:55 -0400] bluekelp: what are best practices for managing the "infrastructure in the large" - e.g. sort of like what AWS Cloud Formation does?  trying to determine where knowledge of every node (and their run_lists) lives
[2013-03-13 01:52:00 -0400] bluekelp: so it can be versioned, etc.
[2013-03-13 01:55:56 -0400] log1kal: Hi Seattle meetup
[2013-03-13 01:59:07 -0400] miah: hullo seattles. i hope the rain is treating you well!
[2013-03-13 02:00:17 -0400] Blackavar: *wave* back down that way.
[2013-03-13 02:16:41 -0400] iverson0881: hey
[2013-03-13 02:17:19 -0400] iverson0881: so i have something like <%= chef var %>:<%= another chef var %>string
[2013-03-13 02:17:28 -0400] iverson0881: inside of a for loop
[2013-03-13 02:17:43 -0400] iverson0881: however i'd like to output that into a command separated list using something like .join(',')
[2013-03-13 02:18:12 -0400] iverson0881: however i'm not sure how to do that with the breakup of ruby code and template specific syntax
[2013-03-13 02:26:59 -0400] bluekelp: iverson0881: is this general ruby Q or something inside a recipe?
[2013-03-13 02:27:22 -0400] iverson0881: bluekelp: this is inside a template actuallly
[2013-03-13 02:27:40 -0400] iverson0881: bluekelp: its a bit of both inside a template and writing ruby
[2013-03-13 02:28:08 -0400] bluekelp: can you gist something? i'm not uber ruby dude but might be able to help
[2013-03-13 02:33:56 -0400] iverson0881: bluekelp: will do
[2013-03-13 02:35:04 -0400] iverson0881: bluekelp: something like this: https://gist.github.com/omerhasan/82f31732add93d045149
[2013-03-13 02:37:05 -0400] bluekelp: so you want the array to contain elements like localhost:123, foo:234, etc.?
[2013-03-13 02:37:14 -0400] bluekelp: the session.save_path, i mean
[2013-03-13 02:37:39 -0400] iverson0881: yeah but to also contain the "persistent=1&amp;weight=1&amp;timeout=1&amp;retry_interval=3&amp;sess_locking=Off"
[2013-03-13 02:40:34 -0400] bluekelp: there might be a syntax error lurking but something like this? https://gist.github.com/bluekelp/30cf9c7d14a750e6629d
[2013-03-13 02:44:20 -0400] iverson0881: bluekelp: thanks will try it out
[2013-03-13 02:51:32 -0400] iverson0881: bluekelp: yeah that worked really well. i always forget about the ability to put variables into quotes
[2013-03-13 02:51:59 -0400] bluekelp: glad i could help
[2013-03-13 02:52:04 -0400] iverson0881: bluekelp: thank you!
[2013-03-13 03:56:09 -0400] dmiller: hi all, how do I change the location of the cookbook repo? knife is currently looking in /var/chef/cookbooks but I want it to look at ~/cookbooks (or something like that)
[2013-03-13 03:59:11 -0400] brianseeders: http://docs.opscode.com/config_rb_knife.html
[2013-03-13 03:59:17 -0400] brianseeders: cookbook_path is probably what you want
[2013-03-13 03:59:26 -0400] brianseeders: (dmiller)
[2013-03-13 04:00:15 -0400] dmiller: brianseeders: ahh, thank you sir. That was surprisingly difficult to google for
[2013-03-13 05:33:48 -0400] jhammerman: Hi Chef IRC - does anyone know how (or can point me to a Wiki to get started on researching) to perform a reverse DNS lookup and store the result in a variable in a recipe?
[2013-03-13 05:48:16 -0400] miah: jhammerman: its ruby. so if you can figure out how to do that then you're answer is solved.
[2013-03-13 05:48:38 -0400] miah: http://www.ruby-doc.org/stdlib-1.9.3/libdoc/socket/rdoc/Socket.html
[2013-03-13 05:48:49 -0400] jhammerman: miah:Yeah, been digging in since I asked the question, it looks like I want a command block
[2013-03-13 05:49:03 -0400] jhammerman: which I will probably do in BASH, since that will be fast :p
[2013-03-13 05:49:57 -0400] gleam: there's also resolv::dns
[2013-03-13 05:50:07 -0400] jhammerman: So I want to some thing like this: prod_ip_addr=`host node['hostname'].prod.mydomain`
[2013-03-13 05:50:37 -0400] jhammerman: But Iam wondering about string concatenation and escaping the node attribute to allow them to expand
[2013-03-13 05:51:36 -0400] jhammerman: gleam:Do you have a link?
[2013-03-13 05:52:00 -0400] miah: ohai also provides chef with the nodes public ip address
[2013-03-13 05:52:52 -0400] gleam: http://www.ruby-doc.org/stdlib-1.9.3/libdoc/resolv/rdoc/Resolv/DNS.html
[2013-03-13 05:53:05 -0400] miah: gleam: indeed. i often forget that one
[2013-03-13 05:58:25 -0400] jhammerman: miah: yes, but I need the address that has not been assigned to the first NIC. If I can get it w / reverse DNS, than I can write it out to form bond0. If not, I'll have to create a data bag with the prod IP address of every box (which I really don't want to do)
[2013-03-13 05:58:35 -0400] jhammerman: gleam:thank you, looking now
[2013-03-13 06:02:37 -0400] jhammerman: gleam:looks perfect. Thanks!
[2013-03-13 06:09:46 -0400] jhammerman: Hey if you guys are still there, is this a reasonable facsimile of what I'm trying to achieve?
[2013-03-13 06:09:48 -0400] jhammerman: ruby_block "prod_ip" do
[2013-03-13 06:09:48 -0400] jhammerman:         block do
[2013-03-13 06:09:48 -0400] jhammerman:                 prod_ip=resolv::dns("#{node['hostname']}.prod.ihr)
[2013-03-13 08:48:12 -0400] pixie79: hi all - would it be valid to write the following in a chef template:     ldapUser    = <%= node[:authconfig][:ldap][:dnbind].sub(/cn=/,'') %>
[2013-03-13 08:48:40 -0400] pixie79: as I need the value of node[:authconfig][:ldap][:dnbind] but without the leading 'cn='
[2013-03-13 09:13:03 -0400] Mithrandir: pixie79: it's generally a bad idea to use node in templates, since exceptions will be swallowed.  I'd recommend pushing it as a variable in the template definition.
[2013-03-13 09:15:45 -0400] mahrob: Hi Guys
[2013-03-13 09:15:52 -0400] mahrob: looking for some chef help!
[2013-03-13 09:16:46 -0400] mahrob: is anyone available?
[2013-03-13 09:18:36 -0400] mahrob: Guys, I am new to this, so I don't know if anyone is online or not
[2013-03-13 09:23:45 -0400] pixie79: Mithrandir: not sure what you mean, i had just been copying other templates here,
[2013-03-13 09:24:16 -0400] pixie79: mahrob: best to state your question - then if people know the answer or are free to help they will :)
[2013-03-13 09:24:54 -0400] Mithrandir: pixie79: use template "foo" do \n variables({ldapuser => node[:authconfig][:ldap][:dnbind].sub(/cn=/,'') }) \n end ; and then <%= @ldapUser %> in the template.
[2013-03-13 09:25:15 -0400] mahrob: Thanks, my issue is Chef Cookbook Compilation Error While Bootstrapping The Node
[2013-03-13 09:26:26 -0400] mahrob: Net::HTTPServerException  ------------------------  404 "Not Found"  Cookbook Trace:  ---------------    /var/chef/cache/cookbooks/webapps-configs/recipes/httpd.rb:12:in `from_file'  Relevant File Content:  ----------------------  /var/chef/cache/cookbooks/webapps-configs/recipes/httpd.rb:    10:   11:  CHEF_ENV = node.chef_environment   12>> http_ssl_creds = Chef::EncryptedDataBagItem.load("#{CHEF_ENV}", "http-ssl")
[2013-03-13 09:26:46 -0400] mahrob: This is the error that I am getting while bootstrapping the node
[2013-03-13 09:26:52 -0400] pixie79: Mithrandir: ok thanks - i think i have seen that and know understand what you mean
[2013-03-13 09:28:07 -0400] pixie79: mahrob: have you uploaded the encrypted databag? and told the server you are bootstrapping how to find the secret key ?
[2013-03-13 09:28:47 -0400] mahrob: pixie79: yes, the secret key is on the node server in /etc/chef/
[2013-03-13 09:29:25 -0400] mahrob: I have also added the encrypted key path in my knife.rb and that gets included in client.rb
[2013-03-13 09:29:58 -0400] pixie79: mahrob: it needs to be on the transfered to the client before you try and access the databag - but the error looks like you cant find the databag on the server
[2013-03-13 09:31:52 -0400] mahrob: so before bootstrapping the node, I have to transfer the secret key on the node?
[2013-03-13 09:36:06 -0400] mahrob: pixie79: but since chef-client is not installed on the node before I bootstrap it, so do I have to manually create /etc/chef directory on node
[2013-03-13 10:46:28 -0400] f1gjam: hey guys, anyone here using chef cookbook windows
[2013-03-13 10:46:39 -0400] f1gjam: i am having an issue with windows_package
[2013-03-13 11:41:30 -0400] akamaus: hi all. Something strange happening to my chef-server. Accepting search functionality inside a receipt usually freezes a chef-client. knife index rebuild freezes too. Uploading cookbooks and roles work unreliable too. I'm using chef server version 10.18.0-1 on ubuntu lucid. Could you please give an advice?
[2013-03-13 11:48:05 -0400] ucb: g'day all
[2013-03-13 11:48:44 -0400] ucb: I'm not sure what's broken with my chef install but after I upgraded it I now get ERROR: JSON::ParserError: Unsupported `json_class` type 'Symbol' on commands like "knife node show XXXX"
[2013-03-13 11:48:59 -0400] ucb: additionally, other knife commands work just fine, e.g. knife role show XXXX
[2013-03-13 11:49:03 -0400] ucb: any thoughts on this?
[2013-03-13 12:51:47 -0400] aaa: hi can someone explain why I'm getting a syntax error in this "execute "enable-nagios-notifications" do   action :nothing   command <<-EOF     echo "[`date +%s`] ENABLE_NOTIFICATIONS" > /var/lib/nagios3/rw/nagios.cmd && \     echo "[`date +%s`] START_EXECUTING_SVC_CHECKS" > /var/lib/nagios3/rw/nagios.cmd \   EOF end"
[2013-03-13 12:53:43 -0400] aaa: how is EOF meant to be used? is it "command <<-EOF" or "command << -EOF" or "command << - EOF" ?
[2013-03-13 13:07:01 -0400] maruq: hi guys
[2013-03-13 13:07:31 -0400] maruq: lazy web question - when using knife ec2 server create, how do I specify the ephemeral storage size?
[2013-03-13 13:11:57 -0400] maruq: or is that automagically implied based on the available instance storage for the instance type?
[2013-03-13 13:12:49 -0400] Guest8814: Does chef let a person manage config files accross servers?
[2013-03-13 13:15:22 -0400] emanuelez: hello there. is there a standard way to put private keys in an encrypted data bag
[2013-03-13 13:15:23 -0400] maruq: answered my own question - http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html
[2013-03-13 13:16:06 -0400] maruq: Guest8814: yes, you could either use a file or template resource inside your recipe.
[2013-03-13 13:19:04 -0400] zrth: setup porblem - i followed ever step in http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide
[2013-03-13 13:19:22 -0400] zrth: when setting up a server i get : ERROR: Fog::Compute::AWS::NotFound: The key pair 'id_rsa' does not exist
[2013-03-13 13:19:38 -0400] zrth: the key name is the right one
[2013-03-13 13:19:50 -0400] zrth: any ideas where to look for the problem ?
[2013-03-13 13:20:38 -0400] zrth: the command used was: knife ec2 server create -I  ami-b89842d1  -G default    # allso -i and -S and -i + -S do not solve the problem
[2013-03-13 13:23:39 -0400] maruq: zrth: I'm running with "knife ec2 server create -I ami-123456 -x ubuntu -G ec2-secgrp -i ~/.ssh/ec2-key.pem -S ec2-keyname"
[2013-03-13 13:24:28 -0400] maruq: zrth: -x sets the user, but it sounds more that it can't find your key / ec2 doesn't know your keyname
[2013-03-13 13:26:37 -0400] zrth: ubuntu@chef:~/.chef$ knife ec2 server create -I  ami-b89842d1  -x ubuntu -i ~/.ssh/id_rsa -S id_rsa
[2013-03-13 13:26:40 -0400] zrth: ERROR: Fog::Compute::AWS::NotFound: The key pair 'id_rsa' does not exist
[2013-03-13 13:26:43 -0400] zrth: ubuntu@chef:~/.chef$ ls ~/.ssh/id_rsa
[2013-03-13 13:26:45 -0400] zrth: /home/ubuntu/.ssh/id_rsa
[2013-03-13 13:29:43 -0400] maruq: zrth: hmm permissions?
[2013-03-13 13:30:17 -0400] maruq: oh, -S id_rsa should be the name AWS knows your key by
[2013-03-13 13:30:18 -0400] zrth: maruq: 400
[2013-03-13 13:30:49 -0400] zrth: maruq: in aws the ley is knowen as "id_rsa"
[2013-03-13 13:32:01 -0400] maruq: hmm but you can create the node fine using ec2-run-instances ?
[2013-03-13 13:34:19 -0400] maruq: zrth: I also set knife[:aws_access_key_id] , knife[:aws_secret_access_key] & knife[:aws_ssh_key_id] in my .chef/knife.rb
[2013-03-13 13:35:17 -0400] zrth: maruq: i also set those 3 values... , did not try the ec2-run-instances yet, doing so now
[2013-03-13 13:35:41 -0400] maruq: zrth: yeah, I would confirm the underlying AWS stuff is working first
[2013-03-13 13:36:01 -0400] maruq: otherwise I think the only other difference is that I have my key as 644.
[2013-03-13 13:36:16 -0400] maruq: I probably shouldn't have, but I do for some reason
[2013-03-13 13:40:22 -0400] zrth: maruq: can you past me the line you use with  ec2-run-instances ?
[2013-03-13 13:43:13 -0400] null_route: Hey guys! how do I set up the omnibus install to NOT install webui?
[2013-03-13 13:45:44 -0400] maruq: zrth: ec2-run-instances ami-123456 -k id_rsa -g ec2-secgrp
[2013-03-13 13:49:41 -0400] zrth: maruq:  -K or -k ?
[2013-03-13 13:50:57 -0400] maruq: lowercase
[2013-03-13 13:51:49 -0400] maruq: uppercase K = the key file, lowercase k = key pair name
[2013-03-13 13:55:57 -0400] Guest8814: change nick
[2013-03-13 13:57:26 -0400] geekbri: weird, looks like one of my hosted chef nodes normal attribute data got corrupted overnight
[2013-03-13 14:02:30 -0400] null_route: I just installed a fresh Chef server using 11.x - My next step would normally be to create client -
[2013-03-13 14:02:40 -0400] null_route: knife configure -i
[2013-03-13 14:02:47 -0400] null_route: is that still relavent?
[2013-03-13 14:02:53 -0400] rep0st: null_route: yes
[2013-03-13 14:02:58 -0400] null_route: IS my chef server supposed to be listening on port 4000 ?
[2013-03-13 14:03:04 -0400] rep0st: null_route: not with chef 11
[2013-03-13 14:03:19 -0400] rep0st: null_route: i think it might've been an oversight. Just replace the server url with https:// and remove port 4000
[2013-03-13 14:03:30 -0400] null_route: ahhh.
[2013-03-13 14:03:32 -0400] null_route: cool!
[2013-03-13 14:03:42 -0400] null_route: that's the WebUI, or the chef?
[2013-03-13 14:03:56 -0400] rep0st: null_route: that's for everything
[2013-03-13 14:04:03 -0400] null_route: cool.
[2013-03-13 14:04:06 -0400] rep0st: null_route: webui will be going to 443 and all clients will be pulling on 443
[2013-03-13 14:04:35 -0400] null_route: can I disable the webui interface for security/simplicity?
[2013-03-13 14:04:44 -0400] null_route: (I used to not install the .deb)
[2013-03-13 14:06:00 -0400] rep0st: null_route: i'm not sure about disabling the webinterface. I personally think it's nice to have as long as it's behind a firewall.
[2013-03-13 14:06:55 -0400] null_route: rep0st: I'm kinda' new to chef, but if I manage the cookbooks through Git, woin't the web interface break things?
[2013-03-13 14:07:07 -0400] null_route: (managing through GIT is the accepted way, anyway, no?)
[2013-03-13 14:07:29 -0400] Azrael: hmmmm
[2013-03-13 14:07:40 -0400] gchristensen: null_route: yes, changing stuff in the web interface vs. changing stuff via Git are exclusive
[2013-03-13 14:07:49 -0400] Azrael: looks like ohai is borked for lxc guests
[2013-03-13 14:07:56 -0400] Azrael: cant figure out the ipaddress
[2013-03-13 14:08:40 -0400] rep0st: null_route: the web interface is nice to immediately identify what's what in a cookbook, create users and grab private keys, etc. I personally don't make any changes directly to the chef server. I make changes locally and commit them to my git repo.
[2013-03-13 14:09:03 -0400] null_route: ok
[2013-03-13 14:09:37 -0400] rep0st: null_route: we're  a visual people the web interface is a good way to get an answer quick. Managing your cookbooks should be done in version control in my honest opinion
[2013-03-13 14:11:29 -0400] null_route: we've been using git from the get-go -
[2013-03-13 14:11:55 -0400] null_route: anywayh -
[2013-03-13 14:12:01 -0400] null_route: OK - I have teh client created, but it doesn't show up
[2013-03-13 14:12:05 -0400] null_route: how do I re-index the client list?
[2013-03-13 14:15:07 -0400] null_route: chef-server-ctl reindex
[2013-03-13 14:16:25 -0400] null_route: hmmm...
[2013-03-13 14:17:00 -0400] null_route: I see that there are now chef "user" instead of clients.
[2013-03-13 14:31:56 -0400] pikesley: help! please! https://gist.github.com/pikesley/5152648
[2013-03-13 14:32:02 -0400] pikesley: weird, weird fail there
[2013-03-13 14:33:47 -0400] awgross: that is weird, no clue myself
[2013-03-13 14:35:22 -0400] pikesley: EVERYTHING ELSE WORKS!!!
[2013-03-13 14:35:24 -0400] pikesley: BAH!
[2013-03-13 14:37:03 -0400] knuckolls_: pikesley: yep that's wild. nuke it from space.
[2013-03-13 14:37:21 -0400] pikesley: nuke what?
[2013-03-13 14:37:28 -0400] pikesley: IT WORKS IN TEST!
[2013-03-13 14:40:47 -0400] pikesley: why does it give me a 403?
[2013-03-13 14:40:55 -0400] pikesley: but only for that?
[2013-03-13 14:49:09 -0400] f1gjam: hey guys, I have issues with opscode windows cookbook, specifically the package_name
[2013-03-13 14:49:25 -0400] f1gjam: when installing sql server, it all goes well and installs however i get and issue right at the end
[2013-03-13 14:50:00 -0400] null_route: I'm about to go bring up a second Chef server - one at our production site, and one in the office. Does anyone else out there have a similar setup?
[2013-03-13 14:50:11 -0400] f1gjam: [2013-03-13T13:59:26+00:00] FATAL: NameError: windows_package[Microsoft SQL Server 2012 (64-bit)] (sql_server_2012::sqlServer line /chef/cache/cookbooks/sql_server_2012/recipes/sqlServer.rb) had an error: NameError: uninitialized constant Mixlib::ShellOut::Exceptions
[2013-03-13 14:50:11 -0400] f1gjam: [2013-03-13T13:59:26+00:00] FATAL: NameError: windows_package[Microsoft SQL Server 2012 (64-bit)] (sql_server_2012::sqlServer line /chef/cache/cookbooks/sql_server_2012/recipes/sqlServer.rb) had an error: NameError: uninitialized constant Mixlib::ShellOut::Exceptions
[2013-03-13 14:50:11 -0400] f1gjam: [2013-03-13T13:59:26+00:00] FATAL: NameError: windows_package[Microsoft SQL Server 2012 (64-bit)] (sql_server_2012::sqlServer line /chef/cache/cookbooks/sql_server_2012/recipes/sqlServer.rb) had an error: NameError: uninitialized constant Mixlib::ShellOut::Exceptions
[2013-03-13 14:50:15 -0400] f1gjam: whoops sorry
[2013-03-13 14:50:17 -0400] null_route: ...and am I abouut to enter a world of pain?
[2013-03-13 14:50:44 -0400] f1gjam: why would that be a pain
[2013-03-13 14:51:05 -0400] f1gjam: null_route, you just need to decide how (once the internal office cookbooks are ready) you would put them in the production one
[2013-03-13 14:51:13 -0400] f1gjam: so more of a process/packaging issue
[2013-03-13 14:51:14 -0400] null_route: dunno. I'm thinking about what happens when I "git pull" and "knife upload" on the production server after a few weeks
[2013-03-13 14:51:35 -0400] f1gjam: configure knife default to point to your local internal chef
[2013-03-13 14:51:42 -0400] f1gjam: and then create second knife file
[2013-03-13 14:51:52 -0400] f1gjam: which you HAVE to pass via the -c flag for knide
[2013-03-13 14:51:54 -0400] f1gjam: knife
[2013-03-13 14:52:05 -0400] f1gjam: that what you CANNOT do knife upload to the wrong server
[2013-03-13 14:52:24 -0400] f1gjam: so you would work normally knife cookbook upload myCookbook
[2013-03-13 14:52:36 -0400] f1gjam: that would send it to your internal chef server (default config
[2013-03-13 14:52:39 -0400] null_route: f1gjam: that's a great idea - how does that compare with how I'm doing it - by managing a separate cookbook directory ( on a different server)
[2013-03-13 14:52:54 -0400] null_route: ...and using git to sync changes when I'm ready?
[2013-03-13 14:53:05 -0400] f1gjam: that would work also...
[2013-03-13 14:53:26 -0400] null_route: as they say, TMTWWTDI :-)
[2013-03-13 14:53:33 -0400] f1gjam: ??
[2013-03-13 14:53:39 -0400] null_route: (it's a PERL thing :-) )
[2013-03-13 14:53:44 -0400] f1gjam: lol ;)
[2013-03-13 14:53:57 -0400] matti: Ruby's too.
[2013-03-13 14:54:08 -0400] null_route: matti: oh, phew - I thought I'd be stoned :-)
[2013-03-13 14:54:11 -0400] f1gjam: so back to my quesiton
[2013-03-13 14:54:15 -0400] matti: null_route: ;p
[2013-03-13 14:54:20 -0400] f1gjam: anyone used windows cookbook
[2013-03-13 14:54:32 -0400] f1gjam: this error is getting my my ****
[2013-03-13 14:54:33 -0400] f1gjam: [2013-03-13T13:59:26+00:00] FATAL: NameError: windows_package[Microsoft SQL Server 2012 (64-bit)] (sql_server_2012::sqlServer line /chef/cache/cookbooks/sql_server_2012/recipes/sqlServer.rb) had an error: NameError: uninitialized constant Mixlib::ShellOut::Exceptions
[2013-03-13 14:55:31 -0400] null_route: does debug give any more clues?
[2013-03-13 14:55:38 -0400] f1gjam: nope
[2013-03-13 15:00:31 -0400] dpollen: Hey is there a reliable way to force a Mysql root password change with a cookbook?
[2013-03-13 15:03:19 -0400] wamilton: anyone have advice for writing cookbooks to work properly when operating on files in nfs shares?
[2013-03-13 15:04:47 -0400] wamilton: e.g., I want to use the same cookbook to provision a vagrant to serve my application as I use to provision the production server, but I can't set ownership on nfs shares...
[2013-03-13 15:15:42 -0400] knuckolls_: this pull request is good to go and has positive feedback both in github and in jira. I was hoping we could get it merged into knife-ec2 master today. :) http://tickets.opscode.com/browse/KNIFE-190  https://github.com/opscode/knife-ec2/pull/93 can anyone from opscode go ahead and hit the button? jtimberman?
[2013-03-13 15:19:33 -0400] geekbri: You should ask them to review it during the next code review
[2013-03-13 15:19:39 -0400] geekbri: they just did one yesterday
[2013-03-13 15:20:17 -0400] knuckolls_: geekbri: that's good to know. who should i ask? just in here? email somewhere?
[2013-03-13 15:20:33 -0400] geekbri: um, yeah i mean asking in here is fine, bmt / jtimberman are always at the code reviews
[2013-03-13 15:20:38 -0400] geekbri: so certainlyt hey aren't bad people to ask :)
[2013-03-13 15:21:25 -0400] knuckolls_: well hey btm / jtimberman, can we queue up KNIFE-190 for the next code review?
[2013-03-13 15:21:27 -0400] knuckolls_: done.
[2013-03-13 15:21:32 -0400] knuckolls_: thanks geekbri. :)
[2013-03-13 15:21:38 -0400] geekbri: np :)
[2013-03-13 15:32:41 -0400] ShawnMcCool: Hey guys, sorry to bother. I have hosted chef running and all is well.. I'm curious as to how I would go about setting up an environment that uses a drastically old version of PHP. Any tips on how to approach this?
[2013-03-13 15:33:32 -0400] nkts: why you need very old php?
[2013-03-13 15:33:42 -0400] ShawnMcCool: because i think it's better than new php
[2013-03-13 15:33:53 -0400] nkts: old software comes with old bugs/security holes..
[2013-03-13 15:34:02 -0400] wamilton: ShawnMcCool: the php cookbook lets you compile from source and lets you install it with your package manager, and there are cookbooks for managing your package manager
[2013-03-13 15:34:11 -0400] ShawnMcCool: joking of course, it's because there's a legacy system that need to be maintained and i don't want new constructs to accidentally slip through deelopment
[2013-03-13 15:35:03 -0400] ShawnMcCool: wamilton So a best-practice would be to have it compiled from source? that makes sense.
[2013-03-13 15:37:03 -0400] wamilton: ShawnMcCool: see https://github.com/opscode-cookbooks/php/blob/master/recipes/source.rb#L43 ... you just need a url with the php source you wish to use
[2013-03-13 15:39:07 -0400] wamilton: ShawnMcCool: the alternative would be eg if on debian, use the apt cookbook to pin the package versions, but that would get hairy fast as you may butt up against the package requirements for the apache php extension
[2013-03-13 15:39:29 -0400] ShawnMcCool: i see, thanks for your help, that gives me a direction to pursue
[2013-03-13 15:46:36 -0400] danielle_: does anyone know if spice weasel supports kvm?
[2013-03-13 15:49:50 -0400] knuckolls_: danielle_: what do you want it to do with kvm?
[2013-03-13 15:51:12 -0400] danielle_: knuckolls, https://github.com/rubiojr/knife-kvm
[2013-03-13 15:53:08 -0400] knuckolls_: danielle_: well we just released knife-whisk, which is similar in spirit to spiceweasel but i think better suited for working specifically with nodes. right now it spits out knife ec2 commands but it's on the docket to make it agnostic. if you'd like to use knife-whisk with kvm, i'll do the work today to make it more general. :) https://github.com/Banno/knife-whisk
[2013-03-13 15:54:22 -0400] danielle_: Would that work on rackspace too?
[2013-03-13 15:54:55 -0400] knuckolls_: sure. it's just a way to store config flags, group them as mixins, and then spit them out on the command line with overrides
[2013-03-13 15:55:13 -0400] knuckolls_: i found that often i just want a small variation of a server, so now we just ask whisk
[2013-03-13 15:56:19 -0400] dnoggle: Hi Knuckolls, I work with Danielle
[2013-03-13 15:56:24 -0400] dnoggle: knife-whisk looks very nice
[2013-03-13 15:56:33 -0400] knuckolls_: thanks :)
[2013-03-13 15:56:47 -0400] null_route: Can anyone translate this to Chef11 syntax: node[:mongos][:confServers].join(',')
[2013-03-13 15:56:54 -0400] dnoggle: I imagine this is your project?
[2013-03-13 15:56:55 -0400] null_route: works happily in chef 10
[2013-03-13 15:57:23 -0400] knuckolls_: dnoggle: i had the vision for it, yes. one of my co-workers implemented it as part of getting him up to speed on chef.
[2013-03-13 15:57:33 -0400] dnoggle: ok
[2013-03-13 15:57:47 -0400] null_route: hmmmm
[2013-03-13 15:58:27 -0400] knuckolls_: dnoggle: what i want to add is support for spitting out commands for different providers, but without coupling it to any specific one. you should be able to just put whatever flags in the yml file you want.
[2013-03-13 15:58:53 -0400] knuckolls_: dnoggle: it's not a lot of work, we just got it working for us and pushed it out to the community yesterday to see if there was any interest
[2013-03-13 15:59:18 -0400] dnoggle: knuckolls: oh wow, what timing haha
[2013-03-13 15:59:42 -0400] nlloyds2: null_route: That should be OK in chef 11, as long as node[:mongos][:confServers].respond_to?(:join) is true
[2013-03-13 16:00:17 -0400] nlloyds2: null_route: what's the value of node[:mongos][:confServers] ?
[2013-03-13 16:00:41 -0400] null_route: nlloyds2: lemme go verify that it really has a value....
[2013-03-13 16:00:45 -0400] null_route: :-)
[2013-03-13 16:01:39 -0400] knuckolls_: dnoggle, danielle_: i'll put a little more thought into how i want the whisk.yml file to look for supporting multiple providers
[2013-03-13 16:02:08 -0400] knuckolls_: pm me with your contact information if you want me to ping you when i get it taken care of :)
[2013-03-13 16:02:14 -0400] danielle_: Okay, cool, thank you
[2013-03-13 16:03:21 -0400] null_route: nlloyds2: The maps is coming from the environment
[2013-03-13 16:03:25 -0400] null_route: could that have something to do with it?
[2013-03-13 16:04:09 -0400] nlloyds2: null_route: maps?
[2013-03-13 16:04:13 -0400] null_route: yeah
[2013-03-13 16:04:18 -0400] null_route: JSON
[2013-03-13 16:04:51 -0400] nlloyds2: null_route: I don't think it would make a difference. Are you getting an error from that?
[2013-03-13 16:05:06 -0400] null_route: [2013-03-13T16:01:45+00:00] FATAL: NoMethodError: Undefined node attribute or method `join' on `node'
[2013-03-13 16:07:21 -0400] nlloyds2: null_route: ohhhh
[2013-03-13 16:07:50 -0400] null_route: nlloyds2: ?
[2013-03-13 16:07:50 -0400] nlloyds2: null_route: what does node[:mongos][:confServers].to_a do?
[2013-03-13 16:08:10 -0400] nlloyds2: null_route: It looks like it thinks join is an attribute
[2013-03-13 16:09:11 -0400] null_route: hmmm
[2013-03-13 16:09:16 -0400] null_route: Hmmm
[2013-03-13 16:09:23 -0400] null_route: got farther in the chef run.
[2013-03-13 16:09:34 -0400] null_route: checking debug output
[2013-03-13 16:10:38 -0400] null_route: i'll go and fix this next issue, and we'll see.
[2013-03-13 16:10:43 -0400] null_route: Thanks, nlloyds2 !!!!
[2013-03-13 16:11:00 -0400] null_route: nlloyds2: is that a *bug*
[2013-03-13 16:11:53 -0400] nlloyds2: null_route: No prob. I think it could be a bug, since you would never do node.my.cool.attr.ibute.with("some args")
[2013-03-13 16:18:12 -0400] nlloyds2: null_route: http://tickets.opscode.com/browse/CHEF-3850 looks similar, but was deemed to be caused by something else. It looks like the way you were doing it was correct. \_()_/
[2013-03-13 16:19:20 -0400] null_route: heh -
[2013-03-13 16:19:32 -0400] null_route: unfortunately, it returned nothing
[2013-03-13 16:19:44 -0400] null_route: as if node was null
[2013-03-13 16:19:51 -0400] null_route: need to figure out why
[2013-03-13 16:19:59 -0400] null_route: PErhaps this is related to the Chef 11 change
[2013-03-13 16:20:11 -0400] null_route: with no more implicit default attributes?
[2013-03-13 16:30:48 -0400] null_route: hmmmm
[2013-03-13 16:30:53 -0400] null_route: I don't know -
[2013-03-13 16:31:04 -0400] null_route: it seems to take the key:value, but not the array
[2013-03-13 16:35:31 -0400] null_route: nlloyds2: I have a hit
[2013-03-13 16:35:33 -0400] null_route: hint*
[2013-03-13 16:35:46 -0400] null_route: The array was configured in the environment
[2013-03-13 16:36:15 -0400] null_route: I just noticed that there was a map configured in the node itself mongos: { mongoConf: {} }
[2013-03-13 16:36:31 -0400] null_route: I don't know where it came from :-(
[2013-03-13 16:38:11 -0400] hikeit: does the attributes/default use "set" instead of "default" ?
[2013-03-13 16:38:47 -0400] null_route: ...but after getting rid of it, the join worked (even without to_a). It probably came from me running the chef run without the environment defined (as such, had no node[mongos][confServers]
[2013-03-13 16:39:02 -0400] null_route: hikeit: it's configured inside the JSON
[2013-03-13 16:43:45 -0400] null_route: Thank you all!
[2013-03-13 16:45:43 -0400] nlloyds2: Imagine that, a data integrity problem related to MongoDB :D
[2013-03-13 16:47:24 -0400] c-lui: can I put a log block into a ruby_block ? Or can a variable be set in a ruby_block and used outside it ?
[2013-03-13 16:52:49 -0400] ranjibd: c-lui: you can use Chef::Log.info/debug/error/ etc in side the ruby block
[2013-03-13 16:57:28 -0400] c-lui: thanks !
[2013-03-13 17:15:34 -0400] morete: hello all
[2013-03-13 17:15:36 -0400] morete: hi jespada_ :)
[2013-03-13 17:16:03 -0400] morete: quick question.. does the "group" resource allow multiple users on the "members" attribute?
[2013-03-13 17:16:12 -0400] morete: so I want to append multiple users to a group
[2013-03-13 17:16:24 -0400] morete: can I do :
[2013-03-13 17:16:31 -0400] morete: members: "user1,user2"
[2013-03-13 17:16:33 -0400] morete: ?
[2013-03-13 17:16:54 -0400] morete: examples I found are always listing a single user
[2013-03-13 17:17:21 -0400] morete: documentation is expressed in plural... so I assume it should be possible... could someone confirm?
[2013-03-13 17:18:37 -0400] nlloyds: morete: It can be a string or array, so "user1" or ["user1", "user2"]. Source: https://github.com/opscode/chef/blob/master/lib/chef/resource/group.rb#L55-L62
[2013-03-13 17:19:36 -0400] morete: nlloyds: awesome... will give it a go ;) thanks!
[2013-03-13 17:22:46 -0400] morete: nlloyds: excellent... worked like a charm :) thanks again
[2013-03-13 17:23:55 -0400] nlloyds: morete: No prob. I'm making a note to get this mentioned on http://docs.opscode.com/chef/resources.html#id46
[2013-03-13 17:24:41 -0400] morete: yes please... that would add some extra awesomeness points ;)
[2013-03-13 17:27:04 -0400] nlloyds: And some docs about how to contribute to the docs :)
[2013-03-13 17:34:41 -0400] pcn: ohai chefs
[2013-03-13 17:34:53 -0400] pcn: For opscode, can you fix the chefconf pages?
[2013-03-13 17:34:55 -0400] pcn: http://chefconf.opscode.com/register/
[2013-03-13 17:35:38 -0400] pikesley: OMFG CHEF-POWERED CONTINUOUS DEPLOYMENT FROM COLD
[2013-03-13 17:35:38 -0400] faustroll: jtimberman: I'm following your lead from that apt cookbook
[2013-03-13 17:35:41 -0400] pcn: s/2012/2013/
[2013-03-13 17:36:42 -0400] faustroll: jtimberman: I now have a _test cookbook that has test specific recipes with test specific attributes
[2013-03-13 17:37:00 -0400] faustroll: jtimberman: I'm liking it
[2013-03-13 17:37:40 -0400] faustroll: jtimberman: thanks for the work on 0.7 : well done
[2013-03-13 17:44:44 -0400] faustroll: jtimberman: test-kitchen 0.7 that is. your apt cookbook was enough to lead me in the right direction. well done
[2013-03-13 17:45:05 -0400] jtimberman: faustroll: awesome
[2013-03-13 17:48:10 -0400] jtimberman: pcn: we'll get that fixed. thanks!
[2013-03-13 17:48:21 -0400] jtimberman: pcn: I'm told we're going to party like it's 2012 though ;)
[2013-03-13 17:52:44 -0400] doomviking: oh dear
[2013-03-13 18:07:19 -0400] mgalkiewicz: Hi I try to use LWRP from opscode cookbook rabbitmq but I am getting: Cannot find a resource for rabbitmq_vhost on debian version 7.0
[2013-03-13 18:07:45 -0400] mgalkiewicz: I added depends "rabbitmq" in metadata.rb
[2013-03-13 18:08:18 -0400] wamilton: mgalkiewicz: there's only a vhost resource: https://github.com/opscode-cookbooks/rabbitmq/tree/master/resources
[2013-03-13 18:09:11 -0400] mgalkiewicz: I thought resource name is cookbook name and the name itself combined
[2013-03-13 18:09:20 -0400] wamilton: mgalkiewicz: nope
[2013-03-13 18:09:29 -0400] mgalkiewicz: so the docs are outdated
[2013-03-13 18:09:47 -0400] mgalkiewicz: I mean readme in rabbitmq cookbook
[2013-03-13 18:10:17 -0400] wamilton: mgalkiewicz: seems that way... try just calling the resource vhost and see if it works, I guess...
[2013-03-13 18:10:32 -0400] mgalkiewicz: it is weird
[2013-03-13 18:11:10 -0400] mgalkiewicz: so there is also resource user which would override normal user resource right?
[2013-03-13 18:12:10 -0400] wamilton: mgalkiewicz: actually, you may be right... try just doing `include_recipe 'rabbitmq::default'` in your recipe to make sure it's loaded...
[2013-03-13 18:13:03 -0400] Illusioneer: I'm getting a undefined method `full_name' error while running a server install from chef-solo
[2013-03-13 18:13:12 -0400] Illusioneer: Is there a fix for this yet?
[2013-03-13 18:14:33 -0400] mgalkiewicz: wamilton: still no luck
[2013-03-13 18:15:08 -0400] wamilton: mgalkiewicz: one moment, looking for LWRP's I have used...
[2013-03-13 18:17:59 -0400] wamilton: mgalkiewicz: yeah, you were right about lwrp resource_name being the concatentation of cookbook and filename...
[2013-03-13 18:18:13 -0400] jblaine: When not using knife bootstrap, but instead using a first chef-client run to "register" a client and node entry, how does one set the run list to be stored for the node?
[2013-03-13 18:18:48 -0400] wamilton: mgalkiewicz: did you try literally `include_recipe 'rabbitmq::default' right above and invokation of rabbitmq_vhost and get the same error?
[2013-03-13 18:18:50 -0400] jblaine: chef-client -E sets the environment on the node (when queried with knife node show...), but chef-client's -o 'role[myrole]' does not persist on the Chef Server
[2013-03-13 18:19:43 -0400] jblaine: So, I am looking for 'chef-client <options here that will configure the node entry on chef server to be in environment X and with run list Y>
[2013-03-13 18:20:28 -0400] jblaine: I want -o 'role[myrole]' to persist the same way -E my_env already does
[2013-03-13 18:21:08 -0400] nlloyds: jblaine: Is the node already registered? If so you can `knife node edit nodename` right?
[2013-03-13 18:21:18 -0400] tomdzk: jblaine: I've moved nodes into a different environment before by adding "environment <env name>" to /etc/chef/client.rb on the node - the next chef-client will pick that up and persist it
[2013-03-13 18:21:20 -0400] mgalkiewicz: wamilton: yep
[2013-03-13 18:22:21 -0400] wamilton: mgalkiewicz: gist/pastebin your recipe pls?
[2013-03-13 18:22:40 -0400] mgalkiewicz: sure
[2013-03-13 18:23:20 -0400] mgalkiewicz: wamilton:  https://gist.github.com/maciejgalkiewicz/1065c633f092fc530e8c
[2013-03-13 18:24:14 -0400] jblaine: nlloyds: it needs to be non-interactive
[2013-03-13 18:24:44 -0400] jblaine: tomdzk: Right, -E works already and persists.
[2013-03-13 18:25:09 -0400] jblaine: tomdzk: I'm looking for the chef-client option to say "hey, prime my run list with X because I am clearly a brand new node"
[2013-03-13 18:25:25 -0400] jblaine: tomdzk: And persist it on the chef server like -E my_env already does.
[2013-03-13 18:26:20 -0400] wamilton: mgalkiewicz: looks like it should work... testing w/ vagrant now... stubbing out your databag refs, obv...
[2013-03-13 18:26:30 -0400] miah: it is non-interactive when you bootstrap a node, it gets registered with the role etc
[2013-03-13 18:26:51 -0400] miah: -o temporarily overrides the nodes configuration
[2013-03-13 18:26:59 -0400] jblaine: Sure, if you use root SSH keys.
[2013-03-13 18:27:01 -0400] mgalkiewicz: wamilton: ok thx
[2013-03-13 18:28:53 -0400] miah: root ssh keys are only used during bootstrap and can be safely removed afterwards
[2013-03-13 18:31:21 -0400] miah: if root ssh keys worry you, you could create the node with the correct runlist before hand then register a client and link it to that node
[2013-03-13 18:31:57 -0400] tomdzk: jblaine: maybe the -j to chef-client will help ? it takes as an argument the path to the first-boot.json file which is a json file containing the run list (and maybe other stuff) - haven't tested that, but might work
[2013-03-13 18:33:06 -0400] wamilton: mgalkiewicz: commented on your gist... I think your problem is that rabbitmq['vhost'] isn't a string...
[2013-03-13 18:33:07 -0400] jblaine: tomdzk: Will definitely try that. Thanks.
[2013-03-13 18:33:11 -0400] jblaine: miah: Thanks.
[2013-03-13 18:33:36 -0400] mgalkiewicz: wamilton: I tried "/nova" as weel
[2013-03-13 18:33:37 -0400] mgalkiewicz: well
[2013-03-13 18:34:13 -0400] wamilton: mgalkiewicz: and you added `depends "rabbitmq"` to your metadata?
[2013-03-13 18:34:18 -0400] mgalkiewicz: yes
[2013-03-13 18:37:38 -0400] mgalkiewicz: wamilton: I will check the cookbook cache whether there is appropriate rabbitmq cookbook
[2013-03-13 18:38:38 -0400] wamilton: mgalkiewicz: updated my comment with what I did
[2013-03-13 18:39:10 -0400] mgalkiewicz: looks like there is still an old version of rabbitmq
[2013-03-13 18:40:58 -0400] riceo: Hi, I'm currently working out how to manage user accounts across approx. 30 Linux nodes on hosted chef. I'm looking at the opscode users cookbook. Just wondered if this cookbook is widely used, and how others in similar situations solve this problem? I'd like to be able to store user details in chef, allow granular access to nodes, and ideally allow users to change their password in the centrally stored location via passwd. Thoughts?
[2013-03-13 18:41:27 -0400] riceo: I guess the nuclear option would be to implement LDAP / KRB, but I really would like to avoid that PITA.
[2013-03-13 18:41:41 -0400] mgalkiewicz: wamilton: thx for help I will purge and reupload rabbitmq I think it will work fine
[2013-03-13 18:41:43 -0400] miah: tomdzk: ya. that should work.
[2013-03-13 18:44:23 -0400] wamilton: riceo: we just create user accounts and update authorized_keys using a databag that has the pubkey and we don't worry about passwords...
[2013-03-13 18:44:34 -0400] doomviking: yeah, what wamilton said
[2013-03-13 18:44:43 -0400] doomviking: I hate passwords
[2013-03-13 18:45:25 -0400] wamilton: if you really wanted, you could put the encrypted password in the databag
[2013-03-13 18:45:57 -0400] riceo: I'm not averse to forcing key-only auth. Sounds like that is the way to go.
[2013-03-13 18:45:59 -0400] doomviking: or just make an encrypted data bag
[2013-03-13 18:46:18 -0400] riceo: Are you using the opscode users cookbook?
[2013-03-13 18:46:23 -0400] doomviking: yes
[2013-03-13 18:47:09 -0400] mario_leipzig: hello all, is it possible to configure the web_app.conf.erb template of the apache2 cookbook in a vagrantfile?
[2013-03-13 18:47:11 -0400] riceo: nice, ok, thanks!
[2013-03-13 18:48:55 -0400] wamilton: mario_leipzig: yes, just use the template and cookbook attributes to point it wherever you like
[2013-03-13 18:50:35 -0400] mario_leipzig: what what keys must i use, apache2 -> web_app -> ... ?
[2013-03-13 18:51:03 -0400] wamilton: mario_leipzig: where is the template you wish to use?
[2013-03-13 18:51:56 -0400] mario_leipzig: i want to use the default template and change the docroot placeholder
[2013-03-13 18:53:46 -0400] wamilton: mario_leipzig: specify apache2 for the cookbook and your docroot for the docroot -- all definition params are passed through transparently to the template in the web_app definition
[2013-03-13 18:54:44 -0400] wamilton: mario_leipzig: so where it says @params['whatever'] in the template, it will access the 'whatever' attribute of the webapp
[2013-03-13 18:55:41 -0400] mario_leipzig: like this: https://gist.github.com/mbirkigt/5155015 ?
[2013-03-13 18:56:59 -0400] wamilton: mario_leipzig: no, in your own recipe
[2013-03-13 18:57:08 -0400] wamilton: mario_leipzig: that's how you use definitions and resources
[2013-03-13 18:57:53 -0400] mario_leipzig: ok, so it's not possible with a vagrantfile, i have to write a receipe for this?
[2013-03-13 18:58:04 -0400] wamilton: mario_leipzig: yes
[2013-03-13 18:58:29 -0400] mario_leipzig: @wamilton: thank you
[2013-03-13 19:00:28 -0400] scalp42: hi folks, Ive been bugging my friend Miah way too much those last days and I was wondering if anyone could help me regarding this : https://gist.github.com/scalp42/5154883
[2013-03-13 19:01:57 -0400] ranjibd_: scalp42: environment attribute override .. as you said it?
[2013-03-13 19:01:58 -0400] scalp42: thank you in advance and greatly appreciated if anyone take a look
[2013-03-13 19:02:30 -0400] scalp42: well the problem is that the environment dont match each app
[2013-03-13 19:02:45 -0400] scalp42: staging env would have a different number of workers for each app
[2013-03-13 19:02:57 -0400] scalp42: and override my roles
[2013-03-13 19:03:14 -0400] scalp42: except I need a role[FOO_staging] and a role[FOO_prod]
[2013-03-13 19:03:23 -0400] scalp42: but im pretty sure it's wrong
[2013-03-13 19:05:00 -0400] ranjibd_: scalp42: so you have some customization that are dependent on apps as well as environment
[2013-03-13 19:05:00 -0400] bluekelp: i'm not sure i understand.  why not have each app's threads as an attribute defaulted in the role?
[2013-03-13 19:05:52 -0400] josephholsten: scalp42: when you say n workers, you're saying you need that many threads or procs? not that many servers, right?
[2013-03-13 19:05:58 -0400] scalp42: the thing is that the environment will override all this as I would like to keep Miah advice for default attributes in nodes, override in roles and envs
[2013-03-13 19:06:13 -0400] scalp42: yeah can replace with like Nginx workers if more familiars
[2013-03-13 19:06:19 -0400] scalp42: *familiar
[2013-03-13 19:06:58 -0400] ranjibd_: why not have a hash , unicorn_worker={:app1=>1,:app=>2} as an attribute ,, overridden in per environment basis.. and the cookbook use node.unicorn.set[:workder] = node.uni_corn.woker[ app_name]
[2013-03-13 19:07:00 -0400] scalp42: I still gonna have lets say 20 s-BAR/prod-BAR and 20 s-FOO/prod-FOO
[2013-03-13 19:07:17 -0400] ranjibd_: scalp42: in fact you can do that in the attribute file itself
[2013-03-13 19:07:38 -0400] ranjibd_: no.. not attribute file..that wont work.. sorry
[2013-03-13 19:07:58 -0400] ranjibd_: but a hash as an attribute should work, per environment basis
[2013-03-13 19:08:11 -0400] scalp42: okay let me absorb two seconds haha
[2013-03-13 19:08:27 -0400] btm: @opscode chef code review join: http://bit.ly/YsdVdZ, watch: http://youtu.be/TRtR_RpGDXw
[2013-03-13 19:08:27 -0400] ranjibd_: :-)
[2013-03-13 19:08:40 -0400] scalp42: so I would put this hash in my application cookbooks FOO and BAR
[2013-03-13 19:10:07 -0400] scalp42: have roles['FOO'] with a runlist application FOO
[2013-03-13 19:10:16 -0400] scalp42: okay im lost
[2013-03-13 19:10:16 -0400] scalp42: :D
[2013-03-13 19:11:19 -0400] scribbles34: hi
[2013-03-13 19:11:22 -0400] hikeit: hey folks i don't suppose anyone knows off hand a good way to search for all nodes with an empty run list?
[2013-03-13 19:11:31 -0400] scalp42: I added it to the gist
[2013-03-13 19:11:51 -0400] scalp42: gonna try to wrap my head around it ranjibd_ thanks for the help!
[2013-03-13 19:12:03 -0400] failshell: anyone has a nice tactic to manage ulimits with Chef? or perhaps a cookbook?
[2013-03-13 19:12:12 -0400] scribbles34: can anyone point me in the right direction with this issue http://stackoverflow.com/questions/15374961/chef-data-bag-query
[2013-03-13 19:12:19 -0400] ranjibd_: hikeit: search("*:*").select{|n|n.run_list.nil?}
[2013-03-13 19:12:22 -0400] rep0st: How does everybody back up their open source chef server?
[2013-03-13 19:12:31 -0400] timsmith: failshell: There's a few cookbooks out there
[2013-03-13 19:12:34 -0400] timsmith: github and community site
[2013-03-13 19:12:41 -0400] ranjibd_: not sure about the nil? part.. shoot chef-shell and check..:-)
[2013-03-13 19:12:48 -0400] failshell: timsmith: thanks, ill check
[2013-03-13 19:13:19 -0400] ranjibd_: rep0st: theres a knife plugin to do backup & restore
[2013-03-13 19:13:34 -0400] ranjibd_: rep0st: otherwise most of the stuffs are in git anyway
[2013-03-13 19:13:56 -0400] rep0st: ranjibd: i was looking at that plugin. But does it require me to bootstrap my chef-server?
[2013-03-13 19:14:01 -0400] scribbles34_: I will repost as I just got disconected - can anyone help with this issue http://stackoverflow.com/questions/15374961/chef-data-bag-query
[2013-03-13 19:14:04 -0400] scalp42: ranjibd_: the thing is the environment still overriding but it doesnt really work in my case, I must be missing something
[2013-03-13 19:15:10 -0400] jblaine: tomdzk: Using -E myenv and -j my.json together worked!
[2013-03-13 19:15:45 -0400] ranjibd_: scribbles34_: use "#{}" instead of '<%=%>'
[2013-03-13 19:16:28 -0400] ss__: i am a newbie to chef.   i have a ruby_block where i calculate a value as an output of a command line execution and then i want to use that new value in the next definition which is followed by the ruby block.
[2013-03-13 19:16:43 -0400] scribbles34_: ok thanks ranjibd will try it
[2013-03-13 19:16:50 -0400] ss__: for some reason, the definition gets the old value and not the newly updated value.
[2013-03-13 19:17:00 -0400] scribbles34_: thanks
[2013-03-13 19:17:47 -0400] ss__: is there anyway one could override the previous compiled value to the new value at run time for an attribute?
[2013-03-13 19:17:59 -0400] ranjibd_: ss__: you cant do that easily..
[2013-03-13 19:18:54 -0400] ranjibd_: ss__: can you share the recipe ? .. if you are calculating the value during execution phase (which is where the ruby_block's block gets evaled), you must consume the value in execution phase itself..
[2013-03-13 19:19:16 -0400] ranjibd_: chances are you are using it in the compile time
[2013-03-13 19:22:28 -0400] ss__: @ranjibd:  this is the recipe.
[2013-03-13 19:22:29 -0400] ss__: ruby_block "test" do   block do   cmdret =  Mixlib::ShellOut.new("ls -d/var/test/test*/test2// | /usr/bin/head -1")   cmdret.run_command   node.default['app']['testpath'] =  cmdret.stdout   end end     clob_files "/opt/test/" do    app node['app']['name']    apppath node['app']['testpath'] end
[2013-03-13 19:22:49 -0400] ranjibd_: dude.. pastebin please :-)
[2013-03-13 19:23:42 -0400] ss__: @ranjibd! Sorry. Here is the link http://pastebin.com/RWpWM5Un
[2013-03-13 19:24:10 -0400] ranjibd_: yeah.. u see you are building the clob_files resource at compile time , i.e. the valies of app and appath will be what is available during the compile phase ... when the other resource is not executed
[2013-03-13 19:24:29 -0400] ranjibd_: ss__: wrap you clob_files resource in a ruby_block
[2013-03-13 19:25:39 -0400] ss__: can a definition also be wrapped into a ruby_block?
[2013-03-13 19:25:57 -0400] ranjibd_: ss__: if you cant pass those apppath and app values as resource attributes... because they are calculated at the compile phase
[2013-03-13 19:26:10 -0400] ranjibd_: ss__: not sure.. u can try..
[2013-03-13 19:27:18 -0400] ranjibd_: ss__: http://pastebin.com/K2zTbfF2
[2013-03-13 19:27:46 -0400] ss__: @ranjibd. i will try that.
[2013-03-13 19:30:08 -0400] ranjibd_: hikeit: it should be n.empty?
[2013-03-13 19:30:31 -0400] jkeiser: I just put up a post on upgrading from Chef 10 -> Chef 11 on the Opscode Blog: http://www.opscode.com/blog/2013/03/12/5106/
[2013-03-13 19:30:37 -0400] c_t: huh
[2013-03-13 19:31:07 -0400] c_t: am I reading the docs right that with files you can't have environment as a criteria for file specificity?
[2013-03-13 19:32:30 -0400] hikeit: ranjibd_: this worked, very close to what you gave me, thanks!    knife exec -E "search(:node,'*:*').select{|n|n.run_list.empty?}.each{|n| puts n.name}"
[2013-03-13 19:33:09 -0400] ranjibd_: yeah,, we have monitoring / health check for that..
[2013-03-13 19:33:51 -0400] ranjibd_: a bunch of stuff atually.. chef related.. nodes with no run_list, nodes with direct recipe assignments,, nodes with higher convergence time etc
[2013-03-13 19:37:21 -0400] hikeit: nagios monitors or other?
[2013-03-13 19:40:58 -0400] miah: ranjibd_: nice. i still need to put together our checks for those as well
[2013-03-13 19:41:47 -0400] ranjibd_: hikeit: yeah,, nagios ,, but nsca based ,, passive checks
[2013-03-13 19:55:47 -0400] ss__: @ranjibd that did not work.
[2013-03-13 19:59:40 -0400] laurent\: timsmith: hiya, i don't quite understand https://github.com/opscode-cookbooks/nagios/commit/961ff9952b0c19197d390c95e3bd6caa4fa6e871
[2013-03-13 20:00:46 -0400] timsmith: laurent\:  That's the fun that is order
[2013-03-13 20:00:56 -0400] timsmith: the Nagios node can't be just any other node
[2013-03-13 20:00:59 -0400] timsmith: because if it's the first node
[2013-03-13 20:01:03 -0400] timsmith: it'll never work
[2013-03-13 20:01:12 -0400] timsmith: it's a special snowflake nod
[2013-03-13 20:01:13 -0400] timsmith: e
[2013-03-13 20:05:57 -0400] laurent\: timsmith: ok that doesn't make any sense to me yet :), any idea why node.roles is used to select the nagios server hostgroups and node["run_lists"]["roles"] for the clients ?
[2013-03-13 20:06:13 -0400] laurent\: s/select/set/
[2013-03-13 20:06:26 -0400] timsmith: there's a fix for that
[2013-03-13 20:06:33 -0400] timsmith: it' might get reviewed today
[2013-03-13 20:07:05 -0400] btm: @opscode cookbook code review, join: http://bit.ly/WI3xo9, watch: http://youtu.be/HNXm4kviOM4
[2013-03-13 20:07:16 -0400] laurent\: ok, good to know, thanks Tim
[2013-03-13 20:12:38 -0400] Umair: newbie here https://github.com/titanous/chef-ebs I'm confused can anyone tell me where should I define the attributes for RAID array creation and EBS volume creation for this cookbook? or confirm if I can define them in attributes.rb for cookbook or I have to do on the node? Thanks.
[2013-03-13 20:15:58 -0400] maplebed: I've never used the chef-ebs cookbook.  However, piops support and raid support just got upstreamed into the AWS cookbook.
[2013-03-13 20:16:22 -0400] maplebed: https://github.com/opscode-cookbooks/aws
[2013-03-13 20:16:58 -0400] maplebed: I'm not sure which cookbook has better support...
[2013-03-13 20:22:38 -0400] Umair: this cookbook depends on aws so it is using it I guess
[2013-03-13 20:22:53 -0400] Umair: but the thing I'm confused about is where to define those attributes
[2013-03-13 20:23:05 -0400] Elridge: hello, I'm pretty new to chef.  I have a question about why a particular cookbook (artifact) cannot be found. I'm using berkshelf to download the cookbooks from the community cookbook site.  Other cookbooks I'm able to download.  I have a dependency on nexus (>=1.0.0) which is dependent on the artifact cookbook.  When berkshelf tries to fetch it, it errors out.
[2013-03-13 20:23:44 -0400] clundquist: where do you expect to find the cookbook?
[2013-03-13 20:24:00 -0400] bluekelp: Elridge: can you fetch the cookbook directly with knife/etc?
[2013-03-13 20:24:12 -0400] clundquist: looks like it is located, http://community.opscode.com/cookbooks/nexus
[2013-03-13 20:24:54 -0400] Elridge: http://cookbooks.opscode.com/api/v1/cookbooks
[2013-03-13 20:25:03 -0400] Elridge: or therein
[2013-03-13 20:25:30 -0400] Elridge: nexus is found, its dependency, 'artifact' is not
[2013-03-13 20:25:46 -0400] clundquist: http://community.opscode.com/cookbooks/artifact
[2013-03-13 20:25:47 -0400] Elridge: Error message in my console:
[2013-03-13 20:25:48 -0400] Elridge: Ridley::Errors::HTTPNotFound {"error":["Cannot find a cookbook named artifact"]}         /home/elridge.dmello/.rvm/gems/ruby-1.9.3-p374@geoserver/gems/ridley-0.8.4/lib/ridley/middleware/chef_response.rb:25:in `on_complete'
[2013-03-13 20:25:57 -0400] maplebed: Umair: from the syntax, it looks like the example there was copy/pasted from a 'knife node edit <hostname>' session.
[2013-03-13 20:26:21 -0400] maplebed: but you can set attributes in a number of places - a wrapper cookbook, a role, or individually on a host via the node edit thing.
[2013-03-13 20:26:55 -0400] Umair: maplebed thanks alot
[2013-03-13 20:27:06 -0400] Umair: thats what I wanted to clear since I was confused
[2013-03-13 20:27:19 -0400] Elridge: The artifact cookbook says that its requirement is 'Chef 10'.  Does that imply it will also work with Chef 11?
[2013-03-13 20:27:41 -0400] maplebed: Umair: the syntax will be different if you set it in a role or wrapper cookbook, though that's the more sustainable answer.
[2013-03-13 20:28:14 -0400] maplebed: for testing, go ahead and knife node edit.  once you're set, it should be added to the wrapper cookbook using 'node.set[blah][blah]'
[2013-03-13 20:28:37 -0400] maplebed: Umair: more on that here: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-03-13 20:28:47 -0400] Umair: maplebed: alright I will test it out, thanks
[2013-03-13 20:28:55 -0400] maplebed: yw!
[2013-03-13 20:32:39 -0400] bluekelp: how do people manage/version the stuff that's a level up from nodes? e.g., once all nodes have run_lists and it's all happy, where do people record and version the nodes themselves?
[2013-03-13 20:33:11 -0400] bluekelp: something more at the CloudFront level, to use AWS speak
[2013-03-13 20:35:55 -0400] maplebed: there are a few projects out there that are aiming at orchestration.  haven't used any myself.
[2013-03-13 20:36:26 -0400] kessle10: does anyone have a good resource/reference for writing knife exec scripts?
[2013-03-13 20:36:33 -0400] juliancdunn: bluekelp: I've never versioned nodes... that's a strange concept to me
[2013-03-13 20:37:22 -0400] maplebed: bluekelp: another method that we're discussing is stamping out AMIs as part of the process and feeding them into things like AWS ASGs.  Not quite the same thing, but similar.
[2013-03-13 20:37:28 -0400] bluekelp: juliancdunn: so other than "what is in the server" how do you track your nodes and ensure their roles are correct, etc?  not doing this seems strange to me in the same way that just using "what is" on a node is compared to having it managed by chef
[2013-03-13 20:38:40 -0400] juliancdunn: bluekelp: well, that's a complicated question... I assume you mean beyond the trivial "knife node show"
[2013-03-13 20:39:39 -0400] juliancdunn: are you worried about people breaking the run_list on your boxes?
[2013-03-13 20:40:49 -0400] bluekelp: right.  i mean i could hack to gether some scripts to "knife node list" and when iterate and show each and dump that to a file to version
[2013-03-13 20:41:21 -0400] maplebed: I know I've come across hosts in the past and said "oh #!#$! this host {is missing a,has an extra} role!!" There are a few things I've wanted to throw into nagios to check (one already done is to dump all ec2 security groups and verify they're correct)
[2013-03-13 20:41:22 -0400] bluekelp: i'm not worried about people intentionally breaking as much as being able to re-create the cluster in another data center, in another environment for QA, etc.
[2013-03-13 20:42:17 -0400] juliancdunn: bluekelp: well, there are tools for that, like spiceweasel
[2013-03-13 20:42:27 -0400] bluekelp: it seems everything i read online is just about running service X on node Y, which is a really trivial use case.  what about auditing and ensuring you have N web servers and they're not "snowflakes" compared to each other (e.g., some admin adds a node as an ad hoc "just this once")
[2013-03-13 20:42:44 -0400] bluekelp: ah, ok. thanks.  i'll check spiceweasel out
[2013-03-13 20:42:59 -0400] maplebed: bluekelp: ironfan is another orchestration framework
[2013-03-13 20:43:13 -0400] juliancdunn: bluekelp: I'm not sure that Chef solves that particular problem of people creating snowflakes
[2013-03-13 20:43:47 -0400] juliancdunn: seems like a policy/training issue... plus, if it's *easier* for people to create nodes the Chef way, they will
[2013-03-13 20:44:13 -0400] bluekelp: perhaps i'm assuming chef is a taller stack than it is.
[2013-03-13 20:44:42 -0400] tolland: ohai
[2013-03-13 20:44:49 -0400] bluekelp: right. but creating them slightly different from the others is just as likely to happen as the 'old' way of someone installing random package X on server Y
[2013-03-13 20:44:56 -0400] bluekelp: same problem, just a level up in the stack now
[2013-03-13 20:45:07 -0400] knuckolls_: bluekelp: we released this yesterday because spiceweasel didn't do it for us. https://github.com/Banno/knife-whisk. i'm currently adding the ability to use any provider instead of just ec2.
[2013-03-13 20:45:10 -0400] tolland: im seeing random Errno::ENOMEM: errors on cookboks that use mixlib/shellout/unix.rb
[2013-03-13 20:45:43 -0400] juliancdunn: bluekelp: not really, so long as all other variables are the same (environment, the versions of cookbooks running in that environment) it's impossible to create snowflakes if you have the same runlist as the others
[2013-03-13 20:45:44 -0400] maplebed: knuckolls_: I saw that yesterday! I like it.
[2013-03-13 20:46:03 -0400] knuckolls_: maplebed: hooray!
[2013-03-13 20:46:16 -0400] knuckolls_: it's a tool i've wished existed for awhile now.
[2013-03-13 20:46:25 -0400] bluekelp: right.  it's the checking of/versioning of runlists and node-lists that i'm after i guess
[2013-03-13 20:46:55 -0400] juliancdunn: bluekelp: what I've recommended to people is to not put run lists in roles
[2013-03-13 20:47:05 -0400] bluekelp: it'd be great if i could also spin up a mess-o-nodes from the same list, too.  TIL that's called orchestration (?)
[2013-03-13 20:47:12 -0400] juliancdunn: but put them in a "roles" cookbook as recipes with "include_recipe"
[2013-03-13 20:47:23 -0400] juliancdunn: that way you can version said "roles" cookbook, just like everything else
[2013-03-13 20:47:32 -0400] bluekelp: hrm, interesting.  is there an in-depth discussion/article as to why?
[2013-03-13 20:47:55 -0400] juliancdunn: it's because roles are global variables that can't be versioned
[2013-03-13 20:48:29 -0400] bluekelp: can roles include_recipe, or perhaps i'm not quite getting your point
[2013-03-13 20:48:54 -0400] juliancdunn: no, just put one item in each role's run_list that is "recipe[roles::whatever]"
[2013-03-13 20:48:55 -0400] bluekelp: or do you mean a single role_recipe that itself them includes the recipes (like the old role run_list)
[2013-03-13 20:49:05 -0400] juliancdunn: yeah exactly
[2013-03-13 20:49:21 -0400] clundquist: juliancdunn: roles can specify version constraints though
[2013-03-13 20:49:37 -0400] clundquist: and you can do integration testing on them with test-kitchen 1.0
[2013-03-13 20:51:05 -0400] juliancdunn: clundquist: yes, but you can't version the run_list
[2013-03-13 20:51:20 -0400] juliancdunn: if you want to add a new recipe to a role, all roles get it across all environments
[2013-03-13 20:52:19 -0400] clundquist: there are work arounds, but yes
[2013-03-13 20:52:37 -0400] clundquist: really the greater pain is role inheritance trees
[2013-03-13 20:52:58 -0400] maplebed: bluekelp: yeah, orchestration is the word I think is becoming standard for talking about managing groups of servers (a la cloudformation).  it's one abstraction level above chef proper, and the tools around it are still very young.
[2013-03-13 20:53:28 -0400] clundquist: maplebed: +1
[2013-03-13 21:03:37 -0400] miah: its a good thing you can have lots of roles and nodes can belong to more than one
[2013-03-13 21:05:19 -0400] ajensen: hey all, did something about definitions change in chef 11? I just ran our recipes in chef 11 and there was a complaint about the iptables cookbook, specifically it couldn't find iptables_rule which is defined in it.
[2013-03-13 21:05:52 -0400] hikeit: chef-solo?
[2013-03-13 21:06:19 -0400] ajensen: yes
[2013-03-13 21:07:12 -0400] clundquist: scientific 6 or centos 5 aaron?
[2013-03-13 21:07:19 -0400] ajensen: yes, SL6
[2013-03-13 21:07:50 -0400] jtimberman: ajensen: you're using iptables_rule in "my_cookbook"?
[2013-03-13 21:08:00 -0400] clundquist: I think definitions are deprecated, but I am not sure?
[2013-03-13 21:08:05 -0400] jtimberman: ajensen: put a dependency in "my_cookbook" on iptables
[2013-03-13 21:08:07 -0400] jtimberman: they're not deprecated.
[2013-03-13 21:08:15 -0400] ajensen: right jt
[2013-03-13 21:08:20 -0400] hikeit: ^ what jtimberman said :)
[2013-03-13 21:08:23 -0400] jtimberman: lwrp's are generally preferred :)
[2013-03-13 21:08:41 -0400] hikeit: chef 11 solo doesn't load all cookbooks in the repo anymore
[2013-03-13 21:08:51 -0400] hikeit: only those in run list and dependencies
[2013-03-13 21:08:53 -0400] ajensen: dependency how? I have an include
[2013-03-13 21:08:59 -0400] hikeit: in the metadata.rb
[2013-03-13 21:09:04 -0400] ajensen: ah
[2013-03-13 21:09:05 -0400] ajensen: great
[2013-03-13 21:09:06 -0400] hikeit: depends "iptables"
[2013-03-13 21:09:07 -0400] ajensen: that makes sense
[2013-03-13 21:09:30 -0400] ajensen: awesome, i'll give that a shot.
[2013-03-13 21:09:41 -0400] ajensen: is there a list of other things i should be on the lookout for?
[2013-03-13 21:10:05 -0400] ajensen: and Chris, how'd you know I was that aaron jensen ;)
[2013-03-13 21:10:17 -0400] ajensen: i mean ajensen
[2013-03-13 21:10:17 -0400] ajensen: heh
[2013-03-13 21:10:38 -0400] hikeit: this is the best place to start: http://docs.opscode.com/breaking_changes_chef_11.html
[2013-03-13 21:11:05 -0400] hikeit: if you do node[var] = value, you'll need to specify precedence
[2013-03-13 21:11:07 -0400] ajensen: cool. could you guys add that to the blog post about upgrading? i didn't see it there. looks like a handy link, thank.s
[2013-03-13 21:16:56 -0400] matschaffer: any thoughts on how I could figure out which recipe this is coming from? https://gist.github.com/matschaffer/5156330
[2013-03-13 21:17:27 -0400] miah: seems like we just talked about definitions this morning :P
[2013-03-13 21:18:00 -0400] clundquist: ajensen: I work at bluebox
[2013-03-13 21:18:18 -0400] miah: clundquist: are you in SF?
[2013-03-13 21:18:31 -0400] clundquist: Seattle
[2013-03-13 21:18:33 -0400] miah: ah
[2013-03-13 21:18:34 -0400] timsmith: jtimberman: You might wanna hold off on http://tickets.opscode.com/browse/COOK-2546
[2013-03-13 21:18:41 -0400] timsmith: it looks like it breaks some things
[2013-03-13 21:19:09 -0400] miah: clundquist: definitely owe you a beer or something when you're in town (hopefully coming to chefconf)
[2013-03-13 21:19:32 -0400] clundquist: miah: funny story about chef conf except without funny and more with sad
[2013-03-13 21:19:41 -0400] clundquist: doesn't look like I will be there :(
[2013-03-13 21:20:09 -0400] timsmith: Is Scott Lampert around?
[2013-03-13 21:20:45 -0400] miah: clundquist: lame
[2013-03-13 21:20:52 -0400] miah: make bb send you
[2013-03-13 21:21:54 -0400] clundquist: well good news is scooper and fnichol are going to be there :)
[2013-03-13 21:22:27 -0400] miah: ya
[2013-03-13 21:24:26 -0400] jtimberman: timsmith: heh - merged.
[2013-03-13 21:24:39 -0400] jtimberman: timsmith: won't release yet tho
[2013-03-13 21:25:05 -0400] timsmith: people are prepping the pitch forks now
[2013-03-13 21:25:08 -0400] jtimberman: timsmith: the "fix provided" nagios tickets are all merged, so rebase w/ master before submitting new one
[2013-03-13 21:25:14 -0400] jtimberman: :)
[2013-03-13 21:25:26 -0400] timsmith: nrpe can't read the config files now
[2013-03-13 21:25:29 -0400] jtimberman: timsmith: I don't have any mentions on twitter, it's cool.
[2013-03-13 21:25:31 -0400] timsmith: they're owned by root
[2013-03-13 21:25:48 -0400] timsmith: I'd throw down $$$ that someone complains within the next 2 days
[2013-03-13 21:25:59 -0400] timsmith: apparently critical monitoring stuff should always be run from master
[2013-03-13 21:26:10 -0400] jtimberman: This is kind of my point ;)
[2013-03-13 21:26:53 -0400] jtimberman: seems it should use default['nagios']['user']  = 'nagios'
[2013-03-13 21:27:17 -0400] timsmith: yep
[2013-03-13 21:27:21 -0400] timsmith: it's in a few places
[2013-03-13 21:27:23 -0400] timsmith: I'm fixing it now
[2013-03-13 21:28:09 -0400] jtimberman: directory "#{node['nagios']['nrpe']['conf_dir']}/nrpe.d" do
[2013-03-13 21:28:14 -0400] jtimberman: template "#{node['nagios']['nrpe']['conf_dir']}/nrpe.cfg" do
[2013-03-13 21:28:14 -0400] timsmith: yep
[2013-03-13 21:28:21 -0400] timsmith: it's in a few places
[2013-03-13 21:29:48 -0400] jtimberman: got it
[2013-03-13 21:30:30 -0400] ponyofdeath: hi, trying to run an awk command inside an recpie with command awk -F: 'BEGIN{OFS=":"}/... but I get an syntax error which means I need to escabe a bunch of stuff in that command. wondering what the proper way of doing that is
[2013-03-13 21:31:02 -0400] jtimberman: timsmith: https://github.com/opscode-cookbooks/nagios/commit/84312f90925ef3f29fe65f3f143f1cb831ace361
[2013-03-13 21:31:05 -0400] jtimberman: :)
[2013-03-13 21:31:07 -0400] miah: nrpe should be a RP =)
[2013-03-13 21:31:12 -0400] jtimberman: miah: nrpecheck!
[2013-03-13 21:31:21 -0400] miah: yes, but setting up nrpe itself isn't
[2013-03-13 21:31:28 -0400] jtimberman: heh
[2013-03-13 21:31:35 -0400] jtimberman: :)
[2013-03-13 21:31:38 -0400] miah: ponyofdeath: you know you can do text substitution with ruby too right? =)
[2013-03-13 21:31:43 -0400] timsmith: too quick
[2013-03-13 21:32:07 -0400] timsmith: nrpe should not be in the nagios cookbook
[2013-03-13 21:32:10 -0400] ponyofdeath: miah: ok guess I can learn that quick too but also how do I escape the whole command if possible
[2013-03-13 21:32:11 -0400] timsmith: agreed
[2013-03-13 21:32:44 -0400] jtimberman: timsmith: especially since nrpe can be usd by sensu too right?
[2013-03-13 21:32:53 -0400] jtimberman: (or at least nrpe plugins i guess?)
[2013-03-13 21:32:55 -0400] miah: ponyofdeath: not sure. i avoid doing that stuff completely.
[2013-03-13 21:32:56 -0400] jtimberman: anyway, gotta run
[2013-03-13 21:32:58 -0400] timsmith: well and nagios can be used without nrpe
[2013-03-13 21:33:02 -0400] miah: indeed
[2013-03-13 21:33:33 -0400] miah: shellout, catching return value (and assuming it drops a usable return value) or stdout = fuck that
[2013-03-13 21:33:52 -0400] ponyofdeath: miah: ok can you give me an example of oding it with ruby code inside a recipe
[2013-03-13 21:34:11 -0400] miah: http://ruby.about.com/od/advancedruby/a/gsub.htm
[2013-03-13 21:43:04 -0400] paigeat: knuckolls: / knuckolls_
[2013-03-13 21:43:20 -0400] knuckolls_: yep?
[2013-03-13 21:50:47 -0400] ponyofdeath: miah: seems gsub does not do field separation which i need to search and replace second field
[2013-03-13 21:53:16 -0400] awgross: ponyofdeath: you can, line.split(':') gives you an array of fields
[2013-03-13 21:53:28 -0400] awgross: you can then do whatever you want to the second field
[2013-03-13 21:53:59 -0400] knuckolls_: paigeat: you rang?
[2013-03-13 21:54:03 -0400] ponyofdeath: awgross: ok thanks let me look that up
[2013-03-13 21:55:01 -0400] AlisonM: Any ideas why I would get 'ERROR: TypeError: no implicit conversion from nil to integer' when bootstrapping a windows server?
[2013-03-13 21:55:44 -0400] paigeat: knuckolls_: ohai I pm'd a little bit of a wall of text about me and what I come to you for to your other nick
[2013-03-13 21:56:23 -0400] knuckolls_: haha okay i need to get an irc bouncer for freenode
[2013-03-13 21:56:28 -0400] knuckolls_: so that kind of thing doesn't happen.
[2013-03-13 21:56:40 -0400] paigeat: hehe its ok its no rush
[2013-03-13 21:56:42 -0400] paigeat: take your time
[2013-03-13 21:57:59 -0400] paigeat: my boss told me about your project this morning and I'm excited to say I have a lot of big plans in terms of my libvirt / kvm / cman project I'm working on and I've been tasked to maintain the ebuilds for cman in gentoo which I'm hoping will give me a good way to bring that sort of stuff over to ubuntu as well for other people to use
[2013-03-13 22:10:44 -0400] Majost: what is the difference between default_unless and set_unless in an attributes file -- does the default not actually set a value in the node data?
[2013-03-13 22:11:42 -0400] Majost: ahhh... I think I found my answer: http://docs.opscode.com/essentials_cookbook_attribute_files_attribute_persistence.html
[2013-03-13 22:20:01 -0400] maplebed: I'm working on merging some changes into the mongodb cookbook and I'm encountering an odd problem.  When first bringing up a new node (on ec2 with a bootstrap first chef run), the contents of /etc/mongodb.conf are default.  After I log in and run chef a second time, the contents are what I want them to be.
[2013-03-13 22:20:18 -0400] maplebed: I'm at a loss as to why the files' not getting written correctly the first time.
[2013-03-13 22:20:35 -0400] maplebed: any pointers on common causes of this sort of thing that might give me a direction for debugging?
[2013-03-13 22:24:50 -0400] tmichael: any chef windows folks here?  I'm not, but need to Chef Windows.  Have probably pretty simple, potentially even stupid question
[2013-03-13 22:24:59 -0400] maplebed: it appears the version that exists after the first run is the version from the package install rather than the version that's supposed to be placed from the template .erb file.
[2013-03-13 22:26:08 -0400] JustinAiken: I'm trying to install the default recepie for the jabber cookbook (http://community.opscode.com/cookbooks/jabber), but it's giving me errors about the jabber group not existing
[2013-03-13 22:26:08 -0400] hikeit: could be that the package extraction / install / build is happening after the template creation
[2013-03-13 22:26:09 -0400] tmichael: used to kickstarting my *NIX hosts.  can/i do something similar with Windows (e.g. point to Windows ISO and go) or do I need to manually build a "golden image" and then go from there?
[2013-03-13 22:27:05 -0400] JustinAiken: Anybody know of a good ejabbard package that Just Works, or where i'd start looking to fix the "cannot determine group id for 'jabber', does the group exist on this system?" error it throws?
[2013-03-13 22:27:32 -0400] hikeit: you could just create the group in your own cookbook, then include the jabber cookbook
[2013-03-13 22:28:12 -0400] tmichael: JustinAiken: yeah, what hikeit said.  comments suggests this is pretty simple cook so might not cover that
[2013-03-13 22:28:14 -0400] maplebed: hikeit: that's all I can imagine as well, but the first line of the replicaset recipe is 'include default' (where the pcakage gets installed) and after that it goes on to do the replicaset stuff.  does it make a difference that it's a definition and library that's creating the replicaset? like they run before a regular recipe package install would?
[2013-03-13 22:56:08 -0400] littleidea: anyone using chef as a lib to update data bags from other applications?
[2013-03-13 22:57:15 -0400] knuckolls_: littleidea: the ridley gem is a bit friendlier for things like that.
[2013-03-13 22:57:42 -0400] knuckolls_: i believe.
[2013-03-13 22:57:42 -0400] pwf: my webui.pem seems to have changed... does this happen automatically for any reason?
[2013-03-13 23:00:15 -0400] littleidea: knuckolls_: danke
[2013-03-13 23:06:48 -0400] bluekelp: is there a way to iterate a node's tags in a recipe? not able to find it and would like to not dig thru knife source
[2013-03-13 23:07:11 -0400] bluekelp: or just get a collection of them
[2013-03-13 23:10:27 -0400] knuckolls_: bluekelp: i'm not sure off hand, but i'll show you how to find out
[2013-03-13 23:10:28 -0400] pwf: this should match the public key i see in the chef admin gui right: 'openssl rsa -in /etc/chef/webui.pem -pubout'
[2013-03-13 23:10:34 -0400] pwf: because it totally doesn't :/
[2013-03-13 23:11:01 -0400] knuckolls_: bluekelp: hop on a node, type `shef -z`, type `recipe` to go into recipe mode, then you'll have access to the node object. type `(node.methods - Object.methods).sort`
[2013-03-13 23:11:11 -0400] knuckolls_: that'll show you what you have access to
[2013-03-13 23:11:22 -0400] knuckolls_: or knife node show <node name> -l | grep <tag>
[2013-03-13 23:11:31 -0400] knuckolls_: that'll show you everything ohai provides to you from the node
[2013-03-13 23:12:08 -0400] josephholsten: anyone got any bright ideas on how I can provide both fnichol's and riotgames' rbenv cookbooks from the same chef server?
[2013-03-13 23:12:12 -0400] josephholsten: without going mad?
[2013-03-13 23:15:23 -0400] bluekelp: knuckolls_: thanks. it looks like there's a 'tags' method but am testing to make sure it works as expected
[2013-03-13 23:15:45 -0400] bluekelp: i wasn't able to find this documented anywhere but perhaps i'm not looking in the right place
[2013-03-13 23:16:52 -0400] knuckolls_: bluekelp: i was in the same boat. that's just something i figured out once and i've taught people ever since. there's also this http://wiki.opscode.com/display/chef/Shef
[2013-03-13 23:17:16 -0400] knuckolls_: josephholsten: you're gonna have to rename one of them locally until we get real cookbook namespaces :/
[2013-03-13 23:17:24 -0400] knuckolls_: josephholsten: that's all i've got
[2013-03-13 23:17:59 -0400] josephholsten: I'm thinking I'll find a way to get the log stash cb to work with both
[2013-03-13 23:33:03 -0400] AntonZ: Hello, is Atomic-penguin here somewhere ?
[2013-03-13 23:34:39 -0400] scribbles34: hi all, for one of my recipes I set node vairables in the attribute file ( from a data bag ). How can I get this to update on a second rerun if I update a data bag ite to a new value?
[2013-03-13 23:40:55 -0400] atomic-penguin: AntonZ, yeah, what is up?
[2013-03-13 23:44:59 -0400] AntonZ: im looking at your oracle cookbook
[2013-03-13 23:45:11 -0400] AntonZ: there is this guy - pdksh
[2013-03-13 23:45:16 -0400] AntonZ: required for 11g
[2013-03-13 23:45:30 -0400] AntonZ: however, redhat 6 cant find the package... any work arounds ?
[2013-03-13 23:45:51 -0400] AntonZ: it seems to be a known issue as i started to google, but thought perhaps you know the answer
[2013-03-13 23:47:20 -0400] psykidellic: Hello, I am trying to bootstrap an EC2 instance using chef-solo/knife-solo. I am trying to setup the PG data path to an EBS volume. Since, I am using Elasticsearch also, I run it to format the device and setup the paths. But unfortunately, my PG sql setup fails with: https://gist.github.com/psykidellic/5157570
[2013-03-13 23:48:49 -0400] psykidellic: How should I go about fixing it? Looks like I will need to create the folder on the mounted path before calling pgsql cookbook.
[2013-03-13 23:50:22 -0400] AntonZ: Eric, also check this out: https://blogs.oracle.com/linux/entry/oracle_rdbms_server_11gr2_pre
[2013-03-13 23:50:32 -0400] AntonZ: looks like one package installs them all
[2013-03-13 23:51:31 -0400] jedsmith: anybody have much experience with chef 11 driving a large fleet and want to suggest an instance type for a server to drive a large number of nodes? let's say 800 for a ballpark, though that's low
[2013-03-13 23:51:36 -0400] jedsmith: my gut is steering me toward m2.2xl, any thoughts?
[2013-03-13 23:51:56 -0400] jedsmith: if I missed docs, preemptive apologies
[2013-03-13 23:52:03 -0400] psykidellic: Or is there a better way/recipe to mount and format drives before calling pgsql recipe.
[2013-03-13 23:52:45 -0400] AntonZ: psy, check out cookbooks here http://community.opscode.com/cookbooks
[2013-03-13 23:53:19 -0400] AntonZ: this will mount a volume for you: http://community.opscode.com/cookbooks/aws
[2013-03-13 23:53:59 -0400] atomic-penguin: AntonZ, yum search ksh, or send me a link to the updated Oracle DB requirements for platform_version 6
[2013-03-13 23:54:33 -0400] atomic-penguin: AntonZ, pdksh is Public Domain Korn Shell
[2013-03-13 23:55:29 -0400] AntonZ: so pdksh was replaced with ksh and ksh is okay with oracle during isntallation ?
[2013-03-13 23:56:01 -0400] AntonZ: https://blogs.oracle.com/linux/entry/oracle_rdbms_server_11gr2_pre - but apperntly this package after installed on RHEL 6 converts it to Oracle Linux 6
[2013-03-13 23:56:06 -0400] psykidellic: AntonZ: I did look into it before but their warning of "chef-solo" scared me off. Maybe, it will just do what I require for now.
[2013-03-13 23:56:33 -0400] AntonZ: im using RightScale, ive been told they are chef-solo, works jsut fine for me
[2013-03-13 23:58:56 -0400] clundquist: is there a way to do a chef-shell one liner?
[2013-03-13 23:59:33 -0400] atomic-penguin: AntonZ, I don't really know.  Last time I looked, RHEL6 equivalents were not certified for Oracle DB, or I couldn't find a requirements list
