[2013-03-18 00:15:57 -0400] silentrob: Hey chef fans, has anyone had any luck with redis on opsworks?
[2013-03-18 07:22:11 -0400] Apes: Is there anything Like Foreman for Chef?
[2013-03-18 07:49:02 -0400] kerouac: dudes... i LOVE food fight
[2013-03-18 08:12:32 -0400] GreatSUN: Hi all
[2013-03-18 08:13:12 -0400] GreatSUN: I am wondering why a default, I defined in my resource isn't taken (in my opinion, I defined it correctly)
[2013-03-18 08:14:01 -0400] GreatSUN: I pasted code at nopaste... resource: http://nopaste.info/ff636218e2.html call of resource: http://nopaste.info/b859acbaf6.html
[2013-03-18 08:14:24 -0400] GreatSUN: can someone tell me why this is resulting in ignore_failure as false?
[2013-03-18 08:22:42 -0400] GreatSUN: noone in and awake, who can help out with resources?
[2013-03-18 08:38:24 -0400] BryanWB__: can i put resources in the script executed by knife exec?
[2013-03-18 08:39:20 -0400] GreatSUN: BryanWB__: afaik, yes
[2013-03-18 08:39:40 -0400] GreatSUN: with some definition block
[2013-03-18 08:40:00 -0400] GreatSUN: but I am new to writing resources myself
[2013-03-18 08:40:14 -0400] GreatSUN: got a problem with default definition of attributes
[2013-03-18 08:41:41 -0400] BryanWB__: hmm. looks like not
[2013-03-18 08:50:52 -0400] GreatSUN: BryanWB__: can you put source to nopaste?
[2013-03-18 08:51:11 -0400] GreatSUN: and mention the error/problem you get in description?
[2013-03-18 08:51:58 -0400] GreatSUN: would be great, maybe we can find out why it is not working, if there is a possibility to have it working ;-)
[2013-03-18 09:14:51 -0400] tms:  Need help in network settings. What settings should be done in VagrantFile so that server(Chef-server 11) running on the vm(ubuntu 12.04) can be accessed externally  ?
[2013-03-18 09:50:24 -0400] GreatSUN: hmmm...
[2013-03-18 09:51:04 -0400] GreatSUN: as discussed last time, I created a LWRP now to download RPM-file via yum, find it and install it with rpm afterwards
[2013-03-18 09:51:35 -0400] GreatSUN: but somehow yum_package still works in another thread and I am not able to see the file afterwards
[2013-03-18 09:51:48 -0400] GreatSUN: does someone have an idea what I could do?
[2013-03-18 10:23:07 -0400] GreatSUN: how do I get output of a command executed by bash_resource into a variable in my recipe ?
[2013-03-18 10:45:59 -0400] GreatSUN: still noone who can tell me how to get output of a bash resource?
[2013-03-18 10:46:11 -0400] GreatSUN: I really mean resource, not backtick-command
[2013-03-18 11:08:42 -0400] brianseeders: i'm fairly new to chef GreatSUN, but I don't think you can
[2013-03-18 11:09:05 -0400] brianseeders: you could, as part of the script, redirect the output to a file, then read the file from later in the recipe
[2013-03-18 11:12:02 -0400] GreatSUN: at least I got a workaround
[2013-03-18 11:16:43 -0400] brianseeders: keep in mind of course that the file will still be there on later chef runs even if the script isn't executed
[2013-03-18 11:16:49 -0400] brianseeders: whether that is good or bad for your case
[2013-03-18 11:28:08 -0400] Zhann: I have chef-client running continuously on a couple of servers (chef-client -i 300). The memory useage increases with every run, so I'm afraid I might have a memory leak. Anyone who has any good ideas on how to debug / find the leak?
[2013-03-18 11:42:59 -0400] Guest5880: hey guys, could anybody explain why I'm getting "Response: Invalid value '0.2.1' for cookbook_versions" when doing "knife environment from file environments/test.json". Why 0.2.1 is invalid for cookbook_versions?
[2013-03-18 11:44:15 -0400] zts: Guest5880: you probably want "= 0.2.1"
[2013-03-18 11:44:23 -0400] zts: Guest5880: see http://docs.opscode.com/essentials_cookbook_versions_constraints.html
[2013-03-18 11:45:04 -0400] Guest5880: thanks zts
[2013-03-18 11:45:17 -0400] zts: you're welcome
[2013-03-18 11:45:39 -0400] GreatSUN: hey guys
[2013-03-18 11:46:42 -0400] GreatSUN: if I use yum_package and want to install a specific version like "MySQL-server = 5.5.29-1.rhel5" is there a possibility to let yum_package stop working with an error instead of installing
[2013-03-18 11:46:57 -0400] GreatSUN: 5.5.27-1 for example if this is the newest version in the repo?
[2013-03-18 11:51:37 -0400] zts: GreatSUN: that should be what happens - if you specify a version, it means use that particular version.  But I hadn't seen that syntax before - maybe try specifying the version using the version parameter?
[2013-03-18 12:09:35 -0400] GreatSUN: zts: thanks, I will try to do so
[2013-03-18 12:34:19 -0400] ohadlevy: Apes: i hope one day we'll have foreman for chef too
[2013-03-18 12:38:22 -0400] Azrael: will chef 11 make its way into the yum + apt repos?  or is the expectation that from now on we download rpm/deb from the site and manage ourselves?
[2013-03-18 12:51:46 -0400] boudhuis: Hi guys, i'm testing a new cookbook on windows to download a .zip file, but everytime the chef client downloads the zip the file is corrupt. Anyone seen this behaviour on windows?
[2013-03-18 12:54:39 -0400] geekbri: boudhuis: stupid question, have you checked to make sure that the file youre downloading isn't corrupt on the remote host?  That is assuming you have access to the host its being served from?
[2013-03-18 12:55:19 -0400] boudhuis: Yeah, when i download the zip using IE it is fine, only when chef downloads it it gets corrupted
[2013-03-18 12:55:52 -0400] boudhuis: remote_file "C:/Windows/Temp/av.Zip" do
[2013-03-18 12:55:53 -0400] boudhuis:   source "http://192.168.101.8/mcafee/av.Zip"
[2013-03-18 12:55:53 -0400] boudhuis:   action :create_if_missing
[2013-03-18 12:55:53 -0400] boudhuis: end
[2013-03-18 12:56:05 -0400] boudhuis: Code is pretty simple as you can see
[2013-03-18 13:28:17 -0400] geekbri: you made sure to delete the file after you found out it was corrupt right?  As if i remember correctly create_if_missing may not re download even if the SHA1 is different with create_if_missing
[2013-03-18 13:47:53 -0400] kechagia: I'm experiencing an OOM issue when downloading a big file using "execute 'wget http://myserver/file -O mytempdir'". It feels like chef-client is trying to store the whole file in the system ram, which is strange. I tried it with 0.10.x and the most recent 0.11, same results.
[2013-03-18 14:13:56 -0400] seph: Is it possible to get the last run timestamp and status from a node? (perhaps by looking at some log). All I can find is `knife status` which looks like it requires server access
[2013-03-18 14:15:12 -0400] Mithrandir: look at ohai_time in the node object?
[2013-03-18 14:16:17 -0400] seph: AFAICT ohai_time is set to *now*. So if I look at node['ohai_time'] it's now, though I can probably search for the node, and pull the saved data from the server. I'm hoping for something a little smoother
[2013-03-18 14:19:10 -0400] seph: namely, you're suggesting: Time.at(search(:node, "name:#{node[:fqdn]}").first[:ohai_time])
[2013-03-18 14:19:16 -0400] seph: which feels very roundabout
[2013-03-18 14:20:03 -0400] zts: ohai_time on the server will give you (roughly) the time of the last successful run - if it failed, the server won't have been updated
[2013-03-18 14:20:06 -0400] zts: so that's not really what you want either
[2013-03-18 14:20:26 -0400] zts: seph: I don't think there is, I have used a chef handler to write that information locally so that other stuff can use it
[2013-03-18 14:20:55 -0400] seph: zts: Is your handler somewhere I can read it? I haven't written them before
[2013-03-18 14:22:58 -0400] seph: Though it looks like I can probably crib off http://community.opscode.com/cookbooks/chef_handler
[2013-03-18 14:25:18 -0400] gyre007: what attributes do you guys normally specify per env ? I want to have them limited to absolute necessaries...
[2013-03-18 14:36:28 -0400] GreatSUN: hey all
[2013-03-18 14:36:56 -0400] GreatSUN: I got an ArgumentError saying wrong number of arguments (4 for 3)
[2013-03-18 14:37:14 -0400] GreatSUN: that normally means I am sending 4 arguments but the method only takes 3
[2013-03-18 14:37:16 -0400] GreatSUN: right?
[2013-03-18 14:37:27 -0400] seph: yes
[2013-03-18 14:37:49 -0400] GreatSUN: but the called method is defined like this: def setDefaultsBasedOnKey(workNodeKey, valueKey, destNodeKey=nil, valueKey2=nil)
[2013-03-18 14:38:07 -0400] GreatSUN: why does it expect 3 arguments though?
[2013-03-18 14:38:37 -0400] GreatSUN: I am using Chef: 10.12.0
[2013-03-18 14:38:53 -0400] GreatSUN: any ideas?
[2013-03-18 14:40:34 -0400] seph: This is probably more of a ruby question than a chef question. What code is this, is it in a module or a class or something?
[2013-03-18 14:40:43 -0400] GreatSUN: I checked on the server itself in /var/chef/cache that the library is in the current version
[2013-03-18 14:41:11 -0400] GreatSUN: before I had three arguments
[2013-03-18 14:41:18 -0400] GreatSUN: on other machines it is working
[2013-03-18 14:41:47 -0400] GreatSUN: so my guess is more like the library is somehow cached on the system
[2013-03-18 14:42:12 -0400] GreatSUN: and chef works with the cached version instead of with the actual
[2013-03-18 14:48:11 -0400] gyre007: GreatSUN: I would google for Chef bugs...this sounds familiar to me...
[2013-03-18 14:48:21 -0400] gyre007: check out tickets.opscode
[2013-03-18 14:48:35 -0400] gyre007: possibly update chef and see if that changes anything..but check out bugs..
[2013-03-18 14:54:16 -0400] kechagia: fixed the wget oom problem, one should use -q so the stdout buffer doesn't shoot through the ceiling.
[2013-03-18 14:57:21 -0400] withnale: is there a way to get the last chef-run of a node out of knife?
[2013-03-18 14:57:56 -0400] gchristensen: withnale: look at the ohai_time
[2013-03-18 14:58:24 -0400] withnale: thanks.
[2013-03-18 15:10:05 -0400] seph: withnale: Ha. I was just asking about this, this morning. ohai_time, is set to *now*, so if you look at a node object as returned by search, you can pull it for the last successful chef run. If you want more information, look at the handlers
[2013-03-18 15:15:56 -0400] GreatSUN: gyre007: have been searching for quite a while now
[2013-03-18 15:16:02 -0400] GreatSUN: nothing found :-(
[2013-03-18 15:16:11 -0400] GreatSUN: but the problem persists on this machine
[2013-03-18 15:16:38 -0400] GreatSUN: I could set up the machine again, cause it is qa instance, but what if production has the same problem?
[2013-03-18 15:16:45 -0400] GreatSUN: I can not set up production again
[2013-03-18 15:17:10 -0400] GreatSUN: can you help me somehow?
[2013-03-18 15:17:30 -0400] GreatSUN: or maybe someone else... This wrong number of arguments error drives me nuts
[2013-03-18 15:19:31 -0400] hikeit: GreatSUN: where are you getting the error? Is it a method you wrote, or is it something in chef?
[2013-03-18 15:19:51 -0400] GreatSUN: it is a method i wrote (library)
[2013-03-18 15:20:10 -0400] GreatSUN: I changed the number of arguments from 3 to 4 some time ago
[2013-03-18 15:20:37 -0400] hikeit: any chance you have the cookbook where it is defined locked to a specific version on that server (by environment)?
[2013-03-18 15:20:47 -0400] GreatSUN: and now even though it takes 4 arguments and is written like that in var/chef/cache -> def setDefaultsBasedOnKey(workNodeKey, valueKey, destNodeKey=nil, valueKey2=nil)
[2013-03-18 15:21:07 -0400] GreatSUN: I get the error that I am using 4 arguments, but the method only takes 3
[2013-03-18 15:21:27 -0400] chris613: Does anyone know how to prevent chef-client for removing cached cookbooks when running with -o to override the run-list? I figured the skip_expires=>true moneta cache option in client.rb would do it, but it doesn't
[2013-03-18 15:22:10 -0400] hikeit: GreatSUN: did you look at the stack trace? it should be showing exactly what line of what file triggered the error, including where it thinks the method was defined (iirc)
[2013-03-18 15:22:13 -0400] GreatSUN: hikeit: might be locked, but I uploaded cookbook to chef manually, too and anyways it is saved correctly in the cache
[2013-03-18 15:22:29 -0400] GreatSUN: hikeit: yeah, I ded
[2013-03-18 15:22:30 -0400] GreatSUN: did
[2013-03-18 15:22:42 -0400] GreatSUN: all seams ok for me
[2013-03-18 15:23:07 -0400] GreatSUN: and it is running on other machines (deployed from scratch) without problems
[2013-03-18 15:23:31 -0400] GreatSUN: that's why my guess is about some cache I don't know of
[2013-03-18 15:23:51 -0400] GreatSUN: where the old method definition recides and is used instead of the new one
[2013-03-18 15:24:05 -0400] GreatSUN: whereas I don't really think this can be true
[2013-03-18 15:24:37 -0400] GreatSUN: hikeit: do you have any idea what I could do?
[2013-03-18 15:25:21 -0400] GreatSUN: brb
[2013-03-18 15:25:26 -0400] GreatSUN: <-- toilette
[2013-03-18 15:25:44 -0400] hikeit: it should show the path to the definition, does it show the correct path?
[2013-03-18 15:25:56 -0400] jtimberman: hey chefs. if you want to read a great writeup on how chef builds the "resource collection" (and what that is), check out this post: http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-03-18 15:33:17 -0400] cwj: anyone have a suggestion off-hand as to how i can easily force an exception or otherwise test my exception handler?
[2013-03-18 15:33:20 -0400] gyre007: jtimberman: that looks pretty awesome...cheers for sharing
[2013-03-18 15:33:59 -0400] cwj: indeed
[2013-03-18 15:35:26 -0400] mattray: cwj: call execute with a bogus command?
[2013-03-18 15:36:13 -0400] cwj: mattray: i was hoping to avoid uploading a cookbook for it, but I guess I will write a simple one that does just that
[2013-03-18 15:36:27 -0400] cwj: i couldn't get it to work correctly in shef
[2013-03-18 15:36:50 -0400] GreatSUN: hikeit: at least for the recipe I am calling the method from
[2013-03-18 15:37:13 -0400] GreatSUN: mattray: do you have an idea on my wrong number of arguments topic?
[2013-03-18 15:37:34 -0400] mattray: GreatSUN: just got here, missed the question
[2013-03-18 15:37:52 -0400] GreatSUN: mattray: the method had 3 arguments before but is now defined with def setDefaultsBasedOnKey(workNodeKey, valueKey, destNodeKey=nil, valueKey2=nil)
[2013-03-18 15:37:59 -0400] GreatSUN: called with 4 arguments
[2013-03-18 15:38:21 -0400] GreatSUN: I am getting the error ArgumentError - wrong number of arguments (4 for 3)
[2013-03-18 15:38:51 -0400] mattray: GreatSUN: where?
[2013-03-18 15:38:58 -0400] GreatSUN: mattray: in the cache (var/chef/cache) I see the right library and stuff
[2013-03-18 15:39:13 -0400] GreatSUN: mattray: when running chef-client on a not newly deployed machine
[2013-03-18 15:39:48 -0400] GreatSUN: the recipe calls the method with 4 arguments
[2013-03-18 15:40:15 -0400] GreatSUN: afaik the definition takes 4 arguments
[2013-03-18 15:40:56 -0400] GreatSUN: mattray: but the method was taking 3 arguments before
[2013-03-18 15:41:06 -0400] GreatSUN: so I was thinking about some cached definition
[2013-03-18 15:41:13 -0400] GreatSUN: which causes the problem
[2013-03-18 15:41:28 -0400] GreatSUN: but that shouldn't be the point in my opinion
[2013-03-18 15:41:30 -0400] mattray: a library in a cookbook? has it been updated?
[2013-03-18 15:41:37 -0400] GreatSUN: yes
[2013-03-18 15:41:41 -0400] GreatSUN: exactly
[2013-03-18 15:41:56 -0400] mattray: did you update it? is it tracked in version control?
[2013-03-18 15:42:03 -0400] GreatSUN: yes
[2013-03-18 15:42:04 -0400] GreatSUN: both
[2013-03-18 15:43:51 -0400] GreatSUN: mattray: and it shows up with the current version in chef-cache
[2013-03-18 15:44:33 -0400] GreatSUN: chef version is 10.12.0
[2013-03-18 15:45:00 -0400] hikeit: are you referencing the definition in one cookbook, and the library defined in another?
[2013-03-18 15:45:09 -0400] GreatSUN: hikeit: nope
[2013-03-18 15:45:24 -0400] GreatSUN: but the cookbook itself is referenced
[2013-03-18 15:47:11 -0400] geekbri: You don't have the method defined in two separate cookbooks do you?
[2013-03-18 15:48:43 -0400] GreatSUN: geekbri: I bet there might be another cookbook using the same method
[2013-03-18 15:48:48 -0400] GreatSUN: (methodname)
[2013-03-18 15:48:59 -0400] GreatSUN: I guess that is the problem
[2013-03-18 15:49:01 -0400] GreatSUN: will check
[2013-03-18 15:49:03 -0400] GreatSUN: thanks!
[2013-03-18 15:49:30 -0400] geekbri: no problem :)
[2013-03-18 15:50:20 -0400] geekbri: That means there are two different people offending others with their use of camel case ;)
[2013-03-18 15:50:27 -0400] geekbri: or the same person twice
[2013-03-18 15:58:17 -0400] GreatSUN: geekbri: :-P
[2013-03-18 15:58:37 -0400] GreatSUN: geekbri: the main problem is, that I am not allowed to put libs at a central place
[2013-03-18 15:58:49 -0400] GreatSUN: geekbri: if I was, that problem would never occur
[2013-03-18 15:58:53 -0400] geekbri: :(
[2013-03-18 15:58:53 -0400] GreatSUN: +e
[2013-03-18 15:59:16 -0400] GreatSUN: geekbri: I didn't even think about the other cookbook being installed on that system
[2013-03-18 16:00:42 -0400] hikeit: you could have a 'libraries' cookbook if you have a standard set of libs you share between multiple cookbooks...
[2013-03-18 16:00:56 -0400] geekbri: you could also put them in a gem
[2013-03-18 16:00:59 -0400] hikeit: you could also use namespacing to avoid the issue
[2013-03-18 16:01:10 -0400] geekbri: moduletastic
[2013-03-18 16:02:24 -0400] GreatSUN: guys you are great
[2013-03-18 16:02:26 -0400] GreatSUN: :-)
[2013-03-18 16:02:30 -0400] GreatSUN: btw
[2013-03-18 16:02:43 -0400] GreatSUN: isn't it possible to link in a library from another cookbook?
[2013-03-18 16:03:05 -0400] geekbri: if a cookbook depends on another cookbook its libraries will be loaded
[2013-03-18 16:03:20 -0400] geekbri: and by that I mean if a cookbook uses the actual "depends" method
[2013-03-18 16:03:34 -0400] GreatSUN: geekbri: how does chef get to know where it finds the libraries?
[2013-03-18 16:04:12 -0400] geekbri: I'm not sure I understand the question but when a cookbook depends on other cookbooks they will all be loaded.  Part of the cookbook loading process is to load the libraries.
[2013-03-18 16:04:46 -0400] geekbri: If I remember correctly libraries are actually the first thing loaded
[2013-03-18 16:05:20 -0400] GreatSUN: ok :-)
[2013-03-18 16:05:58 -0400] GreatSUN: so just depends "cookbook2" within the recipe loading the libs would do the job
[2013-03-18 16:05:59 -0400] GreatSUN: right?
[2013-03-18 16:06:12 -0400] geekbri: you can put it int he metadata.rb
[2013-03-18 16:06:55 -0400] geekbri: So in Chef 10.24.0 the order is, load libraries, load lwrps, load attributes, load resource definitions
[2013-03-18 16:07:08 -0400] geekbri: So the libraries are indeed the first part of the cookbook thats loaded :)
[2013-03-18 16:13:25 -0400] GreatSUN: lol
[2013-03-18 16:13:33 -0400] GreatSUN: the dependency was already there...
[2013-03-18 16:13:49 -0400] GreatSUN: sometimes doing stupid things :-(
[2013-03-18 16:16:00 -0400] gp5st: what would be the best way to use the deployment resource to sync with an svn tag?
[2013-03-18 16:19:54 -0400] GreatSUN: ok guys
[2013-03-18 16:19:56 -0400] GreatSUN: see ya laters
[2013-03-18 16:19:59 -0400] GreatSUN: bye for now
[2013-03-18 16:22:05 -0400] oddover: Hi all. what's a good way to version control the node configs?
[2013-03-18 16:23:55 -0400] gp5st: oddover: what do you mean? you can keep roles, databags, and environments in the repo with your cookbooks and stuff
[2013-03-18 16:24:24 -0400] oddover: I guess what I mean is the configs for what roles and environments get applied to each node.
[2013-03-18 16:27:29 -0400] alex_____: guys maybe you could help me
[2013-03-18 16:27:46 -0400] alex_____: how does the node determine its name?
[2013-03-18 16:28:19 -0400] alex_____: first run it uses bla.domain.com en second run only bla
[2013-03-18 16:28:46 -0400] alex_____: but what file did make that change
[2013-03-18 16:28:54 -0400] andrer: I'm playing around with a recipe which installs a PHP module. It need to restart apache, what is the cleanest way to make that dependency? Just doing "include_recipe apache" doesn't feel right
[2013-03-18 16:29:10 -0400] oddover: alex_____: by "its name", do you mean the one that ohai comes up with?
[2013-03-18 16:29:14 -0400] andrer: But adding the recipe as a depends in metadata.rb doesn't seem to give me the service.
[2013-03-18 16:29:42 -0400] alex_____: oddover no the client names which it uses to login
[2013-03-18 16:30:19 -0400] oddover: alex_____: not sure about that one.
[2013-03-18 16:30:23 -0400] alex_____: andrer make a service resource of apache action do nothing with supports var and notify it
[2013-03-18 16:30:35 -0400] alex_____: o oke
[2013-03-18 16:30:37 -0400] alex_____: to bad
[2013-03-18 16:30:51 -0400] alex_____: because i want it to use the fqdn
[2013-03-18 16:31:10 -0400] hikeit: alex____: what do you get from hostname --fqdn ?
[2013-03-18 16:31:51 -0400] andrer: alex_____: My apache cookbooks metadata says it provides "service[httpd]"
[2013-03-18 16:32:29 -0400] hikeit: andrer: it only provides that if you include the recipe
[2013-03-18 16:32:38 -0400] alex_____: hikeit nothing its empty
[2013-03-18 16:32:42 -0400] hikeit: depends just loads definitions
[2013-03-18 16:33:05 -0400] andrer: hikeit: OK, so I must include the recipe in my recipe?
[2013-03-18 16:33:11 -0400] yfeldblum: andrer, use a `depends` in the metadata, use `include_recipe` in your recipe, and then use a notification to trigger the service to restart
[2013-03-18 16:33:32 -0400] hikeit: alex____: you need to fix the hostname fqdn problem, then it should announce itself correctly as i think it uses hostname --fqdn to determine the client name
[2013-03-18 16:33:41 -0400] hikeit: check your /etc/hosts file if you're on RHEL
[2013-03-18 16:33:42 -0400] andrer: yfeldblum: OK :)
[2013-03-18 16:34:11 -0400] alex_____: i am on solaris10
[2013-03-18 16:34:20 -0400] alex_____: creating a zone
[2013-03-18 16:34:30 -0400] hikeit: for solaris, you'll need to figure out how to set the fqdn, there should be an option or something
[2013-03-18 16:34:51 -0400] kerouac: soalris sets the fqdn the same way
[2013-03-18 16:35:10 -0400] alex_____: yeah but how do i set it on the zone
[2013-03-18 16:35:25 -0400] kerouac: is the zone booted?
[2013-03-18 16:35:31 -0400] alex_____: because now it returns nothing
[2013-03-18 16:35:34 -0400] alex_____: yes
[2013-03-18 16:35:40 -0400] alex_____: i am inside the zone
[2013-03-18 16:35:51 -0400] alex_____: rollbacked it to start all over
[2013-03-18 16:35:52 -0400] kerouac: you can either set it manually or use sysconfig
[2013-03-18 16:36:01 -0400] kerouac: man sysconfig first
[2013-03-18 16:36:01 -0400] alex_____: manually
[2013-03-18 16:36:08 -0400] kerouac: it's been years since i worked at sun
[2013-03-18 16:36:17 -0400] hikeit: on enterprise linux, we just put 127.0.0.1 <fqdn> <hostname> into /etc/hosts
[2013-03-18 16:36:33 -0400] kerouac: there are 6 files in solaris that determine system id
[2013-03-18 16:36:42 -0400] kerouac: hikeit: same premise
[2013-03-18 16:36:50 -0400] kerouac: linux is mostly solaris anyway
[2013-03-18 16:37:13 -0400] alex_____: bash-3.00# man sysconfig
[2013-03-18 16:37:14 -0400] alex_____: No manual entry for sysconfig.
[2013-03-18 16:37:14 -0400] hikeit: kerouac: ah, okay. i figured it wasn't quite the same. debian does it differently too, as does slackware
[2013-03-18 16:38:55 -0400] ssd7: Ohai Chefs!
[2013-03-18 16:39:07 -0400] kerouac: http://www.oracle.com/technetwork/articles/servers-storage-admin/o11-111-s11-sysconfig-524498.html
[2013-03-18 16:39:16 -0400] j^2: ssd7: yo :)
[2013-03-18 16:39:24 -0400] alex_____: hikeit hostname doesnt have that option btw
[2013-03-18 16:39:34 -0400] hikeit: alex: your right
[2013-03-18 16:39:55 -0400] hikeit: looks like you can do this: echo foo.your.domain.com > /etc/nodename
[2013-03-18 16:39:55 -0400] hikeit: and reboot
[2013-03-18 16:40:12 -0400] mortonpe: Ohai chefs!  Recently the maintainer of the WinRM gem (dan) decided to stop maintenance. Dan has agreed to turn maintenance and development of the Gem over to me.  You may ask why I am here, but it is simple the Chef on Windows community uses WinRM  heavily and I value your thoughts. That being said there is a bit of code that will require significant effort to be able to test and maintain: Kerberos GSSAPI. Is anyone out there using KerberosGSSAPI with the
[2013-03-18 16:40:12 -0400] mortonpe: WinRM gem. Is this a feature worth supporting?
[2013-03-18 16:40:15 -0400] hikeit: then the "hostname" command should give back fqdn
[2013-03-18 16:40:27 -0400] hikeit: and (i'm guessing here) that chef will use that
[2013-03-18 16:41:15 -0400] alex_____: lets see
[2013-03-18 16:42:39 -0400] alex_____: hikeit: no it does not it only gives bla of bla.domain.com
[2013-03-18 16:43:58 -0400] alex_____: first run it uses bla.domain.com and second only bla
[2013-03-18 16:44:09 -0400] hikeit: grumble sorry i don't have solaris to test with
[2013-03-18 16:44:22 -0400] alex_____: i place some files
[2013-03-18 16:44:39 -0400] alex_____: not many people :P
[2013-03-18 16:45:20 -0400] alex_____: An FQDN is a "Fully Qualified Domain Name." By default, Chef Client uses the node's FQDN to uniquely identify node names to the server if the node name was not explicitly set.
[2013-03-18 16:46:13 -0400] alex_____: but how the fuck do i get that :P
[2013-03-18 16:47:01 -0400] zts: alex_____: the node name defaults to the FQDN, so if that changes then the node name will change - but you can also set the node name in /etc/chef/client.rb
[2013-03-18 16:47:52 -0400] zts: alex_____: "why is it changing" is still a good question, though - I seem to recall that there are two hosts files, /etc/hosts and (maybe) /etc/inet/hosts - some other subdirectory of /etc
[2013-03-18 16:47:55 -0400] alex_____: zts and do you know how chef gets the fqdn in solaris?
[2013-03-18 16:48:08 -0400] alex_____: true
[2013-03-18 16:48:19 -0400] zts: alex_____: it gets it from ohai, let me look at the source...
[2013-03-18 16:48:32 -0400] alex_____: in first run i create /etc/defaultdomain
[2013-03-18 16:49:16 -0400] zts: it does it using getaddrinfo from ruby
[2013-03-18 16:49:40 -0400] alex_____: ah oke lets see what ruby does on solaris
[2013-03-18 16:50:06 -0400] zts: alex_____: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/solaris2/hostname.rb
[2013-03-18 16:50:08 -0400] zts: that's the code
[2013-03-18 16:51:12 -0400] andrer: My recipe is also trying to start a service which require a valid config created by a template and won't start before the config is made. Now it does action [:enable,:start] in the service declaration, and it seems it does an immediate start (before the config is made). Is the best practice here to simply avoid :start and make the template notify my service?
[2013-03-18 16:52:28 -0400] alex_____: zts humm oke so i think it uses fqdn(from("hostname") + "." + from("domainname")) on second run
[2013-03-18 16:53:31 -0400] alex_____: how did i use ruby irb right?
[2013-03-18 16:55:11 -0400] zts: yeah
[2013-03-18 16:55:25 -0400] alex_____: humm
[2013-03-18 16:55:32 -0400] alex_____: thats strange
[2013-03-18 16:56:03 -0400] alex_____: when i use it on a working machine it only gives me the hostname not the fqdn
[2013-03-18 16:57:27 -0400] ekristen: is there any way to use ssh keys with the git scm resource?
[2013-03-18 16:57:48 -0400] alex_____: zts it should take the one iside the else
[2013-03-18 17:00:11 -0400] oddover: so does anyone know a good way to version control the node configs? (what roles/environments are applied, etc)
[2013-03-18 17:01:04 -0400] yfeldblum: oddover, for chef-solo or chef-client?
[2013-03-18 17:01:12 -0400] oddover: yfeldblum: client
[2013-03-18 17:03:00 -0400] yfeldblum: oddover, apply one role and one environment to each node; ensure that the role and environment applied are obvious from the node name
[2013-03-18 17:03:13 -0400] andrer: Trying to override default["newrelic"]["defaultappname"] = "unconfigured" in a role. I use "default_attributes": { "newrelic": { "defaultappname": "someFoo" } } but that's not working
[2013-03-18 17:03:27 -0400] andrer: Unable to find any docs/examples on how the default_attributes should be configured
[2013-03-18 17:04:11 -0400] railsraider: validation of cookbook takes to long before it uploads, something like 30-45 sec
[2013-03-18 17:04:21 -0400] railsraider: any idea how to speed it up
[2013-03-18 17:04:37 -0400] oddover: yfeldblum: so, your answer would be that it's unnecessary to version control those configs?
[2013-03-18 17:05:32 -0400] hikeit: oddover: for node configs, you could set up a script that automatically downloads the nodes from the chef server and pushes them to a repo. would get you version tracking
[2013-03-18 17:06:10 -0400] hikeit: (in our group though, we've decided that they're not worth putting in VC
[2013-03-18 17:06:35 -0400] yfeldblum: oddover, why would you version-control them? they're essentially static, never-changing data, and you can always take a backup of your chef-server with the `knife-server` gem (and probably various other gems)
[2013-03-18 17:07:08 -0400] yfeldblum: oddover, nodes should never move between environments, and should rarely switch roles
[2013-03-18 17:07:51 -0400] oddover: I guess that makes sense. Is it best practice to only apply one role to each node?
[2013-03-18 17:10:43 -0400] yfeldblum: oddover, in my opinion, yes
[2013-03-18 17:11:09 -0400] oddover: what if you have a node that acts as a DB and a web server?
[2013-03-18 17:11:33 -0400] yfeldblum: oddover, then it can have two roles temporarily, but why are you doing that?
[2013-03-18 17:11:43 -0400] bougyman: masterkorp: oi
[2013-03-18 17:12:03 -0400] oddover: yfeldblum: mostly for sandbox hosts
[2013-03-18 17:12:52 -0400] oddover: where we want to test the whole stack of stuff, but we don't want to set up the whole infrastructure. maybe on a desktop or something.
[2013-03-18 17:12:53 -0400] yfeldblum: oddover, you can also define another role that simply includes both the db and webserver roles in the run-list
[2013-03-18 17:13:03 -0400] oddover: yfeldblum: true
[2013-03-18 17:13:44 -0400] freezey: having a weird issue... I have a custom ohai attribute that i distribute with ohai_plugins in one of my cookbooks. During the cron chef run one of the attributes fail to load data.. however if i run chef-client manually it works perfectly.. both of which are being run as root
[2013-03-18 17:14:58 -0400] masterkorp: bougyman: hello, man how is it hanging ?
[2013-03-18 17:18:37 -0400] yfeldblum: oddover, and of course the roles can be in version control
[2013-03-18 17:18:49 -0400] oddover: yfeldblum: yea
[2013-03-18 17:19:11 -0400] ekristen: I need to checkout a private repository using git scm provider, any way to do that with chef? Where does the private key need to go?
[2013-03-18 17:19:26 -0400] bougyman: masterkorp: low and to the left.
[2013-03-18 17:21:16 -0400] masterkorp: hehe
[2013-03-18 17:21:34 -0400] yfeldblum: ekristen, you can look at http://tech.yipit.com/2012/09/05/deploying-from-github-the-right-way/ for some ideas
[2013-03-18 17:22:14 -0400] yfeldblum: ekristen, particularly the parts about setting up a GIT_SSH script
[2013-03-18 17:23:18 -0400] ekristen: yfeldblum: so it looks like the best bet is to create a custom ssh wrapper script that specifies the ssh key?
[2013-03-18 17:23:49 -0400] yfeldblum: ekristen, yep; once you get it working, it turns out to be pretty simple
[2013-03-18 17:23:58 -0400] ekristen: yfeldblum: cool, that'll help, thanks!
[2013-03-18 17:26:43 -0400] gleam: there's a deploy_wrapper cookbook that creates them fwiw
[2013-03-18 17:26:59 -0400] gleam: loads the privat ekey from an encrypted data bag
[2013-03-18 17:27:15 -0400] ekristen: gleam: I'll go look for that
[2013-03-18 17:35:35 -0400] CharlieSu: Is it possible to have 'knife ec2 server create' provision and instance with more than 1 ephemeral devices?  I've tried adding '--ephemeral "/dev/sdb,/dev/sdc"' without any luck.  Am I missing something?
[2013-03-18 17:47:24 -0400] CharlieSu: Is this not used to start an EC2 instance with multiple ephemeral drives?  https://github.com/opscode/knife-ec2/blob/0.6.2/lib/chef/knife/ec2_server_create.rb#L192
[2013-03-18 17:54:44 -0400] andrer: Is it considered a bug that when running just a single recipe the attributes from the role definition isn't loaded? Or it is just newbfesting by me?
[2013-03-18 17:56:49 -0400] Aaiiit: Hi guys.  Just trying out Chef again.   But compared to last time we tried a lot doesn't work right now.   With every package we tried installing, we get : FATAL: Chef::Exceptions::Package: package[ntp] (rails_stack::default line 1) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for <package-name>
[2013-03-18 17:58:20 -0400] Aaiiit: Been googling and lost too much time.  Anyone been having this problem?  Or know what I'm doing wrong.
[2013-03-18 17:58:33 -0400] segv: Which problem?
[2013-03-18 17:58:41 -0400] segv: scrollback is backlog fail
[2013-03-18 17:58:58 -0400] Aaiiit: @segv : Chef::Exceptions::Package: No version specified, and no candidate version available for <package-name>
[2013-03-18 18:01:45 -0400] Aaiiit: No one that has got this error?? : Chef::Exceptions::Package: No version specified, and no candidate version available for <package-name>
[2013-03-18 18:02:11 -0400] segv: I've had it before but only happens when there is a package conflict on the local system for myself
[2013-03-18 18:02:19 -0400] segv: Other than that, no
[2013-03-18 18:02:36 -0400] Aaiiit: ah @segv , thank you interesting
[2013-03-18 18:02:36 -0400] segv: Also had that with the homebrew package installer
[2013-03-18 18:02:44 -0400] zts: Indeed, and I'm more used to seeing error messages with more detail in them
[2013-03-18 18:02:48 -0400] jtimberman: Aaiiit: what platform are you using?
[2013-03-18 18:02:49 -0400] zts: (eg, the failing yum or apt-get invocation)
[2013-03-18 18:03:02 -0400] segv: Unless I specified a version it would not "default" to any particular version
[2013-03-18 18:03:23 -0400] Aaiiit: @jtimberman : I'm using Debian
[2013-03-18 18:03:57 -0400] zts: Aaiiit: also, which version of Chef?
[2013-03-18 18:04:34 -0400] CharlieSu: jtimberman: do you konw much about the --ephemeral option for knife ec2 server create?   I'm not having any luck with it
[2013-03-18 18:04:42 -0400] jtimberman: CharlieSu: i don't, sorry.
[2013-03-18 18:05:07 -0400] Aaiiit: I was able to bootstrap a new node.  Now I want to add some recipes.  I've added git to install, got this error.  I've added ntp to install got this error.
[2013-03-18 18:06:43 -0400] Aaiiit: @zts: Chef server is 10.18.2
[2013-03-18 18:07:06 -0400] Aaiiit: @zts: Chef client also
[2013-03-18 18:09:04 -0400] jtimberman: Aaiiit: what happens if you run 'sudo apt-get update' and rerun chef?
[2013-03-18 18:13:03 -0400] Aaiiit: @jtimberman : apt-get update ... you don't mean apt-get upgrade?
[2013-03-18 18:14:01 -0400] Aaiiit: @jtimberman : ok, did apt-get update on client  ... I got another error now, didn't expect that because of an apt-get update ...   error is now : hef::Exceptions::Exec: service[ntpd] (rails_stack::default line 8) had an error: Chef::Exceptions::Exec: /usr/sbin/update-rc.d ntpd defaults returned 1, expected 0
[2013-03-18 18:15:58 -0400] Aaiiit: @jtimberman : Thanks for the tip.   What does 'apt-get update' change in Chef?
[2013-03-18 18:17:14 -0400] jtimberman: Aaiiit: it doesn't. that is the debian package manager command to update the local package cache.
[2013-03-18 18:18:15 -0400] Aaiiit: @jtimberman : lol, yeah i know, that's why I don't get it changes anything in chef
[2013-03-18 18:18:29 -0400] jtimberman: Aaiiit: Chef uses the underlying package manager to install packages.
[2013-03-18 18:18:42 -0400] jtimberman: Aaiiit: What happens is chef literally runs "apt-get install ntp"
[2013-03-18 18:18:57 -0400] jtimberman: Aaiiit: but apt didn't know about the package.
[2013-03-18 18:19:04 -0400] jtimberman: so that error bubbles up to Chef.
[2013-03-18 18:20:50 -0400] Aaiiit: @jtimberman : oooh yeah, starting to understand know ... but, what do you mean with :"but apt didn't know about the package"
[2013-03-18 18:21:16 -0400] segv: Aaiiit: he means that it was not registered as a package "Apt" had in its package cache.
[2013-03-18 18:21:23 -0400] jtimberman: right
[2013-03-18 18:21:27 -0400] segv: Meaning it had NO idea what it was looking for
[2013-03-18 18:21:35 -0400] segv: like try this apt-get install blahblahblah
[2013-03-18 18:21:40 -0400] segv: essentially the same thing
[2013-03-18 18:21:41 -0400] segv: :p
[2013-03-18 18:21:55 -0400] segv: E: Unable to locate package blahblahblah
[2013-03-18 18:21:56 -0400] segv: :P
[2013-03-18 18:23:47 -0400] Aaiiit: @segv & @jtimberman : ok, sounds logical :)    so is there another recipe i have to run now so that apt can find it?
[2013-03-18 18:25:01 -0400] jtimberman: Aaiiit: opscode's "apt" cookbook will automatically run apt-get update, put it as the first recipe in your run list and your nodes will have the apt cache updated first thing.
[2013-03-18 18:25:11 -0400] segv: jtimberman: yeah, I use that as well.
[2013-03-18 18:25:13 -0400] segv: Saves me a lot of work.
[2013-03-18 18:25:37 -0400] segv: no manual 'bash 'apt-get update' do' nastiness
[2013-03-18 18:26:17 -0400] Aaiiit: wow @jtimberman and @segv,   you guys saved me  I had no clue where to look.  Thank you
[2013-03-18 18:27:36 -0400] jtimberman: segv: :)
[2013-03-18 18:27:45 -0400] jtimberman: segv: the first version of that cookbook had one line:
[2013-03-18 18:27:47 -0400] jtimberman: execute "apt-get update"
[2013-03-18 18:27:55 -0400] segv: haha
[2013-03-18 18:28:02 -0400] jtimberman: well, it's idempotent :)
[2013-03-18 18:28:24 -0400] jtimberman: but not necessarily convergent
[2013-03-18 18:29:01 -0400] Aaiiit: But, in older versions of Chef this was not necessary?  Or do I got this all wrong?   I did use chef-solo last time
[2013-03-18 18:29:39 -0400] segv: jtimberman: I would expect so
[2013-03-18 18:29:59 -0400] miah: i still feel like :update-cache should be an available action to the apt package provider
[2013-03-18 18:30:19 -0400] miah: instead of some one-off recipe in a 3rd party cookbook
[2013-03-18 18:30:23 -0400] segv: miah: That would be nice
[2013-03-18 18:30:43 -0400] segv: I can see how that could cause issues on some distributions though
[2013-03-18 18:31:00 -0400] miah: with some helper functions to determine when the cache was last updated and if caches are available for newly added repo's
[2013-03-18 18:31:02 -0400] jtimberman: Aaiiit: it depends. if you had a provisioning process that ran apt-get update (or if that was done after the base OS was installed in some way)
[2013-03-18 18:31:11 -0400] miah: make it a little more intelligent
[2013-03-18 18:31:15 -0400] jtimberman: miah: meh
[2013-03-18 18:31:16 -0400] segv: jtimberman: yeah, I just throw apt-get update in the initial bootstrap
[2013-03-18 18:31:17 -0400] jtimberman: :)
[2013-03-18 18:31:18 -0400] miah: :P
[2013-03-18 18:31:37 -0400] segv: then use the apt recipe after initial bootstrap with specified recipes
[2013-03-18 18:31:58 -0400] miah: ya. i hate doing that.
[2013-03-18 18:32:24 -0400] miah: its extra work thats tedious and error prone
[2013-03-18 18:35:00 -0400] hikeit: that issue happens in more than just apt though
[2013-03-18 18:35:45 -0400] hikeit: the default action for the php default cookbook also updates the cache, which takes about 2 minutes on my servers and it happens every time anything in pear was updated, which is like every 3rd chef run
[2013-03-18 18:36:43 -0400] segv: whoops
[2013-03-18 18:36:49 -0400] segv: just hung up on an unsuspecting vendor haha
[2013-03-18 18:38:40 -0400] dwradcliffe: Today I've been getting undefined method `[]=' for nil:NilClass for all my attributes https://gist.github.com/dwradcliffe/6ad2df48ff3bfd453d58
[2013-03-18 18:40:06 -0400] miah: hikeit: ya. thats a failure in SRP
[2013-03-18 18:40:30 -0400] miah: :install should not necessarily mean :update-cache
[2013-03-18 18:41:18 -0400] miah: you _can_ specify multiple actions to a provider. i observe that some authors forget that and make their actions do too much.
[2013-03-18 18:43:08 -0400] miah: dwradcliffe: 'node.default['memcached']...
[2013-03-18 18:44:24 -0400] dwradcliffe: miah: so all the community cookbooks are wrong?
[2013-03-18 18:45:39 -0400] binjured: hmmm... i have a provider with multiple actions, one of which needs to inform another be run. i tried `notifies :run, resources(:execute => "restart")` and about half a dozen other random combinations but i always get ResourceNotFound.
[2013-03-18 18:46:48 -0400] fly9: does anyone know why the mysql cookbook excludes the conf.d include on redhat-based systems?
[2013-03-18 18:47:19 -0400] fly9: the percona cookbook does the same
[2013-03-18 18:52:12 -0400] miah: dwradcliffe: http://www.opscode.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/
[2013-03-18 18:53:19 -0400] freezey: having a weird issue... I have a custom ohai attribute that i distribute with ohai_plugins in one of my cookbooks. During the cron chef run one of the attributes fail to load data.. however if i run chef-client manually it works perfectly.. both of which are being run as root
[2013-03-18 18:53:39 -0400] hikeit: i'd like to be able to specify a maximum cache age (and be able to specify it for yum, apt, gem, pear, cpan, pip
[2013-03-18 18:59:35 -0400] benkay: i just installed chef-server from the opscode apt repository, and while the install seemed to proceed just dandy, when I run 'chef-server', bash says "chef-server: not found"
[2013-03-18 18:59:51 -0400] benkay: do I need to add the chef location to my path manually?
[2013-03-18 19:01:16 -0400] timsmith1: benkay: you shouldn't need to run the server directly
[2013-03-18 19:02:21 -0400] benkay: so where the instructions say "chef-server > knife configure -i", I should read that as "my server terminal prompt: knife configure -i"
[2013-03-18 19:06:23 -0400] jforce: I can't find any information about this online. Anybody have any insight about Chef 11.4.0 w/ Ruby 2.0.0-p0? .rvm/rubies/ruby-2.0.0-p0/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require': cannot load such file -- rubygems/format (LoadError)
[2013-03-18 19:08:23 -0400] jforce: I should have used a Gist. Anybody know anything about this error using Chef 11.4.0 with Ruby 2.0.0-p0? https://gist.github.com/justinforce/5189891
[2013-03-18 19:08:52 -0400] kesor: benkay: you using chef 11 server?
[2013-03-18 19:09:10 -0400] benkay: kesor: yup.
[2013-03-18 19:09:48 -0400] jforce: I found this, so it looks like it's been fixed but not released. https://github.com/opscode/chef/blob/master/lib/chef/provider/package/rubygems.rb#L35
[2013-03-18 19:09:57 -0400] kesor: benkay: you shouldnt do that on "mt server terminal prompt", knife configure -i is used to create a "workstation". you just need to copy the validation.pem and admin.pem from your server, and run the knife command somewhere where you have your cookbooks at.
[2013-03-18 19:10:37 -0400] kesor: benkay: knife configure -i will ask you where your admin.pem and validation.pem are at, and create a .chef/knife.rb configuration file that later is used by knife to connect to your server.
[2013-03-18 19:12:30 -0400] kesor: benkay: oh, it will also ask for the server url  naturally.
[2013-03-18 19:13:10 -0400] benkay: thanks kesor.
[2013-03-18 19:13:27 -0400] kesor: does anyone know if there is a blog post out there talking about the differences between chef 11 and the chef-solo used by aws opsworks?
[2013-03-18 19:13:51 -0400] kavi_: hi, when i tried to login in chef server webUI, i'm getting error like, Sorry but something went wrong. anybody can help me pls..
[2013-03-18 19:15:42 -0400] kesor: kavi_: any errors you can paste in your /var/log/chef-server/chef-server-webui/current?  is it chef-server 11?
[2013-03-18 19:16:21 -0400] kesor: kavi_: also in /var/log/chef-server/nginx/error.log
[2013-03-18 19:17:17 -0400] kavi_: oh sorry, now i cant access office system from this place. can u please guide what are the possibilities r there to get this error???
[2013-03-18 19:17:52 -0400] kesor: kavi_: show the error, then I can guess what the reason might have been.
[2013-03-18 19:17:58 -0400] kavi_: API everything s working fine but only problem with WebUI
[2013-03-18 19:18:53 -0400] kesor: kavi_: really, as much as I want to help, I just can't help without seeing some text that might suggest what the problem is ...
[2013-03-18 19:21:03 -0400] kavi_: yeah u r rit. please check this error: [11/Mar/2013:08:13:51 -0600]  "DELETE /clients/pedant_admin_client HTTP/1.1" 200 "0.015" 496 "-" "chef-pedant rspec tests" "127.0.0.1:8000" "200" "0.009" "11.0.0" "algorithm=sha1;version=1.0;" "admin" "2013-03-11T14:13:51Z" "2jmj7l5rSw0yVb/vlWAYkK/YBwk=" 875 172.26.146.55 - - [11/Mar/2013:08:13:51 -0600]  "DELETE /clients/pedant_client HTTP/1.1" 200 "0.014" 494 "-" "chef-pedant rspec tests" "127.0.0.
[2013-03-18 19:21:22 -0400] kesor: yikes  please paste it into a gist, or pastie or something.
[2013-03-18 19:21:37 -0400] kesor: but this looks like its success, not an error.
[2013-03-18 19:23:17 -0400] kavi_: i'm sorry kesor, i'm very new to chef. just nw i'm learning. But web page s displaying properly, but after entering username n pwd. i getting error
[2013-03-18 19:23:22 -0400] kavi_: somethinf went wrong
[2013-03-18 19:24:13 -0400] kesor: kavi_: those two files I asked you for, can you put them in gist.github.com?
[2013-03-18 19:26:21 -0400] hcastro: can anyone point me toward the easiest way to do an HTTP post within a recipe and parse the HTTP response? vaguely recall re-use of a an internal chef module that aided in that
[2013-03-18 19:26:59 -0400] kesor: hcastro: ruby_block? :)
[2013-03-18 19:27:19 -0400] kesor: hcastro: there is also http://docs.opscode.com/resource_http_request.html
[2013-03-18 19:27:34 -0400] hcastro: kesor: yeah, but mainly asking to avoid using the net/http api directly :)
[2013-03-18 19:28:07 -0400] hcastro: kesor: don't recall there being a way to capture output via that resource
[2013-03-18 19:28:59 -0400] kavi_: https://gist.github.com/ramalink/5190078
[2013-03-18 19:29:58 -0400] kesor: kavi_: is that /var/log/chef-server/chef-server-webui/current or /var/log/chef-server/nginx/error.log ?
[2013-03-18 19:31:34 -0400] kavi_: nginx error log
[2013-03-18 19:32:15 -0400] kesor: kavi_: that looks like the access log, not the error log.
[2013-03-18 19:32:44 -0400] kesor: also, it does not have any errors in it. its all successful http requests.
[2013-03-18 19:33:59 -0400] kavi_: oh sorry kesor.. let me take all error file n come back to u, sorry.
[2013-03-18 19:35:24 -0400] dwradcliffe: miah: turns out it was this: https://github.com/DataDog/chef-datadog/pull/26
[2013-03-18 19:35:29 -0400] j^2: ok, so i have a 412 Precondiion failing, becasue i deleted an old cookbook, how do  i figure out what cookbook/recipe is calling for in?
[2013-03-18 19:35:33 -0400] j^2: s/in/it?
[2013-03-18 19:35:43 -0400] j^2: something like chef-client --verbose?
[2013-03-18 19:35:59 -0400] iselby: someone able to help me with what I hope is a stupid issue getting my knife setup working properly?
[2013-03-18 19:36:10 -0400] kesor: iselby: sure
[2013-03-18 19:36:15 -0400] iselby: OK, here's where I'm at
[2013-03-18 19:36:24 -0400] iselby: ubu 12.04, installed chef server via deb
[2013-03-18 19:36:50 -0400] kesor: iselby: you should probably use the omnibus installer
[2013-03-18 19:37:19 -0400] iselby: despite the official install page saying otherwise?
[2013-03-18 19:37:19 -0400] iselby: http://www.opscode.com/chef/install/
[2013-03-18 19:37:32 -0400] kesor: iselby: no, http://wiki.opscode.com/display/chef/Chef+11+Server+Preview#Chef11ServerPreview-QuickStart
[2013-03-18 19:37:46 -0400] kesor: iselby: the link you pasted is the client
[2013-03-18 19:37:57 -0400] kesor: oh, sorry. I see they have the server there as well now
[2013-03-18 19:38:23 -0400] iselby: the link I posted is also the server
[2013-03-18 19:38:37 -0400] kesor: iselby: yep, the chef server omnibus. its up-to-date, didn't realize they added it there.
[2013-03-18 19:39:05 -0400] iselby: OK, so then so far I'm good?
[2013-03-18 19:39:17 -0400] iselby: I've got the webui and all the other goodness up and running on a server
[2013-03-18 19:39:28 -0400] iselby: I'm just getting timeouts with all knife comands
[2013-03-18 19:39:59 -0400] kesor: iselby: you configured knife with "knife configure -i" and all? your .chef/knife.rb file has your server url?
[2013-03-18 19:40:08 -0400] iselby: yep
[2013-03-18 19:40:25 -0400] iselby: ports open, rules set up in openstack and on the server
[2013-03-18 19:40:39 -0400] iselby: tried it on the server itself, and on my local workstation
[2013-03-18 19:40:42 -0400] kesor: iselby: and the server hostname when you created it is the same you are using right now?  ssl problems give errors that are weird and not helpful.
[2013-03-18 19:40:52 -0400] iselby: yes
[2013-03-18 19:41:00 -0400] kesor: iselby: can you connect to your server with "openssl s_client -connect servername:443" and the CN is the same knife is using?
[2013-03-18 19:41:12 -0400] iselby: lemme ask you this
[2013-03-18 19:41:32 -0400] iselby: what's the new chef server API url?
[2013-03-18 19:41:45 -0400] iselby: it would appear http://my-chef:4000 is no longer correct?
[2013-03-18 19:42:00 -0400] kesor: iselby: pretty sure it should be https
[2013-03-18 19:42:22 -0400] kesor: iselby: https://my-chef
[2013-03-18 19:42:39 -0400] iselby: that was it
[2013-03-18 19:42:44 -0400] kesor: now it works?
[2013-03-18 19:42:46 -0400] iselby: yep
[2013-03-18 19:43:00 -0400] kesor: nice :)
[2013-03-18 19:43:00 -0400] iselby: was using old-style URLs (10.x chef)
[2013-03-18 19:43:05 -0400] iselby: damn right, that was easy
[2013-03-18 19:43:07 -0400] iselby: thanks for your help!
[2013-03-18 19:43:19 -0400] kesor: n
[2013-03-18 19:43:20 -0400] kesor: np
[2013-03-18 19:44:51 -0400] kesor: had to grok a problem with knife not uploading "some" cookbooks while uploading others, because the server ssl certificate CN was different from what my colleague was using  weird errors with getaddrinfo and no clue that its ssl related. wasted a day or more on tha tone.
[2013-03-18 19:46:04 -0400] kesor: I think this channel is so active because each chef run takes forever to finish . :)
[2013-03-18 19:48:19 -0400] btm: @opscode No chef/cookbook code review today, scheduling conflict with our monthly all-hands meeting
[2013-03-18 19:49:01 -0400] kesor: :(
[2013-03-18 19:59:11 -0400] binjured: could someone tell me why `new_resource` wouldn't contain default attribute values?
[2013-03-18 19:59:27 -0400] binjured: trying to use a template and it's not getting enough variables; all the defaults are missing.
[2013-03-18 19:59:36 -0400] kesor: binjured: can you show the code?
[2013-03-18 20:00:26 -0400] binjured: kesor: https://gist.github.com/ae65d2db115de808d4e6
[2013-03-18 20:00:46 -0400] binjured: there are a ton of defaults not making it into "watch"
[2013-03-18 20:00:48 -0400] kesor: binjured: and you have a resources/watcher.rb?
[2013-03-18 20:00:52 -0400] binjured: yep.
[2013-03-18 20:01:08 -0400] binjured: attribute :stderr_class, :kind_of => [String], :default => 'StdoutStream'
[2013-03-18 20:01:12 -0400] binjured: there's one example
[2013-03-18 20:02:12 -0400] kesor: binjured: i'm not sure, but can you try and add "new_resource = @new_resource" just after the block start?
[2013-03-18 20:03:00 -0400] kesor: binjured: although its a non-educated guess of mine, as I have no idea why it would matter  only that I see it in half the providers in my cookbooks dir.
[2013-03-18 20:03:11 -0400] binjured: kesor: sigh, false alarm; stupidity.
[2013-03-18 20:03:31 -0400] binjured: was missing @watch in the template and the debug output doesn't include defaults
[2013-03-18 20:03:39 -0400] binjured: hence my belief they were missing
[2013-03-18 20:03:45 -0400] kesor: binjured: whats the opposite of murphy? :)
[2013-03-18 20:04:43 -0400] kesor: oh, its yhprum apparently. http://en.wikipedia.org/wiki/Yhprum's_Law
[2013-03-18 20:07:29 -0400] petecheslock: KarlHungus - have you started or continued any work on your freebsd omnibus stuff?
[2013-03-18 20:08:03 -0400] petecheslock: was going to write up a blogpost on building omnibus chef with on freebsd 8.3 and 9.1 so that when we get to a testing point there will be a doc that can tell people how to test it
[2013-03-18 20:08:52 -0400] KarlHungus: i've been stuck spec'ing a new graphite build. should be free of it this afternoon and back to omnibus
[2013-03-18 20:11:32 -0400] petecheslock: ok cool - i'll start writing up a document on how to build based on your branch.
[2013-03-18 20:20:26 -0400] gyre007: what's your preferred way to build a new Chef server guys ? given that you have NONE running ? ie how do you build it from scratch ?
[2013-03-18 20:21:02 -0400] _dumfries: gyre007: https://github.com/fnichol/knife-server this is pretty nice.
[2013-03-18 20:21:03 -0400] Mithrandir: I tend to just do it by hand.
[2013-03-18 20:21:10 -0400] Mithrandir: apt-get install chef-server-api
[2013-03-18 20:21:15 -0400] Mithrandir: and take it from there.
[2013-03-18 20:23:35 -0400] gyre007: dumfries_: damn....doesnt have Rackspace cloud
[2013-03-18 20:23:38 -0400] gyre007: support
[2013-03-18 20:23:44 -0400] gyre007: but it's on the Roadmap :)
[2013-03-18 20:24:17 -0400] gyre007: looks interesting though...cheers for bringing it to my attention
[2013-03-18 20:25:15 -0400] iamchrisf: I'm trying to use knife ssh to login to a single box of role:X.  There are multiple boxes with role:X.  With knife search I can supply "-R 1" .  It seems "knife ssh" does not support that option.  Is there a way to limit output via the SEARCH_QUERY, or am I going to have to kludge this?
[2013-03-18 20:25:20 -0400] rep0st: i'm amazed at how fast it was for me to write a cookbook for deploying our hyperic agent on all our nodes. <3 chef
[2013-03-18 20:27:16 -0400] gyre007: iamchrisf: what are the criteriaons based on which you want to filter ?
[2013-03-18 20:28:11 -0400] kesor: gyre007: or use omnibus chef server ...
[2013-03-18 20:28:29 -0400] gyre007: kesor: yes but you still need to build a machine and set up config etc...
[2013-03-18 20:28:31 -0400] gyre007: manually
[2013-03-18 20:28:42 -0400] kesor: gyre007: really? what do you mean?
[2013-03-18 20:29:06 -0400] gyre007: well I'd like to build it from the command line ideally using knife...and I want to bootstrap Chef server
[2013-03-18 20:29:08 -0400] gyre007: not client
[2013-03-18 20:29:32 -0400] kesor: gyre007: yes, a server. there is an omnibus installer for it now.
[2013-03-18 20:29:43 -0400] maplebed: gyre007: build one by hand then use that to build the to-be-production server using the by-hand and turn down the by-hand one.
[2013-03-18 20:29:46 -0400] iamchrisf: role:X AND limit 1
[2013-03-18 20:30:12 -0400] kesor: gyre007: check opscode.com/chef/install  there is a "server" tab in there.
[2013-03-18 20:30:51 -0400] zuhaib: I think i know the answer to this but I am blanking out, can providers access node attributes?
[2013-03-18 20:31:04 -0400] kesor: zuhaib: LWRPs can't
[2013-03-18 20:31:09 -0400] gyre007: kesor: you mean doing this via chef-solo ?
[2013-03-18 20:31:18 -0400] kesor: gyre007: no. I mean via omnibus ...
[2013-03-18 20:31:36 -0400] gyre007: but that's gonna install the Chef server...who will build the VM for me ??
[2013-03-18 20:31:41 -0400] gyre007: Ill have to do that manually
[2013-03-18 20:32:02 -0400] kesor: gyre007: I use vagrant with a shell provisioner.
[2013-03-18 20:32:04 -0400] jtimberman: gyre007: knife-server by fnichol
[2013-03-18 20:32:07 -0400] zuhaib: kesor: humm, including custom provider
[2013-03-18 20:32:11 -0400] jtimberman: might be your path to victory
[2013-03-18 20:32:13 -0400] gyre007: jtimberman: doesnt support Rackspace yet
[2013-03-18 20:32:19 -0400] gyre007: but it is indeed awesome
[2013-03-18 20:32:26 -0400] gyre007: if youre on Amazon
[2013-03-18 20:32:57 -0400] kesor: gyre007: but really, how hard is it to "ssh my_rackspace_server exec_omnibus_chef"?   what do you usually use to create a rackspace server?
[2013-03-18 20:33:12 -0400] gyre007: kesor: KNIFE
[2013-03-18 20:33:30 -0400] gyre007: and automatically register it against already running Chef server
[2013-03-18 20:33:59 -0400] gyre007: but getting this done via Vagrant and shell provider sounds like an intersting option...given that 1.1 now supports Rackspace cloud..mmm
[2013-03-18 20:34:09 -0400] kesor: gyre007: yep.
[2013-03-18 20:34:39 -0400] gyre007: kesor: thanks for the hint...havent thought about it....looks like that's what I'm gonna do...
[2013-03-18 20:34:59 -0400] jtimberman: the latest chef-server github master branch supports install/setup of chef server..
[2013-03-18 20:35:03 -0400] gyre007: until Fletcher implements Rackspace support indeed...then I'm switching to knife-server :)
[2013-03-18 20:35:14 -0400] jtimberman: its mainly focused around using a vagrant based workflow for testing, but should "work"
[2013-03-18 20:35:52 -0400] gyre007: jtimberman: I'll have  a look
[2013-03-18 20:36:20 -0400] kesor: gyre007: "vagrant up --provider=rackspace" ftw! :)
[2013-03-18 20:36:32 -0400] gyre007: yeah
[2013-03-18 20:41:36 -0400] rafaelmagu: Is nodejs cookbook broken for anyone else on Ubuntu Precise?
[2013-03-18 20:41:43 -0400] rafaelmagu: Unmet dependencies
[2013-03-18 20:43:42 -0400] gyre007: rafaelmagu: you probably dont have dependent cookbooks on your Chef server...
[2013-03-18 20:43:58 -0400] rafaelmagu: Not the issue
[2013-03-18 20:44:03 -0400] rafaelmagu: Was working last week
[2013-03-18 20:44:05 -0400] rafaelmagu: No changes made to repo
[2013-03-18 20:44:22 -0400] rafaelmagu: Seems the APT repo got a new version that broke things
[2013-03-18 20:45:20 -0400] gyre007: I see
[2013-03-18 20:45:29 -0400] gyre007: good that you found it..
[2013-03-18 20:45:49 -0400] miah: a good rule is: if you something you depend on is mission critical. version lock it.
[2013-03-18 20:46:40 -0400] rafaelmagu: Sadly, it's not one I control directly
[2013-03-18 20:46:50 -0400] rafaelmagu: It's a cookbook being called by another cookbook (sensu)
[2013-03-18 20:47:02 -0400] rafaelmagu: Posted on the sensu channel as well to see if anyone knows anything
[2013-03-18 20:48:01 -0400] kesor: in application cookbook, before_restart block is not run by root? :/
[2013-03-18 20:50:12 -0400] miah: rafaelmagu: sensu requires node now?
[2013-03-18 20:50:21 -0400] rafaelmagu: My bad
[2013-03-18 20:50:25 -0400] rafaelmagu: Does not
[2013-03-18 20:50:38 -0400] rafaelmagu: It just happened to show up right after the sensu recipe ran
[2013-03-18 20:50:42 -0400] rafaelmagu: Not related
[2013-03-18 20:51:40 -0400] Xorlev: Hey guys, I could use some advice. I'm using the chef-percona cookbook to stand up a MySQL server. My configuration has a pretty big ibdata file and large iblogfiles so it takes MySQL ~60s to create them on disk for first time use. The default init script waits only 14 seconds, so the chef run aborts thinking it failed (when in reality it was actually OK).
[2013-03-18 20:51:41 -0400] Xorlev: Is there a way to recover from a bad "service start" and check for myself? I'm not above hacking the percona cookbook to my own needs.
[2013-03-18 21:01:04 -0400] kesor: Xorlev: http://docs.opscode.com/resource_execute.html has a timeout attribute you might find useful, its default is 3600 though ...
[2013-03-18 21:03:19 -0400] gyre007: does this http://docs.opscode.com/breaking_changes_chef_11.html#with-inline-compilation means that LWRPs development has changed
[2013-03-18 21:03:22 -0400] gyre007: right
[2013-03-18 21:03:38 -0400] gyre007: would be nice to have comparison between 10 and 11...
[2013-03-18 21:04:25 -0400] kesor: gyre007: where can I read more about inline compilation?
[2013-03-18 21:05:34 -0400] kesor: gyre007: there is a doc at http://docs.opscode.com/breaking_changes_chef_11.html that goes over a lot of changes for comparison
[2013-03-18 21:05:56 -0400] gyre007: kesor: hah that's what I just copy-pasted above with my q
[2013-03-18 21:06:12 -0400] kesor: gyre007: so why ask a comparison? :)
[2013-03-18 21:06:15 -0400] gyre007: you probably didnt click on it...it goes directly to my question
[2013-03-18 21:06:47 -0400] gyre007: well..in old LWRPs there was some code needed like updated etc...now it looks like LWRPs are updated automatically with subresources...
[2013-03-18 21:06:51 -0400] gyre007: etc..
[2013-03-18 21:07:12 -0400] gyre007: would be nice to see how to use these things correctly...but I'll be playing Vagrant with these...
[2013-03-18 21:07:13 -0400] kesor: gyre007: only if you use that user_inline_resources thing?
[2013-03-18 21:07:15 -0400] gyre007: shortly..
[2013-03-18 21:07:20 -0400] gyre007: yeah
[2013-03-18 21:07:39 -0400] kesor: gyre007: I am still trying to use chef-rewrite on resources created inside lwrp  with no success.
[2013-03-18 21:07:51 -0400] gyre007: haha
[2013-03-18 21:08:21 -0400] timsmith: is there some magic to get chef to load the environment variables so they can be read.  If I export http_proxy and run IRB it's available via ENV['http_proxy"], but the same is not true when I run shef or chef-client
[2013-03-18 21:21:23 -0400] kesor: why would `create` on resource 'template[]` throw a Net::HTTPServerException 403 "Forbidden"? :(
[2013-03-18 21:22:04 -0400] kesor: could it be because this template is defined inside a ruby_block (somewhere deep inside)?  and then, why does it work on a second chef run? :(
[2013-03-18 21:25:57 -0400] sabooky: Is there a way to use knife bootstrap with chef-solo?
[2013-03-18 21:27:27 -0400] oddover: hi all. when you upload cookbooks to the chef server, do you have to do that via knife?
[2013-03-18 21:28:07 -0400] oddover: or can you make something like a git post-commit hook that pushes the files to a directory on the chef server, that it can then read?
[2013-03-18 21:28:39 -0400] oddover: (or I guess more generally, can you just put the cookbooks in a directory on the server and have it read from there?)
[2013-03-18 21:28:57 -0400] kesor: oddover: it has to be done with knife, somewhere. they are stored in a database, not on disk.
[2013-03-18 21:29:20 -0400] oddover: ok
[2013-03-18 21:29:33 -0400] oddover: is there a good interface for doing that?
[2013-03-18 21:29:41 -0400] kesor: oddover: "knife cookbook upload" ?
[2013-03-18 21:30:28 -0400] oddover: ok
[2013-03-18 21:30:56 -0400] kesor: oddover: but its an interesting idea to do it in a git hook upon push.
[2013-03-18 21:31:16 -0400] oddover: maybe I could do a git hook to do the knife cookbook upload
[2013-03-18 21:31:19 -0400] kesor: oddover: I like it, especially when its used to "validate" your commit using "knife cookbook upload --freeze" and foodcritic and such.
[2013-03-18 21:31:34 -0400] kesor: yeah, you could. its a very nice idea.
[2013-03-18 21:32:13 -0400] oddover: also, is there any good docs on bookshelf and what it does?
[2013-03-18 21:34:58 -0400] kesor: oddover: you mean berkshelf.com
[2013-03-18 21:35:48 -0400] kesor: oddover: although I personally don't like it much, its overkill. librarian-chef from https://github.com/applicationsonline/librarian does the basic thing that I need, and its enough.
[2013-03-18 21:35:53 -0400] oddover: is that the bookshelf shown here? http://docs.opscode.com/chef_overview_server.html
[2013-03-18 21:36:42 -0400] kesor: oddover: no  thats some part of the chef server
[2013-03-18 21:36:46 -0400] ivey: no that's part of the chef server
[2013-03-18 21:36:48 -0400] oddover: ok
[2013-03-18 21:37:03 -0400] ivey: good thing we called it berkshelf or that would be super confusing
[2013-03-18 21:37:10 -0400] oddover: lol
[2013-03-18 21:38:10 -0400] oddover: so, if I want to set up two replicated chef servers, what do I need synced between the two? just the DB?
[2013-03-18 21:38:14 -0400] kesor: I really like that git-hook idea  am going to do it now.
[2013-03-18 21:38:24 -0400] oddover: kesor: your welcome :)
[2013-03-18 21:40:04 -0400] kesor: wtf  found a post commit hook, on github, but the hook is for subversion  :/
[2013-03-18 21:40:05 -0400] kesor: ehh
[2013-03-18 21:44:50 -0400] Majost: is there any reason a service start action would not actually do anything?
[2013-03-18 21:45:56 -0400] hikeit: oddover: i think if you just sync the DB, search won't work quite right, but i haven't had a chance to test yet
[2013-03-18 21:46:26 -0400] hikeit: majost: if it thinks the service is already running, or if the service start command failed silently
[2013-03-18 21:46:44 -0400] Majost: hrm
[2013-03-18 21:47:00 -0400] Urocyon: Ivey I appreciate the searchability of berkshelf over bookshelf as well.
[2013-03-18 21:47:30 -0400] Majost: how does chef know if the service is running?
[2013-03-18 21:47:50 -0400] hikeit: the exit code from service <foo> status
[2013-03-18 21:49:08 -0400] oddover: is anyone here running open source chef with multiple chef-servers?
[2013-03-18 21:50:25 -0400] kesor: oddover: chef-client on a server talking to more than one server?
[2013-03-18 21:50:46 -0400] kesor: on a box I mean
[2013-03-18 21:51:09 -0400] oddover: many chef-client nodes talking to multiple chef-servers
[2013-03-18 21:51:11 -0400] kesor: Majost: usually the specific provider checks the status via some status command
[2013-03-18 21:51:31 -0400] kesor: oddover: but one of these many chef-client nodes, would he be talking to more than one server?
[2013-03-18 21:51:48 -0400] oddover: kesor: probably not
[2013-03-18 21:51:57 -0400] kesor: oddover: whats the problem then?
[2013-03-18 21:52:37 -0400] oddover: kesor: I'm trying to figure out how to set up a HA, replicated chef server environment
[2013-03-18 21:54:09 -0400] hikeit: kesor: problem would be that if there are 2 servers, each serving half of the environment, if there is no synchronization, search wouldn't work (would only see half of the world).
[2013-03-18 21:54:17 -0400] qhartman: oddover, If you're doing this w/ chef 11, it shouldn't be too tough. Have two (or more) chef-servers behind a load balancer, and have them all talk to the same postgres server in the backend
[2013-03-18 21:54:23 -0400] hikeit: and if one goes down, the other won't have any record of all the clients that jump ship
[2013-03-18 21:54:29 -0400] kesor: hikeit: yeah, oddover sais he wants HA of chef servers 
[2013-03-18 21:54:39 -0400] qhartman: oddover, and then setup that postgres infrastrucutre with typical postgres HA stuff
[2013-03-18 21:55:02 -0400] hikeit: qhartman: what about search? how would they know to index?
[2013-03-18 21:55:13 -0400] hikeit: or does indexing come after it goes into the DB?
[2013-03-18 21:55:31 -0400] kesor: what about nodes registering to one of the servers, how would their metadata and certificate be transfered to the other server?
[2013-03-18 21:55:41 -0400] hikeit: my impression was that the info came from the API and went into both
[2013-03-18 21:55:45 -0400] qhartman: hikeit, Not sure w/ 11. I'm guessing based on what I read about chef 11 architecture
[2013-03-18 21:56:04 -0400] hikeit: i'm not either :) i guess we're all waiting for someone else to do it first
[2013-03-18 21:56:39 -0400] oddover: is there any detailed docs or a tutorial or something on how to do that with chef 11?
[2013-03-18 21:56:42 -0400] hikeit: kesor: the metadata and certificate are stored in the database, so if multiple servers all point to a single PG server, they'll all have the same data
[2013-03-18 21:57:43 -0400] hikeit: don't think anyone's written one yet
[2013-03-18 21:58:42 -0400] qhartman: The 11 architecture looks like it's a pretty typical Web App / DB system, so "normal" scaling / HA stuff should apply
[2013-03-18 21:59:38 -0400] gyre007: I wonder if Opscode implement role versionin or somehow get them more tied to cookbooks in some way..
[2013-03-18 22:00:31 -0400] hikeit: role versioning is supposedly coming in chef 12
[2013-03-18 22:00:43 -0400] qhartman: hikeit, gyre007 that's what I heard as well
[2013-03-18 22:00:48 -0400] kesor: I think if you synchronize /opt/chef-server/embedded/service/chef-solr/home/data/index/ and the rest of the /opt/chef-server folder  you will probably get all the correct indexes and stuff. assuming you can get some sort of consistency
[2013-03-18 22:00:53 -0400] miah: because everybody bitches about it. its a great workaround to poorly designed cookbooks though.
[2013-03-18 22:01:13 -0400] rafaelmagu: I'm getting "The requested method PUT is not allowed for the URL" from Chef 10
[2013-03-18 22:01:21 -0400] rafaelmagu: Do I purge the cookbooks and start again?
[2013-03-18 22:02:11 -0400] oddover: qhartman: so how do you do a multiple postgres database setup? do you use some sort of postgres cluster service like pgcluster?
[2013-03-18 22:03:07 -0400] oddover: Also, is it possible to handle multiple data centers on different networks in that kind of setup?
[2013-03-18 22:03:35 -0400] kesor: oddover: your server-name would need to be the same, because of the ssl certificate.
[2013-03-18 22:03:46 -0400] hikeit: multi-master db servers across data centers is a particularly hard problem
[2013-03-18 22:04:27 -0400] EJC: kesor - so I added the status command to be something like "service <servicename> check" and it works perfectly
[2013-03-18 22:04:41 -0400] EJC: kesor it seems that if the status check fails, there are no errors given
[2013-03-18 22:04:42 -0400] kesor: EJC: cool :)
[2013-03-18 22:05:02 -0400] EJC: kesor - kinda - this works flawlessly to a 12.04 ubuntu vm
[2013-03-18 22:05:11 -0400] EJC: kesor to a ec2 instance, it fails
[2013-03-18 22:05:30 -0400] kesor: EJC: your ec2 is also ubuntu precise?
[2013-03-18 22:05:37 -0400] EJC: kesor: yes
[2013-03-18 22:05:44 -0400] jtimberman: gyre007: roles don't have versions at all, so no, we don't implement that at all :)
[2013-03-18 22:05:56 -0400] EJC: kesor http://cloud-images.ubuntu.com/releases/precise/release/
[2013-03-18 22:05:58 -0400] jtimberman: gyre007: if roles were to get versions, it would be a "Chef 12" kind of thing, I *think*.
[2013-03-18 22:06:08 -0400] gyre007: I know...I wonder if you plan to
[2013-03-18 22:06:12 -0400] kesor: EJC: yeah, I use the same in my vagrant and ec2
[2013-03-18 22:06:12 -0400] gyre007: yeah
[2013-03-18 22:06:28 -0400] jtimberman: gyre007: it's been discussed, and i think that we'll probably add it, but i can't speak to the engineering priority queue :)
[2013-03-18 22:06:33 -0400] EJC: kesor would the ubuntu verion matter that much?
[2013-03-18 22:06:38 -0400] gyre007: understood :)
[2013-03-18 22:06:47 -0400] EJC: kesor seems like this either does or does NOT work - "check" should never work...
[2013-03-18 22:07:06 -0400] jtimberman: gem install ubuntu_ami ; knife ec2 amis ubuntu precise
[2013-03-18 22:07:45 -0400] kesor: jtimberman: why would you need a gem to tell you your ubuntu amis when you have that via http on ubuntu.com? :)
[2013-03-18 22:08:43 -0400] kesor: EJC: assuming the service is the same, and not upstart vs. init.d or something  it should work exactly the same, ec2 or not ec2.
[2013-03-18 22:08:54 -0400] EJC: kesor i know :-)
[2013-03-18 22:09:29 -0400] jtimberman: kesor: its faster to C-r amis ubuntu RET
[2013-03-18 22:09:44 -0400] EJC: kesor I'd have hoped that'd be the case, I'll also imagine that on my local vms, where it works, the service status is returning a failing exit code so the cookbook attempts to install the service :-)
[2013-03-18 22:09:52 -0400] jtimberman: i guess i could have written an alfred search plugin :)
[2013-03-18 22:10:02 -0400] jtimberman: but this works on linux machines too ;)
[2013-03-18 22:10:05 -0400] kesor: jtimberman: i only put them in a vagrant file once, from now on  its C-r vagrant up.
[2013-03-18 22:10:13 -0400] doomviking: oh man I love that.
[2013-03-18 22:10:16 -0400] jtimberman: kesor: AMIs change.
[2013-03-18 22:10:17 -0400] jtimberman: :D
[2013-03-18 22:10:31 -0400] kesor: jtimberman: the /current/ url points to the latest one
[2013-03-18 22:10:32 -0400] doomviking: I can now ditch that web bookmark :)
[2013-03-18 22:11:03 -0400] jtimberman: it was also fun to hack :)
[2013-03-18 22:11:12 -0400] kesor: :)
[2013-03-18 22:12:35 -0400] maplebed: gyre007: re: role versioning, the easy answer is to move everything that would be in a role into an application-cookbook instead and version that. at that point, role versions are superfluous.
[2013-03-18 22:12:53 -0400] gyre007: maplebed: thats what we are doing now
[2013-03-18 22:13:14 -0400] gyre007: but I like ease of search and naming that roles bring...
[2013-03-18 22:13:23 -0400] gyre007: makes our Infastructure nicely documented...
[2013-03-18 22:13:37 -0400] gleam: if the run list were being properly populated that'd make application cookbooks a little better too
[2013-03-18 22:14:07 -0400] rafaelmagu: Gaaaah! My Chef server is self-destructing!
[2013-03-18 22:14:15 -0400] maplebed: for search, create an internal standand that you assign an attribute in the app-cookbook and search on that instead; same results.
[2013-03-18 22:14:15 -0400] gyre007: lol
[2013-03-18 22:14:17 -0400] rafaelmagu: knife encountered an unexpected error
[2013-03-18 22:14:29 -0400] gyre007: maplebed: that lol wasnt meant for you
[2013-03-18 22:14:30 -0400] rafaelmagu: With every command that queries the server
[2013-03-18 22:14:45 -0400] maplebed: ;)
[2013-03-18 22:15:58 -0400] maplebed: gyre007: jamie winsor (berkshelf guy) made a compelling argument for that pattern at a chef meetup in SF last week.
[2013-03-18 22:16:14 -0400] gyre007: hah just watching that video :)
[2013-03-18 22:16:25 -0400] gyre007: literally
[2013-03-18 22:16:38 -0400] EJC: kesor so we're in agreement that there's some kinda bug in the service lwrp?
[2013-03-18 22:16:45 -0400] maplebed: nice.
[2013-03-18 22:17:07 -0400] kesor: EJC: prove it! :)
[2013-03-18 22:17:39 -0400] EJC: kesor:  this works:
[2013-03-18 22:17:42 -0400] maplebed: (for anybody else following along, the video is at http://goo.gl/duVnJ but skip to 20 minutes in to get to the good stuff.)
[2013-03-18 22:17:48 -0400] bluekelp: howdy. the web ui reports last chef-client run/server connect.  how can i get this via command line? i dumped json for knife search and knife node show but am not finding it
[2013-03-18 22:17:48 -0400] EJC: service "config-service" do
[2013-03-18 22:17:50 -0400] kesor: EJC: don't paste here ....
[2013-03-18 22:17:50 -0400] EJC:   status_command "service config-service check"
[2013-03-18 22:17:52 -0400] EJC:   supports :restart => true
[2013-03-18 22:17:54 -0400] EJC:   action [ :enable, :start ]
[2013-03-18 22:17:56 -0400] EJC: end
[2013-03-18 22:18:01 -0400] maplebed: bluekelp: knife status IIRC
[2013-03-18 22:18:02 -0400] EJC: this does NOT:
[2013-03-18 22:18:06 -0400] miah: jamies whole stance of "dont use roles, use wrapper cookbooks" is pretty stupid imho
[2013-03-18 22:18:10 -0400] EJC: service "config-service" do
[2013-03-18 22:18:12 -0400] EJC:   supports :restart => true
[2013-03-18 22:18:14 -0400] EJC:   action [ :enable, :start ]
[2013-03-18 22:18:16 -0400] EJC: end
[2013-03-18 22:18:18 -0400] EJC: >.< (sorry)
[2013-03-18 22:18:19 -0400] miah: it completely sidesteps attribute precedences
[2013-03-18 22:18:30 -0400] miah: and makes using roles or environments at all a little bit more difficult
[2013-03-18 22:18:45 -0400] miah: there are more elegant ways to implement those ideas without throwing out useful features of chef
[2013-03-18 22:19:06 -0400] bluekelp: maplebed: thanks
[2013-03-18 22:19:07 -0400] gyre007: miah: what are those elegant ways then ?
[2013-03-18 22:19:14 -0400] gyre007: this is working out good for us...
[2013-03-18 22:19:18 -0400] kesor: EJC: what about "supports :status => true, :restart => true"?
[2013-03-18 22:19:25 -0400] gyre007: but Id like to know opscode stance on this...
[2013-03-18 22:19:31 -0400] maplebed: huh.  I didn't get that it sidestepped attribute precedence - you still have all levels available in both.
[2013-03-18 22:19:38 -0400] miah: write wrapper cookbooks that implement business logic around resource/providers
[2013-03-18 22:19:43 -0400] gyre007: havent seen any blog post on this anywhere...pretty much almost everyone hates roles :)
[2013-03-18 22:19:49 -0400] EJC: kesor: not sure what you're shooting for?
[2013-03-18 22:19:58 -0400] miah: the only people that hate roles are the people who don't fully understand attribute precedence
[2013-03-18 22:19:59 -0400] gyre007: yeah LWRPs is another choice...fair enough
[2013-03-18 22:20:03 -0400] EJC: kesor:  the actual script doesn't have a <servicename> status argument
[2013-03-18 22:20:14 -0400] EJC: kesor it does have a servicename check argument
[2013-03-18 22:20:17 -0400] kesor: EJC: the default for "supports" is "supports { :restart => true, :status => true }", but you changed it to be only restart.
[2013-03-18 22:20:26 -0400] gyre007: miah: attr precedence was a total madness in previous versions...troubleshoot them and think big was a pain
[2013-03-18 22:20:27 -0400] miah: cookbooks that implement _all_ of their logic as recipes are typically quite inflexible
[2013-03-18 22:20:46 -0400] kesor: EJC: so your status_command is probably not even checked.
[2013-03-18 22:20:53 -0400] gyre007: in which way exactly
[2013-03-18 22:20:57 -0400] miah: i've been using chef for about 2 years and honestly haven't had many issues with attributes. (and right now I support chef 0.6 deployment so..)
[2013-03-18 22:21:32 -0400] gyre007: hah...well...becaue the concept is slightl complicated people are trying to find a way out of it...we want to make our lives easier ;)
[2013-03-18 22:21:39 -0400] miah: recipe based cookbooks force you to implement attributes based on their standard, and make too many other assumptions about how you want a service deployed as well as how your environment looks
[2013-03-18 22:21:39 -0400] gyre007: and it is...
[2013-03-18 22:21:51 -0400] gyre007: yeah but its nicely versioned
[2013-03-18 22:21:55 -0400] miah: the problem is that everybody using chef is still thinking like a sysadmin and not a programmer
[2013-03-18 22:22:01 -0400] gyre007: when someone messes up with role im screwed
[2013-03-18 22:22:01 -0400] jtimberman: Opscode's take is, "Here's a bunch of primitives for you to use. Pick the ones that work for you, ignore the ones that don't work, or that you don't need."
[2013-03-18 22:22:14 -0400] miah: and we're working out workarounds to make our shitty shell script ideas work well in chef
[2013-03-18 22:22:19 -0400] EJC: kesor you think that's why it worked?
[2013-03-18 22:22:20 -0400] gyre007: jtimberman: fair point
[2013-03-18 22:22:23 -0400] jtimberman: And attributes specifically, we recommend: Use "default" attributes *everywhere* you set attributes.
[2013-03-18 22:22:32 -0400] jtimberman: Except when you need to use other precedence levels.
[2013-03-18 22:22:38 -0400] EJC: kesor: not because I had the status_command in there?
[2013-03-18 22:22:42 -0400] jtimberman: And you'll know when you'll need them.
[2013-03-18 22:22:50 -0400] miah: a lwrp / hwrp cookbook shouldn't specify _any_ attributes. thats up to the end user to implement / abuse
[2013-03-18 22:23:01 -0400] kesor: EJC: status command is nice, but the service doesnt/didnt check the status so its behavior is adhoc.
[2013-03-18 22:23:02 -0400] jtimberman: miah: Did you read Erik's post?
[2013-03-18 22:23:08 -0400] jtimberman: Everyone should read that.
[2013-03-18 22:23:09 -0400] miah: jtimberman: nope?
[2013-03-18 22:23:09 -0400] Mithrandir: miah: I'm fairly sure we'll see distinct canons emerge somewhere down the line, where you get sysadmin-done-the-X way and sysadmin-done-the-Y-way
[2013-03-18 22:23:21 -0400] jtimberman: http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-03-18 22:23:24 -0400] EJC: kesor - I'm not following you on that adhoc part....
[2013-03-18 22:23:27 -0400] jtimberman: Mithrandir: ohai!
[2013-03-18 22:23:30 -0400] jdelan: Is there a knife command to force a node to run it's cookbooks?
[2013-03-18 22:23:38 -0400] Mithrandir: jtimberman: ohai indeed!
[2013-03-18 22:23:45 -0400] gyre007: its in my read queue jtimberman ...
[2013-03-18 22:23:53 -0400] miah: jtimberman: ah. erik knows his shit i'll give this a read shortly.
[2013-03-18 22:23:57 -0400] jtimberman: jdelan: depends :)
[2013-03-18 22:24:00 -0400] miah: Mithrandir: indeed.
[2013-03-18 22:24:16 -0400] jtimberman: jdelan: you can do, "knife ssh 'name:nodesnameyouwant' 'sudo chef-client'"
[2013-03-18 22:24:25 -0400] kesor: EJC: i think reading the attributes section of http://docs.opscode.com/resource_service.html might give you some ideas on how to fix your problem.
[2013-03-18 22:24:27 -0400] qhartman: oddover, there are tons of different ways to handle that. Personally I use streaming replication front-ended by Pgpool2
[2013-03-18 22:24:37 -0400] jtimberman: that will search the chef server for the node named nodesnameyouwant, open an ssh connection to it, and run chef-client
[2013-03-18 22:24:43 -0400] jdelan: @jtimberman, nope, will try it out, thanks
[2013-03-18 22:25:43 -0400] rafaelmagu: Alright, I need some help
[2013-03-18 22:25:48 -0400] rafaelmagu: Chef server is throwing a tantrum
[2013-03-18 22:25:50 -0400] EJC: kesor yeah, I see
[2013-03-18 22:25:59 -0400] rafaelmagu: After I came back from the holiday this morning
[2013-03-18 22:26:11 -0400] EJC: kesor if status is not provided it tries to look it up in the process table
[2013-03-18 22:26:18 -0400] EJC: kesor it shouldn't find it ANYWHERE
[2013-03-18 22:26:40 -0400] EJC: the cookbook it's running int the recipe both have the service name in it
[2013-03-18 22:26:44 -0400] rafaelmagu: Every knife command that queries the server returns: "Exception: NoMethodError: undefined method `name' for #<Hash:0x0000000291a738>"
[2013-03-18 22:26:57 -0400] EJC: I can only assume it's finding one of those and assuming it's running and not starting it
[2013-03-18 22:27:02 -0400] rafaelmagu: And trying to delete a node returns "Response: No routes match the request: /clients/"
[2013-03-18 22:27:12 -0400] kesor: EJC: better be explicit in your service attributes
[2013-03-18 22:27:37 -0400] EJC: once I added in the status_command, it worked - again - I'm guessing because my actual init script doesn't have a "status" option, only a "check" option
[2013-03-18 22:27:44 -0400] rafaelmagu: Where do I look?
[2013-03-18 22:27:45 -0400] EJC: kesor I'm trying that right now
[2013-03-18 22:27:49 -0400] rafaelmagu: Nothing in the logs for Solr
[2013-03-18 22:27:52 -0400] EJC: and kesor - thank you so much
[2013-03-18 22:28:03 -0400] kesor: EJC: np, don't think I helped much tbh.
[2013-03-18 22:28:07 -0400] EJC: kesor I was holding on to the end of this rope with just my fingernails
[2013-03-18 22:28:13 -0400] EJC: kesor - you did - you don't realize it :-)
[2013-03-18 22:28:34 -0400] miah: ok. ya. that article is pretty great. everybody should read it =)
[2013-03-18 22:28:39 -0400] miah: good job erikh
[2013-03-18 22:29:01 -0400] EJC: kesor yep, specifying the status command works - with the reload bit removed
[2013-03-18 22:29:10 -0400] kesor: EJC: glad to hear that.
[2013-03-18 22:29:29 -0400] EJC: kesor so I still think that's a bug
[2013-03-18 22:29:47 -0400] EJC: kesor somewhere it was thinking the status was "running" or "ok" or w/e - but the service wasn't up
[2013-03-18 22:30:03 -0400] EJC: the second I tell it the status command  - poof - it all works just fine....
[2013-03-18 22:30:09 -0400] EJC: wonder if my vm's won't work now.....
[2013-03-18 22:30:16 -0400] kesor: EJC: the status command return code should be zero when the service runs, and non-zero otherwise. I think.
[2013-03-18 22:30:39 -0400] kesor: EJC: the output does not matter, only the return code matters.
[2013-03-18 22:30:40 -0400] EJC: kesor right - I'd imagine so, but calling our services with "status" won't return anything
[2013-03-18 22:30:46 -0400] EJC: kesor right
[2013-03-18 22:30:50 -0400] EJC: one sec...
[2013-03-18 22:31:38 -0400] EJC: kesor calling our service with a nonexistant flag (I just did <servicename> holyhell) and the return code is 1
[2013-03-18 22:32:00 -0400] EJC: kesor - the status check to me then should have set of a chain that resulted in the service being installed
[2013-03-18 22:32:06 -0400] kesor: EJC: that would tell chef that the service is not running, so it would probably try and start it.
[2013-03-18 22:32:09 -0400] EJC: kesor sorry, started
[2013-03-18 22:32:19 -0400] jdelan: I'm trying to run "knife ssh 'name:*' 'sudo chef-client'", and it 'failed to connect' or'connection refused' against all my servers (they are windows), is that a firewall issue, or do I need to configure my knife.rb file?
[2013-03-18 22:32:38 -0400] EJC: kesor correct, and I can see the attempt to start the service, but it actually does nothing
[2013-03-18 22:32:41 -0400] EJC: kesor no service started
[2013-03-18 22:33:21 -0400] kesor: jdelan: try and use the fqdn using "knife ssh . -a fqdn"
[2013-03-18 22:34:00 -0400] kesor: jdelan: can you ssh to any of your servers with out using knife ssh?
[2013-03-18 22:34:07 -0400] kesor: *without
[2013-03-18 22:35:36 -0400] kesor: jdelan: also, for windows, you might need to use http://docs.opscode.com/plugin_knife_windows.html or something.
[2013-03-18 22:35:54 -0400] jdelan: thanks, kesor
[2013-03-18 22:36:52 -0400] EJC: kesor - where can I see the source for the service lwrp?
[2013-03-18 22:37:26 -0400] kesor: EJC: https://github.com/opscode/chef/tree/master/lib/chef/provider/service
[2013-03-18 22:39:09 -0400] EJC: kesor: thanks man - again , that service status should have produced an error of some kind if the service didn't support that
[2013-03-18 22:40:46 -0400] kesor: EJC: it does support it  just not the way you wrote your service script.
[2013-03-18 22:42:05 -0400] kesor: EJC: https://github.com/opscode/chef/blob/master/lib/chef/provider/service/simple.rb#L131 says "status", your custom service says "check".
[2013-03-18 22:42:07 -0400] EJC: kesor again - when I call my serivce script with "foobarbat" it has an exit code of 1, if I call it with check, it has an exit code of 0
[2013-03-18 22:42:20 -0400] kesor: EJC: check is not standard
[2013-03-18 22:42:58 -0400] benkay: is it a bad idea to run the chef workstation on the same box that chef server is running on?
[2013-03-18 22:43:15 -0400] EJC: kesor: I gotcha on that one (and totally agree), just kinda weird without the status command listed in my recipe, it says it's starting the service and it all just fails silently
[2013-03-18 22:44:08 -0400] EJC: kesor yeah, it's this r.match(line)
[2013-03-18 22:46:01 -0400] jdelan: so, then winrm states fqdn is not established, but I'm looking at the node, and the attribute is populated...odd
[2013-03-18 22:47:40 -0400] kesor: benkay: not a bad idea. just make sure you use address the server with its name, and not localhost.
[2013-03-18 22:50:39 -0400] EJC: kesor so if I said the resource supported start/restart/stop/status then this should also have failed is what you're suggesting?
[2013-03-18 22:51:11 -0400] EJC: it's that or explicitly say what the status command is (because we're idiots and used "check" instead of "status")...
[2013-03-18 22:51:18 -0400] kesor: EJC: yes, because without status_command it would have tried to use the wrong command to check the status.
[2013-03-18 22:51:39 -0400] EJC: kesor: it FINDS that string in the process table because the role is named after the servive
[2013-03-18 22:51:43 -0400] EJC: service
[2013-03-18 22:51:50 -0400] kesor: EJC: yes. thats what you get when your programmers don't follow convention and invent their own non-conventional things, disregarding return codes, inventing new words, etc ...
[2013-03-18 22:51:54 -0400] EJC: so it thingks it's running lol
[2013-03-18 22:52:25 -0400] kesor: I worked with a couple of companies where programmers that wrote services for linux didn't even know what a return code is ...
[2013-03-18 22:52:32 -0400] EJC: >.<
[2013-03-18 22:52:53 -0400] kesor: or where they would insist on telling me what a daemon is  with disregard on the 3-4 things every daemon should do.
[2013-03-18 22:53:10 -0400] kesor: (and then be surprised it receiped sigup and broken pipe)
[2013-03-18 22:53:14 -0400] kesor: *received
[2013-03-18 22:53:19 -0400] EJC: I'm not sure I know the 3 - 4 things a daemon should do either
[2013-03-18 22:53:22 -0400] EJC: >.<
[2013-03-18 22:54:14 -0400] kesor: EJC: http://www.netzmafia.de/skripten/unix/linux-daemon-howto.html check section 4.
[2013-03-18 22:55:45 -0400] EJC: kesor if I knew bupkis about daemons, I'd still have been able to guess about 3 of those lol
[2013-03-18 22:56:15 -0400] EJC: I do want to bring someone over to the meat grinder tomorrow and jam in their arm up to the elbow for this tho
[2013-03-18 22:56:19 -0400] kesor: programmers usually just run their scripts inside screen  :)
[2013-03-18 22:56:28 -0400] EJC: "works on my machine"
[2013-03-18 22:56:41 -0400] kesor: "who shut down the screen process???" )
[2013-03-18 22:56:42 -0400] kesor: :)
[2013-03-18 22:56:47 -0400] EJC: good, gimmie about all your laptops and I'll just cluster those, hell with this cloud crap
[2013-03-18 22:57:37 -0400] EJC: I _do_ wish the service provider would have said something like, "Grepping the process tree for a service named <r> - HEY found it called <line>"
[2013-03-18 22:57:43 -0400] EJC: then I'd have been hmmmmm....
[2013-03-18 22:58:24 -0400] kesor: it does
[2013-03-18 22:58:30 -0400] kesor: https://github.com/opscode/chef/blob/master/lib/chef/provider/service/simple.rb#L146
[2013-03-18 23:01:01 -0400] EJC: kesor: what version of chef does thtat come in or has that not changed in forever?
[2013-03-18 23:01:13 -0400] EJC: I do _NOT_ see that in any of my logs with them run with -VV
[2013-03-18 23:01:23 -0400] kesor: you need to use "chef-client -l debug"
[2013-03-18 23:01:24 -0400] kesor: i think
[2013-03-18 23:02:09 -0400] EJC: kesor I'm installing via knife ec2 server create -VV
[2013-03-18 23:02:24 -0400] EJC: and just grepping my logs, I don't see anything about the falling back to table ... business in them
[2013-03-18 23:02:34 -0400] kesor: EJC: well, ssh into your ec2 instance and run "chef-client -l debug"
[2013-03-18 23:04:04 -0400] siezer: grye its the same mostly
[2013-03-18 23:04:33 -0400] EJC: kesor seriously man - you've helped me so much
[2013-03-18 23:04:44 -0400] EJC: now I owe you and timberman a meal when you're in boston
[2013-03-18 23:05:12 -0400] kesor: buy me a ticket to boston first ;)
[2013-03-18 23:05:23 -0400] EJC: you didn't help me THAT much :-)
[2013-03-18 23:05:33 -0400] siezer: use_inline_resources addresses CHEF-3681
[2013-03-18 23:07:08 -0400] EJC: kesor - it's funny - once you see how things come off the rails, turning aroudn and looking at how many times you successfuully crossed those paths is pretty scary/crazy
[2013-03-18 23:07:44 -0400] edelschaedel: does anyone know how to convert a metadata.json file into a metadata.rb file?   For some reason i have the json but not the .rb in a cookbook.
[2013-03-18 23:07:51 -0400] kesor: EJC: yeah, good thing we have new rails up in front.
[2013-03-18 23:07:57 -0400] kesor: EJC: or else it would be boring
[2013-03-18 23:08:09 -0400] kesor: edelschaedel: is it very long?
[2013-03-18 23:08:30 -0400] edelschaedel: well long enough to not want to recreate it by hand :-)
[2013-03-18 23:10:01 -0400] kesor: edelschaedel: just remove all the curly braces and its good to go ;)
[2013-03-18 23:11:15 -0400] edelschaedel: kessor:  thanks!  i'll try that.
[2013-03-18 23:13:29 -0400] benkay: is there a way to rip out the knife tool and reinstall it? I'm getting crazy errors on my chef-server installation when I try to run knife.
[2013-03-18 23:13:58 -0400] kesor: benkay: did you install using omnibus?
[2013-03-18 23:14:15 -0400] benkay: yes
[2013-03-18 23:14:23 -0400] benkay: kesor: yes
[2013-03-18 23:14:56 -0400] kesor: benkay: then your chef client things are mostly at /opt/chef/ and you probably have a "chef" package that you can remove with apt-get if its ubuntu.
[2013-03-18 23:16:01 -0400] andrer: Do anyone know if it should be regarded a bug that running chef-client with a custom runlist (-o) should disregard attributes set on the role/node?
[2013-03-18 23:16:07 -0400] andrer: Or is that actually intended behavior?
[2013-03-18 23:16:10 -0400] EJC: kesor  -  just out of curiosity - have you ever seen this:
[2013-03-18 23:16:15 -0400] EJC: https://forums.aws.amazon.com/thread.jspa?messageID=385024
[2013-03-18 23:16:16 -0400] andrer: Because that took me by surprise.
[2013-03-18 23:16:16 -0400] benkay: kesor: I only have /opt/chef-server, which makes me think I'm misremembering using the omnibus installer
[2013-03-18 23:16:34 -0400] kesor: benkay: the new-er chef-servers dont install knife at all.
[2013-03-18 23:16:37 -0400] EJC: i see it listed here as well http://tickets.opscode.com/browse/KNIFE-207
[2013-03-18 23:17:32 -0400] benkay: now, if which knife is pointing me at /usr/local/bin, what does that imply about installation method?
[2013-03-18 23:17:59 -0400] kesor: benkay: I think it says you did "gem install chef". try and check with "gem list"
[2013-03-18 23:18:24 -0400] kesor: EJC: idk. could be that fog is using an older version of the aws api that doesn't list some kind of new-er ec2 instances or something. all aws api calls have a version in them.
[2013-03-18 23:18:59 -0400] benkay: heh kesor I get a totally blank list out of that
[2013-03-18 23:19:09 -0400] kesor: benkay: "sudo gem list" ? :/
[2013-03-18 23:19:11 -0400] kesor: idk :)
[2013-03-18 23:19:21 -0400] EJC: the ec2 instance create creates the instance, then randomly it fails saying "I can't find that instance" that opscode bug I pasted in has the exact thing I'm seeing
[2013-03-18 23:19:22 -0400] benkay: huh. yeah, that did a thing.
[2013-03-18 23:19:23 -0400] kesor: try and read inside the file.
[2013-03-18 23:21:06 -0400] benkay: thanks, kesor.
[2013-03-18 23:22:01 -0400] kesor: now if only my own chef thing would work  that would really be great. I even did an effort and earned lots of karma on purpose. ehhh...
[2013-03-18 23:23:17 -0400] benkay: haha
[2013-03-18 23:23:24 -0400] benkay: well, you can keep building your karma up.
[2013-03-18 23:23:51 -0400] benkay: and riddle me this: when does chef make admin.pem?
[2013-03-18 23:24:13 -0400] doomviking: EJC: it happens to me rarely
[2013-03-18 23:24:18 -0400] kesor: benkay: during /opt/chef-server/bin/chef-server-ctl reconfigure
[2013-03-18 23:24:44 -0400] kesor: benkay: or maybe during dpkg -i chef-server.dpkg  one of these
[2013-03-18 23:25:13 -0400] benkay: kesor any suggestions on how to regenerate that?
[2013-03-18 23:25:29 -0400] kesor: benkay: don't you have it already in /etc/chef-server/ ?
[2013-03-18 23:25:46 -0400] benkay: kesor: only chef-server-secrets.json
[2013-03-18 23:26:00 -0400] kesor: benkay: did you do that reconfigure in the first place?
[2013-03-18 23:26:00 -0400] EJC: doomviking: we have something like 15 services - and for testing, we spin up ALL of them and it nukes us 9 out of 10 times....
[2013-03-18 23:26:52 -0400] benkay: kesor no...
[2013-03-18 23:27:14 -0400] kesor: benkay: you should  its in the two-line instructions on the omnibus download page.
[2013-03-18 23:27:23 -0400] benkay: interesting. i have no chef-server/bin
[2013-03-18 23:27:38 -0400] doomviking: EJC: nuts
[2013-03-18 23:27:47 -0400] kesor: benkay: opscode.com/chef/install check the "server" tab.
[2013-03-18 23:28:17 -0400] EJC: doomviking: yeah, not sure what to do about it - leaves a nameless instance running and our process craps out
[2013-03-18 23:28:27 -0400] EJC: I don't see a retry option or anything....
[2013-03-18 23:28:59 -0400] benkay: kesor: i may have borked this install. "chef-server-ctl: not found"
[2013-03-18 23:29:14 -0400] kesor: benkay: its somewhere in /opt/chef-server/ ....
[2013-03-18 23:29:29 -0400] EJC: I'm gonna toss something into the mailing list and see if someone doesn't have any suggestions - finally to the point of wanting to pull down the ruby code for that gem...
[2013-03-18 23:31:33 -0400] doomviking: EJC: yeah if its hitting you that hard, definitely make some noise
[2013-03-18 23:31:55 -0400] kesor: EJC: you might want to check the ec2 api version that is used by whatever library you get that problem with
[2013-03-18 23:33:07 -0400] kesor: EJC: according to http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ the latest version is 2013-02-01, you can use my test script to ask for a list of your servers and see if its the aws version thing or not -- check https://github.com/kesor/amazon-queries/blob/master/main.py it has a "DescribeInstances" question in there somewhere.
[2013-03-18 23:33:50 -0400] EJC: it's not an aws thing - I can see the instance is created and running and available
[2013-03-18 23:34:30 -0400] kesor: EJC: the AWS APIs have versions  maybe your "fog" gem or whatever is using an older version that doesn't show your instances.
[2013-03-18 23:34:32 -0400] EJC: kesor I also have the latest 0.6.2 knife ec2 plugin installed
[2013-03-18 23:34:52 -0400] kesor: EJC: yes yes  it doesn't matter, they still probably use an older version of the api.
[2013-03-18 23:34:55 -0400] EJC: the only gems installed are what get laid down when we install the knife plubins
[2013-03-18 23:34:59 -0400] EJC: plugins
[2013-03-18 23:35:22 -0400] kesor: EJC: whats your version on your "fog" gem?
[2013-03-18 23:36:14 -0400] EJC: kesor *** LOCAL GEMS ***
[2013-03-18 23:36:18 -0400] EJC: fog (1.7.0, 1.5.0)
[2013-03-18 23:36:43 -0400] kesor: ok, sec.
[2013-03-18 23:37:32 -0400] kesor: look here -- https://github.com/fog/fog/blob/v1.7.0/lib/fog/aws/compute.rb#L322  see, its using version 2012-07-20, and not the latest 2013-02-01.
[2013-03-18 23:38:20 -0400] kesor: which might mean that aws returns weird results when using the older api version. you can check it with the script I linked.
[2013-03-18 23:38:37 -0400] EJC: how would I upgrade that?
[2013-03-18 23:39:02 -0400] EJC: and how confident are we that upgrading it fixes the problem and doesn't introduce other whackiness (or is there another fix)?
[2013-03-18 23:39:19 -0400] kesor: i'm not confident. thats why I told you to test first.
[2013-03-18 23:39:33 -0400] doomviking: fog 1.10.0 uses 2012-12-01
[2013-03-18 23:39:54 -0400] kesor: EJC: is your account in AWS new?
[2013-03-18 23:40:13 -0400] EJC: kesor maybe 4 months old?
[2013-03-18 23:40:43 -0400] kesor: EJC: mm no, it can't be the vpc thing then. but still  check with the two version numbers to see if its the same result.
[2013-03-18 23:43:07 -0400] EJC: kesor: ok, one sec...
[2013-03-18 23:43:59 -0400] kesor: check the code at https://github.com/kesor/amazon-queries/blob/master/main.py  its about 45 lines in the amazon/query.py file which does the request, and 13 lines in main.py that asks the question.
[2013-03-18 23:45:42 -0400] benkay: i'm staring at the admin public key in my webui
[2013-03-18 23:46:00 -0400] EJC: kesor: hmmmm - not sure what kinda result I shoudl be expecting lol
[2013-03-18 23:46:05 -0400] benkay: and am somewhat at my wits end to figure out where the .pem file exists on the drive
[2013-03-18 23:46:06 -0400] kesor: benkay: you should have the private one in /etc/chef-server/
[2013-03-18 23:46:29 -0400] kesor: EJC: its a list of your instances  in xml, raw form of the aws api.
[2013-03-18 23:46:34 -0400] benkay: negatron, kesor.
[2013-03-18 23:46:39 -0400] benkay: no clue why.
[2013-03-18 23:47:22 -0400] kesor: benkay: you install chef-server with the omnibus thing, then run chef-server-ctl reconfigure, then wait, then boom  admin.pem is there.
[2013-03-18 23:47:47 -0400] benkay: kesor: apparently I didn't use the omnibus, because chef-server-ctl is nowhere to be found.
[2013-03-18 23:48:04 -0400] benkay: getting close to a ls -R / | grep chef-server-ctl
[2013-03-18 23:48:08 -0400] w6fu: *dumb ruby question alert* Can I use a variable inside a hash?
[2013-03-18 23:48:09 -0400] benkay: and going for a walk
[2013-03-18 23:48:19 -0400] w6fu: example: mysql_connection_info = {:host => "mysql1-master", :username => 'root', :password => #{mysql_password}}
[2013-03-18 23:48:51 -0400] kesor: w6fu: yes, just use the variable name, no curly braces. its without quotes, so ruby will not think its a string.
[2013-03-18 23:49:12 -0400] w6fu: mysql_connection_info = {:host => "mysql1-master", :username => 'root', :password => mysql_password}
[2013-03-18 23:49:15 -0400] w6fu: like that?
[2013-03-18 23:49:25 -0400] EJC: kesor: ok, I see a list of instances - I didn't realize i had to comment out everything but what I wanted :-)
[2013-03-18 23:49:45 -0400] kesor: EJC: yeah, also the endpoint has the region in there somewhere ...
[2013-03-18 23:49:50 -0400] EJC: right
[2013-03-18 23:49:58 -0400] EJC: I had to replace west with east
[2013-03-18 23:50:17 -0400] kesor: EJC: so you can try out the two different versions of the API, the one used in fog 1.7.0 and the current one  and see if thats the problem.
[2013-03-18 23:50:19 -0400] EJC: so when the knife ec2 server create bonks again, I should run this?
[2013-03-18 23:50:48 -0400] kesor: EJC: yeah, then you can for sure know that its not AWS who is fooling your tools  that its actually a bug in fog or something.
[2013-03-18 23:51:00 -0400] EJC: ok, lemmie plug in 2012-07-20 first and see what happens...
[2013-03-18 23:51:30 -0400] EJC: pluggin in 2012-07-20 works just as good
[2013-03-18 23:52:06 -0400] kesor: you can see a list of even older ones at http://aws.amazon.com/developertools/351  but I guess it only breaks when it breaks.
[2013-03-18 23:52:22 -0400] w6fu: kesor: works, thank you very much.
[2013-03-18 23:53:31 -0400] EJC: kesor I feel like it's in line 228 where we create the connection and it doesn't try/retry
[2013-03-18 23:53:31 -0400] benkay: oh man
[2013-03-18 23:53:42 -0400] benkay: kesor dig this: there is no chef-server-ctl file on my box
[2013-03-18 23:53:43 -0400] benkay: period.
[2013-03-18 23:53:56 -0400] kesor: EJC: the way the AWS api works, when your have a very long xml response, it will break it into pieces and give you a next_token  idk, maybe fog has a bug with that as well. its only a guess, but idk.
[2013-03-18 23:54:32 -0400] kesor: benkay: did you install chef-server with omnibus? ...
[2013-03-18 23:54:42 -0400] benkay: apparently not.
[2013-03-18 23:54:48 -0400] benkay: or i ruined something afterwards.
[2013-03-18 23:54:56 -0400] benkay: hilariously, the webui is running
[2013-03-18 23:54:58 -0400] benkay: chef server is running
[2013-03-18 23:55:00 -0400] kesor: benkay: is your computer power cord in both the socket in the wall and the socket in the computer? :)
[2013-03-18 23:55:01 -0400] benkay: chef-solr is running
[2013-03-18 23:55:07 -0400] EJC: >.<
[2013-03-18 23:55:14 -0400] benkay: i am ssh'd into the beast
[2013-03-18 23:55:35 -0400] doomviking: voodoo
[2013-03-18 23:56:13 -0400] kesor: EJC: what you think about my tiny python aws api tool? :)
[2013-03-18 23:56:36 -0400] kesor: EJC: it mostly requires to copy-paste from the API docs on aws.amazon.com/documentation/
[2013-03-18 23:56:38 -0400] EJC: I dig it
[2013-03-18 23:57:04 -0400] kesor: only part I couldn't write for it is XML parsing  :)
[2013-03-18 23:57:26 -0400] EJC: it JUST died again on me just now
[2013-03-18 23:57:38 -0400] EJC: ready to rip out the remaining bits of hair I have lol
[2013-03-18 23:57:57 -0400] EJC: at least the service start up nonsense works for sure
[2013-03-18 23:58:52 -0400] benkay: kesor: installed through apt.
[2013-03-18 23:59:18 -0400] kesor: benkay: then you probably have the 10.x server, which didn't have that configure command.
[2013-03-18 23:59:27 -0400] kesor: benkay: and it has no "admin.pem" either
[2013-03-18 23:59:30 -0400] benkay: nice!
[2013-03-18 23:59:31 -0400] benkay: nice nice.
[2013-03-18 23:59:44 -0400] benkay: i have no idea what the implications of that would be for workstation startup.
