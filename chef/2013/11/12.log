[2013-11-12 00:04:53 -0500] otakup0pe: i feel like i'm taking crazy pills.
[2013-11-12 00:05:22 -0500] otakup0pe: searching for "chef_environment:foo AND name:api*" returns the one node i expect. "chef_environment:foo AND name:elastic*" reutrns every nod ein foo
[2013-11-12 00:05:25 -0500] otakup0pe: what am i missing here
[2013-11-12 00:10:55 -0500] otakup0pe: bueler ?
[2013-11-12 00:13:50 -0500] ptrf: I want to have chef dump the run list and versions of cookbooks in /etc/motd on new nodes.
[2013-11-12 00:14:11 -0500] ptrf: My idea was to render a template with a variable.
[2013-11-12 00:15:38 -0500] do46: Hey there, I'm very new to chef. Can anyone point me to a good resource to help me understand when to use a LWRP vs when to use an ordinary ruby library class
[2013-11-12 00:15:58 -0500] ptrf: I'm trying to get a string for the run list by running run_context.cookbook_collection.to_hash.each do |cookbook, version| ... in order to iterate over the run list for that run
[2013-11-12 00:16:17 -0500] bobbyz: What is node.run_state supposed to be used for?  The only references I can find indicate it's something deprecated but I can't find much more than that, and it seems to be used extensively in the nginx cookbook (node.run_state['nginx_configure_flags'])
[2013-11-12 00:16:18 -0500] josephholsten: dgarstang3: did you figure out your issue with CHEF-3694?
[2013-11-12 00:16:45 -0500] dgarstang3: josephholsten: not yet. it's been an issue for months now
[2013-11-12 00:17:08 -0500] dgarstang3: josephholsten: i think it's because the user cookbook tries to run the same code for each group that a user is in
[2013-11-12 00:17:45 -0500] josephholsten: bobbyz: it's sorta like a single-run cache of values. the attributes don't get persisted to the chef server, but are accessible to other recipes
[2013-11-12 00:18:19 -0500] bobbyz: josephholsten: awesome, ty.  So basically a shared hash that recipes can access
[2013-11-12 00:18:53 -0500] josephholsten: dgarstang3: usually that warning is legit. if you've got multiple places trying to control resources, it's very likely that they are interacting with each other in unexpected ways
[2013-11-12 00:19:09 -0500] josephholsten: if you need something like adding groups to a user, then try
[2013-11-12 00:21:06 -0500] ptrf: anyone got any pointers as to how I would get the run_list from a recipe
[2013-11-12 00:21:46 -0500] ptrf: can't seem to find any attributes og resources providing that info
[2013-11-12 00:23:34 -0500] dgarstang3: josephholsten: Seems to work fine for the users cookbook
[2013-11-12 00:23:53 -0500] josephholsten: group "add #{@user} to #{@group}" do; members [@user]; group_name @gid; append true; end
[2013-11-12 00:23:57 -0500] dgarstang3: josephholsten: i don't think the author ever thought to test a user might be in multiple groups
[2013-11-12 00:24:10 -0500] josephholsten: the trick is to have the resource name not be identical
[2013-11-12 00:24:21 -0500] dgarstang3: josephholsten: tell that to the author :)
[2013-11-12 00:24:26 -0500] josephholsten: no
[2013-11-12 00:25:39 -0500] dgarstang3: josephholsten: allrighty then
[2013-11-12 00:26:18 -0500] josephholsten: oh, I see. you're not using the groups attribute on a user databag
[2013-11-12 00:26:38 -0500] josephholsten: are you using the users_manage resource directly?
[2013-11-12 00:26:45 -0500] dgarstang3: josephholsten: Yes
[2013-11-12 00:27:16 -0500] dgarstang3: If it's not one random error, it's another random error "ArgumentError: You must specify at least one cookbook repo path"
[2013-11-12 00:28:28 -0500] josephholsten: lol. I have no idea where that could be coming from. I thought the client/knife config file had a reasonable default for that
[2013-11-12 00:30:21 -0500] dgarstang3: josephholsten: Doing this... http://pastebin.com/nHuqtsgg
[2013-11-12 00:30:40 -0500] dgarstang3: and then some users get assigned to multiple groups
[2013-11-12 00:30:50 -0500] josephholsten: so you're right about the users cookbook not expecting you to use the users_manage resource for more than one group. honestly, I'm impressed it doesn't blow up at all when used that way.
[2013-11-12 00:31:54 -0500] josephholsten: but that's one of those use cases that is hard to write another way, and is entirely safe
[2013-11-12 00:32:13 -0500] josephholsten: b/c the resource is being defined in exactly the same way for each call
[2013-11-12 00:32:31 -0500] dgarstang3: what I figured
[2013-11-12 00:32:45 -0500] josephholsten: I wonder if there's a ticket for that particular case
[2013-11-12 00:32:51 -0500] dgarstang3: cookbook management makes my head hurt.
[2013-11-12 00:32:53 -0500] dgarstang3: :(
[2013-11-12 00:34:58 -0500] dgarstang3: I moved my base role from the recipe to the Vagrant file's run_list (replicating a real deploy). Now, it can't find other cookbooks that where in the base role. This makes me want to scream.
[2013-11-12 00:39:01 -0500] dgarstang3: Why can't I put the base role into Vagrantfile?
[2013-11-12 00:40:38 -0500] dgarstang3: Cuz, if I do, then it can't find shit
[2013-11-12 00:46:22 -0500] dgarstang3: What on Earth does this mean? 'ArgumentError: You must specify at least one cookbook repo path'
[2013-11-12 01:05:33 -0500] gclark85: anyone have a good way to manage chef clients in EC2?  I am wondering when clients get removed, how to delete them from hosted chef
[2013-11-12 01:12:05 -0500] dgarstang3: Back to this again. "ArgumentError: You must specify at least one cookbook repo path"
[2013-11-12 01:12:26 -0500] otakup0pe: gclark85: we use runlevel 0 scripts to cleanup
[2013-11-12 01:12:35 -0500] otakup0pe: coupled with a "janitor" script we use to periodically prune.
[2013-11-12 01:12:45 -0500] otakup0pe: didn't see anything out from the community tho. if you see one that'd be rad.
[2013-11-12 01:13:12 -0500] log1kal: gclark85: otakup0pe: we did similar, but weren't allowed to opensource it :(
[2013-11-12 01:13:34 -0500] otakup0pe: i just havne't gotten around to it :/
[2013-11-12 01:15:02 -0500] gclark85: Am I on the right track if I think I need to do something like have a shutdown script for deleting the node?
[2013-11-12 01:16:35 -0500] gclark85: ah, runlevel 0 is shutdown, got it
[2013-11-12 01:17:55 -0500] gclark85: but when I try to run knife on the client, I get errors.
[2013-11-12 01:19:27 -0500] otakup0pe: we didn't do it through knife, we did something with ridley.
[2013-11-12 01:19:34 -0500] otakup0pe: you could use knife but you'll need a knife.rb
[2013-11-12 01:19:49 -0500] otakup0pe: dunno which option is the least anti-pattern
[2013-11-12 01:20:33 -0500] gclark85: haha, got it ok
[2013-11-12 01:27:50 -0500] josephholsten: any pre-summit events in seattle tonight?
[2013-11-12 02:01:07 -0500] magoo: i'm still using the old model of having a chef repo with all of my cookbook deps contained in it. my vagrantfile is at the root of the repo and relies on a roles/standalone.rb file to provision our dev environment. how do i fit this into the berkshelf method?
[2013-11-12 02:01:44 -0500] josephholsten: very painfully ;-)
[2013-11-12 02:01:58 -0500] josephholsten: I use test kitchen inside of each of my cookbooks in the repo
[2013-11-12 02:02:05 -0500] magoo: yeah, it seems like a huge monolithic task
[2013-11-12 02:02:20 -0500] josephholsten: this lets me add it to each one as I touch them.
[2013-11-12 02:02:41 -0500] josephholsten: and whenever I need to, I can go back to the old workflow
[2013-11-12 02:03:12 -0500] josephholsten: once we've got all the cookbooks berkshelf-ified and test-kitchenized, we're going to split them off into separate repos
[2013-11-12 02:03:32 -0500] magoo: so do you have one berksfile in the base of your repo?
[2013-11-12 02:05:03 -0500] magoo: is there a good writeup on this?
[2013-11-12 02:21:07 -0500] josephholsten: magoo: no good writeup. I should do that.
[2013-11-12 02:22:41 -0500] josephholsten: do you have a team working out of the same chef repo?
[2013-11-12 04:15:42 -0500] rafaelmagu: When knife upload / returns "ERROR: internal server error", where does one go on the chef-server (11.x) to see what's going on?
[2013-11-12 05:19:08 -0500] garrett__: I don't suppose anyone's seen this before? I'm trying to 'knife upload .' into a fresh chef server. "ERROR: File remote/ is a directory while file remote/ is a regular file"
[2013-11-12 05:21:22 -0500] garrett__: I'm not getting anything useful out of dtruss to figure out what's actually emitting that
[2013-11-12 05:22:18 -0500] jkeiser: garrett__: what version of chef?  and of knife-essentials?
[2013-11-12 05:25:32 -0500] garrett__: jkeiser: chef 11.0.8-1-ubuntu-12.04, knife 11.4.4
[2013-11-12 05:25:44 -0500] garrett__: annnd maybe that's my problem
[2013-11-12 05:26:18 -0500] jkeiser: garrett__: if you upgrade to latest chef it should at least get better, if not go away
[2013-11-12 05:26:30 -0500] jkeiser: garrett__: or you can gem install knife-essentials and not upgrade chef
[2013-11-12 05:27:21 -0500] jkeiser: garrett__: imo upgrading to chef 11.8 is preferable to that :)
[2013-11-12 05:27:43 -0500] jkeiser: the knife-essentials gem is no longer maintained except big bug fixes; new features go into chef proper.
[2013-11-12 05:27:47 -0500] garrett__: jkeiser: hrm, n/m. 11.0.8 is the most recent chef-server, according to opscode.com/chef/install
[2013-11-12 05:28:00 -0500] jkeiser: garrett__: server or client?
[2013-11-12 05:28:07 -0500] jkeiser: garrett__: you need the latest client
[2013-11-12 05:28:12 -0500] garrett__: jkeiser: server.
[2013-11-12 05:28:21 -0500] jkeiser: garrett__: server isn't the issue, client is
[2013-11-12 05:28:29 -0500] garrett__: jkeiser: ah; duh. ok. that's an easy fix
[2013-11-12 05:29:03 -0500] jkeiser: when knife --version yields 11.8.0, you should be in much better shape
[2013-11-12 05:31:01 -0500] jkeiser: I'm afraid my head is drooping onto the keyboard, my only other suggestion is once you upgrade client to 11.8.0, make sure knife-essentials is not installed (type gem uninstall knife-essentials)
[2013-11-12 05:31:12 -0500] jkeiser: Latest greatest is in chef
[2013-11-12 05:31:36 -0500] garrett__: jkeiser: thanks. now i just have to do a little unwinding to make all my client tools happy under 10.9, but this makes sense
[2013-11-12 05:31:50 -0500] jkeiser: 10.9?
[2013-11-12 05:31:56 -0500] garrett__: jkeiser: i'm in the same boat. i was looking at version numbers and my brain just farted. it's like 11:30pm here.
[2013-11-12 05:32:03 -0500] garrett__: jkeiser: osx mavericks
[2013-11-12 05:32:08 -0500] jkeiser: ah ok :)
[2013-11-12 05:32:32 -0500] garrett__: jkeiser: though it'll probably be faster to just boot a vm and do that it that way :P
[2013-11-12 05:32:37 -0500] garrett__: jkeiser: thanks for your slap upside the head, hehe
[2013-11-12 05:32:40 -0500] jkeiser: cool!  I'll be at the summit tomorrow, but do file a bug if you're still having an issue and no one responds
[2013-11-12 05:33:03 -0500] jkeiser: heh, I'm slap happy
[2013-11-12 05:33:05 -0500] jkeiser: good luck!
[2013-11-12 07:29:25 -0500] s2r2: arghs. Ubuntu's missing always_set_home in sudoers is causing execute("env > env.log"){ user "ubuntu" } to include HOME=/root.
[2013-11-12 07:30:59 -0500] s2r2: Am I right to assume that mixlib shellout is somehow using sudo?  Couldn't really find it in the code...
[2013-11-12 07:43:08 -0500] bcave: hi
[2013-11-12 07:44:14 -0500] bcave: any chefspec users here? I'm trying to access a node attribute in a before block
[2013-11-12 07:44:59 -0500] bcave: chef_run.node['cookbook'
[2013-11-12 07:45:08 -0500] bcave: chef_run.node['cookbook']['attribute']
[2013-11-12 07:45:21 -0500] bcave: is that the correct way to access node attributes?
[2013-11-12 07:47:23 -0500] bcave: never mind, I came right. i thought the default attributes were loading, but it has to be manually set
[2013-11-12 08:46:40 -0500] jhgaylor: chef isn't running one of my template resources.  with -l debug it doesn't even mention it.  how might i debug this?
[2013-11-12 08:47:35 -0500] s2r2: jhgaylor: try to follow the path your expecting chef to hit on your recipe containing the template[]
[2013-11-12 08:48:08 -0500] jhgaylor: there is another template resource that references another file in the same directory.
[2013-11-12 08:48:09 -0500] s2r2: jhgaylor: start from the run_list, extended run_list, include_recipe-calls, if branches in your recipes...
[2013-11-12 08:48:34 -0500] s2r2: jhgaylor: conditionals, maybe?  hard to tell without a glance at your recipe..
[2013-11-12 08:50:52 -0500] ocholetras: Guys what do you thing abou the pattern about using a cookbook called "Roles" and recipes for each roles to "simulate" a role runlist which is versionable, mentioned by Dunn on this video;: http://www.opscode.com/blog/chefconf-talks/beginning-chef-antipatterns-julian-dunn/
[2013-11-12 08:51:08 -0500] jhgaylor: s2r2 pybackend.rb has 1 template resource and it's being ignored.  everything else works as expected https://gist.github.com/jhgaylor/7427655
[2013-11-12 08:51:21 -0500] jhgaylor: i'm really new to chef.  i just picked it up last week because it seemed cheaper than a sys admin :D
[2013-11-12 08:52:43 -0500] s2r2: jhgaylor: I won't comment that assumption your recipes look pretty straight-forward, what's your run_list?  does it include tracer::default?
[2013-11-12 08:53:45 -0500] jhgaylor: the run_list is just tracer but i've tried tracer::pybackend as well
[2013-11-12 08:55:03 -0500] jhgaylor: if the template was invalid I would expect chef to complain, the file is present, and i have permissions.  is it possible the client has cached an old cookbook?
[2013-11-12 08:56:44 -0500] s2r2: jhgaylor: is it possible that the chef-server doesn't have the latest one?  that variant is more probable I think
[2013-11-12 08:57:00 -0500] s2r2: however, /var/chef/cache I think contains your cookbooks on the machine
[2013-11-12 08:57:15 -0500] jhgaylor: according to the logs of berks upload tracer the proper version has been uploaded.  ill check the web gui.
[2013-11-12 08:58:29 -0500] jhgaylor: the version number is correct, but the file isn't up to date.  weird.  at least i've found a symptom now :)  thanks!
[2013-11-12 09:10:54 -0500] JeanMertz: I include a custom library helper in my cookbook attributes file, this works. But when I use "include_attribute" from another cookbook, it can't find the helper anymore in the original cookbook. Is there any way to force library loading even when using include_attribute?
[2013-11-12 09:14:00 -0500] JeanMertz: In other words, how can I force CookbookCompiler to run #compile_libraries when using the include_attributes helper
[2013-11-12 09:15:43 -0500] jaykatta: ERROR: Errno::EHOSTUNREACH: No route to host - connect(2) getting this error when I run knife configure --initial
[2013-11-12 09:15:45 -0500] jaykatta: can anybody help
[2013-11-12 09:16:07 -0500] jaykatta: I have updated /etc/hosts on both workstation and opensource chef server
[2013-11-12 09:16:28 -0500] jhgaylor: i uploaded several versions of a cookbook to chef enterprise and an older version was pinned as the default.  I believe i needed to use the -no-freeze flag initially but didn't.  can i recover from this or will i need --force for the rest of eternity?
[2013-11-12 09:19:41 -0500] jaykatta: ERROR: Errno::EHOSTUNREACH: No route to host - connect(2) getting this error when I run knife configure --initial
[2013-11-12 09:19:46 -0500] jaykatta: can anybody help
[2013-11-12 09:19:47 -0500] Jamin: jaykatta: You're generally talking about hosts\DNS or firewall issues here.  Try connecting to it from elsewhere.
[2013-11-12 09:20:41 -0500] jaykatta: Jamin: its connecting properly from each other using fqdn
[2013-11-12 09:22:21 -0500] Jamin: telnet to whatever you are typing in as the chef server on (port 443 probably for HTTPS)
[2013-11-12 09:22:24 -0500] jhgaylor: s2r2: thanks again for your help.  i got everything sorted out.
[2013-11-12 09:22:26 -0500] Jamin: does it connect?
[2013-11-12 09:22:37 -0500] s2r2: jhgaylor: nice :)
[2013-11-12 09:26:19 -0500] jaykatta: Jamin: telnet is not connecting
[2013-11-12 09:26:41 -0500] jaykatta:  telnet chef-server.com Trying 192.168.122.109... telnet: connect to address 192.168.122.109: No route to host
[2013-11-12 09:40:55 -0500] dtrott: Is there any documentation on the names of attributes for example why is the environment = chef_environment and ip = ipaddress ?
[2013-11-12 09:46:18 -0500] mattsmith: Morning all, is it possible to install a package without it automatically starting when using apt?
[2013-11-12 09:48:40 -0500] mattsmith: i.e i'm installing Cassandra and do not want this to start after the installation
[2013-11-12 10:04:17 -0500] shakimra: I'm trying to do some testing of a cookbook reliant on databags using test-kitchen
[2013-11-12 10:04:35 -0500] shakimra: but I'm not sure if there's a nice way to set-up the chef-solo part to achieve this...
[2013-11-12 10:05:37 -0500] shakimra: does anyone know of any attempts to do this?
[2013-11-12 10:12:08 -0500] henk_: hi guys, quick question.
[2013-11-12 10:12:42 -0500] henk_: i'm trying to bootstrap an windows amazon instance. And I get the following error: ERROR: Failed to authenticate to ["10.1.3.127"] as Administrator Response: Bad HTTP response returned from server (401).
[2013-11-12 10:13:23 -0500] henk_: I guess i need to set the allowunencrypted winrm setting. but i don't know how to set it during the creation of the server
[2013-11-12 10:22:34 -0500] henk_: could someone help me with: i'm trying to bootstrap an windows amazon instance. And I get the following error: ERROR: Failed to authenticate to ["10.1.3.127"] as Administrator Response: Bad HTTP response returned from server (401). I guess i need to set the allowunencrypted winrm setting. but i don't know how to set it during the creation of the server
[2013-11-12 10:24:33 -0500] dmdeklerk: Hi. On ubuntu I have installed ruby 2.0 globally. I cant run chef-apply on that node and I believe its because it runs with the wrong ruby. Could this be correct and if so how would I fix that?
[2013-11-12 10:24:42 -0500] dmdeklerk: The error reads "Could not find chef (>= 0) amongst [bundler-1.3.5, rake-10.1.0] (Gem::LoadError)"
[2013-11-12 10:41:13 -0500] dmdeklerk: ^ chef version is 11.6.2
[2013-11-12 10:41:27 -0500] bcave: hi
[2013-11-12 10:41:35 -0500] dmdeklerk: hi
[2013-11-12 10:53:10 -0500] bcave: how are you dmdeklerk ?
[2013-11-12 10:53:56 -0500] dmdeklerk: well despite of not getting chef-apply to run, fine thanks
[2013-11-12 10:54:06 -0500] ptrf: so I'm wondering, is the client_name something you can fetch and use in a recipe
[2013-11-12 10:54:24 -0500] bcave: lol. Similar to me. Unable to get test-kitchen to converge
[2013-11-12 10:54:54 -0500] bcave: ptrf: node name or client name?
[2013-11-12 10:54:54 -0500] ptrf: client_name
[2013-11-12 10:54:55 -0500] ptrf: or run_list
[2013-11-12 10:55:00 -0500] ptrf: I would like both
[2013-11-12 10:56:50 -0500] ptrf: You can't just throw in run_context.something.something in the recipe, because it will be compiled and executed before the resources are available
[2013-11-12 10:57:01 -0500] ptrf: so it will return uninitialized data
[2013-11-12 10:57:14 -0500] workmad3: ptrf: that's what ruby_block is for
[2013-11-12 10:57:24 -0500] bcave: node.run_list.expand(node.chef_environment)
[2013-11-12 10:58:01 -0500] bcave: or just "#{node.run_list}" - that should give you access to it
[2013-11-12 10:58:17 -0500] ptrf: hmmm, okay, I just can't find that info anywhere in the docs
[2013-11-12 10:58:30 -0500] ptrf: lunch break now, but I'll try when I get back, thanks bcave and workmad3
[2013-11-12 10:58:38 -0500] workmad3: node.run_list.include?("recipe[some-recipe]")
[2013-11-12 10:58:51 -0500] workmad3: bcave: no need to turn it into a string ;)
[2013-11-12 10:59:10 -0500] bcave: ok, yes right workmad3
[2013-11-12 10:59:13 -0500] bcave: thanks
[2013-11-12 11:12:35 -0500] daxroc: Morning all
[2013-11-12 11:14:29 -0500] daxroc: When bootstrapping clients whats the correct way to set the remote validation_client_name, currently it's being set to my local client name ?
[2013-11-12 11:34:20 -0500] drrk: Cope: is the code from TDI with Chef available to download?
[2013-11-12 11:40:03 -0500] michael_mbp: hey wor
[2013-11-12 11:54:05 -0500] dmdeklerk: Is it possible to load another recipe ( include_recipe "apt" ) from inside a recipe run through chef-apply. It doesnt seem to be possible since include_recipe is in lib/dsl which is not loaded by chef-apply. Any tips on how to get this working?
[2013-11-12 11:58:17 -0500] holms: Chef::Exceptions::PrivateKeyMissing: I cannot read /etc/chef/validation.pem, which you told me to use to sign requests!
[2013-11-12 11:58:20 -0500] holms:  =/
[2013-11-12 11:58:33 -0500] holms: i haven't told anything to read from anywhere..
[2013-11-12 11:58:38 -0500] holms: what's wrong with omnibus installer
[2013-11-12 12:01:02 -0500] dmdeklerk: holms: seems like you need chef-client::config recipe
[2013-11-12 12:02:18 -0500] holms: so it's knife-solo problem then..
[2013-11-12 12:02:19 -0500] holms: probably
[2013-11-12 12:07:14 -0500] teukka: holms: do you ever sleep? you seem to be here 24/7? ;)
[2013-11-12 12:08:15 -0500] teukka: holms: if something wants to read validation.pem it normally means that chef-client wants to register the node/client to chef server. i.e. make api call
[2013-11-12 12:08:28 -0500] holms: teukka: if i want to keep this job would be nice to finish this
[2013-11-12 12:08:47 -0500] teukka: holms: where/how did you get that error
[2013-11-12 12:08:57 -0500] holms: https://github.com/matschaffer/knife-solo/issues/312
[2013-11-12 12:09:02 -0500] holms: raised a bug
[2013-11-12 12:09:09 -0500] holms: this should be a  bug, i just rolled back snapshot
[2013-11-12 12:09:24 -0500] holms: everything from scratch produces this situation
[2013-11-12 12:11:22 -0500] dmdeklerk: holms: check out chef-client::config recipe, that recipe installs validation.pem on your node. cant you add that to your runlist, iam not familiar with knife solo
[2013-11-12 12:11:55 -0500] teukka: probably chef-server cookbook triggers chef-client run. but lemme see
[2013-11-12 12:12:35 -0500] holms: chef-client config recipe..?
[2013-11-12 12:12:59 -0500] holms: i've updated the issue decription
[2013-11-12 12:13:06 -0500] holms: now you can see all i've got :)
[2013-11-12 12:16:11 -0500] teukka: holms: thanks for all the info. I still don't get it all
[2013-11-12 12:16:14 -0500] teukka: "make: *** [install_server] Error 100"
[2013-11-12 12:18:36 -0500] holms: :DD
[2013-11-12 12:18:41 -0500] teukka: I'm wondering if the chef-server installation is overriding the stacktrace from chef-solo. there is no information where the chef-solo run crashed
[2013-11-12 12:18:54 -0500] holms: k I can do this without make file
[2013-11-12 12:18:56 -0500] holms: will be the same
[2013-11-12 12:19:33 -0500] holms: k one sec will update the description again
[2013-11-12 12:20:11 -0500] teukka: holms: ah, the make is on your workstation. gotcha
[2013-11-12 12:21:08 -0500] teukka: holms: oh, is that chef-stacktrace.out from your workstation? you should get the one from the node
[2013-11-12 12:21:15 -0500] holms: yes
[2013-11-12 12:21:33 -0500] holms: one more clue:  rm -rf /etc/chef
[2013-11-12 12:21:37 -0500] holms: i for this
[2013-11-12 12:23:16 -0500] holms: no.. didn't helped
[2013-11-12 12:24:09 -0500] teukka: holms: ssh ubuntu@dell.chef 'sudo cat /var/chef/cache/chef-stacktrace.out'
[2013-11-12 12:25:04 -0500] holms: oh lol
[2013-11-12 12:25:09 -0500] holms: understood
[2013-11-12 12:25:15 -0500] holms: cookbook git is not found
[2013-11-12 12:25:17 -0500] holms: how stupid of me
[2013-11-12 12:25:46 -0500] teukka: you totally confused me. the stacktrace didn't make any sense :D
[2013-11-12 12:25:54 -0500] holms: Chef::Exceptions::CookbookNotFound: Cookbook git not found. If you're loading git from another cookbook, make sure you configure the dependency in your metadata
[2013-11-12 12:26:05 -0500] holms: strange that knife-solo didn't made berks-install
[2013-11-12 12:26:32 -0500] teukka: holms: you don't have it declared in the Berksfile
[2013-11-12 12:26:55 -0500] teukka: same for "vim" cookbook
[2013-11-12 12:27:57 -0500] teukka: it was ran: "Installing Berkshelf cookbooks to 'cookbooks'..."
[2013-11-12 12:28:11 -0500] holms: true
[2013-11-12 12:34:35 -0500] teukka: holms: the timestamps in your stacktraces don't seem to be accurate. is your computer's clock synched?
[2013-11-12 12:35:04 -0500] teukka: that might also be the reason for some validation problems
[2013-11-12 12:35:42 -0500] teukka: like if the sertificate is created in the "future", it will not be trusted in the "past"
[2013-11-12 12:42:16 -0500] ptrf: bcave: ok, so I used node.name and node.run_list, with great success. now, I'm wondering about 2 things -  1) the run_list I get is not expanded, I want to get the expanded run_list.    2) how do I get a list of attributes on the node object? I couldn't find node.name or node.run_list anywhere on docs.opscode.com
[2013-11-12 12:43:49 -0500] holms: teukka: it is..
[2013-11-12 12:45:51 -0500] teukka: holms: this from chef.dell is off by 26 hours (?): [2013-11-11T20:09:24+00:00]
[2013-11-12 12:46:27 -0500] teukka: eh, 16 hours
[2013-11-12 12:46:31 -0500] teukka: but still
[2013-11-12 12:46:48 -0500] holms: root@dell:/etc# date
[2013-11-12 12:46:49 -0500] holms: Mon Nov 11 20:32:54 GMT 2013
[2013-11-12 12:46:51 -0500] holms: US time
[2013-11-12 12:46:57 -0500] holms: i'm in IE :D
[2013-11-12 12:47:07 -0500] holms: hmz
[2013-11-12 12:47:11 -0500] teukka: that is GMT
[2013-11-12 12:47:37 -0500] holms: k updated
[2013-11-12 12:47:42 -0500] holms: thanks D
[2013-11-12 12:47:43 -0500] holms: :)
[2013-11-12 12:47:53 -0500] teukka: no prob. I hopew you can keep you job ;)
[2013-11-12 12:48:43 -0500] holms: me too, month passed, really confused with chef..but trying my best ))
[2013-11-12 12:48:44 -0500] teukka: and especially hope you don't loose it because of knife-solo =)
[2013-11-12 12:48:47 -0500] holms: :DDD
[2013-11-12 12:49:00 -0500] holms: launched chef-server.. ls /etc/chef-server/*.pem: no files
[2013-11-12 12:49:01 -0500] holms: =/
[2013-11-12 12:50:27 -0500] teukka: I hope someone can help better with chef-server. I should also try too keep my own job :/
[2013-11-12 12:50:36 -0500] holms: :D
[2013-11-12 12:55:50 -0500] holms: crap, those keys not in there =(
[2013-11-12 13:20:29 -0500] juzer: I wonder how files and folder inside cookbooks are named. What does cookbooks/nginx/attributes/default.rb signify. Why can't it be named something else
[2013-11-12 13:21:42 -0500] bcave: ptrf: you could try node.run_list.expand(node.chef_environment)
[2013-11-12 13:22:46 -0500] juzer: bcave: did u reply to my query?
[2013-11-12 13:24:26 -0500] bcave: juzer: no, ptrf's
[2013-11-12 13:25:10 -0500] bcave: juzer: the default attributes specified default values that are loaded. this should help you: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-11-12 13:25:21 -0500] bcave: any kitchen users here?
[2013-11-12 13:25:33 -0500] bcave: or specifically... kitchen-ec2?
[2013-11-12 13:29:31 -0500] holms: teukka: https://github.com/holms/chef-starter
[2013-11-12 13:29:50 -0500] holms: teukka: feel free to flood with issues
[2013-11-12 13:30:06 -0500] juzer: bcave: thanks for replying, my question is not specific to attributes. I see this pattern in almost every folder inside cookbooks. files/default/ libraries/default/ recipes/default.rb etc.
[2013-11-12 13:30:26 -0500] juzer: do they mean anything
[2013-11-12 13:33:23 -0500] ptrf: ah thanks, that' was what youwrote
[2013-11-12 13:34:14 -0500] holms: ptrf: it's for me :)?
[2013-11-12 13:36:08 -0500] ptrf: holms: no, for bcave ... bcave thanks :)
[2013-11-12 13:36:15 -0500] bcave: pleasure ptrf
[2013-11-12 13:36:32 -0500] ptrf: I really don't understand why I can't find any of those attributes
[2013-11-12 13:36:42 -0500] bcave: juzer: not for context in terms of recipes?
[2013-11-12 13:36:46 -0500] ptrf: documented that is
[2013-11-12 13:37:10 -0500] bcave: i'm not 100% sure, but I used "some_nondefault_name.rb" under attributes for recipes/some_nondefault_name.rb
[2013-11-12 13:37:29 -0500] bcave: files and attributes filenames correlate to recipes
[2013-11-12 13:39:11 -0500] juzer: bcave: ohhk, that makes sense.
[2013-11-12 13:39:27 -0500] juzer: I will checkout further.
[2013-11-12 13:40:13 -0500] bcave: this is frustrating. if I provision an (ec2) instance with a run list of a role using knife, the instance is provisioned without issue. However, when I provision the same using kitchen, the chef-solo run fails
[2013-11-12 13:40:21 -0500] bcave: any pointers on what to look out for?
[2013-11-12 13:40:47 -0500] ptrf: how does chef-solo fail?
[2013-11-12 13:41:41 -0500] bcave: when trying to install a chef_gem
[2013-11-12 13:42:01 -0500] bcave: chef_gem "fog"
[2013-11-12 13:42:33 -0500] ptrf: hmm, do you have the stack trace?
[2013-11-12 13:42:48 -0500] bcave: it can't find a C compiler (which is required to install fog). however, it works fine in a normal chef-client environment, as the recipe that installs it preps a build environment first
[2013-11-12 13:43:14 -0500] bcave: i've even updated the role to include recipe['build-essential'] first in the role
[2013-11-12 13:43:35 -0500] bcave: but when chef-solo converges the role, it tries to install the chef_gem before the gcc is installed
[2013-11-12 13:43:48 -0500] ptrf: ah
[2013-11-12 13:44:12 -0500] ptrf: I experienced something similar with ruby-build a while ago
[2013-11-12 13:44:41 -0500] ptrf: when you talk about updating your role, you mean a chef-solo role, right?
[2013-11-12 13:45:37 -0500] ptrf: (I havent used chef-solo with roles, but it seems like "everyone" is deeming role usage an anti-pattern)
[2013-11-12 13:45:55 -0500] ptrf: and you mean update the run_list of your role
[2013-11-12 13:48:39 -0500] bcave: yeah. the role's run list has something like 'recipe[build-essential]','recipe[mycookbook::somerecipe]'
[2013-11-12 13:48:52 -0500] ptrf: bcave: you cant solve the problem by using notifications or subscriptions? maybe I'm not understanding here, you want to find out why it fails rather than try to fix it, so that it works with both chef-solo and chef server
[2013-11-12 13:48:58 -0500] bcave: but it always does mycookbook::somerecipe before build-essential
[2013-11-12 13:48:59 -0500] ptrf: ?
[2013-11-12 13:49:06 -0500] bcave: that might work.
[2013-11-12 13:49:10 -0500] bcave: trying one more approach
[2013-11-12 13:49:35 -0500] ptrf: I would try to follow the application / library cookbook pattern that's been all the rage since chef summit
[2013-11-12 13:49:41 -0500] bcave: chef-solo gets run by kitchen, so I'm trying to manually duplicate the role's run list into the kitchen yaml run list
[2013-11-12 13:50:31 -0500] ptrf: if it works with chef-client and hosted chef/chef server, I would try writing a simple wrapper cookbook to replace the role, and see if that solves the problem
[2013-11-12 13:50:44 -0500] ptrf: it's a quick tias
[2013-11-12 13:54:54 -0500] cpuguy83: Sometimes I've noticed, on Windows, the chef-client service does not respond to control functions (start/stop).  I have to run it twice.
[2013-11-12 13:55:19 -0500] cpuguy83: Also assuming this is the cause of why sometimes my chef-clients are stopped because they are set to autostart
[2013-11-12 13:56:09 -0500] mtfk: is the chef/install.sh up to date, as I tried to install chef-client on arch linux but it fails. Accordgin to bug tracker this problem should be fixed.
[2013-11-12 13:56:43 -0500] aberrios:  /ignore * joins
[2013-11-12 13:56:45 -0500] aberrios: oops
[2013-11-12 14:01:37 -0500] mtfk: any hint how to install chef-client on the distro which is not supported by install.sh script ?
[2013-11-12 14:08:51 -0500] bcave: ptrf: tias'ing - but i wanted to configure the attributes, and am not familiar with using chef-solo...
[2013-11-12 14:09:16 -0500] bcave: can I just do node.set[:attribute][:attribute] in solo? I had a node.save after all of that, assuming that isn't required in solo?
[2013-11-12 14:09:52 -0500] bcave: mtfk: the install.sh should be relatively easy to adapt?
[2013-11-12 14:10:18 -0500] bcave: if it's being bootstrapped with knife, you can override the template being used to run your own script hosted somewhere
[2013-11-12 14:14:11 -0500] alex____: hi, does anyone know which is the encoding of the result returned by a chef-client command?
[2013-11-12 14:15:27 -0500] ptrf: bcave: hmm, how are you using chef-solo? you mentioned kitchen, do you spawn a vagrantbox?
[2013-11-12 14:16:08 -0500] ptrf: because I set it with chef.json in the vagrant file. i know that's hacky hacky
[2013-11-12 14:17:13 -0500] ptrf: actually! I might be lying... not intentionally, but it's been quite a while since I used chef-solo and vagrant
[2013-11-12 14:19:53 -0500] mtfk: bcave: I found another way to do it via gem install chef, I am just suprise that it is not part of the official documentation
[2013-11-12 14:24:37 -0500] mtfk: what is the best practice for sharing admin.pem and validator.pem, can it be just part of the chef-repo?
[2013-11-12 14:25:59 -0500] ptrf: mtfk: it resides in .chef, which can be part of your chef-repo
[2013-11-12 14:27:30 -0500] ptrf: iana chef expert, but I we have a ~/.chef folder at work, which is more or less shared among me and my coworkers
[2013-11-12 14:27:49 -0500] ptrf: so we have the same validator.pem, which resides outside of our chef-repo
[2013-11-12 14:28:05 -0500] mtfk: ptrf: I just read in the documentation that I have to download it and put to .chef then add .chef to .gitignore to prevent uploading that on the server
[2013-11-12 14:28:19 -0500] ptrf: nice :-)
[2013-11-12 14:28:30 -0500] mtfk: so I am a bit confuse with that
[2013-11-12 14:28:51 -0500] mtfk: because each time I will want to establish new workstation I have to get access to those files on the main server
[2013-11-12 14:28:53 -0500] ptrf: well, thing is that knife will look in ~/.chef at some point while trying to find knife.rb
[2013-11-12 14:29:07 -0500] ptrf: that's why I didn
[2013-11-12 14:29:17 -0500] ptrf: ...'t put .chef in the chef-repo
[2013-11-12 14:30:25 -0500] ptrf: we also have recipe[chef-client::delete_validation] as one of the first inclusions, in order to delete validation key after registering a client
[2013-11-12 14:30:36 -0500] mtfk: so how do you redistribute admin.pem and validator.pem ?
[2013-11-12 14:30:51 -0500] ptrf: we use pass + dropbox
[2013-11-12 14:31:04 -0500] ptrf: so outside of chef
[2013-11-12 14:31:26 -0500] mtfk: yes share keys with NSA and others :)
[2013-11-12 14:31:54 -0500] mtfk: ok so there is no any rutine for that right now in chef?
[2013-11-12 14:32:41 -0500] ptrf: mtfk: http://zx2c4.com/projects/password-store/
[2013-11-12 14:33:45 -0500] mtfk: ptrf: thanks a lot I didn't knew that project, sounds good for that what I need
[2013-11-12 14:41:32 -0500] ptrf: mtfk: it's pretty bareboned, and requires you to enforce a sane name spacing, but aside from that it's really great
[2013-11-12 14:41:55 -0500] ptrf: also, regarding NSA, I have reasonable trust in our GPG key :-)
[2013-11-12 14:46:16 -0500] ptrf: (as in, if I can't put my trust on the backing cryptographic theory or if our key was revealed to external parties during key generation, I have a whole set of other more grave problems  :-)
[2013-11-12 15:05:09 -0500] bcave: ptrf: chef-solo is run from test-kitchen + the kitchen-ec2 driver
[2013-11-12 15:05:33 -0500] bcave: i.e. provision an EC2 instance, SSH and bootstrap omnibus installer. Then apply role using chef-solo
[2013-11-12 15:07:16 -0500] bcave: mtfk: i think i've used that approach before. it might also be because im installing during the convergance stage:
[2013-11-12 15:07:50 -0500] bcave: g = chef_gem "fog" do .... action :nothing end;    g.run_action(:install)
[2013-11-12 15:07:58 -0500] bcave: so i might need to play around with that
[2013-11-12 15:09:33 -0500] henk_: guys, i'm trying to bootstrap an amazon win2k8r2 instance with the command: knife bootstrap windows winrm 10.1.3.224 -x test -P 123test -VV  but i constantly get a "ERROR: Failed to authenticate to ["10.1.3.224"] as test
[2013-11-12 15:09:40 -0500] henk_: any ideas?
[2013-11-12 15:12:52 -0500] ptrf: bcave: oh, I see
[2013-11-12 15:13:11 -0500] ptrf: haven't used ec2 instances for kitchen yet
[2013-11-12 15:13:30 -0500] ptrf: bcave: why would you use chef-solo against an ec2 instance?
[2013-11-12 15:16:48 -0500] henk_: anyone has an idea about my failed to authenticate?
[2013-11-12 15:52:08 -0500] shredder12: hi! is it possible to edit a chef client without invoking an editor; automated?
[2013-11-12 16:27:09 -0500] stormerider: looking forward to seeing folks at the summit today, just need to find the energy to get on the road
[2013-11-12 17:11:04 -0500] cannonball: I have an environments question.  The docs mention environment use applications of "live", "staging", "test", "devel", etc.  We have multiple projects which each have live, test, and devel.
[2013-11-12 17:12:19 -0500] cannonball: I figured I could make environments as follows:   proj_a_live, proj_a_test, proj_a_devel    then for the second project:   proj_b_live, proj_b_test, proj_b_devel,   ad nauseum.
[2013-11-12 17:12:35 -0500] cannonball: Does this sound horrendously bad?
[2013-11-12 17:13:25 -0500] cannonball: the live/test/devel approach seems to implicitly assume you would create a new chef server for each project because the project appears to be tied to the chef server.  Is that an accurate assessment?
[2013-11-12 17:15:40 -0500] holms: schisamo: heyja :) you've got mail
[2013-11-12 17:16:31 -0500] garrett__: cannonball: you can use environment (dev/test/prod/etc) assignments to determine runlists, attribute values, etc. so it's more a way of saying "if the box is in dev, do this; if it's in test, do this; etc
[2013-11-12 17:17:45 -0500] holms: does anybody could
[2013-11-12 17:17:52 -0500] holms: help me in here with chef-server/
[2013-11-12 17:17:59 -0500] holms: i'd even provide you a free vps on digitalocean
[2013-11-12 17:18:00 -0500] holms: ;DD
[2013-11-12 17:18:24 -0500] holms: chef-server cookbook doesn't work for me, keys not generated
[2013-11-12 17:18:35 -0500] holms: any volunteer for 15min or so?
[2013-11-12 17:18:42 -0500] holms: got makefiles, and tmux session :P
[2013-11-12 17:20:34 -0500] cannonball: garrett__: Understood.  My question is more that I'm overloading the environment to be "PROJECT_ENVIRONMENT", aiming to not have to create a new chef-server for every project that we maintain.
[2013-11-12 17:21:28 -0500] bean: cannonball: the way we do it is stage/uat/prod, and then each of the attributes for said apps is namespaced in that env under ['company_name']['app_name']
[2013-11-12 17:21:42 -0500] cannonball: I am starting to think it would be best to put the project name as a role and then check for the role in the DSL.
[2013-11-12 17:21:58 -0500] bean: thats certainly possible too
[2013-11-12 17:22:14 -0500] cannonball: so "company_name" is your "project" designation then...
[2013-11-12 17:22:57 -0500] cannonball: That's smart, I think I'll adopt that approach.  And use the role too.  Simplifies the readability of the logic IMHO.
[2013-11-12 17:23:37 -0500] cannonball: ruby supports tertiary assignments, right?
[2013-11-12 17:23:41 -0500] garrett__: cannonball: yeah, we setup a baseline common to all platforms  fail2ban, etc, and then each project, or project component, gets a specific role, pulled from project-specific cookbooks.
[2013-11-12 17:24:31 -0500] garrett__: so role[base], role[projectA-db], role[projectA-frontend], role[projectB-frontend], etc.
[2013-11-12 17:24:59 -0500] cannonball: I'm a longtime perl guy.  I think I have more problems understanding ruby than with chef in general.  But I had a coworker today just explain the difference between [:key] and ["key"].  The ruby all (slowly) starting to make sense.
[2013-11-12 17:25:05 -0500] cannonball: garrett__: Perfect, thanks.
[2013-11-12 17:26:05 -0500] garrett__: cannonball: yeah, it does ternary. foo = 1 ? 'zim' : 'zam'
[2013-11-12 17:26:42 -0500] garrett__: cannonball: i came from perl, too.
[2013-11-12 17:27:26 -0500] wdeviers: So! question, when you use an encrypted databag, how is it that bash attempts to sometimes execute the encryption key file?
[2013-11-12 17:27:53 -0500] bean: hmm, I can't say i've seen that wdeviers
[2013-11-12 17:27:56 -0500] wdeviers: Such that if you have, perhaps, "!!" in your keyfile, it tries to fire command history during bootstrp?
[2013-11-12 17:28:33 -0500] wdeviers: well then!  It looks a lot like:
[2013-11-12 17:28:46 -0500] wdeviers: 10.132.16.19 bash: line 60: warning: here-document at line 60 delimited by end-of-file (wanted `!!!!!!')
[2013-11-12 17:28:46 -0500] wdeviers: 10.132.16.19 bash: command substitution: line 60: syntax error near unexpected token `;;'
[2013-11-12 17:28:46 -0500] wdeviers: 10.132.16.19 bash: command substitution: line 60: `<<!!!!!!;;,'
[2013-11-12 17:29:35 -0500] wdeviers: I mean... is it loaded via source()ing it?
[2013-11-12 17:30:02 -0500] Edugdias: #chef
[2013-11-12 17:30:15 -0500] wdeviers: This comes up because I was trying to be funny (always a bad idea) and using ASCII art as the key on a development instance
[2013-11-12 17:30:44 -0500] bean: wdeviers: shouldn't your key, be, you know, a key?
[2013-11-12 17:30:47 -0500] holms: lol
[2013-11-12 17:30:54 -0500] garrett__: *golfclap*
[2013-11-12 17:31:04 -0500] Edugdias: I lost the clients chef-validator e chef-webui, I have recreated, but I can not reload the chef-validator key, is possible to do this?
[2013-11-12 17:31:07 -0500] wdeviers: sure, sure, it should be.  But shouldn't it also not get parsed by bash?
[2013-11-12 17:31:10 -0500] dgarstang3: *onehandedclap*
[2013-11-12 17:32:12 -0500] wdeviers: You can make it file that has a key, or a passphrase, or just a series of random letters and it's fine.  but ascii art?  That's just classy.  If it would work : (
[2013-11-12 17:33:09 -0500] Edugdias: yes I have the key, how can I do it?
[2013-11-12 17:33:27 -0500] wdeviers: oh, sorry Edugdias, I was complaining about something else : )
[2013-11-12 17:36:05 -0500] dgarstang3: Man, these random vagrant/chef "ArgumentError: You must specify at least one cookbook repo path" messages are getting old.
[2013-11-12 17:36:28 -0500] cpuguy83: dgarstang3: I doubt they are random :)
[2013-11-12 17:36:48 -0500] dgarstang3: cpuguy83: When you spin it up, get that error, destroy, respin and it goes away, I'd call it pretty random.
[2013-11-12 17:37:23 -0500] cpuguy83: dgarstang3: That's not normal
[2013-11-12 17:37:46 -0500] dgarstang3: cpuguy83: right, rather.... random I'd say
[2013-11-12 17:38:21 -0500] cpuguy83: dgarstang3: I mean if you are getting this error something is wrong that should be fixed.
[2013-11-12 17:38:26 -0500] dgarstang3: cpuguy83: then again, berkshelf seems rather random too. Sometimes my cookbooks are in ~/.berkshelf/default/cookbooks, sometimes it's ~/.berkshelf/$name...
[2013-11-12 17:38:37 -0500] dgarstang3: cpuguy83: sounds good to me
[2013-11-12 17:40:41 -0500] bean: hmm, dgarstang3. Do these cookbooks have a gem bundle for them?
[2013-11-12 17:40:45 -0500] bean: like are you using bundler?
[2013-11-12 17:40:55 -0500] dgarstang3: bean: not at all.
[2013-11-12 17:41:00 -0500] bean: hmm ok
[2013-11-12 17:41:20 -0500] bean: i've never seen that happen with berkshelf, so thats quite odd
[2013-11-12 17:41:26 -0500] bean: what berkshelf version?
[2013-11-12 17:41:35 -0500] dgarstang3: bean: part of the issue is that I need to clear stuff out between vagrant runs, and it's not clear what needs to be cleared for a start
[2013-11-12 17:46:29 -0500] bean: dgarstang3: I'd just vagrant destroy and then recreate.
[2013-11-12 17:46:31 -0500] bean: personally.
[2013-11-12 18:07:30 -0500] dgarstang3: bean: Well, that doesn't remove Berksfile.lock, for a start
[2013-11-12 18:07:41 -0500] bean: oh, you're talking about in the repo.
[2013-11-12 18:07:49 -0500] dgarstang3: bean: vagrant destroy also doesn't remove the cached cookbooks
[2013-11-12 18:07:54 -0500] bean: right
[2013-11-12 18:08:22 -0500] dgarstang3: bean: it's not a valid test of a new cookbooks ability to install from scratch if all the cookbooks are stilled cached, and at previous versions. :)
[2013-11-12 18:11:50 -0500] dgarstang3: The other annoyance is random occurrances of 'vagrant provision' brigning up the vm, and that's it. An Additional 'vagrant provision' is required to do a chef run, which this particular case has resulted in the infamous 'No error message' message.
[2013-11-12 18:12:05 -0500] CldSass: Looking for a Devops , Anybody know a good place to post Job. We are working with chef.
[2013-11-12 18:12:07 -0500] bean: hmm interesting
[2013-11-12 18:12:22 -0500] bean: CldSass: probably not this channel and not IRC :P
[2013-11-12 18:12:26 -0500] dgarstang3: bean: coworker has reported the same provision behaviour.
[2013-11-12 18:12:52 -0500] bean: hmm, I can't say I've seen it, you guys use a dev server to do this right? not individual workstations
[2013-11-12 18:13:29 -0500] CldSass: Bean: Sounds good, I thought I opscode had a community job posting, but cant find it
[2013-11-12 18:13:44 -0500] dgarstang3: bean: individual workstations... with vagrant on each
[2013-11-12 18:14:06 -0500] bean: mk, I thought, you guys were doing some sort of shared server but that must have been someone else, dgarstang3
[2013-11-12 18:14:28 -0500] dgarstang3: bean: not me. :)
[2013-11-12 18:19:32 -0500] dgarstang3: lets see if vagrant-berkshelf 1.3.3 -> 1.3.4 helps
[2013-11-12 18:24:16 -0500] freezey: seeing this when i try to do a search : https://gist.github.com/acaiafa/b52550cfb9f2d4294b8a
[2013-11-12 18:32:02 -0500] dgarstang3: argh vagrant, come on... "Net::HTTP::Persistent::Error: too many connection resets (due to SSL_read:: sslv3 alert bad record mac - OpenSSL::SSL::SSLError) after 0 requests on 70316924088820, last used 1384281101.5478468 seconds ago"
[2013-11-12 18:32:43 -0500] dgarstang3: oh, that wasn't even vagrant, That was a berks upload.
[2013-11-12 18:33:30 -0500] chris613: Does anyone know of a cookbook that helps abstract the idea of database migrations? (non-rails) I want it to wrap the database cookbook and let me supply 1) A query to get the current schema version  2) a directory full of versoined sql migration files
[2013-11-12 18:33:44 -0500] chris613: Does this exist, or do I have the opportunity to develop it myself? ;)
[2013-11-12 18:43:39 -0500] freezey_: seems that all of my data and nodes in chef have disappeared
[2013-11-12 18:45:38 -0500] martin_work: hey does anyone know if the Conference Ticket for chefconf includes any of the workshops or are they separate?
[2013-11-12 18:46:46 -0500] holms: knife environment from file /*
[2013-11-12 18:46:55 -0500] dyer: Is there a channel for the summit ?
[2013-11-12 18:46:56 -0500] holms: using wildcards possible?
[2013-11-12 18:47:50 -0500] teukka: holms: if you don't quote it that will be expanded by your shell
[2013-11-12 18:49:28 -0500] holms: teukka: http://pastie.org/8475470
[2013-11-12 18:49:46 -0500] freezey_: anyway to put all the nodes back into chef?
[2013-11-12 18:49:50 -0500] freezey_: looks like all my data went missing
[2013-11-12 18:49:54 -0500] freezey_: on knife search
[2013-11-12 18:50:04 -0500] holms: or this
[2013-11-12 18:50:05 -0500] holms: $ knife role from file *
[2013-11-12 18:50:06 -0500] holms: FATAL: File must end in .js, .json, or .rb
[2013-11-12 18:50:16 -0500] holms: i need json and rb autodetect or smtng
[2013-11-12 18:50:51 -0500] holms: freezey_: knode node from file nodes/*.json ?
[2013-11-12 18:50:54 -0500] holms: knife*
[2013-11-12 18:51:27 -0500] freezey_: have to find that file
[2013-11-12 18:51:39 -0500] freezey_: yeah
[2013-11-12 18:51:42 -0500] freezey_: all of the nodes are just missing from chef
[2013-11-12 18:51:44 -0500] freezey_: which is odd
[2013-11-12 18:51:44 -0500] holms: good luck :)
[2013-11-12 18:52:14 -0500] holms: if anybody also could tell me how to unistall chef-server completely would be nice.
[2013-11-12 18:52:29 -0500] holms: cause else, reinstall is failing, and keys are not generated
[2013-11-12 18:53:03 -0500] freezey_: well they are missing from the search
[2013-11-12 18:53:18 -0500] freezey_: not from the system itself
[2013-11-12 18:55:12 -0500] freezey_: anybody have any ideas howto get the nodes back into search?
[2013-11-12 18:55:30 -0500] holms: there should be #chef-server
[2013-11-12 18:55:31 -0500] holms: or smtng..
[2013-11-12 18:55:55 -0500] freezey_: sigh
[2013-11-12 18:55:59 -0500] holms: true =(
[2013-11-12 18:56:23 -0500] holms: to appear on a wild horse
[2013-11-12 18:57:06 -0500] freezey_: annnddd chef keeps breaking
[2013-11-12 18:57:07 -0500] freezey_: great
[2013-11-12 18:59:31 -0500] freezey_: has to be a way to import the node list
[2013-11-12 19:09:38 -0500] holms: oh nice: chef-server-ctl uninstall
[2013-11-12 19:11:12 -0500] freezey_: h
[2013-11-12 19:11:13 -0500] freezey_: hm
[2013-11-12 19:11:14 -0500] freezey_: yeah
[2013-11-12 19:11:25 -0500] freezey_: chef-server doesnt seem to be able to handle 1000 nodes
[2013-11-12 19:11:28 -0500] freezey_: or 2000 nodes
[2013-11-12 19:11:46 -0500] pravka: freezey: are you one a single chef-server node?
[2013-11-12 19:11:49 -0500] renchap: there are instances with more than 10 000 nodes
[2013-11-12 19:11:54 -0500] pravka: ^ ^
[2013-11-12 19:12:10 -0500] renchap: http://www.opscode.com/blog/2013/02/04/cycle-computing-puts-chef-11-through-its-paces-w10k-aws-servers/
[2013-11-12 19:12:36 -0500] freezey_: pravka: yeah single chef-server node
[2013-11-12 19:12:40 -0500] holms: very nice lol https://github.com/rcbops/opencenter-agent/blob/master/opencenteragent/plugins/lib/bash/chef/uninstall-chef-server.sh
[2013-11-12 19:12:47 -0500] freezey_: and it seems the nodes disappeared from search
[2013-11-12 19:12:48 -0500] freezey_: and
[2013-11-12 19:12:51 -0500] freezey_: yeah
[2013-11-12 19:12:54 -0500] freezey_: slowly waiting to come back
[2013-11-12 19:13:08 -0500] holms: freezey_: why you on single chef-server node?
[2013-11-12 19:13:15 -0500] holms: :) 1k of nodes it's not a joke
[2013-11-12 19:13:21 -0500] freezey_: yeah
[2013-11-12 19:13:21 -0500] freezey_: well
[2013-11-12 19:13:24 -0500] pravka: freezey_: sounds like an underlying issue with the chef server itself.
[2013-11-12 19:13:25 -0500] freezey_: now i have to scale it out more
[2013-11-12 19:13:36 -0500] holms: they have a docs for scale'ing
[2013-11-12 19:13:43 -0500] pravka: freezey_: chef-server-ctl + chef-server.rb makes it insanely easy now.
[2013-11-12 19:13:57 -0500] freezey_: yeah i am running chef-server 11
[2013-11-12 19:14:07 -0500] freezey_: holms: any good docs that i can be pointed to?
[2013-11-12 19:15:58 -0500] pravka: freezey_: http://docs.opscode.com/server/private_chef_1x_admin_ha.html
[2013-11-12 19:16:18 -0500] holms: don't expect answer from a biggest chef doc hater lol
[2013-11-12 19:16:20 -0500] pravka: freezey_: that's for private chef, but for the most part the architecture is the same on open source chef server.
[2013-11-12 19:16:29 -0500] pravka: holms: :)
[2013-11-12 19:16:39 -0500] holms: this page at least have pictures
[2013-11-12 19:16:41 -0500] holms: quote good
[2013-11-12 19:17:04 -0500] pravka: freezey_: honestly, I'd start w/ moving solr and couch to dedicated instances and see how that works for you.
[2013-11-12 19:17:26 -0500] holms: pravka: this one would be also nice for dummies like me http://learnchef.getharvest.com/introduction.html#mapping
[2013-11-12 19:17:49 -0500] pravka: freezey_: but without knowing *any*thing about your internal setup, it's difficult to speak authoritiatively ^_^
[2013-11-12 19:18:57 -0500] freezey_: heh
[2013-11-12 19:19:03 -0500] freezey_: yeah i mean
[2013-11-12 19:19:07 -0500] freezey_: so its roughly 2000 nodes
[2013-11-12 19:19:10 -0500] freezey_: and is growing
[2013-11-12 19:19:11 -0500] freezey_: but the single node
[2013-11-12 19:19:13 -0500] freezey_: 16gb
[2013-11-12 19:19:15 -0500] freezey_: isn;t able to handle it
[2013-11-12 19:19:19 -0500] freezey_: and it dropped all of the nodes
[2013-11-12 19:19:22 -0500] freezey_: out of solr
[2013-11-12 19:19:27 -0500] freezey_: and if you reindex
[2013-11-12 19:19:34 -0500] freezey_: you cant do a knife search
[2013-11-12 19:19:35 -0500] freezey_: on anything
[2013-11-12 19:22:37 -0500] freezey_: so that would make it tank
[2013-11-12 19:25:34 -0500] pravka: freezey_: have you added many nodes recently?
[2013-11-12 19:25:40 -0500] freezey_: yeah
[2013-11-12 19:25:43 -0500] freezey_: about 1500
[2013-11-12 19:25:45 -0500] freezey_: yesterday
[2013-11-12 19:25:46 -0500] pravka: that's what the issue is.
[2013-11-12 19:25:49 -0500] freezey_: yeah
[2013-11-12 19:25:54 -0500] freezey_: that i kinda figured :)
[2013-11-12 19:25:55 -0500] pravka: freezey_: http://stackoverflow.com/questions/12924946/how-many-nodes-can-i-manage-with-one-instance-of-chef-server
[2013-11-12 19:26:01 -0500] freezey_: just saw that link
[2013-11-12 19:26:01 -0500] freezey_: lol
[2013-11-12 19:39:55 -0500] garrett__: hrm
[2013-11-12 19:40:03 -0500] garrett__: does the chef cron provider support the @reboot facility?
[2013-11-12 19:40:39 -0500] garrett__: n/m. found my own answer.
[2013-11-12 19:48:59 -0500] holms: knife node from file nodes/* works, but from makefile it desnt ((
[2013-11-12 20:04:10 -0500] freezey_: is there a way to add all the nodes in node list back into solr?
[2013-11-12 20:04:14 -0500] freezey_: so it can search those?
[2013-11-12 20:40:24 -0500] joesph1: I don't suppose anyone has experience with mongodb(windows) and clustering with an arbiter via a chef recipe
[2013-11-12 20:41:47 -0500] cpuguy83: joesph1: I don't think anyone even should have that kind of experience :)
[2013-11-12 20:43:10 -0500] joesph1: 99% of the recipe works, but having issues assigning the arbiter
[2013-11-12 20:43:42 -0500] joesph1: works fine when i run the command via cmd.exe, but it does not seem to stick when running the command through the provider.
[2013-11-12 20:43:43 -0500] joesph1: oh well.
[2013-11-12 20:54:02 -0500] freezey_: if you do a reconfigure on chef to up the heapsize of solr
[2013-11-12 20:54:06 -0500] freezey_: will it dump all the solr data?
[2013-11-12 20:59:49 -0500] dgarstang3: Anyone, if I was gonna use this cookbook, http://community.opscode.com/cookbooks/rsyslog ... where would I set node['rsyslog']['server']?
[2013-11-12 21:00:43 -0500] jhunter: silly q, but if i'm getting 403s on a new user using knife, how do I grant that user admin rights?
[2013-11-12 21:00:46 -0500] jhunter: it seems to be a permissions problem
[2013-11-12 21:03:27 -0500] dgarstang3: Anyone, if I was gonna use this cookbook, http://community.opscode.com/cookbooks/rsyslog ... where would I set node['rsyslog']['server_ip']? What's the right way to do it?
[2013-11-12 21:06:19 -0500] dgarstang3: vagrant/berkshelf still giving me 'No error message'
[2013-11-12 21:06:40 -0500] jhunter: nm.. got it
[2013-11-12 21:09:04 -0500] Salim: I have around 150 nodes and on a few I am getting this: FATAL: Chef::Exceptions::ImmutableAttributeModification: Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"'
[2013-11-12 21:09:19 -0500] Salim: when running chef-client
[2013-11-12 21:11:22 -0500] storme_chefcon: Salim: that would seem to be a bug in a cookbook, the stacktrace should show more context
[2013-11-12 21:21:34 -0500] dgarstang3: Anyone using http://community.opscode.com/cookbooks/rsyslog ?
[2013-11-12 21:23:06 -0500] gabrtv: dgarstang3: yessir
[2013-11-12 21:23:51 -0500] gabrtv: dgarstang3: https://github.com/opdemand/deis-cookbook/blob/master/recipes/logserver.rb
[2013-11-12 21:25:16 -0500] Salim: storme_chefcon: thanks
[2013-11-12 21:26:00 -0500] joesph1: if anyone's wondering about that mongo cluster issue, it's because the cluster takes roughly 30 seconds to initialize before you can add an arbiter.  the end.
[2013-11-12 21:32:01 -0500] vt102: What's the best way to have newly spun up VMs integrate into chef?  I have been manually knife bootstrapping, but I'd like to know what more automatic mechanisms might exist.  Is orchestration accomplished by having something manually bootstrap onto new nodes?
[2013-11-12 21:37:58 -0500] joesph1: we use jenkins to provision the machines and jobs to run the bootstrap as well
[2013-11-12 21:38:16 -0500] joesph1: i think thats what you're asking for ..
[2013-11-12 21:39:34 -0500] storme_chefcon: vt102: you might want to look into vagrant or the like
[2013-11-12 21:40:58 -0500] zts: vt102: cloudinit installing Chef on first boot, or kickstart/vm-builder doing it while creating the VM
[2013-11-12 21:41:01 -0500] vt102: HmmI'm not a jenkins expert, I've only seen it used to automatically run unit tests.  and I've only seen vagrant used to spin up local VMs.  I'm talking about spinning up new web servers, etc out in a cluster/cloud and get them provisioned correctly.  Should I be researching jenkins and vagrant for that?
[2013-11-12 21:42:19 -0500] garrett__: vt102: i use knife-ec2 to provision and then bootstrap new nodes
[2013-11-12 21:42:37 -0500] vt102: zts: cloudinit looks interesting, thanks.
[2013-11-12 21:42:54 -0500] garrett__: vt102: we use jenkins for continuous integration, and i've been thinking about baking amis based on passed tests, but as-is we're just using it to validate builds
[2013-11-12 21:43:32 -0500] flagg0204: is there a way in a recipe to reference the version of the chef-client running?
[2013-11-12 21:43:42 -0500] flagg0204: e.g. if chef_version = 11 do foo else do bar
[2013-11-12 21:44:32 -0500] vt102: garrett__: I'm familiar with that.  I just wondered if there were an automatic way to do it.  (I'm no chef expert!)  People show slides of spinning up new chef servers and everything gets integrated together.  I get that, but have only seen it done manually.  If I have some sort of automated process spinning up new portions of an app stack, I'm not sure how it would be done.
[2013-11-12 21:46:05 -0500] garrett__: vt102: knife-ec2 is basically just knife with some extra code to talk to ec2. so you can say "give me this new computer, based on this image, give me these disks, assign everything to this security group; when it comes up, bootstrap it using 'role[base],role[webserver],role[projectA]'
[2013-11-12 21:46:24 -0500] garrett__: vt102: you can then have autodiscovery setup to have it automatically added to your load balancer pool, etc.
[2013-11-12 21:46:56 -0500] zts: vt102: recently (on AWS), I've also used Packer (http://packer.io/) to build AMI's with Chef and various other basic stuff preinstalled
[2013-11-12 21:48:20 -0500] garrett__: vt102: ah, yeah; our full-stack is defined in chef, so we just use the base amazon-managed images. we recently moved over from rackspace
[2013-11-12 21:48:27 -0500] zts: vt102: but it depends on your use case.  If your autoprovisioning is for things like auto-scaling groups on AWS, you want to avoid any external dependencies at boot time (like installing Chef from the internet).  If it's for CI, maybe that doesn't matter so much
[2013-11-12 21:48:29 -0500] vt102: garret__: what do you mean by auto discovery?  Is that a feature, or just the other nodes being updated by their next chef-client run?
[2013-11-12 21:48:47 -0500] garrett__: vt102: though i'll probably look at using pre-baked amis to improve spin-up time
[2013-11-12 21:49:10 -0500] vt102: zts: thanks, I will research that!  I'm not just looking at AWS, tho.  Also onsite VMware and OpenStack.
[2013-11-12 21:49:20 -0500] SFLimey: Does anyone know if I'm referencing a attribute in an older version of a chef cookbook do I need to put include_attribute statement?
[2013-11-12 21:49:54 -0500] fak3r: I've followed the opscode doc, but am failing to create a sudo user via the sudo cookbook
[2013-11-12 21:49:56 -0500] SFLimey: Its a recipes from within that version of the cookbook/
[2013-11-12 21:49:56 -0500] zts: vt102: yeah, Packer is definitely worth a look - it has multiple backends (including VMware and Openstack, neither of which I've used), and you can build images on multiple providers in parallel
[2013-11-12 21:50:04 -0500] fak3r: any thoughts on my setup/error? https://gist.github.com/philcryer/7439401
[2013-11-12 21:50:15 -0500] garrett__: vt102: autodiscovery is just a general concept. a node talks to some other node and says "here i am!" and the other node says "ok, cool, you go in this group". then other nodes can ask "who's in this group?", etc  http://www.serfdom.io/ is sort of a light-weight general usecase. though you can make it as enterprisey as you want ;)
[2013-11-12 21:50:17 -0500] vt102: zts: Great, thanks!
[2013-11-12 22:08:26 -0500] chrombar: I am looking for documentation for the node element, especially what are the supported elements and what they represent. The only page I could find was this one: http://docs.opscode.com/knife_node.html . However I couldn't not find any information about the specific elements contained in the json object. Any hints where I can find something like that?
[2013-11-12 22:11:26 -0500] sn0wb1rd: chrombar: You should probably checkout http://docs.opscode.com/ohai.html as the node elements are populated by ohai
[2013-11-12 22:13:39 -0500] chrombar: sn0wb1rd: thanks. I will have a look at that. Just one more noob question: Can I use the normal and default elements in the node file to override cookbook attributes?
[2013-11-12 22:14:05 -0500] sn0wb1rd: Use node.override if you want to override
[2013-11-12 22:17:00 -0500] chrombar: sn0wb1rd: I know about that. I am just confused by the node file and it's structure. Would that then go into the 'override' object?
[2013-11-12 22:27:13 -0500] jhammerman: Hi Chef users. Is it possible to set the 'source' value for templates to a URL?
[2013-11-12 22:31:03 -0500] dmdeklerk: jahammerman: No you can not do that. Its also goes against the principle of keeping all your infrastructure code in the same repository. Why would you want to do that?
[2013-11-12 22:36:01 -0500] robawt: dmdeklerk: a good example would be downloading the 'latest' logstash that has a universal download URL
[2013-11-12 22:36:13 -0500] zts: jhammerman: if you really need to do it, the best you can do is two resources - remote_file to download the template, then template (with the 'local' parameter set to true, and 'source' pointing to the location of the downloaded template)
[2013-11-12 22:36:27 -0500] jhammerman: dmdeklerk: Our dev team pushes via Jenkins automatically to a file system repository. They want to push a build with a templatized env.properties and have Chef render it.
[2013-11-12 22:36:29 -0500] robawt: i agree everything should be centralized, but there are edge cases in non-production environments that a URL source isn't exactly unheard of
[2013-11-12 22:36:38 -0500] wjb: I read that setting a chef-client daemon interval of 0 will disable periodic chef-client runs, however, does anyone know for sure if this is true?
[2013-11-12 22:36:47 -0500] jhammerman: zts: Good point, that would work
[2013-11-12 22:36:59 -0500] wjb: I tried it on a node, and it actually seemed to do continuous chef-client runs...
[2013-11-12 22:40:40 -0500] bugoff: 2
[2013-11-12 22:41:08 -0500] dmdeklerk: jhammerman: I agree with @zts way. I would recommend keeping the last 'good' version you downloaded so you can always go back a version in case the file got messed up on the server side.
[2013-11-12 22:42:27 -0500] jhammerman: dmdeklerk: Yes, all of the logic for this will be wrapped in a 'deploy' block that symlinks current to the latest release, and keeps five previous versions on disk
[2013-11-12 22:42:33 -0500] jhammerman: Thanks all, I appreciate it
[2013-11-12 23:14:05 -0500] holms: omfg it's finally working after 15hours of debugging https://github.com/holms/chef-starter
[2013-11-12 23:16:28 -0500] dmdeklerk: holms: i'm happy for you.
[2013-11-12 23:16:47 -0500] holms: could help for you too :P
[2013-11-12 23:17:05 -0500] holms: make install, and it will do totally everything
[2013-11-12 23:17:06 -0500] holms: :D
[2013-11-12 23:17:16 -0500] holms: and edit .makerc
[2013-11-12 23:17:19 -0500] dmdeklerk: on ubuntu 12.04?
[2013-11-12 23:17:22 -0500] holms: yeah
[2013-11-12 23:17:29 -0500] holms: tested 10 times in a row
[2013-11-12 23:17:41 -0500] holms: with digitalocean instance
[2013-11-12 23:17:51 -0500] holms: although many crap can pop-up
[2013-11-12 23:18:45 -0500] holms: only problem is how to force knife
[2013-11-12 23:18:51 -0500] holms: to "append' config not to destroy it
[2013-11-12 23:19:53 -0500] dmdeklerk: cool. will check it out another day. its 00.19 here, time to turn off my pc ;-) you should do the same
[2013-11-12 23:37:59 -0500] flagg0204: is there a way to "include_recipe <specific version of recipe>"
[2013-11-12 23:39:54 -0500] storme_chefcon: flagg0204: no, recipes arent versioned, cookbooks are
[2013-11-12 23:40:52 -0500] flagg0204: storme_chefcon: so the end result im trying for is including a recipe from a specific version of a cookbook depending on a certain attribute
[2013-11-12 23:42:36 -0500] storme_chefcon: i can't think of any way to accomplish that the way you're describing. given the Summit going on I would suggest mailing the mailing list with what you're trying and what your rationale behind it is, and maybe someone will think of a different way to accomplish what you want
[2013-11-12 23:46:51 -0500] flagg0204: cool thanks
