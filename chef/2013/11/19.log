[2013-11-19 00:00:23 -0500] dgarstang3: using include_recipe means it doesn't show up in the run list... However, putting it in the role (typically) means loss of revision control.
[2013-11-19 00:00:27 -0500] coderanger: phutchins: QED that line of code triggers immediate and near-violent distrust from my inner infosec
[2013-11-19 00:00:42 -0500] dgarstang3: it would be nice to have a clear direction on the best practice way
[2013-11-19 00:02:38 -0500] phutchins: dgarstang3: it depends on your implementation. the way I normally do it is to only have one recipe assigned to the node (maybe 2 if i have a base role assigned) then in the cookbook do include_recipe for the others that are needed. (and of course make sure to add your depends for each of those in your metadata.rb)
[2013-11-19 00:03:14 -0500] phutchins: dgarstang3: i generally dont use roles for recipes but that is more personal preference than best practice...
[2013-11-19 00:03:18 -0500] dgarstang3: phutchins: so, you don't put anything in the role except base role (we also have a location role), and that's it...
[2013-11-19 00:03:26 -0500] phutchins: dgarstang3: no roles.
[2013-11-19 00:03:32 -0500] dgarstang3: phutchins: k
[2013-11-19 00:03:49 -0500] dgarstang3: not being able to see the full run list does suck tho
[2013-11-19 00:03:51 -0500] phutchins: dgarstang3: not saying you shouldn't, but thats what I do. roles aren't versioned so it makes it harder to roll back...
[2013-11-19 00:03:55 -0500] phutchins: dgarstang3: agreed.
[2013-11-19 00:04:02 -0500] phutchins: thas why i just doit consistent in the recipe
[2013-11-19 00:04:08 -0500] dgarstang3: kk
[2013-11-19 00:04:10 -0500] dgarstang3: thanks
[2013-11-19 00:04:33 -0500] phutchins: np
[2013-11-19 00:07:29 -0500] phutchins: coderanger: fyi kickit was intended for internal workstations fyi...
[2013-11-19 00:07:45 -0500] freezey: no chef-client for ubuntu saucy?
[2013-11-19 00:07:48 -0500] phutchins: coderanger: wont be exposed to internet and would be used to kick off updates when needed...
[2013-11-19 00:09:34 -0500] phutchins: coderanger: and i agree with your points...
[2013-11-19 00:10:21 -0500] coderanger: phutchins: Meh, if you mean for local dev then it doesn't save a ton off just not using daemon mode, and if oyu mean for like internal IT enforcement then I still treat that as prod
[2013-11-19 00:11:03 -0500] phutchins: coderanger: they dont' run as daemon as we dont' want them updating when they're not supposed to
[2013-11-19 00:11:18 -0500] coderanger: Then how would this work?
[2013-11-19 00:11:21 -0500] phutchins: coderanger: not saying theres not a better solution... thats just what i've come up with at this point
[2013-11-19 00:11:29 -0500] phutchins: haven't begun using it at all actually
[2013-11-19 00:11:35 -0500] coderanger: the USR1 signal is just to kick off a run in a sleeping daemon-mode client
[2013-11-19 00:11:42 -0500] phutchins: as i like to think through things like this first of course
[2013-11-19 00:12:01 -0500] phutchins: coderanger: right, i mean it woul dbe running daemon mode but not automatically running...
[2013-11-19 00:12:17 -0500] coderanger: So you mean daemon mode but set the interval to a year or something?
[2013-11-19 00:12:34 -0500] phutchins: or never, if thats even possible... but basically, yes.
[2013-11-19 00:12:41 -0500] coderanger: I don't think there is an option for never
[2013-11-19 00:12:49 -0500] phutchins: k
[2013-11-19 00:12:55 -0500] coderanger: But yeah, internal or not its still production-y
[2013-11-19 00:13:18 -0500] coderanger: if anything internal workstations often present a bigger risk since people can do stupid things on them
[2013-11-19 00:13:31 -0500] phutchins: eh
[2013-11-19 00:13:35 -0500] phutchins: its development workstations
[2013-11-19 00:13:38 -0500] phutchins: for now it would be ok
[2013-11-19 00:13:42 -0500] jtimberman: everything is production. there's just a difference whether paying customers are affected by change/downtime.
[2013-11-19 00:13:45 -0500] phutchins: not the best permanent solution, agreed...
[2013-11-19 00:14:43 -0500] coderanger: phutchins: Right, and for a permanent solution look at mcollective, pushy, or salt (or maybe rundeck)
[2013-11-19 00:15:04 -0500] phutchins: i've looked at ironfan
[2013-11-19 00:15:08 -0500] phutchins: but not for the same thing
[2013-11-19 00:15:15 -0500] coderanger: Eh, thats super specific
[2013-11-19 00:15:18 -0500] coderanger: Its for cluster management
[2013-11-19 00:15:22 -0500] phutchins: right but for someting different
[2013-11-19 00:15:22 -0500] phutchins: right
[2013-11-19 00:15:40 -0500] phutchins: i'll have to look further into salt and pushy
[2013-11-19 00:15:51 -0500] phutchins: i looked at mcollective when i looked at iron fan but it was for the cluster management pieces
[2013-11-19 00:16:17 -0500] coderanger: At heart all three of those systems are a message bus of some kind, and a worker that accepts commands
[2013-11-19 00:16:25 -0500] coderanger: the only command you care about is chef-client
[2013-11-19 00:16:40 -0500] phutchins: for this particular purpose, yes
[2013-11-19 00:16:46 -0500] phutchins: but not for the other use case
[2013-11-19 00:16:53 -0500] coderanger: The other use case?
[2013-11-19 00:17:07 -0500] phutchins: for cluster creation
[2013-11-19 00:17:29 -0500] coderanger: I'm just talking in the context of kickit
[2013-11-19 00:17:36 -0500] phutchins: gotcha
[2013-11-19 00:18:49 -0500] phutchins: so in your opinion, what could be done to make kickit better? given we want a lightweight chef runner with no auth over http
[2013-11-19 00:30:11 -0500] coderanger: phutchins: Um, Pushy basically sounds like what you want except it uses zmq for the agent comms
[2013-11-19 00:30:37 -0500] coderanger: Its a little ruby agent that listens on a zmq socket for commands from the chef-server
[2013-11-19 00:31:19 -0500] phutchins: kk
[2013-11-19 00:31:23 -0500] coderanger: But if you really wanted to do it yourself
[2013-11-19 00:31:41 -0500] coderanger: first step would be to stop using daemon mode entirely, the tool should control the life cycle of chef-client
[2013-11-19 00:33:11 -0500] coderanger: The tricky part then is you need the tool to watch the client lockfile to ensure it runs to completion (give or take a timeout)
[2013-11-19 00:34:00 -0500] phutchins: sounds like a good idea. id planned on not runnung as a deamon when used with this tool...
[2013-11-19 00:45:05 -0500] pabst^: if test-kitchen complains of a missing gem for an integration test (ruby-shadow) where would I add that gem? I tried adding it to the cookbooks Gemspec file, that didn't work
[2013-11-19 00:47:44 -0500] idlemichael: i'm using vagrant, provisioning with chef_solo, but somehow chef 10.12 gets installed, and runs as chef-client, tries to ping the chef-server, etc and locks up the chef process id file so chef-solo can't run. any ideas?
[2013-11-19 00:49:57 -0500] rbwsam: knife search help please: I'm doing a search by environment and role and getting a result that does not have the required role
[2013-11-19 00:50:14 -0500] rbwsam: knife search node "chef_environment:production AND role:redis"
[2013-11-19 00:51:02 -0500] coderanger: idlemichael: What basebox are you using?
[2013-11-19 00:51:22 -0500] coderanger: rbwsam: Sounds correct
[2013-11-19 00:51:51 -0500] idlemichael: coderanger: raring64 from http://cloud-images.ubuntu.com/vagrant/raring/current/raring-server-cloudimg-amd64-vagrant-disk1.box
[2013-11-19 00:52:03 -0500] rbwsam: coderanger: odd, one of the results shows these roles:  monitored, web, soa, base
[2013-11-19 00:52:06 -0500] coderanger: Okay, and how you are installing chef on it?
[2013-11-19 00:52:11 -0500] rbwsam: coderanger: no redis in that list
[2013-11-19 00:52:42 -0500] idlemichael: coderanger: i've run vagrant up --no-provision and chef 10.12.0 gets installed regardless
[2013-11-19 00:52:42 -0500] coderanger: rbwsam: Try roles:redis
[2013-11-19 00:52:49 -0500] coderanger: which is almost certainly what you want anyway
[2013-11-19 00:53:31 -0500] coderanger: idlemichael: Whats installing it?
[2013-11-19 00:53:40 -0500] coderanger: idlemichael: Are you sure its not just in the image?
[2013-11-19 00:54:00 -0500] coderanger: idlemichael: http://blog.utlemming.org/2013/01/vagrant-cloud-images.html
[2013-11-19 00:54:04 -0500] coderanger: idlemichael: Looks like they do
[2013-11-19 00:54:04 -0500] rbwsam: coderanger: that fixed it, what is the difference between roles and role?
[2013-11-19 00:54:09 -0500] idlemichael: ah thanks coderanger
[2013-11-19 00:55:07 -0500] coderanger: rbwsam: role: is based on static node expansion, roles: is expanded recursively and should only be updated after a successful run since it is driven from the client
[2013-11-19 00:55:34 -0500] rbwsam: coderanger: Interesting, thanks for the quick help!
[2013-11-19 00:55:55 -0500] coderanger: idlemichael: The opscode bento images are what I use for blanks
[2013-11-19 00:56:24 -0500] idlemichael: coderanger: i was looking for something with ruby 1.9 by default
[2013-11-19 00:56:54 -0500] coderanger: idlemichael: Not sure what you mean, chef ships its own ruby
[2013-11-19 00:56:56 -0500] idlemichael: coderanger: ahhh these seem neat, thanks!
[2013-11-19 01:01:38 -0500] zenloop: can I send variables to a resource with notifies?
[2013-11-19 01:02:01 -0500] coderanger: zenloop: No
[2013-11-19 01:02:30 -0500] coderanger: zenloop: Resources are supposed to be independent since they model a single object
[2013-11-19 01:20:39 -0500] garrett__: anyone using duplicity?
[2013-11-19 01:21:42 -0500] garrett__: i see a few half-baked cookbooks out there, so i'm wondering what other people might be using
[2013-11-19 02:10:26 -0500] jameson-pmac: coderanger: is there a chance you will upload those slides from the community summit somewhere?
[2013-11-19 02:10:34 -0500] jameson-pmac: about poise
[2013-11-19 02:10:39 -0500] coderanger: jameson-pmac: Up on slideshare already
[2013-11-19 02:10:55 -0500] coderanger: jameson-pmac: http://www.slideshare.net/coderanger
[2013-11-19 02:11:06 -0500] jameson-pmac: awesome, thank you
[2013-11-19 03:02:33 -0500] coderanger: kallen: Yo, easier to debug on here if you want
[2013-11-19 03:38:27 -0500] context: is there a way to run 'chef-client' on a node from the workstation knife command ?
[2013-11-19 03:47:11 -0500] coderanger: context: knife ssh?
[2013-11-19 04:10:57 -0500] savant: Hi all
[2013-11-19 04:11:05 -0500] coderanger: Alo
[2013-11-19 04:11:14 -0500] savant: Is there a way to alias a recipe as another recipe?
[2013-11-19 04:11:26 -0500] savant: I have my own php cookbook
[2013-11-19 04:11:36 -0500] savant: and the newrelic cookbook wants to install the opscode one
[2013-11-19 04:11:58 -0500] savant: which also ends up installing/upgrading things that break my setup
[2013-11-19 04:12:25 -0500] savant: so I'd rather not do that. especially because the newrelic one only includes "php::default", which just installs php.
[2013-11-19 04:12:36 -0500] coderanger: No
[2013-11-19 04:12:39 -0500] savant: I want to alias it as "seatgeek-php::default"
[2013-11-19 04:12:45 -0500] coderanger: And yes, this sucks
[2013-11-19 04:12:57 -0500] coderanger: :-(
[2013-11-19 04:12:59 -0500] savant: can I monkey-patch RunContext?
[2013-11-19 04:13:11 -0500] savant: like
[2013-11-19 04:13:24 -0500] coderanger: Technically yes but I'm not telling you how because I can't predict how much that would break the universe :P
[2013-11-19 04:13:29 -0500] savant: if I include a recipe, something like "seatgeek::chef-overrides"
[2013-11-19 04:13:34 -0500] savant: at the top
[2013-11-19 04:13:55 -0500] savant: it would include that recipe, which would have it's own lib that monkey-patches include_recipe
[2013-11-19 04:14:02 -0500] savant: https://github.com/opscode/chef/blob/master/lib/chef/run_context.rb#L129
[2013-11-19 04:14:58 -0500] savant: so the inclusion of the recipe would update the RunContext object to add a  "provides_recipe" method
[2013-11-19 04:15:24 -0500] savant: does that make sense?
[2013-11-19 04:15:27 -0500] coderanger: You would need to hack the loading system
[2013-11-19 04:15:30 -0500] flaccid__: savant: what exactly do you need to override?
[2013-11-19 04:15:46 -0500] savant: flaccid__: I do not want to load the php::default cookbook
[2013-11-19 04:15:47 -0500] coderanger: Doable, but if you want to see the kind of crazy involve go read chef-funnel
[2013-11-19 04:16:14 -0500] flaccid__: savant: provide a php cookbook that does nothing haha
[2013-11-19 04:16:30 -0500] savant: seems lame.
[2013-11-19 04:16:48 -0500] savant: not very elegant
[2013-11-19 04:16:53 -0500] savant: let me see
[2013-11-19 04:17:12 -0500] flaccid__: there isn't anything not lame or not elegant for what you wan to do.
[2013-11-19 04:17:35 -0500] flaccid__: of course you could just fork the new relic cookbook and comment out the recipe include.
[2013-11-19 04:17:41 -0500] savant: if a library exists, how does chef know how to include it?
[2013-11-19 04:17:59 -0500] savant: to be honest i'd love to use the opscode stuff
[2013-11-19 04:18:20 -0500] savant: but the release cycles are a bit slow (i totally understand why)
[2013-11-19 04:18:29 -0500] savant: so replacing my custom ones would be a pita.
[2013-11-19 04:18:43 -0500] flaccid__: do you mean depend or include_recipe
[2013-11-19 04:19:08 -0500] savant: https://github.com/escapestudios/chef-newrelic/blob/master/recipes/php-agent.rb#L8
[2013-11-19 04:19:44 -0500] flaccid__: yes that includes the recipe
[2013-11-19 04:19:50 -0500] savant: new-relic::php-agent calls include_recipe "php"
[2013-11-19 04:19:56 -0500] savant: so what I'd do (ideally)
[2013-11-19 04:20:18 -0500] flaccid__: http://docs.opscode.com/essentials_cookbook_recipes.html#include-recipes
[2013-11-19 04:28:45 -0500] savant: https://gist.github.com/josegonzalez/75bbb8efd4fad0273c8c
[2013-11-19 04:28:47 -0500] savant: something like that
[2013-11-19 04:29:29 -0500] savant: is what I'd want to do
[2013-11-19 04:29:42 -0500] savant: not necessarily exactly that, but close.
[2013-11-19 04:30:56 -0500] savant: flaccid__: ^
[2013-11-19 04:32:34 -0500] flaccid__: i wonder what you are trying to achieve
[2013-11-19 04:33:00 -0500] savant: i already have a recipe that provides the installation of php
[2013-11-19 04:33:16 -0500] savant: i shouldnt need to use a different one, especially when they are functionally equivalent in my case.
[2013-11-19 04:33:34 -0500] flaccid__: so you just use that cookbook.
[2013-11-19 04:33:49 -0500] savant: i want to *also* use a community cookbook
[2013-11-19 04:33:53 -0500] flaccid__: if you have to name it differently, fork the new relic cookbook and change the include_recipe and depends.
[2013-11-19 04:34:43 -0500] savant: so I'm guessing what I want is both: 1) unsupported 2) not recommended
[2013-11-19 04:35:10 -0500] flaccid__: for 1) you would need to ask opscode support if you pay for that i guess
[2013-11-19 04:35:27 -0500] flaccid__: for 2), i'm not sure you'll find someone that recommends it
[2013-11-19 04:35:50 -0500] savant: i meant by the chef-peeps
[2013-11-19 04:35:57 -0500] savant: (to whom I am eternally grateful)
[2013-11-19 04:36:05 -0500] savant: *may they live forever*
[2013-11-19 04:36:31 -0500] flaccid__: hold a poll
[2013-11-19 04:36:42 -0500] savant: heh
[2013-11-19 04:37:01 -0500] savant: i'll just ask anyone with mod
[2013-11-19 04:37:04 -0500] savant: :P
[2013-11-19 04:37:31 -0500] flaccid__: have fun
[2013-11-19 05:50:30 -0500] bobthemagicman: Hey there folks, I am hoping someone has some experience with using "knife rackspace" plugin to create servers. I am getting an error after server creation when it tries to install the chef-client. The error is as follows: "dpkg: error: dpkg status database is locked by another process"
[2013-11-19 05:51:13 -0500] bobthemagicman: it seems an other process is still using dpkg when the chef script/knife tries to install the chef-client
[2013-11-19 06:56:28 -0500] segv: hey quick q
[2013-11-19 06:56:38 -0500] segv: the chef DSl, is there a way to have dynamic variables within a role?
[2013-11-19 07:21:38 -0500] coderanger: segv: No
[2013-11-19 07:21:44 -0500] segv: figured so
[2013-11-19 07:21:48 -0500] coderanger: Roles are converted to JSON before upload
[2013-11-19 07:21:54 -0500] coderanger: the .rb DSL in there is just for convenience
[2013-11-19 07:21:57 -0500] segv: ah, yeah, just read that
[2013-11-19 07:23:16 -0500] coderanger: What are you trying to do?
[2013-11-19 07:23:40 -0500] segv: I had an idea and then realized it was stupid, path to a URL (within my role) filled out later by the environment etc.
[2013-11-19 07:23:47 -0500] segv: but realized I can just do that in the recipe
[2013-11-19 07:24:46 -0500] coderanger: Yep, thats usually the answer :)
[2013-11-19 08:23:20 -0500] bilalcochin: Got the following error when using chef-solo http://pastebin.com/jCT7QmeR
[2013-11-19 08:29:04 -0500] henk_: morning guys, quick question. is it possible to change the windows administrator password from a recipe in chef? I've got amazon instances with generated passwords, and I want to change them
[2013-11-19 09:04:28 -0500] BryanWB: ohai chefs! anyone know if test-kitchen supports windows yet?
[2013-11-19 09:04:44 -0500] Breaking_Pitt: Hi guys... Someone knows how can I test that a service is running?
[2013-11-19 09:08:55 -0500] unflores: er...ps ax | grep service name?
[2013-11-19 09:23:52 -0500] chaos: i've subscribes and notifies assigned to same resource, if first fails (susbcribes), will second (notifies) run?
[2013-11-19 09:23:57 -0500] chaos: like here http://wklej.org/id/1182047/
[2013-11-19 09:42:02 -0500] henk_: is it possible to change the windows administrator password from a recipe in chef? I've got amazon instances with generated passwords, and I want to change them
[2013-11-19 09:45:20 -0500] JeanMertz: How can I access the cookbook metadata programatically during a chef-run? I tried searching for any methods, but I can only find them defined on the Resource and Provision instances, nothing through the Node object.
[2013-11-19 09:46:59 -0500] JeanMertz: Well, accessing through the node object makes not sense, my bad.
[2013-11-19 09:49:12 -0500] JeanMertz: I did try to use "run_context.cookbook_collection[cookbook_name].metadata", but cookbook_name is undefined in a reipce Chef 11.6 (I can only find it on the Provider class)
[2013-11-19 09:59:10 -0500] zts: JeanMertz: cookbook_name should work in a recipe, and it is an accessor on the recipe class
[2013-11-19 09:59:20 -0500] zts: JeanMertz: perhaps you can pastebin what you've tried, and what error you got?
[2013-11-19 10:11:07 -0500] Breaking_Pitt: unflores I've forgot to say with chef!!! :D
[2013-11-19 10:11:58 -0500] unflores: if it's going to determine whether or not you will execute something then it is used with a not_if call
[2013-11-19 10:12:39 -0500] unflores: http://pastie.org/8492178
[2013-11-19 10:13:52 -0500] unflores: that's clearly not the same functionality, but I often use the shell to check things that I need to know in a recipe
[2013-11-19 10:14:06 -0500] unflores: Not sure if it is the proper way but it is a way
[2013-11-19 10:14:40 -0500] Breaking_Pitt: let me see
[2013-11-19 10:17:58 -0500] JeanMertz: zts: I see, problem is, I'm not in the recipe, but in a library helper. How can I access the recipe instance? (like I can access "node" in a recipe)
[2013-11-19 10:20:05 -0500] JeanMertz: zts: Hmm, I'm sending the node method to my helper method right now, I could just send "self", and use everything available in the recipe instance...
[2013-11-19 10:28:32 -0500] spheromak: JeanMertz: you can pass node instance to any library method
[2013-11-19 10:28:54 -0500] spheromak: ruby defaults to pass by refrence, that node instance is mutable by your library.
[2013-11-19 10:30:20 -0500] JeanMertz: spheromak: Thanks, I was already doing that, I just wanted to access more than the node, but I figured it out by passing `self` to my Service::Recipe class in a recipe, and `self` to Service::Attribute class in an attribute file. And from there I can then access node/cookbook_name etc, depending on the type of self. Right?
[2013-11-19 10:30:50 -0500] spheromak: well
[2013-11-19 10:31:26 -0500] spheromak: what are you trying to get at ?
[2013-11-19 10:32:02 -0500] spheromak: JeanMertz: when you say more than node
[2013-11-19 10:33:00 -0500] spheromak: the 2 things you need basically anywhere in chef are run_context and node (which is actually part of run_context).
[2013-11-19 10:33:36 -0500] spheromak: if you are trying to get at resources they are in the resource_collection as well. so really if you want to do some fu where you access chef from outside -> in. you need to pass your run_context to the outside class/method.
[2013-11-19 10:33:39 -0500] JeanMertz: Well, before I had a Service class, which I initialized with new(node), but I also want to access cookbook_name (and possibly other variables Chef provides). So instead I did Service.new(self) in a recipe, which gave me access to cookbook_name. But then I noticed that self isn't the same in an attribute file and a recipe, so now I use Service::Recipe for my recipe helpers, and Service::Attribute for attribute helpers
[2013-11-19 10:33:57 -0500] JeanMertz: ah nice
[2013-11-19 10:34:11 -0500] spheromak: Service is your external class name ?
[2013-11-19 10:34:17 -0500] spheromak: would be carefull with that naming ;)
[2013-11-19 10:34:29 -0500] spheromak: make sure you wrap youre namespaces apropriately.
[2013-11-19 10:34:32 -0500] JeanMertz: but, I can expect different behaviour of run_context in different context then, right? So that would require more guards
[2013-11-19 10:34:39 -0500] spheromak: nope
[2013-11-19 10:34:48 -0500] JeanMertz: spheromak: yeah, it's namespaced to my company name
[2013-11-19 10:34:50 -0500] spheromak: everything is stepping in and around run_context
[2013-11-19 10:35:08 -0500] spheromak: https://github.com/opscode/chef/blob/master/lib/chef/run_context.rb
[2013-11-19 10:35:13 -0500] spheromak: Big discaimer here.
[2013-11-19 10:35:38 -0500] spheromak: generally not advised to root around in run_context, but it may help you to undertstand how chef is put together to read through that.
[2013-11-19 10:35:59 -0500] JeanMertz: spheromak: right, but f.e. "cookbook_name", it's initialized in the recipe.rb of Chef, so run_context in an attribute would not have that variable, correct?
[2013-11-19 10:36:41 -0500] JeanMertz: *run context in an attibute *.rb file
[2013-11-19 10:37:23 -0500] spheromak: it should be accessible through context. that is basically everything that is the chef run.
[2013-11-19 10:37:56 -0500] spheromak: so yer trying to get at cook_name duriing compile time and parsing of attributes ?
[2013-11-19 10:41:25 -0500] JeanMertz: I am just wrapping my head around this and building some sane helpers. Right now I was trying to shorten this: node[:company][:chef][:server][:my][:attribute] to this -> service = Service.new(self/node/run_context), and then be able to do service[:my][:attribute], where the helper fills in the rest based on 1) company name 2) cookbook_name (in this case, poorly named "chef"), 3) attribute file name (in this case "server").
[2013-11-19 10:41:50 -0500] JeanMertz: Not something that I really really need, but I was just messing around and using this as a good test case
[2013-11-19 10:43:40 -0500] JeanMertz: And to keep it modular, I wanted to place it in a library cookbook to be able to use it for all other application cookbooks
[2013-11-19 10:43:48 -0500] spheromak: yea not really certain of what you will get calling this stuff in attribute space. that code will be evaluated at compile time. there should be some instance var floating around that should be @cookbook_name.
[2013-11-19 10:44:22 -0500] spheromak: Generally what I do with this sort of stuff is singleton class that has an attr_accessor for :node.  so you can just give it node, and have att atributes or w/e else you need
[2013-11-19 10:46:49 -0500] JeanMertz: Right, thank you for that. I'm going to mess around with run_context
[2013-11-19 10:47:46 -0500] spheromak: so yer saying ina attribs you are passing self back and getting yer current Chef::Recipe instance or Chef::Attribute instance.
[2013-11-19 10:48:01 -0500] spheromak: then mutating stuff there
[2013-11-19 10:48:49 -0500] spheromak: some stuff i've done round this is a full connector/abstraction for services in etcd.
[2013-11-19 10:48:58 -0500] JeanMertz: Right, I'm simply doing service = Service::Attribute.new(self) in an attribute file, and doing some stuff there, which I can then access through `service` in the attribute file.
[2013-11-19 10:49:27 -0500] spheromak: yea
[2013-11-19 10:49:30 -0500] spheromak: makes sense
[2013-11-19 10:49:40 -0500] spheromak: same basic idea jsut diff scoping
[2013-11-19 10:49:57 -0500] spheromak: and your service class has to be aware of what it's being handed
[2013-11-19 10:50:08 -0500] spheromak: not a huge deal either
[2013-11-19 10:50:09 -0500] JeanMertz: and then f.e. I have a Service::Node instance which adds some methods and has a method_missing to delegate to the Chef node instance.
[2013-11-19 10:50:44 -0500] JeanMertz: spheromak: That's what I was messing around with now, either do a Service::Recipe and Service::Attribute class, or have a general Service class and add some guards for the context it's in
[2013-11-19 10:51:00 -0500] spheromak: ah you could just mix into Chef::Recipe if you want to add some methods (tho im quite against the abuse of mixing into Chef::Recipe)
[2013-11-19 10:51:02 -0500] JeanMertz: but I'm not too sure how different both contexts are, if it is worth subclassing
[2013-11-19 10:51:18 -0500] spheromak: https://github.com/spheromak/services-cookbook/blob/master/libraries/connection.rb
[2013-11-19 10:51:46 -0500] spheromak: this uses etcd as a backend for ednpoint/member registraion. I need to cut it over to a gem. and out of a library, but it's doing stuff
[2013-11-19 10:52:30 -0500] spheromak: https://github.com/spheromak/services-cookbook/blob/master/libraries/connection.rb
[2013-11-19 10:52:37 -0500] spheromak: example lib that does attribute population
[2013-11-19 10:52:56 -0500] spheromak: using node.set vs trying to be in context. Again most of this stuff is compile time vs runtime
[2013-11-19 10:53:47 -0500] ptrf: so, I'm trying to setup berkshelf in my chef-repo, to do more sane chef-repo management
[2013-11-19 10:53:57 -0500] ptrf: I'm also using hosted chef at opscode
[2013-11-19 10:54:08 -0500] JeanMertz: spheromak: where exactly are you doing context checks in there?
[2013-11-19 10:54:18 -0500] spheromak: no where
[2013-11-19 10:54:22 -0500] ptrf: So, I'm wondering, because I have an application cookbook, where should I put this?
[2013-11-19 10:54:22 -0500] spheromak: cause im passed node
[2013-11-19 10:54:49 -0500] ptrf: I'm thinking of putting it in $(chef-repo)/cookbooks/..., but then, won't it be managed by the chef-repo git repo
[2013-11-19 10:55:29 -0500] JeanMertz: spheromak: right, I saw you're passing in run_context, but then you're only operating on run_context.node
[2013-11-19 10:55:30 -0500] ptrf: if I'm using berkshelf, wouldn't it then make sense to gitignore cookbooks/, and then setup a local git repo for my application cookbook in cookbooks/
[2013-11-19 10:55:33 -0500] spheromak: ptrf: im a fan of repo-per-cookbook model myself
[2013-11-19 10:55:53 -0500] ptrf: I want to be able to do both knife upload .
[2013-11-19 10:55:54 -0500] spheromak: JeanMertz: which is the instance that your chef run executes in
[2013-11-19 10:55:59 -0500] ptrf: and git commit blabla
[2013-11-19 10:56:13 -0500] ptrf: but I dont want to mix up my cookbook developing and my chef-repo management
[2013-11-19 10:56:41 -0500] ptrf: I've seen somewhere the use of git submodules, but that doesnt look so nice
[2013-11-19 10:56:42 -0500] JeanMertz: spheromak: yeah, I get that now. Only thing I'm still figuring out is how to best handle the differences of that context in a recipe vs in an attribute file (and thus also compile-time vs runtime)
[2013-11-19 10:56:58 -0500] spheromak: JeanMertz: what i was trying to say early on. you don't have to pass your self around you can pass node or run_context and reach in.
[2013-11-19 10:57:01 -0500] ptrf: spheromak: how does my proposed setup sound  then? is it viable? :)
[2013-11-19 10:58:31 -0500] spheromak: attribute parsing is strictly compile time. so this stuff generally works how I want it. unless you're trying to overwrite some other cooks stuff. but even then you could force the run to load attribs before you mutate them with cookbook loader.. ahhhh so much terible stuff you can do once you start diging through this stuff ;)
[2013-11-19 10:59:29 -0500] spheromak: ptrf: thats why you pull cooks out of your repo and into their own.
[2013-11-19 10:59:49 -0500] spheromak: ptrf: if you start using berks/librarian. cook managment is removed from your chef_repo
[2013-11-19 10:59:55 -0500] JeanMertz: spheromak: thanks for that, run_context it is :)
[2013-11-19 11:00:10 -0500] spheromak: JeanMertz: its fun stuff to expore. chef-shell is your friend.
[2013-11-19 11:00:15 -0500] spheromak: chef-shell -z
[2013-11-19 11:00:33 -0500] spheromak: and reading through how chef actually builds up the run is valuable
[2013-11-19 11:00:54 -0500] ptrf: spheromak: hmm, I guess I'll have to work through it, the TIAS way, that's probably the issues way to find my misconceptions. thanks though
[2013-11-19 11:01:05 -0500] JeanMertz: spheromak: I have the shef page open somewhere, but haven't figured out how to best use it yet :) Basically I'm just doing vagrant provision runs right now and output some stuff I want to investigate using Chef::Log (terrible, I know)
[2013-11-19 11:01:07 -0500] spheromak: TIAS ?
[2013-11-19 11:01:29 -0500] ptrf: try it and see :)
[2013-11-19 11:01:34 -0500] spheromak: JeanMertz: yea just go into a provisioned node and run chef-shell -z -c config.rb -j foo
[2013-11-19 11:01:35 -0500] ptrf: lunch
[2013-11-19 11:01:52 -0500] spheromak: JeanMertz: if yer using vagrant to do it it should be /tmp/vagrant-blah...
[2013-11-19 11:02:09 -0500] spheromak: sets upt he node run. then you can step into the run recipe
[2013-11-19 11:02:17 -0500] spheromak: and explore run_context from the repl
[2013-11-19 11:02:34 -0500] spheromak: ptrf: rgr that
[2013-11-19 11:03:53 -0500] JeanMertz: Thanks spheromak, need to investigate some more:
[2013-11-19 11:04:32 -0500] JeanMertz: $ /tmp/vagrant-chef-1# chef-shell -s -c solo.rb -k dna.json
[2013-11-19 11:04:37 -0500] JeanMertz: $ /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/mixlib-cli-1.3.0/lib/mixlib/cli.rb:226:in `parse_options': invalid option: -k (OptionParser::InvalidOption)
[2013-11-19 11:05:20 -0500] JeanMertz: ah typo
[2013-11-19 11:05:32 -0500] JeanMertz: nice, works perfectly
[2013-11-19 12:06:26 -0500] zeroXten: hmm, the guy before me set our chef clients to have an interval of 120 and a splay of 300 rather than the traditional 30 min interval. Any thoughts about how good/bad this approach is?
[2013-11-19 12:22:37 -0500] spheromak: zeroXten: depends on chef server version, and your specific hardware, and node counts. As well as what you do in your recipes.
[2013-11-19 12:22:42 -0500] spheromak: number of sliders there.
[2013-11-19 12:25:06 -0500] zeroXten: fair enough
[2013-11-19 12:25:41 -0500] zts: What's the expected behaviour when splay is greater than interval?
[2013-11-19 12:25:59 -0500] spheromak: generally chef-server 11 can run tight intervals much better than chef10
[2013-11-19 12:26:18 -0500] spheromak: zts: i was wondering that as well.
[2013-11-19 12:27:43 -0500] gavala: Is there a way to make a chef run fail if a condition is met in a recipe?
[2013-11-19 12:28:18 -0500] zts: gavala: http://stackoverflow.com/questions/14290397/how-do-you-abort-end-a-chef-run
[2013-11-19 12:28:40 -0500] chaos: gavala, Chef::Log.fatal afair
[2013-11-19 12:29:13 -0500] gavala: brillant thanks, didn't manage to find that one with google!
[2013-11-19 12:29:14 -0500] chaos: hmm Application.fatal! is even better ;-)
[2013-11-19 12:29:52 -0500] zts: gavala: yeah, it helps that I already knew that one exists :)  It's a really comprehensive answer from jtimberman
[2013-11-19 12:32:57 -0500] gavala: aaand that works like a charm, thanks guys
[2013-11-19 12:38:53 -0500] visof: hi
[2013-11-19 12:39:19 -0500] visof: how can i pass multiple dependes in metadata file, depends 'foo','bar' or what?
[2013-11-19 12:39:36 -0500] gavala: depends 'foo'
[2013-11-19 12:39:38 -0500] gavala: depends 'bar'
[2013-11-19 12:39:46 -0500] visof: bad
[2013-11-19 12:39:54 -0500] visof: it should pass as list
[2013-11-19 12:45:15 -0500] zeroXten: I've noticed that complaints about using roles seems to boil down to (a) they're not versioned (b) using run_list doesn't take into account the environment. For example http://dougireton.com/blog/2013/02/16/chef-cookbook-anti-patterns/ it says "that change affects all servers in the role, including Prod" ... isn't that exaclty why roles have an env_run_list? I still don't get what the big deal is with using roles.
[2013-11-19 12:56:14 -0500] zts: zeroXten: you can deal with the latter issue with env_run_list, but then you have to promote a change to a new environment you have more places to update (and more opportunities to screw it up).  There's also no env_run_lists analogue for role attributes
[2013-11-19 12:56:22 -0500] BryanWB: anyone know if it's possible to use windows w/ test-kitchen yet?
[2013-11-19 13:00:53 -0500] zts: zeroXten: in my opinion, roles are broken, and "role cookbooks" suck for other reasons.  My advice is to be aware of the limitations, but use whatever you prefer
[2013-11-19 13:04:27 -0500] zeroXten: yeah, i've been stung by not having role env attributes
[2013-11-19 13:05:27 -0500] zeroXten: zts: why do you think "role cookbooks" suck?
[2013-11-19 13:07:03 -0500] zts: my biggest complaint is that they subvert the expanded run list (if you rely on include_recipe, you can't trust node.recipes and node.roles, so you have to write your own hack elsewhere to record what recipes you've used)
[2013-11-19 13:07:33 -0500] zts: Though I should probably check whether that's been fixed at some point, I guess there's no reason why it couldn't
[2013-11-19 13:07:53 -0500] gkarekinian: I had a case where I couldn't override an attribute in a policy/wrapper cookbook so I had to use a role anyway (because of a dynamic attribute depending on another one)
[2013-11-19 13:09:39 -0500] zts: Also, I'm just generally irritable.  I think that the concept of roles has a place in the chef model, and (effectively) ditching them - because you can bodge something similar with cookbooks - is a lousy idea
[2013-11-19 13:10:15 -0500] zts: I'd much rather see the deficiencies of roles addressed.  I think there was muttering that they might end up versioned in a future Chef major release, but I'm not up to date on that discussion
[2013-11-19 13:11:03 -0500] zeroXten: the roles are just ruby, so you can wrap your attributes in a if node.chef_environment ... right?
[2013-11-19 13:11:32 -0500] zts: no, roles are json.  There's a ruby DSL, but that turns into JSON before they're used
[2013-11-19 13:11:39 -0500] zts: so they never see a node object
[2013-11-19 13:11:42 -0500] zeroXten: ahh yeah, thats right :(
[2013-11-19 13:11:49 -0500] gkarekinian: If you need to override an attribute for an environment, use an environment
[2013-11-19 13:12:02 -0500] zeroXten: yeah yeah.. I think I did the if statement in an attributes file in a cookbook
[2013-11-19 13:13:26 -0500] zeroXten: generally, the only problem I had with roles is the approach of having a "base" role used by everything, then promoting something to production within the role. If a subset of servers don't like the change it can be annoying ;)
[2013-11-19 13:13:54 -0500] zeroXten: i might stop using a base etc approach
[2013-11-19 13:22:04 -0500] ptrf: hhmmm, why do I get an cookbook 'acme' not found in any of the default locations, when I add cookbook 'acme', git: 'git@github.com:AcmeCorp/acme.git' to my berksfile and run berks?
[2013-11-19 13:23:20 -0500] ptrf: hmm, used the almgithy http://community.opscode.com/chat/chef/2013-08-09
[2013-11-19 13:37:49 -0500] ptrf: still getting the error though
[2013-11-19 14:03:47 -0500] zeroXten: is there anything I should be aware of before starting to use berkshelf instead of the "legacy" approach?
[2013-11-19 14:06:12 -0500] zeroXten: ah, thanks jtimberman for http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/ :)
[2013-11-19 14:16:26 -0500] Breaking_Pitt: guys teoric question... Is possible (and recommendable) make a dist-upgrade from a chef recipe?
[2013-11-19 14:16:52 -0500] Breaking_Pitt: is it possible?
[2013-11-19 14:16:56 -0500] Breaking_Pitt: Do you recommend it?
[2013-11-19 14:19:43 -0500] cpuguy83: Breaking_Pitt: Anything is possible, you can run any command you want.
[2013-11-19 14:19:52 -0500] cpuguy83: Generally you want to control the package versions you are using, though.
[2013-11-19 14:20:20 -0500] Breaking_Pitt: cpuguy83 Have you tested it?
[2013-11-19 14:20:35 -0500] cpuguy83: Breaking_Pitt: Have I tested if I can run a command on my systems?
[2013-11-19 14:20:44 -0500] Breaking_Pitt:  :)
[2013-11-19 14:20:49 -0500] Breaking_Pitt: No the dist-upgrade
[2013-11-19 14:20:52 -0500] Breaking_Pitt: command
[2013-11-19 14:20:53 -0500] cpuguy83: Chef is just Ruby.  Ruby can do anything to the system you ask it to
[2013-11-19 14:21:25 -0500] cpuguy83: You'll also have to trigger a reboot to happen somehow
[2013-11-19 14:22:07 -0500] cpuguy83: Keep in mind... apt-get uprade is dangerous to do blindly on your server.  apt-get dist-upgrade is nuts.
[2013-11-19 14:29:41 -0500] adamjk-dev: not to mention reboots aren't the easiest to handle
[2013-11-19 14:29:50 -0500] adamjk-dev: chef-client run doesn't span through a reboot
[2013-11-19 14:32:25 -0500] cpuguy83: One could schedule an at command to happen
[2013-11-19 14:32:32 -0500] cpuguy83: Or something.
[2013-11-19 14:34:15 -0500] DandyPandy: With berkshelf, do you have to delete a version of a cookbook via knife and upload it again via berks to get it to update on the server?
[2013-11-19 14:35:22 -0500] DandyPandy: that's assuming the version isn't changing because it's in development. I know I should be using Vagrant for testing, but I'm not at a place I can do that right now.
[2013-11-19 14:35:57 -0500] adnichols: DandyPandy: I believe if you don't increment thee version then yes - or there may be a way to force it
[2013-11-19 14:37:38 -0500] JeanMertz: Does Chef have a method to easy check if a deeply nested attribute key exists?
[2013-11-19 14:42:08 -0500] cpuguy83_: JeanMertz: attributes are just Ruby hashes
[2013-11-19 14:42:42 -0500] JeanMertz: cpuguy83_ I know, I was just hoping Chef provided an easy method to do nested key search in those hashes, but I guess I can add my own helper
[2013-11-19 14:44:46 -0500] cpuguy83: JeanMertz: http://stackoverflow.com/questions/8301566/find-key-value-pairs-deep-inside-a-hash-containing-an-arbitrary-number-of-nested
[2013-11-19 14:46:28 -0500] adamjk-dev: hey all, are ruby_block resources called every chef run?
[2013-11-19 14:46:37 -0500] JeanMertz: cpuguy83 thanks, I was aware of these methods, but since Chef is build around these attributes, I expected there to be some available already in the Chef source code.
[2013-11-19 14:46:39 -0500] adamjk-dev: meaning, they are not idempotent by default (without using some sort of guard)
[2013-11-19 14:46:53 -0500] adnichols: adamjk-dev: correct
[2013-11-19 14:46:59 -0500] JeanMertz: adamjk-dev they are, and the guard is only_if/not_if
[2013-11-19 14:47:06 -0500] adamjk-dev: adnichols: that's what I thought, just wanted to check
[2013-11-19 14:47:17 -0500] adamjk-dev: gotcha, thanks
[2013-11-19 14:47:20 -0500] zts: JeanMertz: I usually end up trying, and catching exceptions - it does seem like something that would be good to have in the DSL though
[2013-11-19 14:47:38 -0500] cpuguy83: activesupport provides "try"
[2013-11-19 14:47:45 -0500] cpuguy83: Which you could use
[2013-11-19 14:47:47 -0500] ichilton: hi zts, adamjk-dev & adnichols
[2013-11-19 14:47:56 -0500] zts: hola ichilton, how's it going?
[2013-11-19 14:47:59 -0500] JeanMertz: cpuguy83 true, but you still need to chain the try's, I'd rather have it traverse a hash
[2013-11-19 14:48:00 -0500] adnichols: hey ichilton
[2013-11-19 14:48:05 -0500] ichilton: zts: fine thanks - you?
[2013-11-19 14:48:06 -0500] adamjk-dev: ichilton: heyo, whats up
[2013-11-19 14:48:17 -0500] JeanMertz: Also cpuguy83 does Chef include ActiveSupport? I wasn't aware of this
[2013-11-19 14:48:30 -0500] cpuguy83: JeanMertz: You can include whatever you want
[2013-11-19 14:48:36 -0500] cpuguy83: chef_gem resource
[2013-11-19 14:48:52 -0500] zts: ichilton: yeah, not too bad!
[2013-11-19 14:48:54 -0500] JeanMertz: Hmm, yeah. I guess it's a bit overkill just for this one issue.
[2013-11-19 14:49:10 -0500] cpuguy83: JeanMertz: You can use Hash#fetch
[2013-11-19 14:49:34 -0500] JeanMertz: Yeah, using that now, just wondered if there was a prettier method already available, guess not :)
[2013-11-19 14:49:37 -0500] cpuguy83: Not much better than try in that case.
[2013-11-19 14:49:47 -0500] Alex______: hello
[2013-11-19 14:50:48 -0500] cpuguy83: JeanMertz: This one looks nice: http://stackoverflow.com/questions/1820451/ruby-style-how-to-check-whether-a-nested-hash-element-exists
[2013-11-19 14:51:27 -0500] Alex______: I have  a simple question is it possible to set default attributes inside a recipe FOR a recipe which is run before the recipes that defines the attributes
[2013-11-19 14:51:30 -0500] Alex______: ?
[2013-11-19 14:52:13 -0500] JeanMertz: cpuguy83: hmm, yeah, that seems like a nice solution
[2013-11-19 14:52:25 -0500] cpuguy83: JeanMertz: Or.... just ensure that the attribute key always exists and set it to a null object or *gasp!* nil
[2013-11-19 14:52:49 -0500] cpuguy83: The gasp is because I'm finding that nil is a bad thing
[2013-11-19 14:52:51 -0500] zts: Alex______: cookbook attributes files are loaded before recipes are compiled
[2013-11-19 14:53:09 -0500] Alex______: a oke so i need to define them in my attributes file
[2013-11-19 14:53:43 -0500] cpuguy83: I like making the data have what the code needs, not the other way around.
[2013-11-19 14:56:09 -0500] broconne: I know that in a recipe, you can't do a rescue block on a chef resource..  is there a way to do that inside of a provider?
[2013-11-19 14:56:43 -0500] cpuguy83: broconne: You can do a rescue block in a recipe if it's in a method
[2013-11-19 14:57:10 -0500] adnichols: broconne: what are you trying to accomplish? There are some built-in methods to retry or allow the resource to fail w/out failing the run
[2013-11-19 14:57:42 -0500] Alex______: is it also possible to use search inside a attribute file
[2013-11-19 14:57:43 -0500] Alex______: ?
[2013-11-19 14:59:38 -0500] Breaking_Pitt: thanks adamjk-dev cpuguy83
[2013-11-19 15:00:02 -0500] adamjk-dev: Breaking_Pitt: of course
[2013-11-19 15:02:24 -0500] Alex______: i want to do something like: default.dialogue.applicationservers = search(:node, 'role:td48') ..... is thath even possible??
[2013-11-19 15:05:10 -0500] ___stefan: Hi everyone, can someone quickly help me with a bit of ruby? I'm trying to read the flags of the cpus in a node but I keep getting "undefined method `flags' for 1:Fixnum". Ruby beginners mistake for sure. Here is the code http://pastie.org/8492788
[2013-11-19 15:06:50 -0500] cpuguy83: ___stefan: Looks like "cpu" is returning simply a 1
[2013-11-19 15:07:17 -0500] broconne: cpuguy/adnichols..  Trying to catch a 404 error for a remote_file inside of a library.. And try a different path if we receive that.
[2013-11-19 15:07:43 -0500] broconne: this is in a provider, not a receipe.
[2013-11-19 15:08:04 -0500] cpuguy83: broconne: You can have a rescue block inside any method, no matter where it is located.
[2013-11-19 15:08:25 -0500] broconne: hmm.. wasn't working..
[2013-11-19 15:08:51 -0500] broconne: http://stackoverflow.com/questions/18341615/how-to-capture-chef-exceptions
[2013-11-19 15:08:57 -0500] broconne: that links says it shouldn't work in receipes either
[2013-11-19 15:08:59 -0500] holms: found 2 results in google from #chef log, and nobody answer those poor guy questions =/
[2013-11-19 15:09:29 -0500] Alex______: is it possible to use chefs search inside a attribute file?
[2013-11-19 15:09:32 -0500] cpuguy83: broconne: rescuing an exception won't let you continue on in your code
[2013-11-19 15:09:56 -0500] broconne: well the rescue block never gets called
[2013-11-19 15:10:08 -0500] cpuguy83: broconne: So, you can't throw a rescue block directly into a recipe, but if you have a method that you've defined in your recipe then you can
[2013-11-19 15:10:08 -0500] holms: http://pastie.org/8492809
[2013-11-19 15:10:13 -0500] holms: anybody knows wtf is this ?
[2013-11-19 15:10:14 -0500] holms: :)
[2013-11-19 15:10:32 -0500] broconne: cpuguy:  I was trying to do a rescue around a remote_file resoruce inside of a custom provider.  was the use case.
[2013-11-19 15:10:39 -0500] juliancdunn: broconne: I think the easiest way to do what you want is the following:
[2013-11-19 15:10:45 -0500] juliancdunn: 1. ignore failure on the first resource
[2013-11-19 15:10:49 -0500] cpuguy83: broconne: Aaah, that's a whole other ball of wax.
[2013-11-19 15:10:57 -0500] ___stefan: cpuguy83: k, thanks. Does anyone have an example for iterating through the ohai attributes?
[2013-11-19 15:10:57 -0500] juliancdunn: 2. add idempotency guard to second resource that only fires if the target file doesn't exist
[2013-11-19 15:11:32 -0500] broconne: how do you ignore the failure?  it stops the chef run.
[2013-11-19 15:12:08 -0500] skarufue: i get a error when i try to knife something on a chef server i just installed. but i can access the webinterface just fine. error is here: https://paste.aykit.org/?8b8d008337447b73#NpeTua7kLM7cPG41HAliQKu5JfFLv8P2wf5pgam8qpU=
[2013-11-19 15:12:13 -0500] cpuguy83: ___stefan: Well, you need to know the structure of what you are iterating.
[2013-11-19 15:12:30 -0500] adnichols: broconne: search for ignore_failure here: http://docs.opscode.com/resource.html
[2013-11-19 15:12:32 -0500] cpuguy83: ___stefan: Also, you can't call "flags" on a hash, you'd have to do ['flags']
[2013-11-19 15:12:58 -0500] broconne: adnichols - thanks.
[2013-11-19 15:12:59 -0500] ___stefan: cpuguy83: is there a nice way to print that in Ruby? like in php print_r/var_dump
[2013-11-19 15:13:21 -0500] cpuguy83: ___stefan: "pp", but you first have to do "require pp"
[2013-11-19 15:13:27 -0500] cpuguy83: * require 'pp'
[2013-11-19 15:14:34 -0500] ___stefan: cpuguy83: ok, thanks
[2013-11-19 15:14:58 -0500] juliancdunn: cpuguy83: you can also use chef-shell to poke around in the data structure
[2013-11-19 15:15:00 -0500] cpuguy83: pp is pretty print, fyi
[2013-11-19 15:15:31 -0500] juliancdunn: er, that was supposed to be to ___stefan
[2013-11-19 15:15:57 -0500] ___stefan: juliancdunn: ok, thanks
[2013-11-19 15:17:17 -0500] broconne: interesting.. even on ignore failure it still dumps the stack to the screen.
[2013-11-19 15:18:02 -0500] adnichols: broconne you set ignore_failure true ?
[2013-11-19 15:18:12 -0500] juliancdunn: it'll still dump the stack, but the recipe will continue
[2013-11-19 15:18:15 -0500] broconne:  had an error: 404 "Not Found"; ignore_failure is set, continuing
[2013-11-19 15:18:18 -0500] adnichols: broconne it may dump the stack to the screen I guess
[2013-11-19 15:18:20 -0500] broconne: yeah its continuing
[2013-11-19 15:18:22 -0500] broconne: just dumping the stack
[2013-11-19 15:18:53 -0500] broconne: just thought i t was interesting :-)
[2013-11-19 15:19:02 -0500] broconne: I assume there is "suppress_dump" :-)
[2013-11-19 15:19:17 -0500] juliancdunn: broconne: not sure, but we'd take a patch :-P
[2013-11-19 15:19:48 -0500] broconne: haha
[2013-11-19 15:20:51 -0500] stankaitis: hi all I have come into managing a chef repo that was not built by me and I am new to chef, just working my may through the fundamentals.  The problem I am up against is that the chef-repo is common code base, so someone made a change to test out in sty, and then chef-client ran in prod and things broke...  what is the chef recommended workflow and way of dealing with this?  GIT Branches?  a stg branch merge to a prod branch after
[2013-11-19 15:20:51 -0500] stankaitis: testing?  I have been looking at environments, and that seems to work with segmentation, but I am not seeing the workflow to promote changes from one env to the other...
[2013-11-19 15:22:05 -0500] zunkree: Hello
[2013-11-19 15:24:15 -0500] zunkree: an I build chef-server from source code? Where can I get such documentation?
[2013-11-19 15:24:45 -0500] skarufue: zunkree: you can but its badly documented. and wierd
[2013-11-19 15:25:38 -0500] Alex______: why doesnt this work? default.web.applicationservers = ::Chef::Search::Query.search(:node, 'role:web')
[2013-11-19 15:25:50 -0500] Alex______: inside my attribute file?
[2013-11-19 15:28:04 -0500] Alex______: ?
[2013-11-19 15:30:16 -0500] Alex______: anyone who can help me with this it drives me crazy
[2013-11-19 15:31:39 -0500] adnichols: Alex______: I'm assuming it works if you move it into a recipe?
[2013-11-19 15:31:58 -0500] Alex______: my apache cookbook installs apache after that a cookbook gets extra attribute out of chef which are needed in the apache cookbook
[2013-11-19 15:32:34 -0500] Alex______: but the second cookbook cannot run before my apache cookbook
[2013-11-19 15:32:57 -0500] Alex______: and when i define it in a recipe my apache cookbook will ignore it
[2013-11-19 15:34:53 -0500] Alex______: adnichols you know what i mean
[2013-11-19 15:34:55 -0500] Alex______: ?
[2013-11-19 15:35:06 -0500] adnichols: Alex______: Not really without seeing the code
[2013-11-19 15:35:15 -0500] adnichols: Alex______: if you want to pastebin it I'll take a look
[2013-11-19 15:35:25 -0500] Alex______: oke wait one sec :)
[2013-11-19 15:37:45 -0500] bean: stankaitis: I'd say version pinning.
[2013-11-19 15:37:56 -0500] zeroXten: do people generally use a rakefile to run test-kitchen, foodcritic, rubocop etc?
[2013-11-19 15:38:56 -0500] Alex______: adnichols : http://pastebin.com/7kYLUYV2
[2013-11-19 15:38:56 -0500] adnichols: zeroXten: We do
[2013-11-19 15:39:05 -0500] stankaitis: bean thanks I will check that out.
[2013-11-19 15:39:53 -0500] spiffytech: I'm trying to follow the Chef 10 -> 11 migration guide, but "knife download /" is giving me problems: http://pastebin.com/brEVDwpx
[2013-11-19 15:39:55 -0500] Alex______: i need to set those attributes for my apache cookbook but the rest of the cookbook needs to run after apache
[2013-11-19 15:40:23 -0500] adnichols: Alex______: the order you set the attributes in becomes less important if you set them as override instead of default
[2013-11-19 15:41:10 -0500] Alex______: uhhuh i know but i am not trying to override attributes but merge them
[2013-11-19 15:41:22 -0500] zeroXten: adnichols: k thanks
[2013-11-19 15:41:25 -0500] adnichols: Alex______: they get merged either way
[2013-11-19 15:41:42 -0500] adnichols: Alex______: it's a matter of which values take precidence
[2013-11-19 15:42:06 -0500] Alex______: oke but i see the settings in the node overview but they where not used on the system
[2013-11-19 15:42:47 -0500] adnichols: Alex______: where are you including the apache cookbook? is it somewhere further down in this recipe?
[2013-11-19 15:43:12 -0500] stormerider: spiffytech: try knife-backup plugin
[2013-11-19 15:43:42 -0500] Alex______: i am not including it it is higher in my runlist
[2013-11-19 15:43:58 -0500] bean: I'd include it in your recipe.
[2013-11-19 15:44:12 -0500] bean: that makes mroe sense than throwing it in your run list
[2013-11-19 15:44:37 -0500] Alex______: oke so i need to include it in my recipe and remove it from my runlist
[2013-11-19 15:45:15 -0500] adnichols: Alex______: also note that attributes in a recipe file, even at the default precedence, should be used over defaults in the cookbook attributes file
[2013-11-19 15:45:17 -0500] Alex______: its in my runlist because its a DMZ server
[2013-11-19 15:45:40 -0500] Alex______: and the other cookbook installs its config on the server
[2013-11-19 15:46:16 -0500] adnichols: Alex______: I don't have enough context about your setup to understand why that influences things
[2013-11-19 15:47:13 -0500] Alex______: well i have a apache DMZ server
[2013-11-19 15:47:42 -0500] tnarik: hi everyone
[2013-11-19 15:48:08 -0500] Alex______: now i want to add a custumers vhost AND error documents which are set in httpd-default.conf which is managed by the apache cookbook
[2013-11-19 15:48:14 -0500] tnarik: quick question, was the 'encrypted_data_bag_secret' setting removed already from Chef 11.8?
[2013-11-19 15:48:57 -0500] tnarik: I am trying to use encrypted data bags with Vagrant (which uses 'encrypted_data_bag_secret' in the 'solo.rb' configuration file it creates) and was constantly unsuccessful
[2013-11-19 15:49:10 -0500] tnarik: instead, if I modify the 'solo.rb' to have a knife[:secret_file] setting, it works
[2013-11-19 15:49:22 -0500] Alex______: so i need to change some apache attributes from down the runlist
[2013-11-19 15:50:13 -0500] Alex______: and the apache cookbook needs to stay in the runlist because it will still be needed when i delete the client
[2013-11-19 15:50:23 -0500] Alex______: (custumer)
[2013-11-19 15:50:24 -0500] adnichols: Alex______: the order of attribute definition should only really be relevant if they are at the same precedence level - they get merged regardless
[2013-11-19 15:50:40 -0500] joshfng: hello
[2013-11-19 15:51:13 -0500] Alex______: oke so the ones in recipes get also merged before al the recipe's are run
[2013-11-19 15:51:14 -0500] adnichols: Alex______: so you should be able to do what you want to do - but without seeing all the code you are working with I can't really say why it's not working
[2013-11-19 15:51:16 -0500] Alex______: ?
[2013-11-19 15:51:27 -0500] adnichols: Alex______: yes
[2013-11-19 15:51:28 -0500] Alex______: oke
[2013-11-19 15:51:45 -0500] Alex______: than i gonna take a look
[2013-11-19 15:51:56 -0500] Alex______: thanks for you help and awnsers
[2013-11-19 15:54:05 -0500] openminded: hi. I have a question about scaling chef-server. Currently I run chef-server on a 1 cpu 1 gb ram VM with default install. It seems slow on the web-ui and about 40 servers show a 500 error now, which was circumvented by using the -s option
[2013-11-19 15:54:33 -0500] openminded: does anyone know what to tweak on the server to be able to scale up (to about 25o)?
[2013-11-19 15:54:45 -0500] stormerider: more ram, for sure.
[2013-11-19 15:55:34 -0500] openminded: Ok, I'll try that. the thing is I do not see much RAM consumed when the server is slow. I thought I might need to tweak erlang but I can't find many docs about it
[2013-11-19 15:56:34 -0500] joshfng: Hey guys. Is there a way to do a limited search with chef
[2013-11-19 15:56:44 -0500] joshfng: we have 2000+ nodes, and a lot of our cookbooks use search
[2013-11-19 15:56:55 -0500] joshfng: causing chef-client to gc
[2013-11-19 15:57:24 -0500] zts: joshfng: https://github.com/opscode-cookbooks/partial_search
[2013-11-19 15:57:37 -0500] joshfng: Yeah, we're working on switching everything over to that
[2013-11-19 15:57:50 -0500] joshfng: Just didn't know if there was also a way to do a limit offset search
[2013-11-19 15:57:56 -0500] joshfng: or a find_each type search
[2013-11-19 15:58:10 -0500] openminded: hi joshfng, perhaps you can tell me what you tweaked from default to manage those 2000 hosts?
[2013-11-19 15:58:39 -0500] joshfng: openminded: the only thing we've done so far is bump solr memory and up the unicorn workers
[2013-11-19 15:58:48 -0500] zts: joshfng: ah sorry, misunderstood the question.
[2013-11-19 15:59:01 -0500] openminded: aha, thanks :)
[2013-11-19 15:59:11 -0500] joshfng: we're also splitting each chef serve out to dedicated boxes
[2013-11-19 15:59:16 -0500] joshfng: server*
[2013-11-19 16:00:04 -0500] lewiz: Hey guys.  Can I defer execution of chef_gem to runtime?  It fails as build-essential (Ubuntu) is not yet installed.
[2013-11-19 16:00:38 -0500] ptrf: hmm, I'm wondering
[2013-11-19 16:00:57 -0500] ptrf: oh, nevermind, jumping the gun here
[2013-11-19 16:02:38 -0500] zts: lewiz: you can't, but (if you're using the build-essential cookbook), you can set node['build_essential']['compiletime'] to true to install build-essential at compile-time
[2013-11-19 16:03:35 -0500] lewiz: zts: I'm not at the moment, but that sounds interesting so I'll check it out.  Thanks
[2013-11-19 16:04:04 -0500] lewiz: zts: ah nice - that looks like exactly what I'm after
[2013-11-19 16:14:49 -0500] skarufue: can anyone have a look: https://paste.aykit.org/?8b8d008337447b73#NpeTua7kLM7cPG41HAliQKu5JfFLv8P2wf5pgam8qpU=?
[2013-11-19 16:14:59 -0500] skarufue: i am kinda stuck on this one
[2013-11-19 16:16:23 -0500] bean: skarufue: those log lines are from the 15th
[2013-11-19 16:16:34 -0500] skarufue: yes
[2013-11-19 16:16:34 -0500] bean: it looks like your client doesn't know how to find your chef server
[2013-11-19 16:16:36 -0500] bean: (dns, etc)
[2013-11-19 16:16:41 -0500] skarufue: but problem stipp persists
[2013-11-19 16:17:01 -0500] skarufue: well but on the same machine i can comnnect to the webinterface
[2013-11-19 16:17:12 -0500] skarufue: (from browser)
[2013-11-19 16:17:28 -0500] skarufue: so dns seems fine
[2013-11-19 16:19:40 -0500] skarufue: also it obviously reaches server. the server returns a 201
[2013-11-19 16:19:58 -0500] skarufue: which seems right
[2013-11-19 16:20:55 -0500] skarufue: but then knife throws that wierd socket error (after having established connection) ... which is wierd.
[2013-11-19 16:21:47 -0500] Alex______: hey i found a problem in the service provider for solaris
[2013-11-19 16:22:12 -0500] Alex______: when you want to disable a service it is only possible when it is enabled
[2013-11-19 16:22:30 -0500] Alex______: but there is also another state : maintainance
[2013-11-19 16:22:45 -0500] stormerider: skarufue: at a guess, it's a problem with the bookshelf URL
[2013-11-19 16:22:53 -0500] Alex______: you cannot disable that one
[2013-11-19 16:23:02 -0500] Alex______: is this a bug or?
[2013-11-19 16:24:02 -0500] skarufue: stormerider: if it isnt set in knife.rb doesnt that default to chef_server_url?
[2013-11-19 16:24:22 -0500] stormerider: the chef server tells the client what to use
[2013-11-19 16:25:00 -0500] skarufue: stormerider: oh my. and he uses whatever he thinks fqdn is?
[2013-11-19 16:25:20 -0500] skarufue: stormerider: also port? 443?
[2013-11-19 16:26:55 -0500] skarufue: stormerider: does this connection go through nginx?
[2013-11-19 16:31:12 -0500] renan_: Hello! Anybody tried to use redis::server yet? I am getting "undefined method `run_state' for Chef::Resource::RunitService" when trying to install it
[2013-11-19 16:31:59 -0500] stormerider: skarufue: i believe so, yes.
[2013-11-19 16:34:49 -0500] cpuguy83: Anyone know why on Windows chef-client service would not respond to a start command?
[2013-11-19 16:35:01 -0500] cpuguy83: Often I have to tell it to start 2x before it actually starts
[2013-11-19 16:35:28 -0500] ichilton: Is it possible for a wrapper cookbook to override a template from the original?
[2013-11-19 16:35:58 -0500] cpuguy83: ichilton: http://stackoverflow.com/questions/15933157/replacing-a-template-in-a-wrapper-cookbook
[2013-11-19 16:36:30 -0500] ichilton: cpuguy83: thank you!
[2013-11-19 16:36:45 -0500] cpuguy83: ichilton: Proud to be your personal Google Search assistant :)
[2013-11-19 16:37:15 -0500] ichilton: cpuguy83: ;)
[2013-11-19 16:37:23 -0500] skarufue: ok. this is a mess. what does everyone do to firewall their chef-server?
[2013-11-19 16:37:37 -0500] cpuguy83: skarufue: iptables?
[2013-11-19 16:37:40 -0500] skarufue: i was under the impression that i just need port 443
[2013-11-19 16:37:50 -0500] skarufue: but it turns out i seem to need more
[2013-11-19 16:38:05 -0500] skarufue: cpuguy83: iptables duh...
[2013-11-19 16:38:10 -0500] cpuguy83: skarufue: :)
[2013-11-19 16:38:37 -0500] skarufue: when i first installed the chef-server i just saw shitloads of open ports bound to all interfaces
[2013-11-19 16:38:44 -0500] skarufue: to which i said ney
[2013-11-19 16:39:01 -0500] skarufue: so i blocked everything except 443 on eth0
[2013-11-19 16:39:13 -0500] skarufue: well except loopback ofc
[2013-11-19 16:39:26 -0500] c_t: doesn't chef-server usually listen on port 4000?
[2013-11-19 16:39:30 -0500] cpuguy83: I live dangerously and don't do much firewalling on the local side.  And my chef server isn't publicly available.
[2013-11-19 16:39:39 -0500] skarufue: well
[2013-11-19 16:39:44 -0500] skarufue: i cannot
[2013-11-19 16:39:51 -0500] skarufue: ok so 4000
[2013-11-19 16:40:17 -0500] cpuguy83: Everything should be going through nginx, so whatever is in that config
[2013-11-19 16:40:25 -0500] skarufue: k
[2013-11-19 16:40:30 -0500] cpuguy83: Except for backend services, of course (Solr, etc)
[2013-11-19 16:40:56 -0500] stormerider: c_t: that was 10, 11 is 80/443 by default
[2013-11-19 17:10:54 -0500] polysics: hello! is there a way to install upstart on Ddebian using Chef, please?
[2013-11-19 17:11:10 -0500] polysics: that stupid "Yes, I want to do this" option is breaking something
[2013-11-19 17:11:14 -0500] holms: what is upstart
[2013-11-19 17:11:37 -0500] polysics: a sysinit alternative
[2013-11-19 17:12:01 -0500] holms: maybe you need to contact cookbook author
[2013-11-19 17:16:00 -0500] zeroXten: wait what? minitest-handler cookbook requires you to put tests in its cookbook?
[2013-11-19 17:21:58 -0500] cwj: zeroXten: tests for minitest-handler to execute go inside your cookbook, under files/default/test
[2013-11-19 17:22:06 -0500] cwj: named like <recipe>_test.rb
[2013-11-19 17:22:09 -0500] cwj: iirc
[2013-11-19 17:24:07 -0500] zeroXten: cwj: yeah, i'm getting confused between the documentation for the gem and the cookbook
[2013-11-19 17:24:58 -0500] skarufue: polysics: upstart is the default in almost all recent ubuntus.
[2013-11-19 17:25:13 -0500] polysics: but not on Debian
[2013-11-19 17:25:21 -0500] polysics: which is where I need to install upstart :)
[2013-11-19 17:26:48 -0500] skarufue: polysics: ist this just a yes/no question or does it have interactive components (i.e. dpkg-configure package)
[2013-11-19 17:29:12 -0500] polysics: it is the only package I ahve seen that asks for a weird thing
[2013-11-19 17:29:28 -0500] polysics: you have to type "Yes, do as I say!"
[2013-11-19 17:29:33 -0500] polysics: really, exactly that
[2013-11-19 17:30:35 -0500] bean: polysics: it's probably able tobe worked around with some preseed value.
[2013-11-19 17:31:11 -0500] bean: or --force-yes
[2013-11-19 17:31:23 -0500] skarufue: no
[2013-11-19 17:31:28 -0500] skarufue: its stupid hard
[2013-11-19 17:31:31 -0500] skarufue: by design
[2013-11-19 17:31:36 -0500] skarufue: polysics: http://ask.debian.net/questions/replacing-non-interactively-a-required-package
[2013-11-19 17:32:39 -0500] skarufue: polysics: or just the line you need:
[2013-11-19 17:32:40 -0500] skarufue: dpkg --force-remove-essential remove sysvinit
[2013-11-19 17:32:41 -0500] skarufue: apt-get install upstart
[2013-11-19 17:33:01 -0500] skarufue: meh-  \n not needet here
[2013-11-19 17:33:18 -0500] skarufue: oh it actually is. sorry
[2013-11-19 18:09:02 -0500] determinant_: I am looking to setup a release management pipeline on azure IaaS using chef
[2013-11-19 18:09:17 -0500] determinant_: Are there any case studies / examples of this done ?
[2013-11-19 18:09:32 -0500] determinant_: I can provision a server using knife-azure
[2013-11-19 18:09:56 -0500] determinant_: but I am facing problems when i want to transfer my build artifacts to the target machine and get the up
[2013-11-19 18:10:10 -0500] determinant_: How does one deal wth solving this problem ?
[2013-11-19 18:10:26 -0500] steveelsewhere: anyone know how to check an attribute against a chef solo run?
[2013-11-19 18:19:45 -0500] freezey: anyone have a recipe for disabling some ohai plugins?
[2013-11-19 18:23:40 -0500] dgarstang3: I'm looking at a chef run here. First run worked. Second fails with a 'HTTP Request Returned 401 Unauthorized: error'. Hostname has not changed. Ideas?
[2013-11-19 18:30:47 -0500] wtfitsme: Hello, I am using yum_package to install some packages with specific versions but not a specific release. For instance php-devel.5.3.3 and not php-devel.5.3.3-23, Is it possible to use a wildcard?
[2013-11-19 18:54:48 -0500] modulus10: good morning/afternoon
[2013-11-19 18:56:01 -0500] modulus10: I was wondering if somsone could direct me to some documentation on how to secure chef by user and group - is it possible for chef to allow people access based on environment? I.E. if i have 3 env's dev qa prod - can i give people access to dev and qa and NOT be able to push configs to production servers?
[2013-11-19 18:56:22 -0500] juliancdunn: determinant__: best practice is to put build artifacts on an artifact server (or even an HTTP server) and transfer them to the node that way
[2013-11-19 18:57:07 -0500] juliancdunn: dgarstang3: did the chef run change your node_name in /etc/chef/client.rb?
[2013-11-19 18:57:19 -0500] juliancdunn: wtfitsme: I don't think that's possible because I don't think yum understands wildcards like that
[2013-11-19 18:57:54 -0500] determinant__: juliancdunn: Thanks for the reply. There is no standard way then ? If i have issues of putting them out in the open, ? (maybe HTTPS is a way) But all of the custom services then right ?
[2013-11-19 18:58:02 -0500] juliancdunn: modulus10: you can do that if you are using Hosted or Enterprise Chef, using RBAC
[2013-11-19 18:58:20 -0500] determinant__: Also, I don't see great resources on setting up chef installation in an Azure VM. Are there any use cases of this at all ?
[2013-11-19 18:58:33 -0500] dgarstang3: juliancdunn: No. i think that something that chef needs hasn't run yet. i gotta work out how to make upstart start the chef-client last. :(
[2013-11-19 18:58:58 -0500] modulus10: juliancdunn: thanks for the info - unfortunately i am not using hosted or enterprise :(
[2013-11-19 18:59:01 -0500] juliancdunn: determinant__: there's no "standard way" mostly because every company does artifact distribution differently
[2013-11-19 18:59:24 -0500] juliancdunn: but generally people run something like Sonatype Nexus or Artifactory, put the binaries there, and then retrieve them with Chef
[2013-11-19 18:59:39 -0500] juliancdunn: those products are akin to fancy HTTP servers, and you can have authentication against them as well
[2013-11-19 19:00:00 -0500] determinant__: juliancdunn: That is true, they are very customized tailored to the application's requirement
[2013-11-19 19:00:03 -0500] determinant__: thanks.
[2013-11-19 19:00:15 -0500] determinant__: juliancdunn: Also, I don't see great resources on setting up chef installation in an Azure VM. Are there any use cases of this at all ?
[2013-11-19 19:02:16 -0500] jperry: ohai chefs
[2013-11-19 19:02:50 -0500] jperry: using the ohai cookbook and inside the default recipe it sets local variable to the return of a resource and then calls "updated?" on it
[2013-11-19 19:03:05 -0500] jperry: https://github.com/opscode-cookbooks/ohai/blob/master/recipes/default.rb
[2013-11-19 19:03:59 -0500] jperry: nm, I figured it out.  I think we have some old code that has a bug
[2013-11-19 19:04:20 -0500] gchristensen: determinant__: all I do is have an apt/yum server for internal artifacts, on the VPN so it isn't public.
[2013-11-19 19:04:29 -0500] juliancdunn: determinant__: wdym setting up chef installation on an Azure VM?
[2013-11-19 19:04:35 -0500] juliancdunn: like getting Chef Client on there?
[2013-11-19 19:05:37 -0500] determinant__: juliancdunn: Cuz, I am on a windows scenario:)
[2013-11-19 19:05:57 -0500] determinant__: yeah something like that,(i.e) I want to run a webiste from there, based on IIS
[2013-11-19 19:06:27 -0500] juliancdunn: determinant__: I assume you watched my webinar? :-)
[2013-11-19 19:06:35 -0500] determinant__: gchristensen: That's very simple and nice. Unfortunately I am at the mercy of windows here :(
[2013-11-19 19:06:52 -0500] gchristensen: determinant__: okay, set up an internal VPN'd http server :P
[2013-11-19 19:08:01 -0500] determinant__: gchristensen: He he, that's definitely one way i would think about it, i can have my CI to upload bits to it and trigger a download job on the VM :) Thanks, for the suggestion
[2013-11-19 19:08:30 -0500] determinant__: juliancdunn: Pretty n00b here,  from the looks of it, had i watched pretty much all my questions my get answered, where can I find it ?
[2013-11-19 19:08:53 -0500] juliancdunn: determinant__: https://www.youtube.com/watch?v=aanm1Neto1U
[2013-11-19 19:10:09 -0500] determinant__: juliancdunn: Thanks a ton. Looks exactly like my scenario. I will watch it :)
[2013-11-19 19:10:10 -0500] determinant__: Thanks again :)
[2013-11-19 19:10:11 -0500] juliancdunn: the source code for the nopcommerce cookbook is here: https://github.com/juliandunn/nopcommerce
[2013-11-19 19:11:06 -0500] determinant__: ah, perfect, thanks :)
[2013-11-19 19:11:24 -0500] MattMaker: okay, there's something a bit pathological about how hard it is to figure out how to get chef to just ... copy a folder
[2013-11-19 19:11:26 -0500] MattMaker: locally
[2013-11-19 19:11:41 -0500] MattMaker: Google results for that question are a mess
[2013-11-19 19:11:49 -0500] polysics: does anyone use Vagrant locally? What is your process for moving to a real VPS?
[2013-11-19 19:14:13 -0500] MattMaker: doing it by shelling out to a command or using the bash resource: silly, and difficult to escape spaces properly.  Writing your own half-page-long recursive copy-a-folder function right there in ruby: even siller. Help?
[2013-11-19 19:20:23 -0500] juliancdunn: MattMaker: *supposedly* Chef 11.6 added file:/// as a source for a bunch of the file providers: http://docs.opscode.com/release/11-6/release_notes.html
[2013-11-19 19:20:35 -0500] juliancdunn: though the last time I told someone that, they told me it doesn't work
[2013-11-19 19:21:17 -0500] MattMaker: interesting
[2013-11-19 19:26:37 -0500] juliancdunn: polysics: upload the cookbooks to the real Chef server and fire up production nodes?
[2013-11-19 19:26:42 -0500] juliancdunn: not sure what you mean exactly
[2013-11-19 19:28:11 -0500] polysics: I have no Chef server :)
[2013-11-19 19:29:53 -0500] teukka: polysics: juliancdunn will sell you one ;)
[2013-11-19 19:30:19 -0500] teukka: free for up to 5 nodes
[2013-11-19 19:31:16 -0500] teukka: polysics: but depending on your vps provider, there might also be a vagrant plugin for it
[2013-11-19 19:32:09 -0500] teukka: polysics: and if you want chef-solo instead you can use e.g. knife-solo
[2013-11-19 19:45:21 -0500] jmickle: the nginx recipe sucks
[2013-11-19 19:45:22 -0500] jmickle: ;-p
[2013-11-19 19:45:50 -0500] pihkal010: i have a question about templates
[2013-11-19 19:45:59 -0500] pihkal010: i'd like to add the chef node name to a template
[2013-11-19 19:46:25 -0500] pihkal010: anyone know how to do that?
[2013-11-19 19:46:28 -0500] coderanger: pihkal010: <%= node.name %>
[2013-11-19 19:46:44 -0500] pihkal010: huh, ok.  i'll try that.  i tried this: <%= @chef_config['node_name'].inspect %> but it didnt work
[2013-11-19 19:49:48 -0500] pihkal010: awesome, that worked.  thanks
[2013-11-19 19:49:55 -0500] pihkal010: if i want it lowercase, will .downcase work?
[2013-11-19 19:59:28 -0500] juliancdunn: just to be clear, Vagrant is intended to be used for development only, polysics -- that's what mitchellh would tell you
[2013-11-19 20:05:51 -0500] maniacal: bootstrap has the following that get's output to /etc/chef/client.rb on the target node ==>   <%= config_content %>
[2013-11-19 20:06:18 -0500] maniacal: I've spent the last 20 minutes going through the code.  can't for the life of me firgure out where it's getting    config_content
[2013-11-19 20:06:56 -0500] maniacal: It appears to be reading it from a file.  I'm guessing a file on my local system.  probably something packed in the gem.  want to see that file, and want to know if it can be overwritten
[2013-11-19 20:07:04 -0500] maniacal: maybe I jsut answered my own question
[2013-11-19 20:08:23 -0500] aMoniker: Is there a way to ignore the exit status code, continuing the script regardless, within a call to service?
[2013-11-19 20:08:38 -0500] aMoniker: Or will an error status code even stop things?
[2013-11-19 20:08:50 -0500] adnichols: aMoniker: ignore_failure ?
[2013-11-19 20:09:34 -0500] aMoniker: adnichols: cool - do I have to set it to any value?
[2013-11-19 20:09:43 -0500] adnichols: aMoniker: true :)
[2013-11-19 20:10:07 -0500] aMoniker: which is just `ignore_failure true` within the context of service?
[2013-11-19 20:10:13 -0500] adnichols: yep
[2013-11-19 20:10:20 -0500] aMoniker: cool, thank you
[2013-11-19 20:13:01 -0500] adnichols: I get that those are common to all resources but I bet it would save a lot of questions to document those options on each resource type doc (for service, template, etc)
[2013-11-19 20:13:35 -0500] coderanger: beware that ignore_failure is rather ugly and should generally be avoided
[2013-11-19 20:13:40 -0500] coderanger: it still displays the error
[2013-11-19 20:14:03 -0500] wdilly: on my chef bootstrap i get the following error: The request failed because your clock has drifted by more than 15 minutes.... does this mean that my chef-node or chef-workstation have the wrong NTP time?
[2013-11-19 20:14:13 -0500] adnichols: agreed, which is extra crappy if you are using an attribute from an encrypted data bag that you don't want folks to see
[2013-11-19 20:15:21 -0500] adnichols: coderanger: are there other approaches to ignore_failure that I'm maybe not thinking of? Or just avoid getting into a situation where a failure is acceptable?
[2013-11-19 20:15:48 -0500] coderanger: adnichols: Yeah, that last one, in this case I would fix the service script for example (possibly via a wrapper)
[2013-11-19 20:16:03 -0500] adnichols: makes sense
[2013-11-19 20:16:21 -0500] _ci: How can I use a databag variable in knife.rb?
[2013-11-19 20:16:30 -0500] maniacal: nope.   didn't answer my own question.  so I'll ask another way:         How do I add items to client.rb
[2013-11-19 20:17:07 -0500] adnichols: wdilly: could mean either
[2013-11-19 20:17:17 -0500] adnichols: wdilly: just means they are out of sync
[2013-11-19 20:17:28 -0500] _ci: For example, knife[:aws_access_key_id]="encrypted_databag_item"
[2013-11-19 20:18:04 -0500] adnichols: wdilly: actually that's not accurate - it's most likely not your workstation
[2013-11-19 20:20:11 -0500] adnichols: maniacal: use the chef-client cookbook?
[2013-11-19 20:20:28 -0500] maniacal: I want to modify the client.rb that get's created by the bootstrap
[2013-11-19 20:20:34 -0500] coderanger: _ci: That isn't how encrypted data bags work
[2013-11-19 20:20:59 -0500] sparr: is there a common implementation for specifying what the network configuration of a node should be, which will survive the deletion and recreation of that node and client on the chef server?
[2013-11-19 20:21:04 -0500] sparr: or that won't
[2013-11-19 20:21:21 -0500] gregkare: _ci: You want to use environment variables for something you set in knife.rb
[2013-11-19 20:21:25 -0500] maniacal: looks like you could at one point put a client.rb in your .chef directory and it would use that
[2013-11-19 20:21:27 -0500] _ci: coderanger: I didn't think so.  Any thoughts on how to encrypt a sensitive variable in knife,rb
[2013-11-19 20:21:33 -0500] sparr: right now I'm using a data bag to store that information
[2013-11-19 20:21:44 -0500] coderanger: _ci: You don't, nor would it make any sense to since its all local
[2013-11-19 20:21:54 -0500] adnichols: maniacal: yeah, looking at the docs I see the same
[2013-11-19 20:21:59 -0500] coderanger: _ci: You can't protect your workstation from itself
[2013-11-19 20:22:08 -0500] maniacal: adnichols: where do you see that?  I found it on an old page
[2013-11-19 20:22:12 -0500] maniacal: not a opscode page
[2013-11-19 20:22:18 -0500] adnichols: maniacal: http://docs.opscode.com/knife_bootstrap.html
[2013-11-19 20:22:26 -0500] maniacal: awesome.
[2013-11-19 20:23:40 -0500] _ci: coderanger: valid.  Was trying to add an extra level in case a workstation file was compromised.  Encryption seemed logical.
[2013-11-19 20:24:05 -0500] coderanger: _ci: Encryption is very logical, encrypt your HDD :)
[2013-11-19 20:24:35 -0500] gregkare: It makes sense not to have stuff like AWS credentials in your git repo, you probably want different credentials for everyone
[2013-11-19 20:25:04 -0500] gregkare: Environment variables make a lot of sense for things like that, then you can keep your knife.rb in the repo without the credentials
[2013-11-19 20:25:13 -0500] maniacal: adnichols: sorry, but still dont' see it mentioned on that page.  I did a search for 'client.rb' only found 2 instances so I read the whole doc and still don't see it.  if don't mind can you lead this blind man
[2013-11-19 20:25:39 -0500] adnichols: maniacal: it's under a header "Debian and Apt"
[2013-11-19 20:26:00 -0500] adnichols: maniacal: "The knife bootstrap sub-command will look in three locations for the template that is used during the bootstrap operation."
[2013-11-19 20:26:48 -0500] maniacal: Ok.  that's for the bootstrap template.  which is where the client.rb is created.  but I'm trying to modify what contents get put in client.rb.  maybe it's not possible
[2013-11-19 20:26:56 -0500] _ci: coderanger: not for this project.  :)
[2013-11-19 20:27:49 -0500] maniacal: I might just have to recreate the bootstrap put in my own code to create client.rb.   seems lame though.  I should be able to modify what get's put in there
[2013-11-19 20:28:12 -0500] adnichols: maniacal: ok - I guess I read it and thought it did that, I haven't tried this myself
[2013-11-19 20:28:31 -0500] maniacal: I appreciate you taking the time
[2013-11-19 20:29:35 -0500] stormerider: maniacal: you might be able to do it with bootstrapper, i havent had time to dig into that much yet. https://github.com/opscode/bootstrapper
[2013-11-19 20:30:48 -0500] maniacal: stormerider: cool.  I'll check that out.  didn't know about that
[2013-11-19 20:31:07 -0500] stormerider: maniacal: it's still under development, as i understand it.
[2013-11-19 20:31:21 -0500] stormerider: heard about it at the Summit last week.
[2013-11-19 20:31:49 -0500] maniacal: yeah.  that's what it says on the page.  basically "use with caution"
[2013-11-19 20:33:19 -0500] adnichols: there is so little software I use anymore that doesn't come w/ that warning...
[2013-11-19 20:36:49 -0500] wdilly: adnichols, thats crazy, i setup NTP with chef is there a way to tell it bootstrap regardless of NTP status
[2013-11-19 20:37:39 -0500] adnichols: wdilly: it's a basic auth requirement - have you manually verified that they are or are not in sync?
[2013-11-19 20:38:27 -0500] wdilly: no, but the bootsrap has since worked
[2013-11-19 20:38:49 -0500] wdilly: adnichols, I spun up about 50 VMS and only 1 failed with the NTP problem
[2013-11-19 20:38:59 -0500] adnichols: wdilly: maybe only one had time issues
[2013-11-19 20:39:28 -0500] wdilly: adnichols, only one did, just makes me think I need to kickstart NTP instead of using chef
[2013-11-19 20:40:05 -0500] wdilly: (all the VMS were identical template)
[2013-11-19 20:40:09 -0500] adnichols: wdilly: possibly - if it becomes a regular problem
[2013-11-19 20:40:36 -0500] adnichols: wdilly: are these across multiple physical systems or in a cloud provider? Maybe there's a VM host out there w/ bad time
[2013-11-19 20:40:55 -0500] wdilly: adnichols, its in a eucalyptus private cloud
[2013-11-19 20:41:21 -0500] wdilly: adnichols, and it would be acorss multiple physical node controllers
[2013-11-19 20:41:48 -0500] maniacal: Found it.  https://github.com/opscode/chef/blob/05ba3e301794bd09173c5c3f13a62c2530d8b403/lib/chef/knife/core/bootstrap_context.rb   but don't know that it helps me much unless I feel like customizing knife.  Nice to finally know though :)
[2013-11-19 20:41:52 -0500] adnichols: wdilly: ok, well if it keeps happening then maybe there's an underlying issue to fix
[2013-11-19 20:41:58 -0500] wdilly: though, other instances on that same node controller did not have issue
[2013-11-19 20:42:13 -0500] wdilly: adnichols, yep, its something to re-think, thanks.
[2013-11-19 21:03:37 -0500] chris613: is remote_file with a source of file:/// available in Chef 10, or was that a Chef 11 addition?
[2013-11-19 21:08:20 -0500] Toger: Is there a OSS version of the API hosted at http://community.opscode.com/api/v1, so one could host their own (for local librarian-chef compatibility)?
[2013-11-19 21:08:38 -0500] juliancdunn: Toger: not yet
[2013-11-19 21:08:58 -0500] Toger: juliancdunn: thank you.
[2013-11-19 21:09:33 -0500] nickmeha1ry: Is there any way to change which interface node[:ipaddress] references? I'm trying to work around a problem with AFW and I need that to have the internal IP.
[2013-11-19 21:11:51 -0500] gchristensen: juliancdunn: is the API documented other than the knife source?
[2013-11-19 21:12:50 -0500] coderanger: gchristensen: No, and I don't think the next gen server is likely to match it since the berkshelf API might end up the next defacto standard
[2013-11-19 21:13:04 -0500] coderanger: Its kind of touch-and-go right now
[2013-11-19 21:13:39 -0500] gchristensen: daamn nice
[2013-11-19 21:14:14 -0500] juliancdunn: chris613: that was a Chef 11 addition.
[2013-11-19 21:14:26 -0500] juliancdunn: I got the definitive answer about file:/// from our doc writer.
[2013-11-19 21:14:39 -0500] juliancdunn: remote_file takes file:/// for source, but nothing else does. the docs are being updated.
[2013-11-19 21:14:48 -0500] chris613: juliancdunn: Thanks. That's terrible news for me, but thanks..... :P
[2013-11-19 21:15:13 -0500] juliancdunn: chris613: it should motivate you to upgrade! :-P
[2013-11-19 21:16:43 -0500] chris613: juliancdunn: Yeah, we're planning our upgrade
[2013-11-19 21:17:37 -0500] Toger: Is Pushy ever going to be in the OSS version?
[2013-11-19 21:20:44 -0500] jtimberman: Toger: "yes"
[2013-11-19 21:20:59 -0500] jtimberman: that is, open sourcing pushy was discussed at the chef summit last week
[2013-11-19 21:21:06 -0500] Toger: oh good to hear; wasn't looking forward to vulcan-mind-melding MCollective and pushy.
[2013-11-19 21:21:07 -0500] jtimberman: the details about that are not finalized.
[2013-11-19 21:21:08 -0500] Toger: err chef.
[2013-11-19 21:21:52 -0500] jtimberman: i don't have any more details than that though :)
[2013-11-19 21:24:26 -0500] coderanger: jtimberman: push da buttan!
[2013-11-19 21:25:19 -0500] coderanger: Writing reusable cookbooks is really hard :(
[2013-11-19 21:25:58 -0500] coderanger: Related: chef 12 pony, can we rename the env resource to be windows_env
[2013-11-19 21:26:32 -0500] jameson__: so I always forget this, when the file doesn't change with template, it doesn't trigger the notifies right?
[2013-11-19 21:26:33 -0500] coderanger: btm: We should do repo transfers eventually when you get a chance :)
[2013-11-19 21:26:52 -0500] coderanger: jameson__: Depends, if the owner or mode changes, it would
[2013-11-19 21:27:33 -0500] jameson__: mm literally nothing should've changed?
[2013-11-19 21:28:13 -0500] jameson__: well, it's a LWRP that I am running so none of the options or the variables changed.
[2013-11-19 21:28:27 -0500] jameson__: maybe the recipe is wrong somewhere @_@
[2013-11-19 21:44:30 -0500] gchristensen: jtimberman: is it possible to get more opscode stickers? :) I'm geting my laptop's screen replaced, andwell... there goes my sticker.
[2013-11-19 22:08:02 -0500] Simar: Does anyone have experience with the "deploy" resource ?? We are planning to deploy some code in our prod env using chef, I was wondering if deploy resource is the correct way to go?? Thanks
[2013-11-19 22:09:53 -0500] coderanger: Simar: It works for what it does
[2013-11-19 22:10:01 -0500] coderanger: but what it does is "manage deployments with git"
[2013-11-19 22:10:08 -0500] coderanger: and thats almost always a bad idea :)
[2013-11-19 22:11:20 -0500] dpippenger: So, I just signed up for an enterprise chef trial, and I'm watching module2 and it indicates I should have a link to download a starterkit.... but I don't have a link to that
[2013-11-19 22:12:59 -0500] Simar: coderanger: Thanks, let me check it out..but I agree deployment with git is a bad idea :-) but for now due to some limitations, I have to work around that issue..
[2013-11-19 22:13:20 -0500] coderanger: dpippenger: Are you on preview.opscode.com?
[2013-11-19 22:13:47 -0500] dpippenger: no, nothing indicated I should be... the webinar just magically was directed to a download page
[2013-11-19 22:14:04 -0500] coderanger: dpippenger: How did you sign up for your account?
[2013-11-19 22:14:05 -0500] dpippenger: well I creatde an account there
[2013-11-19 22:14:20 -0500] dpippenger: I didn't realize it was there
[2013-11-19 22:14:27 -0500] dpippenger: so I have an account
[2013-11-19 22:14:32 -0500] dpippenger: and I'm logged into that account
[2013-11-19 22:14:36 -0500] coderanger: Heh, after signup it should have shown you the starter kit page
[2013-11-19 22:15:22 -0500] dpippenger: ok, it didn't
[2013-11-19 22:15:29 -0500] dpippenger: so I just logged back in again
[2013-11-19 22:15:37 -0500] dpippenger: and now I get a blank screen with the opscode header and footer
[2013-11-19 22:15:47 -0500] coderanger: Do you have jsblock or similar?
[2013-11-19 22:15:53 -0500] dpippenger: nope
[2013-11-19 22:15:59 -0500] dpippenger: well I have adblock
[2013-11-19 22:16:08 -0500] dpippenger: 0 ads blocked on this page
[2013-11-19 22:16:11 -0500] coderanger: Sorry, officially no longer my dept
[2013-11-19 22:16:33 -0500] dpippenger: yeah, super
[2013-11-19 22:17:32 -0500] dpippenger: I got something called private-chef from an email download link, is that the starter kit?
[2013-11-19 22:18:18 -0500] dpippenger: it's 788 megs
[2013-11-19 22:21:13 -0500] coderanger: No, thats the private chef installer
[2013-11-19 22:21:39 -0500] dpippenger: "You can download a trial copy of Enterprise Chef Server via the following links:"
[2013-11-19 22:21:39 -0500] dpippenger: you can understand the source of my confusion
[2013-11-19 22:22:03 -0500] coderanger: sigh, one sec
[2013-11-19 22:22:39 -0500] coderanger: dpippenger: http://i.coderanger.net/YMEHX.png
[2013-11-19 22:23:11 -0500] dpippenger: does the site not work in chrome?
[2013-11-19 22:23:20 -0500] dpippenger: because I don't have any of those menu options
[2013-11-19 22:23:25 -0500] dpippenger: manage is the only working link at the top
[2013-11-19 22:23:38 -0500] dpippenger: let me try firefox
[2013-11-19 22:25:23 -0500] dpippenger: http://imgur.com/Tx6q5nt
[2013-11-19 22:25:27 -0500] dpippenger: yeah, this is what I see
[2013-11-19 22:25:43 -0500] dpippenger: I'm assuming that's not normal
[2013-11-19 22:25:53 -0500] coderanger: lulz, no idea
[2013-11-19 22:27:10 -0500] coderanger: I don't think any of the web folks hang out on IRC, so sending in a support ticket is your best bet
[2013-11-19 22:27:26 -0500] dpippenger: sigh
[2013-11-19 22:32:41 -0500] supercom32: Sorry about the newbie question, but when you call a package, ie: windows_zipfile "<SomeText>" do, the <SomeText> part is just a description as to what it does?
[2013-11-19 22:33:25 -0500] coderanger: supercom32: It is the name of the resource
[2013-11-19 22:33:55 -0500] supercom32: coderanger: Is the name of the resorce an arbitrary label you give it?
[2013-11-19 22:34:11 -0500] coderanger: Depends, on some things it becomes the default value of something
[2013-11-19 22:34:16 -0500] coderanger: Like with directory '/tmp/foo'
[2013-11-19 22:34:28 -0500] supercom32: Most times, I see people just put the full path to a file for something like windows_zipfile as the resorce name.
[2013-11-19 22:34:31 -0500] coderanger: Thats the same as directory 'awesome' do path '/tmp/foo' end
[2013-11-19 22:34:53 -0500] coderanger: Also when you do notifications you reference things by name
[2013-11-19 22:35:17 -0500] supercom32: coderanger: What specifically do notifications do for you? I noted that with or without them, it seems to be ok for my recipe.
[2013-11-19 22:36:12 -0500] coderanger: So notifications matter for systems that aren't 100% idempotent, the simplest example is restarting a service when its config file changes
[2013-11-19 22:36:46 -0500] coderanger: each resource triggers its notifications when it "changes" though that means different things in different places
[2013-11-19 22:37:16 -0500] supercom32: I see
[2013-11-19 22:38:04 -0500] supercom32: So as soon as something notifies another, it will kick off that resource block?
[2013-11-19 22:38:23 -0500] coderanger: It will run the specified action on the specified resource
[2013-11-19 22:38:24 -0500] supercom32: For example, if after unzipping I notify delete and some file.
[2013-11-19 22:38:28 -0500] supercom32: Ah
[2013-11-19 22:38:55 -0500] supercom32: If your doing resource actions in sequence, there is no need to notify since the following action will always be executed anyway?
[2013-11-19 22:39:17 -0500] coderanger: Right, it only matters for capturing state deltas generally
[2013-11-19 22:39:20 -0500] coderanger: like service restarts
[2013-11-19 22:39:45 -0500] coderanger: The restart itself isn't an idempotent-relevant action, just most software is terrible
[2013-11-19 22:39:49 -0500] coderanger: and so you need to coddle it a bit
[2013-11-19 22:39:50 -0500] supercom32: Ah, I see. In this sample recipe a co-worker created, he notifies one after the other, but it seemed useless as they run sequentially anyways.
[2013-11-19 22:40:16 -0500] coderanger: I mean you could also just restart every service on every chef run if you wanted
[2013-11-19 22:40:21 -0500] coderanger: but that seems like a bad idea :)
[2013-11-19 22:40:37 -0500] supercom32: hah
[2013-11-19 22:41:31 -0500] supercom32: When I run chef-solo, my recipe downloads a zip file and then extracts it. But I noted that if I had a previous run in, and the zip file still exists in my working directory, it craps out with an error regarding trying to create the file.
[2013-11-19 22:41:43 -0500] supercom32: Is that normal? Or should it do cleanup for me automatically?
[2013-11-19 22:41:54 -0500] coderanger: Having never used this windows_zipfile resource I can't say
[2013-11-19 22:41:59 -0500] supercom32: Ah ok
[2013-11-19 22:45:39 -0500] Guest56417: maybe a dumb question, but I'm seeing some weird behavior. I'm using the knife-ec2 plugin, 0.6.6, and knife-windows 0.5.14. These are running in Chef 11.8.0. When I use knife ec2 server create to create a Windows box, it bootstraps chef-client 11.8, as I would expect. However, when I use knife ec2 server create to create a Linux box, it boostraps chef-client 11.4.0.
[2013-11-19 22:46:06 -0500] Guest56417: I don't have a bootstrap version in my knife.rb file, and even when I tried to set one to "11.8.0" it still didn't bootstrap 11.8.0
[2013-11-19 22:46:19 -0500] Guest56417: Any ideas where I could look next?
[2013-11-19 22:46:24 -0500] dgarstang3: Anyone here with a mac put all their chef-fu onto a virtualbox vm, and had it kick off vagrant boxes. Does that work ok?
[2013-11-19 22:47:07 -0500] jmickle: dgarstang3: what do you mean
[2013-11-19 22:47:18 -0500] jmickle: Guest56417: check your bootstrap file for install links
[2013-11-19 22:47:33 -0500] jmickle: dgarstang3: i use a mac and vagrant-chef-zero
[2013-11-19 22:48:15 -0500] dgarstang3: jmickle: I mean install berksehlf and vagrant inside a virtual box vm
[2013-11-19 22:48:34 -0500] jmickle: i mean i think you are asking about virtualizing inside of virtualized
[2013-11-19 22:48:41 -0500] jmickle: i don't think thats going to work out too well for you
[2013-11-19 22:48:42 -0500] jmickle: ;-p
[2013-11-19 22:48:50 -0500] dgarstang3: jmickle: Yes, because I don't want to pollute my system
[2013-11-19 22:49:34 -0500] jmickle: uhhhh i mean i doubt its going to work
[2013-11-19 22:49:42 -0500] jmickle: just isolate off on your mac
[2013-11-19 22:50:04 -0500] dgarstang3: jmickle: isolate?
[2013-11-19 22:50:20 -0500] jmickle: i mean put it in its own space
[2013-11-19 22:50:26 -0500] jmickle: some dir or something
[2013-11-19 22:50:29 -0500] jmickle: that you can just rm later
[2013-11-19 22:50:43 -0500] dgarstang3: jmickle: that's a bit hard with gems and such
[2013-11-19 22:50:48 -0500] jmickle: not really
[2013-11-19 22:50:53 -0500] jmickle: thats all RVM does
[2013-11-19 22:51:00 -0500] jmickle: just installs locally to ~/.rvm
[2013-11-19 22:51:11 -0500] dgarstang3: how about I don't want ruby on my mac at all? :)
[2013-11-19 22:51:23 -0500] jmickle: i think thats a stupid way to look at it :-)
[2013-11-19 22:51:29 -0500] Guest56417: jmickle: I looked at the bootstrap template (`rvm gemdir`/gems/chef-11.8.0/lib/chef/knife/bootstrap/chef-full.erb -- should I be looking elsewhere?), and it uses chef_version property (sorry if I'm using the wrong name, a bit new to ruby and chef), and in the bootstrap_context.rb file, it defines chef_context as knife_config[:bootstrap_version] || Chef::VERSION
[2013-11-19 22:51:29 -0500] jmickle: ruby comes on your mac wether you like it or not
[2013-11-19 22:51:30 -0500] jmickle: haha
[2013-11-19 22:52:24 -0500] jmickle: Guest56417: are you supplying a bootstrap template? with the -d on your knife ec2 server create?
[2013-11-19 22:53:36 -0500] Guest56417: jmickle: No
[2013-11-19 22:57:48 -0500] Guest56417: the other weird thing is the AMI doesn't have gcc on it. When I try to use chef_gem "chef-vault" in my recipe, the first time I try to run that recipe, it tries to build the puma native extension and fails because it doesn't have gcc. However, if I immediately rerun that recipe, it says that chef-vault is already installed and it works.
[2013-11-19 22:59:03 -0500] Guest56417: I tried to trace the dependency graph, and chef-vault depends on chef-client; chef-client 11.4 does NOT depend on puma while chef-client 11.6 and chef-client 11.8 DO depend on puma, so is there something weird going on with the dependency resolution?
[2013-11-19 22:59:38 -0500] Guest56417: And is the fact that the ami doesn't have gcc on it why it's not bootstrapping 11.8 or 11.6 (because it can't build the native extensions)?
[2013-11-19 23:25:01 -0500] iverson0881: hi are there any good or best practices for using chef in a small team? I feel like using knife commands and directly uploading from my machine is a bad idea, do people use jenkins to deploy their chef environments or cookbooks?
[2013-11-19 23:25:33 -0500] iverson0881: i've tried knife spork but it's been fairly limiting in its ability and we've had a few snafus in the past using it as it currently doesn't support all scenarios we'd hope for
[2013-11-19 23:26:29 -0500] adnichols: iverson0881: we're moving to using Jenkins & having only that upload to the chef server but yes, it's something you have to find a good solution to. Somtimes communication in the team is sufficient, sometimes not
[2013-11-19 23:26:52 -0500] coderanger: Or just embrace the chaos
[2013-11-19 23:27:10 -0500] adnichols: iverson0881: There are a variety of approaches
[2013-11-19 23:27:39 -0500] iverson0881: adnichols: would definitely like to hear some if you have time
[2013-11-19 23:29:18 -0500] adnichols: iverson0881: well we just talked about two :)
[2013-11-19 23:30:11 -0500] jtimberman: Roles aren't evil: http://www.opscode.com/blog/2013/11/19/chef-roles-arent-evil/ :) hat tip to juliancdunn for this.
[2013-11-19 23:33:44 -0500] adnichols: iverson0881: I'm gonna sign off soon - this topic can be pretty involved to understand what specifically you are trying to do and what isn't working. knife spork is another approach that works well for some - but each approach has to make some assumptions that may not be what you want
[2013-11-19 23:34:50 -0500] adnichols: iverson0881: I also don't feel like I've worked with a process I'm totally happy with yet - Jenkins just happens to be the current approach we think will work
[2013-11-19 23:35:03 -0500] adnichols: iverson0881: but we also want a large team of developers to be able to contribute to chef
