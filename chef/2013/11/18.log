[2013-11-18 00:36:13 -0500] eswenson_: Anyone around who knows how to bootstrap a new node that DOESN'T already have gcc installed on it, but where one of the cookbooks in the run_list must be compiled?  chef client doesn't execute the run list until it can compile, so no opportunity to get build-essential loaded first.
[2013-11-18 00:38:34 -0500] estahn: morning...
[2013-11-18 00:40:49 -0500] eswenson_: g'monin'
[2013-11-18 00:48:37 -0500] estahn: guys i'm using http_request resource to setup a solr core but the second time chef runs it will throw an error cause the core already exists. how can i assign the result of an http_request to a variable?
[2013-11-18 00:48:48 -0500] estahn: http_request "create_core" do
[2013-11-18 00:48:48 -0500] estahn:   action :get
[2013-11-18 00:48:49 -0500] estahn:   url "http://127.0.0.1:#{node["tomcat"]["port"]}/solr/admin/cores?action=CREATE&name=collection1&collection=collection1&wt=json"
[2013-11-18 00:48:49 -0500] estahn: end
[2013-11-18 01:07:21 -0500] rafaelmagu: Is nginx caching available for open-source Chef server?
[2013-11-18 01:07:38 -0500] rafaelmagu: I'm seeing very slow sync times for cookbooks since migrating to Chef 11
[2013-11-18 01:07:47 -0500] rafaelmagu: And I saw this tunable on the chef-server cookbook
[2013-11-18 01:11:54 -0500] wtfitsme: Hello can anyone tell me why I receive: undefined method `default_action' when running the yum cookbook?
[2013-11-18 01:19:51 -0500] juliancdunn: wtfitsme: what version of Chef Client are you using?
[2013-11-18 01:20:44 -0500] wtfitsme: juliancdunn: 0.10.6
[2013-11-18 01:22:34 -0500] juliancdunn: wtfitsme: yeah, that's pretty old. default_action is Chef 11 syntax
[2013-11-18 01:23:15 -0500] wtfitsme: juliancdunn: ah I see, thx!
[2013-11-18 02:15:18 -0500] teukka: juliancdunn: according to google and release notes `default_action` came in 0.10.10. I've definitely used it for a long time
[2013-11-18 02:16:41 -0500] teukka: https://tickets.opscode.com/browse/CHEF-1789 =)
[2013-11-18 04:04:08 -0500] juliancdunn: teukka: ah, even better then!
[2013-11-18 04:04:24 -0500] juliancdunn: don't listen to me, I only work here :-P
[2013-11-18 05:13:39 -0500] garrett__: I'm on EC2. I'm using the lusis/kibana cookbook, which references nginx. when a node stops/starts, i have an init script in place which will kick off a chef recipe to update my chef server with the node's new IP information, as well as update Route53. nginx doesn't seem to see that any of that information has changed, and re-generates a stale ngninx conf, which causes the run to fail, as nginx tries to bind to an ip/interface that no lo
[2013-11-18 05:14:58 -0500] garrett__: am i missing a step? nginx seems to be the only cookbook which has issues
[2013-11-18 07:09:12 -0500] mrigesh: hello
[2013-11-18 07:09:41 -0500] mrigesh: need some guidance on how chef-client executes the run_list
[2013-11-18 07:09:50 -0500] mrigesh: can some body help me
[2013-11-18 07:49:08 -0500] spheromak: mrigesh: whats up
[2013-11-18 10:11:36 -0500] maloik_: Our chef is writing text attributes to some config files and they end up using ^M for newlines, but I'm having some trouble tracking down where these come from. The source is a ruby on rails api sending json, and I believe the newlines are still \r\n in there. Anyone know of known issues or cases where this can happen ?
[2013-11-18 10:37:14 -0500] mattsmith: Morning all, I'm in the process of writing a cookbook and have hit a small problem. On first run the converge fails as a config file that i'm going to parse does not exist, however the file is created by the apt-get install in the step above. I guess the converge does not take into account the files created by the apt install? Is there any best practices for this situation? should I wrap file parse in an "if" statement that will never get met
[2013-11-18 10:37:15 -0500] mattsmith: in a real run?
[2013-11-18 10:39:22 -0500] ryno75: anyone up?
[2013-11-18 10:40:00 -0500] ryno75: I have what I think will be a seemingly easy question but I can't find an answer anywhere
[2013-11-18 10:40:11 -0500] ryno75: easy to answer that is
[2013-11-18 10:41:00 -0500] ryno75: I'm coming from the puppet side of things and am used to being able to apply configs/manifests/classes/etc. simply based on something as simple as a regex match on a hostname
[2013-11-18 10:41:11 -0500] ryno75: can't seem to figure out how to do this in Chef
[2013-11-18 10:41:22 -0500] ryno75: in an automated way
[2013-11-18 10:42:15 -0500] ryno75: Seems like there should be a way to apply run lists (i.e. roles, recipes,  etc.) based on a hostname regex match.
[2013-11-18 10:42:36 -0500] bugoff: /5/7
[2013-11-18 10:42:43 -0500] ryno75: Or maybe a way to specify the run list in the client.rb?
[2013-11-18 10:42:44 -0500] ryno75: IDK
[2013-11-18 10:43:11 -0500] drrk: mattsmith you should be able to make sure the package install runs first
[2013-11-18 10:43:21 -0500] drrk: sorry didn't mean to pm that
[2013-11-18 10:44:02 -0500] mattsmith: drrk, thanks. It should be running first but my guess is the converge is failing
[2013-11-18 10:44:18 -0500] mattsmith: i.e at converge stage no package is being installed
[2013-11-18 10:44:30 -0500] mattsmith: thus chef is not aware of any files that apt may create
[2013-11-18 10:46:26 -0500] mattsmith: this then causes the parse step to fail as the file does not exist
[2013-11-18 10:55:58 -0500] enbergj: ryno75: if nothing else, a simple bash loop around knife node list, e.g. nodes=$(knife node list | grep "myregex"); for node in nodes; do knife node run_list add $node 'role[myrole]'; done
[2013-11-18 10:56:12 -0500] enbergj: for node in $nodes
[2013-11-18 10:56:49 -0500] ryno75: hmm.... ok
[2013-11-18 10:57:13 -0500] enbergj: I would think there was a way to do this by applying something to a chef search query, but I dunno how ;)
[2013-11-18 10:57:20 -0500] ryno75: I guess I was thinking there was an inherent way of doing that within the mechanisms of chef.
[2013-11-18 10:57:38 -0500] ryno75: but... that option could work.
[2013-11-18 10:58:04 -0500] enbergj: simple bash scripting can make things a lot easier than trying to learn how to do things the "right way" in another tool ;)
[2013-11-18 11:00:08 -0500] ryno75: yeah, definitely faster
[2013-11-18 11:00:19 -0500] ryno75: thanks for the idea
[2013-11-18 11:00:28 -0500] enbergj: np
[2013-11-18 11:58:06 -0500] dev1x: is there a way to refresh chef env variables ?
[2013-11-18 12:00:28 -0500] zts: dev1x: not sure what you mean by that - If you're using ruby to get an environment variable (eg, ENV['USER'] ), that will be retrieved at the time you use it.
[2013-11-18 12:00:56 -0500] dev1x: the thing is, when i start chef i run two recipes
[2013-11-18 12:00:58 -0500] dev1x: one to change the hostname
[2013-11-18 12:01:09 -0500] dev1x: and another that will get the hostname and use it
[2013-11-18 12:01:23 -0500] dev1x: the thing is that the second one is using the old hostname
[2013-11-18 12:02:09 -0500] zts: ah okay, so you need node['hostname'] to change between one and the other?
[2013-11-18 12:02:31 -0500] dev1x: i need the node['hostname'] to be updated on the second recipe
[2013-11-18 12:02:36 -0500] dev1x: actually its the fqdn
[2013-11-18 12:02:39 -0500] dev1x: but the issue is the same
[2013-11-18 12:02:44 -0500] zts: The short answer is that you can tell ohai to reload, which will then do all of its checks again and update the automatic attributes - see the example here: http://docs.opscode.com/resource_ohai.html#examples
[2013-11-18 12:02:51 -0500] dev1x: AH
[2013-11-18 12:02:56 -0500] dev1x: reload ohai seems perfect
[2013-11-18 12:03:05 -0500] zts: give it a try, but you might find you still have a problem
[2013-11-18 12:03:09 -0500] dev1x: so should i use
[2013-11-18 12:03:25 -0500] dev1x: ohai  "reload_fqdn" do
[2013-11-18 12:03:29 -0500] dev1x: action :reload
[2013-11-18 12:03:30 -0500] dev1x: end
[2013-11-18 12:03:30 -0500] dev1x: ?
[2013-11-18 12:03:57 -0500] railsraider: HI I cant get a gem to load after compile time even though i do Gem.clear_paths
[2013-11-18 12:04:04 -0500] zts: the reason is that Chef works in two phases - first, it compiles your recipes; second, it converges them.  The second recipe will be compiled before the first one is converged.  This means that depending on exactly how you are using it, the second recipe might not see the change at the right time
[2013-11-18 12:04:37 -0500] dev1x: so that's why i need to use ohai to reload?
[2013-11-18 12:04:38 -0500] railsraider: http://pastebin.com/bAi2ENrv
[2013-11-18 12:04:47 -0500] railsraider: why is this not loading the aws-sdk
[2013-11-18 12:04:58 -0500] railsraider: cannot load such file -- aws-sdk
[2013-11-18 12:05:01 -0500] zts: dev1x: yup, give that a try - if it doesn't work, pastebin your recond recipe that uses the hostname and maybe I can suggest a way to make it work
[2013-11-18 12:05:08 -0500] dev1x: okies
[2013-11-18 12:05:10 -0500] dev1x: thanks a lot man!
[2013-11-18 12:05:44 -0500] zts: no problem
[2013-11-18 12:06:09 -0500] railsraider: i have omnibus
[2013-11-18 12:06:22 -0500] zts: railsraider: I'd think that should work, but why not use chef_gem?
[2013-11-18 12:06:31 -0500] railsraider: ?
[2013-11-18 12:06:40 -0500] railsraider: theres a resource like that?
[2013-11-18 12:07:04 -0500] zts: yup, http://docs.opscode.com/resource_chef_gem.html
[2013-11-18 12:07:31 -0500] zts: if you want to make a gem available for Chef, it's the best one to use - it will make sure it installs it into the right ruby, at compile time, and makes Gem aware of it
[2013-11-18 12:07:31 -0500] railsraider: heres the trace http://pastebin.com/AugJ6uE0
[2013-11-18 12:07:58 -0500] railsraider: thanks i'll give it a shot
[2013-11-18 12:10:24 -0500] Hedin: hi everyone!!! i have some strange bug. chef-server after upload cookbook  add some string in beginning and end every recipe file. So after that it can't compile
[2013-11-18 12:11:19 -0500] Hedin: chef-server-11.0.8 chef-11.6.2
[2013-11-18 12:11:50 -0500] railsraider: zts: thanks a lot! it worked
[2013-11-18 12:14:00 -0500] zts: railsraider: ace!
[2013-11-18 13:17:49 -0500] adamjk-dev: hey all, anyone familiar with the virtualbox cookbook? https://github.com/peplin/virtualbox-cookbook
[2013-11-18 13:37:21 -0500] adamjk-dev: can anyone point me to a list of components for adding issues against Chef?
[2013-11-18 13:37:36 -0500] adamjk-dev: the cookbook I am opening a ticket against does not have an id associated with it (virtualbox)
[2013-11-18 13:47:53 -0500] Breaking_Pitt: some advice on this error...
[2013-11-18 13:47:54 -0500] Breaking_Pitt: [2013-11-18T14:46:28+01:00] FATAL: NoMethodError: undefined method `ignore_failing' for Chef::Resource::Execute
[2013-11-18 13:50:46 -0500] adamjk-dev: anyone at opscode have an idea why there isn't a component for 'virtualbox' to add an issue against that cookbook?
[2013-11-18 13:56:48 -0500] stormerider: Breaking_Pitt: doesnt look like execute supports ignore_failing: http://docs.opscode.com/resource_execute.html
[2013-11-18 13:57:12 -0500] Breaking_Pitt: thanks stormerider
[2013-11-18 13:57:18 -0500] Breaking_Pitt: i'll take a look
[2013-11-18 13:58:47 -0500] stormerider: adamjk-dev: i believe only the opscode cookbooks have components, not third party ones
[2013-11-18 13:59:04 -0500] adamjk-dev: stormerider: I was wondering if that might be the case, thanks
[2013-11-18 13:59:17 -0500] adamjk-dev: stormerider: so that stinks, there is no way to open issues on that cookbook either
[2013-11-18 13:59:29 -0500] stormerider: if it's third party, then you'd file it to the dev via github/etc
[2013-11-18 14:00:04 -0500] adamjk-dev: stormerider: just via an email I presume?
[2013-11-18 14:00:29 -0500] stormerider: though it looks like jtimberman worked on that cookbook so you might be able to get help from him when he's around :)
[2013-11-18 14:00:58 -0500] adamjk-dev: yeah, the "opscode" one points to peplin's, which is a fork of timbermans
[2013-11-18 14:01:25 -0500] adamjk-dev: but I can't file an issue via ticket.opscode.com nor an issues tracker on github, so I emailed the dev at least
[2013-11-18 14:02:27 -0500] stormerider: right, it looks like something jtimberman did in his own time, not on behalf of opscode... at least that's what i'm inferring from the @housepub.org email
[2013-11-18 14:02:37 -0500] adamjk-dev: ah, presumably so
[2013-11-18 14:02:47 -0500] adamjk-dev: I just think that cookbook should install the extension pack as well :)
[2013-11-18 14:22:52 -0500] dev1x: zts, that didnt work
[2013-11-18 14:22:55 -0500] dev1x: the ohai reload
[2013-11-18 14:23:03 -0500] dev1x: it still uses the old information
[2013-11-18 14:24:49 -0500] unflores: has anyone used the elasticsearch cookbook?  I am running it with chef solo and it's not linking the binary properly
[2013-11-18 14:34:36 -0500] dev1x: anyone knows how to reload ohai plugins?
[2013-11-18 14:35:54 -0500] dev1x: anyone knows how to reload ohai plugins?
[2013-11-18 14:36:38 -0500] phutchins: Anyone seen a problem where you upload a cookbook but for some reason the recipes folder does't make it to the node?
[2013-11-18 14:36:58 -0500] phutchins: the folder and default.rb exists on the chef server, but my vagrant node does not get the recipes folder or default.rb that lives in it
[2013-11-18 14:37:44 -0500] phutchins: and thus I get "could nto find recipe default for cookbook-blah"
[2013-11-18 14:49:52 -0500] theredseth: morning
[2013-11-18 14:51:00 -0500] theredseth: quick question...
[2013-11-18 14:51:48 -0500] bur: hi
[2013-11-18 14:51:52 -0500] theredseth: im just learning chef...when i run sudo chef-client from my client machine my recipe that is running is supposed to install apache2...basic
[2013-11-18 14:52:37 -0500] theredseth: i keep getting this error though:  no version specified, and no candidate version available for apache2
[2013-11-18 14:52:37 -0500] bur: if you add this recipe
[2013-11-18 14:52:50 -0500] bur: stacktrace
[2013-11-18 14:53:03 -0500] bur: can someone help
[2013-11-18 14:53:12 -0500] theredseth: im on centos 6.4    it runs fine on my ubuntu vm though....is there somethign specific you need to do for centos?
[2013-11-18 14:53:23 -0500] Zauberfisch23: theredseth: there is no apache2 on chentOS
[2013-11-18 14:53:30 -0500] Zauberfisch23: the redhat guys call it httpd
[2013-11-18 14:53:39 -0500] bur: yum install httpd
[2013-11-18 14:53:57 -0500] Zauberfisch23: so you need to write "package httpd" and "service httpd" instead of appache2
[2013-11-18 14:54:01 -0500] bur: package "httpd"
[2013-11-18 14:54:04 -0500] bur: faster
[2013-11-18 14:54:38 -0500] theredseth: ahhh   knew there was something different   thanks
[2013-11-18 14:54:43 -0500] Zauberfisch23: I forgot the quotes, of course it should be: package "httpd"
[2013-11-18 14:54:59 -0500] theredseth: right
[2013-11-18 14:55:26 -0500] bur: after knife upload in all cookbooks in each file adds some symbols in bedin and zero in end
[2013-11-18 14:55:58 -0500] bur: its only on server
[2013-11-18 14:56:16 -0500] theredseth: so what do you do if you have a mixed environment   some centos and some ubuntu?   just make seperate cookbooks or recipes? or can you put soemthing in the recipe that would figure out what you needed based on platform?
[2013-11-18 14:56:40 -0500] ocholetras: There is a cookbook for apache2
[2013-11-18 14:57:02 -0500] ocholetras: should be platform family agnostic
[2013-11-18 14:57:14 -0500] ocholetras: and use either yum or apt when it is the case
[2013-11-18 14:57:24 -0500] ocholetras: are u using the community cookbook for apache2?
[2013-11-18 14:57:36 -0500] theredseth: one that i wrote
[2013-11-18 14:57:45 -0500] ocholetras: ok
[2013-11-18 14:58:10 -0500] ocholetras: then  you have to deal the thing *^^
[2013-11-18 14:58:18 -0500] theredseth: i just missed that there is apache2 for ubuntu but its called just httpd on centos
[2013-11-18 14:58:19 -0500] ocholetras: doing a case
[2013-11-18 14:58:34 -0500] theredseth: ok
[2013-11-18 14:58:37 -0500] ocholetras: case node['platform_family']....
[2013-11-18 14:58:42 -0500] theredseth: right
[2013-11-18 14:58:42 -0500] ocholetras: deban do that
[2013-11-18 14:58:50 -0500] ocholetras: debian do that
[2013-11-18 14:58:51 -0500] bur: and can you help me?
[2013-11-18 14:58:54 -0500] ocholetras: redhat do other stuff
[2013-11-18 14:59:28 -0500] theredseth: thanks for the help
[2013-11-18 14:59:32 -0500] ocholetras: np
[2013-11-18 14:59:39 -0500] ocholetras: have a look at opscode apache2 cookbook
[2013-11-18 14:59:42 -0500] ocholetras: could help
[2013-11-18 14:59:59 -0500] ocholetras: but its so big.. so inspect carefully or you are going to die xD
[2013-11-18 15:01:10 -0500] bur: example
[2013-11-18 15:01:41 -0500] bur: before upload cookbook looks like pakage "mc"
[2013-11-18 15:02:15 -0500] bur: after its looks like 88 package "mc" 0
[2013-11-18 15:02:27 -0500] bur: why?
[2013-11-18 15:09:59 -0500] bur: <bur> example
[2013-11-18 15:09:59 -0500] bur: [19:01:41] <bur> before upload cookbook looks like pakage "mc"
[2013-11-18 15:10:00 -0500] bur: [19:01:44] rickmanelius [~rickman@host-69-146-253-189.static.bresnan.net] chef
[2013-11-18 15:10:00 -0500] bur: [19:01:47] rickmanelius [~rickman@host-69-146-253-189.static.bresnan.net] IRC: Client Quit
[2013-11-18 15:10:00 -0500] bur: [19:02:16] <bur> after its looks like 88 package "mc" 0
[2013-11-18 15:10:00 -0500] bur: [19:02:27] <bur> why?
[2013-11-18 15:17:09 -0500] bobbywilson0: can chef overwrite or delete a file it didn't create? e.g. /etc/logrotate.d/rsyslog has an error I would like to fix but I can't seem to successfully delete it or overwrite it with file resource and delete action
[2013-11-18 15:19:01 -0500] stormerider: bur: sorry, i dont understand what you're asking
[2013-11-18 15:20:47 -0500] bur: recipe before knife upload
[2013-11-18 15:20:47 -0500] bur: #
[2013-11-18 15:20:47 -0500] bur: # Cookbook Name:: mc
[2013-11-18 15:20:48 -0500] bur: # Recipe:: default
[2013-11-18 15:20:48 -0500] bur: #
[2013-11-18 15:20:48 -0500] bur: # Copyright 2013, YOUR_COMPANY_NAME
[2013-11-18 15:20:48 -0500] bur: #
[2013-11-18 15:20:49 -0500] bur: # All rights reserved - Do Not Redistribute
[2013-11-18 15:20:49 -0500] bur: #
[2013-11-18 15:21:05 -0500] bur: after in web ui
[2013-11-18 15:21:06 -0500] bur: 88
[2013-11-18 15:21:06 -0500] bur: #
[2013-11-18 15:21:06 -0500] bur: # Cookbook Name:: mc
[2013-11-18 15:21:06 -0500] bur: # Recipe:: default
[2013-11-18 15:21:07 -0500] bur: #
[2013-11-18 15:21:07 -0500] bur: # Copyright 2013, YOUR_COMPANY_NAME
[2013-11-18 15:21:07 -0500] bur: #
[2013-11-18 15:21:07 -0500] bur: # All rights reserved - Do Not Redistribute
[2013-11-18 15:21:08 -0500] bur: #
[2013-11-18 15:21:08 -0500] bur: 0
[2013-11-18 15:21:16 -0500] bur: what the 88
[2013-11-18 15:21:27 -0500] bur: and zero in end
[2013-11-18 15:22:18 -0500] bur: its adds in all recipes
[2013-11-18 15:34:09 -0500] squeegy: I have an action that subscribes to another action (create a directory). The action is subscribing to create, however, if the directory already exists the subscribed action is not being triggered. Is there something other than create that I can subscribe to that is always triggered?
[2013-11-18 15:57:24 -0500] zts: dev1x: you may want to re-read the other comment I made, concerning compile vs converge
[2013-11-18 15:57:59 -0500] zts: dev1x: so if you'd like to pastebin your recipes, I can explain that referring to your actual code, and maybe suggest a solution
[2013-11-18 16:06:56 -0500] adamjk-dev: anyone at Opscode have a suggestion for what to do with cookbook ownership transfers?
[2013-11-18 16:07:23 -0500] adamjk-dev: i.e. the maintainer of the virtualbox cookbook doesn't want to own it anymore, can we move it to Opscode or does someone else just pick up ownership or what?
[2013-11-18 16:08:45 -0500] adamjk-dev: http://community.opscode.com/cookbooks/virtualbox
[2013-11-18 16:09:23 -0500] jtimberman: adamjk-dev: Opscode is working on having fewer cookbooks that we primarily maintain.
[2013-11-18 16:09:56 -0500] adamjk-dev: jtimberman: I can certainly understand that haha. You guys can't exponentially manage more and more cookboks
[2013-11-18 16:10:10 -0500] jtimberman: tl;dr: it was a good idea originally, got a lot of content available, but we're not the primary stakeholders in many of the technologies we have maintained cookbooks
[2013-11-18 16:10:20 -0500] jtimberman: And yeah, it totally doesn't scale.
[2013-11-18 16:10:22 -0500] adamjk-dev: jtimberman: so what do we do, just fork it, find a new person (possibly me) and how does the opscode site know where the new location is?
[2013-11-18 16:10:49 -0500] adamjk-dev: jtimberman: gotcha, well.... its an original fork of your code in fact haha, what do we do with it now? the current maintainer is done with it
[2013-11-18 16:11:05 -0500] adamjk-dev: and I can't add issues since you cant add them on tickets.opscode.com nor on the existing github location
[2013-11-18 16:11:12 -0500] jtimberman: adamjk-dev: current maintainer would a) add "new person" (you perhaps) as a collaborator on the community site. b) promote "new person" to maintainer. c) maintainers can update the "home page" field which would point to the repository.
[2013-11-18 16:11:54 -0500] adamjk-dev: jtimberman: I see, so it is basically up to the maintainer then to handle it all I take it?
[2013-11-18 16:12:17 -0500] jtimberman: yeah, tickets.opscode.com in the COOK project is for cookbooks that we "own" - which will hopefully be much fewer soon :).
[2013-11-18 16:12:41 -0500] adamjk-dev: jtimberman: right right, I was all frustrated this morning when I couldn't find an ID for the virtualbox cookbook :)
[2013-11-18 16:12:58 -0500] jtimberman: common confusion :(
[2013-11-18 16:13:09 -0500] adamjk-dev: jtimberman: okay, then it is up to me or whomever else to take ownership then, thanks for the clarification
[2013-11-18 16:13:29 -0500] adamjk-dev: jtimberman: yeah, I just saw the issue tracker turned off on their github page and assumed tickets.opscode.com
[2013-11-18 16:13:46 -0500] jtimberman: adamjk-dev: if you want to use / fork / merge in my fork (github.com/jtimberman/virtualbox-cookbook) you're welcome to it. I don't have cycles to maintain it.
[2013-11-18 16:14:03 -0500] adamjk-dev: jtimberman: yeah, the current one is a fork of your code
[2013-11-18 16:14:22 -0500] adamjk-dev: jtimberman: I believe the new one (peplin's) is ahead of yours if I am not mistaken
[2013-11-18 16:15:02 -0500] jtimberman: i don't know :)
[2013-11-18 16:15:13 -0500] jtimberman: my local copy of the repo says initial commit was 2.5 years ago
[2013-11-18 16:15:19 -0500] adamjk-dev: jtimberman: no worries, not your responsibility.... you answered the questions at hand, thank you sir
[2013-11-18 16:15:24 -0500] jtimberman: :D
[2013-11-18 16:15:28 -0500] adamjk-dev: indeed :)
[2013-11-18 16:15:40 -0500] jtimberman: fwiw: https://wiki.opscode.com/display/chef/Community+Cookbook+Diversification
[2013-11-18 16:18:01 -0500] strictlyb: anyone from bashton in here?
[2013-11-18 16:20:39 -0500] freezey: curious if anyone has ran into chef searches taking forever
[2013-11-18 16:29:35 -0500] jchauncey: is there a way in a recipe to tell the chef run to start over?
[2013-11-18 16:31:44 -0500] jchauncey: my use case is that im trying to test a deploy in test kitchen. so i have 1 recipe that does an initial deploy and that works, but when the next recipe runs to deploy the next version it fails because the deploy resource has the same name
[2013-11-18 17:01:30 -0500] strictlyb: has anoyone else come across this bug with the aws cookbook where the raid assemble trys to create a raid array on the wrong device due to the kernel seeing devices not as its set when adding?
[2013-11-18 17:16:45 -0500] jdve: i'm trying to use ignore_failure with "service restart" to attempt to restart a service, but continue if it fails...seems to just keep failing the whole run on me...is this normal?
[2013-11-18 17:18:29 -0500] zts: jdve: no, can you pastebin the resource and the output?
[2013-11-18 17:18:38 -0500] jdve: sure, one sec
[2013-11-18 17:18:59 -0500] zeroXten: heh, upgrading chef-client to 11.8 is killing my /usr/bin/ symlinks
[2013-11-18 17:22:07 -0500] jhayden: I tried renaming a knife sub command because I was modifying it and I get the following error
[2013-11-18 17:22:09 -0500] jhayden: FATAL: Cannot find sub command for:
[2013-11-18 17:22:18 -0500] jhayden: anyone have any insight?
[2013-11-18 17:24:30 -0500] jdve: zts: ooo, my bad!  it is working, it's just printing out the error message in exactly the same way as normally...the only difference is the last line "Chef Client finished"
[2013-11-18 17:24:50 -0500] jdve: i guess i was expecting it to say something about the error getting ignored
[2013-11-18 17:36:40 -0500] ryno75: Does anyone know how to make newly auto-scaled instances automatically ascribe to speciifc roles/recipes/etc?
[2013-11-18 17:37:41 -0500] ryno75: when the instance launches it automatically downloads the client.rb and validator.pem from a secure location, then runs chef-client
[2013-11-18 17:37:53 -0500] ryno75: however... nothing is applied to the "node" by default
[2013-11-18 17:38:14 -0500] ryno75: I'd like to have it grab a specific role based on something like a hostname regex
[2013-11-18 17:38:47 -0500] ryno75: or at least be able to specify something on the chef-client run to make it ascribe to a role.
[2013-11-18 17:39:31 -0500] gchristensen: ryno75: for my hardware provisioning, the devicepasses theMAC address of its primary NIC to a PHP script which returns the roles I want it to be
[2013-11-18 17:42:14 -0500] ZonkedZebra: Anyone have experience overriding templates with OpsWorks? I think I'm doing everything right, but it still uses the built in template
[2013-11-18 17:43:27 -0500] zts: ryno75: you can set the initial run-list in a json file, and the -j option to chef-client (I use cloud-init to write out whatever's appropriate for that ASG)
[2013-11-18 17:47:26 -0500] ryno75: zts: thanks
[2013-11-18 17:48:04 -0500] ryno75: any examples of that you can point me to?
[2013-11-18 17:48:25 -0500] ryno75: new enough to chef that I'm not entirely sure what that json should contain
[2013-11-18 17:48:39 -0500] ryno75: just a run-list definition?
[2013-11-18 17:48:49 -0500] dev1x: damn this hostname crap is killing me
[2013-11-18 17:49:16 -0500] zts: ryno75: yeah, I think I struggled to find an example in the past - here's my minimal one:    {"run_list": ["role[base]"]}
[2013-11-18 17:55:07 -0500] willejs: ohai chefs
[2013-11-18 17:55:27 -0500] ZonkedZebra: zts: You have any experience with Amazon's OpsWorks?
[2013-11-18 17:56:07 -0500] willejs: I'm using chef-solo (via vagrant) and am feeding in attributes via a json file with the -j option, i expect these attributes to be of the normal attribute precedence, and to over ride default cookbook attributes, but this is not the case?
[2013-11-18 17:58:43 -0500] ikanusim: I'm giving chef-client --local-mode a spin and I get Cookbook 'apache2' is empty or entirely chefignored for all of my cookbooks
[2013-11-18 17:59:36 -0500] ikanusim: I'm not providing the -o option
[2013-11-18 17:59:56 -0500] ikanusim: but I'm passing some recipes as part of the json I'm feeding with -j
[2013-11-18 18:00:46 -0500] zts: ZonkedZebra: 'fraid not
[2013-11-18 18:00:55 -0500] ikanusim: the actual recipes are then loaded with include_recipe, but as soon as that's the case, I get Cookbook <cookbook name> not found
[2013-11-18 18:01:05 -0500] ikanusim: what am I missing?
[2013-11-18 18:03:58 -0500] nickballenger: exit
[2013-11-18 18:09:18 -0500] dgarstang3: I just tried using Chef::Application.fatal!('The rsyslog::server recipe requires physical disks for storing logs.') ... and it appears that fired but above that, it just says 'exit'
[2013-11-18 18:09:32 -0500] dgarstang3: What missing am I?
[2013-11-18 18:10:52 -0500] dgarstang3: well, raise produces output. Dunno what the point of Chef::Application.fatal!(msg) is then when msg isn't displayed.
[2013-11-18 18:17:07 -0500] bean: dgarstang3: it seems that fatal! "Log a fatal error message to both STDERR and the Logger, exit the application"
[2013-11-18 18:18:30 -0500] tcate__: At the Summit there was some talk about Opscode handing off ownership of some community cookbooks. Does anyone know who the Opscode point of contact for that is?
[2013-11-18 18:27:11 -0500] spheromak: tcate__: I would imagine its jtimberman but not positive about that.
[2013-11-18 18:28:44 -0500] tcate__: spheromak: yeah, that sounds likely. I'll hit him up and see if he knows
[2013-11-18 18:29:46 -0500] gyre007: if I have a default attribute set to foo in my wrapper cookbook and there is a same one set to blah in community cookbook, what will b e the resulting attribute value in Chef  11 ?
[2013-11-18 18:30:49 -0500] ryno75: zts: thanks.  That's what I was imagining but glad to see it with my eyes.
[2013-11-18 18:54:23 -0500] dgarstang3: Anyone know why the lvm module would bitch at me passing a stripe size of 128 when running "return Math.log2(value) % 1 == 0" ?
[2013-11-18 19:10:31 -0500] failshell: is there an up-to-date YUM repo from opscode? im looking at yum.opscode.com and it's very outdated
[2013-11-18 19:11:39 -0500] gleam: everything is meant to use omnibus now
[2013-11-18 19:12:08 -0500] failshell: yeah that
[2013-11-18 19:12:12 -0500] failshell: s what i want to sync
[2013-11-18 19:12:22 -0500] failshell: omnibus doesnt mean you can't have a yum repo
[2013-11-18 19:13:58 -0500] bean: omnibus is just a script that plops stuff under /opt i believe
[2013-11-18 19:14:03 -0500] bean: so no, it doesn't use a yum repo
[2013-11-18 19:14:43 -0500] douglaswth: bean: omnibus packages are debs and rpms though
[2013-11-18 19:15:07 -0500] bean: r u sure
[2013-11-18 19:15:13 -0500] bean: oh you're right
[2013-11-18 19:15:17 -0500] bean: I'm not thinking today
[2013-11-18 19:16:27 -0500] bean: it looks like they are just straight up debs / rpms though
[2013-11-18 19:16:30 -0500] bean: no repo
[2013-11-18 19:17:19 -0500] holms: http://stackoverflow.com/questions/18260991/why-doesnt-knife-upload-roles-upload-any-roles
[2013-11-18 19:17:24 -0500] holms: somebody can explain this unfairness?
[2013-11-18 19:18:40 -0500] holms: coderanger: good evening :)
[2013-11-18 19:18:44 -0500] coderanger: Alo
[2013-11-18 19:19:10 -0500] coderanger: holms: The issue is that chef_fs (and so knife upload/download/diff/chef-zero) don't understand anything but the JSON formats
[2013-11-18 19:19:27 -0500] holms: holms@holms:~/lab$ knife upload /home/holms/lab/roles/logstash-server.json
[2013-11-18 19:19:27 -0500] holms: ERROR: Chef::ChefFS::FileSystem::OperationNotAllowedError: Chef::ChefFS::FileSystem::OperationNotAllowedError
[2013-11-18 19:19:28 -0500] coderanger: jkeiser: and I have talked about fixing it, will probably go in phase two of the dialects patch
[2013-11-18 19:19:45 -0500] coderanger: holms: That should be knife upload /roles/logstash-server.json
[2013-11-18 19:20:21 -0500] holms: huge thanks mate
[2013-11-18 19:22:45 -0500] holms: coderanger: and I want to upload cookbooks with that command?
[2013-11-18 19:22:52 -0500] holms:  knife upload /cookbooks
[2013-11-18 19:22:53 -0500] holms: doesn't work
[2013-11-18 19:23:03 -0500] holms: or atleast it doesn't upload anythiing
[2013-11-18 19:23:14 -0500] holms: ah ok solved
[2013-11-18 19:23:23 -0500] coderanger: holms: It should work :)
[2013-11-18 19:24:40 -0500] holms: forgot to copy new berkshelf file
[2013-11-18 19:24:49 -0500] holms: lol
[2013-11-18 19:24:49 -0500] holms: ERROR: Errno::ENOMEM: Cannot allocate memory - fork(2)
[2013-11-18 19:25:04 -0500] holms: need to increase swap
[2013-11-18 19:25:15 -0500] coderanger: o_O
[2013-11-18 19:25:20 -0500] gleam: swap makes the baby jesus cry
[2013-11-18 19:25:24 -0500] coderanger: Is this on your workstation?
[2013-11-18 19:25:29 -0500] holms: yeah
[2013-11-18 19:25:31 -0500] coderanger: Also yes, swapfiles are a terrible idea on every level
[2013-11-18 19:25:34 -0500] holms: with 32gb of ram
[2013-11-18 19:25:46 -0500] holms: ah no wait
[2013-11-18 19:25:48 -0500] coderanger: But on my travel laptop it is somewhat needed
[2013-11-18 19:25:51 -0500] holms: this is on digital ocean instanse
[2013-11-18 19:26:03 -0500] holms: actually for chef server
[2013-11-18 19:26:13 -0500] holms: i have 512mb ram, and increasing swap helped
[2013-11-18 19:26:16 -0500] holms: it's ssd in there
[2013-11-18 19:26:16 -0500] holms: :)
[2013-11-18 19:27:01 -0500] holms: there were no swap at all..
[2013-11-18 19:27:47 -0500] coderanger: Ahh, half a gig is definitely cutting it close on most modern systems
[2013-11-18 19:27:51 -0500] coderanger: Which is a shame
[2013-11-18 19:28:02 -0500] gleam: not to mention omnibus client seems to want ~190mb for itself when it runs
[2013-11-18 19:28:12 -0500] holms: before swap, it was breaking every time )))
[2013-11-18 19:28:26 -0500] coderanger: gleam: Are you doing a lot of searches?
[2013-11-18 19:28:26 -0500] holms: ofcourse if you haave ssd in there
[2013-11-18 19:28:34 -0500] gleam: lots and lots
[2013-11-18 19:28:44 -0500] holms: omnibus is not in erlang is it..?
[2013-11-18 19:28:57 -0500] coderanger: No
[2013-11-18 19:29:05 -0500] coderanger: Omnibus is just a build system
[2013-11-18 19:29:48 -0500] holms: finally!! 'make update' works
[2013-11-18 19:29:49 -0500] holms: saves my life
[2013-11-18 19:30:08 -0500] holms: uploads everything..
[2013-11-18 19:31:40 -0500] holms: on another machine ive got this =/ :
[2013-11-18 19:31:41 -0500] holms: knife upload cookbooks /cookbooks
[2013-11-18 19:31:41 -0500] holms: ERROR: Attempt to use relative path 'cookbooks' when current directory is outside the repository path
[2013-11-18 19:31:49 -0500] holms: it's not outside!
[2013-11-18 19:33:04 -0500] holms: coderanger: any ideas?
[2013-11-18 19:33:14 -0500] coderanger: holms: Check your knife config
[2013-11-18 19:33:53 -0500] holms: configs are identical
[2013-11-18 19:33:53 -0500] holms: :D
[2013-11-18 19:34:23 -0500] holms: the only thing is that FQDN on one machine is faked
[2013-11-18 19:34:25 -0500] holms: with etc/hosts
[2013-11-18 19:34:30 -0500] holms: allover machines and nodes
[2013-11-18 19:35:44 -0500] holms: coderanger: http://pastie.org/8490530
[2013-11-18 19:35:53 -0500] holms: first one fails
[2013-11-18 19:36:00 -0500] holms: another one works
[2013-11-18 19:36:06 -0500] wtfitsme:  Hello, I have a newbie question: I have a recipe in which I would like to use the package resource to install about a 100 packages. I need to specify the version of each package. Would a data bag which includes each package name and version be appropriate for this task?
[2013-11-18 19:36:58 -0500] coderanger: wtfitsme: Any reason to not do it in a recipe?
[2013-11-18 19:38:08 -0500] holms: k found a problem lol
[2013-11-18 19:38:13 -0500] wtfitsme: Well yes, but seeing that I need to specify the version for each package (and there are about 100) I was hoping to use a block as oppsoed to decalring each package and version.
[2013-11-18 19:38:25 -0500] holms: never give relative path for repo to knife
[2013-11-18 19:39:23 -0500] jbz: wtfitsme: Feed a hash to a loop to build the package resources. Pull the hash out of attributes or databags, whatever, but attributes is probably easier.
[2013-11-18 19:39:36 -0500] stormerider: wtfitsme: so i did this recently, i defined a hash for package => version and just iterated across that.
[2013-11-18 19:40:11 -0500] stormerider: i can gist an example if you need
[2013-11-18 19:40:16 -0500] holms: coderanger: have no clue, using command simply as-is.. gives me this strange error
[2013-11-18 19:40:23 -0500] coderanger: wtfitsme: packages = {name: version, name: version, ...}; packages.each do |name, ver| package name do version ver end end
[2013-11-18 19:40:46 -0500] wtfitsme: Thanks all, that makes sense. Using a hash would be easier. Thanks again!
[2013-11-18 19:41:12 -0500] coderanger: wtfitsme: data bags are handy when you want to do stuff like update from an external system, like a release management tool
[2013-11-18 19:41:31 -0500] coderanger: but if its just self-contained static-ish data then it doesn't get you a ton
[2013-11-18 19:41:55 -0500] wtfitsme: true, it is static data indeed.
[2013-11-18 19:42:33 -0500] stormerider: wtfitsme: https://gist.github.com/stormerider/7534058
[2013-11-18 19:42:33 -0500] coderanger: and putting it in a cookbook gives you much more powerful versioning semantics
[2013-11-18 19:43:35 -0500] wtfitsme: stormerider: coderanger Gracias!
[2013-11-18 19:44:52 -0500] stormerider: de nada :)
[2013-11-18 19:47:09 -0500] dgarstang3: Any idea why there's no link to the github project page? http://community.opscode.com/cookbooks/redis
[2013-11-18 19:47:31 -0500] holms: coderanger: help =/
[2013-11-18 19:47:39 -0500] holms: reinstalled everything on intranet it doesn't work
[2013-11-18 19:47:43 -0500] holms: on Do it works
[2013-11-18 19:52:49 -0500] hsoma: Hi everybody, what changes has to be done to a glassfish cookbook inorder to create a domain and start
[2013-11-18 19:53:09 -0500] holms: hsoma: ask glasshfish cookbook author
[2013-11-18 20:00:08 -0500] hsoma: hallo, can anybody help me with glassfish cookbook
[2013-11-18 20:02:48 -0500] holms: if anybody could help me with this, i'd donate some euros
[2013-11-18 20:02:48 -0500] holms: knife upload cookbooks /cookbooks
[2013-11-18 20:02:48 -0500] holms: ERROR: Attempt to use relative path 'cookbooks' when current directory is outside the repository path
[2013-11-18 20:02:53 -0500] holms: cause it's bullshit
[2013-11-18 20:03:00 -0500] holms: on one machien works, on another not
[2013-11-18 20:03:03 -0500] holms: both ubuntu
[2013-11-18 20:03:08 -0500] holms: both same config
[2013-11-18 20:03:21 -0500] spiffytech: I have a Chef 10 server I'd like to upgrade to Chef 11. All the guides I can see include installing Chef 11 on another machine. Is it possible/advisable to do an in-place upgrade on one machine?
[2013-11-18 20:03:37 -0500] btm_: @opscode chef/ohai code review: join: https://plus.google.com/hangouts/_/76cpi42t99tr34d29k3ofrao5k, watch: http://youtu.be/7QOpIoKytvE
[2013-11-18 20:11:01 -0500] holms: where are the supporters =/
[2013-11-18 20:14:10 -0500] chip-: holms: What's the cookbook_path value in the respective knife.rb files?
[2013-11-18 20:15:32 -0500] holms: chip-: http://pastie.org/8490638
[2013-11-18 20:15:38 -0500] holms: identicall as on another pc
[2013-11-18 20:15:44 -0500] holms: a dir name is identical
[2013-11-18 20:15:48 -0500] holms: on another pc it works =/
[2013-11-18 20:16:15 -0500] chip-: Same dir and knife.rb on both hosts? there's not another .chef/knife.rb anywhere if you recurse down PWD?
[2013-11-18 20:17:40 -0500] josephholsten: coderanger: this usage of embedding a user resource in an application resource is sane, right? https://github.com/jssjr/chef-descartes/blob/master/recipes/default.rb#L54
[2013-11-18 20:18:15 -0500] coderanger: josephholsten: Yeah, should work
[2013-11-18 20:18:41 -0500] holms: chip-: both server tree, and knife.rb and pwd http://pastie.org/8490642
[2013-11-18 20:18:47 -0500] josephholsten: hmm, I'm getting "ERROR: No resource found for user. Tried application_user, application_ruby_user, user" under chef-client 11.8
[2013-11-18 20:18:49 -0500] holms: find 10 differences lol
[2013-11-18 20:18:58 -0500] josephholsten: guess I get to go spelunking!
[2013-11-18 20:20:00 -0500] coderanger: josephholsten: Right, it should find just plain user as a resource
[2013-11-18 20:20:39 -0500] chip-: holms: Line 72? Are the cookbooks actually at /home/ubuntu/lab/cookbooks?
[2013-11-18 20:20:47 -0500] holms: chip-: i deleted them for now
[2013-11-18 20:21:23 -0500] holms: chip-: even if thre's no cookbooks in dir, it should just not produce any erors
[2013-11-18 20:21:55 -0500] holms: le me relaunch the shell
[2013-11-18 20:22:01 -0500] holms: maybe somekind of $PATH crap
[2013-11-18 20:22:43 -0500] holms: nop.. =/
[2013-11-18 20:22:47 -0500] holms: magic..
[2013-11-18 20:23:38 -0500] chip-: The error's telling truth then. If you're trying to upload /home/ubuntu/lab/cookbooks from a PWD of /home/ubuntu/lab and the cookbook_path in knife.rb is /home/holms/lab/cookbooks, you're creating ambiguity because you "Attempt to use relative path 'cookbooks' when current directory is outside the repository path"
[2013-11-18 20:23:49 -0500] chip-: the cookbook_path in knife.rb is significant to this operation.
[2013-11-18 20:23:59 -0500] chip-: If ubuntu has a pwd of /home/holm/lab/cookbooks it'll totally work.
[2013-11-18 20:24:30 -0500] holms: X)X
[2013-11-18 20:24:46 -0500] holms: time to rest..
[2013-11-18 20:24:53 -0500] holms: chip-: fancy a drink?
[2013-11-18 20:25:18 -0500] chip-: I'm taking a week off. Tech conferences last week, my liver can't take it. Thank you though! :)
[2013-11-18 20:25:20 -0500] holms: choose a reward lol
[2013-11-18 20:25:27 -0500] holms: :D
[2013-11-18 20:25:52 -0500] holms: time to stop working after wwork hours =/
[2013-11-18 20:26:01 -0500] chip-: Relax!
[2013-11-18 20:26:04 -0500] holms: stupiddiest mistake i had in a while
[2013-11-18 21:02:43 -0500] btm_: @opscode no cookbook code review today, everyone's busy. /cc @jdeamattson
[2013-11-18 21:12:27 -0500] josephholsten: m3a5ur3d
[2013-11-18 21:13:26 -0500] stormerider: running into a weird issue here: https://gist.github.com/stormerider/7535378 -- it's like chef can't resolve rubygems, but if i wget the file it works perfectly fine. any thoughts?
[2013-11-18 21:14:56 -0500] stormerider: i've never seen something like that before
[2013-11-18 21:14:59 -0500] josephholsten: hmm, I don't like that it's using http instead of https
[2013-11-18 21:16:38 -0500] josephholsten: but the issue is it resolving rubygems.org
[2013-11-18 21:16:44 -0500] stormerider: both work from what i can tell, but i dont think it really matters... it's not really like im transmiting sensitive information asking for a gem
[2013-11-18 21:16:46 -0500] josephholsten: are you running nscd?
[2013-11-18 21:17:04 -0500] josephholsten: you might need to reset a local resolver cache
[2013-11-18 21:17:08 -0500] stormerider: not at that point in the run, no.
[2013-11-18 21:17:29 -0500] stormerider: it hasnt gotten far enough to configure ldap and such
[2013-11-18 21:18:23 -0500] josephholsten: can you shell into the box and open irb?
[2013-11-18 21:18:38 -0500] josephholsten: then run `require 'open-uri'; open('http://rubygems.org/').read`
[2013-11-18 21:19:38 -0500] joe1: Can i make sure i'm not missing something.  I have a cookbook in a repo, but I have to clone it INTO a cloned copy of the chef-repo, then upload the whole thing to the "chef-server" ?
[2013-11-18 21:19:48 -0500] joe1: is there a way to just refer to the cookbook without moving it around manually
[2013-11-18 21:20:03 -0500] joe1: s/a cookbook in a repo/a github repo with a cookbook in it/
[2013-11-18 21:20:06 -0500] josephholsten: stormerider: I'm asking because I know curl uses its own resolver, and wget may as well. I want to verify the behaviour of the resolver used by ruby
[2013-11-18 21:20:28 -0500] josephholsten: joe1: <3
[2013-11-18 21:20:37 -0500] joe1: ?
[2013-11-18 21:20:39 -0500] josephholsten: not exactly
[2013-11-18 21:20:58 -0500] stormerider: josephholsten: that worked fine
[2013-11-18 21:21:08 -0500] josephholsten: joe1: this is a possible goal for chef 12, but definately not today
[2013-11-18 21:21:20 -0500] joe1: because people are now editing the checked-in copy of the cookbook in the chef-repo instead of committing changes to the actual cookbook
[2013-11-18 21:21:46 -0500] josephholsten: yeah, let me point you to a workflow that helps avoid that terribleness
[2013-11-18 21:21:50 -0500] stormerider: and reading http://rubygems.org/latest_specs.4.8.gz gives me binary data
[2013-11-18 21:21:56 -0500] joe1: and now i realize that we may not even be referring to the cookbook repo
[2013-11-18 21:22:02 -0500] joe1: at all
[2013-11-18 21:22:17 -0500] dgarstang3: getting really old. "ArgumentError: You must specify at least one cookbook repo path"
[2013-11-18 21:23:22 -0500] josephholsten: stormerider: can you run chef-client again? can chef talk to rubygems now?
[2013-11-18 21:23:35 -0500] stormerider: nope, still the same error.
[2013-11-18 21:23:48 -0500] josephholsten: joe1: what most folks are doing now is using http://berkshelf.com, along with http://vialstudios.com/guide-authoring-cookbooks.html
[2013-11-18 21:24:34 -0500] dgarstang3: josephholsten: Most people? I've never seen that link before
[2013-11-18 21:24:48 -0500] joe1: so berkshelf clones them for me, then what? I check them in and then copy to server?
[2013-11-18 21:24:57 -0500] josephholsten: dgarstang3: then you haven't even read the docs for berkshelf
[2013-11-18 21:24:59 -0500] joe1: or i guess make berkshelf install and then push and never check it in?
[2013-11-18 21:25:07 -0500] josephholsten: joe1: essentially the idea is: you write a cookbook for each application/service you want internally, and specify its dependencies in the metadata.rb. then use berks to manage deps and upload to your chef server
[2013-11-18 21:25:09 -0500] dgarstang3: josephholsten: oh yes I have
[2013-11-18 21:25:43 -0500] josephholsten: dgarstang3: please look under the section "generating a new cookbook" on berkshelf.com and please stop trolling me while I help people
[2013-11-18 21:26:06 -0500] josephholsten: joe1: then each app/service's cookbook can be in its own git repo.
[2013-11-18 21:26:20 -0500] josephholsten: dgarstang3: <3
[2013-11-18 21:26:33 -0500] stormerider: josephholsten: add them to your ignore list, i did that a long time ago and have not regretted it once
[2013-11-18 21:27:24 -0500] joe1: "Just locate your cookbook and initialize it!" .... ok ... how/what does that do?
[2013-11-18 21:27:45 -0500] josephholsten: ouch. lemme check the context of that
[2013-11-18 21:28:01 -0500] joe1: "They were added to The Berkshelf."
[2013-11-18 21:28:07 -0500] joe1: grrrr ruby thinking
[2013-11-18 21:28:33 -0500] josephholsten: stormerider: oh, wait can you check the earlier thing inside of chef-shell?
[2013-11-18 21:28:46 -0500] stormerider: https://tickets.opscode.com/browse/CHEF-3912 might be what i'm running into josephholsten
[2013-11-18 21:28:58 -0500] josephholsten: eww
[2013-11-18 21:29:41 -0500] josephholsten: joe1: this might be better, I haven't watched it: http://www.youtube.com/watch?v=hYt0E84kYUI
[2013-11-18 21:29:50 -0500] josephholsten: I'm digging into the docs right now
[2013-11-18 21:30:18 -0500] dgarstang3: joe1: why not use a package for mysql?
[2013-11-18 21:31:27 -0500] joe1: http://vialstudios.com/guide-authoring-cookbooks.html seems highly focused on linux / vagrant but im not using those tools
[2013-11-18 21:32:56 -0500] joe1: and seems to be based on moving tgz's of the cookbooks around
[2013-11-18 21:32:58 -0500] joe1: is that right?
[2013-11-18 21:33:57 -0500] josephholsten: oh, that's for applications
[2013-11-18 21:34:18 -0500] josephholsten: like internally developed ones.
[2013-11-18 21:37:04 -0500] josephholsten: for things like mysql or however you're using externally developed applications, this is a better doc: http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-11-18 21:37:31 -0500] joe1: its not the writing as much as the "getting chef to get the pieces without me hand-assembling them"
[2013-11-18 21:38:29 -0500] josephholsten: well, you could use chef-solo and git submodules I guess
[2013-11-18 21:38:43 -0500] joe1: im not using mysql not sure why that came up
[2013-11-18 21:39:29 -0500] josephholsten: oh, sorry. I misread that message earlier
[2013-11-18 21:40:17 -0500] josephholsten: so let's begin again. what's a community cookbook you're using?
[2013-11-18 21:40:50 -0500] josephholsten: also, what tools are you comfortable using? sounds like windows?
[2013-11-18 21:40:56 -0500] joe1: iis, chocolatey, webpi, windows, for example
[2013-11-18 21:41:03 -0500] joe1: are in our chef-repo cookbooks/ dir
[2013-11-18 21:41:07 -0500] joe1: i think that's a bad/stupid place for them
[2013-11-18 21:41:14 -0500] joe1: would like to just refer to them
[2013-11-18 21:41:38 -0500] joe1: but then I dont know how to make it work with chef-server without a bunch of cloning & copying up to server
[2013-11-18 21:41:46 -0500] josephholsten: ooh, we've definately been having trouble getting chocolatey to work out of the box with bootstrap
[2013-11-18 21:41:55 -0500] joe1: i am comfortable using a lot of tools. I "have" to use windows here
[2013-11-18 21:42:01 -0500] josephholsten: gotcha
[2013-11-18 21:42:32 -0500] josephholsten: so what we do is we have a 'master' Berksfile at the base of our chef-repo
[2013-11-18 21:42:45 -0500] joe1: i am also writing a cookbook just to corral the few tasks needed to get our compile slaves setup
[2013-11-18 21:43:01 -0500] joe1: so I am trying to put that in its own github repo
[2013-11-18 21:43:45 -0500] joe1: the page you just linked said not to use roles, but people here have been telling me to use roles
[2013-11-18 21:44:03 -0500] joe1: i am not sure if I understand why he's saying not to use them - they're not versioned? what? then what have I been checking into git?
[2013-11-18 21:44:34 -0500] josephholsten: joe1: yes. I'm so sorry. we have some differing factions who are trying to work those things out
[2013-11-18 21:45:02 -0500] josephholsten: within that master berksfile, I have it pull in all our internal application cookbooks which we store in cookbooks/
[2013-11-18 21:45:24 -0500] joe1: wait, why do you store them if it pulls them in
[2013-11-18 21:45:40 -0500] joe1: i want to eliminate storage of upstream cookbooks
[2013-11-18 21:45:59 -0500] josephholsten: then we upload all the cookbooks from our master berksfile, plus all the dependended upon cookbooks, by running `berks upload`
[2013-11-18 21:46:30 -0500] josephholsten: we use cookbook/ just for *internally developed* cookbooks. someday we'd like to move them out into seperate repos, but we're not there yet
[2013-11-18 21:46:49 -0500] dgarstang3: joe1: one repo per cookbook works well, for us
[2013-11-18 21:46:56 -0500] joe1: ok wait. i thought the job of berkshelf was to put things into the "cookbooks" dir from other sources
[2013-11-18 21:47:02 -0500] joe1: then you "knife upload" to copy that dir to the server
[2013-11-18 21:47:19 -0500] josephholsten: joe1: that's the approach used by another tool, librarian-chef
[2013-11-18 21:47:21 -0500] joe1: so where is it getting them from if they're stored already where it would be putting them?
[2013-11-18 21:47:51 -0500] josephholsten: all *externally developed* cookbooks are mentioned in the master berksfile, which keeps a local cache of those referenced cookbooks, and uploads the required ones with `berks upload`
[2013-11-18 21:47:55 -0500] joe1: ok lets not introduce new tools. can you just say what berkshelf is "supposed" to do
[2013-11-18 21:48:11 -0500] dgarstang3: joe1: There's lots of tools. :)
[2013-11-18 21:48:35 -0500] josephholsten: joe1: yes, ignore that tool
[2013-11-18 21:48:36 -0500] coderanger: joe1: berkshelf is a package manager where the packages are cookbooks
[2013-11-18 21:48:54 -0500] joe1: ok. where does it get cookbooks and where does it install them
[2013-11-18 21:49:09 -0500] josephholsten: joe1: did you look at that berksfile link I sent you?
[2013-11-18 21:49:19 -0500] coderanger: joe1: It gets them from the opscode community site (right now)
[2013-11-18 21:49:20 -0500] joe1: i looked at http://berkshelf.com/
[2013-11-18 21:49:31 -0500] coderanger: and it installs them either locally for chef-solo or to your chef-server
[2013-11-18 21:49:32 -0500] joe1: but its light on the understanding and heavy on the copy-and-paste
[2013-11-18 21:49:47 -0500] joe1: so it doesnt mutate my chef-repo working dir?
[2013-11-18 21:49:54 -0500] coderanger: Indeed, it doesn't
[2013-11-18 21:50:05 -0500] josephholsten: joe1: I just sent you a /msg
[2013-11-18 21:50:09 -0500] josephholsten: can you see that?
[2013-11-18 21:50:14 -0500] coderanger: Well, it writes out Berksfile.lock, does that count? ;-)
[2013-11-18 21:56:21 -0500] freezey: has anyone had a reindex not reindex the data?
[2013-11-18 21:58:18 -0500] pabst^: don't realize how crappy you write your cookbooks until you start doing testing :P
[2013-11-18 22:00:52 -0500] josephholsten: pabst^: so much this
[2013-11-18 22:01:40 -0500] gchristensen: pabst^: we'll get you there :)
[2013-11-18 22:03:57 -0500] pabst^: gchristensen: you've been a great help so far :)
[2013-11-18 22:10:29 -0500] joe1: what if I refer to a cookbook who doesn't have a metadata.rb ? I guess the dependency chain breaks at that point?
[2013-11-18 22:10:39 -0500] joe1: is it widely known to setup metadata.rb ?
[2013-11-18 22:10:53 -0500] joe1: in other words should I expect every cookbook I use to properly set it thus work with berkshelf
[2013-11-18 22:11:03 -0500] chip-: Every cookbook should have a well-formed metadata.rb
[2013-11-18 22:12:09 -0500] dgarstang3: Is berkshelf supposed to resolve depandant cookbooks dependancies?
[2013-11-18 22:12:34 -0500] joe1: if it doesnt I dont see how it isn't a pain in the ass to do manually
[2013-11-18 22:13:35 -0500] dgarstang3: I have bc-rsyslog. It has bc-lvm in It's Berkfile. bc-lvm uses bc-ohai and says to get it from git. However, bc-rsyslog is downloading bc-ohai from our chef server which IS NOT what I said to do
[2013-11-18 22:13:38 -0500] joe1: so do you have to include the "metadata" keyword in the berksfile to do that?
[2013-11-18 22:13:44 -0500] joe1: wtf now im confused
[2013-11-18 22:13:54 -0500] joe1: because berksfiles dont go in cookbooks
[2013-11-18 22:13:59 -0500] joe1: they go in chef-repos
[2013-11-18 22:14:31 -0500] bugoff: 22
[2013-11-18 22:17:08 -0500] garrett__: how are people handling key management for encrypted databag keys?
[2013-11-18 22:17:33 -0500] gchristensen: garrett__: I drop the encrypted data bag key on every server when its provisioned :?
[2013-11-18 22:17:38 -0500] garrett__: i'm thinking of building a one-time-pad system which will allow bootstrapped nodes to pull down the ones they need
[2013-11-18 22:17:53 -0500] gchristensen: that sounds like a cool idea
[2013-11-18 22:18:10 -0500] garrett__: yeah, i'm just trying to avoid as much manual intervention as possible
[2013-11-18 22:18:33 -0500] garrett__: but a little ssh wrapper to fetch/push the necessary keys might be easier
[2013-11-18 22:19:09 -0500] magoo: i have a service command that essentially runs "ubic status service_name". If run as any other user than root, it'll report the cached status which isn't necessarily accurate. My chef-client is already run as sudo so why isn't it executing as root?
[2013-11-18 22:19:28 -0500] zts: joe1: you may want to watch "The Berkshelf Way" session from the last ChefConf, which explains the workflow/organisation that Berkshelf was built to implement - http://www.youtube.com/watch?v=hYt0E84kYUI
[2013-11-18 22:19:38 -0500] magoo: to fix it, i made the status command "sudo ubic status service_name". it works but it seems silly
[2013-11-18 22:20:16 -0500] magoo: is there a better solution?
[2013-11-18 22:21:07 -0500] joe1: i would love to find some documentation I dont have to "sit through" :)
[2013-11-18 22:21:30 -0500] joe1: also that link gives me error 500 !
[2013-11-18 22:21:55 -0500] gchristensen: joe1: I agreed, but also found that video to be really helpful to hear someone say it
[2013-11-18 22:23:33 -0500] zts: Yup, I'm no fan of podcasts and screencasts and the like.  But the berkshelf docs today are what they are (more useful once you already know what they're on about).  That session is probably the quickest way of getting up to speed with it, and it is worth the time
[2013-11-18 22:23:47 -0500] zts: no good if it's giving you an error, though (but it works for me)
[2013-11-18 22:24:21 -0500] dgarstang3: I have bc-rsyslog. It has bc-lvm in It's Berkfile. bc-lvm uses bc-ohai and says to get it from git. However, bc-rsyslog is downloading bc-ohai from our chef server which IS NOT what I said to do
[2013-11-18 22:26:49 -0500] joe1: the metadata.rb can have multiple "depends" lines? or it's list valued?
[2013-11-18 22:27:15 -0500] chip-: multiple are okay.
[2013-11-18 22:27:19 -0500] joe1: http://docs.opscode.com/essentials_cookbook_metadata.html doesn't really explain how to do multiple
[2013-11-18 22:27:30 -0500] joe1: (and no examples as is par)
[2013-11-18 22:27:49 -0500] zts: dgarstang3: today, I believe the only way to sort that out is to duplicate the relevant line from bc-lvm's Berksfile in bc-rsyslog's (yeah, I know).  I believe sorting this out is a goal of Berkshelf 3
[2013-11-18 22:28:18 -0500] chip-: joe1: If you feel the docs are lacking in a specific way, tweet @chefdocs. They're really into feedback there.
[2013-11-18 22:28:30 -0500] joe1: nor does it explain how to get them from git.
[2013-11-18 22:28:49 -0500] joe1: probably wont be tweeting :) sorry not a twitter person
[2013-11-18 22:28:58 -0500] josephholsten: joe1: you can't explicitly say they should come from git in a metadata.rb
[2013-11-18 22:29:10 -0500] joe1: oh. then how do I refer to my cookbooks on git?
[2013-11-18 22:29:18 -0500] dgarstang3: zts: hi... so i'm not crazy? it doesn't follow the dependancy chain? people said it does....
[2013-11-18 22:29:32 -0500] josephholsten: as far as chef-client is concerned, it just needs the name and version, and gets the cookbook from the chef-server
[2013-11-18 22:30:03 -0500] joe1: so we're back to cloning and uploading by hand ?
[2013-11-18 22:30:13 -0500] josephholsten: berkshelf understands getting cookbooks from git, and will upload it to your chef-server
[2013-11-18 22:30:14 -0500] zts: dgarstang3: nah, you're not crazy - it sort of does.  It will recurse, but it's only through metadata.rb at that point - and anything it finds will be resolved against your chef server or the community cookbook site, depending on your config
[2013-11-18 22:30:15 -0500] joe1: or cloning then running berkshelf install?
[2013-11-18 22:31:11 -0500] flaccid__: so anyone know how to get an ohai plugin to reload so it scrapes the system for data again i.e. hostname change?
[2013-11-18 22:31:18 -0500] dgarstang3: zts: yah I've noticed. It's been causing some issues because it's been pulling off the server which is not up to date. That raises the next question... where are people putting deps? git or chef server?
[2013-11-18 22:32:50 -0500] joe1: i am really confused. I just want my cookbook to be pulled from git.
[2013-11-18 22:32:54 -0500] joe1: http://berkshelf.com/#the_berksfile shows git references
[2013-11-18 22:33:27 -0500] joe1: but it also shows use of the "metadata" keyword, which, below, is explained in a way that implies that is a berksfile that should be in a Cookbook
[2013-11-18 22:33:55 -0500] joe1: but I am not in a cookbook. I am in my chef-repo. should I presume it still works?
[2013-11-18 22:34:11 -0500] dgarstang3: Where are people putting berkshelf dependant cookbooks? (ie locall written ones). git or chef server?
[2013-11-18 22:34:15 -0500] zts: dgarstang3: for me personally, it's all git (I'm using chef-solo almost exclusively at the moment) - I have the impression that the Riot Games folks use the chef server for the job though
[2013-11-18 22:34:56 -0500] garrett__: flaccid__: notifies :reload, "ohai[reload]", :immediately?
[2013-11-18 22:35:05 -0500] segv: so guys, quick Q, role names, how do you guys determine role name?
[2013-11-18 22:35:23 -0500] segv: I mean obviously there is 'app_name' or  primary role for the host
[2013-11-18 22:35:27 -0500] garrett__: flaccid__: http://docs.opscode.com/resource_ohai.html
[2013-11-18 22:35:35 -0500] segv: Not getting any good public repos idealogy
[2013-11-18 22:35:40 -0500] segv: for a standard naming convention
[2013-11-18 22:35:43 -0500] coderanger: segv: web, db, ci, lb
[2013-11-18 22:36:10 -0500] dgarstang3: zts: kk. git for me too...
[2013-11-18 22:36:12 -0500] garrett__: segv: i try to make my roles the smallest common subsets to a group of servers
[2013-11-18 22:36:12 -0500] freezey: anyone know howto take a backup of the solr data in chef 11?
[2013-11-18 22:36:40 -0500] garrett__: segv: so 'web' 'db' 'logclient' 'logserver', etc.
[2013-11-18 22:36:50 -0500] dgarstang3: zts: for me, it seems dangerous to upload to the chef server before tested, where if someone does a chef-client run, it's gonna pick up the change. If git is used instead, that won't happen
[2013-11-18 22:37:02 -0500] flaccid__: garrett__: reload doesn't actually reload https://tickets.opscode.com/browse/OHAI-389
[2013-11-18 22:37:36 -0500] josephholsten: segv: for an app named "diesel": diesel (app server), diesel-solr, diesel-cache (memcache), diesel-redis, diesel-db (mysql)
[2013-11-18 22:37:46 -0500] zts: dgarstang3: yup, the sophisticated workflow would have continuous integration running tests on your cookbooks, then pushing (and freezing) a new version to the Chef server.  You can have cookbook version constraints in your environments, so you can make sure that the new versions don't get rolled out until you're ready
[2013-11-18 22:38:05 -0500] zts: there's obviously a bunch of work to get to that point though
[2013-11-18 22:38:11 -0500] josephholsten: segv: note we use dashes for role names so they map directly to hostnames (our cookbooks use underscores)
[2013-11-18 22:38:20 -0500] segv: josephholsten: got it
[2013-11-18 22:38:36 -0500] garrett__: flaccid__: hm. well, that's a pain.
[2013-11-18 22:39:05 -0500] josephholsten: and I've got a script called `mkbox` that I just give a role and an environment and it builds me a box with the right instance size, hostname, run list, &c
[2013-11-18 22:40:08 -0500] josephholsten: zts: you're right about riot using chef for prod, but they use chef-solo for dev/local-test
[2013-11-18 22:44:11 -0500] jbz: :q!
[2013-11-18 22:44:15 -0500] jbz: heh
[2013-11-18 22:48:10 -0500] bigoldrock: is there a way to do a knife "test run" so you can see what the end result would be without having to run it for real?
[2013-11-18 22:48:23 -0500] chip-: chef-client --why-run
[2013-11-18 22:48:41 -0500] chip-: Caveat: http://blog.afistfulofservers.net/post/2012/12/21/promises-lies-and-dryrun-mode/
[2013-11-18 22:48:45 -0500] bigoldrock: thanks
[2013-11-18 22:58:47 -0500] Tuatara: Hi... Berkshelf questions welcome here or is there another channel for Berkshelf?
[2013-11-18 23:02:00 -0500] justizin: Tuatara: there is a berkshelf chan, you probs can also ask here
[2013-11-18 23:10:41 -0500] phutchins: hi
[2013-11-18 23:10:50 -0500] phutchins: anyone know about errors involving utf-8?
[2013-11-18 23:11:13 -0500] phutchins: Getting this: ERROR: "\x8B" from ASCII-8BIT to UTF-8
[2013-11-18 23:11:22 -0500] phutchins: and searching turns up nothign that has helped...
[2013-11-18 23:11:34 -0500] coderanger: phutchins: From what?
[2013-11-18 23:12:08 -0500] phutchins: from a chef-client run on a node that has just registered itself with the chef server. It has an empty runlist
[2013-11-18 23:12:15 -0500] phutchins: i've manually added the client.rb
[2013-11-18 23:12:22 -0500] phutchins: and the validation.pem to the node
[2013-11-18 23:12:26 -0500] coderanger: Does it have unicode in its FQDN?
[2013-11-18 23:12:27 -0500] phutchins: and run chef-client after an omnibus install
[2013-11-18 23:12:48 -0500] phutchins: could it be that the fqdn is not set?
[2013-11-18 23:12:55 -0500] coderanger: run hostname -f
[2013-11-18 23:12:57 -0500] coderanger: what do you see
[2013-11-18 23:13:07 -0500] phutchins: one sec
[2013-11-18 23:13:12 -0500] phutchins: lost connection to the node
[2013-11-18 23:13:30 -0500] phutchins: redis1.localdomain
[2013-11-18 23:13:32 -0500] phutchins: ^ fqdn
[2013-11-18 23:13:37 -0500] coderanger: Okay, seems sane
[2013-11-18 23:13:41 -0500] phutchins: yeah
[2013-11-18 23:13:44 -0500] coderanger: Can you please pastebin the full traceback
[2013-11-18 23:13:48 -0500] phutchins: i changed it a few times to make sure
[2013-11-18 23:13:55 -0500] phutchins: yeah will do, thanks for helping :)
[2013-11-18 23:13:56 -0500] phutchins: one sec...
[2013-11-18 23:14:43 -0500] phutchins: http://pastebin.com/U13kiE2t
[2013-11-18 23:15:38 -0500] phutchins: i've compared file types with another node that works fine. they are both us-ascii
[2013-11-18 23:16:00 -0500] gkarekinian: The real stacktrace is in /var/chef/cache/chef-stacktrace.out
[2013-11-18 23:16:33 -0500] coderanger: Yahr, ^^
[2013-11-18 23:16:46 -0500] phutchins: http://pastebin.com/PjkaH2h2
[2013-11-18 23:18:26 -0500] coderanger: phutchins: Might be something in the ohai data
[2013-11-18 23:18:37 -0500] phutchins: hum
[2013-11-18 23:18:42 -0500] coderanger: phutchins: You can run ohai from the command line and see what it spits out
[2013-11-18 23:18:44 -0500] phutchins: ok let me see if i cn
[2013-11-18 23:18:45 -0500] phutchins: yeah
[2013-11-18 23:18:51 -0500] phutchins: maybei can run it through utf8 filter
[2013-11-18 23:18:55 -0500] phutchins: or woudl it show utf8 characters
[2013-11-18 23:18:58 -0500] coderanger: It shouldn't be trying to transcode to ascii though
[2013-11-18 23:19:33 -0500] coderanger: Oh, I see, its just a garbage byte that doesn't map to utf
[2013-11-18 23:19:51 -0500] phutchins: userdata
[2013-11-18 23:19:59 -0500] phutchins: looks like crap
[2013-11-18 23:20:04 -0500] phutchins: so the node has chef-solo on it already
[2013-11-18 23:20:37 -0500] phutchins: i'm writing a cookbook where chef-solo will install chef-client and run chef-client after chef-solo
[2013-11-18 23:20:56 -0500] coderanger: Why would you do that?
[2013-11-18 23:21:01 -0500] phutchins: because aws :)
[2013-11-18 23:21:17 -0500] holms: phutchins: https://github.com/holms/chef-starter/
[2013-11-18 23:21:20 -0500] coderanger: Is this for baked AMI bootstrapping?
[2013-11-18 23:21:27 -0500] phutchins: so i need solo for the opsworks stuff
[2013-11-18 23:21:29 -0500] phutchins: yeah
[2013-11-18 23:21:33 -0500] phutchins: chef-solo is baked in
[2013-11-18 23:21:36 -0500] phutchins: and runs the opsworks stuff
[2013-11-18 23:21:47 -0500] coderanger: phutchins: opsworks + chef-client is probably going to go really poorly
[2013-11-18 23:21:47 -0500] phutchins: then i want to kick in our recipes from our chef server after the solo run has completed
[2013-11-18 23:21:50 -0500] phutchins: holms: looking
[2013-11-18 23:21:56 -0500] coderanger: Pick one system and use it
[2013-11-18 23:22:12 -0500] phutchins: coderanger: can't...
[2013-11-18 23:22:20 -0500] holms: phutchins: make install, setups chef-server, make install_workstation will setup chef client
[2013-11-18 23:22:21 -0500] phutchins: and someone mentioned that they've done it successfully
[2013-11-18 23:22:35 -0500] holms: phutchins: make install, actually does everything till the end
[2013-11-18 23:23:10 -0500] phutchins: holms: not quite sure this is what i'm looking for
[2013-11-18 23:23:10 -0500] coderanger: phutchins: http://xkcd.com/1170/
[2013-11-18 23:23:54 -0500] phutchins: coderanger: lol
[2013-11-18 23:23:59 -0500] phutchins: oddly i actually worked at cnn :)
[2013-11-18 23:24:37 -0500] phutchins: so i don't care if the other guy was doing it really. i was doing this before I found that someone else was doing it as well :)
[2013-11-18 23:24:52 -0500] phutchins: are there any specific reasons that you think this would be a good idea?
[2013-11-18 23:24:56 -0500] gkarekinian: If you're using OpsWorks just for boostrapping chef-client you probably just want to use OpsWorks
[2013-11-18 23:25:03 -0500] gkarekinian: Oops
[2013-11-18 23:25:08 -0500] gkarekinian: s/just/don't/
[2013-11-18 23:25:19 -0500] phutchins: we need the functions of opsworks
[2013-11-18 23:25:22 -0500] phutchins: that only come from chef-solo
[2013-11-18 23:25:27 -0500] phutchins: so thats not going to work.
[2013-11-18 23:25:43 -0500] gkarekinian: Then don't use chef server at all if you use OpsWorks
[2013-11-18 23:26:01 -0500] phutchins: well i want other things that I need chef-client for
[2013-11-18 23:26:09 -0500] coderanger: phutchins: That I think it would be a good idea?
[2013-11-18 23:26:10 -0500] phutchins: i've heard no good rasons for not doing this yet :)
[2013-11-18 23:26:25 -0500] coderanger: There are like 2 or 3 reasons it is a good idea, and then like a million that make it a terrible idea
[2013-11-18 23:26:40 -0500] phutchins: ok so lets name a few that make it bad
[2013-11-18 23:26:48 -0500] phutchins: i know its dirty :)
[2013-11-18 23:26:55 -0500] phutchins: but technically... why?
[2013-11-18 23:26:56 -0500] coderanger: 1) they will stomp on each others runtime files (cache, backups, etc)
[2013-11-18 23:27:01 -0500] coderanger: 2) Lots of moving pieces
[2013-11-18 23:27:04 -0500] coderanger: 3) Redunant
[2013-11-18 23:27:12 -0500] phutchins: i accept 1
[2013-11-18 23:27:12 -0500] coderanger: 4) No single point of truth
[2013-11-18 23:27:14 -0500] phutchins: but not the others
[2013-11-18 23:27:15 -0500] gkarekinian: It will break horribly
[2013-11-18 23:27:18 -0500] phutchins: :)
[2013-11-18 23:27:26 -0500] coderanger: 5) Version mismatch between chef runs
[2013-11-18 23:27:31 -0500] gkarekinian: And everyone who even touches the stuff will become insane
[2013-11-18 23:27:50 -0500] phutchins: :)
[2013-11-18 23:27:57 -0500] phutchins: ok so alternatives...
[2013-11-18 23:28:11 -0500] phutchins: i'm wondering if theres a way to run the solo stuff through chef-client
[2013-11-18 23:28:15 -0500] phutchins: or vice versa
[2013-11-18 23:28:21 -0500] coderanger: Alternative is to just bake an AMI with the omnibus chef-client already installed, and with your validation cert
[2013-11-18 23:28:26 -0500] coderanger: and just forget opsworks exists
[2013-11-18 23:28:49 -0500] phutchins: I need to find out how opsworks uses chef to configure its nodes for scaling...
[2013-11-18 23:28:55 -0500] phutchins: becuase that is the piece that I have to keep
[2013-11-18 23:28:56 -0500] gkarekinian: You should explain what you're trying to do with OpsWorks, and also with chef-client
[2013-11-18 23:29:12 -0500] coderanger: phutchins: opsworks is just using ASGs
[2013-11-18 23:29:13 -0500] phutchins: ok so we're moving from engine yard to opsworks for our rails app
[2013-11-18 23:29:51 -0500] gkarekinian: To me OpsWorks is chef-solo with inter-node communication for orchestration, it's meant to be used without a Chef server
[2013-11-18 23:30:19 -0500] phutchins: with the requirement of 1) engine yard is horrid 2) enable autoscaling
[2013-11-18 23:30:22 -0500] jtimberman: phutchins: so, several months ago, I did exactly this: install chef-client with opsworks lifecycle stuff, and then let chef-client take over all the things i actually cared about.
[2013-11-18 23:30:42 -0500] phutchins: jtimberman: so how did the scaling stuff work after that?
[2013-11-18 23:30:48 -0500] jtimberman: i didn't do anything with scaling stuff.
[2013-11-18 23:30:51 -0500] phutchins: ah
[2013-11-18 23:31:28 -0500] coderanger: phutchins: Again, its just auto-scaling groups
[2013-11-18 23:31:34 -0500] phutchins: i have yet to actually play with or dig into the asg stuff
[2013-11-18 23:32:03 -0500] phutchins: coderanger: i'm not too familiar. im looking for some reading on how aws implements asg's
[2013-11-18 23:32:06 -0500] coderanger: Given that you stated autoscaling as 50% of your requirements, I would probably start there
[2013-11-18 23:32:21 -0500] phutchins: yeah.
[2013-11-18 23:32:24 -0500] phutchins: sounds reasonable.
[2013-11-18 23:32:36 -0500] pabst^: So when I am doing integration testing with test-kitchen and chef-zero, and the cookbook I am testing includes recipes from other cookbooks, should I just check those cookbooks out into ./test/integration/default/cookbooks ?
[2013-11-18 23:32:54 -0500] coderanger: phutchins: Basically ASGs are just you give it an AMI and set some threholds
[2013-11-18 23:33:06 -0500] coderanger: and it boots instances as needed based on basic metrics
[2013-11-18 23:33:09 -0500] coderanger: (super basic though)
[2013-11-18 23:33:39 -0500] phutchins: right
[2013-11-18 23:34:21 -0500] phutchins: so the chef-solo part is only used for initial setup of the node? then whatever aws installed is used to manage? or is chef-solo actually still used afterwards
[2013-11-18 23:34:34 -0500] coderanger: For what
[2013-11-18 23:34:36 -0500] coderanger: ASGs?
[2013-11-18 23:34:57 -0500] phutchins: yeah
[2013-11-18 23:35:01 -0500] coderanger: There is no chef-solo
[2013-11-18 23:35:04 -0500] coderanger: or anything else
[2013-11-18 23:35:10 -0500] coderanger: all it does is boot the instance
[2013-11-18 23:35:22 -0500] coderanger: You have to setup the initializer script/userdata to do what you want
[2013-11-18 23:35:36 -0500] coderanger: which is generally something like chef-client -j whatever.json
[2013-11-18 23:35:49 -0500] phutchins: ah gotcha
[2013-11-18 23:36:30 -0500] phutchins: let me go look at aws opsworks a bit more in depth
[2013-11-18 23:36:41 -0500] coderanger: opsworks is basically just ASGs + chef-solo
[2013-11-18 23:36:43 -0500] phutchins: i was under the impression that solo was used in the scalign configuration
[2013-11-18 23:36:46 -0500] phutchins: right
[2013-11-18 23:37:11 -0500] coderanger: but if your goal isn't to use chef-solo then opsworks isn't what you want
[2013-11-18 23:37:12 -0500] phutchins: but from my understanding, it has awareness of the other nodes and uses chef-solo to update configurations between them
[2013-11-18 23:37:39 -0500] coderanger: Minimally, they expose some EC2 API info
[2013-11-18 23:37:53 -0500] phutchins: well my most important goal is to use autoscaling.
[2013-11-18 23:39:19 -0500] phutchins: i guess i could do something more like write a cookbook that would be used in chef-solo that does what i need
[2013-11-18 23:39:23 -0500] coderanger: Then, as I said, go read the ASG docs
[2013-11-18 23:39:27 -0500] phutchins: and could pull it from my chef server
[2013-11-18 23:39:33 -0500] phutchins: or the git repo rather
[2013-11-18 23:40:29 -0500] phutchins: on a side note, this look useful to anyone? https://github.com/phutchins/kickit
[2013-11-18 23:40:48 -0500] coderanger: phutchins: Given the existence of Pushy, less so
[2013-11-18 23:40:55 -0500] phutchins: ah
[2013-11-18 23:40:56 -0500] coderanger: phutchins: (also mcollective and salt)
[2013-11-18 23:40:56 -0500] phutchins: hah
[2013-11-18 23:41:26 -0500] phutchins: in regards to kickit?
[2013-11-18 23:41:34 -0500] coderanger: Indeed
[2013-11-18 23:41:37 -0500] phutchins: mcollective is much larger
[2013-11-18 23:41:42 -0500] phutchins: and not nearly the same thing
[2013-11-18 23:41:50 -0500] phutchins: mcollective have that function in it?
[2013-11-18 23:41:59 -0500] phutchins: not heard of pushy
[2013-11-18 23:42:04 -0500] coderanger: Sure, but its a superset and probably more useful for production systems
[2013-11-18 23:42:31 -0500] coderanger: pushy is the Opscode version of mcollective and/or the salt runner
[2013-11-18 23:43:17 -0500] coderanger: Given that it mentions OS X I'm guessing you intend this for dev though
[2013-11-18 23:43:18 -0500] phutchins: and yeah pushy looks like the same.
[2013-11-18 23:43:24 -0500] phutchins: i dont want all the other funcitons of either of those
[2013-11-18 23:43:25 -0500] phutchins: personally...
[2013-11-18 23:43:28 -0500] phutchins: so those dont' fit
[2013-11-18 23:43:41 -0500] phutchins: but thanks for pointing those out
[2013-11-18 23:43:43 -0500] coderanger: Um, thats like the worst reason to write software
[2013-11-18 23:43:51 -0500] phutchins: because i need someting? lol
[2013-11-18 23:44:06 -0500] coderanger: Because you want to rationalize away all existing tools as "too complex"
[2013-11-18 23:44:25 -0500] phutchins: well first of all i didn't reallyze that funciotn exited in either of those
[2013-11-18 23:44:38 -0500] phutchins: and yes, its like installing microsoft office vs text editor
[2013-11-18 23:44:54 -0500] phutchins: if i don't need office, there is a huge reason not to install it and use text editor
[2013-11-18 23:44:57 -0500] coderanger: The general class of orchestration tools is quite big
[2013-11-18 23:45:01 -0500] phutchins: same situation
[2013-11-18 23:45:14 -0500] coderanger: Sure, but don't write your own text editor because you don't like Word ;-)
[2013-11-18 23:45:31 -0500] phutchins: :)
[2013-11-18 23:45:34 -0500] phutchins: i like word jsut fine
[2013-11-18 23:45:41 -0500] phutchins: i just didn't want to install it on all my windows boxes :)
[2013-11-18 23:46:38 -0500] dgarstang3: ya chuggin' along with chef, thinking everything is making sense until it comes to a screeching halt. I was trying to make sure my cookbooks has as few deps as possible, which means the Vagrant run list just has role_foo, where role_foo contains the recipe without a base role. Well, this particular recipe needs extra packages, so bc-apt is required. Where do I put that tho? do I do an include_recipe "bc-apt"?
[2013-11-18 23:46:40 -0500] dgarstang3: that seems crappy. Do I put it in the role?
[2013-11-18 23:46:56 -0500] coderanger: phutchins: rundeck + winrm is also handy for windows
[2013-11-18 23:47:14 -0500] phutchins: coderanger: i don't use windows... just making a metaphor :)
[2013-11-18 23:47:40 -0500] coderanger: phutchins: Your metaphor still fails because starting a new project is still way out of scope for it
[2013-11-18 23:48:17 -0500] phutchins: coderanger: i think its completely in scope. I had a small job to be done. i created a small project to solve the problem.
[2013-11-18 23:48:23 -0500] phutchins: it was a very small investment of time
[2013-11-18 23:48:39 -0500] phutchins: not to mention I wasn't aware that there was a solution existing out there regardless
[2013-11-18 23:48:45 -0500] phutchins: none turned up in my searches...
[2013-11-18 23:49:20 -0500] phutchins: and no reason to get down on someone for trying to contribute to the community don't you think :)
[2013-11-18 23:49:36 -0500] phutchins: if nothing else it was a fun excercise...
[2013-11-18 23:49:39 -0500] coderanger: phutchins: Okay, slightly better reason, this is a flaming security issue and running it in prod will more or less immediately corrupt your servers
[2013-11-18 23:49:57 -0500] coderanger: since nothing stops this from killing chef-client in the middle of dangerous ops
[2013-11-18 23:50:14 -0500] coderanger: and it has no auth, so random port scanners will set it off
[2013-11-18 23:50:24 -0500] phutchins: coderanger: it own't kill a chef run. its running as a daemon and sents it command to start
[2013-11-18 23:50:27 -0500] phutchins: doesn't stop or kill it
[2013-11-18 23:50:41 -0500] phutchins: adn it would/should be locked down via firewall rules or vpn anywho
[2013-11-18 23:50:53 -0500] phutchins: that should be obvious
[2013-11-18 23:51:43 -0500] phutchins: i would like to embed some authentication tho
[2013-11-18 23:51:44 -0500] coderanger: Its your funeral ;-)
[2013-11-18 23:52:01 -0500] phutchins: hah strong punishment for an attempt at contribution :)
[2013-11-18 23:52:06 -0500] phutchins: this channels feelign a bit harsh tonight...
[2013-11-18 23:52:16 -0500] phutchins: not the communtiy i'm used to surrounding chef
[2013-11-18 23:52:59 -0500] coderanger: phutchins: I think you underestimate the depth of badness that comes from having `sudo killall ...` in something publically accessible
[2013-11-18 23:53:36 -0500] coderanger: This is not a situation where "I'll just make a little thing" is a good idea
[2013-11-18 23:53:45 -0500] phutchins: coderanger: i do not underestimate that, only would have expected constructive feedbac..
[2013-11-18 23:54:02 -0500] coderanger: My feedback is use rundeck or mcollective :)
[2013-11-18 23:54:08 -0500] phutchins: i found that hint for getting the chef-client service to start on an opscode doc
[2013-11-18 23:54:18 -0500] phutchins: so i guess we should not trust the opscode documentation...
[2013-11-18 23:54:20 -0500] coderanger: because they are quite well documented tools and do what you need
[2013-11-18 23:54:45 -0500] coderanger: Okay, lets rewind, an admin running those commands is fine
[2013-11-18 23:55:12 -0500] coderanger: thats different than 1) granting sudo access to a service account for /usr/bin/killall or 2) putting a service wrapper on that
[2013-11-18 23:56:24 -0500] coderanger: Lets say ruby has a code exec vuln somewhere
[2013-11-18 23:56:41 -0500] coderanger: Now the attack escalation path jumps directly to "can kill all processes"
[2013-11-18 23:56:55 -0500] dgarstang3: wq
[2013-11-18 23:56:57 -0500] dgarstang3: oops
[2013-11-18 23:57:05 -0500] phutchins: from http?
[2013-11-18 23:57:22 -0500] dgarstang3: So.... uhm.... where do people put dependant recipes? Do you use include_recipe or do you put it in the run list for the role?
[2013-11-18 23:57:40 -0500] coderanger: Sure, I trust HTTP parsers roughly as far as I can throw them, and string parsers in general have long histories of buffer problems
[2013-11-18 23:57:59 -0500] phutchins: dgarstang3: depends 'cookbook' in your metadata.rb
[2013-11-18 23:58:10 -0500] dgarstang3: phutchins: you need more than that
[2013-11-18 23:58:21 -0500] phutchins: dgarstang3: then use include_recipe in your recipe
[2013-11-18 23:58:27 -0500] phutchins: dgarstang3: YOU need more than that :)
[2013-11-18 23:58:32 -0500] dgarstang3: phutchins: is that better than putting it in the role?
[2013-11-18 23:58:32 -0500] phutchins: coderanger: agreed.
[2013-11-18 23:58:52 -0500] phutchins: dgarstang3: putting what in the role? depends in your metadata is completely different than putting something in a role
[2013-11-18 23:58:54 -0500] dgarstang3: phutchins: if you put it in metadata.rb, that isn't enough to make it 'run'
[2013-11-18 23:59:03 -0500] phutchins: dgarstang3: no
[2013-11-18 23:59:17 -0500] dgarstang3: phutchins: putting the cookbook into the role vs using include_recipe. Both will work
[2013-11-18 23:59:58 -0500] phutchins: dgarstang3: yes.
