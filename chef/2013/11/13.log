[2013-11-13 00:35:06 -0500] forehand: researching chef here.  What are some ways to handle database schema changes with new versions of web apps via chef?
[2013-11-13 00:48:53 -0500] juliancdunn: forehand: I usually recommend using Liquibase for schema changes
[2013-11-13 00:49:09 -0500] juliancdunn: and you can invoke that with Chef. but it does schema evolutions much better
[2013-11-13 02:00:55 -0500] redondos: what's the recommended way of creating a GRE tunnel using chef in ubuntu that persists across reboots?
[2013-11-13 02:01:54 -0500] redondos: i am trying to avoid managing the interfaces file but i suppose there's no way out
[2013-11-13 02:32:52 -0500] gclark85: can anyone tell me is there a way to have chef-client run on a regular basis?
[2013-11-13 04:25:56 -0500] Guest96233: Hello,
[2013-11-13 04:27:28 -0500] Guest96233: Hello?
[2013-11-13 04:46:36 -0500] coderanger: Anyone at the summit hacking on stuff at the hotel?
[2013-11-13 05:10:42 -0500] forehand: Anyone know of good resources for getting started with chef in a small enterprise?
[2013-11-13 05:12:59 -0500] dtrott: The opscode training is pretty good, either paid or just work through the tutorials on their web site..
[2013-11-13 05:14:10 -0500] dtrott: Strongly suggest you use hosted chef to start though setting up the server too is a big mountain to climb when you start...
[2013-11-13 06:06:56 -0500] packeteer: yeah, opensource server was painful the first time
[2013-11-13 06:09:03 -0500] dtrott: I thought it would be cool to create a tutorial where you write the cookbook to install the OSS version so at the end of doing it you have a working internal chef ...
[2013-11-13 06:46:08 -0500] b00tbu: Hi I was trying to set up chef server and workstation on same ubuntu server
[2013-11-13 06:46:18 -0500] b00tbu: Has any one tried and did it worked..?
[2013-11-13 06:51:17 -0500] coderanger: b00tbu: It would work, though its kind of against the point
[2013-11-13 06:51:40 -0500] b00tbu: We were getting an issue
[2013-11-13 06:51:58 -0500] b00tbu: when a client deb is installed it is trying to replace the server file
[2013-11-13 06:52:06 -0500] b00tbu: since both have same package name
[2013-11-13 06:52:30 -0500] b00tbu: Server and Client package(deb) has same name.
[2013-11-13 06:53:10 -0500] b00tbu: I am checking this since our firewall block some ports. We were trying to have server and client on server so we won't face issue with uploading cookbooks
[2013-11-13 06:53:35 -0500] b00tbu: **client package has -knife hence trying to get client.deb file.
[2013-11-13 06:53:37 -0500] coderanger: b00tbu: Which file? server and client install into totally different folders
[2013-11-13 06:53:51 -0500] coderanger: The two are actually no longer related
[2013-11-13 06:53:53 -0500] b00tbu: Yes agreed
[2013-11-13 06:54:06 -0500] b00tbu: but when dpkg -i client.deb is ran it shows message
[2013-11-13 06:54:26 -0500] b00tbu: replacing server-package
[2013-11-13 06:54:38 -0500] b00tbu: Ubuntu deb.packages has same name..
[2013-11-13 06:54:54 -0500] coderanger: Are you using the omnibus packages or something from Ubuntu?
[2013-11-13 06:54:56 -0500] b00tbu: hence they each other try replacing hte package
[2013-11-13 06:54:59 -0500] b00tbu: the package
[2013-11-13 06:55:11 -0500] coderanger: Can you please pastebin the exact error text?
[2013-11-13 06:55:17 -0500] b00tbu: I tried omnibus package.. it was going on for ever.
[2013-11-13 06:55:31 -0500] b00tbu: no errors
[2013-11-13 06:55:39 -0500] b00tbu: I will clarify a bit
[2013-11-13 06:55:48 -0500] b00tbu: we have server installed in  one server.
[2013-11-13 06:55:59 -0500] b00tbu: To get workstation set up in same server.
[2013-11-13 06:56:08 -0500] b00tbu: we tried omnibus installer..
[2013-11-13 06:56:12 -0500] b00tbu: That went for long time..
[2013-11-13 06:56:22 -0500] coderanger: Sure, it can take a while
[2013-11-13 06:56:25 -0500] b00tbu: no response. Hence I got client.deb file and tried installing..
[2013-11-13 06:57:28 -0500] b00tbu: I will get you the error while installing
[2013-11-13 07:00:08 -0500] b00tbu: http://pastebin.com/i6HzKvhD
[2013-11-13 07:00:12 -0500] b00tbu: I have place it here
[2013-11-13 07:01:47 -0500] coderanger: There is no error there
[2013-11-13 07:03:24 -0500] b00tbu: it says trying to replace
[2013-11-13 07:04:03 -0500] b00tbu: Preparing to replace chef 11.8.0-1.ubuntu.12.04(Server) (using chef_11.8.0-1.ubuntu.12.04_amd64.deb)(client) ...
[2013-11-13 07:04:48 -0500] b00tbu: Client installation is trying to replace the server installation
[2013-11-13 07:04:59 -0500] b00tbu: since the packages have the same name...
[2013-11-13 07:05:17 -0500] b00tbu: I even tried with older version of client and got similar message..
[2013-11-13 07:05:35 -0500] coderanger: b00tbu: Thats normal output for dpkg
[2013-11-13 07:05:44 -0500] coderanger: Specifically it means chef is already installed
[2013-11-13 07:06:02 -0500] b00tbu: Okey...
[2013-11-13 07:06:05 -0500] coderanger: The packages for client and server do not have the same name
[2013-11-13 07:06:09 -0500] b00tbu: Does that means it wont remove the server../
[2013-11-13 07:06:35 -0500] b00tbu: Okey I will try it once again..
[2013-11-13 07:06:37 -0500] coderanger: chef-server is named chef-server, chef is named chef
[2013-11-13 07:07:03 -0500] coderanger: As I said, the two pieces of software have nothing to do with each other beyond the API level
[2013-11-13 07:07:28 -0500] b00tbu: @coderanger thanks for the clarification..
[2013-11-13 07:07:38 -0500] b00tbu: I will give it a try and let you know..
[2013-11-13 07:10:00 -0500] b00tbu: It is staying in installing state..
[2013-11-13 07:10:25 -0500] b00tbu: Preparing to replace chef 11.8.0-1.ubuntu.12.04 (using chef_11.8.0-1.ubuntu.12.04_amd64.deb) ... Unpacking replacement chef ...
[2013-11-13 07:10:30 -0500] b00tbu: Stays that way..
[2013-11-13 07:11:46 -0500] coderanger: How fast is the server and do you have enough disk space?
[2013-11-13 07:12:42 -0500] b00tbu: yes the server is fast..
[2013-11-13 07:12:52 -0500] b00tbu: but working behind firewall..
[2013-11-13 07:13:02 -0500] b00tbu: so used proxy..
[2013-11-13 07:14:13 -0500] b00tbu: Error
[2013-11-13 07:14:15 -0500] b00tbu: dpkg: unrecoverable fatal error, aborting:
[2013-11-13 07:14:21 -0500] b00tbu:  fork failed: Cannot allocate memory
[2013-11-13 07:15:03 -0500] b00tbu: it got installed... @coderanger
[2013-11-13 07:15:05 -0500] b00tbu: thanks..
[2013-11-13 07:15:06 -0500] b00tbu: :)
[2013-11-13 07:15:26 -0500] coderanger: What are the specs on this server?
[2013-11-13 07:15:44 -0500] coderanger: You probably need at least 2-4GB of RAM for a chef server at an absolute minimum
[2013-11-13 07:16:00 -0500] b00tbu: we are running under 1.7GB
[2013-11-13 07:18:10 -0500] coderanger: You're going to have a bad time
[2013-11-13 07:18:25 -0500] b00tbu: :) this is intial set up.. we were getting memory error..
[2013-11-13 07:18:40 -0500] b00tbu: Errno::ENOMEM: Cannot allocate memory - stty
[2013-11-13 07:18:54 -0500] coderanger: So, to reiterate, you need more RAM than that :P
[2013-11-13 07:19:04 -0500] b00tbu: we are upgrading the server..
[2013-11-13 07:19:07 -0500] b00tbu: now
[2013-11-13 07:19:24 -0500] b00tbu: client+server 2-4 GB will do fine..?
[2013-11-13 07:19:38 -0500] b00tbu: I mean having both in one server...
[2013-11-13 07:20:47 -0500] check1: hello any one to help with chef question on why I get this "{"error":["Failed to authenticate as dart. Ensure that your node_name and client key are correct."]}" when I do a PUT  /organizations/myenv/environments/devtest
[2013-11-13 07:20:58 -0500] check1: I dont see this problem when I do a GET
[2013-11-13 07:21:36 -0500] coderanger: b00tbu: client RAM usage can vary a lot depending on how you use chef
[2013-11-13 07:21:56 -0500] coderanger: for server, 4 is probably the lowest I would go and expect stability
[2013-11-13 07:22:39 -0500] coderanger: check1: How are you doing your API calls?
[2013-11-13 07:23:19 -0500] check1: well I am using this
[2013-11-13 07:23:35 -0500] check1: JAva project  https://github.com/charleyw/chef-api-java
[2013-11-13 07:23:54 -0500] check1: here is the code
[2013-11-13 07:23:58 -0500] b00tbu: We wanted Workstation and server in same server.. for getting cookbooks ready.. Th
[2013-11-13 07:24:13 -0500] coderanger: b00tbu: That would be weird, the workstation should be your actual workstation
[2013-11-13 07:25:13 -0500] coderanger: check1: Use https://github.com/jclouds/jclouds-chef
[2013-11-13 07:25:22 -0500] check1: is it
[2013-11-13 07:25:26 -0500] coderanger: check1: No idea what that other thing is, but its ancient and looks unmaintained
[2013-11-13 07:25:48 -0500] check1: hey well I tried even with that shell script it doesnt work
[2013-11-13 07:25:59 -0500] check1: let me show you which script i am talking about
[2013-11-13 07:26:07 -0500] coderanger: No idea what shell script you mean
[2013-11-13 07:26:51 -0500] check1: script is here : http://docs.opscode.com/auth.html
[2013-11-13 07:27:24 -0500] check1: Its a bash script ... it works on GET but doesnt work for POST i get that : {"error":["Failed to authenticate as dart. Ensure that your node_name and client key are correct."]}
[2013-11-13 07:27:27 -0500] coderanger: check1: That script can only make GET requests
[2013-11-13 07:27:40 -0500] check1: I changed it to make POST
[2013-11-13 07:27:52 -0500] coderanger: You changed it incorrectly then
[2013-11-13 07:28:24 -0500] check1: But should that script work if changed  correctly you think ?
[2013-11-13 07:28:42 -0500] coderanger: By definition yes, if you wrote the correct code it would work
[2013-11-13 07:28:47 -0500] coderanger: :)
[2013-11-13 07:28:54 -0500] coderanger: Thats not a very helpful tautology though
[2013-11-13 07:28:56 -0500] check1: lol... well I am using chef 0.9
[2013-11-13 07:29:15 -0500] check1: let me show you what changes I made...
[2013-11-13 07:29:23 -0500] dtrott: lol - a friend of mine used to love saying - works as implemented ...
[2013-11-13 07:29:42 -0500] coderanger: check1: If you want to use java, just use the jcloud-chef library, thats well maintained
[2013-11-13 07:30:02 -0500] check1: ohh is it
[2013-11-13 07:30:05 -0500] check1: what version ?
[2013-11-13 07:30:06 -0500] coderanger: Bash is not something you should ever write Chef-related stuff in, that script in the docs is provides as an example
[2013-11-13 07:30:28 -0500] coderanger: and should probably be removed, originally that little bash script was the only example of doing chef auth other than the chef codebase itself
[2013-11-13 07:30:30 -0500] check1: "  case $method in     GET) #      curl_command="curl $headers $auth_headers $path"       curl_command="curl $headers $auth_headers $path"       echo "Executing curl command " $curl_command       $curl_command       ;;     POST)       curl_command="curl $headers $auth_headers $path $body"       echo "Executing curl command " $curl_command       $curl_command       ;;     *)       echo "Unknown Method. I only know: GET" >&2       return 
[2013-11-13 07:30:33 -0500] coderanger: but there are now lots of other things
[2013-11-13 07:30:42 -0500] check1: ohh ok
[2013-11-13 07:30:51 -0500] coderanger: check1: Yeah no, thats not even remotely going to work
[2013-11-13 07:31:17 -0500] check1: well let me use jclouds can you tell me if it will work chef 0.9 and secondly can you tell me what version of jclouds to use
[2013-11-13 07:32:26 -0500] coderanger: Use the latest version, and I have no idea
[2013-11-13 07:32:33 -0500] coderanger: Chef 0.9 is far beyond end of life
[2013-11-13 07:32:47 -0500] coderanger: but the API hasn't changed too much, most stuff should work except maybe the cookbook API
[2013-11-13 07:33:00 -0500] coderanger: Nothing in the auth protocol has changed surely
[2013-11-13 07:33:09 -0500] check1: I mean i saw several difference between documentation and what I actually saw
[2013-11-13 07:33:15 -0500] coderanger: Related: you really shouldn't be using 0.9
[2013-11-13 07:33:26 -0500] coderanger: It is actively unsafe in many areas
[2013-11-13 07:34:14 -0500] check1: haha... well I am going to show this chat log to my manager :)
[2013-11-13 07:34:49 -0500] coderanger: In general you probably shouldn't use any software that is no longer getting security fixes
[2013-11-13 07:35:20 -0500] check1: ohh ok
[2013-11-13 07:36:49 -0500] check1: Is there a link on Maven central where you can point me too... i see so many jclouds chef libraries
[2013-11-13 07:38:20 -0500] coderanger: http://search.maven.org/#search|ga|1|a%3A%22jclouds-chef%22
[2013-11-13 07:38:29 -0500] coderanger: Thats the only one I know of
[2013-11-13 07:40:04 -0500] check1: thanks coderanger
[2013-11-13 08:48:12 -0500] bcave: good morning all
[2013-11-13 08:48:14 -0500] henk_: hi guys, can someone please tell me how to install a windows 2008 chef node? whatever i do, it keeps registering itself as a client
[2013-11-13 08:49:38 -0500] drrk: all nodes are clients aswell
[2013-11-13 08:49:58 -0500] drrk: the client is the means to login to the chefserver
[2013-11-13 08:51:33 -0500] henk_: ah ok. so you'll get a client and a node in your webui?
[2013-11-13 08:52:07 -0500] drrk: yes
[2013-11-13 08:52:23 -0500] henk_: thanks.
[2013-11-13 08:52:57 -0500] Tensibai: Hi there
[2013-11-13 08:53:32 -0500] henk_: hi
[2013-11-13 08:54:32 -0500] Tensibai: small question, but no luck searching about it on docs: how can I set a env variable for a gem_package install ?
[2013-11-13 08:54:52 -0500] Tensibai: BUT  I don't wish to set this env variable outside the install context
[2013-11-13 08:56:02 -0500] Tensibai: phrased differently: will the use of ENV['HTTP_PROXY']  = proxy be enought if defined inside the recipe ?
[2013-11-13 12:00:51 -0500] sacoetzee: hey all, real quick one. How would I stub a "YAML.load_item('some_file") with chefspec
[2013-11-13 12:06:59 -0500] bretep: I am configuring a postgres cookbook. I'd like at the very end to print manual instructions, like "Manual restart of postgres required". I'd rather not restart postgres when chef runs. Thoughts, suggestions?
[2013-11-13 12:07:39 -0500] Tensibai: bretep: use log ressource and notifies it ?
[2013-11-13 12:08:44 -0500] bretep: Would I just use the 'delayed' timer?
[2013-11-13 13:01:56 -0500] Tensibai: bretep: I think so, create a log ressource with action :nothing and then notify it from the ressources changing to log at the end, you may wish to log at warning level, but I don't really remember the attribute for that
[2013-11-13 13:02:20 -0500] Tensibai: and sorry for the delayed answer, was out for lunch
[2013-11-13 13:04:49 -0500] bretep: No problem. Here is what I did: http://pastebin.com/pnmymRRZ
[2013-11-13 13:06:13 -0500] Tensibai: bretep: unfortunately my proxy don't allow me to access pastebin, you may try gist or pastie.org
[2013-11-13 13:07:06 -0500] bretep: http://pastie.org/private/iblaufhs4eiarqcofqw
[2013-11-13 13:08:35 -0500] Tensibai: bretep you should add a action :nothing to the log ressource
[2013-11-13 13:09:04 -0500] Tensibai: if not it would be logged at each chef run
[2013-11-13 13:10:17 -0500] Tensibai: I think write is the default action for log
[2013-11-13 13:11:10 -0500] bretep: So if I add the :nothing then it will only write the log if the file changes?
[2013-11-13 13:11:30 -0500] Tensibai: bretep: that's it
[2013-11-13 13:12:54 -0500] bretep: http://pastie.org/private/b6lzcdtwua7kh4m6bfm3ba
[2013-11-13 13:13:02 -0500] Tensibai: (May I ask why you don't want to restart postgress within chef ?)
[2013-11-13 13:13:47 -0500] Tensibai: bretep: more like this: http://pastie.org/8477287
[2013-11-13 13:14:24 -0500] bretep: Isn't that what I first posted? http://pastie.org/private/iblaufhs4eiarqcofqw
[2013-11-13 13:14:59 -0500] Tensibai: look at the log resource
[2013-11-13 13:15:25 -0500] Tensibai: there's just action :nothing added to it
[2013-11-13 13:16:27 -0500] bretep: I don't want the postgres server to be restarted outside of schedualed maintence.
[2013-11-13 13:17:10 -0500] Tensibai: Ok I see
[2013-11-13 13:19:22 -0500] bcave: I don't think I'm the first, but going to bring it up anyway...
[2013-11-13 13:19:45 -0500] bcave: If i have a role with a run list, and execute it with chef-server / chef-client, the run list seems to get executed in order
[2013-11-13 13:19:59 -0500] bcave: however, if I use the role in chef-solo, the run list is almost reverted
[2013-11-13 13:24:44 -0500] bcave: e.g. https://gist.github.com/brettcave/7449050
[2013-11-13 13:25:08 -0500] bcave: this is with a test-kitchen run - the run list is expanded in the correct order, but then starts installing in reverse order
[2013-11-13 13:34:18 -0500] glen: how do i fill attributes from encrypted data bag?
[2013-11-13 13:34:33 -0500] glen: i want to stuff some password to openldap cookbook for bindpw
[2013-11-13 13:34:55 -0500] glen: and and seems as that cookbook does not pass any @variables, i should store them node attribute before calling cookbook
[2013-11-13 13:48:07 -0500] bcave: you need to load them
[2013-11-13 13:48:50 -0500] bcave: secret = Chef::EncryptedDataBagItem.load_secret("/path/to/your/secret/file")
[2013-11-13 13:49:32 -0500] bcave: bag_item = Chef::EncryptedDataBagItem.load(BAG_NAME, ITEM_NAME, secret)
[2013-11-13 13:53:25 -0500] bcave: your_var = bag_item["the_key"]
[2013-11-13 13:56:05 -0500] zts: bcave: which version of chef-solo?  (I use chef-solo, works the right way around for me)  One possibility is that there's something in your "last" recipe which is being forced to run during the compile phase, which might be confusing.
[2013-11-13 13:58:25 -0500] glen: bcave: what is better, do that in wrapper cookbook recipe, or do it in wrapper cookbook attributes
[2013-11-13 13:58:44 -0500] glen: in recipe, there's more convenient method available secrets = data_bag_item('ldap', 'nss_bindpw')
[2013-11-13 13:59:17 -0500] bcave: zts - sorry, yeah - it was phase confusion
[2013-11-13 13:59:38 -0500] bcave: i have an include_recipe which gets parsed in the convergence phase, while i have some things that I force into the compilation phase
[2013-11-13 14:00:00 -0500] bcave: e.g. g = chef_gem "fog" do .....; g.run_action(:install)
[2013-11-13 14:01:05 -0500] bcave: glen - I tried the wrapper approach, but it didn't work either - I need to install a chef_gem before convergance
[2013-11-13 14:02:29 -0500] bcave: if I use include_recipe "some::thing", then would the some:thing converge before the current recipe's compile?
[2013-11-13 14:06:49 -0500] zts: bcave: no, unless every resource in recipe[some::thing] is doing .run_action(:whatever) to make it happen
[2013-11-13 14:07:02 -0500] henk_: stupid question maybe. But if you install the chef services in windows. Does it only install the newly added reccipes to your host, of does it update all of it?
[2013-11-13 14:07:24 -0500] cpuguy83: henk_: Not sure I follow your question
[2013-11-13 14:08:23 -0500] cpuguy83: henk_: On a chef run the Chef client is always running through the full run list.  Because things are idempotent tasks that have already been run will probably not do anything in subsequent runs
[2013-11-13 14:09:33 -0500] henk_: Thanks.... ;). that's what i was looking for.
[2013-11-13 14:10:01 -0500] daxroc: Is it ok to set defaults values in the environment and override them in an ohai plugin ?
[2013-11-13 14:10:44 -0500] zts: bcave: if you haven't seen it, I thought this blog post was helpful to understand what's going on: http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-11-13 14:52:01 -0500] broconne: Is it possible to access the node object from a library?
[2013-11-13 14:52:55 -0500] cpuguy83: broconne: I library should really be self-contained.
[2013-11-13 14:53:10 -0500] cpuguy83: broconne: You could have someone pass in a node object that you can play with
[2013-11-13 14:53:33 -0500] cpuguy83: s/I/A
[2013-11-13 14:53:42 -0500] cpuguy83: Don't know where that "I" came from
[2013-11-13 14:54:12 -0500] broconne: Yeah - I would think most would be...  for this one we are doing LDAP lookups from other recipes.. and the LDAP server is dependant on the environment.. felt like a good fit for a node attribute.
[2013-11-13 14:55:20 -0500] broconne: is there a more library specific way to do that?  or should I require them to pass in the node object?
[2013-11-13 14:56:24 -0500] cpuguy83: broconne: Definitely have them pass in the info you want, probably even just the specific data items not the node object
[2013-11-13 14:56:48 -0500] broconne: hmm.. you are talking about a fair number of things that would need to be passed in..
[2013-11-13 14:57:00 -0500] broconne: username,password,node,port and then your search query.
[2013-11-13 14:57:13 -0500] cpuguy83: That's just my opinion... But I think of libraries as something that could easily be a gem
[2013-11-13 14:57:15 -0500] broconne: also expect this library to be used a lot in our infra.
[2013-11-13 14:57:37 -0500] broconne: yeah - i can see boht sides of it
[2013-11-13 14:58:09 -0500] bcave: zts: very helpful, just the sort of explanation i needed to clarify
[2013-11-13 14:58:57 -0500] cpuguy83: broconne: That's all reasonable stuff to pass in.  If someone wanted to they could just pass in the actual hash and you wouldn't have to change anything in your lib
[2013-11-13 14:59:22 -0500] bcave: ah, ok... so I think i may have a workable approach...
[2013-11-13 15:00:18 -0500] bcave: the main issue that I had was that i use encrypted data bags, but the secret file is on a remote system that uses a chef_gem to retrieve it (Fog)
[2013-11-13 15:00:29 -0500] cpuguy83: my_ldap_hash = { username: 'myuser', password: 'itsasecret!', address: 'ldap.mycompany.com', query: 'awesome ldap query' }
[2013-11-13 15:00:39 -0500] cpuguy83: MyLdapLib.new(my_ldap_hash)
[2013-11-13 15:00:51 -0500] zts: broconne: you could also consider pushing the options into environment variables, then the library could just look at those
[2013-11-13 15:00:58 -0500] broconne: an all the values from that hash are loaded from attributes.
[2013-11-13 15:01:19 -0500] broconne: zts: You mean OS environment vars?
[2013-11-13 15:01:23 -0500] zts: broconne: yup
[2013-11-13 15:01:48 -0500] cpuguy83: So effectively you could store that data in a hash in your node attr and pass in just that node[:ldap][:host_info] (for example)
[2013-11-13 15:02:45 -0500] cpuguy83: broconne: So the node attrs are just a hash.  You can pass that hash into your lib
[2013-11-13 15:03:08 -0500] cpuguy83: But passing in the node object itself would not be a good thing
[2013-11-13 15:03:09 -0500] broconne: yeah, so sounds like I would pass the node object in.
[2013-11-13 15:03:12 -0500] broconne: heh
[2013-11-13 15:03:32 -0500] cpuguy83: Pass in the hash that has the actual data in it, not the node object
[2013-11-13 16:27:11 -0500] programmerq: as far as I can tell, this test is broken: https://github.com/opscode-cookbooks/apache2/blob/master/files/default/tests/minitest/default_test.rb#L52-L54
[2013-11-13 16:27:20 -0500] programmerq: it appears to be a test for this resource: https://github.com/opscode-cookbooks/apache2/blob/master/recipes/default.rb#L165-L173
[2013-11-13 16:27:33 -0500] programmerq: the test is looking for a file called security, but the template writes out security.conf
[2013-11-13 16:59:57 -0500] jbz: Anyone familiar with Chef Server 11.08 who can tell me if something is a known bug?
[2013-11-13 17:00:44 -0500] ptrf: well, for starters you can try posting what you think is a bug (in a gist if necessary)
[2013-11-13 17:00:59 -0500] ptrf: and you can try to search trhe tickets, referenced in the topic.
[2013-11-13 17:01:11 -0500] jbz: Yeah, I looked at the tickets, but my search-fu is frankly pants
[2013-11-13 17:01:14 -0500] jbz: anyway
[2013-11-13 17:01:19 -0500] ptrf: :) i know that feeling
[2013-11-13 17:01:23 -0500] jbz: I'll give it another shot, but:
[2013-11-13 17:01:27 -0500] jbz: when I look at a node in the web UI
[2013-11-13 17:01:37 -0500] jbz: even a node that is in the production environment
[2013-11-13 17:01:37 -0500] ptrf: other people's issue trackers fails to make sense for me too
[2013-11-13 17:01:43 -0500] jbz: the edit window shows it as being in _default
[2013-11-13 17:01:49 -0500] jbz: so if I hit save without checking that
[2013-11-13 17:01:54 -0500] jbz: it will *move it* to _default.
[2013-11-13 17:01:56 -0500] jbz: Urgh.
[2013-11-13 17:02:12 -0500] ptrf: the web UI being hosted chef at management.opscode.com?
[2013-11-13 17:02:23 -0500] jbz: No, the open source server.
[2013-11-13 17:02:26 -0500] ptrf: oh
[2013-11-13 17:02:29 -0500] ptrf: manage*
[2013-11-13 17:03:09 -0500] ptrf: eh, I can't replicate that here, we use hosted chef, but I rarely interact with it through the browser
[2013-11-13 17:03:35 -0500] ptrf: that being said, I actually had a question too:
[2013-11-13 17:04:44 -0500] ptrf: what can chef-rewind do, that resource resolve + editing (resources("template[/etc/openvpn/server.conf]").cookbook "housepub-openvpn"
[2013-11-13 17:04:52 -0500] ptrf: ... ) cant fix
[2013-11-13 17:04:55 -0500] ptrf: mis paste
[2013-11-13 17:05:53 -0500] ptrf: so you can edit resources with  a = resources("...") ; a.prop1 = ...; a.prop2 = ... etc
[2013-11-13 17:06:23 -0500] ptrf: why would you need chef-rewind? is it because it conforms more to the DSL LWRP format?
[2013-11-13 17:07:11 -0500] mattsmith: After some advise if I may, I'm writing a recipe that may/may not update a configuration file used by a service - How do I tell my recipe to only restart the service if a change to the configuration has been made?
[2013-11-13 17:07:48 -0500] zts: ptrf: it's just 'syntactic sugar'
[2013-11-13 17:09:46 -0500] ptrf: zts: are you sure?
[2013-11-13 17:09:51 -0500] zts: ptrf: yes
[2013-11-13 17:10:20 -0500] Cope: nah he's just bluffing
[2013-11-13 17:10:23 -0500] Cope: he has a tell
[2013-11-13 17:10:41 -0500] zts: Cope :)
[2013-11-13 17:10:44 -0500] Cope: see, when he uses inverted commas like 'this' - it means he's not confident
[2013-11-13 17:11:00 -0500] Cope: if he uses themn like "this", he's actually telling the truth
[2013-11-13 17:11:15 -0500] zts: Cope: ahhh but what if I were to use smart quotes?
[2013-11-13 17:12:03 -0500] ptrf: zts: no, I wasn't trying to imply anything, but as far as I can see, resolving a resource with resources("blabla") and changing it causes chef to clone the resource
[2013-11-13 17:12:14 -0500] ptrf: so for a template, it might render two templates
[2013-11-13 17:13:05 -0500] ptrf: so when you do unwind of a resource for instance, what happens then? is the original resource still cloned then?
[2013-11-13 17:13:10 -0500] zts: ptrf: I don't believe that's correct - resources("foo") returns the instance of the resource in the collection
[2013-11-13 17:13:22 -0500] ptrf: oh, then my sources are outdated
[2013-11-13 17:13:26 -0500] zts: ptrf: I'll also appeal to authority here with Seth Vargo's gist showing the way to do it manually :) https://gist.github.com/sethvargo/6443603
[2013-11-13 17:13:49 -0500] ptrf: granted, IANA chef expert
[2013-11-13 17:13:54 -0500] zts: https://github.com/bryanwb/chef-rewind/blob/master/lib/chef/rewind.rb#L23 <- also, chef-rewind grabs it the same way
[2013-11-13 17:14:58 -0500] ptrf: zts: haha, you've got to be kidding me, so chef-rewind is only 73 SLOC
[2013-11-13 17:15:10 -0500] joesph: jbz: I see that bug as well.  I have to be careful when making any changes via ui.  ptrf is right though, you should try to interact with it programmatically such that it is a repeatable and expected change.  (unless you're just testing)
[2013-11-13 17:15:13 -0500] ptrf: okay, well that solves it
[2013-11-13 17:16:05 -0500] ptrf: joesph: jbz I must admit, I use knife a lot simply because the management ui on opscode is still horribly slow
[2013-11-13 17:17:05 -0500] ptrf: zts: should've opted to look at the code before, but thanks
[2013-11-13 17:17:31 -0500] zts: ptrf: no problem!
[2013-11-13 17:23:06 -0500] joesph: mattsmith:  you can use a service lwrp with a default action of restart and use only_if {some ruby code here}
[2013-11-13 17:23:54 -0500] jbz: joesph:  Thanks very much for the confirmation :-)
[2013-11-13 17:27:37 -0500] cpuguy83: net start chef-client
[2013-11-13 17:27:37 -0500] cpuguy83: The service is not responding to the control function.
[2013-11-13 17:27:39 -0500] cpuguy83: I see this quite frequently on my Windows systems:
[2013-11-13 17:28:56 -0500] zts: joseph, mattsmith: using "notifies" might be more appropriate - see http://docs.opscode.com/resource_common.html#notifications
[2013-11-13 17:31:19 -0500] mattsmith: joseph, zts, Thanks guys I will investigate both approaches :-)
[2013-11-13 17:36:26 -0500] jhsu802701: I already have solutions for providing the database name, username, and password for my Rails apps and Ruby gems.  However, I've heard that Chef is a more elegant way to do this.
[2013-11-13 17:36:45 -0500] jhsu802701: But the documentation for Chef is so complicated.
[2013-11-13 18:12:34 -0500] dtrott: When building a custom cookbook when would I choose to implement a LWRP verse simply adding the code to /libraries ?
[2013-11-13 18:14:55 -0500] mattupstate: LWRP's are arguably easier to write
[2013-11-13 18:15:24 -0500] mattupstate: but you need to understand the DSL as opposed to plain old ruby
[2013-11-13 18:18:09 -0500] caryp: is there an irc channel for chef summit?
[2013-11-13 18:25:16 -0500] nickmeharry: How can I modify the bootstrap process? I need to add a DNS entry to /etc/resolv.conf before the node can find the chef server.
[2013-11-13 18:25:39 -0500] d```: nickmeharry: I'd modify the base image you're installing from
[2013-11-13 18:26:08 -0500] nickmeharry: Hmm, ok. I'm just using the default rackspace Ubuntu 12.04 image.
[2013-11-13 18:28:09 -0500] zts: nickmeharry: you can create a custom bootstrap template - http://docs.opscode.com/knife_bootstrap.html#custom-templates
[2013-11-13 18:32:40 -0500] nickmeharry: zts: I think that's what I was looking for. Thanks.
[2013-11-13 18:51:10 -0500] joelteon: I'm getting "Could not satisfy version constraints for: application" when trying to provision a VM with chef-zero. application has no version constraints.
[2013-11-13 18:52:10 -0500] jmickle: anyone have a good tutorial for setting up vagrant to test locally with cookbooks?
[2013-11-13 18:53:58 -0500] failshell: how do you delete an attribute from a recipe? i tried node.default['foo'].delete('bar') but that doesnt work. the attribute is set on the node itself
[2013-11-13 18:54:37 -0500] jmickle: failshell knife node edit
[2013-11-13 18:54:48 -0500] failshell: jmickle: not going to do that on over 300 machines
[2013-11-13 18:54:48 -0500] jmickle: but if its being set in a recipe somewhere the next time chef converges it will be set again
[2013-11-13 18:55:37 -0500] jmickle: wait you set an attribute specific to a node on over 300 machines?
[2013-11-13 18:55:37 -0500] jmickle: ;-p
[2013-11-13 18:55:50 -0500] philsturgeon: anyone here know much about the python cookbook, pip installs and distribute?
[2013-11-13 18:56:00 -0500] philsturgeon: http://pastie.org/8478174 been getting this error
[2013-11-13 19:01:26 -0500] bugoff: :18
[2013-11-13 19:20:09 -0500] joelteon: am I going to have to put a debugger statement in chef-zero to test this
[2013-11-13 19:20:20 -0500] joelteon: it would be great if there were any more information
[2013-11-13 19:22:58 -0500] dtrott: jmickle: http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2013-11-13 19:23:21 -0500] jmickle: awesome thank you!
[2013-11-13 19:23:57 -0500] dtrott: The tutorial throws in Berkshelf too but thats probably a good thing ...
[2013-11-13 19:54:56 -0500] chris613: Does anyone have a link for me that explains step by step how LWRPs are executed in terms of the "first pass" and "second pass"? Specifically I'm trying to figure out if code inside my "action :create" block executes during the first pass, or whether the LWRP itself just gets put on the resource collection and execution of code in "action :create" doesn't occur until the second pass?
[2013-11-13 19:55:18 -0500] chris613: I'm not even sure I'm clear enough with what I want to figure out, which is why I'm looking for a guide that explains it in more detail than the main opscode docs
[2013-11-13 19:55:38 -0500] douglaswth: sounds like you are talking about compile/converge
[2013-11-13 19:55:50 -0500] chris613: yes. first/second == compile/converge
[2013-11-13 19:56:02 -0500] douglaswth: provider actions are usually done during the converge phase
[2013-11-13 19:57:08 -0500] douglaswth: you would have to do run_action to get it to occur during compile phase, but you should probably only do that if you have a really good reason
[2013-11-13 19:57:46 -0500] chris613: I'm talking specifically about LWRPs that themselves define resources inside their action.
[2013-11-13 19:57:59 -0500] chris613: I'm using this as an example: https://github.com/opscode-cookbooks/cron/blob/master/providers/d.rb  and can't seem to replicate the same effects
[2013-11-13 19:58:28 -0500] sn0wb1rd: what do you expect and what is happening?
[2013-11-13 19:58:37 -0500] douglaswth: everything inside of the action blah do/end block is done during converge
[2013-11-13 19:59:07 -0500] chris613: douglaswth: And that includes the compilation and immediate convergence of any resources declared insice that block?
[2013-11-13 19:59:34 -0500] douglaswth: as far as I know
[2013-11-13 19:59:56 -0500] chris613: sn0wb1rd: Trying to get a notifies line in the LWRP declaration in our recipe to fire if a particular template inside the LWRP provider has changed. Seemingly exactly like the cron_d example
[2013-11-13 20:00:29 -0500] chris613: What's happening is that the notify appears to happen before the underlying template is updated
[2013-11-13 20:02:35 -0500] douglaswth: http://docs.opscode.com/lwrp_custom_provider.html#use-inline-resources might be relevant to this
[2013-11-13 20:05:40 -0500] chris613: It looks like it might be...
[2013-11-13 20:23:53 -0500] chris613: Nope, still not understanding how the cron_d example works (does it even work?). From what I've read, the :create block is going to be run during converge, which will add the template to the collection immediately after the LWRP, then it does new_resource.updated_by_last_action(t.updated_by_last_action?) which I'd assume is ALWAYS false since the template resource won't attempt to converge until after the LWRP is done. What am I missing?
[2013-11-13 20:31:49 -0500] chris613: errr, I mean t.run_action(:create) :P
[2013-11-13 20:33:36 -0500] joelteon: "Could not find cookbooks 'application' in any of the sources. Is it in your Berksfile?"
[2013-11-13 20:33:42 -0500] joelteon: I have site :opscode in there
[2013-11-13 20:36:56 -0500] azret: anyone know why my mysql recipe is converging before my yum recipe although my run list says run yum first
[2013-11-13 20:37:45 -0500] azret: this is for chef solo and not actual chef, this works fine when i provision a new server
[2013-11-13 20:37:51 -0500] azret: doesn't work so well with my vagrant box
[2013-11-13 20:40:12 -0500] Lazar_Dobrescu: Hello. I was wondering if it is possible to install a ruby gem(in chef's ruby, like by using chef_gem) and use that same gem in a custom lightweight provider, without using two separate run-lists(and I guess two separate executions of chef)?
[2013-11-13 20:41:17 -0500] joelteon: where are cookbooks storeD?
[2013-11-13 20:46:06 -0500] joelteon: ugh
[2013-11-13 20:46:19 -0500] joelteon: I JUST wiped ~/.berkshelf and reinstalled, and berks still says it can't find 'application'
[2013-11-13 20:46:25 -0500] joelteon: even though I just installed it
[2013-11-13 20:46:25 -0500] sn0wb1rd: chris613: I had a similar issue I believe https://github.com/opscode-cookbooks/lvm/blob/master/libraries/provider_lvm_logical_volume.rb#L109-L120
[2013-11-13 20:47:01 -0500] chris613: sn0wb1rd: EXACTLY the solution we just came up with
[2013-11-13 20:47:06 -0500] sn0wb1rd: chris613: The solution I had in the lvm cookbook worked
[2013-11-13 20:48:40 -0500] chris613: yup, our version of that same thing also works
[2013-11-13 20:49:54 -0500] chris613: jtimberman: Who do I send documenation bugs to?
[2013-11-13 20:58:04 -0500] dgarstang3: Anyone here making use of http://community.opscode.com/cookbooks/rsyslog ?
[2013-11-13 20:59:23 -0500] Jug_: could someone explain me which one is the "correct way"...use chef-solo locally to test my cookbooks and somehow skip recipes that require connecting to chef-server or just use chef-client also on my local machine?
[2013-11-13 21:02:41 -0500] scarolan: Jug_: This is an evolving science.  A lot of people have had good results with Berkshelf and Vagrant
[2013-11-13 21:04:10 -0500] scarolan: Mischa Taylor wrote a really awesome blog post about testing cookbooks using Berkshelf and Vagrant:  http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2013-11-13 21:05:56 -0500] chris613: Jug_: If you need to test things which depend on the chef server (search?) then the "correct way" is to test with chef-client
[2013-11-13 21:06:40 -0500] jjj4: hello! i have bootstrapped a node using 'knife bootstrap'. it is an ec2 instance, but i am using cloudformation and not 'knife ec2' to provision the instance. it has an elastic ip address, but the node attributes only have the internal ip. what is the right way to do this and does it involve ohai's cloud features?
[2013-11-13 21:07:15 -0500] scarolan: jjj4: The external ip should be either under ec2. or cloud.
[2013-11-13 21:07:24 -0500] Jug_: yeah, I have been trying to test with chef-client but seems a bit more complex that just using chef-solo....and didn't have any luck on using chef-zero
[2013-11-13 21:08:00 -0500] scarolan: try a "knife node show <hostname> -l" and you should find the public ip buried in there somewhere
[2013-11-13 21:10:01 -0500] jjj4: thanks for the '-l' suggestion, but it's not there
[2013-11-13 21:10:05 -0500] zts: jjj4: Yeah, you may have to create the file "/etc/chef/ohai/hints/ec2.json" for ohai to realise it's on AWS, and populate some things like that.
[2013-11-13 21:10:13 -0500] dgarstang3: scarolan: assuming he doesn't need the ec2.json hints file...
[2013-11-13 21:10:38 -0500] dgarstang3: that hints file is so.... errr... what's a less emotive word than stupid?
[2013-11-13 21:10:46 -0500] jjj4: ok, thanks, i'll look into that hints file
[2013-11-13 21:12:29 -0500] buff3r: Hi, I'm getting this error message when trying to use one of the standard opscode python cookbook: "Cannot find a resource for python_pip on ubuntu version 11.10".  Things I've tried: * added depends "python" to metadata.rb. * added include_recipe "python" to the recipe I'm running.
[2013-11-13 21:21:00 -0500] scarolan: jjj4: does "knife node show <target> -a cloud.public_ipv4" not return any data for you?
[2013-11-13 21:23:47 -0500] scarolan: jjj4: what is your base AMI image?  I just tested it on Ubuntu 12.04 with Ohai 6.20.0, Chef 11.8
[2013-11-13 21:26:10 -0500] zts: scarolan: are you running the instance in an old AWS account?  ie, EC2-Classic, not EC2-VPC
[2013-11-13 21:26:55 -0500] scarolan: zts: I'm just spinning up a default Ubuntu 12.04 instance in us-east, using the vagrant provider
[2013-11-13 21:27:45 -0500] joelteon: "Could not satisfy version constraints for: application"
[2013-11-13 21:27:47 -0500] joelteon: how do I debug this
[2013-11-13 21:28:47 -0500] zts: scarolan: sure, but how old is your AWS account?  The issue is that ohai doesn't need a hint if you're running in EC2-Classic, but it does if you're in VPC.  A while back, Amazon changed things so that you get a VPC by default now (EC2-VPC mode)...
[2013-11-13 21:28:59 -0500] jjj4: i'm in a vpc
[2013-11-13 21:29:10 -0500] zts: scarolan: I believe that you always need the hint in VPC/EC2-VPC, so I'm interested to know if I'm wrong and it works for you in spite of that
[2013-11-13 21:29:28 -0500] scarolan: zts: No, I think you are probably correct.  I haven't tested for these attributes inside of a VPC
[2013-11-13 21:29:42 -0500] zts: jjj4: yeah, you'll almost certainly need the hint
[2013-11-13 21:30:15 -0500] jjj4: ok, i have created the file (with nothing in it). i am re-running my cloudformation to create the instance in a vpc
[2013-11-13 21:30:17 -0500] zts: scarolan: just for extra laughs, you might find that if you start instances in a different region (that you haven't used before), they'll magically be in a VPC even though you don't get one in us-east
[2013-11-13 21:30:50 -0500] scarolan: zts: yes, i've noticed some of that before, when spinning up training instances for students
[2013-11-13 21:31:41 -0500] pravka: just started seeing an odd error today when uploading cookbooks
[2013-11-13 21:31:52 -0500] pravka: ERROR: Network Error: Error connecting to http://chef.domain.com/sandboxes/000000000000741acb9f98b225f8fc5b - Operation timed out - connect(2)
[2013-11-13 21:31:52 -0500] pravka: Check your knife configuration and network settings
[2013-11-13 21:32:11 -0500] pravka: what's even more odd is that my knife.rb points to https.
[2013-11-13 21:32:32 -0500] pravka: and nginx['url'] is https, as well
[2013-11-13 21:35:30 -0500] jjj4: I created the file "/etc/chef/ohai/hints/ec2.json". Started with a brand new instance and ran "knife bootstrap -i ~/keys/dev/us-west-1.pem 54.219.171.211 --no-host-key-verify --sudo" but i'm still not getting any cloud. attributes. Do I need the EC2 plugin installed?
[2013-11-13 21:37:03 -0500] zts: jjj4: the plugin should already be there (it comes with ohai).  If you login to the machine and run "ohai cloud",  does it show you any cloud attributes?
[2013-11-13 21:38:31 -0500] jjj4: zts: ohai cloud returns "I cannot find an attribute named cloud! (ArgumentError)"
[2013-11-13 21:39:06 -0500] jjj4: i'm running my own chef server. does the version of that server matter?
[2013-11-13 21:39:41 -0500] zts: jjj4: No, but the version of ohai/chef might.  On the instance, what do you get from "ohai -v" ?
[2013-11-13 21:40:00 -0500] jjj4: zts: 6.18.0
[2013-11-13 21:41:09 -0500] zts: jjj4: okay, not too old.  Next thing I'd try is run "ohai cloud -l debug | grep -C20 ec2" - could you do that and pastebin the output?
[2013-11-13 21:42:11 -0500] zts: jjj4: oh, and can you confirm that you're using the omnibus installer on the instance?
[2013-11-13 21:42:22 -0500] simplesi: can someone give me a hand with using attribute? on nested attributes?
[2013-11-13 21:42:45 -0500] jjj4: zts: http://pastebin.com/GjjzEYnc
[2013-11-13 21:43:21 -0500] simplesi: I'm attempting to check whether an attribute exists within the attributes hash - e.g. node['a']['b'], but can't work out the syntax - is there some node.attribute?('a.b') form?
[2013-11-13 21:43:53 -0500] zts: jjj4: hm, it looks like it hasn't picked up the hint - the line that includes "looks_like_ec2?" should be saying true
[2013-11-13 21:44:05 -0500] jjj4: zts: How do i check if it's the omnibus installer? I do not see omnibus in the bootstrap output. I do see: Downloading Chef 11.6.0 for ubuntu...
[2013-11-13 21:44:49 -0500] zts: jjj4: ah, I can tell it's the omnibus installer from your pastebin - if it's installed into /opt/chef, that'll be omnibus
[2013-11-13 21:45:46 -0500] jjj4: zts: ok, great. also, my knife.rb and .pem files are in chef-repo/.chef and not ~/.chef. does that make a difference where to put the hints file?
[2013-11-13 21:46:46 -0500] zts: jjj4: that shouldn't matter, but I'm just checking whether/how to change the location of the hints directory
[2013-11-13 21:47:47 -0500] jjj4: zts: and my /etc/ did not have a chef dir, so maybe my workstation isn't looking at /etc/chef at all. I had to create all folders /etc/chef/ohai/hints/
[2013-11-13 21:48:05 -0500] jjj4: zts: i'm on osx
[2013-11-13 21:48:09 -0500] zts: jjj4: sorry no, the hint file needs to be on the instance, where ohai is running, not on your workstation
[2013-11-13 21:49:59 -0500] buff3r: Hi, I'm getting this error message when trying to use one of the standard opscode python cookbook: "Cannot find a resource for python_pip on ubuntu version 11.10".  Things I've tried: * added depends "python" to metadata.rb. * added include_recipe "python" to the recipe I'm running.
[2013-11-13 21:50:09 -0500] zts: jjj4: so the way that it works is that Chef Client (on the instance) runs Ohai (on the instance), which detects all of the data and passes it back to chef-client.  At the end of the run, chef-client sends that data to the Chef server, which is what you query through knife
[2013-11-13 21:50:58 -0500] jjj4: ok, so i need to make that file as a part of user_data on ec2, right?
[2013-11-13 21:51:22 -0500] jjj4: zts: or ssh, or whatever, but user_data is easy
[2013-11-13 21:52:54 -0500] zts: jjj4: yeah, whichever way is easiest - I was already using the CloudFormation::Init stuff, so I just added it as an extra file there.  But doing it straight out of userdata is fine too (just remember that you may need to make the parent directories before touching the file)
[2013-11-13 21:59:32 -0500] zts: jjj4: by the way, I'd also suggest looking at Packer ( http://packer.io/ ) for building customised AMI's with Chef etc baked in.  I haven't used it enough to criticise it, but it's worked well enough for me that I'll recommend it
[2013-11-13 22:07:47 -0500] jjj4: zts: thank you! it's working.
[2013-11-13 22:08:30 -0500] zts: ace!
[2013-11-13 22:58:13 -0500] Guest18743: Would anyone here be able to help me with a problem with hosted enterprise chef? (haven't heard back from support)
[2013-11-13 23:00:05 -0500] Guest18743: Could bootstrap yesterday, but not today, dies right after connecting to opscode.com
[2013-11-13 23:01:49 -0500] Guest18743: So I'm not sure that it's me
[2013-11-13 23:03:32 -0500] r2: holler holler.  is there a way to run `omnibus clean` on a remote host via vagrant?
