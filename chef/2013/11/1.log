[2013-11-01 00:01:26 -0400] josephholsten: I don't even
[2013-11-01 00:01:46 -0400] josephholsten: {chef_wm_depsolver,'-assemble_response/3-lc$^0/1-0-',1, [{file,"src/chef_wm_depsolver.erl"},{line,266}]}
[2013-11-01 00:02:07 -0400] josephholsten: no hablo '-lc$^0/1-0-'
[2013-11-01 00:03:14 -0400] josephholsten: and there are no tags in the repo
[2013-11-01 00:05:19 -0400] josephholsten: and there are no opcode erlangers around are there?
[2013-11-01 00:38:39 -0400] josephholsten: and omnibus chef-server only delivers the beam files.
[2013-11-01 00:39:07 -0400] josephholsten: so I have no way of figuring out what revision of the code this error came from
[2013-11-01 09:30:25 -0400] glen: how chef-server manages logrotation?
[2013-11-01 09:30:42 -0400] glen: my /var/log is 1.2g and does not seem there's any logrotation
[2013-11-01 10:49:30 -0400] rnamF^: hey guys, i'm getting a chef error on my vagrant and i'm not sure on how to fix it
[2013-11-01 10:49:33 -0400] rnamF^: undefined method `log' for Chef:Class
[2013-11-01 10:49:49 -0400] rnamF^: not sure if i'm missing something to be loaded
[2013-11-01 11:00:15 -0400] rnamF^: anyone?
[2013-11-01 11:25:58 -0400] rnamF^: undefined method `log' for Chef:Class - can anyone help me with this error? it shows up when i load a recipe on vagrant
[2013-11-01 11:26:02 -0400] rnamF^: not sure if some plugin is missing
[2013-11-01 13:02:00 -0400] allaire: Guys, is there any easy solution to fix the problem that Ohai points on embedded Ruby on first run?
[2013-11-01 13:02:48 -0400] allaire: reloading ruby_bin, gems_dir, etc.
[2013-11-01 13:11:00 -0400] Raymii: I have two nodes which are shown by knife node list and knife node show NODENAME, but when doing a knife search node "fqdn:NODENAME" or knife search node "fqdnNODENAME*. They are also not shown on the chef server web interface status page, but are on the node and client lists. Chef client itself finishes successfully on those nodes. clients run chef client 11.8 and server is latest.
[2013-11-01 13:12:36 -0400] et1337: hello chefs. today I'm spamming a new project. chefdash - http://sidebolt.github.io/chefdash/
[2013-11-01 13:13:19 -0400] et1337: it lets you trigger chef-client runs across a whole cluster simultaneously and watch the results in realtime.
[2013-11-01 13:13:27 -0400] et1337: give it a try and let me know what you think
[2013-11-01 13:13:32 -0400] Raymii: et1337 so does knife ssh?
[2013-11-01 13:15:41 -0400] et1337: Raymii: I got sick of trying to sort the log output from knife ssh. All the nodes printing at once.
[2013-11-01 13:16:51 -0400] pwelch: Has anyone seen this using chef 11 and ruby 1.8: lib/chef/provider/package/aix.rb:91: warning: regexp has invalid interval
[2013-11-01 13:21:10 -0400] CPS: pwelch: what's the regex it's complaining about?
[2013-11-01 13:21:41 -0400] pwelch: CPS: not sure. that is the first line of out put when running chef-client on a machine
[2013-11-01 13:21:49 -0400] pwelch: I'll run debug to see if there is more info
[2013-11-01 13:22:41 -0400] pwelch: doesnt show anything. that is the first line of the chef-client run output along with some other issues. however, the chef-run still converges
[2013-11-01 13:23:38 -0400] CPS: sounds like something internal, no clue
[2013-11-01 13:38:51 -0400] mfridh: is this really correct that foodcritic wants me to put the $self cookbook in metadata.rb? "FC007: Ensure recipe dependencies are reflected in cookbook metadata ..."
[2013-11-01 13:39:14 -0400] mfridh: this is in my_cookbook::recipeA, where I do include_recipe my_cookook::recipeB ...
[2013-11-01 13:40:36 -0400] mfridh: damn... it was a typo.
[2013-11-01 13:53:11 -0400] michaelhart: I'm writing a provider that uses the "file" provider to write down a file, which in turn notifies a restart on a service. When the provider is executed it fails looking up the service with "cannot be found in the resource collection". But the next step chef-client takes it to run the delayed notifications, during which it restarts the same service it couldn't look up.
[2013-11-01 13:53:47 -0400] michaelhart: The delayed notification is valid because of another change triggering it. But any idea why I can't notify the service from the provider?
[2013-11-01 13:53:59 -0400] michaelhart: The nagios cookbook does this successfully, as do a few others.
[2013-11-01 14:10:38 -0400] michaelhart: solved it, i was calling the provider from another provider, which had "use_line_resources" set.
[2013-11-01 14:20:01 -0400] thedeeno: I'm trying to change the default value of `Chef::Config[:encrypted_data_bag_secret]` for chef-client. How do I do this?
[2013-11-01 14:21:32 -0400] gchristensen: thedeeno: check out the chef-cliet cookbook, and you can set encrypted_data_bag_secret as a configuration key
[2013-11-01 14:23:19 -0400] thedeeno: gchristensen: awesome, I'll check it out.
[2013-11-01 14:27:13 -0400] thedeeno: gchristensen: actually, i'd prefer to manually supply a configuration file at the start of a run. Do you know what the directive would look like to set this value?
[2013-11-01 14:27:35 -0400] thedeeno: it doesn't appear to be documented if it's possible
[2013-11-01 14:32:10 -0400] gchristensen: thedeeno: I'm not certain, but that seems counter-intuitive. chef is about removing the manual steps
[2013-11-01 14:33:31 -0400] mattupstate: thedeeno: knife supplies it on bootstrap
[2013-11-01 14:35:30 -0400] bean__: yeah, you dont want to have to do it manually
[2013-11-01 14:35:34 -0400] mattupstate: otherwise, you'll need to have another mechanism to add your secret to the file that chef-client loads
[2013-11-01 14:35:45 -0400] mattupstate: which is a pain
[2013-11-01 14:36:19 -0400] thedeeno: I'm using chef-solo atm (trying out chef-client -z today). It's still one command, I just want it to be obvious which configuration file it uses. IIRC I might just need to do add the line `encrypted_data_bag_secret "/path/to/my/file"` in my config file
[2013-11-01 14:37:44 -0400] thedeeno: yeah knife copies the file, I'm just trying to figure out what I can put in that file :)
[2013-11-01 14:38:22 -0400] mattupstate: you can put whatever you want in it, but best it be nice and random
[2013-11-01 14:38:58 -0400] mattupstate: whats the -z option do?
[2013-11-01 14:39:02 -0400] mattupstate: never used it
[2013-11-01 14:39:14 -0400] holms: yeah i heard -z too what's that?
[2013-11-01 14:39:14 -0400] thedeeno: haha, no no my secret is a long hash. I'm talking about the config file. I'm trying to figure out what the directive to change it's default path looks like
[2013-11-01 14:40:08 -0400] thedeeno: it came out last night (I just noticed cause I'm working on this at the moment). Included in the new chef 11.8, it basically runs a local chef-server.
[2013-11-01 14:40:16 -0400] thedeeno: for a single run
[2013-11-01 14:40:27 -0400] mattupstate: oh right
[2013-11-01 14:40:32 -0400] mattupstate: chef "zero"
[2013-11-01 14:40:33 -0400] thedeeno: so there's no longer a divide between solo configurations and full configs
[2013-11-01 14:40:36 -0400] thedeeno: yeah
[2013-11-01 14:41:24 -0400] thedeeno: as far as I can tell, I've been able to just run chef-client -z instead of chef-solo. Only a few tweaks to some of my files that weren't using the full chef-server syntax.
[2013-11-01 14:46:07 -0400] thedeeno: nice, yup I can just add `encrypted_data_bag_secret "/path/to/my/file"` to my config file and it will use that to decrypt databags by default
[2013-11-01 14:46:28 -0400] mattupstate: i was just about to mention that
[2013-11-01 14:47:04 -0400] thedeeno: mattupstate: well thanks for looking into it :)
[2013-11-01 14:47:22 -0400] togume: thedeeno: Right on point with the conversatoin I was about to start. One thing to be careful with is that as of the latest chef/knife, if you use the secret in the knife.rb config, it will ALWAYS use that for encrypting/decrypting.
[2013-11-01 14:47:44 -0400] togume: So, if you have a recipe which does not know what to do with encrypted data, you'll run into headaches.
[2013-11-01 14:48:14 -0400] togume: Which brings up my question, whether anyone knows how to toggle encryption/cleartext from knife cli...
[2013-11-01 14:54:21 -0400] droy: Hi all, anyone using the s3_file cookbook?  I can't seem to get it working (I'm a newcomer to chef)...
[2013-11-01 14:55:01 -0400] togume: I just tested with the latest gems, and the behavior is still there. So, lesson, unless there's something I'm missing: Careful when you place knife[:secret_file] in your knife.rb because it will encrypt every data bag item you create.
[2013-11-01 14:55:40 -0400] thedeeno: togume: interesting, thanks for highlighting that
[2013-11-01 15:04:00 -0400] pwelch: so is the preferred method of upgrading omnibus chef just to run the installer again?
[2013-11-01 15:04:06 -0400] pwelch: I dont see any mention of it on the page
[2013-11-01 15:04:49 -0400] thedeeno: pwelch: YMMV but it worked for me. 11.6 -> 11.8
[2013-11-01 15:04:59 -0400] thedeeno: just ran the installer again
[2013-11-01 15:05:33 -0400] pwelch: thedeeno: ok. Im doing 10.28 > 11.8. but thanks! Was wondering if it works
[2013-11-01 15:08:01 -0400] togume: thedeeno: et-al: FYI - create new issue around this to bring awareness and hopefully prevent future head-bashing for others: https://tickets.opscode.com/browse/CHEF-4719
[2013-11-01 15:10:07 -0400] pwelch: thedeeno: Followup: worked going from 10.28 -> 11.8 omnibus.
[2013-11-01 15:21:16 -0400] daveops: Anyone know what permissions are needed to create orgs through the API with Private/Enterprise Chef? I keep getting 403s when trying w/ my user.
[2013-11-01 15:22:11 -0400] CPS: i think the only levels are user and admin
[2013-11-01 15:22:19 -0400] CPS: you probably need admin
[2013-11-01 15:22:44 -0400] kristianpaul: hi :-)
[2013-11-01 15:26:14 -0400] daveops: CPS: Thanks. Do you know how I can make a user admin? I couldn't find anything in the docs.
[2013-11-01 15:27:11 -0400] CPS:  you can do it through the web ui. you'll need to copy/paste the private key it shows you to a .pem file on the client machine
[2013-11-01 15:27:37 -0400] tomduffield: hi kristianpaul
[2013-11-01 15:30:34 -0400] daveops: I'll try that CPS. Thanks!
[2013-11-01 15:30:43 -0400] CPS: np
[2013-11-01 15:31:09 -0400] gchristensen: I don't even ... one of my boss's cookbooks that he wrote placed a sysctl config in one cookbook, but reloads the configuration in another
[2013-11-01 15:33:36 -0400] mondo: does anyone know if the ark cookbook downloads the remote file every time chef-client is run?
[2013-11-01 15:34:12 -0400] tomduffield: mondo: depends on the version of chef-client you are running and the resource guards you are using
[2013-11-01 15:35:10 -0400] tomduffield: mondo: as of 11.6.0, remote_file has a use_conditional_get flag that will check last modified by headers: http://docs.opscode.com/resource_remote_file.html
[2013-11-01 15:35:33 -0400] mondo: ok that makes sense
[2013-11-01 15:35:54 -0400] mondo: I had a chef-client failure on a package that was already installed via ark
[2013-11-01 15:36:08 -0400] mondo: it must not have been able to connect to the remote server to check last modified
[2013-11-01 15:36:44 -0400] tomduffield: mondo: that could be
[2013-11-01 15:45:55 -0400] mondo: looks like the ark cookbook doesn't give you an option to disable the checksum check.
[2013-11-01 15:47:39 -0400] tomduffield: mondo: https://github.com/opscode-cookbooks/ark/blob/master/providers/default.rb#L47
[2013-11-01 15:47:49 -0400] tomduffield: it looks like it'll declare the checksum if you pass it in
[2013-11-01 15:47:49 -0400] thedeeno: Is there a way to disable the caching of cookbooks during a chef-client run? I'm blowing away the whole repo after each run so the cache is useless and is slowing down my run time significantly while developing
[2013-11-01 15:48:25 -0400] mondo: oh ok you're right
[2013-11-01 15:48:39 -0400] mondo: If I don't specify a checksum it won't check it.
[2013-11-01 15:53:08 -0400] mondo: tomduffield: would you mind looking at this?  https://gist.github.com/andrewfraley/7267465
[2013-11-01 15:53:31 -0400] tomduffield: mondo: yep, thats code :)
[2013-11-01 15:53:36 -0400] mondo: Everytime chef-client runs it's trying to connect to node['zabbix']['agent']['prebuild']['url']
[2013-11-01 15:53:57 -0400] bean__: sounds like it needs an idempotency check.
[2013-11-01 15:54:05 -0400] tomduffield: mondo: thats correct
[2013-11-01 15:55:18 -0400] tomduffield: it needs to talk to it in order to determine idempotency
[2013-11-01 15:55:30 -0400] tomduffield: either by checking the headers or by downloading it and comparing checksums
[2013-11-01 15:56:19 -0400] mondo: ok gotcha, so the only way to disable this is to add a not if cached file exists to my ark section
[2013-11-01 15:57:11 -0400] tomduffield: well
[2013-11-01 15:57:35 -0400] tomduffield: if you dont even want to talk to the url then yes, you need to have a resource guard that looks locally
[2013-11-01 15:58:35 -0400] mondo: Ok cool, thanks.
[2013-11-01 15:58:40 -0400] tomduffield: mondo: but like I said, if you are using >= 11.6.0 it'll automatically do a conditional-get on the headers
[2013-11-01 15:59:14 -0400] mondo: even with the resource guard?  I am running 11.6.0 btw.
[2013-11-01 15:59:45 -0400] tomduffield: no, resource guard would block it i believe
[2013-11-01 16:00:03 -0400] mondo: will test shortly
[2013-11-01 16:37:43 -0400] dgarstang: Does anyone have any idea why cookbook B would run before cookbook A, when cookbook A is BEFORE B in the run list?
[2013-11-01 16:39:22 -0400] serialsito:  are you using environment?
[2013-11-01 16:39:24 -0400] Raymii: I have two nodes which are shown by knife node list and knife node show NODENAME, but when doing a knife search node "fqdn:NODENAME" or knife search node "fqdnNODENAME*. They are also not shown on the chef server web interface status page, but are on the node and client lists. Chef client itself finishes successfully on those nodes. clients run chef client 11.8 and server is latest.
[2013-11-01 16:40:39 -0400] dgarstang: it would be oh so very helpful if chef could explicitly show the expanded run list somewhere
[2013-11-01 16:40:48 -0400] dgarstang: serialsito: moi? No.
[2013-11-01 16:43:16 -0400] tomduffield: dgarstang: expanded run_list is in the chef log output
[2013-11-01 16:44:28 -0400] dgarstang: tomduffield: my client isn't logging that
[2013-11-01 16:45:19 -0400] tomduffield: dgarstang: check your log levels
[2013-11-01 16:45:36 -0400] tomduffield: dgarstang: it should be at info/debug level
[2013-11-01 16:45:56 -0400] dgarstang: tomduffield: I'm running chef-client... whatever that log gets me
[2013-11-01 16:45:58 -0400] tomduffield: dgarstang: also, check your include_recipe calls
[2013-11-01 16:46:14 -0400] tomduffield: dgarstang: can I get gist of your log output?
[2013-11-01 16:47:02 -0400] dgarstang: tomduffield: lemme see if increasing debug level shows it
[2013-11-01 16:53:44 -0400] dgarstang: tomduffield: no mention of expanded in output with chef-client -l debug
[2013-11-01 16:53:57 -0400] tomduffield: can I see a gist of your output?
[2013-11-01 16:54:24 -0400] dgarstang: tomduffield: i'll have to scrub it... I removed the company name.... but dunno what else
[2013-11-01 16:57:32 -0400] dgarstang: tomduffield: Ugh. There's sensitive stuff in there
[2013-11-01 16:57:55 -0400] tomduffield: dgarstang: do you see the run_list in the log output/
[2013-11-01 16:58:50 -0400] dgarstang: tomduffield: explicitly 'run_list'? No. All that seems relevant is 'Loading cookbooks'
[2013-11-01 17:00:02 -0400] tomduffield: it should be in the first 5-10 lines of output
[2013-11-01 17:00:43 -0400] dgarstang: tomduffield: 'Run List is ...' but that shows the UNexpanded run list.
[2013-11-01 17:00:51 -0400] dgarstang: tomduffield: Actually...
[2013-11-01 17:01:05 -0400] dgarstang: tomduffield: 'Run List expands to [bc-role::base]' ... that's not correct
[2013-11-01 17:01:38 -0400] tomduffield: thats the downside of using include_recipe
[2013-11-01 17:01:53 -0400] tomduffield: recipes included that way dont show up in your expanded run_list
[2013-11-01 17:01:58 -0400] dgarstang: tomduffield: there's an alternative?
[2013-11-01 17:02:23 -0400] dgarstang: tomduffield: oh.. you mean put it explicitly in the node's run list?
[2013-11-01 17:02:52 -0400] tomduffield: yeah, put the recipes you declared in bc-role::base into an actualy role named base
[2013-11-01 17:03:25 -0400] dgarstang: tomduffield: err... putting them in a role fixes that?
[2013-11-01 17:04:21 -0400] troyready: ^ incidentally, that would solve your issue with the java cookbook and attributes -- you could set default attributes in the roles (e.g., java version = 7), and those would have a higher precedence than the default one in the cookbooks.
[2013-11-01 17:05:02 -0400] coderanger: dgarstang: include_recipe has no effect on the expanded run list nor is that fact that a recipe was included recorded in the node data
[2013-11-01 17:05:29 -0400] dgarstang: coderanger: oh dear
[2013-11-01 17:05:37 -0400] tomduffield: dgarstang: I really think you would benefit greatly from taking a Chef Fundamentals course. A lot of the stuff you are struggling with is covered
[2013-11-01 17:05:51 -0400] dgarstang: So, would the expanded run list show me the ALL cookbooks and their true execution order?
[2013-11-01 17:06:36 -0400] dgarstang: tomduffield: Apparently I wasn't welcome at one this week. I guess too many questions here are not well received.
[2013-11-01 17:06:59 -0400] coderanger: dgarstang: http://i.coderanger.net/oLgL3.png
[2013-11-01 17:07:59 -0400] tomduffield: dgarstang: can you expand on what you mean by "wasn't welcome"?
[2013-11-01 17:08:04 -0400] dgarstang: coderanger: is base a role or a recipe?
[2013-11-01 17:08:23 -0400] coderanger: Those are roles
[2013-11-01 17:08:28 -0400] dgarstang: tomduffield: i probably shouldn't.
[2013-11-01 17:08:31 -0400] coderanger: As in the thing designed to be used as roles
[2013-11-01 17:11:25 -0400] troyready: dgarstang, using "recipes as roles" vs just plain roles shouldn't be an issue from a cookbook ordering perspective. It very much sounds like you're encountering a compilation/execution phase issue again. http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-11-01 17:29:25 -0400] dgarstang: So, on the use of roles .... when doing that, the run list reported by chef-client is still only what's defined in the role...
[2013-11-01 17:33:34 -0400] troyready: dgarstang, that doesn't sound right. My workstation's node only has "role[companyworkstation]" in its run list
[2013-11-01 17:34:20 -0400] dgarstang: troyready: yet a chef-client run shows you all cookbooks?
[2013-11-01 17:34:33 -0400] troyready: dgarstang, but when I run chef-client, I get the following at the start: https://gist.github.com/troyready/7268914
[2013-11-01 17:34:55 -0400] troyready: Notably, "run list expands to..."
[2013-11-01 17:35:28 -0400] dgarstang: troyready: I get "Run List expands to [bc-role::base, bc-lvm]"
[2013-11-01 17:35:42 -0400] dgarstang: troyready: which is what the role has...
[2013-11-01 17:35:52 -0400] GeoffC_: Hi all, I'm trying to figure out how to connect my chef workstation to amazon ec2 to create autoscale groups
[2013-11-01 17:35:53 -0400] Brad811: So, I'm having a very strange problem. I am able to upload the cookbook "ntp" every time, but if I try to upload "build-essential" I get an error, every time.
[2013-11-01 17:36:23 -0400] dgarstang: troyready: oh maybe it's because bc-role::base is a cookbook that does include_recipe on everything
[2013-11-01 17:36:30 -0400] troyready: Yeah, exactly
[2013-11-01 17:36:34 -0400] dgarstang: bugger
[2013-11-01 17:37:01 -0400] dgarstang: thanks
[2013-11-01 17:38:23 -0400] troyready: Sure thing. FWIW, I've heard it mentioned in here long ago that it is an issue that should be improved, but I don't know if we'll see that anytime soon
[2013-11-01 17:38:56 -0400] troyready: In the meantime, the core design is centered around using roles directly, and I think you'd see a lot of benefit from that
[2013-11-01 17:41:36 -0400] dgarstang: troyready: kk.
[2013-11-01 17:49:09 -0400] dgarstang: time for a pychef question. Client management... i see nothing about clients in the pychef docs...
[2013-11-01 17:54:14 -0400] troyready: dgarstang, looks like there's definitely a need to put more documentation in the source. Seems to have a few functions in the client source: https://github.com/coderanger/pychef/blob/master/chef/client.py
[2013-11-01 17:54:52 -0400] dgarstang: troyready: oic. thanks. poor docs, always left out...
[2013-11-01 17:55:04 -0400] troyready: I just did a "import chef; api = chef.autoconfigure(); c = chef.Client('clientname'); print c.certificate" successfully
[2013-11-01 17:55:18 -0400] dgarstang: oh, but no Client.delete... it seems
[2013-11-01 17:55:52 -0400] lmickh: H3@d
[2013-11-01 17:57:01 -0400] troyready: dgarstang, I think that's defined here: https://github.com/coderanger/pychef/blob/master/chef/base.py#L114
[2013-11-01 17:58:19 -0400] dgarstang: troyready: :-O I owe you a coke
[2013-11-01 17:58:39 -0400] troyready: :)
[2013-11-01 17:59:40 -0400] simon: Hiya.
[2013-11-01 17:59:49 -0400] simon: I have an issue with overriding an attribute in an environment.
[2013-11-01 17:59:58 -0400] simon: https://github.com/spheromak/dhcp-cook/blob/master/attributes/default.rb
[2013-11-01 18:00:08 -0400] simon: Im overrideing dhcp.interfaces.
[2013-11-01 18:00:42 -0400] simon: This is my json for the environment in the chef server
[2013-11-01 18:00:43 -0400] simon: {"defaults":{"dhcp":{"networks":["172.30.5.0"],"interfaces":["eth0"]}},"overrides":{}}
[2013-11-01 18:00:58 -0400] simon: But when I run my chef recipe I get
[2013-11-01 18:00:59 -0400] simon: Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"'
[2013-11-01 18:02:12 -0400] simon: I get same when I override in overrides.
[2013-11-01 18:02:39 -0400] simon: Interestingly, when I run shef -z on the server.
[2013-11-01 18:02:46 -0400] simon: chef > node[:dhcp] => {"networks"=>["172.30.5.0"], "interfaces"=>["eth0"]}
[2013-11-01 18:03:17 -0400] simon: Chef version 11.4 btw.
[2013-11-01 18:06:03 -0400] troyready: simon, which recipe is being run in that cookbook?
[2013-11-01 18:06:23 -0400] simon: troyready: im running dhcp::server
[2013-11-01 18:07:20 -0400] spheromak: simon i have a bunch of stuff im about to push on that
[2013-11-01 18:07:31 -0400] spheromak: whats the issue
[2013-11-01 18:07:33 -0400] spheromak: ?
[2013-11-01 18:07:36 -0400] simon: http://pastebin.com/EGisb0Sn
[2013-11-01 18:07:53 -0400] spheromak: yup
[2013-11-01 18:07:58 -0400] spheromak: hold on lemme push this stuff
[2013-11-01 18:08:04 -0400] spheromak: should have that fixed
[2013-11-01 18:08:07 -0400] simon: Ah, swell :)
[2013-11-01 18:08:18 -0400] spheromak: been pending a release for weeks.. just haven't had time :D
[2013-11-01 18:09:12 -0400] simon: Oh, btw, saw that im on dhcp 2.0.0 and that there is a tag for 2.0.1
[2013-11-01 18:09:38 -0400] spheromak: yea theres a released on
[2013-11-01 18:09:41 -0400] spheromak: *one
[2013-11-01 18:09:57 -0400] spheromak: i've been a bad steward on this cook the last year
[2013-11-01 18:13:35 -0400] simon: Awfully kind spheromak :)
[2013-11-01 18:13:42 -0400] simon: I shall treat you to a beer if I meet you.
[2013-11-01 18:13:51 -0400] spheromak: https://github.com/spheromak/dhcp-cook/pull/11
[2013-11-01 18:13:58 -0400] spheromak: is the set of stuff pending
[2013-11-01 18:14:09 -0400] spheromak: if that builds on Travis ill merge and cut a community release
[2013-11-01 18:15:19 -0400] spheromak: ah i should clean up the refs to work cook server ;)
[2013-11-01 18:16:00 -0400] failshell: anyone knows if its possible with Mixlib::CLI to specify twice the same flag? like -f foo -f bar? can't seem to find that documented
[2013-11-01 18:17:14 -0400] spheromak: failshell, mostly i think people use a proc to build a list from  some delimiter
[2013-11-01 18:17:26 -0400] failshell: spheromak: yeah that
[2013-11-01 18:17:32 -0400] failshell: hwat im looking into now
[2013-11-01 18:17:44 -0400] simon: Ah, excellent friday. I have crisps an beer and looking at the travis build :3
[2013-11-01 18:18:38 -0400] GeoffC_: Hey guys, I am trying to do the multinode ec2 example on the opscode site.  Is a gemfile a separate filename.rb or is it appended to the knife.rb file?
[2013-11-01 18:19:28 -0400] spheromak: failshell, https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap.rb#L118-L123
[2013-11-01 18:20:45 -0400] failshell: spheromak: nice exactly what i needed
[2013-11-01 18:22:36 -0400] Raymii: Anybody know of a current and working corosync/pacemaker cookbook?
[2013-11-01 18:23:44 -0400] failshell: i have go say, i really like mixlib/{cli,shellout}
[2013-11-01 18:26:29 -0400] dan`: why does chef server require hostname file to be FQDN while mans say it doesn't? If I put short name to  /etc/hostname  then my hostname -f prints right FQDN but chef server cannot run.
[2013-11-01 18:27:31 -0400] spheromak: dan`, you can set the internal hostname server uses in the chef-server config
[2013-11-01 18:27:46 -0400] spheromak: by default it needs to talk to itself on some services
[2013-11-01 18:29:52 -0400] thedeeno: Is it possible to turn off cookbook caching?
[2013-11-01 18:30:57 -0400] spheromak: thedeeno, you having issues with it ?
[2013-11-01 18:31:15 -0400] spheromak: or just don't want the i/o
[2013-11-01 18:31:16 -0400] spheromak: :D
[2013-11-01 18:31:29 -0400] thedeeno: spheromak: I want to skip the i/o :)
[2013-11-01 18:32:15 -0400] spheromak: could mout it as tmpfs ;)
[2013-11-01 18:32:28 -0400] spheromak: *mount
[2013-11-01 18:33:33 -0400] thedeeno: hmm, that's possible. Would be easier if I could just turn it off though, I guess that's not possible?
[2013-11-01 18:34:09 -0400] spheromak: don't think so
[2013-11-01 18:34:16 -0400] spheromak: not 100% tho ;)
[2013-11-01 18:34:26 -0400] spheromak: its pretty central to client-run
[2013-11-01 18:36:11 -0400] thedeeno: I'll try the tmpfs. I'm trying out chef-zero today and it's much slower than chef-solo because it appears to be indexing my cookbooks, rather than just serving them.
[2013-11-01 18:38:57 -0400] spheromak: thedeeno, ah
[2013-11-01 18:39:15 -0400] spheromak: thedeeno, dunno jkeiser might be able to help you out there :D
[2013-11-01 18:39:17 -0400] jkeiser: thedeeno: worth filing an issue for sure.  I'm fairly certain there's no way to do it now
[2013-11-01 18:39:52 -0400] CPS: in a recipe i need to detect windows server 2003 vs 2008. how do i do that? what platform does chef report those two as?
[2013-11-01 18:40:01 -0400] spheromak: simon just making sure everything builds in kitchen then will push to community  a 2.1.0  on dhcp
[2013-11-01 18:40:22 -0400] JeanMertz: Is there a way to notify an "include_recipe"-like LWRP to include a recipe at the end of a run?
[2013-11-01 18:40:22 -0400] spheromak: simon if you want to test out the master branch go for it and let me know if you have issues.
[2013-11-01 18:40:29 -0400] simon: Yeah, i tried running kithcen on my local machine, but there seems to be issue s:(
[2013-11-01 18:40:38 -0400] thedeeno: jkeiser: will do
[2013-11-01 18:40:53 -0400] jkeiser: thedeeno: we really don't want to short-circuit much behavior so that we can be sure chef-client -z and chef-client behavior is the same, but that seems like a good candidate for it
[2013-11-01 18:41:17 -0400] spheromak: simon yea the service restart
[2013-11-01 18:41:48 -0400] thedeeno: jkeiser: can you point me to the general area in the code this logic resides? maybe I can attach a pull request if I can grok it fast enough.
[2013-11-01 18:42:23 -0400] simon: spheromak: indeed. It looks like one should try to start dhcp until every file is in place.
[2013-11-01 18:42:32 -0400] spheromak: simon is it the centos build restarting service that broke for you ? i think cause i setup a test on lo:0  and centos doesn't like this
[2013-11-01 18:42:33 -0400] jkeiser: thedeeno: it's actually not in chef-zero itself, I'll take a look here
[2013-11-01 18:42:51 -0400] thedeeno: jkeiser: cool
[2013-11-01 18:43:00 -0400] simon: spheromak: yep centos indeed.
[2013-11-01 18:43:41 -0400] simon: spheromak: should I pastebin the output?
[2013-11-01 18:44:08 -0400] spheromak: simon no same issue i see. just making sure thanks
[2013-11-01 18:45:27 -0400] josephholsten: could any opscoders tell me what revision of chef_wm in included in the omnibus chef-server 10.0.8?
[2013-11-01 18:45:44 -0400] josephholsten: sfalcon: ^^
[2013-11-01 18:46:19 -0400] sfalcon: josephholsten: yeah, I might be able to help you with that :)
[2013-11-01 18:46:41 -0400] josephholsten: if only there were version tags in the repo ;-)
[2013-11-01 18:46:41 -0400] sfalcon: So if you really mean omnibus Chef Server 10.x, then there should not be *any* version of chef_wm included.
[2013-11-01 18:46:59 -0400] josephholsten: um, 11.0.8
[2013-11-01 18:47:09 -0400] jkeiser: thedeeno: pretty sure it would be here: https://github.com/opscode/chef/blob/master/lib/chef/client.rb#L236-L247
[2013-11-01 18:47:20 -0400] jkeiser: thedeeno: might even be as easy as letting local mode take the first path
[2013-11-01 18:47:28 -0400] sfalcon: ok, then. :) Look in /opt/chef-server/version.txt for the erchef version.
[2013-11-01 18:47:45 -0400] josephholsten: also, if I meant omnibus chef-server 10, I would be insane as omnibus server didn't exist yet
[2013-11-01 18:48:16 -0400] jkeiser: thedeeno: like if Chef::Config.solo || (Chef::Config.local_mode && !Chef::Config.versioned_cookbooks)
[2013-11-01 18:48:25 -0400] jkeiser: thedeeno: instead of if Chef::Config[:solo]
[2013-11-01 18:48:41 -0400] ggolin: hi all
[2013-11-01 18:48:45 -0400] spheromak: jkeiser,  could be interesting to have a toggle
[2013-11-01 18:48:49 -0400] sfalcon: josephholsten: there's a tag in erchef repo for each version. And the repo includes rebar.config.lock which references the tag or SHA for all erchef deps.
[2013-11-01 18:49:15 -0400] josephholsten: ah, awesome
[2013-11-01 18:49:24 -0400] jkeiser: spheromak: could be  what do you think might be the use in it?
[2013-11-01 18:49:29 -0400] ggolin: hey miah, you pasted a link to a blog entry about chef run queue, and i cannot find it anymore.
[2013-11-01 18:49:34 -0400] sfalcon: josephholsten:  you trying to track a bug or add something?
[2013-11-01 18:49:36 -0400] ggolin: this was several days ago :/
[2013-11-01 18:50:00 -0400] ggolin: never mind, found it :)
[2013-11-01 18:50:30 -0400] josephholsten: sfalcon: yeah, started digging here https://botbot.me/freenode/chef/msg/7424694/
[2013-11-01 18:51:46 -0400] thedeeno: jkeiser: ha, nice. Sounds like you've already figured it out. I'll take a closer look :)
[2013-11-01 18:51:56 -0400] josephholsten: also, this version of chef-server has no version.txt anywhere in /opt/chef-server
[2013-11-01 18:52:06 -0400] sfalcon: josephholsten: got it. Sorry nobody was around to help at the time.
[2013-11-01 18:52:14 -0400] jkeiser: thedeeno: educated speculation :)  I could be totally wrong
[2013-11-01 18:52:19 -0400] sfalcon: hmm. Maybe I misremembered the path.
[2013-11-01 18:52:52 -0400] sfalcon: sec, I will spin up a vm
[2013-11-01 18:52:53 -0400] josephholsten: I checked all the files in `dpkg -L chef-server`
[2013-11-01 18:53:12 -0400] josephholsten: erchef files are /opt/chef-server/embedded/service/erchef/
[2013-11-01 18:54:41 -0400] josephholsten: oooh /opt/chef-server/embedded/service/erchef/releases/RELEASES
[2013-11-01 18:54:44 -0400] sfalcon: josephholsten: my bad, how about /opt/chef-server/version-manifest.txt
[2013-11-01 18:55:32 -0400] josephholsten: and I now have a rabbit hole to fall down! erchef 1.2.6
[2013-11-01 18:56:18 -0400] sfalcon: Before you go. You should know that omnibus-chef-server master includes a complete update on the cookbook dep solving.
[2013-11-01 18:56:34 -0400] josephholsten: btw, 11.0.8 is the latest chef-server release, right?
[2013-11-01 18:56:46 -0400] sfalcon: Yes, that's the latest release.
[2013-11-01 18:56:58 -0400] sfalcon: You can grab a nightly build to test with if you're up for that.
[2013-11-01 18:57:00 -0400] spheromak: sfalcon, there tickets on that stuff ? wuold like to read up on the changes re: depsolver
[2013-11-01 18:57:24 -0400] spheromak: since thats pretty much the bane of my existence these days (unsolvable versions) :D
[2013-11-01 18:57:26 -0400] josephholsten: I noticed that, was trying to see if what the issue was touching, I'm having trouble creating repro steps
[2013-11-01 18:57:47 -0400] sfalcon: spheromak: yeah, I think i can find the ticket.
[2013-11-01 18:58:02 -0400] josephholsten: spheromak: I may have a ticket that could use your :eyes:
[2013-11-01 18:58:37 -0400] josephholsten: https://tickets.opscode.com/browse/CHEF-4694
[2013-11-01 18:58:47 -0400] josephholsten: is that what you're hitting?
[2013-11-01 18:59:09 -0400] sfalcon: Since we're here the erlang based depsolver could get into an exponential time situation. This would result in the erchef beam process hogging CPU. And nodes with a run list that would trigger it would never be able to complete a CCR
[2013-11-01 18:59:22 -0400] spheromak: yea
[2013-11-01 18:59:38 -0400] sfalcon: The original solver was based on gecode, a C++ constraint solver that is much more powerful.
[2013-11-01 18:59:46 -0400] spheromak: sfalcon, that was that issue i reported way back, but couldn't get enough info to you.. then my tickets.opscode account went fubar
[2013-11-01 19:00:01 -0400] chromcar: I am trying to override an attribute, which is defined in opscode tomcat: 'attributes/default.rb' => default["tomcat"]["keytool"] = "/usr/lib/jvm/default-java/bin/keytool" . I have tried adding to my wrapper cookbook: 'recipe/default' => node.override["tomcat"]["keytool"] = '/usr/bin/keytool' or node.default["tomcat"]["keytool"] = '/usr/bin/keytool' or in  'attributes/default.rb' =>  node.override["tomcat"]["keytool"] = '/usr/bin/key
[2013-11-01 19:00:05 -0400] chromcar: What am I doing wrong?
[2013-11-01 19:00:40 -0400] josephholsten: sfalcon: I assume we aren't going to go back to a gecode wrapper? seems like the omnibus install avoids the annoying dependency issues that caused most people pain
[2013-11-01 19:00:41 -0400] sfalcon: So in Hosted Chef and now (in nightlies of OSC) we replaced the erlang solver with the gecode based approach that we started out with. It isn't as elegant eng-wise, but it is faster and works :P
[2013-11-01 19:00:54 -0400] josephholsten: <3
[2013-11-01 19:00:56 -0400] spheromak: josephholsten, that sounds like the same issue.
[2013-11-01 19:01:26 -0400] spheromak: sfalcon, is it something jkeiser could mimic in chef-zero ?
[2013-11-01 19:01:47 -0400] spheromak: would be good to have the same solver algos in zero and server (and in berks and librarian) but...
[2013-11-01 19:01:55 -0400] josephholsten: erg, mimicing that in pure ruby sounds unpleasant
[2013-11-01 19:02:01 -0400] sfalcon: So yeah, we *are* back to the gecode wrapper. For now it is really the same as it was in 10 (ruby gem wrapping interaction with gecode) and now some erlang glue to talk to it.
[2013-11-01 19:02:11 -0400] spheromak: ah
[2013-11-01 19:02:37 -0400] spheromak: so we could write an optional code-path for zero that wrapped gcode ala old chef-server to get the same logic
[2013-11-01 19:02:51 -0400] josephholsten: spheromak: it's really an awesome contstraint solver lib: http://www.gecode.org
[2013-11-01 19:03:01 -0400] gyre007: is there a way how I can tell file resource to create file in users home directory without giving it a full path ?
[2013-11-01 19:03:12 -0400] sfalcon: Well pretty sure jkeiser reimplemented constraint solving while doing the nytimes crossword and chasing after his children in 20 lines of Ruby, but I'd have to check. :)
[2013-11-01 19:03:35 -0400] spheromak: josephholsten, i know it is ;D
[2013-11-01 19:03:55 -0400] jkeiser: It's not impossible to have a switch that would turn it on if you really want it, but gecode is a dependency I'd hesitate to force on most users
[2013-11-01 19:04:17 -0400] spheromak: sfalcon, i know the zero code is bute force jkeiser and i had a hangout about it cause i ran into issues where server and zero weren't in agreement about things.
[2013-11-01 19:04:24 -0400] jkeiser: And copying gecode's behavior is  probably not in the cards :)
[2013-11-01 19:04:28 -0400] josephholsten: that's mostly me saying I won't volunteer. if it's okay to not have a performant impl, constraint resolution is actually a simple problem to 'solve'
[2013-11-01 19:04:35 -0400] jkeiser: spheromak: was that the ultimate conclusion of that?
[2013-11-01 19:04:37 -0400] spheromak: jkeiser, yea fully agree. but for my  integration tests it would be nice
[2013-11-01 19:04:58 -0400] spheromak: jkeiser, tbh i think It was my issues. and it was that zero was a bit looser. so was berks
[2013-11-01 19:05:09 -0400] spheromak: than what chef-server was
[2013-11-01 19:05:13 -0400] sfalcon: Where I'd really like to see us go is a "take two" on how cookbook deps work across the board. And likely end up in a place where we don't need nearly so much hard-core-solving
[2013-11-01 19:05:14 -0400] josephholsten: so it's easy to make two solvers that are provably equivalent in result, we'll just never get the perf of gecode
[2013-11-01 19:05:41 -0400] spheromak: jkeiser, i really apreciate the time you took to walk through it though.  It helped me add some  hacky debugging output to resolve where the issues in my cooks were
[2013-11-01 19:05:47 -0400] sfalcon: constraint solving and easy go together like...
[2013-11-01 19:05:55 -0400] spheromak: sfalcon, lol
[2013-11-01 19:06:01 -0400] josephholsten: sfalcon: package/dep management is one of the truly hard problems of sysadmin
[2013-11-01 19:06:13 -0400] spheromak: dep hell is the bane
[2013-11-01 19:06:24 -0400] spheromak: static binaries for life!
[2013-11-01 19:06:27 -0400] jkeiser: constraint solver was the actual thing I wrote in the Black Friday line (not the whole server)
[2013-11-01 19:06:32 -0400] spheromak: *nods
[2013-11-01 19:07:05 -0400] sfalcon: yar. and so that's why I think it is really worth considering some aikido moves where we redefine the problem to make it easier to solve.
[2013-11-01 19:07:28 -0400] jkeiser: +1
[2013-11-01 19:07:31 -0400] spheromak: sfalcon, i would be 100%  for that
[2013-11-01 19:07:33 -0400] jkeiser: spheromak: anytime :)
[2013-11-01 19:07:49 -0400] sfalcon: jkeiser: I love that story. :)
[2013-11-01 19:07:52 -0400] josephholsten: sfalcon: boolean satisfiability is the defacto standard for np-complete problems, proving something is np-complete usually involves reducing the problem to SAT
[2013-11-01 19:09:31 -0400] josephholsten: to get back to useful discussion
[2013-11-01 19:09:36 -0400] spheromak: josephholsten, heh
[2013-11-01 19:10:11 -0400] josephholsten: is there a plan for when the gecode solver would get released? in the 11.0.x series? before 12.0?
[2013-11-01 19:10:19 -0400] spheromak: josephholsten, yea so basically.  were screwed ;) and dephell effects all of compsci cause of satisfiability
[2013-11-01 19:10:44 -0400] spheromak: or rather dephell is a side effect of SAT ;)
[2013-11-01 19:10:54 -0400] sfalcon: josephholsten: the upgraded solver (gecode based) will be in the next release of OSC which right now is "scheduled" for late Jan.
[2013-11-01 19:11:33 -0400] josephholsten: awesome. is the team who got that done coming to the community summit? I need to start tracking who to buy beers
[2013-11-01 19:11:54 -0400] sfalcon: We'll be there :)
[2013-11-01 19:14:11 -0400] sfalcon: Marc Paradise (mparadise), Stephen Delano, and Mark Anderson all put in big effort to build/verify/deliver the rewrapped solver for erchef.
[2013-11-01 19:16:54 -0400] spheromak: sfalcon, what are your ideas re: new system for cook deps ?
[2013-11-01 19:16:59 -0400] spheromak: if you can discuss
[2013-11-01 19:17:09 -0400] spheromak: or we can maybe talk @ summit about this
[2013-11-01 19:29:38 -0400] TrinitronX: anyone familiar with using knife ssh tmux?
[2013-11-01 19:30:33 -0400] TrinitronX: I'm trying to run something like: knife ssh "name:node-name-*" tmux
[2013-11-01 19:30:49 -0400] TrinitronX: but not seeing any tmux sessions or windows opened
[2013-11-01 19:34:37 -0400] Skeletor1: Hi all, I have a question in regard to using databags  and how to access them. So I have my databag called passwords, and in that databag I have my services that have passwords stored in them.  For example webapp, in webapp I have my passwords for rds and s3 stored it in based on regions. Is this a best practices to store my usernames and passwords in the databag?
[2013-11-01 19:34:52 -0400] JayF: You need to use encrypted data bags if you're storing secrets.
[2013-11-01 19:35:16 -0400] JayF: and because those are one of the only ways to "securely" store things for use in chef, I'd absolutely use them to store the secrets.
[2013-11-01 19:37:59 -0400] sfalcon: spheromak: stepped away for a bit. Nothing secret. But chatting at summit about it would be ++
[2013-11-01 19:38:19 -0400] spheromak: sure ill buy drinks :D
[2013-11-01 19:39:45 -0400] Skeletor1: I am using encrypted databags, the question is,  is this the right way of going about using the databag to store passwords in chef based using aws. The databag looks liek this: id(service i.e webapp),  env(production, staging), region(us-west-2, us-west-1), service(s3, rds), then credentials?
[2013-11-01 19:40:26 -0400] Skeletor1: credentials( db_username, db_password)
[2013-11-01 19:42:24 -0400] teukka: sigh, I'm happy that `Chef::Provider::File.join` does not exist and do something totally different than `File.join` =)
[2013-11-01 19:45:43 -0400] Skeletor1: This is an exmple of what I have: http://pastebin.com/j4U0i1NR
[2013-11-01 19:47:35 -0400] coderanger: teukka: Where are you hitting that? It should only happen in LWRPs at this point
[2013-11-01 19:50:16 -0400] teukka: coderanger: yeah, I just copied a bit of logic from a recipe to a LWRP. I sure know the issue, just didn't pay attention. And thought it's good it at least crashes the run :)
[2013-11-01 19:50:38 -0400] coderanger: teukka: Ahh, that would do it :)
[2013-11-01 19:54:00 -0400] teukka: class Chef::Provider::File; def self.join(*args); FileUtils.rm_f(::File.join(*args)); end; end
[2013-11-01 19:54:05 -0400] teukka: or something ;)
[2013-11-01 19:54:29 -0400] spheromak: ::File 4tw
[2013-11-01 19:54:37 -0400] spheromak: :\
[2013-11-01 19:54:59 -0400] spheromak: coderanger, wasn't there a big discussion about this on the ml a while ago
[2013-11-01 19:55:23 -0400] teukka: yeah there was
[2013-11-01 19:55:27 -0400] coderanger: Yeah, there was talk about mixing ::File in to make it not a crash bug
[2013-11-01 19:55:36 -0400] coderanger: but I think it was determined that fixing it for recipes was enough
[2013-11-01 19:55:42 -0400] spheromak: yea
[2013-11-01 19:55:45 -0400] spheromak: i think its ok
[2013-11-01 19:58:07 -0400] supercom32: Forgive me, but I'm rather new to Chef. I tried looking at a recipe such as: http://pastebin.com/w2vmuEZa . It seems simple enough, but I don't really understand how it works. For example, how does it know where to get Firefox?
[2013-11-01 19:58:45 -0400] coderanger: supercom32: Thats the URL
[2013-11-01 19:58:47 -0400] supercom32: Is the download location defined somewhere else, outside of the recipe file?
[2013-11-01 19:59:03 -0400] coderanger: supercom32: Yeah, look at attributes/default.rb
[2013-11-01 19:59:13 -0400] coderanger: You'll see it has the URL to an installer exe
[2013-11-01 19:59:14 -0400] hamush: hi, i'm new to chef.. i'm in an org that uses roles and recipes, but no one here knows what the difference is... are they different tools that accomplish the same thing? is one deprecated?
[2013-11-01 19:59:25 -0400] supercom32: coderanger: Ahhh
[2013-11-01 19:59:50 -0400] coderanger: hamush: roles are 1) fully declarative and 2) managed differently
[2013-11-01 20:00:16 -0400] coderanger: hamush: There is some wiggle room between them, but I would start out using roles for actual roles
[2013-11-01 20:00:22 -0400] supercom32: coderanger: For this example with firefox, I assume the product you are trying to install needs to support command line (ie. non interactive) installations?
[2013-11-01 20:00:31 -0400] coderanger: supercom32: Yes
[2013-11-01 20:00:57 -0400] coderanger: supercom32: The windows_package resource speaks MSIs I know, and I think it does NSIS-style installers that support unattended mode
[2013-11-01 20:01:18 -0400] supercom32: coderanger: Ah, thats neat.
[2013-11-01 20:05:51 -0400] hamush: coderanger: are there any rules of thumb for what makes a good role vs a recipe?  like for instance, if i have a program i want to be installed on multiple servers - would it make since to configure that as a role or a recipe?
[2013-11-01 20:06:22 -0400] coderanger: hamush: A recipe is generally a piece of software, like apache or postgres or $yourapp
[2013-11-01 20:06:37 -0400] coderanger: a role is something like webserver or appserver or loadbalanced
[2013-11-01 20:06:41 -0400] coderanger: loadbalancer
[2013-11-01 20:07:02 -0400] hamush: hmm... so i might be able to clumsily think of a role as a meta-recipe, then?
[2013-11-01 20:07:12 -0400] coderanger: Yeah, roles are groups of recipes
[2013-11-01 20:07:26 -0400] hamush: cool, i think i'm getting the picture
[2013-11-01 20:18:39 -0400] timsmith: is there a code review today?
[2013-11-01 20:24:16 -0400] cparedes: hey folks: not sure what's going on here, i'm validating a LWRP resource attribute with type 'Array' and am passing in an array, but i'm getting this error right now: Option disks must be a kind of Array!  You passed ", ".
[2013-11-01 20:24:25 -0400] cparedes: attribute: disks ["/dev/xvdf", "/dev/xvdh"]
[2013-11-01 20:24:34 -0400] cparedes: what's going on here?
[2013-11-01 20:25:09 -0400] thedeeno: If I wanted to ducktype a Chef built in class, where would you recommend I put that code so that it's applied in chef-client run?
[2013-11-01 20:32:30 -0400] idlemichael: hey all -- i'm using other attributes to configure other attributes in my attributes/default.rb file. it looks like these attributes that rely on previously defined attributes cannot be overridden no matter what. does that sound correct?
[2013-11-01 20:32:34 -0400] supercom32: I noted that inside a cookbook, there is a recipe folder with a "default.rb" file. I assume this is only used because there is one recipe in the example? I can create as many as I want in the format <YourRecipe>.rb?
[2013-11-01 20:32:47 -0400] idlemichael: yes supercom32
[2013-11-01 20:32:53 -0400] idlemichael: you can create as many recipes as you want supercom32
[2013-11-01 20:33:09 -0400] supercom32: idlemichael: Sweet.
[2013-11-01 20:33:09 -0400] idlemichael: you reference htem as cookbook::recipe_name
[2013-11-01 20:36:55 -0400] idlemichael: if i set "node.set['java']['jdk_version'] = '7'" in https://github.com/opscode-cookbooks/java/blob/master/attributes/default.rb, the node['java']['openjdk_packages'] are still for java 6 -- any ideas why?
[2013-11-01 20:38:57 -0400] dan3: try "override['java']['jdk_version'] = '7'
[2013-11-01 20:39:18 -0400] dan3: "
[2013-11-01 20:41:16 -0400] idlemichael: dan3: [2013-11-01T20:41:05+00:00] INFO: Processing log[jdk version: 7 open jdk packages openjdk-6-jdkopenjdk-6-jre-headless] action write (java::lol line 3)
[2013-11-01 20:41:42 -0400] idlemichael: i made the java::lol recipe just to try and override the default attributes before running the openjdk recipe
[2013-11-01 21:08:57 -0400] Skeletor1: Can I put conditionals in templates, specifically in the variables sections for example :db_password => if node.provider == "ec2" ec2_db_password else node[:webapp][:db_password] end ?
[2013-11-01 21:09:57 -0400] Skeletor1: What I just said makes no sense, better todo that in the template
[2013-11-01 21:10:02 -0400] Skeletor1: erb
[2013-11-01 21:30:10 -0400] navid_: How do I upgrade knife on the mac?
[2013-11-01 21:31:49 -0400] gchristensen: navid_: you can run this: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-11-01 21:32:05 -0400] navid_: thanks!
[2013-11-01 21:32:10 -0400] gchristensen: you're welcome
[2013-11-01 21:36:55 -0400] holms: dear people can somebody explain me how touse chef docs?
[2013-11-01 21:37:21 -0400] holms: i wen there to get  syntax of attributes, where to write them, some xamples or smtng http://docs.opscode.com/chef_overview_attributes.html
[2013-11-01 21:37:28 -0400] holms: only got names and usuless text
[2013-11-01 21:37:49 -0400] holms: (stupid packages loss =/)
[2013-11-01 21:38:55 -0400] coderanger: holms: Those are reference docs
[2013-11-01 21:39:05 -0400] coderanger: holms: If you are looking for a tutorial try learnchef.opscode.com
[2013-11-01 21:39:10 -0400] holms: thanks :)
[2013-11-01 21:40:41 -0400] holms: k any syntax reference then?
[2013-11-01 21:40:59 -0400] holms: cause else i don't care actually, it's working just don't know what to write in json file
[2013-11-01 21:41:38 -0400] holms: like you go in here and see everything clear http://docs.puppetlabs.com/puppet/2.7/reference/lang_variables.html
[2013-11-01 21:41:44 -0400] holms: anything for chef like this?
[2013-11-01 21:43:16 -0400] coderanger: holms: I'm not quite sure what you are asking
[2013-11-01 21:43:30 -0400] holms: there's a code samples
[2013-11-01 21:43:33 -0400] coderanger: Chef attributes aren't (always) related to JSON and the format varies depending on what you are writing
[2013-11-01 21:43:52 -0400] coderanger: (roles vs. cookbooks vs. environments vs. direct node manipulation)
[2013-11-01 21:43:53 -0400] holms: i mean not the case samples, but just says where to write and how to write
[2013-11-01 21:44:10 -0400] coderanger: holms: You haven't said what you are trying to write
[2013-11-01 21:44:16 -0400] holms: maybe i should ask straight then ))
[2013-11-01 21:44:19 -0400] coderanger: Do you mean the attributes file in a cookbook?
[2013-11-01 21:44:38 -0400] coderanger: There are indeed many example snippets on the page you linked
[2013-11-01 21:44:42 -0400] coderanger: you just have to scroll down
[2013-11-01 21:44:44 -0400] holms: nodes/mynode.json there's run_list in there, I want to change attribute in cookbook from there, cauase i'm using 3rd party one
[2013-11-01 21:45:18 -0400] coderanger: In general we don't recommend doing that, better to change it via a role if at all possible
[2013-11-01 21:45:29 -0400] holms: ah ok
[2013-11-01 21:45:33 -0400] holms: so i'm doing this wrong
[2013-11-01 21:45:35 -0400] coderanger: setting attributes directly in a node generally makes for fragile systems
[2013-11-01 21:46:01 -0400] coderanger: but if you want to do it, the format is "normal": {"foo": "bar"}
[2013-11-01 21:46:30 -0400] supercom32: Question: In an attribute file, I see entries like "default['apache']['dir'] = ..." for example. In others, I see "default['firefox']['http_url']. Are the options 'dir' and 'http_url' just descriptions, or are they really reserved words describing the data to come?
[2013-11-01 21:47:22 -0400] holms: coderanger: i will ask you straight, just because it's 22h in here and I wanna go from office, but i'll promise to read docs next time :D
[2013-11-01 21:47:45 -0400] holms: https://github.com/lusis/chef-kibana there's node['kibana']['webserver']  option which can be changed from default to 'nginx' cause by default it will be apache
[2013-11-01 21:48:20 -0400] coderanger: holms: In your logstash or kibana role, add this
[2013-11-01 21:48:30 -0400] holms: i though i can do this here: http://pastie.org/8449054
[2013-11-01 21:48:41 -0400] coderanger: override_attributes(kibana: {webserver: 'nginx'})
[2013-11-01 21:48:44 -0400] coderanger: and you'll be all set
[2013-11-01 21:48:52 -0400] holms: it's in the role right?
[2013-11-01 21:48:56 -0400] coderanger: Yes
[2013-11-01 21:49:04 -0400] holms: it's empty, is it also should be myhostname.json?
[2013-11-01 21:49:07 -0400] coderanger: Though it doesn't look like you are using roles in there
[2013-11-01 21:49:29 -0400] holms: yes i'm actually don't
[2013-11-01 21:49:57 -0400] coderanger: So 1) you should use roles in the future since they make this much easier and 2) in that node JSON add "normal": {"kibana": {"webserver": "nginx"}}
[2013-11-01 21:50:38 -0400] holms: understood, will read about roles monday :) thank you for your patience
[2013-11-01 22:05:48 -0400] sethvargo: Ohai Chef's, I just released Test Kitchen 1.0.0.beta.4: https://t.co/SJp9DJYqeM. Diff: https://t.co/jrmPDZ77jW
[2013-11-01 22:05:57 -0400] sethvargo: Whats left for Test Kitchen 1.0? Glad you asked: https://t.co/jfbLHsDHiF!
[2013-11-01 22:08:21 -0400] sn0wb1rd: sethvargo: welcome back to IRC
[2013-11-01 22:11:17 -0400] holms: coderanger: got one weird problem  ERROR: Cookbook kibana not found. If you're loading kibana from another cookbook, make sure you configure the dependency in your metadata
[2013-11-01 22:11:30 -0400] holms: http://community.opscode.com/cookbooks/kibana
[2013-11-01 22:11:37 -0400] holms: cache?
[2013-11-01 22:11:50 -0400] coderanger: holms: Not sure how you are using Chef, so I can say much in general
[2013-11-01 22:12:00 -0400] holms: it's chef solo
[2013-11-01 22:12:00 -0400] coderanger: holms: Guessing you are using chef-solo though?
[2013-11-01 22:12:07 -0400] holms: knife solo cook myhostname
[2013-11-01 22:12:11 -0400] coderanger: Okay, and how are you transfering cookbooks to the target machine?
[2013-11-01 22:12:20 -0400] holms: with that command
[2013-11-01 22:12:51 -0400] holms: there's vagrant vm
[2013-11-01 22:12:59 -0400] holms: there's knife-solo gem ( i think)
[2013-11-01 22:13:09 -0400] holms: first you provision vm then you cook it :)
[2013-11-01 22:13:34 -0400] coderanger: So knife solo just copies over the current folder
[2013-11-01 22:13:40 -0400] holms: probably yes
[2013-11-01 22:13:45 -0400] coderanger: do you have a cookbooks/kibana/metadata.rb?
[2013-11-01 22:14:06 -0400] holms: oh lol it's downloaded
[2013-11-01 22:14:12 -0400] coderanger: Hmm?
[2013-11-01 22:14:28 -0400] holms: no folder kibana in cookbooks/
[2013-11-01 22:14:34 -0400] coderanger: Are you using berkshelf then?
[2013-11-01 22:14:41 -0400] holms: librarian
[2013-11-01 22:14:53 -0400] holms: k found knife solo clean le me try that
[2013-11-01 22:14:55 -0400] coderanger: And you added it to your cheffile?
[2013-11-01 22:15:21 -0400] holms: that what i've worked *me baka*
[2013-11-01 22:15:40 -0400] holms: forgot*
[2013-11-01 22:17:24 -0400] holms: coderanger: you working here full time :))?
[2013-11-01 22:17:30 -0400] coderanger: Hmm?
[2013-11-01 22:17:38 -0400] holms: you always seems to be available
[2013-11-01 22:18:01 -0400] holms: perfect: (kibana::default line 34) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for ruby1.9.1-full
[2013-11-01 22:18:10 -0400] coderanger: Yes, a decent portion of my job is outreach and education, Balanced takes community leadership seriously :)
[2013-11-01 22:18:34 -0400] holms: you really good at it ))
[2013-11-01 22:19:10 -0400] coderanger: holms: If you are installing stuff from lusis it is almost certainly expecting his omnibus stack, I've not used it yet though so I can't provide much guidance there
[2013-11-01 22:19:31 -0400] coderanger: holms: He is in UTC-4, and is pretty responsive to questions on Twitter though
[2013-11-01 22:21:13 -0400] holms: em what is lusis and omnibus stack :)
[2013-11-01 22:22:12 -0400] coderanger: lusis is someone that wrote a kibana cookbook, though on closer inspection it isn't the one you are using :)
[2013-11-01 22:22:14 -0400] coderanger: So never mind
[2013-11-01 22:22:30 -0400] coderanger: His is https://github.com/lusis/chef-kibana
[2013-11-01 22:25:12 -0400] holms: oh good i've submited to wrong repo ))))))
[2013-11-01 22:25:33 -0400] holms: bug*
[2013-11-01 22:26:16 -0400] holms: coderanger: any solution to that?
[2013-11-01 22:26:21 -0400] holms: omnibus-chef ?
[2013-11-01 22:27:34 -0400] coderanger: holms: I can't tell what kibana cookbook you are using
[2013-11-01 22:28:01 -0400] coderanger: The realityforge one doesn't have a line 34 in that file, and in lusis' line 34 isn't a package install
[2013-11-01 22:28:39 -0400] coderanger: Also doesn't kibana ship with logstash these days?
[2013-11-01 22:30:53 -0400] Skeletor1: When using encrypted databags, how are you all distributing the secret file onto the node?
[2013-11-01 22:31:09 -0400] coderanger: Skeletor1: knife bootstrap copies it from your local machine automatically I think
[2013-11-01 22:31:13 -0400] holms: coderanger: it was moved out from logstash cookbook , they said to use chef-kebana cookbook.
[2013-11-01 22:31:20 -0400] coderanger: but the real answer is "very carefully"
[2013-11-01 22:31:21 -0400] holms: ok i wonder which one librarian installed lol
[2013-11-01 22:32:03 -0400] coderanger: Skeletor1: Secrets management is super hard :(
[2013-11-01 22:34:15 -0400] holms: coderanger: it's https://github.com/rashidkpc/Kibana =/
[2013-11-01 22:34:19 -0400] Skeletor1: coderanger: Heh, yeah I was thinking carefully also, its a chicken before the egg case.
[2013-11-01 22:35:21 -0400] coderanger: holms: Thats 1) not a cookbook and 2) thats the repo for the old kibana 2 that you don't want to use
[2013-11-01 22:35:37 -0400] holms: hmz, how can I specify repo in nodes/host.json ?
[2013-11-01 22:35:43 -0400] holms: or librarian or what
[2013-11-01 22:35:48 -0400] holms: now im confused
[2013-11-01 22:35:59 -0400] miah: it has to be a cookbook, not just any code repository
[2013-11-01 22:36:12 -0400] coderanger: holms: What does your cheffile look like?
[2013-11-01 22:38:16 -0400] holms: coderanger: http://pastie.org/8449155
[2013-11-01 22:38:46 -0400] coderanger: holms: Okay, so you are using the realityforge cookbook
[2013-11-01 22:39:12 -0400] coderanger: holms: Ahh, I was looking at master
[2013-11-01 22:39:13 -0400] coderanger: derp
[2013-11-01 22:39:15 -0400] holms: so we also have to choose repos somehow..
[2013-11-01 22:39:21 -0400] coderanger: https://github.com/realityforge/chef-kibana/blob/0.1.6/recipes/default.rb#L33-L37
[2013-11-01 22:39:25 -0400] coderanger: Thats the line with the errors
[2013-11-01 22:39:31 -0400] coderanger: I would really use lusis' cookbook though
[2013-11-01 22:40:06 -0400] holms: how to specify a repo?
[2013-11-01 22:40:29 -0400] holms: k idiotic quesiton
[2013-11-01 22:40:40 -0400] holms: from paste it's obvious
[2013-11-01 22:40:41 -0400] coderanger: holms: Its been a while since I used librarian
[2013-11-01 22:40:51 -0400] holms: that's how: pastie.org/8449155
[2013-11-01 22:40:53 -0400] holms: in comments :D
[2013-11-01 22:40:56 -0400] coderanger: But yeah, use https://github.com/lusis/chef-kibana :)
[2013-11-01 22:41:27 -0400] holms: started 9am now it's 22:40..but challenge is challenge
[2013-11-01 22:46:02 -0400] coderanger: holms: If it makes you feel better, after I tackle Jenkins, logstash is next on my list of things to make easy :)
[2013-11-01 22:48:06 -0400] holms: coderanger: thnx ))))
[2013-11-01 22:48:24 -0400] miah: coderanger: I'd <3 your assistance. https://github.com/miah/chef_logstash
[2013-11-01 22:48:45 -0400] cwj: freaking jenkins
[2013-11-01 22:48:53 -0400] coderanger: miah: :) There will be blood
[2013-11-01 22:48:58 -0400] miah: im fine with blood
[2013-11-01 22:49:16 -0400] miah: there are several yaks i want to shave in there
[2013-11-01 22:49:19 -0400] cwj: every time i think i have a handle on automating it, lol we changed all the plugins"
[2013-11-01 22:49:27 -0400] miah: ya
[2013-11-01 22:49:36 -0400] miah: jenkins plugins == fuck you. please die.
[2013-11-01 22:49:52 -0400] miah: not the easiest thing to deal with
[2013-11-01 22:49:53 -0400] coderanger: miah: http://i.coderanger.net/JEhJR.png that is what my jenkins recipe looks like now
[2013-11-01 22:50:15 -0400] cwj: i am considering learning some nodejs for the express purpose of making strider-cd cm-friendly
[2013-11-01 22:50:17 -0400] holms: oh so miah you can help with logstash later on right :DD?
[2013-11-01 22:50:32 -0400] miah: coderanger: interesting
[2013-11-01 22:51:19 -0400] cwj: coderanger: where the branch at :)
[2013-11-01 22:51:28 -0400] coderanger: cwj: balanced-cookbooks/jenkins
[2013-11-01 22:51:45 -0400] cwj: cheers
[2013-11-01 22:51:50 -0400] dgarstang: it would seem that chef's upload syntax checking needs a little tweaking.
[2013-11-01 22:53:00 -0400] holms: coderanger: =/ http://pastie.org/8449183
[2013-11-01 22:56:09 -0400] dgarstang: "ERROR: undefined method `close!' for nil:NilClass" in Web UI. Not fun.
[2013-11-01 22:57:20 -0400] coderanger: dgarstang: Its an old Ruby bug
[2013-11-01 22:57:40 -0400] dgarstang: coderanger: it seems to occur when I upload files to the chef server that aren't valid
[2013-11-01 22:57:45 -0400] coderanger: holms: So make a user for nginx?
[2013-11-01 22:58:05 -0400] coderanger: dgarstang: Yes, that error in particular just means someone tried to raise an exception during a socket handler
[2013-11-01 22:58:28 -0400] dgarstang: coderanger: well when that error occurs, the cookbooks are not deployed during a chef run.
[2013-11-01 22:58:45 -0400] holms: probably nginx installation failed last time or smtng
[2013-11-01 22:58:52 -0400] coderanger: dgarstang: Yes, just saying that error message isn't useful, you have to go digging in the logs for the real error
[2013-11-01 22:59:13 -0400] dgarstang: coderanger: yeah I tried that before and it was no help. Guess I'll try again
[2013-11-01 22:59:29 -0400] seanz: Basic question: can Chef actually affect Windows group policy in any way?
[2013-11-01 23:00:03 -0400] coderanger: seanz: If a human can do it, chef can do it
[2013-11-01 23:00:38 -0400] seanz: coderanger: I'm trying to determine if chef would be practical for a Windows network of ~10 nodes.
[2013-11-01 23:01:03 -0400] dgarstang: coderanger: I'd do a download but --repo-path doesn't work
[2013-11-01 23:01:53 -0400] coderanger: seanz: Chef is, at heart, just converting the steps you would do by hand into code
[2013-11-01 23:02:03 -0400] coderanger: seanz: The underlying steps don't change (much)
[2013-11-01 23:02:29 -0400] dgarstang: coderanger: there we go. chef happily accepts vagrant vdi disk files for upload
[2013-11-01 23:05:59 -0400] coderanger: dgarstang: Sure, if its not in your Chefignore, it uploads it
[2013-11-01 23:06:35 -0400] dgarstang: coderanger: no error checking eh
[2013-11-01 23:06:54 -0400] coderanger: dgarstang: It has error checking, as I said quite clearly there is a bug in Ruby that interferes with it
[2013-11-01 23:07:21 -0400] dgarstang: coderanger: i thought you said the bug was UI related.
[2013-11-01 23:07:37 -0400] coderanger: dgarstang: No, it is in Net::HTTP, if you are inside a socket handler
[2013-11-01 23:07:57 -0400] coderanger: when the original error happens, nethttp tries to close the socket
[2013-11-01 23:08:02 -0400] coderanger: but its already been set to nil
[2013-11-01 23:08:06 -0400] coderanger: thus the secondary error
[2013-11-01 23:08:57 -0400] holms: I really feel this way now :DD http://goo.gl/jiMzg
[2013-11-01 23:28:24 -0400] holms: miah: you here
[2013-11-01 23:28:25 -0400] holms: ?
