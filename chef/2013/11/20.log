[2013-11-20 00:44:54 -0500] spheromak: iverson0881: using jenkins right now to achieve this
[2013-11-20 00:45:34 -0500] spheromak: iverson0881: jenkins + test-kitchen + berkshelf. basically. Some issues for sure, and it hasn't been a cake walk. :D
[2013-11-20 00:45:50 -0500] spheromak: iverson0881: basically same boat as adnichols
[2013-11-20 01:24:37 -0500] broconne: anyone run into a chef recipse hanging if it starts a service that uses the daemon command?
[2013-11-20 01:24:38 -0500] Soliah: Could someone tell me how you make a node converge after changing some attributes in an environment?
[2013-11-20 01:25:41 -0500] jbz: Soliah:  You should just be able to run chef-client again
[2013-11-20 01:25:52 -0500] jbz: if the node is in that environment, it will get those attributes during the run.
[2013-11-20 01:25:59 -0500] jbz: (er, run chef-client on the node).
[2013-11-20 01:26:17 -0500] Soliah: jbz, can this be initialised from the server? Or do I have to manually do this via knife?
[2013-11-20 01:26:55 -0500] jbz: Soliah: No not from the server.  chef-client is intended to be run from the node being converged.  You can do it manually using knife, but that's not a recommended production method
[2013-11-20 01:26:58 -0500] jbz: for testing, sure
[2013-11-20 01:27:13 -0500] jbz: you could use knife ssh to kick off a chef-client run.
[2013-11-20 01:27:41 -0500] Soliah: Yea I guess the best way would be specify the environment via knife to kick of the chef-client run.
[2013-11-20 01:27:50 -0500] jbz: well
[2013-11-20 01:28:14 -0500] jbz: for testing, yeah.  Although you can tell the node (from the server) which environment to apply.
[2013-11-20 01:28:19 -0500] jbz: You just can't kick off the run.
[2013-11-20 01:28:59 -0500] jbz: (at least, I *think* you can specify the environment from the servernot 100% sure)
[2013-11-20 03:26:06 -0500] vine: < up a creek without a paddle
[2013-11-20 03:26:33 -0500] vine: semi-recent changes to knife solo have rendered my previous understanding obsolete
[2013-11-20 03:27:00 -0500] vine: knife solo cook foobar nodes/test.json
[2013-11-20 03:27:10 -0500] vine: previously worked, now complains WARNING: Local cookbook_path '/var/chef/site-cookbooks' does not exist
[2013-11-20 03:27:31 -0500] vine: how do I guide it back to ./site-cookbooks within the same directory?
[2013-11-20 03:39:36 -0500] vine: would be super appreciative if someone could help me connect the dots.
[2013-11-20 04:25:25 -0500] mauro: join chef
[2013-11-20 08:14:57 -0500] michael_mbp: hi all
[2013-11-20 08:15:43 -0500] michael_mbp: what's the best way to upgrade the version of passenger on a particular node?
[2013-11-20 08:37:00 -0500] tnarik: hi
[2013-11-20 08:37:15 -0500] tnarik: I was playing with chef-vault and chef-solo
[2013-11-20 08:37:55 -0500] tnarik: but I fail to see how the node in chef-solo is using it's private/public key (if it does)
[2013-11-20 08:38:08 -0500] tnarik: and I cannot get it to work
[2013-11-20 08:38:26 -0500] tnarik: anyone here tried something similar and suceeded?
[2013-11-20 08:39:54 -0500] michael_mbp: guy to talk to is workmad3
[2013-11-20 08:40:06 -0500] michael_mbp: he has mad chef skillz.
[2013-11-20 09:25:11 -0500] kernelpanik: hi guys!
[2013-11-20 09:27:35 -0500] storme_out: oddly busy for 1am pacific, heh
[2013-11-20 09:28:09 -0500] kernelpanik: I have to migrate my chef server from version 10 to 11. I found http://www.ducea.com/2013/03/05/howto-migrate-to-chef-11/ in which shows  to use knife knife-backup/restore plugin to perform the migration...do you think is a best practice?  (after import all data in the new chef server I will change the DNS record)
[2013-11-20 09:29:45 -0500] storme_out: yes, that's how i did it. though iirc knife backup on environments downloads the _default environment... delete it, trying to reupload it will just error on you since it's an immutable record in the db
[2013-11-20 09:29:51 -0500] drrk: kernelpanik: it's what I plan to do, I thinkit's prety good
[2013-11-20 09:30:29 -0500] drrk: if you have the port defined for the server in client.rb as 4000 you will need to remove that too
[2013-11-20 09:30:39 -0500] kernelpanik: gr8!  I needed opinion like that ;)
[2013-11-20 09:30:53 -0500] kernelpanik: ah ok
[2013-11-20 09:31:09 -0500] kernelpanik: because in the new chef server there is a reverse proxy
[2013-11-20 09:31:39 -0500] drrk: yeah it's on 443 not 4000
[2013-11-20 09:31:43 -0500] kernelpanik: also in install ruby from rvm is advisable?
[2013-11-20 09:43:14 -0500] m4rcu5: ohai hrak
[2013-11-20 09:43:25 -0500] hrak: hai!
[2013-11-20 09:47:58 -0500] mrwpink: Hi
[2013-11-20 09:49:05 -0500] hrak: hey guys, librarian-chef noob question: i'm using the munin cookbook which pins the dependency nginx at '~> 1.8', but i want to use the most recent version of the nginx cookbook in a project. Librarian-chef now keeps the nginx cookbook at 1.8.0 but i want 2.0.4. Is there a way to do this?
[2013-11-20 09:49:26 -0500] hrak: both munin and nginx are in my Cheffile btw
[2013-11-20 09:49:53 -0500] bubu\a: yoo, I need to template a file with chef. The exact line is: $template LOGSTASH,'<%PRI%>%timegenerated:::date-rfc3164-buggyday% %HOSTNAME% %APP-NAME%: %msg:::drop-last-lf%\n'
[2013-11-20 09:50:22 -0500] bubu\a: chef is interpolating <%PRI%>, and blowing up, which I don't want. How can I escape that?
[2013-11-20 09:52:32 -0500] hrak: bubu\a: try <%%PRI%%>
[2013-11-20 09:52:47 -0500] bubu\a: will do ta hrak
[2013-11-20 10:29:39 -0500] kraM: Hey guys. What's wrong with "<% node['some_array'].each do |v| -%><%= v %><% end -%>" ? Results in "(erubis):49: syntax error".
[2013-11-20 10:31:23 -0500] kraM: Do I need to put these statements on different lines?
[2013-11-20 10:38:32 -0500] karthee: Hi .. I am trying to setup CI for writing cookbooks. Can somebody advice how to run all the unit tests altogether ?
[2013-11-20 10:39:13 -0500] karthee: currently I am running individually by  using the command "rspec /path/to/unittest.rb"
[2013-11-20 10:42:22 -0500] zaargy: bundle exec rspec or some cookbooks have a rakefile
[2013-11-20 10:44:02 -0500] karthee: zaargy: thanks sir. I am new to this I will google it around thanks
[2013-11-20 10:47:43 -0500] determinant_: juliancdunn: I am trying to reproduce what you are demonstrating in your demo, it is trying to connect to the port 5985 and times out from there.
[2013-11-20 10:47:44 -0500] determinant_: http://pastebin.com/Vp4EijH6
[2013-11-20 10:47:46 -0500] determinant_: Any ideas ?
[2013-11-20 11:18:25 -0500] determinant_: http://pastebin.com/Vp4EijH6 - Any ideas why it is still waiting for RM to be ready ?
[2013-11-20 11:18:34 -0500] determinant_: Do i need to make any changes in the target server ?
[2013-11-20 11:18:35 -0500] determinant_: WinRM
[2013-11-20 11:33:27 -0500] glen: eh, knife is giving me quite different error if i specify nodename with path starting with '/': http://sprunge.us/IAhH
[2013-11-20 11:34:55 -0500] glen: first i thought my chef is hijacked by some mochiweb
[2013-11-20 11:56:27 -0500] stevedomin: I'm trying to upload cookbooks with knife-spork (I'm using Berkshelf), using: knife spork upload my_cookbook -D
[2013-11-20 11:56:43 -0500] stevedomin: and I'm getting this error: ERROR: TypeError: no implicit conversion of nil into String
[2013-11-20 12:33:10 -0500] phutchins: morning
[2013-11-20 13:30:19 -0500] GreatSUN: hi all
[2013-11-20 13:30:35 -0500] GreatSUN: I have a problem connected to https://tickets.opscode.com/browse/CHEF-3304
[2013-11-20 13:31:00 -0500] GreatSUN: the system is running on windows and I get an exception cause I am using utf-8 character in ruby-script
[2013-11-20 13:31:25 -0500] GreatSUN: at the first line of the script I have #encoding: utf-8
[2013-11-20 13:32:06 -0500] GreatSUN: the error occurs within ruby 1.9.3 and chef 11.6.0
[2013-11-20 13:32:37 -0500] GreatSUN: I also tried ENV['RUBYOPT'] = '-Ku' already
[2013-11-20 13:32:42 -0500] GreatSUN: but this didn't help either
[2013-11-20 13:32:47 -0500] GreatSUN: any suggestions?
[2013-11-20 13:39:08 -0500] lewiz: On my Windows VM I can run a "knife windows bootstrap" and it succeeds (e.g. I set all winrm stuff correctly).  If I create a Vagrant box and run vagrant up certain commands fail with OutOfMemory errors.  Anybody know why this might be?  It's the same image... perhaps Vagrant is running chef in a different way?
[2013-11-20 13:41:21 -0500] kraM: I am right when I think I can put recipes in a sub directory like cookbooks/cookbook/recipes/foo/bar.rb, right? Thaugth this was possible. What does run_list need to look like for that to work?
[2013-11-20 13:52:09 -0500] m4rcu5: anyone in here using librarian-chef during development cycles?
[2013-11-20 13:53:23 -0500] gregkare: m4rcu5: I'm (still) using librarian-chef, I never liked Berkshelf
[2013-11-20 13:54:30 -0500] m4rcu5: gregkare: how do you get along? i mean, when you have a new cookbook which is under heavy development, are you commiting to a git repo every time, then librarian-chef install it and then knife upload it? or is there a faster way around this?
[2013-11-20 14:01:04 -0500] gregkare: m4rcu5: If it's under active development and meant to be external I'd use a git submodule
[2013-11-20 14:03:03 -0500] m4rcu5: gregkare: and normal internal development? how you you do it? we now have a cheffile with all cookbooks (pointing to our own git as well als the community cookbooks) and do development in site-cookbooks, however if you depend on another cookbook this wil fail
[2013-11-20 14:12:09 -0500] gregkare: m4rcu5: Oh for that we just also use site-cookbooks for all our project cookbooks, they're not managed with Librarian
[2013-11-20 14:12:38 -0500] m4rcu5: gregkare: and how do you keep track of the dependancys of your own cookbooks?
[2013-11-20 14:12:55 -0500] gregkare: That's the part that's not perfect, good point :)
[2013-11-20 14:13:40 -0500] gregkare: We end up with some duplication, dependencies have to be added to the Cheffile for our cookbooks in site-cookbooks
[2013-11-20 14:13:58 -0500] gregkare: It's not that bad once it's done though, but it's indeed not ideal
[2013-11-20 14:15:16 -0500] m4rcu5: gregkare: you could also do like us, add your own cookbooks to the Cheffile as well, and have it instaled that way, but every development cycle you need to install and upload
[2013-11-20 14:17:11 -0500] gregkare: That's something I'll have to try! I haven't done big changes to the librarian setup we have, I don't remember in which cases librarian will run automatically when knife is used
[2013-11-20 14:17:43 -0500] m4rcu5: gregkare: thats also something i could look at, we currently do not run it with knife
[2013-11-20 14:18:47 -0500] gregkare: We use knife-spork heavily
[2013-11-20 14:19:22 -0500] gregkare: We freeze cookbooks at every upload, pin cookbook versions in the chef environments
[2013-11-20 14:19:32 -0500] gregkare: (bump and freeze, of course)
[2013-11-20 14:25:06 -0500] m4rcu5: gregkare: we also use knife-spork, do you have it intergrated with librarien?
[2013-11-20 14:29:49 -0500] juliancdunn: determinant_: the box needs to have WinRM enabled over 5985 for now
[2013-11-20 14:29:55 -0500] juliancdunn: as instance-data
[2013-11-20 14:34:30 -0500] phutchins: ANyone know of a way to do a conditional depends?
[2013-11-20 14:34:31 -0500] GreatSUN: so noone who knows how to get rid of utf-8 problem in chef 11?
[2013-11-20 14:34:46 -0500] phutchins: say there are some cases which i would not want to have the file depends in the metadata but some that I would
[2013-11-20 14:34:56 -0500] phutchins: GreatSUN: what problems?
[2013-11-20 14:35:05 -0500] phutchins: it depends on what your problem is
[2013-11-20 14:35:19 -0500] GreatSUN: I have a problem connected to https://tickets.opscode.com/browse/CHEF-3304
[2013-11-20 14:35:24 -0500] determinant_: juliancdunn: I am able to connect to it after enabling RM
[2013-11-20 14:35:27 -0500] GreatSUN: I have utf-8 characters in code, at the first line I have #encoding: utf-8
[2013-11-20 14:35:32 -0500] GreatSUN: already tried setting ENV['RUBYOPT'] = '-Ku'
[2013-11-20 14:35:35 -0500] determinant_: however, i am missing the distro which you are using in the sample
[2013-11-20 14:35:52 -0500] determinant_: and I am getting 401's returned from the bootstrap,
[2013-11-20 14:35:58 -0500] determinant_: is there a way to run chef-solo on the machine ?
[2013-11-20 14:36:02 -0500] GreatSUN: local environment is set to en_US.UTF-8
[2013-11-20 14:36:22 -0500] phutchins: GreatSUN: yeah i don't know about that one... i always try to get rid of the utf-8 characters :)
[2013-11-20 14:36:25 -0500] phutchins: why do you want theM?
[2013-11-20 14:36:29 -0500] GreatSUN: phutchins: chef solo, version 11.6.0 , ruby 1.9.3
[2013-11-20 14:36:48 -0500] GreatSUN: phutchins: to make string replacements secure
[2013-11-20 14:37:27 -0500] GreatSUN: phutchins: its not so easy to have strings that noone uses to be there to mark the place where there should be some value
[2013-11-20 14:39:24 -0500] phutchins: GreatSUN: yeah i understand. Are there no other laternative ways to do that tho?
[2013-11-20 14:42:19 -0500] determinant_: I tried a "knife bootstrap windows winrm xx.xx.xx.xx -x devopsmgmt -P Zodiac!99"
[2013-11-20 14:42:44 -0500] determinant_: Bootstrapping Chef on <ip>
[2013-11-20 14:42:45 -0500] determinant_: ERROR: Failed to authenticate to ["<ip>"] as devopsmgmt
[2013-11-20 14:42:45 -0500] determinant_: Response: Bad HTTP response returned from server (401).
[2013-11-20 14:42:47 -0500] determinant_: is what comes up
[2013-11-20 14:42:52 -0500] determinant_: any hints on what am i missing ?
[2013-11-20 14:57:01 -0500] b-dean: what version of chef server 10.x do you need to have chef 11.x clients?
[2013-11-20 15:02:09 -0500] b-dean: we have an old chef server (10.12.0) and we're wondering if 11.8.0 clients will be able to connect to it and use it correctly
[2013-11-20 15:02:23 -0500] determinant_: I had to tweak with the winrm settings to get bootstrap working
[2013-11-20 15:02:37 -0500] determinant_: however, after installing it defaults to get the chef repository from https://localhost and fails
[2013-11-20 15:02:50 -0500] determinant_: the issue is with the client.rb in the C:/chef directory
[2013-11-20 15:02:55 -0500] determinant_: how do i override this setting ?
[2013-11-20 15:18:35 -0500] ptrf: hmm
[2013-11-20 15:20:21 -0500] ptrf: when I want to use an attribute in a recipe, I used to do a node["asdasda"]["asddas"] and that went fine
[2013-11-20 15:20:49 -0500] ptrf: now I'm trying to do it using node.asdasda.asddas, but alas, chef-client complains
[2013-11-20 15:20:58 -0500] ptrf: I need a node.default. or node.override, etc
[2013-11-20 15:21:11 -0500] ptrf: my point is, I don't want the default value if there's an overrid
[2013-11-20 15:21:11 -0500] ptrf: e
[2013-11-20 15:21:59 -0500] ptrf: oh! http://www.opscode.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/ <- i'll just read this
[2013-11-20 15:25:31 -0500] ptrf: Ok, so I'm stil a bit confused, I have the following question: In order to get the value with highest precedence, I have to lookup using node[:something][:something_else]?
[2013-11-20 15:25:42 -0500] ptrf: because I cant use node.something.something
[2013-11-20 15:27:23 -0500] adnichols: ptrf: that is correct - you should read using node[]
[2013-11-20 15:27:34 -0500] adnichols: ptrf: you should write using node.default / node.override / etc
[2013-11-20 15:28:25 -0500] zts: ptrf: I'm surprised by that, I'd think the accessor method (node.foo.bar) should still work fine - it's only an issue if you're _assigning_ attributes
[2013-11-20 15:29:49 -0500] ptrf: zts: using, chef 11.6.0
[2013-11-20 15:29:56 -0500] ptrf: adnichols: thanks a lot!
[2013-11-20 15:30:25 -0500] zts: ptrf: yes
[2013-11-20 15:30:31 -0500] ptrf: adnichols: it was really from reading through the sensu cookbook I found this nice way of writing to attributes
[2013-11-20 15:30:39 -0500] ptrf: zts: I get a stacktrace on my clients
[2013-11-20 15:30:49 -0500] ptrf: NoMethodError: Undefined method or attribute `users' on `node'
[2013-11-20 15:31:14 -0500] ptrf: yet, I have node.override.users.blbalba in my cookbook
[2013-11-20 15:33:13 -0500] zts: ptrf: interesting!  To be honest, i've never liked that style of attribute access, but I do have a couple of cookbooks that still seem to be using it (eg, "timezone-ii") - and I've had that running from 11.4 - 11.8
[2013-11-20 15:50:55 -0500] holms: coderanger: got any luck with logstash?
[2013-11-20 16:04:57 -0500] determinant_: juliancdunn: The bootstrap.bat which it downloads seems to be setting the chef_server_url to localhost in the client.rb, Is there a way to override this ?
[2013-11-20 16:14:33 -0500] juliancdunn: determinant_: it just takes the chef_server_url from the workstation you're bootstrapping *from*
[2013-11-20 16:16:19 -0500] phutchin1: can you get remote_directory to run immediately?
[2013-11-20 16:16:21 -0500] juliancdunn: also, here's the instance-data I was talking about, to set up EC2 boxes to accept bootstrapping on Windows. https://gist.github.com/juliandunn/7995d219c979d91becf0
[2013-11-20 16:22:28 -0500] determinant_: juliancdunn: And in my machine i have to change in knife.rb in C:\chef directory ?
[2013-11-20 16:22:56 -0500] sdicu: how can you set into a cron resource a custom environment ?
[2013-11-20 16:23:02 -0500] determinant_: it is already set to point to chef on cloud
[2013-11-20 16:27:08 -0500] sdicu: never mind - i got it
[2013-11-20 16:27:12 -0500] sdicu: environment  Hash['A'=>'B']
[2013-11-20 16:29:55 -0500] determinant_: http://docs.opscode.com/config_rb_knife.html
[2013-11-20 16:30:02 -0500] determinant_: I was able to pick up the configuration from here
[2013-11-20 16:30:03 -0500] determinant_: :)
[2013-11-20 16:30:25 -0500] lewiz: what level of debug is required to show output from execute statements when running chef-client manually?
[2013-11-20 16:30:33 -0500] steveelsewhere: anyoine know of a postgres cookbook that works with chef 11 and centos? the opscode postgresql cookbook seems to have issues with chef11 (ChefPostgresqlHelpers)
[2013-11-20 16:31:54 -0500] sdicu: @lewiz there is no required debug level - you can set the debug level with -l debug|info etc or write your client.rb or solo-conf.rb
[2013-11-20 16:32:26 -0500] steveelsewhere: that should be PostgresqlHelpers, rather
[2013-11-20 16:33:37 -0500] lewiz: sdicu: do you know which level will show me all stdout & stderr from an execute statement?
[2013-11-20 16:33:48 -0500] sdicu: default is info
[2013-11-20 16:33:48 -0500] lewiz: sdicu: oddly I get nothing with debug
[2013-11-20 16:34:25 -0500] sdicu: what do you have into client.rb ?
[2013-11-20 16:35:00 -0500] lewiz: sdicu: I get output but nothing from an execute statement.  e.g. execute "fred" command "rm -rf /" done :)
[2013-11-20 16:35:13 -0500] sdicu: you need this into client.rb
[2013-11-20 16:35:15 -0500] sdicu: log_location     STDOUT
[2013-11-20 16:35:24 -0500] sdicu: if not will log to a file
[2013-11-20 16:39:00 -0500] lewiz: sdicu: I'm seeing output.  My query is around where output from a single execute statement goes.  It looks as though my execute command is not running and I'm trying to debug that.  -l debug still shows no output from the execute command.  I see all other (debug) chef output
[2013-11-20 16:39:42 -0500] sdicu: ah ... how do you run the command ?
[2013-11-20 16:40:05 -0500] lewiz: sdicu: with an execute statement
[2013-11-20 16:40:22 -0500] dyer: Hey guys, is there a way to find out all the exact cookbook versions currently applied to a node ?
[2013-11-20 16:40:48 -0500] j^2: dyer: environment pinning?
[2013-11-20 16:41:25 -0500] dyer: in this environment ( dev ) there isnt any pinning
[2013-11-20 16:41:37 -0500] j^2: it'll take the newest one then that's on the chef-server
[2013-11-20 16:42:30 -0500] sdicu: i can't say 100% ... i have to see the source code - BUT the chef will spawn a process w/o recording the output if you use execute
[2013-11-20 16:42:48 -0500] zts: dyer: you can inspect the cookbook metadata.rb's in the chef cache on the node, but that's about it - I don't believe chef-client records it anywhere by default
[2013-11-20 16:42:59 -0500] dyer: ok, thats what I figured.  Thanks
[2013-11-20 16:43:34 -0500] sdicu: you can redirect to a file or use something different ... like out = `command` but you need to make sure is idempotent
[2013-11-20 16:55:08 -0500] jchauncey: if you set a node attribute in a recipe is that persisted across chef runs?
[2013-11-20 16:56:10 -0500] sdicu: yes - if you apply the same recipe into node's run_list - look as well at attribute precedence
[2013-11-20 16:57:39 -0500] pattersonc: is it possible to get ohai to realize that a new system ruby has been installed? i seem to run into this issue everytime I work with chef
[2013-11-20 16:58:04 -0500] pattersonc: i have tried ohai do :relaod end
[2013-11-20 16:59:03 -0500] holms: anybody did logstash cookbook?
[2013-11-20 17:01:27 -0500] holms: how to find attributes values in roles..?
[2013-11-20 17:01:32 -0500] holms: with a knife
[2013-11-20 17:01:37 -0500] holms: like generated password and etc
[2013-11-20 17:02:11 -0500] jbz: holms: knife role show <role> should give you a dump of the role's attributes
[2013-11-20 17:02:59 -0500] holms: probably not what i mean =/
[2013-11-20 17:03:15 -0500] holms: in here, a recipe search for an attribute in node, through role somehow
[2013-11-20 17:03:31 -0500] holms: it sees ip of node which uses that role
[2013-11-20 17:03:37 -0500] holms: insane..
[2013-11-20 17:04:02 -0500] jbz: sorry, not sure what you're askin.
[2013-11-20 17:04:13 -0500] holms: something like "find "ip" in "my_role_name"
[2013-11-20 17:04:34 -0500] holms: logstash_servers = search(:node, "role:logstash_server AND chef_environment:#{node.chef_environment}")
[2013-11-20 17:04:56 -0500] holms: what is it searching in here?
[2013-11-20 17:05:22 -0500] holms: and the recipe retrives logstash_servers[0]['ipaddress'],
[2013-11-20 17:05:34 -0500] holms: how the hell did he found an IP of node, where specific role is used
[2013-11-20 17:05:38 -0500] jbz: no
[2013-11-20 17:05:47 -0500] jbz: you are searching for a node, which is what :node means
[2013-11-20 17:06:05 -0500] holms: a node which uses some role yea?
[2013-11-20 17:06:16 -0500] jbz: and it is telling chef to search for a node which has the role :logstash_server applied to it AND the chef_env specified applied to it
[2013-11-20 17:06:18 -0500] jbz: yes
[2013-11-20 17:06:26 -0500] holms: hmz
[2013-11-20 17:06:38 -0500] holms: how to find all chef_envs from specific node..?
[2013-11-20 17:06:39 -0500] jbz: you should get back, from that search line, an array of node objects
[2013-11-20 17:06:53 -0500] jbz: each node should only be in one chef environment.
[2013-11-20 17:07:16 -0500] jbz: It can't be in more than one, I'm pretty sure.
[2013-11-20 17:07:34 -0500] holms: k le me ask another way
[2013-11-20 17:07:52 -0500] holms: we have some node, with applied role to it
[2013-11-20 17:07:58 -0500] holms: after running chef-client
[2013-11-20 17:08:04 -0500] holms: can I view generated attributes?
[2013-11-20 17:08:13 -0500] holms: or default one
[2013-11-20 17:08:19 -0500] holms: withing anothin role :)
[2013-11-20 17:08:30 -0500] holms: another cookbook*
[2013-11-20 17:09:06 -0500] jbz: once the chef-client has run, and completed successfully, the node will save its node state to the server.  Starting at that point, any node which runs a search can get that node's state returned to it as a node object.
[2013-11-20 17:09:11 -0500] jbz: That node object contains all its attributes.
[2013-11-20 17:09:23 -0500] jbz: *unless you use sparse search results
[2013-11-20 17:09:27 -0500] holms: ok
[2013-11-20 17:09:33 -0500] holms: so how to view all attributes of the nodee?
[2013-11-20 17:09:47 -0500] jbz: Using knife?  Or in recipe code?
[2013-11-20 17:09:57 -0500] holms: knife for now would be nice
[2013-11-20 17:10:01 -0500] jbz: knife node show <node name>
[2013-11-20 17:10:59 -0500] holms: http://pastie.org/8495922
[2013-11-20 17:11:01 -0500] holms: no ip =?
[2013-11-20 17:11:04 -0500] holms: sad
[2013-11-20 17:11:22 -0500] holms: or this should be set manually in node config?
[2013-11-20 17:11:29 -0500] divad: add --long to view the whole thing
[2013-11-20 17:11:33 -0500] jbz: oh sorry
[2013-11-20 17:11:33 -0500] jbz: yes
[2013-11-20 17:11:38 -0500] jbz: what divad said
[2013-11-20 17:11:55 -0500] holms: nothing http://pastie.org/8495926
[2013-11-20 17:11:57 -0500] divad: knife node show <node name> --long
[2013-11-20 17:12:29 -0500] jbz: holms has that machine successfully finished a chef client run?
[2013-11-20 17:12:48 -0500] holms: well yes
[2013-11-20 17:13:22 -0500] holms: ill try one more time
[2013-11-20 17:13:46 -0500] holms: wooo
[2013-11-20 17:13:49 -0500] holms: now it works
[2013-11-20 17:14:05 -0500] holms: aah i know why
[2013-11-20 17:14:10 -0500] holms: i've reinstall chef-server lol
[2013-11-20 17:21:36 -0500] holms: omfg
[2013-11-20 17:21:45 -0500] holms: jbz: when making knife upload /nodes
[2013-11-20 17:21:50 -0500] holms: all node info resets X_X
[2013-11-20 17:21:53 -0500] holms: why?
[2013-11-20 17:22:05 -0500] jbz: uh
[2013-11-20 17:22:25 -0500] jbz: because you're overwriting the node record on the server with a static record which doesn't contain the node's run data.
[2013-11-20 17:22:33 -0500] jbz: The next time the node runs chef-client, it should repopulate.
[2013-11-20 17:22:51 -0500] jbz: The chef server contains that last known state of the node.
[2013-11-20 17:24:02 -0500] holms: so after bulk node update (let's say i've added something)
[2013-11-20 17:24:21 -0500] holms: one of the nodes (or i mean role, which using recipes) depends on
[2013-11-20 17:24:23 -0500] holms: node state
[2013-11-20 17:24:38 -0500] holms: so after bulk update, and chef-client rerun
[2013-11-20 17:24:41 -0500] holms: this will fail
[2013-11-20 17:24:49 -0500] mvisich: Hi I had a question. Is there any ways to symlink all the ymls on a deploy block before any other step?
[2013-11-20 17:24:57 -0500] jbz: holms:  I never, ever upload node records.
[2013-11-20 17:25:03 -0500] holms: why?
[2013-11-20 17:25:06 -0500] jbz: I let the node register itself when it is provisioned.
[2013-11-20 17:25:08 -0500] holms: i like to store everything in git
[2013-11-20 17:25:10 -0500] jbz: uh
[2013-11-20 17:25:17 -0500] jbz: this, basically, is why.
[2013-11-20 17:25:20 -0500] jbz: Then you don't have current state.
[2013-11-20 17:25:29 -0500] jbz: You have only what you've manually put in the node record.
[2013-11-20 17:25:33 -0500] jbz: Or at least, you can only rely on that.
[2013-11-20 17:25:34 -0500] holms: so after node update, it should rerun itself or smtng
[2013-11-20 17:25:40 -0500] jbz: No.
[2013-11-20 17:25:51 -0500] jbz: I use my chef server as the source of truth for my current infrastructure state.
[2013-11-20 17:26:08 -0500] jbz: I use git as my current source of truth for what my *cookbook code* is, i.e. methods and default state.
[2013-11-20 17:26:13 -0500] holms: i'm using my  workstation as source of the truth :P
[2013-11-20 17:26:27 -0500] holms: when you have 2000 nodes in here
[2013-11-20 17:26:34 -0500] holms: i need to have files or smtng..
[2013-11-20 17:26:39 -0500] jbz: I never write node state manually to the chef server.  I've managed ~3500 nodes.
[2013-11-20 17:26:50 -0500] holms: what do you mean manually :)
[2013-11-20 17:27:06 -0500] jbz: I don't use node upload.  I don't edit and upload node records.
[2013-11-20 17:27:08 -0500] holms: git checkout myrepo; cd myrepo; knife upload /
[2013-11-20 17:27:12 -0500] jbz: Nope.
[2013-11-20 17:27:17 -0500] holms: so how can you dublicate
[2013-11-20 17:27:20 -0500] holms: whole cluster then
[2013-11-20 17:27:21 -0500] holms: ?
[2013-11-20 17:27:22 -0500] jbz: My repo doesn't contain node records.
[2013-11-20 17:27:27 -0500] jbz: I have roles and cookbooks
[2013-11-20 17:27:38 -0500] jbz: which, if nodes come up with those roles applied, will do what's necessary.
[2013-11-20 17:27:46 -0500] holms: so now
[2013-11-20 17:27:55 -0500] holms: you have  like 50 roles
[2013-11-20 17:28:01 -0500] holms: and 2000 nodes which has random amount of roles
[2013-11-20 17:28:09 -0500] holms: how you will clone your cluster ?
[2013-11-20 17:28:19 -0500] jbz: uh
[2013-11-20 17:28:30 -0500] holms: who will have definition of run_list
[2013-11-20 17:28:32 -0500] jbz: I don't 'clone my cluster' with current node state.
[2013-11-20 17:28:34 -0500] jbz: The roles.
[2013-11-20 17:28:46 -0500] jbz: Yes, I'm responsible for assigning roles to nodes as they provision
[2013-11-20 17:28:59 -0500] holms: how can you memories 20 random role combination
[2013-11-20 17:29:01 -0500] holms: to 2000 nodes?
[2013-11-20 17:29:02 -0500] jbz: I do that outside of chef, using AWS user_data scripts or cobbler.
[2013-11-20 17:29:05 -0500] holms: memorize*
[2013-11-20 17:29:08 -0500] jbz: I don't.
[2013-11-20 17:29:16 -0500] holms: wron design then
[2013-11-20 17:29:23 -0500] holms: if you don't want to replicate cluster
[2013-11-20 17:29:25 -0500] jbz: Well, works for me, so call it wrong all you want.
[2013-11-20 17:29:26 -0500] holms: then yeah it's ok
[2013-11-20 17:29:35 -0500] evalenci: They get booted with what they need and start ane be part of a role/environment as needed holms, the machine/node doesnt matter just the state and what their function is
[2013-11-20 17:29:37 -0500] holms: if you put same cluster to 2000 companies
[2013-11-20 17:29:38 -0500] zts: holms: given that jbz's approach doesn't periodically screw up his search results, one might argue that his design is the correct one :)
[2013-11-20 17:29:41 -0500] holms: i want them to be identical D:
[2013-11-20 17:29:53 -0500] jbz: holms:  I think the problem is this
[2013-11-20 17:30:01 -0500] jbz: you need to let go of treating your actual node state as precious.
[2013-11-20 17:30:02 -0500] jbz: Instead
[2013-11-20 17:30:04 -0500] holms: zts: then it's incorrect to use node search in cookbooks =/
[2013-11-20 17:30:10 -0500] jbz: know that you can always rebuild them the way you want.
[2013-11-20 17:30:15 -0500] jbz: holms:  Not at all.
[2013-11-20 17:30:26 -0500] jbz: I use node search *only when I want to look for current state*, which is kept in chef server.
[2013-11-20 17:30:35 -0500] jbz: I never use node search to look for things that I keep in github.
[2013-11-20 17:30:44 -0500] evalenci: holms, I work with only aws nodes, I dont even know what the node name is, only that they come up with the service and configuration defined in my cookbooks
[2013-11-20 17:30:57 -0500] zts: holms: I disagree - when using chef client/server, I also don't use "knife node from file" except for backup/restore of a chef server.  Never for updating nodes
[2013-11-20 17:31:23 -0500] zts: holms: but anyway, none of these ways is right or wrong - they each have tradeoffs.  You need to pick which set of tradeoffs is the best fit for your requirements
[2013-11-20 17:31:24 -0500] holms: zts:  my point is that i have my vagrant setup, my sandbox1, sandbox2,3,5,5,99
[2013-11-20 17:31:30 -0500] holms: and i want to provision all of them
[2013-11-20 17:31:31 -0500] holms: identically
[2013-11-20 17:31:37 -0500] holms: each node with his own role
[2013-11-20 17:31:45 -0500] holms: predefined by me
[2013-11-20 17:32:10 -0500] jbz: holms:  Let me put it this way.  I don't determine which node gets which role based on chef info, when I'm standing things up.
[2013-11-20 17:32:12 -0500] holms: so then specifiying IP to roles
[2013-11-20 17:32:14 -0500] jbz: I have tools which do that.
[2013-11-20 17:32:17 -0500] holms: is way to go, allways probably
[2013-11-20 17:32:35 -0500] holms: jbz: which tools?
[2013-11-20 17:32:38 -0500] jbz: I don't save my 'cluster state', I have a method of rapidly spinning up the nodes I need.
[2013-11-20 17:32:40 -0500] jbz: It varies.
[2013-11-20 17:32:57 -0500] jbz: In some places, I've used custom consoles which provisioned nodes on AWS and kept track of it there.
[2013-11-20 17:33:10 -0500] jbz: In other places, I've had scripts which spun up the requisite nodes in blocks.
[2013-11-20 17:33:27 -0500] jbz: the point, though, is that that is not *current infrastructure state*, that is a *template*
[2013-11-20 17:33:51 -0500] jbz: once the template is applied (the nodes are spun up, with roles assigned) *then* there is a 'state' but that state is never saved/restored, only used by existing nodes for coordination.
[2013-11-20 17:34:13 -0500] holms: well then i like i said, picking IP from node state in recipe
[2013-11-20 17:34:19 -0500] holms: is just a disaster in my situatioj
[2013-11-20 17:34:23 -0500] holms: is just a disaster in my situation*
[2013-11-20 17:34:37 -0500] holms: unless you do everything in order
[2013-11-20 17:34:45 -0500] jbz: It sounds like it, yes, because you're trying to do a search against a 'live value' which your provisioning method can overwrite at any time.
[2013-11-20 17:34:55 -0500] jbz: Destructively overwrite.
[2013-11-20 17:35:03 -0500] holms: unless there's a
[2013-11-20 17:35:08 -0500] holms: way to say, to knife
[2013-11-20 17:35:13 -0500] holms: upload nodes in exact
[2013-11-20 17:35:14 -0500] holms: order
[2013-11-20 17:35:23 -0500] jbz: that is one of those 'template scripts' I'm talking about.
[2013-11-20 17:35:33 -0500] jbz: Write code that does that, using knife, e.g.
[2013-11-20 17:36:13 -0500] zts: eg https://github.com/mattray/spiceweasel
[2013-11-20 17:36:43 -0500] jbz: You're up against the limits of the chef toolstack.  Although chef's tools *can* provision nodes, it's not really designed to track and manage the provisioning of infrastructure. It's designed to manage infrastructure once it's provisioned.  As zts indicated, there are tools outside core chef which try to address that task.
[2013-11-20 17:36:55 -0500] jbz: AWS Opsworks, e.g.
[2013-11-20 17:37:02 -0500] jbz: spiceweasel (thanks zts)
[2013-11-20 17:37:05 -0500] jbz: etc.
[2013-11-20 17:37:13 -0500] mattray: working on some new stuff
[2013-11-20 17:38:24 -0500] mattray: holms: let me know if that works for you
[2013-11-20 17:38:53 -0500] holms: if you ask.. me managing with chef
[2013-11-20 17:39:03 -0500] holms: goes over complexity with hadoop
[2013-11-20 17:39:14 -0500] holms: last time i've spent so much time on this was openstack :D
[2013-11-20 17:39:40 -0500] luckymike: holms: if you're using AWS and considering cloudformation you might like this: https://github.com/heavywater/sparkle_formation
[2013-11-20 17:39:53 -0500] holms: i'm using own datacenter
[2013-11-20 17:40:12 -0500] luckymike: nm then
[2013-11-20 17:40:12 -0500] holms: but thanks, because personally i'm using digitalocean
[2013-11-20 17:40:26 -0500] holms: so this will be handly
[2013-11-20 17:40:28 -0500] holms: handy*
[2013-11-20 17:41:03 -0500] zts: luckymike: oh nice, thanks for linking that
[2013-11-20 17:41:15 -0500] luckymike: zts: sure
[2013-11-20 17:41:18 -0500] holms: jbz: so you do using spiceweasel, to provision nodes in order?
[2013-11-20 17:41:22 -0500] holms: with so many nodes..
[2013-11-20 17:41:50 -0500] luckymike: we also use spiceweasel in some contexts
[2013-11-20 17:42:30 -0500] holms: now i'm thinking, i have my own makefile which pretty much automated all installs.. everything i've needed
[2013-11-20 17:42:39 -0500] holms: now for initial config i need to specify order of nodes
[2013-11-20 17:42:51 -0500] holms: would be nice to have depdency in nodes/mynode.json
[2013-11-20 17:42:54 -0500] holms: or smtng like this..
[2013-11-20 17:43:15 -0500] mattray: holms: spiceweasel can do yaml, json or ruby
[2013-11-20 17:48:20 -0500] holms: mattsmit_: to write quickly a bash script, which picks nodes order from custom config file is like
[2013-11-20 17:48:23 -0500] holms: 15min of work
[2013-11-20 17:48:34 -0500] bryanl: Whats the idiomatic way of getting the encrypted data bag secret on to clients?
[2013-11-20 17:48:50 -0500] holms: mattray is gone =(
[2013-11-20 17:52:47 -0500] jtimberman: bryanl: there's a flag to the 'knife bootstrap' command that can do that for newly provisioned hosts. however, i personally am a big fan of chef-vault.
[2013-11-20 17:53:11 -0500] bryanl: jtimberman: thanks for the pointer
[2013-11-20 17:53:41 -0500] holms: i wonder how much more tool will i bring to chef to make it work on him self..
[2013-11-20 18:12:00 -0500] jtimberman: bryanl: http://jtimberman.housepub.org/blog/2013/09/10/managing-secrets-with-chef-vault/
[2013-11-20 18:12:08 -0500] jtimberman: sorry meant to grab that link and got distracted with "work" :)
[2013-11-20 18:14:51 -0500] mahmoudimus: jtimberman, that's useful - thanks :)
[2013-11-20 18:45:20 -0500] sdicu: is it possible to re-initialize a variable that is initialized from a provider with load_current_resource
[2013-11-20 18:45:24 -0500] sdicu: ?
[2013-11-20 18:48:32 -0500] tcate: Am I correct in thinking that "action :checkou" for the git resource will only run if the destination doesn't already exist?
[2013-11-20 18:48:39 -0500] tcate: action: checkout
[2013-11-20 18:59:32 -0500] dagan: anyone able to help with a chef-solo http_proxy issue?
[2013-11-20 19:00:27 -0500] broconne: is there a good ruby idiom for a large block in which the first part of a conditional modifies the second..  for example.  I am trying to say:  if something.nil? == false or ::File.exists?(something).. but I really only want to do that or if that something is not nil...
[2013-11-20 19:00:36 -0500] broconne: looks ugly when I write it up.. and ugly doesn't feel like ruby
[2013-11-20 19:09:09 -0500] memelet: Has anyone found a way to install mysql 5.6 on ubuntu (without manual intervention)?
[2013-11-20 19:10:32 -0500] maplebed: Can you specify per-platform dependencies in metadata.rb? eg I only need the apt cookobok on debian and I only need the yum cookbook on redhat? I have the correct dependencies in the recipes themselves, I'm just wondering about the metadata.
[2013-11-20 19:10:50 -0500] coderanger: maplebed: No, nor does it matter
[2013-11-20 19:11:05 -0500] coderanger: The cookbooks will be transferred once and thats it
[2013-11-20 19:11:25 -0500] lazyPower: Hola cheffers, i have a question. When I run a cook book that consumes the NewRelic cookbook - it runs and completes fine. Its populating with the nodes default attribute of license_key as defined in the recipe. However when I include that recipe, and run it in another vagrant session it fails to populate the NR license key which causes the restart command to fail thus the run fails
[2013-11-20 19:11:40 -0500] coderanger: Its mildly annoying from a Technically Correct point of view, but not really an operational issue for the most part
[2013-11-20 19:11:43 -0500] lazyPower: What step am I missing to define this across instances. Surely cookbooks are more portable than I'm thinking...
[2013-11-20 19:13:02 -0500] maplebed: coderanger: I've had it get annoying because of version dependencies; i.e. some cookbook I don't use requires a different version of a cookbook I do use.
[2013-11-20 19:13:13 -0500] maplebed: but in my present situation, I'm not bothered.
[2013-11-20 19:13:23 -0500] maplebed: it just feels weird to have the yum cookbook require on a debian system...
[2013-11-20 19:13:32 -0500] maplebed: thanks.
[2013-11-20 19:13:50 -0500] spheromak: extra unused deps is never something we really want, but It's a side effect of the way things work right now.  agreed it smells
[2013-11-20 19:13:53 -0500] coderanger: maplebed: It does feel weird, it comes up for other stuff though, like requiring the runit cookbook even if you aren't using runit, etc
[2013-11-20 19:14:21 -0500] coderanger: platform-specific deps are the most obvious, and themselves probably fixable, but overall I'm not sure there is a great solution
[2013-11-20 19:14:29 -0500] JayF: It's honestly more annoying for chef-solo workloads, where you rsync the cookbooks around for most every run
[2013-11-20 19:15:00 -0500] JayF: metadata is generally used at a point before you'd know what platform it's running on though, so it's not really trivial
[2013-11-20 19:15:10 -0500] maplebed: otoh, if you did have the capacity to specify conditional dependencies within metadata, you'd have to have access to all that info at a different time
[2013-11-20 19:15:13 -0500] maplebed: yeah, that.
[2013-11-20 19:15:22 -0500] maplebed: also, you'd be repeating the dependency info.
[2013-11-20 19:17:55 -0500] coderanger: maplebed: The issue with "conditional dependencies" is that those deps are evaluated server-side right now, which means they need to be full declarative and safe
[2013-11-20 19:18:23 -0500] coderanger: maplebed: I think kallistec has been musing on how to move dep resolution to the client, but not sure how that would work
[2013-11-20 19:18:49 -0500] spheromak: was a bit of discussion around moving the depsolving out to the tooling or the clients
[2013-11-20 19:19:03 -0500] spheromak: or both
[2013-11-20 19:19:13 -0500] maplebed: cool. well, I'm fine for now. This time it came up because I was submitting a pull request and adding apt, which felt weird because the Vagrantfile spins up a redhat instance. But it's part of adding support for ubuntu to the cookbook, so meh.
[2013-11-20 19:21:16 -0500] coderanger: spheromak: Yeah, I know the immediate problem is version constraint solving because people keep DoSing the server, but it would be handy for this too
[2013-11-20 19:41:40 -0500] spheromak: for sure
[2013-11-20 19:51:28 -0500] there_is_only_on: Can anyone help me debug this? https://gist.github.com/azretd/33708b8f51ac1197d6c2#file-gistfile1-txt, is there a reason why my recipe is not completing? I am finding that that the "/opt/local/ant" directory is not being created
[2013-11-20 19:52:10 -0500] there_is_only_on: It should be noted that I have 3 other recipes like  the install ant bash script that install successfully
[2013-11-20 20:02:14 -0500] coderanger: there_is_only_on: "cp ant/dbupgrader.jar /opt/local/ant/lib/." is not valid bash AFAIK
[2013-11-20 20:02:18 -0500] coderanger: drop the trailing .
[2013-11-20 20:03:29 -0500] there_is_only_on: coderanger, but i think the reason that is failing is because of the prior recipe not being completed no?
[2013-11-20 20:04:07 -0500] coderanger: I don't see anything in that recipe creating that folder
[2013-11-20 20:04:26 -0500] there_is_only_on: bash "install_ant" do
[2013-11-20 20:04:26 -0500] there_is_only_on:   cwd ::File.dirname(ant_src_filepath)
[2013-11-20 20:04:26 -0500] there_is_only_on:   code <<-EOH
[2013-11-20 20:04:26 -0500] there_is_only_on:     mkdir -p #{ant_install_path}
[2013-11-20 20:04:52 -0500] coderanger: Oh, ouch
[2013-11-20 20:04:57 -0500] coderanger: Why not use a directory resource?
[2013-11-20 20:05:27 -0500] coderanger: More specifically that isn't creating the lib/ subfolder
[2013-11-20 20:05:36 -0500] coderanger: which is probably why bash is complaining
[2013-11-20 20:05:48 -0500] btm: @opscode chef/ohai code review: join: https://plus.google.com/hangouts/_/76cpj9chtkmg93r00mrv7lrvjk, watch: http://youtu.be/kmWBSD6Ys3M
[2013-11-20 20:06:05 -0500] there_is_only_on: its not even creating the original folder
[2013-11-20 20:06:12 -0500] there_is_only_on: with -p it should create opt/local/ant
[2013-11-20 20:06:29 -0500] there_is_only_on: then it should extract apache-ant-version-bin.tar.gz into the directory
[2013-11-20 20:07:23 -0500] there_is_only_on: this same script works with activemq and maven, so I'm trying to figure why does it not work with ant
[2013-11-20 20:09:12 -0500] jtimberman: there_is_only_on: you want recursive true w/ the directory resource
[2013-11-20 20:12:56 -0500] supercom32: Is there a Windows resource for un-archiving tar files? Would perhaps windows_zipfile do it? (wishful thinking)
[2013-11-20 20:13:36 -0500] coderanger: supercom32: I don't think windows has native support for Tar archives
[2013-11-20 20:13:55 -0500] supercom32: coderanger: I see.
[2013-11-20 20:28:48 -0500] supercom32: Assuming you want to create a recipe that downloads version <x>, is there a way to pass this to your recipe at knife command line rather than have specific recipes for each version of the product you want to install? I assume there's a way to do this.
[2013-11-20 20:32:37 -0500] Holos: Do people use the chef LWRP for users? or the other one on github? The Chef based one seems to not create directories on Debian for me, and there are bugs that are 2+ years old...
[2013-11-20 20:48:49 -0500] there_is_only_on: jtimberman, i think I kind of have that with mkdir -p, I think what I am going to do is create the directories outright and just have them extract there, theres not much i can do outside of that
[2013-11-20 20:49:27 -0500] there_is_only_on: 3/4 installs are structured the same way, its the 4th install (when i move them around it changes which gets installed) thats the issue
[2013-11-20 20:49:42 -0500] there_is_only_on: i wouldn't ask you guys to debug the whole recipe though
[2013-11-20 20:49:54 -0500] there_is_only_on: I'm officially lost on why it works that way
[2013-11-20 20:51:44 -0500] michaelhart: is there a way in a recipe or provider to determine if a service has already been defined?
[2013-11-20 20:51:50 -0500] michaelhart: that is, i have a
[2013-11-20 20:52:32 -0500] michaelhart: oops, "service 'blah' do" in a recipe, but want to lookup in another recipe or provider if that service resource is defined or not.
[2013-11-20 20:56:32 -0500] Joel: the opscode community cookbook calls service "apache2" do... twice, is that acceptable? I thought some resources had to be unique, or only one gets called?
[2013-11-20 21:00:04 -0500] Joel: in a recipe I have service "apache2" do action [:enable, :start ] end and it keeps re-enabling the service, thoughts? http://pastebin.com/wfu4Sxw7
[2013-11-20 21:06:29 -0500] there_is_only_on: yea adding recursive directory creation did nothing, same issue
[2013-11-20 21:07:39 -0500] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/7acpj597in1p5ip3bb09a2diqg, watch: http://youtu.be/uAh7b1iCD8U
[2013-11-20 21:12:49 -0500] supercom32: If a recipe depends on another one, will it automatically get added to your run_list when the recipe is required?
[2013-11-20 21:13:02 -0500] supercom32: provided you add it as a depends of course.
[2013-11-20 21:21:24 -0500] Joel: supercom32: yes.
[2013-11-20 21:23:48 -0500] wamilton: anyone know if it's possible to include_recipe in a recipe invoked with chef-apply ?
[2013-11-20 21:24:31 -0500] Joel: what exactly is current_resource?
[2013-11-20 21:25:47 -0500] sn0wb1rd: joel an object holding the current state of the resource
[2013-11-20 21:26:45 -0500] zts: supercom32: no - "depends" points to a cookbook, but that will be loaded when the cookbook is loaded.  If your recipe depends on another one, you need to use "include_recipe 'othercookbook::recipe'" to load it
[2013-11-20 21:27:01 -0500] Joel: sn0wb1rd: I have a service that constantly keeps getting enabled, which from chef/provider/service.rb leads me to believe the current_resource isn't holding correct info, thoughts?
[2013-11-20 21:29:14 -0500] Joel: it's a simple call, I'm just doing service apache 2 enable start, on ubuntu.
[2013-11-20 21:29:23 -0500] Joel: 10.04
[2013-11-20 21:33:54 -0500] matchs: Hello Everyone! I'm new using chef and I'm getting a problem using it with fabric and vagrant on windows. I know, I know, everybody told me to switch to linux or mac, but I want to see if it can be done on Windows too. Ok, here goes the question: When I run > fab vagrant bootstrap I get an error saying that it was unable to load Chef API configuration. Can anyone help me with it?
[2013-11-20 21:34:37 -0500] there_is_only_on: matchs how did you install chef? through ruby gems or through the chef binary?
[2013-11-20 21:34:50 -0500] jmickle: match's theres no reason the answer should be switch to linux or mac... you should be able to use what you are comfortable with
[2013-11-20 21:35:13 -0500] jmickle: matchs: are you supplying the proper chef configuration directory?
[2013-11-20 21:35:15 -0500] matchs: I installed it through the chef binary
[2013-11-20 21:37:07 -0500] matchs: jmickle: idk if I'm supplying it correclty. Actually this project already runs on linux and mac and I'm trying to put it to run on windows. Can you help me to figure it out?
[2013-11-20 21:37:59 -0500] jmickle: matchs: TBH i haven't ever done it on windows, i am not sure what the process would even look like. It just seems like its not finding your knife configuration to plugin the chef server variables properly
[2013-11-20 21:38:18 -0500] matchs: I've figured out for myself that the exception is being thrown when my fabfile.py calls chef_roledefs()
[2013-11-20 21:38:21 -0500] jmickle: when it bootstraps verify if its filling in the URL for your chef server properly
[2013-11-20 21:38:39 -0500] jmickle: sounds like its probably using default of like localhost or something
[2013-11-20 21:38:46 -0500] jmickle: and not getting your actual server URL
[2013-11-20 21:38:51 -0500] matchs: env.roledefs = chef_roledefs(hostname_attr = ['ec2.public_hostname','ipaddress'])
[2013-11-20 21:38:54 -0500] matchs: that's the line
[2013-11-20 21:39:04 -0500] jmickle: yeah but is it actually populating the variable
[2013-11-20 21:39:16 -0500] jmickle: on linux it would be /etc/chef/chef.rb i think
[2013-11-20 21:39:22 -0500] jmickle: that contains the chef_server_url
[2013-11-20 21:39:24 -0500] jmickle: variable
[2013-11-20 21:40:38 -0500] matchs: hummm... when I installed chef it created a C:\chef folder. I searched on web and tried to place a solo.rb file with the paths to my roles, databags and cookbooks folders
[2013-11-20 21:41:23 -0500] matchs: how can I check which URL it is getting?
[2013-11-20 21:49:09 -0500] matchs: jmickle: I just opened the chef log and found an entry that says that there was a FATAL error cause it could not find the validation.pem file
[2013-11-20 21:49:27 -0500] jmickle: perfect
[2013-11-20 21:49:48 -0500] jmickle: so its not finding the right validator pen file, which means you need to fill that info in or the location attr is not being passed in
[2013-11-20 21:50:18 -0500] jmickle: you may need to specify that attr as well
[2013-11-20 21:50:28 -0500] dagan: Can anyone tell me how to return a rendered template as a string?
[2013-11-20 21:50:47 -0500] dagan: I'd like to assign the contents of a template to an attribute
[2013-11-20 21:51:38 -0500] matchs: jmickle: ok... I'll try to figure out what to do with the validation.pem and see what happens
[2013-11-20 21:51:49 -0500] jmickle: ;-) hope that helps matchs
[2013-11-20 21:52:17 -0500] glen: how can i resolve platforms like omnios to platform family?
[2013-11-20 21:52:22 -0500] matchs: jmickle.. me too hehehehe
[2013-11-20 21:57:14 -0500] matchs: jmickle, the FATAL disapeared and now I have WARNs that says that it was unable to detect ipadress, macadress and ip6address
[2013-11-20 21:57:37 -0500] matchs: jmickle, by the way, thanks for your help so far
[2013-11-20 21:58:34 -0500] glen: how do i write code blocks in jira? (tickets.opscode.com)?
[2013-11-20 22:01:13 -0500] matchs: there_is_only_on, is there any difference between installing through gem or binary?
[2013-11-20 22:01:57 -0500] jmickle: matchs: no problem definitely good you are getting progress, what ip are you trying to pull? sounds like the ohai stuff is not populating properly or may not be pulling it properly
[2013-11-20 22:02:28 -0500] jmickle: matchs: sounds like you may be hitting something with that actual virtualization framework you are using now + ohai collection check your plugins to make sure you have the right configs set
[2013-11-20 22:02:52 -0500] jmickle: matchs: i ran into similar using vagrant-chef-zero on my mac and it was because the node[:ec2] fields weren't populating on my set up for obvious reasons
[2013-11-20 22:03:40 -0500] jmickle: matchs: btw idk who told you to switch to linux or mac as the answer but tell them to go pound sand :-)
[2013-11-20 22:04:50 -0500] matchs: jmickle, lol. I agree with you. I've used linux for coding for almost 5 years, now I'm trying to code on windows.
[2013-11-20 22:05:15 -0500] jmickle: matchs: use whatever you like, thats the beauty of our world :-)
[2013-11-20 22:05:34 -0500] jmickle: matchs: there is no "right" answer there are only blatantly wrong answers ;-)
[2013-11-20 22:05:53 -0500] matchs: jmickle, The guys who told me to switch to linux or mac are my coworkers, I'm new here, so they make some jokes with me.
[2013-11-20 22:06:03 -0500] matchs: jmickle, lol, you're right
[2013-11-20 22:06:07 -0500] jmickle: matchs: got it, where you at?
[2013-11-20 22:06:17 -0500] matchs: jmickle, Brazil
[2013-11-20 22:06:25 -0500] jmickle: matchs: i meant company
[2013-11-20 22:06:41 -0500] matchs: jmickle, The company name is jusBrasil
[2013-11-20 22:06:44 -0500] jmickle: oh
[2013-11-20 22:06:47 -0500] jmickle: cool ;-)
[2013-11-20 22:07:06 -0500] matchs: jmickle, it's a cool company here, but it's not internationally known (yet)
[2013-11-20 22:07:14 -0500] jmickle: makes sense
[2013-11-20 22:07:43 -0500] jmickle: well i hope that helps i don't know much about the windows stack haven't used it and don't want to with all honesty but meh its still the same shit concepts are still the same
[2013-11-20 22:07:55 -0500] jmickle: even rocket science is not that hard ;-)
[2013-11-20 22:08:03 -0500] matchs: lol, yeah
[2013-11-20 22:08:21 -0500] matchs: Actually I'm pretty sure it's just some config I may be missing
[2013-11-20 22:08:29 -0500] matchs: not a Windows issue
[2013-11-20 22:08:31 -0500] jmickle: yeah sounds like you are on the right track now though
[2013-11-20 22:08:43 -0500] jmickle: fiddle around with your config and i bet you will find it
[2013-11-20 22:08:52 -0500] matchs: ok, gimme one sec
[2013-11-20 22:09:50 -0500] matchs: jmickle, that's my client.rb file: http://pastebin.com/c0cj0dB3
[2013-11-20 22:11:36 -0500] netty195: hi all
[2013-11-20 22:13:38 -0500] jmickle: matchs: hmm it looks fine ;-/
[2013-11-20 22:14:13 -0500] jblaine: So check this out
[2013-11-20 22:14:25 -0500] matchs: jmickle, tricky...
[2013-11-20 22:15:26 -0500] jblaine: chef-client --once -o 'recipe[chef-client::config],recipe[chef-client::service]'
[2013-11-20 22:16:06 -0500] jblaine: chef-client runs. The recipe reconfigures the client.rb and reloads it, overriding --once. That chef-client never exits.
[2013-11-20 22:17:52 -0500] jblaine: That's going to royally suck to fix.
[2013-11-20 22:18:47 -0500] bretep: I have to build a yaml based configuration and it must be one file, however different configuration yaml blocks can be made depending on the role of a server. I'd like to have chef concatinate everything in a dirctory example: /config.d/*.yml and that will be used in the config.yaml template. Any suggesions?
[2013-11-20 22:38:17 -0500] supershabam: any best practices about including tarballs in the files directory of a cookbook?
[2013-11-20 22:38:53 -0500] FernandoEscher: hello there
[2013-11-20 22:39:46 -0500] FernandoEscher: does anyone knows how to apply a fix on rails_application for this bug fix? https://tickets.opscode.com/browse/CHEF-3940
[2013-11-20 22:46:28 -0500] matchs: jmickle, thanks for the help pal. I gotta go now. I'll try to figure it out again tomorrow.
[2013-11-20 22:49:33 -0500] clayb: I have two roles which specify override_attributes; one inherits from the other. The child role however can't set an attribute to [ ], it stays [ "foo", "bar" ]. Do attributes not over ride if they evaluate to false, or are lists special?
[2013-11-20 22:50:17 -0500] clayb: I'm not quite groking this behavior from either: http://docs.opscode.com/essentials_cookbook_attribute_files.html or http://docs.opscode.com/chef_overview_attributes.html
[2013-11-20 23:08:44 -0500] adnichols: supershabam: including tarballs in the files directory implies you are committing them to your scm, don't really suggest that
[2013-11-20 23:09:35 -0500] clayb: I usually use remote_file for tarballs then I can use something better for tracking binaries (or non-diffable bits)
[2013-11-20 23:09:53 -0500] adnichols: clayb: yes, host somewhere & use remote_file
[2013-11-20 23:11:43 -0500] adnichols: "don't really suggest that" probably isn't strong enough in some companies individuals would hunt  you down and hurt you for doing that :)
[2013-11-20 23:19:41 -0500] mischief: hey everyone, i'm new so be gentle. i've inherited a system running vagrant and chef-solo that is public facing, and insecure. what is the best way to ensure secure access to the guests? creating a custom vagrant image, or using chef to manage the passwords/keys? is there a document describing this in detail anyone can point me to?
[2013-11-20 23:26:07 -0500] jameson__: mischief: install fail2ban and turn off password login and make it sshkeys only.  make chef-solo update the authorized keys on runs
[2013-11-20 23:40:57 -0500] coderanger: jameson__: With ssh keys, fail2ban is probably redundant
[2013-11-20 23:43:58 -0500] jameson__: coderanger: I ban for failing public key check too many times
[2013-11-20 23:44:21 -0500] coderanger: jameson__: Meh, let em try, not like they can even brute force an SSH key
[2013-11-20 23:44:29 -0500] jameson__: s/too many/too quickly/
[2013-11-20 23:44:38 -0500] mischief: i use sshguard myself
[2013-11-20 23:44:54 -0500] coderanger: jameson__: If I ever had CPU load issues from sshd I might care, but thats never happened
[2013-11-20 23:44:55 -0500] mischief: but the primary issue is that in the current config, the vagrant vms are open to the world.
[2013-11-20 23:45:33 -0500] jameson__: you the ports are?
[2013-11-20 23:45:44 -0500] mischief: unfortunately.
[2013-11-20 23:46:26 -0500] mischief: i'm setting up vagrant and chef on a local system so i can test config changes without affecting the existing setup, until i arrive at a solution
[2013-11-20 23:48:47 -0500] jameson__: you can make vagrant so it can only be reached by the host-vm isn't that the default network setting?
[2013-11-20 23:49:21 -0500] jameson__: or is the issue that anyone in the host vm can touch the vm?
[2013-11-20 23:50:01 -0500] jameson__: the former is a setting in the vagrant file, the latter is.. you have to trust the other people who you share the machine with who has sudo?
[2013-11-20 23:50:21 -0500] mischief: jameson__: we currently forward ssh ports with vagrant so that developers can access these guests.
[2013-11-20 23:50:54 -0500] mischief: :-(
[2013-11-20 23:53:34 -0500] jameson__: then sshkeys are about it.
[2013-11-20 23:54:25 -0500] mischief: uh
[2013-11-20 23:54:49 -0500] mischief: right
[2013-11-20 23:55:08 -0500] mischief: well, now i have to figure out why this vagrant file wont run on my local system
[2013-11-20 23:55:30 -0500] mischief: i was lied to, it's not as easy as 'vagrant up'
[2013-11-20 23:55:41 -0500] mischief: jameson__: thanks for the information, i'll see what i can do
