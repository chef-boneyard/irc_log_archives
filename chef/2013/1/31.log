[2013-01-31 00:10:40 -0500] miah: mhalligan: no
[2013-01-31 00:11:23 -0500] miah: basically i will have stuff like graphite_host and have it ||=
[2013-01-31 00:11:52 -0500] miah: mhalligan: if you want to swing by sometime i can show you how i'm doing it.
[2013-01-31 00:12:03 -0500] miah: or chat me up on im
[2013-01-31 00:12:06 -0500] miah: you know the drill
[2013-01-31 00:17:04 -0500] Machello: anyone else tested chef_handler LWRP with an error in the chef_client run?
[2013-01-31 00:45:39 -0500] mhalligan: miah: no to what?
[2013-01-31 01:21:57 -0500] nickh: Hello, does anyone have any idea why this change to the node doesn't persist after a chef run?
[2013-01-31 01:22:02 -0500] nickh: If I run: knife node edit --all bckupserver-us-gov-west-1a
[2013-01-31 01:22:12 -0500] nickh: and set bckp_group:          3
[2013-01-31 01:22:29 -0500] nickh: I can verify with: knife node show bckupserver-us-gov-west-1a --long | fgrep -i bckp_group
[2013-01-31 01:23:28 -0500] nickh: but then if I run chef-client on that node, it gets reset back to 0 (the default in the attributes file)...  I don't have any override attributes settings for any of its roles yet...
[2013-01-31 01:24:35 -0500] timsmith: Does anyone use passenger with the nginx cookbook?
[2013-01-31 01:36:51 -0500] jtnz: If a Chef run fails during the compilation phase, then an exception handler won't actually have been loaded yet will it?
[2013-01-31 02:30:14 -0500] jonathanmickle: Hi, does anyone know how to use hostname to access an attribute in an environment file
[2013-01-31 02:30:39 -0500] jonathanmickle: for example if i have a hostname that i know will always be present and its is in an object in the environment.json
[2013-01-31 02:30:44 -0500] jonathanmickle: x: {
[2013-01-31 02:31:19 -0500] jonathanmickle: oops x: { "hostname": { attr1: "", attr2 : ""} }
[2013-01-31 02:47:30 -0500] robbkidd: jonathanmickle: Is it the hostname of the node on which you are taking some action? Or are you trying to look up a hostname of some other node?
[2013-01-31 02:48:23 -0500] jonathanmickle: hostname of the node
[2013-01-31 02:48:35 -0500] jonathanmickle: basically i have some hostnames that will always be present for use in an app
[2013-01-31 02:48:42 -0500] jonathanmickle: but i have attributes under each one
[2013-01-31 02:49:03 -0500] jonathanmickle: and its attributes are particular to this app so thats where X is x is the name of the app (in this case)
[2013-01-31 02:49:05 -0500] robbkidd: What is "x:" in your hash above?
[2013-01-31 02:49:10 -0500] robbkidd: Ah.
[2013-01-31 02:49:26 -0500] jonathanmickle: then I have hash with attributes for each server
[2013-01-31 02:49:43 -0500] robbkidd: node[:x][:hostname][:attr1]  if I'm in line with your description.
[2013-01-31 02:49:56 -0500] jonathanmickle: basically heres the use case, this is a node app and we are deploying two node instances per server and each instance has to have a particular port in its config
[2013-01-31 02:50:07 -0500] jonathanmickle: the problem is i need to pull :hostname from the server being launched
[2013-01-31 02:50:14 -0500] jonathanmickle: so i need :hostname filled in automatically
[2013-01-31 02:50:19 -0500] robbkidd: Ah.
[2013-01-31 02:50:51 -0500] jonathanmickle: i do this in templates with <%= node.name %>
[2013-01-31 02:51:10 -0500] jonathanmickle: i tried this right now cnAttr = node[:app][node.name]
[2013-01-31 02:51:20 -0500] jonathanmickle: but chef errored saying no attribute
[2013-01-31 02:51:55 -0500] robbkidd: That's in node[:hostname] or node.hostname
[2013-01-31 02:52:22 -0500] robbkidd: You have knife configured to talk to your chef server?
[2013-01-31 02:52:45 -0500] jonathanmickle: yeah
[2013-01-31 02:52:59 -0500] jonathanmickle: i wish i could essentially do
[2013-01-31 02:53:05 -0500] jonathanmickle: node[:app
[2013-01-31 02:53:06 -0500] jonathanmickle: oops
[2013-01-31 02:53:14 -0500] robbkidd: Try: knife node show <hostname> -a hostname
[2013-01-31 02:53:21 -0500] jonathanmickle: node[:app][node[:hostname]]
[2013-01-31 02:53:37 -0500] jonathanmickle: thats essentially what i need
[2013-01-31 02:53:43 -0500] jonathanmickle: i know hostname get populated for sure
[2013-01-31 02:53:59 -0500] robbkidd: So do it in two lines:
[2013-01-31 02:54:08 -0500] robbkidd: hostname = node[:hostname]
[2013-01-31 02:54:20 -0500] robbkidd: node[:app][hostname][:attr1]
[2013-01-31 02:54:26 -0500] jonathanmickle: ahh
[2013-01-31 02:54:31 -0500] jonathanmickle: didn't realize that would work
[2013-01-31 02:55:22 -0500] robbkidd: Yep. It's all just Ruby, man.
[2013-01-31 02:55:49 -0500] jonathanmickle: yeah i just can't ever agree with ruby ;-p
[2013-01-31 02:55:50 -0500] robbkidd: Or, well, you should try it first. But that should work.
[2013-01-31 02:56:19 -0500] robbkidd: No configuration management systems have yet been written in JavaScript. So you're stuck with Ruby for the foreseeable future.
[2013-01-31 02:59:09 -0500] jonathanmickle: hahahaha yeah i know thank you so much for your help I'm trying that out right now
[2013-01-31 03:03:05 -0500] jonathanmickle: agh it errored
[2013-01-31 03:11:37 -0500] Majost: What is the correct way to override attributes from dependent cookbooks, within the cookbook?
[2013-01-31 03:11:55 -0500] Majost: In the recipe, or the attribute file?
[2013-01-31 03:12:49 -0500] miah: i only ever do overrides in environments
[2013-01-31 03:13:41 -0500] Majost: hrm
[2013-01-31 03:14:08 -0500] Majost: What I am trying to do is set this: ['nginx']['default_site_enabled'] -- to False when using my cookbook.
[2013-01-31 03:31:48 -0500] juliancdunn: Majost: I usually do node.set in that situation
[2013-01-31 09:34:04 -0500] daxroc: Morning all
[2013-01-31 09:36:25 -0500] daxroc: What's the best place to configure per node attributes that might change but do have a default set in the cookbook/attributes/default.rb can you identify them by hostname/nodename or am I thinking of this wrong ?
[2013-01-31 09:48:56 -0500] ssd7: daxroc: Typically, when I hit a problem like that I think *very* carefully about whether I *actually* have per node attributes
[2013-01-31 09:49:14 -0500] ssd7: or do I have attributes that are per role but I just happen to have 1 node in that role.
[2013-01-31 10:00:40 -0500] daxroc: no these would be customised per node, ie some sites would have role attributes and some specific ones would need to overide them so I'm thinking node here ?
[2013-01-31 10:01:40 -0500] daxroc: eg a db role with app1 uses the role settings a db role with app1, 2,3 uses node specific?
[2013-01-31 10:02:36 -0500] daxroc: *settings -> attributes
[2013-01-31 10:19:17 -0500] ssd7: daxroc: Well, I'd have to see the specifics to have a strong opinions.  When forced to do per-node stuff, I tend to make an attribute that is a hash where the keys are the node fqdn's
[2013-01-31 10:22:42 -0500] daxroc: ssd7: I might not have the right mindset yet, still learning ruby & chef
[2013-01-31 10:25:38 -0500] ssd7: np, don't mean to sound short.  A bit late here.  Generally with Chef (or any config management, really), you want to avoid modelling problems in such a way that you would need node-by-node customization.  Sometimes it can seem silly since you might only have one server that is the "db server for app1", but reallly, in general, I would do a seperate role for something like that which builds on your base db role.
[2013-01-31 10:30:19 -0500] daxroc: ssd7: I could endup with quite a few roles tho 100s
[2013-01-31 10:31:42 -0500] daxroc: ssd7: How do you convert and send an enviornment to the server?
[2013-01-31 10:31:49 -0500] daxroc: *environment
[2013-01-31 10:32:07 -0500] ssd7: daxroc: Right, so there are probably details of this problem I don't know.  Chef provides a lot of ways to model problems though, so sometimes it is best to dig in and experiment a bit.
[2013-01-31 10:32:26 -0500] ssd7: daxroc: Unsure what you mean.  As in, do you currently have some json you want to upload as an environment?
[2013-01-31 10:33:22 -0500] daxroc: I've got a dsl.rb in environment/mine.rb
[2013-01-31 10:34:27 -0500] ssd7: daxroc: Ahh, just try: knife environment from file environment/mine.rb
[2013-01-31 10:37:00 -0500] daxroc: ssd7: thanks, may add that to the rakefile. The docs do say use rake install but it's not running from file ?
[2013-01-31 10:37:46 -0500] ssd7: daxroc: Can you point me to the docs that say that?  You should't use that rakefile for much.
[2013-01-31 10:37:55 -0500] ssd7: s/much/anything really/
[2013-01-31 10:39:52 -0500] daxroc: It's in the wiki but it does say they've been moved to docs , http://wiki.opscode.com/display/chef/Environments
[2013-01-31 10:41:58 -0500] ssd7: I'll make a note to clean that up, thanks.
[2013-01-31 10:42:41 -0500] daxroc: ssd7: appreciate the help.
[2013-01-31 10:43:06 -0500] ssd7: daxroc: np :(
[2013-01-31 10:43:08 -0500] ssd7: :)
[2013-01-31 10:43:09 -0500] ssd7: opps
[2013-01-31 10:43:19 -0500] ssd7: now I know it is getting late. Can't even get my smilies right
[2013-01-31 10:43:46 -0500] daxroc: Where are you based?
[2013-01-31 10:44:16 -0500] mattt: MARS
[2013-01-31 10:44:59 -0500] ssd7: :)
[2013-01-31 10:45:19 -0500] ssd7: Seattle, which is similar to Mars depending on where you're from.
[2013-01-31 10:46:38 -0500] tknerr: ohai chefs!
[2013-01-31 10:46:53 -0500] mattt: ssd7: seattle's very nice
[2013-01-31 10:48:01 -0500] ssd7: indeed :)
[2013-01-31 10:48:10 -0500] tknerr: is there any way to detect if we are running in a vagrant environment from within a chef recipe?
[2013-01-31 10:48:49 -0500] tknerr: reason is: i want to include a recipe only when running in vagrant
[2013-01-31 10:49:54 -0500] mattt: tknerr: there is an ohai param that indicates which virt type you're in, would that help?
[2013-01-31 10:50:20 -0500] tknerr: mattt: good point, let me check...
[2013-01-31 10:50:30 -0500] mattt: not familiar w/ vagrant tho :(
[2013-01-31 10:52:15 -0500] tknerr: `ohai virtualization/system` says `[ "vbox" ]`
[2013-01-31 10:52:35 -0500] tknerr: thats an indicator for virtualbox at least
[2013-01-31 10:53:48 -0500] tknerr: oh, and `ohai current_user` says `[ "vagrant" ]`, that's a good indicator as well
[2013-01-31 10:53:54 -0500] tknerr: thanks mattt!
[2013-01-31 10:54:08 -0500] mattt: tknerr: there may be a better way, i'm new to chef and that was the first thing that sprang to mind
[2013-01-31 10:56:18 -0500] tknerr: mattt: np, that was super helpful as I didn't think of ohai. It works for now...
[2013-01-31 10:56:31 -0500] daxroc: offtopic here but are *.json files allowed to have /* */ comments, do they work with chef ?
[2013-01-31 10:57:52 -0500] daxroc: afaik its up to the decoder to parse them and some do others don't
[2013-01-31 10:58:28 -0500] mattt: daxroc: i know when you edit nodes, roles, etc. with knife it does json syntax checking, may be worth testing it there w/ a dummy node/role/whatever
[2013-01-31 11:00:00 -0500] mattt: daxroc: presumably if you use knife from file to import a json whatever, that'll probably give you a red light if the contents are deemed invalid
[2013-01-31 11:00:35 -0500] daxroc: mattt: I did the knife node edit and it wouldn't save changes ?
[2013-01-31 11:01:25 -0500] mattt: daxroc: sounds like it doesn't like it, but i can't say much more than that
[2013-01-31 11:02:25 -0500] daxroc: mattt: not a big issue just we need to add svn keywords to all files might have to put *.json on the exclusion list :D
[2013-01-31 11:02:53 -0500] zts: JSON standard/spec doesn't permit comments
[2013-01-31 11:03:03 -0500] zts: (unfortunately)
[2013-01-31 11:04:10 -0500] zts: https://plus.google.com/118095276221607585885/posts/RK8qyGVaGSr
[2013-01-31 11:33:18 -0500] daxroc: zts: Thanks
[2013-01-31 11:34:19 -0500] zts: np
[2013-01-31 12:11:35 -0500] daxroc: Anyone know where I can get an example node file in dsl?
[2013-01-31 12:34:12 -0500] matti: daxroc: Node file?
[2013-01-31 12:35:46 -0500] daxroc: matti: yeah, node.rb example
[2013-01-31 12:36:02 -0500] daxroc: matti: can a node be in two or more environments ?
[2013-01-31 12:48:14 -0500] emanuele: How do I move or copy files in a recipe? Do I have to use a ruby block?
[2013-01-31 13:03:32 -0500] daxroc: In a recipe can I itterate through each item in an array ?
[2013-01-31 13:03:56 -0500] daxroc: for example to create users
[2013-01-31 13:08:49 -0500] Azrael808: I'm deploying an application using the unicorn, rails and application providers found in the application and application_ruby cookbooks, but I'm unable to pass on environment variables to the Unicorn process
[2013-01-31 13:09:30 -0500] Azrael808: Which the application requires to operate properly
[2013-01-31 13:10:26 -0500] Azrael808: I have found some pull requests/forks of the application_ruby cookbook, which I assume is the best option... But do you guys have any recommendations?
[2013-01-31 13:19:19 -0500] Azrael808: daxroc: I believe so, yes - it's just standard ruby syntax :)
[2013-01-31 14:30:26 -0500] dyer: Hey guys, question, are all attribute files loaded the attributes directory in a cookbook ? For example what if I have a defualt.rb,  hosted.rb, and other.rb. I also have corresponding recipes ( recipes/default.rb, recipes/other.rb, recipes/hosted.rb ), would all the attirbute files be loaded if I was only running recipe[something::default] ?
[2013-01-31 14:31:06 -0500] bougyman: i doubt it
[2013-01-31 14:32:33 -0500] dyer: I think they are....
[2013-01-31 14:32:37 -0500] Guest28292: Hi, annyway to pass a tag at bootstrap?  I've tried using -j  jsonfile
[2013-01-31 14:32:51 -0500] Guest28292: but it says invalid
[2013-01-31 14:33:05 -0500] dyer: says the json is invalid ?
[2013-01-31 14:33:07 -0500] Guest28292: {"tags":["sharedsevices"]}
[2013-01-31 14:33:19 -0500] zts: dyer: pretty sure they are all loaded
[2013-01-31 14:33:34 -0500] kamabe: dyer: http://docs.opscode.com/essentials_nodes_chef_run.html i'm pretty sure chef treats all attributes files as if they are one file. you separate them into files for your convenience. so yeah, they are all loaded regardless of the recipe you're running
[2013-01-31 14:34:22 -0500] Guest28292: yep  error is /usr/lib/ruby.........../json/ommon.rb:148:in 'parse': 743: unexpected token at 'yourjsonfile'
[2013-01-31 14:34:39 -0500] Guest28292: have validated the xml
[2013-01-31 14:34:46 -0500] dyer: well its not XML, its JSON
[2013-01-31 14:34:50 -0500] dyer: knife bootstrap ec2-174-129-45-27.compute-1.amazonaws.com -e foundry --ssh-user ec2-user --identity-file ~/.ssh/key.pem -j '{"rayo": {"artifacts": {"gateway": {"url": "https://xxxxx.s3.amazonaws.com/rayo/rayo-gateway.b113.war"}}}}'
[2013-01-31 14:34:55 -0500] dyer: example of what works for me
[2013-01-31 14:35:30 -0500] Guest28292: sorry I meant json
[2013-01-31 14:35:35 -0500] dyer: Guest28292, looks like a parse error, are you wrapping your json in a single quote?
[2013-01-31 14:35:41 -0500] Guest28292: dyer, but I'm being stupid
[2013-01-31 14:35:52 -0500] dyer: Guest28292, no one said that :)
[2013-01-31 14:35:53 -0500] Guest28292: the bootstrap -j option takes a json string
[2013-01-31 14:35:57 -0500] Guest28292: not a file
[2013-01-31 14:36:12 -0500] dyer: Guest28292, notice how my json string is wrapped in a single quote
[2013-01-31 14:36:14 -0500] Guest28292: should rtfm a bit more carefully lol
[2013-01-31 14:36:17 -0500] dyer: '{"rayo": {"artifacts": {"gateway": {"url": "https://xxxxx.s3.amazonaws.com/rayo/rayo-gateway.b113.war"}}}}'
[2013-01-31 14:36:33 -0500] dyer: was that it ?
[2013-01-31 14:37:39 -0500] Guest28292: dyer, cool - single quotes did it
[2013-01-31 14:37:43 -0500] Guest28292: thanks
[2013-01-31 14:37:43 -0500] dyer: great
[2013-01-31 14:37:46 -0500] dyer: yw
[2013-01-31 14:38:02 -0500] dyer: kamabe, yea, looks like your right
[2013-01-31 14:41:24 -0500] alff: guys, question
[2013-01-31 14:41:26 -0500] alff: http://pastebin.com/8EJpZDK1
[2013-01-31 14:41:45 -0500] alff: ubuntu 12.04
[2013-01-31 14:45:31 -0500] paigeadele: /chef-client uses too much memory on my boxes-----
[2013-01-31 14:47:52 -0500] zts: paigeadele: how much is too much?
[2013-01-31 14:49:00 -0500] petecheslock: paigeadele: what version of chef?  and are you using the omnibus packages or rubygems?
[2013-01-31 14:51:22 -0500] whack: I have a set of machines in a cluster and am currently storing this information with tags. Any best practices on doing this? Would node attributes be better since you can search by field (say, 'cluster:foo')?
[2013-01-31 14:54:35 -0500] orignal29: petecheslock: having the same issue as paigeadele here, and we bootstrapped with rubygems.  Would omnibus have a lower memory footprint?
[2013-01-31 14:55:33 -0500] petecheslock: orignal29: it's possible - what version of ruby is chef currently running under?
[2013-01-31 14:56:04 -0500] petecheslock: i think the newer omnibuses are 1.9.3 (which we saw a slight mem/perf improvement on)
[2013-01-31 14:57:04 -0500] petecheslock: honestly the largest improvement i've seen (on hosted chef only) - was the usage of the new partial search lib (https://github.com/opscode/partial_search)
[2013-01-31 14:57:11 -0500] orignal29: petecheslock: 1.8.7
[2013-01-31 14:57:41 -0500] petecheslock: before that we had heavy usage of Chef Search in our cookbooks and that was a memory drain
[2013-01-31 14:58:28 -0500] chris613: If I have clients that were installed from rubygems, is it possible / helpful to migrate them to omnibus?
[2013-01-31 14:58:37 -0500] zts: whack: I'd tend to use roles or attributes for that kind of thing, but I haven't really used tags (they don't seem to be a commonly used feature)
[2013-01-31 14:59:44 -0500] whack: zts: my roles are more like generic service labels (hadoop, elasticsearch, etc)
[2013-01-31 15:00:26 -0500] whack: i'll play with attributes for now ;)
[2013-01-31 15:00:57 -0500] petecheslock: chris613: yea - we were on rubygems and migrated pretty painlessly to omnibus.  this HW cookbook does all the heavy lifting for you - https://github.com/hw-cookbooks/omnibus_updater
[2013-01-31 15:01:10 -0500] zts: whack: there's definitely more than one way to do it :)
[2013-01-31 15:01:19 -0500] Azrael808: Hey guys (if I'm repeating myself, apologies - I had a connectivity issue): I am trying to host a ruby application with unicorn and I'm using the application and application_ruby cookbook resources, but I'm running into an issue with environment variables.
[2013-01-31 15:01:38 -0500] whack: zts: nod, just looking for alternatives since tags aren't really useful for me as is given syntax limitations ;)
[2013-01-31 15:01:42 -0500] Azrael808:  The unicorn resource doesn't seem to honour the "environment" Hash I'm passing it... Is that expected if I'm using the opscode cookbooks?
[2013-01-31 15:01:47 -0500] whack: zts: anyhoo, thanks for the suggestions!
[2013-01-31 15:01:53 -0500] zts: whack: no problem, hope it works out!
[2013-01-31 15:02:31 -0500] orignal29: petecheslock: This is very interesting, I will check this out, thanks!
[2013-01-31 15:03:54 -0500] gchristensen: tagged? can also use an array as an argument. - is it OR'ing all the arguments? or AND ing them all ? as in - must be tagged foo, bar, and baz, or returns true if its one of foo, bar, or baz.
[2013-01-31 15:06:48 -0500] tknerr: is there a way to get an expanded run_list which also contains the recipes included via `include_recipe`?
[2013-01-31 15:07:11 -0500] chris613: petecheslock: Thanks for that link. This looks like it will help me with another issue I'm having as well!
[2013-01-31 15:07:59 -0500] tknerr: i have tried `node.run_list.expand(node.chef_environment).recipes`, but this expands only the recipes defined in roles, but not recipes included via `include_recipe`
[2013-01-31 15:08:04 -0500] petecheslock: chris613:  no problem - between moving to partial search with hosted chef and omnibus with 1.9.3 ruby - we saw like a 75% decrease in our memory usage
[2013-01-31 15:08:27 -0500] chris613: That's very encouraging!
[2013-01-31 15:08:46 -0500] tknerr: i'm looking for the "fully expanded run_list" so to say... :-)
[2013-01-31 15:13:13 -0500] laurent\: every now and then i'm wondering about attributes merging. let's see what's about nomerge in the tickets :)
[2013-01-31 15:13:18 -0500] rpq: i'm having issues installing with chef-solo, rabbitmq-server starting is failing to start... can anyone here help?
[2013-01-31 15:14:04 -0500] rpq: it seems theres a ticket out for it with a new rabbitmq recipe for a newer version of chef.  even after hacking that new recipe in, i still get an error during the chef-solo isntall
[2013-01-31 15:14:07 -0500] rpq: install*
[2013-01-31 15:15:03 -0500] zts: tknerr: pretty sure that include_recipe doesn't modify the run_list
[2013-01-31 15:17:11 -0500] tknerr: zts: is there a way to tell whether a recipe is being applied to a node? I guess inspecting the run_list is not reliable then as you miss the included recipes...
[2013-01-31 15:17:17 -0500] rpq: http://is.gd/XqzmXX -- here is my output
[2013-01-31 15:21:47 -0500] tknerr: zts: guess I found a way: `node.run_state[:seen_recipes]` shows the included recipes as well.
[2013-01-31 15:22:35 -0500] tknerr: which leads me to the next question: is `node.run_state[:seen_recipes]` searchable via chef search?
[2013-01-31 15:23:08 -0500] zts: tknerr: no, run_state isn't sent to the server.  You could perhaps use a report handler to save it into a regular attribute, and save the node
[2013-01-31 15:24:57 -0500] tknerr: zts: yeah, sounds like an idea
[2013-01-31 15:25:38 -0500] zts: tknerr: I imagine this situation will get a bit better with Chef 11, as I believe it adds some more reporting features
[2013-01-31 15:25:53 -0500] zts: tknerr: though I have no idea whether they'll be visible through search from a node either
[2013-01-31 15:26:15 -0500] rpq: is rabbitmq supposed to run as root or nonroot?
[2013-01-31 15:26:41 -0500] tknerr: zts: i'm currently converting my roles to application cookbooks, i.e. run_lists defined in roles are now include_recipes in the application cookbook-
[2013-01-31 15:27:27 -0500] tknerr: zts: one thing i wasn't aware of is that i'm losing the run_list by doing this.
[2013-01-31 15:28:23 -0500] tknerr: zts: i.e. my run_list now only contains "my-app-cookbook" and suddenly i can't search for nodes with a specific role or recipe anymore :-(
[2013-01-31 15:28:26 -0500] zts: tknerr: yeah, I'm not a fan of that pattern, though I understand many people love it
[2013-01-31 15:28:38 -0500] zts: tknerr: being able to version your "roles" is a big win though
[2013-01-31 15:29:47 -0500] tknerr: zts: that's exactly the point, but they are not roles anymore now... sigh :-/
[2013-01-31 15:31:05 -0500] tknerr: zts: i was already thinking of introducing "marker roles" which are just roles with an empty run_list and no attributes defined applied to a node. at least i could search for roles then...
[2013-01-31 15:45:20 -0500] philsturgeon: Hey guys, getting a similar error to this with chef-server http://tmtk75.github.com/2012/12/24/loaderror_for_moneta_and_the_workaround.html
[2013-01-31 15:45:57 -0500] philsturgeon: if I spin up a new EC2 box I get this error. if I ssh in, remove moneta (0.7.9) and run sudo gem update it will install a newer version of chef and an older version of moneta (0.6.0)
[2013-01-31 15:46:26 -0500] philsturgeon: how do i specify those two versions? chef was 10.14.4 and moneta is obviously trying to get "the newest" version of moneta
[2013-01-31 15:46:33 -0500] philsturgeon: seems like i should pick those two
[2013-01-31 15:52:02 -0500] philsturgeon: where the heck do i set bootstrap_version_string?
[2013-01-31 15:53:11 -0500] gkarekinian: You need to install moneta 0.6.0 _before_ installing chef in your bootstrap script
[2013-01-31 15:53:26 -0500] philsturgeon: gkarekinian: yeah my bootstrap seems to be the place to be
[2013-01-31 15:53:28 -0500] gkarekinian: Since the gemspec specifies it needs any version of moneta, so it's going to grab the latest by default
[2013-01-31 15:53:39 -0500] zts: I thought that had been fixed in a more recent chef release?
[2013-01-31 15:53:41 -0500] philsturgeon: trying to work out how to set bootstrap_version_string, or shall i just remove it and hack it?
[2013-01-31 15:53:51 -0500] philsturgeon: well it MIGHT have been fixed but my chef version is old
[2013-01-31 15:54:02 -0500] philsturgeon: so i need to tell it to install a newer version, hence wondering about bootstrap_version_string
[2013-01-31 15:54:06 -0500] philsturgeon: find in folder gives me nothing
[2013-01-31 15:54:33 -0500] philsturgeon: I have this http://d.pr/i/POos
[2013-01-31 15:54:49 -0500] zts: philsturgeon: knife bootstrap --bootstrap-version ?
[2013-01-31 15:55:51 -0500] philsturgeon: zts: is that a thing? http://d.pr/i/OB43
[2013-01-31 15:55:57 -0500] gkarekinian: --bootstrap-version VERSION  The version of Chef to install
[2013-01-31 15:56:03 -0500] gkarekinian: Yup it's the command line argument
[2013-01-31 15:56:39 -0500] gyre008: is there any way how I can set OVERRIDE attributes in json file ?
[2013-01-31 15:57:18 -0500] gyre008: I just want override attributes...when i dont specify the type of attribute chef-client takes them as automatic and sets them on the chef server
[2013-01-31 15:58:39 -0500] philsturgeon: gkarekinian: knife bootstrap --bootstrap-version 10.18.2 gives ERROR: Must pass an FQDN or ip to bootstrap
[2013-01-31 15:59:33 -0500] gkarekinian: You need to give it a host to bootstrap
[2013-01-31 16:00:29 -0500] philsturgeon: gkarekinian: ahh im building like this; http://d.pr/i/6VDz guess i can just smash in the bootstrap version as an arg there?
[2013-01-31 16:01:52 -0500] gkarekinian: You have two choices basically: Use the same version of chef you're using, but copy the template and install moneta 0.6.0 before chef, or pass the --bootstrap-version 10.18.2 to bootstrap / update your local chef installation to be 10.18.2
[2013-01-31 16:02:19 -0500] gkarekinian: Yup you can just add the argument to those
[2013-01-31 16:02:25 -0500] philsturgeon: gkarekinian: perfect
[2013-01-31 16:02:27 -0500] philsturgeon: thanks!
[2013-01-31 16:02:39 -0500] philsturgeon: i like manually setting the chef version in the create scripts, means i dont get random surprises
[2013-01-31 16:03:42 -0500] daxroc: with encrypted databags is there a simple way to introduce a new shared key if/when a shared key became comprimised ?
[2013-01-31 16:25:08 -0500] alff: question: in previous chef versions all nodes had attributes "Recipes" and "Roles", but in .10.18 i can't locate "Roles" attribute. Was it deprecated?
[2013-01-31 16:26:23 -0500] alff: all roles were expand from run_list to "Roles"
[2013-01-31 16:28:55 -0500] gokr: I have a tar ball that I transfer using cookbook_file and then unpack using bash. Now... it would be neat if i could make it so that it is only transferred/unpacked if the checksum differs from the file in the cache dir. Any ideas?
[2013-01-31 16:29:51 -0500] willejs: hmm, i can only think of doing it by remote_file or http heading the remote file...
[2013-01-31 16:29:56 -0500] gokr: remote_file has a checksum attrib, but... that only prevents unneeded transfer. My issue is that I don't want to run the bash script if the tar ball hasn't changed.
[2013-01-31 16:31:09 -0500] gokr: Also, earlier I experimented using ... remote_directory - but that is dead slow for a large tree with files.
[2013-01-31 16:32:14 -0500] daemon600: When running chef-client in daemon mode, the first run goes perfect with no errors. All runs after that, I get the following  "Resource template[config.conf] is configured to notify resource service[testservice] with action restart, but service[testservice] cannot be found in the resource collection." - Any ideas? Chef: 10.12.0 RHEL 2.6.18-308.1.1.el5
[2013-01-31 16:33:10 -0500] gkarekinian: gokr: You want to use action :nothing on your remote_file and have your remote_directory resource be ran by using notifies
[2013-01-31 16:33:47 -0500] gkarekinian: http://docs.opscode.com/resource_common_notifications.html
[2013-01-31 16:34:36 -0500] gokr: mmmm, but I don't want to use remote_directory because it is waay to slow. But perhaps I can use remote_file + checksum + notification to run bash? Is that what you mean?
[2013-01-31 16:35:20 -0500] daemon600: Already went through that doc - It only fails when running in daemon mode
[2013-01-31 16:35:48 -0500] gkarekinian: gokr: Yes, have the notifies on the remote_file with a checksum
[2013-01-31 16:36:20 -0500] gokr: gkarekinian: Thanks. Also, am i the only one missing an rsync thing?
[2013-01-31 16:40:21 -0500] opyate: Hi chefs, the RAM requirement for Private Chef is 4GB (http://private-chef-docs.opscode.com/installation/standalone.html) Can we expect similar requirements for Chef Server?
[2013-01-31 16:41:14 -0500] mattray1: opyate: yeah, maybe slightly less
[2013-01-31 16:41:36 -0500] opyate: mattray: how much less? I'm trying to gauge which EC2 instance size to go for
[2013-01-31 16:41:48 -0500] mattray: opyate: of course, you can try to run it on whatever you want. With Private Chef we're pushing our customers to make sensible choices
[2013-01-31 16:42:36 -0500] bourke: easy way to check if an Chef::EncryptedDataBagItem is empty?
[2013-01-31 16:42:40 -0500] mattray: opyate: I don't have a good feel for it yet, Omnibus Chef Server 11 should be well-tuned
[2013-01-31 16:42:52 -0500] bourke: thought it was a hash but doesn't seem to have the .empty? function
[2013-01-31 16:43:33 -0500] opyate: mattray: this user experienced OOM which let to an ECONNREFUSED: http://tickets.opscode.com/browse/CHEF-3230 My own server is on 613MB RAM, and I'm having similar problems. I'll try and bump it up to a few gig, then, thanks
[2013-01-31 16:59:32 -0500] willejs: hi guys, and idea why my chef-client isn't creating pid files,even when i specify that it should?
[2013-01-31 17:01:12 -0500] behemphi: @willejs is it erroring on the creation or completing the run and not creating them?
[2013-01-31 17:01:51 -0500] willejs: i presumed it would create a pid file for the duration of the run regardless of outcome, but it doesn't...
[2013-01-31 17:02:08 -0500] willejs: my runs are successful, but whilst chef is running, no pid file is created
[2013-01-31 17:02:27 -0500] behemphi: I think I misunderstood you.  You mean the pid file for the chef-client process
[2013-01-31 17:02:52 -0500] willejs: yeah
[2013-01-31 17:03:02 -0500] willejs: sorry, i should have been more clear
[2013-01-31 17:03:07 -0500] behemphi: ah, you will need someone with far more chef-foo than I
[2013-01-31 17:03:09 -0500] behemphi: :-)
[2013-01-31 17:03:18 -0500] willejs: ohh ;(
[2013-01-31 17:03:45 -0500] willejs: any chef ninjas around?
[2013-01-31 17:03:48 -0500] behemphi: no worries willejs that is a low bar
[2013-01-31 17:05:23 -0500] willejs: cheers anyway tho
[2013-01-31 17:10:51 -0500] jbz: This is sort of derpy, but can anyone point me to a good piece of documentation on converge_by?
[2013-01-31 17:12:01 -0500] jbz: Maybe it's a caffeine shortfall, but my google-fu has failed me
[2013-01-31 17:19:20 -0500] daemon600: No one else having issues with chef-client as daemon on RHEL5?
[2013-01-31 17:20:31 -0500] nickh: If I have this (default['scbackupserver']['bckp_group'] = '0') set in a cookbook's default attribute file and change it for a node using 'knife node edit', it *should* stay at the value I set using knife node edit (unless I have override setting for a role or something like that), correct?
[2013-01-31 17:47:26 -0500] ddilinger: what is considered 'best practices' for cookbook repositories inside your clone of opscode-chef ?  sub-modules?
[2013-01-31 17:47:34 -0500] ddilinger: or is there something a little more refined than git submodules
[2013-01-31 17:50:05 -0500] mattray: ddilinger: take a look at Berkshelf or Librarian, those are generally preferred over git submouldes
[2013-01-31 17:50:31 -0500] ddilinger: mattray: excellent, thanks for the pointer
[2013-01-31 17:50:32 -0500] mattray: both tools interact with the Community site, local filesystems or git repos
[2013-01-31 17:50:59 -0500] mattray: so you track your cookbook dependencies with a file rather than duplicating the code
[2013-01-31 17:54:31 -0500] sethvargo: ddilinger: if you're familiar with bundler for Rubygems, berkshelf will make a lot of sense
[2013-01-31 17:58:15 -0500] juliancdunn: ddilinger: we make separate Git repos for every cookbook
[2013-01-31 17:58:32 -0500] sethvargo: juliancdunn: the problem with that is $$
[2013-01-31 17:58:56 -0500] KarlHungus: ohai sethvargo =)
[2013-01-31 17:59:03 -0500] juliancdunn: sethvargo: you mean if you're using private GitHub repos?
[2013-01-31 17:59:09 -0500] juliancdunn: we're running Gitolite so every repo is free :)
[2013-01-31 17:59:35 -0500] sethvargo: oaaheyyy KarlHungus
[2013-01-31 17:59:40 -0500] sethvargo: juliancdunn:  correct
[2013-01-31 17:59:56 -0500] sethvargo: juliancdunn: consider gitlab then :) there's even a cookbook for that :)
[2013-01-31 18:00:23 -0500] sethvargo: juliancdunn: but it's also more challenging to leverage versioning. you have to tag a sha in stead of a version
[2013-01-31 18:00:26 -0500] sethvargo: instead*
[2013-01-31 18:00:33 -0500] KarlHungus: haha, hmm. i wonder why the database cookbook suggests having a my_app_database_master role, instead of exposing the database servers position in the replication heirarchy with a ohai plugin
[2013-01-31 18:02:10 -0500] juliancdunn: sethvargo: I don't understand what's the downside to tagging a SHA
[2013-01-31 18:02:17 -0500] sethvargo: juliancdunn: semver
[2013-01-31 18:03:24 -0500] juliancdunn: we still use semver but just out-of-band
[2013-01-31 18:09:54 -0500] nickh: If I have this (default['scbackupserver']['bckp_group'] = '0') set in a cookbook's default attribute file and change it for a node using 'knife node edit', it *should* stay at the value I set  using knife node edit (unless I have override setting for a role or something like that), correct?  Whenever I run chef-client on the node, it gets changed back to the default value?
[2013-01-31 18:24:41 -0500] kallistec: nickh: only "normal" attributes persist, which is why you don't see default/override/automatic when editing unless you specify extra flags
[2013-01-31 18:30:46 -0500] bakins: jtimberman: runit cookbook doesn't seem to update the run file (or log/run either) if I want it to. I pass some options that may change (like memcache memory, or something) but file never changes. If I remove file and rerun chef, then I see file with correct content. Is this expected behavior? I looked at the code and see things like:   return @run_script unless @run_script.nil?
[2013-01-31 18:30:53 -0500] bakins: bug or feature?
[2013-01-31 18:32:22 -0500] nickh: Thanks @kallistec, I do see the attribute and can set it with 'knife node edit --all bckupserver-us-gov-west-1a'; however, it gets changed back...  Are you saying that instead of declaring with "default['scbackupserver']['bckp_group'] = '0'", I should do something like "normal['scbackupserver']['bckp_group'] = '0'" in the default attributes file?
[2013-01-31 18:40:15 -0500] josephholsten: bakins: are you running chef 10.16.0?
[2013-01-31 18:40:51 -0500] bakins: josephholsten: 10.18.2
[2013-01-31 18:41:00 -0500] josephholsten: shucks
[2013-01-31 18:41:20 -0500] bakins: chef-solo via berkshelf if that matters
[2013-01-31 18:44:05 -0500] nickh: @kallistec, figured it out...  Sorry, what you were saying didn't sink in until now...  I added '"scbackupserver": { "bckp_group": "3" }' to the 'normal' section when using 'knife node edit --all bckupserver-us-gov-west-1a' and everything is working correctly now :-D
[2013-01-31 18:47:25 -0500] mrtazz: is there a way to delete normal attributes for a node in a recipe so that the default ones take again?
[2013-01-31 18:49:04 -0500] mrtazz: I have a lot of nodes which accidentally got a normal attribute set with an upgrade and now I want to rollback and have them use the defaults again
[2013-01-31 18:50:05 -0500] jbz: Don't do that from recipes
[2013-01-31 18:50:17 -0500] jbz: Are you using hosted chef or your own server?
[2013-01-31 18:50:38 -0500] mrtazz: own server
[2013-01-31 18:51:14 -0500] jbz: If you delete the nodes and clients from the server, will their reregistering themselves be a problem?
[2013-01-31 18:52:13 -0500] mrtazz: hmm that would be a bit of a problem, I mean it would work, but seems very drastic just to get rid of some node attributes
[2013-01-31 18:55:13 -0500] jbz: well alternately you can delete those attributes from the node records
[2013-01-31 18:55:21 -0500] jbz: they'll just reregister the default values next run
[2013-01-31 18:55:29 -0500] jbz: (if there aren't any set on the server, it'll use recipe defaults)
[2013-01-31 18:55:37 -0500] jbz: but that's more fine-grained work
[2013-01-31 18:58:14 -0500] mrtazz: hmm ok
[2013-01-31 18:58:33 -0500] mrtazz: is there a way to bulk edit nodes with knife?
[2013-01-31 18:58:49 -0500] mrtazz: or will I have to do them one by one?
[2013-01-31 19:06:51 -0500] otterley: why is it that 'knife role from file' can take a list of role filenames, but 'knife node from file' can't?
[2013-01-31 19:07:16 -0500] otterley: wrapping 'knife node from file' in a for loop is an order of magnitude slower.
[2013-01-31 19:21:49 -0500] tos9: Hi.
[2013-01-31 19:23:19 -0500] tos9: Your issue tracker on https://github.com/opscode/chef-repo is disabled, but the link in the info bar is (twiceover) out of date :). That link is a 404 for me, and the correct link looks like http://wiki.opscode.com/display/chef/Chef+Repository , which says it's being moved/deleted
[2013-01-31 19:28:08 -0500] webframp: tos9: github issues aren't used, check out http://tickets.opscode.com/
[2013-01-31 19:28:42 -0500] tos9: webframp: Thanks.
[2013-01-31 19:39:16 -0500] otterley: anyone know why knife status is so slow?
[2013-01-31 19:39:21 -0500] otterley: am I the only one?
[2013-01-31 19:44:58 -0500] jonathanmickle: check your chef server
[2013-01-31 19:45:23 -0500] otterley: jonathanmickle, for what?
[2013-01-31 19:45:32 -0500] jonathanmickle: cpu load, network, memory
[2013-01-31 19:45:38 -0500] otterley: all of those are fine, as far as I can tell
[2013-01-31 19:45:44 -0500] jonathanmickle: make sure your server is running healthy
[2013-01-31 19:45:51 -0500] jonathanmickle: knife status takes me a couple seconds
[2013-01-31 19:45:57 -0500] otterley: how many nodes?
[2013-01-31 19:46:10 -0500] jonathanmickle: but it pulls back couple hundred responses for me and i use about 120 nodes
[2013-01-31 19:46:50 -0500] cheeseplus: 2 seconds for me with 20+ nodes and a moderately powerful chef-server (running as a kvm)
[2013-01-31 19:47:29 -0500] otterley: I have 337 nodes, it takes 29s
[2013-01-31 19:47:48 -0500] otterley: it's an 8G VM (on my own bare metal) with 4CPUs.
[2013-01-31 19:47:59 -0500] otterley: only 1.5GB of memory is used
[2013-01-31 19:48:53 -0500] otterley: no significant I/O utilization when I run it
[2013-01-31 19:49:07 -0500] jonathanmickle: welcome to ruby?
[2013-01-31 19:49:08 -0500] jonathanmickle: haha
[2013-01-31 19:49:25 -0500] cheeseplus: s/ruby/couchDB/ ;)
[2013-01-31 19:49:27 -0500] otterley: when I run it, most of the CPU utilization is merb
[2013-01-31 19:49:49 -0500] jonathanmickle: i think its probably something you just have to accept in chef
[2013-01-31 19:49:50 -0500] otterley: then, knife-status itself (ruby)
[2013-01-31 19:50:05 -0500] jonathanmickle: chef has a lot of things that could definitely be improved
[2013-01-31 19:50:21 -0500] otterley: I have noticed that merb (chef-server) takes most of 1 CPU.
[2013-01-31 19:50:24 -0500] jonathanmickle: but i could be wrong
[2013-01-31 19:50:54 -0500] cheeseplus: hopefully I'll be testing chef11 in our dc soon, very curious to see the perf gains
[2013-01-31 19:51:01 -0500] jonathanmickle: yeah
[2013-01-31 19:51:10 -0500] miah: cool
[2013-01-31 19:51:10 -0500] cheeseplus: have to rewrite a few recipes though
[2013-01-31 19:51:35 -0500] miah: my cookbook refactor list is long
[2013-01-31 19:51:44 -0500] jonathanmickle: yeah thats been my hangup from moving to hosted chef
[2013-01-31 19:51:52 -0500] jonathanmickle: I've got around a couple hundred recipes
[2013-01-31 19:52:14 -0500] jonathanmickle: that i inherited and I'm not really up for rewriting all recipes because opscode didn't want to support backwards compatibility
[2013-01-31 19:52:15 -0500] cheeseplus: thankfully I've only got a 20 or so and nothing is really prod there yet
[2013-01-31 19:52:41 -0500] jonathanmickle: so we are staying chef10 for a little while as well
[2013-01-31 19:52:47 -0500] jonathanmickle: until we can slowly work through them
[2013-01-31 19:55:31 -0500] sn0wb1rd: Does anybody here know a way to dynamically update a resource's attribute? I have a method of doing it here: https://gist.github.com/4659646 But it seems to be overly complicated and wanted to see anybody have any simpler way.
[2013-01-31 19:56:33 -0500] Kzim: hi
[2013-01-31 19:57:02 -0500] Kzim: Does anyone have advice on chef orchestration layer ?
[2013-01-31 19:57:25 -0500] cheeseplus: Kzim: ironfan is pretty neat though I haven't implemented myself
[2013-01-31 19:57:28 -0500] flagg0204: is there an example somewhere of reloading a cookbook after another cookbook sets an attribute
[2013-01-31 19:58:40 -0500] jonathanmickle: Kzim: i agree with cheese plus iron fan looks pretty good
[2013-01-31 19:58:45 -0500] Kzim: cheeseplus, i was just watching the ironfan hadoop video if anyone have feedback on this i would be great
[2013-01-31 19:59:05 -0500] jonathanmickle: flagg0204: what do you mean?
[2013-01-31 19:59:10 -0500] ev0ldave: i saw a mention somewhere on the wiki that chef 11 will provide support for cookbooks in more than just ruby
[2013-01-31 19:59:19 -0500] ev0ldave: can anyone point me to that page?
[2013-01-31 19:59:26 -0500] cheeseplus: Kzim: I happen to know some of the guys since they are local and I've seen them demo a few times
[2013-01-31 19:59:28 -0500] jonathanmickle: oops wrong button
[2013-01-31 19:59:45 -0500] cheeseplus: still trying to get it implemented somewhere myself
[2013-01-31 20:00:04 -0500] sn0wb1rd: flagg0204: Do you happen to remember where that was :)
[2013-01-31 20:00:38 -0500] Kzim: cheeseplus, ok do you know a good doc or tuto except the github ?
[2013-01-31 20:01:08 -0500] cheeseplus: Kzim: unfortunately not, just the chefconf video - the other demos were at local workshops/devops meetups
[2013-01-31 20:01:14 -0500] flagg0204: jonathanmickle: so one cookbook does a node.set for a sysctl value.  then the sysctl cookbook interates over those set attributes and make them happen on the os
[2013-01-31 20:01:39 -0500] flagg0204: but the setting ofthe attribute is occuring after the initial sysctl run.  so i wanted a way of reloading the sysctl cookbook to execute again in a chef run
[2013-01-31 20:01:44 -0500] Kzim: cheeseplus, thanks !
[2013-01-31 20:05:23 -0500] jonathanmickle: flagg0204: I would probably use the sysctl cookbook
[2013-01-31 20:05:29 -0500] jonathanmickle: and then set role specific settings
[2013-01-31 20:05:34 -0500] jonathanmickle: so when the sysctl cookbook runs
[2013-01-31 20:05:37 -0500] jonathanmickle: it will set those
[2013-01-31 20:06:53 -0500] flagg0204: yeah im trying to avoid roles, as they are not versionable. but ill look into using the sysctl cookbook
[2013-01-31 20:12:45 -0500] Majost: Is there a decorator I can use to tell foodcritic to ignore a specific line of code?
[2013-01-31 20:13:08 -0500] Majost: from within the actual cookbook that is
[2013-01-31 21:08:34 -0500] BleakLife: are there any updates needed to chef-server in regards to the latest round of ruby vulns?  or is 10.18.2 safe?
[2013-01-31 21:09:11 -0500] BleakLife: i see a security release in early jan, so thinking probably solved already?
[2013-01-31 21:09:31 -0500] Majost: It was resolved afaik
[2013-01-31 21:09:52 -0500] BleakLife: excellent, thanks
[2013-01-31 21:21:17 -0500] bencaron: Is there a way to pass a variable to an recipe included via include_recipe?
[2013-01-31 21:21:53 -0500] bencaron: I tried writing to @value in the parent recipes, but I can't read it inside the included recipe
[2013-01-31 21:23:30 -0500] chris613: bencaron: Only way I know would be via a node attribute
[2013-01-31 21:23:50 -0500] bencaron: that sounds dirty :\
[2013-01-31 21:24:04 -0500] bencaron: I'm already looping on an array of attributes
[2013-01-31 21:24:20 -0500] tomdzk: bencaron: alternatively change that parent code to be a LWRP
[2013-01-31 21:24:40 -0500] bencaron: yeah, you're right, that would be cleaner
[2013-01-31 21:24:54 -0500] chris613: bencaron: What sounds dirty is a design that requires you to pass variables to included recipes that are not appropriate as node attributes
[2013-01-31 21:25:17 -0500] bencaron: chris613: totally right :)
[2013-01-31 21:25:40 -0500] chris613: Many community cookbooks do stuff like this: node.override['postfix']['mail_type'] = 'master' \ include_recipe "postfix"
[2013-01-31 21:26:02 -0500] chris613: Which looks perfectly sane to me
[2013-01-31 21:26:18 -0500] bencaron: i'm probably doing to much stuff in my recipe
[2013-01-31 21:26:35 -0500] bencaron: it's creating jenkins jobs following attributes for the node
[2013-01-31 21:27:06 -0500] bencaron: LWRP sounds a better idea, thx for the hint
[2013-01-31 21:35:56 -0500] nmische: hello, i'm trying to define a default provider for a LWR
[2013-01-31 21:36:15 -0500] nmische: basically i have two LWR that i want to back with one provider
[2013-01-31 21:36:19 -0500] otterley: well, here's why 'knife status' is so slow:
[2013-01-31 21:36:20 -0500] otterley: merb : chef-server (api) : worker (port 4000) ~ Params: {"action"=>"show", "start"=>"0", "id"=>"node", "q"=>"*:*", "sort"=>"X_CHEF_id_CHEF_X asc", "controller"=>"search", "rows"=>"1000"}
[2013-01-31 21:36:21 -0500] otterley: merb : chef-server (api) : worker (port 4000) ~ {:dispatch_time=>19.313127, :action_time=>19.312448, :after_filters_time=>2.3e-05, :before_filters_time=>0.030564}
[2013-01-31 21:36:31 -0500] otterley: 19 seconds!
[2013-01-31 21:36:35 -0500] nmische: anyone know how to do that?
[2013-01-31 21:37:46 -0500] nmische: trying to set @provider = Chef::Provider::MyProvider in the resource's initialize method doesn't seem to work
[2013-01-31 21:38:18 -0500] otterley: also, does the merb app take a global lock or something?  whenever this request is run, all other pending requests hang
[2013-01-31 21:38:22 -0500] otterley: s/hang/block
[2013-01-31 21:39:00 -0500] cwj: nmische: ive never tried to do that, but my guess is that you might have more success writing a full or "heavyweight" (i guess) provider
[2013-01-31 21:39:14 -0500] cwj: and then reuse that in two different lightweight providers
[2013-01-31 21:39:24 -0500] MerlinDMC: otterley, ruby has a GIL if you use the standard runtime ... rbx or jruby don't have that - so maybe you run in the GIL
[2013-01-31 21:39:33 -0500] nmische: @cwj, yeah, i'm thinking that my be my next approach
[2013-01-31 21:39:35 -0500] cwj: the latest release of opscode's runit cookbook would be an example of writing a full provider in a cookbook
[2013-01-31 21:39:45 -0500] otterley: MerlinDMC, that's not very helpful
[2013-01-31 21:39:50 -0500] nmische: cool, i'll take a look thanks!
[2013-01-31 21:40:00 -0500] otterley: a GIL does not preclude concurrency in every case
[2013-01-31 21:47:20 -0500] otterley: it's unlikely to be the GIL because other connections are accepted in the meantime - it's just that they're not handled
[2013-01-31 21:48:04 -0500] tomdzk: otterley: chef server seems to usually run with thin, make sure that it is running in threaded mode
[2013-01-31 21:49:29 -0500] otterley: tomdzk, interesting.  I'm running the Ubuntu package, it shipped with merb
[2013-01-31 21:49:45 -0500] otterley: it may be thin in fact
[2013-01-31 21:49:52 -0500] otterley: I'm just looking at the process list
[2013-01-31 21:50:25 -0500] otterley: nope, it's merb
[2013-01-31 21:50:57 -0500] tomdzk: otterley: the first few lines in teh chef-server log file should show the adapter
[2013-01-31 21:51:25 -0500] otterley: it's thin
[2013-01-31 21:52:03 -0500] tomdzk: thin's threaded mode is marked as marked as experimental, and it also depends on whether the app behind it can handle it
[2013-01-31 21:52:43 -0500] otterley: I'm pretty sure Thin is concurrent even without threaded mode
[2013-01-31 21:52:47 -0500] otterley: it's EM-backed
[2013-01-31 21:53:00 -0500] otterley: but if something behind it is blocking, Thin will block too
[2013-01-31 21:53:32 -0500] tomdzk: otterley: EM means it is non-blocking, that doesn't make it multi-threaded (wrt. to requests)
[2013-01-31 21:53:45 -0500] otterley: tomdzk, I think we agree
[2013-01-31 21:54:23 -0500] tomdzk: you could try to create a /etc/thin/chef-server.yml file with "threaded: true" in it - that might make thin start in threaded mode
[2013-01-31 21:54:40 -0500] tomdzk: however that would require the chef server api app to actually be able to handle that, not sure if it does
[2013-01-31 21:56:06 -0500] josephholsten: should a restart of chef-expander also restart solr?
[2013-01-31 21:56:39 -0500] otterley: tomdzk: trying clustered mode "-c 4"
[2013-01-31 21:57:22 -0500] ctb: just want to confirm. include_recipe only includes the recipe's resources, but does not actually run it, correct?
[2013-01-31 21:58:10 -0500] ctb: that's what i seem to be observing. unless i'm doing it wrong.
[2013-01-31 21:58:33 -0500] josephholsten: ctb: include_recipe should run the recipe
[2013-01-31 21:59:18 -0500] tomdzk: ctb: a dependency in your metadata.rb should be enough
[2013-01-31 21:59:34 -0500] ctb: hmm, i've got bolth, and i get nothing.
[2013-01-31 21:59:37 -0500] tomdzk: if you just want the resources
[2013-01-31 21:59:54 -0500] ctb: i mean, i gain access to the resources, providers, etc
[2013-01-31 21:59:59 -0500] ctb: but it doesn't exec the recipe
[2013-01-31 22:01:01 -0500] ctb: i think i'm just misunderstanding the functionality
[2013-01-31 22:01:19 -0500] josephholsten: it does execute.
[2013-01-31 22:01:40 -0500] tomdzk: ctb: gist/pastebin ?
[2013-01-31 22:28:29 -0500] mattt: i'm trying to use chef/rest to pull node info -- i can pull cookbook/client info, but not node ... throws an error "can't get const Chef::Node: uninitialized constant Chef::Node"
[2013-01-31 22:32:25 -0500] awgross1: Anyone have experience with the elasticsearch cookbook, having some issues getting it to run properly in vagrant
[2013-01-31 22:34:12 -0500] awgross1: I am getting 0.1.0 via tarball from the github page.  It should be loading up 0.20.1, but somehow it is getting 0.19.8
[2013-01-31 22:34:39 -0500] awgross1: either way, when ark gets around to installing it, ark fails to find the appropriate package on github and gets a 404
[2013-01-31 22:35:05 -0500] kallistec: mattt: you have two options: 1) require 'chef/node'. your REST calls will return fully inflated Chef::Node objects; 2) JSON.create_id = "gtfo" -- this will defeat the object inflation and you'll get a Hash back
[2013-01-31 22:35:59 -0500] mattt: kallistec: tried 1), then it threw Attribute to_ary is not defined! ... let me try 2) :)
[2013-01-31 22:37:29 -0500] deed02392: what's the recommended way to install php and all the packages one requires to host their web application?
[2013-01-31 22:37:35 -0500] deed02392: the app runs on nginx+php-fpm
[2013-01-31 22:37:39 -0500] mattt: kallistec: 2) works fine, so this behaviour is expected?
[2013-01-31 22:38:06 -0500] deed02392: should I install nginx and php-fpm as separate recipes, then have my web app cookbook install all the extensions in yet another recipe?
[2013-01-31 22:40:25 -0500] kallistec: mattt: it's a known thing. the json gem that we use by default looks for a key "json_class" when it's parsing and if that exists it looks up that class (like Chef::Node) and calls $class.json_create
[2013-01-31 22:40:54 -0500] mattt: kallistec: k, thanks for the info!
[2013-01-31 22:41:00 -0500] kallistec: really early on we decided to use that behavior
[2013-01-31 22:41:06 -0500] kallistec: now we don't like it so much
[2013-01-31 22:41:29 -0500] kallistec: but it will take a buch of work to get rid of
[2013-01-31 22:42:58 -0500] awgross1: nevermind on my issue, looks like it was some problems with incorrect cookbook load paths
[2013-01-31 22:43:16 -0500] tomdzk: deed02392: recipe or role, probably depends on whether you have additional recipe code that depends on one of the other packages being installed already - for example writing a configuration file owned by a user installed by one of these packages
[2013-01-31 22:48:08 -0500] mikel: hi! Anybody know if an execute command str can contain a pipe?
[2013-01-31 23:07:22 -0500] otterley: tomdzk: can thin bind all the merb processes to a single port?  or do I have to put a reverse proxy in front to balance the load?
[2013-01-31 23:07:36 -0500] tomdzk: otterley: you could try unicorn
[2013-01-31 23:07:40 -0500] otterley: when running merb in clustered mode, it binds all the processes to different ports
[2013-01-31 23:07:57 -0500] tomdzk: otterley: yeah, I don't know much about merb or chef clustered mode
[2013-01-31 23:08:18 -0500] otterley: tomdzk, yeah - this stuff is black magic, apparently.  OC apparently felt like hiding the ball or something
[2013-01-31 23:08:32 -0500] otterley: it's not clear from the docs at all
[2013-01-31 23:08:39 -0500] tomdzk: otterley: have you tried chef 11 ?
[2013-01-31 23:08:42 -0500] otterley: nope
[2013-01-31 23:09:22 -0500] tomdzk: that one is rails iirc, so nginx/unicorn or passenger in front of it should work fine (assuming the codebase is threadsafe)
[2013-01-31 23:09:38 -0500] otterley: it doesn't matter whether it's threadsafe
[2013-01-31 23:10:16 -0500] otterley: multi-process mode is fine, as long as the on-disk persistence is corruption-free
[2013-01-31 23:10:19 -0500] tomdzk: otterley: the chef server api codebase needs to be threadsafe for this to work, or things will get out of hand very quickly
[2013-01-31 23:10:39 -0500] otterley: tomdzk, concurrent != multithreaded
[2013-01-31 23:10:58 -0500] tomdzk: otterley: even in multi-process, it still needs to be able to run multiple instances concurrently
[2013-01-31 23:11:10 -0500] otterley: tomdzk, that's by definition ...
[2013-01-31 23:11:26 -0500] otterley: you are running multiple instances concurrently when you're running multi-process
[2013-01-31 23:11:29 -0500] tomdzk: otterley: it's not - think changing the same file on disk or stuff like that
[2013-01-31 23:11:37 -0500] otterley: tomdzk, see above about on-disk persistence
[2013-01-31 23:12:08 -0500] tomdzk: otterley: I'm just saying, just because you can start chef-server multiple times doesn't mean it will work correctly
[2013-01-31 23:12:20 -0500] otterley: I agree, there are risks
[2013-01-31 23:12:23 -0500] tomdzk: is cluster-mode designed to be run on the same machine ?
[2013-01-31 23:12:43 -0500] otterley: that is the question :)
[2013-01-31 23:13:58 -0500] otterley: hopefully someone here can tell us ...
[2013-01-31 23:15:03 -0500] _0x783czar: So I'm looking for a uniform way to install chef on a number of different servers running different platforms.  I know I can use the omnibus installer for this, but I also need a way to lock or otherwise keep the versions consistent across machines.  Is there a good way of doing this without having ruby already installed on the machines and using the gem?
[2013-01-31 23:16:00 -0500] otterley: this seems to suggest that it is, considering it's answered by @jtimberman : http://serverfault.com/questions/236397/scaling-chef-with-multiple-instances-or-replication
[2013-01-31 23:19:21 -0500] tomdzk: otterley: this seems to be about scaling on multiple machines though
[2013-01-31 23:19:31 -0500] otterley: see the '-c' option tomdzk
[2013-01-31 23:22:58 -0500] tomdzk: otterley: the answer talks about shared filesystem and proxying behind an apache server, clear signs of a multi-machine (clustered) setup
[2013-01-31 23:23:27 -0500] otterley: The question asked about both.
[2013-01-31 23:23:36 -0500] otterley: and the -c option applies to a single host
[2013-01-31 23:26:07 -0500] tomdzk: otterley: http://mrmiller.nonesensedomains.com/2010/06/15/chef-performance-tuning-part-1/
[2013-01-31 23:26:23 -0500] otterley: I saw that, too
[2013-01-31 23:26:36 -0500] tomdzk: seems to be the way to go
[2013-01-31 23:26:49 -0500] otterley: I have it working here, but it's a lot of work.  This should have been working "out of the box" IMO
[2013-01-31 23:38:49 -0500] josephholsten: grr, chef-sole is so screwed on my machine
[2013-01-31 23:38:50 -0500] josephholsten: solr
[2013-01-31 23:45:15 -0500] supster: Can anone tell why ohai isn't reloading as I expect? https://gist.github.com/6ab4226a4860a3f1cf65
