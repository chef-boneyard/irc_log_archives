[2013-01-02 03:22:45 -0500] maqr: a lot of the chef-solo bootstrap scripts that i'm seeing avoid using the system chef... if i'm running the latest ubuntu, is there any reason i should use 'gem install chef' instead of 'aptitude install chef'?
[2013-01-02 05:02:10 -0500] cwj: maqr: i would only install chef from packages (i.e. via aptitude or apt-get) if you are sure you have added the opscode repo to your apt sources
[2013-01-02 05:03:31 -0500] cwj: even packages from latest ubuntu are already out of date
[2013-01-02 05:04:43 -0500] cwj: really if you are just getting started I would try using the omnibus installer, since it works everywhere and has self-contained ruby environment
[2013-01-02 05:05:20 -0500] cwj: http://wiki.opscode.com/display/chef/Installing+Omnibus+Chef+Client+on+Linux+and+Mac
[2013-01-02 05:06:39 -0500] maqr: thanks cwj :)
[2013-01-02 05:06:52 -0500] cwj: you bet
[2013-01-02 05:08:37 -0500] cwj: since the wiki is being phased out you might want to bookmark this instead http://docs.opscode.com/install_step_installer_run.html
[2013-01-02 05:31:06 -0500] maqr: cwj: it actually says it can't retrieve a valid package for my os, but the gem install works fine... i guess i'm supposed to create my own /etc/chef and get the cookbooks from somewhere?
[2013-01-02 05:32:51 -0500] cwj: yeah, you probably need to populate /etc/chef yourself
[2013-01-02 05:33:28 -0500] cwj: a lot of people use a workflow where they use the knife command (ships with chef) to bootstrap chef on a remote host
[2013-01-02 05:33:42 -0500] cwj: bootstrap process installs chef and populates /etc/chef for you
[2013-01-02 05:34:09 -0500] maqr: yeah, most tutorials i've read go that route, but i'm actually doing this for ec2 with user-data and cloudinit, so i don't think i need knife
[2013-01-02 05:34:47 -0500] cwj: havent used cloudinit myself, so not sure what to tell you there
[2013-01-02 05:35:14 -0500] maqr: i've got that part all figured out now, if i can make chef-solo install nginx from my root shell, then i can make it work with cloudinit
[2013-01-02 05:35:40 -0500] maqr: do you know if i'm supposed to have a directory of cookbooks somewhere? or am i supposed to just grab the ones i need in a sort of ad hoc way?
[2013-01-02 05:36:21 -0500] cwj: you generally set up your own repository for chef config data (referred to as your chef repo)
[2013-01-02 05:36:45 -0500] cwj: so that chef repo will contain both the cookbooks you write and the cookbooks other people write which you use
[2013-01-02 05:36:50 -0500] maqr: i read something about how i'm supposed to have 'cookbooks' (the stock ones) and then 'site-cookbooks' (my modified versions of them)
[2013-01-02 05:37:04 -0500] cwj: yeah thats one way to do it
[2013-01-02 05:38:02 -0500] cwj: i usually advocate for using a tool like berkshelf or librarian to manage your chef repo
[2013-01-02 05:38:20 -0500] cwj: they are like bundler if you're familiar with that
[2013-01-02 05:39:29 -0500] cwj: but when people are just getting started it might be a bit much to learn a repo management tool first thing
[2013-01-02 05:39:52 -0500] maqr: hmm i'll check those out, i should probably do it by hand once though
[2013-01-02 05:41:09 -0500] lehrblogger: i'm also just starting out so might be mistaken, but i think you can keep your cookbooks in different directories without using berkshelf or librarian
[2013-01-02 05:41:10 -0500] cwj: as far as your nginx needs go, you probably want to take an approach of creating your own cookbook which specifies the nginx cookbook (http://cookbooks.opscode.com/cookbooks/nginx) as a dependency
[2013-01-02 05:41:13 -0500] maqr: this is defintely the most confusing linux package i've ever setup
[2013-01-02 05:42:00 -0500] lehrblogger: it seemed to make sense for me to put some of the cookbooks i was writing in my chef-repo, but some others seemed to belong with in the repo of the application they were written to deploy
[2013-01-02 05:42:04 -0500] cwj: lehrblogger: sure, you can configure knife to look in any directory you want. the point of librarian/berkshelf is to make it easier to do repo-per-cookbook
[2013-01-02 05:44:00 -0500] cwj: there used to be an important reason to distinguish between cookbooks/site-cookbooks directories
[2013-01-02 05:44:10 -0500] cwj: but that is depreciated and soon to be removed
[2013-01-02 05:44:39 -0500] lehrblogger: ah, interesting
[2013-01-02 05:45:45 -0500] cwj: http://tickets.opscode.com/browse/CHEF-2308
[2013-01-02 05:46:45 -0500] maqr: if i used librarian, would i not even need an /etc/chef?
[2013-01-02 05:47:23 -0500] cwj: maqr: the config data in /etc/chef has no direct relationship with the contents of your chef repo
[2013-01-02 05:47:35 -0500] cwj: you are going to be using chef solo?
[2013-01-02 05:47:55 -0500] cwj: with solo you upload a copy of your repo, and it can go in /etc/chef
[2013-01-02 05:47:57 -0500] maqr: yeah, i just want to get chef-solo to do anything, then i can build out from there... i haven't been able to find any starting place
[2013-01-02 05:48:02 -0500] cwj: but it can go anywhere
[2013-01-02 05:48:03 -0500] maqr: i'd be happy if it installed nginx with a bad default config
[2013-01-02 05:49:38 -0500] maqr: or even created a user or something, just simple things
[2013-01-02 05:50:06 -0500] cwj: ok, so make a directory to use as your chef repo
[2013-01-02 05:50:17 -0500] maqr: got it, /etc/chef
[2013-01-02 05:50:24 -0500] cwj: make a cookbooks directory and download that nginx cookbook into it
[2013-01-02 05:50:33 -0500] maqr: i just git clone it?
[2013-01-02 05:51:32 -0500] maqr: err, it's a tgz in this case, but ok
[2013-01-02 05:51:33 -0500] cwj: the tgz on that site represents a particular released version
[2013-01-02 05:51:33 -0500] cwj: if you grab it from github ymmv
[2013-01-02 05:52:13 -0500] maqr: heh, the server gives it to me as 'downloads', but yeah, got it renamed it and untar'd it
[2013-01-02 05:53:02 -0500] maqr: now i think i need config/node.json and config/solo.rb?
[2013-01-02 05:53:43 -0500] maqr: it's unclear if there's defaults or if i'm supposed to always invoke it explicitly with 'chef-solo -c config/solo.rb -j config/node.json'
[2013-01-02 05:55:02 -0500] cwj: yes you need to create those files
[2013-01-02 05:55:16 -0500] cwj: and yes i think you need to provide those flags every time
[2013-01-02 05:55:22 -0500] cwj: https://gist.github.com/4432546 << those might work for you
[2013-01-02 05:56:09 -0500] cwj: if you put your config file at /etc/chef/solo.rb you dont need -c flag
[2013-01-02 05:56:19 -0500] cwj: but i think the -j is always required
[2013-01-02 05:56:31 -0500] cwj: could be wrong, i am more familiar with chef-client behavior
[2013-01-02 05:57:10 -0500] maqr: and all this should be running as root, right?
[2013-01-02 05:57:14 -0500] cwj: yes
[2013-01-02 05:57:57 -0500] maqr: ok, at least i'm getting errors now :)
[2013-01-02 06:00:20 -0500] maqr: NoMethodError: undefined method `[]' for nil:NilClass , /etc/chef/cookbooks/nginx/recipes/ohai_plugin.rb:27:in `from_file' , which is 'template "#{node['ohai']['plugin_path']}/nginx.rb" do'
[2013-01-02 06:01:46 -0500] cwj: are you able to run 'ohai' at the command line?
[2013-01-02 06:02:20 -0500] maqr: yup, tons of interesting system info... neat tool
[2013-01-02 06:02:46 -0500] cwj: hrm ok, so thats supposed to populate the data under node['ohai']
[2013-01-02 06:03:45 -0500] maqr: hrm, i also see some things in ohai that need censoring... i'll have to work on that
[2013-01-02 06:03:48 -0500] cwj: ok you need the ohai cookbook
[2013-01-02 06:04:10 -0500] cwj: https://github.com/opscode-cookbooks/nginx/blob/master/metadata.rb
[2013-01-02 06:04:21 -0500] maqr: is there something like a package manager for these cookbooks to follow dependencies?
[2013-01-02 06:04:41 -0500] cwj: yes, thats one of the functions of using librarian or berkshelf
[2013-01-02 06:04:45 -0500] maqr: ah
[2013-01-02 06:05:44 -0500] maqr: oh, 'depends', i get it
[2013-01-02 06:06:30 -0500] cwj: so grab the ohai cookbook, drop it in your cookbook dir and try again
[2013-01-02 06:07:44 -0500] maqr: success!
[2013-01-02 06:08:35 -0500] cwj: ta da
[2013-01-02 06:08:45 -0500] maqr: cwj: now all of these attributes that they have in the docs, like the bool that turns gzip support on/off (node['nginx']['gzip']) ... where's that stuff supposed to go?
[2013-01-02 06:09:00 -0500] maqr: i've been trying to figure this out for hours btw, so thank you :P
[2013-01-02 06:09:12 -0500] cwj: attributes would go in node.json
[2013-01-02 06:09:53 -0500] cwj: add { "nginx": { "gzip": true } } or whatever
[2013-01-02 06:10:30 -0500] maqr: cwj: is there a doc somewhere that explains what can go in node.json?
[2013-01-02 06:12:17 -0500] cwj: well you can put anything you want in there, but only the attributes used by cookbooks you are using will matter
[2013-01-02 06:12:57 -0500] cwj: there are docs which cover how attribute precedence works in client/server usage, but in chef-solo theres no precedence levels
[2013-01-02 06:13:27 -0500] cwj: except automatic attributes (the information ohai collects), i guess
[2013-01-02 06:15:19 -0500] maqr: so when i see something like "node['nginx']['gzip']" that translates into { "nginx" : { "gzip" : true } } because by 'node' they mean 'node.json' and i'm supposed to take my best guess at a json approximation?
[2013-01-02 06:16:07 -0500] maqr: so node['nginx']['source']['modules'] is probably { "nginx" : { "source" : { "modules" : [ 'module1', 'module2', 'etc' ] } } } ?
[2013-01-02 06:16:14 -0500] cwj: yep
[2013-01-02 06:16:42 -0500] maqr: well that makes sense, but it's not super obvious at first :P
[2013-01-02 06:17:05 -0500] cwj: the node object doesn't have a special relationship with the name of the json file, fwiw
[2013-01-02 06:17:37 -0500] maqr: i'll pretend you didn't say that :P
[2013-01-02 06:19:09 -0500] maqr: cwj: so attributes for configuring stuff go in node.json, but there's also solo.rb where i could do things like create a user? and that's just a ruby dsl?
[2013-01-02 06:20:36 -0500] cwj: code for creating users would go in a recipe inside a cookbook
[2013-01-02 06:21:26 -0500] cwj: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings
[2013-01-02 06:21:48 -0500] maqr: ah
[2013-01-02 06:21:54 -0500] cwj: that doc lists the kind of settings that are valid for your chef config file
[2013-01-02 06:22:04 -0500] cwj: some of them are specific to client/server operation
[2013-01-02 06:23:02 -0500] maqr: and for nodes.json, it's only run_list and any attributes that my recipes need? or are there more things that can go in there too?
[2013-01-02 06:23:41 -0500] cwj: the run_list is an attribute, anything that goes in there will be an attribute on the node
[2013-01-02 06:23:54 -0500] cwj: er anything that goes in node.json that is
[2013-01-02 06:25:39 -0500] maqr: hmm, ok... i do wonder what's running run_list, but maybe i shouldn't ask :P
[2013-01-02 06:28:41 -0500] cwj: both chef-client and chef-solo look at that attribute to figure out what to run, it's just one of the fundamentals of how a chef run works
[2013-01-02 06:29:30 -0500] maqr: ok, i think i have enough that i can work the rest out from here... thanks so much cwj, i was about to give up and write a shell script :P
[2013-01-02 06:29:38 -0500] cwj: glad to help
[2013-01-02 06:29:48 -0500] cwj: chef has a steep learning curve but i think it is worth it
[2013-01-02 06:30:31 -0500] maqr: really if your gist was somewhere and people knew "make these directories, git clone a few cookbooks, have these two magic files, run this command", the rest is just normal unixy debugging things
[2013-01-02 06:30:37 -0500] maqr: it's getting to that point that's so challenging
[2013-01-02 07:09:59 -0500] lehrblogger: hey, i need to check out private git repos in a couple of different cookbooks, so i've been trying to use http://community.opscode.com/cookbooks/deploy_wrapper to make things less verbose, but it's failing with:
[2013-01-02 07:10:14 -0500] lehrblogger: https://gist.github.com/4432834
[2013-01-02 07:10:18 -0500] lehrblogger: any tips on figuring out what the problem is?
[2013-01-02 07:36:49 -0500] BryanWB__: ohai chefs!
[2013-01-02 07:37:16 -0500] specialsauce_: ohai!
[2013-01-02 08:16:10 -0500] prox_: Hello. Is there any good way to put template "script.smth" to the host and only after it set the attribute 'default[some][attr] = `script.smth`'?
[2013-01-02 08:25:59 -0500] wonko_be: template '.../script.smth' do ... end if node[some][attr]
[2013-01-02 08:26:25 -0500] wonko_be: this will only run the template block if the attr evals to true
[2013-01-02 08:28:03 -0500] user9910: Hi All. I am new to chef, and I have a quick question I can't find on a net :(
[2013-01-02 08:28:35 -0500] user9910: What is a preferred way of looking for nodes exceptions summary?
[2013-01-02 08:28:48 -0500] prox_: wonko_be: I didn't really get your idea. I want my attr to be set every chef run but it fails on the first chef run when there is no such script yet
[2013-01-02 08:30:58 -0500] lehrblogger: prox_: to prevent it from failing, you might be able to use an only_if to make sure the script exists? but that might only solve half your problem
[2013-01-02 08:31:10 -0500] lehrblogger: user9910: i'm not sure :-/
[2013-01-02 08:31:51 -0500] wonko_be: prox_: i don't understand what you want to do exactly - maybe pastie your current code
[2013-01-02 08:31:52 -0500] user9910: how would you make sure that there are no nodes that has some errors?
[2013-01-02 08:34:28 -0500] prox_: lehrblogger: http://pastie.org/private/3vi6fylc22gmykxdw7g
[2013-01-02 08:36:11 -0500] wonko_be: prox_: what is exactly the error you get?
[2013-01-02 08:36:15 -0500] wonko_be: this should just run
[2013-01-02 08:36:38 -0500] wonko_be: (assuming you have a closing " at the end of your source line)
[2013-01-02 08:37:17 -0500] prox_: it's just typo in copy-past
[2013-01-02 08:37:24 -0500] prox_: lib/chef/mixin/from_file.rb:30: command not found: /script
[2013-01-02 08:37:46 -0500] wonko_be: ah, okay
[2013-01-02 08:38:05 -0500] wonko_be: now I see, you fill the attribute with the content of the scripts run (backticks)
[2013-01-02 08:40:08 -0500] wonko_be: try wrapping it in a ruby block, although I'm not sure if you can set attributes from within a ruby block
[2013-01-02 08:40:14 -0500] wonko_be: http://wiki.opscode.com/display/chef/Resources#Resources-RubyBlock
[2013-01-02 08:41:01 -0500] wonko_be: you might then notify the ruby block to run from the template block
[2013-01-02 08:41:18 -0500] wonko_be: so it only runs when the content of the script is changed (depends on your use case)
[2013-01-02 08:43:38 -0500] prox_: wonko_be: I need to set an attribute every chef-run. trying ruby block
[2013-01-02 08:49:35 -0500] prox_: wonko_be: nice, it works just as I needed. Thanks
[2013-01-02 08:49:48 -0500] wonko_be: np
[2013-01-02 11:50:26 -0500] dagi3d: hi
[2013-01-02 11:51:01 -0500] user9910: Hi All. I am following the "http://wiki.opscode.com/display/chef/Build+a+Django+Stack" manual, and I am getting "Cannot find a resource for mysql_database on ubuntu version 10.04" when initiating the first ec2 instance. Can someone direct to where the problem can be?
[2013-01-02 11:52:55 -0500] dagi3d: is there any way to reload the run list of a node? (for example when a template depends on other nodes that were recently added) the only solution I found so far was to ssh to the node and run chef-client
[2013-01-02 11:56:06 -0500] meineerde: user9910: the database cookbook is not present on the node
[2013-01-02 11:56:31 -0500] meineerde: dagi3d: reload as in during a run?
[2013-01-02 11:58:34 -0500] dagi3d: meineerde: yes. say that I made a change in a cookbook or that there is a template that makes a node search and I added more nodes so it needs to be updated
[2013-01-02 12:00:16 -0500] meineerde: dagi3d: when you rely on external information (e.g. a search) you should just generate the results into a template. the search is executed during each riun, the template is rendered and if it is different from what is on the disk, it is replaced there
[2013-01-02 12:01:00 -0500] meineerde: apart from that, I think I still don't really understand what you are trying to do.
[2013-01-02 12:01:39 -0500] meineerde: also, the cookbooks are retrieved from the server beafore each run.
[2013-01-02 12:01:52 -0500] meineerde: see wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run for details
[2013-01-02 12:03:05 -0500] dagi3d: meineerde: I know that. but how can I rerun it? I can't find the knife command for that
[2013-01-02 12:03:23 -0500] meineerde: well, just perform a regular chef run
[2013-01-02 12:03:56 -0500] meineerde: which is typically setup with either chef-client as a service or from cron
[2013-01-02 12:04:21 -0500] meineerde: (e.g. with https://github.com/opscode-cookbooks/chef-client )
[2013-01-02 12:04:46 -0500] meineerde: alternatively you can `knife ssh` into the server(s) and run chef-client that way
[2013-01-02 12:12:40 -0500] dagi3d: thx meineerde
[2013-01-02 12:53:17 -0500] MartinCleaver: http://www.opscode.com/chef/install/ does not have an option for Mac OS 10.8
[2013-01-02 12:53:27 -0500] MartinCleaver: further, picking 10.7 then gives:
[2013-01-02 12:53:33 -0500] MartinCleaver: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-01-02 12:53:33 -0500] MartinCleaver:   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
[2013-01-02 12:53:34 -0500] MartinCleaver:                                  Dload  Upload   Total   Spent    Left  Speed
[2013-01-02 12:53:35 -0500] MartinCleaver: 100  6397  100  6397    0     0  10702      0 --:--:-- --:--:-- --:--:-- 31825
[2013-01-02 12:53:36 -0500] MartinCleaver: Downloading Chef  for mac_os_x...
[2013-01-02 12:53:37 -0500] MartinCleaver: Unable to retrieve a valid package!
[2013-01-02 12:54:55 -0500] MartinCleaver: http://wiki.opscode.com/display/chef/Workstation+Setup says nothing about support for Mac OS 10.8
[2013-01-02 12:59:34 -0500] MartinCleaver: To connect to opscode-omnitruck-release.s3.amazonaws.com insecurely, use `--no-check-certificate'.
[2013-01-02 12:59:49 -0500] MartinCleaver: doing that allowed me to get `chef-10.16.4_1.mac_os_x.10.7.2.sh'
[2013-01-02 13:00:09 -0500] MartinCleaver: which I could then execute as root
[2013-01-02 13:00:50 -0500] meineerde: MartinCleaver: as osx already brings ruby, you can simply run `sudo gem install chef` and be done
[2013-01-02 13:01:12 -0500] MartinCleaver: ah. Okay, thanks
[2013-01-02 13:01:30 -0500] matti: meineerde: He would be better off using rbenv / rvm for this Ruby on Mac.
[2013-01-02 13:01:38 -0500] matti: meineerde: 1.8 is considered ancient history.
[2013-01-02 13:01:50 -0500] meineerde: matti: ewll, it's still in use somewhere...
[2013-01-02 13:02:11 -0500] matti: meineerde: And? Recommending it on such basis is a bad idea anyway.
[2013-01-02 13:02:17 -0500] MartinCleaver: what's on 1.8?
[2013-01-02 13:02:22 -0500] meineerde: matti: but yeah, that's probably a good idea in the long run. still, ruby 1.8 does the trick and all the standard stuff still work
[2013-01-02 13:02:37 -0500] MartinCleaver: ah
[2013-01-02 13:02:55 -0500] matti: MartinCleaver: OS X / Mac ships really ancient version of Ruby.
[2013-01-02 13:03:02 -0500] meineerde: matti: and for getting started, it way easier to use what's there instead of having to install another ruby first
[2013-01-02 13:03:05 -0500] matti: MartinCleaver: Even between 1.8 revision is ancient.
[2013-01-02 13:03:47 -0500] matti: meineerde: 640k was enough for most people in the past ;p But things are moving forward ;]
[2013-01-02 13:04:18 -0500] meineerde: matti: it's not "ancient". the last release was in late june.
[2013-01-02 13:04:31 -0500] meineerde: but yeah, in the long run it's probably better to use 1.9
[2013-01-02 13:04:42 -0500] meineerde: (also given that 2.0 is about to be finalized)
[2013-01-02 13:04:45 -0500] matti: krzysztof@apple ~ $ ruby -v
[2013-01-02 13:04:46 -0500] matti: ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin11.3.1]
[2013-01-02 13:04:52 -0500] matti: Take no effort with brew and rbenv.
[2013-01-02 13:04:58 -0500] matti: Takes*
[2013-01-02 13:05:22 -0500] matti: MartinCleaver: Said that, trying to do Ruby development on OS X is considered by me a retarded idea.
[2013-01-02 13:05:45 -0500] matti: MartinCleaver: Get 1.9, get vagrant and get yourself a Linux VM / box (if you wish).
[2013-01-02 13:05:56 -0500] matti: s/Ruby/Chef/
[2013-01-02 13:06:25 -0500] matti: Retarded case insensitive file system, etc.
[2013-01-02 13:06:27 -0500] matti: SRLSY
[2013-01-02 13:06:29 -0500] matti: In 2013.
[2013-01-02 13:06:30 -0500] matti: ;]
[2013-01-02 13:06:39 -0500] MartinCleaver: ok, makes more sense given its Chef dev. I don't need Ruby for itself
[2013-01-02 13:07:37 -0500] MartinCleaver: how mature is Chef's implementation for Windows Nodes?
[2013-01-02 13:07:43 -0500] matti: MartinCleaver: All you need it VIM on your Mac and Linux VM for Chef.
[2013-01-02 13:35:30 -0500] meineerde: matti: don't hate. (I personally consider a mac a great platform for ruby development)
[2013-01-02 13:36:06 -0500] matti: meineerde: I had so much issues with developers working on OS X, and then pushing code to Linux where everything breaks.
[2013-01-02 13:36:10 -0500] Xiol: Does anyone have an example cookbook that implements multi-platform providers? I'm having real trouble understanding how to write a provider that can run on ubuntu and centos (for example), as I can't access node['platform'] from inside the provider, so I'm looking for example code I can pick apart! (Or documentation, but I haven't found anything that makes sense / has examples).
[2013-01-02 13:36:19 -0500] matti: meineerde: That I have grown to dislike the concept of Ruby / Rails on OS X.
[2013-01-02 13:37:07 -0500] matti: meineerde: And being on a pager duty for such deployments only makes you dislike it even more ;]
[2013-01-02 13:38:25 -0500] meineerde: matti: guess you had a bad start then. i earn my life developing ruby stuff on osx for linux deployments
[2013-01-02 13:38:40 -0500] matti: meineerde: :)
[2013-01-02 13:38:50 -0500] matti: meineerde: I am sure if done right it works well, no doubt tere.
[2013-01-02 13:42:18 -0500] matti: meineerde: I was using Linux on desktop for a long time, and only recently got OS X to that state to enjoy it.
[2013-01-02 13:42:30 -0500] matti: meineerde: Meaning, I disliked it as development platform a lot in the past.
[2013-01-02 13:43:31 -0500] meineerde: I went to a mac from windows about 4 years ago. and it got soo much better :)
[2013-01-02 13:44:37 -0500] meineerde: so yeah, macs have their wuirks, but they work reliably most of the time and look beautiful at that (unlike all of the linux desktops I tried so far)
[2013-01-02 13:45:10 -0500] Xiol: Macs UK keyboard layout is terrible, though.
[2013-01-02 14:23:45 -0500] matti: meineerde: For me, was the midnset which was the biggest thing to overcome.
[2013-01-02 14:23:50 -0500] matti: meineerde: So to speak.
[2013-01-02 14:24:02 -0500] matti: meineerde: And, BSD user-space was initially driving me nuts a little.
[2013-01-02 14:24:10 -0500] MartinCleaver: If a node is deployed, is there something to detect if someone makes a manual configuration to it? e.g. changes something in /etc/ ?
[2013-01-02 14:24:33 -0500] matti: meineerde: Said that, I live in the terminal most of the time, so in the long term it makes no differnce -- plus, I do like full screen iTerm2 ;]
[2013-01-02 14:24:46 -0500] matti: MartinCleaver: As a whole of /etc?
[2013-01-02 14:24:51 -0500] meineerde: matti: i used to work with solaris. bsd is a overflowing paradise of awesomeness in comparison...
[2013-01-02 14:24:59 -0500] matti: MartinCleaver: Chef only tracks changes of the resources you have defined.
[2013-01-02 14:25:11 -0500] matti: meineerde: Haha, indeed ;]
[2013-01-02 14:25:27 -0500] matti: meineerde: I worked with Solaris as well using it for storage due to amazing ZFS ;]
[2013-01-02 14:25:28 -0500] MartinCleaver: Well, any given folder, but /etc seemed a good example
[2013-01-02 14:25:35 -0500] matti: meineerde: And it was always tripping me.
[2013-01-02 14:25:39 -0500] meineerde: matti: +1
[2013-01-02 14:26:27 -0500] matti: MartinCleaver: Said, if you have /etc/hosts being managed by Chef, then it will detect and over-write changes to the file.
[2013-01-02 14:26:44 -0500] MartinCleaver: oh, I see. Cool, thanks.
[2013-01-02 14:26:46 -0500] matti: MartinCleaver: For it will have no knowledge of /etc/resolv.conf chanigng, unless you manage it as well.
[2013-01-02 14:26:53 -0500] meineerde: MartinCleaver: if you want to control things, you have to gain that control by yourself by fully describing the intended state
[2013-01-02 14:26:53 -0500] MartinCleaver: y
[2013-01-02 14:27:13 -0500] matti: MartinCleaver: There are projects to detect changes in under /etc.
[2013-01-02 14:27:29 -0500] matti: MartinCleaver: One is using git to store everything under /etc.
[2013-01-02 14:27:58 -0500] meineerde: MartinCleaver: generally, you should avoid to do any manual changes if possible, or at the very least only do these changes to areas not touched by chef at all
[2013-01-02 14:28:20 -0500] meineerde: mixing manual changes with chef's changes is a sure road to an inconsistency desaster
[2013-01-02 14:28:26 -0500] matti: Yep.
[2013-01-02 14:28:35 -0500] matti: And beats the whole idea of configuration management.
[2013-01-02 14:30:56 -0500] matti: Xiol: Would it be possible for you to use Ohai provider directly?
[2013-01-02 14:35:10 -0500] matti: Xiol: require 'ohai' ; o = Ohai::System.new ; o.all_plugins ; p o['platform']
[2013-01-02 14:43:29 -0500] Xiol: matti: That seems a bit hacky ;) I'm sure there's a proper way to handle this I just haven't found an example/documentation where it's described!
[2013-01-02 14:43:46 -0500] Xiol: I wouldn't mind the hacky route in all fairness, but I'm trying to write something I can commit upstream!
[2013-01-02 14:46:18 -0500] matti: Xiol: With all due respect, most of contributes cookbooks are far from being perfect.
[2013-01-02 14:46:36 -0500] matti: Xiol: I use 0 of upstream cookbooks.
[2013-01-02 14:47:18 -0500] zts: Xiol: I don't know the exact answer to your question, but you might look at the core resources/providers for some inspiration.  I understand that the usual pattern, though, is to load different providers for different platforms, rather than one provider which handles multiple platforms
[2013-01-02 14:47:48 -0500] matti: +1
[2013-01-02 14:47:50 -0500] zts: matti: and the only way that contributed cookbooks improve is through the community working to improve them
[2013-01-02 14:47:52 -0500] zts: so Xiol++
[2013-01-02 14:48:00 -0500] matti: Package one is probably a good place to start.
[2013-01-02 14:48:12 -0500] zts: yeah, User is also worth a look
[2013-01-02 14:48:53 -0500] matti: zts: The reason why I dislike most of them, is because they do more harm to your OS than good.
[2013-01-02 14:49:40 -0500] matti: zts: And, most of developer writing cookbooks have no idea about systems, and most of systems people writing them have very little Ruby experience.
[2013-01-02 14:52:42 -0500] zts: matti: I don't personally think that attitude is very constructive (though I can empathise).  Again, the community cookbooks improve because people who _do_ know better contribute improvements
[2013-01-02 14:53:05 -0500] zts: but it is totally okay to not have the time (or desire, for whatever reason) to contribute
[2013-01-02 14:57:22 -0500] matti: zts: I have bad experience with helping that I was left with after using Puppet for many years.
[2013-01-02 14:57:31 -0500] matti: zts: Perhaps that is why I am slightly biased.
[2013-01-02 14:57:54 -0500] matti: zts: But your point is fair, of course :)
[2013-01-02 14:58:37 -0500] zts: matti: as is yours, I can understand (unfortunately!)  But we can encourage the good souls in the community to keep making things better, and one day the result will warrant a change of heart :)
[2013-01-02 14:58:49 -0500] matti: +1
[2013-01-02 14:58:50 -0500] matti: :)
[2013-01-02 14:59:17 -0500] matti: You have made my day, actually.
[2013-01-02 15:06:21 -0500] Xiol: Yeah, most of the cookbooks seem to target Debian and Ubuntu and leave off support for RHEL and CentOS. In my organisation this is extremely limiting as we're a RHEL/CentOS shop primarily
[2013-01-02 15:06:41 -0500] Xiol: Which is why I'm trying to munge RHEL support into this Debian/Ubuntu-exclusive cookbook!
[2013-01-02 15:07:23 -0500] Xiol: zts: From what I've read so far, it does seem that different providers are loaded for each platform (seems like this would cause a lot of code duplication, but alas). I'll take a look at the core stuff and see if I can figure it out from that
[2013-01-02 15:19:02 -0500] meineerde: Xiol: you can also write real providers (not just LWRPs) where you can use inheritance to extract common behavior into an "abstract" parent provider
[2013-01-02 15:21:05 -0500] meineerde: (like it's done in the database cookbook)
[2013-01-02 15:54:28 -0500] jwcarman: Is there a good cookbook out there for managing WebSphere MQ?
[2013-01-02 15:54:41 -0500] jwcarman: With resources defined for setting up queues/topics, etc.?
[2013-01-02 15:56:44 -0500] jwcarman: googling doesn't seem to find much on the topic
[2013-01-02 16:10:38 -0500] jperry2: Anyone using jruby on their local workstation to work with chef?
[2013-01-02 16:10:52 -0500] jperry2: I get this when using jruby
[2013-01-02 16:10:53 -0500] jperry2: ERROR: NotImplementedError: fork is not available on this platform
[2013-01-02 16:11:08 -0500] jperry2: when trying to upload all cookbooks
[2013-01-02 16:14:33 -0500] kallistec: jperry2: most of the core stuff in chef works, but the code we use to call external commands uses fork/exec, which doesn't work on JRuby
[2013-01-02 16:14:52 -0500] jperry2: would it work with Rubinius?
[2013-01-02 16:15:56 -0500] kallistec: when JRuby adds support for more options to Process.spawn, it may be possible to implement that code using Process.spawn, but at the moment most of the options we need (e.g., set working directory of sub process) are silently ignored
[2013-01-02 16:21:42 -0500] yfeldblum: kallistec, you could make an intermediately process that gets the needed parameters, sets them on itself (chdir, envvars, close fd's, etc), then exec's the real subprocess, and there's your Process.spawn hack
[2013-01-02 16:25:06 -0500] kallistec: yfeldblum: maybe. I've read that jruby has some hacks when it detects that you're trying to fork off another ruby, but I don't know how they work.
[2013-01-02 16:25:44 -0500] kallistec: jperry2: rbx might work, it's been quite a while since I looked into it
[2013-01-02 16:26:02 -0500] jperry2: @kallistec, thx
[2013-01-02 16:26:05 -0500] jperry2: I'll check it out
[2013-01-02 16:26:11 -0500] yfeldblum: kallistec, don't fork off another ruby; Process.spawn another ruby
[2013-01-02 16:26:44 -0500] yfeldblum: kallistec, but this other ruby is a ruby script that ships with chef, whose job it is to do the things from within the subprocess that jruby's Process.spawn can't do from the parent
[2013-01-02 16:28:55 -0500] laurent\: jperry2: i'm running shef with jruby
[2013-01-02 16:29:12 -0500] jwcarman: So, nobody has a good Websphere MQ cookbook out there?
[2013-01-02 16:29:47 -0500] laurent\: (but i'm not forking)
[2013-01-02 16:29:48 -0500] kallistec: yfeldblum: yeah, from what I remember from either tweets or blog posts or bug comments from Charlie Nutter, JRuby might be looking at the command you pass in and checking if it's running a ruby and then running it in a new VM context instead of process.
[2013-01-02 16:31:01 -0500] yfeldblum: kallistec, screw with it, then; make the command like `env NOT_A_RUBY_U_JSMARTYPANTS jruby chef/hacks/jruby/subprocess.rb param1 param2 param3`
[2013-01-02 16:31:35 -0500] yfeldblum: kallistec, or make a bash script in the middle
[2013-01-02 16:32:35 -0500] konopka: anybody use the deploy resource for a larger git repo? i'm running into "Mixlib::ShellOut::CommandTimeout" a bunch
[2013-01-02 16:32:52 -0500] kallistec: eh, if I were to go to that length, I'd figure out how to make a jruby java ext using ProcessBuilder which supports the options we need
[2013-01-02 16:34:04 -0500] yfeldblum: kallistec, :D
[2013-01-02 16:36:33 -0500] jperry2: thanks guys for the info, I think it sounds like I should hold off using jruby for now as it seems it can be challenging
[2013-01-02 16:39:53 -0500] meineerde: jperry2: well, you can use different rubies for chef and your actual application
[2013-01-02 16:40:11 -0500] meineerde: (which you do when you use the omnibus installer anyway)
[2013-01-02 16:40:35 -0500] jperry2: yeah true, but my application is calling knife which is where I run into the issue
[2013-01-02 16:40:49 -0500] jperry2: not sure how easy it would be to swap back and forth
[2013-01-02 16:44:57 -0500] jperry2: I'm using rvm so I could have it switch over to another shell for that stuff then switch back
[2013-01-02 16:53:05 -0500] kallistec: jperry2: what level of confidence do you have in these cookbooks you're uploading?
[2013-01-02 16:53:26 -0500] jperry2: ?
[2013-01-02 16:53:27 -0500] kallistec: knife is only shelling out to execute syntax checks
[2013-01-02 16:53:33 -0500] jperry2: hmm
[2013-01-02 16:53:56 -0500] jperry2: it's just a normal cookbook upload
[2013-01-02 16:54:08 -0500] jperry2: basically this is a local development environment which spins up a local chef server
[2013-01-02 16:54:14 -0500] kallistec: if you're happy to skip those, you can use the cookbook upload libraries yourself
[2013-01-02 16:54:15 -0500] jperry2: uploads all the cookbooks, etc
[2013-01-02 16:54:31 -0500] jperry2: it fails when doing a knife cookbook upload -all
[2013-01-02 16:55:08 -0500] jperry2: it does several other knife calls throughout the application
[2013-01-02 16:55:18 -0500] jperry2: it probably isn't only knife cookbook upload but I could test
[2013-01-02 16:55:32 -0500] jperry2: maybe all knife commands experience this
[2013-01-02 16:56:22 -0500] kallistec: that's the only one I know of that needs to shell out
[2013-01-02 16:56:25 -0500] jperry2: instead of calling knife directly though your stating just use the knife libraries instead
[2013-01-02 16:56:29 -0500] jperry2: ah okay
[2013-01-02 16:56:42 -0500] kallistec: I could be forgetting something
[2013-01-02 16:56:45 -0500] jperry2: I could give that a try to see if it works
[2013-01-02 16:56:46 -0500] kallistec: anyway https://github.com/opscode/chef/blob/master/lib/chef/cookbook_uploader.rb
[2013-01-02 16:57:19 -0500] jperry2: does it only shell out when you doing the --all?
[2013-01-02 16:57:23 -0500] kallistec: you probably should subclass it and override validate_cookbooks with a stub
[2013-01-02 16:57:55 -0500] jperry2: okay I'll take a look at that class and see what I need to do
[2013-01-02 16:57:58 -0500] kallistec: jperry2: no, any time you upload a cookbook, it's in the validate_cookbooks part of that code
[2013-01-02 17:09:15 -0500] oddover: hey. anyone got a good example of using notifies/subscribes in an LWRP?
[2013-01-02 17:15:08 -0500] oddover: and on a related note...is there any way to do a notification without actually doing anything? What I want to do is add some values to the attributes hash, and then notify another resource
[2013-01-02 17:17:01 -0500] mesozoic: If anyone uses the passenger_apache2::mod_rails recipe, I could use some help. node[:languages][:ruby] isn't getting set - don't know why - so my configuration files are broken. It works on the first run, and fails on all following runs. I posted details to SO: http://bit.ly/W26Mzv
[2013-01-02 17:22:04 -0500] jperry2: ballistic, thx I'll take a look, thanks for the pointers
[2013-01-02 18:15:54 -0500] makmanalp: my cookbook started failing on the PG gem saying "make" doesn't exist even though I have build-essential
[2013-01-02 18:17:28 -0500] makmanalp: any reasons why https://github.com/opscode-cookbooks/build-essential/blob/master/recipes/default.rb doesn't seem to install make on ubuntu?
[2013-01-02 18:17:43 -0500] makmanalp: looks like the build-essential package doesn't include make
[2013-01-02 18:18:37 -0500] cheesepl_: makmanalp: I just installed build-essential on 12.04 and built something so I know that cookbook works
[2013-01-02 18:18:55 -0500] cheesepl_: guessing it's something specific to the PG gem
[2013-01-02 18:19:02 -0500] meineerde: makmanalp: in all current ubuntu versions, build-essential has a direct dependency to make
[2013-01-02 18:19:13 -0500] cheesepl_: ^
[2013-01-02 18:19:16 -0500] makmanalp: wait, no, I'm an idiot
[2013-01-02 18:19:19 -0500] makmanalp: I'm sorry
[2013-01-02 18:19:26 -0500] makmanalp: I just checked, you're right
[2013-01-02 18:19:46 -0500] makmanalp: so why the heck is the pg gem from database::postgresql failing now but was okay 2 days ago? hmm.
[2013-01-02 18:26:27 -0500] oddover: hey. anyone got a good example of using notifies/subscribes in an LWRP?
[2013-01-02 18:28:13 -0500] pasties: I'd also be interested in seeing that example
[2013-01-02 18:56:43 -0500] matschaffer: oh woah, who's doing the philly training? wanna do a drink up?
[2013-01-02 19:02:34 -0500] makmanalp: jtimberman: are you aware of an issue where postgresql::ruby seems to fail because make isn't installed on ubuntu?
[2013-01-02 19:03:19 -0500] discHead: Hi all.  I'm trying to write an LWRP but am confused abouut how (or whether it's possible) to implement #load_current_resource
[2013-01-02 19:03:45 -0500] discHead: Checked docs.opscode.com but couldn't find anything
[2013-01-02 19:05:51 -0500] discHead: Is it just a matter of defining a load_current_resource method in the provider file and assigning to @current_resource?
[2013-01-02 19:06:13 -0500] cyli: discHead:  I think you can just define the function?  (new to this, so may be wrong) - I followed this example:  https://github.com/fnichol/chef-user/blob/master/providers/account.rb
[2013-01-02 19:06:55 -0500] discHead: cyli, I'm checking it out now. Thanks!
[2013-01-02 19:08:17 -0500] yfeldblum: discHead, Chef::Provider#load_current_resource is responsible for learning about the state of the system and recording (often in instance variables) as much of that state as is necessary for future actions to do their work
[2013-01-02 19:11:08 -0500] discHead: yfeldblum -- Understood; I've just been confused about the proper way to implement it for my own provider; that is, whether to assign to @current_resource or do anything else that might be expected
[2013-01-02 19:11:48 -0500] yfeldblum: discHead, you can do it however you like - whichever way works best given the particular details of the case; some providers use @current_resource; others do whatever
[2013-01-02 19:12:04 -0500] yfeldblum: discHead, @current_resource is an internal implementation detail
[2013-01-02 19:12:45 -0500] discHead: Okay.  I thought there might be some kind of convention-over-configuration type thing that I was missing. :-)
[2013-01-02 19:13:06 -0500] jtimberman: makmanalp: why wouldn't make be installed?
[2013-01-02 19:13:12 -0500] jtimberman: don't you have build-essential?
[2013-01-02 19:13:30 -0500] discHead: So instance variables in a provider's code will be specific to that provider
[2013-01-02 19:13:41 -0500] jtimberman: build-essential: Depends: libc6-dev | libc-dev, gcc (>= 4:4.4.3), g++ (>= 4:4.4.3), make, dpkg-dev (>= 1.13.5)
[2013-01-02 19:13:44 -0500] jtimberman: on ubuntu 12.04
[2013-01-02 19:14:15 -0500] jtimberman: discHead: you're basically inspecting the system to find out what the state of the resource is in currently.
[2013-01-02 19:14:40 -0500] yfeldblum: discHead, the convention is to use @current_resource, unless that makes life bothersome :D
[2013-01-02 19:14:51 -0500] jtimberman: discHead: https://github.com/opscode-cookbooks/samba/blob/master/providers/user.rb
[2013-01-02 19:15:01 -0500] jtimberman: i used smbuser there
[2013-01-02 19:15:24 -0500] jtimberman: but @current_resource is probably better and clearer :)
[2013-01-02 19:15:32 -0500] discHead: Oh good, two examples now. Thanks. :-)
[2013-01-02 19:15:38 -0500] eka: anyone knows why node.fetch("somekey", nil) throws an IndexError? tried that in shef
[2013-01-02 19:18:40 -0500] yfeldblum: eka, backtraces help
[2013-01-02 19:20:25 -0500] makmanalp: jtimberman: I have it included. I wonder if it's an ordering thing that's caused by me using chef-rewind
[2013-01-02 19:21:13 -0500] makmanalp: jtimberman: actually never mind, I have the build-essential package but not the recipe. But I think the pg ruby recipe should include that anyway
[2013-01-02 19:21:43 -0500] eka: yfeldblum: shouldn't behave like a Hash?
[2013-01-02 19:22:07 -0500] jtimberman: makmanalp: the build-essential recipe is included by postgresql::ruby - https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/ruby.rb#L30
[2013-01-02 19:22:16 -0500] yfeldblum: eka, it behaves kind of like a hash in many situations, but backtraces still help
[2013-01-02 19:22:39 -0500] eka: yfeldblum: it says that the key doesn't exists but should return nil instead
[2013-01-02 19:22:44 -0500] eka: yfeldblum: IMHO
[2013-01-02 19:23:29 -0500] eka: yfeldblum: http://pastebin.com/s4fYaavs
[2013-01-02 19:23:39 -0500] makmanalp: jtimberman: So it seems, but I still can't explain why running "make" returns The program 'make' is currently not installed.  You can install it by typing etc ...
[2013-01-02 19:24:00 -0500] makmanalp: jtimberman: and by extension the gem installation fails
[2013-01-02 19:24:52 -0500] yfeldblum: eka, https://github.com/opscode/chef/blob/10.16.4/chef/lib/chef/node/attribute.rb#L186-L201
[2013-01-02 19:25:04 -0500] yfeldblum: eka, opscode didn't implement #fetch right
[2013-01-02 19:25:39 -0500] eka: yfeldblum: yes I was looking for that :P
[2013-01-02 19:26:39 -0500] yfeldblum: eka, Hash#fetch checks how many parameters were passed (or something similar), while Chef::Node::Attribute#fetch does not
[2013-01-02 19:26:47 -0500] makmanalp: jtimberman: http://pastebin.com/CK5CFvYM
[2013-01-02 19:26:52 -0500] yfeldblum: eka, might want to open a ticket
[2013-01-02 19:26:59 -0500] eka: yfeldblum: yes opening ticket
[2013-01-02 19:27:23 -0500] eka: yfeldblum: thanks
[2013-01-02 19:28:58 -0500] makmanalp: jtimberman: this is even after I explicitly add build-essential to the vagrant run list before the other recipes
[2013-01-02 19:36:14 -0500] kallistec: eka: that is almost certainly fixed for Chef 11
[2013-01-02 19:36:39 -0500] eka: kallistec: ok.. tkt opened still :)
[2013-01-02 19:36:47 -0500] oddover: hey. anyone got a good example of using notifies/subscribes in an LWRP?
[2013-01-02 19:36:52 -0500] eka: kallistec: you know when chef 11 will be around? :)
[2013-01-02 19:37:45 -0500] kallistec: eka: we're pretty close to prerelease for the client, I'm not sure exactly when to expect it
[2013-01-02 19:38:06 -0500] eka: kallistec: thanks for the good work though. :)
[2013-01-02 19:41:23 -0500] kallistec: thanks! Lots of good stuff from a ton of people in Chef 11, in particular the chef server rewrite and omnibus installer stuff
[2013-01-02 19:42:09 -0500] discHead: Do you know yet how that's going to be rolled out on Hosted Chef?
[2013-01-02 19:42:29 -0500] barnacles: anyone use the mysql cookbook to create servers on their nodes? I'm having trouble accessing the VM mysql server from my host machine (as in, I cannot connect)
[2013-01-02 19:48:29 -0500] jtimberman: makmanalp: what distribution are you using?
[2013-01-02 19:48:33 -0500] jtimberman: and version
[2013-01-02 19:48:49 -0500] kallistec: discHead: Chef 11 client should just work with hosted chef, and there will be a compatibility period for using 10.x. In the case of encrypted data bags (format changes in Chef 11), the server version is irrelevant and it's the client versions that matter. Chef 10.18 adds forward compat with Chef 11.x for a small number of incompatibilities
[2013-01-02 19:49:12 -0500] kallistec: (Chef 10.18 is in testing at the moment)
[2013-01-02 19:49:37 -0500] discHead: Okay, cool
[2013-01-02 19:49:47 -0500] makmanalp: jtimberman: ubuntu 12.04 / precise
[2013-01-02 19:50:11 -0500] kallistec: fwiw: http://wiki.opscode.com/display/chef/Breaking+Changes+in+Chef+11
[2013-01-02 19:59:25 -0500] robbkidd: For a deploy resource with no migration to run, where is a good place to run "bundle install"? Should it be in one of the hooks provided by the deploy resource or should I call it as a script after the deploy?
[2013-01-02 19:59:57 -0500] Toger: I am using a chef template for httpd. I want chef to ensure that httpd is running (action start), but also restart if chef updates the httpd.conf.  However, on first run httpd is being started before the template and failing.  If I make it action:nothing then chef won't make sure httpd is running in general. How do I work around this?
[2013-01-02 20:00:59 -0500] Death_Syn: make the template notify the service action?
[2013-01-02 20:02:26 -0500] Toger: that handles restarts due to config changes, but to make it work I have to remove action start from httpd so chef won't restart httpd if it crashes.
[2013-01-02 20:02:52 -0500] Toger: that is, removing action start means chef will no longer restart a failed httpd; which I'd like it to do.
[2013-01-02 20:07:28 -0500] btm: @opscode First Chef Code review of 2013: join http://bit.ly/THPz0q watch: http://youtu.be/0IoH28syIX8 #opschef
[2013-01-02 20:10:21 -0500] eka: I need to set a node attribute based on some OS data how/where can I do that? (would be some ruby code)
[2013-01-02 20:11:01 -0500] robbkidd: eka: What OS data?
[2013-01-02 20:13:25 -0500] eka: robbkidd: I need to set the bind ip for various services and I need to see what is the private ip, and sometimes that private ip might not exist so I want to fallback to other ip
[2013-01-02 20:13:55 -0500] eka: robbkidd: I need a function that is run and set a node attribute where can I put that?
[2013-01-02 20:14:29 -0500] robbkidd: eka: Have you tried ohai? http://docs.opscode.com/ohai.html
[2013-01-02 20:15:12 -0500] eka: robbkidd: I'm using ohai  :) but need a function the thing is that this can run on linode or dev machine so in linode some attribute exists that in dev not
[2013-01-02 20:15:13 -0500] jwcarman: why would a local chef server (running in a vm), return a 301 response code sometimes?
[2013-01-02 20:15:29 -0500] eka: robbkidd: so I need a function, where can I put that?
[2013-01-02 20:16:30 -0500] robbkidd: eka: The dev machine won't give up its IP to ohai?
[2013-01-02 20:16:56 -0500] eka: robbkidd: yes but comes from a different node attribute
[2013-01-02 20:17:05 -0500] eka: robbkidd: still I need some logic to do that
[2013-01-02 20:17:13 -0500] eka: robbkidd: CAN you tell me where??
[2013-01-02 20:17:58 -0500] zts: eka: a recipe, is the conventional place - if you need its data to be available to the rest of your chef run, make sure it's the first recipe
[2013-01-02 20:18:10 -0500] chip-: eka: Check out the server.rb attributes file in the mysql cookbook
[2013-01-02 20:18:24 -0500] eka: zts: ok that's something thanks
[2013-01-02 20:18:52 -0500] chip-: eka: It's a good example of setting an ip address based on an attribute other than node[:ipaddress] if present.
[2013-01-02 20:18:55 -0500] zts: eka: sometimes you can put stuff at the bottom of /etc/chef/client.rb (or solo.rb), but I think that will happen too early to have the other data you want
[2013-01-02 20:19:13 -0500] eka: chip-: will look at it thanks
[2013-01-02 20:20:27 -0500] eka: chip-: and all files in attributes.rb are auto loaded?
[2013-01-02 20:20:38 -0500] eka: chip-: sorry in /attributes/*.rb
[2013-01-02 20:20:45 -0500] chip-: eka: yes.
[2013-01-02 20:20:57 -0500] eka: chip-: thanks!! that will do
[2013-01-02 20:27:20 -0500] oddover: hey. anyone got a good example of using notifies/subscribes in an LWRP?
[2013-01-02 20:30:56 -0500] sg4m: cheflevelramen: believe I worked out that issue we talked about where aws_ebs_volume didn't save the volume_id : http://tickets.opscode.com/browse/COOK-2148, if it's still getting in your way.
[2013-01-02 20:32:05 -0500] n00bie: I am trying to use the apache2 cookbook on a centos box with vagrant.  Where can I set the document root?
[2013-01-02 20:49:02 -0500] jwcarman: has anyone else seen a locally-running chef server return 301 response codes when running via vagrant port forwarding?
[2013-01-02 20:49:06 -0500] n00bie: I believe my fundamental question has now shift to "How do I use templates?"
[2013-01-02 20:49:49 -0500] jwcarman: I am using Berkshelf and it doesn't even look like it's getting to the chef server for some reason
[2013-01-02 20:50:34 -0500] jwcarman: berkshelf dies with a 301 response that it doesn't like and it doesn't upload any cookbooks
[2013-01-02 20:50:52 -0500] jwcarman: does anyone have any ideas on how to best debug this?
[2013-01-02 20:52:19 -0500] n00bie: jwcarman: Sorry, you're way ahead of me
[2013-01-02 20:52:43 -0500] jwcarman: n00bie: you'll catch up pretty fast
[2013-01-02 20:53:55 -0500] n00bie: Thanks for the words of encouragement
[2013-01-02 20:54:28 -0500] mattt: n00bie: yewcandeweet
[2013-01-02 20:54:47 -0500] jwcarman: n00bie: I've not been at this very long; I can't be too far ahead! :)
[2013-01-02 21:00:12 -0500] wlan: Oh
[2013-01-02 21:00:16 -0500] wlan: Hello guys
[2013-01-02 21:02:44 -0500] wlan: I'm newbie in chef, and i cannot to try, puppet or chef
[2013-01-02 21:03:28 -0500] eka: wlan: what?
[2013-01-02 21:04:15 -0500] wlan: Why chef better than puppet? =)
[2013-01-02 21:04:27 -0500] wlan: It's not for trolling
[2013-01-02 21:04:38 -0500] eka: ouch
[2013-01-02 21:05:03 -0500] wlan: I need choose a system for managment
[2013-01-02 21:05:14 -0500] wlan: i need to choose
[2013-01-02 21:05:41 -0500] eka: wlan: you know ruby? chef is good so
[2013-01-02 21:05:55 -0500] wlan: eka: nope, but i know perl and python
[2013-01-02 21:06:18 -0500] wlan: AFAIK ruby is like perl
[2013-01-02 21:06:48 -0500] wlan: I read many many pages in web
[2013-01-02 21:07:01 -0500] wlan: Chef texhnically is better puppet
[2013-01-02 21:07:02 -0500] btm: @opscode cookbook review: join http://bit.ly/Vva4wL, watch: http://youtu.be/lZktPVCLvvo #opschef
[2013-01-02 21:07:21 -0500] eka: wlan: http://bit.ly/UGMxe3
[2013-01-02 21:07:48 -0500] eka: wlan: any answer here will be biased
[2013-01-02 21:07:56 -0500] wlan: eka: yes yes yes
[2013-01-02 21:08:00 -0500] wlan: I read this
[2013-01-02 21:08:25 -0500] miah: experiment with various configuration management systems. make a decision based on those results.
[2013-01-02 21:08:35 -0500] miah: don't let people tell you what to do. use that grey matter.
[2013-01-02 21:08:41 -0500] eka: miah: that's very difficult lots to learn IMHO
[2013-01-02 21:08:47 -0500] miah: welcome to life
[2013-01-02 21:08:50 -0500] eka: lol
[2013-01-02 21:08:51 -0500] lehrblogger: when i was choosing between them, i read somewhere that chef was better suited to people with a development background, and puppet better for those with a sysadmin background
[2013-01-02 21:09:28 -0500] wlan: chef supports ec2 and euca clouds
[2013-01-02 21:09:34 -0500] miah: if you dont enjoy learning. computers are probablly not for you.
[2013-01-02 21:09:37 -0500] miah: wlan: so does puppet.
[2013-01-02 21:09:59 -0500] wlan: miah: i read about knife, it is really nice thing
[2013-01-02 21:10:06 -0500] miah: i guess
[2013-01-02 21:10:11 -0500] miah: puppet has similar features
[2013-01-02 21:10:45 -0500] wlan: miah: i enjoy learning, dude ;)
[2013-01-02 21:11:09 -0500] wlan: miah: what do you say about speed?
[2013-01-02 21:11:18 -0500] miah: speed varies in all platforms
[2013-01-02 21:11:37 -0500] miah: it also varies on task, and implementation
[2013-01-02 21:11:58 -0500] miah: i've used cfengine, puppet, and chef. the people i work for use chef.
[2013-01-02 21:12:00 -0500] wlan: Chef's requirements make me cry
[2013-01-02 21:12:12 -0500] miah: how so?
[2013-01-02 21:12:16 -0500] maplebed: ok, so I'm working with the nagios cookbook, trying to use the hostgroups data bag to create a data bag that contains all hosts in the same environment as the chef server.  Most of the searches in the recipe do things like search(:node, "roles:#{r.name} AND chef_environment:#{node.chef_environment}") do |n|.
[2013-01-02 21:12:36 -0500] maplebed: However, since the hostgroup data bag is supposed to define a search, the recipe there just says search(:node, "#{hg['search_query']}") do |n|
[2013-01-02 21:12:41 -0500] maplebed: which seems reasonable.
[2013-01-02 21:13:06 -0500] maplebed: but I'm at a loss on how to construct a search in the data bag that can reference the calling hosts' environment in the same way the recipe does.
[2013-01-02 21:13:25 -0500] maplebed: Should I change the recipe to construct the user-provided search with the environment in the same way as the other searches?
[2013-01-02 21:13:30 -0500] wlan: Are alternative for chef and puppet>
[2013-01-02 21:13:31 -0500] wlan: ?
[2013-01-02 21:13:44 -0500] wlan: On python or another L?
[2013-01-02 21:13:46 -0500] maplebed: wlan: salt, cfengine,
[2013-01-02 21:13:48 -0500] miah: saltstack, cfengine, juju, bcfg2
[2013-01-02 21:13:53 -0500] eka: wlan: there is a python one called saltstack
[2013-01-02 21:14:09 -0500] wlan: hm
[2013-01-02 21:14:10 -0500] kallistec: wlan: speed is almost completely dependent on platform/network/etc. Any config manager is doing a bunch of IO for side effects
[2013-01-02 21:14:32 -0500] maplebed: I'm leaning towards yes, I should add the restriction into the recipe, since if you do construct a hostgroup out of a search that doesn't, you don't have a host that exists for it and nagios complains.
[2013-01-02 21:14:33 -0500] wlan: What do you recommend?
[2013-01-02 21:14:38 -0500] maplebed: any opinions here?
[2013-01-02 21:14:43 -0500] wlan: maplebed: yep
[2013-01-02 21:15:57 -0500] wlan: I know, it is stupid ask on this channel, but i'm really interesting
[2013-01-02 21:17:09 -0500] kallistec: wlan: so, Chef advocates with puppet experience will tell you that eventually they found puppet's DSL limiting and needed to use ruby to extend puppet in meaningful ways
[2013-01-02 21:17:24 -0500] miah: maplebed: you can include the environment in the databag entry
[2013-01-02 21:17:49 -0500] maplebed: miah: as a variable?
[2013-01-02 21:17:58 -0500] miah: you could just put 'role:foo AND chef_environment:#{node.chef_environment}'
[2013-01-02 21:18:09 -0500] miah: and let ruby do string interpolation
[2013-01-02 21:18:10 -0500] jwcarman: anyone know of a way to turn up logging output with berkshelf?
[2013-01-02 21:18:11 -0500] maplebed: and that will get double-interpreted?
[2013-01-02 21:18:16 -0500] maplebed: huh.  I didn't expect that.
[2013-01-02 21:18:17 -0500] miah: i believe so yes
[2013-01-02 21:18:25 -0500] maplebed: I'll give it a try, thanks.
[2013-01-02 21:18:35 -0500] miah: its a object sending a message to a object. its the ruby way.
[2013-01-02 21:18:35 -0500] jwcarman: Nobody expects the Spanish Inquisition!
[2013-01-02 21:18:50 -0500] maplebed: s/Inquisition/Interpolation/?
[2013-01-02 21:18:56 -0500] wlan: Can i use chef without ruby skiils?
[2013-01-02 21:19:03 -0500] miah: yes.
[2013-01-02 21:19:05 -0500] robbkidd: miah: Are you https://github.com/miah ?
[2013-01-02 21:19:10 -0500] jwcarman: wlan: that's what I am doing!
[2013-01-02 21:19:10 -0500] wlan: Or i need to learn basics of ruby?
[2013-01-02 21:19:11 -0500] jwcarman: :)
[2013-01-02 21:19:11 -0500] miah: but your ruby skills will likely improve as you use chef
[2013-01-02 21:19:13 -0500] miah: robbkidd: yes.
[2013-01-02 21:19:23 -0500] wlan: jwcarman: nice =)
[2013-01-02 21:19:35 -0500] wlan: I think i will try chef
[2013-01-02 21:19:42 -0500] jwcarman: wlan: I knew ruby a bit before I started
[2013-01-02 21:19:51 -0500] lehrblogger: wlan: i just dove in without studying any ruby. coming from python, the syntax comes pretty easily
[2013-01-02 21:19:56 -0500] wlan: I think i musr will try chef
[2013-01-02 21:20:03 -0500] robbkidd: miah: Ah! Marvelous! Can you recommend which of the chef-redid repos I should use? Yours? CXinc's? Another?
[2013-01-02 21:20:03 -0500] wlan: must
[2013-01-02 21:20:10 -0500] kallistec: wlan: chef-server has a bunch of moving parts, which can be frustrating if installation doesn't go right. On the other hand you get the search feature which allows you to configure one system (e.g., nagios, load balancer) based on what other systems you have
[2013-01-02 21:20:22 -0500] robbkidd: miah: *sigh* chef-redis, even.
[2013-01-02 21:20:24 -0500] n00bie: In the apache2 cookbook, how can I change the document root?
[2013-01-02 21:20:27 -0500] miah: well. cxincs probably hasn't been updated since i left. just use the one in my repo. others may have different features.
[2013-01-02 21:20:40 -0500] miah: use the one that works best for your requirements.
[2013-01-02 21:20:53 -0500] robbkidd: miah: Yours has been chugging along nicely for me for a couple weeks. Thanks for it!
[2013-01-02 21:20:54 -0500] kallistec: wlan: chef-server installation will be much nicer in the near future with the single package installer
[2013-01-02 21:20:57 -0500] miah: thanks
[2013-01-02 21:22:48 -0500] wlan: Can webUI show a status of my tasks?
[2013-01-02 21:22:57 -0500] wlan: Like puppet's dashboard
[2013-01-02 21:23:16 -0500] kallistec: wlan: at the moment, no
[2013-01-02 21:23:25 -0500] wlan: sad
[2013-01-02 21:25:12 -0500] miah: what tasks do you want to see on a dashboard?
[2013-01-02 21:29:23 -0500] wlan: miah: er, for example, i wanna install a packet, and i want to know status of this task
[2013-01-02 21:29:27 -0500] n00bie: In the apache2 cookbook, how can I change the document root?  in the default.rb?
[2013-01-02 21:29:40 -0500] maplebed: miah: my test (so long as I'm doing it right) shows that double-interpolation doesn't happen.  :(
[2013-01-02 21:30:36 -0500] wlan: lehrblogger: nice, i will try
[2013-01-02 21:30:42 -0500] maplebed: (log output is [2013-01-02T21:26:57+00:00] INFO: searching for '*:* AND chef_environment:#{node.chef_environment}' <--, which I would expect to say 'production' instead of #{node.chef_environment})
[2013-01-02 21:31:00 -0500] wlan: Just now late for me -)
[2013-01-02 21:31:11 -0500] wlan: 1:31 AM
[2013-01-02 21:31:21 -0500] maplebed: anyway.  I think I'll add the constraint in a way similar to the rest of the recipe and upstream it, see if the patch is accepted.
[2013-01-02 21:38:40 -0500] eka: attributes are automatically read from all cookbooks even if they are not included in the run-list?
[2013-01-02 21:40:26 -0500] miah: maplebed: link me when you have a PR/ticket
[2013-01-02 21:40:34 -0500] maplebed: ok.
[2013-01-02 21:40:57 -0500] maplebed: just testing the patch now.
[2013-01-02 21:43:09 -0500] charity_: df -h
[2013-01-02 21:50:24 -0500] jwcarman: It looks like Berkshelf is failing to upload something to /sandboxes or whatever.  That's the 301 error it's getting
[2013-01-02 21:50:32 -0500] jwcarman: What's that all about?
[2013-01-02 21:50:40 -0500] jwcarman: Looks like it might be syntax checking?
[2013-01-02 22:19:09 -0500] aabes: is there a way to provide chef-server (opensource) a client certificate that it should trust as an admin?
[2013-01-02 22:19:52 -0500] kostiklv: Hi! Does anybody have a minute to help with (most probably very simple) problem with create LWRP provider?
[2013-01-02 22:24:44 -0500] maplebed: miah: http://tickets.opscode.com/browse/COOK-2150 and https://github.com/opscode-cookbooks/nagios/pull/85
[2013-01-02 23:00:26 -0500] ober: so I have these instance_methods added to libraries/ as helper functions added to Chef::Resource::Template. and in erb am calling <%= some_method.call(some_var) %> does erb not support <%= Chef::Resource::Template.new.some_method(some_var) %>?
[2013-01-02 23:09:19 -0500] ranjibd: aabes, around?
[2013-01-02 23:09:59 -0500] aabes: here
[2013-01-02 23:10:20 -0500] aabes: ranjibd?
[2013-01-02 23:11:07 -0500] ranjibd: which version of chef you are using?
[2013-01-02 23:12:42 -0500] aabes: currently, on 0.10.8
[2013-01-02 23:12:45 -0500] aabes: just saw your email...
[2013-01-02 23:45:48 -0500] aabes: ranjibd - in your scenario, you have admin credentials already available, and you're creating new users to match your openvpn and other auth environments
[2013-01-02 23:45:49 -0500] aabes: ?
[2013-01-02 23:46:18 -0500] ranjibd: well., im doing it via a chef recipe
[2013-01-02 23:46:26 -0500] ranjibd: that is attached to the server node
[2013-01-02 23:46:43 -0500] ranjibd: but yes, i am running with a chef admin
[2013-01-02 23:47:00 -0500] aabes: you're manipulating chef -server entities within a chef recipe ... wow, that's brave ;)
[2013-01-02 23:47:11 -0500] ranjibd: aabes, indeed
[2013-01-02 23:47:54 -0500] aabes: my scenario is a bit different - I'm trying to inject a known user into a chef-server.
[2013-01-02 23:48:08 -0500] aabes: but I have a chicken and egg problem
[2013-01-02 23:49:15 -0500] ranjibd: when you say known user.. what exactly you mean? known to whom?
[2013-01-02 23:49:29 -0500] ranjibd: chef? or some other system?
[2013-01-02 23:49:34 -0500] aabes: other system
[2013-01-02 23:49:50 -0500] aabes: well... as long as they agree on a user+key I don't care who's the chicken and who's the egg
[2013-01-02 23:50:32 -0500] ranjibd: so you have an external system, like ldap or openvpn, which has a user list, and you want chef to be in sync with that?
[2013-01-02 23:50:32 -0500] aabes: issue is that right now, I'm using the webui pem to create this user... but the key is generated as part of server install...
[2013-01-02 23:50:47 -0500] ranjibd: yes
[2013-01-02 23:51:28 -0500] aabes: I'd like to inject my key during server install, or shortly there after... ideally, without depending on anything that got generated during server install
[2013-01-02 23:53:21 -0500] aabes: does that make any sense?
[2013-01-02 23:55:56 -0500] yfeldblum: aabes, chef-server keys are generated on-demand, when you request key resets
[2013-01-02 23:56:17 -0500] aabes: by default yes...
[2013-01-02 23:56:43 -0500] aabes: I want to feed a key into chef... and ranjibd has suggested a method
[2013-01-02 23:56:59 -0500] aabes: but it still requires an initial admin user to be available
