[2013-01-11 00:27:28 -0500] WPsites: I've got a recipe that has a bash script block in it that keeps failing because in the script a compiler generates a warning. What can I do about this?
[2013-01-11 00:33:22 -0500] tomdzk: WPsites: best is probably to create a separate script file that deals with the warning using normal shell tests, and returns the output status you consider to be correct (e.g. 0 if the warning can be ignored)
[2013-01-11 00:35:07 -0500] WPsites: sounds like hard work
[2013-01-11 00:35:23 -0500] tomdzk: heh
[2013-01-11 01:23:31 -0500] red5|ryan: ever seen a 401 from knife cookbook upload --all?
[2013-01-11 01:35:27 -0500] tomdzk: red5|ryan: check that the machine you running this on, is still registered as a client (with the correct key)
[2013-01-11 01:51:05 -0500] Migore: hey, I'm trying to install postgis from here (http://community.opscode.com/cookbooks/postgis) but I keep getting this: FATAL: NameError: Cannot find a resource for apt_repository on ubuntu version 12.04
[2013-01-11 01:51:18 -0500] Migore: I'm very noob to chef, can anyone give me some advice?
[2013-01-11 01:54:28 -0500] kallistec: Migore: probably that recipe is trying to install a 3rd party apt repo, and it expects you to have the apt cookbook to do so
[2013-01-11 01:57:45 -0500] Migore: hmm, I'll try it
[2013-01-11 01:57:46 -0500] Migore: thanks
[2013-01-11 02:04:27 -0500] timsmith: I noticed that chef 10.16.6 just showed up
[2013-01-11 02:04:30 -0500] timsmith: any release notes on that
[2013-01-11 02:04:43 -0500] timsmith: JIRA is a bit behind
[2013-01-11 02:04:48 -0500] timsmith: 10.16.4 is still unreleased there
[2013-01-11 02:11:56 -0500] Migore: kallistec: it worked! thanks!
[2013-01-11 02:13:45 -0500] kallistec: np
[2013-01-11 02:55:20 -0500] robbkidd: OK. Beating head against wall. Looking for a solution to install an MTA (Postfix, exam4, or the like) that will allow me to configure local delivery in development and smart host relaying in staging and production.
[2013-01-11 02:55:35 -0500] maek: anyone know where the sandboxes dir is stored in private chef?
[2013-01-11 02:57:24 -0500] robbkidd: I'm testing on Ubuntu, so I've a preference for Postfix, but my read of the OpsCode Postfix cookbook is that it only covers a full on mail server or a client MTA that relays through another. No local delivery. Do I understand that right?
[2013-01-11 03:16:30 -0500] ggolin: can i have a ruby_block in an not_if metaparameter?
[2013-01-11 03:16:54 -0500] ggolin: something like not_if ruby_block { File.exist? SNMP::MIB::DEFAULT_MIB_PATH + "/#{mib}.yaml" }
[2013-01-11 03:17:34 -0500] kallistec: ggolin:  yeah, you just don't need the "ruby_block" part
[2013-01-11 03:17:45 -0500] ggolin: oh
[2013-01-11 03:17:51 -0500] ggolin: and when does that get evaluated?
[2013-01-11 03:18:02 -0500] kallistec: at the last possible moment
[2013-01-11 03:18:15 -0500] maek: kallistec: do you know by chance the location of the sandboxes dir in private chef ?
[2013-01-11 03:18:27 -0500] ggolin: kallistec, thanks, im going to try that.
[2013-01-11 03:18:34 -0500] kallistec: maek: not off hand, no
[2013-01-11 03:18:45 -0500] maek: k, thanks.
[2013-01-11 03:19:45 -0500] maek: hooray for partials in chef 11. :D
[2013-01-11 04:06:12 -0500] ggolin: any way to notify a ruby_block resource defined in another recipe? (same cookbook)
[2013-01-11 04:35:34 -0500] ranjib_: ggolin, same as any other resources
[2013-01-11 04:36:10 -0500] ranjib_: ggolin, how are you adding that recipe, via include_recipe, or directly in run_list ?
[2013-01-11 04:36:54 -0500] ranjib_: ggolin,  notifies :run ,"ruby_block[something]"
[2013-01-11 05:21:18 -0500] erratic: dude vegas has roller coasters Im hittin that up
[2013-01-11 05:21:41 -0500] erratic: right after I get good and ready to puke up alot of alcohol
[2013-01-11 06:19:18 -0500] lehrblogger: hm, i have a relatively simple question - if i'm include_recipe'ing one inside another, is there any way to get a variable from the child recipe into the parent?
[2013-01-11 06:19:40 -0500] lehrblogger: i could set a node attribute, but that's not really what i need this for
[2013-01-11 07:19:47 -0500] DeadZen: there something wrong with the sudo cookbook?
[2013-01-11 09:59:31 -0500] bubu: hi guys - how can I use stuff in data bags in .erb templates?
[2013-01-11 10:08:40 -0500] simonmcc: bubu: data_bag & data_bag_item are useable inside your ruby fragments in the erb
[2013-01-11 10:09:35 -0500] simonmcc: bubu: you could also extract the data you want in the recipe, and then pass it to the template using variables option
[2013-01-11 10:12:12 -0500] bubu: yes simonmcc going down the latter route
[2013-01-11 10:12:16 -0500] bubu: I think... :)
[2013-01-11 10:13:25 -0500] simonmcc: bubu: there are many ways to skin the cat :-)
[2013-01-11 10:19:33 -0500] jeekl: Are there any specific ohai key that I can look for, for determining if a computer is virtualised or not?
[2013-01-11 10:26:39 -0500] MerlinDMC: jeekl, virtualization ... there are system and role entries
[2013-01-11 10:28:16 -0500] jeekl: MerlinDMC: Yeah, that's the only thing I found too, and it looks fine on xenserver and vmware, but I just get an empty virtualization, without role and system, in my cagrant-test with virtualbox.
[2013-01-11 10:29:43 -0500] MerlinDMC: maybe because ohai doesn't know vbox? :)
[2013-01-11 10:29:54 -0500] MerlinDMC: i would look for an ohai plugin then ... if you really need that
[2013-01-11 10:30:16 -0500] jeekl: Allright. Cool. :-)
[2013-01-11 10:30:18 -0500] jeekl: Thanks!
[2013-01-11 10:35:45 -0500] MerlinDMC: jeekl, http://tickets.opscode.com/browse/OHAI-110 ... looks like it should detect it ...
[2013-01-11 10:40:49 -0500] Squarism: How does puppet vs chef compare (except that ruby uses ruby which i myself hate)
[2013-01-11 10:40:54 -0500] Squarism: ?
[2013-01-11 10:44:25 -0500] Cope: Squarism: what's motivating the question?  what are you planning to do?
[2013-01-11 10:45:13 -0500] Squarism: Cope: as I wrote on #puppet
[2013-01-11 10:45:15 -0500] Squarism: i want to sell a CM tool the operations department here on my organization. Sadly, i have a hard time evaluating puppet (ive used chef before - which i know rougly). Isnt there some nice videos showing the ease and power of puppet. All the tutorials are very technical / non-abstract. I want to show the big picture before going inte "manifests" and other shit
[2013-01-11 10:46:00 -0500] Squarism: I wanna propose a CM tool to my operations department. But dont understand puppet.
[2013-01-11 10:46:22 -0500] ProfFalken: Squarism: then go with what you know
[2013-01-11 10:46:27 -0500] Squarism: ...cannot find any good intro/beginners-tutorial
[2013-01-11 10:47:06 -0500] Cope: Squarism: where do you sit here? are you a dev? are you a manager?
[2013-01-11 10:47:07 -0500] ProfFalken: Squarism: Chef has the awesomeness of "search" that has to be added to Puppet (heira)
[2013-01-11 10:47:35 -0500] ProfFalken: Squarism: Puppet has the awesomeness of not insisting on being the cannonical source of truth (unlike chef)
[2013-01-11 10:47:53 -0500] ProfFalken: but it ultimately comes down to "what's the quick win here" in my experience
[2013-01-11 10:48:02 -0500] Squarism: im a developer, but on my last org - had a more devops role as we were responsible for the infrastructure ourselves
[2013-01-11 10:48:14 -0500] ProfFalken: unless you are running thousands of nodes and need to look at ssl scaling etc
[2013-01-11 10:48:29 -0500] ProfFalken: then I'd pick one that you'd comfortable with and use it
[2013-01-11 10:49:09 -0500] Squarism: Quick wins are, automated deployment. Tracable configurations. Less dependent on people
[2013-01-11 10:49:27 -0500] Squarism: ...and also scalability / maintainability
[2013-01-11 10:49:38 -0500] Squarism: well prolly start with 10 nodes or so
[2013-01-11 10:50:02 -0500] ProfFalken: ok, and you already have knowledge of Chef?
[2013-01-11 10:50:22 -0500] ProfFalken: What about those around you? Do they have knowledge of any other tools (cfengine/puppet/salt)?
[2013-01-11 10:50:28 -0500] Squarism: Yeah.. but im not gonna be the main user of the software - that will be the operations department'
[2013-01-11 10:50:37 -0500] ProfFalken: heh
[2013-01-11 10:50:54 -0500] Squarism: ProfFalken, these are 45 yrs+ old men with no former experiance with CM tools
[2013-01-11 10:50:54 -0500] ProfFalken: ok
[2013-01-11 10:51:03 -0500] Squarism: ...that will be the primary users
[2013-01-11 10:51:22 -0500] ProfFalken: first thing I'd sy to that is that age doesn't matter, it's wether they are willing to adopt new technologies
[2013-01-11 10:51:39 -0500] ProfFalken: do they have a load of bash scripts etc. for provisioning boxes?
[2013-01-11 10:51:55 -0500] ProfFalken: if so, then they're already using CM, they probably just don't know it yet...
[2013-01-11 10:52:08 -0500] ProfFalken: do they have a Configuration Management Database?
[2013-01-11 10:52:27 -0500] ProfFalken: if so, look to see how easy it would be to interface puppet/chef/whatever to that existing infrastructure
[2013-01-11 10:52:47 -0500] Squarism: ProfFalken, the answer is prolly NO, NO
[2013-01-11 10:52:55 -0500] ProfFalken: (it's far easier to sell something that hooks into the exising kit than tell them they need to blow everything away and start again)
[2013-01-11 10:53:13 -0500] Squarism: oh ok
[2013-01-11 10:53:16 -0500] Cope: Squarism: what sort of stuff do the ops team do? Scale? Type of busness? Tech?
[2013-01-11 10:54:26 -0500] Squarism: Its a governemental company providing 25 roughly similar typical web applications running on tomcat/mysql... with PROD and TEST environments
[2013-01-11 10:54:41 -0500] Cope: UK?
[2013-01-11 10:54:45 -0500] Squarism: No.. sweden
[2013-01-11 10:55:34 -0500] Squarism: Im just not a good operations person. Just wanna make it A. easy to sell. B. easy to use for these totally CM-inexperianced people
[2013-01-11 10:55:37 -0500] Cope: What's driving the desire to use CM? Is there some pain that the ops people are feeling? Or is it that you want to evangelise awesomness?
[2013-01-11 10:55:50 -0500] ProfFalken: Cope: good question :)
[2013-01-11 10:56:13 -0500] Squarism: #1  evangelise awesomness!
[2013-01-11 10:56:18 -0500] Squarism: no.
[2013-01-11 10:57:38 -0500] ProfFalken: Squarism: do they see a problem with the current setup (ad are you able to articulate what you see as "the problem")?
[2013-01-11 10:58:01 -0500] Squarism: We are having problems with cumbersome deployments. And I think chef solved that with ease. So in order to get that going - why not use these tools that actually provide more benefits than just automated deployments
[2013-01-11 10:58:21 -0500] ProfFalken: Squarism: I have to be honest, my aproach would probably be "I'd like to talk to you about making deployment/CM more efficient because I've got a few ideas" (or words to that effect)
[2013-01-11 10:58:43 -0500] ProfFalken: once you've had a conversation that outlines where you feel the issues are, you can then move on to talking about specific tech
[2013-01-11 10:58:52 -0500] Cope: Squarism: my experience tends to be that you won't introduce Chef (or puppet) by showing ops people tutorials or videos.  It needs to speak to their needs right now.
[2013-01-11 10:59:02 -0500] ProfFalken: instead of "yelling" that we should all use chef/puppet/whatever
[2013-01-11 10:59:06 -0500] ProfFalken: because we can
[2013-01-11 10:59:10 -0500] ProfFalken: Cope: +1 for that
[2013-01-11 10:59:16 -0500] Cope: So if you can buid a demo shoqing how chef made something quick and awesome, you'll get attention.
[2013-01-11 10:59:37 -0500] Squarism: Cope, yeah.. that sounds sane
[2013-01-11 10:59:44 -0500] ProfFalken: Squarism: also, bear in mind that at times, Puppet/Chef/whatever can get in the way of deployments if it's not configured correctly
[2013-01-11 10:59:52 -0500] ProfFalken: so don't rush in to this... :)
[2013-01-11 11:00:17 -0500] Squarism: Cope, like getting some machine with 4-5 virtual machines on it and then show off some magic?
[2013-01-11 11:00:18 -0500] Squarism: =D
[2013-01-11 11:00:35 -0500] Squarism: ie.. deploying existing apps on those machine
[2013-01-11 11:00:36 -0500] Squarism: s
[2013-01-11 11:00:38 -0500] Cope: Both ProfFalken and I have extensive Puppet experience - so we know both sides.  For me, on a green field site, I'd choose Chef, but the important thing to do is to be able to demonstrate value quickly.  If you already have some experience with Chef, it's a good place to start.  But puppet's a great tool too, of course.
[2013-01-11 11:00:53 -0500] ProfFalken: example: I worked for an organisation where the only way to get code in to production (including a web app) was to package it up as a .rpm and deploy via yum
[2013-01-11 11:00:57 -0500] ProfFalken: that sucked hard
[2013-01-11 11:01:34 -0500] ProfFalken: I introduced Capistrano for a small project at the start of it's lifecycle as an "alternative" way of deploying just this one app
[2013-01-11 11:01:54 -0500] ProfFalken: within a year, we were deploying all our webapps (including the legacy ones) with Cap
[2013-01-11 11:02:04 -0500] Squarism: cap is good
[2013-01-11 11:02:13 -0500] Cope: Squarism: yeah, if you can show how to build a mini env, or a vagrant box running a qa env, or something that obviously makes their lives easier, you'll get attention.
[2013-01-11 11:02:22 -0500] ProfFalken: Squarism: check out Vagrant if you want a quick way of launching a number of VMs with puppet/chef support built in
[2013-01-11 11:02:31 -0500] ProfFalken: Cope: snap :)
[2013-01-11 11:02:54 -0500] Cope: But what you think is awesome may not be what 45 yo IT veteran working for the government thinks is awesome.
[2013-01-11 11:03:02 -0500] Squarism: Cope, yeah.. thatll be my plan
[2013-01-11 11:03:10 -0500] ProfFalken: (and taolly agree about using chef from the outset these days btw, just wish it wasn't so insistent on trying to be a CMDB at the same time... :( )
[2013-01-11 11:03:11 -0500] Cope: So handle with care - you can sometimes do more damage than good.
[2013-01-11 11:03:18 -0500] Squarism: ProfFalken, ill check out Vagrant then
[2013-01-11 11:03:51 -0500] ProfFalken: Squarism: do, and once you've mastered the basics, look at http://docs.vagrantup.com/v1/docs/multivm.html
[2013-01-11 11:04:01 -0500] ProfFalken: it will explain how to get a number of VMs up and running quickly
[2013-01-11 11:04:19 -0500] Cope: Squarism: what I will say clearly and firmly is that Chef has one of the most friendly and accessible communities of anywhere I've ever experienced, so if you want some help and guidance as you make stuff awesome, stick around here :))
[2013-01-11 11:04:26 -0500] ProfFalken: +1
[2013-01-11 11:04:38 -0500] Squarism: Haha
[2013-01-11 11:04:49 -0500] Squarism: You two are a good example of that! =D
[2013-01-11 11:05:03 -0500] Squarism: Really appriciate the leads!
[2013-01-11 11:05:14 -0500] Cope: Very welcome - let us know how you get on.
[2013-01-11 11:05:15 -0500] Squarism: ../feedback
[2013-01-11 11:05:28 -0500] Squarism: Ill surely come back
[2013-01-11 11:06:39 -0500] Squarism: ProfFalken, exactly what is vagrant? Like a distro of a Virtual Machine software + configuration of it?
[2013-01-11 11:07:20 -0500] Squarism: Could it set up a chef server with some chef clients on a single machines?
[2013-01-11 11:07:27 -0500] ProfFalken: Squarism: it's a ruby gem that launches VMs via virtualbox
[2013-01-11 11:07:30 -0500] ProfFalken: yes
[2013-01-11 11:07:34 -0500] ProfFalken: if you tell it to
[2013-01-11 11:07:40 -0500] Squarism: ok nice
[2013-01-11 11:07:55 -0500] ProfFalken: you basically feed it a file with a given format
[2013-01-11 11:07:59 -0500] ProfFalken: and it launches the VMs
[2013-01-11 11:08:23 -0500] ProfFalken: I used to have a version that provisioned a chef server and all the clients, not sure what happened to it
[2013-01-11 11:08:35 -0500] ProfFalken: I'll see if I can dig it out from somewhere
[2013-01-11 11:08:43 -0500] ProfFalken: but I wouldn't hold your breath :)
[2013-01-11 11:09:02 -0500] Squarism: oh ok.. feel free to share it if u find it
[2013-01-11 11:10:00 -0500] ProfFalken: will do
[2013-01-11 11:10:22 -0500] ProfFalken: if I find it (I think it's on an old machine that I don't have anymore) I'll push it to github
[2013-01-11 11:10:28 -0500] Squarism: Thanx
[2013-01-11 11:15:28 -0500] ndee: hi guys, I'm starting out with chef and I am reading the wiki. I want to build a LAMP stack, which I also read in the wiki but one question that I have is: where do I store my own configuration values? for example, when I want to change the query_cache_limit for the mysql cookbook.
[2013-01-11 11:16:24 -0500] ProfFalken: ndee: store the, in attributes (node, cookbook or environment) and then access them in your recipes and pass them to your templates
[2013-01-11 11:16:43 -0500] ProfFalken: alternatively, check out the community cookbooks for LAMP stuff, they may already do what you need
[2013-01-11 11:19:14 -0500] ndee: ProfFalken, so the workflow is to create an own cookbook and "import" the already existing cookbooks?
[2013-01-11 11:20:38 -0500] ProfFalken: ndee:
[2013-01-11 11:20:42 -0500] ProfFalken: not quite
[2013-01-11 11:21:20 -0500] ProfFalken: you would create a git repo to store all your cookbooks/roles/databags in and then use "knife cookbook install" (or what ever the syntax is) to add the community cookbook
[2013-01-11 11:21:35 -0500] ndee: yes, that I understood so far
[2013-01-11 11:21:39 -0500] ProfFalken: ndee: it's all at http://community.opscode.com/cookbooks/
[2013-01-11 11:22:11 -0500] ndee: but I don't understand where exactly I can set my own attributes for, e.g. creating mysql users
[2013-01-11 11:24:14 -0500] ProfFalken: there are many places
[2013-01-11 11:24:21 -0500] ProfFalken: look at the attributes section on the wiki
[2013-01-11 11:24:35 -0500] ProfFalken: http://wiki.opscode.com/display/chef/Attributes
[2013-01-11 11:25:34 -0500] ProfFalken: ndee: It might also be worth looking at something smaller than an entire LAMP stack for your first deploy though based on my past experience... :)
[2013-01-11 11:27:12 -0500] maddoc: jtimberman: Thanks! Would be really happy if you could keep me posted in case you get any more/new info.
[2013-01-11 11:39:26 -0500] jbusam: Is there any reason why an "add repository" wouldn't trigger an apt-get update?
[2013-01-11 12:12:50 -0500] ndee: ProfFalken, so you normally clone a cookbook and then edit it, is that the correct approach? :D
[2013-01-11 12:13:13 -0500] ndee: ProfFalken, I just want to start with the DB server, then add the apache server and then maybe a nginx load balancer
[2013-01-11 13:04:24 -0500] woltage: Hi! Can I somehow manage SElinux file types with Chef?
[2013-01-11 13:30:53 -0500] woltage: Ok, fixed users-cookbook bug.
[2013-01-11 13:31:10 -0500] woltage: Now it works with SELinux.
[2013-01-11 13:33:51 -0500] fromonesrc: any tips on getting started with hosting my own chef server?
[2013-01-11 13:33:59 -0500] fromonesrc: I'm only seeing refs to opscode private chef
[2013-01-11 13:34:24 -0500] fromonesrc: I thought there was a free option using open source chef, maybe I'm wrong on that
[2013-01-11 13:35:54 -0500] matti: It is.
[2013-01-11 13:36:19 -0500] fromonesrc: matti: can you elaborate?
[2013-01-11 13:36:30 -0500] matti: You can install it yourself.
[2013-01-11 13:36:39 -0500] matti: There are packages and other ways.
[2013-01-11 13:36:57 -0500] matti: It has some annoying dependencies, but aside of that is easy to install and configure.
[2013-01-11 13:37:07 -0500] zts: fromonesrc: http://wiki.opscode.com/display/chef/Installing+Chef+Server
[2013-01-11 13:37:38 -0500] fromonesrc: zts: thanks, that looks helpful!
[2013-01-11 13:37:51 -0500] fromonesrc: matti: thanks
[2013-01-11 13:38:00 -0500] matti: fromonesrc: Google as well, there are thousands of blog posts how to do this.
[2013-01-11 13:38:24 -0500] matti: fromonesrc: Pretty much every sparkly operations ninja wrote an article about how to use ls in bash, and install Chef server ;]
[2013-01-11 13:38:56 -0500] fromonesrc: searches were coming back with articles about chef and opscode private chef (paid)
[2013-01-11 13:39:00 -0500] fromonesrc: I'll do some more digging :)
[2013-01-11 13:39:21 -0500] fromonesrc: install doesn't look too complicated
[2013-01-11 13:41:19 -0500] beliveyourdream: anyone knows how can i generate a random string in chef ?
[2013-01-11 13:41:40 -0500] fromonesrc: beliveyourdream: it's just ruby so http://stackoverflow.com/questions/88311/how-best-to-generate-a-random-string-in-ruby
[2013-01-11 13:42:02 -0500] matti: beliveyourdream: Its Ruby, so find any way you like.
[2013-01-11 13:42:43 -0500] beliveyourdream: ok thanks
[2013-01-11 15:06:15 -0500] PierreO1: Hi guys, I have an issue on how to organise my work
[2013-01-11 15:06:33 -0500] PierreO1: I have a gentoo,  and the recipes I want to use are not made for it
[2013-01-11 15:06:35 -0500] xerxas: Hi all !
[2013-01-11 15:06:48 -0500] xerxas: I have this message error: '[2013-01-10T23:02:05+00:00] INFO: HTTP Request Returned 412 Precondition Failed: {"non_existent_cookbooks":["build_essential"],"cookbooks_with_no_versions":[],"message":"Run list contains invalid items: no such cookbook build_essential."}'
[2013-01-11 15:07:21 -0500] PierreO1: I want to give back to the community, but it seems a difficult process and a lot of work
[2013-01-11 15:07:22 -0500] xerxas: the cookbook build_essential is here, uploaded, the thing is the node have it's own node, using it own client, in it's own environement
[2013-01-11 15:07:49 -0500] xerxas: I already had this issue, but don't remember how I fixed it, basically, the build-essential cookbook is here, but the node cannot access it
[2013-01-11 15:08:06 -0500] xerxas: does anyone know how I can make this cookbook accessible to this node ?
[2013-01-11 15:08:40 -0500] PierreO1: So if you have some advises for me on what should I do? (using opscode cookbooks, using gentoo non-official cookbooks, or try to report bugs for opscode cookbooks)
[2013-01-11 15:09:22 -0500] spox: xerxas: looks like you are using the wrong name
[2013-01-11 15:09:28 -0500] spox: the cookbook is 'build-essential'
[2013-01-11 15:09:32 -0500] spox: not 'build_essential'
[2013-01-11 15:10:41 -0500] spox: PierreO1: you just have to fill out a form to contribute upstream to opscode cookbooks. it's not too bad.
[2013-01-11 15:10:53 -0500] xerxas: ah spox, sorry ;)
[2013-01-11 15:10:55 -0500] spox: and filing bugs you run into is still helpful even without any fixes
[2013-01-11 15:10:56 -0500] xerxas: thanks !
[2013-01-11 15:10:59 -0500] spox: xerxas: sure :)
[2013-01-11 15:11:15 -0500] xerxas: spox:  I'm stupid, sorry ;)
[2013-01-11 15:11:36 -0500] spox: xerxas: nah, it happens. easy to mix the dash and underscore up
[2013-01-11 15:12:15 -0500] PierreO1: spox : Yes, I know, ok, I was a bit desperate because of a cookbook not maintained anymore, I'll do my best to help back the community :)
[2013-01-11 15:12:24 -0500] PierreO1: spox : thanks, have a nice day!
[2013-01-11 15:12:50 -0500] spox: PierreO1: not maintained by opscode, or a community cookbook that has been abandoned?
[2013-01-11 15:13:45 -0500] PierreO1: spox : a community cookbook that looks like abandoned, Jenkins
[2013-01-11 15:14:29 -0500] PierreO1: spox : I'll try a pull request and if not working, I'll give him a second life!
[2013-01-11 16:02:45 -0500] leifmadsen: when I run the chef-client on a machine, where is the output of the run stored again?
[2013-01-11 16:02:50 -0500] leifmadsen: I just need to validate what ran
[2013-01-11 16:03:36 -0500] leifmadsen: disregard, found it
[2013-01-11 16:15:55 -0500] Joel: leifmadsen: $20 if you punch Jason in the arm.
[2013-01-11 16:16:10 -0500] leifmadsen: Joel: which Jason?!
[2013-01-11 16:16:14 -0500] cheflevelramen: Hi cooks, I have yet another question (thanks for everyone being so helpful btw). With encrypted data bags, it looks like you need to have the encryption key on the machine that executes an encrypted resource. I don't see a simple way of properly distributing the encryption key, other than storing it too in the chef repo, though this time unencrypted. Is there really any benefit then of having encrypted items if the encryption
[2013-01-11 16:16:25 -0500] Joel: leifmadsen: the wee one.
[2013-01-11 16:16:35 -0500] leifmadsen: Joel: he is significantly far away from me :)
[2013-01-11 16:16:42 -0500] leifmadsen: I'm in Toronto, he in HSV
[2013-01-11 16:16:54 -0500] Joel: leifmadsen: ahh that's right, you're north north american
[2013-01-11 16:16:58 -0500] leifmadsen: Joel: however, you might want to ask opticron :)
[2013-01-11 16:20:40 -0500] zts: cheflevelramen: I think your line was truncated, but if using encrypted data bags you should distribute your encryption key using something other than Chef
[2013-01-11 16:21:27 -0500] zts: cheflevelramen: the goal of encrypted data bags is that the Chef server does not have access to your secrets (which might be a concern when using Hosted Chef, or just as a matter of good practice) - but this means that the Chef server shouldn't see your encryption key
[2013-01-11 16:23:04 -0500] cheflevelramen: zts: I see, and I agree. Is there a standard way then of distributing encryption keys? Obviously I don't want to sacrifice automaticity by manually distributing the key, and I rather not inject a bash script in my knife -> provisioning process
[2013-01-11 16:24:18 -0500] zts: cheflevelramen: I don't think there's a standard way, and I'm not sure what's common (I haven't used the feature myself).  I've heard of people distributing the key in their build process (kickstart, FAI, etc), and using a small web service
[2013-01-11 16:25:04 -0500] zts: cheflevelramen: in the second case, you have a Chef recipe to pull down the key from a web service that only your servers have access to
[2013-01-11 16:25:56 -0500] zts: cheflevelramen: and if you're provisioning using 'knife bootstrap', I imagine you could use a custom boostrap template to drop off the key
[2013-01-11 16:26:15 -0500] zts: cheflevelramen: sorry I'm not more familiar with using that feature in practice, hopefully someone else here can add some more detail
[2013-01-11 16:26:48 -0500] cheflevelramen: zts: interesting. I'm using knife ec2 server create. Do you happen to know if the knife-ec2 gem includes an easy way to do this? I haven't seen one yet. Guess I should go dig deeper
[2013-01-11 16:28:24 -0500] zts: cheflevelramen: I believe that ultimately uses the regular bootstrap mechanism, so it's probably possible in the same way
[2013-01-11 16:29:47 -0500] cheflevelramen: zts: sounds promising. I'll take a look. Thanks for help! If anyone else has other ways of overcomming encryption key distribution, I'd be interested to hear about them
[2013-01-11 16:29:54 -0500] zts: cheflevelramen: and here's a gist from jtimberman with an example bootstrap template: https://gist.github.com/1302749
[2013-01-11 16:31:08 -0500] zts: (you'd want to take lines 34-42 and put them into the bootstrap template you're using)
[2013-01-11 16:35:27 -0500] poseid: hello.. I am trying to setup a dev box with chef-solo... there is this attribute  "root_path" => "#{languages[:ruby][:gems_dir]}/gems/passenger-#{passenger[:version]}",
[2013-01-11 16:35:38 -0500] cheflevelramen: zts: Awesome, this looks like a good solution. Need to read up on bootstrap templates, but I'll give this a show. Thanks again
[2013-01-11 16:35:39 -0500] poseid: how would I use this in the Vagrantfile
[2013-01-11 16:36:45 -0500] zts: cheflevelramen: no problem, good luck :)
[2013-01-11 16:39:33 -0500] ryduh: Hey there. Having a little problem using chef to install mysql. getting this error when I up my vagrant box: apt-get -q -y install mysql-client=5.5.24-0ubuntu0.12.04.1 returned 100, expected 0
[2013-01-11 16:39:54 -0500] pwelch: ryduh: is it a fresh vagrant box?
[2013-01-11 16:39:58 -0500] ryduh: http://hastebin.com/venelaromi.coffee
[2013-01-11 16:40:02 -0500] pwelch: I have found sometimes you need to run apt-get update
[2013-01-11 16:40:24 -0500] ryduh: do you know how I can do that automatically with vagrant?
[2013-01-11 16:40:33 -0500] ryduh: this is my Vagrantfile. http://hastebin.com/venelaromi.coffee
[2013-01-11 16:40:53 -0500] ryduh: do I need to make a new cookbook and recipe for that?
[2013-01-11 16:41:14 -0500] pwelch: you could use a vagrant inline script
[2013-01-11 16:41:20 -0500] pwelch: or include the opscode apt cookbook
[2013-01-11 16:41:21 -0500] pwelch: https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb
[2013-01-11 16:41:28 -0500] pwelch: add it to the top of the run_list
[2013-01-11 16:41:34 -0500] spox: yea
[2013-01-11 16:41:38 -0500] spox: use the apt cookbook
[2013-01-11 16:41:49 -0500] spox: you'll want to have your vagrant simulate a real node
[2013-01-11 16:41:49 -0500] ryduh: sweet
[2013-01-11 16:41:53 -0500] ryduh: thanks. i'll try it
[2013-01-11 16:41:55 -0500] pwelch: get that cookbook
[2013-01-11 16:41:57 -0500] spox: and you can't always make the assumption apt will be up-to-date
[2013-01-11 16:42:18 -0500] spox: so the apt cookbook will ensure it is no matter where you apply your runlist
[2013-01-11 16:42:19 -0500] pwelch: and add ` chef.add_recipe "apt" ` above the git cookbook
[2013-01-11 16:42:29 -0500] pwelch: what spox said
[2013-01-11 16:42:55 -0500] poseid: basically, this lines seems to cause my problem:  https://github.com/cookbooks/passenger_apache2/blob/master/attributes/default.rb#L3-L4
[2013-01-11 16:43:00 -0500] poseid: in a vagrant setup
[2013-01-11 16:44:11 -0500] spox: poseid: what is the problem you are seeing?
[2013-01-11 16:44:37 -0500] poseid:     ~/projects/chef/base-chef-solo/Vagrantfile:36:in `block (2 levels) in <top (required)>': undefined local variable or method `languages' for main:Object (NameError)
[2013-01-11 16:45:21 -0500] ryduh: my install moved on to installing mysql-client so I think that problem is fixed. thanks :)
[2013-01-11 16:46:08 -0500] spox: poseid: do you have the cookbook downloaded locally?
[2013-01-11 16:46:55 -0500] poseid: yes
[2013-01-11 16:47:03 -0500] poseid: ps my Vagrantfile is this: http://pastebin.com/6y097NLX
[2013-01-11 16:47:24 -0500] ryduh: If I add recipes to chef in my Vagrantfile, do I still need to add them to my run list to get them installed/run?
[2013-01-11 16:47:45 -0500] spox: try replacing `languages` with node.languages and see what you get
[2013-01-11 16:47:53 -0500] spox: i'm looking at the cookbook now in test-kitchen
[2013-01-11 16:50:32 -0500] poseid: ok
[2013-01-11 16:53:09 -0500] poseid: hmm.. since it's in the vagrant file... the only config.vm... type of object seem to be in the scope
[2013-01-11 16:53:37 -0500] poseid: can the Ruby path be captured in another manner ?
[2013-01-11 16:55:13 -0500] poseid: or maybe adding a "node" => "languages" hash?
[2013-01-11 16:56:03 -0500] spox: oh
[2013-01-11 16:56:04 -0500] poseid: ah.. this looks interesting too: http://stackoverflow.com/questions/14126122/chef-attribute-nodelanguages-vanishes-after-first-chef-client-run
[2013-01-11 16:56:30 -0500] poseid: hmm.. no that's chef client
[2013-01-11 16:57:42 -0500] spox: poseid: i don't believe your setup will work
[2013-01-11 16:57:46 -0500] spox: it's not the cookbook
[2013-01-11 16:57:55 -0500] spox: it's your vagrant setup
[2013-01-11 16:58:28 -0500] spox: vagrant is trying to convert your chef.json value into json to send to the new node
[2013-01-11 16:58:35 -0500] spox: languages won't be defined there
[2013-01-11 16:58:40 -0500] spox: you need to provide the full path
[2013-01-11 16:59:57 -0500] poseid: ok.. that would normally come from the cookbook attribute, or ?
[2013-01-11 17:01:19 -0500] spox: poseid: sorry, can you restate the question. i'm not sure i understand what you are asking.
[2013-01-11 17:02:23 -0500] poseid: I've tried this cookbook before with chef-server, and there the path was assembled from the attributes
[2013-01-11 17:02:28 -0500] poseid: at least what I understood
[2013-01-11 17:02:53 -0500] poseid: now, that's really nice, that there was some kind of default path.... for the cookbook
[2013-01-11 17:03:01 -0500] poseid: can I do this with chef-solo?
[2013-01-11 17:03:25 -0500] poseid: (default path for installing e.g. ruby gems ? )
[2013-01-11 17:04:09 -0500] poseid: this was the error that I was having before:  http://pastie.org/5669137
[2013-01-11 17:04:26 -0500] spox: okay, so when the chef-client loads the cookbook, the default attributes file sets defaults using information for the chef run (ohai data around the ruby language)
[2013-01-11 17:04:28 -0500] poseid: so, I thought I set the path in the chef_json in the vagrantfile
[2013-01-11 17:04:38 -0500] poseid: oh, ok!
[2013-01-11 17:04:43 -0500] spox: if you provide overrides, though, then you have to set the full path explicitly
[2013-01-11 17:05:25 -0500] spox: poseid: the problem with how you are setting the path in the vagrantfile is the ruby code is executed on your local machine, and the hash generated is turned into json and saved on the new node
[2013-01-11 17:05:48 -0500] spox: so it has no concept of the ohai data, or node, or any chef bits that your current json structure is assuming
[2013-01-11 17:06:03 -0500] poseid: i see... I also just ran the ohai command on the VM
[2013-01-11 17:07:00 -0500] poseid: hmm.. so, I can't use this cookbook, since it looks like I would need to use overrides ?
[2013-01-11 17:07:20 -0500] poseid: and chef-solo does maybe not provide override paths ?
[2013-01-11 17:07:43 -0500] spox: lets back up. why are you providing overrides currently?
[2013-01-11 17:07:55 -0500] spox: they look like they are the same values from the existing cookbook attributes
[2013-01-11 17:08:48 -0500] poseid: good idea
[2013-01-11 17:09:34 -0500] poseid: my goal was to have simple vagrantfile with basic ruby/rails setup
[2013-01-11 17:10:29 -0500] poseid: I saw the chef-solo code in the Vagrantfile
[2013-01-11 17:10:44 -0500] poseid: and I started from there.. to add recipes
[2013-01-11 17:10:55 -0500] spox: okay. well i don't see any need for the attribute overrides
[2013-01-11 17:11:03 -0500] spox: so how about just trying it with those removed
[2013-01-11 17:11:07 -0500] poseid: it's that my vagrant provision was having a problem
[2013-01-11 17:11:26 -0500] poseid: http://pastie.org/5669137
[2013-01-11 17:12:13 -0500] poseid: http://pastie.org/5669137
[2013-01-11 17:13:03 -0500] poseid: Recipe Compile Error in /tmp/vagrant-chef-1/chef-solo-1/cookbooks/passenger_apache2/recipes/default.rb
[2013-01-11 17:13:16 -0500] poseid: so, I was thinking adding attributes would fix it
[2013-01-11 17:14:59 -0500] spox: poseid: open up the passenger_apache2/recipes/default.rb file on your local machine
[2013-01-11 17:15:09 -0500] poseid: ok
[2013-01-11 17:15:18 -0500] spox: change line 36 to this:
[2013-01-11 17:15:20 -0500] spox: creates node[:passenger][:module_path]
[2013-01-11 17:15:33 -0500] spox: and then reprovision your solo node
[2013-01-11 17:16:14 -0500] poseid: ok
[2013-01-11 17:16:28 -0500] spox: you could also use the latest stable release instead
[2013-01-11 17:16:37 -0500] spox: if you cloned the git repo, you can do:
[2013-01-11 17:16:48 -0500] spox: git checkout 1.1.0
[2013-01-11 17:17:03 -0500] poseid: ah, ok
[2013-01-11 17:17:19 -0500] poseid: that's good to know.. also, I know where to start debugging now
[2013-01-11 17:17:29 -0500] poseid: ok... I'll check
[2013-01-11 17:19:04 -0500] poseid: super
[2013-01-11 17:19:13 -0500] poseid: 1.1.0 does the job!
[2013-01-11 17:19:14 -0500] poseid: thanks
[2013-01-11 17:19:21 -0500] spox: poseid: sure
[2013-01-11 17:19:24 -0500] queso: I created a chef-git user on my nodes and added an ssh key pair that can access our git server. What's the best way to pull now? Is there a way to clone a repository as root using the chef-git user's keys?
[2013-01-11 17:21:09 -0500] spox: queso: git resource
[2013-01-11 17:21:11 -0500] spox: queso: http://docs.opscode.com/chef/resources.html#scm
[2013-01-11 17:22:47 -0500] queso: spox: ty
[2013-01-11 17:23:52 -0500] KarlHungus: zomg. jenkins is CI'ing my cookbooks and uploading them for me. happy days are here again!
[2013-01-11 17:25:20 -0500] queso: spox: So that'll use the ssh keys of the user I specify?
[2013-01-11 17:25:56 -0500] pwelch: KarlHungus: havent got it uploading but have jenkins testing syntax and some chefspec
[2013-01-11 17:26:01 -0500] pwelch: its amazibg
[2013-01-11 17:26:49 -0500] mirkAfk_: KarlHungus:  We are preparing to do that sometime next week.  Any advise?
[2013-01-11 17:27:21 -0500] KarlHungus: pwelch: yep. completely awesome. i need to move jenkins over to a host with a fusion-io card and writing some vargrant tooling so test-kitchen can run integrations/acceptance next
[2013-01-11 17:27:55 -0500] KarlHungus: mkirk: use seth vargo's strainer to isolate cookbooks
[2013-01-11 17:29:04 -0500] pwelch: strainer is a must, especially if you have a single repo
[2013-01-11 17:29:40 -0500] pwelch: though chefspec is a horrible way to learn rspec :)
[2013-01-11 17:30:28 -0500] mkirk: We currently have individual repos for cookbooks.
[2013-01-11 17:30:46 -0500] KarlHungus: next goal (after test-kitchen) is to load the acceptance tests into nagios so things fail loadly when promoted to dev/qa/staging envs
[2013-01-11 17:31:21 -0500] KarlHungus: if its all working by next week maybe i'll do a lightning talk at devopsdays :P
[2013-01-11 17:38:44 -0500] zts: KarlHungus: that's backwards, submit a full talk then make it work
[2013-01-11 17:38:54 -0500] zts: KarlHungus: Conference Driven Development is the way forward
[2013-01-11 17:39:22 -0500] KarlHungus: LOL
[2013-01-11 17:40:55 -0500] poseid: ok.. see you
[2013-01-11 17:42:12 -0500] pwelch: zts: awesome idea
[2013-01-11 17:46:01 -0500] leifmadsen: hey all, I think it's a friday brain cramp thing, but I can't seem to figure out how to access the values in the mysql_connection_info inside the template when I pass things like this:  https://gist.github.com/4512616
[2013-01-11 17:46:27 -0500] leifmadsen: am I passing the value via the variables correctly? And how might I access in the template itself?
[2013-01-11 17:49:35 -0500] spox: leifmadsen: @conn_info ?
[2013-01-11 17:49:54 -0500] pwelch: leifmadsen: wouldnt you access it in the template as @conn_info[:host]
[2013-01-11 17:50:28 -0500] leifmadsen: pwelch: I tried that, and it was not valid/populated
[2013-01-11 17:50:33 -0500] leifmadsen: that's what I figured :)
[2013-01-11 17:51:58 -0500] zts: pwelch: I wish I could take credit for it, but I stole it from a friend (t0m/bobtfish)
[2013-01-11 17:52:14 -0500] zts: pwelch: he has used it successfully as a motivating factor, but YMMV :)
[2013-01-11 17:53:15 -0500] baz: hi guys, just set up my first install today, everything seems fine, no errors, but the run list isn't actually running
[2013-01-11 17:53:15 -0500] leifmadsen: pwelch: spox: oh interesting, I guess I thought I could use @conn_info['host'] but it needed to be :host
[2013-01-11 17:53:33 -0500] baz: no errors in /var/log/chef/client.log - where do I need to look first?
[2013-01-11 17:53:34 -0500] spox: leifmadsen: yes. hashes are just hashes
[2013-01-11 17:53:42 -0500] leifmadsen: spox: right, too used to accessing attributes :)
[2013-01-11 17:53:42 -0500] spox: if you created it via Mash instance, you would be able to use either
[2013-01-11 17:54:07 -0500] leifmadsen: spox: just for my own reference, how might that look?
[2013-01-11 17:54:20 -0500] leifmadsen: ruby skills are still lacking it appears
[2013-01-11 17:54:23 -0500] spox: my_mash = Mash.new(:fu => 'bar', :foo => 'bar')
[2013-01-11 17:54:32 -0500] spox: or, if you have an existing hash
[2013-01-11 17:54:33 -0500] baz: specifically I added a run list for my main chef server itself - using the community 'apt' cookbook to install the 'apt' and 'apt-cacher-ng' recipes
[2013-01-11 17:54:40 -0500] spox: my_mash = Mash.new(my_hash)
[2013-01-11 17:54:48 -0500] leifmadsen: spox: gotcha, thanks much
[2013-01-11 17:54:55 -0500] baz: the client log shows that the run list was processed, but the package isn't installed
[2013-01-11 17:57:13 -0500] tolland: the windows installer seems to hang at computing space requirements
[2013-01-11 17:57:36 -0500] tolland: fyi
[2013-01-11 17:57:55 -0500] queso: Using the scm resource with the git provider, I always end up with a "deploy" branch even though I am setting reference to a branch I want checked out. How can I make it stop creating a "deploy" branch and checking it out?
[2013-01-11 18:01:31 -0500] baz: guess I'll try puppet instead
[2013-01-11 18:02:03 -0500] spox: lol
[2013-01-11 18:02:10 -0500] spox: subtle troll is subtle
[2013-01-11 18:04:19 -0500] specialsauce: queso: i have the same issue
[2013-01-11 18:04:59 -0500] queso: specialsauce: I'm reading the deploy resource documentation now. Maybe there's a good reason for what it's doing. :)
[2013-01-11 18:05:53 -0500] specialsauce: queso: i think we need to specify "revision" on the git resource
[2013-01-11 18:06:17 -0500] queso: specialsauce: I think "revision" and "reference" do the same thing, but I'm not sure.
[2013-01-11 18:06:31 -0500] specialsauce: i don't know, i use reference and I have this issue
[2013-01-11 18:06:36 -0500] specialsauce: but i haven't tried with revision
[2013-01-11 18:06:56 -0500] maplebed: the docs say that reference is an alias for revision
[2013-01-11 18:06:58 -0500] specialsauce: docs.opscode.com is *so* much nicer than the old docs
[2013-01-11 18:07:31 -0500] queso: specialsauce: Perhaps the resource is "hard-coded" to not allow this default behavior to be overrided. Seems strange because that's not what git clone does.  I just want the equivalent of `git clone --branch ...`.
[2013-01-11 18:07:45 -0500] specialsauce: queso, yeah likewise
[2013-01-11 18:08:00 -0500] maplebed: queso: are you using the 'depuloy' or 'git' resource?
[2013-01-11 18:08:09 -0500] maplebed: s/depuloy/deploy/
[2013-01-11 18:08:09 -0500] queso: maplebed: git
[2013-01-11 18:08:36 -0500] specialsauce: maplebed, likewise i'm using git resource
[2013-01-11 18:11:09 -0500] queso: specialsauce: If I figure something out, I'll let you know. No promises though. :)
[2013-01-11 18:11:25 -0500] maplebed: I think I found it.
[2013-01-11 18:11:36 -0500] maplebed: it's cloning the revision you want into a new local branch named 'deploy'
[2013-01-11 18:11:48 -0500] maplebed: 160           shell_out!("git checkout -b deploy #{sha_ref}", run_options(:cwd => @new_resource.destination))
[2013-01-11 18:11:59 -0500] specialsauce: github ftw
[2013-01-11 18:12:19 -0500] queso: maplebed: That's quite an assumption for chef to make.
[2013-01-11 18:12:45 -0500] maplebed: I mean, why would you ever want the local branch named the same as the branch you're checking out?
[2013-01-11 18:12:48 -0500] maplebed: srsly.
[2013-01-11 18:12:58 -0500] specialsauce: hehe
[2013-01-11 18:13:11 -0500] queso: maplebed: You're kidding?
[2013-01-11 18:13:50 -0500] specialsauce: pretty screwy behaviour
[2013-01-11 18:14:17 -0500] specialsauce: guess i can fork, change and request a merge?
[2013-01-11 18:14:30 -0500] maplebed: heh...  yeah, I'd prefer to have the local branch named the same as what I'm checking out, but for my current use, I actually don't care so much.  So long as the revision is correct, meh.
[2013-01-11 18:14:54 -0500] queso: maplebed: It makes it impossible to go on the server and determine what branch is being tracked.
[2013-01-11 18:15:23 -0500] maplebed: ehh...  git will still tell you what it's tracking, won't it?
[2013-01-11 18:15:24 -0500] queso: maplebed: And it makes it impossible to manually pull, without checking the recipe to see what branch needs to be pulled.
[2013-01-11 18:15:50 -0500] maplebed: hmm..  nm, that's only if you manually tell it to track that branch.
[2013-01-11 18:16:29 -0500] queso: maplebed: How do you tell it to track that branch?  It does create the branch you want to track, but if there happen to be others, then there's no way to know.
[2013-01-11 18:16:56 -0500] maplebed: http://gitready.com/beginner/2009/03/09/remote-tracking-branches.html
[2013-01-11 18:17:01 -0500] specialsauce: i thought all those "assumptions" were all sourced from .git/config?
[2013-01-11 18:17:56 -0500] queso: maplebed: Right, it adds a "tracking" branch. But when I ssh to the server there could have been other branches added for tracking.
[2013-01-11 18:20:34 -0500] cosmic_cat: HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden
[2013-01-11 18:20:59 -0500] cosmic_cat: This client is not authorized to read some of the information required to access it's cookbooks
[2013-01-11 18:21:17 -0500] cosmic_cat: any helpful folks out there seen this error before?
[2013-01-11 18:24:38 -0500] maplebed: queso: what I was thikning is that if the git checkout in the recipe included --track, then git pull would work correctly, and when you run git branch with some flag it would tell you what it's tracking.
[2013-01-11 18:25:31 -0500] maplebed: though I would also support naming the local branch the same as the remote instead of 'deploy'.
[2013-01-11 18:25:54 -0500] maplebed: (maybe in addition!  or automatically setting branch.autosetupmerge)
[2013-01-11 18:28:18 -0500] queso: maplebed: It sets clones from the branch you specify and tracks that branch, but then creates a new branch named "deploy" which references the same hash as the branch you specify. The resource should have a deploy_branch option that defaults to "deploy" but that if set to nil would not create a new branch. That would remove this problem.
[2013-01-11 18:29:34 -0500] queso: maplebed: I'm not sure the benefit of creating a "deploy" branch and the documentation doesn't say why or even (clearly) that it does this.
[2013-01-11 18:29:36 -0500] maplebed: I think you may be confusing clone and checkout.
[2013-01-11 18:29:44 -0500] maplebed: (either that or I am...  ;) )
[2013-01-11 18:30:11 -0500] queso: maplebed: checkout -b branchname creates a new branch at the same location as the currently checked-out branch.
[2013-01-11 18:30:46 -0500] kallistec: queso: it uses a separate branch with hard resets to get you on the right rev regardless of whether history has been edited, etc
[2013-01-11 18:31:07 -0500] kallistec: the other option to accomplish this is to be totally headless
[2013-01-11 18:32:09 -0500] maplebed: it's not just running checkout -b though, which would do as you describe.  it's running git checkout -b deploy #{sha_ref}, which will create the local 'deploy' branch at #{sha_ref} rather than your currently checkout out branch.
[2013-01-11 18:32:47 -0500] maplebed: the clone just gets the whole repo, without info about revision.
[2013-01-11 18:32:52 -0500] queso: And what if I want to name my deployable branch in my repository "deploy"?
[2013-01-11 18:33:31 -0500] maplebed: the local deploy branch, as created by the chef recipe, won't conflict with a branch named 'deploy' that you may have in the repository from which it was cloned.
[2013-01-11 18:33:42 -0500] maplebed: (it'll just be confusing.)
[2013-01-11 18:33:47 -0500] queso: kallistec: But, okay, I suppose that's a legitimate reason to create a new branch. But it could refrain from doing this if you don't specify a hash.
[2013-01-11 18:35:19 -0500] queso: But I guess this is related to my wondering if Chef should be used merely to deploy apps or also to update them..
[2013-01-11 18:36:20 -0500] maplebed: If I'm reading it right, the chef recipe will update the repo to the current state of the branch you specify
[2013-01-11 18:36:26 -0500] maplebed: it just doesn't use 'git pull' to do so
[2013-01-11 18:36:51 -0500] maplebed: it gets the ref for the current commit the remote branch points to and resets to that revision.
[2013-01-11 18:37:04 -0500] queso: maplebed: yeah, but *I* might want to use git pull :) I guess it's not a big deal. I could just execute the command to check out the branch again.
[2013-01-11 18:37:41 -0500] maplebed: the summary, so far as i can tell - so long as only chef manages the repo, the way it's written will work just fine.  If you also want to muck in the repo by hand (eg git pull), it's broken.
[2013-01-11 18:38:01 -0500] queso: maplebed: Right.
[2013-01-11 18:38:45 -0500] queso: maplebed: I'll be going through this next, and maybe then everything will make sense: http://docs.opscode.com/resource_deploy.html
[2013-01-11 18:38:54 -0500] maplebed: there's another option (to muck with it locally)
[2013-01-11 18:39:04 -0500] maplebed: instead of using git pull, do the update the same way the provider does:
[2013-01-11 18:39:11 -0500] maplebed: git fetch #{@new_resource.remote} && git fetch #{@new_resource.remote} --tags && git reset --hard #{target_revision}
[2013-01-11 18:41:29 -0500] maplebed: the deploy resource is likely not what you want, if all you want is a git checkout.  The deploy resource does the whole revision shared current thing, with timestampted revision checkouts and current symlinking to the current choice.
[2013-01-11 18:41:34 -0500] maplebed: (much like capistrano)
[2013-01-11 18:42:04 -0500] queso: maplebed: I'm reading some capistrano docs now trying to understand what it's doing so I can decide if it's a good thing. :)
[2013-01-11 18:43:00 -0500] queso: maplebed: In the past I have written my own upgrade scripts so I'm not familiar with capistrano's practices.
[2013-01-11 18:44:16 -0500] kallistec: queso: you can update apps with chef, that's how we do it--sometimes w/ deploy resource, sometimes w/ git resource and some notifies
[2013-01-11 18:44:26 -0500] kallistec: just use action :sync
[2013-01-11 18:46:05 -0500] queso: kallistec: Okay, thanks. Do you also use it for database migrations, etc.?
[2013-01-11 18:46:51 -0500] kallistec: no, we have those scripted but initiate them manually
[2013-01-11 18:48:18 -0500] queso: kallistec: So manially initiate database upgrades and then run Chef to upgrade your apps if the database migrations are successful?
[2013-01-11 18:49:09 -0500] queso: s/manially/manually/
[2013-01-11 18:49:19 -0500] kallistec: more or less, the actual details vary depending on the migration, e.g., there can be code changes before and after sometimes, etc.
[2013-01-11 18:49:55 -0500] queso: kallistec: Right, okay, thanks. I've only been using Chef for a week so there's a lot to put together.
[2013-01-11 18:50:05 -0500] maplebed: kallistec: how do you handle rollbacks?
[2013-01-11 18:50:57 -0500] kallistec: maplebed: we keep the app version (git tag) in a data bag that we version control with git
[2013-01-11 18:51:14 -0500] maplebed: makes sense.
[2013-01-11 18:51:29 -0500] kallistec: if a deploy goes south, we revert the data bag change, upload with the old version, run chef
[2013-01-11 18:52:53 -0500] ryduh: I'm trying to create a dev environment with vagrant/chef. We pull from a private git repo with different users. what's the best way to allow whoever has access to enter their own ssh username and pw (we access git over ssh)?
[2013-01-11 18:53:17 -0500] maplebed: ryduh: use ssh keys and agents.
[2013-01-11 18:54:58 -0500] ryduh: with config.ssh.forward_agent = true
[2013-01-11 18:55:00 -0500] ryduh: ?
[2013-01-11 18:56:45 -0500] tomdzk: ryduh: yep, though that will only work for the vagrant user iirc
[2013-01-11 18:57:14 -0500] ryduh: like if I have a vagrant user on my host system and guest?
[2013-01-11 18:57:28 -0500] tomdzk: no, the vagrant user in the VM (which is set up automatically)
[2013-01-11 18:59:28 -0500] tomdzk: ryduh: you can easily try this out: enable config.ssh.forward_agent, then ssh to the VM, then do a git clone as the vagrant user (this should work), then do a git clone as e.g. the root user in the VM which will likely fail
[2013-01-11 18:59:53 -0500] littonj: does anyone know if there is a good way to determine the version of a databag that has been actually used on run on a node? I'm trying to come up with a way to verify the status of user account changes managed in the users data bag
[2013-01-11 19:06:06 -0500] knuckolls: littonj: are you hoping to see that the user info changes correctly after you upload a new version of a user databag?
[2013-01-11 19:06:27 -0500] geekbri: Did hosted chef just get hosed by any chance?
[2013-01-11 19:06:58 -0500] knuckolls: geekbri: knife status returned an error for me, so yes?
[2013-01-11 19:07:05 -0500] geekbri: knuckolls: same :)
[2013-01-11 19:07:08 -0500] maplebed: me too.
[2013-01-11 19:07:13 -0500] geekbri: its throwing 404's
[2013-01-11 19:07:18 -0500] knuckolls: cool.
[2013-01-11 19:07:29 -0500] geekbri: I was in the middle of testing launching a new server and I thought, DAMNIT I SCREWED UP AGAIN
[2013-01-11 19:07:37 -0500] geekbri: then i was like, wait, this error isn't something _I_ did wrong!
[2013-01-11 19:10:45 -0500] sunil_: Anyone know whats going on with opscode api? it seems to be down again today
[2013-01-11 19:11:26 -0500] mrchoey: +1 to issues, getting very strange html responses back
[2013-01-11 19:11:32 -0500] cwj: +1
[2013-01-11 19:12:10 -0500] fromonesrc: did a load balancer blow? people are getting 404s on pages while others are not
[2013-01-11 19:12:11 -0500] geekbri: +1 to my issues
[2013-01-11 19:12:21 -0500] geekbri: me english bad
[2013-01-11 19:12:51 -0500] konopka: 404'in
[2013-01-11 19:13:06 -0500] stephenlauck: anyone else having hosted chef problems?
[2013-01-11 19:13:25 -0500] geekbri: mmhhmmmm
[2013-01-11 19:13:28 -0500] maplebed: stephenlauck: widespread.
[2013-01-11 19:13:35 -0500] stephenlauck: all week....
[2013-01-11 19:13:52 -0500] stephenlauck: good time to work on chef server internal i guess
[2013-01-11 19:15:02 -0500] sunil_: this has been a rough week for sure.
[2013-01-11 19:15:06 -0500] pwelch: 404 here as well
[2013-01-11 19:15:24 -0500] jtimberman: https://twitter.com/opscode_status/status/289812347671957505
[2013-01-11 19:16:35 -0500] jtimberman: should be back to normal now
[2013-01-11 19:16:41 -0500] stephenlauck: thanks jtimberman
[2013-01-11 19:16:43 -0500] pwelch: jtimberman: thanks
[2013-01-11 19:17:21 -0500] konopka: smooth sailing now, thanks!
[2013-01-11 19:21:55 -0500] autolykos: hi everybody
[2013-01-11 19:22:09 -0500] autolykos: I have a problem with encrypted data bags
[2013-01-11 19:22:13 -0500] autolykos: and I hope someone can help
[2013-01-11 19:22:35 -0500] autolykos: as I am running out of ideas
[2013-01-11 19:22:59 -0500] kallistec: Hey everyone. If you run your own chef-server, you should upgrade it right away: http://www.opscode.com/blog/2013/01/11/chef-10-16-6-security-release/
[2013-01-11 19:23:17 -0500] autolykos: cool
[2013-01-11 19:23:35 -0500] autolykos: basically I put my id_rsa in an encrypted data bag
[2013-01-11 19:23:53 -0500] autolykos: without passphrase
[2013-01-11 19:24:00 -0500] autolykos: I provision my vagrant VM with such key
[2013-01-11 19:24:09 -0500] autolykos: and I can see it is decrypted correctly
[2013-01-11 19:24:23 -0500] autolykos: but when I ssh to some other machine it asks for a passphrase
[2013-01-11 19:24:27 -0500] autolykos: I nevere set
[2013-01-11 19:24:35 -0500] autolykos: any clue anyone?
[2013-01-11 19:25:07 -0500] tomdzk: autolykos: are you sure it asks for a passphrase (as opposed to a password) ?
[2013-01-11 19:25:12 -0500] autolykos: yes
[2013-01-11 19:25:28 -0500] tomdzk: run ssh with -vvv to see what key the passphrase is for
[2013-01-11 19:25:53 -0500] autolykos: good idea
[2013-01-11 19:27:45 -0500] autolykos: Enter passphrase for key '/home/vagrant/.ssh/id_rsa':
[2013-01-11 19:27:52 -0500] autolykos: the key is for id_rsa
[2013-01-11 19:27:56 -0500] maplebed: try loading that key on its own,
[2013-01-11 19:28:05 -0500] maplebed: just to verify.
[2013-01-11 19:28:05 -0500] autolykos: I already did that
[2013-01-11 19:28:16 -0500] autolykos: scp'ing the key from the original machine works fine
[2013-01-11 19:28:23 -0500] tomdzk: autolykos: try a different name for the key
[2013-01-11 19:28:30 -0500] tomdzk: vagrant itself sets up ssh keys
[2013-01-11 19:28:37 -0500] tomdzk: so you might conflict with that
[2013-01-11 19:28:44 -0500] autolykos: it does not
[2013-01-11 19:28:57 -0500] autolykos: if I simply scp the key form the machine I took it
[2013-01-11 19:29:07 -0500] autolykos: it does not ask for any passphrase
[2013-01-11 19:29:59 -0500] tomdzk: autolykos: you could also diff the deployed key vs. your manually uploaded one, and verify permissions
[2013-01-11 19:30:09 -0500] programmerq: so, I'm trying to do a vagrant multi-vm setup. I'd like the first vm to install chef, and then use vagrant's chef-client provisioner with that newly created chef server. Has anyone ever done this before?
[2013-01-11 19:30:14 -0500] FarmKing: should "knife cookbook upload --all" replace templates on the chef server?
[2013-01-11 19:30:20 -0500] tomdzk: autolykos: and maybe check the ssh agent in the vm
[2013-01-11 19:30:26 -0500] autolykos: @tomdzk permissions are the same
[2013-01-11 19:30:33 -0500] autolykos: @tomdzk key is the same
[2013-01-11 19:30:42 -0500] tomdzk: programmerq: I have, it is complicated :)
[2013-01-11 19:31:05 -0500] autolykos: if I `cat' it I can see the key without passphrase
[2013-01-11 19:31:26 -0500] autolykos: running ssh -vvv shows
[2013-01-11 19:31:28 -0500] autolykos: debug1: key_parse_private_pem: PEM_read_PrivateKey failed
[2013-01-11 19:31:30 -0500] programmerq: tomdzk: do you mind sharing your vagrantfile?
[2013-01-11 19:31:31 -0500] slauck:  INFO: Received exception (500) attempting to generate run history id
[2013-01-11 19:31:58 -0500] tomdzk: programmerq: sorry, can't really, lots of work stuff
[2013-01-11 19:32:05 -0500] tomdzk: programmerq: but I can give you some hints
[2013-01-11 19:32:29 -0500] tomdzk: programmerq: first, you'll want to use the shell provisioner to set up the chef server
[2013-01-11 19:32:39 -0500] konopka: autolykos: i've gotten the passphrase prompt when my key was inadvertently truncated
[2013-01-11 19:32:42 -0500] programmerq: I've done that, and I have a running chef server
[2013-01-11 19:32:53 -0500] programmerq: I'm at the point where I need to pull the validation.pem
[2013-01-11 19:33:08 -0500] tomdzk: programmerq: that script should also copy the validation.pem and webui.pem into the /vagrant folder
[2013-01-11 19:33:16 -0500] autolykos: @konopka I'll try to diff the 2 keys once again to rule out
[2013-01-11 19:33:27 -0500] tomdzk: programmerq: this allows the chef provider to use them
[2013-01-11 19:33:46 -0500] tomdzk: programmerq: I've also found it useful to setup a chef client on the chef server VM
[2013-01-11 19:34:08 -0500] bear: is anyone else having 404 issues for that security blog post?
[2013-01-11 19:34:42 -0500] programmerq: tomdzk: I'm not familiar with the /vagrant folder and how that makes it so I can have the provider use the keys. do I have to set up file sharing?
[2013-01-11 19:35:03 -0500] tomdzk: programmerq: vagrant automatically mounts the folder containing the Vagrantfile, into the VM under /vagrant
[2013-01-11 19:35:11 -0500] programmerq: that's cool
[2013-01-11 19:35:38 -0500] programmerq: (I'm still pretty new to vagrant)
[2013-01-11 19:35:46 -0500] programmerq: that'll help me a lot. Thanks!
[2013-01-11 19:36:07 -0500] autolykos: @konopka when I put the id_rsa in the json data bag I get rid of the '\r\n', can it be that?
[2013-01-11 19:36:12 -0500] mattt: bear: loads fo rme
[2013-01-11 19:36:31 -0500] konopka: autolykos: yup that'd do it
[2013-01-11 19:36:35 -0500] bear: bah - let me try another browser and try to force reload it
[2013-01-11 19:36:47 -0500] konopka: i put in \n in the json and it worked
[2013-01-11 19:36:52 -0500] mattt: bear: you talking about http://www.opscode.com/blog/2013/01/11/chef-10-16-6-security-release/ right ?
[2013-01-11 19:36:59 -0500] bear: mattt - yes
[2013-01-11 19:37:29 -0500] tomdzk: autolykos: when you use knife data bag show, then it should show a proper ssh keys with newlines and everything; if it doesn't then you have truncation issues
[2013-01-11 19:40:15 -0500] aldous: Hey everyone, I was having a trouble using ssh_wrapper with the deploy resource and would love to pick someone's brain about it
[2013-01-11 19:43:17 -0500] FarmKing: can anyone think of a reason templates would not be updated from my workstation to the server with "knife cookbook upload --all"?
[2013-01-11 19:43:46 -0500] aldous: isn't hosted chef down right now?
[2013-01-11 19:44:54 -0500] FarmKing: aldous: that would be a reason
[2013-01-11 19:45:07 -0500] FarmKing: knife completes successfully though
[2013-01-11 19:45:37 -0500] maplebed: it came back (for me at least)
[2013-01-11 19:46:15 -0500] Holos: Is there a way to get a chef shell when I can pull in databags and test loops and stuff?
[2013-01-11 19:46:55 -0500] Holos: I am new to ruby, so I wanted to gets my code and make sure it's going to work as I code it, instead of trying to write it all, send it to a dev box and pray it works
[2013-01-11 19:47:13 -0500] maplebed: Holos: shef -z (or chef-shell depending on your version) will do taht.
[2013-01-11 19:47:26 -0500] maplebed: also, irb is a good tool for trying out rubyish stuff.
[2013-01-11 19:48:59 -0500] cwj: seems like Chef::Config[:client] evals to true in shef -z, but not when i run the same recipe code in chef-client
[2013-01-11 19:49:06 -0500] cwj: anyone seen that behavior?
[2013-01-11 19:49:17 -0500] FarmKing: turns out that I needed to set --cookbook-path cookbooks/
[2013-01-11 19:50:19 -0500] programmerq: tomdzk: do you have your vagrantfile do a knife configure? If so, do you just system() out to run the knife commands?
[2013-01-11 19:50:32 -0500] tjstum: Why would the execute resource not look through PATH? (and no, the path attribute isn't set)
[2013-01-11 19:50:56 -0500] tomdzk: programmerq: to setup a chef client on the chef server VM ?
[2013-01-11 19:51:29 -0500] programmerq: tomdzk: no, I basically want to be able to do "knife node" or "knife cookbook upload" from the workstation
[2013-01-11 19:51:33 -0500] Toger: When I execute knife ssh 'query that returns 300 hosts' 'sleep 60', occasionally knife fails to return.  netstat shows about 300 connections in ESTABLISHED state to port 22 to the destinations, and none in a suspect state like SYN_SENT or anything like that. Any idea why this might be? 10.4 on centos 5.5.
[2013-01-11 19:52:01 -0500] tomdzk: programmerq: you can just use knife configure as usual
[2013-01-11 19:52:24 -0500] programmerq: tomdzk: right, but I'd like my vagrantfile to leave me with a working knife file when I do vagrant up
[2013-01-11 19:52:38 -0500] programmerq: I suspect I should just be able to call "system" inline in a vagrantfile
[2013-01-11 19:52:42 -0500] Toger: ruby 1.8.7 as well.
[2013-01-11 19:53:43 -0500] Toger: I didn't see anything in tickets.opscode.com that seems related.
[2013-01-11 19:54:45 -0500] tomdzk: programmerq: with recent chef versions (10.16.x) you can script knife to completely register as a client without any user interaction (see http://tickets.opscode.com/browse/CHEF-3455)
[2013-01-11 19:55:21 -0500] Death_Syn: hooray security update notifications via twitter
[2013-01-11 19:56:03 -0500] programmerq: tomdzk: so it's just a knife configuration I need to do, and I don't need to do any crazy command calling from inside vagrantfile.
[2013-01-11 19:56:05 -0500] programmerq: nice
[2013-01-11 19:56:17 -0500] programmerq: especially since my test to call system from the vagrant file shows that it totally doesn't work. :)
[2013-01-11 19:57:48 -0500] tomdzk: programmerq: I setup a chef client within the VM so I can just use vagrant provision to update cookbooks, data bags, ... - for this my setup script does all the knife calls, and I have vagrant mount my cookbooks folder into the VM
[2013-01-11 19:58:09 -0500] tomdzk: programmerq: that has the benefit that it doesn't mess with the knife.rb on the host
[2013-01-11 19:58:28 -0500] tomdzk: (outside of the VM)
[2013-01-11 19:59:09 -0500] programmerq: hmmm
[2013-01-11 19:59:26 -0500] programmerq: we've been using knife block to switch between our stacks
[2013-01-11 19:59:40 -0500] programmerq: and I was hoping to basically be able to do "knife block vagrant"
[2013-01-11 19:59:49 -0500] programmerq: after running a vagrant up
[2013-01-11 19:59:51 -0500] programmerq: and have it work
[2013-01-11 20:00:09 -0500] programmerq: but now that I know about /vagrant
[2013-01-11 20:00:20 -0500] programmerq: it might be fine to do it all inside the vm
[2013-01-11 20:00:40 -0500] tomdzk: programmerq: either would work, though then you'll to manually upload cookbooks
[2013-01-11 20:00:56 -0500] programmerq: I'm just putting my vagrantfile inside my chef-repo
[2013-01-11 20:01:02 -0500] programmerq: so all that's right there
[2013-01-11 20:01:08 -0500] programmerq: inside /vagrant
[2013-01-11 20:01:27 -0500] programmerq: oh, I see what you're saying
[2013-01-11 20:01:36 -0500] programmerq: yeah, but I have to upload cookbooks to my other environments too
[2013-01-11 20:01:45 -0500] programmerq: so it'd mimic those fairly nicely
[2013-01-11 20:01:56 -0500] tomdzk: programmerq: sure, but for testing I've found it very nice to just do 'vagrant provision'
[2013-01-11 20:02:40 -0500] programmerq: if I find a way to run commands locally instead of on the VM, I'd get the same functionality
[2013-01-11 20:02:52 -0500] programmerq: just a different implementation
[2013-01-11 20:03:02 -0500] programmerq: but it looks like that's not going to be super clean to run things locally
[2013-01-11 20:03:09 -0500] tomdzk: programmerq: yeah :)
[2013-01-11 20:03:28 -0500] programmerq: I'd have to write my own provisioner
[2013-01-11 20:03:32 -0500] tomdzk: programmerq: ?
[2013-01-11 20:04:18 -0500] programmerq: instead of the Shell provisioner, I'd need LocalShell that runs commands locally rather than on the vagrant vm
[2013-01-11 20:04:39 -0500] programmerq: and that seems crazy enough that I should reconsider my whole approach, and just expect to run knife inside vagrant.
[2013-01-11 20:04:44 -0500] tomdzk: programmerq: on the host ? the Vagrantfile is plain ruby, you can use system or %x to your hearts content
[2013-01-11 20:05:20 -0500] programmerq: I just tried putting some system blocks where I wanted them to execute
[2013-01-11 20:05:21 -0500] autolykos: @konopka: thanks a lot, that was the problem
[2013-01-11 20:05:30 -0500] programmerq: but they execute immediately, and not where they appear in the vagrant file
[2013-01-11 20:05:34 -0500] tomdzk: programmerq:  though it might be a bit confusing as the code is evaluatd even running status
[2013-01-11 20:06:02 -0500] blitzrage: tomdzk: sounds like we've had the same approach. Load up a chef server with vagrant and use chef_solo to deploy the chef server, then use knife inside the VM to import the cookbooks, roles etc, via knife
[2013-01-11 20:06:05 -0500] tomdzk: programmerq: but if you want to run things locally, I would not use vagrant
[2013-01-11 20:06:08 -0500] programmerq: I'm guessing that has something to do with the fact that vagrantfile is just a config file.
[2013-01-11 20:06:29 -0500] programmerq: which totally makes sense
[2013-01-11 20:06:32 -0500] tomdzk: programmerq: well no, it is actual code that gets executed for every vagrant invocation
[2013-01-11 20:06:34 -0500] programmerq: yeah, knife inside vm is what I want now
[2013-01-11 20:06:58 -0500] tomdzk: blitzrage: yep
[2013-01-11 20:07:03 -0500] programmerq: tomdzk: of course, I understand that it is actual code, but it appears to be code that simply builds configuration
[2013-01-11 20:07:04 -0500] blitzrage: I created a whole cookbook that does the loading of the data
[2013-01-11 20:07:15 -0500] programmerq: and vagrant takes that config and goes and does the stuff it's been configured to do
[2013-01-11 20:07:41 -0500] tomdzk: programmerq: another benefit of knife inside of the server VM is that you can make chef server manage itself which is useful for applying recipes to it
[2013-01-11 20:07:52 -0500] konopka: autolykos: great
[2013-01-11 20:08:17 -0500] tomdzk: programmerq: e.g. I use vagrant to test our chef server backup + restore (which are recipes)
[2013-01-11 20:08:50 -0500] programmerq: tomdzk: it just boils down to the fact that we were hoping to mimic our other non-vagrant stacks as much as possible, and we run knife on our workstation instead of on the chef server. That's all. no big deal running knife inside vagrant for our vagrant stack though.
[2013-01-11 20:13:02 -0500] jhayden: I have a quick security question. I am running chef 10.16.2
[2013-01-11 20:13:28 -0500] jhayden: does chef have any exposure to the recent RoR security vulnerability?
[2013-01-11 20:13:51 -0500] tomdzk: jhayden: http://www.opscode.com/blog/2013/01/11/chef-10-16-6-security-release/
[2013-01-11 20:14:30 -0500] cwj: am i correct in assuming Chef::Config[:client] and/or Chef::Config.client should eval to true when run in chef-client?
[2013-01-11 20:14:34 -0500] jhayden: @tomdzk excellent! Thank you
[2013-01-11 20:14:41 -0500] cwj: because it seems to in shef -z but not when i run my recipe in chef-client
[2013-01-11 20:16:57 -0500] queso: Can an existing open source chef server just be reprovisioned to upgrade it?
[2013-01-11 20:19:30 -0500] queso: Or, what is the appropriate way to upgrade it?
[2013-01-11 20:20:25 -0500] tomdzk: queso: if it is managing itself (e.g. the chef server is a node and has the appropriate chef-server recipe in its run list), then you should just be able to upgrade it as you would any other service
[2013-01-11 20:20:46 -0500] queso: tomdzk: Ah, nice. Thanks.
[2013-01-11 20:22:11 -0500] tomdzk: queso: I haven't tried that yet though :)
[2013-01-11 20:22:57 -0500] fromonesrc: anyone else getting bootstrap failures "Temporary failure resolving 'archive.ubuntu.com'"?
[2013-01-11 20:23:00 -0500] aldous: Hey guys, I made a gist of my ssh_wrapper deploy issue https://gist.github.com/4513637 I would love anyone's help.
[2013-01-11 20:23:10 -0500] fromonesrc: getting this consistently
[2013-01-11 20:23:34 -0500] fromonesrc: not a chef problem I know...
[2013-01-11 20:24:02 -0500] cwj: aldous: is git installed? :)
[2013-01-11 20:24:30 -0500] aldous: why am I so embarrassing
[2013-01-11 20:25:12 -0500] cwj: aldous: if you knew how many times i have forgotten that part
[2013-01-11 20:31:25 -0500] jkyle: so, rake databag:upload_all doesn't seem to upload all data bags. it skips some
[2013-01-11 21:06:02 -0500] jtimberman: Opscode cookbook code review starting now. Hangout: https://plus.google.com/hangouts/_/2ee1d376762ed700ca4c481c8db6ea98f51cba47 Youtube stream: http://youtu.be/DoEvdDKdE5U
[2013-01-11 21:08:21 -0500] blitzrage: jtimberman: I'd like to request to have COOK-2208 added to the list of reviews
[2013-01-11 21:08:24 -0500] blitzrage: unless that is defined ahead of time
[2013-01-11 21:21:21 -0500] jwitrick: quick question is there a way to from with in a conditional execution block to call another chef resource. I.e. If I only wanted a resource x to run if the service y is running. Unfortunately notifications from the y service will not work.
[2013-01-11 21:22:41 -0500] pwelch: Are code reviews free for anyone to jump in?
[2013-01-11 21:27:08 -0500] mattray: pwelch: yes
[2013-01-11 21:30:11 -0500] leifmadsen: is it par for the course to transition your own issue in the ticketing system? e.g. set to Fix Provided?
[2013-01-11 21:30:17 -0500] leifmadsen: or should I allow someone else to triage the issue?
[2013-01-11 21:31:53 -0500] leifmadsen: well, I set my own issue to Fix Provided (as I did) and we'll see if I get scolded ;)
[2013-01-11 21:31:57 -0500] mattray: leifmadsen: if you've got a fix, please set it.
[2013-01-11 21:32:01 -0500] leifmadsen: done
[2013-01-11 21:32:05 -0500] leifmadsen: mattray: thanks
[2013-01-11 21:32:38 -0500] leifmadsen: still unsure on exactly the preferred transition process in chef (every project has their own preference)
[2013-01-11 21:34:34 -0500] Holos: Anyone use node.domain on Chef 10 for windows to determine your domain name? I have a data bag that sets the value of a server dependant on the domain. When I use db['server']['domain'
[2013-01-11 21:35:06 -0500] Holos: ] I get a "Cannot find resource for domain on windows 6.0.6002" but node.domain exists in Chef webgui
[2013-01-11 21:37:01 -0500] Holos: sorry, that is db = data_bag_item("bag","item") ; node.set['test-server'] = db['server'][node.domain]
[2013-01-11 21:39:35 -0500] dyer: Sanity check guys, if I have a recipe called Phono and another called Prism.  Phono includes Prism via include_recipe and in its attributes file called "include_attribute "prism", but it still appears to be loading attributes in alphabetical ordering
[2013-01-11 21:39:57 -0500] dyer: Shouldnt include_attribute prism force Prism to be loaded before Phono ?
[2013-01-11 21:40:06 -0500] dyer: Chef 10.16.2
[2013-01-11 21:43:46 -0500] cwj: dyer: attribute load order is non-deterministic until chef 11
[2013-01-11 21:43:49 -0500] cwj: dyer: http://tickets.opscode.com/browse/CHEF-2903
[2013-01-11 21:44:10 -0500] cwj: unless someone backports to 10.x
[2013-01-11 21:44:21 -0500] dyer: wow, that really sucks
[2013-01-11 21:49:47 -0500] peat: Hello everyone. Question about environments. I can show a node and see it's environment (eg: knife node show mynode), but it doesn't show up in a node search (eg: knife search node "*:*"). I'm not really sure where to start debugging this. Any helpful pointers? :)
[2013-01-11 21:50:13 -0500] peat: Sorry, search query is "chef_environment:*"
[2013-01-11 21:56:21 -0500] xmltok: ive had to tweak some setting in search for it to find my nodes, it was because some fields were too long, or i had too many nodes, something like that
[2013-01-11 21:56:30 -0500] xmltok: stuff would be randomly missing
[2013-01-11 21:57:16 -0500] peat: Oof. Well, I did a 'knife index rebuild' and now everything is gone from the search ... although 'knife node list' is still rational.
[2013-01-11 21:58:37 -0500] xmltok: this was mine, http://tickets.opscode.com/browse/CHEF-2346
[2013-01-11 21:58:42 -0500] zts: peat: wild guess, but check whether chef-expander has died on your chef server
[2013-01-11 21:59:06 -0500] peat: zts: ahh, alright. What service does chef-expander provide?
[2013-01-11 22:00:05 -0500] zts: peat: it's responsible for taking requests to update stuff in search, and actually feeding them into solr.  I seem to recall that you can empty solr without it (the first part of 'knife index rebuild'), but you need it to repopulate the index
[2013-01-11 22:00:29 -0500] peat: Perfect. :D One moment.
[2013-01-11 22:00:33 -0500] zts: peat: so assuming I'm correctly remembering how that fits together, that's where I'd start looking :)
[2013-01-11 22:00:53 -0500] zts: peat: xmltok's ticket is also well worth reading, as that problem bites a lot of people
[2013-01-11 22:01:48 -0500] dyer: cwj, so what is the point of include_attribute if they are loaded non-deterministically  ?
[2013-01-11 22:02:00 -0500] cwj: dyer: you've got me :)
[2013-01-11 22:02:02 -0500] dyer: lol
[2013-01-11 22:02:03 -0500] dyer: love it
[2013-01-11 22:02:36 -0500] peat: Hmm. Restarted expander and solr, no dice. Diving into the ticket.
[2013-01-11 22:02:37 -0500] cwj: i had a problem with attribute load order once but it wasnt between cookbooks, so i just slapped it all in one attribute file and went off to find another problem
[2013-01-11 22:02:44 -0500] cwj: i agree that it sucks
[2013-01-11 22:10:12 -0500] lehrblogger: i'm trying to delete a hosted chef client from manage.opscode.com, but get "Permission denied. You do not have permission to delete this client. (Error 22020)"
[2013-01-11 22:10:16 -0500] lehrblogger: is this related to the recent API issues (http://status.opscode.com/)? or have i gotten something into a weird state?
[2013-01-11 22:10:52 -0500] lehrblogger: my organization is just me, so i doubt it's actually a permissions issue
[2013-01-11 22:15:47 -0500] Holos: When you create config files based on databag content, what is the preferred method of having chef redo those configuration on the next run? delete, and then have a create? or is there some other concept I'm missing?
[2013-01-11 22:17:04 -0500] dyer: Holos, Chef would look at the template on the system and the template its about to write and see if they are the same ( via checksum).  If they are great, skip, otherwise write to disk
[2013-01-11 22:17:06 -0500] spox: Holos: use the data to either generate the contents of a file resource, or use the data within a template
[2013-01-11 22:19:40 -0500] Holos: dyer: Does the version of the recipe have to change to compare checksum?
[2013-01-11 22:19:50 -0500] Holos: or is this done on a per-run basis
[2013-01-11 22:20:44 -0500] jtimberman: dyer: include_attribute isn't non-deterministic, the attributes files load ordering is, because it's "hash ordered" so sometimes it's alphabetical but sometimes not. yay hashes!
[2013-01-11 22:20:51 -0500] jtimberman: i believe that will be resolved in chef 11 thoguh
[2013-01-11 22:20:55 -0500] peat: Man, this is still borked. expander is running, although the log file is at 0 bytes. I can see search queries getting through to solr just fine; no errors in the logs. no knife errors at all ... but nothing gets reindexed.
[2013-01-11 22:21:05 -0500] jtimberman: peat: rabbitmq running?
[2013-01-11 22:21:21 -0500] peat: jtimberman: yup.
[2013-01-11 22:22:07 -0500] dyer: Holos, per run
[2013-01-11 22:22:34 -0500] dyer: Templates checksums are evaluated per run
[2013-01-11 22:23:09 -0500] jtimberman: peat: was there a message about the node in the expanderl og file?
[2013-01-11 22:23:42 -0500] peat: jtimberman: there are no messages in the expander log file. It's at 0 bytes; it gets recreated if I nuke it and restart the service, but ... no data in it.
[2013-01-11 22:25:43 -0500] autolykos: I have a question: is it possible to use a template to udate an already existing file?
[2013-01-11 22:25:57 -0500] autolykos: or I have to write my own provider for that?
[2013-01-11 22:26:52 -0500] autolykos: a concrete example is the following: drop a known_hosts file in .ssh in case none is found
[2013-01-11 22:27:24 -0500] autolykos: or update the one that it is there with the content of a data bag
[2013-01-11 22:28:49 -0500] jtimberman: peat: what about the solr.log?
[2013-01-11 22:28:59 -0500] jtimberman: peat: if you edit the node manually and save it, does it update?
[2013-01-11 22:30:42 -0500] peat: jtimberman: solr log is solid, no errors there. let me check on the editing. one moment.
[2013-01-11 22:32:02 -0500] peat: jtimberman: No -- it doesn't update the search, although 'knife node show' gives me the updated information.
[2013-01-11 22:32:18 -0500] AndroUser: Is there any obvious reason why adding a repo with apt cookbook would not trigger an apt-get update? I always get the wrong package installed. Example the nodejs cookbook
[2013-01-11 22:44:47 -0500] peat: Alternate approach -- from a recipe, can I query the chef server for a complete list a nodes? I can search manually for this in the short term.
[2013-01-11 22:45:01 -0500] peat: *complete list of nodes
[2013-01-11 22:48:59 -0500] peat: ... is there any documentation about what methods or objects are available from within a recipe?
[2013-01-11 22:49:10 -0500] peat: (chef specific .. I know my way around ruby)
[2013-01-11 22:50:46 -0500] siezer: peat search(:index_name, "solr:query")
[2013-01-11 22:50:59 -0500] siezer: search(:nodes, "*:*")
[2013-01-11 22:51:05 -0500] peat: siezer: search is broken, I'm working around that.
[2013-01-11 22:51:12 -0500] siezer: search(:nodes, "hostname:*")
[2013-01-11 22:51:38 -0500] siezer: search(:nodes, "hostname:*").each do |i|
[2013-01-11 22:51:44 -0500] siezer: nodes = search(:nodes, "hostname:*")
[2013-01-11 22:52:14 -0500] siezer: ^ all that is in the compile phase. feed the info into resources for later converging
[2013-01-11 22:54:43 -0500] bmcgee: hey guys, is it possible to set the value of an observable, allowing it to inform any subscribers but preventing a computed observable from reacting to the change? I'm trying to create a multi-select, basic idea is here: http://jsfiddle.net/LfUL5/1/
[2013-01-11 22:54:57 -0500] peat: siezer: Yeah, but it doesn't work if my search index is hosed. Knife can pull a list of nodes with 'node list' -- I'm looking for something similar from within a recipe while the search borkage is getting fixed.
[2013-01-11 22:55:13 -0500] bmcgee: balls, wrong room. lol move along, nothing to see...
[2013-01-11 22:55:31 -0500] doomviking: heh
[2013-01-11 22:58:14 -0500] siezer: peat knife and a recipe use the same API to seach
[2013-01-11 22:58:52 -0500] siezer: knife node list == search(:node "*:*")
[2013-01-11 22:59:11 -0500] siezer: are you on hosted, private, or oss?
[2013-01-11 22:59:27 -0500] peat: private.
[2013-01-11 23:00:45 -0500] ranjib_: peat, knife node list uses Chef::Node.list, which i think comes from db (i.e. couch if you are chef 10, postgres if you are chef 11)
[2013-01-11 23:01:01 -0500] peat: ranjib_: That was my understanding, yes.
[2013-01-11 23:01:11 -0500] siezer: hrm... email support. there's a problem somewhere with the indexer that they can fix pretty quick
[2013-01-11 23:02:00 -0500] ranjib_: peat, in past i have used Node.list and search(:node,"*:*") to check if chef solr is doing something funky
[2013-01-11 23:02:15 -0500] ranjib_: had a lot of trouble with solr in the initial days
[2013-01-11 23:02:29 -0500] peat: ranjib_: Ahh, excellent. I will pursue Node.list and see what that gives me. Many thanks!
[2013-01-11 23:07:23 -0500] peat: ranjib_: Node.list gets me the basic data I'm looking for. Where can I find rdoc for the Node object?
[2013-01-11 23:07:44 -0500] ranjib_: peat, rubygems ?
[2013-01-11 23:08:10 -0500] peat: Derp, yes, sorry. Stupid question. It's friday. Hah.
[2013-01-11 23:08:13 -0500] peat: Thank you. :)
[2013-01-11 23:08:24 -0500] ranjib_: noh.. its redirecting to the wiki..
[2013-01-11 23:08:53 -0500] peat: Oh, I'm just looking at the damned code.
[2013-01-11 23:09:04 -0500] peat: Sorry. Not a fan of opscode documentation at the moment. ;)
[2013-01-11 23:09:24 -0500] ranjib_: peat what exactly you want ?
[2013-01-11 23:10:02 -0500] ranjib_: i tend to read the code instead,
[2013-01-11 23:10:24 -0500] peat: ranjib_: I'm working around a busted search server, so I'm figuring out alternative ways to find and inspect nodes so that I can deploy this cluster before 5:00. :) haha.
[2013-01-11 23:10:39 -0500] laurent\: is it list(true) you're looking for ?
[2013-01-11 23:11:44 -0500] laurent\: or load(id)
[2013-01-11 23:12:08 -0500] ranjib_: peat , Chef::Node.load(<node_name>).to_json
[2013-01-11 23:12:12 -0500] peat: Perfect.
[2013-01-11 23:12:21 -0500] laurent\: (just wild guesses, going back to my card game)
[2013-01-11 23:12:27 -0500] ranjib_: or even with knife, knife node show <name> -Fj
[2013-01-11 23:14:16 -0500] ranjib_: peat, alternatively you can delete the api client of that node, and start chef client in the new node, with same name, without a runlist, it should pick up the old node's runlist
[2013-01-11 23:14:40 -0500] siezer: pear
[2013-01-11 23:14:44 -0500] siezer: er peat
[2013-01-11 23:14:45 -0500] siezer: http://rubydoc.info/gems/chef/Chef/Node
[2013-01-11 23:14:48 -0500] siezer: http://private-chef-docs.opscode.com/
[2013-01-11 23:15:06 -0500] peat: ranjib_: Oh, that part is fine. This is mostly about discovering services within an environment. It was working beautifully before the search server took a dive; I'm just working around it on a deadline. Haha.
[2013-01-11 23:15:25 -0500] siezer: try  private-chef-ctl opscode-solr restart
[2013-01-11 23:15:39 -0500] siezer: you want to fix search instead of work around it.
[2013-01-11 23:16:26 -0500] laurent\: sudden issue with the search ? is it now missing entries ?
[2013-01-11 23:16:31 -0500] peat: Solr runs correctly. I can query it directly just fine.
[2013-01-11 23:16:41 -0500] peat: No, I did an index rebuild and all of the entries were dropped.
[2013-01-11 23:16:44 -0500] siezer: but not from recipes?
[2013-01-11 23:17:13 -0500] siezer: open a crit support ticket with support@opscode.com. they'll call you.
[2013-01-11 23:17:20 -0500] peat: I'm going to dissappear for a while and fix my problem with the short term fix. I'll be back to discuss this later. In the meantime, scroll up and read my original messages. :)
[2013-01-11 23:18:20 -0500] peat: Sorry, I misstated -- it's not private chef. :)
[2013-01-11 23:21:10 -0500] mrchoey: Does anyone know of an easy way to send multiple encrypted data bag keys on bootstrap? Can you specify multiple encrypted_data_bag_secret lines in knife.rb or only one?
