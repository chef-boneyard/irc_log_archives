[2013-01-14 00:06:18 -0500] WPsites: Is there some kind of tool that can connect to your chef server or read your chef repo and give you some kind of visual/documentation/overview of your infrastructure?
[2013-01-14 00:22:20 -0500] flaccid: WPsites: i wouldn't mind something like that too, but personally i have not seen. the blueprint project might help but thats kind of doing the opposite i.e. reverse engineering a non chef managed system
[2013-01-14 00:24:09 -0500] WPsites: flaccid: there is a lot of noise when you try searching for "blueprint project" on Google!
[2013-01-14 00:25:02 -0500] mh`: flaccid: how does chef persist/store that info? (i'm not familiar much with chef yet)
[2013-01-14 00:25:04 -0500] mh`: chef server, rather
[2013-01-14 00:25:51 -0500] flaccid: WPsites: did you try putting chef in the keywords?
[2013-01-14 00:26:12 -0500] WPsites: hehe, nope
[2013-01-14 00:26:13 -0500] flaccid: 2nd result for me (devstructure)
[2013-01-14 00:26:24 -0500] flaccid: mh`: which info?
[2013-01-14 00:26:26 -0500] mh`: dat lazy
[2013-01-14 00:26:33 -0500] mh`: flaccid: the info that would be required to build such a tool
[2013-01-14 00:27:23 -0500] flaccid: i'm not sure on the internals, but i guess a lot would be in the node object
[2013-01-14 00:28:00 -0500] WPsites: yes looks very interesting but like you say it's not quite what I had in mind
[2013-01-14 00:28:33 -0500] mh`: yah i dunno what format that's in.. like how is it serialized, where does it live
[2013-01-14 00:28:43 -0500] mh`: flat file? sqlite? circusdb
[2013-01-14 00:28:46 -0500] mh`: i'll google heh
[2013-01-14 00:28:53 -0500] mh`: thought maybe you'd know since you're always chef'ing it up in here
[2013-01-14 00:29:30 -0500] WPsites: if the chef admin stores all the configuration in their chef-repo then all of that information is accessible in json files
[2013-01-14 00:29:59 -0500] flaccid: mh`: i'm not the right guy to ask that
[2013-01-14 00:30:11 -0500] WPsites: otherwise you can query everything through the restful api
[2013-01-14 00:30:12 -0500] flaccid: its sunday in US so not many peeps alive that could help on both questions
[2013-01-14 00:30:40 -0500] mh`: flaccid: i dont actually care much, just wondered why there wasn't a tool like what WPsites asked for
[2013-01-14 00:31:12 -0500] flaccid: i reckon there is a good chance there is. i don't store as much in my brain as google :)
[2013-01-14 00:31:12 -0500] WPsites: I'm sure someone will build something one day
[2013-01-14 00:31:20 -0500] mh`: flaccid: weird, i do
[2013-01-14 00:31:22 -0500] mh`: ;/
[2013-01-14 00:31:26 -0500] flaccid: heheh
[2013-01-14 00:31:40 -0500] WPsites: right now I have to look at recipes and edit nodes to see what's going on
[2013-01-14 00:31:46 -0500] mh`: as someone coming from puppet and trying to learn/grok/migrate a large production organization to chef
[2013-01-14 00:32:11 -0500] WPsites: would be nice to just see an overall view of it and be able to drill down with some clicks to see how the recipes/runlist is implemented
[2013-01-14 00:32:16 -0500] mh`: while there's way better OSS ecosystem (recipes for the stuff i actually care about), there's not nearly the enterprisey polish that puppet world has
[2013-01-14 00:32:29 -0500] flaccid: WPsites: i'm not sure what problem you actually have there. nodes have node.json which shows the run_list and node attributes and i think you can query that stuff, i'm just limited on chef server..
[2013-01-14 00:32:36 -0500] mh`: but for me the better-tested recipes and so forth are worth more to me than the enterprise support/tooling
[2013-01-14 00:32:40 -0500] mh`: so i'm making that tradeoff
[2013-01-14 00:33:00 -0500] flaccid: o wpi;dm
[2013-01-14 00:33:05 -0500] mh`: check out stedolan.github.com/jq/ for neat thing to query json
[2013-01-14 00:33:14 -0500] flaccid: oops. i wouldn't look at it like that, anything a cookbook doesn't cater for you can contribute
[2013-01-14 00:33:16 -0500] mh`: flaccid: <not sure if keyboard mash or unfamiliar acronym>
[2013-01-14 00:33:20 -0500] WPsites: I haven't got a problem, I can plod along doing just that but there must be a better way
[2013-01-14 00:33:40 -0500] mh`: flaccid: was that @ me?
[2013-01-14 00:33:50 -0500] flaccid: yep sorry
[2013-01-14 00:34:06 -0500] mh`: i think you misunderstood
[2013-01-14 00:34:13 -0500] flaccid: wouldn't the chef server UI thing show what each node is running without having to query ?
[2013-01-14 00:34:16 -0500] mh`: i was saying chef has a better community for recipes
[2013-01-14 00:37:32 -0500] mh`: puppet has more polished docs, clear technical info on how various components fit together
[2013-01-14 00:37:33 -0500] mh`: (imho)
[2013-01-14 00:37:36 -0500] mh`: http://puppetlabs.com/puppet/enterprise-vs-open-source/ and re your question
[2013-01-14 00:37:53 -0500] mh`: there is no analog to puppet enterprise on the chef side
[2013-01-14 00:38:02 -0500] mh`: (that i'm aware of)
[2013-01-14 00:38:12 -0500] mh`: private chef is the same as chef server, for all intents
[2013-01-14 00:38:53 -0500] mh`: and hosted chef is hilariously slow, fwiw
[2013-01-14 00:39:11 -0500] flaccid: i see. well i work at RightScale and use that, so I guess thats what I'd call my enterprise toolset
[2013-01-14 00:40:08 -0500] mh`: yes, and rightscale has a business model because chef lacks enterprise tools.. (and ec2's stuff used to be terrible, and still is in some aspects)
[2013-01-14 00:40:19 -0500] mh`: otherwise you guys would be reduced to bridging people using multicloud :)
[2013-01-14 00:40:22 -0500] mh`: no offense :P
[2013-01-14 00:41:36 -0500] flaccid: good points for sure. i guess i'm just an open source kind of guy; probably would have the same attitude if i owned a big company..
[2013-01-14 00:42:37 -0500] mh`: i'm an open source kind of guy on my own time, but when you're running infrastructure supporting a few billion requests/day server management/orchestration is a means to an end
[2013-01-14 00:43:49 -0500] flaccid: there are some big chef users out there of that size though
[2013-01-14 00:44:11 -0500] mh`: yea of course, there are much much bigger users of chef in terms of server count (much bigger)
[2013-01-14 00:44:22 -0500] mh`: but they also have the internal resources to develop their own tooling and so forth
[2013-01-14 00:44:33 -0500] mh`: we don't, startup life
[2013-01-14 00:44:50 -0500] mh`: we have the ability/knowledge, don't have the resources because it's not best use of my time
[2013-01-14 00:45:10 -0500] flaccid: many ways to skin a cat
[2013-01-14 00:45:42 -0500] flaccid: me0w
[2013-01-14 00:46:18 -0500] mh`: did you say meow
[2013-01-14 00:46:26 -0500] flaccid: i did
[2013-01-14 00:46:44 -0500] mh`: meow see here
[2013-01-14 00:48:00 -0500] WPsites: https://github.com/jbz/knife-audit looks interesting. Not graphical (maybe I'm in a dream world with that anyway) but looks like it may give some nice info at a glance sort of thing
[2013-01-14 00:48:28 -0500] flaccid: in slight rs defense there, you do get monitoring and alerting and of course the provisioning, but still you can knife it up and all that. some of the puppet enterprise stuff does look good. each to their own i guess
[2013-01-14 00:50:27 -0500] WPsites: and running "knife audit -s" gives a nice little overview of which nodes are using which recipes
[2013-01-14 00:51:30 -0500] flaccid: sounds good
[2013-01-14 00:57:10 -0500] WPsites: Have you seen any writeups/info from shared hosts using chef?
[2013-01-14 01:02:12 -0500] WPsites: how do you delete a data bag ITEM from within a recipe?
[2013-01-14 01:03:05 -0500] WPsites: there is no data bag delete command I can see.. you can delete from knife but that's no good
[2013-01-14 01:04:54 -0500] yfeldblum: WPsites, recipes should typically only *read* data-bag items, not write/delete them
[2013-01-14 01:05:10 -0500] yfeldblum: WPsites, if recipes need to store data for later, that should be done onto the node attributes
[2013-01-14 01:06:08 -0500] WPsites: I see that but the create command is available from within a recipe so why not the delete
[2013-01-14 01:07:28 -0500] WPsites: I've got a VPN cookbook that stores it's IP address and some other config bits for each host in a data bag, I don't want to have to do this manually every time I create a node or delete one
[2013-01-14 01:07:42 -0500] yfeldblum: WPsites, then store that data on the node attributes ...
[2013-01-14 01:08:32 -0500] WPsites: then the other nodes need to access that info
[2013-01-14 01:08:39 -0500] yfeldblum: WPsites, "here's a hammer; here's how to hold it; no you can't use it correctly when you're holding it by the head ..."
[2013-01-14 01:08:42 -0500] yfeldblum: WPsites, search
[2013-01-14 01:10:19 -0500] WPsites: yeah makes sense to do it a different way I suppose. I just wanted to go with how the cookbook worked for now as I haven't really got the time to be changing it
[2013-01-14 01:11:05 -0500] WPsites: adding the info to the node didn't work for some reason can't remember why exactly. I suppose for now I will just do some manual intervention to delete the data bag item when I remove a server and then look at changing the cookbook to use the node for storage at a later date.
[2013-01-14 01:12:19 -0500] WPsites: if I have say 500 machines/results when I search the nodes for this VPN info is it going to be dog slow?
[2013-01-14 01:12:24 -0500] WPsites: rather than 500 data bag items
[2013-01-14 01:14:14 -0500] WPsites: and would I just loop through those 500 results and Chef::Node.load() for each one to get to the information or is there a better way, maybe to retrieve it as a single result set?
[2013-01-14 01:16:12 -0500] yfeldblum: WPsites, slow? your cookbooks are checking a hundred things on disk already ... that probably dwarfs the amount of time a chef-server-search will take ...
[2013-01-14 01:16:50 -0500] yfeldblum: WPsites, shelling out to package managers, service control scripts, etc ...
[2013-01-14 01:18:17 -0500] WPsites_: Oops, lost connection. So any advice on this?
[2013-01-14 01:18:32 -0500] yfeldblum: WPsites, slow? your cookbooks are checking a hundred things on disk already ... that probably dwarfs the amount of time a chef-server-search will take ...
[2013-01-14 01:18:33 -0500] yfeldblum: WPsites, shelling out to package managers, service control scripts, etc ...
[2013-01-14 01:18:53 -0500] WPsites_: but node.load 500 times?
[2013-01-14 01:19:15 -0500] yfeldblum: WPsites, no, `other_nodes = search(:node, "some-query")`
[2013-01-14 01:19:32 -0500] WPsites_: then what do I do with other_nodes?
[2013-01-14 01:19:42 -0500] yfeldblum: WPsites, it's an array of Chef::Node objects
[2013-01-14 01:19:48 -0500] yfeldblum: WPsites, you loop over them or whatever
[2013-01-14 01:19:55 -0500] WPsites_: oh ok so no loading needed.
[2013-01-14 01:20:22 -0500] WPsites_: is there any way to restrict the info that comes back? or do I just get all node info, the end
[2013-01-14 01:20:39 -0500] yfeldblum: WPsites, no in chef-10, yes in chef-11
[2013-01-14 01:21:50 -0500] WPsites: OK well that's good enough for me. I haven't got 500 servers right now, I've only got about 16, so once I have more and need that performance boost it will be there in a coming release of Chef. Nice one
[2013-01-14 01:42:56 -0500] jtimberman: WPsites, yfeldblum: with hosted chef, you cna use whitelist-node-attrs cookbook, http://ckbk.it/whitelist-node-attrs
[2013-01-14 01:45:40 -0500] WPsites: jtimberman: looks interesting. Saved on the server where?
[2013-01-14 02:15:29 -0500] wassy121_: Hi chefs.  Anyone use chefspec on the regular?
[2013-01-14 02:15:41 -0500] wassy121_: I'm having some issues testing "notifies"
[2013-01-14 02:16:24 -0500] wassy121_: it says Failure/Error: chef_run.should notify 'service[nginx]', :restart \n undefined method `delayed_notifications' for #<ChefSpec::ChefRunner:0xb6816be8>
[2013-01-14 02:22:59 -0500] wassy121_: http://pastebin.ca/2301882
[2013-01-14 02:23:18 -0500] wassy121_: in case anyone cares to take a gander, see if I'm doing something obviously wrong
[2013-01-14 02:26:56 -0500] wassy121_: http://pastebin.ca/2301883 that one includes the error.  Sorry if I'm spammy, just been searching around for examples/problems like it otherwheres and can't find anything.
[2013-01-14 05:42:09 -0500] pcboy_: wizonesolutions: 23
[2013-01-14 05:42:17 -0500] pcboy_: Erf sorry for the hl
[2013-01-14 09:44:53 -0500] jeekl: Any omnibus packages fr chef11-testing yet?
[2013-01-14 09:59:14 -0500] kernelPanik: hi guys! Is possible the node name with Knife?
[2013-01-14 10:02:12 -0500] mattt: kernelPanik: do what now
[2013-01-14 10:02:39 -0500] kernelPanik: ah sorry... I mean " change "  the node name
[2013-01-14 10:03:12 -0500] mattt: not sure myself :P
[2013-01-14 10:24:55 -0500] zts: kernelPanik: no - you'll need to set the new node name in /etc/chef/client.rb on the node, then reregister it
[2013-01-14 10:28:25 -0500] kernelPanik: ok! thanks!
[2013-01-14 10:50:40 -0500] WPsites: There is always something isn't there I've got apache cookbook and then next the php cookbook but it seems the apache cookbook is failing because it's trying to start apache but apache can't start because the vhost file has php_admin_value stuff in there yet PHP isn't yet installed by a recipe. Do move PHP before the apache cookbook? sounds backwards to me but suppose it might work?
[2013-01-14 10:54:57 -0500] battosai_: hi
[2013-01-14 10:57:02 -0500] battosai_: test
[2013-01-14 10:57:58 -0500] matti: battosai_: Test pass 1/1
[2013-01-14 10:59:24 -0500] battosai_: facing the following error:
[2013-01-14 10:59:38 -0500] battosai_: sudo chef-expander -n1
[2013-01-14 10:59:53 -0500] battosai_: can't activate eventmachine (~> 0.12.10, runtime) for ["chef-expander-10.16.6"], already activated eventmachine-1.0.0 for ...
[2013-01-14 11:00:23 -0500] battosai_: anybody faced a similar issue?
[2013-01-14 11:02:17 -0500] matti: What is chef-expander?
[2013-01-14 11:02:17 -0500] WPsites: I haven't. I've never even used chef-expander, never heard of it. *goes to google to find out what it is*
[2013-01-14 11:02:43 -0500] matti: Chef Expander replaces the chef-solr-indexer daemon that was included with Chef 0.8 and 0.9
[2013-01-14 11:02:46 -0500] matti: Right.
[2013-01-14 11:03:18 -0500] matti: Of course, has nearly no documentation.
[2013-01-14 11:04:14 -0500] gyre007: can someone tell me why is CHef ignoring this resource ? https://gist.github.com/4529322 when I run i tmanually all works fine but Chef for whatever reason skips it
[2013-01-14 11:04:50 -0500] gyre007: I'm running out of ideas...only_if should prevent it from running it ONLY IF it's already running ie only if the grep returns 0
[2013-01-14 11:04:55 -0500] gyre007: meaning TRUE
[2013-01-14 11:04:57 -0500] gyre007: arrrgh
[2013-01-14 11:05:22 -0500] matti: battosai_: What is the full output?
[2013-01-14 11:05:27 -0500] WPsites: is it because that command is in Ruby code and gets run before screen is started?
[2013-01-14 11:05:47 -0500] gyre007: WPsites: that's a shell command
[2013-01-14 11:06:06 -0500] gyre007: unless im missing somehting
[2013-01-14 11:06:11 -0500] matti: gyre007: Add -l debug
[2013-01-14 11:06:14 -0500] WPsites: should it not be in a code block then
[2013-01-14 11:06:48 -0500] matti: gyre007: And do not need to escape quotes; use single quotes.
[2013-01-14 11:06:48 -0500] gyre007: matti: I did add a -l debug confirms what I say - it skips the resource execution
[2013-01-14 11:06:50 -0500] gyre007: WPsites: let mesee
[2013-01-14 11:07:27 -0500] matti: gyre007: Sure, you know better.
[2013-01-14 11:07:32 -0500] gyre007: :)
[2013-01-14 11:08:02 -0500] battosai_: '/tmp/gecode-3.5.0 % sudo chef-expander -n1                                                            /usr/local/lib/site_ruby/1.8/rubygems.rb:233:in `activate': can't activate eventmachine (~> 0.12.10, runtime) for ["chef-expander-10.16.6"], already activated eventmachine-1.0.0 for ["amqp-0.6.7", "chef-expander-10.16.6"] (Gem::LoadError)         from /usr/local/lib/site_ruby/1.8/rubygems.rb:249:in `activate'         from /usr/loca
[2013-01-14 11:08:24 -0500] gyre007: matti: https://gist.github.com/4529322
[2013-01-14 11:08:58 -0500] battosai_: trying to install chef-server on kubuntu
[2013-01-14 11:09:19 -0500] matti: battosai_: 1. USe paste facility ;p 2. gem list ;p
[2013-01-14 11:09:38 -0500] matti: gyre007: Fire up shef and build this by hand, and then execute.
[2013-01-14 11:10:00 -0500] battosai_: ok
[2013-01-14 11:10:05 -0500] gyre007: that's exactly what I wanted to avoid :) messing up with unfriendly shef console...looks like I have no choice
[2013-01-14 11:10:07 -0500] gyre007: arrgh
[2013-01-14 11:10:18 -0500] matti: gyre007: Not quite.
[2013-01-14 11:10:26 -0500] matti: gyre007: It whines about | [2013-01-14T10:57:56+00:00] DEBUG: Skipping execute[run-zeus-in-screen] due to not_if command `ps -ef | grep "SCREEN -d -m zeus start"
[2013-01-14 11:10:36 -0500] gyre007: yes
[2013-01-14 11:10:37 -0500] gyre007: but why
[2013-01-14 11:10:38 -0500] matti: gyre007: Perhaps your weird quoting gets mangled?
[2013-01-14 11:11:10 -0500] gyre007: but if I dont add those quotes I wont be able to match it
[2013-01-14 11:11:11 -0500] matti: gyre007: 'ps -ef | grep -- "SCREEN -d -m zeus"'
[2013-01-14 11:11:11 -0500] gyre007: ...
[2013-01-14 11:11:31 -0500] matti: You can add -q there.
[2013-01-14 11:11:39 -0500] matti: 'ps -ef | grep -q -- "SCREEN -d -m zeus"'
[2013-01-14 11:12:24 -0500] gyre007: ill give it a go matti
[2013-01-14 11:12:59 -0500] battosai_: http://pastebin.com/H2Cf6qQ2
[2013-01-14 11:13:01 -0500] matti: Try it.
[2013-01-14 11:13:34 -0500] matti: battosai_: Having two version of EventMachine might be a problem.
[2013-01-14 11:13:53 -0500] matti: battosai_: If a project does not explicitly states which version it wants.
[2013-01-14 11:14:08 -0500] matti: battosai_: Said that, 0.12.10 is OLD and pretty much deprecated.
[2013-01-14 11:14:12 -0500] matti: battosai_: And very buggy :)
[2013-01-14 11:14:19 -0500] battosai_: oh..ok
[2013-01-14 11:14:20 -0500] matti: battosai_: Btter to get rid of it in favour of 1.x
[2013-01-14 11:14:57 -0500] battosai_: ah..i see...in my desparate attempts to get cef up and running...this seems to be the remains of my old failed attempts
[2013-01-14 11:14:57 -0500] matti: EM /should/ be backward-compatible.
[2013-01-14 11:15:07 -0500] matti: battosai_: :)
[2013-01-14 11:15:17 -0500] battosai_: i am thinking how to install from a clean slate
[2013-01-14 11:15:44 -0500] matti: battosai_: Do few things.
[2013-01-14 11:15:58 -0500] battosai_: event machine seems to be the only repeated entry
[2013-01-14 11:16:02 -0500] battosai_: let m eremove it
[2013-01-14 11:16:05 -0500] battosai_: *me
[2013-01-14 11:16:19 -0500] matti: battosai_: 1. Remove all gems (not needed); 2. Update Ruby to 1.9 (use Brightbox's repositories); 3. Use Opscode repository and then install Chef Server package.
[2013-01-14 11:16:39 -0500] matti: battosai_: If it is just Chef Client / Solo your are after, then skip #3.
[2013-01-14 11:16:46 -0500] matti: battosai_: And install gem under Ruby 1.9
[2013-01-14 11:17:44 -0500] battosai_: ok, i have one machine and my aim is to get a minimal chef up and running with a Hello Worl cookbook
[2013-01-14 11:17:54 -0500] battosai_: i attempted chef-solo and couldn't get it up and running
[2013-01-14 11:18:05 -0500] matti: Its really simple.
[2013-01-14 11:18:11 -0500] matti: What was the problem?
[2013-01-14 11:18:13 -0500] battosai_: now attempting a server and client on one machine
[2013-01-14 11:18:37 -0500] battosai_: none of the daemons started
[2013-01-14 11:18:45 -0500] matti: Errors?
[2013-01-14 11:18:53 -0500] battosai_: all failed with some errors or the errors
[2013-01-14 11:18:57 -0500] matti: ;p
[2013-01-14 11:19:10 -0500] gyre007: that didnt seem to help matti this is really weird...https://gist.github.com/4529322
[2013-01-14 11:19:16 -0500] battosai_: i recall one - 'require yajl' was one
[2013-01-14 11:19:21 -0500] gyre007: I pasted the output from debug log...from second run
[2013-01-14 11:19:27 -0500] matti: gyre007: OK
[2013-01-14 11:19:29 -0500] matti: battosai_: http://blog.brightbox.co.uk/posts/next-generation-ruby-packages-for-ubuntu
[2013-01-14 11:20:17 -0500] matti: gyre007: Put there not_if 'false'
[2013-01-14 11:20:29 -0500] matti: gyre007: Should get /bin/false which returns 0.
[2013-01-14 11:20:41 -0500] matti: gyre007: Which should make not_if evaluate as true.
[2013-01-14 11:20:50 -0500] matti: gyre007: Simplest test every, I think.
[2013-01-14 11:21:07 -0500] gyre007: but then it will always execute
[2013-01-14 11:21:12 -0500] gyre007: on every chef run...
[2013-01-14 11:21:15 -0500] matti: gyre007: It is just a test.
[2013-01-14 11:21:19 -0500] gyre007: ah I see
[2013-01-14 11:21:21 -0500] gyre007: ok will do
[2013-01-14 11:23:17 -0500] matti: gyre007: You can also do an catch-all thing.
[2013-01-14 11:24:17 -0500] matti: gyre007: not_if 'bash -c "exec &> /tmp/test.txt ; ps -ef | grep -q -- "SCREEN -d -m zeus"'
[2013-01-14 11:24:26 -0500] gyre007: I noticed somewthing weird matti
[2013-01-14 11:24:48 -0500] matti: Yes?
[2013-01-14 11:24:55 -0500] gyre007: ps -ef |grep -q -- 'SCREEN -d -m zeus start' returns 0 in the shell EVEN THOUGH the command is NOT running...
[2013-01-14 11:24:59 -0500] gyre007: sec...ill gist it
[2013-01-14 11:25:50 -0500] gyre007: matti:  at the bottom
[2013-01-14 11:25:51 -0500] gyre007: https://gist.github.com/4529322
[2013-01-14 11:26:47 -0500] matti: gyre007: 0 is fine with grep if the result is not found.
[2013-01-14 11:28:00 -0500] matti: Ops.
[2013-01-14 11:28:04 -0500] matti: The way-around.
[2013-01-14 11:28:04 -0500] matti: Normally, the exit status is 0 if selected lines are found and 1 otherwise.
[2013-01-14 11:29:28 -0500] gyre007: yeah
[2013-01-14 11:29:44 -0500] gyre007: i think the grep is matching grep...which causes it to exit with 0 exist value...
[2013-01-14 11:29:52 -0500] gyre007: ill try grep blah|grep -v grep...
[2013-01-14 11:30:34 -0500] matti: Oh, LOL.
[2013-01-14 11:30:44 -0500] matti: It might happen.
[2013-01-14 11:31:03 -0500] matti: 'ps -ef | grep -q -- "[S]CREEN -d -m zeus"'
[2013-01-14 11:39:26 -0500] gyre007: I just put grep -v  there and all works as expected matti
[2013-01-14 11:39:29 -0500] gyre007: gotcha
[2013-01-14 11:42:16 -0500] matti: :>
[2013-01-14 11:42:26 -0500] matti: It was really a 'Doh' thing.
[2013-01-14 11:59:04 -0500] battosai_: matti: http://pastebin.com/L8StBMjS
[2013-01-14 11:59:36 -0500] matti: Hah.
[2013-01-14 11:59:39 -0500] matti: Stupid.
[2013-01-14 12:00:04 -0500] matti: battosai_: I'd complain to chef-expander developers for being stupid.
[2013-01-14 12:00:15 -0500] battosai_: :)
[2013-01-14 12:00:25 -0500] matti: battosai_: Meanwhile, you can / probably have to use 0.12.10
[2013-01-14 12:01:07 -0500] battosai_: hmmm...one question...for a minimalist chef up and running on one machine, am i following the right path?
[2013-01-14 12:02:22 -0500] matti: battosai_: What is your development machine?
[2013-01-14 12:02:34 -0500] matti: battosai_: On Linux / OS X, get VirtualBox and vagrant.
[2013-01-14 12:02:59 -0500] battosai_: matti: Ubuntu 11.04
[2013-01-14 12:03:03 -0500] matti: battosai_: Get one VM with Chef Server, and then as many as you like VMs (or have enough resources) for clients.
[2013-01-14 12:03:17 -0500] matti: battosai_: And you can trash them to your heart's content.
[2013-01-14 12:03:30 -0500] matti: battosai_: Get Ruby 1.9 on your Ubuntu.
[2013-01-14 12:03:42 -0500] matti: battosai_: Install VirtualBox and vagrant, and off you go ;]
[2013-01-14 12:03:56 -0500] matti: battosai_: It really will speed up your development.
[2013-01-14 12:04:12 -0500] matti: battosai_: If not, then for playing around / testing, its OK to have one machine.
[2013-01-14 12:04:23 -0500] matti: battosai_: Not sure what you'd need chef-expander for, but...
[2013-01-14 12:04:23 -0500] matti: ;]
[2013-01-14 12:05:41 -0500] battosai_: matti: I just want to play around and want to use a hello world cookbook
[2013-01-14 12:06:13 -0500] battosai_: matti: was following this: http://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually
[2013-01-14 12:06:40 -0500] battosai_: matti: if i can avoid it i am ok with that
[2013-01-14 12:08:44 -0500] battosai_: matti: should I be going for chef-solo?
[2013-01-14 12:08:45 -0500] matti: battosai_: Try installing it with system packages.
[2013-01-14 12:08:58 -0500] matti: battosai_: Depends. Solo has its limitations / quirks.
[2013-01-14 12:10:08 -0500] battosai_: matti: hmmm
[2013-01-14 12:11:18 -0500] battosai_: matti: tried that earlier never got the server/clent up they always failed...nevertheless trying it again
[2013-01-14 12:13:03 -0500] matti: ;]
[2013-01-14 12:13:11 -0500] battosai_: matti: so should i remove chef installations done through gem?
[2013-01-14 12:13:22 -0500] battosai_: matti: i believe yes
[2013-01-14 12:13:59 -0500] matti: As a cleanup, yep.
[2013-01-14 12:20:31 -0500] battosai_: matti: http://pastebin.com/PLzxeejB
[2013-01-14 12:22:11 -0500] matti: I guess you need some Gems.
[2013-01-14 12:25:04 -0500] jimjimovich: It seems that if any information reported back to the chef server has any UTF-8 data in it, I get an error (like a drive name, username comment, etc).  How can I avoid this problem?
[2013-01-14 12:28:53 -0500] battosai_: matti: mixlib, meb core and eventmachine are all present in the gem list http://pastebin.com/f28pR1GT
[2013-01-14 12:29:13 -0500] user9910: Hi guys. A quick question. What is a site specific cookbooks? And why it is better to separate and to have 2 directories for local and site specific cookbooks ?
[2013-01-14 12:48:41 -0500] specialsauce: user9910: imaging you want to put an animated gif of mickey mouse to be served as the default for all apache requests. You can do this in config. YOu probably don't want to do it in the default apache cookbook you then publish to the interwebs for everyone to use, so yu stick it in a site-specific cookbook
[2013-01-14 12:53:27 -0500] matti: battosai_: Odd. Hm.
[2013-01-14 12:54:38 -0500] battosai_: matti: based on google searches, it seems the newer versions simply break stuff :D
[2013-01-14 12:54:57 -0500] battosai_: matti: what versions did you have up and running?
[2013-01-14 12:55:19 -0500] matti: LOL
[2013-01-14 12:55:41 -0500] matti: battosai_: We have v11 (Erchef) at the moment. I was playing with 10.x some time ago.
[2013-01-14 12:56:30 -0500] battosai_: matti: hmmm
[2013-01-14 12:57:08 -0500] matti: battosai_: I hope that folks from OpsCode will fix this version issues.
[2013-01-14 12:57:09 -0500] matti: ;/
[2013-01-14 12:58:51 -0500] battosai_: matti: hmm, so what do you suggest?  should I downgrade - say ruby 1.8, chef - 0.9?
[2013-01-14 12:59:43 -0500] matti: battosai_: No, no. 10.x is the way to go.
[2013-01-14 13:40:45 -0500] poseid: i am just playing with a centos 6.2 vagrant box
[2013-01-14 13:40:54 -0500] poseid: how would i update the ruby version with chef?
[2013-01-14 13:41:01 -0500] poseid: currently there is 1.8 installed
[2013-01-14 13:41:15 -0500] poseid: (I am using chef solo for this)
[2013-01-14 13:48:51 -0500] wassy121: Anyone here use chefspec for testing?  If so, could you maybe take a look at http://pastebin.ca/2301883 ?  It gives me an error that I can't seem to find the reason for.
[2013-01-14 13:49:12 -0500] user9910: specialsause: Do I need to create a new cookbook that will import the default apache one, or is it preferred to change the apache default but save it in site-specific cookbook folder?
[2013-01-14 13:53:05 -0500] matti: wassy121: It looks OK, to be honest.
[2013-01-14 13:53:22 -0500] matti: wassy121: Missing method is an issue, wonder why it does not have it.
[2013-01-14 13:54:20 -0500] wassy121: I don't want to say "I know, right"; but it seems like something underlying that it is either missing or not grabbing properly from the ChefSpec::ChefRunner
[2013-01-14 13:54:53 -0500] matti: wassy121: Does it work when you remove notify?
[2013-01-14 13:55:23 -0500] wassy121: yes
[2013-01-14 13:55:32 -0500] wassy121: just comment out line 13 from that pastebin
[2013-01-14 13:56:06 -0500] matti: Whoo.
[2013-01-14 13:56:12 -0500] matti: chefspec is a _LOT_ of magic.
[2013-01-14 13:57:28 -0500] cwj: user9910: per http://tickets.opscode.com/browse/CHEF-2308 the site-cookbooks "shadowing" is being deprecated and then removed. i would suggest that you create a new cookbook which uses include_recipe to include the default apache one, and modifies any of the apache cookbook's resources as needed
[2013-01-14 13:58:32 -0500] matti: wassy121: No idea if this will work, but add there 'include ChefSpec::Matchers' below requires.
[2013-01-14 14:06:20 -0500] wassy121: it still fails in the same way
[2013-01-14 14:10:11 -0500] zeroXten: ok, why is my chef.couch 151GB?
[2013-01-14 14:10:32 -0500] cwj: because you havent been compacting it?
[2013-01-14 14:11:00 -0500] cwj: http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server
[2013-01-14 14:11:14 -0500] zeroXten: just looking at that now, thanks
[2013-01-14 14:11:17 -0500] cwj: no
[2013-01-14 14:11:20 -0500] cwj: er np
[2013-01-14 14:11:27 -0500] zeroXten: heh
[2013-01-14 14:12:35 -0500] zeroXten: so I now have a small chef.couch.compact
[2013-01-14 14:12:42 -0500] zeroXten: but my chef.couch is the same
[2013-01-14 14:13:01 -0500] zeroXten: does it just take time or is it using the new file?
[2013-01-14 14:13:10 -0500] cwj: if your disk is too full, couch will not be able to finish creating the new file
[2013-01-14 14:13:36 -0500] cwj: if that is the case i think it continues using the old file
[2013-01-14 14:14:04 -0500] cwj: its been a while since i've had to mess with couch though, maybe check to see if its still running
[2013-01-14 14:14:17 -0500] zeroXten: ah yeah, very little space left
[2013-01-14 14:39:32 -0500] poseid: anyone has seen problems with libyaml?
[2013-01-14 14:39:35 -0500] poseid: I get a Error executing action `install` on resource 'package[libyaml-devel]'
[2013-01-14 14:39:51 -0500] poseid: No version specified, and no candidate version available for libyaml-devel
[2013-01-14 14:40:47 -0500] cwj: poseid: what platform are you on?
[2013-01-14 14:40:55 -0500] poseid: centos 6.3
[2013-01-14 14:41:03 -0500] cwj: and what cookbook are you getting that error from
[2013-01-14 14:41:10 -0500] poseid: rbenv_build
[2013-01-14 14:41:32 -0500] poseid: -> /cookbooks/ruby_build/recipes/default.rb:65:in `from_file'
[2013-01-14 14:41:40 -0500] poseid: its /cookbooks/ruby_build/recipes/default.rb:65:in `from_file'
[2013-01-14 14:41:54 -0500] poseid: oops.. double posted the line
[2013-01-14 14:42:26 -0500] cwj: looks like there is an issue for that
[2013-01-14 14:42:26 -0500] cwj: https://github.com/fnichol/chef-ruby_build/pull/8
[2013-01-14 14:42:31 -0500] cwj: just needs to be merged
[2013-01-14 14:42:38 -0500] cwj: you could fork the repo and apply it yourself
[2013-01-14 14:42:54 -0500] poseid: oh, ok.. thanks!
[2013-01-14 14:43:00 -0500] poseid: i ll try
[2013-01-14 14:46:00 -0500] cwj: np
[2013-01-14 14:46:36 -0500] poseid: yes... it looks good now
[2013-01-14 15:02:32 -0500] geekbri: is the chef API down again??
[2013-01-14 15:05:17 -0500] geekbri: anybody else getting 502 bad gateway errors with hosted chef
[2013-01-14 15:05:28 -0500] geekbri: seems like the gateway nginx is trying to pass too is down :)
[2013-01-14 15:07:39 -0500] autolykos: sorry guys, I feel pretty stupid to ask this question here, but my googling powers seem to have abandoned me
[2013-01-14 15:08:05 -0500] autolykos: I can't find a way to write a chef recipe to install a given mysql version
[2013-01-14 15:08:46 -0500] autolykos: recipe[mysql::server] does not seem to include a property for versions
[2013-01-14 15:09:01 -0500] autolykos: or at least I was not able to find it
[2013-01-14 15:09:17 -0500] autolykos: and for property I mean attribute
[2013-01-14 15:10:37 -0500] awgross: Any idea who's doing the Opscode Chef training in NYC on the 28th?
[2013-01-14 15:11:02 -0500] autolykos: I suspect I have to use the package resource, but I'd like to be pointed out at some references to setup, configure and launch a specific version of MySQL
[2013-01-14 15:11:12 -0500] autolykos: through chef
[2013-01-14 15:11:44 -0500] awgross: autolykos: check out the MySQL cookbook on the opscode cookbook site
[2013-01-14 15:11:55 -0500] autolykos: already did
[2013-01-14 15:12:28 -0500] autolykos: awgross can you point out a specific part of the cookbook?
[2013-01-14 15:12:57 -0500] awgross: for setting the version you are probably going to want to poke around in the attributes/ folder
[2013-01-14 15:13:14 -0500] awgross: i havent used the cookbook myself however
[2013-01-14 15:15:10 -0500] autolykos: awgross, yes I am an idiot :). node["mysql"]["package_name"] sounds pretty much what I needed
[2013-01-14 15:15:28 -0500] awgross: haha np we all miss things
[2013-01-14 15:24:45 -0500] poseid: sorry... i am again seeing something i cant see what the problem:
[2013-01-14 15:24:46 -0500] poseid: STDERR: httpd: Could not reliably determine the server's fully qualified domain name, using localhost.localdomain for ServerName
[2013-01-14 15:25:01 -0500] poseid: in the apache2 cookbook
[2013-01-14 15:26:01 -0500] awgross: poseid: what does hostname -f give you
[2013-01-14 15:26:11 -0500] awgross: compared to `hostname`
[2013-01-14 15:26:20 -0500] poseid: localhost
[2013-01-14 15:26:33 -0500] poseid: and localhost.localdomain
[2013-01-14 15:26:41 -0500] poseid:  for the other... it's a vagrant box
[2013-01-14 15:26:47 -0500] awgross: gotcha
[2013-01-14 15:26:54 -0500] awgross: seems to be why httpd is complaining
[2013-01-14 15:27:11 -0500] poseid: i can try to set a hostname with vagrant let's see
[2013-01-14 15:27:21 -0500] awgross: should be doable
[2013-01-14 15:29:31 -0500] pattersonc: what would be the best way to run chef-client for the simple purpose of updating node information (ip address)? for instance, an ec2 instance has an ip address change.
[2013-01-14 15:30:04 -0500] pattersonc: can i override the runlist to nothing?
[2013-01-14 15:30:08 -0500] matti: pattersonc: You mean feeding it back to server?
[2013-01-14 15:30:11 -0500] pattersonc: yes
[2013-01-14 15:30:25 -0500] matti: You can clean run list, yes.
[2013-01-14 15:30:27 -0500] pattersonc: but i don't want to actually run the nodes runlist (or change it)
[2013-01-14 15:30:54 -0500] awgross: pattersonc: i think you can specify a run list to chef-client on the command line using -j?
[2013-01-14 15:31:00 -0500] awgross: to pass in the json for the run?
[2013-01-14 15:31:16 -0500] awgross: i may have the wrong switch but you should be able to pass run specific data
[2013-01-14 15:32:00 -0500] pattersonc: there is -o to override the runlist
[2013-01-14 15:32:29 -0500] awgross: sounds promisin
[2013-01-14 15:32:31 -0500] awgross: g
[2013-01-14 15:33:05 -0500] Joel: I'm a bit lost on "best practice" when it comes to deploying rails apps. Do you guys use chef recipes to do this, or do you just use chef to get the box all set up, and come back and use something like capistrano? Right now I'm using vagrant/chef from the mindset of quickly spinning up environments developers can use and trash. Ideally I would like the scripts to be used for dev/beta/production as
[2013-01-14 15:33:07 -0500] Joel:  well.
[2013-01-14 15:33:33 -0500] pattersonc: Joel: looke at the application and application_rails cookbooks
[2013-01-14 15:34:27 -0500] Joel: pattersonc: will do, thanks.
[2013-01-14 15:34:45 -0500] pattersonc: Joel: also checkout the docs on deploy resource. as you will read the strategies were ported from capistrano
[2013-01-14 15:34:47 -0500] pattersonc: http://wiki.opscode.com/display/chef/Deploy+Resource
[2013-01-14 15:35:07 -0500] Joel: pattersonc: reading now :)
[2013-01-14 15:35:17 -0500] pattersonc: what would be the syntax for specifying a nil runlist?
[2013-01-14 15:35:22 -0500] pattersonc: []?
[2013-01-14 15:35:26 -0500] cwj: yep
[2013-01-14 15:36:41 -0500] pattersonc: doh:  `initialize': Unable to create Chef::RunList::RunListItem from String:"[]": must be recipe[] or role[]
[2013-01-14 15:36:52 -0500] pattersonc: tried recipe[], same thing...
[2013-01-14 15:38:38 -0500] lehrblogger: maybe you could make a throwaway role with an empty run list?
[2013-01-14 15:39:01 -0500] lehrblogger: although there's probably a more correct way :)
[2013-01-14 15:39:52 -0500] pattersonc: -o '' actually ran my normal runlist
[2013-01-14 15:48:55 -0500] cwj: pattersonc: what program are you passing these arguments to?
[2013-01-14 15:51:01 -0500] pattersonc: chef-client
[2013-01-14 15:51:43 -0500] cwj: what do you hope to achieve by running chef-client with an empty run list?
[2013-01-14 15:52:00 -0500] spox: storing ohai data about the node?
[2013-01-14 15:52:05 -0500] pattersonc: ohai sending updated node info to hosted chef
[2013-01-14 15:52:08 -0500] cwj: ah
[2013-01-14 15:52:37 -0500] pattersonc: we run deployment via knife ssh . 'chef-client'
[2013-01-14 15:53:18 -0500] cwj: yeah, so do we. i opted to implement a lockfile mechanism for our deployments, so they are skipped unless the lockfile is removed
[2013-01-14 15:53:40 -0500] cwj: so i can manage other parts of the system without needless deploys
[2013-01-14 15:54:06 -0500] cwj: im guessing that the override runlist feature wasn't built to handle an empty list
[2013-01-14 15:54:08 -0500] pattersonc: do you use deploy resource? it should skip deployment if the rev is the same
[2013-01-14 15:54:23 -0500] cwj: deploy doesn't, deploy_revision does
[2013-01-14 15:54:33 -0500] cwj: sometimes i want to deploy the same revision
[2013-01-14 15:54:38 -0500] cwj: for idiot reasons
[2013-01-14 15:54:39 -0500] pattersonc: im thinking a dummy recipe might be the path of least resistance
[2013-01-14 15:54:46 -0500] pattersonc: cwj: force_deploy?
[2013-01-14 15:54:57 -0500] cwj: some day
[2013-01-14 15:55:12 -0500] cwj: i have been rewriting our cookbooks using the application cookbook pattern
[2013-01-14 15:56:02 -0500] makerbreakr: hey, I am designing some systems
[2013-01-14 15:56:34 -0500] makerbreakr: Chef will be used to manage about 2000 digital signage systems, so I wont be needing to manage the more normal things on a server, other than the webserver
[2013-01-14 15:56:52 -0500] makerbreakr: I will need to manage things like fluxbox, xorg (nvidia and intel), chrome etc
[2013-01-14 15:57:08 -0500] makerbreakr: I am going to have to write a lot of the recipes from scratch, and I am trying to figure out the best way to do this
[2013-01-14 15:57:23 -0500] makerbreakr: I manage 3-4 other guys who have no experience with chef/ruby.
[2013-01-14 15:57:54 -0500] makerbreakr: Right now, my plan was to setup databags for each node, with resolution, # of out puts etc, and read the databags from the recipes
[2013-01-14 15:58:44 -0500] makerbreakr: https://gist.github.com/4531069
[2013-01-14 15:59:08 -0500] makerbreakr: and have them edit things appropos (including video_card (intel/nvidia) etc, and base the recipes on the databags
[2013-01-14 15:59:34 -0500] makerbreakr: is that the right way to design things? Or am I better off writing more individual recipes, rather than something monolithic, that relies on the JSON
[2013-01-14 15:59:43 -0500] makerbreakr: the databags*
[2013-01-14 16:00:42 -0500] KarlHungus: i would use data bags
[2013-01-14 16:00:48 -0500] matti: makerbreakr: Use attributes in cookbooks to use in recipes and over-write on node / role level.
[2013-01-14 16:01:00 -0500] matti: makerbreakr: Use data bags to provide eternal data about everything you like.
[2013-01-14 16:01:18 -0500] KarlHungus: data bags will allow you to share config in a r/w manner with other systems
[2013-01-14 16:01:18 -0500] matti: makerbreakr: And format JSON nicely ;]
[2013-01-14 16:01:38 -0500] makerbreakr: karlhungus, yes, that is another point, that I forgot to mention
[2013-01-14 16:01:57 -0500] makerbreakr: my intention is to then write a rails app, that abstracts away a lot of this stuff, that will allow anyone to manage things
[2013-01-14 16:03:09 -0500] makerbreakr: for example though, would you write a recipe named video_card, and then read in the databag, getting the video_card atribute
[2013-01-14 16:03:31 -0500] makerbreakr: and if it is intel, install intel drivers, and fi it is nvidia install nvida drivers?
[2013-01-14 16:05:28 -0500] KarlHungus: makerbreakr: i would drive that with ohai
[2013-01-14 16:06:03 -0500] KarlHungus: the host knows what video card it has. just expose that with an ohai plugin and let the cookbook's recipe act accordingly
[2013-01-14 16:13:27 -0500] lehrblogger: hi, i've been serving my (admittedly unpopular) website from an ec2 micro instance, but chef-client is capping the CPU (http://cl.ly/image/2U2s3a063Z2u) and it seems to have been failing for 12 hours
[2013-01-14 16:13:29 -0500] lehrblogger: should i just upgrade to a small? or is something else likely to be wrong?
[2013-01-14 16:19:54 -0500] Holos: I have a recipe i'm editing, to change a default based on the contents of a databag. I have a node.set['zabbix_windows']['agent']['servers'] = [db['proxy_servers'][node.domain]] to set the value.. but when my databag changes it doesn't get updated in the template driven config file. Is that the correct way of seeing a node variable?
[2013-01-14 16:20:23 -0500] Holos: it works the first time to set the value to be something other then the default, but if I change it in the databag it doesn't update
[2013-01-14 16:21:22 -0500] ranjibd: Holos, are you re-invoking the chef client after data bag change?
[2013-01-14 16:21:49 -0500] makerbreakr: karlhungus, where does ohai expose that at?
[2013-01-14 16:21:50 -0500] Holos: ranjibd: just running chef-client from the cli.. no version updates on the cookbook
[2013-01-14 16:22:13 -0500] ranjibd: Holos, that should pick up the data bag changes
[2013-01-14 16:22:20 -0500] ranjibd: how are you changing the data bag?
[2013-01-14 16:22:37 -0500] ranjibd: manually or via the recipe itself?
[2013-01-14 16:23:47 -0500] Holos: ranjibd: I edit the databag from the cli using knife "knife data bag edit zabbix_windows proxies"
[2013-01-14 16:25:07 -0500] ranjibd: Holos, then it should pick up the changes. you are using the community zabbix cookbook?
[2013-01-14 16:25:59 -0500] Holos: ranjibd: I'm using the Zabbix_Windows community cookbook, since it's for windows
[2013-01-14 16:28:41 -0500] KarlHungus: makerbreakr: it doesn't. but adding plugins to ohai is easy
[2013-01-14 16:30:38 -0500] Holos: ranjibd: I just updated the databag, and verified it with knife data bag show.. and re-ran the client, and it doesn't detect the change and update the custom node attribute
[2013-01-14 16:30:59 -0500] oddover: Hey chefs. Does anyone know of a good cookbook for configuring printing services (like CUPS)
[2013-01-14 16:31:14 -0500] hankx: Hi,
[2013-01-14 16:31:19 -0500] ranjibd: Holos, where you are using the node.set ?
[2013-01-14 16:31:25 -0500] ranjibd: in your recipe?
[2013-01-14 16:31:44 -0500] Holos: yes, before the recipe tells it to create the template..
[2013-01-14 16:32:49 -0500] Holos: https://gist.github.com/4531322 shows the code
[2013-01-14 16:33:30 -0500] hankx: Hey Ranjibd,
[2013-01-14 16:33:45 -0500] hankx: i'm very new chef and require one help
[2013-01-14 16:34:07 -0500] ranjibd: hankx, sure, shoot your question
[2013-01-14 16:34:32 -0500] hankx: i've jus uploaded my cookbook to chef server and want to associate it with chef client nodes
[2013-01-14 16:34:38 -0500] hankx: how do i do that ?
[2013-01-14 16:35:53 -0500] Holos: hankx: Edit the node runlist
[2013-01-14 16:36:35 -0500] hankx: how i can find that run list path
[2013-01-14 16:36:39 -0500] ranjibd: Holos, what does knife node shoe <node name> -a zabbix_windows.agent.servers return?
[2013-01-14 16:37:05 -0500] Holos: http://wiki.opscode.com/display/chef/Managing+Nodes+With+Knife
[2013-01-14 16:37:09 -0500] hankx: and do i have to run any knife command to see if myrecipe is working or not ?
[2013-01-14 16:37:12 -0500] ranjibd: hankx, knife node run_list add "recipe[name of the cookbook]"
[2013-01-14 16:37:28 -0500] ranjibd: that should suffice, for most cases,
[2013-01-14 16:38:08 -0500] ranjibd: Holos, the zabbix windows cookbook use those attributes directly in template
[2013-01-14 16:38:09 -0500] hankx: thanks Ranjibd , will try that
[2013-01-14 16:38:11 -0500] tesmar: hi all, I included the default mod_ssl recipe, but my site has an ssl error on it
[2013-01-14 16:38:30 -0500] tesmar: I am wondering how to enable ssl via the opscode apache2 cookbook?
[2013-01-14 16:39:17 -0500] Holos: ranjibd: the node show indicates the updated test1.domain.com.. the current config has test.domain.com
[2013-01-14 16:39:50 -0500] jtimberman: tesmar: use a template resource to write a virtualhost config file that has the SSL configuration for the site you want to setup, and then enable it with apache_site definition.
[2013-01-14 16:40:05 -0500] jtimberman: tesmar: and make sure apache2::mod_ssl is in the node's run list
[2013-01-14 16:40:53 -0500] tesmar: jtimberman: thank you. How do I call out the template for an apache virtual host from my app's recipe?
[2013-01-14 16:41:24 -0500] tesmar: I could just copy it to my cookbook, but there might be a better way...
[2013-01-14 16:41:45 -0500] Holos: ranjibd: If I delete the zabbix_agentd.conf file, and re-run chef it puts the test1.domain.com in there, so it seems that the checksum isn't working or something weird..
[2013-01-14 16:42:24 -0500] ranjibd: Holos, yes.
[2013-01-14 16:43:43 -0500] jtimberman: tesmar: put the template for the vhost in a separate recipe for your application's apache setup.
[2013-01-14 16:43:58 -0500] tesmar: jtimberman: thanks for your help
[2013-01-14 16:44:48 -0500] jtimberman: the "web_app" definition wraps up the template and apache_site together in a single thing to put in the recipe
[2013-01-14 16:45:18 -0500] jtimberman: there's examples in the apache2 README
[2013-01-14 16:53:16 -0500] mjolk: is it weird to call a require in a LWRP ?
[2013-01-14 16:53:47 -0500] mjolk: i'm building a git pull/ssh key validating LWRP and i need 'net/ssh', but i've yet to see a recipe that does this
[2013-01-14 16:55:01 -0500] awgross: mjolk: you should probably do that logic in a library file and call that library in your LWRP
[2013-01-14 16:55:13 -0500] poseid: hmm... now, I am still a bit stuck with the apache2 cookbook
[2013-01-14 16:55:15 -0500] mjolk: what do you mean "library file?"
[2013-01-14 16:55:26 -0500] poseid: I get: STDERR: Warning: DocumentRoot [/srv/www/my_site] does not exist
[2013-01-14 16:55:27 -0500] mjolk: OH
[2013-01-14 16:55:37 -0500] poseid: however, I had changed the directory earlier
[2013-01-14 16:55:37 -0500] mjolk: well, does that docroot exist poseid ?
[2013-01-14 16:55:45 -0500] mjolk: grep -Ri documentroot
[2013-01-14 16:56:10 -0500] poseid: I changed it to:   docroot "/var/www/..."
[2013-01-14 16:56:21 -0500] awgross: mjolk: cookbooks can have custom ruby libraries, they live in cookbook_name/libraries/, there are some examples floating around online
[2013-01-14 16:56:39 -0500] mjolk: just saw that awgross - for some reason i thought you meant shipping around some ruby library on the system
[2013-01-14 16:56:58 -0500] mjolk: cool, thanks awgross, i'm going to try to call a library from the provider
[2013-01-14 16:59:01 -0500] wassy121: Anyone here use chefspec for testing?  If so, could you maybe take a look at http://pastebin.ca/2301883 ?  It gives me an error that I can't seem to find the reason for.
[2013-01-14 17:00:03 -0500] mjolk: 12: #./cookbooks/php/spec/memcache_spec.rb: what's on line 12?
[2013-01-14 17:00:43 -0500] baz: anyone know why the opscode 'users' cookbook removes me from the 'sysadmin' group on every run? or rather how to stop it from doing so? :)
[2013-01-14 17:01:37 -0500] mjolk: baz : is there a "group 'sysadmin' do " line in that cookbook?
[2013-01-14 17:01:44 -0500] mjolk: if so, it probably defines the members
[2013-01-14 17:01:53 -0500] mjolk: *glances meaningfully at his tip jar*
[2013-01-14 17:03:45 -0500] wassy121: mjolk, line 12 is the pastebin's line 13
[2013-01-14 17:03:51 -0500] wassy121: the notify line
[2013-01-14 17:05:24 -0500] makerbreakr: is there an ohai plugin for video card info?
[2013-01-14 17:05:27 -0500] baz: mjolk: not that I can see, nor is there any such thing mentioned in the docs
[2013-01-14 17:05:51 -0500] mjolk: which repo are you using baz ?
[2013-01-14 17:05:57 -0500] mjolk: link to it
[2013-01-14 17:05:59 -0500] baz: mjolk: http://community.opscode.com/cookbooks/users
[2013-01-14 17:06:29 -0500] mjolk: are you removed and then readded?
[2013-01-14 17:06:32 -0500] baz: maybe I'm using the wrong tool - I just want to create a user account for myself on all the client nodes, with the same ssh key and with membership of the 'sysadmin' group
[2013-01-14 17:06:52 -0500] KarlHungus: makerbreakr: not that i'm aware of.
[2013-01-14 17:07:24 -0500] baz: mjolk: I've created a data bag with my user account in it, with the groups defined, including 'sysadmin' - when I run chef-client, it removes my account from all groups except the default
[2013-01-14 17:07:31 -0500] baz: very odd
[2013-01-14 17:07:33 -0500] KarlHungus: makerbreakr: but its not magic, if you're creating the rest of the chef stuff like you described it should be cake. just look to dmesg, lspci, or something liek that
[2013-01-14 17:07:35 -0500] mjolk: which "default"
[2013-01-14 17:07:40 -0500] makerbreakr: k
[2013-01-14 17:08:00 -0500] baz: well this is debian, so when you create a new user, it adds a group with the same name
[2013-01-14 17:08:04 -0500] mjolk: yes
[2013-01-14 17:08:24 -0500] baz: 'adduser foobar' creates a user 'foobar' in group 'foobar' - that's what I'm left with after I run chef-client
[2013-01-14 17:08:43 -0500] baz: I can run usermod to manually add 'foobar' to the 'sysadmin' group (which is created and exists, all looks good)
[2013-01-14 17:08:58 -0500] baz: but on the next run, the user is removed from that group
[2013-01-14 17:09:08 -0500] mjolk: sure
[2013-01-14 17:09:39 -0500] mjolk: https://github.com/opscode-cookbooks/users/blob/master/providers/manage.rb i wonder if line 81 is of interest
[2013-01-14 17:10:25 -0500] mjolk: post your databag
[2013-01-14 17:17:44 -0500] baz: mjolk: huh I can't reproduce it now - it happens for my account but not for others
[2013-01-14 17:23:43 -0500] makerbreakr: Karlhungus, I loaded a custom plugin, to read the PCI info
[2013-01-14 17:24:10 -0500] makerbreakr: am I going to have to just iterate over all the PCI devices, adn search for the two strings, or do you tihnk there is a better way?
[2013-01-14 17:24:42 -0500] mjolk: does your os have a more direct/less resource intensive way?
[2013-01-14 17:27:13 -0500] baz: ok I had some weirdness in my data bag - groups were somehow listed in a hash instead of a list
[2013-01-14 17:28:23 -0500] mjolk: knew it :D
[2013-01-14 17:30:07 -0500] baz: thanks for your time, still very new to this so it's hard to know where to start debugging!
[2013-01-14 17:31:39 -0500] mjolk: no worries, i'm coming over from puppet too
[2013-01-14 17:31:44 -0500] mjolk: so it helps me as well
[2013-01-14 17:32:52 -0500] baz__: mjolk: I'm coming from manually managing about 50+ servers, so despite the hiccups I am very happy :)
[2013-01-14 17:33:03 -0500] mjolk: woof.
[2013-01-14 17:51:50 -0500] pcn: What's the right way to resolve foodcritic's FC003?  E.g. what attribute/info distinguishes a solo run from a server run?
[2013-01-14 17:52:30 -0500] pcn: I'm working on cleaning up the cassandra cookbook, and I'd like to guard the search per FC003 so it can error if it's used on chef-solo
[2013-01-14 17:52:59 -0500] pcn: (it's appropriate in this case - the search functionality is being used in a specific cookbook to discover other nodes in a way that just won't work without chef-server)
[2013-01-14 17:56:00 -0500] pcn: Ah, I see: Chef::Config
[2013-01-14 18:08:43 -0500] jtimberman: pcn: yeah, Chef::Config[:solo] will be true if invoked from chef-solo.
[2013-01-14 18:09:33 -0500] pcn: jtimberman: Thanks, I just found that.  I have a follow-on question.  Is there an example of the right exception to raise when I'm on the wrong run type and this recipe is invoked?
[2013-01-14 18:11:15 -0500] pcn: E.g. is there a wiki page for foodcritic that describes standard ways to mitigate particular warnings like this?
[2013-01-14 18:11:39 -0500] jtimberman: pcn: i don't know if foodcritic has a particular page about it
[2013-01-14 18:12:42 -0500] pcn: jtimberman: OK, so from the chef side, what's the right exception to raise?
[2013-01-14 18:12:47 -0500] jtimberman: i don't have a specific recommended exception for it though.
[2013-01-14 18:13:19 -0500] jtimberman: I'd probably use Chef::Application.fatal!("This recipe isn't supported on Chef Solo.")
[2013-01-14 18:13:49 -0500] jtimberman: http://rubydoc.info/gems/chef/Chef/Application#fatal%21-class_method
[2013-01-14 18:14:29 -0500] pcn: Cool, that seems like a better way to handle it than what I was finding under Chef::Exceptions.
[2013-01-14 18:14:31 -0500] jtimberman: Here's all the Chef::Exception custom exceptions: http://rubydoc.info/gems/chef/Chef/Exceptions - but I don't know if one is particularly suited for this
[2013-01-14 18:14:41 -0500] jtimberman: Sounds like you found that then :)
[2013-01-14 18:14:44 -0500] pcn: Yeah, just now
[2013-01-14 18:37:18 -0500] c_t_: hrm, my google-fu is failing me
[2013-01-14 18:37:32 -0500] c_t_: is there a knife plugin somewhere for loading the contents of a file into an encrypted data bag?
[2013-01-14 18:39:19 -0500] ranjib_: c_t_, knife data bag from file --secret-file ?
[2013-01-14 18:39:52 -0500] amfred: Hi all!  I hope you might be able to help me.  I'm trying to figure out, given a node definition, a) what the run-list will be, and also determine b) what the attributes are that are exposed in the metadata files, and c) what other attributes are used in the recipes (say, in /recipe/attributes/default.rb).  Is there an API that can give me that information?
[2013-01-14 18:41:39 -0500] ranjib_: amfred, `knife node show <node name> -a run_list ` will give you the run_list of a node,
[2013-01-14 18:42:12 -0500] ranjib_: amfred, on the second question,  you mean metadata file of a cookbook?
[2013-01-14 18:42:13 -0500] amfred: ranjib, knife is not my preferred option; I'd rather use an API if I can
[2013-01-14 18:42:36 -0500] ranjib_: amfred, Chef::Node.load(<node_name>).run_list
[2013-01-14 18:42:47 -0500] amfred: Yes, recipe/metadata.rb for question b
[2013-01-14 18:43:07 -0500] amfred: Aha, I like Chef::Node.load(<node_name>).run_list
[2013-01-14 18:43:46 -0500] amfred: Let me see here...
[2013-01-14 18:43:48 -0500] tomdzk: amfred: just be aware that this will give you the un-expanded run list
[2013-01-14 18:44:14 -0500] amfred: Ah, meaning, if recipes or roles include other recipes, I won't get them back?
[2013-01-14 18:44:31 -0500] amfred: The expanded version would be more helpful; otherwise I'd have to recurse on it
[2013-01-14 18:44:40 -0500] tomdzk: amfred: yep, you'll have to expand it like so: node.run_list.expand(node.chef_environment).recipes
[2013-01-14 18:44:54 -0500] tomdzk: (when using chef server)
[2013-01-14 18:44:55 -0500] amfred: brilliant
[2013-01-14 18:45:49 -0500] amfred: FYI, I'm writting a little UI for a developers' tool, and I'm trying to let you enter values for the attributes in the recipes.  That's the end goal here.
[2013-01-14 18:46:16 -0500] kreedy: Is anyone else having problems with the new version of the passenger_apache2 cookbook? I'm getting "ERROR: Module passenger does not exist!" on execute("a2enmod passenger") on ubuntu 12.04.
[2013-01-14 18:46:26 -0500] kreedy: I'm willing to debug it further, but didn't want to put in the work if someone else already has a solution.
[2013-01-14 18:46:36 -0500] TheErik_: I've got a question about replacing the /etc/chef/validation.pem with one from a backup...
[2013-01-14 18:47:07 -0500] ranjib_: TheErik_, shoot
[2013-01-14 18:49:04 -0500] TheErik_: Has anyone managed to delete the validation certificate from the DB?  I can easily replace /etc/chef/validation.pem,  but Chef appears to cache a copy in it's DB.  I don't want it to create a new one, I want to force it to load one I manually replace the existing one with. Any ideas?
[2013-01-14 18:55:04 -0500] miah_: hi
[2013-01-14 18:55:35 -0500] c_t_: Haldo, miah
[2013-01-14 18:57:52 -0500] amfred: I'm looking at the knife docs, and I see that GET /nodes/NODE_NAME/cookbooks would get me the metadata in a useful format.   Would Chef::Node.load(<node_name>).cookbooks return something similar?
[2013-01-14 18:59:20 -0500] amfred: Actually: Chef::Node.load(<node_name>).run_list.expand(node.chef_environment).cookbooks
[2013-01-14 18:59:53 -0500] amfred: I can go play with this, I just wonder if it works that way
[2013-01-14 18:59:59 -0500] miah: look at the source
[2013-01-14 19:00:37 -0500] amfred: k
[2013-01-14 19:06:08 -0500] jtimberman: Opscode Open Source Code Review, Google+ Hangout: https://plus.google.com/hangouts/_/981c1d37d2b59c2ef2400c3066b9e7cd18bb7813 and Live YouTube stream: http://youtu.be/Ayd5HB-Lfbw
[2013-01-14 19:16:05 -0500] mattray: Spiceweasel 2.0 writeup: http://leastresistance.wordpress.com/2013/01/14/spiceweasel-2-0/
[2013-01-14 19:16:33 -0500] spox: awesome
[2013-01-14 19:17:02 -0500] spox: btw, mattray, spiceweasel is really super great
[2013-01-14 19:17:15 -0500] mattray: spox: thanks!
[2013-01-14 19:17:56 -0500] mattray: I'm adding more cluster stuff next, then Berkshelf & Librarian integration
[2013-01-14 19:18:22 -0500] miah: hot
[2013-01-14 19:18:33 -0500] mattray: and I need to do a write-up of a real world example
[2013-01-14 19:18:54 -0500] mattray: probably going to use my test-lab
[2013-01-14 19:19:15 -0500] spox: ah, fantastic. that latter part i was looking to implement in some external tooling
[2013-01-14 19:19:17 -0500] coderanger: Anyone want to take a glance at https://github.com/coderanger/psf-chef/tree/master/site-cookbooks/rsnapshot before I start ripping it into its own repo?
[2013-01-14 19:19:33 -0500] coderanger: Designed to be a simple backup-system-in-a-box cookbook
[2013-01-14 19:21:03 -0500] mattray: spox: I'm also hoping to get back to the lxc cookbook this week :)
[2013-01-14 19:21:32 -0500] spox: mattray: me too. i have some stuff queued up in the dev branch i need to get packaged up and released :)
[2013-01-14 19:21:59 -0500] mattray: so much code to write, so little time
[2013-01-14 19:22:09 -0500] KarlHungus: spiceweasel makes me wish i was on virtual servers instead of metal ;)
[2013-01-14 19:22:20 -0500] miah: mattray: so damned true
[2013-01-14 19:23:06 -0500] mattray: KarlHungus: working on APIs for metal, if I had time
[2013-01-14 19:25:24 -0500] KarlHungus: mattray: wouldnt that just be 'knife bootstrap'?
[2013-01-14 19:27:45 -0500] mattray: KarlHungus: yeah
[2013-01-14 19:28:06 -0500] mattray: KarlHungus: but if you have something like Razor or Crowbar with a knife plugin that would be sexier
[2013-01-14 19:28:21 -0500] mattray: a hardware cloud
[2013-01-14 19:29:46 -0500] KarlHungus: mattray: i like the sound of that
[2013-01-14 19:30:08 -0500] KarlHungus: mattray: i should do a bit of hacking and see what i can come up with
[2013-01-14 19:30:26 -0500] mattray: KarlHungus: work is already being done
[2013-01-14 19:30:45 -0500] miah: both razor and crowbar are quite interesting
[2013-01-14 19:30:47 -0500] mattray: KarlHungus: ping fnichol next time he's in here for the latest Chef/Razor news
[2013-01-14 19:31:05 -0500] miah: i kind of wish i had a big pool of hardware to test them out on (and some infinite time)
[2013-01-14 19:31:11 -0500] KarlHungus: i need to ping him on some stuff seth vargo was telling me anyhow
[2013-01-14 19:31:15 -0500] mattray: miah: see previous comments :)
[2013-01-14 19:31:17 -0500] KarlHungus: will do
[2013-01-14 19:31:24 -0500] miah: ya
[2013-01-14 19:31:55 -0500] mattray: Anything at #4 on my TODO is perpetually pushed out
[2013-01-14 19:32:06 -0500] miah: seriously
[2013-01-14 19:32:24 -0500] Zeelot: hey guys how do you install a package that requires you to accept a license?
[2013-01-14 19:32:47 -0500] Zeelot: I can't seem to install sun-java6-jdk
[2013-01-14 19:33:45 -0500] tomdzk: Zeelot: the note in the java cookbook doesn't work for you ? https://github.com/opscode-cookbooks/java
[2013-01-14 19:35:19 -0500] Zeelot: tomdzk: I don't see a note about a license
[2013-01-14 19:35:49 -0500] tomdzk: Zeelot: "Important Note" in the readme: "the java::oracle recipe forces you to set either override the node['java']['oracle']['accept_oracle_download_terms'] to true or set up a private repository accessible by HTTP."
[2013-01-14 19:36:14 -0500] Zeelot: ah
[2013-01-14 19:36:31 -0500] pwelch: what would be the best way to use a template from another cookbook that is include in the run?
[2013-01-14 19:36:34 -0500] Zeelot: do you happen to know where that's used?
[2013-01-14 19:36:36 -0500] pwelch: define a definition?
[2013-01-14 19:37:23 -0500] tomdzk: pwelch: the template resource has a "cookbook" attribute for this
[2013-01-14 19:37:46 -0500] pwelch: tomdzk: Thanks!
[2013-01-14 19:39:52 -0500] jkyle: should this work? seems like it should: knife node show apimatrix.stage.dfw2.tfoundry.com -a users.username
[2013-01-14 19:41:30 -0500] mattray: jkyle: probably, assuming knife node show http://apimatrix.stage.dfw2.tfoundry.com/ works and -a users.username exists
[2013-01-14 19:41:43 -0500] Zeelot: tomdzk: I don't get it, that value isn't used on any of the recipe files
[2013-01-14 19:42:25 -0500] jkyle: the user exists, I get this error => ERROR: TypeError: can't convert String into Integer. Let me see if I can drill down
[2013-01-14 19:43:12 -0500] jkyle: if I do -a users, it lists the user like I'd expect
[2013-01-14 19:43:49 -0500] jbz: Does it list users by username or uid?
[2013-01-14 19:43:52 -0500] jbz: oh
[2013-01-14 19:43:54 -0500] jkyle: username
[2013-01-14 19:43:58 -0500] jbz: n/m you just said, sorry lol
[2013-01-14 19:44:12 -0500] kreedy: have a fix for the passenger_apache2 cookbook if anyone needs it. also poked my boss again about getting the CCLA signed
[2013-01-14 19:44:21 -0500] c_t_: woo, zeus traffic manager cookbook is ready for testing
[2013-01-14 19:46:28 -0500] PierreO: Hi guys, I'm hacking on nginx recipe, and I'm trying to pass the tests before doing a pull request, but...
[2013-01-14 19:46:31 -0500] PierreO: pierres-imac in ~/chef/cookbooks/nginx
[2013-01-14 19:46:31 -0500] PierreO:  |COOK-2209 |  kitchen init
[2013-01-14 19:46:32 -0500] PierreO: /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/1.9.1/rubygems/specification.rb:1625:in `raise_if_conflicts': can't activate json-1.7.5, already activated json-1.5.4 (Gem::LoadError)
[2013-01-14 19:46:44 -0500] PierreO: Anybody has an idea?
[2013-01-14 19:47:56 -0500] mattt: does the chef omnibus install not provide an init script?
[2013-01-14 19:49:19 -0500] karna: is anyone there?
[2013-01-14 19:49:23 -0500] jkyle: could, maybe, someone else try that query so I can determine if it's just my system or if it's expected behavior?
[2013-01-14 19:49:44 -0500] karna: I have an error in executing chef !
[2013-01-14 19:49:53 -0500] karna: NoMethodError ------------- undefined method `service' for Chef::Resource::Execute
[2013-01-14 19:50:45 -0500] PierreO: mattt:why do you need a init sript? it's for a chef client right?
[2013-01-14 19:52:11 -0500] PierreO: karna:you don't have a line number in your error? Making a reference to a recipe?
[2013-01-14 19:52:36 -0500] karna: yeah I do have it !
[2013-01-14 19:53:03 -0500] mattt: PierreO: correct -- don't i need the chef-client to daemonize on boot ?
[2013-01-14 19:53:06 -0500] PierreO: And, what do you have in your recipe?
[2013-01-14 19:53:29 -0500] karna: I'm installing hadop namenode recipe
[2013-01-14 19:53:31 -0500] PierreO: mattt: nope 'cause you call the chef client when needed
[2013-01-14 19:53:33 -0500] karna: hadoop
[2013-01-14 19:53:41 -0500] mattt: PierreO: bro that's crazy
[2013-01-14 19:54:31 -0500] tomdzk: Zeelot: this attribute is fairly recent, did you check your java cookbook version ? It is used here: https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb
[2013-01-14 19:55:18 -0500] mattt: PierreO: when i install from opscode apt repo i get a chef-client init script, and the client daemonizes on boot
[2013-01-14 19:55:47 -0500] Zeelot: I'm not using the cookbooks, I was mostly wondering how I can make chef accept the terms for me when installing a package of any kind
[2013-01-14 19:55:57 -0500] Zeelot: but maybe I'll just use the cookbook =/
[2013-01-14 19:56:06 -0500] PierreO: karna: so what's the line? the recipe?
[2013-01-14 19:56:34 -0500] tomdzk: Zeelot: yeah, that might be the simplest option; or you look at the link I posted - lines 58ff show how it installs java
[2013-01-14 19:56:35 -0500] spox: mattt: no init scripts from the omnibus install
[2013-01-14 19:57:00 -0500] spox: mattt: you can use the chef-client cookbook to install them for you when you provision
[2013-01-14 19:57:06 -0500] PierreO: mattt: I'm not using chef client, but just chef solo, and for me they work the same way : "ssh myserver exec chef options"
[2013-01-14 19:57:11 -0500] karna: it's 346 and 347
[2013-01-14 19:57:39 -0500] karna: I'm trying in another way and let you know it !
[2013-01-14 19:57:53 -0500] mattt: spox: ah, chef-client cookbook ...
[2013-01-14 19:59:04 -0500] mattt: PierreO: i like running the client in daemon mode, that ways you'll get eventual consistency without having to force a run on each node
[2013-01-14 19:59:11 -0500] Zeelot: tomdzk: thanks for the info
[2013-01-14 19:59:24 -0500] tomdzk: Zeelot: np
[2013-01-14 20:00:12 -0500] jtimberman: mattt: the reason for the debian package starting the service is related to debian packaging policy about packages that provided a daemon, that it should be started at package installation.
[2013-01-14 20:00:33 -0500] jtimberman: mattt: its the "least surprising" thing to people who prefer and use the apt repository/packages for installing Chef.
[2013-01-14 20:00:43 -0500] spox: because why would packages simply install files!?
[2013-01-14 20:01:42 -0500] mattt: jtimberman: ok, that makes sense :)
[2013-01-14 20:04:53 -0500] PierreO: mattt: ok, I didn't know :) Thanks !
[2013-01-14 20:08:49 -0500] oddover: Hey chefs. Does anyone know a good cookbook for configuring printing services (like CUPS)?
[2013-01-14 20:09:45 -0500] WPsites: I'm using a git resource and can set the owner/group and that works fine. I'm using the template resource and I've set the owner/group and that is getting a permission denied, almost like it's ignoring the owner/group. Any ideas whats going on here?
[2013-01-14 20:13:10 -0500] jtimberman: spox: that's another matter entirely ;)
[2013-01-14 20:14:18 -0500] WPsites: any idea where I can browse the source of the template provider?
[2013-01-14 20:15:10 -0500] mattt: WPsites: you tried running w/ debug ?
[2013-01-14 20:15:39 -0500] PierreO: (Ok, for my issue with test-kitchen, I uninstalled json 1.5.4 and reinstalled test-kitchen and it worked.)
[2013-01-14 20:15:44 -0500] WPsites: just doing that now
[2013-01-14 20:15:54 -0500] oddover: WPsites: Here's the source for it: https://github.com/opscode/chef/blob/master/lib/chef/provider/template.rb
[2013-01-14 20:16:51 -0500] mattt: WPsites: chef-client -l debug IIRC
[2013-01-14 20:18:57 -0500] WPsites: doesn't tell me much more    Error executing action `create_if_missing` on resource . Permission denied
[2013-01-14 20:20:46 -0500] coderanger: WPsites: Are you running chef-client as root?
[2013-01-14 20:20:50 -0500] WPsites: The recipe is trying to write a config file the resides on a NFS share. so root is squished and cannot create the file. I've set owner/groupd on the template resource which should create it with that owner/group but it's not. The git resource just above it works fine and does take care of the owner/group
[2013-01-14 20:22:46 -0500] WPsites: the compiled resource has the correct owner/group but it's obviously not using it otherwise it would be created just like the git resource creates files on that share
[2013-01-14 20:25:55 -0500] coderanger: WPsites: The way git and templates work is a bit different
[2013-01-14 20:26:09 -0500] coderanger: git actually setuid's to that user when it runs the git subproc
[2013-01-14 20:26:22 -0500] coderanger: templates are written out from Ruby (read: chef-client) itself
[2013-01-14 20:26:30 -0500] coderanger: so it writes as root and then chown/chmod
[2013-01-14 20:26:57 -0500] coderanger: You can see it in the code, write to temp file, set ACL params, rename into place
[2013-01-14 20:26:57 -0500] Leitz: Is there a way to do something like "knife node edit server.com" to do the same change to lots of nodes?
[2013-01-14 20:27:08 -0500] coderanger: Leitz: Make a little knife exec script
[2013-01-14 20:27:16 -0500] coderanger: Or use pychef et al :)
[2013-01-14 20:27:33 -0500] Leitz: coderanger, new-ish to chef.
[2013-01-14 20:27:51 -0500] coderanger: What kind of change are you trying to make?
[2013-01-14 20:27:54 -0500] paulmooring: Leitz: That's a good indicator a role might be the way to go
[2013-01-14 20:27:57 -0500] Leitz: Are the node files stored in text anywhere?
[2013-01-14 20:28:16 -0500] Leitz: Change the environment file they point to.
[2013-01-14 20:28:22 -0500] oddover: atomic-penguin: you around?
[2013-01-14 20:28:24 -0500] paulmooring: Leitz: You can get them with `knife node show $NODE_NAME -Fj > node.json
[2013-01-14 20:28:40 -0500] coderanger: Leitz: What do you know best, ruby, python, java?
[2013-01-14 20:28:45 -0500] paulmooring: then make your changes and 'knife node from file node.json
[2013-01-14 20:28:50 -0500] Leitz: Bash.  :)
[2013-01-14 20:28:59 -0500] coderanger: Leitz: Time to learn Ruby or Python then :P
[2013-01-14 20:29:01 -0500] mattt: :)
[2013-01-14 20:29:10 -0500] Leitz: Bit if what paulmooring says is true I can use a little sed and have a great time.
[2013-01-14 20:29:28 -0500] coderanger: Yeah, workable but will be very slow and error prone
[2013-01-14 20:29:40 -0500] coderanger: JSON and sed reeeeeeally don't get along
[2013-01-14 20:29:46 -0500] Leitz: coderanger, you used the word "best". My php and python aren't as good as my bash.
[2013-01-14 20:29:46 -0500] coderanger: or rather, JSON and regexes
[2013-01-14 20:30:00 -0500] bmhatfield: I have a somewhat odd chef question: If I had a directory that was managed exclusively by chef (eg; application.d/ configuration files or something like that), does anyone have experience cleaning up that directory *WITHOUT* deleting it?
[2013-01-14 20:30:11 -0500] Leitz: Lemme see what I can do, thanks!
[2013-01-14 20:30:33 -0500] bmhatfield: I have an almost-idea on how to do this, but I'm not sure how to pull the information I want out of Chef to do it.
[2013-01-14 20:30:37 -0500] coderanger: Leitz: Heh, in Python: pip install pychef; python -c 'import chef; api = chef.autoconfigure(); for node in chef.Node.list().itervalues(): node.chef_environment = 'asdf'; node.save()
[2013-01-14 20:30:47 -0500] tomdzk: coderanger: use jq, http://stedolan.github.com/jq/
[2013-01-14 20:30:47 -0500] coderanger: Leitz: Insert newlines as needed, but you get the idea
[2013-01-14 20:30:48 -0500] mattt: pychef?  neat
[2013-01-14 20:31:28 -0500] coderanger: bmhatfield: Just directory '...' do action :delete end
[2013-01-14 20:31:56 -0500] coderanger: mattt: Client bindings in ruby, python, java, and hideously unsupported php :)
[2013-01-14 20:32:07 -0500] coderanger: and I know someone is working on JS bindings
[2013-01-14 20:32:25 -0500] bmhatfield: coderanger: Say I wanted a cleaner way of implementing this without deleting files and having chef recreate them
[2013-01-14 20:32:40 -0500] coderanger: bmhatfield: Ahh, you just want to delete everything that isn't from chef?
[2013-01-14 20:32:47 -0500] bmhatfield: Exactly
[2013-01-14 20:33:00 -0500] bmhatfield: The motives for doing such a thing are pure, I assure you
[2013-01-14 20:33:05 -0500] bmhatfield: In this particular case.
[2013-01-14 20:33:10 -0500] coderanger: bmhatfield: https://github.com/coderanger/chef-collectd/blob/master/recipes/default.rb#L64
[2013-01-14 20:33:12 -0500] mattt: bmhatfield: hotel?
[2013-01-14 20:33:36 -0500] bmhatfield: I'm sorry, hotel?
[2013-01-14 20:33:45 -0500] mattt: bmhatfield: it was a long shot, but guess it's not you :P
[2013-01-14 20:33:50 -0500] coderanger: bmhatfield: You'll need to tweak it a bit, but you get the idea I hope :)
[2013-01-14 20:34:54 -0500] bmhatfield: Ah, that's a clever idea, but not 100% of what I need, sorry for leaving out this detail: some of the things in this directory will have been previously created by chef, but the resources will have been outright removed from the recipe rather than having action :delete specified on them
[2013-01-14 20:35:05 -0500] bmhatfield: So what I was thinking
[2013-01-14 20:35:17 -0500] coderanger: bmhatfield: Thats what that does
[2013-01-14 20:35:31 -0500] coderanger: It looks for any files in that folder that don't correspond to a resource
[2013-01-14 20:35:35 -0500] coderanger: and then deletes those
[2013-01-14 20:35:41 -0500] bmhatfield: Oh!!
[2013-01-14 20:35:54 -0500] bmhatfield: I misinterpreted that resources() call
[2013-01-14 20:36:11 -0500] bmhatfield: Wow, that's WAY easier than I thought it would be
[2013-01-14 20:36:27 -0500] bmhatfield: Is there anywhere I can find documentation about that "resources()" call?
[2013-01-14 20:36:38 -0500] bmhatfield: I'd like to read more and understand it before I do anything with it.
[2013-01-14 20:37:29 -0500] coderanger: bmhatfield: https://github.com/opscode/chef/blob/master/lib/chef/recipe.rb
[2013-01-14 20:37:33 -0500] coderanger: It is pretty simple
[2013-01-14 20:37:44 -0500] coderanger: Those are the extra magic methods you get in recipe code
[2013-01-14 20:37:56 -0500] mattt: someone say magic
[2013-01-14 20:39:12 -0500] bmhatfield: Most excellent.
[2013-01-14 20:39:20 -0500] bmhatfield: coderanger: PS: Thank you for PyChef
[2013-01-14 20:39:31 -0500] coderanger: :-)
[2013-01-14 20:39:45 -0500] bmhatfield: I made this with it: https://github.com/bmhatfield/chef-deregistration-manager
[2013-01-14 20:39:51 -0500] atomic-penguin: oddover, I am
[2013-01-14 20:40:21 -0500] atomic-penguin: oddover, what is up?
[2013-01-14 20:40:23 -0500] coderanger: bmhatfield: Cool!
[2013-01-14 20:42:16 -0500] iverson0881: @bmhatfield i think the most interesting part there is the fabfile integration
[2013-01-14 20:42:25 -0500] iverson0881: bmhatfield: will definitely take a look
[2013-01-14 20:42:51 -0500] coderanger: iverson0881: Let me know if you have any questions
[2013-01-14 20:43:14 -0500] mjolk: bmhatfield thanks, this is interesting
[2013-01-14 20:43:38 -0500] coderanger: pychef has been kind of dormant lately, haven't really needed to add much to it :)
[2013-01-14 20:48:06 -0500] jkyle: it really seems like, from the behavior of other attributes, you should be able to introspect user data with knife. I'm beginning to wonder if this is a bug
[2013-01-14 20:48:42 -0500] coderanger: jkyle: What are you trying to do?
[2013-01-14 20:50:28 -0500] jkyle: knife node show foo.com -a users.username.dir
[2013-01-14 20:51:09 -0500] jkyle: to find the home directory for a given user on a system. Any attribute query below the top level 'user' attribute throws a ERROR: TypeError: can't convert String into Integer
[2013-01-14 20:51:41 -0500] jkyle: usually see that when you try to key an array
[2013-01-14 20:52:33 -0500] bmhatfield: coderanger: Do you have any suggestions for abstracting that ruby block out such that I could call it from multiple recipes?
[2013-01-14 20:52:44 -0500] bmhatfield: I have 3 or 4 configuration directories I would want to use it on I think
[2013-01-14 20:52:55 -0500] bmhatfield: It would be nice if I could follow DRY for it
[2013-01-14 20:53:00 -0500] jkyle: this works better: -a etc.passwd.deploy
[2013-01-14 20:53:26 -0500] coderanger: bmhatfield: Just make an LWRP that takes the folder name and maybe some resource type info
[2013-01-14 20:54:21 -0500] bmhatfield: coderanger: Good call. Silly me. Thanks, will do.
[2013-01-14 20:57:37 -0500] miah: lwrp all the things
[2013-01-14 20:58:28 -0500] thehar: lol
[2013-01-14 20:59:36 -0500] mattt: always think of LARPing when i see LWRP :(
[2013-01-14 21:00:00 -0500] miah: lighting bolt!
[2013-01-14 21:20:07 -0500] makerbreakr: how do i pull get an item in a databag in shef?
[2013-01-14 21:20:20 -0500] makerbreakr: by databags name is node_databags, and I am trying to get test_install
[2013-01-14 21:20:26 -0500] makerbreakr: I keep getting arugment errors
[2013-01-14 21:20:41 -0500] makerbreakr: so i think I am not getting the syntax correct
[2013-01-14 21:26:07 -0500] whilp: data_bag_item("node_databags", "test_install") ?
[2013-01-14 21:28:01 -0500] makerbreakr: whilp, i think its looking locally for databags using that way
[2013-01-14 21:28:32 -0500] makerbreakr:  databags(:node_databags) this returns the items in the databags, but I cant figure out how to load one item
[2013-01-14 21:28:36 -0500] whilp: locally? are you running shef in client mode?
[2013-01-14 21:29:16 -0500] makerbreakr: im running it from my workstation, Data bag path '/var/chef/data_bags' is invalid
[2013-01-14 21:29:23 -0500] whilp: shef -zc /path/to/your/client.rb should mean that data_bag/data_bag_item calls go to the server
[2013-01-14 21:29:48 -0500] emanuelez: what's a good way to deal with security updates on (for example) ubuntu nodes?
[2013-01-14 21:30:00 -0500] makerbreakr: whilp, it is pulling from my server
[2013-01-14 21:31:17 -0500] makerbreakr: there we go, thanks
[2013-01-14 21:31:30 -0500] whilp: what did the trick? (for the archives)
[2013-01-14 21:31:44 -0500] makerbreakr: i guess, I wasnt running in client mode
[2013-01-14 21:31:59 -0500] makerbreakr: even though databags(:node_databags) was pulling from the server
[2013-01-14 22:06:31 -0500] makerbreakr: ["screen", {"id"=>1965, "path"=>"http://localhost/1965/index.html"}]
[2013-01-14 22:06:42 -0500] makerbreakr: if pp screen equals that, how do i access id?
[2013-01-14 22:07:02 -0500] matti: foo[0]['id']
[2013-01-14 22:07:19 -0500] matti: makerbreakr: Fire up irb and experiment.
[2013-01-14 22:08:05 -0500] makerbreakr: i think i have tried every iteration
[2013-01-14 22:08:06 -0500] makerbreakr: heh
[2013-01-14 22:08:12 -0500] makerbreakr: but ill give it a go in irb
[2013-01-14 22:08:12 -0500] matti: He?
[2013-01-14 22:08:22 -0500] kreedy: anyone know off hand how to get the current git hash being used in an application or deploy_revision? i'd like to then take it and node.set["appname"]["version"] = hash
[2013-01-14 22:08:52 -0500] matti: Pardon index will be 1.
[2013-01-14 22:09:18 -0500] matti: makerbreakr:
[2013-01-14 22:09:19 -0500] matti: (main):001:0> x = ["screen", {"id"=>1965, "path"=>"http://localhost/1965/index.html"}]
[2013-01-14 22:09:22 -0500] matti: => ["screen", {"id"=>1965, "path"=>"http://localhost/1965/index.html"}]
[2013-01-14 22:09:24 -0500] matti: (main):002:0> x[1]['id']
[2013-01-14 22:09:27 -0500] matti: => 1965
[2013-01-14 22:27:07 -0500] jkyle: If a cookbook doesn't work with its default configuration, would that be considered a bug? Not sure if that's a QA goal for opscode cookbooks or not.
[2013-01-14 22:28:31 -0500] bluepojo: probably, in my experience opscode would accept a pull request that fixes such an issue
[2013-01-14 22:28:32 -0500] juliancdunn: jkyle: I'd consider that a bug, personally
[2013-01-14 22:28:33 -0500] bluepojo: jkburges:
[2013-01-14 22:28:34 -0500] bluepojo: err
[2013-01-14 22:28:35 -0500] bluepojo: jkyle:
[2013-01-14 22:31:08 -0500] jkyle: cool
[2013-01-14 22:32:13 -0500] kreedy: best way i can find to get the app's current git hash and store it in an attribute is: node.set["appname"]["version"] = release_path.split("/").last in the after_restart block. anyone have a better way?
[2013-01-14 22:35:44 -0500] oddover: atomic-penguin: you still around now?
[2013-01-14 22:38:14 -0500] tolland: its good to see there are some 3rd party contributions to the wiki ;-)
[2013-01-14 22:38:38 -0500] tolland: "Online Shopping is very easy and practical it is today and has become a way of life the era of globalization of technology. But convenience is often used by those who are not responsible. So secure is it to shop online? Listen tip shop safe in the following  Ekiosku.com jual beli online aman menyenangkan"
[2013-01-14 22:52:43 -0500] bmhatfield: coderanger: any idea why resources() in shef returns an array of resource names when it does not in actual chef?
[2013-01-14 22:53:15 -0500] coderanger: bmhatfield: Different functions?
[2013-01-14 22:54:17 -0500] bmhatfield: It must be, I just can't figure out how
[2013-01-14 22:54:27 -0500] bmhatfield: I'm in recipe context
[2013-01-14 22:54:32 -0500] coderanger: Sorry, dealing with our nagios eating its own face right now
[2013-01-14 22:54:37 -0500] bmhatfield: no worries
[2013-01-14 22:54:42 -0500] bmhatfield: either way, it's doing this: run_context.resource_collection.instance_variable_get(:@resources_by_name).keys
[2013-01-14 22:54:42 -0500] bugoff: how to match debian version 6.0.x
[2013-01-14 22:54:46 -0500] bmhatfield: which is spiffy
[2013-01-14 22:58:16 -0500] coderanger: Eventual consistency strikes again
[2013-01-14 22:59:56 -0500] bmhatfield: hoorah
[2013-01-14 23:03:41 -0500] ahammond: how do I add a role to a node? I've tried knife node run_list add auto01 "role[jenkins]", but that only changes the Run list. How do I get jenkins added to the Roles?
[2013-01-14 23:05:08 -0500] tomdzk: ahammond: does this help ? http://docs.opscode.com/essentials_roles_formats.html
[2013-01-14 23:05:17 -0500] tomdzk: ahammond: you basically need to create such a role yourself
[2013-01-14 23:05:50 -0500] ahammond: tomdzk: ok, I'll chase that down
[2013-01-14 23:06:48 -0500] tomdzk: ahammond: simplest way is to first determine the list of recipes you need to apply (e.g. make the run_list consist entirely of recipes), and once you have that working, create a role out that list of recipes
[2013-01-14 23:08:17 -0500] ahammond: tomdzk: I tried creating the role already. I did knife role from file roles/jenkins.rb and it didn't barf
[2013-01-14 23:08:46 -0500] tomdzk: ahammond: and that file exists, roles/jenkins.rb ?
[2013-01-14 23:09:01 -0500] tomdzk: and it references a bunch of recipes/other roles >
[2013-01-14 23:09:02 -0500] tomdzk: ?
[2013-01-14 23:09:04 -0500] ahammond: tomdzk: and knife role show jenkins succeeds (it's pretty minimal to start with
[2013-01-14 23:09:11 -0500] ahammond: tomdzk: references one other recipe
[2013-01-14 23:09:24 -0500] tomdzk: ahammond: then you should only need to run chef-client on the node in order to apply that run list
[2013-01-14 23:10:13 -0500] ahammond: tomdzk: so, node edit sets the runlist, then chef-client does something and then node show can see it's in the Role list?
[2013-01-14 23:11:22 -0500] tomdzk: ahammond: "knife node run_list add" etc. only change info on the chef server, they don't directly affect the actual node/machine
[2013-01-14 23:11:50 -0500] tomdzk: you'll have to run chef-client on the machine itself in order to update it (either manually or via a cron job)
[2013-01-14 23:12:43 -0500] hachi: hello folks
[2013-01-14 23:12:54 -0500] oddover: atomic-penguin: you around?
[2013-01-14 23:13:07 -0500] ahammond: tomdzk: so when I run knife node show auto-1, I do not see jenkins listed under Roles, although role[jenkins] is in the Run List. How do I get it to be listed as a Role, too?
[2013-01-14 23:13:11 -0500] hachi: I'm having a hard time searching for this with google, but does anyone know how you load a public key for a user upon creation, rather than having chef generate one?
[2013-01-14 23:13:28 -0500] oddover: for everyone else: does anyone know of a good cookbook for managing CUPS/printing stuff?
[2013-01-14 23:15:04 -0500] ahammond: hachi: load?
[2013-01-14 23:15:26 -0500] ahammond: hachi: you mean, you create a user and you want to create an ssh key-pair at the same time?
[2013-01-14 23:15:27 -0500] hachi: I don't see a load command :\
[2013-01-14 23:15:48 -0500] hachi: not ssh key pair, I want to not create an RSA key for the user at the same time
[2013-01-14 23:16:01 -0500] hachi: knife client create, set the public key... don't generate one for me
[2013-01-14 23:17:02 -0500] miah: knife client create <client> will create a client with that name. you can create your .pem file using the -F argument
[2013-01-14 23:17:14 -0500] hachi: but that gives me the private key
[2013-01-14 23:17:18 -0500] hachi: I already have one I want to use
[2013-01-14 23:17:30 -0500] hachi: I want to tell chef to create the client with the public key I supply
[2013-01-14 23:17:53 -0500] ahammond: how do I assign a Role to a node? I've done knife node run_list add auto01 "role[jenkins]", but that only changes the Run List. How do I get jenkins added to the Roles? (as seen by knife node show auto01)
[2013-01-14 23:20:16 -0500] bmhatfield: hachi: The only way you can do that is to directly insert the private side of the key into couch.
[2013-01-14 23:20:29 -0500] hachi: huh?
[2013-01-14 23:20:38 -0500] hachi: the server shouldn't need my private key, should it?
[2013-01-14 23:20:42 -0500] bmhatfield: er
[2013-01-14 23:20:44 -0500] bmhatfield: sorry, typo
[2013-01-14 23:20:50 -0500] bmhatfield: I meant to say public
[2013-01-14 23:20:52 -0500] bmhatfield: :-)
[2013-01-14 23:20:54 -0500] bmhatfield: Either way
[2013-01-14 23:21:04 -0500] bmhatfield: the chef APIs have no way to provide a key
[2013-01-14 23:21:08 -0500] bmhatfield: which means knife can't do it
[2013-01-14 23:21:13 -0500] hachi: I'm just... a little baffled, because I can't find any way to do this while keeping my private key... private
[2013-01-14 23:21:39 -0500] bmhatfield: You can edit the client in couch
[2013-01-14 23:21:41 -0500] bmhatfield: that's it.
[2013-01-14 23:22:14 -0500] bmhatfield: I traced this all the way out because I feel the same way as you :-)
[2013-01-14 23:23:02 -0500] hachi: this is badly broken... chef uses keys for security, but then doesn't even let me securely create them
[2013-01-14 23:26:17 -0500] kallistec: in chef 11 you can give the server a public key of your choosing
[2013-01-14 23:30:11 -0500] atomic-penguin: oddover, yes
[2013-01-14 23:30:28 -0500] hachi: hmm, I'm looking for chef 11 in debian, is debian behind on releases?
[2013-01-14 23:31:12 -0500] atomic-penguin: oddover, what is it that you wanted to ask?
[2013-01-14 23:31:14 -0500] kallistec: hachi: it's not released yet, so for now you have to deal with it or edit things in couchdb
[2013-01-14 23:31:19 -0500] hachi: :\
[2013-01-14 23:31:30 -0500] kallistec: it's coming soon though
[2013-01-14 23:31:42 -0500] oddover: atomic-penguin: I was googling, and I saw that you had a cookbook for cups. Is that available online somewhere?
[2013-01-14 23:32:43 -0500] atomic-penguin: oddover, no, but I can probably send you the code
[2013-01-14 23:33:15 -0500] oddover: atomic-penguin: ok. how do you want to do that?
[2013-01-14 23:33:22 -0500] kallistec: fwiw: http://wiki.opscode.com/display/chef/Chef+11+Server+Preview
[2013-01-14 23:34:45 -0500] atomic-penguin: oddover, it doesn't actually manage the server
[2013-01-14 23:35:23 -0500] oddover: ok. what does it do?
[2013-01-14 23:36:02 -0500] atomic-penguin: oddover, it installs cups on the client, turns off the cups service and sets the cups server.  Also tries to copy the lpoptions file from the cups server itself
[2013-01-14 23:36:41 -0500] atomic-penguin: I see no reason I couldn't filter branch it and put it up on github for you
[2013-01-14 23:36:44 -0500] oddover: ok. that's basically what I'm looking for then
[2013-01-14 23:36:56 -0500] oddover: that'd be awesome
[2013-01-14 23:38:02 -0500] oddover: also, I don't know if you remember, but I was working on a cookbook for iptables a while back. I'm almost finished with it. I have one or two more kinks to work out.
[2013-01-14 23:38:54 -0500] oddover: I remember that you were interested in it when it's finished, so I'll make sure I put it on github, and send you a link to it
[2013-01-14 23:39:37 -0500] atomic-penguin: Yeah, our iptables cookbook is a mess
[2013-01-14 23:52:08 -0500] atomic-penguin: oddover, https://github.com/atomic-penguin/cookbook-cups
[2013-01-14 23:57:59 -0500] oddover: atomic-penguin: ok. looks pretty simple
[2013-01-14 23:59:51 -0500] theerik_: Does the feature @Kallistec note include the ability for me to load back in a webui or validation PEM?   I'd like to restore a PEM from backup into a Chef server, but right now, there doesn't seem to be any way I can do that.
