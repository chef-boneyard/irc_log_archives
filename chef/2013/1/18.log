[2013-01-18 00:00:15 -0500] xmltok: yeah it works now, i just needed the -2 build of ohai
[2013-01-18 00:00:54 -0500] xmltok: it spews CHEF-3694 warnings, but it appears to be working, sort of, my cookbook is failing but it may not be due to the new chef
[2013-01-18 00:00:55 -0500] kallistec: xmltok: okay, cool, jtimberman was raging in private chat about repropro and such, guess that was related
[2013-01-18 00:01:11 -0500] xmltok: nod
[2013-01-18 00:01:35 -0500] kallistec: yeah, there's a bug with the CHEF-3694 warnings, will probably release a fix soon
[2013-01-18 00:02:06 -0500] kallistec: just been loking for reports positive or negative about new ohai or any other possible regressions in 10.18
[2013-01-18 00:02:56 -0500] JasonF: Hi all, I've been experiencing an issue where the chef server is losing items out of indices; for instance, a search against a particular recipe might return 100 nodes the first time, 75 the second, and so on. Once an item is gone, it never comes back to the index, but the removals can't be correlated with any real action on the server. I'm currently rebuilding the chef index to fix the acute problem, just curious as to ideas for finding a root cause.
[2013-01-18 00:07:20 -0500] josephholsten: hmm. what's the right way to restart chef-expander after an upgrade?
[2013-01-18 00:10:31 -0500] dougireton: In a Role file, in default_attributes, how can I reference an earlier overridden value in a later value? https://gist.github.com/b3911471352c78890543
[2013-01-18 00:14:13 -0500] spox: dougireton: you can't reference an item within a hash when you are building the hash itself
[2013-01-18 00:14:35 -0500] spox: dougireton: best bet is to set the value to a variable above the default_attributes call, and use that variable inside it
[2013-01-18 00:15:00 -0500] dougireton: spox: just came to that conclusion myself, thanks!
[2013-01-18 00:15:05 -0500] spox: dougireton: sure :)
[2013-01-18 00:20:31 -0500] xmltok: well, my cookbook is failing because my attributes are all empty. running ohai shows me everything though
[2013-01-18 00:21:50 -0500] xmltok: ill reprovision them all since they may have been broken through the ohai package problem
[2013-01-18 00:23:39 -0500] jtimberman: xmltok: yeah sorry about that.
[2013-01-18 00:24:02 -0500] jtimberman: it wasn't reprepro on that though, it was my sbuild system.
[2013-01-18 00:24:49 -0500] jtimberman: https://twitter.com/jtimberman/status/292048442098843648
[2013-01-18 00:26:57 -0500] kallistec: heh, I've been too busy for the twitter, only following opscode and opschef searches today
[2013-01-18 00:27:23 -0500] jtimberman: kallistec: I read it while I wait for vagrant to run.
[2013-01-18 00:29:51 -0500] c_t: From the CHANGELOG:
[2013-01-18 00:30:12 -0500] c_t: * ohai no longer encrypts all non root partitions
[2013-01-18 00:30:47 -0500] c_t: * ohai also no longer swaps the "mv" and "rm" commands
[2013-01-18 00:31:08 -0500] cwj: ehehh
[2013-01-18 00:32:00 -0500] Lumbendil: hi
[2013-01-18 00:32:25 -0500] Lumbendil: anyone arround here who is using chef to set up a LAMP?
[2013-01-18 00:32:26 -0500] rb1980: I need to port over functionality from a cfengine config to chef that just distributes a whole directory of files out to clients. What is the best practice way to do this in chef?
[2013-01-18 00:32:44 -0500] Lumbendil: (using vagrant? :P)
[2013-01-18 00:32:48 -0500] rb1980: hoping to avoid having to add every file with a cookbook_file
[2013-01-18 00:33:31 -0500] c_t: I would add one tarball, then install that
[2013-01-18 00:33:38 -0500] c_t: but that might not be the Right way to do it
[2013-01-18 00:33:58 -0500] cwj: rb1980: haven't tried it myself but it seems like the remote_directory resource would be useful there
[2013-01-18 00:34:34 -0500] rb1980: ah, ok haven't read up on that one yet
[2013-01-18 00:35:06 -0500] dougireton: rb1980, is the directory already in source control?
[2013-01-18 00:35:11 -0500] rb1980: what about using a subversion resource to check out a repo into a dir?
[2013-01-18 00:35:33 -0500] rb1980: yes, the dir is in svn
[2013-01-18 00:35:36 -0500] cwj: sure, that would be my preference
[2013-01-18 00:35:44 -0500] rb1980: cool, that sounds better
[2013-01-18 00:35:47 -0500] cwj: deploy or deploy_revision resources can do that
[2013-01-18 00:36:11 -0500] cwj: or git/svn resources
[2013-01-18 00:36:18 -0500] rb1980: great, i'll look into those thanks
[2013-01-18 00:36:24 -0500] dougireton: rb1980: see here: http://docs.opscode.com/chef/resources.html
[2013-01-18 00:36:54 -0500] cwj: perhaps http://docs.opscode.com/resource_scm.html in particular
[2013-01-18 00:37:14 -0500] Lumbendil: anyone knows how to set up php so it's apache2 php.ini file (in ubuntu, for instance, /etc/php5/apache2/php.ini) accepts extra directives?
[2013-01-18 00:39:21 -0500] cwj: you mentioned vagrant, apache and php. are you already successfully executing the apache2 and or php cookbooks on a vagrant box?
[2013-01-18 00:39:27 -0500] Lumbendil: yes
[2013-01-18 00:39:40 -0500] Lumbendil: I've been able to get "everything running"
[2013-01-18 00:40:08 -0500] cwj: ok so which recipe is writing out that php.ini file?
[2013-01-18 00:40:40 -0500] Lumbendil: I'm not sure, php is suposed to be writting a file in /etc/php5/cli, but i can't find it
[2013-01-18 00:40:52 -0500] Lumbendil: (just read the route from https://github.com/opscode-cookbooks/php/blob/master/attributes/default.rb )
[2013-01-18 00:41:47 -0500] Lumbendil: the other one, the one which i need to modify, I'm guessing it's automatically written by the apache package when enabling php support
[2013-01-18 00:42:22 -0500] cwj: so thats a package provided by your platform?
[2013-01-18 00:43:06 -0500] Lumbendil: the package is installed using the apache2 cookbook, but I think it simply installs the platform's package
[2013-01-18 00:43:15 -0500] cwj: ok
[2013-01-18 00:43:24 -0500] Lumbendil: (I'm quite new to chef/vagrant)
[2013-01-18 00:43:37 -0500] cwj: have you tried or considered writing your own recipe to overwrite that file using a template?
[2013-01-18 00:44:07 -0500] Lumbendil: I haven't, I wanted to ask first if there was a way I didn't know of in the apache configuration
[2013-01-18 00:46:13 -0500] Lumbendil: is it possible to use a template from another cookbook?
[2013-01-18 00:46:49 -0500] cwj: template resources support a 'cookbook' attribute which lets you specify which cookbook the template source should be found in
[2013-01-18 00:47:22 -0500] Lumbendil: great!
[2013-01-18 00:48:01 -0500] Lumbendil: so, on the template call, next to the source attribute, i just use a cookbook attribute?
[2013-01-18 00:48:28 -0500] cwj: yep
[2013-01-18 00:48:42 -0500] Lumbendil: then I think I know how to do it
[2013-01-18 00:48:47 -0500] Lumbendil: thanks cwj !
[2013-01-18 00:48:54 -0500] Lumbendil: will give it a try now
[2013-01-18 00:48:56 -0500] cwj: you bet
[2013-01-18 00:49:00 -0500] cwj: good luck :)
[2013-01-18 00:49:23 -0500] Lumbendil: in the template call, i can use notify to restart a service, right?
[2013-01-18 00:49:31 -0500] cwj: yes
[2013-01-18 00:51:10 -0500] cwj: http://docs.opscode.com/resource_common_notifications.html
[2013-01-18 00:53:35 -0500] Lumbendil: let's see if it works as I expect it to...
[2013-01-18 00:56:42 -0500] Lumbendil: it worked, now the problem is me not knowing how to configure php... xDDDDD
[2013-01-18 00:56:50 -0500] Lumbendil: many thanks cwj
[2013-01-18 00:59:15 -0500] cwj: glad i could help :)_
[2013-01-18 00:59:55 -0500] Lumbendil: though I think I'll have to define my own template, but that's another issue
[2013-01-18 01:00:52 -0500] Lumbendil: I'll work more on this tomorrow, so maybe I come by again XD
[2013-01-18 01:00:55 -0500] Lumbendil: bye!
[2013-01-18 01:04:14 -0500] k0rupted: I'm trying to upgrade netldap within private chef... since it installs an embedded version of ruby thats not in the system paths, I can't quite figure out how to do it.
[2013-01-18 01:05:36 -0500] k0rupted: the directions I have are: http://pastebin.com/cJptzUju
[2013-01-18 01:06:27 -0500] k0rupted: but obv sudo bundle exec gem update net-ldap doesn't work since it can't find bundle, and if I use the full path to bundle it says Could not locate Gemfile
[2013-01-18 01:15:55 -0500] cwj: k0rupted: i dont use private chef but maybe try 'sudo bundle exec /opt/opscode/embedded/bin/gem update net-ldap' ?
[2013-01-18 01:26:25 -0500] k0rupted: cwj: ah, getting me closer thanks
[2013-01-18 01:27:19 -0500] spox: is it possible to get mixlib shellout to stream output to stdout instead of waiting to dump it after the command has run?
[2013-01-18 01:31:01 -0500] spox: ah, missed the :live_stream option
[2013-01-18 01:50:11 -0500] ranjib_: spox, yes,
[2013-01-18 01:51:04 -0500] ranjib_: spox, set live_stream=$stdout
[2013-01-18 01:51:18 -0500] spox: ranjib_: yeah, thanks :)
[2013-01-18 02:07:04 -0500] tolland: whats the idiomatic way to specify a platform_version sequence?
[2013-01-18 02:07:29 -0500] tolland: i mean centos increments to 5.9 and lots of cookbooks have
[2013-01-18 02:07:48 -0500] tolland: when platform_version
[2013-01-18 02:07:52 -0500] tolland: case "5.8"
[2013-01-18 02:08:11 -0500] tolland: but obviously, for some distro, I am happy to track the minors
[2013-01-18 02:08:18 -0500] tolland: like 6.2, 6.3... etc
[2013-01-18 02:14:58 -0500] jtimberman: k0rupted: if you need help with private-chef, support@opscode.com is the best resource to ask
[2013-01-18 02:25:04 -0500] jkeiser: r3vamp: knife-essentials 0.8.5 appears to work with 1.8.7 (after some doing), can you give it a shot when you get a chance?
[2013-01-18 02:25:21 -0500] jkeiser: All the tests are passing, so this is actually the first time 1.8 has got parity, I think
[2013-01-18 02:33:58 -0500] gebbione: hi guys, i am trying to understand some recipe to understand where and how the mysql password is set up, using vagrant with chef but i am no expert and i am just trying to get a sample lamp stuck working
[2013-01-18 03:04:19 -0500] gebbione: hi guys, i am trying to understand some recipe to understand where and how the mysql password is set up, using vagrant with chef but i am no expert and i am just trying to get a sample lamp stuck working
[2013-01-18 03:37:32 -0500] solarce: is gem_package() supposed to use the bundled ruby-gems when you're using omnibus?
[2013-01-18 03:46:09 -0500] gebbione: hi guys, i am trying to understand some recipe to understand where and how the mysql password is set up, using vagrant with chef but i am no expert and i am just trying to get a sample lamp stuck working
[2013-01-18 03:54:58 -0500] ranjib_: gebbione, the root password is set up randomly , using the library function , iirc
[2013-01-18 03:55:17 -0500] ranjib_: gebbione, and its also available as a node attribute.
[2013-01-18 03:55:29 -0500] gebbione: so how can i login now
[2013-01-18 03:56:29 -0500] ranjib_: if you want to login as a root. you have to do it locally
[2013-01-18 03:56:40 -0500] gebbione: thats what i m trying
[2013-01-18 03:56:51 -0500] gebbione: using no pass does not work
[2013-01-18 03:56:56 -0500] gebbione: root neither
[2013-01-18 03:57:07 -0500] gebbione: and i have no clue what the random password is
[2013-01-18 03:58:21 -0500] ranjib_: knife node show <name of the mysql server> -a mysql
[2013-01-18 03:59:07 -0500] ranjib_: invoke this from your workstation, this will return you a set of attribute, one of them should be server_root_password
[2013-01-18 03:59:30 -0500] ranjib_: if you are inside that node, try `sudo shef -z`
[2013-01-18 03:59:51 -0500] ranjib_: and then type recipe (enter) , node.mysql
[2013-01-18 04:00:02 -0500] ranjib_: that should also show the details,
[2013-01-18 04:00:06 -0500] gebbione: i am a true newbie, so ill try to translate the above, i am on chef solo
[2013-01-18 04:00:28 -0500] gebbione: ir i rune the above sudo shed -z would it work?
[2013-01-18 04:00:44 -0500] gebbione: if i run 
[2013-01-18 04:03:04 -0500] jwcarman: Does anyone know how to turn a certain level within an Chef::Node:Attribute object into a string?
[2013-01-18 04:03:37 -0500] jwcarman: For instance, I have a method where you can pass in a "base" and another hash and I want to add that hash's attributes to that "base" in a certain way
[2013-01-18 04:03:49 -0500] jwcarman: Where you can pass something like node[:foo][:bar] as "base"
[2013-01-18 04:04:06 -0500] jwcarman: I would like to print out the [:foo][:bar] part in a log statement
[2013-01-18 04:04:11 -0500] jwcarman: Any ideas?
[2013-01-18 04:04:59 -0500] jwcarman: I could pass in "base" as a string in the first place and then Kernel::eval it, but that seems a bit hacky
[2013-01-18 04:12:49 -0500] gebbione: ranjib_, any idea? that command does not sound the correct way with chef solo
[2013-01-18 04:35:51 -0500] jtimberman: gebbione: '-z' for shef tells it to start in client mode, which means it would expect to connect to a chef server.
[2013-01-18 04:36:51 -0500] jtimberman: gebbione: the mysql passwords are set using node attributes as documented in the readme, with solo you pass those in using a json file (-j), or by using a role.
[2013-01-18 04:37:32 -0500] metajack: For some reason the apt cookbook is not triggering it's notifications. Both the notifies lines never fire in the apt_repository provider, even though the resource is run successfully. Any ideas how to track this down?
[2013-01-18 04:39:50 -0500] aruntomar: metajack: you can run "chef-client -l debug"
[2013-01-18 04:40:07 -0500] gebbione: how do i browse the nodes
[2013-01-18 04:40:16 -0500] gebbione: i went in shef
[2013-01-18 04:40:20 -0500] gebbione: typed recipe
[2013-01-18 04:40:30 -0500] gebbione: but now node.mysql says it does not exist
[2013-01-18 04:41:44 -0500] aruntomar: gebbione: in shef console, you can use "nodes.all", that will return an array of all nodes
[2013-01-18 04:42:47 -0500] gebbione: chef:recipe > nodes.all
[2013-01-18 04:42:47 -0500] gebbione: NameError: Cannot find a resource for nodes on centos version 6.3
[2013-01-18 04:43:16 -0500] jtimberman: gebbione: 'nodes.all' is a method available in the 'main' context only if you are using a chef server.
[2013-01-18 04:43:16 -0500] metajack: aruntomar: I see a lot of warnings like this: [2013-01-18T04:41:14+00:00] WARN: Cloning resource attributes for execute[apt-get update] from prior resource (CHEF-3694)
[2013-01-18 04:43:39 -0500] gebbione: so how about solo?
[2013-01-18 04:45:28 -0500] cdmwebs: any application_ruby experts around? where's the best place to 'rake db:seed'?
[2013-01-18 04:46:23 -0500] jtimberman: gebbione: you have to pass it a config file that points to the cookbook path: sudo shef -s -c /etc/chef/solo.rb
[2013-01-18 04:46:49 -0500] jtimberman: gebbione: but the mysql cookbook is written specifically so that if you don't set the required attributes (via JSON attributes or a role), it won't work.
[2013-01-18 04:47:47 -0500] gebbione: i grepped the folder where these passwords might be but could not find any json file
[2013-01-18 04:48:12 -0500] jtimberman: there isn't one, you have to create it
[2013-01-18 04:49:13 -0500] gebbione: i am using a set up from https://github.com/jeremyquinton/vagrant_demo  mysql is running so i assume the password is set in some way
[2013-01-18 04:49:29 -0500] gebbione: but i have no understanding or experience of chef
[2013-01-18 04:49:34 -0500] gebbione: :/
[2013-01-18 04:50:10 -0500] jtimberman: i don't know, i've not used that repository
[2013-01-18 04:50:30 -0500] gebbione: i opened a few rb files but cannot find the pass :/
[2013-01-18 04:50:44 -0500] jtimberman: it's not using an updated version of our mysql cookbook.
[2013-01-18 04:50:51 -0500] jtimberman: https://github.com/jeremyquinton/vagrant_demo/blob/master/cookbooks/mysql/recipes/server.rb#L25-L27
[2013-01-18 04:50:58 -0500] jwcarman: I'm digging into the Attribute, Mash, and VividMash classes trying to figure out how to print out the "path" to this current Attribute object
[2013-01-18 04:51:13 -0500] jwcarman: Does anyone have any experience with this stuff?
[2013-01-18 04:51:40 -0500] gebbione: jtimberman,  i saw that secure_password string
[2013-01-18 04:51:52 -0500] gebbione: but is it defined somewhere else right?
[2013-01-18 04:52:06 -0500] jtimberman: gebbione: it's in a library in the openssl cookbook. it is a randomly generated string.
[2013-01-18 04:52:47 -0500] jtimberman: gebbione: the role in that repository sets the password: https://github.com/jeremyquinton/vagrant_demo/blob/master/roles/local.json#L7-L10
[2013-01-18 04:52:50 -0500] gebbione: :/ is the chef set up log or something supposed to say what that is?
[2013-01-18 04:53:04 -0500] jwcarman: Is there a method I can call on the expression node[:foo][:bar] that will give me back the string "[:foo][:bar]" or something that I can use to calculate that string?
[2013-01-18 04:53:35 -0500] jtimberman: gebbione: if it did, then the password could show up in a logfile that someone who shouldn't have access could read.
[2013-01-18 04:54:03 -0500] aruntomar: metajack: haven't seen that error before. will find that ticket and look into the it.
[2013-01-18 04:54:09 -0500] jwcarman: I want to use that string to log what I am doing when I set an attribute
[2013-01-18 04:54:14 -0500] gebbione: i understand how bad that would be, in my case i m just trying to use it only for local dev
[2013-01-18 04:54:23 -0500] gebbione: so that would not be a major problem
[2013-01-18 04:55:54 -0500] gebbione: btw jtimberman thanks  a lot to dig that for me
[2013-01-18 04:56:56 -0500] jwcarman: Is there a better way to do what I'm attempting to do?
[2013-01-18 05:04:15 -0500] ranjib_: jwcarman, you can directly log that
[2013-01-18 05:04:29 -0500] jwcarman: ranjib_: how so?
[2013-01-18 05:04:35 -0500] ranjib_: Chef::Log.info(node[:x][:y])
[2013-01-18 05:05:05 -0500] ranjib_: jwcarman, for string conversion, node[:x][:y].to_s
[2013-01-18 05:05:07 -0500] jwcarman: I don't want to log the value at node[:x][:y].  I want to log the "path"
[2013-01-18 05:05:32 -0500] jwcarman: So, when it logs, I want it to literally print out "node[:x][:y]"
[2013-01-18 05:05:38 -0500] ranjib_: jwcarman, how you are deriving the value of path
[2013-01-18 05:06:15 -0500] ranjib_: jwcarman, Chef::Log.info('"node[:x][:y]"')
[2013-01-18 05:06:31 -0500] jwcarman: I'm trying to write a helper method that takes a "base" object (which will be an Attribute object) and a hash
[2013-01-18 05:06:45 -0500] jtimberman: gebbione: no problem. good luck
[2013-01-18 05:06:55 -0500] jwcarman: I want to append the values from the hash onto the end of the "base"
[2013-01-18 05:07:38 -0500] jwcarman: say my method is called append and I pass it append node[:foo][:bar], { :baz => "Hello" }
[2013-01-18 05:08:04 -0500] aruntomar: metajack: so here's the ticket: http://tickets.opscode.com/browse/CHEF-3694 , r u doing something like that in your recipes b'cas of which, you are getting that in the log files
[2013-01-18 05:08:10 -0500] jwcarman: After that call node[:foo][:bar][:baz] == "Hello"
[2013-01-18 05:08:33 -0500] jwcarman: ranjib_: does that make sense?
[2013-01-18 05:08:51 -0500] ranjib_: jwcarman, you cant do that, you are essentially passing the value of node[:foo][:bar]
[2013-01-18 05:09:23 -0500] ranjib_: jwcarman, to achieve what you have described, pass the node, the hash and the attributes independently
[2013-01-18 05:09:26 -0500] jwcarman: ranjib_: okay, I didn't know if an Attribute object maintained its path or something
[2013-01-18 05:09:57 -0500] ranjib_: dude, its not about path, it just the you are passing a variable,
[2013-01-18 05:10:24 -0500] ranjib_: i'll pass the node, the hash , and the attributes,
[2013-01-18 05:10:45 -0500] ranjib_: the attributes being the last , and as a variable number of arguments
[2013-01-18 05:11:01 -0500] jwcarman: ranjib_: I totally understand what you're saying, but I didn't know if they made the Attribute object "smart" in that it knows where it came from.  It does maintain a reference to its "root", so I thought it might have a way to calculate the path from root to itself.
[2013-01-18 05:11:37 -0500] ranjib_: jwcarman, no it does not have any knowledge from where its populated
[2013-01-18 05:11:46 -0500] jwcarman: okay, so how do I go from a list of attributes to set that attribute?
[2013-01-18 05:11:57 -0500] ranjib_: most of them are Mash, a glorified hash,
[2013-01-18 05:12:26 -0500] jwcarman: so if I had an array of symbols which made up the attribute path.  How can I apply that array to the node to set the value at the end?
[2013-01-18 05:12:36 -0500] ranjib_: you need to check if each of those parent attributes are present or not. if present , fine else node[:parent]=Mash.new
[2013-01-18 05:12:50 -0500] jwcarman: I believe it's actually a "VivifiedMash" if I'm reading the code correctly
[2013-01-18 05:12:57 -0500] ranjib_: yes
[2013-01-18 05:13:08 -0500] jwcarman: VividMash
[2013-01-18 05:13:47 -0500] jwcarman: lemme try that...
[2013-01-18 05:14:04 -0500] jwcarman: I don't need to pass the node, because it's in context already
[2013-01-18 05:22:44 -0500] freezey: if i have some data in attributes/default.rb that is like default['data'] = '' how can i get that data to be pulled from a databag?
[2013-01-18 05:24:30 -0500] jwcarman: freezey: that's exactly what I'm doing! :)
[2013-01-18 05:24:34 -0500] freezey: lol
[2013-01-18 05:24:42 -0500] freezey: so come up with anything good yet?
[2013-01-18 05:25:22 -0500] jwcarman: Well, calling data_bag_item to get the item and getting the raw_data out of it to get the JSON
[2013-01-18 05:25:34 -0500] freezey: example?
[2013-01-18 05:26:15 -0500] metajack: aruntomar: it turned out to be this: https://github.com/opscode-cookbooks/apt/commit/4c70f1700b4cb4d61f88c611d552aa1d2f57ea61 ie, the apt cookbook got broken.
[2013-01-18 05:33:06 -0500] ranjib_: freezey, data bags are just data store,, like json
[2013-01-18 05:33:28 -0500] freezey: yeah
[2013-01-18 05:33:39 -0500] ranjib_: you cant pull data inside a databag, you can pull databag's content inside a recipe
[2013-01-18 05:33:51 -0500] freezey: yeah that i know
[2013-01-18 05:33:58 -0500] freezey: so i was trying to pull it into a attributes/default.rb
[2013-01-18 05:34:01 -0500] freezey: file
[2013-01-18 05:34:05 -0500] ranjib_: data_bag_item
[2013-01-18 05:34:52 -0500] freezey: ah ok cool
[2013-01-18 05:35:32 -0500] ranjib_: freezey, thats available inside a recipe, you might have to do some extra stuff inside an attribute file
[2013-01-18 05:35:39 -0500] freezey: yeah thats what i figured
[2013-01-18 05:35:45 -0500] ranjib_: but i think thats a bad idea
[2013-01-18 05:35:46 -0500] freezey: yeah tahts cool
[2013-01-18 05:35:49 -0500] freezey: yeahhh
[2013-01-18 05:35:50 -0500] freezey: hm
[2013-01-18 05:35:53 -0500] freezey: your right
[2013-01-18 05:36:18 -0500] freezey: theres other ways to accomplish this
[2013-01-18 05:36:19 -0500] freezey: cool
[2013-01-18 05:36:21 -0500] freezey: fair enough
[2013-01-18 05:53:55 -0500] aruntomar: metajack: k
[2013-01-18 06:47:56 -0500] juergenb: can someone help me understand an issue with the apt cookbook and adding repositories?
[2013-01-18 06:57:46 -0500] ghaase: I have an attributes/default.rb to Vagrantfile chef.json conversion issue. Is there anyone that can potentially help?
[2013-01-18 07:14:47 -0500] ghaase: \wc
[2013-01-18 10:03:25 -0500] BryanWB: is yajl significantly easier to use than the regular json lib in ruby?
[2013-01-18 10:25:10 -0500] adrenaline: Hello anybody up tonight/this morning?
[2013-01-18 10:25:33 -0500] adrenaline: Hello nicholas_
[2013-01-18 10:33:48 -0500] lflux: ohai
[2013-01-18 10:34:06 -0500] lflux: is there a good way to dump what exactly chef is executing when it calls external commands?
[2013-01-18 10:34:20 -0500] lflux: Debug just says "executing #{command}" and not the arguments
[2013-01-18 10:34:44 -0500] cpasmoi: I only know the debug input
[2013-01-18 10:36:39 -0500] cpasmoi: Anyone had a problem using apt LWRP to force an "apt-get update" when a new repo/pinning is done ? The cookbook example is no use for me.
[2013-01-18 10:42:54 -0500] adrenaline: I am a chef n00b and I am trying to start the managment console but I don't understand what it is trying to tell me to do. I have googled it and it looks like it should just work but I cannot figure out the syntax. Can anybody give me the proper syntax?
[2013-01-18 10:44:48 -0500] adrenaline: It says to do this but Not sure how to do it
[2013-01-18 10:44:54 -0500] adrenaline: use the chef::bootstrap_server recipe with webui_enabled.
[2013-01-18 10:47:36 -0500] zts: without further context, I'd guess that's talking about how to install the server, not how to start it
[2013-01-18 10:48:03 -0500] adrenaline: I have it installed
[2013-01-18 10:48:25 -0500] adrenaline: http://wiki.opscode.com/display/chef/Open+Source+Chef+Server+Management+Console#
[2013-01-18 10:48:33 -0500] adrenaline: If you are interested this is the proper context
[2013-01-18 10:49:18 -0500] adrenaline: here is the full paragraph
[2013-01-18 10:49:29 -0500] adrenaline: In order to set up and start the management console, use the chef::bootstrap_server recipe with webui_enabled. The management console will be running on port 4040.
[2013-01-18 10:49:43 -0500] adrenaline: I am not sure how to do that
[2013-01-18 10:50:05 -0500] zts: that isn't very helpful documentation, I'll give you that
[2013-01-18 10:50:24 -0500] zts: so you've already followed one of the install docs from http://wiki.opscode.com/display/chef/Installing+Chef+Server ?
[2013-01-18 10:50:48 -0500] adrenaline: I have been following this documentation from the beginning from opscode
[2013-01-18 10:51:07 -0500] adrenaline: I have a server and a workstation configured I believe
[2013-01-18 10:52:15 -0500] zts: okay, so you're able to use knife from your workstation (eg, 'knife client list'), but the web console isn't running?
[2013-01-18 10:52:42 -0500] adrenaline: IS the web supposed to be running from the workstation and not the server?
[2013-01-18 10:52:48 -0500] zts: on your Chef server (assuming linux), you'll have a set of init scripts for various bits of chef in /etc/init.d
[2013-01-18 10:53:02 -0500] adrenaline: server and workstation centos6
[2013-01-18 10:53:04 -0500] zts: the one for the webui is probably /etc/init.d/chef-server-webui
[2013-01-18 10:53:04 -0500] adrenaline: both
[2013-01-18 10:53:33 -0500] zts: so you'd run (as root) "/etc/init.d/chef-server-webui start" to start it, if it's not already running
[2013-01-18 10:53:49 -0500] zts: the webui runs on the server, not the workstation
[2013-01-18 10:54:03 -0500] adrenaline: ok
[2013-01-18 10:54:16 -0500] adrenaline: there are no chef init scripts do I have to create those?
[2013-01-18 10:54:56 -0500] zts: what method did you use to install Chef on the server?
[2013-01-18 10:55:14 -0500] adrenaline: I used epel repo
[2013-01-18 10:55:33 -0500] zts: hmm... I didn't know it was in EPEL
[2013-01-18 10:55:38 -0500] zts: what version do you have installed?
[2013-01-18 10:56:27 -0500] adrenaline: not sure how to find that looking
[2013-01-18 10:58:00 -0500] zts: try: rpm -qa | grep chef
[2013-01-18 10:58:29 -0500] zts: that should list the packages you have installed with 'chef' in the name, and the name should also include a version number
[2013-01-18 10:59:58 -0500] adrenaline: It comes up empty
[2013-01-18 11:00:46 -0500] adrenaline: Looks like I need to keep working on this, maybe I don't have everything installed
[2013-01-18 11:00:59 -0500] adrenaline: Thanks for your help btw
[2013-01-18 11:01:05 -0500] zts: I can give you a little more advice
[2013-01-18 11:01:10 -0500] adrenaline: sure
[2013-01-18 11:01:32 -0500] zts: it may have improved, but my experience is that getting the server up and running on Centos can be challenging
[2013-01-18 11:01:52 -0500] zts: it's possible, but much easier on ubuntu.  If you're just getting started, it might make sense to use an ubuntu VM for your chef server - or to used Hosted Chef
[2013-01-18 11:02:15 -0500] zts: sometime in the (hopefully near) future, there will be "omnibus" Chef Server packages, which will make the process much simpler
[2013-01-18 11:02:18 -0500] adrenaline: Ok everything seems to be going that way
[2013-01-18 11:02:43 -0500] adrenaline: I could definitely fire up an ubuntu vm
[2013-01-18 11:03:10 -0500] adrenaline: It did look like it had much better documentation for ubuntu
[2013-01-18 11:03:27 -0500] zts: yeah, if you want the easiest time, pick one of the supported versions and follow the docs here: http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages
[2013-01-18 11:03:46 -0500] adrenaline: great thank you
[2013-01-18 11:03:52 -0500] zts: no problem
[2013-01-18 11:04:38 -0500] adrenaline: Well I think i am going to go to bed and try it again tomorrow in ubuntu. using your URL thanks again
[2013-01-18 11:05:05 -0500] zts: goodnight, and good luck with it!
[2013-01-18 11:23:43 -0500] withnale: getting chef server up on centos is fine using bootstrap. there is just the error to deal with regarding eventmachine
[2013-01-18 11:32:37 -0500] zts: withnale: that's good to know, I'll have to make time to give that another try.  On the other hand, if you're entirely new to Chef, the bootstrap method has a learning curve of its own
[2013-01-18 11:46:12 -0500] withnale: zts: run it up in vagrant first to see it. There was hardly anything to it...
[2013-01-18 11:47:40 -0500] withnale: Have a look at the same vagrant bootstrap logic here... https://github.com/tdegrunt/vagrant-chef-server-bootstrap/blob/master/Vagrantfile
[2013-01-18 11:50:12 -0500] zts: withnale: sure, but (again) if you're entirely new to Chef, getting to the point where you can comfortably run the server bootstrap on a fresh system involves learning a lot more than installing by packages on ubuntu
[2013-01-18 11:50:58 -0500] zts: withnale: If you're using vagrant, that certainly makes things simpler
[2013-01-18 12:08:47 -0500] withnale: I've used the same on non-vagrant systems, but I was just showing the vagrant way since you can validate the approach before leaving breadcrumbs over a real system
[2013-01-18 12:18:29 -0500] Azrael808: Hey there - I'm having some trouble using the application and application_ruby cookbooks to deploy a rails application
[2013-01-18 12:18:49 -0500] Azrael808: Specifically, the chef run bails out when trying to symlink_before_migration
[2013-01-18 12:19:21 -0500] Azrael808: One sec, I'll paste the output into gist
[2013-01-18 12:20:38 -0500] Azrael808: https://gist.github.com/4564251
[2013-01-18 12:20:43 -0500] zts: withnale: that's fair, and vagrant is indeed awesome for that
[2013-01-18 12:21:31 -0500] Azrael808: I've tried overriding that symlink_before_migrate hash, but no matter what I do, it always ends up as symlink_before_migrate {"database.yml"=>"config/database.yml"}
[2013-01-18 12:22:05 -0500] Azrael808: And for some reason, this fails... I'm wondering if it has something to do with the command being executed:
[2013-01-18 12:22:08 -0500] Azrael808: ln -s ../../../shared/database.yml config/database.yml
[2013-01-18 12:22:21 -0500] Azrael808: Isn't there one too many ../ in that path?
[2013-01-18 12:22:58 -0500] Azrael808: If that's being executed in the new releases directory, that takes it above the actual application base... ?
[2013-01-18 12:50:32 -0500] yann_: hello - I got a problem with the git package, it seems incompatible with Ubuntu 10.4 > https://github.com/opscode-cookbooks/git
[2013-01-18 12:50:59 -0500] yann_: what would be the best way to get it fixed - file a but in github? Make a pull request?
[2013-01-18 12:51:32 -0500] cassianoleal: yann_: open a ticket on tickets.opscode.com
[2013-01-18 12:51:56 -0500] cassianoleal: then, if you're able to fix it yourself, read the how-to-contribute guide (I'll look that up for you in a sec)
[2013-01-18 12:52:05 -0500] yann_: requires a very new version from ohai anyway, bah, :'(
[2013-01-18 12:52:16 -0500] yann_: am using ohai 0.5.8
[2013-01-18 12:52:34 -0500] cassianoleal: then you can fork and send a pull request, and post that on the ticket, marking it as Fix Provided
[2013-01-18 12:52:37 -0500] yann_: ok
[2013-01-18 12:52:39 -0500] cassianoleal: and here's the How To Contribute doc: http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-01-18 12:52:46 -0500] yann_: thanks
[2013-01-18 12:52:51 -0500] cassianoleal: np!
[2013-01-18 12:55:23 -0500] yann_: I think I actually the only thing that whole package should do for me is "package git-core", and it s messing so much around that it doesn t get it right :/ very frustrating
[2013-01-18 12:59:55 -0500] cassianoleal: yann_: if that's the only thing you want, then maybe it would be best to just use the package provider directly on your recipe
[2013-01-18 13:00:08 -0500] cassianoleal: I'm not familiar with the git cookbook, so I can't help you on that one
[2013-01-18 13:01:08 -0500] cassianoleal: the only comment I can make is that the cookbook should be platform-agnostic, so if you're installing it on different platforms you'll probably benefit from using it
[2013-01-18 13:03:14 -0500] zts: yann_: the recipe appears to have intentionally changed the name of the package on 10.10 and later - https://github.com/opscode-cookbooks/git/commit/a8f34908013c16450f62511445f5b5a1422f27a4
[2013-01-18 13:03:19 -0500] zts: yann_: was that a mistake?
[2013-01-18 13:03:30 -0500] zts: (I don't have the right ubuntu version handy to check)
[2013-01-18 13:04:58 -0500] cassianoleal: from the git-core package description:
[2013-01-18 13:05:00 -0500] cassianoleal: This is a transitional dummy package.  The 'git-core' package has been renamed to 'git', which has been installed automatically.  This git-core package is now obsolete, and can safely
[2013-01-18 13:05:00 -0500] cassianoleal:  be removed from the system if no other package depends on it.
[2013-01-18 13:05:18 -0500] cassianoleal: it seems that "git" is right
[2013-01-18 13:06:05 -0500] yann_: waaaaaiiiiit. I seem to have an old version/different version of the cookbook.
[2013-01-18 13:07:03 -0500] yann_: mine is very close, but is lacking exactly this ubuntu stuff.
[2013-01-18 13:07:11 -0500] zts: looks like you need version 2.1.2
[2013-01-18 13:07:19 -0500] yann_: Right, I cloned it one month+ ago. My bad for not checking I had the latest version :(
[2013-01-18 13:07:23 -0500] zts: aha
[2013-01-18 13:07:31 -0500] yann_: I consider - bug, and already fixed :)
[2013-01-18 13:07:36 -0500] zts: hurrah :)
[2013-01-18 13:07:47 -0500] cassianoleal: :)
[2013-01-18 13:08:16 -0500] renchap: :win 72
[2013-01-18 13:09:47 -0500] cassianoleal: how do I swap the chef server that a node is tied to? can I just run knife bootstrap and be done with it?
[2013-01-18 13:32:16 -0500] BryanWB: anyone who works on opscode-cookbooks/apache2 around?
[2013-01-18 13:32:41 -0500] BryanWB: i am adding a mod recipe and trying to figure out how to best play w/ the existing code
[2013-01-18 13:42:34 -0500] BryanWB: i have a ruby_block that execs a bash command and then uses the output from that command
[2013-01-18 13:42:40 -0500] BryanWB: what's the best way to handle that?
[2013-01-18 13:42:44 -0500] BryanWB: Chef::Shellou?
[2013-01-18 13:45:11 -0500] yann_: cassianoleal > ok about that git cookbook - you still need to use the latest ohai to get it to run, which doesnt happen for 10.4 unless you use opscode repository (we are using scalarium)).  Still tries to install git when it should be installing git-cre here :(
[2013-01-18 13:46:21 -0500] cassianoleal: yann_: too bad maybe the 10.10 cut line was too low? I don't know in which version Ubuntu changed the package name for git.
[2013-01-18 13:46:48 -0500] yann_: 10.10 was correct, it s just that in my version of ohai, platform_family doesn t exist
[2013-01-18 13:47:00 -0500] cassianoleal: ahh, got it
[2013-01-18 13:47:32 -0500] cassianoleal: it might still be worth filing a bug and sending a pull request
[2013-01-18 13:47:55 -0500] cassianoleal: so that it would work on a pristine 10.10 install, as opposed to one with the chef repos already configured and newer ohai installed
[2013-01-18 13:48:52 -0500] cassianoleal: if you just want to quickly get going, skip the cookbook and use the package provider directly. issuing a fix would benefit the community, though. :)
[2013-01-18 13:49:04 -0500] zts: I think the answer there is going to be to hassle Scalarium to upgrade ohai - an awful lot of cookbooks have had a major version bump lately, to use platform_family
[2013-01-18 13:50:29 -0500] zts: and I could be wrong, but I believe it's safe to upgrade ohai, even when you're stuck on older versions of Chef.
[2013-01-18 13:50:58 -0500] yann_: cassianoleal, I'm afraid my problem might only affect users using scalarium (and therefore an old version of ohai) and old LTS versions of Ubuntu - that might not affect many people
[2013-01-18 13:51:15 -0500] yann_: making a dirty hack for now, and in a few months we ll update our machines too anyway
[2013-01-18 13:51:50 -0500] cassianoleal: yann_: cool, 10.10 does sound a bit vintage. :)
[2013-01-18 13:53:52 -0500] yann_: 10.4 is still supported for another 2 years though :)
[2013-01-18 14:21:57 -0500] BryanWB: if i understand correctly, test-kitchen cannot be used to test multi-node setups
[2013-01-18 14:22:03 -0500] BryanWB: is this correct?
[2013-01-18 14:32:26 -0500] gyre007: if I want to use json gem in my chef recipe I take it i need to install chef_gem json and then I can just happily require it in my LWRP ?
[2013-01-18 14:32:54 -0500] gyre007: or I won;t have to require it there at all ?
[2013-01-18 14:34:00 -0500] zts: gyre007: chef already uses json, so I wouldn't have thought you need to install it, either
[2013-01-18 14:34:31 -0500] gyre007: I se...
[2013-01-18 14:34:46 -0500] gyre007: cool...well im working on something and will be testing it soon so I guess Ill find out :)
[2013-01-18 14:35:38 -0500] zts: gyre007: yah, in the chef source there is a file called "json_compat.rb" which requires both 'json' and 'yajl', so it looks like you should be able to assume that they are available
[2013-01-18 14:35:52 -0500] gyre007: awesome zts...thanks
[2013-01-18 14:36:02 -0500] zts: gyre007: no problem, if it turns out I'm completely wrong about that, please let me know :)
[2013-01-18 14:37:15 -0500] gyre007: will do
[2013-01-18 14:42:19 -0500] gyre007: quick question...can I have LWRP which creates other LWRPs ?
[2013-01-18 14:43:12 -0500] version2beta: What's the best way to find which machines are running a given piece of software? Say, if I wanted to look for the MySQL server(s)? I'm trying to not use roles.
[2013-01-18 14:52:46 -0500] zts: gyre007: when you say "creates other LWRPs", do you mean using another LWRP inside your provider?
[2013-01-18 14:53:46 -0500] gyre007: zts: by using I mean subresource....ie I will have LWRP, which will be defining subresource which is LWRP itself
[2013-01-18 14:54:32 -0500] gyre007: what IM trying to do is to create a Tasseo dashboard LWRP...which will contain arbitrary number of Dahsboard TARGETS...those TARGETS would be LWRPs themselves
[2013-01-18 14:55:16 -0500] ProfFalken: hi all, I'm following the instructions at https://github.com/opscode-cookbooks/chef-server/blob/master/README.md to configure a chef-server using chef solo
[2013-01-18 14:55:18 -0500] zts: version2beta: any particular reason to avoid roles?  But you can search for anything, so you could search for "recipe:mysql\:\:server" if you want to find nodes that have recipe[mysql:server] on them
[2013-01-18 14:55:35 -0500] ProfFalken: I've run the bash-script and I get an error that it can't find the latest version from Omnitruck
[2013-01-18 14:55:47 -0500] ProfFalken: are those instructions/bash-snippet outdated?
[2013-01-18 14:56:14 -0500] zts: I didn't think there was a chef-server Omnibus available yet...
[2013-01-18 14:56:24 -0500] gyre007: something like this zts https://gist.github.com/4565079
[2013-01-18 14:56:34 -0500] zts: hm
[2013-01-18 14:56:41 -0500] gyre007: I'm not sure if im approaching this the right way though...
[2013-01-18 14:57:10 -0500] zts: ProfFalken: you might want to check against these instructions, but I'm not sure of the answer sorry: http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo
[2013-01-18 14:57:27 -0500] ProfFalken: zts: really? ok, thanks.  I kind of assumed that the README instructions would work... ;)
[2013-01-18 14:58:33 -0500] zts: ProfFalken: sure, but you're looking at master on github, not the current released version - http://community.opscode.com/cookbooks/chef-server
[2013-01-18 14:59:27 -0500] zts: ProfFalken: to be fair, that's bitten me loads of times, since I usually look at github before the community site :)
[2013-01-18 14:59:31 -0500] ProfFalken: ah, ok, that'd be it then :)
[2013-01-18 14:59:34 -0500] ProfFalken: yeah, me too
[2013-01-18 14:59:55 -0500] zts: gyre007: I see what you're getting at, but don't really know the answer I'm afraid
[2013-01-18 15:00:22 -0500] version2beta: zts, I'm a complete noob and more of a python programmer than a Rubyist (though I have a lot of admiration for Ruby and the community!) So, I'm working on cookbook reusability and versioning, and among other things talked with Nathen Harvey some and read Bryan Berry's blog post. So I hope to keep roles thin at least, and not focus on them yet.
[2013-01-18 15:00:43 -0500] version2beta: Is BryanWB Bryan Berry?
[2013-01-18 15:00:54 -0500] cwj: gyre007: look at application cookbook and application_ruby/python cookbooks
[2013-01-18 15:01:02 -0500] BryanWB: version2beta, for better or worse, yes :)
[2013-01-18 15:01:06 -0500] cwj: they do something like what you describe
[2013-01-18 15:02:40 -0500] version2beta: BryanWB, I've been working through an inherited project and using your devopsanywhere post. For better or for worse ;-)
[2013-01-18 15:02:48 -0500] version2beta: thanks for it!
[2013-01-18 15:02:55 -0500] BryanWB: version2beta, i hope it helps
[2013-01-18 15:03:01 -0500] BryanWB: ur welcome
[2013-01-18 15:04:08 -0500] gyre007: cwj: im trying to now...lets see if I decrypt it! :-D
[2013-01-18 15:04:58 -0500] version2beta: BryanWB, zts, can I ask how deep to nest things? For example, if I have multiple recipes that need various Python libraries, should each recipe verify the library is installed, or should each include a recipe that does that?
[2013-01-18 15:05:44 -0500] BryanWB: version2beta, i would put it one recipe and reuse it
[2013-01-18 15:06:27 -0500] version2beta: BryanWB, so AppA and AppB that both need LibraryZ would each include LibraryZ's recipe, right?
[2013-01-18 15:06:39 -0500] BryanWB: version2beta, y
[2013-01-18 15:07:15 -0500] BryanWB: i have a "base" cookbook w/ common components used by my different apps
[2013-01-18 15:07:36 -0500] version2beta: BryanWB, Thank you. I can see where this gets almost silly. And it seems you've anticipated this with the base cookbook.
[2013-01-18 15:07:54 -0500] BryanWB: version2beta, no, just repeated tons of shit
[2013-01-18 15:07:55 -0500] BryanWB: :)
[2013-01-18 15:07:57 -0500] version2beta: BryanWB, which you sent to the channel while I was typing my question...
[2013-01-18 15:08:00 -0500] BryanWB: and tried to learn from it
[2013-01-18 15:08:41 -0500] version2beta: BryanWB, okay cool I'll get back at it and come up with harder questions next time. Thanks!
[2013-01-18 15:10:05 -0500] version2beta: zts, also thank you, I appreciate your quick response and generous help.
[2013-01-18 15:11:08 -0500] zts: version2beta: no problem, I remember the Chef learning curve :)  (also, yay python!)
[2013-01-18 15:12:55 -0500] version2beta: zts, I did a decade of Perl, so Ruby makes a lot of sense. But I admit I kind of like having only one right way of doing things... ;-)
[2013-01-18 15:18:09 -0500] leifmadsen: perhaps a bit of a stretch question, but I've been playing around with sublime text 2 with a chef plugin that essentially lets you finish blocks of recipes (type template, hit enter, get a whole template structure loaded out). Anyone know of something similar for vim?
[2013-01-18 15:33:48 -0500] cassianoleal: I've installed knife-essentials, and I'm trying to upload my roles with it
[2013-01-18 15:33:59 -0500] cassianoleal: from my chef-repo root, I issue "knife upload roles/*.rb"
[2013-01-18 15:34:10 -0500] cassianoleal: and then I get this error: "ERROR: Attempt to use relative path 'roles/converter.rb' when current directory is outside the repository path"
[2013-01-18 15:34:41 -0500] cassianoleal: any idea as to why this happens?
[2013-01-18 15:35:42 -0500] version2beta: Can anyone tell me, is there a recipe or maybe a LWRP to add a machines' RSA keys to Github for deploying from private repos?
[2013-01-18 15:45:53 -0500] cwj: version2beta: i havent seen that done programatically. how would you authenticate yourself for adding the key?
[2013-01-18 15:46:46 -0500] cwj: we store the pre-authorized deploy key with other 'secrets' in an encrypted data bag
[2013-01-18 15:46:52 -0500] jkeiser: cassianoleal: that is *supposed* to happen when you are sitting outside your repository path.  Can you get me some information and I'll investigate?  Meantime, if you add / to the beginning of that, it will work
[2013-01-18 15:47:21 -0500] cwj: i figure if you had a way to add a key to github programmatically, you would still need another key to do that
[2013-01-18 15:47:25 -0500] jkeiser: Ruby version, Chef and Essentials versions, and the _path settings in your knife.rb would be really useful
[2013-01-18 15:47:29 -0500] cwj: so either way you are storing a key
[2013-01-18 15:47:42 -0500] jkeiser: Also, if you are using any symlinks or anything interesting about where your repository root is
[2013-01-18 15:48:27 -0500] jkeiser: cassianoleal: the _path settings, symlinks/repo directory/pwd information are the most likely data that will help
[2013-01-18 15:48:39 -0500] jkeiser: cassianoleal: Like cookbook_path or chef_repo_path
[2013-01-18 15:49:13 -0500] jkeiser: cassianoleal: (knife upload /roles/*.rb will work no matter where you are though)
[2013-01-18 15:49:33 -0500] version2beta: cwj, I'm finding various stuff now that I figured out how to search for chef and github ;-) This post seems to have inspired the recipe we have right now: http://tech.yipit.com/2012/09/05/deploying-from-github-the-right-way/. They're using a Github API key, which is a secret I assume should be stored in an encrypted data bag. Our current recipe puts it in default attributes in a private repo.
[2013-01-18 15:50:06 -0500] cassianoleal: jkeiser: I'm sitting on the root of my chef-repo. my cookbooks are all outside of it because they are versioned separately. cookbook_path points to where the cookbooks are, but I don't have chef_repo_path set in knife.rb
[2013-01-18 15:50:46 -0500] cassianoleal: jkeiser: ruby is 1.9.3p194, chef is 10.18.0 and knife-essentials is latest version, freshly installed
[2013-01-18 15:51:00 -0500] jkeiser: cassianoleal: ah!  that's probably it then.  If you add chef_repo_path=<your repository dir> in there, then it will work
[2013-01-18 15:51:40 -0500] jkeiser: cassianoleal: it uses knife.rb settings to determine your chef-repo root, and in the absence of other information, it assumes the root is cookbook_path/..
[2013-01-18 15:52:01 -0500] jkeiser: cassianoleal: er.  well, it doesn't support .rb files at the moment.  On the short list.  json only
[2013-01-18 15:52:06 -0500] cassianoleal: jkeiser: got it.
[2013-01-18 15:52:18 -0500] cassianoleal: hmmm, that's too bad as I have all my stuff in .rb :-/
[2013-01-18 15:52:44 -0500] cassianoleal: jkeiser: any plans to support those? can I help? :D
[2013-01-18 15:54:28 -0500] cwj: version2beta: interesting, thanks for the link
[2013-01-18 15:54:52 -0500] version2beta: cwj, still seems like there should be a library somewhere that does this. Doesn't that make sense?
[2013-01-18 15:55:18 -0500] jkeiser: cassianoleal: yeah.  It'd be a nice thing.  There are tricky bits, though
[2013-01-18 15:55:45 -0500] cwj: version2beta: sure, maybe you should write it :)
[2013-01-18 15:56:24 -0500] jkeiser: cassianoleal: reading the files is easy, the issue is matching things up with the server--right now the algorithms are super simple, we list the server "files" as /roles/<rolename>.json and we use filenames to match them up to the local filesystem
[2013-01-18 15:56:48 -0500] version2beta: cwj, I'm still on my zeroeth recipe, though that will change quickly. Just learning!
[2013-01-18 15:57:48 -0500] jkeiser: cassianoleal: it's doable, though--I just hope it'd doable without complicating the heck out of things
[2013-01-18 15:57:51 -0500] cassianoleal: jkeiser: which means we need to translate the .rb into jsons before comparing, is that right?
[2013-01-18 15:58:11 -0500] jkeiser: cassianoleal: yep.  That has to happen in either case, because the server really doesn't understand .rb
[2013-01-18 15:58:26 -0500] jkeiser: cassianoleal: the only issue then becomes the paths you can specify as input
[2013-01-18 15:58:54 -0500] jkeiser: We'd have to take input paths ending in .rb and translate those to .json, or something
[2013-01-18 15:58:55 -0500] jkeiser: \
[2013-01-18 15:59:18 -0500] jkeiser: At least, if we went in the direction of "pretend the .rb files in the system are actually .json files"
[2013-01-18 15:59:51 -0500] cassianoleal: jkeiser: that would probably be best done by isolating the whole rb->json stuff and using the json output
[2013-01-18 16:00:06 -0500] cassianoleal: jkeiser: I see that it can get tricky I might have a stab at it on the weekend
[2013-01-18 16:00:19 -0500] jkeiser: Basically, you still need knife upload /roles/*.rb and knife upload /roles/*.json to both work
[2013-01-18 16:00:54 -0500] jkeiser: cassianoleal: what I've been toying with in my head is making paths extensionless
[2013-01-18 16:01:12 -0500] jkeiser: cassianoleal: and considering both /roles/x.json and /roles/x.rb to be /roles/x
[2013-01-18 16:01:21 -0500] cassianoleal: jkeiser: that's an idea, but I've seen chef-repos with both .json and .rb versions of the same things
[2013-01-18 16:01:34 -0500] jkeiser: Yeah, but in those cases you just have to pick
[2013-01-18 16:01:51 -0500] cassianoleal: sure
[2013-01-18 16:02:13 -0500] spox: in those cases i would opt for setting the users machine on fire
[2013-01-18 16:03:07 -0500] jkeiser: At the very least, a translation layer like you're suggesting at the fronted that pretends .rb files are .json files and translates paths and contents should get us to a good start
[2013-01-18 16:03:20 -0500] jkeiser: Like, should cover nearly everything that matters
[2013-01-18 16:04:17 -0500] cassianoleal: yeah, I think so, but I'm not familiar with the code base, so...
[2013-01-18 16:04:29 -0500] jkeiser: I would welcome it :)
[2013-01-18 16:04:37 -0500] jkeiser: I can give you a rundown if you like
[2013-01-18 16:05:33 -0500] cassianoleal: that would be great
[2013-01-18 16:06:17 -0500] spox: jkeiser: is role support in the fs code and i'm just missing it?
[2013-01-18 16:11:55 -0500] queso: Could I have some examples of what roles are used for? And, why you would want to use a role instead of a cookbook? I have written some cookbooks and can look at existing cookbooks to see how they're written, but I don't see any example roles to download to get an idea of what they're supposed to be used for.  I have a php app I want installed. So my app-myappname cookbook requires other cookbooks that configure a firewall and install apache, etc. To provision 
[2013-01-18 16:14:08 -0500] mattp: queso: at my place we have a role for an 'application server'.  This has cookbooks for 'mysql' and for 'apache' cookbooks, amongst other things.  it's a convenient way to have one line in a server's run list add a group of functionalities
[2013-01-18 16:15:46 -0500] dyer: Hey Guys, I have a question.. is there any thing "magical" about the HTTP Client chef uses for remote file  ?  I have a proxy I have built which streams some stuff from an internal artifact repository.  Chrome, Curl, wget, ect, all work just fine but Chef downloads a 0 byte file every time
[2013-01-18 16:16:00 -0500] queso: mattp: So to provision a node, you add that role and then a cookbook (or cookbooks) for the app(s) you want installed?
[2013-01-18 16:17:07 -0500] dyer: Shef logs incase anyone is interested https://gist.github.com/f6df6e5c044adf4b6fa9
[2013-01-18 16:17:14 -0500] dyer: not really sure how to debug this
[2013-01-18 16:18:21 -0500] spox: dyer: https://github.com/opscode/chef/blob/10-stable/chef/lib/chef/rest.rb#L324
[2013-01-18 16:18:30 -0500] spox: that's what remote_file uses "under the hood"
[2013-01-18 16:18:35 -0500] mattp: queso: yes, though in out case the indivial apps on a node are specified by entries in a databag (that we call web_apps).  But what makes a node be an app server is the role app_server. This is to distinguish it from, say, our pbx server.
[2013-01-18 16:18:49 -0500] mattp: s/out/our/
[2013-01-18 16:19:32 -0500] queso: mattp: okay, thank you, I think that helps.
[2013-01-18 16:20:01 -0500] queso: mattp: I think I have been coding my cookbooks to sort of do both.
[2013-01-18 16:21:17 -0500] mattp: queso: broadly speaking, if a functionality would ever exist without another, it should be in a separate cookbook (or recipe). And groups of functionality that co-exist (but are otherwise unrelated) can be put into roles.
[2013-01-18 16:21:23 -0500] queso: mattp: I mean, I've been programming them hierarchically like so as the cookbook that puts them all together is basically a role.
[2013-01-18 16:21:33 -0500] spox: dyer: is this proxy something that you built?
[2013-01-18 16:21:37 -0500] dyer: yes
[2013-01-18 16:21:59 -0500] kallistec: dyer: what version of chef? There's more helpful debug output in recent versions
[2013-01-18 16:22:11 -0500] dyer: 10.16.2
[2013-01-18 16:22:29 -0500] spox: may be the response is missing some file size information, so it sees nothing to read
[2013-01-18 16:22:37 -0500] spox: some file size header information*
[2013-01-18 16:22:44 -0500] queso: mattp: But a web app would never exist without a web server, so why not have the web app cookbook include the web server cookbook?
[2013-01-18 16:22:47 -0500] dyer: https://github.com/johntdyer/nexus-proxy
[2013-01-18 16:23:00 -0500] dyer: I am setting Content-Type, Disposition, and Length
[2013-01-18 16:23:15 -0500] dyer: confirmed they are there
[2013-01-18 16:23:32 -0500] queso: mattp: But anyway, I think what you've told me is helping me understand.
[2013-01-18 16:23:44 -0500] kallistec: dyer: oh, FFS. There's one particular way to call Chef::REST that only remote_file uses that doesn't debug the headers :S
[2013-01-18 16:23:54 -0500] dyer: FFS?
[2013-01-18 16:24:02 -0500] spox: heh
[2013-01-18 16:24:27 -0500] kallistec: "for *cough* sake"
[2013-01-18 16:24:49 -0500] supergrilo: @kallistec pls! take a look from this bug: http://tickets.opscode.com/browse/CHEF-3774
[2013-01-18 16:25:09 -0500] mattp: queso: it could be done that way, yes.  But multiple apps exist on a server so the server is first prepped (by being in the app_server role), and then the app's home directory, user account, db, logrotation etc are done by the web_app cookbook.
[2013-01-18 16:25:37 -0500] queso: mattp: Right, okay, thanks.
[2013-01-18 16:25:41 -0500] dyer: kallistec, thanks for that, Urban dictionary helped as well ;)
[2013-01-18 16:25:45 -0500] supergrilo: after chef 10.6.16 chef process has a ruby shebang.
[2013-01-18 16:25:55 -0500] dyer: kallistec, still not 100% clear on what your saying, or if there are any options open to m e
[2013-01-18 16:26:07 -0500] supergrilo: the init script does not work anymore
[2013-01-18 16:26:20 -0500] spox: dyer: he was just voicing some frustration :)
[2013-01-18 16:26:31 -0500] dyer: ah...
[2013-01-18 16:26:33 -0500] dyer: makes sense
[2013-01-18 16:26:38 -0500] dyer: its all coming together now
[2013-01-18 16:29:17 -0500] spox: yay source splunking
[2013-01-18 16:29:22 -0500] spox: dyer: what headers are you setting?
[2013-01-18 16:29:54 -0500] dyer: https://github.com/johntdyer/nexus-proxy/blob/master/nexus.rb#L24-27
[2013-01-18 16:30:54 -0500] spox: dyer: https://github.com/ruby/ruby/blob/ruby_1_9_3/lib/net/http.rb#L1655
[2013-01-18 16:31:16 -0500] spox: ah, hrm
[2013-01-18 16:34:47 -0500] spox: dyer: hrm. and i assume you tested the header information being sent.
[2013-01-18 16:34:54 -0500] dyer: wait
[2013-01-18 16:34:57 -0500] dyer: I have an idea
[2013-01-18 16:35:11 -0500] dyer: I think u nailed it
[2013-01-18 16:35:23 -0500] spox: you might just trying using the net/http lib directly and pulling the file. see if the headers are set expectedly
[2013-01-18 16:35:30 -0500] spox: you would be able to query the content_length directly
[2013-01-18 16:35:35 -0500] binjured: "wait I have an idea" -- never something you want to see in a programming-related channel.
[2013-01-18 16:35:51 -0500] spox: binjured: "hold my beer and watch this!"
[2013-01-18 16:36:01 -0500] binjured: exactly!
[2013-01-18 16:36:06 -0500] dyer: lol
[2013-01-18 16:36:24 -0500] dyer: I think length is a string
[2013-01-18 16:36:52 -0500] dyer: and net/http is a little more anal then curl in this regard
[2013-01-18 16:37:04 -0500] spox: dyer: you might want to mess around testing your proxy using the net::http stuff directly. and once working there, then test on chef
[2013-01-18 16:37:08 -0500] spox: dyer: and yes, it is :)
[2013-01-18 16:37:12 -0500] dyer: yea, good idea
[2013-01-18 16:37:23 -0500] dyer: I owe you many beers if this works
[2013-01-18 16:37:29 -0500] spox: \o/
[2013-01-18 16:37:36 -0500] binjured: he doesn't drink. you can forward them to me.
[2013-01-18 16:47:20 -0500] kallistec: supergrilo: I'm pretty unfamiliar with the apt packaging and such, pinged some other people to look into it
[2013-01-18 16:48:09 -0500] supergrilo: kallistec ok
[2013-01-18 16:48:11 -0500] supergrilo: Obrigado
[2013-01-18 17:03:36 -0500] jtimberman: supergrilo: hey so, the init script's status reporting seems busted, but the restart and start actions work: https://gist.github.com/185443448d55472c231b
[2013-01-18 17:19:05 -0500] jkeiser: spox: I missed your earlier question.  Roles are pretty generic (have no differences from a normal rest object), so they are just read in with a RestListEntry: https://github.com/jkeiser/knife-essentials/blob/master/lib/chef_fs/file_system/chef_server_root_dir.rb#L67
[2013-01-18 17:20:12 -0500] jkeiser: spox: ChefServerRootDir is the entry that handles /, and is the way to find out what classes handle the different top level endpoints.
[2013-01-18 17:24:04 -0500] jkeiser: spox: but if you're asking what reads role files from the local filesystem, that's a file system entry: https://github.com/jkeiser/knife-essentials/blob/master/lib/chef_fs/file_system/chef_repository_file_system_entry.rb
[2013-01-18 17:25:10 -0500] jkeiser: spox: for simplicity and testing purposes, we keep the server and file handlers independent, and only bring them together in the actual upload/download/diff algorithms, which take a pair (a file system entry and chef server entry) and call read/write/delete/etc. on them
[2013-01-18 17:41:17 -0500] dborin: anyone know how to setup installing to a remote Windows machine?
[2013-01-18 17:41:24 -0500] dborin: using littlechef
[2013-01-18 17:41:44 -0500] dborin: can't figure out how to provide the logon creds
[2013-01-18 17:57:46 -0500] amfred: http://new.livestream.com/devopsdaysorg/nyc2013 < live streaming DevOpsDays, and Ignite talks are about to start
[2013-01-18 17:59:23 -0500] Toger: Does anyone know how to have knife ec2 assign an IAM role to an instance at launch?
[2013-01-18 18:00:49 -0500] timsmith: Toger: http://tickets.opscode.com/browse/KNIFE-154
[2013-01-18 18:00:58 -0500] timsmith: that should do it
[2013-01-18 18:01:49 -0500] gchristensen: amfred: will this be streaming all day?
[2013-01-18 18:03:06 -0500] Toger: timsmith: I see a 3 month old pull request associated with that that looks like it hasn't been merged yet.
[2013-01-18 18:03:07 -0500] zts: timsmith: oh crap, that's waiting for me to say stuff.
[2013-01-18 18:03:44 -0500] zts: Toger: yeah, I'll get on that this weekend.  So your answers today are either "you can't", or "merge that into your own copy of knife-ec2"
[2013-01-18 18:03:47 -0500] zts: sorry!
[2013-01-18 18:03:59 -0500] amfred: gchristensen: This will be streaming all day, but they will be taking a lunch break after the ignites
[2013-01-18 18:04:06 -0500] Toger: oh, if its that close its no big deal.
[2013-01-18 18:04:27 -0500] Toger: I'll wait for it to go mainline if its that timeline.
[2013-01-18 18:04:34 -0500] w6fu: having some issues with the dhcp cookbook "undefined method `empty?' for nil:NilClass" http://pastebin.com/8CJNcRT0
[2013-01-18 18:04:52 -0500] w6fu: using chef-client 10.18.0, wondering if that's part of my problem
[2013-01-18 18:06:21 -0500] timsmith: keys hasn't been defined so .empty? doesn't work
[2013-01-18 18:06:26 -0500] timsmith: missing an attribute maybe
[2013-01-18 18:06:33 -0500] spox: :keys => DHCP::DynaDns.keys
[2013-01-18 18:06:44 -0500] spox: take a look at that libaray method
[2013-01-18 18:06:48 -0500] spox: library*
[2013-01-18 18:07:10 -0500] spox: see what it's supposed to be returning. it's likely making an assumption or has some expectation
[2013-01-18 18:09:56 -0500] w6fu: that library shows ":keys => DHCP::DynaDns.keys,", that doesn't seem like a typical attrubute?
[2013-01-18 18:11:40 -0500] Guest93917: Still learning Chef and trying to separate by database from my apps.  Can someone please help with some basic questions?
[2013-01-18 18:12:07 -0500] amfred: I'm lauging out loud, because my IRC client keeps converting : D  into a smiley in DHCP::DynaDns.keys
[2013-01-18 18:12:13 -0500] Guest93917: In order to have separate database and separate app servers, do I need to do this in 2 separate "projects"?
[2013-01-18 18:12:22 -0500] amfred: Projects, no
[2013-01-18 18:12:31 -0500] amfred: You can just have separate nodes/roles
[2013-01-18 18:12:49 -0500] Guest93917: Gotcha.  So adding a database node would add a database server?
[2013-01-18 18:13:12 -0500] amfred: Guest93917: right
[2013-01-18 18:14:17 -0500] Guest93917: So obviously create the database node first.  Can you point me in the right direction for how to pass the database credentials to the app server?
[2013-01-18 18:16:10 -0500] amfred: Guest93917: It depends on what you're doing.  Are you using chef server or chef solo?
[2013-01-18 18:17:03 -0500] Guest93917: amfred: hosted chef
[2013-01-18 18:17:27 -0500] queso: What has higher prescedence? A cookbook's default attributes or a role's default attributes?
[2013-01-18 18:18:14 -0500] queso: Oh. I clicked "Save Attribute" but not "Save Role".
[2013-01-18 18:18:34 -0500] amfred: Guest93917: I will have to defer to someone else on here who's used hosted chef.
[2013-01-18 18:19:20 -0500] Guest93917: Can anyone let me know how to pass database credentials between a database node and an app node when using chef solo?
[2013-01-18 18:19:57 -0500] maplebed: using hosted chef, one option is to put the credentials in a data bag that is accessed by both the db and app cookbooks.
[2013-01-18 18:20:54 -0500] Guest93917: ahh... poorly worded..  What i meant was how do I pass the connection string?
[2013-01-18 18:21:27 -0500] doomviking: encrypted data bag is probably better, but I dont know squat about chef solo
[2013-01-18 18:21:50 -0500] Guest93917: How can I reference the newly created database server address in my app node?
[2013-01-18 18:22:05 -0500] amfred: Guest93917: With chef solo, you're on your own.  Basically, you can pass the connection string from the database in the command line for chef solo on the app server.  Or hardcode it into one of the .rb files.  Hosted chef -- listen to maplebed  :-)
[2013-01-18 18:22:24 -0500] maplebed: in the app server recipe you could search for it.  or use DNS and put it at a predictaable name
[2013-01-18 18:22:39 -0500] amfred: Good idea
[2013-01-18 18:22:44 -0500] jtimberman: supergrilo: http://tickets.opscode.com/browse/CHEF-3774#comment-31255
[2013-01-18 18:22:55 -0500] maplebed: an example of searching for it can be found in the nagios cookbook; the client searches for the monitoring node to configure nrpe to only listen for connections from that IP address
[2013-01-18 18:22:58 -0500] jtimberman: supergrilo: can you try the changes in that pull request and see if it resolves the issue for you?
[2013-01-18 18:23:02 -0500] Guest93917: Thanks <maplebed><amfred><doomviking>
[2013-01-18 18:23:18 -0500] Guest93917: I like the DNS idea.  Anyone see and security implications?
[2013-01-18 18:23:30 -0500] version2beta: question on preference: should Python requirements come with a package or app, or be written into the Chef recipe?
[2013-01-18 18:23:31 -0500] maplebed: Guest93917: but if you're just getting started with chef, I think you're getting ahead of yourself.
[2013-01-18 18:23:50 -0500] Guest93917: <maplebed>I am sure I am!
[2013-01-18 18:23:52 -0500] maplebed: Explore chef to configure the nodes mostly; leave fancy inter-app stuff for when you understand more about how it works.
[2013-01-18 18:24:11 -0500] doomviking: I concur with maplebed
[2013-01-18 18:24:37 -0500] maplebed: but fwiw, this code runs on hosts that are to be monitored in order to find out who will be monitoring them: https://github.com/opscode-cookbooks/nagios/blob/master/recipes/client.rb#L25-L38
[2013-01-18 18:25:45 -0500] Guest93917: <maplebed>Perfect.  Thanks
[2013-01-18 18:26:59 -0500] Guest93917: I will take your advice and learn more before launching into a more complicated project.  One final question
[2013-01-18 18:27:24 -0500] maplebed: keep 'em coming!
[2013-01-18 18:27:53 -0500] Guest93917: What knife command would I use to deploy multiple instances of just the app server (down the road)?
[2013-01-18 18:28:02 -0500] supergrilo: init is easy to solve, but you will always ensure the process will run with "ruby"?
[2013-01-18 18:28:08 -0500] supergrilo: jtimberman
[2013-01-18 18:28:18 -0500] maplebed: I wrap knife in a for loop when I want to launch multiple instances.
[2013-01-18 18:28:21 -0500] Guest93917: assuming app server is a separate node
[2013-01-18 18:28:41 -0500] maplebed: eg for i in {1..9}; do knife ec2 create blah blah host$i &  done
[2013-01-18 18:28:57 -0500] maplebed: Undoubtably there are other ways...
[2013-01-18 18:29:03 -0500] maplebed: (autoscaling groups come to mind)
[2013-01-18 18:29:36 -0500] Toger: the ironfan knife plugin is supposed to help with that
[2013-01-18 18:30:50 -0500] Guest93917: within the knife ec2 server create blah blah host$i how would i specify to only create the app node and NOT the db node?
[2013-01-18 18:30:50 -0500] maplebed: Toger: https://github.com/infochimps-labs/ironfan is what you mean?
[2013-01-18 18:31:11 -0500] Toger: thats the one
[2013-01-18 18:31:17 -0500] Toger: looks promising, but I haven't implemented it yet
[2013-01-18 18:31:18 -0500] maplebed: Guest93917: the -r flag.  create -r "role[app]" ...
[2013-01-18 18:31:26 -0500] Guest93917: perfect!
[2013-01-18 18:31:31 -0500] Guest93917: thanks again
[2013-01-18 18:31:31 -0500] Toger: so far I use a slightly more advanced version of what you are using
[2013-01-18 18:31:32 -0500] maplebed: explore the other flags.
[2013-01-18 18:31:40 -0500] maplebed: -G for security group, -f for instance type, etc.
[2013-01-18 18:36:56 -0500] ryduh: when running knife ec2 server list I'm getting this error "ERROR: URI::InvalidURIError: the scheme https does not accept registry part: ec2..amazonaws.com:443"
[2013-01-18 18:37:09 -0500] ryduh: Where's good to start debugging this?
[2013-01-18 18:37:20 -0500] Toger: is that really a double-dot in the hostname?
[2013-01-18 18:37:30 -0500] ryduh: I think it was caused by terminating a knife ec2 server create early
[2013-01-18 18:37:46 -0500] ryduh: i have terminated all my ec2 instances
[2013-01-18 18:38:05 -0500] ryduh: is there a ec2 cache somewhere on my system that knife uses?
[2013-01-18 18:38:14 -0500] ryduh: or, the knife-ec2 plugin
[2013-01-18 18:39:13 -0500] Toger: ryduh: not that I am aware of, I've canceled lots of server-creates.  Is the hostname really ec2..amazonaws.com:443 ?
[2013-01-18 18:39:17 -0500] Toger: with two dots?
[2013-01-18 18:40:33 -0500] gchristensen: what is going on at this devopsday, skymall?
[2013-01-18 18:42:43 -0500] ryduh: Toger: that's what shows up on my CLI
[2013-01-18 18:42:55 -0500] Toger: check your knife config, I think you have a typo in there
[2013-01-18 18:43:39 -0500] ryduh: I don't have urls in my knife config
[2013-01-18 18:53:14 -0500] tjr9898: Is there a resource I should use if I want chmod a dir or just use the directory resource?
[2013-01-18 18:55:46 -0500] kaerast: tjr9898, use the directory resource
[2013-01-18 18:56:02 -0500] ryduh: tjr9898: that's also a question i had yesterday. i think i just run an execute command
[2013-01-18 18:56:30 -0500] tjr9898: kaerast: For the action, to I just use create even if already exist?
[2013-01-18 18:56:31 -0500] kaerast: execs aren't idempotent
[2013-01-18 18:57:02 -0500] ryduh: kaerast: if the directory exists, it won't error? will it chmod?
[2013-01-18 18:57:05 -0500] kaerast: you don't need an action at all, create is the default
[2013-01-18 18:57:19 -0500] kaerast: create will manage the directory and recreate it if it's ever removed
[2013-01-18 18:57:36 -0500] kaerast: it will ensure that the directory exists and has any ownership and permissions you've set
[2013-01-18 18:57:39 -0500] ryduh: sweet
[2013-01-18 18:57:57 -0500] kaerast: executes are a bad idea as they will try creating the directory every single time
[2013-01-18 18:58:13 -0500] kaerast: I've spent far too much time removing executes from in-house code this week
[2013-01-18 18:58:41 -0500] kaerast: the etsy foodcritic rules are pretty good at catching bad practises like execs where you can use in-built chef commands
[2013-01-18 18:59:10 -0500] timsmith: food critic is your friend
[2013-01-18 18:59:47 -0500] kaerast: timsmith, foodcritic with customised etsy rules and very few of the default rules is your friend
[2013-01-18 18:59:52 -0500] jtimberman: kaerast: execute("yum install foo") { not_if "rpm -qa | grep foo" }, right? :)
[2013-01-18 19:00:06 -0500] timsmith: the latest version includes those etsy rules I believe
[2013-01-18 19:00:09 -0500] timsmith: 1.7?
[2013-01-18 19:00:49 -0500] Toger: When bootstrapping chef 10.18.0 on centos with chef-solo, I get: No such file or directory - nil/gems/chef-10.18.0/distro/redhat/etc/sysconfig/chef-solr
[2013-01-18 19:00:50 -0500] tjr9898: jtimberman: what's wrong with that :P
[2013-01-18 19:00:56 -0500] kaerast: jtimberman, mostly adding users to secondary groups because somebody had failed to spot the group resource
[2013-01-18 19:00:57 -0500] jtimberman: FC040 and FC041 are etsy rules.
[2013-01-18 19:01:12 -0500] jtimberman: tjr9898: package "foo" does the same thing and is portable :)
[2013-01-18 19:01:24 -0500] Toger: ohai says the ruby gem dir is 'nil', but since this is the omnibus install it shouldn't be looking for the system ruby. any suggestions?
[2013-01-18 19:01:32 -0500] jtimberman: tjr9898: TIMTOWTDI, but you should use built-in resources where possible.
[2013-01-18 19:01:57 -0500] kaerast: or that one insane case where somebody was putting a file in place, using sed to modify it, and then executing it in order to modify some directories
[2013-01-18 19:03:03 -0500] jtimberman: :)
[2013-01-18 19:11:56 -0500] cassianoleal: why does an override_attribute set on a role gets precedence over an override_attribute set on the environment? this is happening during initial bootstrap. chef-client on the node is 10.18.0 and I'm using hosted chef.
[2013-01-18 19:15:07 -0500] cassianoleal: well, even a default_attribute on the role is taking precedence :-S
[2013-01-18 19:17:54 -0500] cassianoleal: never mind, my mistake :-/
[2013-01-18 19:18:04 -0500] mjolk: How do I make chef away of my resource from a LWRP?
[2013-01-18 19:18:58 -0500] mjolk: http://wiki.opscode.com/pages/viewpage.action?pageId=7274964 this skips around
[2013-01-18 19:19:21 -0500] mjolk: see: opscode_database - where is that resource defined?
[2013-01-18 19:22:12 -0500] spox: hrm, no anchors
[2013-01-18 19:22:27 -0500] spox: mjolk: right under this text on that page: "Taking the database example, our Resource might be defined by:"
[2013-01-18 19:22:45 -0500] mjolk: I did that
[2013-01-18 19:22:54 -0500] mjolk: but it's still not registering on the compile stage
[2013-01-18 19:23:06 -0500] spox: are you using it in another cookbook?
[2013-01-18 19:23:37 -0500] mjolk: no, same cookbook, which is the part i'm finding frustrating
[2013-01-18 19:23:53 -0500] spox: what's the name of your cookbook?
[2013-01-18 19:24:15 -0500] mjolk: validatekey
[2013-01-18 19:24:17 -0500] spox: okay
[2013-01-18 19:24:29 -0500] spox: so lwrp resource/provider names are based on cookbook name + file name
[2013-01-18 19:24:34 -0500] spox: so it would be: validatekey_database
[2013-01-18 19:26:44 -0500] mjolk: spox : thanks, testing things before copy/pasting every line that changes
[2013-01-18 19:27:10 -0500] ggolin: hello
[2013-01-18 19:28:33 -0500] w6fu: finally figured out my dhcp cookbook from before, if anyone is interested
[2013-01-18 19:29:18 -0500] w6fu: seems it relys on a dns cookbook, since I don't have one I've edited the library to use .nil? instead of .empty?
[2013-01-18 19:31:02 -0500] mjolk: spox : thank you very, very much.  i've gone over this recipe so many times that i just started spacing on the wording in the docs
[2013-01-18 19:33:48 -0500] ggolin: got a foodcritic question
[2013-01-18 19:34:17 -0500] ggolin: one of the tests is failing, stating that the template variable is not being used.
[2013-01-18 19:35:24 -0500] ggolin: http://pastie.org/5721421 thats the template
[2013-01-18 19:35:33 -0500] ggolin: and that variable is being passed
[2013-01-18 19:35:36 -0500] ggolin: what am i doing wrong here?
[2013-01-18 19:37:25 -0500] spox: ggolin: got the template resource definition handy?
[2013-01-18 19:44:18 -0500] makerbreakr: why would this be looping through twice?
[2013-01-18 19:44:19 -0500] makerbreakr: https://gist.github.com/4567781
[2013-01-18 19:44:34 -0500] makerbreakr: json.template, is the output in the template file, and the raw json
[2013-01-18 19:46:25 -0500] ggolin: spox, what i pasted?
[2013-01-18 19:46:30 -0500] ggolin: http://pastie.org/5721421 this?
[2013-01-18 19:47:19 -0500] version2beta: Question on best practices: who should manage library dependencies for Python or Ruby, chef or the repo? For example, should my cookbook include calls to pip install all the Python modules used by the app, or should I use a requirements.txt file a la Django?
[2013-01-18 19:48:07 -0500] spox: ggolin: no, the actual template resource call in the recipe
[2013-01-18 19:48:21 -0500] ggolin: spox, oh yeah, one sec
[2013-01-18 19:54:52 -0500] ggolin: spox hm
[2013-01-18 19:55:08 -0500] ggolin: doesnt look like passign anything into the template, how the f does it work :)
[2013-01-18 19:56:26 -0500] ggolin: spox found it. its not the template, its how the template is called.
[2013-01-18 19:57:11 -0500] ggolin: http://pastie.org/5721543
[2013-01-18 19:58:00 -0500] spox: ggolin: it's complainint about the :blades assignment
[2013-01-18 19:58:07 -0500] spox: since it's not being used in the actual template
[2013-01-18 20:05:12 -0500] supergrilo: jtimberman tks
[2013-01-18 20:13:01 -0500] r3vamp: jkeiser: Sorry just saw your message, i'll give it a shot one sec
[2013-01-18 20:14:53 -0500] cwj: version2beta: take a look at application_python cookbook, it will install from requirements.txt as part of deploying your app
[2013-01-18 20:15:32 -0500] cwj: version2beta: we have tried using chef to manage the dependencies and it seems to me much better to let the repo tell you what it wants
[2013-01-18 20:16:01 -0500] ggolin: spox, thanks. tests are passing now. now to run kitchen.
[2013-01-18 20:24:08 -0500] r3vamp: jkeiser: yup, knife-essentials 0.8.5 now works with my chef 10.18 and ruby 1.8.7, thanks!
[2013-01-18 20:24:37 -0500] jkeiser: r3vamp: hooray!  I'll test 1.8.7 more often, it's not hard with rbenv
[2013-01-18 20:29:49 -0500] Joel: friday brain farts, I managed to do something retarded, and I'm forgetting how I got it working in the first f'in place. How do I get chef to install packages out of apt?
[2013-01-18 20:30:22 -0500] spox: package 'package_name_i_want'
[2013-01-18 20:30:40 -0500] Joel: spox: <3
[2013-01-18 20:36:12 -0500] Joel: spox: that got me the google results I wanted, where I could specify more attributes too. thanks.
[2013-01-18 20:36:23 -0500] spox: Joel: sure :)
[2013-01-18 20:47:39 -0500] Joel: apt_package being what I needed, before I specified install, but I learned from the docs that's the default, which is cool
[2013-01-18 20:50:29 -0500] heathsnow: Will someone show me the syntax for a knife search where Environment=production and Role=BASE_WIN?  I've never found good documentation...the wiki isn't cutting it for me :S
[2013-01-18 20:51:01 -0500] cwj: heathsnow: knife searhc node 'role:BASE_WIN AND chef_environment:production'
[2013-01-18 20:51:27 -0500] heathsnow: cwj: ah!  thank you...writing it down now :P
[2013-01-18 20:51:47 -0500] Toger: when loadbalancing chef-server api connections (port 4000) does the loadbalancer need to be HTTP aware or will a simple tcp loadbalancer suffice?
[2013-01-18 20:51:55 -0500] cwj: heathsnow: http://wiki.apache.org/solr/SolrQuerySyntax might help
[2013-01-18 20:52:12 -0500] cwj: operators like AND, OR, NOT need to be capitalized
[2013-01-18 20:53:01 -0500] cwj: i think chef's solr uses the default lucene parser but someone else might know better than i
[2013-01-18 20:55:13 -0500] makerbreakr: how do you guys pretty up your json for gist?
[2013-01-18 20:55:25 -0500] makerbreakr: is there a way on the gist.github, to make it readable?
[2013-01-18 20:56:00 -0500] tomdzk: makerbreakr: online tools, or python -mjson.tool < ... work well for me
[2013-01-18 20:57:22 -0500] makerbreakr: dang, github should build that in
[2013-01-18 20:57:30 -0500] makerbreakr: anyways, Im not sure why this is doing what it is:  https://gist.github.com/4568455
[2013-01-18 20:57:52 -0500] makerbreakr: why is it skipping over the first element in the array ?
[2013-01-18 20:58:32 -0500] tomdzk: makerbreakr: screens is a hash, not an array
[2013-01-18 21:01:10 -0500] jtimberman: Opscode COOK Code Review starting, Google+ Hangout: https://plus.google.com/hangouts/_/af56ba95d8543858f3a683fcb164390b34065c0a?authuser=0&hl=en-US YouTube Live Stream: http://youtu.be/4YqZTzKiem0
[2013-01-18 21:05:15 -0500] makerbreakr: tomdzk, so I can juse use .each on the hash?
[2013-01-18 21:05:30 -0500] jkyle: when I run my role, the node's logs show that a specific attribute on a node is testing to true. But when I drop into shef -z to test, it shows the attribute as nil. Shouldn't shef -z load the node's attributes as they appear in the cookbook's recipe?
[2013-01-18 21:05:50 -0500] tomdzk: makerbreakr: sure, node_databag['screens'].each do |(key, value)} ... end
[2013-01-18 21:06:04 -0500] greenmoss: anyone here use chef+vagrant?
[2013-01-18 21:06:09 -0500] greenmoss: and gem_package?
[2013-01-18 21:06:28 -0500] tomdzk: makerbreakr: you could probably also just use an array in the json, "screens": [{"id": ...}, ...]
[2013-01-18 21:07:22 -0500] greenmoss: the vagrant precise 64-bit box includes chef, ruby, and gem in /opt/vagrant_ruby/bin
[2013-01-18 21:07:54 -0500] makerbreakr: what would be the key in that situation?
[2013-01-18 21:08:07 -0500] greenmoss: so when I run a recipe that does "package rubygems", then "gem_package 'bundler'", it installs it in the vagrant_ruby, not the system ruby
[2013-01-18 21:08:15 -0500] tomdzk: makerbreakr: no key, since the index is implicit (it being an array)
[2013-01-18 21:08:26 -0500] makerbreakr: sorry, in the hash situation
[2013-01-18 21:08:39 -0500] makerbreakr: {"0"=>{"id"=>2109, "url"=>"http://localhost/"},
[2013-01-18 21:08:39 -0500] makerbreakr:  "1"=>{"id"=>2108, "url"=>"http://localhost/"}}
[2013-01-18 21:08:44 -0500] makerbreakr: sorry*
[2013-01-18 21:08:47 -0500] tomdzk: makerbreakr: your current structure mimics an array, but map is not naturally sorted on keys
[2013-01-18 21:08:54 -0500] jkyle: or do I misunderstand shef's client mode and it is not rpresentative of a node's environment when running chef-client
[2013-01-18 21:08:56 -0500] makerbreakr: |screen,id|  ?
[2013-01-18 21:09:26 -0500] greenmoss: according to my vagrant VMs PATH, chef *ought* to be using system ruby: PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt/vagrant_ruby/bin
[2013-01-18 21:09:27 -0500] tomdzk: makerbreakr: for hash: node_databag['screens'].each do |(id, screen_hash)| ... end
[2013-01-18 21:09:45 -0500] miah: jkyle: it doesn't load anything until you tell it to. its like typing 'irb' and thinking it should have loaded some random code.
[2013-01-18 21:10:11 -0500] tomdzk: greenmoss: iirc vagrant on purpose brings its own ruby, so as not to rely on the box having a ruby
[2013-01-18 21:10:19 -0500] rocket: jtimberman: mattray ping .. I have a question re the new chef 11 setup that uses ssl
[2013-01-18 21:10:35 -0500] mattray: I know nothing on that
[2013-01-18 21:11:11 -0500] rocket: jtimberman: I am trying to setup a vagrant instance that redirects to the port in question .. eg in chef10 I can redirect 4000:4000 and the port is available like it was running on my laptop locally
[2013-01-18 21:11:23 -0500] rocket: I am trying to replicate the setup with chef11
[2013-01-18 21:11:55 -0500] greenmoss: tomdzk: right, but I would expect "package 'rubygems'", which installs /usr/bin/ruby, to then receive all subsequently-installed gems
[2013-01-18 21:11:56 -0500] rocket: it works unbelievably well with chef 10 in my lab ...
[2013-01-18 21:12:17 -0500] tomdzk: greenmoss: more accurately, when creating a base box, one has to install the ruby for vagrant to use
[2013-01-18 21:12:19 -0500] rocket: I dont have to worry about bridging the vm etc
[2013-01-18 21:12:56 -0500] rocket: can I turn off the ssl?  or set it to use a different port that isnt a priviledged port?
[2013-01-18 21:13:30 -0500] makerbreakr: thanks tomdzk!
[2013-01-18 21:13:53 -0500] greenmoss: tomdzk: I understand, but my recipe needs to use the system ruby, not the vagrant ruby
[2013-01-18 21:14:49 -0500] tomdzk: greenmoss: you might have to explicitly specify the ruby, not sure (I use the rvm cookbook to sidestep any issues with the vagrant/system ruby altogether)
[2013-01-18 21:15:54 -0500] greenmoss: how does Chef decide which ruby to install gems in?
[2013-01-18 21:16:08 -0500] greenmoss: is the default "whichever ruby Chef is using"?
[2013-01-18 21:16:14 -0500] tomdzk: it likely uses the one it runs under
[2013-01-18 21:16:28 -0500] cwj: greenmoss: if you use chef_gem it will go in which ever ruby chef is using
[2013-01-18 21:16:38 -0500] cwj: if you use gem_package it should go in the system ruby
[2013-01-18 21:16:42 -0500] cwj: iirc
[2013-01-18 21:17:06 -0500] greenmoss: I'm using "gem_package 'bundler'", but it's installing in the chef ruby instead of the system ruby
[2013-01-18 21:17:37 -0500] greenmoss: thus, subsequent invocations of "bundle" all have the wrong ruby
[2013-01-18 21:17:40 -0500] Joel: I'm running chef on windows but it won't stop prompting me for the passphrase for my id_rsa, thoughts on how to stop this?
[2013-01-18 21:17:57 -0500] cwj: greenmoss: the gem_binary attribute will let you specify the path to the gem binary you want to use
[2013-01-18 21:17:58 -0500] greenmoss: and cron jobs set up using "bundle", which know nothing of vagrant, fail
[2013-01-18 21:18:20 -0500] greenmoss: cwj: yes, but then I have to specify gem_binary for *every* gem_package?
[2013-01-18 21:18:26 -0500] kallistec: greenmoss: if you don't specify a specific `gem` binary, chef will use the internal rubygems api to install packages
[2013-01-18 21:19:34 -0500] kallistec: greenmoss: make a LWRP or resource definition for site_gems or something if you want to reduce the typing/repetition
[2013-01-18 21:20:00 -0500] Joel: when hitting github for repos that is
[2013-01-18 21:22:06 -0500] greenmoss: I thought people were tending to use self-contained ruby to run chef, plus standard system ruby for everything else
[2013-01-18 21:22:56 -0500] greenmoss: I have used system ruby to run chef, before I started working with Vagrant
[2013-01-18 21:22:59 -0500] bluepojo: If I run shef in client mode, should I be able to see environment attributes?
[2013-01-18 21:23:21 -0500] greenmoss: so now that is an unexpected diversion :p
[2013-01-18 21:24:16 -0500] tomdzk: greenmoss: we run it the other way around, system/vagrant ruby for chef, rvm-deployed ruby to run apps etc,
[2013-01-18 21:24:28 -0500] jkyle: miah: how do you get the node into a state that's representative of what they are in a recipe? e.g. all the attributes applied by roles
[2013-01-18 21:25:06 -0500] greenmoss: tomdzk: do you have a recipe I can steal from?
[2013-01-18 21:26:13 -0500] greenmoss: eg github?
[2013-01-18 21:26:43 -0500] greenmoss: rvm or rbenv would be a-ok for this app
[2013-01-18 21:26:51 -0500] version2beta: cwj, thanks for the feedback. That's my inclination already, and I chatted with the dev team and they thought so too.
[2013-01-18 21:26:55 -0500] greenmoss: (it's the "gitorious" cookbook, which I'm trying to run on Precise)
[2013-01-18 21:27:08 -0500] cwj: version2beta: np
[2013-01-18 21:27:17 -0500] ranjib_: greenmoss, you can provide gem_binary to tell chef use the system ruby/gem
[2013-01-18 21:27:35 -0500] version2beta: cwj, We aren't on Django or a supported python_application framework, so I don't think the cookbook is necessarily the best for me except perhaps as an example. But thank you for that!
[2013-01-18 21:27:44 -0500] greenmoss: ranjib_: yes, but I don't want to do that for every gem_package I need to install
[2013-01-18 21:28:09 -0500] greenmoss: if I convert all my cookbooks to vagrant/berkshelf, I'll have to do this in many places
[2013-01-18 21:28:20 -0500] greenmoss: seems wrong somehow
[2013-01-18 21:28:36 -0500] greenmoss: maybe it's just me
[2013-01-18 21:28:47 -0500] tomdzk: greenmoss: sorry no :) but here are some snippets:
[2013-01-18 21:28:52 -0500] tomdzk: greenmoss: rvm_shell "bundle install --local" do
[2013-01-18 21:28:53 -0500] tomdzk:   code "rm Gemfile.lock; bundle install --quiet --local"
[2013-01-18 21:28:53 -0500] tomdzk: end
[2013-01-18 21:29:03 -0500] ranjib_: greenmoss, ideally chef_gem should install gems in omnnibus/chef's
[2013-01-18 21:29:08 -0500] bluepojo: greenmoss: we use rbenv to run apps, and internal ruby to run chef
[2013-01-18 21:29:21 -0500] cwj: version2beta: yeah it is a good example to work from. i have been trying to add a LWRP to the python cookbook for installing requirement files outside of the application_python cookbook, but i am having a hard time making it idempotent without writing a ruby implementation of pip's parser :(
[2013-01-18 21:29:35 -0500] tomdzk: greenmoss: and this for global rvm conf: {
[2013-01-18 21:29:35 -0500] tomdzk:   "id": "rvm",
[2013-01-18 21:29:36 -0500] tomdzk:   "version": "1.16.10",
[2013-01-18 21:29:36 -0500] tomdzk:   "branch": "none",
[2013-01-18 21:29:36 -0500] tomdzk:   "user_installs": [{
[2013-01-18 21:29:36 -0500] tomdzk:     "user": "foo",
[2013-01-18 21:29:37 -0500] tomdzk:     "group": "foo",
[2013-01-18 21:29:37 -0500] tomdzk:     "rubies": [ "1.9.3" ],
[2013-01-18 21:29:37 -0500] tomdzk:     "default_ruby": "1.9.3",
[2013-01-18 21:29:37 -0500] tomdzk:     "global_gems": [{
[2013-01-18 21:29:38 -0500] tomdzk:       "name": "bundler",
[2013-01-18 21:29:38 -0500] tomdzk:       "version": "1.2.1"
[2013-01-18 21:29:39 -0500] tomdzk:     }, {
[2013-01-18 21:29:45 -0500] tomdzk:       "name": "rake",
[2013-01-18 21:29:46 -0500] cwj: tomdzk: use gist or pastebin please
[2013-01-18 21:29:46 -0500] tomdzk:       "version": "0.9.2.2"
[2013-01-18 21:29:47 -0500] tomdzk:     }]
[2013-01-18 21:29:47 -0500] tomdzk:   }]
[2013-01-18 21:29:48 -0500] tomdzk: }
[2013-01-18 21:30:08 -0500] tomdzk: cwj: will do next time
[2013-01-18 21:30:14 -0500] cwj: thanks!
[2013-01-18 21:32:35 -0500] version2beta: cwj, you've got me worried. Pip install won't install what's already there unless you say '--upgrade'. Isn't that idempotent enough?
[2013-01-18 21:33:32 -0500] cwj: version2beta: what if i want to fire notifications when pip has actually done something?
[2013-01-18 21:33:37 -0500] cwj: e.g. restart the app
[2013-01-18 21:36:29 -0500] cwj: the application_python cookbook relies on pip's idempotence by using an execute resource to run pip at every deploy, and thats good enough for most purposes
[2013-01-18 21:39:28 -0500] version2beta: cwj, these are good points. Pip documentation doesn'
[2013-01-18 21:39:43 -0500] version2beta: t specify a return value, either, although it does return something.
[2013-01-18 21:41:12 -0500] version2beta: cwj, for my application cookbook I think I can trust restarting the app after run, that is assuming that chef-client won't run the cookbook if nothing has changed.
[2013-01-18 21:42:08 -0500] cwj: well chef will run the recipes in its run list regardless, but if your recipes are idempotent then the app shouldnt restart unless chef encounters a condition that requires it to do so
[2013-01-18 21:42:29 -0500] cwj: e.g. the revision you specified is not yet deployed
[2013-01-18 21:42:45 -0500] cwj: but yeah i think we are both saying the same thing
[2013-01-18 21:43:00 -0500] greenmoss: tomdzk: are you using chef-rbenv cookbook: https://github.com/fnichol/chef-rbenv ?
[2013-01-18 21:43:42 -0500] tomdzk: greenmoss: rvm, but rbenv should be similar
[2013-01-18 21:48:40 -0500] Joel: I'm doing a librarian-chef install, and one of the github urls it hits keep pulling old code, I haven't specified a version, thoughts on troubleshooting it?
[2013-01-18 21:49:37 -0500] logikal_: Is it possible to use the current chef-server cookbook to grab and install pre-11.0.0 versions?
[2013-01-18 21:59:03 -0500] heydrick: hosted chef having issues?
[2013-01-18 21:59:40 -0500] heydrick: we are seeing 500's
[2013-01-18 21:59:45 -0500] mjolk: in `opscode_database "database" do` where does "database" come from?
[2013-01-18 22:00:59 -0500] izo: hi
[2013-01-18 22:01:41 -0500] izo: anybody use voxel + opscode ?
[2013-01-18 22:04:13 -0500] jtimberman: mjolk: a resources/database.rb file in a cookbook called "opscode"
[2013-01-18 22:04:41 -0500] jtimberman: heydrick: best to open a ticket via support@opscode.com; known issues are posted to status.opscode.com
[2013-01-18 22:05:37 -0500] mjolk: thanks jtimberman
[2013-01-18 22:05:42 -0500] cap10morgan: is there a way to set env vars on the remote side with knife ssh?
[2013-01-18 22:05:46 -0500] maplebed: status.opscode.com is down.
[2013-01-18 22:05:50 -0500] maplebed: guess that means there are problems?
[2013-01-18 22:05:58 -0500] maplebed: :P
[2013-01-18 22:06:47 -0500] izo: "Service is temporarily unavailable. Our engineers are working quickly to resolve the issue."
[2013-01-18 22:06:50 -0500] izo: looks like
[2013-01-18 22:08:06 -0500] mjolk: so to be sure for 'opscode_database "database" do', i'm looking at `#COOKBOOK_#PROVIDERS/FILENAME.RB "#RESOURCE/FILENAME.RB" do` ?
[2013-01-18 22:08:09 -0500] izo: cap10morgan: http://wiki.opscode.com/display/chef/Unix+Environment+Variables+and+Chef+Recipes
[2013-01-18 22:08:52 -0500] izo: anybody using voxel here, or other hosting provider diff than amazon with bootstrapping ?
[2013-01-18 22:10:10 -0500] mjolk: I'm getting frustrated.  I'm writing a LWRP and I followed the docs, but I'm still getting  FATAL: NameError: Cannot find a resource for validatekey_validatekey on ubuntu version 12.04
[2013-01-18 22:10:36 -0500] qhartman: mjolk, oh! I wrote my first LWRP last month and I ran into a similar problem.....
[2013-01-18 22:10:43 -0500] mjolk: cookbook name: validatekey, resources/method.rb and providers/validatekey.rb exist
[2013-01-18 22:11:52 -0500] qhartman: ahhhhh crap, I can't remember....
[2013-01-18 22:12:12 -0500] martinisoft: Any Berkshelf users here?
[2013-01-18 22:12:14 -0500] qhartman: if it comes to me I'll drop a note
[2013-01-18 22:12:21 -0500] mjolk: thanks qhartman.
[2013-01-18 22:12:28 -0500] mjolk: anyone else?  not sure why this is being pissy
[2013-01-18 22:13:19 -0500] qhartman: so you need to include the recipe that has the LWRP
[2013-01-18 22:13:56 -0500] qhartman: then after that invoke it with cookbook_resource
[2013-01-18 22:14:31 -0500] qhartman: so I think based on what you said above, you should be using validatekey_method ?
[2013-01-18 22:14:38 -0500] mjolk: i'm in the same recipe
[2013-01-18 22:15:04 -0500] mjolk: i'm calling the LWRP from the recipe, all under /cookbooks/validatekey
[2013-01-18 22:15:08 -0500] tomdzk: mjolk: I didn't quite follow your problem, but usually the resource and the provider have the same name, and then  you use it as <cookbook name>_<resource name>
[2013-01-18 22:15:23 -0500] mjolk: i'm following this: http://docs.opscode.com/essentials_cookbook_lwrp_example.html
[2013-01-18 22:15:39 -0500] qhartman: If you could post some code in a paste I'm sure someone could point out the problem
[2013-01-18 22:15:46 -0500] tomdzk: mjolk: e.g. in your case, you should have resources/method.rb and provider/method.rb, and then it should be available as validatekey_method
[2013-01-18 22:15:49 -0500] mjolk: cool, let me clean out the stuff i can't show
[2013-01-18 22:16:06 -0500] mjolk: i have a providers/validatekey.rb
[2013-01-18 22:16:09 -0500] qhartman: ^ what tomdzk said
[2013-01-18 22:16:16 -0500] mjolk: i'll move both resources and provider so they're method
[2013-01-18 22:17:17 -0500] mjolk: tomdzk : thank you
[2013-01-18 22:17:22 -0500] mjolk: and thanks qhartman
[2013-01-18 22:17:26 -0500] mjolk: getting further
[2013-01-18 22:18:41 -0500] mjolk: i'll let you know when it's done - open sourcing the recipe when it's done
[2013-01-18 22:18:58 -0500] qhartman: nice
[2013-01-18 22:22:49 -0500] mjolk: what it does is pretty obvious by the name, but it does pre-comparisons of SSH fingerprints so people can stop doing the dangerous "stricthostkeychecking no"
[2013-01-18 22:25:32 -0500] heathsnow: So I can only find manual install instructions for upgrading chef-client on windows machines....but I need to upgrade it on ~ 40 boxes.....there's GOT to be an automated way no?
[2013-01-18 22:25:47 -0500] mjolk: are you in an active directory domain?
[2013-01-18 22:25:52 -0500] heathsnow: yep
[2013-01-18 22:26:00 -0500] mjolk: can you deploy apps with AD?
[2013-01-18 22:26:34 -0500] heathsnow: :S  that means a reboot
[2013-01-18 22:26:38 -0500] mjolk: lol
[2013-01-18 22:26:38 -0500] mattray: heathsnow: have you looked at http://community.opscode.com/cookbooks/omnibus_updater ?
[2013-01-18 22:26:51 -0500] mjolk: i don't use windows, but surely you can write a recipe to install a new package
[2013-01-18 22:26:53 -0500] mjolk: or that
[2013-01-18 22:27:04 -0500] jtimberman: maplebed: status.opscode.com is on tumblr, so :)
[2013-01-18 22:28:02 -0500] maplebed: I'm not sure what that means.
[2013-01-18 22:29:00 -0500] heathsnow: @mattray: I'm taking a look at that now
[2013-01-18 22:32:41 -0500] digitalfire: hi all
[2013-01-18 22:32:48 -0500] digitalfire: i was wondering
[2013-01-18 22:33:56 -0500] digitalfire: is anyone using wrapper and/or role cookbooks?
[2013-01-18 22:34:26 -0500] cwj: digitalfire: sure
[2013-01-18 22:34:34 -0500] digitalfire: and if so does anyone have any tips / sources for best practices on how people are doing this in the wild?
[2013-01-18 22:34:55 -0500] digitalfire: i have had some difficulty finding good info
[2013-01-18 22:35:27 -0500] digitalfire: oh hey cwj
[2013-01-18 22:35:35 -0500] digitalfire: sry didnt see
[2013-01-18 22:36:08 -0500] digitalfire: ohai
[2013-01-18 22:36:19 -0500] cwj: digitalfire: i dont know what particular stumbling blocks you might be encountering, but this blog post illuminated some things for me about setting node attributes directly inside a recipe, and overriding the attributes of resources in other recipes
[2013-01-18 22:36:21 -0500] cwj: http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/
[2013-01-18 22:36:36 -0500] digitalfire: thx
[2013-01-18 22:36:54 -0500] cwj: that helped me to move forward with writing wrapper cookbooks instead of forking every cookbook that doesn't do things exactly the way i like
[2013-01-18 22:36:57 -0500] digitalfire: we are basically at the point where we need to version roles
[2013-01-18 22:37:19 -0500] digitalfire: we've had a few issues with breaking an environment with role changes
[2013-01-18 22:37:32 -0500] viq: Anyone here has an (informed) opinion of chef vs salt ?
[2013-01-18 22:38:40 -0500] digitalfire: we've had theoretical discussions on how we think things should work but i don't want to reinvent the wheel ya know
[2013-01-18 22:40:06 -0500] digitalfire: and now i have to actually build some stuff
[2013-01-18 22:40:14 -0500] cwj: digitalfire: the other thing that i have found helpful is using berkshelf+vagrant to develop cookbooks offline before pushing them to a test environment
[2013-01-18 22:40:56 -0500] cwj: digitalfire: and this blog post is relevant to that http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-01-18 22:41:19 -0500] cwj: (despite the gangnam style reference :))
[2013-01-18 22:41:32 -0500] digitalfire: yeah that article is where our whole re-design plan came from
[2013-01-18 22:41:37 -0500] digitalfire: and practical need obv
[2013-01-18 22:41:49 -0500] digitalfire: psy knows chef
[2013-01-18 22:43:20 -0500] dougireton: In a recipe, how do I get the node's role name?
[2013-01-18 22:45:09 -0500] mjolk: What's a good way to add a private ssh key to a server with chef?
[2013-01-18 22:46:33 -0500] bluepojo: for secure things like keys, I use encrypted databags and write the file
[2013-01-18 22:47:14 -0500] mjolk: Where are you keeping the shared key bluepojo ?
[2013-01-18 22:47:20 -0500] mjolk: that's just abstracting the issue
[2013-01-18 22:47:32 -0500] mjolk: Oh. I see how it helps
[2013-01-18 22:47:37 -0500] mjolk: Not idea, but cool
[2013-01-18 22:48:03 -0500] bluepojo: the key is distributed when you bootstrap the box
[2013-01-18 22:48:06 -0500] bluepojo: the secret, I mean
[2013-01-18 22:48:10 -0500] bluepojo: to decrypt the data bag
[2013-01-18 22:48:39 -0500] mjolk: Yeah, and it keeps all hosts from seeing the ssh key
[2013-01-18 22:48:47 -0500] mjolk: only the ones that can also get the secret
[2013-01-18 22:49:23 -0500] bluepojo: if you want to be particularly careful, you can even use multiple data bag secrets
[2013-01-18 22:49:32 -0500] bluepojo: chef doesn't enforce that you use 1 key for every encrypted data bag
[2013-01-18 22:49:47 -0500] bluepojo: just that when you decrypt you have the key that was used to encrypt
[2013-01-18 22:51:03 -0500] mjolk: cool
[2013-01-18 22:51:45 -0500] cwj: anyone actively using the spice gem?
[2013-01-18 22:52:12 -0500] cwj: surprised to see that the latest version cannot be installed along side recent chef releases
[2013-01-18 22:54:34 -0500] heathsnow: If anyone is interested.......a simple re-bootstrap on Windows machines will update chef-client to latest :)  Whew.
[2013-01-18 22:55:14 -0500] heathsnow: just need to script it for 50 machines and script re-adding env/roles
[2013-01-18 22:57:03 -0500] jsh: I'm looking for a good getting started guide to help one of my local windows admins drink the Chef koolaid...any suggestions?
[2013-01-18 23:25:03 -0500] mjolk: so, why would one of my ruby classes work in `irb` but not through `vagrant provision`? ideas?
[2013-01-18 23:25:24 -0500] mjolk: getting STDERR: sh: 1: Syntax error: word unexpected (expecting ")") even though _i'm_ never shelling out in the code
[2013-01-18 23:25:34 -0500] tomdzk: mjolk: ruby -c gives any hints ?
[2013-01-18 23:26:06 -0500] mjolk: Syntax OK
[2013-01-18 23:27:16 -0500] mjolk: hold on, i think my mom drank while i was in the womb
[2013-01-18 23:27:36 -0500] doomviking: heh
[2013-01-18 23:33:31 -0500] WPsites: I've got a recipe that sets up a website. I need to extend this to create a similar website but with a different configuration. around 50% of the recipee code would be the same for each recipe. it's just the bit in the middle that would be different. Should I create another recipe which would be very like the first one or should I add some more logic (if site_type=2) to the current recipe to check on the type of site and then act accordingly?
[2013-01-18 23:33:56 -0500] ryduh: WPsites: make a role for the common code. ?
[2013-01-18 23:37:06 -0500] WPsites: The current recipe for example is called wepapp.rb and it downloads the src, unzips, creates the path, adds a config file and then adds the apache vhost. Where would the role fit into this? That whole process is currently in a role called website (for example).
[2013-01-18 23:38:46 -0500] kallistec: WPsites: the best way to make a "parameterized recipe" is with an LWRP or resource definition
[2013-01-18 23:39:14 -0500] WPsites: the difference with the app I need to incorporate is instead of the app files being downloaded and unzipped the web app files will already be on the hard drive so just a symlink to the code is required.
[2013-01-18 23:39:40 -0500] WPsites: I have seen LWRP mentioned before but have no experience with it
[2013-01-18 23:40:57 -0500] kallistec: WPsites: http://wiki.opscode.com/pages/viewpage.action?pageId=7274964 http://docs.opscode.com/essentials_cookbook_lwrp.html
[2013-01-18 23:41:14 -0500] kallistec: there were some good blog posts about this recently as well
[2013-01-18 23:42:21 -0500] mjolk: i'm in cookbooks/validatekey/recipes and i'm calling validatekey_method[method], method exists in both resources and providers
[2013-01-18 23:42:34 -0500] mjolk: still getting an error of: FATAL: NameError: validatekey_method[method] (validatekey::default line 72) had an error: NameError: Cannot find a resource for validatekey on ubuntu version 12.04
[2013-01-18 23:43:15 -0500] tomdzk: mjolk: gist for resource, provider, recipe ?
[2013-01-18 23:43:20 -0500] mjolk: sure
[2013-01-18 23:43:35 -0500] mjolk: thanks :)
[2013-01-18 23:47:34 -0500] WPsites: kallistec: thanks LWRP looks like the direction in need to go in
[2013-01-18 23:47:46 -0500] mjolk: tomdzk https://gist.github.com/4569662
[2013-01-18 23:51:29 -0500] occupwnt: I have something I want to install via tarball, but I don't want it to uncompress every run. I tried doing "notifies :run, resources(:execute => "extract tarball")" but it doesn
[2013-01-18 23:51:38 -0500] occupwnt: t ever run that code block. How should I best accomplish this?
[2013-01-18 23:51:52 -0500] maplebed: use not_if ?
[2013-01-18 23:52:10 -0500] tomdzk: mjolk: you have the initialize method twice (in provider and resource), not sure if that matters
[2013-01-18 23:52:21 -0500] tomdzk: mjolk: other than that it looks like it should owrk
[2013-01-18 23:52:51 -0500] mjolk: tomdzk commenting it out of resources now
[2013-01-18 23:53:15 -0500] mjolk: same.
[2013-01-18 23:54:15 -0500] mjolk: commenting it out from both doesn't matter either
[2013-01-18 23:59:31 -0500] occupwnt: maplebed:  I thought about using not_if, but I want to have the ability to upgrade the tarball, so I can't just test for the existence of the extracted directory. I'm thinking notify is the correct option, I just need to figure out my syntax I think.
