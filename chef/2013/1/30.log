[2013-01-30 00:17:31 -0500] DanR_e: @otterley:  Thanks.  So much trouble to date, and probaly it due to using rvm.  Omnibus chef?  I'll check it out and switch.  (BTW the 12.10 is the bootstrap target, so in the future.)
[2013-01-30 00:18:06 -0500] otterley: bootstrap should be capable of installing omnibus for you automatically
[2013-01-30 00:18:22 -0500] otterley: still, I'd avoid non-stable Ubuntu versions in production, or anything resembling production
[2013-01-30 00:18:40 -0500] otterley: (or even stable Ubuntu, for that matter...)
[2013-01-30 00:18:46 -0500] chip-: *rimshot*
[2013-01-30 00:18:59 -0500] otterley: oh hai chip-
[2013-01-30 00:19:23 -0500] chip-: ohai otterley
[2013-01-30 00:19:39 -0500] chip-: DanR_e: This is a handy one-liner: curl -L https://www.opscode.com/chef/install.sh | sh
[2013-01-30 00:19:44 -0500] otterley: chip-, I need to show you my newest ssh management code
[2013-01-30 00:19:57 -0500] chip-: otterley: Got some good stuff?
[2013-01-30 00:20:08 -0500] otterley: yeah, here's what a databag looks like
[2013-01-30 00:21:02 -0500] otterley: https://gist.github.com/9dc48b2629aa49dcbba3
[2013-01-30 00:21:12 -0500] otterley: the policy itself is bad, but hey, at least it's policy
[2013-01-30 00:22:50 -0500] chip-: otterley: Hey, once you can express a policy, then you can argue about it!
[2013-01-30 00:22:57 -0500] otterley: exactry
[2013-01-30 00:23:27 -0500] otterley: I extended Ohai to add user ssh public keys to the etc subtree
[2013-01-30 00:23:37 -0500] otterley: so now we can just run a knife search, and voila
[2013-01-30 00:23:58 -0500] chip-: Right on. That plugin sounds very useful.
[2013-01-30 00:24:08 -0500] otterley: $1000 a copy, y'all
[2013-01-30 00:24:16 -0500] chip-: D:
[2013-01-30 00:24:21 -0500] otterley: daddy needs a new motorbike
[2013-01-30 00:24:30 -0500] chip-: Didn't you just buy one today?
[2013-01-30 00:24:39 -0500] otterley: um.... maybe.
[2013-01-30 00:26:13 -0500] rb1980: hey guys! Hoping someone can help me sort out some confusion with knife:
[2013-01-30 00:27:13 -0500] rb1980: so the person(s) before me who set up chef put everything in a local svn repo and that is where we typically make changes, then those get uploaded to hosted chef
[2013-01-30 00:27:47 -0500] rb1980: but before i realized this, I made some changes on the management portal on hosted chef
[2013-01-30 00:28:05 -0500] rb1980: which got me to thinking i should probably have a way to sync those changes back
[2013-01-30 00:28:26 -0500] rb1980: but the files in the local svn repo for roles for example are rolename.rb
[2013-01-30 00:29:06 -0500] rb1980: is there any way to get knife role show to spit out .rb instead of json? so i can just dump those back to local files?
[2013-01-30 00:29:37 -0500] otterley: rb1980: I think it's a one-way operation.
[2013-01-30 00:29:48 -0500] chip-: rb1980: No, once the file gets stored in the Chef server, it's JSON from there on out.
[2013-01-30 00:29:49 -0500] jtimberman: rb1980: the server stores only the rendered json, so it can only return the JSON
[2013-01-30 00:29:50 -0500] rb1980: so the confusion is: when you do say knife role from file, it expects rb?
[2013-01-30 00:29:52 -0500] chip-: Can only export as json.
[2013-01-30 00:29:54 -0500] otterley: it's a good reason to always use JSON
[2013-01-30 00:30:12 -0500] chip-: rb1980: If you say knife role from file filename.json, it'll figure it out.
[2013-01-30 00:30:14 -0500] rb1980: so if i converted all the local files to .json, i'd be good?
[2013-01-30 00:30:19 -0500] jtimberman: rb1980: yup
[2013-01-30 00:30:28 -0500] rb1980: great, that works. thanks!
[2013-01-30 00:30:32 -0500] jtimberman: The Ruby DSL is available for flexibility.
[2013-01-30 00:30:37 -0500] chip-: Be careful with that if you're using per-environment run lists.
[2013-01-30 00:31:02 -0500] jtimberman: Because sometimes you "don't", "want": ["to", "remember"] or parse "json": "and" "its commas", and "quotes"
[2013-01-30 00:31:07 -0500] jtimberman: :)
[2013-01-30 00:31:15 -0500] rb1980: heh, ok
[2013-01-30 00:32:12 -0500] chip-: I'm in the opposite camp, fwiw. I like using json for those files more than I like using Ruby, because sometimes you don't => want to %w(remember the syntax) ['other']['people'] :might use.
[2013-01-30 00:37:27 -0500] log1kal: Sadface for contributors without CLAs
[2013-01-30 00:37:53 -0500] log1kal: https://github.com/opscode-cookbooks/tomcat/pull/6 makes me a sadpanda.
[2013-01-30 00:38:47 -0500] otterley: jtimberman, that's why I write scripts to write and manipulate the json
[2013-01-30 00:39:30 -0500] otterley: it's a lot easier than writing your own Ruby parser and Chef emulator
[2013-01-30 00:41:58 -0500] aboudreault: shouldn't a directory statement, with *recursive true and owner X* set the owner of all created directories?
[2013-01-30 00:42:12 -0500] ryduh: is there a way to write a chef recipe to redeploy a site using the deploy resource
[2013-01-30 00:42:24 -0500] aboudreault: bah... will use a %w{} with a each loop instead.
[2013-01-30 00:42:29 -0500] ryduh: or is chef only meant to be run during the initial system provision?
[2013-01-30 00:46:18 -0500] timsmith: aboudreault: The problem with recursive is this.  say I tell chef to create /opt/my/app/is/super cool owned by root with recursive is true.  Then I change the recipe later to have a user of www-data.  Only that very last folder will get the permission change.  Chef has no knowledge of what it changed in the past
[2013-01-30 00:48:03 -0500] miah:  chef only knows about the objects (resources, nodes, attributes) you create with it
[2013-01-30 00:48:24 -0500] miah: a recursive operation means chef knows about a, but not b, or c, or d.
[2013-01-30 00:48:53 -0500] miah: unless you do something to build a list of files/directories under a location and build resources out of them
[2013-01-30 00:49:04 -0500] otterley: is chef-client smart enough to cache the results of a search operation if the same search query is made more than once?
[2013-01-30 00:49:15 -0500] zim415: Chef-OS! lol
[2013-01-30 00:49:19 -0500] miah: only if you make your code memoized
[2013-01-30 00:49:29 -0500] aboudreault: I see, yeah
[2013-01-30 00:49:30 -0500] miah: zim415: nixos.org
[2013-01-30 00:50:16 -0500] otterley: miah, trivial example?
[2013-01-30 00:50:18 -0500] zim415: Nice miah; thanks for the link
[2013-01-30 00:50:43 -0500] otterley: that works across cookbooks/recipes?
[2013-01-30 00:50:48 -0500] miah: otterley: https://github.com/miah/nagios/blob/refactor/recipes/_nagios_gather_contacts.rb
[2013-01-30 00:50:57 -0500] log1kal: That abandoned pull request inspired me to sign the opscode CLA.
[2013-01-30 00:51:04 -0500] otterley: miah, see above
[2013-01-30 00:51:13 -0500] miah: i stick the results in node.run_state and check for existence there before doing the search again
[2013-01-30 00:51:34 -0500] miah: opscode asking me to sign the cla so i could contribute inspired me to sign the cla
[2013-01-30 00:51:40 -0500] otterley: yeah, i guess I can modify node, but ew
[2013-01-30 00:51:46 -0500] miah: you're not modifying node
[2013-01-30 00:51:52 -0500] otterley: is run_state already defined?
[2013-01-30 00:51:53 -0500] miah: run_state only exists while chef-client is running
[2013-01-30 00:52:27 -0500] miah: https://twitter.com/kantrn/statuses/241642459174682624
[2013-01-30 00:52:51 -0500] otterley: I've never seen docs for run_state before
[2013-01-30 00:52:59 -0500] miah: because its chef internals
[2013-01-30 00:53:07 -0500] miah: its magic hidden away from most users =)
[2013-01-30 00:53:19 -0500] otterley: that seems to counsel against best practice
[2013-01-30 00:53:29 -0500] miah: best practice depends on where you work
[2013-01-30 00:53:46 -0500] miah: if you work with people comfortable reading ruby source code and writing stuff.. then its not against best practices
[2013-01-30 00:54:04 -0500] miah: otoh. if all of your people working on chef have no idea what ruby is.. ya. don't do that.
[2013-01-30 00:54:22 -0500] miah: of course. those people probably won't know what memoize means either.
[2013-01-30 00:54:24 -0500] otterley: I'm thinking more along the lines of using private APIs/data structures in general
[2013-01-30 00:54:35 -0500] miah: maybe.
[2013-01-30 00:54:45 -0500] otterley: private APIs tend to be private for a reason - so that they can be changed without breaking others' code
[2013-01-30 00:54:51 -0500] miah: im in the mindset that thinks writing proper oop recipes isn't a bad idea
[2013-01-30 00:55:05 -0500] miah: but im a weirdo :P
[2013-01-30 00:55:22 -0500] otterley: so, someday, if Opscode decides to rename run_state, our code could break.  that's not a good thing.
[2013-01-30 00:55:34 -0500] zpatten: That's tha nature of using internals
[2013-01-30 00:55:36 -0500] miah: then don't use run_state. use a temporary variable
[2013-01-30 00:55:51 -0500] otterley: but that won't work across recipes or cookbooks
[2013-01-30 00:55:52 -0500] miah: the thing is, run_state is available to all recipes
[2013-01-30 00:56:04 -0500] miah: this is why people test code
[2013-01-30 00:56:25 -0500] miah: to know things are broken before it hists production
[2013-01-30 00:56:41 -0500] otterley: so, contracts are useless?
[2013-01-30 00:56:45 -0500] zpatten: Chef + CI = FTW
[2013-01-30 00:57:05 -0500] miah: contracts?
[2013-01-30 00:57:38 -0500] otterley: oh, dear.
[2013-01-30 00:57:49 -0500] jtimberman: i'm not aware of any plans to change node.run_state, fwiw.
[2013-01-30 00:58:01 -0500] miah: define rather than ridicule
[2013-01-30 00:58:38 -0500] otterley: I can't have this argument here
[2013-01-30 00:58:42 -0500] sethvargo: Even IF node.run_state were changed, opscode would deprecate, then version. PLUS it would be a major version bump. So if you're locking to a specific Chef version in a tool/library/your codebase, it would be an issue
[2013-01-30 00:58:52 -0500] sethvargo: wouldnt*
[2013-01-30 00:59:03 -0500] jtimberman: ya, that'd be a thing for example Chef 12.
[2013-01-30 00:59:04 -0500] tomdzk: miah: I think he refers to https://en.wikipedia.org/wiki/Design_by_contract
[2013-01-30 00:59:23 -0500] miah: im not asking to have a argument. i'd rather have a constructive discussion, in which  or others may learn something
[2013-01-30 00:59:33 -0500] miah: im not a programmer by trade either. i think thats true for most of the people using chef
[2013-01-30 00:59:44 -0500] miah: though, i am educating myself on programming i still have a long ways to go
[2013-01-30 01:00:15 -0500] zpatten: I've been programming for over 20 years, for major companies, and never used that method
[2013-01-30 01:00:41 -0500] otterley: every time you code for a major OS, you are implicitly doing it
[2013-01-30 01:00:56 -0500] otterley: this is why Apple rejects iOS apps that use private APIs
[2013-01-30 01:01:08 -0500] miah: sure, that makes sense
[2013-01-30 01:01:23 -0500] miah: i think if opscode didn't want us to use the run_state method they would hide it below 'private'
[2013-01-30 01:01:37 -0500] sethvargo: "Design by Contract" is a registered https://en.wikipedia.org/wiki/Trademark of https://en.wikipedia.org/wiki/Eiffel_Software seems to me to suggest it's not something an open source community would back
[2013-01-30 01:01:38 -0500] otterley: it's not that you can't test your work, it's that the vendor can't test everyone else's
[2013-01-30 01:01:48 -0500] zpatten: I may of used it by proxy in effect; but I've never seen that method implemented at any place I've ever worked was all I'm saying
[2013-01-30 01:01:49 -0500] tomdzk: generally, published APIs are considered to be a form of contract between supplier and client that both should adhere to
[2013-01-30 01:02:04 -0500] zpatten: As an edict
[2013-01-30 01:02:16 -0500] miah: sethvargo: actually. i think its well discussed in OOP. in that people are told to use only well defined public interfaces.
[2013-01-30 01:02:17 -0500] tomdzk: zpatten: it's more the general idea: "The central idea of DbC is a metaphor on how elements of a software system collaborate with each other on the basis of mutual obligations and benefits"
[2013-01-30 01:02:25 -0500] otterley: sethvargo, I don't mean it in the capital Design by Contract sense, I mean it as a general matter
[2013-01-30 01:02:36 -0500] zpatten: Ya it's looks more theory than practical to me
[2013-01-30 01:02:40 -0500] miah: otterley, zpatten yup. makes complete sense
[2013-01-30 01:02:48 -0500] tomdzk: zpatten: think stable published APIs
[2013-01-30 01:02:56 -0500] miah: right
[2013-01-30 01:02:56 -0500] zpatten: Like you said; it seems more like a core concept of programming than a "style" of programming
[2013-01-30 01:03:00 -0500] zpatten: Ya
[2013-01-30 01:03:16 -0500] otterley: my point, really, is that I am hesitant to use non-published storage systems in Chef, because of the risk
[2013-01-30 01:03:26 -0500] zpatten: Indeed
[2013-01-30 01:03:27 -0500] otterley: but @jtimberman says it's unlikely to go away, so that's good enough for me
[2013-01-30 01:03:47 -0500] zpatten: well it's an internal that will likey cause Opscode much headache to change around; so likely it won't happen anytime soon
[2013-01-30 01:03:51 -0500] tomdzk: otterley: I guess you could always use node.set
[2013-01-30 01:04:01 -0500] otterley: tomdzk, yes
[2013-01-30 01:04:07 -0500] miah: certainly
[2013-01-30 01:04:19 -0500] miah: i totally understand your points otterley
[2013-01-30 01:04:32 -0500] miah: and they're quite valid
[2013-01-30 01:04:33 -0500] sethvargo: @otterley then write a simple spec that checks that that method is defined and returns the value you expect. throw it on CI with a githook. run when a new chef is released. that's the simplest and easiest solution i can see
[2013-01-30 01:04:58 -0500] otterley: sethvargo, or, Opscode could document it and mark it public :)
[2013-01-30 01:05:15 -0500] sethvargo: @otterley I'm sure it will be at some point, but it's not there yet. That's why it's NOT :)
[2013-01-30 01:05:27 -0500] otterley: anyway, I think we're all in violent agreement here
[2013-01-30 01:06:00 -0500] miah: indeed =)
[2013-01-30 01:06:12 -0500] miah: #hugops for all
[2013-01-30 01:06:52 -0500] zpatten: :)
[2013-01-30 01:07:14 -0500] zpatten: I violently agree with my boss all the time :)
[2013-01-30 01:11:33 -0500] maplebed: jtimberman: I love this change: https://github.com/opscode-cookbooks/nagios/blob/jtimberman/v4/recipes/server.rb#L121-L128
[2013-01-30 01:11:39 -0500] maplebed: also, thanks for the mention!  :)
[2013-01-30 01:13:56 -0500] maplebed: blast.  there's a bug I haven't yet uploaded the fix for in that branch.
[2013-01-30 01:20:09 -0500] miah: nice, thats another way to solve the problem we were just discussing
[2013-01-30 01:27:17 -0500] timsmith: maplebed: I need to fix this one too http://tickets.opscode.com/browse/COOK-2257
[2013-01-30 01:27:50 -0500] maplebed: hmm...
[2013-01-30 01:28:24 -0500] maplebed: I suppose it'd be weird to do ip address == ip || 127.0.0.1, huh.
[2013-01-30 01:28:47 -0500] maplebed: (effectively replacing nil with localhost)
[2013-01-30 01:29:01 -0500] timsmith: it's returning an ip of " "
[2013-01-30 01:29:13 -0500] timsmith: I need to get the node data for a node in the state and fix that
[2013-01-30 01:29:17 -0500] timsmith: before 4.0
[2013-01-30 01:43:54 -0500] maplebed: timsmith: something like this is what I meant: https://gist.github.com/4669873
[2013-01-30 01:44:15 -0500] maplebed: obviously getting the real IP address would be best, but without a sample of the error happening...
[2013-01-30 01:45:53 -0500] timsmith: maplebed: I was going to put in a check that would look for an empty value and if it was empty it would use the standard node['ipaddress'] which would be the ideal fallback
[2013-01-30 01:46:55 -0500] maplebed: oh, you're expecting that it's actually trying to use the cloud/public_ipv4 and that's the empty one, rather than not having 'ipaddress' set?
[2013-01-30 01:47:08 -0500] maplebed: seems reasonable.
[2013-01-30 01:49:53 -0500] timsmith: maplebed:  it ends up with an empty value for the cloud IP.  One more if statement should solve the whole thing.
[2013-01-30 01:54:50 -0500] blasdelf1: how do I get chef to not execute every damn thing at compile time?
[2013-01-30 01:55:51 -0500] blasdelf1: it's running all the methods on a class I have in a cookbook library
[2013-01-30 01:56:23 -0500] zpatten: ya; because they get run when the Chef DSL eval's your files
[2013-01-30 01:56:24 -0500] redsamh: hello
[2013-01-30 01:56:35 -0500] blasdelf1: surely there's some way to make it stop being so frisky?
[2013-01-30 01:56:58 -0500] blasdelf1: it seems to be doing a lot more than just eval
[2013-01-30 01:57:00 -0500] zpatten: It's just how it works; the DSL is ruby; so it has to "run" the ruby code to load your chef DSL commands
[2013-01-30 01:57:18 -0500] zpatten: as a side effect; the code gets executed more or less
[2013-01-30 01:57:25 -0500] blasdelf1: it's not just loading the ruby
[2013-01-30 01:57:35 -0500] blasdelf1: it's actually calling every method
[2013-01-30 01:57:44 -0500] redsamh: I am having some trouble executing powershell code, it seems that the run happens in the first compile phase itself and then when it tries to run again the table has already been created
[2013-01-30 01:57:44 -0500] coderanger: sethvargo: Now we just need to get you voice or whatever in here :)
[2013-01-30 01:57:55 -0500] zpatten: ya ok thats odd; sounds like it's getting confused about your class methods
[2013-01-30 01:58:08 -0500] blasdelf1: yeah they're classmethods
[2013-01-30 01:59:05 -0500] tolland: im seeing lots  of WARN: Cloning resource attributes
[2013-01-30 01:59:37 -0500] tolland: however when the resource was declared in a definition, there is not obvious way to track the source
[2013-01-30 01:59:52 -0500] zpatten: blasdelf1: ya; try moving your classes into another file and require that in?  Can't say I have alot of experience putting classes directly in chef DSL files
[2013-01-30 02:00:35 -0500] coderanger: tolland: Each instance of the resource in the collection should have the correct cookbook_name attrs on it and such
[2013-01-30 02:00:37 -0500] sethvargo: coderanger: whats up?
[2013-01-30 02:00:53 -0500] blasdelf1: zpatten: I thought this was what cookbook libraries were for
[2013-01-30 02:00:54 -0500] coderanger: sethvargo: Bryan sent out the official welcome blast :)
[2013-01-30 02:01:35 -0500] tomdzk: blasdelf1: could you create a gist with the library and the error trace ?
[2013-01-30 02:01:43 -0500] sethvargo: lol I know. you pinged me earlier, didn't you?
[2013-01-30 02:01:49 -0500] zpatten: sure; don't think libraries are considered DSL thou
[2013-01-30 02:01:52 -0500] sethvargo: i have a notification, but it doesn't tell me what you said :(
[2013-01-30 02:02:02 -0500] coderanger: sethvargo: Now we just need to get you voice or whatever in here :) about 3 minutes ago :P
[2013-01-30 02:02:10 -0500] sethvargo: lol :)
[2013-01-30 02:02:11 -0500] zpatten: blasdelf1: sorry I misunderstood; I thought you where putting class directly into your recipes
[2013-01-30 02:02:15 -0500] zpatten: *classes
[2013-01-30 02:02:48 -0500] blasdelf1: tomzdk: will do
[2013-01-30 02:03:10 -0500] zpatten: blasdelf1:  I don't know what to tell you; I have no issues with my cookbooks using libraries; sorry
[2013-01-30 02:04:08 -0500] coderanger: blasdelf1: Pastebin?
[2013-01-30 02:04:44 -0500] blasdelf1: working on it, have to replace some codewords
[2013-01-30 02:07:45 -0500] blasdelf1: coderanger: tomdzk: https://gist.github.com/e8054e4b16400161033a
[2013-01-30 02:08:01 -0500] blasdelf1: I think I might have realized what it is
[2013-01-30 02:08:35 -0500] blasdelf1: is chef doing the variable substitution for the execute names at compile time?
[2013-01-30 02:08:37 -0500] coderanger: What are you seeing called that shouldn't be?
[2013-01-30 02:08:45 -0500] coderanger: Yes, that is just how ruby works :)
[2013-01-30 02:09:01 -0500] blasdelf1: Foo.latest_string
[2013-01-30 02:09:15 -0500] blasdelf1: how unfortunate for ruby :)
[2013-01-30 02:09:29 -0500] coderanger: execute "asdf" do ... end    is actually calling the method #execute with two arguments, the string "asdf" and a block
[2013-01-30 02:09:43 -0500] coderanger: So the string has to be evaluated before the method is called
[2013-01-30 02:10:16 -0500] blasdelf1: and all the execute calls get run up front
[2013-01-30 02:10:34 -0500] blasdelf1: and put on a queue to get actually executed
[2013-01-30 02:10:53 -0500] coderanger: Yes, as part of calling that method chef makes a Resource object and adds it to a list called a ResourceCollection
[2013-01-30 02:11:26 -0500] coderanger: Is the use case that you have a lot of similarly parameterized resources like this?
[2013-01-30 02:11:33 -0500] coderanger: If so, LWRPs might be the answer
[2013-01-30 02:11:37 -0500] blasdelf1: guess I can't have nice things in my execute names
[2013-01-30 02:12:01 -0500] coderanger: You can, it just has to be resolvable at compile time :)
[2013-01-30 02:12:20 -0500] coderanger: Or you have to get into the complexities of adding resources to the collection mid-run
[2013-01-30 02:12:27 -0500] coderanger: probably not worth it if this is just cosmetic :)
[2013-01-30 02:12:37 -0500] blasdelf1: is there a way to log this stuff from a block?
[2013-01-30 02:12:39 -0500] coderanger: but you can do silly things with ruby_block resources and/or LWRPs
[2013-01-30 02:12:45 -0500] tomdzk: blasdelf1: maybe if you make Foo a resource
[2013-01-30 02:13:22 -0500] coderanger: blasdelf1: Sec, let me try something
[2013-01-30 02:13:50 -0500] coderanger: blasdelf1: Yeah, you can use a log resource for this
[2013-01-30 02:13:53 -0500] coderanger: just not documented
[2013-01-30 02:14:04 -0500] coderanger: I think anyway
[2013-01-30 02:14:13 -0500] coderanger: There is a #message attribute :)
[2013-01-30 02:14:32 -0500] coderanger: Hmm, no, that would still be resolved at compile time
[2013-01-30 02:15:16 -0500] coderanger: 1) we should fix that 2) ruby_block "asdf" do block { Chef::Log.info("Some kind of whatever") } end
[2013-01-30 02:15:36 -0500] coderanger: That string will be resolved during run time
[2013-01-30 02:15:37 -0500] coderanger: :)
[2013-01-30 02:15:55 -0500] blasdelf1: thanks!
[2013-01-30 02:16:26 -0500] coderanger: Welcome to where the "Chef isn't really ruby" borders start to get fuzzy ;-)
[2013-01-30 02:17:12 -0500] Glacee: Quick question.. I defined multiple methods as an action in a provider.. and it seems that it runs the method in random orders.. is this expected behavior?
[2013-01-30 02:17:12 -0500] coderanger: In the end, it is just some fancy Ruby code that looks pretty
[2013-01-30 02:17:21 -0500] Glacee: methods*
[2013-01-30 02:17:31 -0500] coderanger: Glacee: Pastebin?
[2013-01-30 02:17:40 -0500] coderanger: Do you mean you defined the actions twice?
[2013-01-30 02:18:02 -0500] Glacee: No.. I define the action with multiple methods
[2013-01-30 02:18:11 -0500] tomdzk: coderanger, blasdelf1: wouldn't making Foo a LWRP be a lot simpler (with name = toolchain-mainline in this case) ?
[2013-01-30 02:18:23 -0500] Glacee: like action :get   is method1 method 2 method3
[2013-01-30 02:18:35 -0500] Glacee: Then I define the resource... put it in the recipe
[2013-01-30 02:18:44 -0500] Glacee: and the methods in the provider does not run in order
[2013-01-30 02:18:45 -0500] coderanger: tomdzk: It would still be compiled before, presumably, that mercurial repo is checked out
[2013-01-30 02:18:57 -0500] Glacee: I had to create 2 actions to fix it
[2013-01-30 02:18:59 -0500] coderanger: Glacee: Pastebin of the various code files would help :)
[2013-01-30 02:19:04 -0500] Glacee: I dont have the code right now :(
[2013-01-30 02:19:09 -0500] Glacee: Not at work :(
[2013-01-30 02:19:20 -0500] blasdelf1: tomdzk: I'll look into that, the LWRP documentation didn't seem clear to me when I wrote it
[2013-01-30 02:19:56 -0500] coderanger: Glacee: Off the top of my head I don't see anything wrong with what you did, actions just call their relevant code, Ruby wouldn't just run code out of order at random :)
[2013-01-30 02:20:19 -0500] Glacee: ok.. hehe I will try to get the code later on :)
[2013-01-30 02:20:25 -0500] Glacee: Yes I found it strange also
[2013-01-30 02:21:00 -0500] Glacee: and the seperated the methods in 2 different actions... put both actions in the recipes and then it ran them in order
[2013-01-30 02:21:05 -0500] coderanger: I'm the first to invoke lolrubby, but even MRI isn't that silly
[2013-01-30 02:21:19 -0500] coderanger: Actually not true, it does run things out of order when you assign a value to a const
[2013-01-30 02:21:23 -0500] Glacee: then I separated*
[2013-01-30 02:21:35 -0500] Glacee: oh ok.. that might be it
[2013-01-30 02:21:43 -0500] Glacee: actually thats it
[2013-01-30 02:21:56 -0500] coderanger: Maybe, only if you did something really silly
[2013-01-30 02:22:11 -0500] Glacee: :0
[2013-01-30 02:22:24 -0500] coderanger: Like Foo = begin Foo = true; false end
[2013-01-30 02:22:30 -0500] Glacee: nah
[2013-01-30 02:22:35 -0500] coderanger: Just an amusing quirk of MRI :P
[2013-01-30 02:23:26 -0500] Glacee: I will try to get back the code.. but it seemed right even for my senior ruby guy :0
[2013-01-30 02:24:22 -0500] redsamh: do you know if there is any way I can keep the temp files while debugging powershell scripts
[2013-01-30 02:25:20 -0500] redsamh: I want to see what exactly got executed I commented out the line to unlink but the temp file gets deleted
[2013-01-30 02:26:35 -0500] coderanger: redsamh: If the run aborts, I think it leaves the file, at least we don't call unlike
[2013-01-30 02:26:50 -0500] coderanger: So just make it return 1?
[2013-01-30 02:27:00 -0500] coderanger: I know not of the ways of the powershell
[2013-01-30 02:27:08 -0500] coderanger: but that would do it for other script resource variants
[2013-01-30 02:27:28 -0500] redsamh: believe me I wish everything was unix
[2013-01-30 02:29:33 -0500] Glacee: redsamh: yes I wished too :)
[2013-01-30 02:29:48 -0500] Glacee: I had to build 15 windows cookbook.. for one of our 50 services that is windows :0
[2013-01-30 02:30:07 -0500] Glacee: is running on windows *
[2013-01-30 02:31:03 -0500] redsamh: :(
[2013-01-30 02:31:21 -0500] zpatten: :(
[2013-01-30 02:32:42 -0500] coderanger: Before Opscode, my last company was 300+ WinXP servers
[2013-01-30 02:32:55 -0500] coderanger: Good times
[2013-01-30 02:33:12 -0500] Glacee: :0
[2013-01-30 02:33:46 -0500] Glacee: We actually run a f2p game written with #charp on the cloud.. fun times :0
[2013-01-30 02:34:29 -0500] coderanger: The MMO world is only slowly coming around to *nix
[2013-01-30 02:34:40 -0500] coderanger: A lot of publishers still insist on Windows all of the everywhere
[2013-01-30 02:35:07 -0500] cheesepl_: coderanger: yea but you still need it on the client side :(
[2013-01-30 02:35:08 -0500] Glacee: Yeah.. :( I am trying to convince the producer to switch to Mono hehe :0
[2013-01-30 02:35:22 -0500] Glacee: YEah.. client side.. I dont care.. but servers in linux please!
[2013-01-30 02:35:25 -0500] coderanger: cheesepl_: Thats a different story :P
[2013-01-30 02:35:28 -0500] cheesepl_: at SOE all the servers were linux at least
[2013-01-30 02:35:44 -0500] cheesepl_: well all but the ones that we acquired when we bought other games
[2013-01-30 02:36:26 -0500] Glacee: hehe
[2013-01-30 02:36:36 -0500] coderanger: NCSoft, Cryptic, CCP, and big parts of Bliz are still on Windows AFAIK
[2013-01-30 02:36:41 -0500] log1kal: Neg.
[2013-01-30 02:36:48 -0500] log1kal: Blizz is all linux for gameservers
[2013-01-30 02:37:02 -0500] coderanger: Asset pipeline was windows based last I saw
[2013-01-30 02:37:16 -0500] log1kal: oh, yes, nearly all dev is windows
[2013-01-30 02:37:27 -0500] log1kal: but the actual game servers, once they're out in the wild are linux
[2013-01-30 02:37:46 -0500] coderanger: Still a lot of Windows infra ;-)
[2013-01-30 02:38:03 -0500] log1kal: D3 was almost windows, but the NetOps team prevailed.
[2013-01-30 02:38:33 -0500] cheesepl_: I was pushing the linux port at Vigil but that whole house of cards came tumbling down :(
[2013-01-30 02:41:33 -0500] coderanger: :(
[2013-01-30 02:42:00 -0500] coderanger: It is a bad sign that in the past few years, working for a tiny tech startup has substantially better job stability than decade-old game studios
[2013-01-30 02:42:01 -0500] Glacee: Why did D3 melt at launch?
[2013-01-30 02:42:08 -0500] Glacee: code? bad infra scaling?
[2013-01-30 02:42:23 -0500] timsmith: what exactly does chef do to validate if a service is running or not in the service resource?
[2013-01-30 02:42:42 -0500] cheesepl_: coderanger: seriously, I went to startup after abandoning big game studios
[2013-01-30 02:43:00 -0500] coderanger: timsmith: Depends on the provider
[2013-01-30 02:43:08 -0500] Glacee: I had my startup, got screwed.. and now working for a big game studio :0
[2013-01-30 02:43:10 -0500] log1kal: Glacee: I don't know for sure (I wasn't there when D3 actually launched), but pretty sure that it has to do with zero elasticity
[2013-01-30 02:43:16 -0500] coderanger: timsmith: If it is marked as supporting a status command it runs that, otherwise it scans all procs
[2013-01-30 02:43:34 -0500] coderanger: cheesepl_: Ditto, PS Opscode is totally hiring :D
[2013-01-30 02:43:49 -0500] Glacee: hehe thats what I suspect also.. and selling to the company I work for.. they have no notion of elasticity and scale
[2013-01-30 02:44:08 -0500] cheesepl_: coderanger: oh I'm happy at Basho but should that ever change ya'll will hear from me ;)
[2013-01-30 02:44:09 -0500] timsmith: coderanger:  That's the problem.  It wasn't setup to support status and the init script name doesn't match the process.  Thanks
[2013-01-30 02:44:46 -0500] coderanger: timsmith: SysV init scripts are a longtroll
[2013-01-30 02:45:29 -0500] timsmith: true
[2013-01-30 02:46:10 -0500] timsmith: pattern in the resource is what I want
[2013-01-30 02:46:27 -0500] coderanger: I can't parse that last message
[2013-01-30 02:46:51 -0500] timsmith: from the wiki: pattern
[2013-01-30 02:46:52 -0500] timsmith: Pattern to look for in the process table.
[2013-01-30 02:46:52 -0500] timsmith: service_name
[2013-01-30 02:47:23 -0500] coderanger: Ahh yes
[2013-01-30 02:47:34 -0500] coderanger: Or make it work with a status command
[2013-01-30 03:04:20 -0500] dotslash: Is there a way to use knife bootstrap by specify a different location for the install files? For example when you are in a closed network and can't reach the opscode site?
[2013-01-30 03:12:37 -0500] jtimberman: dotslash: you can make a custom bootstrap template, or use an http proxy
[2013-01-30 03:14:11 -0500] dotslash: jtimberman: Thanks.
[2013-01-30 04:42:14 -0500] freezey: this possible to do? http://pastebin.ca/2308834
[2013-01-30 04:46:47 -0500] freezey: ah nevermind
[2013-01-30 05:25:14 -0500] mhalligan: Is anyone successfully using berkshelf with the omnibus installer under os x?
[2013-01-30 05:26:01 -0500] justincampbell: mhalligan: can you give more detail?
[2013-01-30 05:27:05 -0500] mhalligan: justincampbell: I'm able to use knife to upload cookbooks, but berks install always fails with: https://gist.github.com/403f7b357359bf766cbb
[2013-01-30 05:27:08 -0500] mhalligan: err berks upload, even
[2013-01-30 05:28:13 -0500] justincampbell: hmm
[2013-01-30 05:28:28 -0500] mhalligan: seems related to http://martinottenwaelter.fr/2010/12/ruby19-and-the-ssl-error/
[2013-01-30 05:29:27 -0500] justincampbell: does that fix your issue?
[2013-01-30 05:29:46 -0500] justincampbell: also FYI brew install curl-ca-bundle works if you dont have macports
[2013-01-30 05:29:47 -0500] mhalligan: nope
[2013-01-30 05:29:54 -0500] justincampbell: hmm
[2013-01-30 05:31:06 -0500] mhalligan: I guess I need to go mess around with rvm,, rbenv, ports, and N other programs to use berkshelf.
[2013-01-30 05:31:13 -0500] mhalligan: *sad panda*
[2013-01-30 05:32:01 -0500] mhalligan: is it recommended not to use omnibus in os x?
[2013-01-30 05:33:51 -0500] coderanger: mhalligan I wouldnt
[2013-01-30 05:34:11 -0500] coderanger: rubygems is already installed
[2013-01-30 05:34:13 -0500] coderanger: just gem install chef
[2013-01-30 05:34:28 -0500] mhalligan: I use to do that, then shit started getting broken
[2013-01-30 05:34:49 -0500] mhalligan: I switched to omnibus after wasting a day or 2 in dependency hell
[2013-01-30 05:34:58 -0500] mhalligan: there's just no useable solution for packaging, is there?
[2013-01-30 05:35:16 -0500] coderanger: Nope, thats why omnibus exists in the first place
[2013-01-30 05:36:11 -0500] coderanger: I'm not actually sure if we ship OpenSSL though
[2013-01-30 05:36:20 -0500] coderanger: We were talking about it, but then there were concerns about legal issues
[2013-01-30 05:36:33 -0500] coderanger: I think we do now though, so might be an issue with the omnibus client build :)
[2013-01-30 05:36:43 -0500] coderanger: Have you reported it in Jira?
[2013-01-30 05:36:56 -0500] mhalligan: not yet, been trying to figure out what I was doing wrong all night.
[2013-01-30 05:36:58 -0500] mhalligan: guess I'm not
[2013-01-30 05:37:02 -0500] ev0ldave: anyone know of a way to have knife show the metadata.json file of a cookbook?
[2013-01-30 05:37:34 -0500] coderanger: ev0ldave: Not on its own
[2013-01-30 05:37:43 -0500] coderanger: ev0ldave: but knife cookbook show <name> <version>
[2013-01-30 05:37:53 -0500] coderanger: In the metadata hash there you'll see most of it
[2013-01-30 05:38:17 -0500] coderanger: mhalligan: Just a complex system :) We don't check SSL certs in our Ruby code, Faraday does by default
[2013-01-30 05:38:19 -0500] ev0ldave: eh, trying to get chef in sync with git and i had a .gitignore that for some reason had metadata.json in it
[2013-01-30 05:38:31 -0500] coderanger: ev0ldave: That is correct
[2013-01-30 05:38:34 -0500] mhalligan: coderanger: is there one solution that "just works"
[2013-01-30 05:38:45 -0500] coderanger: metadata.json is a derived file and so is not usually checked in
[2013-01-30 05:39:35 -0500] ev0ldave: hmm, health_inspector is bitching about it being in chef but not the repo
[2013-01-30 05:40:29 -0500] jtimberman: coderanger, mhalligan: fwiw, I use "omnibus" chef installed on my macs for actually running chef to manage them (per my various blog posts). i use rbenv for my local ruby environment that i do development w/, including managing repositories of various kinds w/ knife.
[2013-01-30 05:41:00 -0500] coderanger: mhalligan: https://github.com/reset/ridley/blob/master/lib/ridley/connection.rb#L40 open up that file under your gems folder and add :ssl => {:verify => false}
[2013-01-30 05:41:10 -0500] coderanger: jtimberman: Yeah, this wouldn't affect knife
[2013-01-30 05:41:17 -0500] mhalligan: yeah, knife is happy.
[2013-01-30 05:41:42 -0500] coderanger: jtimberman: Looks like our install of OpenSSL doesn't have the ca chain to trust anything, and new versions of Faraday turned on verify by default
[2013-01-30 05:41:45 -0500] jtimberman: k, i didn't read all the words above, just skimmed :)
[2013-01-30 05:42:08 -0500] coderanger: mhalligan: specifically add that as an arg to #new, so before the block
[2013-01-30 05:42:10 -0500] jtimberman: coderanger: aye, i went down the road of grabbing cacert.pem from curl.haxxx0rz.se or whatever.
[2013-01-30 05:42:39 -0500] coderanger: mhalligan: ^^ thats another option, grab the CA cert from our CA
[2013-01-30 05:42:44 -0500] coderanger: and drop it "somewhere"
[2013-01-30 05:42:48 -0500] coderanger: I just don't know where
[2013-01-30 05:42:55 -0500] mhalligan: yeah I can't figure out the "somewhere" part yet
[2013-01-30 05:43:17 -0500] c_t: biltong standing for a while before I put it in the dryer
[2013-01-30 05:43:29 -0500] c_t: hmm, there's a name for a ruby project
[2013-01-30 05:43:41 -0500] coderanger: mhalligan: Looking too :)
[2013-01-30 05:44:18 -0500] coderanger: mhalligan: There is /opt/chef/embedded/ssl
[2013-01-30 05:44:23 -0500] mhalligan: tried that
[2013-01-30 05:44:56 -0500] jtimberman: SSL always fills me with sadness.
[2013-01-30 05:45:00 -0500] jtimberman: when it doesn't "Just work"
[2013-01-30 05:45:08 -0500] coderanger: mhalligan: I think it should be /opt/chef/embedded/ssl/certs
[2013-01-30 05:45:13 -0500] coderanger: if I'm reading these docs
[2013-01-30 05:45:47 -0500] coderanger: But it might have /etc/ssl/certs coded somewhere icky
[2013-01-30 05:47:19 -0500] jtimberman: coderanger: on os x /etc/ssl/certs doesn't work irrc.
[2013-01-30 05:47:23 -0500] jtimberman: s/irrc/iirc/
[2013-01-30 05:47:28 -0500] coderanger: Yeah, that rings a bell
[2013-01-30 05:47:38 -0500] mhalligan: ok no dice in the opt/chef/embedded/ssl/certs
[2013-01-30 05:48:45 -0500] jtimberman: you'll want /opt/chef/embedded/ssl/certs, and then in /etc/chef/client.rb or ~/.chef/knife.rb (or whereever they are), set: ssl_ca_path and ssl_ca_file
[2013-01-30 05:50:41 -0500] coderanger: I don't think berkshelf uses those config options
[2013-01-30 05:51:03 -0500] coderanger: It isn't passing any SSL options into Faraday, so you can't alter them
[2013-01-30 05:51:24 -0500] coderanger: (berkshelf uses ridley internally, not the chef gem)
[2013-01-30 05:51:39 -0500] brucelee`: whats the difference between commercial chef and free chef? :p
[2013-01-30 05:51:53 -0500] coderanger: brucelee`: ACLs system, multitennancy
[2013-01-30 05:52:04 -0500] coderanger: New webui eventually
[2013-01-30 05:52:05 -0500] brucelee`: ah ok
[2013-01-30 05:52:53 -0500] jtimberman: brucelee`: paid support and services from opscode.
[2013-01-30 05:53:02 -0500] brucelee`: thanks
[2013-01-30 05:53:19 -0500] brucelee`: so if i pay for chef, and get ACLs systems, what exactly does that allow me to do that the regular chef doesnt
[2013-01-30 05:53:34 -0500] brucelee`: and by pay, thats the 'private chef' and 'hosted chef' options right?
[2013-01-30 05:53:34 -0500] coderanger: Role-based access controls
[2013-01-30 05:53:45 -0500] coderanger: So certain users can have restricted permissions
[2013-01-30 05:53:58 -0500] coderanger: whereas open-source chef only has admin true/false
[2013-01-30 05:54:04 -0500] brucelee`: oh i see...
[2013-01-30 05:54:15 -0500] coderanger: Oh also active directory authentication integration, forgot about that one
[2013-01-30 05:54:18 -0500] brucelee`: so more users can be added into chef, and be allowed to deploy different kind of things
[2013-01-30 05:54:48 -0500] coderanger: brucelee`: You can control what they can update, perhaps some users can update a particular data bag but not others
[2013-01-30 05:54:59 -0500] coderanger: or some users can only update one cookbook, but not roles
[2013-01-30 05:55:02 -0500] coderanger: etc etc
[2013-01-30 05:55:28 -0500] brucelee`: looking into testing out chef. As a linux admin i think ill have to start provisioning a lot of servers, set up ssl keys, sudoers, etc
[2013-01-30 05:55:44 -0500] brucelee`: downloading different packages... installing custom apps, configuring them
[2013-01-30 05:55:45 -0500] brucelee`: etc
[2013-01-30 05:56:01 -0500] brucelee`: any good sources to get started?
[2013-01-30 05:56:15 -0500] coderanger: brucelee`: http://docs.opscode.com/chef_overview.html
[2013-01-30 05:56:16 -0500] coderanger: :)
[2013-01-30 05:56:18 -0500] brucelee`: like any recommended books for recipes, cookbooks, etc
[2013-01-30 05:56:42 -0500] coderanger: brucelee`: I would recommend starting with Hosted Chef, you can sign up for the free tier and run up to 5 servers
[2013-01-30 05:56:44 -0500] brucelee`: i dont have much coding experience btw, do i need to become one to really take advatnage of chef?
[2013-01-30 05:56:49 -0500] coderanger: if you like it, you can then ponder if you want to run your own server
[2013-01-30 05:56:54 -0500] brucelee`: ah ok
[2013-01-30 05:57:01 -0500] coderanger: brucelee`: No, but you'll probably pick up some coding expertise as you go :)
[2013-01-30 05:57:06 -0500] brucelee`: :P
[2013-01-30 05:57:17 -0500] coderanger: A loop here, a few variables there, next thing you know you accidentally a Rails app
[2013-01-30 05:57:22 -0500] ev0ldave: the cookbooks are minimal ruby and you get most of what you need by googling for "chef resources"
[2013-01-30 05:57:31 -0500] brucelee`: ev0ldave: thanks
[2013-01-30 05:57:37 -0500] coderanger: http://docs.opscode.com/just_enough_ruby_for_chef.html :)
[2013-01-30 05:57:41 -0500] brucelee`: ev0ldave: any favorite sites you go to for chef cookbooks
[2013-01-30 05:57:50 -0500] coderanger: docs.opscode.com is the home for all things documenty
[2013-01-30 05:57:54 -0500] coderanger: brucelee`: community.opscode.com
[2013-01-30 05:58:08 -0500] brucelee`: sweet, got pretty much everything i need to get started i see :)
[2013-01-30 05:58:14 -0500] ev0ldave: what coderanger said
[2013-01-30 05:58:40 -0500] jtimberman: brucelee`: start small
[2013-01-30 05:58:44 -0500] brucelee`: does chef not support centos?
[2013-01-30 05:58:50 -0500] jtimberman: brucelee`: totally does
[2013-01-30 05:58:52 -0500] ev0ldave: you wont find any books worth while, it changes and improves so fast here that you will want to just stick around
[2013-01-30 05:59:04 -0500] brucelee`: i see, i just went to the http://opscode.com/chef/install and i dont see centos as an OS
[2013-01-30 05:59:10 -0500] jtimberman: RHEL :)
[2013-01-30 05:59:12 -0500] brucelee`: :p
[2013-01-30 05:59:23 -0500] jtimberman: "Enterprise Linux"
[2013-01-30 05:59:28 -0500] brucelee`: oh i see
[2013-01-30 05:59:35 -0500] ev0ldave: quotes around that indeed
[2013-01-30 05:59:40 -0500] mhalligan: wow, the version of that file in ridley/connection.rb bears little resemblance to the one in the omnibus installer
[2013-01-30 05:59:44 -0500] jtimberman: at the end of the day that'll just give you: curl -L http://www.opscode.com/chef/install.sh | sudo sh
[2013-01-30 05:59:59 -0500] coderanger: mhalligan: We don't ship that in the omnibus installer
[2013-01-30 06:00:10 -0500] jtimberman: ridley is maintained by riot games
[2013-01-30 06:00:11 -0500] coderanger: mhalligan: Thats all from gem install berkshelf
[2013-01-30 06:00:17 -0500] mhalligan: coderanger: ah ok. hrm.
[2013-01-30 06:00:29 -0500] mhalligan: so this is a bad yak to shave then
[2013-01-30 06:00:31 -0500] coderanger: The riot guys wrote their own chef API client code
[2013-01-30 06:00:44 -0500] mhalligan: (trying to make that change you suggested)
[2013-01-30 06:00:58 -0500] jtimberman: brucelee`: that install.sh script simply tries to determine what the platform, its version and machine type of the system so it can construct a URL to the API service that actually provides the downloads
[2013-01-30 06:01:19 -0500] coderanger: mhalligan: Just find where it builds the Faraday connection
[2013-01-30 06:02:34 -0500] mhalligan: jtimberman: tried the ssl_ca_path / ssl_ca_file path in knife.rb, no difference.
[2013-01-30 06:02:50 -0500] jtimberman: berks probably doesn't use it then.
[2013-01-30 06:02:51 -0500] mhalligan: oh ok, I missed the next part of the scrollback.
[2013-01-30 06:02:55 -0500] jtimberman: SSL makes me sad
[2013-01-30 06:02:57 -0500] jtimberman: :)
[2013-01-30 06:03:08 -0500] mhalligan: ++
[2013-01-30 06:03:22 -0500] mhalligan: I'm staring at my drum and my bicycle thinking that they both deserve more attention than ssl
[2013-01-30 06:03:34 -0500] jtimberman: lmao
[2013-01-30 06:04:05 -0500] mhalligan: admissions says i'm a shoe-in for '14 @ UCB, so at least I've only got another year and a half of this
[2013-01-30 06:05:03 -0500] coderanger: mhalligan: hookers and blow, always a good decision
[2013-01-30 06:06:00 -0500] mhalligan: coderanger: hah. I'm way too aspy for the first, and the latter? noone who does cook has ever been to explain to me why they like it except, "it makes me want to talk"
[2013-01-30 06:06:26 -0500] cheesepl_: lol
[2013-01-30 06:11:10 -0500] coderanger: mhalligan: I think an option in your case is to install berkshelf into system ruby instead of ours
[2013-01-30 06:11:32 -0500] mhalligan: coderanger: I don't actually use system ruby for anything
[2013-01-30 06:11:44 -0500] mhalligan: which is frustrating, I think the os x ruby is still 1.8
[2013-01-30 06:11:53 -0500] coderanger: Well or rbenv or whatever the cool kids use now
[2013-01-30 06:11:56 -0500] mhalligan: sigh
[2013-01-30 06:12:02 -0500] coderanger: lolrubby
[2013-01-30 06:12:04 -0500] mhalligan: what's the flavor of the week with that bs?
[2013-01-30 06:12:31 -0500] jtimberman: yeah "system" ruby on os x ain't gonna work :/
[2013-01-30 06:12:34 -0500] coderanger: Don't look at me, I'm running some ancient version of rvm and when I asked how to upgrade it they literally laughed at me on IRC :)
[2013-01-30 06:12:35 -0500] jtimberman: for berkshelf
[2013-01-30 06:12:41 -0500] jtimberman: iirc berkshelf is ruby 1.9+ only
[2013-01-30 06:12:51 -0500] jtimberman: which, it should be, because ffs, 1.8 is EOL in 5 months.
[2013-01-30 06:12:52 -0500] jtimberman: :)
[2013-01-30 06:13:46 -0500] cheesepl_: so far I've found rbenv less painful than rvm
[2013-01-30 06:14:46 -0500] ev0ldave: can anyone point me in the direction of chef 11 beta install?
[2013-01-30 06:15:45 -0500] jtimberman: ev0ldave: client or server
[2013-01-30 06:15:49 -0500] ev0ldave: server
[2013-01-30 06:15:52 -0500] coderanger: Honestly if I was starting over I would just brew install ruby and refuse to run anything that requires 1.8
[2013-01-30 06:15:58 -0500] ev0ldave: and client
[2013-01-30 06:16:00 -0500] jtimberman: http://wiki.opscode.com/display/chef/Chef+11+Server+Preview
[2013-01-30 06:16:03 -0500] jtimberman: client is a ruby gem
[2013-01-30 06:16:09 -0500] ev0ldave: awesome
[2013-01-30 06:16:10 -0500] log1kal: A random note on chef: Using it( and the benefits therein) got me an extra bonus on my paycheck this year.
[2013-01-30 06:16:14 -0500] log1kal: Thanks, opscode!
[2013-01-30 06:16:21 -0500] jtimberman: we're making client builds for omnibus packages too
[2013-01-30 06:16:30 -0500] jtimberman: log1kal: awesome :D
[2013-01-30 06:17:02 -0500] log1kal: ah, you're around, jtimberman! Many thanks for your "how I migrated to berkshelf" blog post
[2013-01-30 06:17:17 -0500] mhalligan: coderanger: after an entire enveing working on this, my brain is dead. where should I put :ssl => {:verify => false} in connection.rb?
[2013-01-30 06:17:22 -0500] paulmooring: jtimberman: do you use berkshelf?
[2013-01-30 06:17:34 -0500] coderanger: mhalligan: One sec, let me find the version matching yours
[2013-01-30 06:17:40 -0500] jtimberman: paulmooring: casually
[2013-01-30 06:17:51 -0500] jtimberman: log1kal: you're welcome
[2013-01-30 06:18:06 -0500] jtimberman: paulmooring: http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/
[2013-01-30 06:19:19 -0500] coderanger: mhalligan: esh, yeah, different, let me trace through this
[2013-01-30 06:19:27 -0500] coderanger: This version of Ridley does have a way ot pass in options
[2013-01-30 06:19:32 -0500] coderanger: So I bet you can configure it somehow
[2013-01-30 06:21:15 -0500] coderanger: mhalligan: bindog
[2013-01-30 06:21:19 -0500] coderanger: er, bingo
[2013-01-30 06:21:24 -0500] coderanger: too tired can't brain
[2013-01-30 06:21:24 -0500] coderanger: https://github.com/RiotGames/berkshelf/blob/v1.1.2/lib/berkshelf/config.rb#L132
[2013-01-30 06:21:58 -0500] coderanger: So I think that goes in a JSON file somewhere
[2013-01-30 06:22:43 -0500] coderanger: Yeah, look for a config.json
[2013-01-30 06:22:50 -0500] coderanger: You should be able to change the option there
[2013-01-30 06:23:34 -0500] mhalligan: yeah
[2013-01-30 06:23:36 -0500] mhalligan: that doesn't work
[2013-01-30 06:24:01 -0500] mhalligan: berkshelf isn't going to save enough time to justify the time I've put into it already
[2013-01-30 06:24:07 -0500] mhalligan: just going back to manually downloading cookbooks
[2013-01-30 06:24:12 -0500] coderanger: mhalligan: In ~/.berkshelf/config.json setting verify to false?
[2013-01-30 06:24:16 -0500] mhalligan: yes
[2013-01-30 06:24:22 -0500] mhalligan: I've been working on this for 5 hours now
[2013-01-30 06:24:25 -0500] mhalligan: I've tried all of that
[2013-01-30 06:24:38 -0500] mhalligan: at least I know I'm not doing it wrong, it's just broke
[2013-01-30 06:26:22 -0500] mhalligan: thanks for all the help guys!
[2013-01-30 06:42:10 -0500] ev0ldave1: is there something for berkshelf like knife-block?
[2013-01-30 07:14:04 -0500] jsegura: Ohai chefs
[2013-01-30 07:14:13 -0500] jsegura: Do you know if there
[2013-01-30 07:14:36 -0500] jsegura: Do you know if there's any tool that make a graph with the relationship (dependencies) of a cookbook folder?
[2013-01-30 07:20:27 -0500] jtimberman: jsegura: i don't know about *cookbooks* (probably), but there's knife-role-spaghetti by mike fiedler for roles.
[2013-01-30 07:20:55 -0500] jsegura: Oh, I'm going to take a look
[2013-01-30 08:47:10 -0500] supster: I am having a hard time using the ohai resource to reload ohai attributes - am I doing something wrong? https://gist.github.com/6ab4226a4860a3f1cf65
[2013-01-30 09:56:40 -0500] Azrael808: Hopefully this is another quick one - when instantiating a server using "knife ec2 server create ..." the encrypted data bag key specified in my knife.rb _isn't_ copied over as part of the bootstrap process.
[2013-01-30 10:00:23 -0500] Azrael808: Whereas the knife bootstrap command does... (according to documentation)
[2013-01-30 10:00:51 -0500] Azrael808: Is there a reason for that? What's a good workaround (I didn't really want to start bundling the keys into an AMI)
[2013-01-30 10:19:43 -0500] teukka: Azrael808: `knife ec2 server create` uses `knife bootstrap` internally so there shouldn't be any difference in regards of the key
[2013-01-30 10:20:02 -0500] Azrael808: Hmmm
[2013-01-30 10:20:19 -0500] Azrael808: I thought it would have done so... Maybe I'm not defining the key correctly in my knife.rb file
[2013-01-30 10:21:44 -0500] teukka: the config should be like this: encrypted_data_bag_secret "/path/to/key"
[2013-01-30 10:23:05 -0500] gkarekinian: Also make sure you're not using an old version of the knife command
[2013-01-30 10:23:28 -0500] Azrael808: And if that's correctly defined, should I be able to view/edit data bags without explicitly referencing the key as a command line parameter?
[2013-01-30 10:24:39 -0500] teukka: no, that is only used by the bootstrap templates
[2013-01-30 10:24:52 -0500] Azrael808: ok
[2013-01-30 10:25:23 -0500] Azrael808: I'm just updating my chef gem (I was using 10.14.4)
[2013-01-30 10:27:25 -0500] BryanWB__: hey guys, for some reason fnichol's rvm::user_install recipe is not working for me https://gist.github.com/4672266
[2013-01-30 10:27:32 -0500] BryanWB__: not sure what i am doing wrong :(
[2013-01-30 10:27:33 -0500] gkarekinian: 10.14.4 has support for encrypted_data_bag_secret in knife.rb
[2013-01-30 10:28:06 -0500] gkarekinian: It should just copy the file to /etc/chef/encrypted_data_bag_secret on bootstrap, that's all
[2013-01-30 10:29:04 -0500] Azrael808: Yeah... That's what I thought, but I'm not having any luck I'm afraid...
[2013-01-30 11:04:46 -0500] alff: Hi everyine!
[2013-01-30 11:05:38 -0500] alff: guys, i have a question about bootstrapping chef-server on ubuntu
[2013-01-30 11:06:50 -0500] benner: hi
[2013-01-30 11:07:43 -0500] alff: http://pastebin.com/8EJpZDK1
[2013-01-30 11:08:35 -0500] alff: i've goggled around but didn't find any suitable solutions
[2013-01-30 11:09:17 -0500] alff: libgecode-dev already installed
[2013-01-30 11:09:54 -0500] alff: any suggestion?
[2013-01-30 11:10:26 -0500] Unicron_: hey guys - can use knife search for tags?  I've tried knife search node "tag:*" and knife search tag
[2013-01-30 12:01:22 -0500] perfabio: hi
[2013-01-30 12:47:57 -0500] autholykos: ohai chefs
[2013-01-30 12:49:14 -0500] gyre007: guys, why would search work from knife and not from within recipe ?
[2013-01-30 12:49:18 -0500] gyre007: the same query...
[2013-01-30 12:49:19 -0500] gyre007: mm
[2013-01-30 12:49:48 -0500] gyre007: is solr broken or...
[2013-01-30 12:50:06 -0500] autholykos: I have a question. I have a recipe that fetch a code base from git. Once the codebase is checked out, I need to move some files to other directories on the same node (specifically SSL certificates). What is the bast way of accomplishing this task from whitin the recipe?
[2013-01-30 12:50:50 -0500] autholykos: I though about writing a provider which uses ruby's FileUtils
[2013-01-30 12:50:57 -0500] autholykos: but maybe there is a better option
[2013-01-30 12:54:20 -0500] Anentropic: autholykos have a look at the 'deploy' resource http://wiki.opscode.com/display/chef/Deploy+Resource
[2013-01-30 12:54:47 -0500] Anentropic: it has a 'symlinking' step built in
[2013-01-30 12:54:50 -0500] BryanWB__: for evaling a a string, what if preferred, instance_exec or instance_eval?
[2013-01-30 12:56:20 -0500] autholykos: Anentropic: ah of course, thanks
[2013-01-30 12:59:26 -0500] Unicron_: Can I use include_role in a recipe in the same way that I can use include_role?
[2013-01-30 12:59:34 -0500] Unicron_: include_recipe*
[2013-01-30 13:00:41 -0500] Unicron_: doesn't look like it
[2013-01-30 13:00:43 -0500] Unicron_: nvm
[2013-01-30 13:00:49 -0500] Unicron_: I can do in a recipe
[2013-01-30 13:09:29 -0500] gyre007: oh GOD
[2013-01-30 13:09:44 -0500] gyre007: has chef_environment attribute changed to JUST environment at some point in Chef ??
[2013-01-30 13:10:40 -0500] gyre007: I mean the search attibute
[2013-01-30 13:15:15 -0500] gyre007: arrrrgh... node attribute stayed the same....but the search attribute changed ....unbelievable
[2013-01-30 13:15:17 -0500] gyre007: uuhhh
[2013-01-30 13:25:29 -0500] gyre007: in 10.16.6 I can do search chef_environment:something but in 10.18 I can't....mmmmmmmmmmmmm
[2013-01-30 14:06:48 -0500] erlingwl_: hi, when/how is chef refreshing overriden_attributes?
[2013-01-30 14:07:01 -0500] erlingwl_: I installed the monit cookbook, without specifying any properties
[2013-01-30 14:07:39 -0500] erlingwl_: then I added override_attributes(   "monit" => {     "notify_email" => "erling@somemail.com" } etc.. to my base.rb role
[2013-01-30 14:08:29 -0500] erlingwl_: but, when I re-run the chef client, it doesn't create a /etc/monit/monitrc with any of my attributes, just using the defaults
[2013-01-30 14:13:36 -0500] wassy121: erlingwl_: You can check to see if the attributes are there by running "knife node show -Fj NODENAME -a monit
[2013-01-30 14:14:00 -0500] wassy121: It may be that you didn't push your base.rb role file to the chef server?
[2013-01-30 14:14:18 -0500] wassy121: But the short answer is that it should re-cache those attribute values when you run chef-client on the client
[2013-01-30 14:16:02 -0500] erlingwl_: wassy121: thanks, I have pushed my base.rb role, but I just saw that my email-address is suddenly there, although the mailserver etc is still defaulted, so maybe I've typed something wrong
[2013-01-30 14:31:37 -0500] mmittelstadt: Anyone else seeing gateway timeout errors from api.opscode.com?
[2013-01-30 14:33:22 -0500] fromonesrc: api feels slow this morning but no time outs yet
[2013-01-30 14:34:12 -0500] fromonesrc: oh cool now I'm getting timeouts
[2013-01-30 14:34:22 -0500] mattt: seeing issues too
[2013-01-30 14:34:25 -0500] fromonesrc: is hosted chef on ec2?
[2013-01-30 14:34:53 -0500] mmittelstadt: fromonesrc: it seems to be on rackspace, according to the IP I get from a DNS lookup of api.opscode.com
[2013-01-30 14:41:19 -0500] jfredett: Quick question (wiki diving is failing me) -- I'd like to run a service as a particular user (eg, I'd like user 'foo' to be the one to run start_command/stop_command) -- is there an easy way to do that in chef proper, or do I need to make the start script run as a particular user? (eg, start command would `su - <user> -c <command>`)?
[2013-01-30 14:41:56 -0500] gchristensen: jfredett: what distro is this on? are you making an init script?
[2013-01-30 14:43:17 -0500] jfredett: ubuntu, it's just a run-of-the-mill start script
[2013-01-30 14:43:55 -0500] jfredett: capture pid, drop it in a file, etc -- it's starting a rack app
[2013-01-30 14:43:59 -0500] jfredett: (not rails)
[2013-01-30 14:44:40 -0500] gchristensen: I highly recommend writing an init or upstart script
[2013-01-30 14:44:41 -0500] jfredett: basically, i was wondering if there's some variant of service that takes a 'user' component like, eg, execute
[2013-01-30 14:45:10 -0500] gchristensen: and that upstart script should switch to the right user
[2013-01-30 14:45:31 -0500] r4vi4n: I am exploring the world of Chef and I am trying to get my own cookbook running through chef server.. why does the client always tries to register with the server? Or am I doing something wrong?
[2013-01-30 14:45:59 -0500] jfredett: gchristensen: sure -- but this thing needs to be managable by monit later, I don't know much about upstart (client wants ubuntu, I'm an arch guy) -- will I be able to get monit to start/stop/monitor via upstart later? -- I guess I should read about upstart
[2013-01-30 14:45:59 -0500] r4vi4n: oh I am using vagrant btw :)
[2013-01-30 14:46:22 -0500] gchristensen: jfredett: and yes, if you look up the docs for the execute block you can specify the user.
[2013-01-30 14:46:30 -0500] gchristensen: I don't know anything about monit
[2013-01-30 14:46:43 -0500] jfredett: gchristensen: right, but can I do that for the `service` block, that's the question
[2013-01-30 14:47:14 -0500] jfredett: it sounds like i can't.
[2013-01-30 14:47:33 -0500] gchristensen: I wouldn't expect so.
[2013-01-30 14:47:55 -0500] jfredett: okay
[2013-01-30 14:47:57 -0500] jfredett: thanks
[2013-01-30 14:48:13 -0500] nattyd: yo dudes.  anyone know how to dump a role defined in the ruby dsl to a json file?
[2013-01-30 14:48:41 -0500] mattt: can't you knife role show <name> -Fj ?
[2013-01-30 14:48:50 -0500] gchristensen: jfredett: I don't know about monit, but my experience would say you probably want an init / upstart script in there somewhere, which you can reference in chef :P
[2013-01-30 14:52:39 -0500] spox: jfredett: you might want to have a look at this cookbook: http://community.opscode.com/cookbooks/monit_bin
[2013-01-30 14:52:47 -0500] spox: has a nice lwrp for creating the monit configs
[2013-01-30 14:53:44 -0500] jfredett: spox: I wrote a crappy monit lwrp, this looks way nicer.
[2013-01-30 14:54:29 -0500] r4vi4n: I always get the message: /etc/chef/client.pem is not present - registering
[2013-01-30 14:56:44 -0500] r4vi4n: it is working when I remove the client from the chef server
[2013-01-30 14:57:55 -0500] nattyd: mattt:  nah, that won't work.  the situation I'm working with is that our chef server is down, but json representations of everything except roles are stored locally, so ideally I'd like to just dump the local roles files written in the ruby dsl to json
[2013-01-30 14:58:21 -0500] nattyd: and then use chef-solo until I bring it back up
[2013-01-30 14:58:50 -0500] zts: nattyd: why not use the ruby dsl roles in chef-solo?
[2013-01-30 14:59:05 -0500] mattt: yeah thought it was interchangable
[2013-01-30 14:59:34 -0500] nattyd: fuck hadn't thought of that.  thanks zts, mattt
[2013-01-30 15:01:03 -0500] dotslash: Any advice for using knife boostrap in an environment that doesn't have access to the opscode site?  Is there a way to use boostrap and specify where to get the rpm?
[2013-01-30 15:05:22 -0500] zts: dotslash: you'll need to customise your bootstrap script - http://wiki.opscode.com/display/chef/Custom+Knife+Bootstrap+Script
[2013-01-30 15:07:52 -0500] dotslash: ckelly: Thanks!
[2013-01-30 15:09:47 -0500] r4vi4n: thanks man...
[2013-01-30 15:13:43 -0500] Flex: anyone have an idea how many api calls you can make to hosted chef before you start getting throttled?
[2013-01-30 15:15:43 -0500] mattt: Flex: a # of us were seeing issues today, not sure if that is related to your question in any way :)
[2013-01-30 15:16:47 -0500] Flex: ERROR: Server returned error for
[2013-01-30 15:16:49 -0500] Flex: ?
[2013-01-30 15:16:58 -0500] Flex: rety in X seconds
[2013-01-30 15:17:15 -0500] mattt: Flex: yepper
[2013-01-30 15:22:36 -0500] Flex: ok
[2013-01-30 15:24:09 -0500] Kzim: Hi
[2013-01-30 15:35:41 -0500] gchristensen: I need to restart mysql after the first time the configuration is loaded because of how significant the changes are, every time after that the reload should suffice.
[2013-01-30 15:35:57 -0500] gchristensen: Does it make sense to set an attribute after the first restart indicating that in the future it should reload?
[2013-01-30 15:36:28 -0500] gchristensen: Is that even possible?
[2013-01-30 16:02:48 -0500] nattyd: turns out I couldn't just use the roles defined in the ruby dsl since we were File.read'ing content from our chef-repo into those roles.  ended up using Chef::Role to load the files and dump the json
[2013-01-30 16:02:54 -0500] nattyd: example for the channel log https://gist.github.com/4674204
[2013-01-30 16:08:11 -0500] Kzim: does the opcode yum cookbook allow us to add custom repo via attributes or something that not break the updates ^ thanks
[2013-01-30 16:09:59 -0500] pixie79: hi all, does anyone here use the non opscode user cookbook to create users home dir's and copy there keys but not actually create the user, i am trying to do this but it keeps failing as my users already exist in ldap
[2013-01-30 16:10:32 -0500] atomic-penguin: Kzim, there is a LWRP that allows that, there are several examples in the yumrepo cookbook of LWRP usage
[2013-01-30 16:15:15 -0500] Kzim: atomic-penguin, thanks ! Also, great nickname
[2013-01-30 16:26:59 -0500] dimes: Anyone have any experience with the cookbook "users" by fnichols?
[2013-01-30 16:27:18 -0500] dimes: errr, "user"
[2013-01-30 16:34:46 -0500] pixie79: dimes: i had the same question about 10 mins earlier, it is creating users but i just want it to maintain users as the users are held in ldap but i need to distribute their ssh keys
[2013-01-30 16:36:00 -0500] dimes: pixie79: Mine wont even create the users. I am admittedly new to chef, but it doesn't seem that hard of a cookbook
[2013-01-30 16:36:26 -0500] pixie79: mine looks to be trying to create them
[2013-01-30 16:36:33 -0500] dimes: I have it uploaded, run_list'd to a node, and the databag is there with two users. But it just doesn't do anything
[2013-01-30 16:37:46 -0500] dimes: pixie79: it's driving me crazy as something must be wrong.
[2013-01-30 16:38:01 -0500] dimes: pixie79: did you do anything other than a databag?
[2013-01-30 16:38:23 -0500] pixie79: do you have the users declared in the runlist, i know i didnt before and that then did nothing
[2013-01-30 16:38:39 -0500] dimes: how do I do that?
[2013-01-30 16:40:09 -0500] pcn: WRT the rubygems comporomise of today, does anyone at opscode have checksums on files that are distributed from there?
[2013-01-30 16:42:18 -0500] dimes: pixie79: What knife command would I use?
[2013-01-30 16:43:59 -0500] pixie79: dimes: i just set the default attributes in role, and declare an attribute of "users" that lists the users you want to create
[2013-01-30 16:45:08 -0500] amccloud: When trying to iterate over a node attribute that contains a hash i'm getting "NoMethodError: undefined method `keys' for []:Array"
[2013-01-30 16:45:15 -0500] amccloud: https://gist.github.com/e1e067d874820747c12c
[2013-01-30 16:45:23 -0500] dimes: pixie79: Sorry, I am a n00b to chef, I don't understand the mechanics of what you are saying.
[2013-01-30 16:45:30 -0500] amccloud: Code, error, and attribute
[2013-01-30 16:46:28 -0500] kallistec: amccloud: call to_hash on it first. Pretty much the general solution to attribute weirdness :(
[2013-01-30 16:46:41 -0500] kallistec: which is why we rewrote it from scratch
[2013-01-30 16:46:41 -0500] dimes: pixie79: Are you saying in the default.rb file under attributes in the cookbook, you added a declaration of "users"?
[2013-01-30 16:47:53 -0500] pixie79: dimes: no i created a role and set the default attributes there, then applied the role to the node
[2013-01-30 16:48:13 -0500] dimes: Ahh, hrmmm, I'll look
[2013-01-30 16:48:46 -0500] paigeadele: anybody had problems with rackspace service net this morning?
[2013-01-30 16:48:50 -0500] amccloud: kallistec: NoMethodError: undefined method `to_hash' for []:Array :|
[2013-01-30 16:49:41 -0500] kallistec: amccloud: you sure there's no normal/override attribute overwriting it?
[2013-01-30 16:50:14 -0500] SpamapS: Question about the opscode chef apt repo signing key... http://wiki.opscode.com/display/chef/Opscode+Apt+Repository+Excerpt
[2013-01-30 16:50:34 -0500] SpamapS: How do I know that this key wasn't spoofed? This page is http... the apt repo is http.. there are no signatures on that key...
[2013-01-30 16:50:45 -0500] amccloud: kallistec: I'm sure.
[2013-01-30 16:51:00 -0500] SpamapS: ProfFalken: ohai! ;)
[2013-01-30 16:51:09 -0500] ProfFalken: SpamapS: :P
[2013-01-30 16:51:34 -0500] kallistec: amccloud: then try moving your `to_hash` one level up? node[:glusterfs][:server].to_hash["volumes"]
[2013-01-30 16:51:46 -0500] dimes: pixie79: Yeah, I have no idea on that. Seems like this would be in the documentation. Not clear to me what to do. =/
[2013-01-30 16:52:27 -0500] Unicron_: have recipe doing ntpserver.each but it says each is an undefined method - does that suggest that ntpserver is not populated?
[2013-01-30 16:53:43 -0500] btm: SpamapS: gpg --keyserver keys.gnupg.net --recv-keys 83EF826A
[2013-01-30 16:54:27 -0500] wdpro_kevin: it it possible to use the Service resource without having an init script?
[2013-01-30 16:54:34 -0500] dimes: pixie79: I thought I understood that by default it would do all users in the dbag
[2013-01-30 16:55:03 -0500] jtimberman: wdpro_kevin: sure, if a package drops off an init script
[2013-01-30 16:55:04 -0500] amccloud: kallistec: No luck :(
[2013-01-30 16:55:05 -0500] Unicron_: ferget it - I have overwritten a data bag item with another databags item - so indeed the array was not populated
[2013-01-30 16:56:52 -0500] pixie79: dimes that is what i thought to start but no unless you declare them it does nothing
[2013-01-30 16:57:00 -0500] wdpro_kevin: jtimberman: what if the init script is not in the normal location (like /etc/init.d)?
[2013-01-30 16:57:48 -0500] dimes: pixie79: I don't suppose you have a txt version of the role you created? I just don't understand the format of what I am supposed to be creating.
[2013-01-30 16:57:52 -0500] dimes: pixie79: if not, no worries
[2013-01-30 16:59:48 -0500] pixie79: dimes: https://gist.github.com/4674669
[2013-01-30 16:59:57 -0500] jtimberman: wdpro_kevin: the service resource has different providers depending on the platform that expect things in "standard" locations for those platforms.
[2013-01-30 17:00:15 -0500] jtimberman: wdpro_kevin: i'd use a link resource to make a symlink from /your/init/script to /etc/init.d
[2013-01-30 17:00:51 -0500] mattray: If you're a knife-hp user, https://github.com/mattray/knife-hp/tree/KNIFE-218 will be the next release. Waiting on a new Fog
[2013-01-30 17:01:02 -0500] mattray: yay features
[2013-01-30 17:01:15 -0500] jtimberman: pcn: fwiw, I just checked the 'chef' gem and the only difference between the one downloaded from rubygems.org is in the man pages (version number change that was corrected in our 'omnibus' package, but not released on rubygems.org due to only a single version being available)
[2013-01-30 17:01:25 -0500] dimes: pixie79: Thanks.
[2013-01-30 17:01:26 -0500] SpamapS: btm: that does nothing
[2013-01-30 17:02:21 -0500] wdpro_kevin: jtimberman: I was thinking the same thing. Thanks
[2013-01-30 17:07:01 -0500] SpamapS: btm: the keyserver is just as likely to be MITM'd as any other server using HTTP
[2013-01-30 17:12:33 -0500] paigeadele: ive almost got my srs letter to go from pole to hole
[2013-01-30 17:21:40 -0500] pixie79: fixed my issue - i have extended the users cookbook to have a create_minimal and a remove_minimal action that only creates the home dir and transfers the authorised_keys
[2013-01-30 17:22:26 -0500] dimes: pixie79: grats.
[2013-01-30 17:30:34 -0500] dimes: pixie79: I have 15+ years as a unix systems engineer, and I don't think I have felt this ignorant or stupid in 14.5 years
[2013-01-30 17:32:47 -0500] btm: SpamapS: I could sign the key, but then you still have to get my key somehow. Eventually we'll rebuild the ancient apt server on something with SSL. But if you have a credible threat that someone is going to MITM you downloading the key from our server and/or pgp.mit.edu, and then MITM you downloading a package, you probably have bigger things to worry about and should be hosting verified packages internally instead.
[2013-01-30 17:34:02 -0500] SpamapS: btm: so basically "Chef doesn't care about your security. Deal with it" ?
[2013-01-30 17:38:26 -0500] gchristensen: is it just me, or does the client list output in a non-deterministic fashion? I was deleting clients, then the order shifted suddenly and I deleted the wrong one.
[2013-01-30 17:38:45 -0500] SpamapS: btm: On the point of "then you have to get my key somehow". Please see: The way GPG is intended to work. Get your key signed. Get it into the web of trust. SSL is probably a cheaper way to do it though, as you are basically buying your way into a reasonably credible web of trust in the global PKI. Though then your repo isn't cachable.. so that presents problems too.
[2013-01-30 17:40:18 -0500] btm: SpamapS: security isn't black and white. You don't care or not care. That kind of assertation and attitude doesn't benefit the discussion.
[2013-01-30 17:41:25 -0500] SpamapS: btm: Sure, security is a process, and what I see in your answer is that you don't actually care about that attack vector.
[2013-01-30 17:42:13 -0500] josephholsten: SpamapS: trolling btm may not work well for you in the long run.
[2013-01-30 17:42:45 -0500] SpamapS: btm: Can users work around it? Yes. Is it reasonable to expect them to know they need to? Probably not. You're putting them at risk by instructing them to trust a key they can't verify.
[2013-01-30 17:43:16 -0500] btm: SpamapS: We have not been concerned enough for an attack vector of multiple MITM attacks between the apt server and remote server to rebuild it. Correct.
[2013-01-30 17:44:13 -0500] c_t: http://scienceblogs.com/goodmath/2007/04/15/strange-loops-dennis-ritchie-a/
[2013-01-30 17:44:19 -0500] c_t: ^ Relevant, somehow
[2013-01-30 17:45:50 -0500] SpamapS: btm: alright. Please forgive my outrageous statement above. I want this to be better, not to get a rise out of you or anybody else.
[2013-01-30 17:47:29 -0500] SpamapS: btm: it would take, how long, to sign that key with a few trusted Opscode keys and push said signatures to the keyservers? That seems like a pretty reasonable thing to do. Would a bug ticket for that have a reasonable chance of getting addressed?
[2013-01-30 17:47:32 -0500] btm: SpamapS: word. apt.opscode.com is probably the oldest box still in existence at Opscode. Ops started rebuilding it once but it fell through the cracks.
[2013-01-30 17:48:31 -0500] btm: SpamapS: I'm not personally the one to rebuild it (especially as we're in the final stages of getting Chef 11 ready to go), but if you file a ticket I'll get a couple signatures on it at least.
[2013-01-30 17:48:58 -0500] SpamapS: btm: cool, thanks.
[2013-01-30 17:53:04 -0500] deed02392: with the file provider, if i want to create a file and the parent dir doesn't exist, does chef create all the necessary parent dirs?
[2013-01-30 17:55:07 -0500] a_a_g: deed02392: i dont think so
[2013-01-30 17:55:21 -0500] paigeamobile: You need to soecify recursive
[2013-01-30 17:55:30 -0500] paigeamobile: Recursive :true
[2013-01-30 17:55:52 -0500] paigeamobile: Its in the resources doc
[2013-01-30 17:55:58 -0500] deed02392: thanks paigeamobile, didn't see that in the docs though
[2013-01-30 17:56:02 -0500] deed02392: ^ lol
[2013-01-30 17:56:33 -0500] deed02392: i looked here: http://docs.opscode.com/resource_file.html
[2013-01-30 17:56:34 -0500] deed02392: doesn't mention at all
[2013-01-30 17:57:09 -0500] paigeamobile: Oh for file
[2013-01-30 17:57:30 -0500] paigeamobile: You may have to create the dir first
[2013-01-30 17:57:31 -0500] a_a_g: paigeamobile: isnt that for directories only?
[2013-01-30 17:57:43 -0500] deed02392: yeah
[2013-01-30 17:57:43 -0500] deed02392: does that not work for file?
[2013-01-30 17:57:49 -0500] a_a_g: dont remember seeing it for files
[2013-01-30 17:57:59 -0500] paigeamobile: Yeah I believe it might be although cqnt tell without looking at the code
[2013-01-30 17:58:36 -0500] SpamapS: btm: http://tickets.opscode.com/browse/CHEF-3807
[2013-01-30 17:58:40 -0500] paigeamobile: I would just do my directory first then my file
[2013-01-30 17:58:46 -0500] SpamapS: btm: thanks for your time.
[2013-01-30 17:58:52 -0500] deed02392: it would be silly if i can't do it for file too.. :(
[2013-01-30 17:59:28 -0500] deed02392: but the file is from an attribute
[2013-01-30 17:59:31 -0500] deed02392: so i'd have to parse the attribute for the path and the file and do it separately
[2013-01-30 17:59:37 -0500] a_a_g: its not so simple for files. what policy do you implement for permissions and owners?
[2013-01-30 18:00:03 -0500] deed02392: i'm creating the socket for php-fpm
[2013-01-30 18:00:23 -0500] paigeamobile: Spam mitm how
[2013-01-30 18:00:50 -0500] a_a_g: deed02392: http://www.ruby-doc.org/core-1.9.3/File.html#method-c-dirname
[2013-01-30 18:01:04 -0500] SpamapS: paigeamobile: mitm the keyserver and apt.opscode.com .. feed user bad key.. install root kit and then package which installs original key.. tracks covered, pwned
[2013-01-30 18:01:28 -0500] a_a_g: http://www.ruby-doc.org/core-1.9.3/File.html#method-c-basename
[2013-01-30 18:01:43 -0500] deed02392: thanks a_a_g
[2013-01-30 18:01:55 -0500] SpamapS: paigeamobile: mitm through DNS.. local ip spoofing.. many ways to get in
[2013-01-30 18:02:20 -0500] paigeamobile: Spammaps dhcp snooping?
[2013-01-30 18:02:25 -0500] SpamapS: paigeamobile: all are addressible by other means.. and can be mitigated.. but nonetheless its an attack surface that should at least be documented.
[2013-01-30 18:03:26 -0500] SpamapS: paigeamobile: yeah you can also be the DHCP server for  them if you're on the same LAN and make yourself their gateway. Thats an oldie, but a goodie. :)
[2013-01-30 18:04:10 -0500] paigeamobile: Thats the only way I can think of, also ossec and snort and use ossec active response
[2013-01-30 18:04:11 -0500] SpamapS: I think DNS cache poison is the scariest, but is getting less easy to do.
[2013-01-30 18:04:32 -0500] paigeamobile: Ah yeah that too
[2013-01-30 18:04:47 -0500] paigeamobile: Dnssec is a little tricky
[2013-01-30 18:05:13 -0500] paigeamobile: And still not widely used
[2013-01-30 18:06:06 -0500] paigeamobile: I wrote a dns cookbook im gonna add dnssec to it at some point and refactor it and give it to the community
[2013-01-30 18:06:13 -0500] josephholsten: SpamapS: did you hear google dns has it turned on now: http://mailman.nanog.org/pipermail/nanog/2013-January/055293.html
[2013-01-30 18:06:42 -0500] paigeamobile: In fact maybe ill start on that today
[2013-01-30 18:07:19 -0500] paigeamobile: Bbiab
[2013-01-30 18:10:42 -0500] SpamapS: josephholsten: did not hear that. Good to hear though.
[2013-01-30 18:17:06 -0500] gyre007: can someone smart here tell me whats the difference between search(:node, 'chef_environment:production') and search(:node, 'environment:production')
[2013-01-30 18:20:08 -0500] jtimberman: gyre007: chef_environment is the actual thing you want that is the node's environment as far as the chef server is concerned.
[2013-01-30 18:20:24 -0500] jtimberman: gyre007: if you have 'environment' then it sounds like someone created an attribute named environment.
[2013-01-30 18:20:40 -0500] jtimberman: e.g., node.chef_environment vs node['environment']
[2013-01-30 18:22:37 -0500] deed02392: i've made some improvements (imho) to the community php-fpm cookbook, how do I contribute my ideas back?
[2013-01-30 18:22:57 -0500] ben-: deed02392: http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-01-30 18:23:33 -0500] deed02392: i thought everything was on docs.opscode.com now?
[2013-01-30 18:23:48 -0500] gchristensen: probably everything but our bookmarks
[2013-01-30 18:23:54 -0500] maplebed: +1 gchristensen
[2013-01-30 18:24:02 -0500] maplebed: anyway, that process is still valid.
[2013-01-30 18:24:55 -0500] josephholsten:  looks like that isn't in docs. yet
[2013-01-30 18:25:59 -0500] maplebed: Hopefully that leads to the question "how do I contribute to docs.opscode.com?"
[2013-01-30 18:26:05 -0500] maplebed: ;)
[2013-01-30 18:35:15 -0500] gyre007: jtimberman: interesting...I noticed some strangeness in our staging environment...basically....search(:node, 'chef_environment:staging') is returning only FEW nodes in staging...whilst search(:node, 'environment:staging') is returning them all...mm
[2013-01-30 18:35:25 -0500] gyre007: I dont quite get why is this happening...
[2013-01-30 18:35:44 -0500] gyre007: because I had a look at this in chef and they all have environment set to staging..
[2013-01-30 18:38:05 -0500] gyre007: jtimberman: in WebUI I can see with every host Environment: staging
[2013-01-30 18:43:48 -0500] miah: did you set a node attribute of 'environment' to 'staging' or the node chef_environment attribute to staging?
[2013-01-30 18:44:00 -0500] miah: what does 'knife node show <node>' on one of your nodes show?
[2013-01-30 18:44:43 -0500] gyre007: miah: let me see....I'll pick one which is returned in both queries...
[2013-01-30 18:46:03 -0500] gyre007: miah: hah...Environment IS INDEED returned in knife show and it's correct!
[2013-01-30 18:47:53 -0500] gyre007: miah jtimberman look at this https://gist.github.com/4675635
[2013-01-30 18:49:42 -0500] miah: are you running open source chef or hosted?
[2013-01-30 18:49:57 -0500] gyre007: open source
[2013-01-30 18:52:12 -0500] miah: is your search indexing?
[2013-01-30 19:03:08 -0500] zpatten: ohai chef peeps
[2013-01-30 19:17:19 -0500] gyre007: miah: arrrgh...I made a horrible mistake...overridden chef_environment attribute for most of the hosts :(
[2013-01-30 19:19:21 -0500] miah: doh
[2013-01-30 19:19:31 -0500] miah: well., at least you know what the problem is now and can fix it =)
[2013-01-30 19:20:27 -0500] nickh: Does anyone use encrypted data bags much?  I was wondering about the 'encrypted_data_bag_secret' file and best practices...  In our 'default' role, we have a postfix recipe that sets up postfix with our SendGrid account - this recipe pulls our SendGrid credentials from an encrypted data bag.  Is it common/safe to push the encrypted_data_bag_secret file out to all hosts?
[2013-01-30 19:21:10 -0500] miah: well consider that anybody with the key can read the data bag
[2013-01-30 19:21:24 -0500] miah: so, if you care that all of your hosts can read the bag (which you should as your using encrypted data bags)
[2013-01-30 19:21:31 -0500] nickh: Or is there a better way (for example always running 'knife ssh ... "sudo chef-client"' from a machine that has the key)?
[2013-01-30 19:21:36 -0500] miah: you can create multiple different keys for each role / environment
[2013-01-30 19:21:40 -0500] miah: key escrow is up to you
[2013-01-30 19:23:27 -0500] nickh: Okay, thanks @miah.  I think that helps :-)
[2013-01-30 19:26:29 -0500] otterley: how can I alias the search method in a library?
[2013-01-30 19:26:34 -0500] otterley: alias original_search search doesn't work
[2013-01-30 19:28:33 -0500] otterley: I suppose I need alias_method, but I'm not sure which class/module to eval it in
[2013-01-30 19:31:15 -0500] jtimberman: otterley: you need to require 'chef/search/query' and create an instance of Chef::Search::Query
[2013-01-30 19:31:44 -0500] otterley: can I do Chef::Search::Query.class_eval {} ?
[2013-01-30 19:32:02 -0500] jtimberman: https://github.com/opscode-cookbooks/nagios/blob/jtimberman/v4/libraries/data_bag_helper.rb#L16
[2013-01-30 19:32:46 -0500] otterley: I actually want to override the search method with an options hash as the final argument; I'm implementing a cache
[2013-01-30 19:34:00 -0500] otterley: to wit: https://gist.github.com/2f375c610e7436a6b1ed
[2013-01-30 19:35:09 -0500] deed02392: I've got notifies :restart, service[php5-fpm], :delayed in a template creator, but it doesn't seem to be actually restarting the service? I have checked all the chef output and it processes the template but never mentions restarting the service
[2013-01-30 19:35:48 -0500] deed02392: it goes on to Processing service: enable, and start though, which is lower down in the recipe
[2013-01-30 19:37:52 -0500] miah: "notifies :restart, 'service[php5-fpm]', :delayed"
[2013-01-30 19:38:43 -0500] deed02392: hmm
[2013-01-30 19:39:09 -0500] deed02392: i haven't used quotes because i'm getting the service name from a variable miah
[2013-01-30 19:39:13 -0500] deed02392: so i've done it like hash{}
[2013-01-30 19:39:21 -0500] deed02392: (can't find hash char)
[2013-01-30 19:39:44 -0500] deed02392: and surrounded it in double quotes
[2013-01-30 19:39:45 -0500] deed02392: is that not sufficient?
[2013-01-30 19:39:45 -0500] deed02392: does chef need to see single quotes around there?
[2013-01-30 19:40:20 -0500] miah: its not about chef. its about ruby.
[2013-01-30 19:40:54 -0500] deed02392: how should I do this then? using single quotes will mean the var isn't put in there?
[2013-01-30 19:40:55 -0500] deed02392: use concatenation?
[2013-01-30 19:41:19 -0500] otterley: notifies :restart, "service[#{name}]", :delayed
[2013-01-30 19:41:28 -0500] jtimberman: otterley: i'm afraid i don't  have any helpful advice for you
[2013-01-30 19:41:40 -0500] deed02392: that's exactly what i'm doing otterley
[2013-01-30 19:41:50 -0500] otterley: jtimberman, no worries - first I'm trying to figure out how to touch node in a library outside a function
[2013-01-30 19:42:14 -0500] jtimberman: carefully! :)
[2013-01-30 19:42:28 -0500] otterley: jtimberman, it doesn't seem to be accessible at that point:
[2013-01-30 19:42:39 -0500] otterley: undefined local variable or method `node' for main:Object
[2013-01-30 19:42:39 -0500] deed02392: can I use notifies in a template block?
[2013-01-30 19:42:49 -0500] otterley: deed02392, sure you can
[2013-01-30 19:43:14 -0500] deed02392: i don't understand why this isn't working then
[2013-01-30 19:43:21 -0500] deed02392: if i do service php5-fpm restart on the command line it works
[2013-01-30 19:43:35 -0500] otterley: run with debugging turned on?  -l debug
[2013-01-30 19:44:55 -0500] deed02392: woah
[2013-01-30 19:44:55 -0500] deed02392: that's rather verbose
[2013-01-30 19:54:04 -0500] Kzim: hi, can i unset an attribute in the environment set by default on the cookbook ?
[2013-01-30 20:00:06 -0500] kamabe: does anyone know of a good way to set the python virtual environment for a python code block in a recipe? i tried passing in the PYTHONPATH environment variable but i still got the error that it couldn't find the module i wanted to import.
[2013-01-30 20:01:37 -0500] btm: @opscode Chef Code Review: join: http://bit.ly/XjKwUk, watch: http://youtu.be/9rFX6-k9OP8 #opschef
[2013-01-30 20:06:26 -0500] paigeadele_: http://pastie.org/private/buahwgjzcnqiue6gvkkeuq
[2013-01-30 20:06:36 -0500] paigeadele_: no dhcp snooping?
[2013-01-30 20:06:37 -0500] paigeadele_: then wtf
[2013-01-30 20:06:39 -0500] deed02392: otterley, it's listed in there as restarting
[2013-01-30 20:07:07 -0500] deed02392: in the debug output it says processing service[php5-fpm] restart
[2013-01-30 20:07:32 -0500] kderr: Is there an easy way to include a recipe from the same cookbook?
[2013-01-30 20:07:40 -0500] deed02392: and then it goes on to say falling back to process table
[2013-01-30 20:07:40 -0500] deed02392: attempting to match php5-fpm
[2013-01-30 20:07:50 -0500] deed02392: running: false, blah blah and then it says it's restarted
[2013-01-30 20:08:15 -0500] deed02392: kderr, include another recipe from a recipe?
[2013-01-30 20:08:20 -0500] deed02392: i believe include cookbook::recipe_name does that
[2013-01-30 20:08:53 -0500] kderr: deed02392: So, you have to specify the cookbook even if it's the same cookbook that the recipe you're writing resides in?
[2013-01-30 20:11:40 -0500] deed02392: that's the way i've seen it done so far kderr
[2013-01-30 20:11:43 -0500] deed02392: is that a problem?
[2013-01-30 20:12:04 -0500] kderr: deed02392: Not really. Just feels like I must be doing something wrong, because it means if I rename the cookbook i have to go change this file.
[2013-01-30 20:12:41 -0500] kderr: Figured there was a way to say "from this 'current' cookbook
[2013-01-30 20:20:56 -0500] jubilo: guys, is there a way to change the default log location in the chef-client cookbook? I see where it's accessing a template to set the location, but if I change anything from STDOUT it errors out on me. Am I missing something obvious?
[2013-01-30 20:28:36 -0500] mmorris: has anyone run into "Incorrect usage of DB GRANT and GLOBAL PRIVILEGES" when granting privileges for a mysql user?
[2013-01-30 20:28:48 -0500] timsmith: can someone explain to me what the concept of run_state is in chef.  In particular when cookbooks modify node.run_state
[2013-01-30 20:32:10 -0500] madh888: question: any tips on managing the access key with OSS chef?
[2013-01-30 20:32:20 -0500] troyready: Anyone going to the Chef Training Workshop at the SCaLE conference next month? Anyone know if it's full already?
[2013-01-30 20:39:13 -0500] ranjibd: madh888,  do you mean user ssh keys?
[2013-01-30 20:39:26 -0500] madh888: yea
[2013-01-30 20:39:47 -0500] madh888: i want to use chef server to manage a bunch of hosts
[2013-01-30 20:39:52 -0500] ranjibd: madh888, check the users community cookbook
[2013-01-30 20:40:14 -0500] madh888: oh no i'm talking more about securing chef
[2013-01-30 20:44:09 -0500] deed02392: kderr, that's a fair point. i wonder if you could use git to automate that somehow though, if you think you'll run into that issue frequently
[2013-01-30 20:46:13 -0500] kderr: deed02392: oof :)
[2013-01-30 20:46:55 -0500] deed02392: what does oof mean :P
[2013-01-30 20:48:05 -0500] deed02392: does anyone know what it means whne chef 'falls back to process table' when you specify :restart, service[foo]
[2013-01-30 20:49:00 -0500] jtimberman: deed02392: it inspects the process table for the process named "foo"
[2013-01-30 20:49:07 -0500] jtimberman: which is usually the most sane thing to do
[2013-01-30 20:49:34 -0500] jtimberman: but it can yield false positives, e.g., a service that starts "workers" and one doesn't die, or someone is reading the man page :)
[2013-01-30 20:50:37 -0500] jtimberman: so chef allows you to tell the service resource whether it supports a "status" command for its init script, or you can give your own pattern that it should look for in the process table, or you can give it a command that will check status if the init script doesn't have one but e.g. a control command does (or something else entirely)
[2013-01-30 20:50:50 -0500] jubilo: is there a way to change the default log location in the chef-client cookbook? I see where it's accessing a template to set the location, but if I change anything from STDOUT it errors out on me. Am I missing something obvious?
[2013-01-30 20:52:40 -0500] deed02392: well jtimberman, I know that 'service php5-fpm restart' properly restarts it
[2013-01-30 20:53:10 -0500] deed02392: i'm more wondering what does it imply that it is using the process table rather than whatever system `service` refers to on debian?
[2013-01-30 20:53:54 -0500] supster: Can anyone tell why I can't get the ohai resource to reload ohai configuration? Am I using notifications wrong? https://gist.github.com/6ab4226a4860a3f1cf65
[2013-01-30 20:54:25 -0500] deed02392: problem is it doesn't seem to be restarting php5-fpm, i know because it doesn't create the .sock file where it should after chef has run but it does if i use either service or init script
[2013-01-30 20:54:55 -0500] deed02392: i say where it should after chef has run, because i've put that notifies line in and the debug output seems to be satisfied it's restarting it somehow
[2013-01-30 20:55:30 -0500] deed02392: i think because it concludes that it's not running, and so just runs the start script, which basically ignores that request because it IS running
[2013-01-30 20:55:31 -0500] deed02392: what do you think jtimberman ?
[2013-01-30 20:56:48 -0500] rava: anyone have a clean way of doing a rename on a mysql table in a recipe if it already exists?
[2013-01-30 20:58:43 -0500] ev0ldave: clean as in not running an execute "mysql -e"?
[2013-01-30 20:59:10 -0500] rava: i answered my own question while making coffee, i'll just wrap it in if not exists()
[2013-01-30 20:59:39 -0500] rava: i've a rename table operation in a recipe, and works fine the first time but pukes the chef run on subsequent runs because it exists
[2013-01-30 21:00:24 -0500] ev0ldave: ah
[2013-01-30 21:02:10 -0500] jtnz: If I have some ruby code in a recipe, I understand that it will run during compilation. To avoid this, you put it in a ruby_block. Will that regular ruby code run again during the execution phase too?
[2013-01-30 21:04:32 -0500] timsmith: I take it there's no code review today?
[2013-01-30 21:04:45 -0500] ev0ldave: you missed it
[2013-01-30 21:05:23 -0500] timsmith: ev0ldave: What name does "other" dave use on here?
[2013-01-30 21:05:46 -0500] ev0ldave: btm
[2013-01-30 21:05:46 -0500] ev0ldave: 12:01
[2013-01-30 21:05:46 -0500] ev0ldave: @opscode Chef Code Review: join: http://bit.ly/XjKwUk, watch: http://youtu.be/9rFX6-k9OP8irc://irc.freenode.net:6667/#opschef
[2013-01-30 21:05:50 -0500] ev0ldave: vanilla dave?
[2013-01-30 21:06:20 -0500] timsmith: ev0ldave: "larry" dave
[2013-01-30 21:07:14 -0500] btm: @opscode cookbook code review, join: http://bit.ly/11gctlC watch: http://youtu.be/EBr6ZDIOxws #opschef
[2013-01-30 21:07:24 -0500] ev0ldave: timsmith:  justdave
[2013-01-30 21:07:43 -0500] btm: timsmith: just in the bio break between code reviews.
[2013-01-30 21:10:31 -0500] ev0ldave: i see the talk of chef 11 server in the wiki, is there a client to go along with it?
[2013-01-30 21:15:24 -0500] mjreed: OK, I have a community cookbook that is putting a bogus value into an attribute that is a list.  How the heck can I override that attribute to remove the bad value?
[2013-01-30 21:16:02 -0500] chris613: Set the attribute elsewhere with a higher priority than the community cookbook uses
[2013-01-30 21:18:22 -0500] ev0ldave: rehat 5 is also 5.0
[2013-01-30 21:18:28 -0500] ev0ldave: for mysql
[2013-01-30 21:18:56 -0500] mjreed: chris613 but the attribute value is a list
[2013-01-30 21:18:59 -0500] mjreed: so it gets merged
[2013-01-30 21:19:01 -0500] mjreed: not overwritten
[2013-01-30 21:20:53 -0500] jblaine: janky -- predefining 'service "whatever" do     action :nothing    end' ... so that you can later reference it with a different action
[2013-01-30 21:21:03 -0500] jblaine: is there any plan to try to clean that wart up?
[2013-01-30 21:22:00 -0500] dougireton: I'm trying to send a metric to statsd from a Chef managed node. What's the easiest way to figure out a node's chef environment and node name using a script (e.g. not in the context of a Chef run)?
[2013-01-30 21:23:57 -0500] drbrain: have any of you opscode people tried out the rubygems prereleases (or ruby 2.0 prereleases which contain it) with chef?
[2013-01-30 21:24:27 -0500] drbrain: I'm curious as we're coming up on the ruby/rubygems 2.0 release date soon
[2013-01-30 21:25:13 -0500] btm: ev0ldave: github.com/opscode/chef master is chef 11 client, also 'gem install chef --pre' will get you the latest chef 11 client beta.
[2013-01-30 21:25:36 -0500] btm: ev0ldave: we've had announcements on the chef mailing list
[2013-01-30 21:26:25 -0500] drbrain:  I'd like to avoid any surprises for you
[2013-01-30 21:26:26 -0500] juliancdunn: jblaine: not sure what you mean by 'janky'
[2013-01-30 21:27:06 -0500] deed02392: how do I inform chef of how to restart a service?
[2013-01-30 21:28:11 -0500] btm: deed02392: http://docs.opscode.com/resource_service.html
[2013-01-30 21:36:07 -0500] mjreed: so that's a no on overriding a list value.
[2013-01-30 21:42:35 -0500] dsl_: Hey all, I was wondering if someone might be able to help with an issue I'm having writing a custom ohai plugin
[2013-01-30 21:43:36 -0500] bluepojo: Has anyone written a recipe to make a box PCI compliant? Chef is unable to connect to the server after the PCI compliance script runs, and I'm wondering if maybe PCI means Chef won't work due to ssh restrictions
[2013-01-30 21:45:03 -0500] bluepojo: or otherwise
[2013-01-30 21:46:53 -0500] dsl_: trying to execute this:
[2013-01-30 21:46:54 -0500] dsl_: https://github.com/looprock/ohai_plugins/blob/master/customjava.rb
[2013-01-30 21:47:32 -0500] dsl_: knife node show cheftest.vast.com -a customjava -Fj
[2013-01-30 21:47:32 -0500] dsl_: {
[2013-01-30 21:47:32 -0500] dsl_:   "customjava": null
[2013-01-30 21:47:34 -0500] dsl_: }
[2013-01-30 21:48:26 -0500] dsl_: unfortunately the wiki only has examples with a single data point
[2013-01-30 21:48:43 -0500] dsl_: I've looked in other plugins and can't see what I'm doing wrong
[2013-01-30 21:59:42 -0500] CharlieSu: dsl_: have you commented everything out and tried setting it to a simple string to ensure that it is setting attributes correctly?
[2013-01-30 22:00:39 -0500] dsl_: yep, if I just assign it via: customjava <val> it works
[2013-01-30 22:01:27 -0500] jtimberman: bluepojo: sshd only listening on localhost? seems bad ;)
[2013-01-30 22:01:31 -0500] mattray: knife-openstack's next release is starting up here: https://github.com/mattray/knife-openstack/tree/0.7.0
[2013-01-30 22:01:32 -0500] mattray: fog 1.9.0 broke stuff, so I'm waiting on the next fog release and currently working off master
[2013-01-30 22:01:39 -0500] mattray: going to clear out most of the pull requests and add a few new features
[2013-01-30 22:01:45 -0500] jtimberman: bluepojo: I wrote this sometime ago: http://ckbk.it/cis_benchmark
[2013-01-30 22:02:07 -0500] CharlieSu: dsl_: i've only briefly looked over your code..  put most of it in a begin/rescuse block and in your rescue set things to a simple string to see if something is blowing up..
[2013-01-30 22:02:34 -0500] bluepojo: jtimberman: ah cool, I'll poke through that
[2013-01-30 22:03:12 -0500] dsl_: CharlieSu, cool thx will do
[2013-01-30 22:04:34 -0500] CharlieSu: dsl_: https://gist.github.com/650f2aa22acec7c458f5
[2013-01-30 22:05:46 -0500] dsl_: cool thx Charlie!
[2013-01-30 22:07:42 -0500] jtimberman: drbrain: I don't believe so. For our native "omnibus" packages, we're bundling specific versions of ruby, rubygems, etc.
[2013-01-30 22:08:16 -0500] drbrain: jtimberman: I tried it on rubygems 2/ruby 2 and it looks like you rely on lib/rubygems/format.rb which is now lib/rubygems/package.rb
[2013-01-30 22:08:44 -0500] drbrain: Gem::Format/Package/Builder are now merged into a common API as Gem::Package
[2013-01-30 22:08:52 -0500] miah: cis benchmark was the first thing i implemented in cfengine.. in 2006 =)
[2013-01-30 22:09:39 -0500] jtimberman: miah: ya, it was the first thing I implemented at SANS (since they worked with CIS to develop it) in puppet.
[2013-01-30 22:19:45 -0500] miah: fun =)
[2013-01-30 22:23:52 -0500] robbkidd: Hola, chefs!
[2013-01-30 22:24:57 -0500] robbkidd: Is there a solution for overriding from which interface node[:ipaddress] is computed?
[2013-01-30 22:25:11 -0500] robbkidd: I see a ticket for ohai opened a while ago on the subject: http://tickets.opscode.com/browse/OHAI-287
[2013-01-30 22:26:47 -0500] robbkidd: There's a recommendation on that ticket to do: node.automatic_attrs[:ipaddress] = node[:whatever]
[2013-01-30 22:27:57 -0500] robbkidd: But I can't quite figure out what to use in "node[:whatever]". Could be that I'm trying to do this in an environment so that all nodes in this environment get their node[:ipaddress] from an alternate NIC.
[2013-01-30 22:30:34 -0500] maplebed: robbkidd: not quiet the answer to your question, but https://github.com/opscode-cookbooks/nagios/blob/master/templates/default/hosts.cfg.erb#L21-L27 is how the nagios cookbook decides what IP address to use for a node.
[2013-01-30 22:30:42 -0500] maplebed: might give you ideas
[2013-01-30 22:31:52 -0500] robbkidd: maplebed: Yup. If only I owned the cookbook I'm dealing with. https://github.com/lusis/chef-logstash/blob/master/recipes/agent.rb#L15-24
[2013-01-30 22:32:14 -0500] maplebed: fork and patch!  :D
[2013-01-30 22:32:28 -0500] robbkidd: There is that.
[2013-01-30 22:33:02 -0500] maplebed: there's one more example from nagios if you do want to fork/patch...  one sec.
[2013-01-30 22:35:47 -0500] robbkidd: Given the block I linked, I figure it might make more sense NOT to search for a node's IP if node['logstash']['agent']['server_ipaddress'] is given.
[2013-01-30 22:36:35 -0500] robbkidd: miah: Does it set node[:ipaddress]?
[2013-01-30 22:36:36 -0500] maplebed: those two were part of a patch to replace using node['hostname'] with a configurable node attribute
[2013-01-30 22:37:19 -0500] maplebed: (say you want to use node['fqdn'] instead, you would change the host_name_attribute to 'fqdn')
[2013-01-30 22:37:55 -0500] miah: no
[2013-01-30 22:38:09 -0500] miah: it doesnt set that attribute, but it will load a node object and tell you the ip based on some assumptions
[2013-01-30 22:38:27 -0500] miah: eg, if host is vagrant or ec2 give different results
[2013-01-30 22:38:35 -0500] robbkidd: Ah.
[2013-01-30 22:39:18 -0500] robbkidd: Yea. That's my problem. I'm in Vagrant and the logstash cookbook assumes you want to send log entries to the default NIC of the node with the logstash_server role.
[2013-01-30 22:39:36 -0500] robbkidd: Which no workie.
[2013-01-30 22:40:23 -0500] miah: yup
[2013-01-30 22:40:30 -0500] robbkidd: Buuut I'm not wedded to logstash. What do you folks use for log aggregation?
[2013-01-30 22:41:16 -0500] miah: well. the problem isn't logstash. its the cookbook.
[2013-01-30 22:41:29 -0500] robbkidd:  True that.
[2013-01-30 22:41:29 -0500] miah: fix the code. no reason to drop a whole product because of a poor cookbook implementation
[2013-01-30 22:41:35 -0500] miah: especially when most cookbooks are poor implementations
[2013-01-30 22:41:56 -0500] robbkidd: {hangs head} OK. I'll do the right thing.
[2013-01-30 22:45:17 -0500] robbkidd: But I'm still curious what you folks use for log aggregation.
[2013-01-30 22:45:21 -0500] robbkidd: :)
[2013-01-30 22:45:29 -0500] iverson0881: robbkidd: rsyslog?
[2013-01-30 22:45:37 -0500] spheromak: rsyslog -> other things
[2013-01-30 22:46:04 -0500] miah: spheromak: <3
[2013-01-30 22:46:12 -0500] miah: syslog-ng + logstash
[2013-01-30 22:46:18 -0500] log1kal: robbkidd: I use splunk, but wish I could use logstash.
[2013-01-30 22:46:32 -0500] spheromak: log1kal: heh use both here.  :\
[2013-01-30 22:46:36 -0500] robbkidd: That might end up being what we settle on. log stash's agent memory footprint is apparently 100MB. http://cookbook.logstash.net/recipes/rsyslog-agent/
[2013-01-30 22:46:39 -0500] iverson0881: splunk is overly priced :(
[2013-01-30 22:46:44 -0500] spheromak: splunk front-end is hard to beat tho
[2013-01-30 22:46:56 -0500] miah: robbkidd: depends on how you run it.
[2013-01-30 22:46:57 -0500] log1kal: spheromak: that's why we chose it over logstash + kibana
[2013-01-30 22:46:59 -0500] iverson0881: there's a few competitors out there now like sumologic
[2013-01-30 22:47:06 -0500] spheromak: we got non techies that build dashes and searches/alerts etc.
[2013-01-30 22:47:07 -0500] miah: the logstash distribution defaults to running logstash via jruby though
[2013-01-30 22:47:33 -0500] miah: so that explains some of the memory issues. but the jvm is more stable than mri and has proper threading..
[2013-01-30 22:47:49 -0500] robbkidd: Yep. I don't mind a little JRuby infiltration here.
[2013-01-30 22:48:14 -0500] robbkidd: "Look at how stable our log-agg is as compared to  all this other stuff."
[2013-01-30 22:48:18 -0500] miah: syslog-ng/rsyslog on hosts, then forward to a central server where logstash digests and aggregates to search
[2013-01-30 22:48:27 -0500] spheromak: ^^
[2013-01-30 22:48:29 -0500] josephholsten: robbkidd: are you mentioning log stash's memory footprint because you're using it for shipping?
[2013-01-30 22:48:31 -0500] robbkidd: That's what I'm thinkin'.
[2013-01-30 22:48:55 -0500] miah: iirc, there were also some micro implementations
[2013-01-30 22:48:55 -0500] josephholsten: we're using rsyslog as a shipper, log stash is just on the  indexing server here
[2013-01-30 22:48:58 -0500] spheromak: lets you use filters to pull stuff out from syslog and push into whatever other digestor
[2013-01-30 22:49:20 -0500] miah: https://github.com/jordansissel/lumberjack
[2013-01-30 22:49:21 -0500] spheromak: so you have collection/alerting/analytics all broken up
[2013-01-30 22:49:23 -0500] robbkidd: josephholsten: Yes. I've only just started tinkering with it so I was going with the default, easy config given in the logstash cookbook README. Looks like I'll be quickly moving to rsyslog -> logstash server.
[2013-01-30 22:49:58 -0500] miah: yup
[2013-01-30 22:50:15 -0500] josephholsten: if you want a more full featured shipper that isn't as big as a log stash agent, I've heard good things about this: https://github.com/josegonzalez/beaver
[2013-01-30 22:50:30 -0500] robbkidd: I'll look into that one, too. Thanks.
[2013-01-30 22:51:34 -0500] josephholsten: but I personally try to keep my clients working on a portable protocol, so I can switch to papertrail or splunk or whatever.
[2013-01-30 22:51:53 -0500] robbkidd: Yea. I figure that's where we'll end up.
[2013-01-30 22:54:19 -0500] miah: time to interview somebody. bbl
[2013-01-30 22:55:45 -0500] juliancdunn: can I use include_recipe within an LWRP?
[2013-01-30 23:03:46 -0500] juliancdunn: ok, I found out how, via a "def load_current_resource" block
[2013-01-30 23:22:32 -0500] mhalligan: Is it valid to put some logic in  a role? I want to set an attribute to be :graphite_host => search(node, "role:graphite-server")
[2013-01-30 23:22:44 -0500] mhalligan: (I know that's a bad assumption if we have multiple graphite-servers, but it's a reaonable starting point for now)
[2013-01-30 23:23:56 -0500] supster: Does anyone see anything wrong with or have improvements for this Upstart job? https://gist.github.com/4678285
[2013-01-30 23:27:06 -0500] juliancdunn: mhalligan: I'm not sure you can do that
[2013-01-30 23:28:05 -0500] log1kal: mhalligan: sadly, I tried to do that too.
[2013-01-30 23:28:09 -0500] mhalligan: log1kal: no love?
[2013-01-30 23:28:09 -0500] log1kal: it didn't work.
[2013-01-30 23:28:23 -0500] mhalligan: oh wellz
[2013-01-30 23:28:41 -0500] juliancdunn: roles are data, not logic
[2013-01-30 23:28:58 -0500] mhalligan: interesting, I thought the roles got evaluated and then created the json data
[2013-01-30 23:29:28 -0500] log1kal: roles get evaluated at the time they're uploaded to the chef-server, though. (afaik)
[2013-01-30 23:29:44 -0500] log1kal: you could do that logic in a meta-cookbook that calls the real cookbook
[2013-01-30 23:30:11 -0500] mhalligan: Ahh that makes sense.
[2013-01-30 23:30:31 -0500] mhalligan: probably makes more sense to just modify the statsd cookbook to have a role attribute and submit a pull request.
[2013-01-30 23:37:26 -0500] spheromak: mhalligan: do that search in your recipe. roles arn't intended to be anythign more than a container for run_lists
[2013-01-30 23:37:47 -0500] spheromak: you can just do a wrapper cook and do it there
[2013-01-30 23:37:57 -0500] spheromak: or yea fix the cook to solve your use case.
[2013-01-30 23:45:53 -0500] mhalligan: that makes sense I guess. mostly I've been trying to see how far I can get without writing site-recipes
[2013-01-30 23:46:44 -0500] mhalligan: so far I'm able to get about 90% of the way through configuring graphite/statsd/logstash/nrpe/sensu/elasticsearch without recipes so I'm quite pleased with this experiment.
[2013-01-30 23:47:11 -0500] mhalligan: any recommendations for a zabbix cookbook? https://github.com/laradji/zabbix was linked to from the community cookbook site .. but I never really trust the community cookbook site
[2013-01-30 23:53:30 -0500] kderr: Is there a way, in a recipe, to ask chef to die in its current run? If I do :stop, service[chef-client], it kills it in its tracks.
[2013-01-30 23:53:56 -0500] johnz: Does anyone have experience using knife-openstack to boot windows instances? I'm having a few problems
