[2013-01-25 00:04:10 -0500] miah: berks has a cookbook generator too
[2013-01-25 00:06:46 -0500] gswallow: I was creating a template like this:
[2013-01-25 00:07:07 -0500] c_t: What cookbook will it generate? Generate one, run it in production, and find out!
[2013-01-25 00:07:24 -0500] gswallow:      rc = Chef::RunContext.new(node, node.cookbook_collection)
[2013-01-25 00:07:25 -0500] gswallow:       t = Chef::Resource::Template.new "#{homedir}/.ssh/id_#{new_resource.type}"
[2013-01-25 00:07:34 -0500] gswallow: t.run_context=(rc)
[2013-01-25 00:07:38 -0500] gswallow: now that doesn't work.  wants some events thing
[2013-01-25 00:08:10 -0500] gswallow: why?
[2013-01-25 00:49:45 -0500] clundquist: Party people, I want to fix ohai to properly report VM memory under OpenVZ by parsing /proc/user_beancounters and multiplying the gaurenteed page count by the page size
[2013-01-25 00:49:55 -0500] clundquist: where should I put the code that does that?
[2013-01-25 00:50:15 -0500] clundquist: would plugins/linux/memory or plugins/linux/virtualization be better?
[2013-01-25 01:03:24 -0500] rteabeault: Is anyone using the concurrency option with knife ssh?  I am using 10.18.2 and if I execute a command against 3 nodes but set the concurrency to anything less than 3 it hangs.  For example if I set it to 1 then the command will get executed on one server and then it will hang.
[2013-01-25 01:21:35 -0500] miah: which ruby are you using?
[2013-01-25 01:25:06 -0500] cientifico: hi. I have this bug in chef 10.18.2 http://tickets.opscode.com/browse/CHEF-3324
[2013-01-25 01:27:40 -0500] cientifico: and sadly seems there is no solution
[2013-01-25 01:32:10 -0500] omarkj: Hey. I'm trying out knife ec2 with my IAM account, but am getting a SignatureDoesNotMatch error. Can't seem to find any documentation to help me out with it.
[2013-01-25 01:33:35 -0500] cientifico: BTW. chef-validator should not be an admin?
[2013-01-25 01:34:01 -0500] cientifico: I think so, in my installation, chef-validtor doesn't have the admin rights
[2013-01-25 01:34:13 -0500] cientifico: but feels strange
[2013-01-25 01:36:50 -0500] cientifico: the last bug of the day: merb : chef-server (api) : worker (port 4000) ~ Connection failed - user: chef - (Bunny::ProtocolError)
[2013-01-25 01:37:14 -0500] cientifico: I get randomly that error. The cpu io and mem of the machine are ok.
[2013-01-25 01:37:27 -0500] cientifico: restart rabbit doesn't seems to improve the situation.
[2013-01-25 01:37:31 -0500] cientifico: ;-(
[2013-01-25 01:43:26 -0500] jtran: anyone know how to force chef-client to use ruby1.9.3 instead of ruby 1.8.7 if both are installed on the system? (ubuntu).   I've tried update-alternatives --config ruby , and the OS defaults to the right one but chef-client doesn't
[2013-01-25 01:43:39 -0500] doomviking: rvm
[2013-01-25 01:43:47 -0500] clundquist: omnibus
[2013-01-25 01:44:10 -0500] miah: omnibus, rbenv, rvm, all valid options =)
[2013-01-25 01:44:27 -0500] clundquist: jtran: what init method are you using? the init script might have the path hard coded instead of /usr/bin/env ruby
[2013-01-25 01:44:35 -0500] clundquist: or something might
[2013-01-25 01:45:33 -0500] jtran: clundquist: init by hand
[2013-01-25 01:45:35 -0500] jtran: sudo chef-client
[2013-01-25 01:46:09 -0500] clundquist: I strongly suggest omnibus
[2013-01-25 01:46:17 -0500] jtran: clundquist: will do thanks!
[2013-01-25 01:47:13 -0500] doomviking: I strongly suggest beer.
[2013-01-25 01:47:16 -0500] clundquist: on rhel it gives an init script, on ubuntu it probably uses upstart, either way will use the embedded ruby 1.9.3 interpreter and ohai
[2013-01-25 01:47:22 -0500] jtran: yes, agreed with that too doomviking
[2013-01-25 01:49:32 -0500] clundquist: Anyone have thoughts on the above question about where to set $ohai memory/total for openvz guests?
[2013-01-25 01:49:58 -0500] clundquist: doing it linux/virtualization seems dirty as it sets a different namespace key
[2013-01-25 01:50:06 -0500] clundquist: but doing it in linux/memory seems wrong too
[2013-01-25 01:52:15 -0500] con: Hi. I was wondering what the accepted way in Chef is to ensure that no other files exist.
[2013-01-25 01:52:30 -0500] con: For example in a folder like sites-enabled, I only want the files I specify to exist, and no other.
[2013-01-25 01:53:29 -0500] clundquist: I would use a ruby_block or library function and do it in ruby
[2013-01-25 01:54:49 -0500] clundquist: alternatively, you could nuke the folder, and re-render, but that sucks
[2013-01-25 01:55:12 -0500] clundquist: or you could say it is a monitoring problem, and alert if there are extra configs
[2013-01-25 01:55:27 -0500] clundquist: none of those are great answers though
[2013-01-25 01:55:51 -0500] clundquist: for a question that is completely reasonable
[2013-01-25 01:56:02 -0500] con: Are there any examples you know of? I've written a whole lot of code to automatically fill in templates out of a hash of specified files, but I haven't found anything like that.
[2013-01-25 01:56:24 -0500] con: And I would assume it's a common need, so I was surprised.
[2013-01-25 01:56:26 -0500] clundquist: for apache2 or nginx?
[2013-01-25 01:56:52 -0500] clundquist: I wrote, https://github.com/bbg-cookbooks/nginx_vhost
[2013-01-25 01:57:03 -0500] clundquist: writing apache2_vhost would be largely the same
[2013-01-25 01:57:24 -0500] con: Not specifically for them. Just for any application that needs a variety of files written somewhere, and doing manual file blocks would be cumbersome.
[2013-01-25 01:58:40 -0500] clundquist: that doesn't remove the config files that it doesn't know about though, which was your original question
[2013-01-25 01:59:27 -0500] con: Indeed. But I was wondering about this too :)
[2013-01-25 02:00:55 -0500] clundquist: similarly there are: https://github.com/opscode-cookbooks/application_nginx and https://github.com/opscode-cookbooks/application
[2013-01-25 02:01:13 -0500] clundquist: I haven't use those myself though
[2013-01-25 02:01:20 -0500] clundquist: used*
[2013-01-25 02:03:38 -0500] con: Do you usually specify resources through data bags?
[2013-01-25 02:04:06 -0500] clundquist: I do yeah
[2013-01-25 02:05:01 -0500] clundquist: I have had bad experiences with chef-solo
[2013-01-25 02:05:09 -0500] clundquist: and recipe attributes overwriting each other
[2013-01-25 02:06:50 -0500] clundquist: and having them out of attributes means private data isn't in git
[2013-01-25 02:06:52 -0500] con: Same here. Also the fact that attributes pretend they act like primitives, but sometimes bug enourmously (for example not supporting .each on hashes).
[2013-01-25 02:16:19 -0500] clundquist: con: So if you were really good, you could do what you want
[2013-01-25 02:16:25 -0500] clundquist: LWRPs support state
[2013-01-25 02:16:36 -0500] clundquist: and if you have an LWRP for nginx config, you could load their state
[2013-01-25 02:16:54 -0500] clundquist: and you could action :destroy unless they were in the current run list
[2013-01-25 02:17:39 -0500] clundquist: I don't know if you are supposed to do that, but I thought about it earlier today for needing multiple redis instances
[2013-01-25 02:18:06 -0500] clundquist: because new_resource.to_hash gave me chef housekeeping stuff that broke my redis config template with things like "resource-name"
[2013-01-25 02:18:17 -0500] clundquist: so I declared state_attrs, and used new_resource.state
[2013-01-25 02:18:32 -0500] clundquist: I don't know if that is intended
[2013-01-25 02:22:26 -0500] con: So if I understant you correctly, suppose when doing this with nginx:
[2013-01-25 02:23:20 -0500] con: You create an nginx LWRP, and when declaring the resource you give a list of all required files. The provider then checks what files exist in the nginx config directories and removes those which are not in the list.
[2013-01-25 02:23:33 -0500] con: What is that state (hack?) for then?
[2013-01-25 02:23:57 -0500] clundquist: basically
[2013-01-25 02:24:31 -0500] clundquist: going back to your original question
[2013-01-25 02:24:57 -0500] clundquist: I think using mktmp, rendering your things, then moving it in place would be the best bang for buck
[2013-01-25 02:25:00 -0500] clundquist: but still isn't the greatest
[2013-01-25 02:25:09 -0500] clundquist: moving ( the folder ) into place
[2013-01-25 02:25:21 -0500] clundquist: doing it with the LWRP, yeah
[2013-01-25 02:25:47 -0500] clundquist: you would make a library function that loads everything in /etc/nginx/sites-enabled/
[2013-01-25 02:25:55 -0500] clundquist: as chef resources, with a default action of destroy
[2013-01-25 02:26:08 -0500] clundquist: and inspect your resource list to see if they should be action create
[2013-01-25 02:26:20 -0500] clundquist: I haven't tried that yet though
[2013-01-25 02:26:24 -0500] clundquist: so it might be a terrible idea
[2013-01-25 02:26:56 -0500] con: On a quest for non-terribles :)
[2013-01-25 02:27:17 -0500] con: I find that quite hard to do with Chef. Not much 'accepted practice' yet, or I'm searching in a wrong way.
[2013-01-25 02:27:37 -0500] con: But it's becoming a bit clearer with your code on Github.
[2013-01-25 02:29:02 -0500] clundquist: Here is what I mean by state_attrs https://github.com/bbg-cookbooks/chef-redis/blob/hw-bluebox/resources/instance.rb#L60-L95
[2013-01-25 02:29:30 -0500] clundquist: and then I render the template, based on that, https://github.com/bbg-cookbooks/chef-redis/blob/hw-bluebox/providers/instance.rb#L64
[2013-01-25 02:29:49 -0500] clundquist: it is a bit of a hack
[2013-01-25 02:30:12 -0500] clundquist: I should look and see what the File resource does for things like group / perms
[2013-01-25 02:32:51 -0500] cientifico: Ok. I regenerate the certificate for chef-validator almost 10 times today. Now I just tried with the validation.pem in the chef-server and worked. Any idea why that could happen? Thanks !
[2013-01-25 02:34:08 -0500] clundquist: con: it looks like Opscode solution is similar to one I described. make a temp version, then move it into place if they differ.
[2013-01-25 02:34:09 -0500] clundquist: https://github.com/opscode/chef/blob/master/lib/chef/scan_access_control.rb
[2013-01-25 02:34:36 -0500] clundquist: from https://github.com/opscode/chef/blob/master/lib/chef/provider/file.rb#L201
[2013-01-25 02:38:27 -0500] con: Alright. That looks reasonable.
[2013-01-25 02:39:01 -0500] con: Thanks for the find there.
[2013-01-25 02:39:06 -0500] clundquist: sure thing
[2013-01-25 02:47:37 -0500] con: As to the state thing, it doesn't seem to be an intended use to use state_attrs to feed all attribute values into a template. Documentation notes that is used by the chef "auditing system" (I don't know what that refers to)
[2013-01-25 02:48:18 -0500] con: But it seems strange that it's not possible to access all values from outside the class.
[2013-01-25 02:49:02 -0500] clundquist: one of the design goals of chef is to "only make the changes needed to a system"
[2013-01-25 02:49:03 -0500] con: Is resource.some_attr_name not accessible from outside?
[2013-01-25 02:49:39 -0500] clundquist: chris roberts wanted the template to be dynamic for that particular case
[2013-01-25 02:49:48 -0500] clundquist: the template is like
[2013-01-25 02:50:02 -0500] clundquist: <% new_resource.each do |key,value| %>
[2013-01-25 02:50:19 -0500] clundquist: <%= key %> <%= value %>
[2013-01-25 02:50:22 -0500] clundquist: <% end %>
[2013-01-25 02:50:28 -0500] clundquist: slightly more complicated, but basically that
[2013-01-25 02:50:40 -0500] clundquist: and if you do new_resource.to_hash
[2013-01-25 02:50:54 -0500] clundquist: you get things like the resource-name, retry-count, and things that break redis
[2013-01-25 02:51:33 -0500] clundquist: also, those settings in the config file, could be loaded and parsed into an object, and only the differing things would be saved
[2013-01-25 02:51:34 -0500] con: Define a wrapper around to_hash that filters even more FORBIDDEN_ATTRIBUTES out?
[2013-01-25 02:51:46 -0500] con: Err, IVARS
[2013-01-25 02:51:50 -0500] clundquist: *nod*
[2013-01-25 02:53:08 -0500] clundquist: if anyone here has thoughts about new_resource.state and how it is intended to be used, I would love to learn
[2013-01-25 02:59:30 -0500] carldanley: so I'm experimenting with Chef and vagrant atm - I have a basic setup atm ( https://github.com/carldanley/Chef-Ubuntu ) - how can I include my own sites for nginx
[2013-01-25 02:59:36 -0500] carldanley: is there a tutorial somewhere?
[2013-01-25 03:00:28 -0500] clundquist: your vhost configurations, or your cookbook?
[2013-01-25 03:00:39 -0500] clundquist: Well, I would suggest Berkshelf to manage your cookbooks
[2013-01-25 03:00:44 -0500] clundquist: it is like Bundler, but for cookbooks
[2013-01-25 03:00:59 -0500] clundquist: http://berkshelf.com/
[2013-01-25 03:01:39 -0500] clundquist: a similar alternative is librarian
[2013-01-25 03:01:49 -0500] clundquist: https://github.com/applicationsonline/librarian
[2013-01-25 03:02:01 -0500] carldanley: awesome, so I would create my own cookbook with the sites I need for nginx?
[2013-01-25 03:02:34 -0500] carldanley: i know php very well, not fam. with ruby too much
[2013-01-25 03:02:49 -0500] carldanley: so previously i ran vagrant with a provisioning shell script
[2013-01-25 03:02:51 -0500] clundquist: depending on what your goals are you could use https://github.com/bbg-cookbooks/nginx_vhost, or https://github.com/opscode-cookbooks/application_nginx
[2013-01-25 03:03:03 -0500] carldanley: i made the switch tonight to chef, loving it so far
[2013-01-25 03:03:07 -0500] carldanley: looking at those links
[2013-01-25 03:06:02 -0500] clundquist: If you want to live on the bleeding edge of hotness
[2013-01-25 03:06:04 -0500] clundquist: there is jamie-ci
[2013-01-25 03:06:28 -0500] clundquist: https://github.com/mdxp/nodejs-cookbook
[2013-01-25 03:06:42 -0500] clundquist: ^ an example of Jamie-CI, Berkshelf, and Vagrant in action
[2013-01-25 03:06:43 -0500] amagee: Hey, how can I automatically do the equivalent of doing "knife node edit mynode" and replacing a section of the json?
[2013-01-25 03:07:12 -0500] carldanley: thnx for the help so far clundquist
[2013-01-25 03:07:19 -0500] carldanley: have a ton of stuff to play with now
[2013-01-25 03:07:25 -0500] clundquist: sure thing
[2013-01-25 03:10:50 -0500] clundquist: amagee: knife node show --format=json $host > $host.json
[2013-01-25 03:11:07 -0500] clundquist: perl -pie s/find/replace/g host.json
[2013-01-25 03:11:16 -0500] clundquist: knife node from file $host.json
[2013-01-25 03:11:27 -0500] amagee: wow, ok
[2013-01-25 03:11:48 -0500] clundquist: if you need more fancy editing
[2013-01-25 03:11:51 -0500] clundquist: you could use ruby
[2013-01-25 03:11:54 -0500] clundquist: and JSON.parse
[2013-01-25 03:12:07 -0500] amagee: yeah
[2013-01-25 03:13:09 -0500] clundquist: that method work for you then?
[2013-01-25 03:13:26 -0500] amagee: yeah, it will work
[2013-01-25 03:13:33 -0500] amagee: just seems bizarrely convoluted
[2013-01-25 03:15:21 -0500] carldanley: clundquist: this stuff looks so foreign to me.. lol
[2013-01-25 03:15:40 -0500] carldanley: clundquist: i basically just want to add multiple sites to sites-available in nginx
[2013-01-25 03:16:18 -0500] carldanley: add the sites and the hosts records on the vm so I can map my comp to the vm for it to work
[2013-01-25 03:16:29 -0500] carldanley: is there some sort of tutorial for getting started on this?
[2013-01-25 03:16:38 -0500] carldanley: like a recommended one?
[2013-01-25 03:17:22 -0500] carldanley: i apologize in advance for the newbie questions clundquist
[2013-01-25 03:17:34 -0500] carldanley: im new to chef and ruby
[2013-01-25 03:18:52 -0500] clundquist: amagee, I don't know a better way to dump current state, edit, then upload
[2013-01-25 03:19:22 -0500] amagee: fair enough.. thanks for your help, this is working fine
[2013-01-25 03:19:40 -0500] clundquist: sure thing
[2013-01-25 03:20:11 -0500] clundquist: carldanley: I would use, https://github.com/bbg-cookbooks/nginx_vhost
[2013-01-25 03:20:17 -0500] clundquist: but I am partial to it since I wrote it the other dya
[2013-01-25 03:20:18 -0500] clundquist: day*
[2013-01-25 03:20:49 -0500] clundquist: if you include that recipe, it gives you a resource called "nginx_vhost"
[2013-01-25 03:20:59 -0500] omarkj: Just out of curiosity, does the chef-client report back to the server if a run fails ?
[2013-01-25 03:21:10 -0500] clundquist: omarkj: no
[2013-01-25 03:21:35 -0500] omarkj: clundquist: Okay, thanks.
[2013-01-25 03:21:42 -0500] carldanley: clundquist: do I need to remove my current submodule of nginx or just add this one?
[2013-01-25 03:22:33 -0500] clundquist: carldanley: that one just makes vhost configs, you'll need to install nginx using your favorite method and create the sites-enabled sites-available structure
[2013-01-25 03:23:03 -0500] carldanley: ok, let me add this submodule real quick
[2013-01-25 03:24:27 -0500] carldanley: clundquist: ok, its added - now where do I populate the vhost configs?
[2013-01-25 03:24:51 -0500] clundquist: there are 2 methods
[2013-01-25 03:25:02 -0500] clundquist: you can make your own cookbook that uses the LWRP ( resource from the cookbook)
[2013-01-25 03:25:08 -0500] clundquist: or use nginx_vhost::data_bag
[2013-01-25 03:25:22 -0500] clundquist: and put the attributes in data_bags and enable them in the run list
[2013-01-25 03:25:30 -0500] carldanley: nginx_vhost::data_bag seems easier but I have no idea what to do with it
[2013-01-25 03:25:40 -0500] clundquist: I'll write up an example
[2013-01-25 03:25:49 -0500] carldanley: thnx so much for the help
[2013-01-25 03:25:54 -0500] carldanley: this is invaluable
[2013-01-25 03:27:07 -0500] clundquist: hmm, do you have anything fancy like rewrite rules?
[2013-01-25 03:27:24 -0500] carldanley: for wordpress eventually
[2013-01-25 03:27:32 -0500] carldanley: but i can get that working later
[2013-01-25 03:28:04 -0500] carldanley: i think im understanding this better
[2013-01-25 03:28:22 -0500] carldanley: so u use the cookbooks to get the server going
[2013-01-25 03:28:39 -0500] carldanley: and use something like berkshire to create a cookbook that "configures" the vm?
[2013-01-25 03:29:04 -0500] clundquist: https://gist.github.com/f5ce2f871e4eebb9febb
[2013-01-25 03:29:23 -0500] clundquist: Berkshelf downloads cookbooks for you and their dependencies
[2013-01-25 03:29:31 -0500] clundquist: you used submodules which is a fine approach
[2013-01-25 03:29:46 -0500] clundquist: but tracking all the dependencies down, and keeping them updated can be challenging
[2013-01-25 03:29:52 -0500] clundquist: and Berkshelf does that for you
[2013-01-25 03:29:56 -0500] carldanley: thats awesome
[2013-01-25 03:30:08 -0500] clundquist: Berkshelf installs them to ~/.berkshelf/cookbooks
[2013-01-25 03:30:17 -0500] carldanley: thats pretty sweet
[2013-01-25 03:30:18 -0500] clundquist: then if you require "berkshelf/vagrant"
[2013-01-25 03:30:23 -0500] clundquist: in your Vagrantfile
[2013-01-25 03:30:32 -0500] clundquist: it will use the cookbooks you listed in your Berksfile
[2013-01-25 03:30:36 -0500] clundquist: and mount them in the VM
[2013-01-25 03:30:46 -0500] carldanley: thats pretty cool
[2013-01-25 03:31:05 -0500] carldanley: so ideally, thats a better solution because berkshire will handle tracking/updating them?
[2013-01-25 03:31:16 -0500] clundquist: yeah
[2013-01-25 03:31:19 -0500] clundquist: like rubygems does
[2013-01-25 03:31:27 -0500] carldanley: sweet
[2013-01-25 03:31:32 -0500] carldanley: for the gist
[2013-01-25 03:31:45 -0500] clundquist: err like, bundler does ( with rubygems)
[2013-01-25 03:31:47 -0500] carldanley: where would I place these JSON examples? in vagrantfile?
[2013-01-25 03:32:14 -0500] clundquist: http://docs.vagrantup.com/v1/docs/provisioners/chef_solo.html
[2013-01-25 03:32:23 -0500] carldanley: ok reading
[2013-01-25 03:32:35 -0500] clundquist: mkdir -p data_bags/nginx
[2013-01-25 03:33:02 -0500] clundquist: add "    chef.data_bags_path = "data_bags"" in the approprate locations
[2013-01-25 03:36:02 -0500] carldanley: ok added the data bag and the pathing
[2013-01-25 03:36:09 -0500] carldanley: for the node.json
[2013-01-25 03:36:17 -0500] carldanley: is that also contained within databags?
[2013-01-25 03:36:33 -0500] clundquist: node.json is there if you were just using chef-solo
[2013-01-25 03:36:35 -0500] clundquist: and not vagrant
[2013-01-25 03:36:39 -0500] clundquist: so half of that will be in
[2013-01-25 03:36:47 -0500] clundquist: add_recipe "nginx_vhost"
[2013-01-25 03:36:56 -0500] carldanley: ok
[2013-01-25 03:37:43 -0500] clundquist: and the other have will be in the Vagrantfile with "chef.json = { "nginx" = > {  "vhosts" => ["example.com"] } } "
[2013-01-25 03:38:39 -0500] clundquist: on a tangent
[2013-01-25 03:38:42 -0500] clundquist: take note of https://github.com/bbg-cookbooks/nginx_vhost/blob/master/templates/default/vhost.conf.erb
[2013-01-25 03:38:51 -0500] clundquist: if you need config options that aren't there, you'll have to pull request those
[2013-01-25 03:38:57 -0500] clundquist: like rewrites
[2013-01-25 03:39:24 -0500] carldanley: so question
[2013-01-25 03:39:47 -0500] carldanley: this cookbook, I can create multiple vhosts easily
[2013-01-25 03:39:54 -0500] clundquist: yep
[2013-01-25 03:39:57 -0500] carldanley: they all use the same server scaffold?
[2013-01-25 03:40:02 -0500] clundquist: yeah
[2013-01-25 03:40:20 -0500] carldanley: is there any way to tweak it to be able to create my own scaffolds
[2013-01-25 03:40:28 -0500] carldanley: and assign a site to a certain scaffold?
[2013-01-25 03:40:38 -0500] clundquist: elaborate on what you mean by scaffold
[2013-01-25 03:40:49 -0500] clundquist: erb templates?
[2013-01-25 03:40:54 -0500] carldanley: i think? sec
[2013-01-25 03:41:02 -0500] carldanley: yes
[2013-01-25 03:41:14 -0500] carldanley: L12-67 of that erb
[2013-01-25 03:41:31 -0500] carldanley: if I create a vhost it defaults to this erb template
[2013-01-25 03:41:37 -0500] clundquist: yeah
[2013-01-25 03:41:44 -0500] carldanley: any way I could assign specific templates to specific vhosts?
[2013-01-25 03:42:01 -0500] carldanley: giving me the options to independently customize vhosts configs
[2013-01-25 03:42:46 -0500] clundquist: so, that template gets rendered for each data_bag item you have enabled
[2013-01-25 03:42:53 -0500] clundquist: so you can change SSL certs per vhost and all that
[2013-01-25 03:42:55 -0500] carldanley: yup
[2013-01-25 03:43:05 -0500] clundquist: but if that template is no where near what you need
[2013-01-25 03:43:11 -0500] clundquist: then it won't help
[2013-01-25 03:43:16 -0500] clundquist: but that should cover most basic cases
[2013-01-25 03:43:22 -0500] carldanley: thats what I was wondering
[2013-01-25 03:43:29 -0500] carldanley: is it easy to tweak the cookbook
[2013-01-25 03:43:43 -0500] carldanley: this would be awesome:
[2013-01-25 03:43:49 -0500] carldanley: if you setup a vhost
[2013-01-25 03:43:51 -0500] carldanley: example.com
[2013-01-25 03:43:59 -0500] carldanley: you should be able to supply a template
[2013-01-25 03:44:12 -0500] carldanley: if there is none, default to default-template.erb
[2013-01-25 03:44:21 -0500] clundquist: hmm
[2013-01-25 03:44:23 -0500] clundquist: you could do that
[2013-01-25 03:44:26 -0500] carldanley: if you assign it, it looks for whatever-you-assigned.erb
[2013-01-25 03:44:30 -0500] clundquist: but it seems like if you need that customized of a templates
[2013-01-25 03:44:37 -0500] clundquist: you might as well use cookbook_file
[2013-01-25 03:44:44 -0500] clundquist: and copy the config as a file, instead of a template
[2013-01-25 03:44:45 -0500] carldanley: what is cookbook_file?
[2013-01-25 03:45:10 -0500] clundquist: http://wiki.opscode.com/display/ChefCN/Resources#Resources-CookbookFile
[2013-01-25 03:45:14 -0500] clundquist: basically cp
[2013-01-25 03:45:25 -0500] clundquist: copies a file out of your files directory in your cookbook
[2013-01-25 03:45:28 -0500] clundquist: and puts it somewhere
[2013-01-25 03:45:39 -0500] carldanley: thats exactly it!
[2013-01-25 03:45:41 -0500] carldanley: ok
[2013-01-25 03:45:44 -0500] carldanley: so ideally
[2013-01-25 03:45:58 -0500] carldanley: id like to be able to include these files somewhere in a subdir like databags
[2013-01-25 03:46:12 -0500] clundquist: yeah, you can
[2013-01-25 03:46:12 -0500] carldanley: and then have it copied to the nginx sites-available
[2013-01-25 03:46:16 -0500] carldanley: bomb
[2013-01-25 03:46:19 -0500] carldanley: u are the man
[2013-01-25 03:46:22 -0500] clundquist: make your own cookbook named
[2013-01-25 03:46:37 -0500] clundquist: "mycompany-vhosts"
[2013-01-25 03:46:44 -0500] clundquist: then in files/ drop them there
[2013-01-25 03:46:48 -0500] carldanley: how do i make a cookbook?
[2013-01-25 03:46:52 -0500] carldanley: i can google
[2013-01-25 03:47:02 -0500] clundquist: knife cookbook create -o . super_awesome
[2013-01-25 03:47:11 -0500] carldanley: really? thats awesome
[2013-01-25 03:47:15 -0500] carldanley: let me make one
[2013-01-25 03:47:41 -0500] carldanley: knife cookbook create -o where cookbook = cookbook name?
[2013-01-25 03:48:15 -0500] clundquist: knife cookbook create help
[2013-01-25 03:48:17 -0500] clundquist: :)
[2013-01-25 03:48:22 -0500] clundquist: but yes
[2013-01-25 03:48:30 -0500] clundquist: -o where <name>
[2013-01-25 03:48:32 -0500] carldanley: i gotta install knife haha
[2013-01-25 03:48:37 -0500] clundquist: gem install knife
[2013-01-25 03:48:43 -0500] clundquist: no-ri --no-rdoc
[2013-01-25 03:49:48 -0500] carldanley: ERROR:  could not find gem knife locally or in a repository
[2013-01-25 03:49:59 -0500] carldanley: googling
[2013-01-25 03:50:15 -0500] clundquist: gem install chef
[2013-01-25 03:50:24 -0500] clundquist: I thought it was a unique gem
[2013-01-25 03:50:27 -0500] clundquist: my mistake
[2013-01-25 03:50:46 -0500] clundquist: there are knife plugins that are unique gems
[2013-01-25 03:51:38 -0500] carldanley: ( installing )
[2013-01-25 03:51:54 -0500] carldanley: so im putting chef on my local dev to create a cookbook and make that available on something like git
[2013-01-25 03:52:04 -0500] carldanley: where my co-workers could pull it in via submodule
[2013-01-25 03:52:09 -0500] carldanley: right?
[2013-01-25 03:52:18 -0500] carldanley: they dont need to gem install chef?
[2013-01-25 03:52:30 -0500] clundquist: nope
[2013-01-25 03:52:36 -0500] carldanley: awesome
[2013-01-25 03:52:40 -0500] carldanley: clundquist: do you drink beer?
[2013-01-25 03:52:41 -0500] clundquist: as long as your virtual machine has it installed
[2013-01-25 03:52:50 -0500] clundquist: carldanley: yes
[2013-01-25 03:53:01 -0500] carldanley: are there sites where I can buy you a beer?
[2013-01-25 03:53:34 -0500] clundquist: not that I know of, mostly do to the nature of beer being a restricted substance, so mailing it to addresses is difficult to validate
[2013-01-25 03:54:01 -0500] carldanley: i totally would sir, i really appreciate the help
[2013-01-25 03:54:15 -0500] clundquist: If you're near seattle we can meet up then
[2013-01-25 03:54:25 -0500] carldanley: im in FL
[2013-01-25 03:54:29 -0500] clundquist: how did you hear about chef?
[2013-01-25 03:54:41 -0500] clundquist: I was thinking about going to West Palm Beach to see friends
[2013-01-25 03:54:51 -0500] clundquist: either that or Hawaii
[2013-01-25 03:54:52 -0500] carldanley: my coworker and I are trying to standardize our local dev environments for our company
[2013-01-25 03:54:57 -0500] carldanley: WPB is awesome
[2013-01-25 03:55:05 -0500] clundquist: virtualbox + chef is a good route
[2013-01-25 03:55:12 -0500] carldanley: i love it so far
[2013-01-25 03:55:21 -0500] carldanley: im getting an awesome crash course
[2013-01-25 03:55:23 -0500] carldanley: =P
[2013-01-25 03:55:24 -0500] clundquist: based on my experience, I would suggest giving people "premade" boxes
[2013-01-25 03:55:31 -0500] clundquist: where you use vagrant package
[2013-01-25 03:55:35 -0500] carldanley: thats what we're trying to use
[2013-01-25 03:55:43 -0500] clundquist: and have your build procedure use chef
[2013-01-25 03:55:49 -0500] carldanley: yup!
[2013-01-25 03:55:56 -0500] clundquist: I guess my point is
[2013-01-25 03:55:57 -0500] carldanley: so we're trying to get everything nailed down
[2013-01-25 03:56:03 -0500] clundquist: don't make your end users use vagrant provision
[2013-01-25 03:56:18 -0500] carldanley: we want them to be able to just vagrant up
[2013-01-25 03:56:19 -0500] carldanley: or w.e
[2013-01-25 03:56:22 -0500] clundquist: yeah
[2013-01-25 03:56:23 -0500] carldanley: and have options they need
[2013-01-25 03:56:28 -0500] carldanley: not have to worry about things
[2013-01-25 03:56:38 -0500] carldanley: but that requires him and I learn it
[2013-01-25 03:56:40 -0500] clundquist: ssl key forward, and port forward 80 to 8080
[2013-01-25 03:56:43 -0500] clundquist: yeah
[2013-01-25 03:56:51 -0500] clundquist: ssh key forward*
[2013-01-25 03:57:14 -0500] carldanley: oh good call
[2013-01-25 03:57:18 -0500] carldanley: so VM uses local ssh keys?
[2013-01-25 03:57:23 -0500] clundquist: yeah
[2013-01-25 03:57:31 -0500] clundquist: I deploy to production from inside my VMs
[2013-01-25 03:57:48 -0500] clundquist: I got tired of stopping memcache/ rabbitmq/ mysql/ mongo/ redis/ ....
[2013-01-25 03:57:48 -0500] carldanley: i need xcode for gem?
[2013-01-25 03:58:00 -0500] carldanley: thats awesome clundquist
[2013-01-25 03:58:13 -0500] carldanley: ya we work for 10up
[2013-01-25 03:58:18 -0500] carldanley: 10up.com
[2013-01-25 03:58:33 -0500] carldanley: we do alot of wordpress work
[2013-01-25 03:58:42 -0500] carldanley: need to have something standardized
[2013-01-25 03:58:46 -0500] clundquist: yep
[2013-01-25 03:58:56 -0500] clundquist: OS X isn't RHEL
[2013-01-25 03:59:10 -0500] clundquist: tell me about your xcode gem question
[2013-01-25 03:59:12 -0500] clundquist: what are you really trying to do
[2013-01-25 03:59:19 -0500] carldanley: gem install chef errored out
[2013-01-25 03:59:38 -0500] clundquist: do you have a c compiler?
[2013-01-25 03:59:44 -0500] carldanley: http://d.pr/i/CDd
[2013-01-25 04:00:07 -0500] carldanley: on mac
[2013-01-25 04:00:12 -0500] carldanley: i think xcode tools should do it
[2013-01-25 04:00:15 -0500] carldanley: let me google it
[2013-01-25 04:00:18 -0500] clundquist: you need ot install the cli tools
[2013-01-25 04:00:53 -0500] clundquist: http://www.opscode.com/chef/install/
[2013-01-25 04:00:56 -0500] clundquist: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-01-25 04:00:59 -0500] clundquist: install chef with that
[2013-01-25 04:01:17 -0500] clundquist: and you won't need the C build deps
[2013-01-25 04:01:29 -0500] clundquist: all knife cookbook create does is make some folders
[2013-01-25 04:01:38 -0500] clundquist: so you might not need it
[2013-01-25 04:02:19 -0500] carldanley: im taking notes on all this stuff btw
[2013-01-25 04:02:32 -0500] carldanley: will prob skype my coworker tomorrow morning =P
[2013-01-25 04:02:34 -0500] clundquist: so that curl command I gave you installs "omnibus"
[2013-01-25 04:03:03 -0500] clundquist: https://github.com/opscode/omnibus-chef
[2013-01-25 04:03:24 -0500] carldanley: is that a good thing?
[2013-01-25 04:03:31 -0500] clundquist: yeah
[2013-01-25 04:03:50 -0500] clundquist: it gives you chef and everything it needs to run precompiled
[2013-01-25 04:04:07 -0500] carldanley: awesome
[2013-01-25 04:04:58 -0500] carldanley: its still going i think
[2013-01-25 04:05:05 -0500] carldanley: no progress bar =/ lol
[2013-01-25 04:05:26 -0500] clundquist: once you run the curl command, it should be in your path
[2013-01-25 04:05:32 -0500] clundquist: chef-solo -v to check
[2013-01-25 04:05:42 -0500] clundquist: I think latest is 10.18.2 or something
[2013-01-25 04:06:56 -0500] carldanley: take awhile normally?
[2013-01-25 04:07:06 -0500] clundquist: usually about 30 seconds on RHEL
[2013-01-25 04:07:14 -0500] clundquist: I use the gem on OS X
[2013-01-25 04:08:52 -0500] carldanley: let me show u
[2013-01-25 04:08:53 -0500] carldanley: sec
[2013-01-25 07:08:13 -0500] cdown: Hi -- a colleague of mine has set up a Chef recipe for an APT cache which isn't working. I commented out the code in the ERB template, but it's still coming back the same on the client. Does the client maintain a local cache? What do I have to do to get the client to recognise that the recipe changed? Thanks :-)
[2013-01-25 07:08:24 -0500] cdown: FTR: I have no clue with Chef. :-(
[2013-01-25 07:08:41 -0500] cdown: I would ask him to change it, but of course this is the day he decides to take vacation...
[2013-01-25 07:08:58 -0500] Mithrandir: did you upload the recipe to the chef server?
[2013-01-25 07:08:59 -0500] flaccid: not sure why you would do a recipe for apt cache
[2013-01-25 07:09:07 -0500] flaccid: cite code and errors
[2013-01-25 07:09:09 -0500] cdown: I have no idea, it's his recipe
[2013-01-25 07:09:13 -0500] cdown: The only error is that the file doesn't change.
[2013-01-25 07:09:33 -0500] cdown: It has /etc/apt/apt.conf.d/02proxy which contains APT proxy information, which I commented out in the recipe on the server but it doesn't replicate it to the client
[2013-01-25 07:09:47 -0500] cdown: Mithrandir: I changed the recipe on the server itself
[2013-01-25 07:09:57 -0500] flaccid: thats not the apt cache.
[2013-01-25 07:10:18 -0500] Mithrandir: cdown: you need to upload it using knife cookbook $name
[2013-01-25 07:10:30 -0500] cdown: On the server?
[2013-01-25 07:10:43 -0500] clundquist: cdown: yes, the client downloads a copy from chef-server
[2013-01-25 07:10:47 -0500] flaccid: anywhere, usually not on the server
[2013-01-25 07:11:20 -0500] clundquist: ^ knife cookbook upload $name
[2013-01-25 07:11:44 -0500] cdown: Yeah, I got that from the error message ;-)
[2013-01-25 07:11:54 -0500] cdown: Seems to have done something on the server, will try now...
[2013-01-25 07:12:15 -0500] clundquist: if you send SIGUSR1 to the daemon it will kick it
[2013-01-25 07:12:23 -0500] clundquist: and if you tail -f /var/log/chef/client.log
[2013-01-25 07:12:27 -0500] clundquist: you can watch it download the new version
[2013-01-25 07:12:51 -0500] cdown: It downloads from the server, but the server appears to serve a copy from before I edited the file.
[2013-01-25 07:13:10 -0500] cdown: There's no /var/log/chef directory.
[2013-01-25 07:13:14 -0500] flaccid: afaik you don't edit the cookbook cache on the server right clundquist ?
[2013-01-25 07:13:15 -0500] cdown: (on the client)
[2013-01-25 07:13:22 -0500] clundquist: is the role or environment pinned to a cookbook version?
[2013-01-25 07:13:30 -0500] cdown: not afaik.
[2013-01-25 07:13:45 -0500] clundquist: you have your cookbook checked out, hopefully it is in a repo
[2013-01-25 07:13:49 -0500] clundquist: on your dev machine
[2013-01-25 07:13:51 -0500] clundquist: you do your changes
[2013-01-25 07:13:54 -0500] clundquist: you run your tests
[2013-01-25 07:13:57 -0500] clundquist: you get sign off
[2013-01-25 07:14:09 -0500] clundquist: then you say, $ knife cookbook upload <name>
[2013-01-25 07:14:09 -0500] cdown: like i say, he deals with that. i don't touch chef
[2013-01-25 07:14:16 -0500] cdown: my workstation has a key to bootstrap machines, if that can also do it, i can do that.
[2013-01-25 07:14:29 -0500] clundquist: yeah that will do it
[2013-01-25 07:14:53 -0500] clundquist: if you can't knife cookbook upload will give you "permission denied"
[2013-01-25 07:14:59 -0500] cdown: So `knife cookbook download foo'?
[2013-01-25 07:15:06 -0500] cdown: then edit, then upload?
[2013-01-25 07:15:12 -0500] clundquist: that will work
[2013-01-25 07:15:18 -0500] clundquist: but download will get it from the server
[2013-01-25 07:15:27 -0500] clundquist: and not from github or  where ever
[2013-01-25 07:15:42 -0500] clundquist: different companies use different work flows
[2013-01-25 07:15:48 -0500] cdown: It's not on GitHub as far as I know.
[2013-01-25 07:15:56 -0500] clundquist: k, then download it is
[2013-01-25 07:16:11 -0500] clundquist: be sure to rev the version in metadata.rb
[2013-01-25 07:16:16 -0500] flaccid: its in the cloud!
[2013-01-25 07:17:58 -0500] clundquist: it is all around us
[2013-01-25 07:19:07 -0500] cdown: It now claims that my pem file is not readable.
[2013-01-25 07:20:10 -0500] clundquist: sudo chown `whoami`: /path/to/pem
[2013-01-25 07:20:12 -0500] clundquist: ?
[2013-01-25 07:20:20 -0500] cdown: stat shows file perms are fine
[2013-01-25 07:20:54 -0500] cdown: 0600, my user.
[2013-01-25 07:20:58 -0500] clundquist: sounds right
[2013-01-25 07:21:12 -0500] clundquist: are you using open source chef server, hosted, private?
[2013-01-25 07:21:30 -0500] cdown: whichever one is the most difficult i guess ;-)
[2013-01-25 07:21:41 -0500] clundquist: if it isn't open source chef server , you can generate another pem
[2013-01-25 07:21:44 -0500] cdown: i believe we're using the open source one on our intenal
[2013-01-25 07:21:49 -0500] cdown: s/intenal/internal/
[2013-01-25 07:22:02 -0500] clundquist: does
[2013-01-25 07:22:03 -0500] clundquist: knife node list
[2013-01-25 07:22:05 -0500] clundquist: return data?
[2013-01-25 07:22:33 -0500] cdown: Complains about my key again
[2013-01-25 07:22:43 -0500] clundquist: cd /tmp
[2013-01-25 07:22:45 -0500] clundquist: and try again
[2013-01-25 07:22:51 -0500] clundquist: you might have a knife.rb in pwd
[2013-01-25 07:23:02 -0500] cdown: `chef --version' is Chef Server (API) Version: 10.16.6
[2013-01-25 07:23:19 -0500] cdown: Still complains in /tmp.
[2013-01-25 07:23:26 -0500] cdown: Which is strange, because I use this key to `knife bootstrap',
[2013-01-25 07:24:05 -0500] clundquist: knife bootstrap using validator.pem to sign the client.pem on first chef-client run
[2013-01-25 07:24:06 -0500] clundquist: I think
[2013-01-25 07:24:08 -0500] clundquist: I could be wrong there
[2013-01-25 07:24:18 -0500] clundquist: which would be different than a node/user pem
[2013-01-25 07:24:24 -0500] cdown: Ah, okay
[2013-01-25 07:24:46 -0500] clundquist: you may be boned without your coworker
[2013-01-25 07:27:54 -0500] cdown: that seems to be the case
[2013-01-25 07:28:14 -0500] clundquist: I don't know your set up, and I would hate to break things further from ignorance
[2013-01-25 07:28:27 -0500] cdown: yeah, that's probably sage.,
[2013-01-25 07:28:37 -0500] clundquist: :/
[2013-01-25 07:28:48 -0500] cdown: All I can get out of whyrun is
[2013-01-25 07:28:57 -0500] cdown: "would touch" for that file, and "would update utime"
[2013-01-25 07:29:09 -0500] clundquist: what is it that you are actually trying to do?
[2013-01-25 07:29:09 -0500] cdown: which i guess implies that it won't actually download anything new, just update the existing attribs
[2013-01-25 07:29:49 -0500] cdown: my colleague put in a file in apt.conf.d that configures apt to use an apt proxy, which doesn't work. i commented this out on the server in /var/chef/cookbook/..., but it doesn't seem to stick on the client
[2013-01-25 07:30:31 -0500] clundquist: ouch
[2013-01-25 07:30:31 -0500] cdown: he is very... "hey guys, let's use chef!"
[2013-01-25 07:30:38 -0500] cdown: except the only problem is that nobody else has any clue what they are doing
[2013-01-25 07:30:43 -0500] cdown: i don't know if you get that vibe from me ;-)
[2013-01-25 07:31:33 -0500] clundquist: how many nodes?
[2013-01-25 07:31:53 -0500] clundquist: in a perfect world, you would push a fix to chef-server
[2013-01-25 07:31:56 -0500] clundquist: via knife cookbook upload
[2013-01-25 07:32:08 -0500] clundquist: in a crappy world where you don't have access at 2:30 am
[2013-01-25 07:32:18 -0500] clundquist: you might stop chef-client and comment out the proxy
[2013-01-25 07:32:18 -0500] cdown: well, he has chef doing all of our developer boxes
[2013-01-25 07:32:21 -0500] cdown: about 10.
[2013-01-25 07:32:33 -0500] cdown: which is irritating as hell because when devs want to do something, suddenly chef reverts it
[2013-01-25 07:32:37 -0500] clundquist: ah, at least it isn't production
[2013-01-25 07:32:40 -0500] cdown: not chef's fault, just why on earth he is using chef for this... argh
[2013-01-25 07:32:51 -0500] clundquist: because he wants your dev env to resemble prod
[2013-01-25 07:33:27 -0500] cdown: except for it's not difficult to make it resemble prod, we have one debian package which sets up our entire system
[2013-01-25 07:34:46 -0500] cdown: it would make sense in a production environment perhaps. but it's kind of hilarious because we don't use it there.
[2013-01-25 07:34:56 -0500] clundquist: ouch
[2013-01-25 07:35:12 -0500] cdown: instead we use it on developer machines, and we're a betting site, so loads of maths geeks are constantly screwing around, as they should be
[2013-01-25 07:35:19 -0500] cdown: and then chef gets called by a cron job and goes "lol bye"
[2013-01-25 07:35:57 -0500] clundquist: sudo service chef-client stop
[2013-01-25 07:35:59 -0500] clundquist: :/
[2013-01-25 07:36:07 -0500] flaccid: cdown: your problem is that the person who implemented chef provided no support
[2013-01-25 07:36:24 -0500] clundquist: or teaching
[2013-01-25 07:36:49 -0500] flaccid: aka education
[2013-01-25 07:36:58 -0500] cdown: yes.
[2013-01-25 07:37:03 -0500] cdown: like i say, he basically said "let's use chef".
[2013-01-25 07:37:05 -0500] flaccid: totally poor IT management there my friend
[2013-01-25 07:37:17 -0500] clundquist: what is the best way to teach coworkers about chef?
[2013-01-25 07:37:19 -0500] cdown: hey you think i don't know that ;-)
[2013-01-25 07:37:24 -0500] cdown: i am but a lowly unix sysadmin...
[2013-01-25 07:37:26 -0500] clundquist: there are the slides from opscode
[2013-01-25 07:37:36 -0500] clundquist: any other good resources?
[2013-01-25 07:37:37 -0500] flaccid: there are many resources
[2013-01-25 07:37:47 -0500] cdown: only problem is i am already 2 days behind on SCRUM
[2013-01-25 07:37:48 -0500] flaccid: rtfm is always good
[2013-01-25 07:37:55 -0500] cdown: so i am pretty much out of time for RTFM :-D
[2013-01-25 07:38:01 -0500] cdown: but thanks for helping me as much as you did anyway.
[2013-01-25 07:38:04 -0500] flaccid: bad management :(
[2013-01-25 07:39:25 -0500] cdown: thanks though. i want to learn chef, it seems nice. just right now i have nfi what i'm doing and of course our infrastructure depends on it (yay!)
[2013-01-25 07:39:37 -0500] cdown: so thanks. have a nice day :-)
[2013-01-25 07:39:59 -0500] flaccid: you too y0
[2013-01-25 07:41:59 -0500] clundquist: I'm curious because I'm in the opposite position, I want to teach 63 people, who don't want to learn
[2013-01-25 07:42:07 -0500] cdown: please hire me
[2013-01-25 07:42:22 -0500] cdown: it would be much easier.
[2013-01-25 07:42:24 -0500] cdown: ;-)
[2013-01-25 07:42:40 -0500] cdown: o/
[2013-01-25 07:42:45 -0500] clundquist: best of luck
[2013-01-25 11:14:58 -0500] mting923: Hi there? Any experts of using Berkshelf + vagrant on Windows?
[2013-01-25 11:15:36 -0500] mting923: I have a permission denied issue which switching my base box using the same vagrantfile.
[2013-01-25 11:15:46 -0500] mting923: config.vm.box = "win2k8x64"   # config.vm.box = "win2k8v2"
[2013-01-25 11:16:17 -0500] mting923: like if I use win2k8x64 , it works, but when I swithc to win2k8v2 ,it failed...
[2013-01-25 11:16:36 -0500] mting923: my berkshelf file line: cookbook "pingdom", github: "cwjohnston/chef-pingdom", ref: "0.0.3", protocol: "https"
[2013-01-25 11:48:40 -0500] cpasmoi: Damned, I didn't see ohai was not in the $PATH on my Debian stable servers... I hope chef can access to ohai information, like plateform_version
[2013-01-25 11:50:07 -0500] cpasmoi: (platform_version)
[2013-01-25 12:09:55 -0500] cassianoleal: anyone installing rvm via chef?
[2013-01-25 12:29:50 -0500] jeekl: Can I set a timeout-value for the git resource? I keep getting 'command timed out' on checking out a huge repo with a bunch of submodules... :-/
[2013-01-25 12:29:59 -0500] yfeldblum: cassianoleal, plenty of people, i assume
[2013-01-25 12:33:07 -0500] cassianoleal: yfeldblum: I'm having trouble using it on Ubuntu. A new ruby installation hangs. I investigated and found out that it hangs on an apt-get run, waiting for me to confirm the installation of the packages, which I obviously can't anyone seen the same?
[2013-01-25 12:34:10 -0500] yfeldblum: cassianoleal, how are you trying to install ruby?
[2013-01-25 12:35:50 -0500] cassianoleal: via recipe rvm::system
[2013-01-25 12:37:08 -0500] yfeldblum: cassianoleal, which cookbook?
[2013-01-25 12:38:06 -0500] cassianoleal: yfeldblum: http://github.com/fnichol/chef-rvm
[2013-01-25 12:38:18 -0500] cassianoleal: it was working flawlessly
[2013-01-25 12:38:37 -0500] cassianoleal: I believe a new version of RVM was released, but I don't know how to check that
[2013-01-25 12:39:41 -0500] yfeldblum: cassianoleal, a new version of RVM or a new version of the Fletcher Nichol's RVM cookbook?
[2013-01-25 12:40:37 -0500] cassianoleal: yfeldblum: could be any, but I have the cookbook pinned down to "~> 0.9", which is the same as before
[2013-01-25 12:40:52 -0500] cassianoleal: unless a minor update of the cookbook broke it, it must be rvm
[2013-01-25 12:43:45 -0500] yfeldblum: cassianoleal, how can you tell it's the rvm::system recipe?
[2013-01-25 12:49:36 -0500] cassianoleal: yfeldblum: that's the only place in my run list that tries to install ruby via RVM :) Also, I ran chef with a debug log level and I could see where it hung. Repeating the process done by Chef I found the problem of apt-get waiting for user interaction: https://gist.github.com/4626106
[2013-01-25 12:57:28 -0500] cassianoleal: yfeldblum: weird thing is that it happens on a newly created EC2 instance from a clean Ubuntu AMI, but it doesn't on a local VM with a clean ubuntu install...
[2013-01-25 12:57:46 -0500] cassianoleal: hmmm, no spoke too son it's hanging on the local VM now as well
[2013-01-25 12:57:54 -0500] yfeldblum: cassianoleal, try preinstalling those packages?
[2013-01-25 12:58:03 -0500] itchyouch: Hello all.  I was wondering how the cron LWRP implanted jobs.  Does it just drop a file into /etc/cron.d?
[2013-01-25 12:58:44 -0500] itchyouch: Or does it end up editing /etc/crontab file for respective users?
[2013-01-25 12:58:53 -0500] cassianoleal: yfeldblum: yeah, that's what I'm looking into right now, but it just feels wrong :)
[2013-01-25 12:59:09 -0500] leifmadsen: morning all!  I'm using the directory resource to create a set of directories recursively, (chef 10.16.2), and I end up with the following:  http://pastebin.com/qBtVTpiP
[2013-01-25 12:59:29 -0500] leifmadsen: basically, the top directory that gets created is marked as root, even though I have owner and group set differently, and recursive true
[2013-01-25 13:00:46 -0500] cassianoleal: leifmadsen: you're not creating the top directory, you're only setting owner and group for the "/etc" part
[2013-01-25 13:00:58 -0500] cassianoleal: leifmadsen: try creating the top directory first, then the /etc one
[2013-01-25 13:01:14 -0500] cassianoleal: or setting ownership on review_site after the fact
[2013-01-25 13:01:21 -0500] leifmadsen: hmmm, documentation seems to indicate it should go all the way down... just seems weird
[2013-01-25 13:01:41 -0500] leifmadsen: ya, just wanted to make sure I wasn't running into a bug, which this almost appears to be
[2013-01-25 13:01:43 -0500] cassianoleal: leifmadsen: if it did, it would have to change ownership and permissions of your root directory  not a good idea
[2013-01-25 13:02:00 -0500] leifmadsen: well it's creating the review_site directory, so I don't understand why it isn't set as well
[2013-01-25 13:02:14 -0500] leifmadsen: the /home/gerrit2/ site doesn't change, and is the same owner/group
[2013-01-25 13:02:23 -0500] leifmadsen: (as what I'm setting in the resource)
[2013-01-25 13:03:04 -0500] leifmadsen: seems odd that /home/gerrit2/review_site/etc, where the dirs being created are review_site and etc in an existing directory, would have the first created directory be set as root:root
[2013-01-25 13:03:15 -0500] cassianoleal: the review_site doesn't change either. it's created as root and stays that way. $HOME had already been created and you didn't explicitly tell chef to change it
[2013-01-25 13:03:35 -0500] yfeldblum: itchyouch, https://github.com/opscode/chef/blob/master/lib/chef/provider/cron.rb
[2013-01-25 13:03:59 -0500] leifmadsen: but review_site is being created, so I don't understand why it wouldn't create it with the o/g I defined in the resource...
[2013-01-25 13:05:51 -0500] cassianoleal: leifmadsen: think of the directory resource as doing a "mkdir -p $dest" (the -p because you set recursive to true), and then chown and chmod on $dest
[2013-01-25 13:06:05 -0500] cassianoleal: that's probably what it's actually doing, but I haven't checked the implementation
[2013-01-25 13:06:07 -0500] leifmadsen: cassianoleal: ah that makes a bit more sense I suppose
[2013-01-25 13:06:11 -0500] leifmadsen: fair enough
[2013-01-25 13:06:14 -0500] cassianoleal: :)
[2013-01-25 13:06:34 -0500] leifmadsen: it still seems.... if not a bug, then perhaps unexpected behaviour :)
[2013-01-25 13:06:42 -0500] leifmadsen: I could see it being argued either way
[2013-01-25 13:06:57 -0500] leifmadsen: anyways, thanks for the info, I'll adjust my recipe accordingly
[2013-01-25 13:07:10 -0500] cpasmoi: Hum, if ohai on Debian is not on the $PATH (it's installed in /var/lib/gems/1.8/bin/ohai ), can chef-client use it ? Like platform_version
[2013-01-25 13:07:13 -0500] cassianoleal: yeah, I had this same impression when I started using it, but couldn't think of a better way afterwards :)
[2013-01-25 13:07:18 -0500] itchyouch: Thanks yfeldblum.  Judging by the code, it seems to just use the crontab command which should edit the respective /etc/crontab file.  I think I will go with managing a Cronjob file deployed via cookbook_file into /etc/cron.d
[2013-01-25 13:07:51 -0500] cpasmoi: I'm in a strange case where a package is installed, but the apt_pinning which is executed in a conditionnal block, is not done.
[2013-01-25 13:39:28 -0500] nacer: cpasmoi: it depends witch ruby exec your chef-client
[2013-01-25 13:40:12 -0500] nacer: cpasmoi: if you are using chef as gem executed with the native ruby1.8 it should be
[2013-01-25 13:41:46 -0500] cpasmoi: chef has been installed via gem, yes (no apt package)
[2013-01-25 14:18:12 -0500] giorgian: hi. windows_registry fails creating a registry key if current user lacks write permission a parent key; is there a way to check if we have permission and grant permission if needed?
[2013-01-25 15:08:11 -0500] heathsnow: Does anyone know the syntax for bootstrapping nodes based on search terms?  For instance role:Windows AND chef_environment:production
[2013-01-25 15:10:05 -0500] cpasmoi: damn ! seems like indeed, chef-client cannot use gem ohai as it is not in the $PATH... better link ohai in /usr/bin :x
[2013-01-25 15:10:20 -0500] maruq: hi guys
[2013-01-25 15:11:47 -0500] gchristensen: hi, I'm having an issue spawning from MySQL getting a different user id when installing (on Ubuntu 12.04) and causing files not to be owned by them. Is there a way to force the mysql user to have a consistent user ID across services? should I create the MySQL user first, then install the packages?
[2013-01-25 15:12:19 -0500] maruq: just wondering, what's the current best practice as far as installing a gem & then using it in a recipe?
[2013-01-25 15:13:06 -0500] maruq: are we still going with the runaction(:install); Gem.clearpaths route?
[2013-01-25 15:13:35 -0500] maruq: or is there a better way than running things in the compilation stage (feels tacky)
[2013-01-25 15:13:48 -0500] maruq: *hacky. damn autocorrect
[2013-01-25 15:32:57 -0500] jannel_: has the node registered itself to the chef server?
[2013-01-25 15:33:22 -0500] smckenna: yes
[2013-01-25 15:33:30 -0500] CaptTofu: howdy!
[2013-01-25 15:33:36 -0500] jannel_: hmm, weird
[2013-01-25 15:33:45 -0500] CaptTofu: anyone: I'm trying to get "::Chef::Recipe.send(:include, Opscode::OpenSSL::Password)" to work in a recipe and not having luck. It gives an error when running
[2013-01-25 15:34:04 -0500] CaptTofu: is there a pre-requisite to this working?
[2013-01-25 15:35:45 -0500] smckenna: yeah i don't see any other node data missing, just the run list
[2013-01-25 16:53:36 -0500] gchristensen: Hi, when I run chef-client -W it says: "Would alter user user[mysql]" - this worries me, is there a way to determine more information about what it would alter?
[2013-01-25 16:58:56 -0500] judd7: report handlers question:  why NOT enable them in client.rb?  I have a large environment, and I want to ensure that it's run EACH AND EVERY time.
[2013-01-25 16:59:03 -0500] wickett: still seeing errors on our end calling hosted chef but http://status.opscode.com shows things are back to normal
[2013-01-25 17:01:02 -0500] wickett: anyone else seeing error rates calling api.opscode.com/organizations/X/nodes/X
[2013-01-25 17:01:20 -0500] wickett: ?
[2013-01-25 17:01:33 -0500] Drewzar: wickett: http://status.opscode.com/
[2013-01-25 17:01:55 -0500] wickett: yeah
[2013-01-25 17:02:00 -0500] wickett: Drewzar: I saw that
[2013-01-25 17:02:26 -0500] wickett: but I would say that it isn't 'resolved'
[2013-01-25 17:03:15 -0500] Drewzar: Nope, it says it still "recovering"
[2013-01-25 17:03:30 -0500] wickett: ok
[2013-01-25 17:04:00 -0500] wickett: good point
[2013-01-25 17:04:10 -0500] Drewzar: and that was like 8 mins ago
[2013-01-25 17:04:29 -0500] wickett: I guess I am impatient :)
[2013-01-25 17:05:19 -0500] wickett: will check back in a bit
[2013-01-25 17:11:34 -0500] c_t: jtimberman: was there some ssh key compromise or something?
[2013-01-25 17:12:24 -0500] Babar: c_t: check the news. Especially github.
[2013-01-25 17:12:26 -0500] magoo_: does anyone know if there's an ohai plugin for getting aws data? specifically, I need to pull region
[2013-01-25 17:12:28 -0500] Afterglow: I think github turned on search, if you searched for id_rsa you got like 44 pages of private keys
[2013-01-25 17:12:43 -0500] c_t: aw shit
[2013-01-25 17:13:57 -0500] Babar: you can still find the same on your favorite search engine, like: google id_rsa site:github.com
[2013-01-25 17:14:42 -0500] c_t: oh wait, is it just github keys inside repositories?
[2013-01-25 17:15:03 -0500] Babar: just?
[2013-01-25 17:15:13 -0500] c_t: oh, that's bad enough, mind you
[2013-01-25 17:15:38 -0500] c_t: what I meant was is it ssh keys inside repositories, or also the ones you upload for deploying and such
[2013-01-25 17:30:58 -0500] ekristen: my chef.couchdb is 5.9gb in size!  I do not have that many servers, anyway to clean this up?
[2013-01-25 17:32:20 -0500] cwj: ekristen: theres a compaction job that needs to be run periodically
[2013-01-25 17:32:48 -0500] cwj: http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server
[2013-01-25 17:33:24 -0500] ekristen: just saw that
[2013-01-25 17:34:19 -0500] wickett: Still seeing errors on the API
[2013-01-25 17:34:37 -0500] cwj: ekristen: fyi, if you are currently in a full disk situation you will need to free up space before the compaction can succeed
[2013-01-25 17:35:07 -0500] ekristen: cwj: yeah that is what I am trying to figure out how to do
[2013-01-25 17:35:14 -0500] ekristen: do I just compact the entire database?
[2013-01-25 17:35:27 -0500] ekristen: one I have cleared up some diskspace?
[2013-01-25 17:35:33 -0500] cwj: yes
[2013-01-25 17:35:43 -0500] _0x783czar: Can someone help me understand the output I'm getting from this chef-run?  Everything seems to be working, but I'm seeing a bunch of warnings I've never seen before.  I wonder if it's a new thing with version 10.18.2?  Here's a selection from my chef-run output: http://pastebin.com/vQm82qwU
[2013-01-25 17:36:18 -0500] ekristen: hrm, I guess I might have to add another drive to this system to be able to compact
[2013-01-25 17:36:58 -0500] koblas: is opscode down - getting a 502 error - on hosted chef server.
[2013-01-25 17:38:33 -0500] ekristen: cwj: is there any way to find out when the compacting is done?
[2013-01-25 17:39:25 -0500] cwj: ekristen: perhaps in the couchdb server log? its been a while for me so im not sure
[2013-01-25 17:39:58 -0500] ekristen: hrm I think I need more disk space for this to work, crap!
[2013-01-25 17:40:14 -0500] cwj: _0x783czar: http://tickets.opscode.com/browse/CHEF-3771 may be related?
[2013-01-25 17:40:22 -0500] cwj: _0x783czar: but it is marked as fixed in 10.18.2
[2013-01-25 17:41:11 -0500] flip__: When using the service resource, it seems that it adds a cookbook_name attribute. Is there any way to change what this attribute resolves to? its resolving to the cookbook that i'm refering to it with, not the one that its in...
[2013-01-25 17:41:13 -0500] mmgaggle_: erkules: GET request your database, it'll show "compact_running": true
[2013-01-25 17:41:39 -0500] mmgaggle_: or false, if it's done
[2013-01-25 17:41:41 -0500] cwj: maybe you are seeing the results of the changes in http://tickets.opscode.com/browse/CHEF-3694
[2013-01-25 17:42:17 -0500] mmgaggle_: cwj: http://wiki.apache.org/couchdb/HTTP_database_API#Database_Information
[2013-01-25 17:42:45 -0500] cwj: _0x783czar: is the recipe in question looping over a resource with a static name as illustrated in http://tickets.opscode.com/browse/CHEF-3694 ?
[2013-01-25 17:44:00 -0500] cwj: _0x783czar:  i bet you are creating a ruby_block[write_authorized_keys] resource for every user and can avoid those warnings by making it something like ruby_block[write_authorized_keys_for_#{username}]
[2013-01-25 17:44:23 -0500] mmgaggle_: ekristen: whoops, that link i sent to cwj was for you
[2013-01-25 17:44:31 -0500] mmgaggle_: re: compaction
[2013-01-25 17:44:50 -0500] ekristen: mmgaggle_: yeah I am just completely out of diskspace
[2013-01-25 17:44:52 -0500] ekristen: is my issue
[2013-01-25 17:45:01 -0500] ekristen: I'm working on that now
[2013-01-25 17:45:30 -0500] maek: erkules: FWIW : curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact
[2013-01-25 17:45:43 -0500] maek: ekristen: ^ rather
[2013-01-25 17:45:47 -0500] maek: erkules: sorry to ping
[2013-01-25 17:46:41 -0500] _0x783czar: cwj: ah, I do believe that is right.  I thought I had removed all issues like that.  I remember in the past chef had a tendency to ignore duplicates like that, sometimes so I generally tried to avoid it.  I like that it's throwing the warnings now.  I'll go and give that a fix.
[2013-01-25 17:46:45 -0500] ekristen: thanks! as soon as I get my disk size issues figured out
[2013-01-25 17:47:07 -0500] kreedy: Anyone seeing memory leaking with chef-client 10.18.2 (omnibus install, ubuntu 12.04, amd64). It was using ~1.5GB of RAM on a very small infrastructure. Only had this version on three boxes (10.16.x on everything else)
[2013-01-25 17:47:20 -0500] kreedy: still have it running on 1 of the 3 boxes if anyone wants me to poke around
[2013-01-25 17:47:53 -0500] maek: ekristen: good point. cant compact with 0 disk. kill /var/log* with fire ;)
[2013-01-25 17:48:12 -0500] ekristen: maek: var/log is small, not enough space
[2013-01-25 17:49:55 -0500] kreedy: also getting ERROR: Server returned error for https://api.opscode.com/organizations/belly/reports/nodes/node.example.com/runs. may or may not be related
[2013-01-25 17:50:00 -0500] _0x783czar: kreedy: I'm just seeing it use about 400MB
[2013-01-25 17:50:19 -0500] kreedy: it is using about 200MB after restart
[2013-01-25 17:50:43 -0500] kreedy: it was using 1.5GB before restart. the machine has only been up for 2 days
[2013-01-25 17:51:41 -0500] flip__: Anyone have a suggestion?
[2013-01-25 17:52:13 -0500] flip__: Regarding my service resource question?
[2013-01-25 17:53:33 -0500] gchristensen: is there any way to get more details about what is going to happen when it says "Would alter user user[mysql]" in a why-run?
[2013-01-25 18:01:43 -0500] cassianoleal: how can I check the actual output (stdout/sterr) of what Chef is currently doing? I'm trying to debug a stuck recipe, but setting the log level to debug gives me the command where it hung at best.
[2013-01-25 18:02:06 -0500] cassianoleal: I tried running the command on the shell and it works, so I wanted to know what's happening at the time of the hng
[2013-01-25 18:02:50 -0500] _0x783czar: cwj: So I was able to remove some of the warnings, however I'm seeing that I still have some warnings because I have two identical resources in two different cookbooks.  They're directory resources and they're ensuring that a certain directory exists.  They both need to exist in case the cookbooks are not used together.  Any ideas on how to avoid the warning?
[2013-01-25 18:07:52 -0500] ekristen: crap, couch db seems to crash when I want to compact! :/
[2013-01-25 18:14:40 -0500] ekristen: I have plenty of diskspace now but couch is crashing on compact -- http://pastebin.com/9bB5TSxG
[2013-01-25 18:18:40 -0500] ekristen: OMG, all that work for compact to take 10 seconds
[2013-01-25 18:18:41 -0500] ekristen: lo
[2013-01-25 18:18:53 -0500] ekristen: lol
[2013-01-25 18:18:53 -0500] ekristen: blarg
[2013-01-25 18:21:53 -0500] jvbe: ekristen thx for the mongo cookbook ;-)
[2013-01-25 18:22:10 -0500] ekristen: jvbe: np, did it work for you?
[2013-01-25 18:22:14 -0500] jvbe: it didn't work unfortunately
[2013-01-25 18:22:21 -0500] ekristen: really?
[2013-01-25 18:22:32 -0500] jvbe: Unable to reconfigure replicaset, retrying in 30 seconds
[2013-01-25 18:22:32 -0500] jvbe: [2013-01-25T18:21:19+00:00] WARN: exception: _id may not change for members
[2013-01-25 18:22:47 -0500] cwj: _0x783czar: thats an interesting question. not sure what i would do there.
[2013-01-25 18:22:49 -0500] ekristen: hrm, you standing up multiple systems at once
[2013-01-25 18:22:52 -0500] jvbe: but this is maybe due to the existing set built by the other script
[2013-01-25 18:22:58 -0500] ekristen: ah
[2013-01-25 18:23:03 -0500] ekristen: jvbe: yeah that would be the problem
[2013-01-25 18:23:05 -0500] jvbe: i had the same error earlier when i ran
[2013-01-25 18:23:17 -0500] jvbe: the command to change the replset manually
[2013-01-25 18:23:29 -0500] ekristen: this script has to be the one to setup the replica set because it does some funky stuff to make sure that it creates unique _id for each member
[2013-01-25 18:23:37 -0500] jvbe: smart :)
[2013-01-25 18:23:38 -0500] cwj: _0x783czar: i think you could set the name to "foo cookbook ensures /path/to/dir" and then set the path attribute manually
[2013-01-25 18:23:55 -0500] jvbe: i almost wrote the same code
[2013-01-25 18:24:05 -0500] jvbe: luckily your mail popped up
[2013-01-25 18:24:12 -0500] jvbe: will recreate my 3 servers
[2013-01-25 18:24:14 -0500] cwj: which mongodb cookbook is this?
[2013-01-25 18:24:25 -0500] _0x783czar: cwj: yeah, that's what I was thinking.  Thanks
[2013-01-25 18:25:07 -0500] jvbe: cwj: Markus Korn <markus.korn@edelight.de>
[2013-01-25 18:28:08 -0500] Suny: hi
[2013-01-25 18:28:47 -0500] Suny: facing this error NameError: Cannot find a resource for web on amazon version 2012.03
[2013-01-25 18:28:59 -0500] Suny: with loading the object from s3
[2013-01-25 18:29:05 -0500] Suny: *while
[2013-01-25 18:29:12 -0500] Suny: any help?
[2013-01-25 18:29:38 -0500] doomviking: drink more coffee
[2013-01-25 18:30:53 -0500] doomviking: or provide more details
[2013-01-25 18:30:56 -0500] doomviking: or both
[2013-01-25 18:32:17 -0500] Suny: i have a war file laoded on s3
[2013-01-25 18:47:58 -0500] autholykos: ohai chefs!
[2013-01-25 18:48:31 -0500] autholykos: I am using vagrant provisioned with chef
[2013-01-25 18:48:57 -0500] autholykos: and everything was working fine until I tried to startup multiple VMs from vagrant
[2013-01-25 18:49:19 -0500] autholykos: now I am crushing my head against the 401 authorization issue
[2013-01-25 18:49:51 -0500] autholykos: I have been deleting client, node, restarted chef-server
[2013-01-25 18:50:04 -0500] autholykos: recreated different clients and tried those
[2013-01-25 18:50:16 -0500] autholykos: reverted to a single vagrant VM
[2013-01-25 18:50:31 -0500] autholykos: deleting the chef-validator on couchdb
[2013-01-25 18:50:34 -0500] autholykos: nothing helped
[2013-01-25 18:51:05 -0500] autholykos: is there anything obvious that I am missing here? I am starting to be a bit frustrated
[2013-01-25 18:53:57 -0500] kallistec: autholykos: do you have a working admin client?
[2013-01-25 18:54:05 -0500] autholykos: yes
[2013-01-25 18:54:25 -0500] autholykos: 'knife client list' works there
[2013-01-25 18:55:10 -0500] autholykos: and the offending client is not listed
[2013-01-25 18:55:12 -0500] ptrstr: kallistec: hosted chef is down/slow?..keeps retrying
[2013-01-25 18:55:20 -0500] kallistec: autholykos: if you `knife client show` the validator, does it show the public key?
[2013-01-25 18:56:18 -0500] autholykos: kallistec: nope, I was in the middle of creating another one
[2013-01-25 18:56:20 -0500] kallistec: ptrstr: http://status.opscode.com
[2013-01-25 18:57:00 -0500] btm: @opscode Cookbook review, join: http://bit.ly/Vno3d8 watch: http://youtu.be/-kgbXHptxvU #opschef
[2013-01-25 18:57:38 -0500] autholykos: kallistec: created a key called apollo8. knife client show apollo8 shows correctly the key
[2013-01-25 18:57:50 -0500] ptrstr: kallistec: handy
[2013-01-25 18:58:18 -0500] kallistec: autholykos: since you deleted the validator from the database, you should try deleting the validator key from /etc/chef and restarting chef-server
[2013-01-25 18:58:58 -0500] autholykos: kallistec: I tried that many time, I am going to do it once again
[2013-01-25 18:59:43 -0500] kallistec: autholykos: you should end up with the correct key in /etc/chef on the chef-server box
[2013-01-25 19:00:00 -0500] kallistec: you can use this knife plugin I wrote to verify the key against the public key:
[2013-01-25 19:00:00 -0500] kallistec: https://github.com/danielsdeleo/knife-plugins/blob/master/key_check.rb
[2013-01-25 19:01:29 -0500] autholykos: kallistec: thanks, I'll try that
[2013-01-25 19:01:30 -0500] btm: timsmith: by the way, we secretly changed the time for the cookbook review if you want to come join us for nagios review. :) sorry.
[2013-01-25 19:02:11 -0500] timsmith: I think it's a conspiracy
[2013-01-25 19:02:33 -0500] btm: timsmith: jtimberman made me change it due to something to do with 'mountain time'
[2013-01-25 19:10:38 -0500] jtran: hey all.   i have a role called 'single-controller' that has a run list of about 15 other roles, one being 'keystone'.    I've added role[single_controller] to 'server1'.  if i do a knife show server1, i clearly  see a role 'keystone' in the 'roles' list.    However, if i issue a  'knife search node "role:keystone"' , it shows up 0 results
[2013-01-25 19:11:29 -0500] jtran: 0 items found
[2013-01-25 19:11:45 -0500] jtran: is that intended behavior?
[2013-01-25 19:16:13 -0500] logikal: jtran: use 'knife search node "roles:keystone"'
[2013-01-25 19:16:26 -0500] logikal: 'roles' searches the expanded runlust
[2013-01-25 19:16:28 -0500] logikal: runlist*
[2013-01-25 19:16:30 -0500] jtran: logikal: ahhh stupid me.  thanks
[2013-01-25 19:17:25 -0500] fly9: anyone using chef with virtualenvwrapper?
[2013-01-25 19:22:10 -0500] dysinger_: fly9: I'm using virtualenv & virtualenv-bin
[2013-01-25 19:24:52 -0500] oddover: Hi chefs. I have a fairly easy question. I created a cookbook that mounts filesystems, sets permissions on some of them, etc. My original name for the cookbook was 'filesystems', and I had attributes in node['filesystems']. The issue is that ohai gives stuff in node['filesystem'] and I don't want people to get confused. What could be another name for that cookbook?
[2013-01-25 19:25:50 -0500] clundquist: it seems like the mount resource should take care of more of that
[2013-01-25 19:26:22 -0500] log1kal: oddover_filesystems, fs_prep, etc?
[2013-01-25 19:26:27 -0500] oddover: it does, but the idea is someone can define some attributes in the .json file, and those attributes will be used to mount the filesystems (using the mount resource)
[2013-01-25 19:27:04 -0500] oddover: fs_prep might be a good name for it
[2013-01-25 19:28:25 -0500] xuru: howdy   is there a way to get the elastic ip of a node from within a cookbook recipe?
[2013-01-25 19:29:03 -0500] clundquist: can you do it from the command line?
[2013-01-25 19:29:27 -0500] xuru: not on the node
[2013-01-25 19:29:39 -0500] clundquist: chef-server?
[2013-01-25 19:30:37 -0500] xuru: I don't think so, unless I put my ec2 secrets in a data bag which I don't really want to do
[2013-01-25 19:30:48 -0500] clundquist: there are encrypted databags
[2013-01-25 19:30:51 -0500] clundquist: but understandable
[2013-01-25 19:31:26 -0500] xuru: I was hoping for something in an ohai plugin or something
[2013-01-25 19:31:42 -0500] xuru: or even an ec2 tag
[2013-01-25 19:31:48 -0500] dysinger_: fog
[2013-01-25 19:32:08 -0500] xuru: that too would require my credentials
[2013-01-25 19:32:10 -0500] clundquist: https://github.com/karmi/cookbook-elasticsearch/blob/master/recipes/aws.rb
[2013-01-25 19:32:45 -0500] xuru: hmm
[2013-01-25 19:32:45 -0500] dysinger_: how do you get ec2 data without creds ?
[2013-01-25 19:33:38 -0500] xuru: I wonder if it would show up in something like whatsmyip.net?
[2013-01-25 19:33:52 -0500] dysinger_: wait a minute
[2013-01-25 19:34:06 -0500] dysinger_: when you attach an EIP to a node, it changes it's public IP address
[2013-01-25 19:34:11 -0500] dysinger_: which is right there in ohai data
[2013-01-25 19:36:08 -0500] nlloyds2: xuru: I have a cookbook that simulates node.cloud: https://github.com/cramerdev/multi-home-cookbook
[2013-01-25 19:37:01 -0500] xuru: yeah, no node['ec2']
[2013-01-25 19:37:01 -0500] nlloyds2: ymmv
[2013-01-25 19:37:02 -0500] dysinger_: what's wrong with ec2.public_ipv4 ?
[2013-01-25 19:37:02 -0500] dysinger_: that's dirt simple - requires zero lines of code
[2013-01-25 19:37:11 -0500] xuru: dysinger_: there is no ec2.public_ipv4
[2013-01-25 19:37:33 -0500] dysinger_: ohai automatically puts it there if you are on ec
[2013-01-25 19:37:34 -0500] dysinger_: ec2
[2013-01-25 19:37:53 -0500] xuru: dysinger_: not in a VPC
[2013-01-25 19:37:53 -0500] dysinger_: this was your question right? "howdy  is there a way to get the elastic ip of a node from within a cookbook recipe?"
[2013-01-25 19:38:08 -0500] dysinger_: oic
[2013-01-25 19:38:32 -0500] xuru: nlloyds2: that wont work either.  The ips on the interfaces are all internal ips
[2013-01-25 19:38:56 -0500] xuru: The elastic IP is nowhere in the ohai data
[2013-01-25 19:39:08 -0500] dysinger_: ah... that's why they called it public_ipv4
[2013-01-25 19:39:10 -0500] dysinger_: ?!
[2013-01-25 19:39:26 -0500] dysinger_: it's not the internal ip
[2013-01-25 19:39:54 -0500] siezer: ps, the node['cloud']['public_ipv4'] is more portable
[2013-01-25 19:39:54 -0500] xuru: yeah, on a regular ec2 instance it has both.  In a VPC it ONLY has an internal ip
[2013-01-25 19:40:05 -0500] dysinger_: crazy
[2013-01-25 19:40:12 -0500] dysinger_: probably because  VPN
[2013-01-25 19:40:20 -0500] siezer: its all about the ec2 metadata servers, baby
[2013-01-25 19:40:27 -0500] xuru: but you can assign elastic IP to them and get to them that way
[2013-01-25 19:40:30 -0500] xuru: without vpn
[2013-01-25 19:41:47 -0500] xuru: so, to reiterate, there is no 'cloud' or 'ec2' attribute on the node and ohai data on an ec2 instance in a VPC that is assigned an elastic ip
[2013-01-25 19:42:35 -0500] dysinger_: time to write some ohai plugins then I would think & probably not a way around at least having creds for a read-only IAM user.
[2013-01-25 19:42:47 -0500] xuru: aha, I think I got it though  without having to put the elastic ip in a role or something
[2013-01-25 19:42:57 -0500] xuru: require "net/http"; Net::HTTP.get_print("www.myexternalip.com", "/raw")
[2013-01-25 19:43:06 -0500] xuru: that actually worked
[2013-01-25 19:44:42 -0500] xuru: The reason I need this (if anyone was wondering), is that I have a monitoring server in a VPC but want to use the same server for external (to the VPC) servers as well
[2013-01-25 19:44:48 -0500] josephholsten: if you look here: tim@dysinger.net
[2013-01-25 19:44:51 -0500] josephholsten: nope
[2013-01-25 19:45:00 -0500] josephholsten: here: https://github.com/opscode/ohai/blob/master/lib/ohai/mixin/ec2_metadata.rb#L66
[2013-01-25 19:45:24 -0500] josephholsten: you'll see that it's making a call to request that metadata
[2013-01-25 19:45:45 -0500] xuru: ah, but I would still need to set that metadata by hand correct?
[2013-01-25 19:46:01 -0500] josephholsten: the question is: what's the appropriate endpoint in your VPC? I doubt they don't provide it
[2013-01-25 19:46:18 -0500] xuru: yeah, good question
[2013-01-25 19:46:49 -0500] xuru: I could try it and see if it works ;)
[2013-01-25 19:47:05 -0500] josephholsten: this api is documented here: http://docs.aws.amazon.com/AWSEC2/2007-03-01/DeveloperGuide/AESDG-chapter-instancedata.html
[2013-01-25 19:48:18 -0500] xuru: josephholsten: I'll have a look thanks
[2013-01-25 19:50:43 -0500] josephholsten: actually, I bet the /2008-02-01/meta-data endpoint is just too old for vpc. curl http://169.254.169.254/ for all the api versions
[2013-01-25 19:51:29 -0500] xuru: yeah, used 1012-01-12
[2013-01-25 19:51:38 -0500] xuru: and I got back is 404 not found
[2013-01-25 19:52:00 -0500] xuru: curl "http://169.254.169.254/2012-01-12/meta-data/i-xxxxxxxx" -o -
[2013-01-25 19:52:31 -0500] josephholsten: this is interesting also: http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AESDG-chapter-instancedata.html
[2013-01-25 19:53:35 -0500] josephholsten: (btw: i'm hoping you'll get this done before I have to migrate my disposable instances to aws vpc next month)
[2013-01-25 19:54:29 -0500] autholykos: kallistec: your knife plugin returns an error: ERROR: ArgumentError: can't get const Chef::ApiClient: uninitialized constant Chef::ApiClient
[2013-01-25 19:56:10 -0500] xuru: josephholsten: well, the myexternalip.com call does give the external ip, although it's not elegant
[2013-01-25 19:57:55 -0500] josephholsten: can you file a ticket though? I'll have to get back to it regardless.
[2013-01-25 19:59:45 -0500] xuru: sure, against ohai?  I'm not really sure it's possible  I know there are a lot of tickets for knife ec2 to support VPC stuff, perhaps that's a better venue
[2013-01-25 20:03:48 -0500] blasdelf1: what's the best way for a cookbook to check if it's being run in chef-solo?
[2013-01-25 20:04:47 -0500] josephholsten: Chef::Config[:solo]
[2013-01-25 20:05:03 -0500] blasdelf1: thanks!
[2013-01-25 20:05:27 -0500] josephholsten: I always forget, but but an example is available in the food critic check for supporting solo: http://acrmp.github.com/foodcritic/#FC003
[2013-01-25 20:06:30 -0500] blasdelf1: that's some terrific documentation
[2013-01-25 20:15:33 -0500] dotslash: Any suggestions for getting chef-server installed in a closed environment that doesn't have access to the internet?
[2013-01-25 20:16:29 -0500] dotslash: Is there any type of uber package to install everything that doesn't require downloading a bunch of individual packages over the internet?
[2013-01-25 20:16:50 -0500] matschaffer1: maybe build everything in a VM with next access available then run it in the closed env?
[2013-01-25 20:19:32 -0500] spox: dotslash: you could go for chef11 and grab an omnibus install of one of the nightlys
[2013-01-25 20:19:33 -0500] kaerast: oh I'm sure security would love a random VM downloaded from the internet running in your secure network
[2013-01-25 20:19:53 -0500] dotslash: Hm... That's a good idea, but it wouldn't work in our situation.
[2013-01-25 20:20:11 -0500] dotslash: So how does the chef11 omnibus differ from the 10.x version?
[2013-01-25 20:22:21 -0500] BigBassettHound: Hi all.  I was wondering if anyone could tell me how to get the IPv4 address of the local machine when using chef-solo
[2013-01-25 20:24:38 -0500] timsmith: node['ipaddress']
[2013-01-25 20:25:15 -0500] BigBassettHound: @timsmith - that seems to return the ipV6 on our boxes
[2013-01-25 20:26:44 -0500] timsmith: you can see the complete list of what would get returned by running sudo ohai | less
[2013-01-25 20:27:02 -0500] timsmith: there's probably an ipv4 specific attribute
[2013-01-25 20:27:16 -0500] BigBassettHound: thanks - does ohai work on windows in chef-solo?
[2013-01-25 20:27:30 -0500] timsmith: that's an excellent question
[2013-01-25 20:27:30 -0500] BigBassettHound: i am getting a complaint about not being able to read
[2013-01-25 20:27:33 -0500] ranjibd: BigBassettHound, yes,
[2013-01-25 20:27:33 -0500] BigBassettHound: client.pem
[2013-01-25 20:27:49 -0500] timsmith: ohai isn't directly tied to chef
[2013-01-25 20:27:54 -0500] timsmith: so you should be able to just run ohai
[2013-01-25 20:27:57 -0500] timsmith: from a command prompt
[2013-01-25 20:28:00 -0500] ranjibd: BigBassettHound, chef needs ohai to get system information, so,.,ohai is a must
[2013-01-25 20:28:01 -0500] timsmith: but I've never done it on windows
[2013-01-25 20:28:35 -0500] BigBassettHound: trying.....
[2013-01-25 20:28:47 -0500] ranjibd: without ohai, chef wont be able to determine what provider to use (like wont be able to decide whether to use apt or yum for package)
[2013-01-25 20:29:07 -0500] BigBassettHound: ok - i just heard of ohai a few minutes ago
[2013-01-25 20:29:25 -0500] ranjibd: ohai network/interfaces/<interface name>/addresses , should give you all the address
[2013-01-25 20:29:35 -0500] BigBassettHound: so all those ohai attributes end up in the node attribute tree?
[2013-01-25 20:29:51 -0500] BigBassettHound: or do i need to run it and then load the json or something
[2013-01-25 20:29:52 -0500] ranjibd: from chef recipes, this can be accessed as, node.network.interfaces.eth0.addresses
[2013-01-25 20:29:59 -0500] ranjibd: yes,
[2013-01-25 20:30:31 -0500] ranjibd: node attributes that are coming from ohai are grouped in a category called automatic category.. and you cant override them
[2013-01-25 20:31:48 -0500] BigBassettHound: so like node['network']['interfaces']['0xa']['ipaddress'] or something like that, huh?
[2013-01-25 20:32:39 -0500] ranjibd: BigBassettHound,  'addresses'
[2013-01-25 20:32:44 -0500] ranjibd: yes
[2013-01-25 20:32:53 -0500] ranjibd: you can check them in command line
[2013-01-25 20:32:57 -0500] timsmith: anyone had an issues deleting cron jobs using the cron attribute.  I have the following cron job # Chef Name: munin-graphite * * * * * /usr/local/bin/munin-graphite.rb 127.0.0.1 2> /dev/null > /dev/null
[2013-01-25 20:32:58 -0500] ranjibd: directly , using ohai
[2013-01-25 20:33:11 -0500] timsmith: I tried to remove it with cron "munin-graphite" and action delete
[2013-01-25 20:33:13 -0500] timsmith: no go
[2013-01-25 20:33:23 -0500] BigBassettHound: thanks - i'll try it
[2013-01-25 20:33:44 -0500] ranjibd: BigBassettHound, when running ohai from command line, attribute nesting is done via /
[2013-01-25 20:34:02 -0500] ranjibd: so, `ohai network/interfaces`
[2013-01-25 20:34:16 -0500] ranjibd: timsmith, did you change the name of the cron resource by any chance?
[2013-01-25 20:34:47 -0500] timsmith: I'm just looking at what's it's called in this file
[2013-01-25 20:34:51 -0500] timsmith: and trying to remove it using that name
[2013-01-25 20:36:04 -0500] magoo_: how can i notify ohai to refresh node data during a chef run?
[2013-01-25 20:37:33 -0500] siezer: magoo_ https://github.com/someara/fqdn-cookbook/blob/master/recipes/rhel.rb#L61
[2013-01-25 20:40:06 -0500] magoo_: siezer: thanks... this is probably my lack of understanding, but i'm trying to rerun ohai as a whole, and not just a plugin. I'm writing /etc/chef/ohai/ec2.json because ohai will pull aws data into the node attributes if it sees that file
[2013-01-25 20:40:25 -0500] magoo_: so i have under the file resource
[2013-01-25 20:40:54 -0500] magoo_: notifies :reload, 'ohai', :immediately
[2013-01-25 20:42:03 -0500] magoo_: it throws an error when i try it this way though
[2013-01-25 20:42:08 -0500] behemphi: Sorry for being thick, but I just onboarded a couple of user to my hosted chef org.  What I woud like to know is if our ORGNAME-validator.pem should be the same for each of us
[2013-01-25 20:42:21 -0500] behemphi: I cannot for the life of me find this discussed in the wiki
[2013-01-25 20:42:37 -0500] magoo_: i use the same one
[2013-01-25 20:42:46 -0500] magoo_: behemphi: ^
[2013-01-25 20:43:11 -0500] behemphi: thanks magoo, I thnk I should rephrase that as "must it be the same for all of us?"
[2013-01-25 20:43:14 -0500] siezer: magoo_ try reloading the ec2 plugin instead of hostname
[2013-01-25 20:43:28 -0500] siezer: behemphi yes, you all share the ORGNAME-validator.
[2013-01-25 20:43:30 -0500] behemphi: seems like that pem represents the org thus should be consistent for all members fo the org
[2013-01-25 20:43:41 -0500] behemphi: well shazaam
[2013-01-25 20:43:44 -0500] magoo_: siezer: i'm not sure it's a plugin
[2013-01-25 20:43:45 -0500] BigBassettHound: got it ---- thanks guys
[2013-01-25 20:43:57 -0500] magoo_: it's built into ohai 6.14
[2013-01-25 20:44:43 -0500] siezer: hrm... should be: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/ec2.rb
[2013-01-25 20:45:07 -0500] magoo_: ah, perfect!
[2013-01-25 20:45:17 -0500] magoo_: let me give that a shot then
[2013-01-25 20:52:40 -0500] ranjibd: magoo_, ec2 should be loaded by default, and the attributes are available as ohai.ec2. If you are in vpc, it might not work, in which case you can use the hint system, http://www.opscode.com/blog/2012/05/30/ohai-6-14-0-released
[2013-01-25 20:55:16 -0500] magoo_: ranjibd: i am in vpc... I touched the file on one of my nodes and the attributes showed up
[2013-01-25 20:58:42 -0500] magoo_: now i just have to figure out why my dev env is installing ohai 6.4 and not the latest
[2013-01-25 20:59:28 -0500] ranjibd: awesome.. keep cooking with chef
[2013-01-25 21:07:42 -0500] jubilo: Guys, I wonder if someone can help me out with a cookbook installation issue.
[2013-01-25 21:08:39 -0500] jubilo: I'm trying to do 'knife cookbook site install application' on a newly installed Chef Server instance and I'm getting this: ERROR: The cookbook repo /var/chef/cookbooks is not a git repository.
[2013-01-25 21:08:51 -0500] jubilo: Google doesn't turn up anything useful. Anyone know anything about it?
[2013-01-25 21:19:49 -0500] JasonF: What's the 'right way' for file modes in file resource? I've found conflicting stuff. Is it 3 digits quoted, 4 digits quoted, or 5 digits unquoted? Or is there no 'best practice'?
[2013-01-25 21:20:34 -0500] poolpog: hi
[2013-01-25 21:20:36 -0500] poolpog: hi hi
[2013-01-25 21:20:53 -0500] poolpog: please help: can I use the "File" resource to rename a file?
[2013-01-25 21:21:01 -0500] fly9: if I set user for a command should /etc/environment be read?
[2013-01-25 21:21:04 -0500] poolpog: or, better question, how can I rename a file?
[2013-01-25 21:21:21 -0500] ranjibd: jubilo,  when you do a site install, it checkout a new git branch
[2013-01-25 21:21:41 -0500] poolpog: example situation: some default pacakge file I want to archive, but replace with my custom file
[2013-01-25 21:21:45 -0500] ranjibd: sso it assumes your chef repo (as mentioned in knife configuration file) is a git repo
[2013-01-25 21:21:59 -0500] JasonF: poolpog: A 'rename', at least on *nix, is usually a copy+delete. You could probably use that pattern? (does chef have a copy resource?)... otherwise just use an execute resource with the command needed to rename
[2013-01-25 21:22:03 -0500] clundquist: Re File perms
[2013-01-25 21:22:03 -0500] clundquist: http://acrmp.github.com/foodcritic/#FC006
[2013-01-25 21:22:06 -0500] poolpog: (probably, the answer is "just remove the default package file and restore from the package if you need it")
[2013-01-25 21:22:17 -0500] clundquist: ^ JasonF
[2013-01-25 21:22:38 -0500] JasonF: ty clundquist
[2013-01-25 21:22:40 -0500] ranjibd: jubilo, if thats not the case, you can do knife cookbook site download <cookbook name>
[2013-01-25 21:22:44 -0500] poolpog: JasonF, I couldn't find "copy" for the fIle resource
[2013-01-25 21:22:56 -0500] ranjibd: which will download the tar ball, and then untar it,
[2013-01-25 21:23:00 -0500] ranjibd: wherever you want
[2013-01-25 21:23:09 -0500] clundquist: JasonF, for general best practices you can use the foodcritic gem
[2013-01-25 21:23:15 -0500] clundquist: gem install foodcritic
[2013-01-25 21:23:19 -0500] clundquist: then foodcritic .
[2013-01-25 21:23:22 -0500] clundquist: in your cookbook root
[2013-01-25 21:23:27 -0500] ranjibd: JasonF, i'll recommend for the octal notation
[2013-01-25 21:23:50 -0500] JasonF: clundquist: I probably won't start using foodcritic immediately, but using it as a reference for the 'right way' other people are following makes a lot of sense.
[2013-01-25 21:23:57 -0500] ranjibd: JasonF, you can use "644" as well as 0644 , but the later one is more explicit
[2013-01-25 21:23:57 -0500] jordane: JasonF: a rename on the same file system is just a inode change
[2013-01-25 21:24:23 -0500] JasonF: jordane: TIL
[2013-01-25 21:24:28 -0500] clundquist: ranjibd: use 00644
[2013-01-25 21:24:30 -0500] jubilo: ranjibd: So I need to create a local git repo before I can check out a git branch. That makes sense, I think.
[2013-01-25 21:24:37 -0500] atomic-penguin: 0666, permissions of the beast
[2013-01-25 21:24:39 -0500] jordane: JasonF: dd large file, mv file. Takes almost no time :)
[2013-01-25 21:24:45 -0500] jubilo: Or I could just download the repo.
[2013-01-25 21:24:46 -0500] ranjibd: clundquist, yeah, +1
[2013-01-25 21:25:17 -0500] ranjibd: poolpog, you can use an execute resource with appropriate not_if/if guard
[2013-01-25 21:25:47 -0500] ranjibd: atomic-penguin, yesss ...
[2013-01-25 21:26:03 -0500] ranjibd: long time since i attended a maiden's concert
[2013-01-25 21:26:32 -0500] jubilo: ranjibd: Thanks for the help.
[2013-01-25 21:26:44 -0500] paigeadele_: anyoen here messed with auditd much?
[2013-01-25 21:26:58 -0500] JasonF: ty clundquist
[2013-01-25 21:27:04 -0500] ranjibd: jubilo, yes.. ideally your chef repo will be a git repo as well
[2013-01-25 21:27:21 -0500] poolpog: thanks, folks
[2013-01-25 21:42:36 -0500] josephholsten: anyone using test-kitchen with berkshelf?
[2013-01-25 21:43:14 -0500] kindsol: I though test-kitchen only supported librarian
[2013-01-25 21:43:46 -0500] josephholsten: I heard it was in development, but I haven't heard anything in months
[2013-01-25 21:44:18 -0500] ranjibd: kindsol, test-kitchen uses berkshelf
[2013-01-25 21:46:01 -0500] kindsol: ranjibd: really? http://tickets.opscode.com/browse/KITCHEN-9
[2013-01-25 21:46:25 -0500] josephholsten: the default is to use librarian
[2013-01-25 21:46:47 -0500] autholykos: guys, I am really stuck with this authorization issue
[2013-01-25 21:46:49 -0500] ranjibd: kindsol, damn.! was not aware of this
[2013-01-25 21:47:13 -0500] kindsol: yeah, I wish it did
[2013-01-25 21:47:17 -0500] autholykos: I have no idea what is going wrong, but my vagrant VM is incapable of connecting to my chef-server
[2013-01-25 21:47:30 -0500] autholykos: I have been restarting chef-server countless time
[2013-01-25 21:47:36 -0500] autholykos: regenerated keys
[2013-01-25 21:47:41 -0500] kindsol: ranjibd: pls vote on that ticket
[2013-01-25 21:47:42 -0500] bluepojo: if you vagrant ssh, can you telnet to the chef server box?
[2013-01-25 21:47:42 -0500] josephholsten: autholykos: have you got the logs in a pastie?
[2013-01-25 21:47:58 -0500] bluepojo: on port 4000 if using OSS chef
[2013-01-25 21:51:22 -0500] autholykos: josephholsten: http://pastebin.com/MiwbxRAv
[2013-01-25 21:51:45 -0500] ekristen: jvbe: you try and redo your mongo cluster?
[2013-01-25 21:52:05 -0500] jvbe: yeah, but no luck, i think i spotted a bug
[2013-01-25 21:52:29 -0500] jvbe: you're not incrementing the max_id, i ended up with 2x _id = 1
[2013-01-25 21:52:46 -0500] ekristen: let me look
[2013-01-25 21:53:30 -0500] jvbe: doing another run
[2013-01-25 21:53:32 -0500] josephholsten: autholykos: your chef_server_url should almost certainly not be :4040, which is typically the web-ui. You probably want :4000 if you host your own.
[2013-01-25 21:53:37 -0500] ekristen: jvbe: look at lines 137 -> 144 https://github.com/ekristen/chef-mongodb/blob/master/libraries/mongodb.rb
[2013-01-25 21:54:03 -0500] ekristen: basically looks to see if you've already stood up one mongo server in the chef_env and looks for the _id
[2013-01-25 21:54:08 -0500] autholykos: josephholsten: you are more than right
[2013-01-25 21:54:19 -0500] jvbe: yes
[2013-01-25 21:54:20 -0500] ekristen: once it iterates through all finding the largest _id on line 144 it increments it by 1
[2013-01-25 21:54:28 -0500] jvbe: but later on 157
[2013-01-25 21:54:36 -0500] jvbe: if you add more than 1 member in 1 go it fails
[2013-01-25 21:54:47 -0500] barrowkwan: hi,  is it possible to search ( query ) other node's attribute in a cookbook?  e.g. in node "ABC", how can I search node "DEF"'s attribute?
[2013-01-25 21:54:54 -0500] josephholsten: autholykos: happy to help! let me know if you hit any more snags
[2013-01-25 21:54:59 -0500] ekristen: in 1 go?
[2013-01-25 21:55:10 -0500] ekristen: as in you are building multiple servers simulatneously?
[2013-01-25 21:55:13 -0500] jvbe: no
[2013-01-25 21:55:18 -0500] autholykos: osephholsten: thank you so much. I have been bashing my head all day on this
[2013-01-25 21:55:41 -0500] jvbe: but i think it failed to set it up in time on 1 machine
[2013-01-25 21:55:47 -0500] jvbe: and then i started the next one
[2013-01-25 21:55:57 -0500] ekristen: hrm, ley me try
[2013-01-25 21:56:00 -0500] jvbe: and that last one created the cluster
[2013-01-25 21:56:02 -0500] ekristen: there could definitely be a bug ;-)
[2013-01-25 21:56:06 -0500] jvbe: (i think)
[2013-01-25 21:56:31 -0500] ekristen: jvbe: well if there is only one the rs.init will run, but the cluster won't happen until the 2nd is added
[2013-01-25 21:56:32 -0500] jvbe: ah no i remember
[2013-01-25 21:56:43 -0500] jvbe: on srv1 it doesn't setup a cluster
[2013-01-25 21:56:51 -0500] jvbe: search can't find anything
[2013-01-25 21:57:05 -0500] ekristen: jvbe: lets do a PM
[2013-01-25 21:57:58 -0500] barrowkwan: hi,  is it possible to search ( query ) other node's attribute in a cookbook?  e.g. in node "ABC", how can I search node "DEF"'s attribute?
[2013-01-25 22:06:12 -0500] mattupstate: is there a way to find out when the last chef-client run took place on a node?
[2013-01-25 22:06:28 -0500] clundquist: tail /var/log/chef/client.log
[2013-01-25 22:06:38 -0500] clundquist: ls -lah tail /var/log/chef/client.log
[2013-01-25 22:06:44 -0500] clundquist: err minus the tail there
[2013-01-25 22:09:09 -0500] dotslash_: I'm looking for ways to get chef server installed on RedHat in an environment where we won't have access to the internet. I've heard the suggestion that we use chef11 and the omnibus installer. Any ideas on how to do it with the 10.x version?
[2013-01-25 22:10:47 -0500] clundquist: dotslash_: omnibus with the 10.x version?
[2013-01-25 22:10:55 -0500] clundquist: I feel like this is a trick question
[2013-01-25 22:11:24 -0500] nlloyds2: mattupstate: https://github.com/jgoulah/knife-lastrun sets this as node attributes
[2013-01-25 22:12:07 -0500] josephholsten: dotslash_: do you have a local yum repo? I'm pretty sure there are rpms like the debian ones. I'd push those rpms into my local repo.
[2013-01-25 22:12:31 -0500] clundquist: josephholsten: +1
[2013-01-25 22:12:42 -0500] clundquist: there are RPMs
[2013-01-25 22:12:51 -0500] clundquist: we use omnibus on scientific 6 (rhel)
[2013-01-25 22:13:09 -0500] dotslash_: There is an omnibus for chef-server on 10.x?
[2013-01-25 22:13:46 -0500] josephholsten: I don't think the chef-server rpms are omnibus, they used to have normal dependencies on system ruby &c.
[2013-01-25 22:13:47 -0500] clundquist: ack chef-server
[2013-01-25 22:14:10 -0500] clundquist: I would omnibus chef-{solo,client}
[2013-01-25 22:14:17 -0500] clundquist: and then use the chef-server recipe
[2013-01-25 22:14:22 -0500] josephholsten: looks like frameos packages chef server rpms
[2013-01-25 22:15:01 -0500] josephholsten: oh, here are the official opscode yum repos: http://wiki.opscode.com/display/chef/Opscode+Yum+Repository+Excerpt
[2013-01-25 22:15:23 -0500] dotslash_: The chef-server recipe looks like it needs access to ruby gem repos though doesn't it?
[2013-01-25 22:16:14 -0500] clundquist: cheat, fork it for a gem_binary attribute
[2013-01-25 22:16:24 -0500] clundquist: then have a recipe running before that installs those gems from source
[2013-01-25 22:16:55 -0500] clundquist: the recipe should be well behaved and say "not_if #the gem is installed"
[2013-01-25 22:18:33 -0500] josephholsten: um, https://github.com/opscode-cookbooks/chef-server/ seems to have been reworked for omnibus. fortunately, it accepts a node['chef-server']['package_file'] attribute
[2013-01-25 22:18:46 -0500] barrowkwan: I have two nodes { "name" :  "abc.example.com", "normal" :  { "att1" : "test" } }  and { "name" :  "def.example.com", "normal" :  { "att2" : "test" } }  ,  is it possible to query attribute "att2" when chef-client run on abc.example.com?  i.e. can a node query attribute on another node?
[2013-01-25 22:19:32 -0500] barrowkwan: I mean to query other node's attribute in a recipe.
[2013-01-25 22:19:32 -0500] josephholsten: barrowkwan: if you're using chef-server or hosted-chef, absolutely.
[2013-01-25 22:19:55 -0500] barrowkwan: I am using chef-server..
[2013-01-25 22:20:03 -0500] josephholsten: http://docs.opscode.com/essentials_search.html
[2013-01-25 22:20:34 -0500] josephholsten: you want search('node', 'attr2:*') or something similar
[2013-01-25 22:20:57 -0500] barrowkwan: what happen if I have multiple nodes that has attr2 ?
[2013-01-25 22:21:13 -0500] barrowkwan: the search will return more than one result..
[2013-01-25 22:22:30 -0500] josephholsten: yes. search always returns a list of objects. search('node', query) will return node objects. you limit the nodes you want to search for using the query
[2013-01-25 22:23:03 -0500] josephholsten: so you might want search('node','name:def.example.com').first['att2']
[2013-01-25 22:25:12 -0500] barrowkwan: I tried this
[2013-01-25 22:25:13 -0500] barrowkwan: Chef::Log.info "------------------------------------------------"
[2013-01-25 22:25:14 -0500] barrowkwan: node1 = search('node', 'name:def.example.com')
[2013-01-25 22:25:14 -0500] barrowkwan: Chef::Log.info node1.inspect
[2013-01-25 22:25:33 -0500] barrowkwan: but node1 return []
[2013-01-25 22:26:11 -0500] timsmith: is there a complete list of platform_family values somewhere?
[2013-01-25 22:26:13 -0500] josephholsten: is node1 defined in your chef server?
[2013-01-25 22:26:48 -0500] barrowkwan: no. it is a local variable    " node1 = search('node'. "
[2013-01-25 22:27:38 -0500] josephholsten: sorry, I mean to ask: is the node with name 'def.example.com' already registered in your chef server? have you chef'd it yet?
[2013-01-25 22:27:47 -0500] barrowkwan: yes
[2013-01-25 22:28:38 -0500] josephholsten: timsmith: I was going to point you at http://docs.opscode.com/dsl_recipe_method_platform_family.html but it doesn't have a complete list
[2013-01-25 22:29:25 -0500] josephholsten: barrowkwan: can you run `knife node search 'name:def.example.com'` ? does it show results?
[2013-01-25 22:29:41 -0500] josephholsten: oops
[2013-01-25 22:29:54 -0500] josephholsten: `knife search node 'name:def.example.com'`
[2013-01-25 22:30:28 -0500] barrowkwan: 0 items found
[2013-01-25 22:30:43 -0500] siezer: try "hostname:"
[2013-01-25 22:30:54 -0500] timsmith: josephholsten: It would be really great if opscode could document this somewhere.  The Ohai release notes for 6.12 have some of them, but they've added stuff since then
[2013-01-25 22:31:15 -0500] barrowkwan: knife search node 'hostname:def.example.com'
[2013-01-25 22:31:18 -0500] barrowkwan: 0 items found
[2013-01-25 22:31:40 -0500] siezer: fqdn?
[2013-01-25 22:32:28 -0500] siezer: depends on whats in your node object really. knife node show (thenode) -L -Fjson | less and search around to find the key
[2013-01-25 22:32:40 -0500] barrowkwan: fqdn return 1 items but it didn't show any attributes..
[2013-01-25 22:32:59 -0500] barrowkwan: only Platform,  Recipes, Roles, Run List, IP, FQDN and Enviornment
[2013-01-25 22:33:26 -0500] siezer: knife node search only shows the "vital stats" by default. You have to give it a -L (for long) if you want to see the whole thing
[2013-01-25 22:34:54 -0500] barrowkwan: thanks siezer, -l give me more result.. I will poke around
[2013-01-25 22:35:01 -0500] barrowkwan: thanks josephholsten too
[2013-01-25 22:41:12 -0500] svs_bbi: Hello, I am trying to run the execute resource in my recipe with the not_if conditional; however, it is still running the execute command apparently because it shows an error
[2013-01-25 22:41:31 -0500] svs_bbi: I am trying to create a postgresql user using command line arguments
[2013-01-25 22:42:47 -0500] svs_bbi: and I am checking if the user already exists to prevent from creating it again. Nevertherless, it gives me an error telling me that the user already exists. It seems like it is still running the command
[2013-01-25 22:43:15 -0500] svs_bbi: I did a test to print a simple line and chef gave me the following error:
[2013-01-25 22:43:42 -0500] svs_bbi: [2013-01-25T14:22:30-08:00] FATAL: Errno::ENOENT: execute[blah print] (bbi-postgresql::initialize line 14) had an error: Errno::ENOENT: No such file or directory - create-user
[2013-01-25 22:43:49 -0500] svs_bbi: thank you
[2013-01-25 22:51:39 -0500] koblas: having a problem - cookbook_file is inserting \r\n on a file it's installing.
[2013-01-25 23:05:19 -0500] k0rupted: I want to remote_file deploy a encrypted_data_bag_secret from a URL. I have the recipe higher up the runlist then the tomcat:users cookbook that requires it. But it keeps craping out saying it can't find the file. Is there a better way of doing what Im trying to do?
[2013-01-25 23:25:41 -0500] ggolin: hello all
[2013-01-25 23:25:51 -0500] ggolin: wondering if it is possible to profile a chef-client run
[2013-01-25 23:26:09 -0500] ggolin: there's a part where the run hangs and id like to know what it is doing
[2013-01-25 23:26:38 -0500] ggolin: wake up
[2013-01-25 23:38:21 -0500] ranjibd: ggolin, yes
[2013-01-25 23:38:25 -0500] ev0ldave: ggolin?  like debug?
[2013-01-25 23:38:32 -0500] ev0ldave: chef-client -l debug
[2013-01-25 23:38:39 -0500] ggolin: i know about -l debug
[2013-01-25 23:38:46 -0500] ranjibd: ggolin, there a chef handler that can print out individual resource  as well as recipe wise time consumed
[2013-01-25 23:39:40 -0500] ggolin: ooooh thaaaaaats what im talking about ranjibd
[2013-01-25 23:39:42 -0500] ranjibd: here you go.. https://github.com/joemiller/chef-handler-profiler
[2013-01-25 23:39:48 -0500] ggolin: thank. you.
[2013-01-25 23:39:57 -0500] ranjibd: give a beer/hug to joemiller
[2013-01-25 23:43:09 -0500] joemiller: beers and hugs welcome
[2013-01-25 23:43:23 -0500] Mithrandir: sup?
[2013-01-25 23:43:55 -0500] ggolin: joemiller, this is so awesome. thank you.
[2013-01-25 23:44:24 -0500] joemiller: glad it helped
[2013-01-25 23:44:24 -0500] Mithrandir: joemiller: that looks pretty neat indeed
[2013-01-25 23:46:38 -0500] joemiller: it can be helpful.
[2013-01-25 23:47:05 -0500] joemiller: we find little nits like developers who don't update a checksum so something gets downloaded on every run.
[2013-01-25 23:47:19 -0500] joemiller: and then you can scold them for adding 30s to the converge
[2013-01-25 23:52:33 -0500] ggolin: well right now i have something that works in dev but just sits there in prod.
[2013-01-25 23:52:43 -0500] ggolin: and im about to find out what i am doing wrong
[2013-01-25 23:53:21 -0500] kallistec: ggolin: for your issue you might have to attach strace
[2013-01-25 23:59:45 -0500] ggolin: kallistec, i see one bit where its doing annoying snmp stuff.
[2013-01-25 23:59:56 -0500] ggolin: i will probably take that out of chef alltogether
