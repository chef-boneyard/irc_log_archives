[2013-07-01 01:45:14 -0400] prefixed: where can I download the default node bootstrapper script from? I need to refactor it so that I can draw from a local / lan source instead of opscode.com
[2013-07-01 01:45:49 -0400] coderanger: prefixed: in the source code, chef/knife/bootstrap/chef-full.erb
[2013-07-01 01:46:44 -0400] prefixed: kk. also, to the best of your knowledge is doing what I want to do going to be a major pain in the ass?
[2013-07-01 01:47:28 -0400] coderanger: Nope, pretty easy
[2013-07-01 01:47:32 -0400] prefixed: thank god
[2013-07-01 01:48:09 -0400] coderanger: Theres a section towards the top of the file, with the install logic
[2013-07-01 01:49:01 -0400] hakunin: I need a general server architecture advice
[2013-07-01 01:49:15 -0400] hakunin: http://serverfault.com/questions/519760/managing-hosts-and-iptables-in-scalable-architecture
[2013-07-01 01:49:21 -0400] hakunin: ^ asked on serverfault
[2013-07-01 01:49:49 -0400] hakunin: but in essence: i'm on digital ocean, which means no private network, private ips, or anything like that
[2013-07-01 01:50:45 -0400] hakunin: and i'm trying to make some nodes scale, without having to reconfigure iptables and hosts on every node every time i add another app or worker node
[2013-07-01 01:51:14 -0400] hakunin: this is more general sysadmin stuff than chef
[2013-07-01 01:52:04 -0400] coderanger: hakunin: Use chef search to dynamically configure it all?
[2013-07-01 01:53:02 -0400] hakunin: coderanger: so you suggest reconfiguring all those iptables by scripting it, that's seems to be the only way
[2013-07-01 01:53:11 -0400] prefixed: coderanger so all this does is run install.sh to download the chef-client installer for the relevant os flavor + then install it?
[2013-07-01 01:53:23 -0400] coderanger: Well you are asking in #chef, so thats kind of what we do here
[2013-07-01 01:53:41 -0400] hakunin: coderanger: totally, and i have everything bootstrapped with chef yeah
[2013-07-01 01:53:52 -0400] coderanger: prefixed: Yep
[2013-07-01 01:54:00 -0400] prefixed: fantasticx
[2013-07-01 01:54:29 -0400] coderanger: prefixed: You can just throw the deb/rpm/whatever on a server internally and grab it
[2013-07-01 01:54:42 -0400] prefixed: coderanger yeah that's the plan
[2013-07-01 01:55:04 -0400] hakunin: coderanger: but i thought perhaps another way? like in my serverfault question i mentioned having a gateway server which would route to other servers. This way new app only that 1 server needs to know about new app/worker nodes, and all those services (db,redis,etc) would talk to gateway
[2013-07-01 01:55:30 -0400] hakunin: s/new app//
[2013-07-01 01:55:32 -0400] prefixed: coderanger also, did the facebook bros pay opscode for training classes?
[2013-07-01 01:56:15 -0400] hakunin: not exact correction, but anyway, hope it's clear
[2013-07-01 01:56:39 -0400] hakunin: so i thought maybe somebody more experienced than me can suggest ways to handle this
[2013-07-01 01:57:11 -0400] coderanger: prefixed: No idea, I just make nifty weby things
[2013-07-01 01:57:28 -0400] prefixed: word
[2013-07-01 02:05:10 -0400] martinisoft: is there any way to get Chef to decrypt a data bag early in the recipe compile phase??
[2013-07-01 02:06:39 -0400] coderanger: martinisoft: It does it whenever you put the code for it
[2013-07-01 02:07:19 -0400] martinisoft: coderanger: strange, because its not actually decrypting the data, just dumping out an unencrypted hash
[2013-07-01 02:07:37 -0400] coderanger: Pastebin the code?
[2013-07-01 02:07:41 -0400] martinisoft: yeah, sec
[2013-07-01 02:10:42 -0400] martinisoft: coderanger: https://github.com/martinisoft/funnies-cookbook/blob/master/recipes/default.rb#L24-L28
[2013-07-01 02:11:21 -0400] martinisoft: I attempt to access that data here: https://github.com/martinisoft/funnies-cookbook/blob/master/recipes/default.rb#L134 (commented out for now)
[2013-07-01 02:11:36 -0400] martinisoft: but it immediately explodes with an encrypted data bag hash
[2013-07-01 02:11:56 -0400] martinisoft: basically all the raw hash data in the bag, still encrypted
[2013-07-01 02:20:41 -0400] prefixed: coderanger so, install.sh uses opscode as well...?
[2013-07-01 02:22:18 -0400] coderanger: prefixed: yes
[2013-07-01 02:23:18 -0400] coderanger: martinisoft: Are you sure you have the key right?
[2013-07-01 02:24:07 -0400] prefixed: ok. in that case, what is the preferred methodology for buidling a custom bootstrapper? so I want to encapsulate all the relevant code that would normally be in install.sh into my cutsom boostrap.erb?
[2013-07-01 02:24:58 -0400] martinisoft: coderanger: in kitchen, yeah the key is in the right spot and chef know's where it is located
[2013-07-01 02:27:20 -0400] coderanger: prefixed: There is no way to do that that I'm aware of, you would have to build your own variant on our install.sh
[2013-07-01 02:28:14 -0400] atrius: so.. can't figure out how to do an array of hashes in JSON :(
[2013-07-01 02:28:17 -0400] prefixed: coderanger ok. additionally, how would I go about building a custom boostrappoer? do you know of any tutorials?
[2013-07-01 02:28:41 -0400] coderanger: prefixed: Just support the few platforms you need
[2013-07-01 02:28:53 -0400] prefixed: yeah, that's the plan
[2013-07-01 02:28:56 -0400] coderanger: atrius: [{}, {}, {}]
[2013-07-01 02:29:11 -0400] prefixed: although, I'm writing for a pretty expansive codebase, so...
[2013-07-01 02:29:31 -0400] coderanger: prefixed: Hmm, well just grab our install.sh and start changing URL bases
[2013-07-01 02:29:39 -0400] prefixed: yep
[2013-07-01 02:30:32 -0400] prefixed: ok, so how would I go about making my custon boostrapper callable through knife?
[2013-07-01 02:30:53 -0400] prefixed: e.g. knife mycustombootsrapper
[2013-07-01 02:31:13 -0400] coderanger: prefixed: You just set the name of your template in the options to bootstrap
[2013-07-01 02:31:15 -0400] atrius: coderanger: hmmm... i tried that but i get this message that says the identifier must be a string
[2013-07-01 02:32:42 -0400] coderanger: atrius: Remember that a hash in JSON looks like {"foo": "bar"}
[2013-07-01 02:32:44 -0400] atrius: coderanger: it says "parse error: invalid object key (must be a string)"
[2013-07-01 02:32:50 -0400] coderanger: not {foo: "bar"} like in JS
[2013-07-01 02:33:14 -0400] prefixed: coderanger so something like knife boostrap --template-file customboots?
[2013-07-01 02:33:47 -0400] coderanger: prefixed: You could, or use the -d option
[2013-07-01 02:34:11 -0400] coderanger: If you put your custom template in ./.chef/bootstrap/foo.erb, then -d foo
[2013-07-01 02:34:20 -0400] prefixed: ok
[2013-07-01 02:34:25 -0400] prefixed: this is going to be fun
[2013-07-01 02:34:32 -0400] coderanger: You can also set knife[:distro]='foo' in your knife.rb so it is the default
[2013-07-01 02:34:43 -0400] atrius: coderanger: sorry, had to restart xhcat.. seems it lost its marbles.. anyway... this is what i've got: http://pastebin.com/RXs2JBD1
[2013-07-01 02:35:12 -0400] atrius: coderanger: http://pastebin.com/pQmCVw3Y <-- and that's the exact error
[2013-07-01 02:35:24 -0400] coderanger: atrius You have an extra } on line 4
[2013-07-01 02:35:34 -0400] coderanger: actually on every line
[2013-07-01 02:35:53 -0400] jtnz: Hey, if a resource is executed via a notify, then does it still perform it's not_if/only_if at time of notify?
[2013-07-01 02:36:09 -0400] atrius: coderanger: don't i need a { "foo": "bar"
[2013-07-01 02:36:18 -0400] atrius: sigh.. enter too fast
[2013-07-01 02:36:29 -0400] coderanger: atrius: json.org shows the format very simply
[2013-07-01 02:36:33 -0400] atrius: anyway.. don't i need a pair to enclose each array element of the hash?
[2013-07-01 02:36:34 -0400] coderanger: jtnz: No
[2013-07-01 02:36:48 -0400] jtnz: coderanger, crap
[2013-07-01 02:37:17 -0400] jtnz: coderanger, so it'll fire regardless? Perhaps you have to use only_if/not_if on the resource that's calling?
[2013-07-01 02:37:55 -0400] jtnz: coderanger, that's notifying*.
[2013-07-01 02:38:09 -0400] coderanger: jtnz: That would be one way, yes
[2013-07-01 02:38:30 -0400] jtnz: coderanger, Do you have another? Or the intended idea?
[2013-07-01 02:39:12 -0400] jtnz: coderanger, or is there a way to use not_if/only_if in the notifies attribute?
[2013-07-01 02:39:32 -0400] coderanger: jtnz: Model the logic as an LWRP and don't rely on notifications
[2013-07-01 02:42:40 -0400] atrius: still can't get it to work... do i need {} to separate each hash? should the array of hashes look something like this: [ {"foo":"bar"}, {"baz":"qux"} ]?
[2013-07-01 02:43:53 -0400] matti: atrius: In JS? Yes.
[2013-07-01 02:44:10 -0400] matti: atrius: http://jsconsole.com/ -- fiddle there.
[2013-07-01 02:44:51 -0400] coderanger: atrius: Yes, that is not what you have
[2013-07-01 02:45:42 -0400] atrius: coderanger: correct.. okay.. i think i have it: http://pastebin.com/4SpuRvk5
[2013-07-01 02:45:48 -0400] atrius: matti: thanks :)
[2013-07-01 02:45:50 -0400] matti: atrius: Having this as array of hashes is giving you no benefit anyway.
[2013-07-01 02:46:03 -0400] matti: atrius: You can nest hashes as much as you want (well, sanely of course).
[2013-07-01 02:46:05 -0400] coderanger: atrius: Are you 100% sure thats the data you want?
[2013-07-01 02:46:17 -0400] atrius: matti: agreed.. but apparently that's what the postgres cookbook wants unless i'm misreading it
[2013-07-01 02:46:44 -0400] atrius: coderanger: am i sure at this point? no, not exactly. i've little idea why they decided to make it this way and not just make it a bunch of attributes
[2013-07-01 02:47:11 -0400] matti: atrius: You sure?
[2013-07-01 02:47:26 -0400] atrius: matti: about which thing? :D
[2013-07-01 02:47:41 -0400] matti: atrius: That it uses it that way.
[2013-07-01 02:48:13 -0400] atrius: matti: well, the readme says: This attribute must be an array of hashes, each hash containing the authorization data.
[2013-07-01 02:48:23 -0400] matti: Oh goes it does.
[2013-07-01 02:48:27 -0400] matti: default['postgresql']['pg_hba'] = [
[2013-07-01 02:48:31 -0400] matti: https://github.com/opscode-cookbooks/postgresql/blob/master/attributes/default.rb#L175
[2013-07-01 02:48:33 -0400] atrius: matti: then it says: The hash keys in the array must be symbols.
[2013-07-01 02:48:37 -0400] matti: What an idiotic idea this is.
[2013-07-01 02:48:58 -0400] atrius: matti: it's been driving me nuts off and on all afternoon
[2013-07-01 02:48:59 -0400] jtnz: coderanger, :(
[2013-07-01 02:49:06 -0400] atrius: and yes, it seems quiet crazy
[2013-07-01 02:49:21 -0400] matti: atrius: My recommendation: download and re-factor.
[2013-07-01 02:49:31 -0400] matti: atrius: Alternatively use Chef Unwind to fix this.
[2013-07-01 02:49:35 -0400] atrius: matti: gross.. but also a good idea :)
[2013-07-01 02:49:38 -0400] atrius: chef unwind?
[2013-07-01 02:50:08 -0400] matti: Ops
[2013-07-01 02:50:13 -0400] matti: s/unwind/rewind/
[2013-07-01 02:50:15 -0400] matti: Mea cupla.
[2013-07-01 02:50:15 -0400] matti: https://github.com/bryanwb/chef-rewind
[2013-07-01 02:50:24 -0400] matti: Might work.
[2013-07-01 02:50:45 -0400] atrius: also, bonus points... it doesn't work: http://pastebin.com/awdgSaeC
[2013-07-01 02:55:33 -0400] matti: atrius: Your JSON looks OK ish: http://pastebin.com/YeAKAZdA
[2013-07-01 02:56:33 -0400] atrius: matti: so at least it parses properly anyway... that said, when chef client runs it still blows up with the error above
[2013-07-01 02:56:48 -0400] matti: Actually, its not.
[2013-07-01 02:57:00 -0400] matti: Let's reverse this
[2013-07-01 03:00:38 -0400] matti: atrius: http://pastebin.com/hLQ9iE0M
[2013-07-01 03:00:48 -0400] matti: atrius: This makes more sense.
[2013-07-01 03:01:25 -0400] atrius: matti: so you're saying replace what i currently have with something that resembles that?
[2013-07-01 03:01:33 -0400] matti: atrius: And there is no "nil" in JSON spec: http://www.json.org/
[2013-07-01 03:01:41 -0400] atrius: because yeah, that does make a crap load more sense
[2013-07-01 03:02:24 -0400] matti: atrius: Yes, it does. I take that back -- about the "idiotic ides ...".
[2013-07-01 03:03:03 -0400] matti: atrius: And you need 1 local and 1 host.
[2013-07-01 03:03:30 -0400] matti: Unless you have more than one interface/network.
[2013-07-01 03:03:47 -0400] atrius: matti: i'm doing overrides, shouldn't the defaults where unchanged still be present or do i need to put something in to replace them as well?
[2013-07-01 03:04:01 -0400] matti: atrius: I am not sure how deeply overrige merges.
[2013-07-01 03:04:11 -0400] atrius: matti: i guess we'll find out in a moment :D
[2013-07-01 03:04:18 -0400] matti: atrius: I assume it does deep-merge of some sort, so it should be intact.
[2013-07-01 03:04:47 -0400] atrius: matti: that seems reasonable
[2013-07-01 03:05:11 -0400] matti: I could check Chef code, but its 4am in the UK ;p And only my insomnia is keeping me awake ;p
[2013-07-01 03:05:17 -0400] atrius: haha
[2013-07-01 03:05:20 -0400] matti: :>
[2013-07-01 03:06:08 -0400] matti: Oh noes.
[2013-07-01 03:06:17 -0400] matti: U W TO KEEL ME.
[2013-07-01 03:06:20 -0400] atrius: lol
[2013-07-01 03:06:29 -0400] matti: ;]
[2013-07-01 03:06:34 -0400] atrius: it's 2206 here and i'm about to go make a doubleshot breve` :D
[2013-07-01 03:06:48 -0400] matti: 10pm.
[2013-07-01 03:06:50 -0400] atrius: and the resulting json in the chefui looks far far better now :D
[2013-07-01 03:06:51 -0400] atrius: yeah
[2013-07-01 03:07:12 -0400] matti: East Coast?
[2013-07-01 03:07:19 -0400] atrius: Central
[2013-07-01 03:07:19 -0400] prefixed: how do I run a bash command (specifically scp) in an erb?
[2013-07-01 03:07:28 -0400] atrius: 2307 on the east coast
[2013-07-01 03:07:30 -0400] matti: prefixed: In Erb?
[2013-07-01 03:07:43 -0400] matti: prefixed: Why in template?
[2013-07-01 03:07:51 -0400] prefixed: matti as in boostrap.erb
[2013-07-01 03:08:00 -0400] prefixed: I am creating a cvustom boostrapper
[2013-07-01 03:08:03 -0400] matti: prefixed: Check out Ruby block or execute.
[2013-07-01 03:08:08 -0400] matti: Oh, right.
[2013-07-01 03:09:20 -0400] prefixed: yes
[2013-07-01 03:11:55 -0400] atrius: matti: good news.. it worked.. bad news.. it isn't that intelligent and promptly nuked all the other entries
[2013-07-01 03:12:01 -0400] atrius: at least it'll be easy to add them back :)
[2013-07-01 03:12:31 -0400] prefixed: can I just run bash code inline without any special formatting?
[2013-07-01 03:15:33 -0400] matti: prefixed: http://pastebin.com/reQvEwBi
[2013-07-01 03:15:42 -0400] matti: prefixed: But, I would recommend using something else.
[2013-07-01 03:15:55 -0400] prefixed: hm
[2013-07-01 03:15:56 -0400] matti: prefixed: Working from within template might become hairy.
[2013-07-01 03:16:07 -0400] prefixed: it looks like I can just run bash inline
[2013-07-01 03:16:31 -0400] matti: prefixed: Consider Ruby block or else...
[2013-07-01 03:16:37 -0400] prefixed: knife bootstrap -d my_custom_bootstrapper
[2013-07-01 03:16:46 -0400] matti: atrius: So? 90% done.
[2013-07-01 03:17:05 -0400] prefixed: this is to boostrap a node using custom code
[2013-07-01 03:17:10 -0400] atrius: matti: something like that yeah.. all this so i can get a replacement for Google Reader working :D
[2013-07-01 03:17:31 -0400] atrius: sometimes i almost regret having decided to do all my local configuration (as much as possible) through Chef
[2013-07-01 03:18:11 -0400] prefixed: basically, instead of using the default bootstrapper code, I'm just going to call out to a custom file
[2013-07-01 03:18:32 -0400] prefixed: coderanger said that was the way to victory
[2013-07-01 03:18:35 -0400] prefixed: no?
[2013-07-01 03:18:43 -0400] matti: atrius: Gosh ;p You could just sign up for some already exisitng ones ;p
[2013-07-01 03:18:50 -0400] matti: atrius: But no ;p Too easy ;p
[2013-07-01 03:18:53 -0400] matti: atrius: Hahah
[2013-07-01 03:19:10 -0400] matti: prefixed: I don't know what he said.
[2013-07-01 03:19:23 -0400] matti: atrius: Yet, it was fun ;s
[2013-07-01 03:19:24 -0400] matti: ;]
[2013-07-01 03:20:13 -0400] prefixed: I *think* I can use a modified version of bootstrap.erb to perform a lan boostrap operation
[2013-07-01 03:20:16 -0400] atrius: matti: lol... true. most importantly i figure if i'm going to be forced to switch i may as well move to one which isn't selling my data as it were
[2013-07-01 03:20:16 -0400] coderanger: The bootstrap, for obvious reasons, is not using Chef recipe code, it is just a bash script
[2013-07-01 03:20:28 -0400] coderanger: well, an erb template that renders to a bash script
[2013-07-01 03:20:33 -0400] prefixed: ok
[2013-07-01 03:20:47 -0400] prefixed: so if I've written this sucker properly, it should work
[2013-07-01 03:21:22 -0400] prefixed: I'm basically going to scp the installer from the chef server to the node
[2013-07-01 03:21:42 -0400] prefixed: then I'll install the chef-client and proceed with the rest of the bootstrapping operations
[2013-07-01 03:21:54 -0400] matti: atrius: NSA will read it anyway ;s
[2013-07-01 03:22:06 -0400] matti: atrius: They love to know what your hobbies are ;p
[2013-07-01 03:22:07 -0400] matti: Haha
[2013-07-01 03:22:25 -0400] prefixed: what does this line do? <%= "export http_proxy=\"#{knife_config[:bootstrap_proxy]}\"" if knife_config[:bootstrap_proxy] -%>
[2013-07-01 03:22:28 -0400] atrius: lol
[2013-07-01 03:22:29 -0400] matti: atrius: Lesson learned -- always fiddle on the side in IRB / JS console.
[2013-07-01 03:23:28 -0400] matti: prefixed: It will add http_proxy with some setting if a hash this key and is not nil.
[2013-07-01 03:23:34 -0400] prefixed: ok
[2013-07-01 03:23:39 -0400] prefixed: don't need it
[2013-07-01 03:23:55 -0400] matti: s/has has/
[2013-07-01 03:23:57 -0400] matti: LOL
[2013-07-01 03:23:59 -0400] matti: Dammit
[2013-07-01 03:24:18 -0400] prefixed: look at me. working on a sunday night to ensure delivery of deliverables on tuesday morning
[2013-07-01 03:24:20 -0400] prefixed: what a guy
[2013-07-01 03:24:37 -0400] atrius: matti: at least i can make them work for it :D
[2013-07-01 03:25:59 -0400] matti: prefixed: Look at us, we help you in the middle of the night free of charge!
[2013-07-01 03:26:02 -0400] matti: prefixed: We rock!
[2013-07-01 03:26:03 -0400] matti: ;d
[2013-07-01 03:26:17 -0400] prefixed: hah
[2013-07-01 03:26:57 -0400] matti: atrius: I am sure they want to know all about your kinky cosplay fetish ;p
[2013-07-01 03:27:19 -0400] matti: atrius: OK, good thing it worked. Time for me to get a nap.
[2013-07-01 03:27:22 -0400] matti: atrius: Good luck Sir ;]
[2013-07-01 03:27:39 -0400] matti: atrius: Just don't read too much ;p It will make you blind ;p
[2013-07-01 03:27:45 -0400] matti: prefixed: Good luck man ;]
[2013-07-01 03:28:18 -0400] prefixed: thanks
[2013-07-01 03:28:27 -0400] prefixed: I'm sure I'll be back tomorrow
[2013-07-01 03:28:39 -0400] atrius: matti: thanks :)
[2013-07-01 03:29:10 -0400] atrius: matti: i do  have the right wife for that kind of thing ;)
[2013-07-01 03:29:31 -0400] matti: ;p
[2013-07-01 03:29:42 -0400] matti: Oh noes.
[2013-07-01 03:29:49 -0400] matti: Bad mental state before bed.
[2013-07-01 03:29:58 -0400] matti: atrius: Your fault ;p
[2013-07-01 03:30:16 -0400] atrius: matti: haha
[2013-07-01 03:30:23 -0400] matti: [ +1 for geeky wifey ;s ]
[2013-07-01 03:30:40 -0400] atrius: i'll make it worse and say there are few things better than a hot asian wife who watches Anime :D
[2013-07-01 03:31:05 -0400] matti: My girlfriend is Japanese.
[2013-07-01 03:31:05 -0400] matti: ;s
[2013-07-01 03:31:11 -0400] matti: I can imagine.
[2013-07-01 03:31:19 -0400] atrius: matti: nice ;)
[2013-07-01 03:32:09 -0400] martinisoft: coderanger: so I figured it out. Had to call to_hash on that environment line to get it to decrypt the data
[2013-07-01 03:48:38 -0400] atrius: sending a kill USR1 to chef-client does wake it up and eventually it does its thing... is there anyway to get it to do it faster?
[2013-07-01 03:57:19 -0400] coderanger: atrius: Just run chef-client
[2013-07-01 03:57:55 -0400] atrius: coderanger: even if it is running as a system service?
[2013-07-01 03:58:16 -0400] coderanger: Yes, as of chef 11 we use lockfiles to sync between the two
[2013-07-01 03:59:19 -0400] atrius: ah, okay
[2013-07-01 05:56:08 -0400] stormerider: anyone had any luck with configuring NRPE via Chef under OSX?
[2013-07-01 06:03:52 -0400] stormerider: ah, i guess it uses macports, nvm.
[2013-07-01 06:10:02 -0400] axyelp: from a chef-apply script, i save the environment properties as  env_obj.override_attributes[:transient]= <some hash>. but while saving, it converts them into string & i can retrieve them only through string keys in recipes. but then, there are some attributes which aren't converted to strings. is there some rule which can help me expect *some* consistency?
[2013-07-01 06:27:14 -0400] coderanger: axyelp: You are dynamically changing an environment object in recipe code?
[2013-07-01 06:37:36 -0400] axyelp: coderanger: no, in a script which immediately calls a 'knife ssh' & the nodes on the other end. is this good practise?
[2013-07-01 06:38:09 -0400] axyelp: coderanger: but that wasn't the problem. was using the attributes in bash which didn't parse them neatly. it's picking them up regardless of what i use - string or symbol!
[2013-07-01 06:40:45 -0400] hujifeng: https://github.com/ceph/ceph-cookbooks
[2013-07-01 06:40:59 -0400] hujifeng: how to use this cookbook to deploy ceph?
[2013-07-01 06:41:07 -0400] hujifeng: too many bugs
[2013-07-01 06:41:21 -0400] hujifeng: anyone used it?
[2013-07-01 06:41:29 -0400] flaccid: https://github.com/opscode-cookbooks/application_ruby#attribute-parameters with the gems param how do i specify the gem version for each gem in the array?
[2013-07-01 07:17:34 -0400] bigbigbang: Hi chefs ! has someone already done replication for Solr ?
[2013-07-01 08:09:01 -0400] ichilton: Trying to use the postgresql cookbook but having a bit of a nightmare...
[2013-07-01 08:09:39 -0400] ichilton: It doesn't seem to be loading attributes/default.rb - any ideas?
[2013-07-01 08:29:29 -0400] flaccid: coderanger: i wills digs in to da code
[2013-07-01 08:32:50 -0400] s2r2: Hmm a node not being returned by a search for its environment (according to "knife node show") -- any hints?
[2013-07-01 08:35:05 -0400] flaccid: i guess i'm seeing it here https://github.com/opscode-cookbooks/application_ruby/blob/master/providers/rails.rb#L154
[2013-07-01 08:35:18 -0400] s2r2: It's not returned by a search for "chef_environment:*" either? wth?
[2013-07-01 08:47:11 -0400] bigbigbang: Please help ! : I 'm trying to replicate solr , after having modify the configuration file in order to have a master and a slave . but I can't reach the url : http//myserver:8389/solr/ ... from my slave , do you think there might be other configuration to do ?
[2013-07-01 09:09:13 -0400] futilegames: Hello, I'm having difficulties running 'bundle install' from 'before_migrate' in 'deploy' .It fails when building a native extension. When run again it builds the previously failed native extension but fails when trying to build the next one.
[2013-07-01 09:09:54 -0400] futilegames: If I ssh into the box, in this case vagrant then running 'bundle install' works
[2013-07-01 09:10:15 -0400] flaccid: futilegames: more l luck if you provide the error output
[2013-07-01 09:14:41 -0400] futilegames: @flaccid, new to chef, wasn't sure what is most relevant so all output here, https://gist.github.com/anonymous/5899464
[2013-07-01 09:16:41 -0400] flaccid: futilegames: see if you get any more output from running gem install json -v '1.8.0' in vagrant ssh
[2013-07-01 09:17:01 -0400] flaccid: and check /usr/local/enquirli/shared/bundle/ruby/2.0.0/gems/json-1.8.0/ext/json/ext/generator/gem_make.out to see if more info there
[2013-07-01 09:17:52 -0400] flaccid: that kind of looks like ruby 2 with chef though which isn't supported
[2013-07-01 09:19:56 -0400] Azrael: i have a general question.  if you're running open-source chef, how do many folks manage multiple datacenters?  one chef server per datacenter?  do you have any tips for keeping each chef server synchronized (w/ respect to cookbooks, environment definitions, etc)?
[2013-07-01 09:21:24 -0400] futilegames: Thanks @flaccid, having a look just now. Ah, I'd not realised ruby2 wasn't supported.
[2013-07-01 09:21:57 -0400] flaccid: futilegames: i believe it will be with chef 11 soon, like next release or somewhere around there
[2013-07-01 09:24:59 -0400] pedda: why is no one in here claiming any issues with several recipes or cookbooks?
[2013-07-01 09:25:17 -0400] flaccid: pedda: huh
[2013-07-01 09:26:04 -0400] pedda: I've been fighting my vagrant & chef combo for a couple of days now
[2013-07-01 09:26:33 -0400] flaccid: why
[2013-07-01 09:26:40 -0400] pedda: i see just a few people with problems here.. as if i were too dump for this topic
[2013-07-01 09:27:01 -0400] pedda: it doesn't matter which recipe or cookbook i try or write
[2013-07-01 09:27:05 -0400] pedda: it keeps failing..
[2013-07-01 09:27:26 -0400] pedda: setting up a basic lamp env seems to be a hard task..
[2013-07-01 09:27:27 -0400] flaccid: its a bit hard to help if you don't show it fails
[2013-07-01 09:27:57 -0400] pedda: i'm talking about my problems in general.. and comparing myself to the action happening in here :)
[2013-07-01 09:28:15 -0400] flaccid: well, i use vagrant and chef every day
[2013-07-01 09:28:24 -0400] flaccid: so do thousands of people
[2013-07-01 09:28:37 -0400] pedda: i have the apt-get problem.. stated several times on the internet.. with an easy solution to include the apt cookbook first, followed by all the other community cookbooks i would like to use
[2013-07-01 09:28:44 -0400] pedda: i know
[2013-07-01 09:29:18 -0400] pedda: i was not able to provision my vom without any problems
[2013-07-01 09:29:26 -0400] pedda: *vm
[2013-07-01 09:30:22 -0400] pedda: it's like vagrant & chef (and berkshelf since a few days) is about creating some recipes and firing up the vm until all errors during the provisioning are gone
[2013-07-01 09:30:46 -0400] pedda: i'm talking about my situation only
[2013-07-01 09:30:56 -0400] flaccid: i recently started using that technique myself
[2013-07-01 09:31:01 -0400] pedda: as i don't see people having that much trouble
[2013-07-01 09:31:16 -0400] flaccid: everyone is different
[2013-07-01 09:31:42 -0400] pedda: i mean.. it is okay if something fails.. but i'm frustrated as it seems as if i wouldn't get the point in this topic
[2013-07-01 09:32:05 -0400] jhiggs: I'd like to use some attributes which are collected by ohai halfway through my deploy. My problem is that during the validation at the beginning of the deploy the attributes do not yet exist and chef throws an error. Does anyone have a clean way to get around this problem?
[2013-07-01 09:32:23 -0400] flaccid: i handle the apt-get update doing https://github.com/flaccid/cookbooks/blob/master/cookbooks/system/recipes/default.rb#L18 which this includes https://github.com/flaccid/cookbooks/blob/master/cookbooks/system/recipes/update_package_list.rb which runs on debian systems only..
[2013-07-01 09:32:31 -0400] flaccid: pedda: ^^ solved.
[2013-07-01 09:33:30 -0400] pedda: this is only one of several problems i encounter..
[2013-07-01 09:33:40 -0400] pedda: probably i'm doing too much stuff at the same time..
[2013-07-01 09:33:53 -0400] flaccid: jhiggs: are you using an ohai custom plugin? if so i saw somewhere online on how to actually reload it, but i have not got it handy. doing it via ohai in execute phase is probably not best
[2013-07-01 09:34:06 -0400] flaccid: pedda: welcome to being a developer
[2013-07-01 09:34:11 -0400] pedda: hehe
[2013-07-01 09:34:19 -0400] flaccid: or any software engineer for that matter
[2013-07-01 09:34:43 -0400] jhiggs: @flaccid: yeah, a custom ohai plugin. I am reloading it. but because the validation happens before any recipe is ran it sees that I'm calling something that doesn't exist.
[2013-07-01 09:35:30 -0400] pedda: does it make a difference if i use include_recipe instead of adding recipe[XYZ] to chef.run_list?
[2013-07-01 09:35:43 -0400] pedda: there seem to be so many ways to accomplish tasks..
[2013-07-01 09:36:11 -0400] pedda: i got introduced to vagrant with the hint, that i should consider to use either puppet or chef for provisioning..
[2013-07-01 09:36:20 -0400] pedda: i decided to use chef..
[2013-07-01 09:36:37 -0400] flaccid: jhiggs: how are you reloading it? can you show me
[2013-07-01 09:36:42 -0400] jhiggs: @flaccid: I can throw it into a template and it's happy because templates are not validated. Right now I'd like to parse the attribute into a template as a variable.
[2013-07-01 09:36:48 -0400] jhiggs: flaccid: yep.
[2013-07-01 09:37:10 -0400] flaccid: pedda: it does matter in the respect of ordering, its a logical choice
[2013-07-01 09:37:32 -0400] jhiggs: ohai "reload_cfn" do
[2013-07-01 09:37:32 -0400] jhiggs:   plugin "cfn"
[2013-07-01 09:37:32 -0400] jhiggs:   action :nothing
[2013-07-01 09:37:33 -0400] jhiggs: end
[2013-07-01 09:37:41 -0400] jhiggs: and I'm parsing the :reload action
[2013-07-01 09:37:44 -0400] jhiggs: with a notificaiton.
[2013-07-01 09:37:48 -0400] flaccid: reload doesn't actually reload
[2013-07-01 09:38:13 -0400] jhiggs: it does if the plugging hasn't existed during the initial run of ohail.
[2013-07-01 09:38:15 -0400] pedda: talking about the inclusion of apt recipe should i go with include_recipe "apt" like the code examples you posted
[2013-07-01 09:38:30 -0400] pedda: rather than with chef.run_list
[2013-07-01 09:38:44 -0400] flaccid: jhiggs: checkout http://tickets.opscode.com/browse/OHAI-389 and there are other related threads. its epic but someone somewhere online that i lost wrote an anti-pattern to do it
[2013-07-01 09:39:20 -0400] jhiggs: yep. I know that thread. :) my name is all over it.
[2013-07-01 09:39:34 -0400] flaccid: pedda: design choice, but i would probably do both. depend on apt in metadata of your cookbook and include_recipe as well
[2013-07-01 09:39:46 -0400] flaccid: jhiggs: oh yeah sorry, well i'm the chris fordham lol
[2013-07-01 09:40:02 -0400] flaccid: haha, just realised
[2013-07-01 09:40:04 -0400] jhiggs: hahaha. hello
[2013-07-01 09:40:15 -0400] flaccid: um, there is this anti pattern somehwere
[2013-07-01 09:40:27 -0400] flaccid: i can't find, but it does do proper reload where you need, need to find..
[2013-07-01 09:40:47 -0400] CaptainQuirk: Hi there !
[2013-07-01 09:40:55 -0400] pedda: while creating a vagrant file.. do you guys destroy your box to see if it still runs without problems from scratch or is it not necessary and you do some "vagrant provision" or "vagrant reload"?
[2013-07-01 09:40:57 -0400] CaptainQuirk: I'm using chef to provision my development machine
[2013-07-01 09:40:58 -0400] pedda: hi
[2013-07-01 09:41:10 -0400] flaccid: pedda: thanks a good test
[2013-07-01 09:41:14 -0400] jhiggs: @flaccid: so anyway, the ohai part is working because I can use the values in templates. the problem is the validation.
[2013-07-01 09:41:38 -0400] flaccid: pedda: this is how i do a server in vagrant https://github.com/rightscale-blueprints/linux_server
[2013-07-01 09:41:40 -0400] pedda: ?
[2013-07-01 09:41:41 -0400] CaptainQuirk: I stumbled upon a small problem with an npm module
[2013-07-01 09:41:48 -0400] pedda: which test?
[2013-07-01 09:41:56 -0400] flaccid: pedda: destroy and up again
[2013-07-01 09:42:00 -0400] CaptainQuirk: I fear that I won't be able to integrate it in the chef provisoning flow
[2013-07-01 09:42:19 -0400] CaptainQuirk: What could be my course of action ?
[2013-07-01 09:42:22 -0400] flaccid: jhiggs: that seems a bit of a hack though as best practice would provide variables in template resource
[2013-07-01 09:42:40 -0400] CaptainQuirk: I was thinking about writing some stuff to a script file to be executed manually at the end
[2013-07-01 09:42:47 -0400] pedda: this is what i end up.. because when my box starts up without problems, i want to be sure, so i destroy it and see if it can start up without any errors.. and then it starts failing again..
[2013-07-01 09:43:03 -0400] pedda: it's like the cause for all my confusion
[2013-07-01 09:43:07 -0400] flaccid: jhiggs: i am pretty sure that this post i need to find solves things for both of us
[2013-07-01 09:43:10 -0400] jhiggs: @flaccid: i'm parsing cloudformation data in. I don't know of any nicer way to get it in.
[2013-07-01 09:43:36 -0400] flaccid: pedda: you need to identify each problem and work out how to solve it; of course this chan can help with each
[2013-07-01 09:43:37 -0400] pedda: * start up without any errors from scratch
[2013-07-01 09:44:06 -0400] pedda: last week i spent 2 days on a VB box until i got pointed to it..
[2013-07-01 09:44:09 -0400] pedda: :(
[2013-07-01 09:44:13 -0400] flaccid: jhiggs: well there is control on when a template resource can be executed or notified so its just a matter of doing the reload with this anti pattern before i believe as a general flow..
[2013-07-01 09:44:19 -0400] jhiggs: @flaccid: i'm wondering if you can wrap a piece of code up in a block that doesn't get validated but still treats the chef methods as it otherwise would.
[2013-07-01 09:44:32 -0400] flaccid: pedda: give up or persist :)
[2013-07-01 09:44:45 -0400] pedda: the 2nd one..
[2013-07-01 09:44:49 -0400] pedda: definetly
[2013-07-01 09:45:29 -0400] flaccid: jhiggs: still seems a bit more hacky than it should. you could use attributes as a placeholder until they can be updated by overriding in the recipe from ohai reload data
[2013-07-01 09:46:21 -0400] jhiggs: @flaccid: I'll try that out and see what happens. I have a feeling that ohai won't override the set attributes. Let me see what happens.
[2013-07-01 09:47:30 -0400] pedda: flaccid the more i read, the mor often i see people using some extended commands to run vagrant instead of just vagrant up is this correct?
[2013-07-01 09:47:31 -0400] CaptainQuirk: On a related topic, when writing a custom provider/resource pair, how can I deal with an operation that expects the user to confirm an installation ?
[2013-07-01 09:48:05 -0400] flaccid: pedda: check out my repository and follow the readme
[2013-07-01 09:48:11 -0400] pedda: i do
[2013-07-01 09:48:40 -0400] pedda: what#s the difference between vagrant up with chef _solo provisioning and sudo chef-solo -c ..
[2013-07-01 09:48:42 -0400] pedda: ?
[2013-07-01 09:48:56 -0400] flaccid: pedda: my Vagrantfile is real simple https://github.com/rightscale-blueprints/linux_server/blob/master/vagrant/Vagrantfile and lines 6 and 7 i need to remove coz of use of apt cookbook
[2013-07-01 09:49:26 -0400] flaccid: pedda: vagrant up is on the host which reloads the vm. sudo chef-solo would be in the box itself with vagrant ssh
[2013-07-01 09:51:06 -0400] pedda: the Chef Solo approach from the readme is about provisioning the host machine rather than a vbox image then?
[2013-07-01 09:51:29 -0400] flaccid: pedda: no its all about a guest box
[2013-07-01 09:51:50 -0400] pedda: why should one vagrant up a vm and do the sudo chef-solo command then?
[2013-07-01 09:52:32 -0400] flaccid: vagrant is about managing a box, not running things inside the box directly, manually
[2013-07-01 09:53:34 -0400] flaccid: there is also #vagrant pedda
[2013-07-01 09:53:40 -0400] pedda: i know
[2013-07-01 09:53:47 -0400] pedda: i'm in all of those..
[2013-07-01 09:53:55 -0400] pedda: at least in those i need
[2013-07-01 09:54:18 -0400] flaccid: cool
[2013-07-01 09:54:21 -0400] pedda: i still don't get it.. i have to use vagrant up, to be able to use sudo chef-solo
[2013-07-01 09:54:22 -0400] pedda: right?
[2013-07-01 09:55:10 -0400] pedda: so.. if there is some sudo chef-solo approach to make things happen inside the guest machine it's just because people didn't want tp provision on startup..
[2013-07-01 09:55:21 -0400] bigbigbang: Is it possible to reach the solr admin webpage (not from localhost)  without modify the chef configuration ? I 've modify some configurations to specify the real ip adresse (not 127.0.0.1) but how can I access http://mychefserver:8389/solr ?? ( My goals is to implement solr replication) so i first need a valid adress in order to be able to reach the http://...:8389/solr/replication . Please help !
[2013-07-01 09:55:29 -0400] pedda: by the use of a vagrant file..
[2013-07-01 09:55:56 -0400] flaccid: jhiggs: this is getting close http://lists.opscode.com/sympa/arc/chef/2012-08/msg00058.html
[2013-07-01 10:00:08 -0400] jhiggs: @flaccid: I think that is doing the same thing is running the ohai method if your recipe.
[2013-07-01 10:01:20 -0400] flaccid: yeah i still can't find what i was talking about
[2013-07-01 10:01:23 -0400] flaccid: loooooost
[2013-07-01 10:01:46 -0400] jhiggs: @flaccid: it didn't work. it keeped the attributed I primed. I'm thought ohai wouldn't overwrite a set attribute.
[2013-07-01 10:04:19 -0400] flaccid: aka square one
[2013-07-01 10:06:11 -0400] ichilton: Having a bit of a newbie problem - how can I add to the runlist from a recipe? - i'm trying to build a wrapper cookbook for my app, but things like postgresql, mongodb etc fail when using include_recipe, but then work when added to the runlist - but I only want to include my app in the runlist. It seems to be something to do with it not loading the default attributes if you include_recipe? - am running chef-solo at the moment but will be moving to chef
[2013-07-01 10:07:27 -0400] jhiggs: @ichilton: have you included the cookbooks as dependencies in your metadata.rb file?
[2013-07-01 10:07:44 -0400] ichilton: jhiggs: ah, no - oops!
[2013-07-01 10:07:52 -0400] jhiggs: @ichilton: :)
[2013-07-01 10:07:57 -0400] ichilton: jhiggs: does that go and load the default attributes?
[2013-07-01 10:08:25 -0400] jhiggs: @ichilton: no it will put the cookbooks on the server you are deploying to. otherwise the entire cookbook won't be available.
[2013-07-01 10:08:47 -0400] ichilton: ah, ok
[2013-07-01 10:09:03 -0400] gkarekinian: He said he's using chef-solo though
[2013-07-01 10:09:17 -0400] jhiggs: you can see it in the first couple of lines when running chef-client
[2013-07-01 10:09:54 -0400] jhiggs: gkarekinian: agh, missed that.
[2013-07-01 10:10:07 -0400] ichilton: Yes, i'm currently running chef-solo for testing, but I have a chef-server setup and ready so i'll be moving to that later
[2013-07-01 10:10:39 -0400] flaccid: ichilton: you don't modify the run_list in the chef run. if you create a 'wrapper' cookbook. depend on those cookbooks in metadata. and have your cookbook use those attributes, use include_recipe where appropriate
[2013-07-01 10:11:18 -0400] ichilton: That's what i'm doing - i'd just forgotten the metadata part :)
[2013-07-01 10:11:51 -0400] flaccid: ichilton: i kind of do what you do with all these https://github.com/rightscale-blueprints
[2013-07-01 10:12:15 -0400] ichilton: Hmm, the git cookbook depends on things like dmg, even though it's running on ubuntu - surely they should do a platform check?
[2013-07-01 10:12:37 -0400] ichilton: flaccid: thanks - will check those out!
[2013-07-01 10:13:05 -0400] flaccid: ichilton: thats way too intricate. if multi platform cookbook they depend on what they could depend on
[2013-07-01 10:13:21 -0400] flaccid: there is no conditional depends from runtime
[2013-07-01 10:13:35 -0400] ichilton: flaccid: what reads Cheffile?
[2013-07-01 10:13:43 -0400] flaccid: ichilton: librarian-chef
[2013-07-01 10:13:49 -0400] ichilton: ah, ok
[2013-07-01 10:14:07 -0400] ichilton: So if you want to use the git cookbook, you just need to install dmg, yum etc?
[2013-07-01 10:14:31 -0400] flaccid: in a literal sense yeah. but this is one reason why i use librarian (or bershelf)
[2013-07-01 10:14:38 -0400] ichilton: Yep
[2013-07-01 10:14:48 -0400] flaccid: which also pulls down the deeps via the community site api
[2013-07-01 10:14:48 -0400] ichilton: What's the summary on librarian vs berkshelf?
[2013-07-01 10:14:58 -0400] ichilton: Yep - bundler for chef?
[2013-07-01 10:15:00 -0400] flaccid: i've never used berkshelf
[2013-07-01 10:15:22 -0400] flaccid: i guess so. i'm not actually a ruby guy so i dislike bundler fundamentally to begin with
[2013-07-01 10:15:38 -0400] ichilton: ah, ok
[2013-07-01 10:15:42 -0400] ichilton: what don't you like about it?
[2013-07-01 10:15:49 -0400] flaccid: we don't do that crap in python
[2013-07-01 10:15:50 -0400] flaccid: :)
[2013-07-01 10:15:56 -0400] ichilton: what do you do?
[2013-07-01 10:16:30 -0400] flaccid: well it depends on context, but if we need to use packages its via a proper api with pip
[2013-07-01 10:16:51 -0400] ichilton: ah, ok
[2013-07-01 10:16:59 -0400] flaccid: ruby is more like, ah i'll just make this random stack of stuff from random places and arbitrary versions and define it all in a file
[2013-07-01 10:17:08 -0400] ichilton: nod
[2013-07-01 10:18:11 -0400] flaccid: its like that line from a move, 1000 ways to die, choose one
[2013-07-01 10:18:26 -0400] flaccid: or in ruby's case, choose however many you like all at the same time :)
[2013-07-01 10:20:04 -0400] flaccid: at the same time though i don't mean to knock ruby. but it is just so much more variant and harder to manage. there is no true virtualenv like thing
[2013-07-01 10:24:24 -0400] ichilton: Yay, that works now - thanks guys.
[2013-07-01 10:25:28 -0400] flaccid: coolio
[2013-07-01 10:26:11 -0400] ichilton: I do get a warning though:
[2013-07-01 10:26:11 -0400] ichilton: [2013-07-01T10:24:18+00:00] WARN: Cloning resource attributes for package[autoconf] from prior resource (CHEF-3694)
[2013-07-01 10:26:14 -0400] ichilton: [2013-07-01T10:24:18+00:00] WARN: Previous package[autoconf]: /vagrant/chef-repo/cookbooks/build-essential/recipes/debian.rb:40:in `block in from_file'
[2013-07-01 10:26:17 -0400] ichilton: [2013-07-01T10:24:18+00:00] WARN: Current  package[autoconf]: /vagrant/chef-repo/cookbooks/ark/recipes/default.rb:25:in `from_file'
[2013-07-01 10:26:20 -0400] ichilton: Any ideas?
[2013-07-01 10:27:27 -0400] flaccid: could just be mismatch of versions
[2013-07-01 10:27:43 -0400] ichilton: ah, ok
[2013-07-01 10:27:51 -0400] ichilton: so they are fighting over which to install?
[2013-07-01 10:27:55 -0400] flaccid: what versions of the cookbooks are you using ichilton
[2013-07-01 10:28:06 -0400] ichilton: The latest from the community site
[2013-07-01 10:28:20 -0400] ichilton: Used: knife cookbook site download
[2013-07-01 10:29:21 -0400] flaccid: i don't think those 3 lines are enough to understand
[2013-07-01 10:29:35 -0400] flaccid: you can always try master as well
[2013-07-01 10:29:42 -0400] ichilton: ok, ta
[2013-07-01 10:29:46 -0400] ichilton: i'll investigate later!
[2013-07-01 10:29:58 -0400] ichilton: it doesn't seem to be causing a problem right now.
[2013-07-01 10:42:43 -0400] CaptainQuirk: Can I bypass a confirmation prompt for a custom package manager I'm writing a resource/provider ?
[2013-07-01 10:43:02 -0400] CaptainQuirk: ... for
[2013-07-01 10:45:28 -0400] flaccid: huh
[2013-07-01 10:46:33 -0400] flaccid: i'm out
[2013-07-01 10:48:28 -0400] jhiggs: @flaccid: :canonical_url => node.attribute?("cfn") ? node["cfn"]["FrontendFqdn"] : "", is the answer.
[2013-07-01 11:23:08 -0400] pluesch0r: hi everybody. i'd like to in-place upgrade my chef server to version 11. is there a guide for that, too? i don't have the luxury of installing it on an other machine for the upgrade.
[2013-07-01 12:04:31 -0400] ichilton: I've updated /etc/default/locale at the top of my chef recipe - how can I ensure that takes effect before any more of the chef run is performed?
[2013-07-01 12:08:39 -0400] pluesch0r: currently trying to install chef server 11.x - i'm following the steps outlined in http://docs.opscode.com/install_server.html; there's no chef-server-ctl on my system (ubuntu 12.04); what am i doing wrong?
[2013-07-01 12:10:09 -0400] pluesch0r: right; installed the client package, not the server package. sigh.
[2013-07-01 12:14:34 -0400] bigbigbang: ok , my solr replication works , but now my problem is : Server returned error for http://127.0.0.1:8000/search/environment?q=*:*&sort=&start=0&rows=20                    does someone know why ?
[2013-07-01 12:15:49 -0400] bigbigbang: everything is working expect this ... the admin password between the 2 server is the same, they work on the same database , and rabbitmq is clustered ..
[2013-07-01 12:16:26 -0400] bigbigbang: the error appears when i try to do a search ...
[2013-07-01 12:20:36 -0400] pluesch0r: installing chef server 11, getting error 'Exception during Pedant credentials setup' and then 'SSL_connect returned=1 errno=0 state=SSLv2/v3 read server hello A: unknown protocol' when running 'chef-server-ctl test'; how can i debug that?
[2013-07-01 12:22:08 -0400] pluesch0r: right; chef server 11 doesn't seem to only want to listen to port 4040 anymore. at least the pedant stuff looks for answers on 443.
[2013-07-01 12:26:25 -0400] zeroXten: are there any tricks to get knife bootstrap to use a alternate data_bag_secret_file location?
[2013-07-01 12:31:20 -0400] gyre007: is there any chef cookbook which would allow me to download some stuff from AWS - something like deb package stored in S3 ?
[2013-07-01 12:42:07 -0400] cheeseplus: gyre007: https://github.com/hectcastro/chef-s3cmd
[2013-07-01 12:42:33 -0400] cheeseplus: not sure if there is a formal provider but that gets the job done with s3cmd
[2013-07-01 12:42:39 -0400] gyre007: I see
[2013-07-01 12:42:47 -0400] gyre007: will have a look...cheers cheeseplus
[2013-07-01 12:42:55 -0400] cheeseplus: you can also just get at s3 via http though
[2013-07-01 12:43:04 -0400] cheeseplus: that is how I do it for the riak cookbooks
[2013-07-01 12:43:28 -0400] cheeseplus: so you don't necessarily need anything s3 specific, just a URL
[2013-07-01 12:44:14 -0400] gyre007: that's true actually
[2013-07-01 12:45:22 -0400] gyre007: well...AWS credentials...
[2013-07-01 12:45:24 -0400] cheeseplus: s3cmd would be useful if you need to list a bucket or do a put though
[2013-07-01 12:45:31 -0400] cheeseplus: or have it protected
[2013-07-01 12:46:22 -0400] gyre007: actually I only need a download...ie GET...
[2013-07-01 12:46:36 -0400] gyre007: we are pushing and updating particular objects using different tools...
[2013-07-01 12:47:39 -0400] pluesch0r: anyone else on chef 11 in here with some time on his/her hands? struggling getting my migration (cookbook upload) from v10 to work.
[2013-07-01 12:48:08 -0400] cheeseplus: gyre007: then I'd stick with the native http just for ease
[2013-07-01 12:49:08 -0400] kimm: hi, i've installed chef server, and after that i've changed some config in the /etc/chef/chef-server.rb file (setting the notification email and nginx ssl cert info). Is it normal though that even if I run the chef-server reconfigure those data don't change? :\
[2013-07-01 13:01:49 -0400] pluesch0r: somehow that support page guide isn't really helping.
[2013-07-01 13:02:21 -0400] pluesch0r: when uploading my v10 cookbooks i keep getting 'common.rb:43:in `rescue in block in deep_const_get': can't get const Chef::WebUIUser: uninitialized constant Chef::WebUIUser'
[2013-07-01 13:15:46 -0400] pluesch0r: upgraded the chef gem on my workstation. now, when i upload the old v10 cookbooks i get "`class_for_json_class': Unsupported `json_class` type 'Chef::WebUIUser' (JSON::ParserError)"
[2013-07-01 13:33:04 -0400] ichilton: Anyone come across anything in chef to manage the path?
[2013-07-01 13:35:05 -0400] gregj: matti: morning
[2013-07-01 13:37:31 -0400] matti: Morning.
[2013-07-01 13:37:34 -0400] matti: You here?
[2013-07-01 13:37:40 -0400] matti: O_o
[2013-07-01 13:37:48 -0400] gregj: ;]
[2013-07-01 13:37:51 -0400] gregj: [;
[2013-07-01 13:38:10 -0400] gregj: thought I'll lurk after your tweet
[2013-07-01 13:38:21 -0400] matti: Ah.
[2013-07-01 13:38:39 -0400] matti: I'd recommend #go-nuts. You may like Go.
[2013-07-01 13:39:04 -0400] gregj: python, and lua are enough for me, for now
[2013-07-01 13:39:07 -0400] gregj: (and objectiveC)
[2013-07-01 13:39:09 -0400] gregj: and sql..
[2013-07-01 13:40:24 -0400] pluesch0r: sigh. for the life of me, i can't find that error. not in the server log, not on the client.
[2013-07-01 13:40:26 -0400] matti: pluesch0r: There might be some incompatibility.
[2013-07-01 13:40:30 -0400] pluesch0r: or rather, the solution to that error.
[2013-07-01 13:40:39 -0400] pluesch0r: matti: where do i start looking?
[2013-07-01 13:40:47 -0400] pluesch0r: matti: and thanks for caring.
[2013-07-01 13:40:56 -0400] matti: pluesch0r: Not sure, but... when JSON parser sees "json_class" in there.
[2013-07-01 13:41:06 -0400] matti: pluesch0r: It will try to yeild such object back.
[2013-07-01 13:41:23 -0400] matti: pluesch0r: Normally, you can "fix" this by setting JSON.create_id to nil.
[2013-07-01 13:41:34 -0400] matti: pluesch0r: Obviusly, this is not going to work for a cookbook.
[2013-07-01 13:41:48 -0400] matti: pluesch0r: Check all your .json files i.e. Roles etc.
[2013-07-01 13:41:57 -0400] matti: pluesch0r: And make sure that you don't have anything custom there.
[2013-07-01 13:42:01 -0400] aramus_: Hello, I've been reading the opscode docs and for the "cookbook_file", I'm kind of unclear about the difference between the attributes "source" and "path". So let's say I have a file in my coobook "/files/mount.sh" and I want to copy that over in the client in "/mnt/mount.sh". Would I use source or path?
[2013-07-01 13:42:09 -0400] matti: pluesch0r: That having said, I am not sure where the problem is yet.
[2013-07-01 13:42:40 -0400] zaargy: go lang is awesome, yup yup
[2013-07-01 13:42:48 -0400] matti: aramus_: "source" denotes where Chef should find content of the file e.g. your cookbook files/default.
[2013-07-01 13:43:00 -0400] matti: aramus_: "path" is the path on the client side on its file system.
[2013-07-01 13:43:02 -0400] pluesch0r: matti: i think i've tried poking/uploading the whole server contents at least 20 times by now. maybe it's some sort of unique key stuff or whatever.
[2013-07-01 13:43:08 -0400] matti: aramus_: Path is the same as name.
[2013-07-01 13:43:13 -0400] pluesch0r: when i have a look at the webui it seems as if everything's there.
[2013-07-01 13:43:22 -0400] pluesch0r: but i don't want to go live on a hunch.
[2013-07-01 13:43:32 -0400] ChrisKnife:  test
[2013-07-01 13:43:57 -0400] matti: ChrisKnife: 200 OK
[2013-07-01 13:44:08 -0400] ChrisKnife: knife is hanging on any EC2 command that needs to touch my account. Terminates with "ERROR: Excon::Errors::Timeout: connect timeout reached"
[2013-07-01 13:44:09 -0400] matti: pluesch0r: How do you load data?
[2013-07-01 13:44:19 -0400] aramus_: matti: Oh, I get it. So the name should be where to load it and source is where it's coming from. How should I designate the source though? Do I assume the cookbook path is the base path?
[2013-07-01 13:44:30 -0400] ChrisKnife: So "knife ec2 flavor list" works fine.
[2013-07-01 13:44:39 -0400] pluesch0r: matti: http://pastebin.com/NZSEHrCm that's the error
[2013-07-01 13:44:47 -0400] ChrisKnife: "knife ec2 instance data" times out.
[2013-07-01 13:44:50 -0400] pluesch0r: i load the data with knife upload / -VV
[2013-07-01 13:45:10 -0400] kimm: i've installed chef server, and after that i've changed some config in the /etc/chef/chef-server.rb file (setting the notification email and nginx ssl cert info). Is it normal though that even if I run the chef-server reconfigure those data don't change? :\
[2013-07-01 13:45:20 -0400] aramus_: matti: for example, if my cookbook is in /cookbooks/test, and I have the file in /cookbooks/test/files, do I give the source to be "/files/mount.sh?
[2013-07-01 13:45:28 -0400] pwelch: does anyone know who I could ask to add knife-linode to the code reviews? Specifically this Pull request: https://github.com/opscode/knife-linode/pull/18
[2013-07-01 13:45:33 -0400] pluesch0r: followed http://docs.opscode.com/upgrade_server.html ("relatively simple process" .. yeah right).
[2013-07-01 13:45:37 -0400] pwelch: but there are several that have been out there for awhile
[2013-07-01 13:45:37 -0400] ChrisKnife: Using Opscode hosted free Chef
[2013-07-01 13:46:01 -0400] pluesch0r: kimm: tried restarting the server?
[2013-07-01 13:46:31 -0400] ChrisKnife: Knife is current version, downloaded yesterday, Win7, running under Git Bash. Knife EC2 worked once, enough to create an instance, but has been hanging the last 12 hours.
[2013-07-01 13:46:42 -0400] novegin_: Recipe: <Dynamically Defined Resource>
[2013-07-01 13:47:00 -0400] kimm: pluesch0r: yes.. even rebooted the vps, but the cert is the same, and so the notification email (both the default).. although the reconfigure script showed the changes
[2013-07-01 13:47:00 -0400] matti: aramus_: http://pastebin.com/u5Nx6zVh
[2013-07-01 13:47:01 -0400] novegin_: can*
[2013-07-01 13:47:05 -0400] novegin_: an someone tell how this dynamic definition works
[2013-07-01 13:47:46 -0400] matti: pluesch0r: Ah.
[2013-07-01 13:48:01 -0400] matti: pluesch0r: I'd recommend you upgrade by installing it as Omnibus package.
[2013-07-01 13:48:11 -0400] pluesch0r: matti: yeah. i am using an omnibus package.
[2013-07-01 13:48:14 -0400] matti: pluesch0r: Gems are fishy sometimes. Especially under rvm/rbenv.
[2013-07-01 13:48:24 -0400] pluesch0r: you mean an omnibus package for osx?
[2013-07-01 13:48:29 -0400] matti: Oh. OS X?
[2013-07-01 13:48:31 -0400] pluesch0r: for my workstation installation?
[2013-07-01 13:48:39 -0400] aramus_: matti: thanks. Is there any way to specify a path NOT in files/default?
[2013-07-01 13:49:03 -0400] pluesch0r: matti: i was running v10 on ubuntu 12.04 with packages by jtimberman. then i upgraded to v11 with omnibus.
[2013-07-01 13:49:05 -0400] matti: aramus_: Sure. It needs to be fully-qualified one.
[2013-07-01 13:49:21 -0400] kimm: i'm also wondering if i should change the default passwords for rabbitmq & postgresql, or if it doesn't matter as they just accept local connections
[2013-07-01 13:49:37 -0400] pluesch0r: i followed the tutorial that describes the migration process. i.e. downloaded the full current config with knife into a transfer directory, then installed v11, got it up and running, now struggling to upload the contents with knife.
[2013-07-01 13:49:39 -0400] aramus_: matti: alright, so an absolute path starting from /, right?
[2013-07-01 13:49:41 -0400] pluesch0r: my workstation is osx.
[2013-07-01 13:49:54 -0400] matti: aramus_: Otherwise Chef will try to do its lookup.
[2013-07-01 13:51:19 -0400] pluesch0r: matti: to debug that wonderful problem i'm running chef-server-ctl tail on the server .. but there don't seem to be _any_ errors.
[2013-07-01 13:51:59 -0400] matti: pluesch0r: Update JSON gem on your workstation.
[2013-07-01 13:52:14 -0400] matti: pluesch0r: Error is on your side.
[2013-07-01 13:52:18 -0400] matti: pluesch0r: Not the server.
[2013-07-01 13:52:34 -0400] mattt: what's the best way to re-encrypt data bags if you want to change your secret key ?
[2013-07-01 13:53:17 -0400] matti: aramus_: Just fiddle a bit. Mock a small cookbook and run as Solo.
[2013-07-01 13:53:40 -0400] matti: aramus_: If you want to see what is going on. Alternatively, fire up shef and switch it to cookbook mode and create yourself cookbook_file.
[2013-07-01 13:54:10 -0400] pluesch0r: matti: gonna try that. next step will be to upload the individual directories.
[2013-07-01 13:54:35 -0400] ChrisKnife: $ knife ec2 server list --verbose --verbose  c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/excon-0.23.0/lib/excon/socket.rb:177:in `rescue in block in connect': connect timeout reached (Excon::Errors::Timeout)         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/excon-0.23.0/lib/ excon/socket.rb:156:in `block in connect' ... knife:25:in `<top (required)>'EM] (options)         from c:/opscode/chef/bin/knife:23:in `load' 
[2013-07-01 13:55:00 -0400] pluesch0r: matti: another question .. with the v11 omnibus packages, there doesn't seem to be a process listening on port 4000; has v11 changed the default port? if so .. does that mean that i have to upgrade all my chef clients? 'cause i thought the server change from v10 to v11 would be seamless on the clients?!
[2013-07-01 13:55:07 -0400] HAPPYFUNBALL_: ERROR: TypeError: can't convert nil into String
[2013-07-01 13:55:07 -0400] HAPPYFUNBALL_: hey. I'm working on a custom bootstrapper, and am seeing this message when I attempt to run the script:
[2013-07-01 13:55:19 -0400] HAPPYFUNBALL_: what does this mean, and how can I determine what is trhowing the error?
[2013-07-01 13:55:32 -0400] matti: pluesch0r: 443
[2013-07-01 13:55:38 -0400] matti: pluesch0r: 4000 was deprecated.
[2013-07-01 13:56:00 -0400] matti: pluesch0r: And also, make sure that you have fully-qualified domain name on the Chef server side, which has IN A and IN PTR set correctly.
[2013-07-01 13:56:01 -0400] pluesch0r: matti: but the v10 client should work after changing the port?
[2013-07-01 13:56:05 -0400] matti: pluesch0r: Yes.
[2013-07-01 13:56:18 -0400] pluesch0r: ok
[2013-07-01 13:56:34 -0400] matti: ChrisKnife: Where does it try to connect?
[2013-07-01 13:56:40 -0400] matti: ChrisKnife: Do you have firewall?
[2013-07-01 13:57:12 -0400] matti: ChrisKnife: Can you connect with netcat/telnet to confirm connectivity?
[2013-07-01 13:57:30 -0400] matti: Basic 101 troubleshooting ;p
[2013-07-01 13:58:03 -0400] pluesch0r: matti: do you happen to know what config file i need to massage to have nginx only listen on a specific interface and not 0.0.0.0?
[2013-07-01 13:58:47 -0400] matti: pluesch0r: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/
[2013-07-01 13:59:24 -0400] matti: pluesch0r: "Chef Server Configuration
[2013-07-01 13:59:25 -0400] matti: "
[2013-07-01 13:59:26 -0400] matti: Ops
[2013-07-01 13:59:34 -0400] countdigi: pluesch0r: it will be manipulating your /etc/chef-server/chef-server.rb and running a chef-server-ctl reconfigure
[2013-07-01 13:59:37 -0400] countdigi: http://docs.opscode.com/config_rb_chef_server.html
[2013-07-01 13:59:52 -0400] HAPPYFUNBALL_: hey. I'm working on a custom bootstrapper, and am seeing this message when I attempt to run the script: ERROR: TypeError: can't convert nil into String. What does this mean, and how can I debug it?
[2013-07-01 14:00:13 -0400] matti: HAPPYFUNBALL_: Without code its hard to say.
[2013-07-01 14:00:31 -0400] HAPPYFUNBALL_: matti what code would you like to see?
[2013-07-01 14:00:43 -0400] matti: HAPPYFUNBALL_: Something you have is yielding nil and then it so happen that it is being coerced to string.
[2013-07-01 14:00:52 -0400] pluesch0r: matti: error was caused by a user json file, apparently. upgrading the json gem didn't help, removing the user file did.
[2013-07-01 14:00:59 -0400] pluesch0r: matti: thanks a bunch.
[2013-07-01 14:01:08 -0400] matti: pluesch0r: :)
[2013-07-01 14:01:29 -0400] HAPPYFUNBALL_: matti is there a way to output the line numbe ron error?
[2013-07-01 14:01:31 -0400] gyre007: cheeseplus: https://gist.github.com/DavidAllison/5288249
[2013-07-01 14:01:34 -0400] gyre007: :)
[2013-07-01 14:02:19 -0400] ChrisKnife: matti: (thanks!) No firewall, presume it's using https://api.opscode.com:443/organizations/[myorg]
[2013-07-01 14:02:21 -0400] matti: HAPPYFUNBALL_: Try enabling more verbose output.
[2013-07-01 14:02:31 -0400] HAPPYFUNBALL_: matti no dice
[2013-07-01 14:02:48 -0400] HAPPYFUNBALL_: -VVV doesn't give me a line number
[2013-07-01 14:03:02 -0400] matti: HAPPYFUNBALL_: Nothing in logs?
[2013-07-01 14:03:18 -0400] HAPPYFUNBALL_: where is the relevant log for this usually located?
[2013-07-01 14:03:54 -0400] matti: HAPPYFUNBALL_: Does this work? openssl s_client -connect api.opscode.com:443
[2013-07-01 14:04:07 -0400] matti: HAPPYFUNBALL_: Or, anything else capable of talking SSL.
[2013-07-01 14:04:16 -0400] matti: Oh shit.
[2013-07-01 14:04:21 -0400] matti: ChrisKnife: -> openssl s_client -connect api.opscode.com:443
[2013-07-01 14:04:25 -0400] HAPPYFUNBALL_: also, to be clear, I am using a slightly modified version of the default bootstrap.erb
[2013-07-01 14:04:34 -0400] matti: HAPPYFUNBALL_: What did you changed?
[2013-07-01 14:06:23 -0400] matti: zaargy: +111!!!!!
[2013-07-01 14:07:03 -0400] HAPPYFUNBALL_: matti I replaced the opscode downloader with the following http://pastebin.com/dKVf0aj5
[2013-07-01 14:07:14 -0400] ichilton: Anyone have any thoughts on cloning a github private repo as part of a chef provision?
[2013-07-01 14:07:40 -0400] matti: HAPPYFUNBALL_: "exists"?
[2013-07-01 14:08:20 -0400] matti: HAPPYFUNBALL_: That still should not yield nil
[2013-07-01 14:08:32 -0400] HAPPYFUNBALL_: matti sec
[2013-07-01 14:08:56 -0400] matti: HAPPYFUNBALL_: This is not correct sh/Bash.
[2013-07-01 14:09:01 -0400] matti: HAPPYFUNBALL_: By the way :)
[2013-07-01 14:09:59 -0400] ChrisKnife: matti: curl on that URL returns { "error": "401 - Unauthorized.  You must properly authenticate your API requests!" }
[2013-07-01 14:10:09 -0400] matti: ChrisKnife: That's fine.
[2013-07-01 14:10:16 -0400] matti: ChrisKnife: It means that it can connect.
[2013-07-01 14:10:38 -0400] matti: ChrisKnife: Review you knife configuration et al, to see if there is an old address etc etc.
[2013-07-01 14:10:41 -0400] pluesch0r: countdigi: i don't have a file named /etc/chef-server/chef-server.rb ;)
[2013-07-01 14:10:57 -0400] matti: pluesch0r: You won't.
[2013-07-01 14:11:06 -0400] matti: pluesch0r: Need to careate it manually.
[2013-07-01 14:11:20 -0400] matti: create*
[2013-07-01 14:11:30 -0400] pluesch0r: matti: okay. but also, i don't see a config property that i can use to pin my nginx to a specific ip.
[2013-07-01 14:11:42 -0400] HAPPYFUNBALL_: matti this is my bootstrap.erb http://pastebin.com/hc6sdrKU this is the default one: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb this is the command i am running: knife bootstrap mynewnode.com --template-file /etc/chef/repository/bootstrap/bootstrap_rhel5_x86_64.erb -VVVV
[2013-07-01 14:11:47 -0400] matti: pluesch0r: Did you read the web site I gave you?
[2013-07-01 14:12:42 -0400] matti: HAPPYFUNBALL_: Bash has no concept of returning from functions.
[2013-07-01 14:12:47 -0400] matti: HAPPYFUNBALL_: Do you know Bash?
[2013-07-01 14:13:10 -0400] pluesch0r: matti: yes.
[2013-07-01 14:13:17 -0400] HAPPYFUNBALL_: matti this is erubis code.
[2013-07-01 14:13:25 -0400] pluesch0r: matti: i only found configuration options for enabling and disabling the webui alltogether.
[2013-07-01 14:13:32 -0400] matti: HAPPYFUNBALL_: Emm.
[2013-07-01 14:13:41 -0400] matti: HAPPYFUNBALL_: Template or not, your Bash bits are incorrect.
[2013-07-01 14:13:54 -0400] HAPPYFUNBALL_: matti they're not my bash bits
[2013-07-01 14:14:00 -0400] ChrisKnife: matti: openssl connects and GET / returns good HTML
[2013-07-01 14:14:01 -0400] HAPPYFUNBALL_: they're opscode's bash bits
[2013-07-01 14:14:04 -0400] matti: LOL
[2013-07-01 14:14:20 -0400] HAPPYFUNBALL_: matti this is the default boostrapper https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-07-01 14:14:31 -0400] matti: Anyway.
[2013-07-01 14:15:01 -0400] HAPPYFUNBALL_: does this not jive?
[2013-07-01 14:15:17 -0400] matti: HAPPYFUNBALL_: The nil might be coming from some @chef_config
[2013-07-01 14:16:52 -0400] HAPPYFUNBALL_: matti are you familiar with the bootstrap.erb on github?
[2013-07-01 14:17:14 -0400] matti: HAPPYFUNBALL_: Does the original works?
[2013-07-01 14:18:37 -0400] HAPPYFUNBALL_: matti not if I run it like this: knife bootstrap lldg3tds01.com --template-file /etc/chef/repository/bootstrap/bootstrap.erb -VVVV
[2013-07-01 14:18:47 -0400] pluesch0r: matti: i've understood that i can change the port nginx is listening to etc. via nginx['ssl_port'] = 444 .. but i couldn't find a setting that will let me pin nginx to a specific ip.
[2013-07-01 14:19:22 -0400] pluesch0r: i've also got other websites on that host and nginx is blocking the apache that would normally answer on 443. ;) so i thought it would be the best idea do give chef its own dedicated ip.
[2013-07-01 14:20:38 -0400] matti: pluesch0r: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/attributes/default.rb
[2013-07-01 14:20:50 -0400] matti: HAPPYFUNBALL_: What is going on then?
[2013-07-01 14:20:59 -0400] HAPPYFUNBALL_: matti I have not the slightest
[2013-07-01 14:21:07 -0400] HAPPYFUNBALL_: this is insane
[2013-07-01 14:21:55 -0400] HAPPYFUNBALL_: matti perhaps I'm missing something regarding custom bootstrappers. do you know much about them?
[2013-07-01 14:22:02 -0400] matti: HAPPYFUNBALL_: Not sure what, but something coming from Ruby's side is empty or not there i.e. Hash etc.
[2013-07-01 14:22:08 -0400] matti: HAPPYFUNBALL_: Hence you get the exception.
[2013-07-01 14:22:25 -0400] HAPPYFUNBALL_: matti are you an opscode guy?
[2013-07-01 14:22:33 -0400] matti: HAPPYFUNBALL_: Do you have the same error with OpsCode one?
[2013-07-01 14:22:38 -0400] matti: HAPPYFUNBALL_: I am not, does this bother you?
[2013-07-01 14:22:47 -0400] HAPPYFUNBALL_: no. sec
[2013-07-01 14:22:49 -0400] matti: ;]
[2013-07-01 14:23:15 -0400] matti: pluesch0r: Does this help?
[2013-07-01 14:23:26 -0400] gchristensen: could someone running on ec2 send me their ohai output? specifically regardingtheir `networking` block (you can anonymize your IPs if you'd like) and the`cloud` block?
[2013-07-01 14:23:38 -0400] matti: gchristensen: One second.
[2013-07-01 14:24:15 -0400] gchristensen: ahh! fantatic!
[2013-07-01 14:24:30 -0400] pluesch0r: matti: no, sorry. maybe i'm bling .. but i need something like default['chef_server']['nginx']['listen_ip'] .. all other services have got something comparable to that. but: 'tcp        0      0 *:https                 *:*                     LISTEN      14671/nginx.conf'
[2013-07-01 14:24:35 -0400] pluesch0r: s/bling/blind/
[2013-07-01 14:25:20 -0400] pluesch0r: .. or listen_address
[2013-07-01 14:25:36 -0400] tabolario: pluesch0r: i wonder if you could just pass ['nginx']['ssl_port'] and ['nginx']['non_ssl_port'] as a string with "IP_ADDRESS 443"
[2013-07-01 14:26:34 -0400] tabolario: since the listen directive for nginx even for ssl is going to look like "0.0.0.0:443 ssl"
[2013-07-01 14:26:49 -0400] tabolario: er sorry, so pass it like "IP_ADDRESS:443" and "IP_ADDRESS:80"
[2013-07-01 14:27:16 -0400] pluesch0r: oh really? gonna give that a try then. but i'd guess that the 0.0.0.0 is hardcoded then.
[2013-07-01 14:27:18 -0400] matti: gchristensen: http://pastebin.com/Z9FmRMKt
[2013-07-01 14:27:24 -0400] matti: gchristensen: No v6 though.
[2013-07-01 14:27:37 -0400] tabolario: good point it might be
[2013-07-01 14:28:13 -0400] pluesch0r: listen <%= @non_ssl_port %>;
[2013-07-01 14:28:15 -0400] pluesch0r: looks good.
[2013-07-01 14:28:38 -0400] gchristensen: matti: can you send me the equivalent of node['network'] and node['cloud']?
[2013-07-01 14:28:44 -0400] tabolario: pluesch0r: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/templates/default/nginx.conf.erb
[2013-07-01 14:28:46 -0400] matti: gchristensen: Sure.
[2013-07-01 14:28:56 -0400] ChrisKnife: matti: I think I fixed it by commenting this out in .chef/knife.rb: #knife[:region]                = 'us-east'
[2013-07-01 14:29:10 -0400] tabolario: it'll break doing it that way, unfortunately
[2013-07-01 14:29:15 -0400] ChrisKnife: matti: that was redundant with "knife[:availability_zone]     = 'us-east-1a'"
[2013-07-01 14:29:20 -0400] tabolario: because of https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/templates/default/nginx.conf.erb#L56
[2013-07-01 14:29:38 -0400] ChrisKnife: matti: Can't imagine why that caused a hang.
[2013-07-01 14:30:17 -0400] tabolario: looks like with the way that template is set up there's not a good way to work around it and specify an bind address from the config
[2013-07-01 14:30:28 -0400] tabolario: you could always rebuild the omnibus package yourself though :D
[2013-07-01 14:31:11 -0400] pluesch0r: tabolario: worked, thanks@
[2013-07-01 14:31:16 -0400] pluesch0r: matti: thanks!
[2013-07-01 14:31:21 -0400] tabolario: oh that did work?
[2013-07-01 14:31:30 -0400] ChrisKnife: matti: thanks again
[2013-07-01 14:31:42 -0400] pluesch0r: tabolario: yeah.
[2013-07-01 14:32:29 -0400] matti: gchristensen: http://pastebin.com/raw.php?i=CdcRGrHK
[2013-07-01 14:32:46 -0400] tabolario: pluesch0r: oh right, http is disabled by default i see now
[2013-07-01 14:32:55 -0400] tabolario: pluesch0r: you shouldn't run into the issue i described :)
[2013-07-01 14:33:04 -0400] matti: ChrisKnife: Nice!
[2013-07-01 14:33:10 -0400] matti: ChrisKnife: They are not quite the same thing.
[2013-07-01 14:33:18 -0400] HAPPYFUNBALL_: matti the reason why I asked if you were on opscode staff is because there looks liek there's something weird going on here, and I'm no clear as to *why* the default template wouldn't be working
[2013-07-01 14:33:22 -0400] matti: ChrisKnife: But, I am not sure why knife[:region] is causing issues for you.
[2013-07-01 14:33:34 -0400] matti: HAPPYFUNBALL_: I understand.
[2013-07-01 14:33:38 -0400] gchristensen: matti: and does node['ipaddress'] report the public IP or the private IP? (thank you a *ton* - this is helping a lot on making my dedicated hardware work better with recipes which work best on AWS.)
[2013-07-01 14:33:42 -0400] matti: HAPPYFUNBALL_: You can ask on mailing list.
[2013-07-01 14:33:50 -0400] matti: HAPPYFUNBALL_: Or wait for coderanger or somebody else to wake up.
[2013-07-01 14:34:01 -0400] HAPPYFUNBALL_: matti unfortunately, I have to get this thing done yesterday
[2013-07-01 14:34:07 -0400] HAPPYFUNBALL_: I have deliverables due tomorrow
[2013-07-01 14:34:40 -0400] matti: gchristensen: The "ipaddress" is just generic Linux one.
[2013-07-01 14:34:45 -0400] HAPPYFUNBALL_: the examples section at the bottom of the page seems to inicate that I am doing the right thing: http://docs.opscode.com/knife_bootstrap.html
[2013-07-01 14:34:48 -0400] matti: gchristensen: It will report whatever is on eth0
[2013-07-01 14:34:53 -0400] matti: gchristensen: Which in case of EC2 is private IP.
[2013-07-01 14:35:00 -0400] gchristensen: got it
[2013-07-01 14:35:09 -0400] matti: gchristensen: 2.2.2.2 then ;d
[2013-07-01 14:35:25 -0400] matti: HAPPYFUNBALL_: I see. Dissect the probem then.
[2013-07-01 14:35:27 -0400] HAPPYFUNBALL_: coderanger wake up foo
[2013-07-01 14:35:30 -0400] matti: HAPPYFUNBALL_: Does it work with the default one?
[2013-07-01 14:35:34 -0400] gchristensen: I'm ... considering ... making my ohai plugin override the 'ipaddress' attribute and setting it to the private IP. is that a terrible idea? because I really want it to be a great idea :)
[2013-07-01 14:35:36 -0400] matti: HAPPYFUNBALL_: If not, then what is the error?
[2013-07-01 14:35:45 -0400] matti: HAPPYFUNBALL_: Then, compare theirs and yours with diff.
[2013-07-01 14:35:53 -0400] pluesch0r: tabolario: i think it's enabled over here; but i've set the non-ssl port as well so i should be okay.
[2013-07-01 14:35:54 -0400] HAPPYFUNBALL_: matti no, it doesn't. I get the same error
[2013-07-01 14:35:56 -0400] gchristensen: because my default route is my public IP, which is the opposite behavior I want in 9 out of 10 situations.
[2013-07-01 14:36:00 -0400] matti: HAPPYFUNBALL_: Then run yours -- do you get the same error?
[2013-07-01 14:36:01 -0400] matti: HAPPYFUNBALL_: OK.
[2013-07-01 14:36:19 -0400] HAPPYFUNBALL_: do you know if this is the current bootstrapper script? https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-07-01 14:36:20 -0400] matti: HAPPYFUNBALL_: We need to narrow which part causes it.
[2013-07-01 14:36:29 -0400] HAPPYFUNBALL_: coderanger said it was
[2013-07-01 14:36:34 -0400] tabolario: pluesch0r: well there's going to be a weird rewrite rule then ;)
[2013-07-01 14:36:35 -0400] matti: HAPPYFUNBALL_: Most likely.
[2013-07-01 14:37:01 -0400] matti: pluesch0r: Cool beans
[2013-07-01 14:37:48 -0400] tabolario: pluesch0r: if you have http access enabled with 'enable_non_ssl' and you do the bind address in the port config like above then you'll end up with a rewrite rule like:
[2013-07-01 14:37:51 -0400] HAPPYFUNBALL_: if I run the following using the the bootstrap.erb from that link I get an error: knife bootstrap lldg3tds01.com --template-file /etc/chef/repository/bootstrap/bootstrap.erb -VVVV // ERROR: TypeError: can't convert nil into String
[2013-07-01 14:38:00 -0400] tabolario: rewrite ^(.*) https://$server_name:IP_ADDRESS:443$1 permanent;
[2013-07-01 14:38:40 -0400] tabolario: HAPPYFUNBALL: can you pastie your knife.rb?
[2013-07-01 14:38:47 -0400] HAPPYFUNBALL_: yeah sec
[2013-07-01 14:38:51 -0400] tabolario: you might have something missing in there
[2013-07-01 14:40:01 -0400] HAPPYFUNBALL_: tabolario http://pastebin.com/2H2ui4Qq
[2013-07-01 14:41:01 -0400] pluesch0r: tabolario: ok, thanks for the warning. :)
[2013-07-01 14:41:25 -0400] pluesch0r: tabolario: i think http is disabled but nginx itself is listening on 80. had to pin it away to my apache2 would work again. :)
[2013-07-01 14:41:38 -0400] tabolario: pluesch0r: aha
[2013-07-01 14:42:00 -0400] pluesch0r: yeah. would like to disable nginx for port 80 alltogether, but whatever.
[2013-07-01 14:42:09 -0400] tabolario: well here's one you could debug it HAPPYFUNBALL_,
[2013-07-01 14:42:13 -0400] tabolario: one way*
[2013-07-01 14:43:32 -0400] tabolario: it would be tedius, but you could pull down that template, wrap all of the ERB statements in rescues that print the stacktrace from the exception
[2013-07-01 14:43:51 -0400] matti: HAPPYFUNBALL_: Experiment whit this: http://pastebin.com/BYPJpWFM
[2013-07-01 14:43:55 -0400] tabolario: someone else please chime in if that's a horrible way to do help
[2013-07-01 14:44:19 -0400] tabolario: do what matti said :)
[2013-07-01 14:44:21 -0400] matti: HAPPYFUNBALL_: Sorry, this http://pastebin.com/U0FsTW6z
[2013-07-01 14:44:43 -0400] tabolario: that's a bit more elegant than mine
[2013-07-01 14:44:44 -0400] matti: HAPPYFUNBALL_: If this blows up, or something is missing there. You will know.
[2013-07-01 14:45:04 -0400] matti: HAPPYFUNBALL_: They you can start finding out after which line it blows up.
[2013-07-01 14:45:13 -0400] matti: HAPPYFUNBALL_: And then you will be able to pin-point what is it.
[2013-07-01 14:46:01 -0400] matti: HAPPYFUNBALL_: How do you find out line? You put exit (or something to terminate Ruby) in the middle of the file, etc etc.
[2013-07-01 14:46:25 -0400] matti: tabolario: Sorry haven't seen your approach ;/ Didn't wanted to intrude.
[2013-07-01 14:46:58 -0400] tabolario: matti: oh no well my approach was the probably about as brute force as you can get :) i told him to download the template and put rescues around all the erb blocks
[2013-07-01 14:47:08 -0400] matti: Ah ;p
[2013-07-01 14:48:05 -0400] matti: :)
[2013-07-01 14:49:33 -0400] matti: tabolario: Look at the original template, and tell me... because I might be going bit crazy. But, how do they plan to get exists function to behave as intended there? For me it always returns 1.
[2013-07-01 14:49:52 -0400] tabolario: the original one you posted?
[2013-07-01 14:49:57 -0400] matti: No.
[2013-07-01 14:50:03 -0400] tabolario: oh the opscode chef-full one
[2013-07-01 14:50:05 -0400] matti: tabolario: https://raw.github.com/opscode/chef/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-07-01 14:50:27 -0400] matti: tabolario: return statement in Bash is a bit like break in its behaviour, does not really return anything.
[2013-07-01 14:50:40 -0400] matti: tabolario: Unless I missed some things added to Bash?
[2013-07-01 14:52:43 -0400] HAPPYFUNBALL_: matti where would I run that code?
[2013-07-01 14:52:58 -0400] tabolario: matti: well it's not really returning the value, the number is specifying the status of the function, it's more of a boolean (0 success, non-zero failure)
[2013-07-01 14:53:21 -0400] matti: HAPPYFUNBALL_: Its your template ;s
[2013-07-01 14:53:31 -0400] matti: tabolario: I know.
[2013-07-01 14:53:38 -0400] matti: tabolario: It still does not work.
[2013-07-01 14:53:53 -0400] matti: tabolario: No matter what I put there it will be 1 in my case.
[2013-07-01 14:54:01 -0400] tabolario: matti: oh sorry i see what you're saying
[2013-07-01 14:54:04 -0400] tabolario: let's see....
[2013-07-01 14:55:25 -0400] matti: tabolario: Plus, a simple -f / -x would do there?
[2013-07-01 14:55:33 -0400] HAPPYFUNBALL_: matti tabolario when i use the test template matti created, this happens: http://pastebin.com/sziCTCAV
[2013-07-01 14:55:39 -0400] matti: tabolario: Not like they rely on PATH there ...
[2013-07-01 14:55:50 -0400] matti: tabolario: Giving fully-qualified paths.
[2013-07-01 14:56:18 -0400] matti: HAPPYFUNBALL_: OK, now... does it create file on the remote server in /tmp?
[2013-07-01 14:56:46 -0400] matti: HAPPYFUNBALL_: If not, then we know that is blows up locally.
[2013-07-01 14:57:02 -0400] HAPPYFUNBALL_: sec
[2013-07-01 14:57:48 -0400] HAPPYFUNBALL_: matti nope
[2013-07-01 14:57:54 -0400] HAPPYFUNBALL_: nothing on the remote host
[2013-07-01 14:57:55 -0400] matti: OK.
[2013-07-01 14:58:38 -0400] matti: HAPPYFUNBALL_: Make a copy of this file. And put <%= exit %> in the middle.
[2013-07-01 14:59:12 -0400] matti: HAPPYFUNBALL_: Run again. If there is no nil to String exception and it just exists, move exit to after next instructions.
[2013-07-01 14:59:28 -0400] HAPPYFUNBALL_: matti what is "this file"
[2013-07-01 14:59:36 -0400] matti: The template from me.
[2013-07-01 14:59:40 -0400] matti: http://pastebin.com/U0FsTW6z
[2013-07-01 14:59:57 -0400] HAPPYFUNBALL_: kk sec
[2013-07-01 15:00:07 -0400] tabolario: matti: i'm trying to get it to return 1 and i can't haha
[2013-07-01 15:00:28 -0400] matti: HAPPYFUNBALL_: http://pastebin.com/zXFSEEQq
[2013-07-01 15:00:46 -0400] matti: HAPPYFUNBALL_: After each run that just exited, keep removing 1 exit from the top.
[2013-07-01 15:00:55 -0400] matti: tabolario: Bang.
[2013-07-01 15:01:05 -0400] alexbst: http://www.black-sabbath.com/wp-content/uploads/2013/06/3-IMG_0532-001.jpg
[2013-07-01 15:01:12 -0400] matti: tabolario:
[2013-07-01 15:01:12 -0400] matti: krzysztof@apple ~ $ bash --version
[2013-07-01 15:01:13 -0400] matti: GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin11)
[2013-07-01 15:01:13 -0400] matti: Copyright (C) 2007 Free Software Foundation, Inc.
[2013-07-01 15:01:13 -0400] tabolario: but yeah it could certainly use an -f too
[2013-07-01 15:01:18 -0400] matti: tabolario: Not 4, so maybe ...
[2013-07-01 15:01:26 -0400] matti: tabolario: Indeed.
[2013-07-01 15:01:29 -0400] HAPPYFUNBALL_: matti. I don't know if the code ever even gets to this template file
[2013-07-01 15:01:45 -0400] matti: HAPPYFUNBALL_: True.
[2013-07-01 15:01:51 -0400] tabolario: i'm very much not a bash wizard though, i've never really used `command` before
[2013-07-01 15:01:56 -0400] tabolario: unless that's an alias for which
[2013-07-01 15:01:56 -0400] HAPPYFUNBALL_: matti AH!
[2013-07-01 15:01:57 -0400] HAPPYFUNBALL_: it does
[2013-07-01 15:02:03 -0400] HAPPYFUNBALL_: sec
[2013-07-01 15:02:06 -0400] matti: There you go.
[2013-07-01 15:02:12 -0400] matti: Methodic apporch to troubleshooting ;p
[2013-07-01 15:02:19 -0400] HAPPYFUNBALL_: give me a second
[2013-07-01 15:02:23 -0400] matti: tabolario: which is more common, yeah.
[2013-07-01 15:03:22 -0400] HAPPYFUNBALL_: Matti this script is supposed to create /tmp/bootstrap.txt on the remote node, righT?
[2013-07-01 15:03:26 -0400] matti: Yes.
[2013-07-01 15:03:37 -0400] HAPPYFUNBALL_: that's weird
[2013-07-01 15:03:38 -0400] HAPPYFUNBALL_: it isn't
[2013-07-01 15:03:47 -0400] matti: Well, if it exists...
[2013-07-01 15:03:58 -0400] HAPPYFUNBALL_: it doesn't
[2013-07-01 15:04:03 -0400] matti: HAPPYFUNBALL_: nil error?
[2013-07-01 15:04:30 -0400] HAPPYFUNBALL_: nope
[2013-07-01 15:04:50 -0400] matti: http://pastebin.com/Qwp250xZ
[2013-07-01 15:04:56 -0400] matti: So, that should work.
[2013-07-01 15:05:27 -0400] HAPPYFUNBALL_: matti this doesn't create a new file on the remote node http://pastebin.com/zXFSEEQq
[2013-07-01 15:05:46 -0400] matti: You can do s/exit/exit!/
[2013-07-01 15:06:20 -0400] HAPPYFUNBALL_: what exactly does this line do
[2013-07-01 15:06:21 -0400] HAPPYFUNBALL_: cat <<EOF > /tmp/bootstrap.txt <%= knife_config[:bootstrap_proxy] %> EOF
[2013-07-01 15:06:50 -0400] matti: Saves value of knife_config[:bootstrap_proxy] to /tmp/bootstrap.txt
[2013-07-01 15:08:29 -0400] matti: HAPPYFUNBALL_: Does this do anything? http://pastebin.com/NHidbQAt
[2013-07-01 15:11:45 -0400] HAPPYFUNBALL_: matti that worked
[2013-07-01 15:11:59 -0400] HAPPYFUNBALL_: although, the script promted my for a password
[2013-07-01 15:12:02 -0400] matti: Saved value in /tmp?
[2013-07-01 15:12:06 -0400] HAPPYFUNBALL_: that shouldn't happen, right?
[2013-07-01 15:12:13 -0400] matti: What?
[2013-07-01 15:12:21 -0400] matti: Password?
[2013-07-01 15:12:28 -0400] matti: Do you have SSH keys setup?
[2013-07-01 15:12:47 -0400] matti: Something is fishy with your Knife configuration, maybe.
[2013-07-01 15:14:09 -0400] gaffneyc: With test-kitchen is there any setting for doing a preflight command like `apt-get update`? We're running into issues with our images since the version in apt has been yanked.
[2013-07-01 15:16:03 -0400] HAPPYFUNBALL_: matti http://pastebin.com/HUM0LnjD wtf?
[2013-07-01 15:17:33 -0400] HAPPYFUNBALL_: does it promt for the password because the public key hasn't been added to the host yet?
[2013-07-01 15:19:14 -0400] matti: HAPPYFUNBALL_: -p 'XXXX'
[2013-07-01 15:19:22 -0400] matti: Sorry, -P
[2013-07-01 15:19:23 -0400] HAPPYFUNBALL_: kk
[2013-07-01 15:19:27 -0400] matti: http://docs.opscode.com/knife_bootstrap.html
[2013-07-01 15:19:53 -0400] matti: But, you know that it is not blowing up with nil exception.
[2013-07-01 15:20:00 -0400] matti: So, find out now where it does.
[2013-07-01 15:20:01 -0400] HAPPYFUNBALL_: yeah
[2013-07-01 15:20:07 -0400] HAPPYFUNBALL_: I am going to debug now
[2013-07-01 15:20:12 -0400] matti: Cool beans
[2013-07-01 15:20:13 -0400] matti: :)
[2013-07-01 15:20:13 -0400] HAPPYFUNBALL_: thanks mang
[2013-07-01 15:20:23 -0400] matti: Sure thing ;]
[2013-07-01 15:30:13 -0400] prometheanfire: what is the best way to back up all the orgs in a private chef install?
[2013-07-01 15:39:44 -0400] aramus_: Hello! If I wanted to store a variable that contained the name of a script I wanted to run, would it be better to store it as an attribute or in a data bag?
[2013-07-01 15:40:53 -0400] cheeseplus: aramus_: attribute should be adequate, data bag seems overkill for that purpose
[2013-07-01 15:57:57 -0400] j^2: hey, anyone use knife-rackspace with ORD here?
[2013-07-01 15:58:01 -0400] j^2: i'm having trouble with it
[2013-07-01 15:58:11 -0400] j^2: i run knife rackspace server list
[2013-07-01 15:58:22 -0400] j^2: and none of my servers come back
[2013-07-01 15:58:28 -0400] j^2: i run nova list they come back
[2013-07-01 15:58:58 -0400] j^2: example:
[2013-07-01 15:58:59 -0400] j^2: https://gist.github.com/jjasghar/48641e2961e61a02583b
[2013-07-01 16:00:53 -0400] aramus_: Hello, is it possible for a recipe to use attributes of a different cookbook?
[2013-07-01 16:01:27 -0400] geggam: anyone have cool powerpoints for chef ? i won the political battle and am totally unprepared to talk about chef :)
[2013-07-01 16:04:38 -0400] Death_Syn: geggam: might dig around opscode.  i've seen a couple of their presentations in person at various ruby confs
[2013-07-01 16:04:45 -0400] Death_Syn: and the slidedecks were online later
[2013-07-01 16:04:50 -0400] Death_Syn: but i don't have any urls handyu
[2013-07-01 16:09:34 -0400] prefix: anyone in here have any suggestions for automating scp for a custom bootstrap operation?
[2013-07-01 16:14:04 -0400] jhammerman: Hi Chef IRC. We have a template that has a notifies :restart clause to a daemon associated with it. It seems that the restart action is triggered every time, I'm guessing since the file is rendered dynamically. Is there a way to prevent the restart from occurring using the template resource? Or do I need to set up a 'deployed' tag to prevent the file from rendering unless there are specific changes I'm attempting to push out?
[2013-07-01 16:20:59 -0400] cwj: jhammerman: if your template notifies the service on every chef run, then chef thinks your template is being changed as a result of the run
[2013-07-01 16:21:41 -0400] cwj: jhammerman: when updating a template chef typically keeps a backup of the last file around, so maybe you can diff the two and see whats changing
[2013-07-01 16:23:10 -0400] jhammerman: cwj: OK, thanks
[2013-07-01 16:23:21 -0400] prefix: anyone in here have any suggestions for automating scp for a custom bootstrap operation?
[2013-07-01 16:24:17 -0400] jtimberman: geggam: my speakerdeck and slideshare accounts have a bunch of presentations I've done over the last four years.
[2013-07-01 16:24:22 -0400] jtimberman: speakerdeck.com/jtimberman
[2013-07-01 16:24:33 -0400] jtimberman: http://www.slideshare.net/jtimberman
[2013-07-01 16:25:15 -0400] prefix: or, if it's not possible with SCP, how would I go about copying the chef installer to a new node automatically?
[2013-07-01 16:26:11 -0400] cwj: prefix: have you looked at the bootstrap script templates which ship with chef as a starting point? https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-07-01 16:26:26 -0400] prefix: cwj of course I have
[2013-07-01 16:26:49 -0400] prefix: my environment won't have access to the open internet
[2013-07-01 16:27:08 -0400] prefix: accordingly, I cannot use the default bootstrapper
[2013-07-01 16:27:21 -0400] prefix: I would like to use SCP, but I'm not sure it's possible
[2013-07-01 16:28:29 -0400] zaargy: what's a good cookbook with lots of minitest hanlder tests?
[2013-07-01 16:28:54 -0400] matti: Hey jtimberman
[2013-07-01 16:29:05 -0400] matti: prefix: Still issues?
[2013-07-01 16:29:18 -0400] matti: zaargy: I haven't seen one, aside of ones I've made ;]
[2013-07-01 16:29:26 -0400] matti: zaargy: rspec seem to be more popular.
[2013-07-01 16:29:26 -0400] prefix: matti sort of. trying to figur eout how I can SCP files without user input
[2013-07-01 16:29:54 -0400] zaargy: matti: yah :S
[2013-07-01 16:30:03 -0400] matti: prefix: You don't have to scp necessarily.
[2013-07-01 16:30:18 -0400] prefix: matti what other methods would you suggest?
[2013-07-01 16:31:54 -0400] matti: prefix: It might not be easy to do, but you can fire up netcat to listen and send file over etc.
[2013-07-01 16:32:00 -0400] matti: prefix: There is always a way.
[2013-07-01 16:32:00 -0400] prefix: hm
[2013-07-01 16:32:05 -0400] prefix: looks like I can use expect
[2013-07-01 16:32:29 -0400] matti: prefix: How do you create machines for bootstrapoping?
[2013-07-01 16:32:58 -0400] prefix: they're automatically provisioned as blank RHEL5 images atm
[2013-07-01 16:33:22 -0400] matti: Can you seed SSH keys?
[2013-07-01 16:33:27 -0400] prefix: nope
[2013-07-01 16:33:41 -0400] prefix: welcome 2 my headache
[2013-07-01 16:33:59 -0400] matti: Can you change it so you can have bootstrap key added?
[2013-07-01 16:34:04 -0400] prefix: nope
[2013-07-01 16:34:42 -0400] matti: But you do have SSH access?
[2013-07-01 16:34:52 -0400] matti: With some password?
[2013-07-01 16:34:57 -0400] matti: Unless its random.
[2013-07-01 16:34:58 -0400] prefix: yes
[2013-07-01 16:35:10 -0400] prefix: I do have ssh access
[2013-07-01 16:35:22 -0400] matti: prefix: Well then, as part of you bootstrap script, seed SSH key.
[2013-07-01 16:35:25 -0400] matti: prefix: And then SCP.
[2013-07-01 16:35:44 -0400] prefix: hm
[2013-07-01 16:35:44 -0400] prefix: sec
[2013-07-01 16:36:15 -0400] prefix: I'd just need to add the publickey, right?
[2013-07-01 16:36:34 -0400] matti: prefix: http://linux.die.net/man/1/sshpass
[2013-07-01 16:36:36 -0400] matti: prefix: Yes.
[2013-07-01 16:36:41 -0400] matti: prefix: http://serverfault.com/questions/241588/how-to-automate-ssh-login-with-password
[2013-07-01 16:36:59 -0400] prefix: sshpass wont work on hosts that I haven't SSH'd into yet
[2013-07-01 16:37:05 -0400] gleam: i love the reply that has the example password of "hunter2"
[2013-07-01 16:37:14 -0400] matti: gleam: Hahah
[2013-07-01 16:37:17 -0400] matti: gleam: +1
[2013-07-01 16:40:31 -0400] aramus_: Hello, how would one run a recipe in a different cookbook in another recipe?
[2013-07-01 16:41:31 -0400] matti: You mean, from a different?
[2013-07-01 16:41:42 -0400] aramus_: from* ys
[2013-07-01 16:41:43 -0400] aramus_: yes*
[2013-07-01 16:42:08 -0400] cpasmoi: with include_recipe i guess ?
[2013-07-01 16:42:24 -0400] matti: ;]
[2013-07-01 16:42:55 -0400] aramus_: Would that include_recipe run the recipe before doing the rest of the current recipe?
[2013-07-01 16:45:35 -0400] matti: aramus_: Did you ever read any of the documents on Chef web site?
[2013-07-01 16:46:05 -0400] matti: aramus_: There are some hints and examples there. Also reading other cookbooks might help.
[2013-07-01 16:46:50 -0400] aramus_: I'm on http://docs.opscode.com/chef/ but a lot of these little questions are unexplained. I'm not sure if this is true but the learning curve for chef is really steep.
[2013-07-01 16:47:24 -0400] matti: Depends I suppose.
[2013-07-01 16:48:07 -0400] aramus_: matti: and http://docs.opscode.com/chef/essentials_cookbook_recipes.html talks about include_recipe but it does not mention whether it "forks" or if that recipe is run serially.
[2013-07-01 16:49:34 -0400] matti: aramus_: http://docs.opscode.com/essentials_cookbook_recipes_in_recipes.html
[2013-07-01 16:50:24 -0400] aramus_: matti: that's part of the link I gave you but I am not sure whether it the recipe included will run first before the rest of the recipe is evaluated
[2013-07-01 16:51:05 -0400] aramus_: matti: never mind, I think I got it.
[2013-07-01 16:51:37 -0400] aramus_: thanks though! " the resources found in that recipe will be inserted"
[2013-07-01 16:51:58 -0400] matti: ;]
[2013-07-01 16:52:10 -0400] matti: I was hoping you'll find it ;]
[2013-07-01 16:52:19 -0400] matti: aramus_: But, do an experiment.
[2013-07-01 16:52:20 -0400] aramus_: matti: i am blind.
[2013-07-01 16:52:27 -0400] matti: aramus_: Have two very simple cookbooks and include one to another.
[2013-07-01 16:52:46 -0400] matti: aramus_: Let me say "Hello" and the other one "World" (and maybe something like that).
[2013-07-01 16:53:02 -0400] matti: aramus_: If the assumption is right, you will get Hello World.
[2013-07-01 16:54:01 -0400] aramus_: matti: The thing is, I don't have a server to try running chef-solo on to test stuff. Interns don't really get that many resources to play with.
[2013-07-01 16:54:22 -0400] j^2: any help/advice on http://tickets.opscode.com/browse/KNIFE-319 would be greatly appreciated
[2013-07-01 16:54:29 -0400] aramus_: I write code and hope it works.
[2013-07-01 16:54:42 -0400] matti: aramus_: Interns?
[2013-07-01 16:55:17 -0400] matti: aramus_: You can create environment to play for yourself.
[2013-07-01 16:55:35 -0400] matti: aramus_: Vagrant, or anything else. And install Chef there.
[2013-07-01 17:00:15 -0400] geggam: thank you jtimberman
[2013-07-01 17:00:45 -0400] kimm: guys, i'm wondering if i should change the default passwords for rabbitmq & postgresql, or if it doesn't matter as they just accept local connections... what do you think?
[2013-07-01 17:01:12 -0400] aramus_: matti: Thanks, I'll try that.
[2013-07-01 17:01:32 -0400] matti: kimm: With omnibus?
[2013-07-01 17:01:39 -0400] matti: aramus_: I do encourage you.
[2013-07-01 17:02:23 -0400] kimm: matti: yes, i used it to install the chef server
[2013-07-01 17:03:38 -0400] matti: kimm: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/ and https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/attributes/default.rb
[2013-07-01 17:05:02 -0400] kimm: matti: i exactly followed it.... and i was referring to default['chef_server']['rabbitmq']['password'] = 'chefrocks' , default['chef_server']['postgresql']['sql_password'] = "snakepliskin" and default['chef_server']['postgresql']['sql_ro_password'] = "shmunzeltazzen"
[2013-07-01 17:05:18 -0400] matti: Yeah.
[2013-07-01 17:05:23 -0400] matti: I changes these to randoms.
[2013-07-01 17:05:29 -0400] matti: changed*
[2013-07-01 17:05:55 -0400] kimm: ok... can I do it even if I've already installed the server? or will i need to reinstall it from scratch? :\
[2013-07-01 17:06:29 -0400] matti: You can.
[2013-07-01 17:06:30 -0400] kimm: i've also changed default['chef_server']['notification_email'] = "info@example.com" and the ssl nginx info, but even running the reconfigure script they stay the same
[2013-07-01 17:06:36 -0400] matti: Read web site I gave you.
[2013-07-01 17:08:38 -0400] matti: kimm: IIRC, notification address is not used yet.
[2013-07-01 17:08:40 -0400] kimm: I did, and it says "We use reconfigure to configure the Chef Server after installation, and after modifying the config file (see below)", but even if I changed the info in the /etc/chef-server/chef-server.rb and run the reconfigure, they don't change :)
[2013-07-01 17:08:43 -0400] matti: kimm: As per jtimberman.
[2013-07-01 17:10:11 -0400] kimm: but nginx['ssl_company_name'] is :\
[2013-07-01 17:11:44 -0400] kimm: matti: any other config you suggest to change from the default?
[2013-07-01 17:12:19 -0400] matti: One second.
[2013-07-01 17:12:23 -0400] matti: Let me see I've changed.
[2013-07-01 17:12:49 -0400] gchristensen: has anyone had issues where a hostgroup in nagios has no members, and thusly Nagios can't handle it, and gives up? and if someone has found a good fix for that? :)
[2013-07-01 17:12:53 -0400] matti: kimm: I tweaked JVM options here and there, and some other things ;]
[2013-07-01 17:13:27 -0400] kimm: ok ;)
[2013-07-01 17:39:29 -0400] anoldhacker: What is the "cookbook" attribute used to do in the cron_d resource?
[2013-07-01 17:42:16 -0400] tabolario: anoldhacker: https://github.com/opscode-cookbooks/cron/blob/master/providers/d.rb#L9 It specifies the cookbook that you want to use for the crontab template
[2013-07-01 17:42:59 -0400] tabolario: by default it's set to 'cron', so you don't need to include it unless you want to use your own template
[2013-07-01 17:45:13 -0400] stormerider: i think that's a helpful stub for chef-rewind, basically
[2013-07-01 17:45:15 -0400] anoldhacker: Okay.  So the new_resource object inside the provider has the cookbook method set by the cookbook attribute in the resource.
[2013-07-01 17:45:30 -0400] robbkidd: What might cause a node to have an empty IP recorded on the chef server?
[2013-07-01 17:47:33 -0400] tabolario: anoldhacker: exactly, you can refer to https://github.com/opscode-cookbooks/cron/blob/master/resources/d.rb for where the attributes for the cron_d resource are actually defined
[2013-07-01 17:48:05 -0400] tabolario: stormerider: i usually like to put that attribute in my library cookbooks whenever a resource creates a template just so the user can use their own template if they want to
[2013-07-01 17:48:16 -0400] anoldhacker: Okay.  This is my first time out (in case you hadn't guessed). Thanks.
[2013-07-01 17:48:42 -0400] Otterley: I've never had to use "cookbook" in cron_d
[2013-07-01 17:49:31 -0400] tabolario: i don't see why 99% of the cases out there would want to use their own crontab template, but i think it's always nice to provide that hook
[2013-07-01 17:49:43 -0400] anoldhacker: Not understanding the structure of what I was reading very well, I was confused as to its purpose.
[2013-07-01 17:51:14 -0400] Otterley: I do think the original cron resource should be put to pasture though
[2013-07-01 17:51:31 -0400] tabolario: agreed
[2013-07-01 17:51:55 -0400] Otterley: or at least a big screaming note in the docs that says "don't use this"
[2013-07-01 17:52:42 -0400] anoldhacker: Why is this?
[2013-07-01 17:53:01 -0400] anoldhacker: Andyou probably want to remove it from the examples. ;)
[2013-07-01 17:53:24 -0400] tabolario: anoldhacker: it's more or less deprecated in favor of the opscode cron cookbook
[2013-07-01 17:55:20 -0400] Otterley: anoldhacker, the original cron resource managed user crontab files.  the trouble with those is that if you declare an environment variable in a crontab it never gets reset, and will apply to every cron job in the cron job that follows it ,whether you meant that to happen or not.
[2013-07-01 17:55:32 -0400] Otterley: every cron job in the crontab, that is
[2013-07-01 17:58:39 -0400] robbkidd: More context on node with empty IP: JSON produced by ohai run manually has an "ipaddress": "172.16.78.56" entry, but that IP does not appear in "node show" which I believe is causing other nodes who depend on looking up this IP for templates to have empty entries in the templated config file.
[2013-07-01 17:59:45 -0400] robbkidd: I'm trying to get munin nodes to allow the munin server to talk to them.
[2013-07-01 18:00:24 -0400] robbkidd: And the IP for the munin server chef node is empty, so I get an "allow ^$" entry in the munin-node.conf of the clients.
[2013-07-01 18:03:13 -0400] tabolario: robbkid: what does `knife node show -l` give you?
[2013-07-01 18:03:20 -0400] tabolario: er --long
[2013-07-01 18:04:23 -0400] robbkidd: Quite a bit. Is there a particular segment of this I should look at?
[2013-07-01 18:05:08 -0400] robbkidd: network: interfaces: eth0: addreses:  contains an entry for the IP.
[2013-07-01 18:06:10 -0400] robbkidd: --long's "ipaddress:" entry is empty
[2013-07-01 18:08:32 -0400] robbkidd: I'm having difficulty tracing how an ipaddress present in ohai output gets to a node's ipaddress attribute.
[2013-07-01 18:09:20 -0400] tabolario: the ohai attributes get updated on the node when chef is run
[2013-07-01 18:09:57 -0400] robbkidd: chef-client has been run several times recently on the host in question.
[2013-07-01 18:15:41 -0400] tabolario: robbkidd: any output for 'ohai -l debug ipaddress' ?
[2013-07-01 18:16:39 -0400] robbkidd: Running ohai manually on the node shows the IP.
[2013-07-01 18:17:54 -0400] tabolario: ah right
[2013-07-01 18:18:05 -0400] robbkidd: I am confuzzled.
[2013-07-01 18:18:15 -0400] tabolario: anyone else? i'm at the limit of my troubleshooting here :(
[2013-07-01 18:18:29 -0400] tabolario: sorry i couldn't help you more
[2013-07-01 18:18:39 -0400] robbkidd: Thanks for trying!
[2013-07-01 18:28:37 -0400] robbkidd: Just noticed that four of my chef-client services (v10.24) are holding on to 11-15 GB of RAM while idle. O.o
[2013-07-01 18:31:21 -0400] gchristensen: robbkidd: my understwanding is setting chef-client to fork before it runs will reduce memory usage over time.
[2013-07-01 18:31:38 -0400] robbkidd: Will investigate. Thanks.
[2013-07-01 18:32:28 -0400] tabolario: i was also told the same thing not an hour ago gchristensen
[2013-07-01 18:33:05 -0400] gchristensen: heh
[2013-07-01 18:33:26 -0400] iverson0881: hmm anyone getting 500 errors from chef hosted right now? or is someone migrating my org still?
[2013-07-01 18:35:40 -0400] stormerider: i just did as well
[2013-07-01 18:36:07 -0400] stormerider: (my chef clients ping me on IRC if the run fails)
[2013-07-01 18:42:54 -0400] gchristensen: I'm getting failures as well.
[2013-07-01 18:46:32 -0400] gaffneyc: Using test-kitchen we need to do an 'apt-get update' before the converge.
[2013-07-01 18:46:39 -0400] gaffneyc: Anyone know of a way to properly do that?
[2013-07-01 18:46:51 -0400] gaffneyc: So far we have:  require_chef_omnibus: "~> 11.0.0; sudo apt-get update" in .kitchen.yml
[2013-07-01 18:46:55 -0400] gaffneyc: And that just feels wrong
[2013-07-01 18:47:07 -0400] Otterley: why before the converge?
[2013-07-01 18:47:48 -0400] autorog: does the latest chef-client installer for windows automtically install as a service?
[2013-07-01 18:48:05 -0400] autorog: my older clients have a service.exe type install setup in Program Files
[2013-07-01 18:48:20 -0400] gaffneyc: Out of date apt repo. Trying to install a package fails because the actual binaries have been yanked upstream
[2013-07-01 18:48:40 -0400] Otterley: gaffneyc, are you using the apt cookbook?
[2013-07-01 18:48:46 -0400] autorog: newly installed clients are installing but i have to go in and setup a Windows scheduled task to run chef-client.bat
[2013-07-01 18:48:46 -0400] Otterley: it takes care of it for you
[2013-07-01 18:48:58 -0400] gaffneyc: We are, but we're in the process of splitting cookbooks out and testing them.
[2013-07-01 18:49:19 -0400] gaffneyc: For example I've run into it with imagemagick. Yeah, we can fix it by depending on the apt cookbook
[2013-07-01 18:49:25 -0400] Otterley:  which you should.
[2013-07-01 18:49:36 -0400] gaffneyc: But that feels wrong since the cookbook itself doesn't actually need anything else from the apt cookbook
[2013-07-01 18:49:36 -0400] Otterley: problem solved :)
[2013-07-01 18:50:00 -0400] Otterley: gaffneyc, if your cookbook installs an apt package, it should depend on the apt cookbook.  that shouldn't feel wrong :)
[2013-07-01 18:50:37 -0400] gaffneyc: The apt cookbook provides tools for adding remote repos, and we're not using any of that.
[2013-07-01 18:50:42 -0400] Otterley: it does more than that.
[2013-07-01 18:51:00 -0400] Otterley: as you've seen
[2013-07-01 18:51:33 -0400] tabolario: Otterley: what's your strategy for apt upgrades right now?
[2013-07-01 18:51:44 -0400] Otterley: you mean package upgrades?
[2013-07-01 18:51:52 -0400] tabolario: er yeah those in general
[2013-07-01 18:52:16 -0400] Otterley: our goal is to do them on schedule, since we need them for SSAE-16 compliance
[2013-07-01 18:52:25 -0400] gaffneyc: Yeah, it does but we shouldn't need any of that functionality to install imagemagick
[2013-07-01 18:52:27 -0400] Otterley: I'm not sure how we're going to do that with Chef just yet.
[2013-07-01 18:53:03 -0400] Otterley: gaffneyc, so depend on a base cookbook instead that depends on an apt cookbook, if you don't want every cookbook to depend on apt.
[2013-07-01 18:53:27 -0400] gaffneyc: Hm.
[2013-07-01 18:53:43 -0400] gaffneyc: We're trying to pull our cookbooks out and test them in as much isolation as possible.
[2013-07-01 18:53:59 -0400] gaffneyc: Right now we have one large repo with everything in it
[2013-07-01 18:54:01 -0400] Otterley: gaffneyc, I don't think testing isolated cookbooks is totally sustainable ...
[2013-07-01 18:54:10 -0400] gaffneyc: Why's that?
[2013-07-01 18:54:51 -0400] phoellig: I have a silly question about the contribution guidelines. You're supposed to set a ticket status to 'Fix Provided' when you've resolved an issue. How do you change the ticket status to that on the website? I don't see any options for that and haven't used the tracking system before.
[2013-07-01 18:55:49 -0400] prefix: hat is wrong with my syntax here? if [ `command -v scp` ]
[2013-07-01 18:56:10 -0400] gaffneyc: ; then
[2013-07-01 18:56:10 -0400] Otterley: just my experience, gaffneyc.  it's hard for me to articulate why right now
[2013-07-01 18:56:37 -0400] Otterley: phoellig, you can only do that if you opened the ticket yourself
[2013-07-01 18:56:53 -0400] gaffneyc: Otterley: No worries, we're just getting started with it and figuring out what a good practice is.
[2013-07-01 18:56:56 -0400] lledet: Hi, I'm getting an error on this line "package_name node['apache']['package']" in the apache2 default recipe, it doesn't seem like it's using the default attributes from the apache2 cookbook, how can i make sure it uses those defaults?
[2013-07-01 18:57:32 -0400] phoellig: Otterley: I did open the ticket myself.
[2013-07-01 18:58:42 -0400] phoellig: Otterley: The only options I had on the workflow were to confirm the ticket and then set it to 'in progress', but it seems I'm unable to shift the ticket beyond that.
[2013-07-01 18:58:47 -0400] Otterley: phoellig, log in, visit the ticket, and the status should be a drop down box at th etop
[2013-07-01 19:00:49 -0400] phoellig: Otterly: I've got Comment, Attach Files, Attach Screenshot, and More Actions. More actions contains Stop Watching, Clone, and Create Sub-Task.
[2013-07-01 19:02:06 -0400] Otterley: phoellig, odd.  I see edit, assign, assign to me, comment, more actions, confirm issue, fix provided, and workflow
[2013-07-01 19:02:24 -0400] Otterley: did you already submit a CLA?
[2013-07-01 19:02:43 -0400] phoellig: Otterley, CLA?
[2013-07-01 19:02:49 -0400] Otterley: contributor license agreement
[2013-07-01 19:03:11 -0400] Otterley: http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-07-01 19:03:14 -0400] btm: @opscode #opschef code review: join: https://plus.google.com/hangouts/_/8948ee66d959065687f38ce9c0ec44a23baac85f, watch: http://youtu.be/armjIzVCr5s
[2013-07-01 19:03:36 -0400] phoellig: Otterley, That would be my problem!
[2013-07-01 19:03:41 -0400] phoellig: Thanks for the help.
[2013-07-01 19:04:57 -0400] jmickle: miah: you around?
[2013-07-01 19:05:53 -0400] tabolario: Otterley: i'm having the same issue, i think maybe my CLA hasn't gone through yet?
[2013-07-01 19:06:02 -0400] tabolario: Can't change the status of my ticket to fix provided
[2013-07-01 19:06:52 -0400] tabolario: I'm assuming that's one of the things that'll be enabled once my CLA goes through?
[2013-07-01 19:07:02 -0400] Otterley: I imagine so.  I don't works for Opscode :)
[2013-07-01 19:07:14 -0400] Otterley: I do recall them sending me an email once it had been processed
[2013-07-01 19:08:50 -0400] tabolario: Gotcha
[2013-07-01 19:09:04 -0400] jmickle: anyone know why in ruby using a hash I am assigning a key as APIToken but its being output as Apitoken
[2013-07-01 19:09:04 -0400] jmickle: ?
[2013-07-01 19:09:30 -0400] tabolario: So returning to package upgrades, had you considered doing that outside of Chef? (Like with the not-going-to-be-scalable-for-long capistrano scripts)
[2013-07-01 19:09:54 -0400] Otterley: tabolario, I suspect that's what's going to happen
[2013-07-01 19:10:08 -0400] tabolario: I'm still at the stage where using Capistrano with a role for each node is fine, I was thinking of writing a task so I can just do cap staging apt:upgrade
[2013-07-01 19:10:35 -0400] tabolario: Are you using a node search to populate all the roles in capistrano?
[2013-07-01 19:11:35 -0400] Otterley: package upgrades are risky.  they have to be tested; and we need to ensure that an upgrade doesn't restart a server and cause some sort of degradation/outage, even if temporary
[2013-07-01 19:11:43 -0400] Otterley: moreover, kernel upgrades require reboots
[2013-07-01 19:12:05 -0400] Otterley: by server above, I mean service
[2013-07-01 19:12:45 -0400] tabolario: Right, yeah, I think my procedure for now is going to be to test them in staging for the most part, and just make new instances for kernel upgrades since I'm on AWS
[2013-07-01 19:13:03 -0400] tabolario: This is what I use in my cap script to get all the roles btw https://gist.github.com/tabolario/5903653
[2013-07-01 19:13:47 -0400] Otterley: tabolario, I've got a Chef recipe that generates a YAML file that is basically a table of hosts keyed by name and whose values are certain attributes of that host (host group, data center, environment, etc) - other tools can then parse that and select hosts whose attributes match those that the tool is interested in
[2013-07-01 19:14:02 -0400] Otterley: that file is generated via a search.
[2013-07-01 19:14:13 -0400] tabolario: ah that's a bit more portable than what i have for capistrano :)
[2013-07-01 19:15:17 -0400] Otterley: yes.  that's the idea - abstract that stuff out, so that other tools don't need access to Chef (which has a pretty coarse grained access model) and keep the load on the search engine controlled
[2013-07-01 19:17:19 -0400] tabolario: So when/where does that chef recipe run?
[2013-07-01 19:17:50 -0400] Otterley: on some admin/jumphost boxes
[2013-07-01 19:18:37 -0400] tabolario: interesting, i'll have to consider something like that
[2013-07-01 19:18:55 -0400] tabolario: i do have a few scripts so far that don't use capistrano to orchestrate stuff across nodes
[2013-07-01 19:19:19 -0400] tabolario: would be nice to have all of those get their inventory from the same place
[2013-07-01 19:20:06 -0400] Otterley: it doesn't really matter where you put it as long as the tools can get to it somehow.  you could even put it on a monitoring node and serve it up via HTTP
[2013-07-01 19:42:59 -0400] behemphi1: I am about to embark on my first real testing journey with chef.  what is the difference between cucumber-chef, chefspec and minitest?
[2013-07-01 19:43:31 -0400] prefix: what does this mean?
[2013-07-01 19:43:32 -0400] prefix: 2013-07-01T15:38:35-04:00] FATAL: Errno::ECONNREFUSED: Connection refused - Connection refused connecting to localhost:4000 for /clients, giving up
[2013-07-01 19:43:52 -0400] prefix: specifically, I just tried to bootstrap a chef node
[2013-07-01 19:43:58 -0400] prefix: and then i got that error
[2013-07-01 19:44:20 -0400] behemphi1: @prefix a guess would be the path to your chef server is not correct in your knife.rb
[2013-07-01 19:44:34 -0400] countdigi: behemphi1: chefspec simulates a chef run w/out really doing anything (and is not a "real" run so doesn't catch everything but its super fast)
[2013-07-01 19:44:57 -0400] countdigi: minitest is run after a real chef run (ala test-kitchen in one example) and tests real state of a node after chef converge
[2013-07-01 19:46:01 -0400] countdigi: cucumber-chef is usually run after a real converge to test functionality from outside of the node (like http listening - firewall not blocking, etc)
[2013-07-01 19:47:54 -0400] cwj: there's also minitest-chef-handler which differs from pure minitest (tests run inside the chef run)
[2013-07-01 19:48:39 -0400] behemphi1: That is _very_ useful @countdigi,  Thanks.  It seems a little of each tool  applied at the various development stages is the right way to go.  Can I beg you to talk a bit about how you approach testing holistically.
[2013-07-01 19:49:13 -0400] countdigi: ohai
[2013-07-01 19:49:27 -0400] behemphi1: i.e. what you test, with what tool and where in the devel process?  Or is there a good blog/video out there I am missing
[2013-07-01 19:50:01 -0400] countdigi: behemphi1: i think thats still developing in the community - its not going to anwer your question but a cool vid that i just checked out is:
[2013-07-01 19:50:54 -0400] countdigi: https://www.youtube.com/watch?v=0sPuAb6nB2o
[2013-07-01 19:51:20 -0400] behemphi1: Thank you @countdigi I will be watching it now!
[2013-07-01 19:52:02 -0400] cwj: behemphi1: here's the blog post for that video if you need more context http://starkandwayne.com/articles/2013/05/07/tdd-your-devops-with-test-kitchen/
[2013-07-01 19:52:21 -0400] behemphi1: sweet!  Thanks!
[2013-07-01 19:52:47 -0400] behemphi1: given that most of this is test-kitchen focused is that sort of the way testing is moving in the Chef community?
[2013-07-01 19:53:27 -0400] cwj: if you decide to use test-kitchen you might also look at bats as an alternative to minitest, there are a lot of opscode cookbooks that now include test-kitchen w/ bats tests
[2013-07-01 19:53:33 -0400] cwj: e.g. rabbitmq cookbook
[2013-07-01 19:54:00 -0400] prefix: so, what exactly is wrong with this code? It throws an "unexpected end of file" error when I run it http://pastebin.com/B7JGALwJ
[2013-07-01 19:54:10 -0400] countdigi: i really dig bats
[2013-07-01 19:55:11 -0400] cubed: stupid question, hoping someone can answer it. if i'm trying to check to see if an attribute is empty in a recipe.. what would be the best way of doing this?
[2013-07-01 19:55:12 -0400] cwj: i am starting to write more of my tests in bats, but i still have some tests that run under minitest-chef-handler which i think would be really hard to port to pure minitest or bats
[2013-07-01 19:55:59 -0400] jeremy_carroll: Question. If setting up chef today, is there any blogs / posts about best practices? Ex: using Berkshelf, test-kitchen, cookbook patterns, etc..?
[2013-07-01 19:56:05 -0400] prefix: I don't see what would be causing the erro
[2013-07-01 19:56:06 -0400] prefix: r
[2013-07-01 19:56:06 -0400] prefix: http://pastebin.com/B7JGALwJ
[2013-07-01 19:57:58 -0400] behemphi1: @jeremy_carroll this is a blog post I refer to about once a week and understand more of it as I get farther along
[2013-07-01 19:57:58 -0400] behemphi1: http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-07-01 19:58:14 -0400] behemphi1: www.berkshelf.com is great to follow from beginning to end too IMO
[2013-07-01 19:59:00 -0400] behemphi1: This is a keynote from Chefconf http://www.youtube.com/watch?v=hYt0E84kYUI, but the language might be a bit stiff so use headphones
[2013-07-01 19:59:16 -0400] behemphi1: I suggest the video first as it is a nice overview of many details
[2013-07-01 20:03:32 -0400] robbkidd: With new people active here, asking again about a node having an empty IP.
[2013-07-01 20:04:07 -0400] robbkidd: Given that ohai returns an "ipaddress", what would prevent that IP from appearing in "knife node show nodename"?
[2013-07-01 20:04:55 -0400] btm: @opscode cookbook code review: join: https://plus.google.com/hangouts/_/ddbc126186cf95ed43f8e7df39dd5357b4d0c9fc, watch: http://youtu.be/nIq9LWmryt8
[2013-07-01 20:05:14 -0400] btm: robbkidd: knife node show nodename -a ipaddress <-- works?
[2013-07-01 20:05:51 -0400] robbkidd: That's blank. "ipaddress:     "
[2013-07-01 20:06:38 -0400] robbkidd: Of 4 identical nodes, 2 have IPs in the node attributes and 2 have blank.
[2013-07-01 20:06:40 -0400] tabolario: btm: woot :) i just submitted my very first cookbook PR yesterday
[2013-07-01 20:07:12 -0400] btm: robbkidd: have you run chef-client on the node successfully yet, such that node.save has saved the data?
[2013-07-01 20:07:26 -0400] btm: tabolario: awesome, thanks!
[2013-07-01 20:08:19 -0400] robbkidd: Yes? chef-client has been run a number of times. And the node data's FQDN was updated when I reordered /etc/hosts entries to have the proper name appear first. That change propagated from node to server.
[2013-07-01 20:09:25 -0400] robbkidd: No errors in the chef-client run.
[2013-07-01 20:10:30 -0400] tabolario: damn, seems to be an error on youtube loading the cookbook review stream
[2013-07-01 20:11:10 -0400] btm: tabolario: keep trying. Google is buggy.
[2013-07-01 20:12:05 -0400] prefix: is google a bug
[2013-07-01 20:14:44 -0400] tabolario: ironically it works in firefox
[2013-07-01 20:19:56 -0400] tabolario: i think i'm still waiting on my CLA to be processed
[2013-07-01 20:21:15 -0400] btm: quit
[2013-07-01 20:22:29 -0400] d```: I have a service that is restarting every chef run, due to a template update. Problem is, the template and variables are always the same, so there should be no restarts. I just md5sum'd the file that's supposedly changing before and after the run and got the same checksum
[2013-07-01 20:23:02 -0400] gchristensen: d```: is the template set to touch the file?
[2013-07-01 20:24:05 -0400] d```: gchristensen: I just figured it out. the files are in a managed directory and I have the purge option set
[2013-07-01 20:24:25 -0400] d```: so they're getting deleted every run
[2013-07-01 20:24:53 -0400] gchristensen: that'd do it :)
[2013-07-01 20:25:20 -0400] d```: sometimes it pays to read up 3 lines in teh log... haha :(
[2013-07-01 20:28:51 -0400] prefix: yo
[2013-07-01 20:29:08 -0400] prefix: is this the proper way to exztract a password from a databag? password data_bag_item("global", "passwords")["dsrdbm01"]
[2013-07-01 20:30:36 -0400] prefix: cmon mangs
[2013-07-01 20:32:08 -0400] stormerider: mangs?
[2013-07-01 20:32:42 -0400] josephholsten: anyone else interested in my adding ldap auth to opscode-cookbooks/jenkins?
[2013-07-01 20:33:27 -0400] prefix: stormerider you know, men, but in azn speak
[2013-07-01 20:33:52 -0400] stormerider: ah, so brogrammer speak.
[2013-07-01 20:34:05 -0400] prefix: more or less
[2013-07-01 20:34:15 -0400] prefix: ain't nothin better than a brogrammer
[2013-07-01 20:35:06 -0400] prefix: anyway, is this the proper way to extract a password from a databag? password data_bag_item("global", "passwords")["dsrdbm01"]
[2013-07-01 20:35:53 -0400] stormerider: i havent touched that yet *shrug*
[2013-07-01 20:36:23 -0400] prefix: man
[2013-07-01 20:36:27 -0400] prefix: chef is so strange
[2013-07-01 20:36:31 -0400] nd__: One if my nodes throws a FATAL: NoMethodError: undefined method `run_list' for nil:NilClass  on the chef-client run can someone help me with that?
[2013-07-01 20:37:42 -0400] stormerider: btm: btw, is there a list of tickets you all are reviewing today?
[2013-07-01 20:37:50 -0400] nd__: It's an ubuntu 12.04 with chef-11.4.4-2
[2013-07-01 20:38:27 -0400] stormerider: nd__: gist the run or stacktrace? i think we need more context
[2013-07-01 20:38:40 -0400] nd__: Ok, sure
[2013-07-01 20:39:22 -0400] nd__: stormerider: Stacktrace: https://gist.github.com/alappe/0f451eab4773a5c7ac08
[2013-07-01 20:41:47 -0400] eliklein: seth vargo, you around?
[2013-07-01 20:42:17 -0400] nd__: stormerider: And the run explodes with EOFError: end of file reached
[2013-07-01 20:42:35 -0400] stormerider: nd__: hm. that's unhelpful, huh. can you gist the run itself with like "chef-client -F min" ?
[2013-07-01 20:42:51 -0400] nd__: Yes, will do
[2013-07-01 20:45:25 -0400] nd__: stormerider: The run: https://gist.github.com/alappe/6f302f78033dd062221b
[2013-07-01 20:50:55 -0400] prefix: google: install recipe on cheesecake
[2013-07-01 20:50:59 -0400] prefix: ok
[2013-07-01 20:55:20 -0400] nd__: Well, I gave the chef-server a kick, now it seems to run through ;/
[2013-07-01 20:56:46 -0400] prefix: how 2 make chef go
[2013-07-01 20:57:05 -0400] stormerider: nd__: yeah, sorry, wasnt seeing anything
[2013-07-01 20:58:13 -0400] nd__: stormerider: Sure, thanks for trying though!
[2013-07-01 20:58:16 -0400] aramus_: Hello, can anyone explain when it is necessary to place a #{} around a variable and when it isn't necessary?
[2013-07-01 20:58:45 -0400] Otterley: it's necessary in a quoted string.
[2013-07-01 20:59:02 -0400] Otterley: it means "substitute the value of the expression in braces into this position"
[2013-07-01 20:59:12 -0400] aramus_: so only when you use a variable in ' or "
[2013-07-01 20:59:23 -0400] Otterley: double-quoted strings only.
[2013-07-01 20:59:35 -0400] aramus_: Oh, why not single quotes?
[2013-07-01 20:59:43 -0400] Otterley: expansions do not happen in single-quoted strings; they are meant for literal values
[2013-07-01 21:00:03 -0400] Otterley: (this is common to many scripting languages.)
[2013-07-01 21:00:07 -0400] aramus_: Oh, I see. That's really helpful, thanks!
[2013-07-01 21:00:26 -0400] stormerider: jtimberman, btm: thanks, you just answered the same question i was going to ask :)
[2013-07-01 21:00:38 -0400] tabolario: oh i will definitely hop on the hangout for mine on wednesday too :)
[2013-07-01 21:01:05 -0400] prefix: no but seriously, how do I run a recipe on a node that I've already bootstrapped?
[2013-07-01 21:01:06 -0400] tabolario: hopefully my CLA gets processed by then
[2013-07-01 21:01:19 -0400] tabolario: prefix: by adding it to the node's runlist and running chef-client
[2013-07-01 21:01:20 -0400] Otterley: prefix, chef-client -o 'recipe[myrecipe]'
[2013-07-01 21:01:43 -0400] Otterley: or what tabolario says.  this is basic Chef and is well documented ...
[2013-07-01 21:01:45 -0400] prefix: Otterley tabolario where does that get run from?
[2013-07-01 21:01:52 -0400] tabolario: you run that on the node
[2013-07-01 21:02:12 -0400] prefix: oh, there's no way to run it from the workstation?
[2013-07-01 21:02:26 -0400] Otterley: no
[2013-07-01 21:02:29 -0400] Otterley: well, not directly
[2013-07-01 21:02:49 -0400] prefix: hm
[2013-07-01 21:03:08 -0400] prefix: so do I need to add a recipe to a server before I bootstrap it?
[2013-07-01 21:03:14 -0400] prefix: *node
[2013-07-01 21:03:54 -0400] tabolario: it's not required to do so, but you can specify the runlist of a node when you're first bootstrapping it
[2013-07-01 21:04:00 -0400] prefix: ok
[2013-07-01 21:04:06 -0400] prefix: i'll have to do that
[2013-07-01 21:04:16 -0400] tabolario: you can also add recipes to the runlist after the node is boostrapped and running
[2013-07-01 21:05:06 -0400] prefix: and then i just run boostrap again?
[2013-07-01 21:05:14 -0400] jessicab1: prefix: you could use knife ssh to run it from your workstation, but it basically just sshes in for you with a single command
[2013-07-01 21:06:53 -0400] stormerider: prefix: if you set the runlist after bootstrapping you can just rerun the client
[2013-07-01 21:08:35 -0400] prefix: hm
[2013-07-01 21:08:40 -0400] prefix: this does not make sense to me
[2013-07-01 21:10:46 -0400] behemphi1: @prefix  chef-client is a program on the node that connects to the chef server, reads and node data stored there and does some other stuff (checks environment data, role data, data bag searches, etc).  When you run bootstrap it basically installs the chef gem (or omnibus not sure) on the node, then runs the chef-client
[2013-07-01 21:11:07 -0400] prefix: ok
[2013-07-01 21:11:15 -0400] aneto: prefix: not sure if this is what you want to do or not, but you can add a recipe to a nodes runlist after it is boot strapped, with knife node edit foo -e vim
[2013-07-01 21:11:18 -0400] prefix: I need ot look into my custom bootstrappe rmore then
[2013-07-01 21:11:20 -0400] behemphi1: so once bootstrapped succesfully you need only run the chef-client program, there is no reason to go through the whole bootstrapping process again
[2013-07-01 21:11:59 -0400] behemphi1: so you can issue this command from your workstation:  `knife ssh 'name:my_node' 'sudo chef-client'
[2013-07-01 21:12:23 -0400] jessicab: prefix: probably easier to just add to it with 'knife node run list add' rather than edit.. edit will make you edit the json file with all the node values
[2013-07-01 21:12:34 -0400] prefix: hm
[2013-07-01 21:12:35 -0400] prefix: WARNING: Failed to connect to  -- Net::SSH::AuthenticationFailed: root@lldg3tds01
[2013-07-01 21:12:44 -0400] prefix: that's no good
[2013-07-01 21:13:02 -0400] prefix: where is the validation.pem usually stored on a node/
[2013-07-01 21:13:10 -0400] aneto: /etc/chef
[2013-07-01 21:13:43 -0400] prefix: ok. so these files are here
[2013-07-01 21:14:12 -0400] behemphi1: OK this is about the most disturbing thing I have every seen.  Can a rubyist explain this to me?  https://gist.github.com/behemphi/5904687
[2013-07-01 21:14:27 -0400] behemphi1: Ruby just executed both sides of an if/else
[2013-07-01 21:14:45 -0400] behemphi1: I know it is an edge, but holy moly, what am I missing?
[2013-07-01 21:15:06 -0400] jessicab: prefix: it sounds like its the ssh pass that it failed to auth with? are you sure you can just ssh into it with the creds you gave it? no weird ports or anything?
[2013-07-01 21:15:45 -0400] prefix: jessicab shouldn't the workstation just be using keys to ssh into any nodes?
[2013-07-01 21:16:45 -0400] jessicab: prefix: knife ssh will actually try to make an ssh connection from your workstation to the chef client.. the server, etc wont ever try to log into the client, those validation keys are just for the client contacting the servers api
[2013-07-01 21:16:57 -0400] prefix: ok
[2013-07-01 21:17:17 -0400] jessicab: prefix: when those validation pems are the issue, you should see a 400 error, like a 401 usually
[2013-07-01 21:18:28 -0400] aneto: prefix: are you specifying the user? because when I use it on ec2 I have to specify the ec2-user with -u flag
[2013-07-01 21:18:51 -0400] prefix: I did not
[2013-07-01 21:18:54 -0400] prefix: one sec
[2013-07-01 21:19:13 -0400] aneto: prefix: knife ssh --help
[2013-07-01 21:19:52 -0400] prefix: oof
[2013-07-01 21:20:01 -0400] prefix: unexpected EOF while looking for matching `'' in my custom bootstrapper
[2013-07-01 21:21:20 -0400] siezer: you cant use backticks in your bootstrap scripts
[2013-07-01 21:21:22 -0400] flashvoid: Hi all!   Could someone to point me how to use library from one cookbook in the recipe from another cookbook ?
[2013-07-01 21:21:39 -0400] siezer: er, single quotes, sorry
[2013-07-01 21:21:46 -0400] siezer: so, no awk
[2013-07-01 21:22:19 -0400] siezer: flashvoid simply puts "depends cookbook_with_the_library" in another_cookbook's metadata.rb
[2013-07-01 21:23:56 -0400] flashvoid: siezer, i did it, but then import Opscode::AWS::Ec2 in my recipe fails
[2013-07-01 21:24:11 -0400] behemphi1: siezer:  I did this for nginx
[2013-07-01 21:24:11 -0400] behemphi1: https://gist.github.com/behemphi/5421091
[2013-07-01 21:24:35 -0400] behemphi1: lines 50,51 are the nginx cookbook
[2013-07-01 21:24:42 -0400] behemphi1: the rest is "wrapping"
[2013-07-01 21:25:07 -0400] behemphi1: any of you expert chefs out there please feel free to poke holes in how it was done!
[2013-07-01 21:25:23 -0400] aramus_: Hello! If I change an attribute like "num_of_times_run" in a recipe, will it persist if I run chef again?
[2013-07-01 21:26:23 -0400] Otterley: aramus_, if it's a normal attribute, yes
[2013-07-01 21:26:49 -0400] aramus_: What do you mean by normal attribute?
[2013-07-01 21:29:27 -0400] prefix: where are cookbook dependencies defined?
[2013-07-01 21:29:39 -0400] tabolario: prefix: in a cookbook's metadata.rb
[2013-07-01 21:29:55 -0400] prefix: OK!
[2013-07-01 21:31:10 -0400] siezer: flashvoid when a chef-client runs, all the cookbooks are "loaded" into the context of the chef run. so, all the libraries, resources, proviers, etc become accessable
[2013-07-01 21:31:45 -0400] siezer: sec lemme track down what you're trying to do
[2013-07-01 21:32:40 -0400] flashvoid: <siezer> thanks
[2013-07-01 21:32:56 -0400] Otterley: aramus_, read carefully http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-07-01 21:33:12 -0400] siezer: http://cookingclouds.com/2012/08/14/adding-ebs-volumes-with-opscodes-aws-cookbook/
[2013-07-01 21:33:20 -0400] Otterley: prefix, read carefully http://docs.opscode.com/essentials_cookbook_metadata.html
[2013-07-01 21:33:40 -0400] prefix: Otterley yep
[2013-07-01 21:33:54 -0400] siezer: just by adding "depends aws" do you cookbooks metadata, you'll get access to all the resource/providers in the aws cookbook
[2013-07-01 21:34:13 -0400] siezer: as well as the library functions. you don't hav to do "import" in the recipe
[2013-07-01 21:37:45 -0400] aramus_: Otterley: I've actually read that read that and I just re-read the "Attribute Types" section in case I missed anything. It really doesn't show the syntax of how to use a normal attribute.
[2013-07-01 21:37:48 -0400] prefix: hm
[2013-07-01 21:38:20 -0400] Otterley: aramus_: to read, node["attribute"].  To set, node.set["attribute"].  Simple as that.
[2013-07-01 21:39:09 -0400] jessicab: aramus_: normal can also look like node.normal['attr'].. the big point there is that you dont use node.default.. those go away after the first run
[2013-07-01 21:39:52 -0400] aramus_: Thanks! Is it okay if I place this in attributes/default.rb or would it be good programming practice to place it in another .rb file?
[2013-07-01 21:39:55 -0400] Otterley: yes, as jessicab says, those are synonyms
[2013-07-01 21:40:18 -0400] Otterley: aramus_, generally setting normal attributes is something that should be done only in recipes
[2013-07-01 21:41:08 -0400] Otterley: if you're going to modify them, that is
[2013-07-01 21:41:23 -0400] aramus_: Oh, for my variable "num_of_times_run", I wanted to put a default variable of 0 and increment it everytime it was run.
[2013-07-01 21:41:27 -0400] siezer: The "default" level is normal level. "override" from environments is how you normally modify them. "normal
[2013-07-01 21:41:30 -0400] siezer: is rare
[2013-07-01 21:41:33 -0400] siezer: dammit enterkey
[2013-07-01 21:42:28 -0400] prefix: hm
[2013-07-01 21:42:36 -0400] Otterley: aramus_, so in your recipe, you'd do node["namespace"]["runs"] += 1
[2013-07-01 21:42:46 -0400] Otterley: err, node.set["namespace"]["runs"] += 1
[2013-07-01 21:43:07 -0400] aramus_: Otterley: From what I understand is that I can set an attribute even when it has not been declared in an attribute. I did not know this.
[2013-07-01 21:43:24 -0400] aramus_: *declared in an attribute file
[2013-07-01 21:43:36 -0400] Otterley: yes, it's autovivified
[2013-07-01 21:43:46 -0400] matti: nathenharvey: Hey
[2013-07-01 21:44:01 -0400] nathenharvey: matti: hi
[2013-07-01 21:44:02 -0400] prefix: is fileUtils included in the default version of ruby 1.8.7?
[2013-07-01 21:44:05 -0400] aramus_: Otterley: I also didn't know I could set the value to be something aside from a string, all the examples online are all strings and no ints
[2013-07-01 21:44:10 -0400] Otterley: aramus_, however, if you're going to use an increment operator, you'll want the default to be 0 in your attributes.rb
[2013-07-01 21:44:12 -0400] matti: nathenharvey: me -> kwilczynski @ twitter ;]
[2013-07-01 21:44:43 -0400] nathenharvey: matti: great to meet you here
[2013-07-01 21:45:09 -0400] aramus_: Otterley: Alright, so I'll just set the num_times_run attribute in my default.rb to be 0 then. Thanks!
[2013-07-01 21:45:20 -0400] matti: jtimberman: How do you usually handle case when a resource can be used many time in the recipe - a top-level class variable? Or, Chef somehow is clever in the DSL and passes all invocations collected/aggregated?
[2013-07-01 21:45:24 -0400] matti: nathenharvey: :)
[2013-07-01 21:46:59 -0400] prefix: wtf
[2013-07-01 21:47:00 -0400] prefix: LoadError --------- cannot load such file -- FileUtils
[2013-07-01 21:47:08 -0400] matti: prefix: Code?
[2013-07-01 21:47:31 -0400] matti: krzysztof@apple ~ $ ruby -e 'require "fileutils"'
[2013-07-01 21:47:33 -0400] siezer: matti resources are compiled into a resource_collection (in the run_context) before execution.
[2013-07-01 21:47:33 -0400] matti: Works fine.
[2013-07-01 21:47:46 -0400] siezer: that's how you can set up notifications and junk
[2013-07-01 21:47:57 -0400] matti: siezer: OK!
[2013-07-01 21:48:10 -0400] matti: siezer: I now have place to start ;]
[2013-07-01 21:48:16 -0400] prefix: matti http://pastebin.com/YVnDLuJb
[2013-07-01 21:48:23 -0400] siezer: chef-console
[2013-07-01 21:48:26 -0400] siezer: recipe_mode
[2013-07-01 21:48:33 -0400] siezer: file "hi"
[2013-07-01 21:48:41 -0400] siezer: file "hello_again"
[2013-07-01 21:48:45 -0400] siezer: resources
[2013-07-01 21:48:48 -0400] siezer: run_chef
[2013-07-01 21:49:08 -0400] matti: prefix: Its lower-case.
[2013-07-01 21:49:12 -0400] prefix: hm
[2013-07-01 21:49:14 -0400] prefix: odd
[2013-07-01 21:49:26 -0400] matti: prefix: This is not correct either:  Dir.entries("/tmp/ldap_tools/" == 2)
[2013-07-01 21:49:26 -0400] prefix: I just removed the require statement and it worked
[2013-07-01 21:49:44 -0400] prefix: Matti what's wrong about it
[2013-07-01 21:49:57 -0400] matti: prefix: Chef most likely imports FileUtils class at some point.
[2013-07-01 21:50:11 -0400] matti: prefix: Well, its programming 101.
[2013-07-01 21:50:24 -0400] matti: prefix: FOO.method(paramters)
[2013-07-01 21:50:45 -0400] matti: Now, you have : Foo.method(paramters == [boolean] 2)
[2013-07-01 21:51:06 -0400] matti: I'd imagine Dir.entries('/tmp/ldap_tools').size == 2
[2013-07-01 21:51:18 -0400] matti: ;D
[2013-07-01 21:52:09 -0400] siezer: fileutils protip, you have to use ::File instead of File, because of Chef's File resource ;)
[2013-07-01 21:52:18 -0400] matti: Yeah, that too.
[2013-07-01 21:52:51 -0400] siezer: and style protip: don't be doing a bunch of ruby in your recipes. stick that stuff in libraries and use them in providers
[2013-07-01 21:55:12 -0400] matti: siezer: For what he is doing ruby_block will do.
[2013-07-01 21:55:17 -0400] matti: siezer: But +1 of course.
[2013-07-01 21:55:44 -0400] prefix: yeah
[2013-07-01 21:55:50 -0400] prefix: I mean, you're probably right
[2013-07-01 21:56:17 -0400] prefix: I just don't have a ton of time to writer super amazing code
[2013-07-01 21:58:14 -0400] matti: prefix: Buy Ruby book too.
[2013-07-01 21:58:16 -0400] matti: ;]
[2013-07-01 21:58:22 -0400] prefix: lololol
[2013-07-01 21:58:31 -0400] matti: prefix: If you konow Perl or something, I recommend Eloquent Ruby ;]
[2013-07-01 21:58:46 -0400] prefix: I'm doing this project for the summer, and then I'm not going to touch ruby forever
[2013-07-01 21:59:00 -0400] prefix: I'm a web guy
[2013-07-01 21:59:07 -0400] prefix: not really devops
[2013-07-01 21:59:22 -0400] prefix: but this was a good project, so I took it
[2013-07-01 21:59:55 -0400] prefix: are you 100% sure about ('/tmp/ldap_tools').size == 2?
[2013-07-01 22:00:44 -0400] matti: irb(main):002:0> Dir.entries('/etc').size
[2013-07-01 22:00:45 -0400] matti: => 94
[2013-07-01 22:00:45 -0400] matti: irb(main):003:0> Dir.entries('/etc').size == 2
[2013-07-01 22:00:45 -0400] matti: => false
[2013-07-01 22:00:47 -0400] matti: irb(main):004:0>
[2013-07-01 22:00:49 -0400] matti: Positive.
[2013-07-01 22:00:55 -0400] prefix: perfect
[2013-07-01 22:00:55 -0400] matti: I write Ruby all the time.
[2013-07-01 22:01:03 -0400] prefix: dunno how I feel about ruby
[2013-07-01 22:01:25 -0400] prefix: i feel like it's kinda distracting
[2013-07-01 22:01:33 -0400] matti: prefix: There is one thing with this approach.
[2013-07-01 22:01:55 -0400] matti: prefix: . and .. are correct "directory entries" as they are also in dentry structure for a directory.
[2013-07-01 22:02:09 -0400] matti: prefix: Empty directory also has == 2 as true.
[2013-07-01 22:02:09 -0400] matti: ;]
[2013-07-01 22:02:27 -0400] prefix: yeah; that's fine
[2013-07-01 22:02:48 -0400] prefix: the directory won't exist if these programs haven't been loaded
[2013-07-01 22:03:01 -0400] prefix: unless someone really screwed up the environment
[2013-07-01 22:03:07 -0400] prefix: in which case, glhf
[2013-07-01 22:04:42 -0400] imeyer: OHAI
[2013-07-01 22:04:54 -0400] prefix: omg
[2013-07-01 22:05:01 -0400] prefix: my recipe is working!
[2013-07-01 22:05:12 -0400] matti: prefix: ;]
[2013-07-01 22:05:17 -0400] matti: prefix: Oh then.
[2013-07-01 22:05:24 -0400] matti: prefix: Dir.entries is an overkill.
[2013-07-01 22:05:43 -0400] prefix: oh wait
[2013-07-01 22:05:46 -0400] prefix: no it broke
[2013-07-01 22:05:56 -0400] siezer: OHAI
[2013-07-01 22:06:15 -0400] Otterley: Dir.entries is overkill for what?
[2013-07-01 22:06:19 -0400] imeyer: OHAI siezer
[2013-07-01 22:06:38 -0400] matti: prefix: {File,Dir}.exists? would do.
[2013-07-01 22:06:53 -0400] prefix: probably
[2013-07-01 22:06:53 -0400] prefix: ok
[2013-07-01 22:07:00 -0400] prefix: I'm going to attack this one tomorrow
[2013-07-01 22:07:04 -0400] matti: Otterley: Pardon?
[2013-07-01 22:07:07 -0400] prefix: <3 all of you
[2013-07-01 22:07:12 -0400] matti: ;p
[2013-07-01 22:07:18 -0400] matti: prefix: So much love ;d
[2013-07-01 22:14:24 -0400] frk131: hi, i am new to chef and ruby, i am a bit confused by the chef dsl, something like "file" is a function call to file, with the first parameter a string and the second a lambda? right? where can is find these functions?
[2013-07-01 22:15:27 -0400] matti: frk131: Well, Proc and lambda are kind of ... almost but not quite the same.
[2013-07-01 22:15:42 -0400] matti: frk131: In case of "file" resource it takes a block.
[2013-07-01 22:15:52 -0400] matti: frk131: Which is not quite the same thing as Proc/lambda.
[2013-07-01 22:17:05 -0400] frk131: matti: so if i have apache_site "?" do enable false end, i call the function apache_site with a string and a block? what is enable false? a property bound to the scope of the block?
[2013-07-01 22:17:30 -0400] Otterley: enable is a function call too.  isn't Ruby's optional parens confusing?
[2013-07-01 22:17:39 -0400] Otterley: "yes, yes it is, Otterley!"
[2013-07-01 22:17:50 -0400] matti: frk131: http://blog.8thlight.com/micah-martin/2007/05/20/ruby-dsl-blocks.html
[2013-07-01 22:17:53 -0400] matti: Otterley: :)
[2013-07-01 22:17:54 -0400] Otterley: I <3 Ruby SO MUCH
[2013-07-01 22:18:07 -0400] matti: Haha
[2013-07-01 22:18:11 -0400] Otterley: "disambiguate functions and operators?  who'd want to do that?"
[2013-07-01 22:18:18 -0400] frk131: mhm, i am a bit confused by ruby :P
[2013-07-01 22:19:37 -0400] bnzmnzhnz: frk131: you are saying apache_site("?", { enable(false) })
[2013-07-01 22:19:39 -0400] matti: frk131: http://rubylearning.com/blog/2010/11/30/how-do-i-build-dsls-with-yield-and-instance_eval/
[2013-07-01 22:19:42 -0400] pedda: hi all
[2013-07-01 22:19:51 -0400] matti: frk131: http://www.steve.stewdle.com/blog/?p=19
[2013-07-01 22:19:57 -0400] matti: frk131: You get the idea.
[2013-07-01 22:20:04 -0400] pedda: i have a question regarding chef update (chef_solo)
[2013-07-01 22:20:17 -0400] frk131: matti: i'll look at this links
[2013-07-01 22:20:42 -0400] pedda: i have a mac running 10.8.x when i fire up vagrant i get some row telling me about chef 10.14.2 being used
[2013-07-01 22:20:51 -0400] frk131: i found the function definition, it's define :apache_site, :enable => true do .... end i have a bunch of questions about. the define function is about chef, right?
[2013-07-01 22:20:53 -0400] matti: I need to eat dinner, forgive me frk131 ;]
[2013-07-01 22:21:07 -0400] pedda: when i inspect gem list for chef version i get 11.4 ?!
[2013-07-01 22:21:08 -0400] frk131: matti: thanks for your time
[2013-07-01 22:21:13 -0400] matti: frk131: http://blog.crowdint.com/2011/01/14/building-a-basic-dsl-to-create-callbacks-in-ruby.html
[2013-07-01 22:21:22 -0400] matti: frk131: http://blog.jayfields.com/2008/02/implementing-internal-dsl-in-ruby.html
[2013-07-01 22:21:30 -0400] frk131: matti: jeah i have this tabs open and start to read right now
[2013-07-01 22:21:42 -0400] matti: ;]
[2013-07-01 22:21:50 -0400] matti: frk131: If you know Perl, Python et al
[2013-07-01 22:21:55 -0400] matti: frk131: Get "Eloquent Ruby" books.
[2013-07-01 22:21:57 -0400] matti: book*
[2013-07-01 22:22:17 -0400] matti: frk131: It touches on Ruby-specific things, instead of teaching you what an Integer is again.
[2013-07-01 22:22:22 -0400] anoldhacker: I'm wanting to wrap the file resource so that users don't have to specify so many options.  I expect this would be a common case, but I've not had any luck finding examples or documentation for wrapping a resource.  ???
[2013-07-01 22:22:45 -0400] matti: anoldhacker: I'd suggest define maybe.
[2013-07-01 22:22:50 -0400] matti: anoldhacker: The simplest.
[2013-07-01 22:22:58 -0400] jtimberman: frk131: in chef's resource DSL, resources are constructed via overriding Ruby's method_missing. the resource type (file, package, cookbook_file, user, etc) is the method, and it takes two arguments, a string (the resource's name) and a block (the resource's attributes, or parameters.)
[2013-07-01 22:23:08 -0400] matti: anoldhacker: http://docs.opscode.com/essentials_cookbook_definitions.html
[2013-07-01 22:23:25 -0400] jtimberman: pedda: sounds like the vagrant box you're using already has chef 10.14.2 installed.
[2013-07-01 22:23:25 -0400] pedda: anyone?
[2013-07-01 22:23:42 -0400] pedda: if i destroy it, will it get the updated version ?
[2013-07-01 22:23:50 -0400] pedda: <- new to vagrant
[2013-07-01 22:23:57 -0400] anoldhacker: I'm being steered away from definitions for this.  I can check.
[2013-07-01 22:24:07 -0400] jtimberman: pedda: no, the .box file that you downloaded is precreated with that already installed.
[2013-07-01 22:24:18 -0400] pedda: oh..
[2013-07-01 22:24:26 -0400] Otterley: matti, anoldhacker: definitions are simple but not recommended because you can't "undefine" them (i.e. you can't do action :remove)
[2013-07-01 22:24:36 -0400] jtimberman: pedda: you can tell vagrnt to update it with the vagrant-omnibus plugin (if you're using vagrant 1.1+)
[2013-07-01 22:24:37 -0400] frk131: jtimberman: this are define :apache_site, :enable => true do end the same like define('apache_site', {enable => false}, function() {}) in other languages?
[2013-07-01 22:24:39 -0400] Otterley: I suggest LWRPs instead
[2013-07-01 22:24:49 -0400] jtimberman: frk131: apache_site is a definition, which is slightly different.
[2013-07-01 22:25:02 -0400] matti: Otterley: OK, what do you recommend? A proper resource?
[2013-07-01 22:25:09 -0400] Otterley: LWRP
[2013-07-01 22:25:10 -0400] frk131: jtimberman: define isnt a method call?
[2013-07-01 22:25:20 -0400] Otterley: LWRPs are easy to write, once you get the hang of it
[2013-07-01 22:25:21 -0400] matti: Otterley: OK, I always forget about LWRPs ;
[2013-07-01 22:25:22 -0400] matti: ;]
[2013-07-01 22:25:24 -0400] jtimberman: define is a method that tells chef to create a new definition.
[2013-07-01 22:25:25 -0400] anoldhacker: That's what I'm expecting.
[2013-07-01 22:25:37 -0400] jtimberman: a definition looks like a resource, however it is not a resource.
[2013-07-01 22:25:42 -0400] jtimberman: Otterley: sort of... :)
[2013-07-01 22:25:58 -0400] jtimberman: Otterley: if you implement behavior for an action parameter, then you could mimic that :)
[2013-07-01 22:25:59 -0400] Otterley: note my qualifier jtimberman ;)
[2013-07-01 22:26:14 -0400] Otterley: yeah, but by then you may as well write a LWRP
[2013-07-01 22:26:28 -0400] anoldhacker: So do I create an instance of ::Chef::File, and go from there?
[2013-07-01 22:27:02 -0400] jtimberman: frk131: define takes 2 or more arguments. the first is the name (:apache_site), the  last is a block (do...end). all the others between the name and the block are a hash of arguments that are available as the params hash in the definition
[2013-07-01 22:27:27 -0400] frk131: so for example if i want to run a mysql query, if a table doesnt exists, how to do this? i use execute and if_not + system('mysql ....')?
[2013-07-01 22:27:32 -0400] jtimberman: so define :apache_site, :foo => "bar" do ... end
[2013-07-01 22:27:47 -0400] jtimberman: will have a params[:foo] available, and if not specified will have a value of bar.
[2013-07-01 22:27:55 -0400] frk131: jtimberman: how to find the related chef code, can i set breakpoints to know how chef really works?
[2013-07-01 22:28:13 -0400] sbrinkmeyer: hi my name is scott and i have a problem
[2013-07-01 22:28:30 -0400] pedda: jtimberman thx for hin :)
[2013-07-01 22:28:39 -0400] pedda: update worked like a charm
[2013-07-01 22:28:44 -0400] pedda: *hint
[2013-07-01 22:28:48 -0400] jtimberman: frk131: https://github.com/opscode/chef/blob/master/lib/chef/dsl/recipe.rb
[2013-07-01 22:29:00 -0400] sbrinkmeyer: so if i have a remote_file doing stuff with notifies in the block and a not_if at the end of the block, ... i'm supposing the notifies won't fire if the not_if condition is me
[2013-07-01 22:29:02 -0400] sbrinkmeyer: is met
[2013-07-01 22:29:20 -0400] imeyer: jtimberman: OHAI
[2013-07-01 22:29:21 -0400] jtimberman: frk131: thats how the DSL is implemented
[2013-07-01 22:29:33 -0400] sbrinkmeyer: as the entire remote_file block shouldn't do anything
[2013-07-01 22:29:43 -0400] jtimberman: https://github.com/opscode/chef/blob/master/lib/chef/resource_definition.rb
[2013-07-01 22:30:02 -0400] jtimberman: imeyer: HAIL, FRND
[2013-07-01 22:30:07 -0400] jtimberman: pedda: :)
[2013-07-01 22:30:25 -0400] pedda: can you tell me which version you are using atm?
[2013-07-01 22:30:25 -0400] matti: ;]
[2013-07-01 22:30:51 -0400] pedda: it seems as if my struggeling with the whole vagrant topic is kind of related to several version based issues
[2013-07-01 22:31:38 -0400] pedda: how can i downgrade a chef version?
[2013-07-01 22:32:59 -0400] anoldhacker: Okay, I should use LWRP.  Where/how do I access the file resource from within an LWRP?
[2013-07-01 22:33:22 -0400] jtimberman: anoldhacker: you can use Chef resources inside providers' actions
[2013-07-01 22:34:54 -0400] c_t: ohai imeyer
[2013-07-01 22:35:01 -0400] anoldhacker: okay
[2013-07-01 22:35:35 -0400] imeyer: ohai c_t! long time no irc
[2013-07-01 22:37:35 -0400] matti: jtimberman: Have you seen my question from before?
[2013-07-01 22:37:51 -0400] matti: jtimberman: siezer pushed me in right direction, but what do you think?
[2013-07-01 22:38:41 -0400] imeyer: c_t: nice, i just started working @ knewton
[2013-07-01 22:41:22 -0400] imeyer: c_t: at least they're interesting, yeah?
[2013-07-01 22:44:22 -0400] c_t: ja
[2013-07-01 22:44:55 -0400] c_t: as a learning exercise, I ported xiafs (if you remember it, you're old like me or older) to the kernel that shipped with squeeze
[2013-07-01 22:45:23 -0400] c_t: and then I ported a bunch of those old-timey bsdgames to OS X, because I kinda wanted to play a few of them
[2013-07-01 22:45:58 -0400] imeyer: oh that's freaking awesome
[2013-07-01 22:46:30 -0400] c_t: both a little pointless, but the xiafs thing especially was quite a learning experience
[2013-07-01 22:48:34 -0400] surge_: Is there any way to force chef to create a directory before checking a condition? putting the recipe before the conditional doesnt seem to be working since it looks like chef is evaluating things at compile time
[2013-07-01 22:49:34 -0400] imeyer: surge_: use ruby_block
[2013-07-01 22:50:08 -0400] imeyer: surge_: what's the current code you have?
[2013-07-01 22:51:26 -0400] surge_: imeyer: "directory rrd_dir do (with recursive, create and other sane options)" ---> down 50 lines or so ---> unless Dir.entries(rrd_dir).delete_if{|x| x =~ /\.+/ }.empty?
[2013-07-01 22:51:54 -0400] surge_: The problem is that collectd hasn't been restarted (or even installed for that matter) yet so the subdirectory is empty
[2013-07-01 22:52:04 -0400] surge_: idk why chef is doing this -__- it's really annoying
[2013-07-01 22:52:09 -0400] imeyer: ah okay, you can wrap that unless in a ruby_block and it should do what you want
[2013-07-01 22:52:44 -0400] surge_: yeah i've done something similar to force 'apt-get update' to install, but i guess there's no other way to do it
[2013-07-01 22:52:53 -0400] surge_: to run *
[2013-07-01 22:53:17 -0400] imeyer: yeah, i've just come to accept it for what it is. :)
[2013-07-01 22:58:59 -0400] pedda: anyone using mysql cookbook here?
[2013-07-01 23:02:20 -0400] surge_: pedda: to some degree, yes
[2013-07-01 23:04:34 -0400] jtimberman: matti: saw it, afraid i don't have context about it, and haven't read the previous backscroll
[2013-07-01 23:08:31 -0400] surge_: imeyer: INFO: execute[create rrd dir] ran successfully (woo!)
[2013-07-01 23:30:47 -0400] chip-: Anybody used the minitest busser with test-kitchen?
[2013-07-01 23:30:59 -0400] chip-: If so, got a link to example code in a repo somewhere?
[2013-07-01 23:35:57 -0400] fowlduck: is there a way to debug an attribute and figure out where it's getting its value from?
[2013-07-01 23:38:47 -0400] northface: I am working on automating the creation of AMI images in AWS. I want to be able to use Chef as a way to bootstrap these images and then bundle them. Is there a quick way to deregister a node?
[2013-07-01 23:44:13 -0400] stormerider: northface: a live node, or pruning dead nodes?
[2013-07-01 23:44:29 -0400] lledet: I'm getting an error on this line "package_name node['apache']['package']" in the apache2 default recipe, it doesn't seem like it's using the default attributes from the apache2 cookbook, how can i make sure it uses those defaults?
[2013-07-01 23:44:39 -0400] northface: this would be a live node for just as long as it takes to burn an AMI image and then remove it.
[2013-07-01 23:45:53 -0400] fowlduck: shef shows the correct value for this node, but when the config is generated on the server it has the wrong value...
[2013-07-01 23:45:55 -0400] fowlduck: :/
[2013-07-01 23:46:50 -0400] jessicab1: northface:  pretty sure ive seen someone do that by just doing api calls in a recipe, an api call to the node delete, and another to the client delete
[2013-07-01 23:46:59 -0400] stormerider: northface: something like this might work: knife node delete `hostname -f` -y -c /etc/chef/client.rb && knife client delete `hostname -f` -y -c /etc/chef/client.rb
[2013-07-01 23:47:32 -0400] stormerider: obviously adjusting hostname -f depending on how you name stuff
[2013-07-01 23:50:51 -0400] northface: thanks jessicab1 and stormrider
[2013-07-01 23:51:12 -0400] sbrinkmeyer: fowlduck: you can use a Chef::Log.info "== #{ATTR} "
[2013-07-01 23:51:24 -0400] fowlduck: does that show where it got set?
[2013-07-01 23:51:27 -0400] matti: jtimberman: No problem -- I was wonder how to go about writing LWRP/resource that can be used multiple times in the recipe like e.g. foo 'a' do ... end; foo 'b' do ... end; etc.
[2013-07-01 23:51:33 -0400] sbrinkmeyer: nope
[2013-07-01 23:52:03 -0400] fowlduck: hrm
[2013-07-01 23:52:04 -0400] matti: jtimberman: Imagine that each would be an option that should land in /etc/foo.conf
[2013-07-01 23:52:06 -0400] fowlduck: oh, debug_value
[2013-07-01 23:53:24 -0400] fowlduck: ffs, chef is really hard to debug
