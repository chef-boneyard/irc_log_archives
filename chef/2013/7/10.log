[2013-07-10 00:05:00 -0400] troyready: Anyone know of any good examples of command/shell script output (from a ruby_block or execute resource) being used in a chef recipe? I've done a little bit with ruby_block, but I'm drawing a blank on how to take the output of a command and use it elsewhere in a recipe (like output.each do)
[2013-07-10 00:06:42 -0400] troyready: Specifically, I"m trying to iterate through a number of cron resources depending on the number of ZFS zpools I have on my system, but being able to solve this type of problem would help my recipe development immensely
[2013-07-10 00:22:49 -0400] troyready: Ok, think I answered my own question -- may not be the most elegant thing, but it looks like "output = `zpool list ...` ; output.split(",").each do | x | ..." works in the way I was looking for
[2013-07-10 00:51:52 -0400] inimit: the ruby cookbook is kinda failing me.. I am trying to get a new server setup which is using ruby 1.9.x. I use the cookbook and I find it does indeed get installed, but it's not active and a number of files point to ruby1.8
[2013-07-10 00:52:52 -0400] inimit: is there a better way to upgrade ruby? one alternative is to use rvm but I'm not sure that's the best angle
[2013-07-10 00:55:30 -0400] poli: inimit: no opinion about how to do it, just that rails that used to recommend rvm is now recommending rbenv, you might want to check it out.
[2013-07-10 00:56:06 -0400] inimit: poli: looking at rbenv right now.. thx
[2013-07-10 02:11:50 -0400] anthroprose: anyone use hosted chef behind a proxy such as squid?
[2013-07-10 02:12:02 -0400] anthroprose: having trouble registering new clients, everything else seems to work fine
[2013-07-10 02:14:50 -0400] anthroprose: if I do a curl -L by hand I get: "{ "error": "401 - Unauthorized.  You must properly authenticate your API requests!" }" which I would expect but when running chef-client itself, it hangs on "Creating a new client identity for Jul9-AC-5 using the validator key.
[2013-07-10 02:14:50 -0400] anthroprose: [2013-07-10T02:13:55+00:00] INFO: Client key /etc/chef/Jul9-AC-5.pem is not present - registering
[2013-07-10 02:14:51 -0400] anthroprose: "
[2013-07-10 02:15:21 -0400] anthroprose: [2013-07-10T02:14:58+00:00] FATAL: Errno::ETIMEDOUT: Error connecting to https://api.opscode.com/organization ..........
[2013-07-10 02:27:25 -0400] anthroprose: btw... this issue was because I didnt have http:// chef does not follow the *nix standards of host:port but also required protocol as well
[2013-07-10 02:42:48 -0400] jtimberman: anthroprose: it uses a URI, as it is a RESTful API.
[2013-07-10 02:43:09 -0400] jtimberman: https://api.opscode.com/organization/ORGNAME is correct for the chef_server_url
[2013-07-10 02:43:19 -0400] jtimberman: where ORGNAMe is changed to your actual org name :)
[2013-07-10 03:17:23 -0400] hakunin_: So a day later, no issues with chef server, until just now I looked, and client hasn't reported in 5 hours. I looked into client's chef log, and Connection timed out - connect(2).
[2013-07-10 03:18:31 -0400] hakunin: i looked at ram, and 200mb shows free, but who knows, something may have gone down temporarily
[2013-07-10 03:18:46 -0400] hakunin: and when i went to web ui, it took a while to show up first time
[2013-07-10 03:19:24 -0400] hakunin: right now chef-server-ctl status shows all up, but i didn't look before i went to web gui
[2013-07-10 03:19:49 -0400] hakunin: maybe my adjustments weren't good enough
[2013-07-10 03:20:02 -0400] hakunin: my tuning of ram usage
[2013-07-10 03:21:26 -0400] hakunin: tabolario: hey, you said you're running server on m1.small, would you be able to share your /etc/chef-server/chef-server.rb
[2013-07-10 03:22:36 -0400] hakunin: this is my chef-server.rb: https://gist.github.com/maxim/1468af1f6c86234968d6
[2013-07-10 03:23:00 -0400] tabolario: sure! https://gist.github.com/tabolario/f09d71427fea36e870d6
[2013-07-10 03:23:17 -0400] tabolario: i actually haven't tweaked the memory limits at all
[2013-07-10 03:23:30 -0400] hakunin: hm
[2013-07-10 03:23:37 -0400] hakunin: and you're running with 1.7gb
[2013-07-10 03:23:55 -0400] hakunin: toady00: i had a suspicion it might be related to hostname resolution
[2013-07-10 03:24:05 -0400] hakunin: toady00: sorry, i meant tabolario
[2013-07-10 03:24:37 -0400] tabolario: yeah, although it does look like i'm swapping a bit
[2013-07-10 03:25:15 -0400] hakunin: tabolario: hm, i think my server has no swap at all
[2013-07-10 03:25:28 -0400] hakunin: that would explain problems
[2013-07-10 03:25:43 -0400] tabolario: are you having resource issues?
[2013-07-10 03:27:12 -0400] hakunin: tabolario: i have too much ram usage on 2gb, it used to keep at 70mb free, after tweaks, it went up to 300mb free, but something must be crashing because all of a sudden it stopped accepting client connections
[2013-07-10 03:27:26 -0400] tabolario: are you running anything else on it?
[2013-07-10 03:27:31 -0400] hakunin: nope
[2013-07-10 03:28:07 -0400] hakunin: it's a blank 12.04 x64 machine with latest vanilla server from omnibus
[2013-07-10 03:29:08 -0400] hakunin: but i do have strange domain resolution issues
[2013-07-10 03:29:14 -0400] hakunin: sometimes
[2013-07-10 03:29:29 -0400] hakunin: tabolario: i will try to do what you did with fqdn settings
[2013-07-10 03:29:35 -0400] hakunin: see how that works
[2013-07-10 04:28:32 -0400] Creeves: anyone here used the chef-rvm cookbook?
[2013-07-10 04:33:59 -0400] Maleus_: hey guys Im trying to use chef for the first time, going through the tutorial, and getting this opt/chef/embedded/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247
[2013-07-10 04:34:41 -0400] Maleus_: been googling for about an hour, and Im not seeing concrete answers on that specific error
[2013-07-10 04:45:33 -0400] alyur: Maleus_: I don
[2013-07-10 04:45:43 -0400] Maleus_: I figured it out
[2013-07-10 04:45:47 -0400] alyur: I don't see error in yout message
[2013-07-10 04:46:17 -0400] Maleus_: oh, thats weird, but I ended up having to remove chef and reinstall the gem, it works now
[2013-07-10 04:46:29 -0400] Maleus_: thanks for acknowledging anyway :)
[2013-07-10 04:50:35 -0400] coderanger: Maleus_: Installing via rubygems is neither recommended nor particularly well supported
[2013-07-10 04:50:59 -0400] coderanger: Maleus_: If you pastebin  your error I can look, but about I think I see my ride so probably not for an hour when I get home :)
[2013-07-10 04:51:47 -0400] Maleus_: Ok, I will be in bed within an hour, but I will keep this window up and send a pastebin link to you
[2013-07-10 04:55:46 -0400] jmickle: coderanger: you up this late?
[2013-07-10 04:55:47 -0400] jmickle: :-P
[2013-07-10 05:01:47 -0400] dyu: what's the proper way of migrating nodes to a new chef server?
[2013-07-10 05:13:26 -0400] hakunin: So using knife to add a new machine. Twice. First time: after machine came online and knife started bootstrap: ERROR: Net::SSH::Disconnect: connection closed by remote host. Second time: it was stuck on "Creating a new client identity" and then "Connection timed out" (to chef server). Chef server is working.
[2013-07-10 05:13:55 -0400] hakunin: I ssh'ed into the new machine, tried curl -I [my-chef-server]/clients - got "SSH certificate problem"
[2013-07-10 05:14:02 -0400] hakunin: verify failed
[2013-07-10 05:17:26 -0400] Maleus_: Im doing the tutorial, I was having problems before, and on the bootstrapping portion Im now getting this error, all of this is new to me http://pastebin.com/LcNUwb1E
[2013-07-10 05:50:01 -0400] coderanger: jmickle: Barely, just got home and will be passing out shortly
[2013-07-10 05:50:07 -0400] jmickle: ah
[2013-07-10 05:50:17 -0400] jmickle: migrating a huge redis store right now :(
[2013-07-10 05:50:20 -0400] jmickle: il be up all night
[2013-07-10 05:50:32 -0400] coderanger: loldatabass
[2013-07-10 05:50:40 -0400] jmickle: yep
[2013-07-10 05:50:48 -0400] jmickle: shitty amazon ec2 and degraded hardware ;-P
[2013-07-10 05:51:00 -0400] jmickle: combined with legacy architecture
[2013-07-10 05:51:01 -0400] jmickle: haha
[2013-07-10 05:51:23 -0400] coderanger: DROP DATABASS;
[2013-07-10 05:51:45 -0400] coderanger: Also http://3.asset.soup.io/asset/3776/2147_ecdd.png
[2013-07-10 05:54:20 -0400] jmickle: hahahaha
[2013-07-10 05:54:21 -0400] jmickle: awesome
[2013-07-10 06:07:20 -0400] hakunin: Ok, so all my clients are frequently timing out trying to connect to server.
[2013-07-10 06:08:10 -0400] hakunin: this is very frustrating
[2013-07-10 06:08:14 -0400] hakunin: :(
[2013-07-10 06:08:47 -0400] Creeves: anyone deployed an application using the application cookbook from a repo with a password?
[2013-07-10 06:08:48 -0400] hakunin: is my iptables too restrictive for chef server?
[2013-07-10 06:09:22 -0400] hakunin: then why is it intermittent?
[2013-07-10 06:09:31 -0400] hakunin: i don't get what's going on
[2013-07-10 06:36:09 -0400] m4rcu5: jtimberman: you around?
[2013-07-10 06:39:29 -0400] hakunin: if jtimberman is indeed around, i would madly appreciate looking into my chef client timeout issue, i explained here: http://serverfault.com/questions/522152/chef-clients-time-out-trying-to-connect-to-server
[2013-07-10 06:39:51 -0400] hakunin: of course anyone's input would be invaluable
[2013-07-10 06:43:03 -0400] m4rcu5: my question is regarding the logrotate cookbook, can we have a new version tagged? we would like to include pull request #8 :)
[2013-07-10 06:43:29 -0400] hakunin: I have a theory
[2013-07-10 06:44:16 -0400] hakunin: If I changed FQDN after I launched chef server and some clients, does it mean that some certificates become invalid?
[2013-07-10 06:56:17 -0400] kisoku: does any one have an idea of what user busser executes it's tests as ?
[2013-07-10 06:56:51 -0400] kisoku: root ?
[2013-07-10 08:02:45 -0400] hakunin: Added a swap to my chef server reconfigured it back to defaults please no more weirdness
[2013-07-10 08:26:09 -0400] daxroc: Morning all
[2013-07-10 08:27:08 -0400] daxroc: With chef-client to server communication Is it all done over http/s - restful interface ?
[2013-07-10 08:28:30 -0400] daxroc: Does it use standard ports for this communication?
[2013-07-10 08:53:20 -0400] nazgul: hello
[2013-07-10 08:54:27 -0400] hakunin: daxroc: that seems correct, yes
[2013-07-10 08:59:03 -0400] nazgul: is anyone there?
[2013-07-10 09:00:46 -0400] bigbigbang: Ohai ! Can you (chef experts) give some information about OSC ? I would like to know if you think it's possible to "easily" update rabbitmq ...
[2013-07-10 09:04:02 -0400] bigbigbang: it doesn't seem to be so hard , but if someone could give tips or advice .. if there is any ..  anyway, I will try it
[2013-07-10 09:05:59 -0400] bigbigbang: and another request .. when will the "manual chef installation" documentation (erchef) be updated ?
[2013-07-10 09:28:02 -0400] dyu: my redis service won't start after a reboot. it starts after the recipe installs the package. http://paste.ubuntu.com/5861089/
[2013-07-10 10:47:58 -0400] kisoku: anyone have a good pattern for disabling default init scripts ?
[2013-07-10 10:54:13 -0400] axyelp: is there any way to notify if a bash or execute block fails?
[2013-07-10 10:54:48 -0400] gchristensen: axyelp: if it fails, your convergance fails.
[2013-07-10 10:55:23 -0400] axyelp: gchristensen: well, i want to execute a resource, email actually, if a process is not running! any good way!?
[2013-07-10 10:56:09 -0400] gchristensen: ah! what is your test to see if its running?
[2013-07-10 10:56:32 -0400] axyelp: apps running on the nodes. nginx, unicorn etc...
[2013-07-10 10:56:47 -0400] kisoku: make a resource to send email and not_if "pgrep -lf myprocess"
[2013-07-10 10:57:15 -0400] gchristensen: ^ that. not_if or only_if and then a string, will get executed as shell
[2013-07-10 10:57:26 -0400] axyelp: kisoku: oh! didn't know if i could do that. gchristensen: i am using pgrep.
[2013-07-10 10:57:46 -0400] axyelp: gchristensen: kisoku: cool! thanks!
[2013-07-10 10:58:38 -0400] gchristensen: I recommend reading the chef manual cover to cover :)
[2013-07-10 11:02:10 -0400] axyelp: gchristensen: right! thanks! :)
[2013-07-10 12:07:16 -0400] willejs: hi, is there a plugin for knife that clones a chef ec2 node, (trys to )kill the old one and boots the new one? (maybe with modified params)
[2013-07-10 12:09:09 -0400] s2r2_: dear chefs.  can I affect the [arch=amd64] setting in the sources.list.d/whatever.list created by apt_repository?
[2013-07-10 12:10:08 -0400] s2r2_: https://github.com/opscode-cookbooks/apt/blob/master/resources/repository.rb#L32   yes I can. thanks anyway :)
[2013-07-10 12:17:29 -0400] jhiggs: can someone explain to me the advantages of using something like librarian vs plain old git submodules?
[2013-07-10 12:24:32 -0400] bigbigbang: Trying to update rabbitmq in OSC get this error : STDOUT: error creating client <<"chef-validator">>: {badrpc,     {'EXIT',    {{timeout,    {gen_server,call,   [gen_bunny_mon,    {connect,<6349.247.0>, {network,"127.0.0.1",5672,   {<<"chef">>, .............   can someone help ?
[2013-07-10 12:24:59 -0400] bigbigbang: .. when performaing the first bootstrap
[2013-07-10 12:35:08 -0400] bigbigbang: found this in bootstrap-chef-server :   %% TODO: The cookie used by erchef should be part of config     -> would be great and not so hard IMO
[2013-07-10 12:56:04 -0400] adamjk-dev: hey
[2013-07-10 12:56:14 -0400] adamjk-dev: has anyone dealt with the ark cookbook and the following issue: http://tickets.opscode.com/browse/COOK-3053?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel
[2013-07-10 13:05:20 -0400] joshmyer_: hey guys, how can I do a search for nodes with hostnames begginning with X?
[2013-07-10 13:05:36 -0400] arir: Hi folks, we've just released a cookbook that installs and configures Oracle on Red Hat/derivatives. Have a look at https://github.com/echaeu/echa-oracle. Any feedback/contribution is welcome.
[2013-07-10 13:08:48 -0400] joshmyer_: nice one arir
[2013-07-10 13:17:12 -0400] nico: Hi there
[2013-07-10 13:17:56 -0400] nico: I'm having trouble in setting up my chef 11 server.
[2013-07-10 13:18:13 -0400] nico: I can do "knife client list" without problem, but upload fails
[2013-07-10 13:18:43 -0400] nico: It generates an error 500 in nginx logs, but I can't figure out where this comes from
[2013-07-10 13:19:02 -0400] nico: did anyone experiment this behavior ?
[2013-07-10 13:33:23 -0400] dsteen: ls
[2013-07-10 13:33:37 -0400] dsteen: sorry wrong window :-)
[2013-07-10 14:35:53 -0400] castro1688: hey everyone! quick question.. How to you handle if your service action has a dash.. ie bootstrap-pxc? under my service i have "supports :restart => true, :'bootstrap-pxc' => true", but my notifies doesnt recognize it "notifies :'bootstrap-pxc', "service[mysql]", :immediately"
[2013-07-10 14:36:48 -0400] castro1688: if i dont single quote it, it thinks pxc is a method
[2013-07-10 14:37:02 -0400] castro1688:  FATAL: NameError: service[mysql] (percona-hp::configure_server line 35) had an error: NameError: Cannot find a resource for action_bootstrap-pxc on ubuntu version 12.04
[2013-07-10 14:46:25 -0400] nico: did you try using .to_sym ?
[2013-07-10 14:46:34 -0400] nico: "bootstrap-pxc".to_sym
[2013-07-10 14:57:22 -0400] smj4450: has anyone gotten a 400 bad request error with the http request resource with the 11.6.0.rc.1 client?
[2013-07-10 14:59:24 -0400] castro1688: i have not. i'll take a look into that. my ugly work around was have an execute block calling the service command
[2013-07-10 15:12:11 -0400] cassianoleal: Can anyone help me with the application_ruby cookbook?
[2013-07-10 15:12:46 -0400] cassianoleal: I'm trying to deploy an app using attributes for configuration, but the database block doesn't seem to be able to access the node object
[2013-07-10 15:12:54 -0400] cassianoleal: how do I get that to work?
[2013-07-10 15:38:35 -0400] ehthayer: leaving out a resource attribute definition silently results in an empty value and no error on chef-solo run?  (chef-solo v11.4.4)
[2013-07-10 15:43:20 -0400] ehthayer: could be me.  still converging my brain chef state.
[2013-07-10 15:54:14 -0400] zaargy: can someone help me work otu what's up with my attributes here? https://gist.github.com/zaargy/5967499
[2013-07-10 16:48:51 -0400] castro1688: Anyone ever get this error when calling a resource they created.. "had an error: ArgumentError: wrong number of arguments (1 for 0)"
[2013-07-10 16:49:21 -0400] castro1688: it points to the line where i call the resource, but i'm not sure if its actually a problem with the resource
[2013-07-10 16:58:54 -0400] maplebed: So I discovered yesterday that when testing an attribute that might not exist, I can end the if clause with 'rescue NoMethodError to avoid the chef run crashing with 'undefined method [] for nil:NilClass'.  Opinions? Is this a terrible hack frought with peril or an effective way of dealing with node attributes?
[2013-07-10 16:59:53 -0400] maplebed: eg if node['foo']['bar']['baz'] == something blah blah end rescue NoMethodError
[2013-07-10 17:09:13 -0400] castro1688: ugh. nevermind. figured it out. had a :create in my ruby_block
[2013-07-10 17:14:05 -0400] freezey: imported some databags into chef11 and I am noticing that chef_type data_bag_item is missing. When the recipe runs it doesnt utilize any information inside of these databags
[2013-07-10 17:30:21 -0400] queso: Is there a python client/api for running knife-like commands?
[2013-07-10 17:32:00 -0400] rracterr: the backup feature with cookbook_file is really handy... there needs to be something equivilent for templates...
[2013-07-10 17:32:26 -0400] rracterr: even if the filename.1 file just has the diff's... would be something at least... but ideally the entire previous file.
[2013-07-10 17:33:55 -0400] douglaswth: rracterr: I'm pretty sure template has the same feature
[2013-07-10 17:37:00 -0400] rracterr: I'm looking at the sudo cookbook... recipe uses template and does not specify backup false... yet I see no sudoers.1 in the directory after it makes its changes... wierd then.
[2013-07-10 17:38:35 -0400] spox_: rracterr: chef stores backups in the file_store, not the directory itself
[2013-07-10 17:38:57 -0400] rracterr: seriously... christ how did I miss that... file_store == what?
[2013-07-10 17:42:30 -0400] coderanger: rracterr: depends on how you installed chef, but look in /var/chef/cache
[2013-07-10 17:42:54 -0400] coderanger: could also be /var/cache/chef
[2013-07-10 17:44:37 -0400] rracterr: coderanger: see no back up files in that /var/cache/chef... just the cache of the cookbooks and some pid and out files
[2013-07-10 17:45:10 -0400] rracterr: I also have the /var/chef/cache directory but its empty
[2013-07-10 17:45:38 -0400] rracterr: given I've deployed at least 5 different changes to the sudoers file I would have expected to see 5 backup files
[2013-07-10 17:46:03 -0400] coderanger: Sorry, check /var/chef/backup
[2013-07-10 17:46:20 -0400] coderanger: Brain just autocompleted that string since the cache files are usually where I'm looking :)
[2013-07-10 17:46:43 -0400] rracterr: sweeeet, thats exactly what I was hoping to see
[2013-07-10 17:52:02 -0400] inimit: when using rbenv/ruby_build, how do I see a list of rubies I can install?
[2013-07-10 17:52:13 -0400] gustavo: Hi everybody, I need install chef-server 11 on debian wheezy, but I don't find an omnibus package for wheezy. Anybody know how I can install chef server on Wheezy ?
[2013-07-10 17:53:19 -0400] coderanger: gustavo: use the deb6 packages
[2013-07-10 17:53:32 -0400] gleam: there are chef server packages for squeeze/
[2013-07-10 17:53:35 -0400] gleam: i thought just chef client
[2013-07-10 17:53:47 -0400] coderanger: Oh, sorry, you said server
[2013-07-10 17:54:03 -0400] coderanger: Yeah, we only build the server for ubuntu LTS and CentOS
[2013-07-10 17:54:23 -0400] coderanger: The ubuntu packages will probably work
[2013-07-10 17:56:26 -0400] ponyofde1th: hi, anyone know why this is giving an error http://paste.ubuntu.com/5862373
[2013-07-10 17:56:56 -0400] ponyofde1th: http://paste.ubuntu.com/5862377 is the error
[2013-07-10 17:57:18 -0400] ponyofde1th: http://paste.ubuntu.com/5862379
[2013-07-10 17:57:20 -0400] djustin: I have a windows domain controller where the node[:domain]<>node[:kernel][:cs_info][:domain]...is there any reason why this would happen?
[2013-07-10 17:57:22 -0400] ponyofde1th: sorry more details
[2013-07-10 17:58:30 -0400] kallistec: ponyofde1th: probably you're using a recipe from a cookbook that's not in the run list, nor in the dependencies of any cookbooks in your run list
[2013-07-10 17:59:25 -0400] kallistec: that *used to* work on Chef solo, but in Chef 11 chef-solo uses the dependencies to determine the correct order to load cookbooks
[2013-07-10 17:59:53 -0400] ponyofde1th: kallistec: so i am including the ntp recepie inside my base cookbook
[2013-07-10 18:00:23 -0400] kallistec: ponyofde1th: right, you need to put `depends "ntp"` in your base cookbook's metadata.rb file
[2013-07-10 18:00:30 -0400] ponyofde1th: ahh
[2013-07-10 18:00:38 -0400] ponyofde1th: got it thanks!
[2013-07-10 18:00:43 -0400] kallistec: http://docs.opscode.com/essentials_cookbook_metadata.html
[2013-07-10 18:00:55 -0400] gustavo: coderanger: I only found debian packages for chef 0.10.xx on wheezy, and its dependencies are broken. Those packages have dependencies conflicts with wheezy's packages.
[2013-07-10 18:01:34 -0400] coderanger: gustavo: For chef-client we have debian 6 packages for all versions, for chef-server you will either need to do the omnibus build yourself or try the ubuntu packages
[2013-07-10 18:01:58 -0400] gleam: the ubuntu packages work fine on wheezy
[2013-07-10 18:02:02 -0400] gleam: at least the 10.04 ones do
[2013-07-10 18:02:04 -0400] gleam: (server packages)
[2013-07-10 18:02:08 -0400] gleam: i dunno about 12.04
[2013-07-10 18:02:15 -0400] coderanger: Yeah, it "should work"
[2013-07-10 18:04:21 -0400] freezey: how could i do a search based off the example? http://pastebin.com/Uqgw07RZ   so if i wanted to do something like knife search example_databag "example_example1:* AND example2_example1:*"
[2013-07-10 18:04:43 -0400] freezey: on chef10 server i was able to search with example_example1:* but on 11 i cannot
[2013-07-10 18:04:44 -0400] gustavo: coderanger, gleam: Should work the ubuntu omnibus package on debian 7?
[2013-07-10 18:04:51 -0400] coderanger: gustavo: yes
[2013-07-10 18:05:08 -0400] gustavo: coderanger: Great, I will try !
[2013-07-10 18:05:12 -0400] coderanger: The only thing we depend on from the OS is libc, so as long as they don't break libc ABI, packages should work everywhere
[2013-07-10 18:05:53 -0400] gustavo: coderanger: excelent, thanks for your help !!
[2013-07-10 18:06:11 -0400] freezey: similar to this http://wiki.opscode.com/pages/viewpage.action?pageId=6357075 just doesnt work anymore on 11
[2013-07-10 18:06:35 -0400] rracterr: can anyone recommend a decent hostfile cookbook, I was using standard 'hostfile' cookbook but I've just realized that its implimented using straight file manipulation and as such does not keep any backups like all the native stuff does.
[2013-07-10 18:07:42 -0400] rracterr: just dont see it being that hard to have done that using a template... maybe I'll rewrite it myself.
[2013-07-10 18:08:31 -0400] coderanger: rracterr: Which cookbook do you mean?
[2013-07-10 18:08:42 -0400] coderanger: "standard" usually means from Opscode, but I don't think we have one for hostsfile
[2013-07-10 18:09:17 -0400] rracterr: coderanger: sudoers.chef-20130701093800
[2013-07-10 18:09:25 -0400] rracterr: bahh, ignore, bad paste
[2013-07-10 18:09:57 -0400] rracterr: coderanger: https://github.com/customink-webops/hostsfile/blob/master/libraries/manipulator.rb   that one... and that is the specific file/method of doing the changes thats causing me pain
[2013-07-10 18:11:41 -0400] rracterr: you guys should totally hire me, I'm already downtown, I'm already frustrated with every cookbook I've used, and I'm already tweaking them all to make them work in heterogeneous environments...
[2013-07-10 18:15:15 -0400] freezey: so on the search
[2013-07-10 18:15:22 -0400] freezey: key_key:value does not work
[2013-07-10 18:15:25 -0400] freezey: but key:value does
[2013-07-10 18:15:45 -0400] coderanger: rracterr: Yeah, seth likes sed'ing, I would just template '/etc/hosts' do ... end and be done with it, don't need a cookbook specifically
[2013-07-10 18:16:01 -0400] coderanger: rracterr: Also oblig: even better would be to grab the dnsmasq cookbook and use that
[2013-07-10 18:18:27 -0400] rracterr: while the 'seperation of concerns' argument dosnt really fit here... it feels like it should... pulling in a dnsmasq cookbook to just use the default recipe for hostsfile management will no doubt confuse some later chef admin who rightfully so will go 'wtf why is he caching that whole cookbook when he didnt even really want it'.
[2013-07-10 18:19:52 -0400] coderanger: No, I mean you shouldn't use a hosts file
[2013-07-10 18:20:11 -0400] coderanger: dnsmasq is a little DNS server that is easy to get going, install it in on place and setup your network to use it :)
[2013-07-10 18:21:49 -0400] theSurfer: I am having a memory leak issue with chef-client on CentOS hosts and by reading forums I decided to implement the fork option to the service but now I am having another issue that the chef-client recipe is spawning new process everytime it runs.
[2013-07-10 18:23:01 -0400] theSurfer: II think that the fork option is conflicting with the service recipe of the cookbook.
[2013-07-10 18:23:19 -0400] theSurfer: http://tickets.opscode.com/browse/CHEF-3367?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel
[2013-07-10 18:23:27 -0400] theSurfer: does anyone have a solution for that?
[2013-07-10 18:23:44 -0400] rracterr: coderanger: inappropriate for our purposes, but yea... if this was anything else dns of course.
[2013-07-10 18:23:53 -0400] chip-: theSurfer: Which version of the chef-client cookbook are you using? Ran into that with older versions of the init script
[2013-07-10 18:24:23 -0400] theSurfer: chef-client 3.0.5
[2013-07-10 18:25:11 -0400] chip-: theSurfer: What's probably happening to cause your slow-motion fork bomb is that when the forked chef-client runs exit, they're nuking the lockfile.
[2013-07-10 18:27:53 -0400] theSurfer: chip-> ok... anyway that we can prevent that? or should not add the service recipe?
[2013-07-10 18:28:14 -0400] theSurfer: chip-> I was thinking about moving from chef-client to cron jobs
[2013-07-10 18:28:27 -0400] chip-: Problem with cron is you create a thundering herd issue
[2013-07-10 18:29:34 -0400] chip-: http://tickets.opscode.com/browse/CHEF-3367
[2013-07-10 18:30:12 -0400] chip-: It's marked closed, weird that it's back.
[2013-07-10 18:31:28 -0400] theSurfer: yeah I saw that actually... weird
[2013-07-10 18:32:18 -0400] theSurfer: hum...
[2013-07-10 18:32:41 -0400] theSurfer: I think the host I had a problem is using version 11.0.0 of the chef client
[2013-07-10 18:34:11 -0400] theSurfer: but I am pretty sure that I saw it on 11.4 as well... Let me check and confirm that
[2013-07-10 18:34:31 -0400] theSurfer: thanks
[2013-07-10 18:34:53 -0400] freezey: looks like the issue is here
[2013-07-10 18:34:54 -0400] freezey: http://community.opscode.com/questions/396
[2013-07-10 18:38:11 -0400] hekman: jtimberman: do you know of anybody that is using application_python to run celery standalone? (no django in the mix)
[2013-07-10 18:40:47 -0400] theSurfer: chip-> yep that happens on 11.4 as well
[2013-07-10 18:41:57 -0400] theSurfer: the the process point to a PID file that does not exist
[2013-07-10 18:42:04 -0400] theSurfer: -P /var/run/chef/client.pid
[2013-07-10 18:46:16 -0400] shanlar: how can i see what environment a node belongs to from a recipe?
[2013-07-10 18:46:56 -0400] shanlar: nm got it
[2013-07-10 18:47:07 -0400] shanlar: node.chef_environment
[2013-07-10 18:51:40 -0400] Kzim: hello in HWRP how do i call the node attributes plz ?
[2013-07-10 18:53:36 -0400] chip-: theSurfer: Which 11.4 are you running?
[2013-07-10 19:03:37 -0400] btm: @opscode chef/ohai code review, join: https://plus.google.com/hangouts/_/a5185278a2540a7e46dd8fe14c775f23399e5fc6, watch: http://youtu.be/Za6tB55Dw1I
[2013-07-10 19:09:04 -0400] shanlar: can someone please explain why node.environment works but node['environment'] does not work?
[2013-07-10 19:09:51 -0400] HAPPYFUNBALL: hey what can I use to edit a file? specifically, I need to replace some text. does chef have anything built in that will allow me to do this?
[2013-07-10 19:11:28 -0400] chip-: HAPPYFUNBALL: In-place file editing isn't the greatest pattern, but if you need it: http://sysadvent.blogspot.com/2012/12/day-24-twelve-things-you-didnt-know.html
[2013-07-10 19:12:40 -0400] HAPPYFUNBALL: chip- how would I use this?
[2013-07-10 19:13:04 -0400] chip-: http://sysadvent.blogspot.com/2012/12/day-24-twelve-things-you-didnt-know.html#item_2
[2013-07-10 19:13:35 -0400] HAPPYFUNBALL: ok
[2013-07-10 19:14:46 -0400] konopka: during a first chef-client run, does the node run list, roles, etc get populated on the server after the end of the first successful convergence?
[2013-07-10 19:15:56 -0400] konopka: i'm spinning up a new node in vagrant using the chef-server provisioner
[2013-07-10 19:16:41 -0400] konopka: and not seeing roles, run list, recipes, etc populate on the server for the node until chef-client completes
[2013-07-10 19:16:48 -0400] konopka: is that expected behavior?
[2013-07-10 19:21:08 -0400] petecheslock: konopka - yea that is normal.  at the end of the run a node.save happens which sends the node data to the chef server IIRC
[2013-07-10 19:21:46 -0400] konopka: petecheslock: that's what the chef run document seemed to indicate
[2013-07-10 19:22:05 -0400] konopka: so then it's not a good idea to rely on a search query that you expect to include the node itself in a cookbook
[2013-07-10 19:24:40 -0400] anoldhacker: I'm trying to adapt code from the logrotate cookbook.  This includes a call to Chef::Application.fatal! inside a definition.  When the call is hit, however, I get "uninitialized constant Chef::Application" ???
[2013-07-10 19:28:02 -0400] petecheslock: konopka - yea that probably won't work as on bootstrap the node won't exist
[2013-07-10 19:28:09 -0400] petecheslock: on the 2nd run though it would work
[2013-07-10 19:28:17 -0400] konopka: petecheslock: yup that's exactly what i was running into
[2013-07-10 19:28:36 -0400] konopka: yes it does work on second run
[2013-07-10 19:33:52 -0400] shanlar: how can i set the default environment in the knife.rb file?
[2013-07-10 19:34:02 -0400] shanlar: is it knife[:environment] = 'dev' ?
[2013-07-10 19:45:00 -0400] aramus_: Hello, do subsequent resourcs in a recipe run before a resource finishes?
[2013-07-10 19:49:37 -0400] jordane: aramus_: http://docs.opscode.com/essentials_nodes_chef_run.html this doc explains how a chef run works pretty well
[2013-07-10 19:50:16 -0400] jordane: short answer: it goes over the cookbooks in order for a compilation-like phase, and then again to run.
[2013-07-10 19:50:46 -0400] aramus_: Compilation-like phase?
[2013-07-10 19:51:03 -0400] HAPPYFUNBALL: aramus_ is an imposter! he werks 4 puppet!
[2013-07-10 19:51:07 -0400] jordane: aramus_: it goes through and builds a list of all resources, identifies them, etc.
[2013-07-10 19:51:22 -0400] jordane: aramus_: it is possible to make it act on resources while it is doing this, thus knocking things a bit out of order
[2013-07-10 19:51:53 -0400] jordane: but normally it acts on resources after identifying the whole collection
[2013-07-10 19:52:12 -0400] aramus_: Oh okay, because I have a resource that won't successfully run until a service is finished rstarting. And from the looks of it, the resource seems to run while the service is restarting.
[2013-07-10 19:52:31 -0400] aramus_: Should I put a notifies in there to make sure they run subsequently?
[2013-07-10 19:52:47 -0400] jordane: yes, a notifies would be a good idea.
[2013-07-10 19:53:16 -0400] aramus_: Alright, thanks!
[2013-07-10 19:53:21 -0400] jordane: In that case, I'm not sure how it handles resource execution -- it may do it simultaneously. someone else would have to answer
[2013-07-10 19:53:32 -0400] jordane: but generally a notifies is a good idea if there is a relationship like that
[2013-07-10 19:55:19 -0400] AskSteve: is there documentation somewhere about node.XXX object data?  I'm trying to do a not_if a node is part of an environment.  i.e. is there a node.environment.include?("production") ?
[2013-07-10 19:58:56 -0400] jordane: AskSteve: i think you want the chef_environment attribute
[2013-07-10 19:59:37 -0400] AskSteve: so not_if { node.chef_environment.include?("production") } ?
[2013-07-10 20:00:03 -0400] jordane: AskSteve: the chef_environment is just a string, not a list
[2013-07-10 20:00:54 -0400] theSurfer: chip-> Chef: 11.4.0
[2013-07-10 20:01:08 -0400] AskSteve: is there a list of this type of data somewhere?
[2013-07-10 20:01:30 -0400] theSurfer: just caught multiple process running
[2013-07-10 20:02:36 -0400] jordane: AskSteve: I know http://docs.opscode.com/chef/ohai.html has some, but chef_environment isn't a normal attribute
[2013-07-10 20:02:49 -0400] jordane: there is some documentation about it here http://docs.opscode.com/essentials_environments.html
[2013-07-10 20:03:26 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/8a03108afb972680b9afb4697e14eb799def898bde, watch: http://youtu.be/8gWoHFJCQSY
[2013-07-10 20:22:04 -0400] theSurfer: does anyone knows what would be the best practice to upgrade chef-client on nodes?
[2013-07-10 20:22:48 -0400] theSurfer: is there any knife boostrap command to update the client on the nodes?
[2013-07-10 20:35:44 -0400] luckymike: theSurfer: knife ssh would allow you to run a gem update
[2013-07-10 20:36:45 -0400] luckymike: but managing it through the chef_client cookbook would be a better choice
[2013-07-10 20:40:16 -0400] basic`: anyone around that is very familiar with the postgres cookbook and managing pg_hba?
[2013-07-10 20:40:32 -0400] basic`: jordane: ? :)
[2013-07-10 20:44:06 -0400] jordane: basic`: nope :( sorry!
[2013-07-10 20:47:35 -0400] KarlHungus: basic`: whats the issue?
[2013-07-10 20:48:04 -0400] basic`: KarlHungus: i'm not familiar enough with ruby to know how to append things to the node['postgres']['pg_hba'] hash
[2013-07-10 20:48:25 -0400] basic`: so i want to have some other recipes define the hba.conf entries but not overriding each other
[2013-07-10 20:48:55 -0400] Urocyon: I'm getting an unexpected result searching for role:role_name.  It returns servers that do not have this role, but do have a recipe that searches for systems with this role.    a search for "roles:role_name" however turns up just the server with that role.
[2013-07-10 20:49:04 -0400] Urocyon: Not sure what I've done wrong here.
[2013-07-10 20:49:26 -0400] basic`: maybe it's .merge?
[2013-07-10 20:49:28 -0400] KarlHungus: basic`: this is my wrapper cookbook recipe for postgis https://gist.github.com/jssjr/3da008899d8a3ffc9e49
[2013-07-10 20:50:29 -0400] KarlHungus: basic`: that will hopefully clear up any issues you're facing ;)
[2013-07-10 20:50:48 -0400] basic`: KarlHungus: ahh, so you set hba_data to the node's hash, and then << the new items to that variable
[2013-07-10 20:50:51 -0400] basic`: makes sense
[2013-07-10 20:50:59 -0400] KarlHungus: the problem is that hda_data is an array, not a hash
[2013-07-10 20:51:05 -0400] KarlHungus: so merging using chef is problematic
[2013-07-10 20:51:12 -0400] basic`: i see
[2013-07-10 20:51:46 -0400] basic`: KarlHungus: thanks!
[2013-07-10 20:51:50 -0400] KarlHungus: cheers! yw
[2013-07-10 20:52:18 -0400] KarlHungus: Urocyon: if you find the issue and there isnt a bug filed with opscode, please file one =)
[2013-07-10 20:52:25 -0400] Urocyon: ooh I might have figured it out I put the role I was looking for under an attribute like node['mediaserver']['role'] = role_name   I bet it's picking that up.
[2013-07-10 20:52:37 -0400] KarlHungus: Urocyon: that exact issue had me scratching my head a few days ago while training a new chef user here at $dayjob
[2013-07-10 21:04:32 -0400] Urocyon: KarlHungus: changing that attribute to ['mediaserver']['rolename'] fixed the problem.
[2013-07-10 21:07:09 -0400] KarlHungus: Urocyon: fascinating. i need to reread the search methods source to giure out why thats occurring
[2013-07-10 21:07:13 -0400] KarlHungus: thats a bug imho
[2013-07-10 21:08:00 -0400] Urocyon: I'm still on 10. not sure if the same it true in 11.
[2013-07-10 21:08:19 -0400] Urocyon: s/it/is/
[2013-07-10 21:12:10 -0400] basic`: KarlHungus: that worked perfectly, thank you :)
[2013-07-10 21:17:26 -0400] asharp: is there a way to install a local .dmg file other than bash?
[2013-07-10 21:17:35 -0400] asharp: like using the package resource?
[2013-07-10 21:26:21 -0400] navid: What's the best practice around writing Chef recipes for QA servers, testing them and then applying those to Production once they are good? Do you recommend setting up two separate Chef Servers for this? I'm hoping there's a better solution since I'd rather not have to maintain two Chef servers.
[2013-07-10 21:27:01 -0400] iverson0881: navid: we use chef environments for this, where we bump or contrain cookbook versions and then move up the chain between dev, qa, staging, and production
[2013-07-10 21:28:41 -0400] navid: iverson0881: Thanks! I assume it has worked well for you? Any pitfalls/overhead?
[2013-07-10 21:29:43 -0400] iverson0881: navid: it seems to work well for us, we don't have very very complex requirements, ie, we don't have nested cookbook constraints yet, but it works for us.
[2013-07-10 21:30:07 -0400] iverson0881: navid: we also use knife spork to help and assist in bumping versions in chef environments
[2013-07-10 21:30:33 -0400] Yossie: hi.  have a weird situation with knife search not finding specific nodes.
[2013-07-10 21:30:37 -0400] Yossie: anyone able to help?
[2013-07-10 21:31:00 -0400] micgo: Yossie: what's your search syntax looking like?
[2013-07-10 21:31:01 -0400] iverson0881: navid: and of course foodcritic mixed in with jenkins to keep our sanity
[2013-07-10 21:33:00 -0400] ecarey: Yossie: Have you tried reindexing with knife?
[2013-07-10 21:34:32 -0400] ecarey: That is running: knife index rebuild
[2013-07-10 21:36:26 -0400] Yossie: how do I reindex with knife?
[2013-07-10 21:36:40 -0400] Yossie: ah, knife index rebuild, ok, I will give that a try, thanks!
[2013-07-10 21:37:20 -0400] ecarey: Yossie: No problem, sometimes there's a bit of a lag in indexing once you've created new nodes. That may be your problem.
[2013-07-10 21:37:49 -0400] Yossie: mmm, says it is destructive - can I trust it won't delete anything I need?
[2013-07-10 21:38:36 -0400] navid: iverson0881: thanks! I will try your recommendations!
[2013-07-10 21:38:39 -0400] Yossie: and it's not a lag, it's been a few days, a week even, since I added the role, and search can't seem to find it - but a rebuild seems like the right way to go.
[2013-07-10 21:39:38 -0400] ecarey: Yossie: The role or the node? And it's destructive in that it scraps the index and re-indexs for nodes.
[2013-07-10 21:39:53 -0400] Yossie: I did it.  I can't find anything now!  mmm.
[2013-07-10 21:40:25 -0400] Yossie: oh, wait, does it take time to rebuild after running?
[2013-07-10 21:40:51 -0400] ecarey: I haven't ran it in a while, as I've moved to using Vagrant mostly. I think so though.
[2013-07-10 21:41:46 -0400] Yossie: I hope it recovers, as it were, I note beam.smp is running and using cpu - didn't seem to be before.
[2013-07-10 21:45:48 -0400] ecarey: Does anyone know about any LoadErrors regarding highline in Chef 11.4 in execute blocks? Here's a gist with a better description and the stack trace: https://gist.github.com/ecarey-r7/5924598
[2013-07-10 21:47:33 -0400] ecarey: Yossie: Here's the page on Chef's indexer: http://wiki.opscode.com/display/chef/Chef+Indexer
[2013-07-10 21:50:52 -0400] ecarey: Oh, and I've checked that highline was in the /opt/chef/lib/ruby/gems/1.9.1 directory.
[2013-07-10 21:54:11 -0400] asharp: what's best practice for installing software not in a package manager?
[2013-07-10 21:54:47 -0400] ecarey: asharp: From source or from a tarball?
[2013-07-10 21:54:59 -0400] asharp: ecarey: from a .dmg
[2013-07-10 21:55:14 -0400] ecarey: There's a dmg provider.
[2013-07-10 21:55:14 -0400] asharp: right now i'm using remote_file to get the dmg, then some bash to install
[2013-07-10 21:55:41 -0400] asharp: ecarey: great thank you
[2013-07-10 21:55:49 -0400] ecarey: See http://docs.opscode.com/lwrp_dmg.html and http://community.opscode.com/cookbooks/dmg
[2013-07-10 21:55:58 -0400] ecarey: No problem.
[2013-07-10 22:13:30 -0400] inimit: any recommendations for managing mysql dbs and db users via chef?
[2013-07-10 22:14:38 -0400] inimit: just found https://github.com/opscode-cookbooks/database
[2013-07-10 22:20:08 -0400] Yossie: Help?!  After I did knife index rebuild - I can't seem to search for anythign at all!
[2013-07-10 22:20:10 -0400] Yossie: is that normal?
[2013-07-10 22:21:02 -0400] hakunin_: I really don't get what's happening It's like chef is out to get me.
[2013-07-10 22:21:16 -0400] Yossie: hakunim - I feel that way often.
[2013-07-10 22:21:38 -0400] hakunin: Yossie: did you reconfigure iptables?
[2013-07-10 22:21:48 -0400] Yossie: why?
[2013-07-10 22:21:50 -0400] hakunin: oh nevermind
[2013-07-10 22:21:54 -0400] hakunin: Yossie: misread
[2013-07-10 22:21:57 -0400] Yossie: hehe.
[2013-07-10 22:23:23 -0400] hakunin: so in my case, chef clients start off just fine, but after a few hours of no problems they eventually fail to reach the chef server, and never try to communicate with it again
[2013-07-10 22:23:38 -0400] hakunin: here's a pastie of some errors in client logs: http://pastie.org/private/wanqoup0ybjfo9lvz72w
[2013-07-10 22:23:39 -0400] Yossie: hakunim - never seen that.
[2013-07-10 22:23:48 -0400] hakunin: Yossie: :) it's hakuniN
[2013-07-10 22:24:01 -0400] hakunin: pastie because gist is down
[2013-07-10 22:24:15 -0400] Yossie: I think my fingers like to type what they like to type, hakuniN
[2013-07-10 22:24:26 -0400] Yossie: anyway, looking at the log - I'd say iptables or some other firewall rule.
[2013-07-10 22:24:50 -0400] d```_: is there a way to assign a role to a different node in a recipe?
[2013-07-10 22:24:52 -0400] Yossie: actually, connection timed out - mmm.  not necessary firewall issue.
[2013-07-10 22:25:13 -0400] hakunin: Yossie: most of the failures are like node1 and node2, but there's an occasional node3-like failure
[2013-07-10 22:25:33 -0400] Yossie: memory issues on the server?
[2013-07-10 22:25:40 -0400] hakunin: Yossie: i created swap
[2013-07-10 22:25:46 -0400] hakunin: Yossie: so shouldn't be any more
[2013-07-10 22:25:52 -0400] Yossie: agreed..
[2013-07-10 22:26:05 -0400] Yossie: does the server log show the connection attempts?
[2013-07-10 22:26:28 -0400] Yossie: when you get a failure, try to use openssl client_s to connect to the server from the client directly and see if you can spot an issue.
[2013-07-10 22:26:34 -0400] Yossie: I mean s_client of course.
[2013-07-10 22:27:03 -0400] asharp: can i define attributes within my cookbook (in the attributes folder) with json?
[2013-07-10 22:27:35 -0400] hakunin: Yossie: hm, could you give the specific command? i'll try right now, just not familiar with openssl stuff
[2013-07-10 22:27:59 -0400] Yossie:  man s_client
[2013-07-10 22:28:25 -0400] Yossie: basically: openssl s_client -connect chef.[doma
[2013-07-10 22:28:38 -0400] Yossie: I mean openssl s_client -connect chef.[domain]:443
[2013-07-10 22:28:52 -0400] maplebed: asharp: sfaik, you have to use ruby in the atributes dir, not json.
[2013-07-10 22:29:13 -0400] asharp: maplebed: yeah i think you're right
[2013-07-10 22:29:59 -0400] hakunin: Yossie: i tried it in a bunch of places, it spit out some cryptic stuff for me, but nothing looks broken
[2013-07-10 22:30:01 -0400] surge_: What is a good way to restart multiple services w/ a notify/subscribe? I don't want to be copy pasta the services every time I add a Sensu check
[2013-07-10 22:30:30 -0400] hakunin: asharp: you could use json if you write ruby code to read the json file
[2013-07-10 22:30:44 -0400] hakunin: asharp: but not sure why you'd want that
[2013-07-10 22:31:38 -0400] asharp: hakunin: json requires less typing, that's all
[2013-07-10 22:32:09 -0400] Yossie: hakunin: not sure what to say.  if you can connect to the server reliably even after the chef-client starts to have problems doing the same thing, that is a weird one.
[2013-07-10 22:32:51 -0400] hakunin: Yossie: the thing is - it's intermittent. But afaik chef client has a bug. If it times out - it never retries.
[2013-07-10 22:33:08 -0400] hakunin: Yossie: my problem is - why it ever times out
[2013-07-10 22:33:15 -0400] hakunin: Yossie: i probably can't catch it
[2013-07-10 22:33:58 -0400] kimba: is there a channel for privite chef install issues.
[2013-07-10 22:35:54 -0400] hakunin: surge_: i have many config files, each requiring a restart of a server. But server service might not be present in my runlist, so I didn't want configs to notify it, instead I wanted server to subscribe. And I had 2 different services actually that needed to subscribe to configs.
[2013-07-10 22:35:56 -0400] Yossie: hakunin it may time out due to chef-server being too busy.
[2013-07-10 22:35:58 -0400] hakunin: damn
[2013-07-10 22:36:05 -0400] hakunin: he just left
[2013-07-10 22:36:54 -0400] hakunin: Yossie: i have 5 nodes with half hour intervals
[2013-07-10 22:37:25 -0400] Yossie: ah, yes, shouldn't ever run out of cpu in that setup.
[2013-07-10 22:38:21 -0400] castro1688: is it just me or is the hosted chef api been crap the last two days???
[2013-07-10 22:38:26 -0400] hakunin: Yossie: https://www.evernote.com/shard/s9/sh/5cd2eac2-c61f-4c31-ab1d-9d3b58ba18d7/10d8f1afa00263f8067597bf4a835a01/deep/0/Screenshot%207/10/13%205:38%20PM.png
[2013-07-10 22:38:47 -0400] iverson0881: yeah i think chef hosted is down right now?
[2013-07-10 22:39:13 -0400] castro1688: crap. i know they had issues yesterday..
[2013-07-10 22:39:15 -0400] Yossie: I get the idea..
[2013-07-10 22:39:17 -0400] Yossie: :(
[2013-07-10 22:39:41 -0400] Yossie: got my own grief here, just did knife index rebuild and now I ca't find anything - index can't possibly be big enough to take a while to rebuild, but there u go.
[2013-07-10 22:41:42 -0400] hakunin: Yossie: :( sorry to hear, i'm too new to server to help. I had a problem where adding new nodes required converging all existing nodes. Somebody suggested I setup chef server. Now I have at least 3 problems.
[2013-07-10 22:43:09 -0400] justizin: hey guys, i'm getting lots of errors from api.opscode.com - is there a known problem?
[2013-07-10 22:43:28 -0400] inimit: justizin: experiencing the same..
[2013-07-10 22:44:06 -0400] justizin: perhaps the opscode irc nicks in here are busy trying to fix it..
[2013-07-10 22:44:12 -0400] hakunin: I find it a little ironic because when I complained about my own chef server setup issues, I was pitched to use hosted chef. :)
[2013-07-10 22:44:20 -0400] justizin: of course, of course. ;)
[2013-07-10 22:44:54 -0400] hakunin: right now neither work
[2013-07-10 22:44:55 -0400] justizin: i've found it mostly a pleasant departure from running my own, though also the decision has a lot to do with using pure cloud resources vs. bare-metal, where there's always decom-ed boxes for infrastructure tasks lying around..
[2013-07-10 22:45:27 -0400] justizin: it's kind of working for me, but i'll back off for a few and see if they're just working something out
[2013-07-10 22:45:37 -0400] Yossie: depending on what you are trying to do, puppet is a really sweet way to do what chef does only eaiser.
[2013-07-10 22:45:38 -0400] justizin: like i see an error or two, then it goes to the next step, rinse, repeat..
[2013-07-10 22:45:59 -0400] ignatz: lotta timeouts.
[2013-07-10 22:46:17 -0400] justizin: Yossie: i'll admit i've had some positive experiences with puppet, but pretty much anything puppet can do, chef-solo can do fine as well..
[2013-07-10 22:46:31 -0400] justizin: and boy howdy is there nothing approaching the richness of the community cookbooks in puppetland..
[2013-07-10 22:46:31 -0400] hakunin: Yossie: i'm a rubyist, and i've gotten this far by (unfortunately for non-rubyists) reading source of chef, cookbooks, and everything else involved
[2013-07-10 22:46:47 -0400] Yossie: puppet is also ruby :)  (thought not as much as chef)
[2013-07-10 22:47:00 -0400] hakunin: Yossie: i know, but there you have to deal with layer of indirection
[2013-07-10 22:47:28 -0400] Yossie: all I can say is that I had a much simpler time with puppet.  that said, there are things you can't do in it for a fact.  wikimedia (where I worked a few months ago) uses puppet.
[2013-07-10 22:47:34 -0400] justizin: i do find that working with puppet has made me better at working with chef..
[2013-07-10 22:47:38 -0400] Yossie: now I don't have a choice - our engineers decided to use chef, so chef it is.
[2013-07-10 22:47:43 -0400] justizin: BTW, i'm getting 500s, not timeouts
[2013-07-10 22:48:08 -0400] Yossie: does anyone on here know how long I can expect a knife index rebuild to take (in the background) and can I monitor the progress somehow?
[2013-07-10 22:48:18 -0400] kimba: question:  chef-server.rb  should be found at /etc/chef-server/chef-server.rb on your chef server... but it's not there. how is it created?
[2013-07-10 22:48:24 -0400] asharp: if i assign a variable to a node attribute, and that attribute has its own attributes, how do i access those attributes from the variable (syntax question)
[2013-07-10 22:48:34 -0400] hakunin: "working with puppet has made me better at working with chef" <-- this is actually a great point. I never worked with puppet but it took me a while to understand what it means to declare resources, rather than "script my server". Very different things.
[2013-07-10 22:48:35 -0400] justizin: Yossie: i've rarely heard wikimedia held up as an example of modern and effective ops.  is it still all-hands for any level of service interruption?
[2013-07-10 22:49:15 -0400] Yossie: hehe, I would have found that out had I worked in their opreations - I didn't.  but I did get to watch it in action.  they are a LARGE site and seem to manage with few operations folks so I can only assume they are doing something right.
[2013-07-10 22:49:16 -0400] justizin: anyway give chef a chance.  take your declarative mindset from puppet and apply it to chef.
[2013-07-10 22:49:46 -0400] Yossie: justizin - that is exactly what I do when I write chef recipes - I think puppet and write chef - that way I get nice and readable recipes..
[2013-07-10 22:54:19 -0400] asharp: anyone? i promise i've been doing private research on this, i cant find any answers
[2013-07-10 22:57:11 -0400] DerpOps: I'm migrating servers from ec2 to vpc. But the node attributes for 'ec2' aren't showing up on servers after I bring them up in vpc. Is there anyway to get back this information?
[2013-07-10 22:58:12 -0400] hakunin: asharp: what do you mean by "that attribute has its own attributes"?
[2013-07-10 22:59:00 -0400] hakunin: asharp: if you mean something like you had node['foo']['bar'] and you assigned node['foo'] = 'something' - you just overwrote ['bar'], and it's no longer there
[2013-07-10 22:59:03 -0400] DerpOps: on my chef server, nodes in ec2 have an auto populated feild called 'ec2'
[2013-07-10 22:59:42 -0400] DerpOps: but when I launch them in vpc that feild is gone and the info in it isn't replaced
[2013-07-10 23:00:07 -0400] hakunin: DerpOps: perhaps some condition fails in a different context?
[2013-07-10 23:00:10 -0400] DerpOps: it would have the instance id, the ami, the internal host name
[2013-07-10 23:00:40 -0400] DerpOps: only thing I know is that in debug ohai checks for ec2 macs addresses and it fails this check
[2013-07-10 23:01:17 -0400] hakunin: DerpOps: i'd look into source code of those checks and run whatever they run by hand
[2013-07-10 23:02:25 -0400] asharp: hakunin: nvm i hacked my way through it. it's like attributes node['a']['b'] node['a']['c']. if i set d = node['a'], then d['b'] is nil
[2013-07-10 23:02:47 -0400] asharp: hakunin: but if d,e = node['a'], then e['b'] is something
[2013-07-10 23:03:24 -0400] hakunin: asharp: depends if you're dealing with arrays or hashes
[2013-07-10 23:03:37 -0400] asharp: hakunin: idk. it's just chef attributes
[2013-07-10 23:03:43 -0400] hakunin: asharp: it's all just ruby :)
[2013-07-10 23:04:11 -0400] asharp: ^ not a ruby expert :(
[2013-07-10 23:12:07 -0400] hakunin: Folks, how does one deal with heavy files in cookbook? My cookbook has 12mb worth of font files, and I'm thinking that could contribute to timeouts. What would you do with those files?
[2013-07-10 23:12:53 -0400] hakunin: Or does client rsync from server? Then it shouldn't be an issue
[2013-07-10 23:20:13 -0400] chip-: theSurfer: Sorry, was ark for a while. Try 11.4.4, I think the fix was released there.
[2013-07-10 23:23:59 -0400] DerpOps: hakunin: ohai see every ec2 server as having a mac address as "fe:ff:ff:ff:ff:ff" even though that's not what ifconfig gives you. In vpc it sees the same mac as ifconfig. Failing that test ohai does not auto-populate the node attributes with ec2 information.
[2013-07-10 23:24:20 -0400] DerpOps: in case anyone cares
[2013-07-10 23:24:33 -0400] hakunin: DerpOps: glad you figured it out
[2013-07-10 23:25:10 -0400] DerpOps: was hoping for magic and a 'oh yeah do this and everything will be cool' but at least i can monkey patch my own fix
[2013-07-10 23:27:54 -0400] hakunin: DerpOps: i see that it does hint?('ec2') before checking mac
[2013-07-10 23:28:02 -0400] hakunin: DerpOps: maybe read up on ohai hinting system?
[2013-07-10 23:28:31 -0400] hakunin: DerpOps: "if you create a file named rackspace.json, euclyptus.json or ec2.json in this directory, then Ohai will assume it is in one of those environments" from here http://www.opscode.com/blog/2012/05/30/ohai-6-14-0-released/
[2013-07-10 23:28:51 -0400] DerpOps: now that's interesting, thanks
[2013-07-10 23:31:42 -0400] kimba: question:  chef-server.rb  should be found at /etc/chef-server/chef-server.rb on your chef server... but it's not there. how is it created?
[2013-07-10 23:32:13 -0400] slillibridge: The value req_time in the erchef logs. Is that value in seconds?
[2013-07-10 23:32:55 -0400] DerpOps: hakunin: that's that magic I was looking for. Thanks again!
[2013-07-10 23:33:02 -0400] DerpOps: worked like a charm
[2013-07-10 23:33:26 -0400] hakunin: kimba: you create it yourself
[2013-07-10 23:33:38 -0400] hakunin: kimba: if you need to override any settings
[2013-07-10 23:33:45 -0400] hakunin: DerpOps: glad it worked!
[2013-07-10 23:34:12 -0400] drywheat: is there a way to pass attributes to the #include_recipe inside a recipe?
[2013-07-10 23:34:43 -0400] hakunin: drywheat: attributes are global among all cookbooks in runlist
[2013-07-10 23:35:20 -0400] cwj: node.override[:foo][:bar] = 'baz' before you include_recipe "foo"
[2013-07-10 23:35:24 -0400] hakunin: drywheat: if you set attributes before including recipe - they will be set in the recipe
[2013-07-10 23:37:05 -0400] kimba: so what would be the port that I would find the webui at?
[2013-07-10 23:38:12 -0400] hakunin: kimba: default is https (443)
[2013-07-10 23:38:56 -0400] paige|laptop: cg
[2013-07-10 23:39:03 -0400] drywheat: hakunin: that makes sense, thanks
[2013-07-10 23:40:49 -0400] paige|laptop: how are things going with old chef server these days
[2013-07-10 23:41:07 -0400] paige|laptop: hopefully happy
[2013-07-10 23:55:44 -0400] hakunin: this is part of my problem: http://tickets.opscode.com/browse/CHEF-4010
[2013-07-10 23:55:56 -0400] hakunin: but it's fixed in client 11.6.0
[2013-07-10 23:56:01 -0400] hakunin: when is that gonna be released?
[2013-07-10 23:56:11 -0400] hakunin: WHEEEEEEEN
