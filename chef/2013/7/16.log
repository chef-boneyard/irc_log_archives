[2013-07-16 17:19:22 -0400] bcave: fog wrapper to upload / download to S3 from knife
[2013-07-16 17:19:35 -0400] bcave: (aws S3 - simple storage service)
[2013-07-16 17:20:44 -0400] bcave: we were using knife-cfn for cloudformation, and some of our stacks reference other templates, which needed to be uploaded to S3 to be referenced
[2013-07-16 17:22:46 -0400] basic`: coderanger: well, fwiw a gem_package fixes it
[2013-07-16 17:23:22 -0400] coderanger: basic`: gem_package 'mysql2'?
[2013-07-16 17:23:31 -0400] basic`: ya, well, 'mysql'
[2013-07-16 17:23:38 -0400] coderanger: works for me :)
[2013-07-16 17:23:39 -0400] basic`: version '~> 2.8.1'
[2013-07-16 17:23:48 -0400] rava: chef-solr was down
[2013-07-16 17:39:18 -0400] cjerdonek: does chef do any auto conversion between symbol and string hash keys when dealing with nodes and data bags, etc? i haven't found any documentation about it
[2013-07-16 17:39:36 -0400] coderanger: cjerdonek: node, yes, bag no
[2013-07-16 17:39:45 -0400] coderanger: node attributes are a subclass of Mash
[2013-07-16 17:39:54 -0400] coderanger: So node[:x] == node['x'] == node.x
[2013-07-16 17:40:01 -0400] coderanger: but really really don't use that last one
[2013-07-16 17:40:19 -0400] cjerdonek: coderanger: thx. are there any best practices to recommend?
[2013-07-16 17:40:34 -0400] cjerdonek: (e.g. prefer symbols to strings or vice versa)
[2013-07-16 17:40:41 -0400] coderanger: cjerdonek: The recommendation is to use node['x'] by default
[2013-07-16 17:40:49 -0400] cjerdonek: k, great. thx
[2013-07-16 17:40:53 -0400] coderanger: because it is the most obvious to a large number of programmers
[2013-07-16 17:41:09 -0400] coderanger: but node[:x] is fine if you know your dev team understands what a Ruby symbol is, etc
[2013-07-16 17:41:40 -0400] cjerdonek: last question: do you know if that recommendation/behavior is documented anywhere?
[2013-07-16 17:41:54 -0400] coderanger: foodcritic is probably the best version of our style guide
[2013-07-16 17:42:01 -0400] coderanger: and, conveniently, it enforces it too
[2013-07-16 17:42:10 -0400] coderanger: http://acrmp.github.io/foodcritic/
[2013-07-16 17:42:13 -0400] cjerdonek: awesome, thx
[2013-07-16 17:42:23 -0400] coderanger: You may not agree with every check, feel free to disable ones you don't like
[2013-07-16 17:42:28 -0400] coderanger: but its a great starting place
[2013-07-16 17:43:06 -0400] jagua: does anyone have a recommendation for configuring interdependent nodes?
[2013-07-16 17:43:14 -0400] jagua: best practices or a link?
[2013-07-16 17:43:41 -0400] coderanger: jagua: Depends on the software details
[2013-07-16 17:43:54 -0400] jagua: i'm setting up a database node with mysql, redis ,etc
[2013-07-16 17:43:58 -0400] coderanger: The best way, if its an option, is setup either side independently and just let them find each other
[2013-07-16 17:44:09 -0400] coderanger: this only works if both sides can cope with the other being down
[2013-07-16 17:44:14 -0400] jagua: and my rails app needs to know about it
[2013-07-16 17:44:55 -0400] coderanger: Then yeah, just use a chef search() in your app recipe to grab the IP of the mysql and redis servers, and write those into configs
[2013-07-16 17:45:18 -0400] coderanger: Depending on how complex your app is, you may be able to use the application_ruby cookbook to do a lot of that for you
[2013-07-16 17:45:32 -0400] jagua: coderange: thanks :)
[2013-07-16 17:46:27 -0400] jagua: the problem is mainly what happens once I start adding more nodes/servers
[2013-07-16 17:46:56 -0400] coderanger: Not sure what you mean, they are all independent for the most part
[2013-07-16 17:47:44 -0400] jagua: well, mainly I just need to know IPs and database access configs on the app servers
[2013-07-16 17:48:35 -0400] jagua: but I'll definately go with your recommendations for search and the application_ruby cookbooks
[2013-07-16 17:48:39 -0400] coderanger: Right, search covers that
[2013-07-16 17:48:57 -0400] coderanger: the chef-server exposes APIs to query your infrastructure :)
[2013-07-16 17:49:25 -0400] jagua: thanks again this was awesome - first time coming to chef chat and I got help right off the bat ! loving chef :)
[2013-07-16 17:50:19 -0400] coderanger: app_ruby is a lot more than that, its a full attempt at a "standard Rails deployment" as a library more or less
[2013-07-16 17:50:28 -0400] coderanger: YMMV, but its worth looking at at least
[2013-07-16 17:52:20 -0400] jagua: ok time to get back to rerunning those chef clients
[2013-07-16 17:52:35 -0400] jagua: coderanger: thanks :)
[2013-07-16 18:12:03 -0400] seren: Is there a preferred way of checking if chef is running in ec2? I've seen at least 4 different methods:  node.attribute?('ec2'), node[:ec2].nil?, node['ec2'].nil?, node.has_key?('ec2')
[2013-07-16 18:12:25 -0400] gchristensen: seren: all those thinsg do the same thing
[2013-07-16 18:12:34 -0400] coderanger: yeah, all functionally identical
[2013-07-16 18:12:54 -0400] coderanger: Even just "if node['ec2']" is isomorphic too
[2013-07-16 18:14:32 -0400] Majost: Does anyone know how to replicate a search request done in a cookbook via a curl?
[2013-07-16 18:14:43 -0400] seren: great. thanks!
[2013-07-16 18:14:44 -0400] coderanger: Majost: It would be quite hard
[2013-07-16 18:15:10 -0400] coderanger: Majost: I think the wiki has some example of Chef API request signing in bash, but its long an unpleasant
[2013-07-16 18:15:22 -0400] Majost: damn
[2013-07-16 18:15:33 -0400] coderanger: Majost: The API request itself is just GET /search/<type>?q=<query>
[2013-07-16 18:15:40 -0400] gchristensen: its the signing
[2013-07-16 18:15:41 -0400] coderanger: Or POST if you are using partial search
[2013-07-16 18:15:42 -0400] Majost: yeah, I am trying to debug a data bag search which seems like its not returning anything
[2013-07-16 18:15:49 -0400] gchristensen: Majost: use 'knife'?
[2013-07-16 18:15:55 -0400] coderanger: Majost: You can use knife search or knife exec
[2013-07-16 18:16:02 -0400] coderanger: or I usually use pychef + ipython :)
[2013-07-16 18:16:16 -0400] Majost: I thought knife search only works with nodes though?
[2013-07-16 18:16:25 -0400] coderanger: No, search is all the same
[2013-07-16 18:16:35 -0400] coderanger: knife search just defaults to nodes if no type is given
[2013-07-16 18:16:39 -0400] coderanger: since its by far the most common
[2013-07-16 18:17:12 -0400] coderanger: "knife search INDEX QUERY (options)"
[2013-07-16 18:24:53 -0400] Majost: huh
[2013-07-16 18:25:18 -0400] Majost: so is there any reason why a chef server would fail to return results if there are for sure matches?
[2013-07-16 18:25:25 -0400] d```: In the chef docs for the service resource it gives a warning against controlling a service with execute statements, is there some other way to issue custom commands to services in chef through the service resource?
[2013-07-16 18:26:00 -0400] Majost: eg: I can do 'knife search users 'groups:sysadmin'" on my old chef 10.x server, and it returns
[2013-07-16 18:26:02 -0400] d```: for example, I'd like to reload freeswitch modules when their config has been updated
[2013-07-16 18:26:14 -0400] Majost: but on my 11 server the result is empty
[2013-07-16 18:27:03 -0400] Majost: d```:  use 'notifies'
[2013-07-16 18:28:06 -0400] Majost: d```:  http://docs.opscode.com/resource_common.html#notifications
[2013-07-16 18:28:47 -0400] d```: Majost: I understand notifies, but I'd have to call an exec block instead of a service block, I don't want to run /etc/init.d/freeswitch reload, I'm looking to run something like fs_cli -rx 'reload mod_XXX'
[2013-07-16 18:28:54 -0400] Majost: so the template or file section you have, add it to that and any time it changes it will send a restart notice to the service
[2013-07-16 18:29:11 -0400] Majost: ah
[2013-07-16 18:29:41 -0400] d```: additionally, I have applications that are controlled by supervisord instead of init
[2013-07-16 18:29:52 -0400] d```: which is not handled by service, as far as I can tell
[2013-07-16 18:29:55 -0400] Majost: You may want to check the init script -- it might do that, but if it doesn't then you may have to call a block like that
[2013-07-16 18:30:02 -0400] Majost: its not recommended because its not portable
[2013-07-16 18:30:14 -0400] d```: Majost: it has a reload, but it just reloads the dialplan xml
[2013-07-16 18:30:24 -0400] d```: not any module config
[2013-07-16 18:30:25 -0400] Majost: and some shell commands may not return proper exit status
[2013-07-16 18:30:30 -0400] Majost: ah
[2013-07-16 18:30:48 -0400] d```: I'm just looking to avoid writing my own LWRP
[2013-07-16 18:30:55 -0400] d```: but it looks like that's not happening
[2013-07-16 18:31:43 -0400] overclocked: not to interrupt, but has anyone setup the open source chef server on an EC2 instance? I am having a hell of a time getting knife configured on the server itself...
[2013-07-16 18:34:17 -0400] HAPPYFUNBALL: why can't I set ulimit with chef?
[2013-07-16 18:50:54 -0400] ianco: any chance anyone can asplain why this lwrp is behaving this way ?
[2013-07-16 18:50:58 -0400] ianco: https://gist.github.com/iancoffey/fe92d547b4b54b4103c8
[2013-07-16 18:56:33 -0400] jhayden: Interesting problem:
[2013-07-16 18:56:59 -0400] jhayden: I had to rebuild a chef-server (10.26) and re-attach a couch db
[2013-07-16 18:57:19 -0400] iverson0881: HAPPYFUNBALL: of course you can if you do within the context of limits.conf
[2013-07-16 18:57:22 -0400] jhayden: seems to work somewhat but when I look at cookbooks via webui
[2013-07-16 18:57:46 -0400] jhayden: I see the list but when I click on individual cookbooks I see no files
[2013-07-16 18:58:16 -0400] jhayden: I have deleted and reinstalled a single cookbook to see if it was corrupted but I get the same behavior
[2013-07-16 18:58:22 -0400] jhayden: Any ideas?
[2013-07-16 19:08:10 -0400] coderanger: ianco: Okay, so this is hard to explain
[2013-07-16 19:08:23 -0400] coderanger: new_resource isn't a variable, its a method call, right?
[2013-07-16 19:08:45 -0400] coderanger: So within the do end block there, it is executing against the context of the nginx_site resource object
[2013-07-16 19:08:50 -0400] coderanger: which is why #enable works
[2013-07-16 19:09:10 -0400] ianco: ahhmm
[2013-07-16 19:10:48 -0400] coderanger: So thats the value of new_resource within the nginx_site resource
[2013-07-16 19:11:01 -0400] coderanger: Another fix is outside of that resource, do "r = new_resource"
[2013-07-16 19:11:14 -0400] coderanger: at which point its now a variable, so lexical scoping takes over
[2013-07-16 19:12:13 -0400] ianco: cool, gotcha
[2013-07-16 19:12:32 -0400] coderanger: Welcome to the guts of Ruby's method access and scoping rules :-)
[2013-07-16 19:12:37 -0400] miah: i just put @new_resource = new_resource in my initialize :P
[2013-07-16 19:12:41 -0400] miah: instance variables ftw
[2013-07-16 19:12:43 -0400] ianco: heh, thanks, excited to be here
[2013-07-16 19:12:50 -0400] coderanger: miah: Thats already done for you actually
[2013-07-16 19:13:02 -0400] miah: sometimes being explicit is good
[2013-07-16 19:13:18 -0400] miah: (and i dont lwrp)
[2013-07-16 19:13:23 -0400] coderanger: Yeah, the issue is that lexical scoping + instance vars can still have some odd surprises
[2013-07-16 19:13:28 -0400] miah: true
[2013-07-16 19:13:42 -0400] coderanger: Much less likely, but only local vars have true lexical scope
[2013-07-16 19:14:00 -0400] coderanger: (and actually thats not technically true, but just avoid weird things with #const_set
[2013-07-16 19:14:05 -0400] Otterley: I'm having a WTF moment
[2013-07-16 19:14:07 -0400] Otterley: https://gist.github.com/mfischer-zd/9b7f45d52859cafd957f/raw/f297cd5bf692bba2cf4b7354d0afbface37c4106/gistfile1.txt
[2013-07-16 19:14:19 -0400] ianco: coderanger, thanks again :)
[2013-07-16 19:14:36 -0400] Otterley: why is Chef complaining that it can't notify my service resource because it can't be found, even though the resource with the exact same name was enabled 2 steps earlier?
[2013-07-16 19:14:44 -0400] coderanger: Otterley: pastebin the recipe code?
[2013-07-16 19:14:54 -0400] Otterley: I just did
[2013-07-16 19:15:02 -0400] Otterley: oh, the code
[2013-07-16 19:15:07 -0400] coderanger: Thats the log output
[2013-07-16 19:15:17 -0400] Otterley: I'll PM you, trying to remove any identifying info is tricky
[2013-07-16 19:15:39 -0400] coderanger: Basically are you using #use_inline_resources anywhere
[2013-07-16 19:15:44 -0400] Otterley: I am
[2013-07-16 19:15:49 -0400] coderanger: Then that would do it :-)
[2013-07-16 19:15:59 -0400] Otterley: oh, I thought that was best practice with Chef 11
[2013-07-16 19:16:00 -0400] coderanger: It creates a captive execution context
[2013-07-16 19:16:07 -0400] coderanger: you can't notify in to or out of that context
[2013-07-16 19:16:19 -0400] coderanger: Ehh, I advocate for a slight modification to it
[2013-07-16 19:16:22 -0400] coderanger: let me fish out the gist
[2013-07-16 19:16:45 -0400] coderanger: https://gist.github.com/coderanger/4506662
[2013-07-16 19:17:03 -0400] coderanger: That is similar (predates use_inline) but allows notifications to exit the LWRP
[2013-07-16 19:17:12 -0400] coderanger: basically nested contexts
[2013-07-16 19:17:21 -0400] Otterley: if it makes no real difference, I can eliminate use_inline_resources
[2013-07-16 19:17:28 -0400] Otterley: I honestly have no idea what it does
[2013-07-16 19:17:45 -0400] miah: it creates a resource collection that is tied to the resource you're creating
[2013-07-16 19:17:54 -0400] miah: so that sub resources have a place to go and aren't lost to the netherworld
[2013-07-16 19:17:57 -0400] coderanger: So both of these snippets exist so that you can have the update trigger status of an LWRP be the AND of all the resources within it
[2013-07-16 19:18:16 -0400] coderanger: If you aren't using notifications on the LWR instances, its moot
[2013-07-16 19:18:38 -0400] Otterley: so is this a bug in use_inline_resources?
[2013-07-16 19:18:46 -0400] miah: or if you dont need to notify any of the sub-resources created inside the lwrp its moot.
[2013-07-16 19:18:46 -0400] coderanger: Not a bug per se
[2013-07-16 19:18:50 -0400] coderanger: Its a restriction
[2013-07-16 19:19:21 -0400] miah: basically, anything outside of your resource provider should notify your resource directly, instead of a sub-resource
[2013-07-16 19:19:22 -0400] Otterley: is there going to be a different problem if I remove use_inline_resources?
[2013-07-16 19:19:27 -0400] coderanger: I think it should be removed, but kallistec and I still need to duke that one out :D we included use_inline kind of as an experiment
[2013-07-16 19:19:36 -0400] miah: your resource should lookup and notify the correct sub-resource
[2013-07-16 19:19:41 -0400] coderanger: Otterley: If you use my_resource ... notifies, then yes
[2013-07-16 19:19:49 -0400] coderanger: miah: Thats not the issue
[2013-07-16 19:20:09 -0400] coderanger: He is trying to have something inside the LWRP notify something outside of it
[2013-07-16 19:20:14 -0400] miah: ah ya
[2013-07-16 19:20:29 -0400] miah: i think the whole notify system is fubar honestly
[2013-07-16 19:20:51 -0400] Otterley: well, there is a template (the sub-resource?) inside the syslog_ng_config resource that notifies the service
[2013-07-16 19:20:59 -0400] coderanger: delta triggers in an idempotent system are indeed frustrating
[2013-07-16 19:21:09 -0400] miah: template is a resoure, and if its defined inside another resource its a sub-resource
[2013-07-16 19:21:22 -0400] coderanger: Otterley: Yes, but does the syslog_ng_config resource itself have any notifications on it?
[2013-07-16 19:21:25 -0400] Otterley: ok, cool, we have our vocabulary straight :)
[2013-07-16 19:21:30 -0400] matti: zaargy: I feel pity for anyone who is going to work with Dave Campbell.
[2013-07-16 19:21:50 -0400] Otterley: coderanger, hmm, lessee.
[2013-07-16 19:22:43 -0400] coderanger: Otterley: If not, you can remove use_inline
[2013-07-16 19:22:45 -0400] Otterley: coderanger, it does not
[2013-07-16 19:22:54 -0400] coderanger: Then it will work basically as you expect
[2013-07-16 19:22:58 -0400] Otterley: ok, thanks
[2013-07-16 19:23:01 -0400] cannonball: I'm not sure if I have a chef configuration problem or a vagrant configuration problem.  I have vagrant set to add a single simple role (effectively adds vim and git).  When I do 'vagrant provision', chef-solo gives me an exception.
[2013-07-16 19:23:08 -0400] cannonball: [2013-07-16T18:58:17+00:00] FATAL: Chef::Exceptions::CookbookNotFound: Cookbook git not found. If you're loading git from another cookbook, make sure you configure the dependency in your metadata
[2013-07-16 19:23:44 -0400] coderanger: Otterley: You can also use the gist I posted, it will also work as you expect
[2013-07-16 19:23:58 -0400] cannonball: It sounds to me like I'm missing something in my chef configuration, but am new enough to not be sure.
[2013-07-16 19:24:08 -0400] coderanger: and will have the advantage of keeping #notifies on the LWR working
[2013-07-16 19:24:36 -0400] trobrock: cannonball: is git in the run_list in vagrant?
[2013-07-16 19:24:56 -0400] Otterley: coderanger, I'll have to look later, I'm already knee deep in a big production change
[2013-07-16 19:25:00 -0400] trobrock: oh I see its in the run_list of the role?
[2013-07-16 19:25:30 -0400] cannonball: trobrock: http://pastie.org/8146642
[2013-07-16 19:25:56 -0400] coderanger: cannonball: is your cookbooks path mapped correctly in the vagrantfile?
[2013-07-16 19:26:45 -0400] cannonball: I think I need to show some paths first.
[2013-07-16 19:26:50 -0400] trobrock: cannonball: what does you chef_solo section of your vagrantfile look like?
[2013-07-16 19:27:01 -0400] cannonball: adding to pastie
[2013-07-16 19:28:57 -0400] cannonball: http://pastie.org/8146654
[2013-07-16 19:29:16 -0400] cannonball: The ~/chef-repo/ directory is the tarball from http://github.com/opscode/chef-repo/tarball/master
[2013-07-16 19:30:05 -0400] trobrock: cannonball: did you put the git cookbook in chef-repo?
[2013-07-16 19:30:35 -0400] coderanger: cannonball: So you only have chef-repo/cookbooks as the cookbooks path
[2013-07-16 19:30:38 -0400] coderanger: and vim/git aren't there
[2013-07-16 19:30:43 -0400] cannonball: Did I "put" it?  The fact that I don't know how to answer that probably means no.
[2013-07-16 19:30:46 -0400] coderanger: You only want to have a single folder structure
[2013-07-16 19:31:16 -0400] trobrock: cannonball: take a look at librarian or berkshelf for handling downloading the cookbooks: http://leopard.in.ua/2013/01/04/chef-solo-getting-started-part-1/ covers librarian a bit
[2013-07-16 19:31:35 -0400] trobrock: if you are used to ruby both those tools follow the bundler mentality
[2013-07-16 19:31:39 -0400] wdpro_kevin: test-kitchen question: Any way to pass "config.vm.provision :shell" ?
[2013-07-16 19:31:41 -0400] cannonball: Is that what librarian does for me?  Auto-downloads cookbooks that aren't in the local cookbook folder?
[2013-07-16 19:32:29 -0400] coderanger: cannonball: 1) use berkshelf
[2013-07-16 19:32:41 -0400] coderanger: 2) berkshelf : chef :: bundler : ruby
[2013-07-16 19:33:05 -0400] trobrock: coderanger: any reason not to use librarian
[2013-07-16 19:33:40 -0400] coderanger: Berkshelf has surpassed it in all ways of measuring more or less
[2013-07-16 19:33:50 -0400] coderanger: if you use chef-server, that is
[2013-07-16 19:33:56 -0400] coderanger: for solo, its a bit more even
[2013-07-16 19:34:12 -0400] trobrock: it has pluses but definitely still not beating it at everything
[2013-07-16 19:34:29 -0400] trobrock: I still have a ton of issues getting to to actually do things like "berks update yum"
[2013-07-16 19:34:43 -0400] trobrock: it has a tendency to not update
[2013-07-16 19:34:45 -0400] miah: i like berkshelf but i feel like its definitely trying to do too much
[2013-07-16 19:34:48 -0400] cannonball: are berkshelf and librarian essentially just wrappers around knife?
[2013-07-16 19:35:07 -0400] coderanger: cannonball: No, they are largely package managers
[2013-07-16 19:35:44 -0400] trobrock: the latest version definitely made things better, and this is not to say I didnt have problems with librarian, but at least for me I haven't been convinced that it exceeds in all ways of measurment
[2013-07-16 19:36:31 -0400] trobrock: number of times I say f berkshelf vs number of times I say f librarian I think are fairly equal :)
[2013-07-16 19:36:49 -0400] miah: i stopped using librarian orginally because of some dependency resolving issue. im not sure if the problem was me being a derp or a legitimate problem.
[2013-07-16 19:36:58 -0400] miah: but i support both endevours
[2013-07-16 19:37:11 -0400] trobrock: miah: those are the problems I had with librarian that caused me to switch
[2013-07-16 19:37:36 -0400] trobrock: but after using berkshelf for about 6 months now I think I would have opted to improve librarian instead
[2013-07-16 19:37:48 -0400] cannonball: Reading various howto's, thanks.
[2013-07-16 19:37:59 -0400] trobrock: librarian tended to get into dependency deadlock situations
[2013-07-16 19:40:49 -0400] miah: ya
[2013-07-16 19:40:56 -0400] miah: i wasn't experienced enough with ruby at the time
[2013-07-16 19:41:12 -0400] miah: but the last year has been fruitful
[2013-07-16 19:41:35 -0400] cannonball: FWIW, possibly  the best presentation I went to at SCALE (a SoCal Linux event) was by Phil Dibowitz from Facebook talking about how they use Chef and the scaling issues they faced.  It was an awesome talk.
[2013-07-16 19:41:44 -0400] trobrock: other than that it seemed to function much closer to how bundler functioned than berkshelf did, although they cleaned quite a few of those oddities up in the latest version
[2013-07-16 19:42:06 -0400] miah: ill have to take a look
[2013-07-16 19:42:21 -0400] brucelee1: coderanger: here's the paste for my client.rb file http://pastebin.com/XfrJwswv, just to remind you, my problem is that running chef-client returns 404 object not found errors, because i think part of the runlist tries to go to the server via the address https://localhost/etc.../, by setting localhost to goto the chef server ip in /etc/hosts makes it work. I can't figure out why it would go to https://localhost though, any ideas?
[2013-07-16 19:42:26 -0400] trobrock: cannonball: any idea if it was the same talk he did at chef conf?
[2013-07-16 19:42:44 -0400] cannonball: I'm not sure.  It's possible.
[2013-07-16 19:42:52 -0400] trobrock: that was a good talk
[2013-07-16 19:43:05 -0400] coderanger: brucelee1: Do a chef-client -l debug
[2013-07-16 19:43:13 -0400] coderanger: brucelee1: Should show something more at least
[2013-07-16 19:43:58 -0400] HAPPYFUNBALL: do I need to load chef::Util::FileEdit in some special way?
[2013-07-16 19:44:04 -0400] jmartin: cannonball: miah: was that diff than the chefconf talk?
[2013-07-16 19:44:04 -0400] HAPPYFUNBALL: http://rubydoc.info/gems/chef/10.16.2/Chef/Util/FileEdit
[2013-07-16 19:49:56 -0400] HAPPYFUNBALL: how would I go about using this class in a ruby_block http://rubydoc.info/gems/chef/10.16.2/Chef/Util/FileEdit
[2013-07-16 19:50:51 -0400] cannonball: trobrock: Here is the PDF from Phil's presentation: http://www.socallinuxexpo.org/sites/default/files/presentations/cfgmgmt.pdf
[2013-07-16 19:50:59 -0400] cannonball: I don't see a video of the presentation anywhere.
[2013-07-16 19:51:09 -0400] trobrock: cannonball: thanks
[2013-07-16 19:52:00 -0400] trobrock: looks like the same talk
[2013-07-16 19:52:11 -0400] jmartin: ja
[2013-07-16 19:52:20 -0400] trobrock: https://www.youtube.com/watch?v=SYZ2GzYAw_Q&list=PLrmstJpucjzXNMLcI5X-EjirpDd-SITd3&index=3
[2013-07-16 19:54:36 -0400] mlb-: I have a powershell file I want to execute in a recipe. I don't particularly wish to inline it into the recipe either. How might I accomplish this?
[2013-07-16 19:56:58 -0400] HAPPYFUNBALL: why is the following code throwing errors? http://pastebin.com/j3nB57rB via Class: Chef::Util::FileEdit
[2013-07-16 20:08:29 -0400] sx0bpqd0xs: hello all. I have an error that is popping up on the client, concerning the root group. it is trying to usermod -g 'root' root and is getting a return of 3 instead of 0. i have a good pasted output here: http://paste.ubuntu.com/5882012/
[2013-07-16 20:08:40 -0400] sx0bpqd0xs: can anyone point me in the right direction to fix this?
[2013-07-16 20:11:22 -0400] sx0bpqd0xs: the purpose is to make sure that root is still there and has 3 ssh keys loaded (for our sysadmins)
[2013-07-16 20:11:46 -0400] mwhooker: cross posting this from ##infra-talk:  I made an upstart script that has a post-start check to see if my service is running. I wanted to use timeout(1) and curl, but realized I would need to install both of those, so instead I wrote a python script. I didn't want to add any more dependencies but the python is far more verbose than bash. does anyone have any comments on going one way or another?
[2013-07-16 20:11:58 -0400] mwhooker: the scripts in question https://github.com/SimpleFinance/chef-zookeeper/tree/master/templates/default
[2013-07-16 20:20:48 -0400] sx0bpqd0xs: ill try again. i get "Couldn't lookup integer GID for group name 0" when trying to run chef-client
[2013-07-16 20:21:00 -0400] sx0bpqd0xs: here is the error, and all the related config: Couldn't lookup integer GID for group name 0
[2013-07-16 20:21:14 -0400] sx0bpqd0xs: http://paste.ubuntu.com/5882048/
[2013-07-16 20:21:38 -0400] sx0bpqd0xs: Are these just bots, or is there anyone here with chef experience?
[2013-07-16 20:22:03 -0400] joecrow: don't you want `gid 0` not `gid "0"` ? I think it's trying to look up a group named "0"
[2013-07-16 20:22:33 -0400] chris613: goes back to being a bot
[2013-07-16 20:22:57 -0400] sx0bpqd0xs: joe: do you mean the line "gid":"0",?
[2013-07-16 20:23:41 -0400] sx0bpqd0xs: root@chef:/opt/chef-cookbooks/cookbooks# cat ./data_bags/users/root.json
[2013-07-16 20:23:41 -0400] sx0bpqd0xs: {
[2013-07-16 20:23:41 -0400] sx0bpqd0xs: "id":"root",
[2013-07-16 20:23:41 -0400] sx0bpqd0xs: "comment":"root user",
[2013-07-16 20:23:41 -0400] sx0bpqd0xs: "uid":"0",
[2013-07-16 20:23:41 -0400] sx0bpqd0xs: "gid":"0",
[2013-07-16 20:23:42 -0400] sx0bpqd0xs: "shell":"/bin/bash"
[2013-07-16 20:23:42 -0400] sx0bpqd0xs: "home":"/root",
[2013-07-16 20:23:43 -0400] sx0bpqd0xs: }
[2013-07-16 20:23:52 -0400] joecrow: yes
[2013-07-16 20:26:00 -0400] sx0bpqd0xs: You are the man! Always helpful to have a second set of eyes on something. Thanks so much.
[2013-07-16 20:26:36 -0400] sx0bpqd0xs: Here, have a virtual dollar... $
[2013-07-16 20:34:43 -0400] geggam: you know.. irc and bitcoins can go together
[2013-07-16 20:35:43 -0400] sx0bpqd0xs: The FDA says no to bitcoin. NSA is looking at you currently.
[2013-07-16 20:36:02 -0400] ianco: hm. so i want to try to chefspec a lwrp, do folks usually just throw an lwrp test recipe together or an entire test cookbook in spec/ ?
[2013-07-16 20:36:52 -0400] sx0bpqd0xs: As to SSH keys.. Now that i have my users being deployed to my servers, i've made a 'ssh_keys' attribute in the databag. Is there some other configuration to be done, to get the ssh keys to deploy to the servers as well?
[2013-07-16 20:38:53 -0400] sx0bpqd0xs: the Chef-fundamentals document doesnt explore how to deploy ssh keys.
[2013-07-16 20:43:37 -0400] doomviki1g: sx0bpqd0xs: look at the users cookbook
[2013-07-16 20:43:40 -0400] dignan_w_: i'm trying to set an attribute in a ruby_block, and then use it later in the same recipe.  it doesn't seem to be working.  i'm doing node.default[:example] = 'value' in the ruby block, and then node[:example] outside the ruby block, but it doesn't seem to be actually setting it
[2013-07-16 20:47:59 -0400] gyre007: I have a q about attribute? method
[2013-07-16 20:48:25 -0400] gyre007: can attribute? method be used to check NESTED keys ?
[2013-07-16 20:49:20 -0400] gyre007: ie somethin like attribute?("blah1.blaah2") or can it only check the first key ie attribute?("blah1")
[2013-07-16 20:51:17 -0400] karamorf: I'm curious as to how go about updating a server. Let's say I have V1 and V2 of a cookbook that sets up a server from scratch, do I need include a recipe in somewhere the manages upgrading a server from V1 to V2?
[2013-07-16 20:51:36 -0400] cheftastic: Was wondering if anyone has used chef-vault in a hosted chef environment?
[2013-07-16 20:54:38 -0400] coderanger: gyre007: node['blah1'] && node['blah1']['blah2']
[2013-07-16 20:55:06 -0400] coderanger: karamorf: Normally no, chef is idempotent so you just define the desired state and chef enforces that
[2013-07-16 20:55:31 -0400] coderanger: karamorf: So unless your upgrade itself isn't idempotent (and can't be massaged into looking like it is) you don't need to do that
[2013-07-16 20:55:40 -0400] gyre007: if the nesting has 4 levels then this is nuts coderanger
[2013-07-16 20:56:03 -0400] coderanger: gyre007: The problem is '.' is legal in attributes
[2013-07-16 20:56:10 -0400] coderanger: as are all characters except \0 probably
[2013-07-16 20:56:28 -0400] coderanger: we could extend it to be node.attribute?('blah1', 'blah2') though
[2013-07-16 20:56:33 -0400] coderanger: would be all in favor of a patch for that
[2013-07-16 20:56:42 -0400] gyre007: so it's not easy to say which attribute is defined...
[2013-07-16 20:57:53 -0400] karamorf: @coderanger hmm. Just makes it hard to think about db upgrades. I wouldn't want to run the seed command on an already existing db, just the migrate command. Would I then want to account for those differences in the recipe itself?
[2013-07-16 20:58:24 -0400] coderanger: gyre007: Generally attributes have a default value so you don't need to check the whole chain
[2013-07-16 20:58:50 -0400] coderanger: gyre007: in your attributes.rb include default['blah1']['blah2'] = null or some other sane default
[2013-07-16 20:58:52 -0400] gyre007: well not the whole chain...but to certain depth
[2013-07-16 20:59:01 -0400] coderanger: and then just check node['blah1']['blah2']
[2013-07-16 20:59:48 -0400] sx0bpqd0xs: doomviki1g: i have the users cookbook docs open. i have created a users json file like this: http://paste.ubuntu.com/5882175/
[2013-07-16 21:00:19 -0400] sx0bpqd0xs: which looks correct to me, but the ssh key is not being store in the authorized_keys file.
[2013-07-16 21:10:58 -0400] sx0bpqd0xs: is there anything more to do, than just add an ssh_keys attribute in a databag,.. for ssh keys to propogate to servers?
[2013-07-16 21:13:41 -0400] surge_: So I'm getting WARN: unable to detect ipaddress in CentOS 5.5. Not sure why this 1 instance is giving me issues, but other CentOS 5.5 boxes were just fine
[2013-07-16 21:13:59 -0400] surge_: without an ip address, chef doesn't get past the cookbook compile phase
[2013-07-16 21:15:10 -0400] cheflevelramen: Quick design question. I have a hosts cookbook that manages my /etc/hosts files on my servers. But I'm now writing a cookbook that installs Katello (centralized package manager for yum). It's public IP needs to be added to each server's /etc/hosts file. The simple solution is to just manually add that to my /etc/hosts template. But I'm under the impression that a cookbook should be completely self-contained. If someone didn't 
[2013-07-16 21:16:19 -0400] coderanger: surge_: It usually means the interface that is the default route has no IP
[2013-07-16 21:17:02 -0400] doomviking: sx0bpqd0xs: do you have the recipe in a role file?
[2013-07-16 21:17:37 -0400] sx0bpqd0xs: thanks. ive not done anything with a role file.
[2013-07-16 21:19:29 -0400] doomviking: sx0bpqd0xs: in the role or other cookbook, recipe[users::sysadmins] or include_recipe "users::sysadmins" will need to be active
[2013-07-16 21:19:42 -0400] doomviking: for example
[2013-07-16 21:19:51 -0400] surge_: coderanger: Hm I've really no clue on how to fixing that. Could you point me in the general direction of something to search for?
[2013-07-16 21:19:56 -0400] surge_: how to fix that *
[2013-07-16 21:20:40 -0400] sx0bpqd0xs: let me give that a whirl. thank you for the input.
[2013-07-16 21:20:47 -0400] coderanger: surge_: well first "sudo route" and look for the default interface
[2013-07-16 21:21:01 -0400] coderanger: surge_: Then "sudo ifconfig <that interface>" and see if it has an IP
[2013-07-16 21:21:29 -0400] coderanger: surge_: This usually only comes up with things like subinterfaces and vlans
[2013-07-16 21:23:39 -0400] sx0bpqd0xs: so there is a role listed in my GUI, but there is nothing in the cookbook/roles directory. is that normal?
[2013-07-16 21:23:55 -0400] coderanger: sx0bpqd0xs: Did you previously upload a role?
[2013-07-16 21:24:14 -0400] coderanger: Also roles are generally kept in just roles/ in your chef repo
[2013-07-16 21:24:39 -0400] sx0bpqd0xs: there is definitely a role here in the GUI. but there isnt a related json file in the roles directory.
[2013-07-16 21:25:45 -0400] sx0bpqd0xs: so if its created in the GUI, it doesnt create a related json file...
[2013-07-16 21:26:18 -0400] sx0bpqd0xs: i dont think having this gui is a good idea.
[2013-07-16 21:27:07 -0400] doomviking: I tend to stay away from it
[2013-07-16 21:27:50 -0400] coderanger: sx0bpqd0xs: The chef-server can't just magically create things in your source control
[2013-07-16 21:27:54 -0400] coderanger: How you use it is up to you
[2013-07-16 21:30:44 -0400] sx0bpqd0xs: ah. thats just a pet peeve of mine. splitting configuration between gui/console causes issues unless there is synchronization between the config database and the related config file structure. when its done right its easy to manage. when its done poorly, its confusing.
[2013-07-16 21:31:51 -0400] sx0bpqd0xs: have a good day! hopefully i can get this role/recipe/databag/configuration/gui/console thing all together tomorrow.
[2013-07-16 21:40:19 -0400] doomviking: yeah, stick with your chef repo and the gui will follow.
[2013-07-16 21:42:59 -0400] coderanger: Different people have different workflows
[2013-07-16 21:43:11 -0400] coderanger: I'm definitely trying to make working with data in the GUI better though :-)
[2013-07-16 22:17:56 -0400] asharp: i know that with berkshelf and vagrant, if i just put a vagrantfile and berksfile together, all the cookbooks in the berksfile, and those cookbook's dependencies, will be downloaded to the vm. but if i want to run chef-solo locally, is there any way i can point chef-solo to a berksfile to get its cookbooks?
[2013-07-16 22:23:56 -0400] coderanger: asharp: berks install --path perhaps?
[2013-07-16 22:24:35 -0400] surge_: coderanger: Well, I thought that maybe the missing /etc/hosts file (dont ask me how THAT happened) was causing the issue with ohai, and once I replaced it. Ohai didn't give me the 3 missing ip errors, but chef is still failing to converge the cookbooks.
[2013-07-16 22:24:55 -0400] surge_: The node has an IP, it has to, since I'm sshing in remotely....
[2013-07-16 22:25:06 -0400] coderanger: surge_: Whats the error?
[2013-07-16 22:26:10 -0400] maplebed: has anybody here used the community jenkins cookbook to create a slaved jenkins setup? (multiple coordinated machines)
[2013-07-16 22:26:45 -0400] maplebed: I'm just looking for some guidance.
[2013-07-16 22:26:51 -0400] surge_: http://pastebin.com/qKBSN7XY
[2013-07-16 22:26:53 -0400] asharp: coderanger: i was going to use a solo.rb file to point to the berkshelf cookbooks. but i dont have any of the necessary cookbooks downloaded yet, they are all in github. i was hoping i could write a berksfile to do this for me
[2013-07-16 22:27:32 -0400] coderanger: surge_: As it says in the log, those are warnings, not errors
[2013-07-16 22:27:38 -0400] surge_: coderanger: That leads to: Undefined method or attribute `ipaddress' on `node'
[2013-07-16 22:28:04 -0400] coderanger: surge_: Well then yes, as I said you need to figure out what your default interface is and check its params
[2013-07-16 22:28:36 -0400] coderanger: surge_: You can run "ohai -l debug" directly also to see what it is trying to do
[2013-07-16 22:28:51 -0400] surge_: Okay. Thanks
[2013-07-16 22:29:57 -0400] coderanger: asharp: Yes, you can (I think)
[2013-07-16 22:30:06 -0400] coderanger: make a berksfile and use berks install --path
[2013-07-16 22:31:47 -0400] asharp: coderanger: works great thank you!
[2013-07-16 22:57:51 -0400] Sauraus: Anyone from OpsCode here that can fixup my jira/wiki login? I keep getting an error saying I should file a ticket with my JIRA admin when I try to create an account
[2013-07-16 23:00:20 -0400] swalberg: I'm trying to install a gem with rbenv_gem but need to pass some options to the gem command. I tried it as a string and chef-client says it must be a hash, I tried it as a hash and I'm told it needs to be a string. Anyone have an example I can follow please?
[2013-07-16 23:00:26 -0400] swalberg: https://gist.github.com/swalberg/6015995
[2013-07-16 23:01:43 -0400] awayne: does anyone have a suggestion for an editor when working on cookbooks?
[2013-07-16 23:01:52 -0400] awayne: is everyone else just using vi/vim?
[2013-07-16 23:02:38 -0400] swalberg: I use mvim, but I'm just getting started here :)
[2013-07-16 23:11:12 -0400] surge_: coderanger: I found a ticket on Opscode that described my problem. Seems like it was fixed in ohai 6.18.0.rc.0
[2013-07-16 23:11:18 -0400] miah: i use vim
[2013-07-16 23:20:19 -0400] aneto: I use sublime and vim
[2013-07-16 23:21:51 -0400] aneto: I really dig sublime as my graphical editor lets you drop multiple coursers and all kind of stuff that I'm still trying to learn =(
[2013-07-16 23:24:39 -0400] surge_: awayne: print this out http://vimcheatsheet.com/
[2013-07-16 23:24:52 -0400] awayne: Anyone ever received an error similar to: "FATAL ...  LoadError: cannot load such file -- lvm" . Running on CentOS 6
[2013-07-16 23:25:24 -0400] awayne: my metadata.rb has a depends on lvm
[2013-07-16 23:30:27 -0400] awayne: looks like it's coming out of the lvm physical_volume provider's initialize --  require 'lvm'
[2013-07-16 23:30:40 -0400] awayne: bah
[2013-07-16 23:30:46 -0400] awayne: i bet i missed the default recipe
[2013-07-16 23:38:55 -0400] awayne: am i missing something in the lvm logical_volume resource?
[2013-07-16 23:39:12 -0400] awayne: The attribute :mount_point is defined, but the callbacks refer to an attribute named :location
[2013-07-16 23:40:17 -0400] awayne: When i specify a mount_point, it fails with a cryptic "unable to convert to int" error
[2013-07-16 23:47:54 -0400] tplaner: I'm running chef-solo, and I was wondering if I wanted to configure a AWS or rackspace server using the same cookbooks as I configured within my vagrantconfig locally, how would I go about it?
[2013-07-16 23:59:22 -0400] cparedes_: hey guys - i'm kind of wondering, is it possible to change what facts are used for file/template directory specificity when selecting which file/template to use?
[2013-07-16 23:59:38 -0400] cparedes_: instead of using OS/hostname/etc.
