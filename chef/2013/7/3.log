[2013-07-03 01:37:38 -0400] stormerider: when troubleshooting attributes, how can i tell what the converged attributes are for a given namespace?
[2013-07-03 01:37:59 -0400] Aristata: Guys I have a really simple recipe, https://github.com/caJaeger/resque-opsworks/blob/master/god/recipes/install.rb , but when opsworks runs it the gem god is not there. There are no errors or anything. Anyone know what the problem might be?
[2013-07-03 01:39:43 -0400] stormerider: like, if i have a failed-run-data.json, i can do "jq .node.default.cacti failed-run-data.json" to look at the default attributes. what would i look at to find the converged/winning set of attributes?
[2013-07-03 01:47:26 -0400] skopii: Howdy, a quick question. I am writing a LWRP. In the LWRP I want to notify a service resource to restart. However, invoking the LWRP multiple times in the same chef run causes the service to be restarted multiple times.
[2013-07-03 01:47:36 -0400] skopii: This is true even with :delayed
[2013-07-03 01:48:07 -0400] skopii: My thinking is that since I have to define the service inside the LWRP to send the notification it's notifying that instance of the service...
[2013-07-03 01:48:48 -0400] skopii: What is the best way to send a notification from inside an LWRP?
[2013-07-03 01:49:50 -0400] Aristata: I think this channel is all questions and no answers.
[2013-07-03 01:50:16 -0400] skopii: miah: ?
[2013-07-03 01:50:44 -0400] stormerider: Aristata: happens sometimes in the afternoons.
[2013-07-03 01:52:02 -0400] stormerider: skopii: if you have multiple invocations of the LWRP why would it be the same instance of the service? not quite following that
[2013-07-03 01:52:03 -0400] Aristata: stormerider:  :(
[2013-07-03 01:52:39 -0400] skopii: stormerider: so can I memoize the service instance?
[2013-07-03 01:52:59 -0400] stormerider: Aristata: AWS Opsworks runs chef 0.9, that mindshare is going to be somewhat small at this point
[2013-07-03 01:54:40 -0400] stormerider: skopii: i havent worked a lot with LWRPs, but are you sure you have to define the service inside it?
[2013-07-03 01:54:50 -0400] skopii: yeah, if I don't define the service it can't find it
[2013-07-03 01:55:10 -0400] skopii: "Cannot find a resource matching..." (did you define it first?)
[2013-07-03 01:57:37 -0400] skopii: aha! so if the recipe where the resource is defined runs then it knows about it
[2013-07-03 01:58:34 -0400] skopii: so rather than requiring the recipe that defines the service runs before the LWRP I should be able to define the service if it doesn't exist already
[2013-07-03 01:59:05 -0400] tobin: can someone give me an example of how to begin/rescue a 'Mixlib::ShellOut::ShellCommandFailed' error?
[2013-07-03 01:59:47 -0400] stormerider: tobin: really depends on the actual error return. that's often from something like an execute[] resource.
[2013-07-03 01:59:57 -0400] skopii: tobin: you can probably just exc_resource = Chef::Resource::Execute.new('resource_name', run_context)
[2013-07-03 02:00:10 -0400] Aristata: stormerider:  If a recipe requires another recipe, do I need to run that recipe first, or will the recipe requiring it run it before hand?
[2013-07-03 02:00:11 -0400] skopii: The execute resource also supports an array (or range IIRC) of return values
[2013-07-03 02:00:34 -0400] tobin: skopii: okay cool thanks. I'll search fro that
[2013-07-03 02:00:47 -0400] stormerider: skopii: i was going to say, alternatively, you could have the LWRP resource instance do a service restart, rather than the LWRP itself. but kudos if you solved it.
[2013-07-03 02:01:00 -0400] tobin: its actually happening during the execution of the group provisioner
[2013-07-03 02:01:21 -0400] skopii: stormerider: that is probably simpler than what I was thinking
[2013-07-03 02:01:26 -0400] stormerider: Aristata: on 10/11, if you do include_recipe it's fine.
[2013-07-03 02:01:30 -0400] skopii: and it's probably more explicit
[2013-07-03 02:02:44 -0400] stormerider: Aristata: if you're referring to cookbook dependencies that's done via the metadata... does that answer the question?
[2013-07-03 02:03:58 -0400] Aristata: stormerider:  The recipe says this at the top: include_recipe "runit"
[2013-07-03 02:05:16 -0400] Aristata: So I assume that will just run on it's own, then do the rest of the recipe
[2013-07-03 02:05:22 -0400] stormerider: Aristata: then you dont need to specify that in your run list, it'll glob it into the run.
[2013-07-03 02:05:29 -0400] Aristata: hmm, ok
[2013-07-03 02:05:47 -0400] stormerider: remeber chef 10/11 is two pass... compile, then execute.
[2013-07-03 02:06:06 -0400] stormerider: i cant speak to 9, is why im qualifying :)
[2013-07-03 02:07:51 -0400] Aristata: I do wonder though, how it knows which cookbook the runit recipe is in.
[2013-07-03 02:09:26 -0400] stormerider: because if it's not x::a, then it's x::default
[2013-07-03 02:09:49 -0400] stormerider: naming is very important in chef.
[2013-07-03 02:09:53 -0400] Aristata: Ah! Things are coming together!
[2013-07-03 02:09:56 -0400] Aristata: Thanks!
[2013-07-03 02:10:25 -0400] stormerider: np
[2013-07-03 02:14:08 -0400] stormerider: gyargh. chef, why are you not regenerating this web_app config? i deleted the apache config file and you still didn't rerun it.
[2013-07-03 02:19:26 -0400] joelteon: so if you pass a string to not_if, that's executed in the shell?
[2013-07-03 02:20:56 -0400] kisoku: stormerider: is the web_app resource being used inside a deploy resource ?
[2013-07-03 02:26:00 -0400] stormerider: kisoku: no, just inside the cacti cookbook.
[2013-07-03 03:18:09 -0400] ssd7: Ohai Chefs
[2013-07-03 03:18:22 -0400] stormerider: gah. i hate when i spend a lot of time trying to figure out why something isnt working and i realize i did <% %> instead of <%= %>
[2013-07-03 03:18:48 -0400] stormerider: it's the one character bugs that drive me crazy, heh.
[2013-07-03 03:20:09 -0400] stormerider: ohai ssd7
[2013-07-03 03:48:43 -0400] Aristata: Is it necessary to define all your chef recipes in the metadata of the cookbook?
[2013-07-03 03:49:36 -0400] Aristata: Also, does a cookbook have to have a default recipe?
[2013-07-03 03:49:56 -0400] skopii: no and no
[2013-07-03 03:50:18 -0400] Aristata: awesome
[2013-07-03 03:50:20 -0400] Aristata: thanks
[2013-07-03 04:04:15 -0400] stormerider: no, but both are good practices IMO
[2013-07-03 05:34:31 -0400] Aristata: can someone verify to me that this is all i need in a recipe to install a gem? https://github.com/caJaeger/resque-opsworks/blob/master/god/recipes/install.rb
[2013-07-03 05:34:50 -0400] Aristata: That recipe runs without an error in the log everytime, but god never exists on the server
[2013-07-03 05:49:09 -0400] coderanger: Aristata: Is opsworks still on 0.9?
[2013-07-03 05:49:21 -0400] coderanger: If so, you might need to be more manual about specifying the gem_binary
[2013-07-03 05:49:34 -0400] Aristata: coderanger:  how so?
[2013-07-03 05:50:05 -0400] coderanger: Older versions of Chef (which I think opsworks is still using) were not good at coping with multiple gem installer binaries on the system
[2013-07-03 05:50:49 -0400] Aristata: chef-0.9.15.5
[2013-07-03 05:50:57 -0400] Aristata: Is the version it looks like opsworks is on
[2013-07-03 05:51:02 -0400] coderanger: yeahhh, that would be the ancient one
[2013-07-03 05:51:07 -0400] Aristata: Ok
[2013-07-03 05:51:18 -0400] Aristata: So what additional information do I need to have for this?
[2013-07-03 05:51:18 -0400] coderanger: Add gem_binary '/path/to/gem' to the resource
[2013-07-03 05:51:48 -0400] Aristata: I don't know what path/to/gem would be
[2013-07-03 05:52:06 -0400] coderanger: How are you installing rubygems?
[2013-07-03 05:52:40 -0400] Aristata: It's being installed vie opsworks in the default recipes for the app deployment
[2013-07-03 05:52:43 -0400] Aristata: I believe
[2013-07-03 05:52:56 -0400] Aristata: opsworks is installing it automatically in the pipe somewhere
[2013-07-03 05:53:08 -0400] coderanger: You don't want to use that gem though, when you install god in to it, the god binary will not be on your path
[2013-07-03 05:53:50 -0400] Aristata: I don't feel like I am following what you are saying very well.
[2013-07-03 05:53:56 -0400] Aristata: What do I want to use to get the binary path?
[2013-07-03 05:54:04 -0400] coderanger: Do not use the Ruby or Rubygem installs that come with opsworks
[2013-07-03 05:54:16 -0400] coderanger: If you want to use Rubygems, you need to install it yourself
[2013-07-03 05:55:05 -0400] coderanger: In later versions of Chef we made this much more explicit and the defaults are no correct, but because opsworks is ~2 years old, it uses the internal installs by default, which is basically always wrong at this point
[2013-07-03 05:55:12 -0400] Aristata: And doing that will clear up my issue, or do I need to do something with that binary path?
[2013-07-03 05:55:40 -0400] coderanger: You need to install rubygems yourself, either via a system package or from source, and then give the resultant path as gem_binary
[2013-07-03 05:55:54 -0400] coderanger: It will probably be /usr/bin/gem or /usr/local/bin/gem
[2013-07-03 05:55:59 -0400] coderanger: depending on your OS and install method
[2013-07-03 05:56:12 -0400] Aristata: I see
[2013-07-03 05:57:15 -0400] Aristata: So at that point, would I just do this:
[2013-07-03 05:57:25 -0400] Aristata: http://pastie.org/8105797
[2013-07-03 05:57:40 -0400] Aristata: (and I assume I want rubygems19?)
[2013-07-03 05:58:06 -0400] coderanger: well it would be gem_binary '/usr/bin/gem' or whatever
[2013-07-03 05:58:07 -0400] coderanger: but yes
[2013-07-03 05:59:13 -0400] coderanger: You can also just switch to plain chef which doesn't have so many issues like this, or rather it would have failed earlier and with an obvious error message :)
[2013-07-03 05:59:21 -0400] Aristata: coderanger:  On my server right now before packaging rubygems19, I already have both of those paths existing, will that be a problem?
[2013-07-03 05:59:40 -0400] coderanger: Both /usr/bin/gem and /usr/local/bin/gem?
[2013-07-03 05:59:47 -0400] Aristata: both
[2013-07-03 05:59:55 -0400] coderanger: That seems bad
[2013-07-03 06:00:06 -0400] coderanger: Do they point at the same install of Ruby?
[2013-07-03 06:00:11 -0400] coderanger: and are they they same version of rubygems?
[2013-07-03 06:00:20 -0400] Aristata: I am not sure how to check that
[2013-07-03 06:00:38 -0400] coderanger: Well --version will tell you the latter
[2013-07-03 06:00:46 -0400] coderanger: and look at the shebang for the former
[2013-07-03 06:01:40 -0400] Aristata:  /usr/local/bin/gem is 1.8.24
[2013-07-03 06:01:57 -0400] Aristata:  /usr/bin/gem is 1.8.11
[2013-07-03 06:02:09 -0400] Aristata: So I imagine they aren't pointing to the same place
[2013-07-03 06:02:14 -0400] coderanger: Probably not :)
[2013-07-03 06:02:30 -0400] coderanger: Use whichever one is correct, unfortunately I can't tell you which that one is :)
[2013-07-03 06:02:34 -0400] Aristata: I wonder why opsworks is installing bot
[2013-07-03 06:02:37 -0400] Aristata: both*
[2013-07-03 06:03:39 -0400] Aristata: gem --version is giving me 1.8.24, that should be indicative of the correct one, yes?
[2013-07-03 06:03:55 -0400] coderanger: No idea :)
[2013-07-03 06:04:07 -0400] coderanger: If "/usr/local/bin/gem install god" results in a working god install
[2013-07-03 06:04:12 -0400] coderanger: then it will work when chef does it
[2013-07-03 06:04:21 -0400] Aristata: ah, good point
[2013-07-03 06:06:17 -0400] Aristata: Well they both seem to work, I would guess that eliminates the gem_binary variable?
[2013-07-03 06:08:50 -0400] coderanger: No, you should still set one of them
[2013-07-03 06:09:09 -0400] coderanger: the default in that version of chef when no gem_binary is given is to do the install directly via API calls
[2013-07-03 06:10:23 -0400] Aristata: Ok, I will give it a shot, thank you.
[2013-07-03 07:19:47 -0400] stormerider: bflad: tossed you a pull request :)
[2013-07-03 07:24:33 -0400] Aristata: Can anyone give me a trail to follow here? I have a recipe that installs a gem, however, it fails to do so if I pair it with another recipe. Has anyone seen this behavior before?
[2013-07-03 07:41:18 -0400] stormerider: Aristata: what do you mean "pair it with"?
[2013-07-03 07:45:40 -0400] Aristata: stormerider:  Basicaly it appears that if the recipe to install the god gem is the only one, it installs. If I have any other recipes it does not get installed. There are no errors in the log, and the recipes before are leaving proof that they have run correctly.
[2013-07-03 07:49:57 -0400] stormerider: you mean if you have other recipes in the runlist?
[2013-07-03 07:51:23 -0400] stormerider: if that's the case i would a) try running the same runlist w/o god, and then b) run the god recipe all on its own
[2013-07-03 08:00:31 -0400] MarkusDBX: Hi, I like to know. Which is the most popular linux distribution within the chef-community? I guess all dists work. But what is the main trend. Just curious. Currently learning chef and designing a development-workflow. Thanks
[2013-07-03 08:01:38 -0400] Aristata: stormerider: Yeah I have been doing that. Unfortunately there are a lot of recipes and it takes forever to redeploy instances :(
[2013-07-03 08:05:04 -0400] Balistic: Hi, using omnibus installer on Ubuntu 12.04, postgres fails to start because it needs 3.7GB of SHM but chef sets SHM to 1.7GB via /etc/sysctl.d/90-postgres
[2013-07-03 08:17:25 -0400] dyu: we pass attributes to knife via -j. The problem we have is that Chef uses the last value that we passed via -j if we don't use -j. I'd like to know how we can avoid this. And where are the values stored?
[2013-07-03 08:38:08 -0400] stormerider: dyu: attributes are wiped each run unless they're part of a recipe/role
[2013-07-03 08:38:40 -0400] fclausen: hello all, is there a way that an external script can check if a chef-client is currently executing a chef run? We have a watchdog tool that should not attempt to restart services while the chef-client is performing a chef run.
[2013-07-03 08:39:40 -0400] stormerider: fclausen: i know chef-client can tell if a run is already going on, so i'd look at what it's doing there
[2013-07-03 08:40:01 -0400] fclausen: thanks stormerider, I'll take a look
[2013-07-03 08:40:12 -0400] stormerider: dyu: -j is handy for setting an initial runlist, after that i wouldnt rely on it
[2013-07-03 08:40:36 -0400] stormerider: or resetting a runlist, i should say.
[2013-07-03 08:49:28 -0400] ichilton: What's the recommended ruby for chef - 1.9.3p286 like the omnibus install uses?
[2013-07-03 09:17:58 -0400] stormerider: 1.9.3 anything should work very well
[2013-07-03 09:30:27 -0400] _JamieD_: Hi all, I'm just switching to encrypted data bags and I see that there is a load method for encrypted data bags. What about the data_bag_item method? Do I need to use a different method call or is the data accessible because I've already loaded and decrypted the data bag?
[2013-07-03 09:39:39 -0400] Aristata: If a chef recipe fails, does it undo previous recipes in the same cookbook?
[2013-07-03 10:05:26 -0400] proppen: Aristata: I can't se how that would be possible if it was already executed.
[2013-07-03 10:07:10 -0400] Aristata: proppen: That's what I thought as well. I have a recipe installing god, and another creating a directory. I then have a third recipe that is generating conf files and telling god to watch them. If I don't run the third recipe, my directories are there, and so is the god gem, if I do run it, both are lost. Makes no sense.
[2013-07-03 10:08:56 -0400] proppen: Aristata: perhaps it's some check or something else that it detects and fail before execution?
[2013-07-03 10:09:41 -0400] Aristata: proppen: Well, I wrote these recipes, and I don't even have a clue how to do that!
[2013-07-03 10:09:49 -0400] Aristata: Being new to chef is frusterating.
[2013-07-03 10:10:55 -0400] proppen: can you pastebin the output of a run?
[2013-07-03 10:38:27 -0400] _JamieD_: I can't get the knife bootstrap to copy over the encrypted_data_bag_secret file for some reason. Anyone know much about this?
[2013-07-03 11:48:13 -0400] ocharles: Hi there. Having a bit of difficultly using include_recipe "build-essential"
[2013-07-03 11:48:33 -0400] ocharles: If I add build-essential to my run list, everything is fine. If I use include_recipe "build-essential" the default compiletime attribute is not being set
[2013-07-03 11:48:41 -0400] ocharles: does include_recipe bring in default attributes?
[2013-07-03 11:48:56 -0400] ocharles: specifically, i'm seeing 'undefined method `[]' for nil:NilClass' on the line 'compiletime = node['build_essential']['compiletime']'
[2013-07-03 11:49:24 -0400] ocharles: so it seems that node['build_essential'] is nil, even though build-essential/attributes/default.rb sets this to false
[2013-07-03 11:52:10 -0400] gkarekinian: ocharles: Did you add "depends 'build-essential'" to your cookbook's metadata.rb?
[2013-07-03 11:54:54 -0400] ocharles: gkarekinian: I have not, in fact I don't have a metadata.rb at all
[2013-07-03 11:55:06 -0400] ocharles: so I should probably fix that :)
[2013-07-03 11:55:30 -0400] ocharles: Is that needed for chef-solo?
[2013-07-03 11:55:38 -0400] ocharles: the documentation suggests that is just for chef-server
[2013-07-03 12:00:05 -0400] gkarekinian: I haven't used chef-solo in a while, but I think it's needed there too to load the attributes and include a recipe
[2013-07-03 12:02:25 -0400] ocharles: It appears it does make a difference yea
[2013-07-03 12:02:39 -0400] ocharles: 'echo depends "build-essential" > metadata.rb' gets me further
[2013-07-03 12:02:53 -0400] ocharles: Can dependencies be specified for only a single recipe, or should I use suggests for that?
[2013-07-03 12:03:00 -0400] ocharles: I only need build-essential for my ::production recipe
[2013-07-03 12:03:56 -0400] gkarekinian: If I remember correctly "suggests" isn't used, it's just there for humans
[2013-07-03 12:04:22 -0400] ocharles: ah, ok
[2013-07-03 12:05:14 -0400] gkarekinian: So yeah, you always end up with tons of dependencies you don't need with community cookbooks, it's just the way it is
[2013-07-03 12:05:33 -0400] ocharles: urgh
[2013-07-03 12:05:37 -0400] ocharles: c'est la vie
[2013-07-03 12:07:37 -0400] gkarekinian: It's even more annoying when using chef server, because your nodes download every single cookbook on bootstrap
[2013-07-03 12:10:14 -0400] gchristensen: only the ones depended on, not every single one on the server
[2013-07-03 12:10:33 -0400] gkarekinian: Yeah I wasn't clear, sorry
[2013-07-03 12:12:09 -0400] gkarekinian: I never thought about using dummy cookbooks to get them to download on the nodes faster until now
[2013-07-03 12:13:33 -0400] ocharles: ok, chef-solo is working again
[2013-07-03 12:13:35 -0400] ocharles: thanks for the help, gkarekinian
[2013-07-03 12:13:50 -0400] gkarekinian: Glad to help
[2013-07-03 12:14:42 -0400] tobin: Can someone give me some pointers on how to do a begin/rescue with chef. I'm trying to add some exception handling around group creation, in case the user being added to the group doesn't exist. https://gist.github.com/joshuatobin/9813f0eb3a8623f85a71
[2013-07-03 12:23:04 -0400] gchristensen: gkarekinian: dummy cookbooks? like making a fakeyum one when you are on debian?
[2013-07-03 12:23:43 -0400] gkarekinian: Yeah but I don't think it's worth it in my case, I don't have that many dependencies I don't use
[2013-07-03 12:23:50 -0400] gchristensen: I doubt it :P
[2013-07-03 12:24:11 -0400] gchristensen: even in my case - I have tons of dependencies all over the place, but it doesn't use *that* much disk space, and it doesn't slow things down *that* much.
[2013-07-03 12:25:27 -0400] gkarekinian: I could do without the dependencies on java, jpackage and tomcat, but it's caused by an ancient application cookbook anyway :)
[2013-07-03 12:31:01 -0400] gchristensen: can I specify a group name in the 'user' resource for the 'gid' or does it need tobe a numerical ID?
[2013-07-03 12:47:24 -0400] lewiz: if I specify a template destination to a directory that doesn't exist, what's the behaviour?
[2013-07-03 12:53:59 -0400] UukGoblin: hi
[2013-07-03 12:54:17 -0400] UukGoblin: I have a simple chef-minitest, like service('sumd').must_be_running
[2013-07-03 12:54:28 -0400] UukGoblin: and it passes, even though sumd isn't running cause there's no binary
[2013-07-03 12:55:00 -0400] UukGoblin: 'sv status sumd' says 'down: sumd: 0s, normally up, want up; run: log: (pid 11498) 65784s'
[2013-07-03 13:17:37 -0400] aramus_: Hello, does anyone know what a `block in from_file` error means? Is this a specific error message or just saying that there's an error in this block of code?
[2013-07-03 13:24:12 -0400] mveitas: aramus: most likely some error in the block of code
[2013-07-03 13:25:55 -0400] HAPPYFUNBALL_: hey, where would I want to put a script that needs to be called by a recipe/cookbook?
[2013-07-03 13:28:33 -0400] cwj: HAPPYFUNBALL_: files/default or templates/default, then use a cookbook_file or template resource to drop it off
[2013-07-03 13:28:46 -0400] mveitas: HAPPYFUNBALL: You can put it anywhere you like and reference it from the recipe, but if you want to keep it self contained then you could include it inside the files/default
[2013-07-03 13:29:09 -0400] HAPPYFUNBALL_: how about/etc/chef/repository/cookbooks/mycookbook/resources
[2013-07-03 13:29:13 -0400] zaargy: if i do chef-client -j <some-json-with-a-runlist> then next time i run chef-client (without -j) it should reuse the runlist right?
[2013-07-03 13:31:02 -0400] cwj: zaargy: i believe thats correct. if the run list completes successfully the first time,it should be persisted into the node data saved to the chef server and used by the chef-client on the next run
[2013-07-03 13:31:10 -0400] mveitas: HAPPYFUNBALL, docs.opscode.com/resource_cookbook_file.html
[2013-07-03 13:34:33 -0400] zaargy: ah is completes successfully...
[2013-07-03 13:34:36 -0400] zaargy: that could be the issue here
[2013-07-03 13:34:47 -0400] zaargy: s/is/if it/
[2013-07-03 13:35:44 -0400] zaargy: i guess the next question is can i make it save the runlist if it doesn't complete successfully?
[2013-07-03 13:35:49 -0400] zaargy: or maybe that is that a bad idea..
[2013-07-03 13:38:56 -0400] cwj: zaargy: you can directly edit the node (and its run list) using knife
[2013-07-03 13:39:08 -0400] cwj: and when you save your changes they will persist to the server
[2013-07-03 13:40:00 -0400] cwj: you can also call node.save inside a recipe if you want to ensure node data is saved before you try to do something potentially problematic (i think the mysql recipe contains an example of this)
[2013-07-03 13:57:46 -0400] aramus_: Is it possible to set an attribute of a node from a recipe?
[2013-07-03 13:59:18 -0400] gleam: sure
[2013-07-03 14:11:25 -0400] gchristensen: does anyone happen to know of a Hubot plugin which integrates with chef search? like 'hubot, chef <search query>' returns some data about the nodes
[2013-07-03 14:11:48 -0400] tabolario: aramus_: http://docs.opscode.com/chef_overview_attributes.html#examples
[2013-07-03 14:13:18 -0400] tabolario: gchristensen: i'm not aware of one, but this might make it easy to write one: https://github.com/normanjoyner/chef-api
[2013-07-03 14:21:24 -0400] jgood: Is it possible to create an ohai plugin to read values from a json value and create a new Mash from that? If so how what is the syntax for reading the json values?
[2013-07-03 14:22:46 -0400] jgood: *read values from a json file
[2013-07-03 14:23:01 -0400] gchristensen: jgood: read into the `json` ruby library, it comes standard
[2013-07-03 14:23:33 -0400] jgood: gchristensen: will do, thanks
[2013-07-03 14:27:23 -0400] chr4: action :deploy doesn't check out git repository when using deploy_revision resource. Is this expected behaviour? action :force_deploy checks it out, but breaks other things (re-sets up symlinks, always fires notifications, even though code was not changed). Any ideas howto workaround this?
[2013-07-03 14:37:19 -0400] eherot: If I want to use a gem in a recipe library (such as Fog), is there a correct, non-kludgy way to make sure it gets installed during the pre-compile phase?  Right now it's giving me "cannot load such file  fog" errors when parsing the 'require' line in my library.
[2013-07-03 14:40:11 -0400] recolor: eherot: Can't you use the gem_package resource?
[2013-07-03 14:48:25 -0400] recolor: x
[2013-07-03 14:48:48 -0400] eherot: recolor: apparently it doesn't happen soon enough in the compile process
[2013-07-03 14:51:18 -0400] eherot: https://gist.github.com/eherot/5918775
[2013-07-03 14:55:38 -0400] juliancdunn: eherot: use chef_gem for that
[2013-07-03 14:56:08 -0400] eherot: juliancdunn: tried it with chef_gem, too.  Same result.
[2013-07-03 14:57:44 -0400] juliancdunn: dunno then. it worked for me: https://github.com/rackspace-cookbooks/rackspacecloud/blob/master/recipes/default.rb
[2013-07-03 14:59:54 -0400] cassianoleal: how can I include_recipe from a LWRP provider?
[2013-07-03 15:04:46 -0400] nmische: is http://community.opscode.com/api/v1 down for anyone else?
[2013-07-03 15:05:15 -0400] mveitas: you are not alone nmische
[2013-07-03 15:05:20 -0400] nmische: i get a 404, ok
[2013-07-03 15:05:39 -0400] nmische: thanks mveitas
[2013-07-03 15:10:05 -0400] adnichols: eherot the way I got this working was a combination of using chef_gem and then not including the gem in the library until I needed it - eg. inside a metho
[2013-07-03 15:13:06 -0400] adnichols: eherot take a look at the way right_aws is included in this library https://github.com/opscode-cookbooks/aws/blob/master/libraries/ec2.rb
[2013-07-03 15:13:07 -0400] eherot: adnichols: hmmI'm skeptical but I'll give it a try.
[2013-07-03 15:13:24 -0400] adnichols: eherot I was likewise skeptical but it resolved issues for me
[2013-07-03 15:14:21 -0400] eherot: adnichols: yeah I found that.  Kind of seems like if the gem isn't there it just ignores the error and drives on.  Bad programming practice a bit?
[2013-07-03 15:15:04 -0400] adnichols: eherot no, it'll fail I'm pretty sure - you could always add more to make it fail harder if you want
[2013-07-03 15:15:46 -0400] eherot: adnichols: it shouldn't fail the way that's written because it doesn't re-raisefar as I understand it at least.
[2013-07-03 15:16:16 -0400] eherot: the assumption seems to be that by the time the actual method call is used, someone will have dealt with the problem (by installing the gem)
[2013-07-03 15:16:38 -0400] eherot: adnichols: I'm gonna try your approach of doing the require in the method
[2013-07-03 15:16:54 -0400] eherot: fingers crossed :-)
[2013-07-03 15:21:26 -0400] recolor:  /msg NickServ identify dellwire
[2013-07-03 15:22:32 -0400] adnichols: eherot I would also use chef_gem instead of gem_package to install fog in addition to the library change
[2013-07-03 15:23:40 -0400] eherot: yeah, I switched that.  I had actually only switched to gem_package during the troubleshooting process.
[2013-07-03 15:23:47 -0400] adnichols:  cool
[2013-07-03 15:38:10 -0400] tobin: Is anyone using jenkins to coordinate uploading cookbook versions to the server?
[2013-07-03 15:38:57 -0400] tobin: I'm using berkshelf, but curious if there are any projects available that can watch a specific branch and manage the berkshelf/knife upload
[2013-07-03 15:46:03 -0400] Aristata: I am having trouble with a recipe, it's giving me this: Cannot find a resource matching service[god]. I have god installed. It is occuring in this recipe: https://github.com/caJaeger/resque-opsworks/blob/master/god/recipes/resque.rb which uses a definition from the definitions directory of the same cookbook. Anyone have any ideas?
[2013-07-03 15:48:30 -0400] jgood: is there a way to call an ohai plugin from a separate cookbook/recipe than the ohai cookbook?
[2013-07-03 15:52:48 -0400] dtm_: Aristata: perhaps an issue with your runit cookbook?  are you using the latest version of the runit cookbook?  seems a related "hack" is listed here: https://github.com/opscode-cookbooks/runit/blob/master/libraries/resource_runit_service.rb
[2013-07-03 15:54:23 -0400] Aristata: dtm_:  I am using the latest runit cookbook, should I try calling this recipe you have linked before my recipe and after runit::default is called? I am not quit sure what additional funtionality this cookbook gives me
[2013-07-03 15:56:24 -0400] eloqua: hi there, having trouble getting the hang with LWRP's on chef-solo
[2013-07-03 15:57:24 -0400] eloqua: i'm trying to add packages on windows through the chocolatey cookbook, but I have trouble where to place the chocolatey commands. I've put them into the default.rb in the recipe folder, but I dont think thats good practice
[2013-07-03 15:58:38 -0400] eherot: adnichols: so far so good, btw.
[2013-07-03 15:59:03 -0400] dtm_: Aristata:  I don't know.  Sorry.
[2013-07-03 16:01:11 -0400] adnichols: eherot great
[2013-07-03 16:01:40 -0400] eherot: adnichols: Thanks for the suggestion.  I don't think it would have occurred to me to try that.
[2013-07-03 16:01:54 -0400] adnichols: eherot that was the 30 second version of about a month of hacky workarounds and frustration
[2013-07-03 16:02:17 -0400] eherot: adnichols: Haha yeah, I can totally relate.  Too bad it's not StackOverflow or I'd mod up your answer. :-)
[2013-07-03 16:02:37 -0400] eherot: and thanks a million for saving me that month.
[2013-07-03 16:02:42 -0400] adnichols: heh, np
[2013-07-03 16:05:06 -0400] eloqua: Where do I put custom recipes?
[2013-07-03 16:09:16 -0400] eloqua: I cant require or include chocolatey on my providers. keep getting errors
[2013-07-03 16:09:20 -0400] eloqua: resources*
[2013-07-03 16:11:18 -0400] eloqua: Where do you put custom recipes? Or does it belong in the recipe.rb
[2013-07-03 16:11:30 -0400] eloqua: default.rb
[2013-07-03 16:11:39 -0400] adnichols: eloqua I'm not sure exactly what you are asking but typically custom recipes go into a custom cookbook
[2013-07-03 16:12:21 -0400] adnichols: and the typical pattern is to put that cookbook in site-cookbooks if it's checked into your chef repo & you are using something like librarian-chef to manage the cookbooks dir
[2013-07-03 16:13:26 -0400] adnichols: you can put your custom recipe under any name in that cookbook you want - default.rb is a conventient place to put stuff that is a 'safe default' if you want to use the cookbook
[2013-07-03 16:14:10 -0400] eloqua: I got chef-solo on a windows machine. I got my runlist configured and my solo.rb is pointing to my cookbooks. inside the cookbook directory I have chocolatey and all the cookbooks it is depending on. now I can start chef-solo via command line and he does the stuff which is mentioned in the default.rb but how do I make him do custom stuff without needing to write it into the default.rb? sorry for being vague here but i'm not 100% convinc
[2013-07-03 16:14:45 -0400] adnichols: anything you want chef to do has to be defined in some recipe
[2013-07-03 16:14:59 -0400] adnichols: so I'm not sure what "custom stuff" you want to do without putting it into a recipe
[2013-07-03 16:15:20 -0400] eloqua: I created a workstation.rb inside the recipes folder. custom stuff meaning using the chocolatey :install command to install packages
[2013-07-03 16:16:00 -0400] eloqua: packages as in "putty", chrome, etc
[2013-07-03 16:16:11 -0400] eloqua: i eventually want to move to a chef server when I get the grasp of this
[2013-07-03 16:16:25 -0400] adnichols: right - so you looked at the example in the chocolatey readme?
[2013-07-03 16:16:32 -0400] adnichols: and put something like that in your workstation.rb ?
[2013-07-03 16:17:29 -0400] eloqua: exactly
[2013-07-03 16:17:43 -0400] adnichols: Then you run chef and point it to your workstation.rb recipe
[2013-07-03 16:17:50 -0400] eloqua: he doesnt recognize the include_recipe command
[2013-07-03 16:18:06 -0400] eloqua: for some odd reason he discovers the workstation.rb automatically :s
[2013-07-03 16:18:42 -0400] lrr: i was wondering if someone could help me debug my redmine cookbook?
[2013-07-03 16:18:57 -0400] gabrtv: i'm fighting an order of operations issue with a git repository, a template (that i need created right after the git repo), and a series of bash commands that are subscribed to :run on git repo change
[2013-07-03 16:18:58 -0400] adnichols: I'm not very familiar with any windows specifics - but if you can put together a pastebin type thing showing the command you are running, the error output and the recipe you are calling that would help
[2013-07-03 16:19:03 -0400] lrr: i've got just about everything done, but for some reason, it's not linking /opt/redmine to /var/www
[2013-07-03 16:19:54 -0400] eloqua: adnichols: thanks, ill copy it straight away
[2013-07-03 16:20:54 -0400] gabrtv: i've got an example here: https://gist.github.com/gabrtv/01937acbfb4e8373627f .. i'm basically trying to get a template to run after the git repo, but before the other subscribed resources
[2013-07-03 16:21:26 -0400] gabrtv: hey adnichols, hope all is well!
[2013-07-03 16:21:51 -0400] adnichols: oh, hey gabrtv - didn't recognize the nick
[2013-07-03 16:22:02 -0400] adnichols: playing with chef eh? :)
[2013-07-03 16:22:17 -0400] gabrtv: more than playing.. our new private paas uses it heavily
[2013-07-03 16:22:24 -0400] adnichols: ah, sweet
[2013-07-03 16:23:18 -0400] adnichols: gabrtv so right now is the template running before the git sync?
[2013-07-03 16:23:36 -0400] eloqua: adnichols: had a faulty provider and resource which was causing the problems. still workstation.rb in /recipes is not loaded. where do I need to add it to get noticed by chef?
[2013-07-03 16:23:48 -0400] adnichols: gabrtv your template is missing an action - that may be part of it
[2013-07-03 16:23:53 -0400] gabrtv: right now it's doing: git, subscribed resources, then template.. which breaks subscribed resources
[2013-07-03 16:24:17 -0400] recolor: x
[2013-07-03 16:24:21 -0400] gabrtv: i need: git, template, then subscribed resources
[2013-07-03 16:26:49 -0400] adnichols: I see
[2013-07-03 16:28:00 -0400] adnichols: Assuming the template always changes if the git sync runs, could you point your subscribes at the template and have git notify the template (or have the template subscribe to the git resource)?
[2013-07-03 16:28:28 -0400] rracterr: So I've got a real problem here and could use some help... I have a very responsive Chef webui... and I can ping my chef server and get sub millisecond responses, but when the clients are run with log level debug I can see it taking 10 seconds or so for every request to the chef server.... which is causing my syncronizing phase to take forever.... ideas?
[2013-07-03 16:28:30 -0400] gabrtv: if the template could subscribe to the git resource, i think i'd be ok.. but not sure templates support that
[2013-07-03 16:28:31 -0400] gad0lin: hi, dummy question what ruby version do you use in your chef repos, I am still on 1.8.7, so maybe we could pick newer version?
[2013-07-03 16:28:44 -0400] rracterr: to be clear, they run slow without debug level too
[2013-07-03 16:28:51 -0400] gabrtv: and no, the template doesn't change on git runs.. it's static config
[2013-07-03 16:31:46 -0400] adnichols: gabrtv the git call should be able to notify :create, "template[blah]" and I'm sure the bash runs could subscribe to the template
[2013-07-03 16:32:15 -0400] adnichols: you may have to set the action in the template to :nothing
[2013-07-03 16:32:42 -0400] adnichols: but in reality they occur one after the other so the template is going to run after git by default
[2013-07-03 16:33:08 -0400] adnichols: the issue is just whether the bash runs will trigger if the template doesn't change
[2013-07-03 16:33:27 -0400] adnichols: thinking about it they probably will not
[2013-07-03 16:34:34 -0400] gad0lin: can I use 1.9.3 ruby with chef or I can pick sth more recent?
[2013-07-03 16:34:49 -0400] gchristensen: gad0lin: using the omnibus installer, it will bring its own isolated version of ruby.
[2013-07-03 16:34:55 -0400] adnichols: eloqua sorry, I'd need to see your chef-solo config, typically if you have a cookbook named "blah" with a recipe "foo" you would put that in cookbooks/blah/recipes/foo.rb and assuming cookbooks is in your cookbook path chef will find it
[2013-07-03 16:35:19 -0400] gabrtv: adnichols: hmm.. looks like this might have worked https://gist.github.com/gabrtv/01937acbfb4e8373627f
[2013-07-03 16:35:53 -0400] gabrtv: actually nevermind..
[2013-07-03 16:36:25 -0400] gad0lin: gchristensen: that what I do and its awesome, i asked about ruby on my local machine to run knife?
[2013-07-03 16:37:30 -0400] rracterr: So I've reviewed the chat logs for the last few months and at least half a dozen people have asked about slow syncronization and nobodys ever seen an answer... does everyone in here just expect it to take 5 minutes to pull down half a dozen cookbooks or is the problem so rare that nobody knows a solution?
[2013-07-03 16:38:27 -0400] eloqua: adnichols: thats my solo.rb nothing much in it really. http://pastebin.com/shpsx5tr
[2013-07-03 16:38:48 -0400] gkarekinian: rracterr: It's not rare, the Opscode platform is really really slow
[2013-07-03 16:38:52 -0400] adnichols: gabrtv could you change this around a bit maybe so the bash calls have an only_if and don't rely on the subscribe? That way things just use order of execution?
[2013-07-03 16:39:16 -0400] eloqua: adnichols: added the json at the bottom: http://pastebin.com/YK4npjC9
[2013-07-03 16:39:45 -0400] gabrtv: adnichols: not a bad idea... i'll try that
[2013-07-03 16:39:52 -0400] rracterr: its wierd to me, because the work they are doing should be so trivial that it should come back blazing fast... and they put it on nginx like they intend to blaze....
[2013-07-03 16:40:32 -0400] rracterr: Any chance its intentionally crippled to drive adoption of hosted chef?
[2013-07-03 16:41:23 -0400] adnichols: eloqua what command are you running to run chef-solo?
[2013-07-03 16:41:53 -0400] adnichols: rracterr I would like to think not, I've had similar experiences but it's never driven me mad enough to seek a solution
[2013-07-03 16:42:44 -0400] rracterr: its just insane that I can spin up an aws linux box in 13 seconds and have to sit for 5 minutes to copy over a few templates
[2013-07-03 16:43:09 -0400] eloqua: adnichols: chef-solo -c solo.rb -j mynode.json
[2013-07-03 16:43:12 -0400] adnichols: yeah, understood, don't have a solution
[2013-07-03 16:43:22 -0400] eloqua: adnichols: mynode.json is the one i pasted below with the runlist
[2013-07-03 16:43:42 -0400] adnichols: eloqua so what I don't see in your runlist is your workstation.rb
[2013-07-03 16:45:16 -0400] adnichols: eloqua when you run chef-solo with those configs - does it give you an error? Seems like that should at least do some stuff (but not  your custom stuff)
[2013-07-03 16:46:43 -0400] eloqua: adnichols: it does. it runs my chocolatey cookbook including the default recipe
[2013-07-03 16:46:57 -0400] adnichols: eloqua and it works right?
[2013-07-03 16:47:00 -0400] eloqua: yea
[2013-07-03 16:47:06 -0400] eloqua: do i need to add the workstation.rb to my runlist
[2013-07-03 16:47:14 -0400] adnichols: yes, if you want it to run
[2013-07-03 16:47:55 -0400] eloqua: whats the exact syntax recipe[chocolatey/workstation.rb] ?
[2013-07-03 16:48:09 -0400] adnichols: you put it in the chocolatey cookbook?
[2013-07-03 16:48:12 -0400] eloqua: nvm found it
[2013-07-03 16:48:13 -0400] eloqua: thanks :)
[2013-07-03 16:48:19 -0400] eloqua: yea
[2013-07-03 16:48:48 -0400] adnichols: k - general convention would be to put it in your own cookbook so you can manage chocolatey separately - but to get things working just go with it for now, change later
[2013-07-03 16:50:52 -0400] eloqua: does my own cookbook need providers and resources? or do I just require the chocolatey cookbook
[2013-07-03 16:51:07 -0400] rracterr: Cant find anything online about what a reasonable expectation is for a chef server as far as nodes/server ratio... if I have 200 boxes running chef-client deamon every 30 minutes against one server... with say... Users, NTP, and Resolver recipes.. is that too much or too little?
[2013-07-03 16:51:52 -0400] d```: rracterr: what version of chef server are you running?
[2013-07-03 16:51:59 -0400] d```: did you do any tuning of the chef server?
[2013-07-03 16:52:48 -0400] d```: rracterr: there's a video from a recent chefconf where some facebook engineer was talking about running 10k nodes against one chef server
[2013-07-03 16:53:06 -0400] d```: but that was a specialized use case scenario
[2013-07-03 16:53:31 -0400] rracterr: Current version
[2013-07-03 16:53:44 -0400] adnichols: eloqua it doesn't need providers and resources but if you just use knife cookbook create (or berks init) you'll get all the requisite bits
[2013-07-03 16:54:15 -0400] rracterr: d```: I've yet to see any whitepaper on tuning the chef server, but I am at the moment digging thru chef-server-running.json looking for settings I may want to tweak
[2013-07-03 16:55:24 -0400] jeremy_carroll: Question. What's the 'Berkshelf' way to comprise run lists based on application cookbooks? Create a new app cookbook for run lists? Ex: <company>-apt + <company>-ntp = new cookbook <company>-base?
[2013-07-03 16:55:28 -0400] gchristensen: all the parts of the chef server are discrete systems, almost all of which are commonly used systems. tuning them is a matter of looking at usage and reading about those systems
[2013-07-03 16:55:39 -0400] eloqua: adnichols: great stuff! thanks alot :)
[2013-07-03 16:56:38 -0400] rracterr: true, but I dont have an architectural topology of the system, so I'm unclear what portions are used when it hits the rest interface from the client... certainly nginx, but rabit? erchef? estatsd?
[2013-07-03 16:57:35 -0400] rracterr: and since I lack any real guide to determine which component is slow... its sorta trial and error... if I knew how to turn on advanced metrics on the server side I would.
[2013-07-03 17:02:03 -0400] gleam: Streaming Entertainment Startup Boxee Acquired By Samsung For Around $30M
[2013-07-03 17:02:09 -0400] adnichols: rracterr from what I can tell most folks who have scaled it have done so via trial and error and like any complex system there's a wheelbarrow full of "it depends" in there
[2013-07-03 17:02:44 -0400] adnichols: rracterr The etsy guys were saying they had something like 1300 nodes every 10 minutes on one beefy box
[2013-07-03 17:10:59 -0400] suffix: touch .yoro_swag
[2013-07-03 17:11:04 -0400] suffix: YOU ONLY RUN ONCE
[2013-07-03 17:25:07 -0400] jgood: getting this response after a remote_file resource. "(file sizes exceed 10000000 bytes, diff output suppressed)" Does this mean that the file is being cropped?
[2013-07-03 17:25:50 -0400] evxd: Can you search for nested attributes with 'node.attribute?()'? I tried using a dot syntax and I am failing.
[2013-07-03 17:26:12 -0400] slillibridge: jgood: No, that just means it won't log the diff.
[2013-07-03 17:27:06 -0400] jgood: slillibridge: thanks, just wanted to check
[2013-07-03 17:31:05 -0400] mikdiet: Have trouble with postgresql reciepe (v3.0.2). There is line `::Chef::Recipe.send(:include, Opscode::PostgresqlHelpers)` in `recipes/config_initdb.rb`. I see `Opscode::PostgresqlHelpers` defined in `libraries/default.rb`. But it fails with error `uninitialized constant Chef::Recipe::Opscode`. Why that library didn't requred and how to fix it?
[2013-07-03 17:43:00 -0400] mikdiet: http://stackoverflow.com/questions/17454689/chef-reciepe-postgresql-doesnt-load-libraries
[2013-07-03 17:50:38 -0400] addisonj_: hrm... funding a mechanical turk account for the first time, a payment is just stuck as pending, I have a demo in a few hours I wanted to use a real HIT for... anyone know how long that takes?
[2013-07-03 18:04:48 -0400] log1kal: miah: if you're around, had a question regarding your miah/chef-redis. It says it doesn't support replication, but I see commits related to it (support for slaveof, etc). Does it support slaveof?
[2013-07-03 18:09:15 -0400] jonathan_____: Hey all, I have a question. I'm trying to run two Redis databases on different ports. So I set up two roles that both have the same run list, but one has override_attributes which sets the port to 6379 and one has override_attributes which sets the port to 6378. This used to work just fine on Chef 0.10.4; since then, I updated Ruby to 2.0 and reinstalled Chef and Knife gems, and the new server I created has chef-client of 11.4.4. I
[2013-07-03 18:09:16 -0400] jonathan_____: seems that this chef-client is ignoring one of these roles, so I'm only ending up with Redis on port 6378 (since it comes last in the node's role list).
[2013-07-03 18:09:21 -0400] jonathan_____: Is there something new I should be doing?
[2013-07-03 18:10:37 -0400] gchristensen: wow... that sounds like it never should have worked.
[2013-07-03 18:10:57 -0400] d```: gchristensen: I was going to say the same thing
[2013-07-03 18:11:03 -0400] log1kal: /agree
[2013-07-03 18:11:14 -0400] jonathan_____: Oh. Heh, I'm  a Chef newbie so I'm not surprised.
[2013-07-03 18:11:30 -0400] organicveggie: How can I check the version of Chef within a recipe?
[2013-07-03 18:11:43 -0400] jonathan_____: What's the best way to achieve what I'm trying to do?
[2013-07-03 18:12:01 -0400] gchristensen: jonathan_____: the idea is the node attributes are consistent all the time, not shifting around like you describe. maybe make the port list a ... list [123, 456] and iterate over it? or... something... oof.
[2013-07-03 18:13:33 -0400] jonathan_____: Hm. I have slightly different configuration for these ports, though, which makes it somewhat tricky.
[2013-07-03 18:14:01 -0400] jonathan_____: And also some servers just have Redis on port 6379 and some only on 6378 -- but given that I just purchased a very large EC2 machine, I'm consolidating
[2013-07-03 18:14:11 -0400] jonathan_____: so I thought I could just apply both roles to the same node
[2013-07-03 18:15:08 -0400] d```: jonathan_____: you could just make two different recipes that configured each redis instance
[2013-07-03 18:15:25 -0400] jonathan_____: d```: yeah, that'll probably be better
[2013-07-03 18:15:45 -0400] gchristensen: or a LWRP :P
[2013-07-03 18:15:56 -0400] gchristensen: reddis "9387" do /* config */ end
[2013-07-03 18:16:21 -0400] d```: I think LWRP is the "right" way
[2013-07-03 18:16:54 -0400] jonathan_____: Given that, could I still have this met:
[2013-07-03 18:16:59 -0400] jonathan_____: * Some nodes only have Redis on 6378
[2013-07-03 18:17:06 -0400] jonathan_____: * Some nodes have Redis on 6378 and 6379
[2013-07-03 18:17:33 -0400] jonathan_____: I guess I could make the recipe do something like
[2013-07-03 18:17:45 -0400] jonathan_____: ports.each { |port| redis port do  }
[2013-07-03 18:17:59 -0400] jonathan_____: and in my roles, assign the ports.
[2013-07-03 18:18:10 -0400] d```: as an array?
[2013-07-03 18:18:13 -0400] jonathan_____: yeah.
[2013-07-03 18:18:20 -0400] d```: there you go
[2013-07-03 18:18:21 -0400] jonathan_____: that way I get recipe reuse.
[2013-07-03 18:18:28 -0400] jonathan_____: Thanks, this has been extremely helpful.
[2013-07-03 18:19:37 -0400] rracterr: asdf
[2013-07-03 18:19:59 -0400] rracterr: so /etc/chef/server.rb and /etc/chef-server/chef-server.rb .... I see both mentioned in documentation as being the source of the server config file... sup with that?
[2013-07-03 18:21:31 -0400] organicveggie: Trying to figure out how to determine what version of Chef is running from within a recipe. node['chef_packages']['chef']['version'] doesn't seem to available. Any suggestions?
[2013-07-03 18:22:27 -0400] gchristensen: organicveggie: try Chef::VERSION to get the current version?
[2013-07-03 18:22:45 -0400] organicveggie: thanks. i'll give that a shot.
[2013-07-03 18:24:24 -0400] organicveggie: gchristensen: worked perfectly. Thanks!
[2013-07-03 18:25:03 -0400] gchristensen: you're welcome
[2013-07-03 18:32:50 -0400] scalp42: hey folks, do you know how to get some visibility into the "include_recipe" cookbooks ?
[2013-07-03 18:33:08 -0400] rracterr: ??
[2013-07-03 18:33:15 -0400] scalp42: if im writing a wrapper cookbook zs-foo
[2013-07-03 18:33:18 -0400] scalp42: that include_recipe "foo"
[2013-07-03 18:33:28 -0400] scalp42: node['recipes'] only returns zs-foo
[2013-07-03 18:33:58 -0400] d```: I'm trying to upgrade from chef server 10.x to erchef, I see that the only ubuntu and RHEL are supported, is there a recommended install path for those of us running debian?
[2013-07-03 18:34:12 -0400] d```: erlang applications from source frighten me
[2013-07-03 18:36:20 -0400] scalp42: trying node.recipe_list
[2013-07-03 19:05:18 -0400] Aristata: I am having trouble with a recipe, it's giving me this: Cannot find a resource matching service[god]. I have god installed. It is occuring in this recipe: https://github.com/caJaeger/resque-opsworks/blob/master/god/recipes/resque.rb which uses a definition from the definitions directory of the same cookbook. Anyone have any ideas?
[2013-07-03 19:07:23 -0400] rracterr: have you tried three hail mary's and a votive?
[2013-07-03 19:07:35 -0400] rracterr: helps when your trying to reach god I'm told
[2013-07-03 19:11:45 -0400] adnichols: using god loses all the fun with chef - I can't type 'stop god' anymore
[2013-07-03 19:16:34 -0400] btm: @opscode chef/ohai code review, join: https://plus.google.com/hangouts/_/feb4bf0bd0d4d6821fd74c100835f957b375172d, watch: http://youtu.be/M5rhlbEItFY
[2013-07-03 19:36:21 -0400] tabolario: btm: not sure if this is a better place to chat, was wondering if you guys could take a look at http://tickets.opscode.com/browse/COOK-3264 for me
[2013-07-03 19:38:48 -0400] stormerider: tabolario: i think they're actually doing chef/ohai stuff today, not cookbooks
[2013-07-03 19:38:57 -0400] tabolario: ah damn lol
[2013-07-03 19:39:15 -0400] tabolario: oh i see that now
[2013-07-03 19:40:41 -0400] stormerider: i missed that initially as well :)
[2013-07-03 19:48:21 -0400] mrcnc: i've got to override some attributes in 2 cookbooks but one uses symbols and the other strings for the hash keys
[2013-07-03 19:48:52 -0400] mrcnc: how could i do this is a chef-solo + vagrant configuration?
[2013-07-03 19:49:14 -0400] mrcnc: do i need to create a role?
[2013-07-03 19:50:09 -0400] recolor: mrcnc: node.override['my_attr']
[2013-07-03 19:56:01 -0400] mrcnc: recolor: i'm not sure what you are suggesting.i'm trying to override the attributes of 2 cookbooks without changing their recipessince i'm using vagrant + chef-solo I'm trying to override in the chef.json
[2013-07-03 20:05:28 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/9fed9f9b84703d047bd20bf3db37400d194d6803, watch: http://youtu.be/rvyCcTYDAwI
[2013-07-03 20:07:15 -0400] stormerider: tabolario: ping, they're doing cookbooks now :)
[2013-07-03 20:13:02 -0400] matti: I wish cookbook reviews were as exciting as foodfight ;p
[2013-07-03 20:18:13 -0400] tabolario: nice to meet you avatar to avatar stormerider
[2013-07-03 20:18:21 -0400] stormerider: tabolario: :)
[2013-07-03 20:39:36 -0400] irvingpop: Opscode gang, I have a question about execution order
[2013-07-03 20:41:28 -0400] irvingpop: resource A brings up a VM guest.    I need to read in its IP addresses (bash or ruby),  and then pass that along to resource B
[2013-07-03 20:43:48 -0400] irvingpop: Having tried a few permutations, one of two things happens:   either the reading command (backticks, for example) executes too early  (at compile time),   or it executes at the right time (ruby_block) but I cannot get the output to pass along to resource B
[2013-07-03 20:44:08 -0400] gswallow: Encrypted data bags don't work on Windows, do they?
[2013-07-03 20:45:40 -0400] smoak: how do i override an attribute from another recipe? using `override["attribute"]` in my attributes file doesnt work
[2013-07-03 20:46:28 -0400] gswallow: or maybe they do; I just need to set Chef::Config[:encrypted_data_bag_secret]
[2013-07-03 20:47:09 -0400] juliancdunn: gswallow: they definitely work
[2013-07-03 20:47:45 -0400] gswallow: juliancdunn: yep
[2013-07-03 20:47:59 -0400] juliancdunn: smoak: don't do that in attributes, do it in the recipe at default priority -- node.default['whee']
[2013-07-03 20:49:31 -0400] smoak: julliancdunn: i see, then what is override for?
[2013-07-03 20:49:43 -0400] juliancdunn: smoak: setting at an even higher priority
[2013-07-03 20:50:03 -0400] smoak: so it doesnt actually change the value, just the priority?
[2013-07-03 20:50:07 -0400] juliancdunn: but since default at recipe context is higher priority than default in attribute context, you don't need to use such a large hammer
[2013-07-03 20:50:26 -0400] gswallow: juliancdunn: orthey would work if the bootstrap templates filled out c:/chef/encrypted and lib/chef/encrypted_data_bag_item.rb were platform agnostic.
[2013-07-03 20:50:37 -0400] gswallow: whichI can fix
[2013-07-03 20:50:57 -0400] smoak: so a default attribute in cookbook1 can be "overriden" in cookbook2 by using node.default['attribute'] in cookbook2s recipe(s)?
[2013-07-03 20:51:23 -0400] juliancdunn: smoak: exactly
[2013-07-03 20:51:32 -0400] smoak: juliancdunn: thanks
[2013-07-03 20:51:34 -0400] juliancdunn: smoak: look at http://docs.opscode.com/essentials_cookbook_attribute_files.html, there's a table
[2013-07-03 20:51:54 -0400] smoak: yeah, i was looking at that and from there it looked like i could use override
[2013-07-03 20:52:11 -0400] juliancdunn: gswallow: I dunno what you mean... don't the bootstrap templates fill that out even on Windows?
[2013-07-03 20:52:20 -0400] smoak: since override takes precendence i was thinking that the value i was setting in my attribute file would take precedence over the default in cookbook1
[2013-07-03 20:52:47 -0400] juliancdunn: smoak: you *can* do that, it will work, but it won't leave you any room to really override later
[2013-07-03 20:52:56 -0400] irvingpop: can you set a node attribute from inside ruby_block?
[2013-07-03 20:53:09 -0400] gswallow: irvingpop: yep
[2013-07-03 20:53:45 -0400] irvingpop: what's the magic incantation for that?
[2013-07-03 20:53:50 -0400] smoak: juliancdunn: ok thanks for the help
[2013-07-03 20:53:59 -0400] gswallow: I think it's just node.set  ?
[2013-07-03 20:54:10 -0400] irvingpop: I saw this but it wasn't answered:  http://stackoverflow.com/questions/15816208/chef-recipes-setting-node-attributes-in-ruby-block
[2013-07-03 20:55:41 -0400] gswallow: I think maybe the answer on that post is correct?
[2013-07-03 20:57:17 -0400] irvingpop: trying now
[2013-07-03 21:17:07 -0400] irvingpop: when I add the b.run_action(:create)  to the ruby_block, it gets called too early and then is useless.   If I don't include that,  the downstream resources that read that attribute can't find anything.
[2013-07-03 21:18:52 -0400] irvingpop: would it work if I moved the downstream resources to another recipe, to be called later?
[2013-07-03 21:26:38 -0400] jessicab: irvingpop: you could also have those prior resources use run action too to run early.. but yea, compilation/run does seem to be per recipe in my experience so moving that stuff to another might work.. but attributes are evaluated pretty early on, so perhaps not
[2013-07-03 21:27:31 -0400] irvingpop: thanks jessicab
[2013-07-03 21:28:13 -0400] irvingpop: is there any way to delay the evaluation?   I tried moving it to a library and that didn't work
[2013-07-03 21:28:32 -0400] irvingpop: this may be what I need:  http://tickets.opscode.com/browse/CHEF-3731
[2013-07-03 21:28:37 -0400] _JamieD_: Hi, anyone able to help with getting encrypted data bags working? I'm having trouble getting bootstrapping to upload the secret file
[2013-07-03 21:29:00 -0400] jessicab: irvingpop: you might want to gist your code? not really sure why run actions wouldnt just work for you really
[2013-07-03 21:31:09 -0400] tonyc_: Are there more details to each configuration in chef-server.rb? http://docs.opscode.com/config_rb_chef_server.html doesn't give details to each setting
[2013-07-03 21:32:37 -0400] tonyc_: I'm trying to tune open source chef to handle multiple new nodes to register at once...I'm currently getting time outs for about half of the nodes
[2013-07-03 21:35:22 -0400] irvingpop: jessicab:  https://gist.github.com/irvingpop/5923040
[2013-07-03 21:35:30 -0400] gchristensen: if I wanted to change the search query used in the nagios cookbook (here: https://github.com/opscode-cookbooks/nagios/blob/master/recipes/server.rb#L104-L108 ) - what is my best bet? it seems very involved to rewind all those resources that depend on the `nodes` variable.
[2013-07-03 21:36:33 -0400] workmad3: gchristensen: you're probably looking at forking and changing
[2013-07-03 21:36:35 -0400] irvingpop: so the ruby blocks get_guestmac and get_guestip are trying to set a node attribute,  so that the later resources can pick that up
[2013-07-03 21:36:37 -0400] stormerider: gchristensen: ive actually been working on that exact case as a feature
[2013-07-03 21:36:55 -0400] stormerider: just talked to opscode about it in today's codereview.
[2013-07-03 21:37:02 -0400] gchristensen: oohh, what was the result?
[2013-07-03 21:37:41 -0400] stormerider: i need to tweak it to be a little broader, but they like the idea. http://tickets.opscode.com/browse/COOK-3262
[2013-07-03 21:37:58 -0400] workmad3: irvingpop: the node attributes are being evaluated at compile time, not in the convergence
[2013-07-03 21:38:15 -0400] irvingpop: right :(
[2013-07-03 21:38:23 -0400] gchristensen: stormerider: I love that you've done this.
[2013-07-03 21:38:29 -0400] workmad3: irvingpop: which just means... don't wrap it in a ruby block resource
[2013-07-03 21:39:04 -0400] workmad3: irvingpop: the ruby block resource is specifically for running a block of code in the convergance rather than in the compile phase... if you want to run ruby code at compile time, just write it ;)
[2013-07-03 21:39:32 -0400] stormerider: gchristensen: i'm probably going to rework it and do some testing this weekend, given the holidays (work told us to take the 5th off as well) and try to bounce it back to them by monday.
[2013-07-03 21:39:51 -0400] gchristensen: stormerider: I will subscribe to everything about this ticket. +1 to open source!
[2013-07-03 21:40:15 -0400] irvingpop: workmad3:   but the first resource there (config_...) is bringing up a new lxc guest.   so the mac/IP will be different than at compile time
[2013-07-03 21:40:22 -0400] workmad3: irvingpop: ah, right...
[2013-07-03 21:40:45 -0400] stormerider: gchristensen: indeed!
[2013-07-03 21:40:47 -0400] workmad3: irvingpop: this is the sort of thing that lwrps are for, I believe
[2013-07-03 21:41:13 -0400] stormerider: power to the people ;)
[2013-07-03 21:41:46 -0400] irvingpop: so if I push this code out to a provider, it wouldn't be evaluated until the "right" moment?
[2013-07-03 21:42:41 -0400] workmad3: irvingpop: well, you wouldn't push that out exactly as-is
[2013-07-03 21:42:46 -0400] workmad3: irvingpop: you'd need to rework it a bit
[2013-07-03 21:43:09 -0400] irvingpop: certainly
[2013-07-03 21:43:18 -0400] gchristensen: stormerider: it might be worth noting that this is no longer multi-environment support, but just the ability to filter your nodes, based on any criteria you want.
[2013-07-03 21:43:35 -0400] irvingpop: would I still keep the ruby_block,  or evaluate as ruby?
[2013-07-03 21:43:44 -0400] workmad3: irvingpop: but yeah... within the provider, you'd set up the vm, then grab the variables out of it to push into the template later on in the provider code, etc.
[2013-07-03 21:56:12 -0400] irvingpop: thanks workmad3, reworking now
[2013-07-03 21:57:26 -0400] lewiz_: hey guys... can anybody tell me how to execute multiple directives based on the output of an external command?  I want something like "if run_command(grep...) do xyz end"
[2013-07-03 21:58:28 -0400] gondoi: i'm trying to share data_bags among test suites in test-kitchen, but when I override the data_bags_path, I always get a scp error that implies it can't find the local source, while the secret_file override scps just fine
[2013-07-03 21:58:38 -0400] gondoi: anyone seen this?
[2013-07-03 21:59:26 -0400] gchristensen: stormerider: if I have bug fixes for that patch of yours, how would you like them?
[2013-07-03 22:03:45 -0400] stormerider: gchristensen: feel free to email me (stormerider@gmail.com)... thanks
[2013-07-03 22:15:59 -0400] gchristensen: stormerider: I can forward the patch if you'd like, however this PR represents the issue and the fix: https://github.com/stormerider/nagios/pull/1
[2013-07-03 22:18:21 -0400] epta: Is it normal to call file that actually created from template in current recipe?
[2013-07-03 22:18:24 -0400] stormerider: thanks, will take a look when i have some time, hopefully tonight. work is pinging me atm :)
[2013-07-03 22:18:33 -0400] gchristensen: sure thing :)
[2013-07-03 22:37:26 -0400] gchristensen: when using chef-rewind, I should install that with chef-gem, right?
[2013-07-03 22:56:13 -0400] stormerider: yes
[2013-07-03 22:58:26 -0400] gchristensen: chef-rewind is far easier than I imagined it would be.
[2013-07-03 23:12:14 -0400] gchristensen: any tips on detecting my datacenter? I have a long list of gateways used by the ISP (incomplete,) the IPs assigned don't seem to be following any pattern, they don't use custom apt / yum sources for local caching. I'm sort of running out of ideas.
[2013-07-03 23:12:33 -0400] gchristensen: other than a traceroute and grepping for 'xe-10-3-3-100.edge3.Newark1.Level3.net' which is the only consistent bit among it, but that tends to be slow.
[2013-07-03 23:18:41 -0400] liam3124: hi, I'm setting some recipes and I'd like to set one to change the current user's password, how can I do it? do I need to generate a password through openssl and then change it in the shadow file or is there another way?
[2013-07-03 23:26:36 -0400] stormerider: bflad: thanks :)
[2013-07-03 23:37:49 -0400] ignatz: just got bit by Windows Server 2012 keeping winrm to the local subnet by default. Amazing how much worse knife-windows works when it can't connect.
[2013-07-03 23:50:38 -0400] cwj: amazing how ignatz
