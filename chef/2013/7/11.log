[2013-07-11 00:07:47 -0400] runnyspot: does anyone here use the java recipe? i'm new to chef and got it running, but when it goes to update alternatives, it exits with a failure. i added a debug statement to print the actual command, and when i run it on the machine it works fine with an exit code of 0
[2013-07-11 00:07:56 -0400] runnyspot: so i'm not sure why chef errors out
[2013-07-11 00:24:47 -0400] hakunin: runnyspot: i use java, but i saw a lot of activity in that cookbook lately, not sure what they changed
[2013-07-11 00:25:16 -0400] hakunin: runnyspot: maybe just a one time network issue?
[2013-07-11 01:13:01 -0400] rava: is languages.ruby.default_version populated by ohai?
[2013-07-11 01:15:47 -0400] rava: nope is the answer to my own question :)
[2013-07-11 02:36:16 -0400] cwj: anyone know if there is a reasonable way to override the automatically generated name for an LWRP?
[2013-07-11 02:51:52 -0400] dyu: my redis service won't start after a reboot, but it starts after running the recipe. halp! 0_o
[2013-07-11 02:51:53 -0400] dyu: http://paste.ubuntu.com/5861089/
[2013-07-11 03:06:50 -0400] hakunin: dyu: i don't think you need an init.d script for it if installed as a package
[2013-07-11 03:07:19 -0400] hakunin: dyu: i installed mine from a PPA on ubuntu 12.04 using this recipe: https://gist.github.com/maxim/25817682775e02ef9ec8
[2013-07-11 03:08:58 -0400] dyu: hmmm. that could be it. let me try. i placed that there coz we have multiple instances(currently 2 but we're growing that to around 12) of redis running in the same machine.
[2013-07-11 03:09:39 -0400] hakunin: dyu: not sure about your case, i just have one redis
[2013-07-11 03:12:40 -0400] dyu: hakunin: that fixed it. thanks, man. i guess i only need a separate init script for the other redis instances
[2013-07-11 03:13:57 -0400] hakunin: never heard of running multiple redis servers on the same machine, so can't help there, good luck
[2013-07-11 03:32:15 -0400] Creeves2: anyone know how to specify a different yml database config file in the application_ruby cookbook (rails recipe)
[2013-07-11 03:59:46 -0400] spoin: quick question for someone. i'm trying to query a chef environment from a knife plugin i'm creating. I can get the environment back fine but I would like to be able to access the attributes set in the environment similarly to how you would access attributes in a node. For example 'node["key1"]["key2"]'. I can kinda do that but i have to first call 'env.default_attributes' or 'env.override_attributes'. I'm running chef 10.12 if that helps 
[2013-07-11 04:49:08 -0400] ssd7: Ohai Chefs
[2013-07-11 05:08:01 -0400] coderanger: miah: How much is your place in alameda?
[2013-07-11 05:08:43 -0400] coderanger: finding a lot of alarming low prices, seems like maybe I'm missing something
[2013-07-11 06:28:33 -0400] arir: Just to repeat my announcement one last time, for those who might have missed it because of time differences etc.
[2013-07-11 06:28:45 -0400] arir: "Hi folks, we've just released a cookbook that installs and configures Oracle on Red Hat/derivatives. Have a look at https://github.com/echaeu/echa-oracle. Any feedback/contribution is welcome."
[2013-07-11 07:38:57 -0400] leehambley: can anyone help me figure out why the cookbook I wrote to wrap rabbitmq isn't working correctly, it's not creating my users: https://gist.github.com/leehambley/5973328
[2013-07-11 07:40:39 -0400] leehambley: Set company-specific attributes in your wrapper cookbook to override the community cookbook defaults. Company-specific recipes should go into this wrapper cookbook as well. from http://dougireton.com/blog/2013/02/16/chef-cookbook-anti-patterns/ - the pattern i'm trying to follow
[2013-07-11 07:41:13 -0400] GreatSUN: hey all
[2013-07-11 07:41:42 -0400] GreatSUN: can someone shortly tell me if chef 11 misses load_attribute_by_short_filename for node?
[2013-07-11 07:42:07 -0400] GreatSUN: is there some replacement or is it just you have to use node.normal.load...
[2013-07-11 08:18:02 -0400] bigbigbang: Houha ! got rabbitmq 3.1.3 working on OSC , will be able to clusterise more easily ;-)
[2013-07-11 08:38:37 -0400] \du: hello
[2013-07-11 08:39:00 -0400] bigbigbang: hi !
[2013-07-11 08:40:32 -0400] \du: i am traing to install php5.4 in aws using OpsWorks on Ubuntu 12.04 LTS, i can load the cookbook with the recipe, i using this one: https://github.com/xavadu/cookboook
[2013-07-11 08:40:49 -0400] \du: i add the recipes to the setup lifecycle but i had this error
[2013-07-11 08:41:05 -0400] \du: NoMethodError: undefined method `apt_repository' for ..
[2013-07-11 08:41:42 -0400] \du: i am reading that it's a common error, that some people get trying to install mongodb too, but i can't find a solution
[2013-07-11 08:41:44 -0400] \du: any idea?
[2013-07-11 08:49:51 -0400] johndeere: @<\du> which version of chef are you running?
[2013-07-11 08:50:37 -0400] \du: i using OpsWorks of AWS (Amazon), i think that it run chef solo
[2013-07-11 08:51:08 -0400] \du: there is any command that i can run in the terminal to know the version ?
[2013-07-11 08:51:25 -0400] johndeere: chef-client -v
[2013-07-11 08:52:40 -0400] \du: mmm i didnt have, let me see
[2013-07-11 08:53:58 -0400] \du: chef-0.9.15.5 chef-solo
[2013-07-11 08:55:11 -0400] \du: this it's my error log
[2013-07-11 08:55:13 -0400] \du: http://pastebin.com/hHeicV3h
[2013-07-11 08:55:38 -0400] \du: line 297
[2013-07-11 08:56:15 -0400] \du: and i found this: https://github.com/aws/opsworks-cookbooks/issues/28 then now i run it not in the boot, if not manually but i had the same error
[2013-07-11 08:56:44 -0400] \du: now, i found that maybe i must add: include_recipe "apt" in my recipe, i will try it
[2013-07-11 08:56:53 -0400] johndeere: try that
[2013-07-11 08:57:14 -0400] johndeere: I am not very familiar with OpsWorks but I'm happy to help dig
[2013-07-11 09:03:11 -0400] \du: i update the recipe like that, i will try now: https://github.com/xavadu/cookboook/blob/master/php5_ppa/recipes/from_skettler.rb#L20
[2013-07-11 09:03:30 -0400] johndeere: from what I've read that should do the trick
[2013-07-11 09:03:41 -0400] \du: thanks you johndeere, for me chef and opsworks are new, them any help it's useful
[2013-07-11 09:04:06 -0400] johndeere: yw
[2013-07-11 09:05:57 -0400] \du: oh, now this run good! but doesn't upgrade my php version from 5.3 to 5.4
[2013-07-11 09:08:24 -0400] shimo: the recipe doesn't upgrade anything
[2013-07-11 09:08:32 -0400] shimo: it only adds an apt repo
[2013-07-11 09:09:43 -0400] \du: ooh, i must add some line to do an apt upgrade or something like that ?
[2013-07-11 09:12:13 -0400] shimo: i think you have to research a little on your own
[2013-07-11 09:12:33 -0400] shimo: but the recipe only adds an apt repository
[2013-07-11 09:12:36 -0400] shimo: nothing else
[2013-07-11 09:13:35 -0400] \du: i am in it from yesterday :P, thanks shime
[2013-07-11 09:13:40 -0400] shimo: you'll have to reinstall most likely
[2013-07-11 09:14:11 -0400] \du: i will see it, i think that i must run this recipe in the begining before another recipe install php in the new instance
[2013-07-11 09:14:28 -0400] \du: maybe overriden the run_list
[2013-07-11 09:49:22 -0400] Darrel: hallo... anyone around done any work with opsworks?
[2013-07-11 09:50:14 -0400] Darrel: I have a project with a dead line a week out that I could use another pair of hands on.
[2013-07-11 10:04:53 -0400] \du: dopry, i am fighting with it
[2013-07-11 10:05:15 -0400] dopry: hah.. I totally feel you...
[2013-07-11 10:05:44 -0400] \du: i am new, and from yesterday i am trying to upgrade to php5.4 i can't yet..
[2013-07-11 10:05:49 -0400] \du: what problem do you have?
[2013-07-11 10:06:09 -0400] dopry: I'm debugging templates against it right now.. doesn't give me very good error feedback and haven't figured out a way to get the same version of chef running on my local machine.
[2013-07-11 10:06:27 -0400] dopry: I have a pretty complex environment I'm migrating off of RightScale.
[2013-07-11 10:06:59 -0400] \du: OpsWorks use chef-solo, i am not sure if you can change the version
[2013-07-11 10:07:15 -0400] gkarekinian: OpsWorks uses a modified version of chef-solo, so you can't change the version
[2013-07-11 10:07:20 -0400] dopry: right now I'm just struggling with a time deadline.. I thought the developer who was working on it had a lot more done...
[2013-07-11 10:07:45 -0400] dopry: yeah they're using the peritor version based on 0.8 I think...
[2013-07-11 10:08:13 -0400] \du: chef-0.9.15.5
[2013-07-11 10:08:30 -0400] dopry: he told me a lot more was done... when I started doing code reviews and such I realized the project is a good bit farther behind than it should be...
[2013-07-11 10:08:55 -0400] dopry: suffice it to say... I'm looking for someone to help me out over the next few weeks while I get this project back on track and delivered.
[2013-07-11 10:10:16 -0400] \du: dopry, sorry i can't help you, i am a bit full of project too
[2013-07-11 10:12:13 -0400] dopry: \du, full schedules are fun.. Are you upgrading your environments to php 5.4?
[2013-07-11 10:12:26 -0400] dopry: or updating your app to work with php 5.4?
[2013-07-11 10:14:03 -0400] \du: dopry, i start a new job, an we decide to use AWS with OpsWorks, i am setting up the server and later i must migrate some code and development anothers, but yes, i need php 5.4
[2013-07-11 10:14:32 -0400] dopry: are you using ubuntu 12.04?
[2013-07-11 10:14:40 -0400] \du: and i want do it by cookbook.. i not.. why use OpsWorks? but something that must be simple, becomes so complicate, i am starting to hate OpsWorks
[2013-07-11 10:14:47 -0400] \du: yes dopry
[2013-07-11 10:15:01 -0400] \du: now i find it https://forums.aws.amazon.com/thread.jspa?messageID=468008&#468008
[2013-07-11 10:15:14 -0400] \du: but still having errors, see the last post it's mine
[2013-07-11 10:15:27 -0400] dopry: you should probably use the ondrej ppas...
[2013-07-11 10:16:22 -0400] \du: it's that i am traing, but if i do it in the setup lifecycle i have the follor error: NoMethodError: undefined method `apt_repository' for
[2013-07-11 10:16:37 -0400] dopry: then the packaging system shoudl just pick up 5.4 for the php packages... If you create a custom cookbook with just a recipe to setup that ppa and assign it to the setup event on your php layer..
[2013-07-11 10:16:43 -0400] dopry: oh so you got that far... :)
[2013-07-11 10:16:48 -0400] \du: then now, i fork this repository to mine: https://github.com/opscode-cookbooks/apt and run this cookbook first
[2013-07-11 10:17:03 -0400] dopry: you can just include 'apt'
[2013-07-11 10:17:05 -0400] \du: but now i am having this error:  http://pastebin.com/ksgnyDmq ( line 2719 and 2745 )
[2013-07-11 10:17:10 -0400] dopry: probably...
[2013-07-11 10:17:28 -0400] dopry: you don't need to fork it and add if it's already in the opsworks repo...
[2013-07-11 10:17:39 -0400] \du: i try it, to include_recipe see: http://pastebin.com/9CPTqW1y
[2013-07-11 10:18:14 -0400] \du: it's not in the opsworks it's in opscode
[2013-07-11 10:18:18 -0400] \du: :1
[2013-07-11 10:18:48 -0400] dopry: ahh...
[2013-07-11 10:19:52 -0400] \du: [Thu, 11 Jul 2013 10:11:00 +0000] ERROR: file[/etc/apt/sources.list.d/php54.list] (/opt/aws/opsworks/current/site-cookbooks/apt/providers/repository.rb:118:in `class_from_file') had an error:
[2013-07-11 10:19:52 -0400] \du: undefined method `run_action' for "file[/var/lib/apt/periodic/update-success-stamp]":String
[2013-07-11 10:20:25 -0400] \du: dopry, that superman help you if you need upgrade to 5.4 in your project
[2013-07-11 10:24:15 -0400] dopry: \du have you tried just using execute and using the shell to add the ppa?
[2013-07-11 10:25:31 -0400] \du: which will be using execute? i can do it by shell, but i need use OpsWorks
[2013-07-11 10:25:44 -0400] dopry: \du also you may need to force an apt-get update..
[2013-07-11 10:26:03 -0400] dopry: on I see you are doing that..
[2013-07-11 10:26:12 -0400] \du: see my recipe: https://github.com/xavadu/cookboook/blob/master/php54/recipes/default.rb
[2013-07-11 10:26:31 -0400] \du: now i am trying to add the repository and run all system uprade
[2013-07-11 10:27:09 -0400] fooJBar: Hello Chefs, anyone know how to manually clone a resource inside a recipe?
[2013-07-11 10:28:54 -0400] dopry: \du, I would remove the ignore_failure from both of those...
[2013-07-11 10:29:07 -0400] dopry: the execute calls...
[2013-07-11 10:29:38 -0400] \du: dopry, okey i will try, now i am initialing a instance with this recipe and crossing the fingers
[2013-07-11 10:32:35 -0400] dopry: \du you could also use a notify on the source list update...
[2013-07-11 10:32:37 -0400] dopry: template "/etc/apt/sources.list.d/my_apt_sources.list" do
[2013-07-11 10:32:37 -0400] dopry:   notifies :run, resources(:execute => "apt-get update"), :immediately
[2013-07-11 10:32:37 -0400] dopry: end
[2013-07-11 10:34:26 -0400] \du: let me see, i am so new in chef, i must add this lines to templates/default.rb ?
[2013-07-11 10:34:39 -0400] dopry: no it goes in your recipe...
[2013-07-11 10:35:16 -0400] \du: okey, i will try
[2013-07-11 10:36:26 -0400] dopry: \du, good luck.. I gotta get back to work...
[2013-07-11 10:37:01 -0400] \du: dopry, thanks you! and good luck too with you deadline
[2013-07-11 10:37:13 -0400] dopry: \du, note... I'm strongly considering scrapping opsworks and just using capistrano and chef-solo...
[2013-07-11 10:37:25 -0400] dopry: this web interface is just too much headache...
[2013-07-11 10:38:29 -0400] dopry: I can't debug in vagrant locally and the errors I get from opsworks are very useful. sometimes I run in to issues where I run deploys and it just fails with no explanation and I run it again and it works...
[2013-07-11 10:38:49 -0400] dopry: err are not very usefule.
[2013-07-11 10:40:22 -0400] dopry: I feel like I'm playing battleship rather than programming trying to hunt down errors in erb templates.
[2013-07-11 10:41:51 -0400] fooJBar: dopry: I ended up re-implementing the Chef ERB renderer as a standalone app so i don't have to re-do a full run everytime I attempt to fix typos in ERBs
[2013-07-11 10:42:43 -0400] dopry: fooJBar, have you tested that with OpsWorks? I need all the JSON they're producing for me... I can get it from the cli tools...
[2013-07-11 10:43:05 -0400] \du: i agree dopry
[2013-07-11 10:43:13 -0400] fooJBar: dopry: No I have not used it with OpsWork, only chef and chef-solo
[2013-07-11 10:43:46 -0400] dopry: I'm not a strong ruby developer. I know enough to work with the templates and do basic flow control and conditionals in my recipes.
[2013-07-11 10:45:21 -0400] dopry: fooJBar, are you sharing that tool or is it something you keep in the private stash?
[2013-07-11 10:46:02 -0400] dopry: woot. I think I found the culprit.. a misplaced ] at the end of a line...
[2013-07-11 10:46:53 -0400] fooJBar: dopry: the actual code is proprietary, but its rather simple. Use the erubis gem to do the render and re-implement template partials by adding the render() method which Chef uses. The only thing you need to be careful with is to mimic how Chef is going to find the source ERBs. I can give you a code snippet if you;re interested
[2013-07-11 10:48:50 -0400] dopry: fooJBar, that would be awesome.. Anything to get away from the 2-3 cycle I'm working with now...
[2013-07-11 10:49:09 -0400] dopry: \du, oh by the way are you working with opsworks-agent-cli?
[2013-07-11 10:51:00 -0400] dopry: \du, You can use it up update cookbooks and re-run setup.. It's a lot fast than the web interface.
[2013-07-11 10:51:59 -0400] \du: dopry, i am using the web interface
[2013-07-11 10:52:03 -0400] dopry: fooJBar, my client didn't like your chat request...
[2013-07-11 10:52:12 -0400] \du: dopry, i will search
[2013-07-11 10:52:16 -0400] \du: thanks
[2013-07-11 10:52:27 -0400] dopry: \du, you can cut a minute or two out of the cycle using that command.
[2013-07-11 10:52:58 -0400] dopry: \du, sudo  opsworks-agent-cli help run_command
[2013-07-11 10:53:12 -0400] \du: i am seeing the documentation thanks
[2013-07-11 10:53:14 -0400] fooJBar: dopry: if you send me your email I'll send you the gist of what you need to do, don't want to flood this chat :)
[2013-07-11 10:54:55 -0400] dopry: is there a way to make the template resources be super verbose about their errors?
[2013-07-11 11:01:22 -0400] johndeere: I am currently hitting some issues with chef, rvm and bundle exec whatever
[2013-07-11 11:01:55 -0400] johndeere: if I log in as the specified user and manually run the command then it works, but when it is supposed to be run by chef I get an error
[2013-07-11 11:02:54 -0400] johndeere: it complains about permissions on /root/.RubyInline
[2013-07-11 11:03:04 -0400] johndeere: any ideas
[2013-07-11 11:03:54 -0400] johndeere: ?
[2013-07-11 11:29:38 -0400] \du: i am running an apt-get dist-upgrade from a recipe
[2013-07-11 11:29:54 -0400] \du: there is anyway to say Yes to everything ?
[2013-07-11 11:30:20 -0400] \du: because i am having and error here: Do you want to continue [Y/n]? Abort.STDERR:
[2013-07-11 11:30:20 -0400] \du: ---- End output of apt-get dist-upgrade ---
[2013-07-11 11:31:27 -0400] dopry: apt-get -y --force-yes
[2013-07-11 11:32:12 -0400] \du: thanks you dopry
[2013-07-11 11:34:12 -0400] dopry: johndeere, what the command you're using to run the job when logged in? What does your recipe look like that is running the job?
[2013-07-11 11:34:51 -0400] johndeere: I use rvm_shell
[2013-07-11 11:34:58 -0400] johndeere: lemme quickly make a gist
[2013-07-11 11:36:03 -0400] dopry: johndeere, warning: much like commander schultz, "I know nothing!" but will gladly take a look.
[2013-07-11 11:37:47 -0400] johndeere: https://gist.github.com/HannesBenson/5974709
[2013-07-11 11:38:55 -0400] johndeere: the bundle install part works as expected, all the gems are installed, but when it gets to assets:precompile it dies, I'm running it again now to get the full error output
[2013-07-11 11:45:26 -0400] johndeere: any thoughts dopry ?
[2013-07-11 11:47:33 -0400] dopry: whats the error?
[2013-07-11 11:47:50 -0400] johndeere: still waiting on the output, will post it as soon as I have it
[2013-07-11 11:48:57 -0400] dopry: and bundle exec rake assets:precompile works when you're node[:rails][:user]?
[2013-07-11 11:49:09 -0400] johndeere: yeah
[2013-07-11 11:49:51 -0400] dopry: with the RAILS_ENV set to {node.chef_environment}?
[2013-07-11 11:50:22 -0400] johndeere: yeah, which in this case is STAGING
[2013-07-11 11:50:39 -0400] ran_: hi
[2013-07-11 11:50:46 -0400] johndeere: hi ran_
[2013-07-11 11:51:01 -0400] ran_: I am looking for the old chef-server 10.14.4 but I cannot find it at all
[2013-07-11 11:51:12 -0400] ran_: I need that old version.. Anybody got an idea where I can get it from?
[2013-07-11 11:51:37 -0400] ran_: Apologies, but I do need the 10 old version and I have already spent hours looking around without much luck
[2013-07-11 11:52:17 -0400] dopry: johndeere, what is the 'INLINEDIR' environment variable set to?
[2013-07-11 11:53:08 -0400] johndeere: echo $INLINEDIR gives a blank string
[2013-07-11 11:53:40 -0400] dopry: I think /root/.rubyline is the default path in the gem...
[2013-07-11 11:53:56 -0400] dopry: and rake is building something with rubyinline...
[2013-07-11 11:54:24 -0400] dopry: just a guess based on https://www.ruby-forum.com/topic/210551
[2013-07-11 11:54:57 -0400] dopry: johndeere, ^^
[2013-07-11 11:55:12 -0400] johndeere: reading that now
[2013-07-11 11:55:39 -0400] johndeere: image_science needs ruby_inline
[2013-07-11 11:55:51 -0400] johndeere: so I first got the error when running it as the required user
[2013-07-11 11:56:08 -0400] dopry: did you maybe run it as root before?
[2013-07-11 11:56:09 -0400] johndeere: then solved the issue by installing libfreeimage3 and libfreeimage-dev
[2013-07-11 11:56:31 -0400] johndeere: I'll quickly check if the gem is mentioned anywhere else
[2013-07-11 11:56:38 -0400] johndeere: I'll tell you what
[2013-07-11 11:56:46 -0400] johndeere: I'll revert to a clean vm
[2013-07-11 11:56:53 -0400] johndeere: and run the whole recipe as non-root
[2013-07-11 11:57:27 -0400] johndeere: and see what pops out, hopefully that resolves it somehow :) I will check the INLINEDIR env var as well
[2013-07-11 11:57:30 -0400] johndeere: just in case
[2013-07-11 11:58:58 -0400] ran_: anybody knows where to get old versions of chef-server from?
[2013-07-11 11:59:36 -0400] johndeere: ran I'm pretty sure you can get it out of the git repo
[2013-07-11 11:59:42 -0400] johndeere: by checking out the version
[2013-07-11 11:59:49 -0400] johndeere: but that could be quite hectic
[2013-07-11 12:00:27 -0400] ran_: Oh well.... I was looking for the RPM (I am using centos..) but maybe I should try to checkout from the git
[2013-07-11 12:07:20 -0400] \du: okey, this it's something strange, if i run this recipe https://github.com/xavadu/cookboook/blob/master/php54/recipes/default.rb the first time i get this error: http://pastebin.com/RmktFb9B but if i run for second time, works
[2013-07-11 12:07:24 -0400] \du: any idea why?
[2013-07-11 12:09:07 -0400] dopry: The file it's looking for does exist until you run the process. opt/aws/opsworks/current/site-cookbooks/apt/providers/repository.rb should be checking if /var/lib/apt/periodic/update-success-stamp exists before trying to act on it.
[2013-07-11 12:09:19 -0400] dopry: err does not exist..
[2013-07-11 12:09:50 -0400] dopry:  /var/lib/apt/periodic/update-success-stamp is the last time update sucessfully run.. at least thats my guess looking at it.
[2013-07-11 12:10:12 -0400] \du: but look like a OpsWorks bug, really?
[2013-07-11 12:10:23 -0400] dopry: no looks like a bug in the recipe you're using.
[2013-07-11 12:10:24 -0400] cpasmoi: file[/etc/apt/sources.list.d/php54.list] sending delete action to file[/var/lib/apt/periodic/update-success-stamp] (immediate) ;; undefined method `run_action' for "file[/var/lib/apt/periodic/update-success-stamp]":String
[2013-07-11 12:11:26 -0400] cpasmoi: I agree, seems like you're messing up with this file
[2013-07-11 12:11:50 -0400] \du: https://github.com/xavadu/cookboook/blob/master/php54/recipes/default.rb
[2013-07-11 12:11:59 -0400] \du: this is my recipe, so simple mm.. :1
[2013-07-11 12:12:08 -0400] \du: the second time that i run, it's work okey
[2013-07-11 12:12:22 -0400] \du: without error, only the first time give me this error
[2013-07-11 12:13:24 -0400] dopry: \du, the recipe you clone into you repo form opscode is the problem it looks like.
[2013-07-11 12:13:44 -0400] \du: and the include_recipe "apt" i take it from the official opscore cookbook
[2013-07-11 12:13:50 -0400] dopry: that apt cookbook you grabbed is the issue...
[2013-07-11 12:14:04 -0400] dopry: opscore.. but what release?
[2013-07-11 12:14:25 -0400] \du: this one https://github.com/opscode-cookbooks/apt
[2013-07-11 12:14:35 -0400] dopry: and opscode recipes don't necessarily play nice with opsworks..
[2013-07-11 12:15:25 -0400] dopry: is it for version 0.9.15 ?
[2013-07-11 12:15:41 -0400] \du: oh.. but i didn't found a OpsWorks apt recipe, and if i want run my php54 recipe in the setup lifecycle i need the apt recipe, if not i had an error
[2013-07-11 12:16:10 -0400] \du: Version 2.0.0+ of this cookbook requires Chef 11.0.0 or later.
[2013-07-11 12:16:11 -0400] dopry: that doesn't mean the one your find on opscode will work.
[2013-07-11 12:16:13 -0400] \du: mm..
[2013-07-11 12:16:33 -0400] \du: yeap look like that !
[2013-07-11 12:16:38 -0400] dopry: and it doesn't mean it's compatible with the fork of chef in use on OpsWorks.
[2013-07-11 12:18:47 -0400] ran_: thanks very much johndeere
[2013-07-11 12:18:55 -0400] johndeere: yw
[2013-07-11 12:19:12 -0400] ran_: whois
[2013-07-11 12:26:52 -0400] m4rcu5: is there a way to use more levels in data bags? like plesk_plans/client_name/plane_name.json? or should i use the 2 levels and add a client: "
[2013-07-11 12:26:59 -0400] m4rcu5: in the data bag itself?
[2013-07-11 12:31:24 -0400] fooJBar: m4rcu5: I do it in the bag, never tried sub dirs in the folder. If you try it let us know
[2013-07-11 12:43:33 -0400] \du: good! i downgrade the version of apt recipe and work fine now :)
[2013-07-11 13:03:44 -0400] bigbigbang: Ohai ! if someone interested in sort of failover (+clustered stuff) with Open source Chef, please visit my blog bigbigbangblog.blogspot.com . It's still a draft, but I really hope someone of the community will help me. Thx !!
[2013-07-11 13:18:55 -0400] laurent\_: bigbigbang: i'll be trying to achieve something similar
[2013-07-11 13:20:15 -0400] bigbigbang: laurent\_:  Hey great ! You will be able to find information on my blog ! It's a working solution but still need to be improved.
[2013-07-11 13:20:39 -0400] djstunami: bigbigbang: Basically you're trying to run a hot-failover machine?  Correct me if I'm wrong, but doesn't the chef-repo on the workstation contain everything you'd need to recreate a new server config?
[2013-07-11 13:21:18 -0400] bigbigbang: laurent\_: The next thing I will try to do is to update solr to solrcloud
[2013-07-11 13:22:06 -0400] laurent\_: maybe the next thing should be to deal with config files the chef way...
[2013-07-11 13:24:47 -0400] bigbigbang: djstunami: the chef-repo on workstation only contains the cookbook ,and some certificate no ?
[2013-07-11 13:25:38 -0400] djstunami: I'm doing some googling now, and that appears to be the case, no node information it appears
[2013-07-11 13:25:39 -0400] bigbigbang: laurent\_:  what are you meaning with "the chef way ? " (i'm quite new with chef..)
[2013-07-11 13:26:38 -0400] laurent\_: why not using /etc/chef-server/chef-server.rb instead of messing with default attributes in /opt/chef-server ?
[2013-07-11 13:31:29 -0400] bigbigbang: laurent\_: I'm probably wrong but i I didn't get any rb file in etc/chef-server/ only json and certificates, I'm doing it with the default attributes because for example "how could you rename the rabbit node when it has already been created ?" I was hopping to gain installation time by doing it this way
[2013-07-11 13:31:53 -0400] laurent\_: i very doubt so
[2013-07-11 13:35:43 -0400] bigbigbang: laurent\_: anyway i'm really interesting in this project, and i'm trying to have the simplest solution so If you try some stuff, please share it ! either on your blog (if any) or on the opscode question page thanks !!
[2013-07-11 13:39:54 -0400] laurent\_: bigbigbang: i'm doing it differently, i don't want to alter any file in /opt or /var/opt directly and i'm trying to split components (psql, rabbitmq, solr) to differents vm
[2013-07-11 13:43:40 -0400] bigbigbang: laurent\_:  I'm was googling about chef-server.rb, it is approximately the same file as /var/opt/chef-server/erchef/etc/app.config  .. so will be approximately the same result .. we can't do anything with that... and by the way will you update rabbitMQ ? ( as it has a lot simplier way to deal with cluster.. I wasn't able to restore my "slave" in order to become master again without losing the configuration of the node.. ( rabbitmqc
[2013-07-11 13:43:56 -0400] laurent\_: nico: have you seen bigbang blog post, he post  something on #chef 40min ago
[2013-07-11 13:44:13 -0400] laurent\_: wrong chan
[2013-07-11 13:46:56 -0400] bigbigbang: laurent\_:  for pgsql , you can't do master/master without any tier solution ( as bucardo , pg-pool..) as I don't want to use this, I only do master/slave ... with trigger file on slave
[2013-07-11 13:47:12 -0400] nico: burgess: looks like active/active ?
[2013-07-11 13:47:28 -0400] nico: erm
[2013-07-11 13:47:34 -0400] nico: bigbigbang:
[2013-07-11 13:47:39 -0400] bigbigbang: nico: no my solution isn't active/active ..
[2013-07-11 13:47:41 -0400] laurent\_: big:  i'm already running clusters with pacemaker, so I want to use it for chef components as well
[2013-07-11 13:48:18 -0400] nico: bigbigbang: so why always hitting the master ?
[2013-07-11 13:49:23 -0400] bigbigbang: laurent\_:  all right , i don't want to use it either ( working in a regional bank as internship...) but will take a look
[2013-07-11 13:50:16 -0400] asthasr: Hi guys.  I have a situation where node.default is being used inside a recipe, in order to pull a data bag item into an attribute. We thought that we could use this pattern to allow the data bag item to be the default, but override it using override_attributes in the role.
[2013-07-11 13:50:42 -0400] \du: i am reading it http://docs.opscode.com/chef/resources.html#execute
[2013-07-11 13:50:50 -0400] asthasr: However, we're getting the "default" (i.e. data bag item) despite the existence of an overriding value in the role.
[2013-07-11 13:51:03 -0400] \du: in the #name i can put anything? if later i will declare a command attrb ?
[2013-07-11 13:51:06 -0400] asthasr: Is this intended, or are we doing something wrong?
[2013-07-11 13:52:19 -0400] nico: \du: try to keep it in mind it has to be unique; not using fancy chars is recommended imho "just in case"
[2013-07-11 13:53:32 -0400] \du: nico, i see, thanks
[2013-07-11 13:54:31 -0400] bigbigbang: nico:  Yes i'm able to work on both server , but there is still a cookbook environment problem (finded with chef-server-ctl test) on the slave .. so I prefer to hit the master as this result (chef-server-ctl test) perfectly work on it .. I got 3 problem out of 70
[2013-07-11 13:54:41 -0400] \du: and it's good practice run two o more command in one execute? per example two apt-get commands
[2013-07-11 13:54:59 -0400] nico: bigbigbang: nice
[2013-07-11 13:55:26 -0400] laurent\_: bigbigbang: ok, to be honnest you're defeating chef's purpose
[2013-07-11 13:55:40 -0400] laurent\_: bigbigbang: have you looked at http://docs.opscode.com/config_rb_chef_server.html ?
[2013-07-11 13:56:45 -0400] laurent\_: using nano to change default attributes in cookbook, using nano to change config files, using tar by hand to install another rabbitmq version, and finally using tar to synchronize all this to the other node
[2013-07-11 13:58:55 -0400] laurent\_: i know it's still draft, i just think you're doing it the wrong way :)
[2013-07-11 14:00:23 -0400] bigbigbang: laurent\_: yes that's why i'm posting here, to find the "correct" solution .. but we can do everything by using chef_server.rb ...
[2013-07-11 14:00:49 -0400] nico: yes
[2013-07-11 14:01:06 -0400] laurent\_: i guess you meant can't :)
[2013-07-11 14:01:21 -0400] nico: upgrading rabbitmq this way is ugly, that's what bugs me most
[2013-07-11 14:01:24 -0400] tplaner: hi, I just upgraded from chef 10.x to 11.x and I've managed to get all of my cookbooks working again except for one which basically just exec's a command on startup -- I get no error during vagrant up, but it just doesn't seem like the command is being executed -- if I manually vagrant ssh and exec the command it works without an issue -- how can I go about debugging this?
[2013-07-11 14:01:59 -0400] nico: tplaner: using Chef::Log.info("my message") in your recipe ?
[2013-07-11 14:05:11 -0400] tplaner: nico: I've done that and the template action is definitely being hit
[2013-07-11 14:07:44 -0400] judd7-: Does chef-client block execution of simultaneous chef-clients on the same node?
[2013-07-11 14:08:20 -0400] gkarekinian: judd7-: Yes, in Chef 11, not the previous versions though
[2013-07-11 14:08:53 -0400] judd7-: thanks gkareklinian  That's a major fail.
[2013-07-11 14:08:56 -0400] laurent\_: hmm it also works with late chef 10 as long as you mention a pid file
[2013-07-11 14:10:06 -0400] judd7-: right, a balance between daemonize and on-demand.
[2013-07-11 14:11:38 -0400] judd7-: can I set the pid in /etc/chef/client.rb ?
[2013-07-11 14:12:48 -0400] laurent\_: you mean for the on-demand runs ?
[2013-07-11 14:14:07 -0400] laurent\_: judd7-: i suddendly have a doubt, the pid file might only works with used with --daemonize
[2013-07-11 14:14:18 -0400] laurent\_: s/with/when/
[2013-07-11 14:20:59 -0400] bigbigbang: laurent\_: <laurent\_> i guess you meant can't :)  ^^
[2013-07-11 14:29:07 -0400] \du: per example if i want modify my php.ini, how i should do it with chef?
[2013-07-11 14:30:24 -0400] \du: just tell me the name of the command or and idea, i will search the rest in the documentation :)
[2013-07-11 14:31:38 -0400] bigbigbang: \du: in order to modify your php.ini, you could use a template of this file so you have to create a recipe with a template file ..
[2013-07-11 14:32:28 -0400] \du: templates! i think that only work for create new conf file, not modify want existent, i will search, thanks bigbigbang
[2013-07-11 14:36:05 -0400] bigbigbang: \du:  a bit like this https://gist.github.com/bigbigbang/5975992 , you can copy your current file and modify what's you want no ? And I m not sure it is only for creating new configuration files, as it will see the differences between the current file and the template and then add them to fit you template ..
[2013-07-11 14:36:21 -0400] dopry: \du, creating a new file with the same name is the same as modifying... If you use your current file as  template, you modifyu it then your recipe overwrites.
[2013-07-11 14:40:29 -0400] \du: okey! yes, i will have some webapp that in the deploy i will need add config to the dns server
[2013-07-11 14:41:09 -0400] d```_: \du: you might also consider using features in php.ini itself
[2013-07-11 14:41:28 -0400] d```_: like including config files in /etc/php.d
[2013-07-11 14:41:41 -0400] d```_: or vhost overrides
[2013-07-11 14:42:01 -0400] \du: ahh, i figured, thanks
[2013-07-11 15:08:09 -0400] daxroc: Do you need to add chef-client to cron or is this done in the bootstrap process?
[2013-07-11 15:08:18 -0400] \du: dopry, do you know how to use 'data bag' in OpsWorks?
[2013-07-11 15:09:38 -0400] josiah: I'm a newcomer to chef and I can't figure out how you are supposed to manage multiple node configurations
[2013-07-11 15:09:48 -0400] josiah: Are you supposed to have a repository for each node?
[2013-07-11 15:10:59 -0400] drywheat: I trying to split my cookbooks out into individual repos under a new github organization and maintain another repo for chef data. Does anyone know a good resource to learn about this?
[2013-07-11 15:11:25 -0400] \du: josiah, i am new too.. but maybe using if statement in your recipe and load diferent file configuration depending maybe the ip or hostname
[2013-07-11 15:11:47 -0400] \du: but for another part.. i thing that if you want diferent configuration in diferent node, maybe do you must use diferent cookbooks
[2013-07-11 15:12:42 -0400] josiah: so how do roles fit in then? Do they get assigned to nodes using knife?
[2013-07-11 15:12:50 -0400] mattray: daxroc: there is a chef-client cookbook (http://ckbk.it/chef-client) that may be used to configure how your chef-client behaves. By default, it does not get daemonized or setup with cron
[2013-07-11 15:13:04 -0400] \du: drywheat, i believe that you can use only one repository for everythiong
[2013-07-11 15:13:18 -0400] mattray: drywheat: learnchef.com is a great way to learn the basics
[2013-07-11 15:13:25 -0400] \du: josiah, to much for me :P i am new :)
[2013-07-11 15:15:12 -0400] zaargy: josiah: you typically assign roles when you do your first chef run. when you provision you typically write a json file with a first run list.
[2013-07-11 15:15:25 -0400] zaargy: you then run chef client agains tthat file with the run list and that is how your machine works out what role it is
[2013-07-11 15:15:29 -0400] zaargy: if that makes sense
[2013-07-11 15:15:55 -0400] zaargy: or you can assign with knife, yup
[2013-07-11 15:19:09 -0400] zaargy: with the caveat that you could only assign with knife after the node has first registered with the chef server
[2013-07-11 15:20:20 -0400] josiah: zaargy, cool - so I keep all my recipes and roles in one source repository and then use knife to manage the roles of servers
[2013-07-11 15:20:58 -0400] zaargy: your provisioner should manage the roles of servers ideally
[2013-07-11 15:21:08 -0400] zaargy: as for one repository, well that is a open question
[2013-07-11 15:21:13 -0400] zaargy: there are several approaches
[2013-07-11 15:21:20 -0400] josiah: i see
[2013-07-11 15:21:26 -0400] zaargy: it is becoming common to have separate repositories for cookbooks
[2013-07-11 15:21:33 -0400] zaargy: look up berkshelf if you want to see more
[2013-07-11 15:21:53 -0400] zaargy: but the 'traditional' way is to have everything in one repo
[2013-07-11 15:21:59 -0400] josiah: I'm using berkshelf (for cookbook & dependency management)
[2013-07-11 15:22:39 -0400] josiah: I'm trying to figure out how to structure my specific node configuration: e.g. node1 is a web server which has apache etc. installed and these 7 websites
[2013-07-11 15:23:13 -0400] zaargy: so you would have an application cookbook for that 'kind' of webserver
[2013-07-11 15:23:40 -0400] blud: ultimately the groups or roles or cookbooks you apply to a node determine what it is, the designation of it's name should mean very little.
[2013-07-11 15:23:52 -0400] zaargy: yep
[2013-07-11 15:25:08 -0400] josiah: the main point i'm struggling with is the "7 websites" part - configuration which is very specific to the node
[2013-07-11 15:25:16 -0400] blud: typically, making things as modular as possible is the best approach. You may want to have 7 different cookbooks for 7 different websites, in case one or two, or 6 of those websites need to be moved to more/different hosts
[2013-07-11 15:25:27 -0400] josiah: I see
[2013-07-11 15:25:35 -0400] dopry: \du, I haven't used them much. I focus on chef solo for my uses.. I'm not a big fan of having a server when I have tools like fabric, capistrano, salt stack, ansible, etc...
[2013-07-11 15:25:42 -0400] josiah: each website instance should be defined as a cookbook
[2013-07-11 15:26:02 -0400] josiah: then it can be moved from server to server using roles or node definitions
[2013-07-11 15:26:16 -0400] dopry: \du, so I don't use databag alot,
[2013-07-11 15:26:39 -0400] zaargy: think it depends what you mean by website etc but yes...maybe :)
[2013-07-11 15:26:50 -0400] blud: or databags ^, but yeah that's generally the idea
[2013-07-11 15:27:02 -0400] josiah: I have a web application which gets deployed for multiple clients
[2013-07-11 15:27:16 -0400] josiah: Each client has up to 4 environments (dev through prod)
[2013-07-11 15:27:46 -0400] josiah: Each environment is accessable through different urls etc but will have essentially the same configuration
[2013-07-11 15:27:58 -0400] josiah: actual deployment of the application is managed by another service (deployhq)
[2013-07-11 15:27:58 -0400] \du: okey, np thanks dopry
[2013-07-11 15:28:36 -0400] blud: so, one possible way for that is a cookbook per client, with recipes per environment, which also reference the service cookbooks required for that environment to run
[2013-07-11 15:28:40 -0400] josiah: so a 'website' for me is a specific client's environment which has different user accounts, databases and credentials
[2013-07-11 15:28:48 -0400] josiah: ok
[2013-07-11 15:29:20 -0400] josiah: and keep it dry by including other recipes from the per environment recipes
[2013-07-11 15:31:13 -0400] blud: typically though, cookbooks are application specific, so there will be one for apache, or nginx, or mysql, and the configuration can either be added to those (not really recommended), using databags (recommended), or seperate configuration cookbooks (easiest for implimentation, while maintaining community cookbooks for software)
[2013-07-11 15:32:22 -0400] blud: but really, the trick is making it so you aren't going to be constrained in the future when something needs to move/change.
[2013-07-11 15:37:33 -0400] josiah: blud, thanks makes sense to me
[2013-07-11 15:39:58 -0400] \du: any idea because with some recipe i get this error: FATAL: Failed to read the private key /etc/chef/client.pem ?
[2013-07-11 15:40:21 -0400] \du: this file doesn't exists in my system, but with other recipes work good
[2013-07-11 15:40:41 -0400] \du: but not with this, per example: https://github.com/xavadu/cookboook/blob/master/bind9/recipes/default.rb
[2013-07-11 15:40:49 -0400] drywheat: is it correct to pair attribute/recipe file names? i.e. server recipe uses server.rb attribute file
[2013-07-11 15:40:55 -0400] \du: i didn't see that be doing something diferent to need the .pem file
[2013-07-11 15:41:06 -0400] drywheat: or can I just use attributes/default.rb ?
[2013-07-11 15:41:56 -0400] \du: drywheat, https://github.com/xavadu/cookboook/blob/master/bind9/attributes/default.rb i think that default will be accesible in all the recipes
[2013-07-11 15:42:14 -0400] \du: drywheat, but if you want create an attributes file for only one recipes, i didnt have idea :P
[2013-07-11 15:42:39 -0400] drywheat: \du: thanks
[2013-07-11 15:43:12 -0400] \du: drywheat, you are welcome, and take it with " ", i am new just, i am not sure
[2013-07-11 15:43:51 -0400] \du: drywheat, maybe it help http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-07-11 15:44:08 -0400] drywheat: \du: yeah. i know default.rb is available for everyone, but i wonder if the attr file server.rb would only be available to the server.rb recipe.
[2013-07-11 15:44:12 -0400] drywheat: dunno
[2013-07-11 15:50:58 -0400] josiah: could I use a databag with search to pull out a list of web apps tagged with the servers FQDN?
[2013-07-11 16:04:38 -0400] dopry: Any freelancers around handy with both OpsWorks and chef and have availability over the next two weeks?
[2013-07-11 16:05:55 -0400] lead_ball: gah, I am writing a recipe with a deploy from a git repo.  I am setting "symlink_before_migrate nil" in the deploy, but still it fails on the target machine with file not found for .../shared/config/yml
[2013-07-11 16:06:15 -0400] lead_ball: shared/config/database.yml that is.  Anyone with any ideas?
[2013-07-11 16:11:36 -0400] Kzim: is there anyway to specify a version in the include_recipe and not the depends ?
[2013-07-11 16:20:29 -0400] lead_ball: huh, interesting, the docs on http://docs.opscode.com/resource_deploy.html need to be updated.
[2013-07-11 16:20:40 -0400] lead_ball: " Use symlink_before_migrate({}) or symlink_before_migrate nil instead of symlink_before_migrate {} because {} will be interpreted as a block rather than an empty hash."
[2013-07-11 16:21:10 -0400] lead_ball: symlink_before_migrate({}) works, but symlink_before_migrate nil does not, it goes back to defaults if you do this
[2013-07-11 16:23:30 -0400] btorch: new to chef here.. I have updated my environment with a new attribute to be overridden but when I run the chef-client on the node nothing happens
[2013-07-11 16:24:30 -0400] glen: hey, why is knife role sending request to http:// address even i do have https everywhere else
[2013-07-11 16:25:16 -0400] glen: more annoying is that it SHOWS that it's sending to https:// while internally it does not! --
[2013-07-11 16:25:19 -0400] glen: ERROR: Server returned error for https://chef-server/roles/base_pld2, retrying 1/5 in 3s
[2013-07-11 16:25:35 -0400] behemphi: @btorch when you say updated your environment, do you mean you set a attr in a chef_environment?
[2013-07-11 16:26:51 -0400] simon__: Hello, what is the prefered way to figure out that you are running inside vagrant in a chef run?
[2013-07-11 16:26:59 -0400] simon__: Right now I check the chef_environment, if its not production then I assume that I am running in Vagrant, which ofc is rather hackish.
[2013-07-11 16:29:49 -0400] donaldguy: Hello. I have a silly problem. I have root on the chef server (private chef), but I don't have a user account in the org. Or rather I didn't. Using orgmapper I successfully associated user with the org to some degree, but I can't seem to get it to be part of the admins group. Mixlib::Authorization::Models::Organization#add_user_to_group seems to have no effect :-(. Any other way to override this without just editing the DB manual
[2013-07-11 16:44:47 -0400] rava: hey all,is it recommended to use the apt packages over the gem packages for installing chef-server 10.x?
[2013-07-11 16:52:17 -0400] glen: i have problem that bootstrap gives error with some json and encode
[2013-07-11 16:52:17 -0400] glen: dopey [2013-07-11T19:51:52+03:00] ERROR: Report handler Chef::Handler::ErrorReport raised #<Encoding::InvalidByteSequenceError: "\xE4" on US-ASCII>
[2013-07-11 16:52:29 -0400] glen: dopey [2013-07-11T19:51:52+03:00] ERROR: /usr/share/ruby/vendor_ruby/1.9/chef/node.rb:386:in `encode'
[2013-07-11 16:53:23 -0400] glen: and that data seems to came from GECOS fields
[2013-07-11 16:56:31 -0400] fish_: I like to create a provider and inherit from file_resource: is there any documentation around that?
[2013-07-11 16:57:01 -0400] glen: http://sprunge.us/ZUNd
[2013-07-11 17:09:44 -0400] slillibridge: Is there any documentation about the statsd data that the erchef process can emit?
[2013-07-11 17:12:24 -0400] lead_ball: btw, anyone know who i contact to correct an error in documentation?
[2013-07-11 17:12:44 -0400] ggolin: hello
[2013-07-11 17:12:57 -0400] lead_ball: hello back
[2013-07-11 17:13:09 -0400] _Spike__: Dave's not here, man.
[2013-07-11 17:14:06 -0400] gchristensen: _Spike__++
[2013-07-11 17:15:43 -0400] lead_ball: rava looking back, i don't know what is recommended, but I was having too much trouble with any gem or package version and just downloaded from v11 from the opscode site
[2013-07-11 17:15:59 -0400] coderanger: lead_ball: File a bug on Jira :-)
[2013-07-11 17:16:15 -0400] lead_ball: coderanger, thanks
[2013-07-11 17:16:47 -0400] behemphi: @lead_ball it is possible to do a pull request on the doc too if you know your way around sphinx
[2013-07-11 17:16:56 -0400] ggolin: how does a shef -z run differ from an actual run when it comes to search results? im seeing different search results.
[2013-07-11 17:18:25 -0400] CaptainQuirk: Hi !
[2013-07-11 17:19:02 -0400] CaptainQuirk: I'm using chef-solo. In one of my cookbooks, I'm attempting to chmod +x a particular file with the script resource
[2013-07-11 17:19:09 -0400] CaptainQuirk: It fails miserably
[2013-07-11 17:19:17 -0400] CaptainQuirk: I'm running chef-solo as a sudo user
[2013-07-11 17:19:53 -0400] behemphi: @CaptainQuirk why are you chmoding the file rather than using the file resource?
[2013-07-11 17:20:03 -0400] CaptainQuirk: behemphi, the file already exists
[2013-07-11 17:20:04 -0400] CaptainQuirk: https://github.com/CaptainQuirk/.oh-my-chef/blob/master/cookbooks/configuration/gitglobal/recipes/default.rb
[2013-07-11 17:20:15 -0400] lead_ball: behemphi, I don't... yet.  but considering i just started learning chef monday, I'd say i'm doing okay
[2013-07-11 17:20:55 -0400] behemphi: happy Cheffing @lead_ball.  Welcome to the party!
[2013-07-11 17:20:56 -0400] ggolin: never mind.
[2013-07-11 17:22:43 -0400] CaptainQuirk: I tried with chmod +x before using 755 litteral
[2013-07-11 17:23:04 -0400] CaptainQuirk: with same result
[2013-07-11 17:23:04 -0400] behemphi: @CaptainQuirk can you attach the error your getting to the gist?
[2013-07-11 17:23:21 -0400] CaptainQuirk: I'm not getting any error from chef
[2013-07-11 17:23:32 -0400] CaptainQuirk: it's just that the file isn't made executable
[2013-07-11 17:23:50 -0400] CaptainQuirk: I get  fatal : cannot exec git-subtree permission denied 
[2013-07-11 17:23:55 -0400] CaptainQuirk: when trying to launch the command
[2013-07-11 17:24:07 -0400] behemphi: sorry to ask, but does that file exist where you think it does
[2013-07-11 17:26:03 -0400] CaptainQuirk: behemphi, don't be
[2013-07-11 17:26:14 -0400] CaptainQuirk: well, unless I'm blind, yes it is
[2013-07-11 17:26:29 -0400] behemphi: damn I even had my fingers crossed on that one
[2013-07-11 17:27:00 -0400] behemphi: So the next question would be is the file there before the bash resource runs
[2013-07-11 17:27:15 -0400] CaptainQuirk: Yes, it's installed with git from the start
[2013-07-11 17:27:16 -0400] behemphi: again, sorry for the baics, but its all I got
[2013-07-11 17:27:27 -0400] behemphi: phooey, I am out of ideas
[2013-07-11 17:27:33 -0400] CaptainQuirk: I install git outside of chef
[2013-07-11 17:28:20 -0400] CaptainQuirk: man, don't you think I'm mixing the command resource with the code one ... ?
[2013-07-11 17:29:05 -0400] behemphi: ah damn
[2013-07-11 17:29:24 -0400] behemphi: that might do it
[2013-07-11 17:29:55 -0400] behemphi: < feels like he failed a quiz
[2013-07-11 17:31:21 -0400] CaptainQuirk: behemphi, looks like it's rolling now
[2013-07-11 17:31:23 -0400] CaptainQuirk: that's great
[2013-07-11 17:31:30 -0400] CaptainQuirk: By the way, how do you test cookbooks
[2013-07-11 17:35:33 -0400] kallistec: Hey everyone, updated 11.6 RC: https://gist.github.com/danielsdeleo/5976964 Give it a shot if you can
[2013-07-11 17:37:10 -0400] wdpro_kevin: ohai chefs
[2013-07-11 17:39:25 -0400] wdpro_kevin: anyone know the syntax (or if it is possible) in the Berksfile to access dependent cookbooks (and version) from a chef server?
[2013-07-11 17:40:14 -0400] wdpro_kevin: I've seen :git with urls used and :path but how about a chef server?
[2013-07-11 17:42:09 -0400] gansbrest: hi. How can I access files or templates folder from the cookbook using ruby to recursively copy files using template recourse ( so I could track changes and notify services on change)
[2013-07-11 17:43:38 -0400] CaptainQuirk: gansbrest
[2013-07-11 17:44:05 -0400] CaptainQuirk: you would like to hook inside the process ?
[2013-07-11 17:45:27 -0400] gansbrest: sort of, I need to replace the same logic template or file recourse uses to choose correct subfolder ( default, debian etc ), basically I need starting point path so I could read directory do things with files in it
[2013-07-11 17:49:03 -0400] behemphi: @CaptainQuirk we are using TestKitchen right now and it is great
[2013-07-11 17:49:13 -0400] behemphi: the bats test are seriously easy to bang out
[2013-07-11 17:49:23 -0400] coderanger: gansbrest: Use a remote_directory resource to copy a whole dir out of the cookbook
[2013-07-11 17:49:44 -0400] gansbrest: yes, I could do that, but I'm not sure if file changes will be tracked
[2013-07-11 17:50:42 -0400] jfoy: all: has anyone seen bad behavior out of /environments/ENV/cookbook-versions when one of the cookbooks has a dependency that can't be resolved in the ENV environment?
[2013-07-11 17:51:10 -0400] gansbrest: by default it uses :create action (always recreate the folder), so it will always notify other resources ( restart nginx for example very time chef-client runs - which is not ideal )
[2013-07-11 17:51:54 -0400] jfoy: before we tracked down the bad dependency, we saw our erchef process go to 700% utilization until we bounced the server
[2013-07-11 17:51:59 -0400] jfoy: (cpu utilization)
[2013-07-11 17:52:41 -0400] coderanger: gansbrest: Ahh, not a great solution for that case, you would have to poke the Chef API from inside the recipe code to get the list of files and then do stuff with them
[2013-07-11 17:52:56 -0400] coderanger: jfoy: Yep, we see it unfortunately often
[2013-07-11 17:53:15 -0400] gansbrest: yes, that's what I'm trying to find.. Is there a link to that API so I could see the list of methods?
[2013-07-11 17:53:17 -0400] coderanger: jfoy: The erchef team is quite literally working on nothing else right now :-(
[2013-07-11 17:53:38 -0400] coderanger: gansbrest: http://docs.opscode.com/api_chef_server_cookbooks_version.html
[2013-07-11 17:53:53 -0400] jfoy: coderanger: ok, thanks :-( Do you have a link to the ticket?
[2013-07-11 17:54:15 -0400] coderanger: jfoy: Just certain edge cases in the dependency solver that go crazy non-linear, at heart the dep computation is an NP complete problem (technically anyway)
[2013-07-11 17:54:32 -0400] coderanger: jfoy: The one I know is on our internal Jira, not sure if there is an external one
[2013-07-11 17:54:50 -0400] gansbrest: thanks
[2013-07-11 17:57:38 -0400] jfoy: coderanger: has this behavior been in erchef all along?
[2013-07-11 17:59:12 -0400] coderanger: jfoy: The details have changed over time I think, I know the fixed a few of the more obvious non-linear cases, but I don't know the details of the current work
[2013-07-11 18:18:08 -0400] akahn: I'm trying to install a gem using gem_package, but when chef-client runs, it fails because of "" being specified as the version. anyone know how to fix this? https://gist.github.com/akahn/3648de72d825b46258fb
[2013-07-11 18:23:05 -0400] coderanger: akahn: Is that against an internal gem server or something?
[2013-07-11 18:26:55 -0400] travisstaton: Is there a command to force chef-client to re-retrieve a cookbook from the chef-server?
[2013-07-11 18:27:22 -0400] coderanger: akahn: You probably need to pass in the gem source info so chef can find the correct verison, that gem doesn't exist on the public servers so I presume its internal
[2013-07-11 18:27:33 -0400] coderanger: travisstaton: chef-client sync's before each run
[2013-07-11 18:28:00 -0400] akahn: coderanger: I have two gem sources in my gemrc. if I run "gem install paperless-deployer" it installs from my gem server (which is first in gemrc, before rubygems).
[2013-07-11 18:28:22 -0400] coderanger: akahn: Yes, but chef doesn't know about that, so the commands probably are coming out wrong
[2013-07-11 18:28:32 -0400] coderanger: akahn: read over :-)
[2013-07-11 18:28:37 -0400] coderanger: https://github.com/opscode/chef/blob/master/lib/chef/provider/package/rubygems.rb
[2013-07-11 18:29:41 -0400] akahn: coderanger: so it's running some commands to check if the gem exists before running the install command I'm seeing?
[2013-07-11 18:29:59 -0400] akahn: I do see this above what I pasted -- [2013-07-11T14:15:03-04:00] WARN:  failed to find gem paperless-deployer (>= 0) from [http://rubygems.org/]
[2013-07-11 18:30:11 -0400] coderanger: akahn: It need to get the candidate version to know if it should install anything
[2013-07-11 18:30:15 -0400] coderanger: That part is failing
[2013-07-11 18:30:33 -0400] akahn: why doesn't that respect my system's gem sources?
[2013-07-11 18:33:01 -0400] coderanger: akahn: Basically it tries to do stuff directly via the Gem API, instead of shelling out where possible
[2013-07-11 18:33:23 -0400] coderanger: You can pass additional gem sources to the resource via #sources
[2013-07-11 18:33:47 -0400] akahn: ok. I'll work around that behavior by specifying sources
[2013-07-11 18:34:08 -0400] djstunami: Ugh, I just upgraded my chef-client on my Solaris 5.10 box and now it's started doing this: "cannot determine user id for 'chef_server', does the user exist on this system".
[2013-07-11 18:34:26 -0400] akahn: coderanger: do you think it's a bug that when a gem isn't found, rather than erroring there, chef client continues but issues an invalid gem install command?
[2013-07-11 18:34:31 -0400] djstunami: *chef-client cookbook
[2013-07-11 18:35:19 -0400] coderanger: akahn: It should probably just leave off the -v option or something, or die
[2013-07-11 18:35:25 -0400] djstunami: It appears that the fix for http://tickets.opscode.com/browse/COOK-2607 has broken this in Solaris, anyone have any experience with this?
[2013-07-11 18:35:28 -0400] coderanger: akahn: I would put in a ticket if there isn't one already
[2013-07-11 18:35:39 -0400] akahn: coderanger: yes. in fact, if the -v wasn't there, I would get my desired behavior
[2013-07-11 18:36:03 -0400] coderanger: akahn: Yeah, though that can lead to non-idempotent behavior, so at least dying with a clearer error would be a start
[2013-07-11 18:40:00 -0400] jgood: Hey, say i wanted to pull the value of my plugin_path for ohai in a recipe, how would i do this? is it node.ohai[plugin_path] ?
[2013-07-11 18:43:27 -0400] sthon: Does anyone know what version of chef server hosted chef is currently using?
[2013-07-11 18:48:06 -0400] coderanger: sthon: It doesn't have a version number
[2013-07-11 18:48:15 -0400] douglaswth: sthon: http://www.opscode.com/blog/2013/06/27/erchef-comes-to-hosted-chef/
[2013-07-11 18:48:24 -0400] coderanger: Hosted Chef is more or less continually updated
[2013-07-11 18:49:04 -0400] sthon: coderanger: more or less? So it's essentially chef 11/erchef now?
[2013-07-11 18:49:27 -0400] coderanger: Yes, it has been running erchef since long before chef 11 was a thing
[2013-07-11 18:50:38 -0400] coderanger: While it is not at all helpful, I can say it is running oc_erchef version 0.21.8 :-)
[2013-07-11 18:51:19 -0400] sthon: thanks.
[2013-07-11 19:05:25 -0400] avleen: anyone using the `ark` cookbook find that it repeatedly reinstalls stuff on every run?
[2013-07-11 19:14:49 -0400] sethvargo: Hey all! Our first KNIFE plugin review is today: https://plus.google.com/hangouts/_/97ce4ae1c02a50011d0e17aa262873bc7ec7ce6e. It join-only for today, but we will add viewing support next week :)
[2013-07-11 19:17:32 -0400] pigmalionstudios: Hi, I'm having a problem trying to install knife-ec2 using a chef recipe when creating an ec2 server, does anybody can help me a bit on that?
[2013-07-11 19:26:25 -0400] sthon: pigmalionstudios: what problem are you having? Any error messages? I ended up using http://rvm.io to get knife ec2 working.
[2013-07-11 19:27:35 -0400] pigmalionstudios: Hi @sthon. Yes, after all the installation seems to be just fine, I connect to the server over ssh and when I try to use any knife command I get:
[2013-07-11 19:27:46 -0400] pigmalionstudios: from /opt/chef/embedded/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'
[2013-07-11 19:27:56 -0400] pigmalionstudios: from /opt/chef/embedded/lib/ruby/site_ruby/1.9.1/rubygems.rb:1231:in `gem'
[2013-07-11 19:27:57 -0400] pigmalionstudios: from /usr/bin/knife:22:in `<main>'
[2013-07-11 19:28:38 -0400] pigmalionstudios: It's hard to read it here with no indentation
[2013-07-11 19:28:54 -0400] pigmalionstudios: the core of the error is:
[2013-07-11 19:29:16 -0400] pigmalionstudios: ... dependency.rb:247:in `to_specs': Could not find chef (>= 0) amongst [bigdecimal-1.1.0 ... etc
[2013-07-11 19:30:15 -0400] jtimberman: avleen: convergent deployment of non-package artifacts is hard :)
[2013-07-11 19:30:36 -0400] jtimberman: avleen: can you summarize the behavior you're seeing and file a COOK ticket for the 'ark' component?
[2013-07-11 19:34:01 -0400] chris613: Are there any stories out there about how to manage multiple chef servers? (for HA or datacenter-local bandwidth considerations, etc). I can automate keeping the cookbooks in sync, but what about node list? There are probably other complications too
[2013-07-11 19:39:00 -0400] ignatz: Hey folks. How do I modify client.rb so that ohai/the client uses hostname instead of fqdn to set the node name? I can't seem to get the syntax right.
[2013-07-11 19:51:32 -0400] akahn: coderanger: looks like there is an existing ticket http://tickets.opscode.com/browse/CHEF-3912
[2013-07-11 19:52:33 -0400] coderanger: akahn: Might be good to just comment with your use case since it isn't mentioned there
[2013-07-11 19:53:18 -0400] akahn: ya
[2013-07-11 19:57:45 -0400] lead_ball: so does anyone know of any tutorials past the basic install and bootstrap a simple example
[2013-07-11 19:58:39 -0400] lead_ball: i have been learning more and more of writing my own recipes but I have yet to find any good tutorials on things like environments or more advanced configs other than looking up docs on each thing and playing until i break it
[2013-07-11 19:58:58 -0400] coderanger: lead_ball: learnchef.com has a few
[2013-07-11 20:07:34 -0400] runnyspot: is there a way to have recipe run as a different user?
[2013-07-11 20:08:30 -0400] pigmalionstudios: Hi, a question: how do I change the installation of chef in the just created client to be with a specific user and not sudo?
[2013-07-11 20:09:41 -0400] coderanger: runnyspot: No, recipes are just ruby code
[2013-07-11 20:09:58 -0400] coderanger: runnyspot: Anything that runs a subcommand in Chef accepts a user and group argument though
[2013-07-11 20:10:48 -0400] coderanger: pigmalionstudios: You will have to handle the install yourself, we distribute chef as deb/rpm/etc packages which generally require root access to install
[2013-07-11 20:11:06 -0400] coderanger: pigmalionstudios: You should be able to use rpm or dpkg manually to handle it though
[2013-07-11 20:11:18 -0400] runnyspot: thanks coderanger
[2013-07-11 20:13:07 -0400] pigmalionstudios: coderanger: ok, thanks. so, changing the question: how can I run chef in the client as ubuntu user and not root (since if I run e.g. chef-client -v as root it works fine, but I get an error running it as ubuntu)
[2013-07-11 20:14:00 -0400] coderanger: pigmalionstudios: Assuming you installed via normal means, the /etc/chef/client.pem key file would have been created as root/root/0600, so you would need to chown that file
[2013-07-11 20:14:13 -0400] coderanger: Other than that it should work, obviously many features of chef won't work though
[2013-07-11 20:14:44 -0400] pigmalionstudios: coderanger: basically what I want to do is to be able to run a knife-ec2 command in a server that I create automatically through chef.
[2013-07-11 20:15:07 -0400] coderanger: pigmalionstudios: just use knife ec2 server create -x ubuntu --sudo ...
[2013-07-11 20:15:33 -0400] coderanger: -x sets the user the bootstrap processes SSHes as, and on the default images the ubuntu user has sudo nopasswd
[2013-07-11 20:15:45 -0400] pigmalionstudios: but the server doesn't have knife ec2 plugin installed from scratch
[2013-07-11 20:16:02 -0400] pigmalionstudios: so I'm having some issues trying to install it and configure it
[2013-07-11 20:16:04 -0400] coderanger: Not sure what you mean, knife ec2 is something you run on your workstation
[2013-07-11 20:17:11 -0400] pigmalionstudios: coderanger: yes, I do that without any problem, but I need to create a different server from the server I have created through chef. Not sure if I am being clear.
[2013-07-11 20:17:33 -0400] coderanger: That is not generally how chef is used
[2013-07-11 20:17:41 -0400] coderanger: knife is always a workstation tool
[2013-07-11 20:17:51 -0400] coderanger: Unless you want to configure an EC2 VM as your workstation
[2013-07-11 20:18:05 -0400] pigmalionstudios: but what if I need that server to be created automatically? is that possible?
[2013-07-11 20:18:34 -0400] pigmalionstudios: (running the knife ec2 server create... automatically through a script or whatever)
[2013-07-11 20:19:05 -0400] coderanger: That is not within the scope of knife ec2
[2013-07-11 20:19:19 -0400] coderanger: I would recommend using something like Amazon's AutoScaling Groups
[2013-07-11 20:19:31 -0400] coderanger: or provisioning management tool
[2013-07-11 20:19:33 -0400] pigmalionstudios: Hm, ok. Anyways I think I am pretty close to make it.
[2013-07-11 20:19:52 -0400] coderanger: You can get close, but really ASGs are the tool for the job if you are already on EC2
[2013-07-11 20:20:01 -0400] pigmalionstudios: I will take a look at that, but it is not autoscaling what I need
[2013-07-11 20:20:25 -0400] pigmalionstudios: I just need a server to be up just for one particular task, and then go down.
[2013-07-11 20:20:26 -0400] coderanger: ASGs are just how you manage automatically spinning up new boxes via an API
[2013-07-11 20:20:37 -0400] pigmalionstudios: Ok, great, thanks for the tip
[2013-07-11 20:20:56 -0400] pigmalionstudios: is any way to have ASGs and chef working together?
[2013-07-11 20:21:25 -0400] coderanger: Yep, there are lots of guides to building an AMI with your validation key and chef config baked in
[2013-07-11 20:21:25 -0400] akahn: coderanger: were you saying that using the rubygems CLI would potentially break idempotency, or that respecting gemrc configuration files would?
[2013-07-11 20:21:31 -0400] pigmalionstudios: since I have created a role that has the server configuration working
[2013-07-11 20:21:44 -0400] coderanger: akahn: Just that chef blindly running gem install without any version specifier
[2013-07-11 20:21:53 -0400] coderanger: akahn: Since it won't know if things needed to be upgraded
[2013-07-11 20:22:06 -0400] pigmalionstudios: coderanger: thanks
[2013-07-11 20:22:22 -0400] akahn: can you explain? running gem install twice results in the same system state
[2013-07-11 20:22:38 -0400] coderanger: akahn: Chef notifications require that Chef knows when things changes and how
[2013-07-11 20:22:49 -0400] coderanger: External idempotence isn't enough
[2013-07-11 20:23:10 -0400] irnnr: hi there
[2013-07-11 20:23:54 -0400] irnnr: was looking to create a relative symlink using link, however couldn't find anything so far. Any hints?
[2013-07-11 20:24:13 -0400] akahn: coderanger: so to go back to the original question, the gem_package resource uses the rubygems ruby API so that it knows more about what's going on with the install, upgrade, etc.
[2013-07-11 20:25:29 -0400] akahn: is that right?
[2013-07-11 20:25:40 -0400] coderanger: irnnr: link 'some name' do target_file '../foo' to '/bar' end
[2013-07-11 20:25:53 -0400] coderanger: akahn: Yes, it introspects stuff from the API like version data
[2013-07-11 20:26:23 -0400] akahn: so you have nothing against respecting gemrc files, it's just that the rubygems ruby API doesn't respect it (e.g. Gem.sources returns rubygems only, no matter what your gemrc says). would you accept a patch to make the gem_package resource respect gemrc?
[2013-07-11 20:26:29 -0400] irnnr: coderanger, ok so far so good, that seems quite obvious. However, how do I know which directory this will happen in?
[2013-07-11 20:26:51 -0400] coderanger: irnnr: Not sure what you mean, that isn't relevant
[2013-07-11 20:27:03 -0400] coderanger: irnnr: relative symlinks are actually just written as relative
[2013-07-11 20:28:17 -0400] coderanger: akahn: Yeah, the rubygems package provider would have to check for a gemrc and load that
[2013-07-11 20:28:17 -0400] irnnr: coderanger: but whether they work will depend on being in the right directory when creating them (?)
[2013-07-11 20:28:52 -0400] coderanger: irnnr: I mean its relative to the actual inode, which is the file specified by #to
[2013-07-11 20:29:27 -0400] akahn: coderanger: cool. i'll look into that. I was looking through the rubygems source but didn't yet find where, when invoking a gem command, the gemrc files are read. once I find that I can try to make that provider do the same
[2013-07-11 20:29:28 -0400] irnnr: ah ok, that might help, will try. thx!
[2013-07-11 20:30:53 -0400] ignatz: I think I got it on my Windows setup. Powershell add-content "`nnode_name `"$env:computername`"`n" -Path c:\chef\client.rb
[2013-07-11 20:32:01 -0400] ignatz: I rename the computer, do that, run chef-client for the first time, and then reboot.
[2013-07-11 20:34:20 -0400] irnnr: coderanger: thanks a lot, that helped a lot. It works and was a lot simpler than I though probably been thinking too complicated
[2013-07-11 20:35:09 -0400] coderanger: irnnr: Its a bit complex since bash likes to pretend that the -s option to ln is a normal path when it isn't at all, just a path-like string
[2013-07-11 20:37:12 -0400] ignatz: https://gist.github.com/gl-conradheiney/5979011 for anyone with similar EC2 Windows Fun
[2013-07-11 20:50:43 -0400] ignatz: oh awesome I screwed that up too :D
[2013-07-11 20:53:16 -0400] ignatz: I still have to hardcode the node name because it hasn't restarted yet.
[2013-07-11 20:53:22 -0400] ignatz: Hope I'm entertaining all.
[2013-07-11 21:01:46 -0400] matti: Guys, can "block" in Ruby block be defined multiple times with its own {not,only}_if?
[2013-07-11 21:05:29 -0400] kallistec: matti: you want multiple ruby blocks sharing a single not/only_if ?
[2013-07-11 21:05:49 -0400] coderanger: matti: That sounds like you just want multiple ruby_block resources
[2013-07-11 21:06:12 -0400] matti: I know ;p
[2013-07-11 21:06:23 -0400] matti: I was just curious :)
[2013-07-11 21:06:25 -0400] matti: Thanks!
[2013-07-11 21:08:10 -0400] Majost1: I am confused about something... According to this code the encrypted_data_bag_secret file is uploaded automatically  https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-07-11 21:08:49 -0400] Majost1: however, I am perhaps incorrectly assuming this template is always used for omnibus installs without me having dropped it into my .chef/bootstrap/ directory
[2013-07-11 21:15:58 -0400] inimit: if I type ruby -v I see 1.9.3, but when the chef-client runs, it seems to be using the system ruby. Any ideas to ensure it uses the rbenv ruby instead of system?
[2013-07-11 21:16:55 -0400] coderanger: inimit: Assuming you installed via our omnibus packages (which are the only recommended way to install) chef ships its own Ruby
[2013-07-11 21:17:25 -0400] inimit: coderanger: I'm using the bootstrap for ubuntu 12
[2013-07-11 21:17:30 -0400] inimit: via gems
[2013-07-11 21:17:57 -0400] coderanger: inimit: Don't :)
[2013-07-11 21:18:21 -0400] inimit: I see.. how would you recommend I bootstrap the server then?
[2013-07-11 21:18:45 -0400] coderanger: the default is to use omnibus, the template is called chef-full if you want to specify one
[2013-07-11 21:19:04 -0400] coderanger: but just leave off that option entirely if you have chef >=11 on your workstation
[2013-07-11 21:20:10 -0400] inimit: ok thx, lemme give that a shot
[2013-07-11 21:26:30 -0400] tplaner: bit of a workflow question, I notice that people typically track cookbooks as git submodules within a project, however isn't the point to lock in a server config in order to make environments consistent?
[2013-07-11 21:26:53 -0400] coderanger: tplaner: I would say that using submodules is far from common
[2013-07-11 21:26:58 -0400] coderanger: I don't actually know anyone doing that
[2013-07-11 21:27:16 -0400] coderanger: berkshelf is the usual way to manage things like that
[2013-07-11 21:28:35 -0400] tplaner: yeah I was looking into berkshelf, but maybe it is just my rudimentary knowledge of chef, but is it possible to bundle berkshelf within a vagrant box similar to how you bundle chef? I couldn't find a lot of documentation about it
[2013-07-11 21:29:52 -0400] adnichols: tplaner there's a vagrant plugin for berkshelf
[2013-07-11 21:30:03 -0400] tplaner: oh, excellent
[2013-07-11 21:31:50 -0400] tplaner: is berkshelf preferred over librarian-chef?
[2013-07-11 21:32:57 -0400] adnichols: tplaner I know of a number of folks who have moved from librarian-chef to berkshelf, don't know of many going the other way - but it kinda depends on your workflow I think
[2013-07-11 21:33:28 -0400] adnichols: we're using librarian-chef right now and are looking at moving to berkshelf but I'm not educated enough yet to expand on the benefits
[2013-07-11 21:33:40 -0400] coderanger: I would say berkshelf is more common by now, librarian does what it does just fine, but thats a lot less
[2013-07-11 21:33:49 -0400] coderanger: librarian may be easier if you are using chef-solo
[2013-07-11 21:34:00 -0400] coderanger: for a client/server workflow, berkshelf all the way
[2013-07-11 21:36:16 -0400] mchu: hey #chef, got a question that's driving me nuts
[2013-07-11 21:36:27 -0400] mchu: got a multi-vm vagrant setup for testing chef-server + knife + clients
[2013-07-11 21:36:38 -0400] mchu: and whenever i try to `knife upload .` a kitchen, i get "ERROR: File remote/ is a directory while file remote/ is a regular file"
[2013-07-11 21:37:02 -0400] mchu: can anybody point me in any direction?
[2013-07-11 21:40:08 -0400] inimit: coderanger: using chef-full how easy is it to upgrade when the time comes?
[2013-07-11 21:41:56 -0400] coderanger: inimit: You just install the new package
[2013-07-11 21:42:14 -0400] inimit: simple enough, thx
[2013-07-11 21:42:25 -0400] cwj: inimit: also, http://community.opscode.com/cookbooks/omnibus_updater
[2013-07-11 21:42:32 -0400] kisoku: bekshelf has more features, consequently more bugs
[2013-07-11 21:45:05 -0400] inimit: thx cwj
[2013-07-11 21:45:44 -0400] jgood: are there any plans to be able to invoke a chef-client run from the webui?
[2013-07-11 21:45:50 -0400] burgess: mchu: i've seen similar when file "remote" is a broken symlink to a directory
[2013-07-11 21:47:02 -0400] mchu: burgess: interesting. was this on the workstation side or the chef-server side? i did a find in the obvious places and there's nothing called remote (thanks!)
[2013-07-11 21:48:54 -0400] burgess: ran into similarly confusing errors last night - think was a symlink on the workstation, which broke in the VM (maybe due to sharing whatnot). not exactly your situation.
[2013-07-11 21:50:30 -0400] mchu: thanks, will keep looking
[2013-07-11 21:55:53 -0400] coderanger: jgood: Yes, there will eventually be a web interface with the Pushy orchestration system (aka Chef Push Jobs)
[2013-07-11 21:56:40 -0400] coderanger: jgood: No specific plans as to how it will work though, possibly a low-level interface based on the pushy primatives, but possibly something higher level
[2013-07-11 21:58:56 -0400] jgood: @coderanger: sounds neat, thanks!
[2013-07-11 21:59:28 -0400] coderanger: jgood: There were a few talks about Pushy at the last ChefConf, videos are probably online somewhere
[2013-07-11 22:00:22 -0400] Majost1: coderanger: are you sure chef 11 doesn't require specifying the template for chef-full to get the encrypted_data_bag_secret file to auto-copy?
[2013-07-11 22:00:36 -0400] jgood: @coderanger: i might just have to go looking for those :)
[2013-07-11 22:00:50 -0400] coderanger: Majost1: chef-full is just the default value for --distro
[2013-07-11 22:01:46 -0400] asharp: for the git resource, can i checkout a specific branch?
[2013-07-11 22:01:48 -0400] asharp: i tried revision
[2013-07-11 22:01:50 -0400] asharp: the attribute
[2013-07-11 22:05:13 -0400] douglaswth: asharp: that should work, but I think it makes a deploy branch out of that (maybe that's what's making you think it's not working?)
[2013-07-11 22:05:46 -0400] asharp: douglaswth: looks like the deploy resource has what i'm looking for
[2013-07-11 22:07:20 -0400] douglaswth: asharp: I'm pretty sure the deploy resource just calls through to the git provider (or whatever provider you pass it)
[2013-07-11 22:07:41 -0400] Majost1: coderanger: I am doing something wrong -- because it wont drop the file for me
[2013-07-11 22:08:03 -0400] coderanger: And you are 100% sure you have the secret configured correctly in your knife.rb?
[2013-07-11 22:08:11 -0400] coderanger: and that your knife is new enough?
[2013-07-11 22:08:28 -0400] Majost1: the latter I am confident is okay - 11.4.4
[2013-07-11 22:08:48 -0400] Majost1: knife.rb I am probably defining the value incorrectly
[2013-07-11 22:13:00 -0400] Majost1: grr... I have tried:
[2013-07-11 22:13:00 -0400] Majost1: knife[:secret_file] = '/path/to/encrypted_data_bag_secret'
[2013-07-11 22:13:00 -0400] Majost1: encrypted_data_bag_secret_key_path '/path/to/encrypted_data_bag_secret'
[2013-07-11 22:13:00 -0400] Majost1: encrypted_data_bag_secret  '/path/to/encrypted_data_bag_secret'
[2013-07-11 22:13:00 -0400] Majost1: encrypted_data_bag_secret =  '/path/to/encrypted_data_bag_secret'
[2013-07-11 22:13:06 -0400] asharp: douglaswth: yes the deploy isnt what i wanted
[2013-07-11 22:13:18 -0400] asharp: i could just use bash "git checkout" for now
[2013-07-11 22:13:54 -0400] douglaswth: the deploy branch it creates should be exactly the same as the branch you named with the revision attribute
[2013-07-11 22:14:37 -0400] asharp: yeah i'm looking at http://docs.opscode.com/resource_git.html right now, and under 'use different branches' it has exactly what i need
[2013-07-11 22:14:48 -0400] Majost1: I probably should just use chef-vault everywhere
[2013-07-11 22:15:16 -0400] Majost1: but some stuff makes not practical... eg: tomcat cookbook
[2013-07-11 22:15:51 -0400] Majost1: I suppose I could write my own users wrapper recipe though
[2013-07-11 22:17:07 -0400] coderanger: Majost1: sec and I can trace the code
[2013-07-11 22:18:47 -0400] rava`: how do i get chef 10.x to generate the validation and webui pems after a gem install?
[2013-07-11 22:19:03 -0400] coderanger: rava`: Start the server procs
[2013-07-11 22:23:19 -0400] Majost1: yeah, it's suppose to be:  knife[:secret_file]
[2013-07-11 22:23:40 -0400] Majost1: there is even a warning in the bootstrap.rb to use that syntax
[2013-07-11 22:24:08 -0400] coderanger: That looks correct
[2013-07-11 22:24:22 -0400] Majost1: wth
[2013-07-11 22:24:58 -0400] coderanger: https://github.com/opscode/chef/blob/master/lib/chef/knife/core/bootstrap_context.rb#L55
[2013-07-11 22:25:02 -0400] Astral303: how can i write an "unless package is not installed" type of a rule?
[2013-07-11 22:25:17 -0400] coderanger: Astral303: Not sure what you mean
[2013-07-11 22:26:02 -0400] Astral303: i'd like to execute a custom shell command to install a package and would like to put an unless rule for a package resource that is not installed
[2013-07-11 22:26:20 -0400] coderanger: How would you normally check if you were doing it by hand?
[2013-07-11 22:26:25 -0400] Astral303: rpm -q
[2013-07-11 22:26:33 -0400] coderanger: Then do that :-)
[2013-07-11 22:26:34 -0400] Astral303: i suppose that answers that question
[2013-07-11 22:26:34 -0400] Astral303: heh
[2013-07-11 22:26:42 -0400] Astral303: didn't know if there was a more chef-y way
[2013-07-11 22:26:59 -0400] coderanger: Not really, I mean if you wanted to you could probably hook into the rpm package provider code
[2013-07-11 22:27:05 -0400] coderanger: but that would be astronomical overkill
[2013-07-11 22:27:06 -0400] Astral303: something like unless package['blah'].exists or something like that
[2013-07-11 22:27:27 -0400] Astral303: thanks coderanger
[2013-07-11 22:27:51 -0400] coderanger: you could probably do something like rpm_package 'blah' { action :nothing }.load_current_resource.version
[2013-07-11 22:28:06 -0400] coderanger: But that would show up in your resource list and other weird things
[2013-07-11 22:28:06 -0400] Majost1: yeah, those two conditions are met... so I am not sure why this is failing. It works under vagrant with their way of specifying the path... so its even more perplexing.
[2013-07-11 22:28:07 -0400] Majost1: heh
[2013-07-11 22:30:15 -0400] Astral303: yeah, the execute / not_if combination actually looks fairly straightforward
[2013-07-11 22:32:43 -0400] organicveggie: Really dumb question. We're still running Chef 0.9.x (long story) and I've forgotten who to create users. Any advice?
[2013-07-11 22:33:35 -0400] coderanger: organicveggie: In 0.9 users are only related to the webui, so unless you use that all you want to do is make a client
[2013-07-11 22:33:42 -0400] coderanger: knife client create --admin <name> I think it was
[2013-07-11 22:33:49 -0400] organicveggie: Clients can be used to run knife remotely, right?
[2013-07-11 22:34:00 -0400] coderanger: Yes, client == API client
[2013-07-11 22:34:09 -0400] organicveggie: Awesome. See? I said it was a dumb question. :)
[2013-07-11 22:34:10 -0400] organicveggie: Thanks.
[2013-07-11 22:59:38 -0400] navid_: How do you execute a bash script (bash resource) only if a file has been updated/changed?
[2013-07-11 23:01:26 -0400] coderanger: navid_: Use a resource notification
[2013-07-11 23:01:56 -0400] navid_: coderanger: thanks! got it
[2013-07-11 23:07:34 -0400] navid_: coderanger: what If I want to execute a bash block only if a template has been changed?
[2013-07-11 23:08:12 -0400] coderanger: navid_: make a bash resource with action :nothing, and use a notification from the template resource to the bash resource
[2013-07-11 23:09:57 -0400] navid_: coderanger: so in that case the code will be only executed with the notification but not during the standard flow?
[2013-07-11 23:10:04 -0400] coderanger: Indeed
[2013-07-11 23:10:10 -0400] navid_: cool thanks!
[2013-07-11 23:16:29 -0400] navid_: coderanger: should this notifies attribute work in template resource: notifies :run, 'bash["Install Log Shipper service"]' ? My bash block starts like this bash "Install Log Shipper service" do
[2013-07-11 23:17:10 -0400] coderanger: drop the quotes in the notification, just 'bash[Install Log Shipper service]'
[2013-07-11 23:17:56 -0400] navid_: awesome!
[2013-07-11 23:18:10 -0400] navid_: i was already excited about Chef but even more now hehe
