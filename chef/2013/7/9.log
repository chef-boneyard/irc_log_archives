[2013-07-09 00:09:06 -0400] Majost: Is it possible to extend the template provider in a cookbook lwrp to add a couple features?
[2013-07-09 00:15:10 -0400] coderanger: Majost: LWRP, no. But you can use a library file and subclass it
[2013-07-09 00:17:20 -0400] Majost: coderanger: cool, thanks! =)
[2013-07-09 00:19:01 -0400] Majost: coderanger: You wouldn't happen to know off hand of any good examples of this pattern?
[2013-07-09 00:19:26 -0400] Majost: I'm probably in over my head if I have to ask though. heh
[2013-07-09 00:21:21 -0400] peregrinator: hi all - question about knife and bootstrap templates: I'm using knife ec2 to create a server, I've tried passing both --distro and --template-file options to a custom bootstrap template I have in .chef/bootstrap/ruby19.erb - everything runs without an error but the server gets ruby 1.8 instead of 1.9...
[2013-07-09 00:29:51 -0400] peregrinator: also anyone around to help with a berkshelf question?
[2013-07-09 00:31:01 -0400] flaccid: peregrinator: you'll never know the answer to a question unless you ask it :)
[2013-07-09 00:31:07 -0400] flaccid: there is also #berkshelf
[2013-07-09 00:32:17 -0400] peregrinator: flaccid: thanks :) basically berkshelf upload is erroring out with an address not found - but my knife config (for say updating roles) works fine - can't seem to track down why
[2013-07-09 00:35:32 -0400] flaccid: peregrinator: yeah try asking that in #berkshelf i guess
[2013-07-09 00:35:53 -0400] peregrinator: flaccid: will do
[2013-07-09 00:44:55 -0400] coderanger: Majost: Yeah, subclassing RPs is definitely advanced-mode
[2013-07-09 00:47:15 -0400] Majost: coderanger: hrm -- it looks like the template provider is a subclass of file itself
[2013-07-09 00:47:35 -0400] coderanger: Indeed, anything that pokes files is
[2013-07-09 00:47:49 -0400] coderanger: cookbook_file and template just have special logic to figure out the content
[2013-07-09 00:48:08 -0400] coderanger: Majost: What are you trying to accomplish?
[2013-07-09 00:48:12 -0400] Majost: I need an 'encrypted_file'
[2013-07-09 00:49:09 -0400] Majost: unfortunately, the code I need to write is not going to be usable for anything other than my company... but if I can get this working, its possible to make it more generic I suppose.
[2013-07-09 00:49:16 -0400] coderanger: Ahh, hmm, you'll have to be careful with the template impl, it does write stuff to temp files at times
[2013-07-09 00:49:46 -0400] Majost: yeah, I have a feeling my initial implementation will be dirty
[2013-07-09 00:49:47 -0400] Majost: heh
[2013-07-09 00:50:06 -0400] Majost: and by dirty, I mean not really secure
[2013-07-09 00:50:07 -0400] Majost: heh
[2013-07-09 00:51:48 -0400] coderanger: So you want to take a template file, render it, encrypt it somehow, and the write the encrypted file to disk?
[2013-07-09 00:52:02 -0400] Majost: ideally, yes.
[2013-07-09 00:52:13 -0400] coderanger: Hmm, sec
[2013-07-09 00:52:14 -0400] coderanger: :)
[2013-07-09 00:52:50 -0400] Majost: hah
[2013-07-09 00:56:25 -0400] coderanger: Majost: class Chef::Provider::EncryptedTemplate < Template; def render_with_context(template_location, &block); super(template_location) do |out| block.call(encrypt(out)); end; end
[2013-07-09 00:56:41 -0400] coderanger: Majost: Where #encrypt does "stuff"
[2013-07-09 00:56:57 -0400] Majost: lol
[2013-07-09 00:56:58 -0400] Majost: awesome
[2013-07-09 00:57:56 -0400] coderanger: You'll probably want to subclass the resource to add a passphrase I would think
[2013-07-09 00:58:11 -0400] coderanger: Unless this is like a gpg encrypt, in which case you need a key ID too?
[2013-07-09 00:58:52 -0400] Majost: in this case, its more like obfuscation then actual encryption really
[2013-07-09 00:59:54 -0400] Majost: but adding a passphrase would be good for other stuff
[2013-07-09 01:01:37 -0400] coderanger: Majost: http://hastebin.com/remolelusi.rb
[2013-07-09 01:01:53 -0400] coderanger: like 900% untested since I just wrote it in the pastebin editor
[2013-07-09 01:01:56 -0400] coderanger: but should get you close
[2013-07-09 01:02:06 -0400] Majost: sweet! thanks! =)
[2013-07-09 01:04:01 -0400] Majost: This is really helpful -- I have other template hacks I need to implement for other stuff, and this gives me a much better understanding of this stuff. =)
[2013-07-09 01:05:59 -0400] coderanger: Unfortunately much of Chef isn't super well designed for extension by subclassing, but this is simple enough that it should work out okay :)
[2013-07-09 01:53:12 -0400] yruss972: Hi, can anyone help with this bug: http://tickets.opscode.com/browse/CHEF-4068
[2013-07-09 01:55:01 -0400] coderanger: yruss972: Would it help to just say "The JSON gem is probably the worst software I've ever had the misfortune to work with"?
[2013-07-09 01:55:41 -0400] yruss972: @coderanger: not very much :?
[2013-07-09 01:55:56 -0400] coderanger: Can I say it anyway?
[2013-07-09 01:56:00 -0400] coderanger: cuz dayaaaaam
[2013-07-09 01:56:07 -0400] coderanger: :-(
[2013-07-09 01:56:17 -0400] Guest72035: :(
[2013-07-09 01:56:27 -0400] yruss972: @coderanger: I don't mind- say it all day long :)
[2013-07-09 02:14:00 -0400] Majost: coderanger: very close to working -- the library is passing a file object and I am using Mixlib::Shellout to do the encryption -- unfortunately the encryption application I am using doesn't seem to like using stdin or pipes, but I am very close
[2013-07-09 02:14:02 -0400] Majost: thanks
[2013-07-09 02:14:22 -0400] coderanger: ivey reset: Can y'all please hire some webdevs and make your site less bad kthxbai :)
[2013-07-09 02:14:31 -0400] reset: which site?
[2013-07-09 02:14:45 -0400] coderanger: leagueoflegends.com
[2013-07-09 02:14:48 -0400] reset: haha
[2013-07-09 02:15:02 -0400] coderanger: http://competitive.na.leagueoflegends.com/media/galleries/screenshot
[2013-07-09 02:15:09 -0400] coderanger: This is apparently the screenshot gallery
[2013-07-09 02:15:10 -0400] coderanger: :)
[2013-07-09 02:16:14 -0400] reset: man
[2013-07-09 02:16:43 -0400] reset: the Oceanic league of legends webpage is a better example of the talents we have now
[2013-07-09 02:16:53 -0400] reset: unfortunately a lot of the site is old and yet to be re-visited
[2013-07-09 02:17:23 -0400] bluepojo: not yet to be revisited
[2013-07-09 02:17:28 -0400] bluepojo: site's in beta
[2013-07-09 02:17:36 -0400] bluepojo: the revisit, that is
[2013-07-09 02:17:58 -0400] bluepojo: http://beta.na.leagueoflegends.com/
[2013-07-09 02:18:26 -0400] bluepojo: but hey
[2013-07-09 02:18:28 -0400] bluepojo: that screenshot
[2013-07-09 02:18:30 -0400] bluepojo: is enough
[2013-07-09 02:18:32 -0400] bluepojo: >_>
[2013-07-09 02:18:33 -0400] bluepojo: <_<
[2013-07-09 02:18:42 -0400] bluepojo: coderanger: reset: ^
[2013-07-09 02:18:44 -0400] coderanger: Trying to find the per-skin glamour images from in-game to use in an art project
[2013-07-09 02:19:04 -0400] bluepojo: not sure we have anything like that unless you mean splash images
[2013-07-09 02:19:32 -0400] bluepojo: http://leagueoflegends.wikia.com/wiki/League_of_Legends_Wiki has lots of images you might be able to pick through
[2013-07-09 02:20:11 -0400] bluepojo: for example: http://leagueoflegends.wikia.com/wiki/Riven/SkinsTrivia
[2013-07-09 02:20:12 -0400] coderanger: Thanky :-) Also checking if lolking has them somewhere I can scrape :)
[2013-07-09 02:20:23 -0400] coderanger: Aha, this is perfect
[2013-07-09 02:20:57 -0400] reset: it's gonna get better, don't worry :)
[2013-07-09 02:22:09 -0400] coderanger: http://lkimg.zamimg.com/shared/riot/images/champions/loading_screens/<id>_<skin>.jpg works too
[2013-07-09 02:22:25 -0400] bluepojo: if you have the game downloaded
[2013-07-09 02:22:31 -0400] bluepojo: you have all the splashes in the install directory
[2013-07-09 02:23:03 -0400] coderanger: Trying to make something I can throw up on Heroku which will just scrape as new stuff gets added
[2013-07-09 02:23:42 -0400] bluepojo: ah
[2013-07-09 02:27:54 -0400] skopii: Hello, I am wondering if there's a way to ask a Chef::Resource all of the attributes?
[2013-07-09 02:28:35 -0400] coderanger: skopii: Not directly, but you can get a list of all instance vars
[2013-07-09 02:28:59 -0400] skopii: yeah, I think that is probably the way to go =\
[2013-07-09 02:29:10 -0400] skopii: I was hoping there was something I missed. Thanks though
[2013-07-09 04:25:47 -0400] cjerdonek: is there a way to force a cookbook's attribute files to be evaluated before the attribute files of a cookbook on which it depends?
[2013-07-09 04:33:12 -0400] sascha_d: @cjerdonek http://docs.opscode.com/essentials_cookbook_attribute_files.html#attribute-file-ordering
[2013-07-09 04:33:22 -0400] sascha_d: oh wait, sorry
[2013-07-09 04:33:38 -0400] sascha_d: I'm thinking about our question and now I'm dizzy
[2013-07-09 04:35:46 -0400] sascha_d: if you have cookbooks A and B, B deps on A, are you trying to set override attributes in B for A?
[2013-07-09 04:36:51 -0400] cjerdonek: sascha_d: i saw that page before, but it doesn't seem to match what i observe.
[2013-07-09 04:37:05 -0400] sascha_d: So can you describe your use case?
[2013-07-09 04:38:28 -0400] cjerdonek: i am trying to set node["mysql"]["version"] before the following line of the mysql cookbook is evaluated: https://github.com/opscode-cookbooks/mysql/blob/master/attributes/server.rb#L41
[2013-07-09 04:39:02 -0400] cjerdonek: i tried doing that in the attribute file of a cookbook named "foo" (before "mysql" alphabetically), but the value did not seem to stick
[2013-07-09 04:39:35 -0400] sascha_d: you need to set an override attribute
[2013-07-09 04:39:45 -0400] sascha_d: that's probably easiest
[2013-07-09 04:40:13 -0400] sascha_d: so if there's already a default['mysql']['attr'] you need to set override['mysql']['attr']
[2013-07-09 04:40:48 -0400] sascha_d: that way Chef will take care of knowing what the version is prior to executing any code
[2013-07-09 04:41:54 -0400] sascha_d: if you want to do it in your recipe that depends on my sql, you can, in the recipe: node.set.override['mysq']['attr'] = "a better value" and after that line "include_recipe mysql::yourrecipe"
[2013-07-09 04:42:16 -0400] juliancdunn: you can also set it at default in the recipe too sascha_d
[2013-07-09 04:42:27 -0400] sascha_d: you can also use the previous notation I used to set it in your depending cookbook's attribute file
[2013-07-09 04:42:38 -0400] sascha_d: @juliancdunn that's going to override the existing mysql attr?
[2013-07-09 04:42:42 -0400] juliancdunn: yep
[2013-07-09 04:42:50 -0400] sascha_d: well that's not confusing
[2013-07-09 04:42:51 -0400] juliancdunn: recipe defaults are higher priority than attribute defaults
[2013-07-09 04:42:57 -0400] sascha_d: oh, right, I knew that part
[2013-07-09 04:43:04 -0400] sascha_d: don't confuse people
[2013-07-09 04:43:11 -0400] sascha_d: :)
[2013-07-09 04:43:21 -0400] cjerdonek: sascha_d: juliancdunn: thx, i will try that out
[2013-07-09 04:43:36 -0400] juliancdunn: you try to confuse!
[2013-07-09 04:43:41 -0400] juliancdunn: (you're welcome cjerdonek)
[2013-07-09 04:44:19 -0400] sascha_d: if I were new and someone told me I could use the word default to override a value but other places it didn't work and I needed 'override,' my head would explode
[2013-07-09 04:44:41 -0400] juliancdunn: usually I just point them to http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-07-09 04:44:49 -0400] sascha_d: yes I did that
[2013-07-09 04:45:28 -0400] sascha_d: you're just trying to offload some of your Delta angst
[2013-07-09 04:45:55 -0400] ivanoats: I am trying rake upload_cookbooks and I get the error ERROR: You authenticated successfully to https://api.opscode.com/organizations/susweb as my_computer_name but you are not authorized for this action. Response:  missing update permission
[2013-07-09 04:49:31 -0400] juliancdunn: ivanoats: i dunno what this rake task is about, but that looks like you're trying to upload cookbooks using a node's certificate rather than your own
[2013-07-09 04:49:47 -0400] juliancdunn: nodes can't change cookbooks, only users can
[2013-07-09 04:49:55 -0400] juliancdunn: (for obvious reasons)
[2013-07-09 04:50:04 -0400] spox: well, you can update the permissions the client has, and then it can
[2013-07-09 04:50:06 -0400] ivanoats: juliancdunn: that sounds on the right track, i had to regenerate some keys, been a long time since I used my opscode account
[2013-07-09 04:50:09 -0400] spox: but, that's probably a bad idea
[2013-07-09 04:50:10 -0400] spox: :P
[2013-07-09 04:50:22 -0400] juliancdunn: spox: definitely. :-)
[2013-07-09 04:51:10 -0400] ivanoats: so... i should use my validator key instead of my node key?
[2013-07-09 04:51:23 -0400] ivanoats: still trying to wrap my head around client vs. node
[2013-07-09 04:52:09 -0400] ivanoats: juliancdunn: when you say "your own" what specific certificate do you mean? sorry I am a 3 year old when it comes to chef right now
[2013-07-09 04:53:18 -0400] cjerdonek: sascha_d: juliancdunn: none of those suggestions seemed to work
[2013-07-09 04:54:13 -0400] cjerdonek: the mysql attribute file seems to be processed before any lines of my cookbook "foo" are evaluated
[2013-07-09 04:58:06 -0400] BrianJ: if one of my libaries requires that a gem is installed, what is the best way of dealing with this?
[2013-07-09 04:58:38 -0400] BrianJ: is the recipe run first before the libarary's 'require' is hit?
[2013-07-09 05:00:05 -0400] cjerdonek: BrianJ: i have dealt with this by "requiring" the gems in my recipes prior to calling any library functions that depend on those gems
[2013-07-09 05:01:14 -0400] BrianJ: ok so lets say i have an aws cookbook which is essentially aws libraries. Should I create a recipe that basically just installs the aws-sdk?
[2013-07-09 05:02:37 -0400] cjerdonek: BrianJ: that sounds like a reasonable approach to try. does it work?
[2013-07-09 05:03:10 -0400] BrianJ: cjerdonek: I haven't tried it yet. Booting up an instance right now.
[2013-07-09 05:17:12 -0400] juliancdunn: ivanoats: I mean the cert named after you... yourname.pem
[2013-07-09 05:17:41 -0400] ivanoats: oh ok. i seem to be missing that
[2013-07-09 05:17:50 -0400] juliancdunn: cjerdonek: gist your recipe?
[2013-07-09 05:21:55 -0400] cjerdonek: juliancdunn: it doesn't have to do with lines of the recipe. they can be empty. i have cookbook "foo" with 'depends "database"' in metadata.rb. i put a log line at the top of the attribute file of "foo" and "mysql" and mysql's is evaluated first.
[2013-07-09 05:22:41 -0400] cjerdonek: mysql's attribute file has logic in it (see github link above) that requires the node attributes to be set prior to evaluating that attribute file
[2013-07-09 05:35:18 -0400] BrianJ: i got cannot load such file -- aws-sdk when i added the gem to a default.rb
[2013-07-09 05:35:27 -0400] BrianJ: I used gem_package
[2013-07-09 05:35:38 -0400] BrianJ: should i have used chef_package?
[2013-07-09 05:36:42 -0400] stormerider: if it's going to be used by chef itself, yes, you have to.
[2013-07-09 05:36:58 -0400] stormerider: that's the difference between the two.
[2013-07-09 05:44:10 -0400] coderanger: BrianJ: Make that chef_gem
[2013-07-09 06:03:01 -0400] BrianJ: @coderanger: using chef_gem in my default.rb recipe. but im still getting "cannot load such file"
[2013-07-09 06:03:12 -0400] BrianJ: I require the cookbook in my other cookbook that uses the libarary,
[2013-07-09 06:03:17 -0400] coderanger: Can you please pastebin the relevant code?
[2013-07-09 06:03:22 -0400] BrianJ: do i need to add the recipe to my run list?
[2013-07-09 06:03:24 -0400] BrianJ: ya one sec
[2013-07-09 06:04:50 -0400] coderanger: You need that recipe to run, either via the run list or include_recipe
[2013-07-09 06:05:54 -0400] BrianJ: coderanger: http://pastie.org/8123508
[2013-07-09 06:06:10 -0400] BrianJ: i have it in my metadata
[2013-07-09 06:06:15 -0400] BrianJ: metadata.rb
[2013-07-09 06:06:38 -0400] coderanger: So a few issues
[2013-07-09 06:07:07 -0400] coderanger: 1) you still need the include_recipe, the depends line in metadata.rb just makes sure the cookbooks and downloaded but isn't involved in what gets run after that
[2013-07-09 06:07:23 -0400] coderanger: 2) library files are run before all recipes, so you can't require gems at the top level of a lib file like that
[2013-07-09 06:07:53 -0400] BrianJ: ah ok
[2013-07-09 06:08:11 -0400] coderanger: Well, you can, it will just fail ;-)
[2013-07-09 06:08:23 -0400] BrianJ: so how do i make it require while waiting for the recipe to run
[2013-07-09 06:08:37 -0400] coderanger: You want to move the require line down to the point where it is actually used at runtime
[2013-07-09 06:08:37 -0400] coderanger: which would naturally be after the gem gets installed
[2013-07-09 06:09:00 -0400] coderanger: So in this case, just move the require to the top of #get_from_s3
[2013-07-09 06:12:49 -0400] BrianJ: k just made the changes
[2013-07-09 06:12:53 -0400] BrianJ: giving it a shot
[2013-07-09 06:12:55 -0400] BrianJ: thanks for the hlep
[2013-07-09 06:12:56 -0400] BrianJ: help*
[2013-07-09 06:13:36 -0400] BrianJ: in one of the opscode cookbooks i see that they use a method to install the gems, is this the best way of dealing with this? https://github.com/opscode-cookbooks/windows/blob/master/providers/zipfile.rb
[2013-07-09 06:14:03 -0400] BrianJ: as to creating a recipe to install the ge
[2013-07-09 06:14:05 -0400] BrianJ: gem*
[2013-07-09 06:21:01 -0400] cjerdonek: BrianJ: i believe you can also put the "require" in the recipes prior to calling library functions that use the gem
[2013-07-09 06:21:21 -0400] BrianJ: ya i got it working
[2013-07-09 06:21:39 -0400] BrianJ: thanks a lot of the input
[2013-07-09 06:34:19 -0400] BrianJ: ugh look like i have another issue with seting environment variables.. I'm adding git to my path, but it doesnt seem to register when the test cookbook's recipe fires off http://pastie.org/8123552
[2013-07-09 06:34:31 -0400] BrianJ: the run list calls git before test
[2013-07-09 06:34:40 -0400] BrianJ: git::windows
[2013-07-09 06:34:40 -0400] BrianJ: that is
[2013-07-09 07:46:15 -0400] hakunin: I installed chef server today, my first time ever, and this happened twice today.
[2013-07-09 07:46:40 -0400] hakunin: I leave it alone for a while, then try to access web gui or ssh, and it's not letting me through.
[2013-07-09 07:47:11 -0400] hakunin: ssh just stays there stuck, not showing prompt
[2013-07-09 07:47:20 -0400] hakunin: web gui says "sending request"
[2013-07-09 07:47:34 -0400] hakunin: and after ~a minute of that, it starts working
[2013-07-09 07:47:40 -0400] coderanger: Is the machine out of RAM or IO?
[2013-07-09 07:48:08 -0400] hakunin: coderanger: i see activity in top
[2013-07-09 07:48:14 -0400] hakunin: coderanger: but don't see it running out of ram
[2013-07-09 07:48:38 -0400] hakunin: coderanger: it's 2GB RAM as per someone's suggestion here, and DO servers are on SSD
[2013-07-09 07:49:38 -0400] coderanger: I mean if SSH is hanging, the machine is having performance issues, while it may be related to running chef-server on an underpowered server, it is definitely outside of the scope of Chef
[2013-07-09 07:49:40 -0400] hakunin: another point: no clients are provisioning, i only have 1 client so far, and i disabled the daemon for now
[2013-07-09 07:49:53 -0400] coderanger: I will note I was clear that running chef-server takes a beefy machine :)
[2013-07-09 07:51:37 -0400] hakunin: coderanger: don't mean to sound snarky, but looking at what it actually does it almost feels like one could write a bash script that can act as chef server, and be crazy fast
[2013-07-09 07:52:07 -0400] coderanger: chef-server is built to scale up very high, as a consequence it doesn't scale down very well
[2013-07-09 07:52:22 -0400] coderanger: Said bash script would probably not do too well with a few thousand API calls a minute :)
[2013-07-09 07:52:50 -0400] coderanger: I wrote Commis as an attempt to make a chef server that scales down well, but its long abandoned at this point due to lack of time
[2013-07-09 07:52:53 -0400] coderanger: It does work though :-)
[2013-07-09 07:52:58 -0400] prognostikos: for those of you using the application cookbook pattern - do you prefer node.set[:some_other_cookbook][:attribute] in the recipies or setting attributes for other cookbooks in attributes files?
[2013-07-09 07:53:13 -0400] coderanger: Just doesn't support any new API changes since 0.10.0
[2013-07-09 07:53:16 -0400] prognostikos: or something else entirely?
[2013-07-09 07:54:05 -0400] hakunin: coderanger: i don't imagine to understand everything involved :) just its job looks deceptively simple from the outside. i guess so does twitter.
[2013-07-09 07:54:45 -0400] coderanger: prognostikos: Why are you setting attrs in other cookbooks?
[2013-07-09 07:55:47 -0400] coderanger: hakunin: All I can say is try to see what performance issues are being capped (IO, RAM, CPU, etc) and then either get more of that or figure out why you are using so much of it (though the answer might just be "because it makes sense for large installs")
[2013-07-09 07:55:47 -0400] hakunin: prognostikos: i rarely set attributes in recipes, i had a few cases where it felt more appropriate
[2013-07-09 07:55:49 -0400] prognostikos: coderanger: i'm considering using application/role cookbooks instead of roles for attribute mgmt.
[2013-07-09 07:56:07 -0400] coderanger: prognostikos: For role-ish cookbooks, set stuff at the override level just like for a role
[2013-07-09 07:56:35 -0400] hakunin: coderanger: now that i look more carefully i notice 77,200k free of ram, and 1,974,576k used according to top
[2013-07-09 07:56:37 -0400] prognostikos: coderanger: in the attributes file or directly in recipies?
[2013-07-09 07:56:41 -0400] hakunin: coderanger: this is probably the problem
[2013-07-09 07:56:52 -0400] coderanger: prognostikos: and an attrs file
[2013-07-09 07:57:15 -0400] coderanger: hakunin: That would indeed do it, 4GB might maybe be enough to run a chef-server, I think for private chef we recommend 16 though
[2013-07-09 07:57:24 -0400] coderanger: 2 is way too small though
[2013-07-09 07:57:50 -0400] hakunin: coderanger: this guy told me he ran 1.7GB (m1.small) with 30 nodes without issues
[2013-07-09 07:58:10 -0400] coderanger: hakunin: I remember, I was there, I said that was nice if true but that it was highly dubious :)
[2013-07-09 07:58:27 -0400] hakunin: coderanger: :( damn it
[2013-07-09 07:58:34 -0400] coderanger: You can try tuning solr and postgres to be less agressive on heap usage
[2013-07-09 07:58:39 -0400] hakunin: coderanger: i am so over reasonable amount of time for this
[2013-07-09 07:59:10 -0400] coderanger: hakunin: For better or worse, chef-server is a complex beast, this is why we offer a SaaS option :)
[2013-07-09 07:59:21 -0400] hakunin: coderanger: extortion!
[2013-07-09 07:59:23 -0400] hakunin: :)
[2013-07-09 08:00:18 -0400] coderanger: All depends on what your time is worth, the open-source server is more or less the same code we run, so it really can work, its just the joy of open source is you pay for it with time
[2013-07-09 08:00:27 -0400] coderanger: If you are happy to do that, then all is well :)
[2013-07-09 08:00:36 -0400] coderanger: If not, well then there is no free lunch
[2013-07-09 08:01:14 -0400] hakunin: coderanger: the problem is that we are at a stage where ~$300/mo for infrastructure is reasonable, but $500 is already a bit too much
[2013-07-09 08:01:26 -0400] hakunin: coderanger: it's that weird middle ground
[2013-07-09 08:01:53 -0400] coderanger: How many servers do you have?
[2013-07-09 08:02:07 -0400] coderanger: Saying "early stage infra" and "> 50 servers" seems a bit odd
[2013-07-09 08:02:08 -0400] hakunin: coderanger: 9 nodes total, excluding chef server
[2013-07-09 08:02:19 -0400] coderanger: hosted chef is $6/node/mo
[2013-07-09 08:02:23 -0400] hakunin: coderanger: 50? never said 50
[2013-07-09 08:03:00 -0400] coderanger: heh, 300/6=50
[2013-07-09 08:03:01 -0400] coderanger: :)
[2013-07-09 08:03:42 -0400] hakunin: coderanger: i meant including servers
[2013-07-09 08:03:56 -0400] hakunin: coderanger: strange i see $120/mo price
[2013-07-09 08:04:39 -0400] coderanger: Thats for 20 nodes, our current billing system doesn't handle actual variable billing :-(
[2013-07-09 08:04:55 -0400] coderanger: billing providers == the worst ever
[2013-07-09 08:05:43 -0400] hakunin: stripe?
[2013-07-09 08:06:31 -0400] hakunin: that plan would turn my $300/mo to $420/mo, and hosted chef would become the most expensive server of all my company servers
[2013-07-09 08:07:55 -0400] hakunin: and frankly i'm almost there with my own :(
[2013-07-09 08:08:02 -0400] hakunin: if it wasn't for this ram thing :(
[2013-07-09 08:09:54 -0400] coderanger: Just check whats eating your RAM
[2013-07-09 08:10:05 -0400] coderanger: Its most likely Solr, after that check Rabbit and Postgres tuning
[2013-07-09 08:10:35 -0400] macdomat: hey all, I have a service that hsould be "enabled" by default, however if a certain command fails to return the correct output it should restart.  The caveat is that I don't want it to restart every chef run, only if the command output is wrong...
[2013-07-09 08:10:39 -0400] macdomat: I was hoping I could create a dummy service and then set that up to notify the "true" service but I'm not sure that will work!
[2013-07-09 08:10:42 -0400] macdomat: something like this: https://gist.github.com/macdomat/34fe8c38c9c4582273f0
[2013-07-09 08:10:44 -0400] macdomat: can anyone help?
[2013-07-09 08:11:10 -0400] hakunin: coderanger: https://gist.github.com/maxim/845c7b1ca7a22d039053
[2013-07-09 08:11:18 -0400] hakunin: coderanger: sorted by ram usage
[2013-07-09 08:11:24 -0400] hakunin: (cleaned up
[2013-07-09 08:11:24 -0400] hakunin: )
[2013-07-09 08:11:54 -0400] coderanger: So that java proc is solr :)
[2013-07-09 08:12:30 -0400] hakunin: coderanger: but 1 process at 233.8mb seems alright, maybe instances of postgres are unnecessary?
[2013-07-09 08:12:37 -0400] coderanger: The postgres RAM is harder to gauge since the vast majority of that should be shared between workers via either explicit SHM or copy-on-write
[2013-07-09 08:12:58 -0400] coderanger: but you can probably scale back postgres workers, and check unicorn workers too
[2013-07-09 08:14:18 -0400] hakunin: coderanger: hm actually what i shown here accounts for only 1GB
[2013-07-09 08:17:44 -0400] coderanger: hakunin: Linux memory tracking is special, you would have to bust out a smaps parser to actually account for everything
[2013-07-09 08:18:11 -0400] kisoku: god i find that so annoying
[2013-07-09 08:18:24 -0400] kisoku: I wish they would just write some bloody tools that tell you the truth :-P
[2013-07-09 08:18:40 -0400] hakunin: coderanger: so is something using mlockall type of thing? i'm not familiar, but had similar issue with elasticsearch
[2013-07-09 08:18:41 -0400] kisoku: I should NOT have to know about smaps :-P
[2013-07-09 08:19:31 -0400] coderanger: kisoku: Just be glad smaps exist, in the bad old days you had to use gdb to connect in and grab the allocation maps from libc directly :)
[2013-07-09 08:19:40 -0400] kisoku: yeah
[2013-07-09 08:19:40 -0400] kisoku: ok
[2013-07-09 08:19:42 -0400] kisoku: :-P
[2013-07-09 08:19:44 -0400] kisoku: you win
[2013-07-09 08:21:47 -0400] coderanger: hakunin: the JVM does weird stuff with locked pages, yes
[2013-07-09 08:21:54 -0400] coderanger: because it likes to basically own the heap
[2013-07-09 08:21:58 -0400] coderanger: as in the whole thing
[2013-07-09 08:22:18 -0400] coderanger: they would probably like to replace the kernel allocator if they could :)
[2013-07-09 08:23:25 -0400] hakunin: coderanger: they should just sell their own hardware
[2013-07-09 08:23:36 -0400] coderanger: They do :-)
[2013-07-09 08:25:18 -0400] hakunin: coderanger: so since you're staff, tell me, why doesn't the wonderful ohai help chef server configure itself according to available ram?
[2013-07-09 08:25:26 -0400] hakunin: :)
[2013-07-09 08:26:07 -0400] coderanger: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/recipes/chef-solr.rb#L93-L102
[2013-07-09 08:26:09 -0400] coderanger: It does ;-)
[2013-07-09 08:26:52 -0400] coderanger: It just doesn't scale down super well, you probably want to push it below that 25% number
[2013-07-09 08:27:43 -0400] coderanger: Some things are just fixed defaults though, for example https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/attributes/default.rb#L252
[2013-07-09 08:28:00 -0400] coderanger: and postgres reserves slabs of SHM relative to the max clients number
[2013-07-09 08:28:09 -0400] coderanger: So if you drop that way down, it will probably help :)
[2013-07-09 08:28:49 -0400] coderanger: We set both Solr and Postgres to use 25% of the RAM by default
[2013-07-09 08:28:55 -0400] hakunin: coderanger: oh jee, it'd reserve about 8*200
[2013-07-09 08:29:04 -0400] hakunin: *gee
[2013-07-09 08:29:06 -0400] coderanger: out of 2GB, you can see how that would get tight
[2013-07-09 08:30:13 -0400] coderanger: A base ubuntu system needs ~512MB just for the default services (cron, syslog, ssh, the kernel itself, etc)
[2013-07-09 08:30:32 -0400] coderanger: Not sure what OS you are using, but you can usually slim that down a good bit
[2013-07-09 08:30:50 -0400] coderanger: in the case of ubuntu, for example, there is whoopsie, atd, etc that can go
[2013-07-09 08:31:12 -0400] hakunin: coderanger: i'm using Digital Ocean's image of ubuntu 12.04 64x, which happily runs rails apps on 512mb nodes for some people
[2013-07-09 08:31:57 -0400] hakunin: coderanger: so yes I'm about to tweak some of these parameters, although i followed your advice and installed this package by hand. Where would i tweak them then?
[2013-07-09 08:32:08 -0400] hakunin: coderanger: (i decided to treat chef server as the only manual part of my setup)
[2013-07-09 08:32:11 -0400] coderanger: hakunin: /etc/chef-server/chef-server.rb
[2013-07-09 08:32:21 -0400] hakunin: coderanger: going there right now
[2013-07-09 08:32:38 -0400] coderanger: the docs have a fuller summary of the options
[2013-07-09 08:32:47 -0400] coderanger: Its approaching 2AM though, and I'm fading
[2013-07-09 08:33:06 -0400] hakunin: coderanger: i'm superficially familiar with some of those postgres settings, we'll see how it works out
[2013-07-09 08:33:07 -0400] coderanger: Trying to remember enough stats to do an outlier rejection
[2013-07-09 08:34:12 -0400] hakunin: coderanger: haven't had a chance to truly express how much you rock for just helping out here
[2013-07-09 08:34:35 -0400] hakunin: (it's 3:30am here btw, might be my second all-nighter) :(
[2013-07-09 08:35:03 -0400] coderanger: heh, no prob
[2013-07-09 08:36:35 -0400] hakunin: coderanger: that file doesn't exist though
[2013-07-09 08:36:44 -0400] threeturn: Hi guys, Anyone knows the status of the freebsd chef-client packaged with omnibus?
[2013-07-09 08:37:39 -0400] coderanger: hakunin: Yahr, not created by default
[2013-07-09 08:38:11 -0400] hakunin: coderanger: gotcha, thx, will consult http://docs.opscode.com/config_rb_chef_server.html
[2013-07-09 08:59:07 -0400] hakunin: hangin' again :( just the web gui after reconfigure. wtf is going on...
[2013-07-09 08:59:22 -0400] hakunin: ssh works
[2013-07-09 08:59:50 -0400] hakunin: enough ram is avail
[2013-07-09 09:03:03 -0400] Sleepy1: if find clients\nodes hang\lag when they start eating into RAM
[2013-07-09 09:03:28 -0400] Sleepy1: Are you on a cloud provider (guessing as you mention just 512mb of RAM)
[2013-07-09 09:03:50 -0400] Sleepy1: eating into swap i mean
[2013-07-09 09:11:27 -0400] BrianJ: When i install git in the git cookbook, its not available in the next cookbook
[2013-07-09 09:13:00 -0400] BrianJ: When I install git using the git cookbook and add git to the system path, it's not available in the next cookbook. Is there a way to deal with this?
[2013-07-09 09:13:54 -0400] BrianJ: I cant call git clone in the subsequent cookbook
[2013-07-09 10:09:59 -0400] BrianJ: When I install git using the git cookbook and add git to the system path, it's not available in the next cookbook. Is there a way to deal with this?
[2013-07-09 10:10:02 -0400] BrianJ: I cant call git clone in the subsequent cookbook
[2013-07-09 10:47:11 -0400] thom: BrianJ: post your code and error, please. and are you using the git resource, or system, or what?
[2013-07-09 10:50:20 -0400] BrianJ: +thom: http://pastie.org/8124136
[2013-07-09 10:50:35 -0400] BrianJ: one sec on the error
[2013-07-09 10:51:37 -0400] BrianJ: http://pastie.org/8124140
[2013-07-09 10:52:30 -0400] BrianJ: and git:windows is run before test in the run list
[2013-07-09 10:54:47 -0400] thom: oh, windows. not a clue, sorry
[2013-07-09 10:56:25 -0400] BrianJ: :(
[2013-07-09 11:14:05 -0400] bigbigbang: Ohai ! Is it possible to specify the erlang cookie (for rabbitMQ) before the "chef-server-ctl reconfigure" ? I didn't find it in the chef-server recipe ..
[2013-07-09 11:44:29 -0400] willejs: hi all, whats your preferred way of configuring a site in nginx? the nginx cookbook doesn't provide a lwrp or similar, the chef-nginx_conf cookbook does however through attributes, is that the one to use?
[2013-07-09 11:45:05 -0400] maruq: hey guys
[2013-07-09 11:46:29 -0400] maruq: is there a way to get a value back from an execute / powershell resource?
[2013-07-09 11:47:11 -0400] maruq: I have a powershell resource that mounts an iso image, but as far as I can tell, Windows doesn't let you specify the mount point
[2013-07-09 11:48:02 -0400] maruq: so I'm passing through the object & calling Get-Volume to get the info. I just need to return that to chef, so I can figure out where it mounted
[2013-07-09 11:49:44 -0400] maruq: I thought perhaps I could do https://gist.github.com/markbate/1886c68ee95ae805ba98
[2013-07-09 11:50:00 -0400] maruq: but it's trying to interpret mount_pount as a resource
[2013-07-09 11:52:50 -0400] gkarekinian: maruq: Can you use an environment variable to pass this around? It sounds wrong but it's the first thing I thought about
[2013-07-09 11:56:15 -0400] maruq: gkarekinian: hmm.. not sure, might give it a try.
[2013-07-09 11:57:34 -0400] maruq: I'm not sure when Chef reads the env vars though...
[2013-07-09 12:02:10 -0400] CaptainQuirk: Hi there !
[2013-07-09 12:02:29 -0400] CaptainQuirk: Is there a way to copy an entire directory structure during a chef run
[2013-07-09 12:02:53 -0400] CaptainQuirk: using the template resource to place files inside afterwards ?
[2013-07-09 12:05:25 -0400] CaptainQuirk: found it, sorry
[2013-07-09 12:28:42 -0400] willejs: : hi all, whats your preferred way of configuring a site in nginx? the nginx cookbook doesn't provide a lwrp or similar, the chef-nginx_conf cookbook does however through attributes, is that the one to use?
[2013-07-09 12:40:38 -0400] ravi: hi
[2013-07-09 12:40:57 -0400] ravi: can someone help me on netdev
[2013-07-09 12:42:12 -0400] laurent\: what's that ?
[2013-07-09 12:42:59 -0400] RJ2: if any knife-spork committers are here... please make it pretty-print the JSON when you promote stuff - the diff for the environment file is unreadable since it rewrites the json to a single line
[2013-07-09 12:44:13 -0400] m4rcu5: RJ2: i would have another one to add, keep the spacing in the version line intact :)
[2013-07-09 12:55:10 -0400] zaargy: if only knife-spork was on some website which allowed you to view the source and make changes and commit them back to the community
[2013-07-09 13:02:42 -0400] matti: zaargy: LOL
[2013-07-09 13:03:00 -0400] matti: zaargy: Hold on there boy ;p You asking for too much ;p
[2013-07-09 13:03:24 -0400] matti: zaargy: Is LoUS really that good? People are raving 'bout it.
[2013-07-09 13:23:07 -0400] jonlives: RJ2: the last version included a fix for that iirc
[2013-07-09 13:23:28 -0400] RJ2: jonlives: awesome, i'll upgrade then :D
[2013-07-09 13:23:57 -0400] jonlives: RJ2: specifically https://github.com/jonlives/knife-spork/pull/70 :)
[2013-07-09 13:24:19 -0400] RJ2: jonlives: fantastic, thanks
[2013-07-09 13:24:29 -0400] jonlives: np :)
[2013-07-09 13:25:07 -0400] jonlives: m4rcu5: your request was also fixed: https://github.com/jonlives/knife-spork/pull/67
[2013-07-09 13:31:49 -0400] Urocyon: Lagomorphs of Unusual Size?
[2013-07-09 13:33:58 -0400] cwj: willejs: i use template resource to drop off a config in /etc/nginx/sites-available and then use the nginx cookbook's nginx_site defintion to enable it
[2013-07-09 13:39:17 -0400] adnichols: anyone know of a knife plugin / tweak that'll show a summary after a knife ssh run to know which nodes had a non-zero exit status from the command run?
[2013-07-09 13:51:52 -0400] m4rcu5: jonlives: cool, thanks, it was something that popped into mind again :)
[2013-07-09 13:52:03 -0400] jonlives: np :)
[2013-07-09 13:53:49 -0400] bigbigbang: Ohohohai... why OSC doesn't get rabbitmq 3 or solrcloud ... I really wait for that .. if never it happen one day ..
[2013-07-09 13:55:22 -0400] bigbigbang: and a database system that support master/master OOTB or clustering .. **dreaming
[2013-07-09 14:21:44 -0400] vincy: Hey guys, writing a chef_handler but having newby errors it seems, the handler uses httparty as a means to communicate to another server, but when i run the chef_handler cookbook, it cannot find the httparty gem... am i missing something?
[2013-07-09 14:22:28 -0400] a|i: how to get the role of a node?
[2013-07-09 14:22:58 -0400] zaargy: MrHeavy: LoUS?
[2013-07-09 14:23:01 -0400] zaargy: oh yeah
[2013-07-09 14:23:04 -0400] zaargy: it is fantastic!
[2013-07-09 14:23:17 -0400] zaargy: zombies and guns - what's not to like?
[2013-07-09 14:25:37 -0400] bigbigbang: What do you think would be the hardest to perform ?  Updating rabbitmq (~2.8 -> 3..) or configuring rabbitmq clustered and with mirrored queues after install ( My goal : having a sort of failover /HA on rabbitmq) Rabbitmq 2.8 isn't friendly with that , but possible and rabbitmq 3 is very friendly with but not implemented .. any opinion ?
[2013-07-09 14:26:43 -0400] techminer: Can someone help me out?  I have a recipe that requires nokogiri.  I have one node out of 20 that is failing on this, the other 19 are working fine.  The nokogiri gem is in the default ruby (rbenv) and in the embedded chef ruby.  I can't figure out what's wrong.  Here is the gist of the error and gem outputs  https://gist.github.com/MattMencel/5957734
[2013-07-09 14:41:53 -0400] techminer: OKodd.  I uninstalled the nokogiri gem in the embedded chef and reran chef-client.  It reinstalled the nokogiri gem and worked fine.
[2013-07-09 14:50:27 -0400] HAPPYFUNBALL: is there a chef way to test whether if a user / group exists or not?
[2013-07-09 15:00:14 -0400] fooJBar: HAPPYFUNBALL: you could create a user resource with action :modify, this will throw an exception if the user doesn't exist.
[2013-07-09 15:01:31 -0400] nate`: was wondering if I could get some help since I hate ubuntu&redhat :P  I need ruby 1.9.3, the ubuntu package while 1.9.3 doesn't work for my needs.  getting this with RVM http://pastebin.com/EsUHwyjW
[2013-07-09 15:05:51 -0400] Sleepy1: its dirty happyfunball but this would work
[2013-07-09 15:05:58 -0400] Sleepy1: not_if {File.readlines("/etc/passwd").grep(/theusername/).size > 0}
[2013-07-09 15:06:41 -0400] Sleepy1: or you could check a homedir exists... or permissions on a file etc
[2013-07-09 15:07:39 -0400] Sleepy1: ruby has some useful file functions
[2013-07-09 15:07:40 -0400] Sleepy1: http://www.ruby-doc.org/core-2.0/File.html
[2013-07-09 15:07:47 -0400] gchristensen: Sleepy1, HAPPYFUNBALL - `id <username>` might be a better way to go about it, should you be using LDAP or some other form of user authentication
[2013-07-09 15:07:58 -0400] gchristensen: (I'm not sure they use the /etc/passwd)
[2013-07-09 15:08:24 -0400] Sleepy1: worth a suggestion :)
[2013-07-09 15:11:48 -0400] AskSteve: I'm using not_if { search(:node, "role:db") } in a template block and it appears to ignore the search results.  Can anybody help me with the syntax?
[2013-07-09 15:19:44 -0400] BrianJ: how do i set windows paths and then be able to use them in subsequent commands?
[2013-07-09 15:20:03 -0400] BrianJ: http://pastie.org/8124140
[2013-07-09 15:31:41 -0400] philsturgeon: so the PHP cookbook does not allow upgrading version of PHP, which is a shame
[2013-07-09 15:32:01 -0400] philsturgeon: the two main "download and build" stages are using not_if "which php"
[2013-07-09 15:32:28 -0400] philsturgeon: im trying to work out if i can get a version specific check, so which php and if version == attributes[version] style
[2013-07-09 15:33:34 -0400] gleam: wrap the cookbook and change hte resource's not_if
[2013-07-09 15:35:41 -0400] MrHeavy: Anyone have any thoughts on vagrant-chef-zero vs. vagrant-chefzero?
[2013-07-09 15:35:55 -0400] jkeiser:  there are two now?
[2013-07-09 15:36:10 -0400] n1ko: havent seen the point of either
[2013-07-09 15:37:01 -0400] jkeiser: The usefulness is that you can run any recipe in your VM (as opposed to chef-solo) and you don't have to set up a server.  But I don't understand why there are two (and I didn't write either one)
[2013-07-09 15:37:01 -0400] n1ko: im just using berkshelf
[2013-07-09 15:37:19 -0400] MrHeavy: I think they were both written around the same time
[2013-07-09 15:37:27 -0400] n1ko: i do use chef zero, not just those plugins
[2013-07-09 15:37:50 -0400] MrHeavy: Yeah, it's really difficult to integration-test stuff like MongoDB replica sets though if you can't use node search
[2013-07-09 15:38:11 -0400] MrHeavy: I shouldn't say "really" -- what I mean there is "more stuff gets hard-coded in the Vagrantfile than really should be"
[2013-07-09 15:38:39 -0400] n1ko: agree, thats why i never bothered with solo
[2013-07-09 15:38:42 -0400] bigbigbang: all right, no answer for my previous question on rabbitmq, so I will try to implement Rabbitmq 3 on OSC as it's a lot simplier to restore ( or HA / failover) .. will give you my "recipe" soon if someone is interested .. and feel free to help too . bye chefs !
[2013-07-09 15:40:03 -0400] MrHeavy: Anyway, jkeiser, are you using one or the other?
[2013-07-09 15:40:13 -0400] MrHeavy: Or was that a strictly academic "I don't understand why there are two" :)
[2013-07-09 15:41:02 -0400] BrianJ: anyone familiar with setting paths in windows during a chef run?
[2013-07-09 15:42:40 -0400] BrianJ: having issues calling out to git after installing it in a previous recipe: http://pastie.org/8124140
[2013-07-09 15:49:29 -0400] AskSteve: I'm using not_if { search(:node, "role:db") } in a template block and it appears to ignore the search results. Can anybody help me with the syntax?
[2013-07-09 15:49:57 -0400] gleam: i don't understand what you'er trying to do
[2013-07-09 15:50:08 -0400] gleam: skip if the node that's running has role[db] in its run list?
[2013-07-09 15:50:35 -0400] AskSteve: yes
[2013-07-09 15:50:46 -0400] AskSteve: I want it on every other role just not role:db
[2013-07-09 15:50:54 -0400] gleam: you should be able to do not_if { node.run_list.include?("role[db]") }
[2013-07-09 15:50:56 -0400] gleam: or somethin glike that
[2013-07-09 15:51:15 -0400] gleam: or wrap the entire thing in an unless ... end
[2013-07-09 15:51:46 -0400] AskSteve: testing...
[2013-07-09 15:55:29 -0400] AskSteve: that worked and the other one didn't, thanks
[2013-07-09 16:04:55 -0400] jkeiser: MrHeavy: I'm not using either yet.  Just an academic thing
[2013-07-09 16:22:57 -0400] Sleepy1: gleam can you wrap your commands in an if statement like
[2013-07-09 16:23:39 -0400] Sleepy1: if node[:instance_role] == "db"
[2013-07-09 16:24:28 -0400] sarkis: hey all, been reading more into chef lately, last i looked there was no equivalent to a --noop like puppet.. seems now theres a --why-run
[2013-07-09 16:25:01 -0400] sarkis: although the little i can find on why-run says it's not so reliable in the way dependencies are mimic'ed whats the downsides?
[2013-07-09 16:28:22 -0400] jtimberman: sarkis: You may be interested in this post by someara: http://blog.afistfulofservers.net/post/2012/12/21/promises-lies-and-dryrun-mode/
[2013-07-09 16:35:41 -0400] sarkis: thank you
[2013-07-09 16:36:02 -0400] sarkis: oh yea thats the one and only post i could find on the subject :P
[2013-07-09 16:36:14 -0400] jtimberman: btm did a pretty good mailing list post on the chef users list about the topic
[2013-07-09 16:36:22 -0400] sarkis: was referring to that post when i said the little i read on the subject
[2013-07-09 16:36:38 -0400] jtimberman: i think this is it: http://lists.opscode.com/sympa/arc/chef/2012-02/msg00257.html
[2013-07-09 16:36:58 -0400] jtimberman: the problem is of course unreliable underlying components :)
[2013-07-09 16:37:22 -0400] rayrod2030: does chef server respect the cookbook depency versions in cookbook metadata?
[2013-07-09 16:38:12 -0400] rayrod2030: or is the default behavior to just use the latest cookbook version available when there is no version locks in an environment.
[2013-07-09 16:39:50 -0400] sarkis: makes sense.. and easy enough to have vms that mirror prod pretty well to test major changes to infrastructure, thanks jtimberman
[2013-07-09 16:40:00 -0400] usha: hi guys
[2013-07-09 16:40:05 -0400] usha: i need ur help
[2013-07-09 16:40:10 -0400] prometheanfire: if I have multible cookbooks using the same data from node attributes, would it be considered best practices to combine all those attributes into one set (instead of having them seperate)?
[2013-07-09 16:40:17 -0400] usha: i am trying hosted chef
[2013-07-09 16:40:28 -0400] usha: and setup the workstation
[2013-07-09 16:41:12 -0400] prometheanfire: instead of having [:rackspacecloud][:rackspace_username] and [:cloud_monitoring][:rackspace_username], it would be just [:rackspace][:rackspace_cloud_username]
[2013-07-09 16:44:12 -0400] ssd7: Ohai Chefs
[2013-07-09 16:45:24 -0400] usha: guys any chef experts
[2013-07-09 16:45:47 -0400] ssd7: usha: We do what we can.  Have  question?
[2013-07-09 16:45:55 -0400] ssd7: s/Have /Have a/
[2013-07-09 16:46:06 -0400] usha: i am getting unauthporized exception 401 when running chef-client with hosted chef
[2013-07-09 16:46:09 -0400] usha: can u please help
[2013-07-09 16:46:56 -0400] usha: ssd7: i am just following the doc..but no luck
[2013-07-09 16:47:35 -0400] ssd7: usha: Can you use pastebin or gist to post the command you are running and the error message you are getting.
[2013-07-09 16:47:56 -0400] ssd7: Most likely, you either have a bad key or your clock is out of sync
[2013-07-09 16:48:22 -0400] usha: i am not sure wht is pastebin or gist
[2013-07-09 16:48:30 -0400] jtimberman: rayrod2030: Correct: if you don't have a version pinned in an environment, chef will download the latest version.
[2013-07-09 16:48:48 -0400] usha: i checked the all the keys looks good
[2013-07-09 16:49:00 -0400] usha: i am able to setup my workstation
[2013-07-09 16:49:21 -0400] prometheanfire: ssd7: I have a question :P
[2013-07-09 16:49:45 -0400] prometheanfire: if I have multiple cookbooks using the same data from node attributes, would it be considered best practices to combine all those attributes into one set (instead of having them seperate)?
[2013-07-09 16:49:49 -0400] prometheanfire: instead of having [:rackspacecloud][:rackspace_username] and [:cloud_monitoring][:rackspace_username], it would be just [:rackspace][:rackspace_cloud_username]
[2013-07-09 16:49:49 -0400] ssd7: usha: https://gist.github.com/
[2013-07-09 16:50:30 -0400] rayrod2030: jtimberman: Thanks for that clarification.  We have changed to the berkshelf way and love it but are going through what I imagine everybody else has in this process which is finding out how to merge/convert our older chef-repo/knife-spork workflow to the berkshelf workflow.
[2013-07-09 16:50:47 -0400] ssd7: prometheanfire: If those two really have no reason to ever be different, I would typically choose the one place that makes the most semantic sense and use that location for the data.
[2013-07-09 16:51:01 -0400] rayrod2030: Still not entirely sure how we manage/pin versions once we upload to chef server.
[2013-07-09 16:51:19 -0400] prometheanfire: ssd7: sounds good to me
[2013-07-09 16:52:13 -0400] usha: ssd7: i am able to setup managed workstation ..knife client list is returning good..
[2013-07-09 17:09:39 -0400] ryan_roemer: Hi -- does anyone know how to get the "node.chef_environment" values within a Chef role?
[2013-07-09 17:09:56 -0400] ryan_roemer: I'm using chef 0.10.x
[2013-07-09 17:11:04 -0400] asharp: my run list is recipe[homebrew], recipe[mysql::server] for a mac. i get this error for the service "mysql" resource:---- Begin output of launchctl load -w '' ----
[2013-07-09 17:11:05 -0400] asharp: STDOUT:
[2013-07-09 17:11:05 -0400] asharp: STDERR: launchctl: Couldn't stat(""): No such file or directory
[2013-07-09 17:11:05 -0400] asharp: nothing found to load
[2013-07-09 17:33:52 -0400] Chris_____: Hi!  I was wondering if someone could help me with an issue.  When I installed the knife-esx plugin for chef, I started to get the following message whenever I run any knife command (it was not there before I installed the plugin).  Could someone please help me disable that message?
[2013-07-09 17:34:12 -0400] Chris_____: Sorry, message is
[2013-07-09 17:34:12 -0400] Chris_____: D, [2013-07-09T12:30:27.731654 #35069] DEBUG -- : Shutdown completed cleanly
[2013-07-09 17:43:14 -0400] jleveque: Hi. I would like to know I to call a LWRP which is included in the current cookbook from a recipe of this current cookbook. I tried with cookbookname_providername "newressourcename" and providername "newresourcename" but it does not work. Thanks
[2013-07-09 17:45:41 -0400] gleam: if your provider is named "instance" in the cookbook "nginx" then it'd be nginx_instance "whatever"
[2013-07-09 17:49:55 -0400] jleveque: gleam, thanks, I think I misunderstood the error message, my error is in fact located inside the loadcurrentressource part of my provider which I don;t understand well.
[2013-07-09 17:55:25 -0400] jleveque: Can someone explain me the @current_resource = Chef::Resource::Lwrpname.new(@new_resource.name) , in the load_current_ressource method ? I don't understand the right part of the affectation
[2013-07-09 17:56:09 -0400] jleveque: The run give this error message : "uninitialized constant Chef::Resource::Lwrpname"
[2013-07-09 17:57:45 -0400] adamjk-dev: heyo
[2013-07-09 17:57:58 -0400] adamjk-dev: is there a way to have a remote file resouce create directories where the file is intended to live?
[2013-07-09 17:58:23 -0400] adamjk-dev: or do you need to create the full directory path prior to executing a remote file resource?
[2013-07-09 17:58:37 -0400] adamjk-dev: i.e. to grab a remote file from the web and put it into /tmp/foo/bar/file
[2013-07-09 17:58:44 -0400] adamjk-dev: do you need to first create /tmp/foo/bar?
[2013-07-09 17:59:09 -0400] adamjk-dev: or can remote_file do that? (I quickly looked here: http://docs.opscode.com/resource_remote_file.html)
[2013-07-09 18:00:22 -0400] WAlbenzi: I am attempting a wrapper cookbook for the chef-client::cron recipe.  The community included minitest fails to detect the file created /etc/cron.d/chef-client and the text within it.  Is there a way to exclude a community included minitest, without forking the cookbook or waiting for the pull request to be integrated.
[2013-07-09 18:01:29 -0400] WAlbenzi: While it seems to be a bad idea to exclude tests, it seems like a fork and fix would be worse.
[2013-07-09 18:03:25 -0400] dissolve: hey everyone.  I am running an internal server for our dev team so the server doesn't have an FQDN, for my own machine that is fine, but for genrated machines, they do not have an updated hosts file.  any idea how i can get around this?
[2013-07-09 18:04:52 -0400] dissolve: sidenote, this is with proxmox, so i suppose one solution is to open up the image tars and add the line to /etc/hosts.  didn't know if there is a better way
[2013-07-09 18:07:32 -0400] inimit: is there a good apache ssl cookbook to manage site's ssl certificates?
[2013-07-09 18:11:18 -0400] superbenk: We're running Chef 10.20.0 & experiencing really slow chef-client runs after awhile.  Trying to figure out where the bottleneck is on the Chef server & having some difficulty.  Is there any known trouble spots I should look for?
[2013-07-09 18:12:08 -0400] superbenk: Thinking it might be RabbitMQ or something related to searches
[2013-07-09 18:12:18 -0400] trobrock: superbenk: it is on the server side where the slowness is? Are you running chef-client in forking mode? After a while without forking chef-client will bloat in memory usage
[2013-07-09 18:12:35 -0400] jessicab1: superbenk: is it possible its just a memory leak? theres this bug on that version: http://tickets.opscode.com/browse/CHEF-3432
[2013-07-09 18:12:43 -0400] superbenk: No, we're running chef-client in cron for that very reason
[2013-07-09 18:13:12 -0400] superbenk: It's definitely the server.  If we reboot it, it will get better for awhile
[2013-07-09 18:18:20 -0400] jgood: Is there a way i can use something like the UNC path to copy files off of an "ideal" server? If possible how would I provide credentials to the existing server?
[2013-07-09 18:25:40 -0400] asharp: my chef script starts with using homebrew, and ends with writing to a root-only file (i am using the cookbook_file resource). homebrew requires me not to be root, and the file write requires me to be root. any ideas?
[2013-07-09 18:29:51 -0400] coderanger: asharp: Change the homebrew provider to run as your user
[2013-07-09 18:31:04 -0400] asharp: coderanger: that sounds great. is that an attribute for homebrew cookbook?
[2013-07-09 18:35:32 -0400] cjerdonek: if an attribute file in a third-party cookbook has conditional logic that depends on reading a certain node attribute value, is there a way to set that attribute prior to executing the attribute file?
[2013-07-09 18:40:16 -0400] miah: no
[2013-07-09 18:42:50 -0400] cjerdonek: miah: was that an answer to me?
[2013-07-09 18:47:01 -0400] aneto: crickets
[2013-07-09 18:55:04 -0400] deed02392: hi guys, trying to install sphinx from source under chef-solo, got an issue where it seems like it's not using an attribute
[2013-07-09 18:55:17 -0400] deed02392: the same code works OK in a client-server setup but I'm sure one of you guys knows exactly why
[2013-07-09 18:56:00 -0400] cjerdonek: deed02392: where is the source and which attribute?
[2013-07-09 18:56:17 -0400] deed02392: the source is on a website, it tries to download it to proceed with compilation
[2013-07-09 18:56:30 -0400] deed02392: the attribute is the desired version
[2013-07-09 18:56:37 -0400] deed02392: so i choose 2.0.8 for version
[2013-07-09 18:56:45 -0400] cjerdonek: deed02392: i meant the source code for the cookbook/recipe
[2013-07-09 18:56:45 -0400] deed02392: and it tries to GET http://blah.com/2.0.8.tgz
[2013-07-09 18:56:57 -0400] deed02392: oh right, in community repos
[2013-07-09 18:57:14 -0400] deed02392: http://community.opscode.com/cookbooks/sphinx
[2013-07-09 18:57:39 -0400] guix_: Hi all, any has used the ifconfig resource to set the mtu value under centos 6.3?
[2013-07-09 19:00:02 -0400] cjerdonek: deed02392: on what line of the recipe is it not using the version attribute?
[2013-07-09 19:00:09 -0400] deed02392: 26 of source.rb
[2013-07-09 19:00:35 -0400] deed02392: it does a remote_file sphinx_tar do
[2013-07-09 19:01:28 -0400] cjerdonek: deed02392: it looks like that attribute defaults to nil. have you tried setting that node attribute value in a cookbook prior to iincluding the sphinx one?
[2013-07-09 19:02:06 -0400] deed02392: yeah cjerdonek, I include it from another recipe and I overwrite the attribute by first including sphinx's, then setting my own in the 'wrapping' recipe
[2013-07-09 19:02:45 -0400] deed02392: ie, include_attribute 'sphinx'; default[:sphinx][:version] = '2.0.8'
[2013-07-09 19:03:03 -0400] cjerdonek: deed02392: have you tried setting the value *before* the line where you include the sphinx recipe
[2013-07-09 19:03:50 -0400] deed02392: hm no cjerdonek, I'm sure I came here for advice in that regard before and it was put to me that if I set any values before including, my settings would be overwritten, because chef takes from the last set value
[2013-07-09 19:05:51 -0400] cjerdonek: no, attribute precedence in chef isn't related so much to evaluation order. see here for example http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2013-07-09 19:06:15 -0400] deed02392: oh right, well at least there is consistence cjerdonek :D
[2013-07-09 19:06:28 -0400] deed02392: i suspect if I take this in i will resolve my issues
[2013-07-09 19:06:29 -0400] deed02392: thanks a lot
[2013-07-09 19:06:34 -0400] cjerdonek: i think it should work if you just set the default value prior to including the recipe
[2013-07-09 19:07:22 -0400] cjerdonek: np
[2013-07-09 19:11:33 -0400] adamjk-dev: anyone familiar with the ark cookbook? https://github.com/opscode-cookbooks/ark
[2013-07-09 19:11:56 -0400] adamjk-dev: I upgraded to the latest version and some things started failing because of a missing directory (./bin)
[2013-07-09 19:12:56 -0400] guix_: Any one knows why the mtu value is not being applied when using the ifconfig resource?
[2013-07-09 19:19:15 -0400] deed02392: hmm cjerdonek did you mean set sphinx's attributes in the wrapping cookbook's recipe, or attributes?
[2013-07-09 19:21:12 -0400] deed02392: I have a feeling that making a cookbook which includes other cookbook recipes is not recommended
[2013-07-09 19:21:20 -0400] cjerdonek: deed02392: i think either would work, but i would start by trying to define it in an attribute file of the wrapping cookbook
[2013-07-09 19:21:59 -0400] deed02392: that's what I do cjerdonek, the latter I mean
[2013-07-09 19:22:21 -0400] deed02392: my cookbook web app has a recipe which just does include_recipe 'sphinx'
[2013-07-09 19:22:25 -0400] cjerdonek: deed02392: it's very common
[2013-07-09 19:22:40 -0400] deed02392: and the cookbook web app has an attribute file called sphinx.rb
[2013-07-09 19:22:55 -0400] deed02392: in there it does include_attribute 'sphinx' then goes on to do a bunch of default[] directives
[2013-07-09 19:23:32 -0400] deed02392: it seems to work for a bunch of other recipes, the only difference I can see is that sphinx is defining attributes like default[:sphinx] and others are default['nginx'] etc
[2013-07-09 19:24:34 -0400] guix_: Looks like tu ifconfig provider is missing a line for mtu when generating the configuration file.
[2013-07-09 19:24:48 -0400] cjerdonek: i don't think you need the include_attribute line. but if you can't get things to work by defining the default value in the attribute file, try setting the attribute value in a line before including the recipe
[2013-07-09 19:25:34 -0400] deed02392: ok so in the wrapping cookbook's recipe which includes the sphinx recipe?
[2013-07-09 19:25:53 -0400] cjerdonek: yeah
[2013-07-09 19:31:41 -0400] cjerdonek: deed02392: node.default[:sphinx][:version] = 'blah'
[2013-07-09 19:32:01 -0400] deed02392: ;)
[2013-07-09 19:32:11 -0400] deed02392: I was just struggling with forgetting that node. bit
[2013-07-09 19:32:49 -0400] sprack: anyone successfully used the route53 cookbook? I keep getting "Cannot find a resource for route53_record"
[2013-07-09 19:32:51 -0400] deed02392: yea this seems to be working
[2013-07-09 19:33:02 -0400] deed02392: it's odd though, I don't understand why it is only an issue for this particular cookbook
[2013-07-09 19:33:39 -0400] deed02392: do you think the use of [:sphinx] is a possible cause?
[2013-07-09 19:33:48 -0400] deed02392: that's the only thing I can see that makes it different to the others that work
[2013-07-09 19:34:06 -0400] deed02392: and I don't think it's an issue when using chef-client
[2013-07-09 19:34:22 -0400] cjerdonek: hmm, i doubt it. there's probably just something else not being noticed
[2013-07-09 19:44:06 -0400] deed02392: the debug log level isn't giving any clues either
[2013-07-09 19:47:47 -0400] nate`: what is wrong with this?
[2013-07-09 19:47:48 -0400] nate`: service 'octopress' do action [:enable, :start]
[2013-07-09 19:47:50 -0400] nate`: end
[2013-07-09 19:49:58 -0400] nathanmilford: Ahoy, migrating from a gem based (system ruby) chef-server 10.16.0 to an omnibus based erchef-server 11.0.8 rpm on CentOS 5.  Following the instruction set at http://www.opscode.com/blog/2013/03/12/5106/ I can knife backup from the old server but knife restore on the new server does not play well.  Nothing gets installed and I get output like this => http://pastebin.com/LqHWkgZW  Thoughts?
[2013-07-09 19:51:28 -0400] aramus_: Hello, what is the "chef" way to make a recipe run again if there is an error? Do you simply redirect the output of the knife command to a file and parse for errors?
[2013-07-09 19:56:52 -0400] kk__: any way to pass attributes to a recipe via chef-client -o -j w/o a json file, e.g. inline json?
[2013-07-09 19:57:56 -0400] kk__: bryan mclelland [opscode] seems to think this isn't a feature they would encourage, http://tickets.opscode.com/browse/CHEF-1918
[2013-07-09 19:58:55 -0400] jessicab1: aramus_: youd probably need to give more info on the specific example when you need to do that? like i normally just handle errors in a cookbook by adding begin/rescue blocks.. that works for most things
[2013-07-09 19:59:11 -0400] deed02392: aramus_, I think the chef way is that your recipe handles any errors that might come up gracefully
[2013-07-09 19:59:44 -0400] kk__: use case: bash script that takes parameters and calls a chef-client -o with those params, my current workaround is to create extra recipes but thats becoming non-dry
[2013-07-09 20:00:22 -0400] aramus_: deed02392: could you give an example?
[2013-07-09 20:00:50 -0400] jessicab1: kk__:  setting attributes on a node in general is kind of advised against.. creates special snowflakes that are hard to manage later
[2013-07-09 20:01:28 -0400] jessicab1: kk__: well, attributes specific to just that one node at least.. seems like most cases you could just script to handle
[2013-07-09 20:03:24 -0400] kk__: jessicab1: setting attributes via roles is recommended
[2013-07-09 20:04:11 -0400] kk__: jessicab1: how would you script to pass a shell script parameter to a chef recipe?
[2013-07-09 20:04:27 -0400] deed02392: cjerdonek,
[2013-07-09 20:04:39 -0400] deed02392: i just decided to 'mv' sphinx's attribute file out the way
[2013-07-09 20:04:46 -0400] jessicab1: kk__: isnt there something about the node itself that could give you that parameter though? like if its based on the network its in, etc
[2013-07-09 20:05:30 -0400] deed02392: i compared the debug data for nginx and sphinx and I did notice chef announced it 'had already seen' an nginx attribute file
[2013-07-09 20:05:34 -0400] deed02392: and it did not for sphinx
[2013-07-09 20:05:43 -0400] kk__: jessicab1: example: ~$ dbsync redis OR pgsql OR all
[2013-07-09 20:06:07 -0400] kk__: jessicab1: dbsync is a bash script that takes the parameters, and runs chef-client -o "recipe[cookbook::sync-redis]"
[2013-07-09 20:06:14 -0400] asharp: the majority of my custom recipe needs to be done as a normal user. but certain things must be done as root. any suggestions?
[2013-07-09 20:07:07 -0400] kk__: jessicab1: so rather than write three separate recipes, one for each script parameter, id like to pass the parameters to the recipe via json attributes.  but id inline so i don't need to create three more json files
[2013-07-09 20:07:38 -0400] kk__: appears others are interested in this functionality, with reason
[2013-07-09 20:07:59 -0400] kk__: (from google search results)
[2013-07-09 20:09:57 -0400] sprack: is there a way to verify that after an include_recipe the wrapping cookbook has loaded it?
[2013-07-09 20:11:42 -0400] jgood: Is there any way to start a chef-client run from the webui?
[2013-07-09 20:11:51 -0400] cjerdonek: sprack: for debugging purposes, or in general?
[2013-07-09 20:13:01 -0400] sprack: cjerdonek: for debugging. I'm trying to figure out why after I include the route53 recipe I still get a "Cannot find a resource" error
[2013-07-09 20:14:04 -0400] cjerdonek: sprack: you can try sprinkling Chef::Log.info lines around. what resource isn't found?
[2013-07-09 20:15:14 -0400] sprack: cjerdonek: route53_record. that cookbook recipe has a record.rb in provider and it's basically a copy/paste of the README example at this point
[2013-07-09 20:19:05 -0400] cjerdonek: sprack: do you have a depends line in metadata.rb?
[2013-07-09 20:19:13 -0400] kk__: jessicab1: well thanks for the dialogue, I'm creating separate recipes.
[2013-07-09 20:19:25 -0400] sprack: cjerdonek: yes
[2013-07-09 20:20:46 -0400] sprack: cjerdonek: the initial portion of the route53 recipe load and checks package dependencies, but once I call the provider i get the error
[2013-07-09 20:20:51 -0400] rracterr: Looking for some ironfan advise, anyone here got any experience?
[2013-07-09 20:39:18 -0400] rava: hey guys, trying to install chef via the chef-server cookbook (pre omnibus chef11 tag) on ubuntu 11.10 and getting arguement errors for gem_package http11_client
[2013-07-09 20:39:32 -0400] rava: this is for chef-server version 10.26.0
[2013-07-09 20:41:00 -0400] derks: I'm using openvpn cookbook... everytime chef-client runs it restarts openvpn... and our vpn connection from the office drops for about 30-45 seconds
[2013-07-09 20:41:14 -0400] derks: seems like restarting openvpn *every* time chef runs is a bad idea
[2013-07-09 20:41:15 -0400] derks: no?
[2013-07-09 20:41:40 -0400] derks: is there any kind of 'notifies :restart *only if something changed*'?
[2013-07-09 20:43:04 -0400] rava: @derks thats how notifies work. in the block you use it, make sure there's idempotent logic
[2013-07-09 20:43:36 -0400] derks: rava "idempotent logic"?
[2013-07-09 20:44:20 -0400] derks: rava: https://github.com/opscode-cookbooks/openvpn/blob/master/recipes/default.rb#L116
[2013-07-09 20:45:30 -0400] rava: @derks ie. a block with an "only_if" or "not_if", or a resource that defines @current_resource
[2013-07-09 20:46:11 -0400] derks: rava in the link i posted above (for openvpn) what would you suggest there?  surprised opscode hasn't had an issue with it
[2013-07-09 20:46:15 -0400] rava: @current_resource.exists
[2013-07-09 20:46:42 -0400] rava: @derks I almost never use just community cookbooks
[2013-07-09 20:47:03 -0400] rava: i always create a wrapper cookbook, that calls the appropriate recipes and resources depending on config
[2013-07-09 20:47:38 -0400] rava: though you should run with debug flag to find out which block is calling the restart
[2013-07-09 20:48:01 -0400] rava: template resources are already idempotent
[2013-07-09 20:48:05 -0400] derks: we do use wrapper cookbooks also
[2013-07-09 20:48:28 -0400] derks: rava, ok.. good point i will run with debug and verify the restart
[2013-07-09 20:49:10 -0400] rava: it might be the service resource at the bottom, that should be [:enable, :start]
[2013-07-09 20:49:12 -0400] rava: imo
[2013-07-09 20:50:06 -0400] rava: i'm almost positive it's that last service block
[2013-07-09 20:50:37 -0400] BrianJ: If i need to set an path variable during a chef run so that the rest of the run uses it, how do I go about doing this?
[2013-07-09 20:51:10 -0400] rava: BrianJ: set the environment variable in an earlier recipe in the run_list
[2013-07-09 20:51:39 -0400] BrianJ: using the env resourse?
[2013-07-09 20:51:53 -0400] BrianJ: resource*
[2013-07-09 20:51:55 -0400] rava: that's what i use
[2013-07-09 20:52:49 -0400] rava: that's what i use for windows
[2013-07-09 20:52:58 -0400] rava: ruby has ENV for *nix machines
[2013-07-09 20:53:32 -0400] intu_omid: anyone know what's the best way on creating some type of a satillite setup for chef server ?
[2013-07-09 20:53:54 -0400] intu_omid: a master server and bounch of clients
[2013-07-09 20:54:10 -0400] BrianJ: so if I wanted to update the system path, i'd do something like: http://pastie.org/8125889
[2013-07-09 20:54:20 -0400] intu_omid: not clients ... othet servers acting as slaves
[2013-07-09 20:55:32 -0400] rava: intu_omid: payed for chef has that
[2013-07-09 20:56:03 -0400] rava: the ability to create chef api hosts that talk to a back end
[2013-07-09 21:10:40 -0400] derks: rava ... ok, so I found that the service is restarting due to a template block.  that same template block exists in my wrapper cookbook
[2013-07-09 21:11:12 -0400] derks: so i assume the cook book runs, sets the file, restarts.. then my wrapper overwrites the same file
[2013-07-09 21:11:39 -0400] derks: how can i override the template of an opscode cookbook without having to maintain that cookbook?
[2013-07-09 21:12:47 -0400] rava: you can reference the template source as belonging in another cookbook when declaring your own template blocks
[2013-07-09 21:13:16 -0400] derks: but the source *does* live in my (wrapper) cookbook
[2013-07-09 21:13:52 -0400] rava: so why worry about the templates in the community coobkook? unless you're just calling the default recipe, then no
[2013-07-09 21:14:00 -0400] rava: are you sure it's a template update that's causing it?
[2013-07-09 21:14:53 -0400] derks: that is what the debug output showed
[2013-07-09 21:14:54 -0400] derks: rava
[2013-07-09 21:14:55 -0400] derks: INFO: template[/etc/openvpn/server.up.sh] sending restart action to service[openvpn] (delayed)
[2013-07-09 21:15:42 -0400] rava: ah, gotta figure out why the template keeps getting changed then
[2013-07-09 21:16:05 -0400] derks: rava, its because i overwrite that file in my wrapper cookbook
[2013-07-09 21:16:13 -0400] derks: how else can i do that without maintaining openvpn?
[2013-07-09 21:17:19 -0400] rava: i see what's going on, you're overwriting a template the original cookbook layed down?
[2013-07-09 21:17:57 -0400] derks: yes
[2013-07-09 21:17:57 -0400] rava: if so, then you have to decide if you really need to fully overwrite the template or if you can just provide the attributes and values in your wrapper cookbook
[2013-07-09 21:18:07 -0400] derks: ok
[2013-07-09 21:18:09 -0400] rava: otherwise, you're sol
[2013-07-09 21:18:17 -0400] rava: unless you want to do all your own installation logic
[2013-07-09 21:18:44 -0400] rava: chef's doing what it's supposed to, you're stuff's just making it repeat itself
[2013-07-09 21:19:53 -0400] derks: rava, this is the file I need to override
[2013-07-09 21:19:53 -0400] derks: https://github.com/opscode-cookbooks/openvpn/blob/master/templates/default/server.up.sh.erb
[2013-07-09 21:20:27 -0400] derks: so basically, they even have an example of how to do it with attributes... but the template is useless
[2013-07-09 21:21:06 -0400] rava: if you cant wrap around the way the community book does it, fork it and submit a patch :)
[2013-07-09 21:21:11 -0400] rava: and use your fork
[2013-07-09 21:21:20 -0400] derks: right on'
[2013-07-09 21:21:22 -0400] derks: will do
[2013-07-09 21:21:25 -0400] derks: thank you for the help
[2013-07-09 21:21:42 -0400] rava: no worries, i've run into situations like this myself with internal providers and stuff from some cookbooks
[2013-07-09 21:36:57 -0400] dsteen: Is there anyway to have chef run a few commands on bootstrap prior to doing anything else?  I need to have it set up a local IP and dns or else nothing will work.
[2013-07-09 21:39:19 -0400] slillibridge: Is there any way to have chef-client display the stdout of a bash resource? setting log_level = "debug" doesn't seem to be doing it (this is from a chef-client run on a vagrant vm).
[2013-07-09 21:39:21 -0400] jessicab1: dsteen: you could create a custom template file
[2013-07-09 21:39:40 -0400] dsteen: hm.   would that override the default, or run in addition to it?
[2013-07-09 21:40:03 -0400] jessicab1: dsteen: it overrides the default.. but you can just take the default, chef_full and just add your command to it
[2013-07-09 21:40:16 -0400] dsteen: cool!  I'll give that a shot.  thanks!
[2013-07-09 21:40:53 -0400] jessicab1: dsteen: this is the current default btw.. it can be tricky to find sometimes - https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-07-09 21:41:17 -0400] dsteen: cool.  thanks!
[2013-07-09 21:41:18 -0400] jessicab1: slillibridge: ive tried to do that too, but ive never found a way.. i always have to use the ruby %x[ ] call to get the stdout
[2013-07-09 22:10:45 -0400] aramus_: Are some opscode pags down for anybody else?
[2013-07-09 22:10:46 -0400] aramus_: http://docs.opscode.com/essentials_cookbook_lwrp_resources_common_conditionals.html
[2013-07-09 22:11:05 -0400] matti: 404
[2013-07-09 22:11:21 -0400] aramus_: Okay, that's good that I'm not alone.
[2013-07-09 22:11:34 -0400] matti: aramus_: http://webcache.googleusercontent.com/search?q=cache:-mZf4MSZS6oJ:docs.opscode.com/essentials_cookbook_lwrp_resources_common_conditionals.html+&cd=1&hl=en&ct=clnk&gl=uk
[2013-07-09 22:12:33 -0400] aramus_: Thanks!
[2013-07-09 22:12:44 -0400] matti: :>
[2013-07-09 22:12:48 -0400] aramus_: Google once again saves the day.
[2013-07-09 22:27:52 -0400] matti: ;p
[2013-07-09 22:27:54 -0400] matti: Yeah
[2013-07-09 22:28:10 -0400] matti: aramus_: If not Google, then NFS must have a backup ;p
[2013-07-09 22:28:13 -0400] matti: *grin*
[2013-07-09 22:28:17 -0400] matti: NFS -> NSA ;p
[2013-07-09 22:37:04 -0400] castro1688: Hey everyone.. Anyone have any tips on how to figure out why a recipe in my role is being executed before everything else? It needs to be last, but it keeps running it first.. thanks!
[2013-07-09 22:40:42 -0400] matti: Something is including it?
[2013-07-09 22:41:02 -0400] castro1688: i dont have any include_recipe calls
[2013-07-09 22:42:19 -0400] matti: Check depends too.
[2013-07-09 22:42:27 -0400] castro1688: aah.. depends.. ok
[2013-07-09 22:42:40 -0400] matti: Maybe it has something that is executing compile time?
[2013-07-09 22:42:56 -0400] castro1688: so a depends in metadata.rb would cause it run possibily?
[2013-07-09 22:43:17 -0400] matti: I am not sure actually.
[2013-07-09 22:43:40 -0400] castro1688: oh wow.. i think something just clicked.. i didnt use ruby block and i had a lot of ruby code..
[2013-07-09 22:43:43 -0400] jessicab: i dont think it does.. i use depends to depend on an lwrp.. and it doesnt run the default recipe for example
[2013-07-09 22:43:54 -0400] castro1688: so it much be running it when compiling everything instead of waiting
[2013-07-09 22:45:59 -0400] jtimberman: matti: aramus_: http://docs.opscode.com/resource_common.html
[2013-07-09 22:46:03 -0400] jtimberman: is where that page will go
[2013-07-09 22:46:19 -0400] jtimberman: sorry we don't have a redirect up yet
[2013-07-09 22:47:01 -0400] aramus_: Thanks! Was the page I mentioned earlier down or just deprecated?
[2013-07-09 22:47:51 -0400] matti: jtimberman: OK, cool!
[2013-07-09 22:47:51 -0400] matti: ;]
[2013-07-09 22:48:34 -0400] jtimberman: deprecated
[2013-07-09 22:58:16 -0400] jtimberman: content is on the page i linked
[2013-07-09 23:10:14 -0400] aramus_: Hello, is this correct syntax for an only_if conditional in a resource?: only_if do File.exists?(/tmp/one) and File.exists?(tmp/two)  end
[2013-07-09 23:18:02 -0400] MrBIOS: hey folks, I'm getting a recipe compilation error when running chef-client on a target node, with the error "wrong number of arguments (2 for 1)"
[2013-07-09 23:18:10 -0400] rava: can anyone help me figure out why the rubygems-install recipe for chef 10.x is failing on ubuntu 11.10? keeps puking when trying to install the gem http11_client
[2013-07-09 23:18:15 -0400] MrBIOS: this is in relation to a recipe that doesn't even apply to the machine
[2013-07-09 23:23:54 -0400] MrBIOS: hmm, apparently this is a chef 10 vs 11 thing
[2013-07-09 23:24:02 -0400] MrBIOS: but I have no idea how to resolve the problem
[2013-07-09 23:30:21 -0400] atomi: what name should I use for my roles json file?
[2013-07-09 23:32:06 -0400] atomi: yeah, I guess it should be descriptive
[2013-07-09 23:45:39 -0400] rava: why does the chef10 branch community cookbook try installing http11_request instead of the em-http-request library that gem uses normally for chef-expander?
[2013-07-09 23:45:46 -0400] rava: the cookbook keeps puking on me due to that
[2013-07-09 23:46:40 -0400] gkra: bah
[2013-07-09 23:46:48 -0400] gkra: how do I delete a role from all nodes that have it?
[2013-07-09 23:47:13 -0400] gkra: not from the run_list, but the roles attribute...
[2013-07-09 23:58:32 -0400] gkra: nevermind, I guess roles are updated as the run_list is changed.
