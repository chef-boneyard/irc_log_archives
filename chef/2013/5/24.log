[2013-05-24 00:10:57 -0400] monokrome: Since chef master requires SSL now
[2013-05-24 00:11:02 -0400] monokrome: How do I install my certs for Chef to use?
[2013-05-24 00:11:19 -0400] monokrome: I think that this issue is that I'm request on HTTP and HTTPS is required now
[2013-05-24 00:13:28 -0400] stormerider: you can enable non-ssl
[2013-05-24 00:13:40 -0400] stormerider: but all that would be tweaked via /etc/chef-server/chef-server.rb
[2013-05-24 00:15:52 -0400] stormerider: like mine is here: https://gist.github.com/stormerider/7900427cebd98d3c5a5e
[2013-05-24 00:15:58 -0400] monokrome: Tahnks, stormerider
[2013-05-24 00:16:28 -0400] monokrome: There's no file called that
[2013-05-24 00:18:24 -0400] monokrome: stormerider: I think that I found the issue
[2013-05-24 00:18:29 -0400] monokrome: My server's /etc/chef directory is empty
[2013-05-24 00:21:45 -0400] stormerider: /etc/chef-server
[2013-05-24 00:22:20 -0400] stormerider: and you may not have a chef-server.rb file by default, but you can add it to adjust the default values
[2013-05-24 00:22:31 -0400] stormerider: then do chef-server-ctl reconfigure to apply the changes.
[2013-05-24 00:22:49 -0400] monokrome: stormerider: There's no validation.pem in there
[2013-05-24 00:22:55 -0400] monokrome: which explains why it doesn't validate
[2013-05-24 00:26:10 -0400] stormerider: i dont remember if that actually needs to exist on the filesystem in chef 11 or not
[2013-05-24 00:26:22 -0400] stormerider: i think it being in the DB is sufficient but im not 100% sure on that
[2013-05-24 00:37:15 -0400] mmccarthy: Hi all. I'm new to Chef and Ruby. Having some problems using knife-ec2. Keep getting this error: ERROR: Excon::Errors::BadRequest: Expected(200) <=> Actual(400 Bad Request)
[2013-05-24 00:37:36 -0400] mmccarthy: Can someone tell me how to turn on some debugging so I can figure out what the problem is?
[2013-05-24 00:41:33 -0400] stormerider: mmccarthy: looks like -VV should turn on max verbosity
[2013-05-24 00:42:48 -0400] mmccarthy: stormerider: Thanks, I literally just figured that out also. Unfortunately the debug doesn't help me too much.
[2013-05-24 00:43:43 -0400] stormerider: what'd it come back with?
[2013-05-24 00:45:06 -0400] mmccarthy: c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/excon-0.22.1/lib/excon/middlewares/expects.rb:10:in `response_call': Expected(200) <=> Actual(400 Bad Request)
[2013-05-24 00:45:07 -0400] mmccarthy:  (Excon::Errors::BadRequest)
[2013-05-24 00:45:07 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/excon-0.22.1/lib/excon/connection.rb:355:in `response'
[2013-05-24 00:45:07 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/excon-0.22.1/lib/excon/connection.rb:249:in `request'
[2013-05-24 00:45:07 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/fog-1.11.1/lib/fog/core/connection.rb:21:in `request'
[2013-05-24 00:45:07 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/fog-1.11.1/lib/fog/aws/compute.rb:384:in `_request'
[2013-05-24 00:45:08 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/fog-1.11.1/lib/fog/aws/compute.rb:379:in `request'
[2013-05-24 00:45:08 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/fog-1.11.1/lib/fog/aws/requests/compute/run_instances.rb:119:in `run_instances'
[2013-05-24 00:45:08 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/fog-1.11.1/lib/fog/aws/models/compute/server.rb:173:in `save'
[2013-05-24 00:45:09 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/fog-1.11.1/lib/fog/core/collection.rb:52:in `create'
[2013-05-24 00:45:09 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/knife-ec2-0.6.4/lib/chef/knife/ec2_server_create.rb:241:in `run'
[2013-05-24 00:45:10 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.4/lib/chef/knife.rb:460:in `run_with_pretty_exceptions'
[2013-05-24 00:45:10 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.4/lib/chef/knife.rb:173:in `run'
[2013-05-24 00:45:11 -0400] mmccarthy:         from c:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.4/lib/chef/application/knife.rb:123:in `run'
[2013-05-24 00:45:24 -0400] stormerider: woah, please gist things instead of dumping them into the channel
[2013-05-24 00:45:30 -0400] failshell: mmccarthy: please use a pastebin
[2013-05-24 00:45:43 -0400] mmccarthy: sorry
[2013-05-24 00:46:54 -0400] stormerider: hm. havent set up windows as a workstation before. but im guessing it's probably having trouble with the EC2 credentials
[2013-05-24 00:47:39 -0400] stormerider: do you have "knife[:aws_access_key_id]" and such in your knife.rb file?
[2013-05-24 00:47:54 -0400] mmccarthy: yes, without that I get different errors
[2013-05-24 00:48:13 -0400] mmccarthy: I thought it might be related to some sort of http request failure.
[2013-05-24 00:50:44 -0400] mmccarthy: With a deliberately bad key I get: Expected(200) <=> Actual(401 Unauthorized) (Excon::Errors::Unauthorized)
[2013-05-24 01:03:42 -0400] stormerider: interesting. can you use that key with other tools like ec2-describe-instances?
[2013-05-24 02:20:09 -0400] cjerdonek: is there a way to override data_bag values when running chef-solo?
[2013-05-24 02:21:03 -0400] coderanger: cjerdonek: override?
[2013-05-24 02:21:27 -0400] cjerdonek: temporarily set one for the purposes of the chef-solo run
[2013-05-24 02:22:07 -0400] cjerdonek: (i.e. replace the existing value)
[2013-05-24 02:26:10 -0400] coderanger: No, but you can just set it in general
[2013-05-24 02:30:30 -0400] cjerdonek: coderanger: can you elaborate? i would like to avoid putting config values specific to chef-solo (normally residing in Vagrantfile) alongside my other data_bag values
[2013-05-24 02:34:39 -0400] josephholsten: cjerdonek: https://github.com/edelight/chef-solo-search
[2013-05-24 02:35:40 -0400] josephholsten: oh, override? that's not going to make for easy to understand failure modes
[2013-05-24 02:36:40 -0400] josephholsten: I just use stub data bags for vagrant testing
[2013-05-24 02:37:59 -0400] cjerdonek: josephholsten: i was just thinking of something like Vagrantfile's chef.json hash (allowing you to override node attributes) but for data bags
[2013-05-24 02:38:37 -0400] cjerdonek: if it can't be done, then yeah, i can use an alternative
[2013-05-24 02:39:09 -0400] coderanger: cjerdonek: Yeah, not aware of anything integrated with vagrant, you could certainly make one though :)
[2013-05-24 02:40:07 -0400] cjerdonek: yes :) thanks both of you for your thoughts
[2013-05-24 02:56:49 -0400] |rt|: has anyone ever installed a chef client on a raspberry pi?
[2013-05-24 03:15:14 -0400] hman: Hi!
[2013-05-24 03:15:42 -0400] hman: I'm just having a little trouble with a LWRP definition not being recognised
[2013-05-24 03:17:55 -0400] kenke: hi all, can someone tell me how to return a value from provider to recipe?
[2013-05-24 03:18:55 -0400] |rt|: Looks like I'm having some luck getting chef client setup on the raspberry pi by installing from gems.  May look into building an omnibus for Raspbian.
[2013-05-24 03:19:25 -0400] coderanger: kenke: Not sure what you mean, providers don't return anything
[2013-05-24 03:19:49 -0400] kenke: yeah I need to return a value from provider is it possible?
[2013-05-24 03:19:51 -0400] coderanger: |rt|: I've heard of some people doing it, its slow since you end up swapping a lot
[2013-05-24 03:20:14 -0400] coderanger: kenke: Your question indicates a deeper issue, what you are trying to do such that you want to return something like that
[2013-05-24 03:20:38 -0400] |rt|: coderanger: yeah hadn't thought of that...only 512mb of ram
[2013-05-24 03:21:01 -0400] coderanger: |rt|: But throw a 1G swapfile on the SD card and it will work eventually
[2013-05-24 03:21:31 -0400] |rt|: coderanger: yeah...it's not a platform that I'd run the client on often...probably manually run when I need it
[2013-05-24 03:21:58 -0400] kenke: I creates a provider that will execute a command, and then search the command result for interested properties using regex, I hope I can return those properties to recipes
[2013-05-24 03:22:01 -0400] |rt|: coderanger: looking at developing some code around the Open Sprinkler project and would be nice to chef it all
[2013-05-24 03:22:33 -0400] coderanger: kenke: resources and providers don't return things because they are running effectively async from where they are defined
[2013-05-24 03:22:53 -0400] coderanger: Remember that recipe running is two phases, compilation and then execution
[2013-05-24 03:23:06 -0400] kenke: so I should use library ?
[2013-05-24 03:23:16 -0400] coderanger: kenke: Maybe, you are still being very vague though
[2013-05-24 03:23:44 -0400] coderanger: If you are just trying to initialize some node attributes, put that in an attributes file
[2013-05-24 03:25:13 -0400] densone: hey all.
[2013-05-24 03:25:27 -0400] densone: Anyone ever seen this error coming from knife-ec2/fog
[2013-05-24 03:25:29 -0400] densone: ERROR: Excon::Errors::BadRequest: Expected(200) <=> Actual(400 Bad Request)
[2013-05-24 03:26:03 -0400] kenke: hi range, https://gist.github.com/anonymous/38efdaf16799c42d7878 is the method I try to achieve
[2013-05-24 03:27:19 -0400] coderanger: kenke: What do you want to do with that output?
[2013-05-24 03:27:47 -0400] coderanger: You could either shove it into node attrs or use the run state hash
[2013-05-24 03:28:25 -0400] coderanger: Both are effectively global variables though, and we all know why loose coupling through global vars is dangerous
[2013-05-24 03:28:36 -0400] kenke: yeah
[2013-05-24 03:29:02 -0400] coderanger: Basically I don't follow the end goal still
[2013-05-24 03:29:22 -0400] coderanger: This doesn't sound like something that is convergent or resource-oriented
[2013-05-24 03:29:32 -0400] kenke: I try to create a reusable method/class which could return the value...
[2013-05-24 03:29:36 -0400] coderanger: so rethink your model around resource structures and you will probably have a better time
[2013-05-24 03:30:13 -0400] |rt|: how do you access the run state hash?  That may help me work around an issue I have with a mid chef-run ohai refresh within a lwrp
[2013-05-24 03:31:12 -0400] kenke: my goal is to create a method which can execute commands and find something that I am interested in the execution output
[2013-05-24 03:31:45 -0400] coderanger: |rt|: node.run_state
[2013-05-24 03:31:54 -0400] kenke: for example, command will be "cat account.txt"  and use regex to find the account names
[2013-05-24 03:31:59 -0400] coderanger: kenke: Sounds like a method for a library file then, not an LWRP
[2013-05-24 03:32:06 -0400] |rt|: nice I'll poke around that tomorrow some...thanks
[2013-05-24 03:32:23 -0400] kenke: sure, I will have a try
[2013-05-24 03:35:04 -0400] coderanger: kenke: Worth noting that you don't need to do a exec cat file, then read the function output into ruby, etc etc, you can just read the file in
[2013-05-24 03:37:24 -0400] kenke: ture, that is just a simple example, I need to use for execute some command to talk to some API and then parse the response to find something interesting
[2013-05-24 03:45:17 -0400] |rt|: got chef to run on the raspberry pi....ohia data is pretty funny....no detected cpu's according to the saved node data
[2013-05-24 03:54:12 -0400] juliancdunn: |rt|: oh really? that's awesome... I was going to try that this wknd
[2013-05-24 03:54:23 -0400] juliancdunn: maybe an ohai patch will be in order...
[2013-05-24 04:01:38 -0400] jroh: anyone know a good way to launch a long running background task from a chef recipe? without blocking chef-client on it
[2013-05-24 04:06:18 -0400] juliancdunn: jroh: set an "at" job? :)
[2013-05-24 04:07:59 -0400] jroh: I think I'll probably do an upstart task now that I'm thinking about it
[2013-05-24 04:12:49 -0400] jroh: bah. I was really hoping to use some chef ruby gem action.. it'd be really awesome if chef had backgroundable resources
[2013-05-24 05:24:41 -0400] juliancdunn: jroh: well, you could go insane and fork a subprocess... it's just Ruby after all :-P
[2013-05-24 05:37:18 -0400] xiaotian: hello everyone,  I am a newbie to hosted chef. I thought I undersdood what node is until I played with knife ec2 plugin and the web ui. when I pass -N <node-name> to 'knife ec2 server create' it actuall creates ec2 instance with <node-name> as instance name.
[2013-05-24 05:37:46 -0400] kenke: hi all, when I ran chef-client on nodes, when I called a method defined in my library, it was executed during compilation, how can I resolve this problem?
[2013-05-24 05:38:01 -0400] xiaotian: I thought node is a class of servers
[2013-05-24 06:04:13 -0400] BryanWB: is there a way to `git checkout` an older version of a file to a new path rather than overwrite the current version of the file?
[2013-05-24 06:07:32 -0400] BryanWB: z0mg! kitchen test REGEX ! fnicho is so far ahead of me
[2013-05-24 06:55:48 -0400] rava: so i wrote an lwrp that works great for installing packages from source, but i'm having trouble coming up with a good way to make it idempotent
[2013-05-24 06:55:59 -0400] rava: namely dealing with source files
[2013-05-24 06:56:05 -0400] rava: ~c source files
[2013-05-24 07:01:42 -0400] shimo: rava: people usually install the source package via remote_file to chef's cache_path
[2013-05-24 07:02:14 -0400] shimo: and then use notify/subscribe to run the make tasks
[2013-05-24 07:02:31 -0400] rava: and just skip if the tarball's sitting around?
[2013-05-24 07:02:34 -0400] alex88: morning guys, if I put default['nginx']['default_site_enabled'] = false into my attributes default.rb file and I include the nginx cookbook inside my recipe, will it overwrite its config right?
[2013-05-24 07:02:59 -0400] shimo: rava: yeah (that's automatic)
[2013-05-24 07:04:21 -0400] rava: i guess i was shooting myself in the foot trying to define it load_current_resource
[2013-05-24 07:04:35 -0400] rava: in terms of overly complex way of doing it
[2013-05-24 07:06:53 -0400] shimo: rava: there's one downside that most people usually ignore. if you have to return to a previously installed version, the package is already there, so notify/subscribe won't fire
[2013-05-24 07:07:54 -0400] rava: wouldn't be too much of an issue for my stuff. i always add version numbers to file names, and that's passed into the lwrp as a resource attribute
[2013-05-24 07:07:56 -0400] shimo: i'm not sure what others do but i circumvent this by having a symlink to the "active" version, and then basing the notify/subscribe to that instead
[2013-05-24 07:08:04 -0400] eugenmayer: Moin
[2013-05-24 07:08:15 -0400] rava: and clean out versions i'm not running
[2013-05-24 07:08:21 -0400] eugenmayer: Anybody running into issue with Debian 7.0? i cant get chef-client running on it properly
[2013-05-24 07:09:56 -0400] eugenmayer: after having some issue installing chef-client, i know get [2013-05-24T09:09:35+02:00] FATAL: NoMethodError: undefined method `run_list' for nil:NilClass
[2013-05-24 07:10:02 -0400] eugenmayer: when runnning chef
[2013-05-24 07:11:52 -0400] rava: do notifications support multiple resource actions?
[2013-05-24 07:12:04 -0400] rava: like can i do notifies [:restart, :start] to a service?
[2013-05-24 07:16:31 -0400] alex88: oh nm it seems I needed to use override
[2013-05-24 07:16:44 -0400] rava: shimo: thanks for the advice on relying on the remote_file resource. just saved me a ton of time :)
[2013-05-24 07:19:07 -0400] JensOfSweden: ohai
[2013-05-24 07:20:20 -0400] alex88: http://pastie.org/private/tosx0wkl3mevoy4mxoqswg why the output during the run has the 3 log lines one near each other and the execute blocks output after all of them?
[2013-05-24 07:24:29 -0400] alex88: oh k, compile and execute time
[2013-05-24 07:29:56 -0400] alex88: lol, on opscode cp I get "The selected environment no longer exists, hence no operations can be performed in this environment using the Management Console. (Error 33021)" and I'm not able to create a new one :S
[2013-05-24 07:37:28 -0400] alex88: cookie clear seems to fix that
[2013-05-24 07:47:05 -0400] Cope: rava: they do
[2013-05-24 07:47:23 -0400] rava: Cope: thanks
[2013-05-24 07:47:24 -0400] Cope: ph i see
[2013-05-24 07:47:32 -0400] Cope: rava: i  misread you
[2013-05-24 07:48:43 -0400] Cope: rava: sorry - no, you can only send one action with a notify
[2013-05-24 08:16:36 -0400] sebbes: hi
[2013-05-24 08:25:08 -0400] alex88: I've a a data bag in data_bags/myproject, I'm trying "knife data bag from file myproject data_bags" and I get no output
[2013-05-24 08:28:40 -0400] alex88: also how am I supposed to use this data bag with chef solo + vagrant if I cannot download it?
[2013-05-24 08:29:31 -0400] silk: knife data bag from file $databag_name ./path/to/file.json
[2013-05-24 08:29:56 -0400] silk: and is used to populate a data bag, not retrieve it
[2013-05-24 08:30:42 -0400] silk: http://docs.opscode.com/essentials_data_bags_use_chef_solo.html
[2013-05-24 08:33:05 -0400] alex88: silk: I ended up creating a new one with the same name, but if I want to use vagrant with chef_solo to make the edits directly on files, I should upload everything by hand to the server when I'm done right?
[2013-05-24 08:34:02 -0400] silk: Ive not used chef-solo, but it would seem that you need to keep the on disk representation in sync with whats stored on the chef server
[2013-05-24 08:34:53 -0400] alex88: silk: so I should manually cookbook/role/data_bag everything to sync server and local repository?
[2013-05-24 08:35:51 -0400] silk: manually is probably less than ideal
[2013-05-24 08:36:10 -0400] silk: they need to be in sync, if you are testing with vagrant, and then uploading to a chef server for use in production?
[2013-05-24 08:36:18 -0400] silk: (im guessing thats what you're doing)
[2013-05-24 08:36:23 -0400] alex88: silk: exactly..
[2013-05-24 08:36:50 -0400] alex88: having chef-solo is nice since I don't have to upload to the server each line I change to test it
[2013-05-24 08:37:32 -0400] alex88: btw, knife data bag from file myproject data_bags/myproject/admins.json will create myproject databag with item admins?
[2013-05-24 08:38:08 -0400] alex88: oh ok needed to add it
[2013-05-24 08:43:23 -0400] zeroXten: is it possible to get chef-client to not replace cache files? I need to fix something and it would be super easy to test by editing cached files
[2013-05-24 09:26:27 -0400] corehook: guys i do suicide if you don't help me :( i don't trust my eyes while read http://docs.opscode.com/install_workstation.html issue. There are written that "This configuration file must be created by running the knife configure --initial command from the server on which the open source Chef Server is installed." but on my server
[2013-05-24 09:26:55 -0400] corehook: [15:26]corehook@chef:/opt$ which knife
[2013-05-24 09:26:56 -0400] corehook: [15:26]corehook@chef:/opt$
[2013-05-24 09:29:17 -0400] s2r2: corehook: not funny
[2013-05-24 09:30:16 -0400] s2r2: check your $PATH; chef = installed from gem/package/omnibus?
[2013-05-24 09:30:45 -0400] corehook: omnibus
[2013-05-24 09:32:31 -0400] corehook: [15:31]corehook@chef:/opt/chef-server/embedded/bin$ ls knife
[2013-05-24 09:32:31 -0400] corehook: knife
[2013-05-24 09:32:33 -0400] corehook: thx bro
[2013-05-24 09:33:05 -0400] corehook: why omnibus dont update my PATH when install  server ?
[2013-05-24 09:40:40 -0400] zeroXten: why does 'run_chef'  in shef just return true, rather than actually running chef-client?
[2013-05-24 09:41:04 -0400] corehook: ERROR: Connection refused connecting to
[2013-05-24 09:41:42 -0400] corehook: fu**ing st**id mother f***er su**d di**er niger fuck    
[2013-05-24 09:42:53 -0400] alex88: damn I've removed my organization key, trying to recreate it gives no organization found.. I've created a client with same name, gave full permissions.. now deploying a node gives "Your validation client is not authorized to create the client for this node (HTTP 403)"
[2013-05-24 09:42:58 -0400] alex88: awesome
[2013-05-24 09:43:38 -0400] ptrf: ok, so i'm experiencing some weird problems here
[2013-05-24 09:44:11 -0400] ptrf: I'm trying to install rbenv as they say you should on their github readme: https://github.com/RiotGames/rbenv-cookbook
[2013-05-24 09:44:26 -0400] ptrf: I have re
[2013-05-24 09:44:49 -0400] corehook: where i can read chef-server's logs ?
[2013-05-24 09:45:13 -0400] ptrf: I have in my runlist for the role i'm using recipe["ruby_build"],role["appserver"]
[2013-05-24 09:46:21 -0400] ptrf: sorry, it's recipe["ruby_build"],recipe["appserver"] in my runlist
[2013-05-24 09:47:11 -0400] ptrf: and I have both rbenv and ruby_build in my metadata.rb for the appserver cookbook
[2013-05-24 09:48:36 -0400] ptrf: yet somehow, I still get resolve errors: Chef::Exceptions::RecipeNotFound: could not find recipe ruby_build for cookbook rbenv
[2013-05-24 09:49:18 -0400] ptrf: and right before that, in the synchronizing cookbooks stage, ruby_build figures
[2013-05-24 09:58:03 -0400] alex88: maybe the default user is also in some groups?
[2013-05-24 09:59:41 -0400] zeroXten: does shef really suck, or is the documentation just crap?
[2013-05-24 09:59:48 -0400] alex88: yeah that does the trick
[2013-05-24 10:15:56 -0400] JensOfSweden: shef realy rocks =)
[2013-05-24 10:16:05 -0400] JensOfSweden: Found out alot of things using shef
[2013-05-24 10:16:24 -0400] matti: Like 1 mln $?
[2013-05-24 10:16:34 -0400] matti: Or, orange pudding?
[2013-05-24 10:16:41 -0400] matti: I could have orange pudding.
[2013-05-24 10:16:56 -0400] matti: ;]
[2013-05-24 10:22:01 -0400] alex88: why after knife ec2 server start, server list doesn't show anything?
[2013-05-24 10:27:58 -0400] alex88: oh, region settings...
[2013-05-24 10:29:09 -0400] alex88: is there a way to have amazon opsworks search nodes in the chef server?
[2013-05-24 10:29:21 -0400] alex88: to get for example other nodes ip and such?
[2013-05-24 10:37:22 -0400] corehook: how and where i can check why knife bootstrap return 10.0.0.32 [2013-05-24T16:36:54+06:00] ERROR: Connection refused connecting to server:4000 for /clients, retry 1/5
[2013-05-24 10:37:23 -0400] corehook:  ?
[2013-05-24 10:43:56 -0400] Cope: corehook: because the client.rb which was populated on the server you bootstrapped is trying to talk to a chef server on port 4000
[2013-05-24 10:44:09 -0400] Cope: if that's incorrect, update your client.rb to point to the real chef server
[2013-05-24 10:44:25 -0400] Cope: and also corret your knife.rb from which the templated client.rb was rendered
[2013-05-24 10:45:20 -0400] corehook: stop
[2013-05-24 10:45:34 -0400] corehook: what port i must use ?
[2013-05-24 10:45:48 -0400] corehook: i downloaded knife.rb from web ui
[2013-05-24 10:46:45 -0400] Cope: corehook: are you using hosted chef?
[2013-05-24 10:47:05 -0400] Cope: or your own chef server?
[2013-05-24 10:47:53 -0400] corehook: private chef server
[2013-05-24 10:49:46 -0400] Cope: corehook: private chef as in purchased from opscode? or private as in "belongs to you" and is the open source chef server?
[2013-05-24 10:50:11 -0400] corehook: i dont purchase it
[2013-05-24 10:50:20 -0400] corehook: it s not privated open source chef
[2013-05-24 10:50:23 -0400] corehook: its private chef server
[2013-05-24 10:53:15 -0400] corehook: solved!
[2013-05-24 10:53:15 -0400] corehook: thx!
[2013-05-24 10:53:37 -0400] Cope: splendid
[2013-05-24 10:53:42 -0400] corehook: now please help me with link about deploing my cookbook ?
[2013-05-24 10:54:06 -0400] Cope: i'm afk for ~25 mins - happy to help when I return
[2013-05-24 10:56:16 -0400] corehook: ok!
[2013-05-24 10:56:16 -0400] corehook: thx
[2013-05-24 11:00:33 -0400] zeroXten: JensOfSweden: the interface is really weird... stupid stuff like run_lists being empty and impossible to populate
[2013-05-24 11:22:58 -0400] corehook: yes!!!
[2013-05-24 11:23:20 -0400] corehook: server done, cookbooks uploaded, node bootstrapted
[2013-05-24 11:23:25 -0400] corehook: workstation configured
[2013-05-24 11:23:27 -0400] corehook: now....
[2013-05-24 11:23:32 -0400] corehook: HOW TO START DEPLOY ??
[2013-05-24 11:25:38 -0400] workmad3: corehook: run chef-client? :)
[2013-05-24 11:27:01 -0400] corehook: hm..
[2013-05-24 11:27:06 -0400] corehook: how i can make it over web ui
[2013-05-24 11:31:34 -0400] workmad3: you can't... you'd need to have bootstrapped the node to run the chef-client periodically for that
[2013-05-24 11:32:03 -0400] workmad3: and then you can't start it on-demand. the client run gets initiated from the client, not the server
[2013-05-24 12:10:25 -0400] corehook: <corehook> server done, cookbooks uploaded, node bootstrapted
[2013-05-24 12:10:25 -0400] corehook: <corehook> workstation configured
[2013-05-24 12:10:26 -0400] corehook: <corehook> now....
[2013-05-24 12:10:33 -0400] corehook: workmad3
[2013-05-24 12:11:06 -0400] corehook: and if i have 300 clients ( virtual or physical servers ) i must run from 300 consoles chef-client ?
[2013-05-24 12:11:14 -0400] corehook: it's joke ?
[2013-05-24 12:11:52 -0400] corehook: 300nodes
[2013-05-24 12:13:16 -0400] aruntomar: corehook: use "knife ssh"
[2013-05-24 12:20:26 -0400] axyelp: is there any way i can set a bash block's verbosity without doing 'chef-client -l debug'?
[2013-05-24 12:30:57 -0400] s2r2:  /join #dovecot
[2013-05-24 12:31:15 -0400] s2r2: ...
[2013-05-24 13:17:15 -0400] DeadZen: hi
[2013-05-24 13:25:27 -0400] DeadZen: how would I find out what chaned between 11.4.0 and 11.4.4 that would break my scripts?
[2013-05-24 13:25:35 -0400] DeadZen: changed*
[2013-05-24 14:08:00 -0400] geekbri: Not sure.  I wish they would add a CHANGELOG.md to chef-client
[2013-05-24 14:08:06 -0400] geekbri: you could always just view the git commits i suppose
[2013-05-24 14:08:25 -0400] geekbri: https://github.com/opscode/chef/commits/11.4.4
[2013-05-24 14:14:12 -0400] jvbe: hi
[2013-05-24 14:15:34 -0400] jvbe: my chef-server ran out of diskspace
[2013-05-24 14:15:38 -0400] jvbe: now when i try to upload cookbooks I get this
[2013-05-24 14:15:39 -0400] jvbe: Uploading ark            [0.0.17]
[2013-05-24 14:15:58 -0400] jvbe: ERROR: Server returned error for http://chef.xxxxxx.com:4000/cookbooks/ark/0.0.17, retrying 1/5 in 3s
[2013-05-24 14:16:00 -0400] jvbe: deleting the cookbook is the same
[2013-05-24 14:16:27 -0400] jvbe: however if I download them it can find the cookbook, also they show up and are browseable from the webui
[2013-05-24 14:17:08 -0400] jvbe: running a chef-client on the nodes returns this: INFO: HTTP Request Returned 500 Internal Server Error: undefined method `payload' for nil:NilClass
[2013-05-24 14:17:42 -0400] jvbe: any ideas what I could do to restore the situation?
[2013-05-24 14:18:41 -0400] jtimberman: jvbe: sounds like you're using chef 10. have you compacted couchdb?
[2013-05-24 14:18:57 -0400] jvbe: yes chef 10
[2013-05-24 14:19:03 -0400] jvbe: compacted?
[2013-05-24 14:19:52 -0400] jvbe: i enlarged my EBS to give it more space
[2013-05-24 14:20:26 -0400] jtimberman: http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server
[2013-05-24 14:20:29 -0400] jvbe: also had to recreate the chef user for rabbitmq
[2013-05-24 14:23:08 -0400] jvbe: just ran a compact
[2013-05-24 14:23:14 -0400] jvbe: db size seems a lot smaller now
[2013-05-24 14:23:29 -0400] jvbe: however still same prob
[2013-05-24 14:26:31 -0400] jvbe: i don't really see a way out
[2013-05-24 14:26:32 -0400] jvbe: but to start from scratch
[2013-05-24 14:33:36 -0400] ryker: hi spox. Are you around?  I was wondering if your delayed_evaluator lazy block should work in a not_if statement for a resource.  Seems like it doesn't.
[2013-05-24 14:34:09 -0400] jtimberman: jvbe: the chef server has logs, and you can enable debug logging on them, to find out more information
[2013-05-24 14:34:36 -0400] jtimberman: jvbe: generally, log_level :debug in the config file (/etc/chef/server.rb, by default, for the API)
[2013-05-24 14:35:35 -0400] spox: ryker: it would not work in that context
[2013-05-24 14:36:30 -0400] ryker: spox: would it work if I put it inside a ruby_block in a system call?
[2013-05-24 14:37:36 -0400] spox: ryker: no, but there wouldn't really be a point to
[2013-05-24 14:37:59 -0400] spox: ryker: what is the problem you're trying to solve?
[2013-05-24 14:38:06 -0400] ryker: i have a device I need to format, and I need to check before I format it if it's already formatted.  The device name is stored in a node attribute and set in a ruby block before this code that attempts to format it.
[2013-05-24 14:38:47 -0400] ryker: I'm not sure how to get that dynamic value into a block of code to check if it's already formatted or not
[2013-05-24 14:39:19 -0400] spox: well, the not_if block will be evaluated during the execution phase, so you should be fine just checking it directly
[2013-05-24 14:40:49 -0400] ryker: but the value is stored in a node attribute that is set in a ruby block before this code, which is why I needed the delayed_evaluator stuff.  Since the lazy block won't work in a not_if statement, how can I get the current value of that node attribute in the not_if code? :)
[2013-05-24 14:41:49 -0400] djstunami: Ohai chefs!  When looking at the server interface, the ohai attribute does not list custom plugins, and in fact, only lists itself, even though I have some (via the ohai cookbook).  What gives?
[2013-05-24 14:43:38 -0400] spox: ryker: pretty sure you can just access the attribute directly in the not_if block, without need for lazy evaluation
[2013-05-24 14:44:50 -0400] ryker: spox: i'll give that a try real quick. boy, this is confusing trying to figure out when the current value of an attribute is available and not an old value from the beginning of the chef run.
[2013-05-24 14:45:56 -0400] spox: ryker: you just need to look at when something will actually be evaluated
[2013-05-24 14:46:23 -0400] spox: the attributes set within the resource happen during the compile phase. the conditional blocks are not evaluated until the execution phase
[2013-05-24 14:46:35 -0400] spox: since the resource will want to know right before it does something, if it should do that something
[2013-05-24 14:46:53 -0400] ryker: hmm.  didn't work
[2013-05-24 14:47:23 -0400] kechagia: Am I missing something, or is the opscode-cookbooks/postgresql config_pgtune attribute reader kinda WTF? https://ezcrypt.it/av6n#WCOaPUTIcIeeJEzW2BgH3qOb
[2013-05-24 14:47:55 -0400] jvbe: jtimberman: i see nothing interesting so far, still the same error as with default logging merb : chef-server (api) : worker (port 4000) ~ undefined method `payload' for nil:NilClass - (NoMethodError)
[2013-05-24 14:48:56 -0400] ryker: spox: do you have time for a peek at the code? :)  https://gist.github.com/albertsj1/22cd064a40cf2250fdbb .  The not_if is at line 89.
[2013-05-24 14:50:34 -0400] spox: ryker:
[2013-05-24 14:50:35 -0400] spox: ah
[2013-05-24 14:50:39 -0400] spox: okay, it's because of the type
[2013-05-24 14:50:58 -0400] spox: sorry, i was making an assumption that you were using a ruby block for the value, not a string
[2013-05-24 14:51:31 -0400] spox: ryker: what did that line look like when you used lazy{}?
[2013-05-24 14:53:41 -0400] ryker: spox: not_if "blkid -s TYPE -o value #{lazy{ node[:ebs][:devicetomount] }}"
[2013-05-24 14:54:20 -0400] spox: ryker: try: not_if lazy{ "blkid -s TYPE -o value #{ node[:ebs][:devicetomount] }" }
[2013-05-24 14:54:22 -0400] ryker: spox: I also tried a similiar bit of code using a ruby block with a sytem call in the not_if instead of shell
[2013-05-24 14:54:23 -0400] spox: instead
[2013-05-24 14:54:43 -0400] ryker: ok. just a sec
[2013-05-24 14:55:05 -0400] spox: i'll have to have a look at how the conditional blocks/bits are stored within the resource
[2013-05-24 14:55:15 -0400] spox: not sure if it's the same as regular attributes or not
[2013-05-24 14:57:12 -0400] ryker: spox: didn't work. Invalid only_if/not_if command:
[2013-05-24 14:57:35 -0400] xmltok: i have colo specific information in a databag that i use from a recipe to assign to node.colo, but lately it has become a problem where variables in node.colo are not available to other recipes. should node.colo be set via ohai instead of a recipe? can I access search and databags from ohai plugins?
[2013-05-24 14:57:40 -0400] spox: yeah, i'm looking at the bits now and they work fully different than the attributes, so the lazy bits won't be of any use
[2013-05-24 14:59:48 -0400] jtimberman: jvbe: is that from chef-client or knife? if chef-client, run w/ debug logging on the client, -l debug. if knife use -VV (i don't remember why they're different :))
[2013-05-24 15:02:21 -0400] jvbe: that is from the chef server log
[2013-05-24 15:04:45 -0400] jtimberman: i know it's from the server log, i mean did you see that when running chef-client or knife
[2013-05-24 15:05:18 -0400] ryker: spox: looking at what I'm doing in the code, can you think of any other way for me to check if the filesystem is already formatted since the device name is dynamic?
[2013-05-24 15:06:03 -0400] ryker: spox: Oh, I wonder.  Will the lazy stuff work inside a script resource?
[2013-05-24 15:06:03 -0400] jvbe: jtimberman: i would guess knife, here knife with -VV: http://pastebin.com/i6XQvLiY
[2013-05-24 15:06:30 -0400] ryker: I can just use a bash if/else statement in there if lazy works inside there.
[2013-05-24 15:07:30 -0400] spox: ryker: sorry, got pulled away for a sec. yeah, it should work there, since those are just attributes being accessed
[2013-05-24 15:07:51 -0400] spox: but i don't think i'm crazy. pretty sure just using a ruby block for the not_if will get you want you need
[2013-05-24 15:10:43 -0400] ryker: spox: a ruby_block resource instead of the whole execute resource, or do you mean using a ruby block in the not_if line?
[2013-05-24 15:11:36 -0400] spox: the latter. not_if { system("/bin/true") }
[2013-05-24 15:11:44 -0400] spox: or, using shellout or what ever :)
[2013-05-24 15:12:04 -0400] ryker: pretty sure I tried that.  I'll try again.
[2013-05-24 15:12:27 -0400] jtimberman: jvbe: do other cookbook uploads have that problem?
[2013-05-24 15:14:45 -0400] jvbe: jtimberman: yes, i'm willing to accept that the server is hosed and start from scratch, if only I could register my existing nodes on the new one without recreating them
[2013-05-24 15:14:55 -0400] faldridge: Is there a way to bulk upload roles with knife in Chef 10.14.4?
[2013-05-24 15:15:33 -0400] jtimberman: jvbe: you can use knife-essentials to back up your nodes and API clients to upload to a rebuilt chef-server.
[2013-05-24 15:15:58 -0400] HunterMcJ: Hi, I have an ec2 instance that I'm trying to get knife to run on. However, any knife command I run is giving me this error. "Your private key could not be loaded from /etc/chef/client.pem".  the client.pem is in the /etc/chef/ directory. Why can it not be loaded?
[2013-05-24 15:16:02 -0400] jtimberman: jvbe: if you're rebuilding, i'd suggest perhaps Chef 11, as the server a) is easier to setup and manage, b) doesn't have couchdb as a component.
[2013-05-24 15:17:21 -0400] knuckolls: HunterMcJ: permissions? try running as root?
[2013-05-24 15:17:33 -0400] ryker: spox: I think the ruby block in the not_if might have worked, but I got an error about the delayed_evaluator when it tried to format.
[2013-05-24 15:17:34 -0400] ryker: mkfs -t xfs #<Chef::DelayedEvaluator:0x0000000439c548@/var/chef/cache/cookbooks/ebs/recipes/raids.rb:88> returned 1
[2013-05-24 15:17:51 -0400] ryker: Will lazy not work in the execute resource?
[2013-05-24 15:18:06 -0400] jvbe: jtimberman: i'll first setup a 10, make sure we're up and running without changing too many variables
[2013-05-24 15:18:19 -0400] jvbe: jtimberman: we can always plan for an upgrade later
[2013-05-24 15:18:59 -0400] btm_: ereslibre: what version of Chef are you using?
[2013-05-24 15:19:18 -0400] jtimberman: jvbe: totally.
[2013-05-24 15:19:21 -0400] knuckolls: jvbe: knife-server may be helpful
[2013-05-24 15:19:47 -0400] jtimberman: jvbe: knife-essentials provides a pretty clean backup/restore option for replacing the chef 10 server with a new one, or for the upgrade.
[2013-05-24 15:19:47 -0400] spox: ryker: it's because of how you have it in use
[2013-05-24 15:20:12 -0400] spox: you need to have lazy{} wrap the entire string
[2013-05-24 15:20:35 -0400] jvbe: jtimberman: ok thx a lot, for the help, I was getting desperate, will it take care of all the pub/pvt keys ??
[2013-05-24 15:20:39 -0400] spox: this:  command "mkfs -t #{options[:fstype]} #{lazy{ node[:ebs][:devicetomount] }}"
[2013-05-24 15:20:42 -0400] ryker: spox: yeah, i was just trying that now. I just remembered how you showed me that not_if line. :)
[2013-05-24 15:20:56 -0400] jtimberman: jvbe: the private keys are on the edge nodes, or "knife workstations"
[2013-05-24 15:20:58 -0400] spox: ryker: cool :)
[2013-05-24 15:21:07 -0400] ereslibre: btm: 11.4.4
[2013-05-24 15:21:15 -0400] jtimberman: jvbe: i don't recall w/ chef 10 if the pub keys for clients are backed up
[2013-05-24 15:21:16 -0400] ereslibre: btm: is this about #chef-hacking ?
[2013-05-24 15:21:46 -0400] ryker: spox: Yeah!  That worked!  Hooray!  Thank you. :)
[2013-05-24 15:21:59 -0400] spox: ryker: sure :)
[2013-05-24 15:22:28 -0400] jvbe: jtimberman: i was more worried about the existing clients, don't they have a server key?
[2013-05-24 15:22:40 -0400] ryker: I would totally make my company pay for advanced Chef training that tought this stuff.  <hint> jtimberman </hint>  :)
[2013-05-24 15:22:52 -0400] jtimberman: ryker: email training@opscode.com with your needs.
[2013-05-24 15:22:57 -0400] jtimberman: :)
[2013-05-24 15:23:09 -0400] ryker: i will :)
[2013-05-24 15:23:30 -0400] jtimberman: jvbe: right, they have their own private key, but re-keying isn't terribly difficult w/ the validation key.
[2013-05-24 15:23:53 -0400] nvbasd_: in an atributes/default.rb file can I have a line like: default['monitoring']['trustedIP'] = { "comment": "value", "ip": "value" }    ??
[2013-05-24 15:25:00 -0400] jvbe: jtimberman: the more steps i need to do/figure out, more that can go wrong ;-)
[2013-05-24 15:27:06 -0400] btm: ereslibre: yes. it looks like a second chef-client run opens the lock file to get the pid of the running instance. when that instance is coplete, it writes its own pid to the file. If the first instance deleted the pid file, it would do so out from under the second instance.
[2013-05-24 15:27:07 -0400] jtimberman: jvbe: i don't have a chef 10 server running right now. but you should be able to do knife client show ACLIENTNAME -Fj
[2013-05-24 15:27:19 -0400] btm: ereslibre: kallistec is the expert on RunLock.
[2013-05-24 15:29:24 -0400] ereslibre: btm: I understand now, thank you. However is strange, because the new instance looks like refuses to start because the pid exists, but it's empty, there is no pid file. It could test a) has this file a pid written on it b) does this pid that I read respond to any signal?
[2013-05-24 15:29:39 -0400] ereslibre: s/the pid exists/the lock file exists/
[2013-05-24 15:29:59 -0400] ereslibre: s/there is no pid file/the lock file hasn't got any pid/
[2013-05-24 15:33:03 -0400] prognostikos: anyone know of a community cookbook to manage ENV vars with an encrypted databag & inject in specific user environments?
[2013-05-24 15:33:25 -0400] prognostikos: seems like I can't be the first to have this need
[2013-05-24 15:35:20 -0400] btm: ereslibre: The usual pattern I've seen is that processes will throw an error if they see an unexpected pid file because they don't know what to do. Give that, maybe some processes are smarter and we just never notice. A ticket and a patch to improve how we act is worthwhile for the discussion at least.
[2013-05-24 15:36:27 -0400] ereslibre_work: btm: that's the idea. there's a dummy signal that can be used, just to check if the pid that is written on the lock file is still 'something running'
[2013-05-24 15:36:42 -0400] ereslibre_work: btm: if that fails, you can safely ignore the lock file, since it contains a pid that is now dead
[2013-05-24 15:38:29 -0400] lpiaounl: is there a way to change out which ruby interpreter chef-client uses?
[2013-05-24 15:39:31 -0400] lpiaounl: i'm getting ERRCONNRESET when the client tries to register for the first time during bootstrapping... seems to be related to the versions of openssl and ruby
[2013-05-24 15:53:41 -0400] MattStratton: Anyone have any idea why I might be getting 400 errors trying to hit EC2 from knife?
[2013-05-24 15:53:59 -0400] MattStratton: I keep getting this: ERROR: Excon::Errors::BadRequest: Expected(200) <=> Actual(400 Bad Request)
[2013-05-24 16:17:27 -0400] kisoku: anyone have an example of using .kitchen.local.yml ?
[2013-05-24 16:22:41 -0400] cwj: kisoku: in my experience  the merging of .kitchen.yml and .kitchen.local.yml doesn't really work the way i expect; i wind up copying all of .kitchen.yml into .kitchen.local.yml before trying to make changes
[2013-05-24 16:22:52 -0400] cwj: maybe im just holding it wrong, i dunno :)
[2013-05-24 16:38:03 -0400] jchauncey: anyone know of a pattern that helps when creating cookbooks that depend on package installations from non standard repos?
[2013-05-24 16:38:14 -0400] jchauncey: for example installing chrome from their apt repo and their yum repo
[2013-05-24 16:38:25 -0400] techminer: Hi, we delete a cookbook from chef-server.  Then reuploaded a new copy.  Now when we run chef-client on the nodes we get "cookbook not found".  It's not grabbing the cookbook from the chef-server and putting it in the local cache.
[2013-05-24 16:38:39 -0400] jchauncey: right now we define the yum information within the recipe but that seems a little jacked
[2013-05-24 16:44:56 -0400] knuckolls: jchauncey: perhaps this is what you're looking for?
[2013-05-24 16:44:58 -0400] knuckolls: https://github.com/opscode-cookbooks/yum
[2013-05-24 16:49:06 -0400] jchauncey: thats what we are using
[2013-05-24 16:52:47 -0400] kisoku: cwj: yeah providing a subset doesn't seem to work very well
[2013-05-24 16:56:37 -0400] ereslibre_work: btm: hey, we just saw what's happening. lsof shows that every command that the first chef-client run forked, are inheriting the lock
[2013-05-24 16:56:57 -0400] ereslibre_work: btm: so the second chef-client run, is just waiting for the lock to be released, which is inherited by all forked processes from the first run
[2013-05-24 16:57:12 -0400] ereslibre_work: any ideas ?
[2013-05-24 17:03:59 -0400] ssd7: ereslibre_work: I don't have full backscroll, but it seems like this improvement to mixlib-shellout might help you eventually: https://github.com/opscode/mixlib-shellout/commit/fc9f845dc5e91c19008781b4cbb5d42eb1d1e669
[2013-05-24 17:05:14 -0400] ereslibre_work: ssd7: wow, that's the hell of a match. thank you
[2013-05-24 17:05:42 -0400] ereslibre_work: ssd7: any idea in which chef-client version will this be released ?
[2013-05-24 17:06:50 -0400] aalmenar: ereslibre_work: that is different mixlib-shellout is on a different gem
[2013-05-24 17:07:17 -0400] aalmenar: ereslibre_work: the question is if this gem is compatible with chef-client 11.4.4
[2013-05-24 17:07:31 -0400] ereslibre_work: aalmenar: yes, but that dependency is set on chef gem: http://rubygems.org/gems/chef
[2013-05-24 17:12:04 -0400] irossi: Hi there, I'm using the passenger_apache2 cookbook and can't get it to work with the examples, not a noob
[2013-05-24 17:12:15 -0400] irossi: Anyone used passenger_apache2 ?
[2013-05-24 17:14:20 -0400] ssd7: ereslibre_work: I'm unsure when we'll see that in the client but I can do some poking around to see.
[2013-05-24 17:24:57 -0400] ereslibre_work: ssd7: thank you :)
[2013-05-24 17:30:40 -0400] cjerdonek: basic question: is there a way to access the "node" method from inside a custom module definition? i'm not sure how to address it without getting NameError.
[2013-05-24 17:31:36 -0400] nebrera: helllo
[2013-05-24 17:31:48 -0400] nebrera: does erchef support mysql  instead of postgres ?
[2013-05-24 17:42:14 -0400] pwnguin: does knife bootstrap support encrypted ssh keys?
[2013-05-24 17:42:58 -0400] pwnguin: ive tried googling ERROR: ArgumentError: Could not parse PKey: no start line
[2013-05-24 17:43:20 -0400] pwnguin: but the other people seem to have a problem net-ssh, but i dont think that's the case
[2013-05-24 17:52:50 -0400] jtimberman: nebrera: no
[2013-05-24 17:53:39 -0400] nebrera: at the config file it says is tis
[2013-05-24 17:53:41 -0400] nebrera: it is
[2013-05-24 17:53:46 -0400] jtimberman: nebrera: that said, it's open source and you could try to get it working.
[2013-05-24 17:56:57 -0400] lpiaounl: pwnguin: I got that error message when I tried using my id_rsa.pub in place of the private id_rsa file
[2013-05-24 17:57:52 -0400] pwnguin: its definately a working key
[2013-05-24 17:58:52 -0400] lpiaounl: right, but is it your public or private key? knife bootstrap -i seems to expect your private key
[2013-05-24 17:59:05 -0400] pwnguin: hmm
[2013-05-24 17:59:44 -0400] ribo: I think something like http://tickets.opscode.com/browse/CHEF-932 has cropped up again with chef 11.4 & git 1.8
[2013-05-24 18:01:46 -0400] lpiaounl: pwnguin: care to share the command you used?
[2013-05-24 18:01:47 -0400] pwnguin: lpiaounl: hmm. originally i didnt have any pubkey in, and i expected it would bootstrap
[2013-05-24 18:03:13 -0400] pwnguin: knife bootstrap 54.235.53.25 --sudo
[2013-05-24 18:05:50 -0400] irossi: jtimberman, I'm trying to use the passenger_apache2 recipe on a Centos 5.8 machine and it won't write any of the web_app params to the /etc/httpd/sites-enabled/[WEB_APP].conf file
[2013-05-24 18:05:51 -0400] pwnguin: lpiaounl: i think i need to shelve this until the training is over. thanks for the pointer though
[2013-05-24 18:05:57 -0400] lpiaounl: pwnguin: i think you have to give it a ssh username with -x unless it's the same as your local user
[2013-05-24 18:06:04 -0400] irossi: jtimberman, Is there an issue with that cookbook and Centos 5.8 ?
[2013-05-24 18:06:28 -0400] pwnguin: lpiaounl: still can't parse pkey
[2013-05-24 18:06:28 -0400] irossi: jtimberman, I'm following the examples in the README.md to a T
[2013-05-24 18:06:35 -0400] irossi: jtimberman, Can you offer any assistance?
[2013-05-24 18:06:50 -0400] lpiaounl: pwnguin: try using -i as well to point it to the id_rsa file
[2013-05-24 18:08:14 -0400] irossi: jtimberman, I've spent that last couple of hours on it and am all out of resources
[2013-05-24 18:08:42 -0400] irossi: jtimberman, Here's the recipe I'm calling it from
[2013-05-24 18:08:45 -0400] irossi: jtimberman, include_recipe "rails"
[2013-05-24 18:08:45 -0400] irossi: include_recipe "passenger_apache2"
[2013-05-24 18:08:46 -0400] irossi: web_app "spt" do
[2013-05-24 18:08:46 -0400] irossi:   docroot node[:app_spt][:docroot]
[2013-05-24 18:08:46 -0400] irossi:   server_name node[:app_spt][:server_name]
[2013-05-24 18:08:46 -0400] irossi:   server_aliases node[:app_spt][:server_aliases]
[2013-05-24 18:08:47 -0400] lpiaounl: knife bootstrap <FQDN> --sudo  -x <userid> -i /path/to/id_rsa
[2013-05-24 18:08:48 -0400] irossi:   rails_env node.chef_environment
[2013-05-24 18:08:50 -0400] irossi:   rack_env node.chef_environment
[2013-05-24 18:08:52 -0400] irossi: end
[2013-05-24 18:09:50 -0400] irossi: jtimberman, And my attributes file
[2013-05-24 18:09:52 -0400] irossi: node.default['app_spt']['docroot'] = '/var/www/vhosts/siteprofile-stg/staging/current/public'
[2013-05-24 18:09:52 -0400] irossi: node.default['app_spt']['server_name'] = 'siteprofile-stg.visiblemeasures.com'
[2013-05-24 18:09:52 -0400] irossi: node.default['app_spt']['server_aliases'] = [ "siteprofile-stg", node[:hostname] ]
[2013-05-24 18:11:04 -0400] jbz: Anyone got a sec for a foodcritic question?
[2013-05-24 18:14:23 -0400] irossi: Does anyone here use the passenger_apache2 cookbook?
[2013-05-24 18:23:57 -0400] blitzrage: stupid question that for some reason I can't good for:  can I have multiple not_if incantations defined for a resource?
[2013-05-24 18:26:05 -0400] jstallard: blitzrage: I don't believe so, but you can do something like this: not_if "some_app && some_other_app"
[2013-05-24 18:26:37 -0400] blitzrage: jstallard: cool, I'll use that syntax, thanks
[2013-05-24 18:26:47 -0400] blitzrage: was looking at a couple of 'if' statements
[2013-05-24 18:26:55 -0400] blitzrage: just wanted to clean it up so it wasn't so heavily nested
[2013-05-24 18:27:10 -0400] blitzrage: just might not have much of a choice though
[2013-05-24 18:28:35 -0400] techminer: We have a cookbook on chef-server 11 that nodes are not able to grab for some reason.  This pastie shows the stacktrace.  http://pastie.org/7954385
[2013-05-24 18:29:37 -0400] techminer: yet "knife cookbook show graphite" produces this so it thinks it's installed
[2013-05-24 18:29:38 -0400] techminer: graphite   0.4.2
[2013-05-24 18:53:40 -0400] greyull: Hey, quick question related to recipe-writing: If I pass an array into a provider structure, will it loop through each object in the array?
[2013-05-24 18:54:09 -0400] greyull: IE: node['blah'] contains [1] = /var/test and [2] = /var/test2
[2013-05-24 18:54:26 -0400] greyull: And you do directory node['blah'] do action :create end
[2013-05-24 18:54:54 -0400] cassianoleal: greyull: node['blah'].each do { |dir| directory dir }
[2013-05-24 18:55:11 -0400] cassianoleal: sorry, omit the "do" as I used {} in the example
[2013-05-24 18:55:12 -0400] cassianoleal: :)
[2013-05-24 18:55:21 -0400] greyull: cassianoleal: Awesome, thanks!
[2013-05-24 18:55:29 -0400] cassianoleal: np :)
[2013-05-24 18:55:36 -0400] greyull: So the entire directory statement should be contained in the { } as well, just to double-check, right?
[2013-05-24 18:56:06 -0400] cassianoleal: greyull: yes. that's the standard way of iterating through an array in ruby
[2013-05-24 18:56:29 -0400] cassianoleal: everything inside the {} is plain Ruby -- the |dir| is the variable that will be used inside the block to reference the current item
[2013-05-24 18:56:37 -0400] greyull: My Ruby knowledge is pretty iffy, considering I only started working with Chef... a week ago.
[2013-05-24 18:56:42 -0400] cassianoleal: :)
[2013-05-24 18:56:51 -0400] cassianoleal: np, you'll get used as you go
[2013-05-24 18:56:58 -0400] cassianoleal: I recommend studying basic Ruby, though
[2013-05-24 18:57:21 -0400] greyull: I probably will do that eventually. For now, my time constraints are getting so close that I'm going to cut corners where I can.
[2013-05-24 18:57:42 -0400] greyull: Project at work, to do basic research and testing on IT automation services like Salt/Chef/Ansible/Puppet
[2013-05-24 18:58:07 -0400] greyull: And since my boss tossed it at me so late... I really only have a week per service
[2013-05-24 18:58:21 -0400] cassianoleal: I see. that's usually the case :)
[2013-05-24 18:58:33 -0400] cassianoleal: this: http://docs.opscode.com/just_enough_ruby_for_chef.html should provide you with enough information to get started
[2013-05-24 18:58:55 -0400] cassianoleal: (although it doesn't mention .each) heh
[2013-05-24 18:59:27 -0400] greyull: Awesome, thanks!
[2013-05-24 18:59:35 -0400] cassianoleal: sure!
[2013-05-24 19:10:58 -0400] greyull: Can I test if a node has a role applied on it in a template file?
[2013-05-24 19:11:29 -0400] greyull: IE <%= if node[:roles] == "web_servers" do echo "blah" end %>
[2013-05-24 19:14:20 -0400] laurent\: greyull: yes you can, something like node.roles.include? "web_servers"
[2013-05-24 19:14:51 -0400] greyull: laurent\: Awesome! Thanks!
[2013-05-24 19:15:03 -0400] jtimberman: irossi: sorry, not sure offhand.
[2013-05-24 19:23:09 -0400] Majost1: re: CHEF-2944 -- does this deadlock due to lack of entropy?
[2013-05-24 19:26:13 -0400] Majost1: It sounds like the blocking issue is caused by insufficient entropy in /dev/random
[2013-05-24 19:38:44 -0400] drgage: hi - why isn't "client_fork true" the default? saved me 15-320mb per node! is there a downside?
[2013-05-24 19:40:02 -0400] mattray: drgage: it's a new feature
[2013-05-24 19:40:36 -0400] mattray: not sure why it isn't default, but we're fairly conservative making new features defaults
[2013-05-24 19:40:42 -0400] drgage: well it's hard to argue with being careful. wish i'd found it sooner though.
[2013-05-24 19:40:56 -0400] miah: there was a issue with it until very recently, so its a good thing it wasn't set to default
[2013-05-24 19:41:05 -0400] spox: miah: what was the issue?
[2013-05-24 19:41:06 -0400] miah: though that problem might have been found faster, it would have been a bigger issue
[2013-05-24 19:41:17 -0400] miah: there was a memory leak
[2013-05-24 19:41:25 -0400] spox: with the forking?
[2013-05-24 19:41:26 -0400] drgage: ironic
[2013-05-24 19:42:04 -0400] drgage: is that problem present in 0.10.18?
[2013-05-24 19:42:29 -0400] miah: i believe it was this: https://github.com/opscode/chef/pull/722
[2013-05-24 19:42:38 -0400] miah: drgage: http://tickets.opscode.com/browse/CHEF-3432
[2013-05-24 19:43:13 -0400] drgage: thanks
[2013-05-24 19:43:21 -0400] miah: http://www.opscode.com/blog/2013/04/25/chef-11-4-4-and-chef-10-24-4-released/
[2013-05-24 19:43:23 -0400] miah: more details
[2013-05-24 19:43:48 -0400] drgage: i wish apt.opscode.com had releases after 10.18
[2013-05-24 19:44:20 -0400] miah: there might be another ticket related, i remember discussing the issue during chefconf and it was resolved right around that time too
[2013-05-24 19:44:39 -0400] spox: ah, pid deletion bits
[2013-05-24 19:44:47 -0400] spox: not so much a memory leak from the fork then
[2013-05-24 19:44:52 -0400] miah: drgage: make your own apt's
[2013-05-24 19:44:56 -0400] spox: since that was the whole point of it
[2013-05-24 19:44:58 -0400] miah: spox: there was one though
[2013-05-24 19:45:04 -0400] spox: where?
[2013-05-24 19:45:47 -0400] drgage: i did, but i wonder how many people using the apt source know that it's stale :(
[2013-05-24 19:46:52 -0400] spox: miah: the only parts i see about memory leaks are lwrp issues when not used with fork
[2013-05-24 19:48:04 -0400] timsmith: anyone know anything about the latest apt cookbook failing during the compile phase on Chef 11.  - https://gist.github.com/tas50/5646038
[2013-05-24 19:49:44 -0400] miah: spox: its possible im confusing things =)
[2013-05-24 19:50:15 -0400] spox: well, it did lead me to some other interesting issues :)
[2013-05-24 19:53:07 -0400] miah: timsmith: seems like the class lookup is failing and thus passing a nil argument to const_defined
[2013-05-24 19:53:35 -0400] miah: i havent looked at the code much, so i dunno.
[2013-05-24 19:53:47 -0400] timsmith: seems like a bit whoops since it's 100% busted on chef 11
[2013-05-24 19:53:57 -0400] timsmith: back to chef 10 I go
[2013-05-24 19:54:26 -0400] stormerider: timsmith: why not just downgrade the apt cookbook instead of chef? that seems a bit... excessive a reaction
[2013-05-24 19:55:10 -0400] miah: or fix the bug =)
[2013-05-24 19:55:11 -0400] timsmith: it's not a new version of the apt cookbook.  That cookbook is in prod with chef 10 running just fine.
[2013-05-24 19:55:15 -0400] jperry: ohai
[2013-05-24 19:55:42 -0400] jperry: I'm running knife bootstrap and it seems to be hanging right after  the step to overwrite the rake executable
[2013-05-24 19:55:49 -0400] jperry: is this normal
[2013-05-24 19:55:50 -0400] Kzim: Anyone use PyChef here please ?
[2013-05-24 19:56:03 -0400] stormerider: what version of the cookbook? im running 1.9.2 on chef 11 fine
[2013-05-24 19:56:35 -0400] timsmith: chef 11.4.4 installed via gem and 1.9.2
[2013-05-24 19:57:47 -0400] miah: which version of ruby?
[2013-05-24 19:58:03 -0400] timsmith: 1.8.7 in precise
[2013-05-24 19:58:18 -0400] miah: why 1.8.7?
[2013-05-24 19:58:23 -0400] kisoku: dont use ruby 1.8.7
[2013-05-24 19:58:30 -0400] miah: ^^^^
[2013-05-24 19:58:32 -0400] kisoku: apt-get purge
[2013-05-24 19:58:43 -0400] kisoku: install ruby1.9.3
[2013-05-24 19:58:57 -0400] stormerider: even better yet, use the omnibus client and use whatever OS version of ruby you want
[2013-05-24 19:59:04 -0400] timsmith: I'm installing the ruby that comes with Precise and is used by several other ruby apps on the system.  Telling people to stop using the ruby that comes with the current Ubuntu release isn't really a fix
[2013-05-24 19:59:15 -0400] kisoku: that is probably best
[2013-05-24 19:59:27 -0400] kisoku: oh but it is
[2013-05-24 19:59:31 -0400] miah: const_defined? only takes a single argument in ruby 1.8.7
[2013-05-24 19:59:43 -0400] miah: and two arguments in 1.9.3.
[2013-05-24 19:59:55 -0400] miah: and thats the answer to your problem above.
[2013-05-24 20:00:08 -0400] stormerider: this is the exact reason you want to use the omnibus client :)
[2013-05-24 20:00:13 -0400] miah: ^
[2013-05-24 20:00:17 -0400] kisoku: ^^
[2013-05-24 20:00:21 -0400] timsmith: fun
[2013-05-24 20:00:36 -0400] timsmith: opscode needs to stop shipping the gems then
[2013-05-24 20:00:57 -0400] mattray: timsmith: or distros shouldn't ship Ruby not supported by the language authors
[2013-05-24 20:02:09 -0400] timsmith: there's nothing I can do about what Ubuntu does.  That's the OS handed to me by a larger org so it's what I have to work with.
[2013-05-24 20:02:32 -0400] mattray: timsmith: agreed, that's why we encourage folks to use the omnibus chef installer
[2013-05-24 20:02:50 -0400] mattray: we can't control the distros either, but 1.8.7 shipped 5 years ago
[2013-05-24 20:03:13 -0400] mattray: in the meantime, what can we do to alleviate your issues?
[2013-05-24 20:03:24 -0400] greyull: How would I include a resource from a cookbook?
[2013-05-24 20:03:43 -0400] greyull: IE: I need to include the supervisor_service resource (supervisor/resources/service.rb)
[2013-05-24 20:03:44 -0400] mattray: greyull: add a dependency in your metadata.rb
[2013-05-24 20:03:48 -0400] greyull: Ah.
[2013-05-24 20:03:50 -0400] greyull: Got it.
[2013-05-24 20:05:26 -0400] timsmith: there's nothing at the moment.  Just seems like you guys shouldn't be shipping gems anymore since they're going to get installed on Ruby 1.8.7 more often then not.  I get that 1.8.7 is ancient.  Not arguing that.  If the gems are still around though customers are going to run it.  I'll probably be switching to Omnibus.  I had planned to anyways, but that makes this a much larger project that involves significantly more testing.  It's 
[2013-05-24 20:05:52 -0400] jtimberman: FYI, no COOK code review today.
[2013-05-24 20:07:47 -0400] jtimberman: timsmith: i think there's a ticket (committed) for apt + chef 11 failure.
[2013-05-24 20:07:57 -0400] jtimberman: timsmith: i was going to look at that next for releasing.
[2013-05-24 20:08:13 -0400] timsmith: that was for why-run support if I remember correctly
[2013-05-24 20:08:19 -0400] timsmith: but I'll check
[2013-05-24 20:09:18 -0400] jtimberman: timsmith: http://tickets.opscode.com/browse/COOK-2441
[2013-05-24 20:09:41 -0400] jtimberman: timsmith: wrt shipping gems vs using ruby from the distro
[2013-05-24 20:09:45 -0400] jtimberman: two things there
[2013-05-24 20:09:59 -0400] jtimberman: first, we build the omnibus packages by installing the gems into the build dir.
[2013-05-24 20:10:02 -0400] jtimberman: iirc.
[2013-05-24 20:10:15 -0400] jtimberman: so *we* need the gems for our own tools :D
[2013-05-24 20:10:25 -0400] jtimberman: (need loosely used, we could use the git repo)
[2013-05-24 20:11:03 -0400] monokrome: I am having the same issue that thedeeno explains in this log. Can someone help me troubleshoot it? http://community.opscode.com/chat/chef/2012-09-22
[2013-05-24 20:11:18 -0400] jtimberman: second, ruby 1.8.7 will no longer be supported upstream by the ruby community, it's totally EOL in June.
[2013-05-24 20:11:48 -0400] mattray: jtimberman: seems like we should drop 1.8.7 when the community does
[2013-05-24 20:12:11 -0400] mattray: http://guides.rubygems.org/specification-reference/#required_ruby_version=
[2013-05-24 20:12:15 -0400] jtimberman: ubuntu 12.04's ruby1.9.1 package(s) do the correct thing with update-alternatives to make 1.9.1 (nee 1.9.3-p194 or whatever) the default ruby on the system.
[2013-05-24 20:12:25 -0400] timsmith: from a customer standpoint if it's not tested and working on a OS or ruby platform it would be better that it's not supported and called out as such
[2013-05-24 20:12:33 -0400] timsmith: I just need to know that this won't work
[2013-05-24 20:17:48 -0400] jtimberman: also, oops, COOK-2441 is very much not the issue i was thinking.
[2013-05-24 20:18:28 -0400] new2chef: is there a way to unset or delete a node attribute?  for example, the opposite of doing a node.set['some']['new']['attribute'] = "foo"
[2013-05-24 20:18:54 -0400] new2chef: i want to be able to delete node['some']['new']['attribute']
[2013-05-24 20:19:06 -0400] timsmith: 2441 is a different one.  I know the one you were talking about.  I submitted a dupe of it
[2013-05-24 20:19:43 -0400] mattray: new2chef: explicitly set it to nil?
[2013-05-24 20:19:51 -0400] new2chef: yep
[2013-05-24 20:19:56 -0400] timsmith: omnibus did fix that issue btw
[2013-05-24 20:20:49 -0400] Majost1: new2chef: mattray is saying you should edit the node via knife and set the value of the attibute to nil
[2013-05-24 20:20:54 -0400] stormerider: jtimberman: can you specify a min version of ruby in the gem? not familiar with building gems
[2013-05-24 20:21:02 -0400] mattray: Majost1: thanks
[2013-05-24 20:21:07 -0400] Majost1: np
[2013-05-24 20:21:24 -0400] new2chef: ahh.. okay, so i would just do node.set['some']['new']['attribute'] = nil ?
[2013-05-24 20:21:47 -0400] stormerider: ah, mattray already beat me to it :)
[2013-05-24 20:21:55 -0400] Majost1: sorta, when you edit the node via knife node edit it is json
[2013-05-24 20:22:07 -0400] djstunami: setting it to nil doesn't remove the key though
[2013-05-24 20:22:10 -0400] djstunami: ?
[2013-05-24 20:22:16 -0400] Majost1: you can remove the key too
[2013-05-24 20:22:23 -0400] new2chef: ah yeah, just tried it, and it doesn't remove the key..
[2013-05-24 20:22:27 -0400] new2chef: so how would i do that?
[2013-05-24 20:22:39 -0400] mattray: djstunami: you could set node.set['some']['new'] = nil
[2013-05-24 20:22:43 -0400] Majost1: but if your recipe is adding the key you need to set it to nil
[2013-05-24 20:22:48 -0400] mattray: and that would kill everything under ['new']
[2013-05-24 20:23:08 -0400] mattray: a good way to get null pointers though
[2013-05-24 20:23:15 -0400] djstunami: mattray: ah, that makes sense
[2013-05-24 20:23:33 -0400] new2chef: @mattray is there a way I can specifically target the node.set['some']['new']['attribute'] key and remove that?
[2013-05-24 20:24:11 -0400] mattray: prune it from ['new'] and leave any other keys? probably
[2013-05-24 20:24:54 -0400] mattray: if it were me, I'd bust out irb and find the right command
[2013-05-24 20:25:05 -0400] mattray: attributes are just a hash
[2013-05-24 20:25:46 -0400] new2chef: mattray- great idea.  i'm new to both chef and ruby. i'll try that out
[2013-05-24 20:25:55 -0400] new2chef: i'll see if i can get the syntax in irb
[2013-05-24 20:25:56 -0400] new2chef: thanks!
[2013-05-24 20:26:05 -0400] mattray: new2chef: take a look at using chef-console
[2013-05-24 20:26:14 -0400] mattray: that'll give you irb and a chef environment
[2013-05-24 20:26:36 -0400] monokrome: How can I verify that my validation client is authorized to create a client for a node?...
[2013-05-24 20:26:45 -0400] mattray: err, chef-shell
[2013-05-24 20:27:09 -0400] stormerider: monokrome: still having trouble with that 403 error?
[2013-05-24 20:27:16 -0400] monokrome: stormerider: yeah
[2013-05-24 20:27:18 -0400] new2chef: @mattray, yeah, i was playing around in there a bit but couldn't really figure it out.
[2013-05-24 20:27:28 -0400] monokrome: I've been troubleshooting but it's like searching for a pin in a haystack
[2013-05-24 20:27:50 -0400] stormerider: monokrome: repaste the gist and see if anyone who's around today has any ideas
[2013-05-24 20:28:01 -0400] mattray: new2chef: http://wiki.opscode.com/display/chef/Shef
[2013-05-24 20:29:03 -0400] new2chef: @mattray: nice! i'll read through that
[2013-05-24 20:29:08 -0400] monokrome: Here's a gist of my issue
[2013-05-24 20:29:10 -0400] monokrome: https://gist.github.com/monokrome/52155b4a2ceaf60ca0a3
[2013-05-24 20:29:17 -0400] new2chef: thanks!
[2013-05-24 20:29:50 -0400] monokrome: I generated a new validator key, then after running the command I SSH'd into the machine and the validator keys match
[2013-05-24 20:30:10 -0400] stormerider: monokrome is getting told that they either have a node that already has the name used (though they checked and didnt see one listed in the webui) or the validator client doesnt have permissions to create the client
[2013-05-24 20:30:32 -0400] stormerider: i ran out of ideas to suggest yesterday ;)
[2013-05-24 20:30:39 -0400] monokrome: I have no nodes
[2013-05-24 20:31:00 -0400] monokrome: It says there might be a client with the same name, so I check and there isn't
[2013-05-24 20:31:25 -0400] monokrome: it says the other thing is that my validation client might have misconfigured authorization permissions
[2013-05-24 20:31:37 -0400] monokrome: but I don't even see anywhere in chef's web interface to change those
[2013-05-24 20:38:23 -0400] monokrome: stormerider: The only other reference I can find to this same issue is a chat log from 2012 where someone asked the same thing and nobody knew what was going on
[2013-05-24 20:38:53 -0400] stormerider: *nod* i saw that, too.
[2013-05-24 20:39:19 -0400] brayn: Morning. I'm having this issue https://github.com/opscode/chef/pull/734 that I see is fixed in alpha 11.5.0  how can I specify a gem for that as I am using chef on vagrant?
[2013-05-24 20:41:16 -0400] giraffe: Hi I followed new instructions to install chef-server on ubuntu 12.04 but I see no service or init script. I do have /opt/chef-server/bin/chef-server-ctl  but start does does not do anything.. what am I missing I installed with dpkg -i
[2013-05-24 20:41:49 -0400] monokrome: stormerider: Honestly, I think the issue is just permissions on chef-validator
[2013-05-24 20:41:56 -0400] monokrome: btu I don't know how to change them
[2013-05-24 20:42:59 -0400] stormerider: well, as much as i know about the validator, it's a special role that is either on or off. if its on it should be able to do everything it needs. but im not too familiar with the guts of that.
[2013-05-24 20:43:31 -0400] monokrome: stormerider: In Chef 10's web interface you could just assign permissions to it
[2013-05-24 20:43:33 -0400] monokrome: Now that's gone
[2013-05-24 20:43:55 -0400] stormerider: right, 11 changed how it's handled.
[2013-05-24 20:44:34 -0400] monokrome: ah
[2013-05-24 20:44:45 -0400] monokrome: I think it's the "403 Forbidden" issue as described on http://wiki.opscode.com/display/chef/Common+Errors
[2013-05-24 20:45:04 -0400] monokrome: but that one only talks about how to solve it on hosted chef
[2013-05-24 20:45:23 -0400] giraffe: oh I forgot to run chef-server-reconfigure
[2013-05-24 20:45:34 -0400] giraffe: Ok so I did that... what is the default user/pass for chef?
[2013-05-24 20:45:43 -0400] monokrome: It's on the right side of the web interfaec
[2013-05-24 20:45:46 -0400] monokrome: interface*
[2013-05-24 20:46:04 -0400] giraffe: OMG
[2013-05-24 20:46:12 -0400] monokrome: what?
[2013-05-24 20:46:23 -0400] giraffe: just the obvious its in my face
[2013-05-24 20:46:27 -0400] monokrome: lol
[2013-05-24 20:46:27 -0400] giraffe: not looking
[2013-05-24 20:46:44 -0400] giraffe: im going to blame it on the long neck
[2013-05-24 20:46:52 -0400] giraffe: thanks
[2013-05-24 20:48:31 -0400] giraffe: I remember a while ago we broke up the single giant cookbook repo into individual repos, but is there any 'fast' way to get the opscode books in chef vs git clone each repo?
[2013-05-24 20:48:37 -0400] stormerider: monokrome: you might want to send that to the email list
[2013-05-24 20:48:51 -0400] stormerider: giraffe: knife cookbook site install <blah>
[2013-05-24 20:49:17 -0400] stormerider: or berkshelf/etc
[2013-05-24 20:49:19 -0400] justizin: also, declare deps and use berkshelf
[2013-05-24 20:49:36 -0400] stormerider: berkshelf is my goal for this weekend :)
[2013-05-24 20:50:52 -0400] brayn: If I would want to build my own gem what tag should I pick from the git repo for chef >= 11.5.0 ?
[2013-05-24 20:51:17 -0400] justizin: i expected berks to be more trouble to start with than it has been
[2013-05-24 20:51:46 -0400] justizin: oh giraffe if you want, i can also give you some terrible advice: add all of the git repos as submodules to your chef repo.  that should take care of everything for you. ;)
[2013-05-24 20:52:25 -0400] giraffe: site install blah is good :)
[2013-05-24 20:53:37 -0400] jameson__: I need to use berkshelf :(
[2013-05-24 20:59:06 -0400] jtimberman: timsmith: released 1.10.0 of apt cookbook
[2013-05-24 20:59:33 -0400] timsmith: cool I'll take a look
[2013-05-24 21:00:31 -0400] blitzrage: jtimberman: for submitting new cookbooks, do I just follow the process of opening a pull request and a jira report?
[2013-05-24 21:00:39 -0400] leifmadsen: <-- formerly blitzrage
[2013-05-24 21:01:18 -0400] leifmadsen: I have a gerrit cookbook that I think is nearly ready for submission
[2013-05-24 21:01:44 -0400] aszeszo: hi all, how to disable ohai plugins when using chef-solo? I want to disable plugins/solaris2/filesystem.rb as it is doing "zfs get -p -H all" which takes 2 minutes on my system
[2013-05-24 21:02:06 -0400] jtimberman: leifmadsen: COOK is for cookbooks that opscode maintains.
[2013-05-24 21:02:26 -0400] jtimberman: and at this time we're not adding new cookbooks to maintain.
[2013-05-24 21:02:53 -0400] jtimberman: leifmadsen: i encourage you to release cookbooks to the community site
[2013-05-24 21:02:58 -0400] leifmadsen: jtimberman: they can't be submitted to opscode for distribution even if maintained externally?
[2013-05-24 21:03:01 -0400] leifmadsen: ok
[2013-05-24 21:03:02 -0400] leifmadsen: thx
[2013-05-24 21:03:16 -0400] jtimberman: that way they're not blocked on us to update for new versions, etc.
[2013-05-24 21:03:29 -0400] jtimberman: more info here: http://wiki.opscode.com/display/chef/Cookbook+Support
[2013-05-24 21:03:46 -0400] aszeszo: i have tried putting Ohai::Config[:disabled_plugins] = [ "filesystem" ] in solo.rb but it didn't work
[2013-05-24 21:10:12 -0400] stormerider: does anyone have any suggestions on how an LWRP that creates files should ensure that it's not overwriting the same file each client run, yet will update the file if the parameters in it have changed?
[2013-05-24 21:11:35 -0400] miah: use a template
[2013-05-24 21:12:38 -0400] stormerider: that's kind of what i was thinking, but the nagios cookbook specifically moved away from using a template for the NRPE LWRP in http://tickets.opscode.com/browse/COOK-991
[2013-05-24 21:13:32 -0400] stormerider: so i dont want to revert that behavior if there was a specific reason for it, but that doesnt really document the why of removing the use of templates
[2013-05-24 21:14:11 -0400] stormerider: jtimberman: dont want to bug you if you're busy, but if you can weigh in on this, would be appreciated :) since you accepted the pull request originally
[2013-05-24 21:20:52 -0400] miah: well, it uses 'content'. i believe file will check that the file checksum differs before overriting, but i would need to look at the file provider to verify.
[2013-05-24 21:22:18 -0400] stormerider: ill look into that. if that's the case, then i should be able to trap whether or not it did overwrite the file before setting new_resource.updated_by_last_action(true)
[2013-05-24 21:23:16 -0400] monokrome: stormerider: The worst part of this is that it's completely reproducable
[2013-05-24 21:23:19 -0400] stormerider: "The contents of this attribute will replace any previous content when this attribute has something other than the default value." sounds like probably not.
[2013-05-24 21:23:23 -0400] monokrome: It's happening on both Hosted and Open Source Chef.
[2013-05-24 21:23:51 -0400] stormerider: monokrome: i have no idea... that's bizarre.
[2013-05-24 21:24:05 -0400] stormerider: 11.4.4 for the client, yes?
[2013-05-24 21:24:43 -0400] monokrome: waiting for a server to boot to verify
[2013-05-24 21:25:55 -0400] monokrome: I used chef-server_11.0.8-1.ubuntu.12.04_amd64.deb on the server
[2013-05-24 21:26:28 -0400] stormerider: i wasnt worried about the server since you're reproing it on hosted chef
[2013-05-24 21:26:35 -0400] monokrome: yeah
[2013-05-24 21:26:40 -0400] monokrome: just waiting for a client to bootstrap
[2013-05-24 21:26:42 -0400] monokrome: so I can see the version
[2013-05-24 21:26:55 -0400] stormerider: the gist says 11.4.4
[2013-05-24 21:27:27 -0400] stormerider: but yeah, i would log into that node once it's up and rerun it with the -l debug like the wiki says
[2013-05-24 21:27:36 -0400] stormerider: see if that sheds any light on the situation
[2013-05-24 21:32:36 -0400] stormerider: i think the thing about the wiki is that object-specific permissions, as far as i know, are specific to hosted/private chef
[2013-05-24 21:33:17 -0400] stormerider: i may be incorrect, though, i spend most of my time on OSE
[2013-05-24 21:44:13 -0400] stormerider: miah: actually, looking at https://github.com/opscode/chef/blob/master/lib/chef/provider/file.rb, it does do that.
[2013-05-24 21:46:36 -0400] stormerider: now to see if i can actually tell whether or not it's been updated in the LWRP
[2013-05-24 21:46:54 -0400] stormerider: actually, i think im mixing compile and converge
[2013-05-24 21:50:20 -0400] shutch: hi all. question, i successfully made a cookbook with a recipe that calls web_app "name" do. just trying to understand the working of chef, does it know that web_app requires apache?
[2013-05-24 21:56:01 -0400] thanatas: Is there any docs on chef-shell?
[2013-05-24 21:56:14 -0400] mattray: http://wiki.opscode.com/display/chef/Shef is all I can find
[2013-05-24 21:56:18 -0400] mattray: thanatas: ^^
[2013-05-24 21:56:28 -0400] stormerider: web_app is an apache2 LWRP, so your cookbook would need to include "depends apache2" in metadata.rb
[2013-05-24 21:56:54 -0400] thanatas: thanks seems that needs to be ported to the new website still it seems
[2013-05-24 21:57:24 -0400] mattray: thanatas: yeah, the chef-docs are on github.com/opscode/chef-docs
[2013-05-24 21:57:25 -0400] stormerider: d.o.c is pretty new, and under pretty aggressive updating :)
[2013-05-24 21:57:35 -0400] mattray: thanatas: I'm going to go look for an Issue for it
[2013-05-24 21:57:39 -0400] mattray: and file it myself
[2013-05-24 21:58:00 -0400] thanatas: Cool, struggling with some of the docs, hopefully I can make some additions once I figure out my problems
[2013-05-24 21:58:43 -0400] mattray: thanatas: https://github.com/opscode/chef-docs/issues/85
[2013-05-24 21:58:58 -0400] shutch: stormerider: thats exactly it, i don't have that depends in my metadata, and it works fine?
[2013-05-24 21:59:15 -0400] thanatas: thanks mattray!
[2013-05-24 21:59:29 -0400] stormerider: huh. not sure, then :)
[2013-05-24 21:59:54 -0400] thanatas: saw it talked about in this video and had never heard of it, and I think it not being on the new site is part of the issue  http://www.youtube.com/watch?v=IJCY2cEr6Rw
[2013-05-24 22:03:54 -0400] acts_as_coder: when attempting to re-use community cookbooks by wrapping them, what's the pattern for "wrapping" a template file to add more information to it? For example, I want to add two lines to the nginx cookbook's passenger.conf.erb template (http://bit.ly/134fYZN)
[2013-05-24 22:05:00 -0400] shutch: acts_as_coder: roll your own cookbook that depends on that
[2013-05-24 22:06:51 -0400] acts_as_coder: shutch: so, I have that already, and I'm following the 'private cookbook' style with a _nginx.rb in my main cookbook which sets attributes and then does 'include_recipe "nginx::source"' but I'm not clear on how to deal with modifying/overriding the passenger template that's in the community cookbok.
[2013-05-24 22:07:56 -0400] acts_as_coder: shutch: do I include my own passenger.conf.erb in my wrapper cookbook?
[2013-05-24 22:07:59 -0400] shutch: https://github.com/opscode-cookbooks/nginx use the config options in read me.md
[2013-05-24 22:09:16 -0400] thanatas: Haven't done much with nginx, but if it has an include httpd.conf type of file at the end of the default apache.conf, you could also write your new lines to that file and ensure the base includes it
[2013-05-24 22:10:33 -0400] acts_as_coder: thenatas: oh, of course! I could just do that :) I'll just drop in another passenger2.conf file (or named whatever) and put my extra configs there.
[2013-05-24 22:10:52 -0400] gyre007: guys how can I search for nodes which have certain attribute set using knife ?
[2013-05-24 22:10:55 -0400] acts_as_coder: shutch: the issue I'm having is that I want to add new passenger config options that are not part of the existing nginx community cookbook.
[2013-05-24 22:11:47 -0400] acts_as_coder: shutch: that is, they don't exist currently in the passenger.conf.erb template so the existing docs / code aren't relevant
[2013-05-24 22:14:17 -0400] stormerider: gyre007: like what attribute?
[2013-05-24 22:14:38 -0400] gyre007: any attribute saved on chef server after chef run...
[2013-05-24 22:14:50 -0400] gyre007: they should all be indexed right ?
[2013-05-24 22:15:04 -0400] stormerider: yes, i just wanted to give a specific example... sec.
[2013-05-24 22:16:16 -0400] stormerider: knife search node "platform:ubuntu", knife search node "ec2_public_hostname:*us-west-2*", etc.
[2013-05-24 22:16:36 -0400] stormerider: basically the thing to keep in mind is that the Ohai structure gets flattened via underscores
[2013-05-24 22:16:55 -0400] stormerider: so while in other places it would be ec2:public_hostname, in the search it's ec2_public_hostname
[2013-05-24 22:16:55 -0400] gyre007: but these are automatic attributes set by ohai ?
[2013-05-24 22:17:01 -0400] stormerider: platform is
[2013-05-24 22:17:07 -0400] gyre007: what if I have some custom attributes set by recipes etc..
[2013-05-24 22:17:12 -0400] gyre007: and want to search by those...
[2013-05-24 22:17:22 -0400] stormerider: should be the same, iirc
[2013-05-24 22:17:24 -0400] gyre007: like...what version of postgres is installed on the server
[2013-05-24 22:18:13 -0400] stormerider: i think that's handled similarly, assuming it's part of the node data information, but i may be wrong. havent tried that myself.
[2013-05-24 22:18:40 -0400] gyre007: mm
[2013-05-24 22:18:51 -0400] gyre007: yeah...I would've thought so...havent figured it out yet...
[2013-05-24 22:22:48 -0400] gyre007: I think i've figured it out stormerider ..after reading this http://docs.opscode.com/essentials_search.html
[2013-05-24 22:23:50 -0400] stormerider: do you mind showing an example of the syntax? im curious to see what you came up with in case i have to try something similar down the road :)
[2013-05-24 22:24:02 -0400] monokrome: stormerider: The clients are Chef 11.4.4
[2013-05-24 22:24:11 -0400] jmickle: anyone else having problems launching instances with hosted chef?
[2013-05-24 22:24:16 -0400] monokrome: Sorry for the delay there
[2013-05-24 22:24:21 -0400] stormerider: monokrome: yeah, i mentioned that i saw that inside the gist
[2013-05-24 22:24:27 -0400] jmickle: i keep getting a 403 Fri, 24 May 2013 22:18:54 +0000] INFO: HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden
[2013-05-24 22:24:35 -0400] monokrome: So that should be fine then, right?
[2013-05-24 22:24:42 -0400] stormerider: monokrome: yes
[2013-05-24 22:24:52 -0400] monokrome: then I don't understand
[2013-05-24 22:25:12 -0400] stormerider: jmickle: there's been a bunch of people who have issues after the recent upgrade. there's a thread on the email list about it.
[2013-05-24 22:25:40 -0400] gyre007: stormerider: let's say you have attribute => node[:foo1][:foo2] = val you can search for it like this:  knife search node 'foo1_foo2:val' -i
[2013-05-24 22:26:01 -0400] gyre007: obviously this must be saved on the Chef server and indexed by solr..
[2013-05-24 22:26:05 -0400] stormerider: gyre007: perfect, that makes a lot of sense.
[2013-05-24 22:26:07 -0400] stormerider: *nods*
[2013-05-24 22:26:24 -0400] stormerider: monokrome: i suggested posting the gist with details to the mailing list to see if anyone else has any ideas.
[2013-05-24 22:27:15 -0400] monokrome: Yeah, I saw that
[2013-05-24 22:27:34 -0400] jmickle: stormerider: thanks do you know where to find that info?
[2013-05-24 22:27:42 -0400] monokrome: I think that it could be an issue with knife-rackspace?
[2013-05-24 22:29:49 -0400] stormerider: jmickle: http://lists.opscode.com/sympa/arc/chef/2013-05/msg00442.html
[2013-05-24 22:30:14 -0400] stormerider: monokrome: entirely possible, i honestly dont know. thus the mailing list, broader base of people to see the issue.
[2013-05-24 22:30:34 -0400] monokrome: understood
[2013-05-24 22:30:36 -0400] monokrome: thanks for your help :)
[2013-05-24 22:31:32 -0400] stormerider: just paying it forward :)
[2013-05-24 22:34:12 -0400] stormerider: so this is a bit more a git question, but i wasnt paying enough attention when i cloned the nagios cookbook and sent in a pull request. i have a separate ticket to submit a PR on, but if i commit to my repo it will update the first PR. if i make a new branch, it will be based on the code i made in the first patch. thoughts about how to get myself out of this hole? :)
[2013-05-24 22:35:35 -0400] acts_as_coder: stormerider: you sure updating the code will alter the pull request? Aren't pull requests based on a specific git sha?
[2013-05-24 22:37:08 -0400] stormerider: im pretty sure that pull requests are based on branch, not commit, so you can update them in response to people's comments.
[2013-05-24 22:37:42 -0400] stormerider: which is why i should have made my own branch and not committed to master *slaps hand*
[2013-05-24 22:37:43 -0400] shutch: acts_as_coder: change branch?
[2013-05-24 22:38:09 -0400] acts_as_coder: well, how about this git reset back to the sha before your changes on master, then branch, then make changes on that new branch
[2013-05-24 22:38:53 -0400] jkline__: Most of the example projects I have looked at, e.g. Net::SSH , Fog, use module as their top level namespace. Chef uses class. Why is that?
[2013-05-24 22:39:10 -0400] jkline__: I assume that allowing me to instantiate a Chef has some benefit?
[2013-05-24 22:39:59 -0400] stormerider: actually, i think i can make a branch from the commit before my changes, and then update from there...
[2013-05-24 22:40:25 -0400] acts_as_coder: stormerider: yeah, that's what I was attempting to describe.
[2013-05-24 22:40:40 -0400] jkline__: For example, https://github.com/fog/fog/blob/master/lib/fog/version.rb uses module vs https://github.com/opscode/chef/blob/master/lib/chef/version.rb uses class
[2013-05-24 22:40:51 -0400] stormerider: right, but it can be done via the git branch command rather than reset
[2013-05-24 22:41:36 -0400] acts_as_coder: don't you need to reset you local repo to the proper sha in order to run "git branch" from that point?
[2013-05-24 22:48:50 -0400] stormerider: git checkout -b <newbranch> <oldcommitsha>
[2013-05-24 22:51:08 -0400] acts_as_coder: stormerider: thanks for the git tip  i think my way would work too but yours is slicker :)
[2013-05-24 22:51:31 -0400] thanatas: ok trying to help upgrade a community cookbook that is failing in chef 11 but worked in chef 10.  New to chef, really new to ruby I can't figure out why this is still erring out -- https://gist.github.com/kylesloan/5647024
[2013-05-24 22:53:37 -0400] stormerider: thanatas: i think you want "link #{node['ack']['symlink_as'].to_s} do"
[2013-05-24 22:54:07 -0400] stormerider: or something along those lines at least
[2013-05-24 22:54:43 -0400] dysinger: how do I get test-kitchen to ignore my vendor/ dir ?
[2013-05-24 22:54:52 -0400] dysinger: vagrant has the same problem
[2013-05-24 22:54:55 -0400] stormerider: probably dont need the .to_s with the #{}, actually.
[2013-05-24 22:55:29 -0400] jvbe: jtimberman: i've setup a new chef server but can't get my existing nodes to authenticate, even by creating new pvt keys
[2013-05-24 22:57:55 -0400] jvbe: jtimberman: somehow resetting the pvt key didn't work, delete+recreating the client does work
[2013-05-24 22:57:59 -0400] jvbe: sigh
[2013-05-24 22:59:25 -0400] stormerider: is the old chef server still around? if so, you could download the client/node list from that and then upload to the new server
[2013-05-24 22:59:51 -0400] jvbe: i did that
[2013-05-24 22:59:54 -0400] jvbe: didn't work
[2013-05-24 23:00:19 -0400] stormerider: odd. that's how i migrated from 10 to 11.
[2013-05-24 23:00:46 -0400] jvbe: yeah i find a lot of things odd with chef
[2013-05-24 23:03:02 -0400] jvbe: great now it authenticates up to the next problem "ArgumentError: invalid byte sequence in US-ASCII"
[2013-05-24 23:10:54 -0400] Twirrim: Looking for a quick sanity check... https://github.com/opscode-cookbooks/haproxy/commit/3a9e6eae24643ffcc42772df940d62b32425a7ea  That change to haproxy.cfg, particularly the new lines 15 and 18, causes things to break because @defaults_timeouts hasn't been passed to it.
[2013-05-24 23:11:02 -0400] Twirrim: am I missing something obvious?
[2013-05-24 23:14:15 -0400] thanatas: Anyone know of a cookbook that uses link and works in chef11?
[2013-05-24 23:29:00 -0400] jperry: Ohai folks
[2013-05-24 23:29:13 -0400] jperry: Anyone know where the intermediary files go when bootstrapping a node?
[2013-05-24 23:29:43 -0400] jperry: the bootstrap process seems to freeze up part way through and never finish
[2013-05-24 23:30:44 -0400] stormerider: thanatas: i am in one of my private cookbooks.
[2013-05-24 23:30:52 -0400] stormerider: thanatas: did you try my suggestion?
[2013-05-24 23:32:44 -0400] thanatas: yes
[2013-05-24 23:32:51 -0400] thanatas: it didn't work https://gist.github.com/kylesloan/5647024
[2013-05-24 23:33:38 -0400] thanatas: and i cannot find a cookbook that devops has a link as an example in to compare with
[2013-05-24 23:34:22 -0400] stormerider: what was the error that it came back with?
[2013-05-24 23:34:36 -0400] thanatas: [2013-05-24T23:22:58+00:00] ERROR: Running exception handlers
[2013-05-24 23:34:37 -0400] thanatas: [2013-05-24T23:22:58+00:00] ERROR: Exception handlers complete
[2013-05-24 23:34:38 -0400] thanatas: [2013-05-24T23:22:58+00:00] FATAL: Stacktrace dumped to /tmp/vagrant-chef-1/chef-stacktrace.out
[2013-05-24 23:34:38 -0400] thanatas: [2013-05-24T23:22:58+00:00] FATAL: NoMethodError: undefined method `[]' for nil:NilClass
[2013-05-24 23:34:46 -0400] thanatas:  12:  if platform?(%w{debian ubuntu})
[2013-05-24 23:34:47 -0400] thanatas:  13>>   link node['ack']['symlink_as'].to_s do #fails
[2013-05-24 23:35:09 -0400] stormerider: that's not using the #{}
[2013-05-24 23:35:25 -0400] thanatas: oh sorry, i've been trying random things, let me put that one back
[2013-05-24 23:36:52 -0400] thanatas:  15>>   link "#{node['ack']['symlink_as'].to_s}" do
[2013-05-24 23:36:59 -0400] thanatas: [2013-05-24T23:36:27+00:00] ERROR: Running exception handlers
[2013-05-24 23:36:59 -0400] thanatas: [2013-05-24T23:36:27+00:00] ERROR: Exception handlers complete
[2013-05-24 23:37:00 -0400] thanatas: [2013-05-24T23:36:27+00:00] FATAL: Stacktrace dumped to /tmp/vagrant-chef-1/chef-stacktrace.out
[2013-05-24 23:37:01 -0400] thanatas: [2013-05-24T23:36:27+00:00] FATAL: NoMethodError: undefined method `[]' for nil:NilClass
[2013-05-24 23:37:20 -0400] thanatas: well this is forcing me to learn ruby ha
[2013-05-24 23:38:13 -0400] thanatas: i can commit my changes so far to github if that makes it easier
[2013-05-24 23:40:27 -0400] stormerider: i might be wrong but i think you also need to specify "link_type :symbolic" (or other type). and i dont think you need the .to_s. beyond that im out of ideas and time, sorry.
[2013-05-24 23:40:51 -0400] thanatas: stormerider: thanks, i'll try that.. if not i'll hit the mailing list
[2013-05-24 23:42:25 -0400] thanatas: http://docs.opscode.com/resource_link.html says link_type defaults
[2013-05-24 23:42:37 -0400] thanatas: and link works if i put in a string instead of a variable
[2013-05-24 23:44:26 -0400] stormerider: thanatas: heading out now, but found this: nagios/recipes/server_source.rb:link "#{node['nagios']['conf_dir']}/stylesheets" do
[2013-05-24 23:44:33 -0400] stormerider: so check the nagios cookbook.
[2013-05-24 23:44:39 -0400] thanatas: cool thanks stormerider
[2013-05-24 23:44:41 -0400] stormerider: np
