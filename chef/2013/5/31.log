[2013-05-31 00:22:06 -0400] derferma_: Is there any way to use a SHA128 checksum with remote_file instead of SHA256
[2013-05-31 00:23:41 -0400] coderanger: derferma_: No
[2013-05-31 00:24:57 -0400] miah: generating a sha256 is hard?
[2013-05-31 00:27:27 -0400] coderanger: miah: It is when you do it on an abacus like a real nerd!
[2013-05-31 00:27:52 -0400] coderanger: That is actually an interesting, I wonder what visualizations of hash algos on an abacus would look like
[2013-05-31 00:30:16 -0400] miah: coderanger: nope. https://www.youtube.com/watch?v=6m6s-ulE6LY
[2013-05-31 00:30:24 -0400] derferma_: miah: no, I already have a bunch of sha128 for files I want to download
[2013-05-31 00:30:26 -0400] derferma_: that's all
[2013-05-31 00:31:16 -0400] coderanger: miah: Craziness, I've got my grandfather's old Curta I should practice more with
[2013-05-31 00:31:40 -0400] miah: i like when the kids in this video show that they imagine the abacus =)
[2013-05-31 00:50:24 -0400] monokrome: wamilton:
[2013-05-31 00:50:30 -0400] monokrome: Sorry, accident.
[2013-05-31 00:56:21 -0400] theCzar: Hello Chefs, question I'm starting to port over some cookbooks to so that they will work with smartos.  Any good resources I can turn to?
[2013-05-31 00:56:50 -0400] theCzar: Also does anyone have a preference on compatability cookbooks for smartos?  Like the Opscode/smartos or Joyent/smartos cookbooks?
[2013-05-31 01:03:52 -0400] shanlar: https://gist.github.com/shanlar/5682360
[2013-05-31 01:04:28 -0400] shanlar: im trying to make the directory attribute default to the root_path, but this isnt working
[2013-05-31 01:04:29 -0400] shanlar: any ideas?
[2013-05-31 01:08:04 -0400] theCzar: shanlar: There's probably a better way than this, but the first thought is to make the default an empty string, then in the code replace it with a the root_path if it's empty
[2013-05-31 01:08:18 -0400] shanlar: yea i was thinking of that
[2013-05-31 01:08:24 -0400] shanlar: as plan B
[2013-05-31 01:10:37 -0400] failshell: hey guys. i installed chef server 11 on  AWS. after the install, i changed its hostname. problem is, it works inside AWS, but from the office, i cant knife cookbook upload/download, because its returning the AWS hostname of the instance. where do i change the URL ?
[2013-05-31 01:10:42 -0400] failshell: im abit confused by 11
[2013-05-31 01:13:57 -0400] failshell: https://gist.github.com/failshell/f5d39166017fa55e1862
[2013-05-31 01:14:00 -0400] failshell: that's the error i get
[2013-05-31 01:16:42 -0400] bluekelp: failshell: can you do "knife node list" ok?
[2013-05-31 01:16:48 -0400] failshell: yeah
[2013-05-31 01:18:07 -0400] failshell: i tried replacing that EC2 hostname from /etc/chef-server/chef-running-config.json with the correct one
[2013-05-31 01:18:08 -0400] bluekelp: you'll need a vpn or you might be able to hack ip-10-98-130-231.ec2.internal into your local /etc/hosts as the public ip
[2013-05-31 01:18:40 -0400] bluekelp: yeah i don't know how to get the server to update what it thinks its fqdn is. might be cached somewhere in its indexes, etc. too
[2013-05-31 01:18:40 -0400] failshell: cant i just reconfigure chef to use a different hostname?
[2013-05-31 01:19:32 -0400] failshell: hmmm
[2013-05-31 01:22:00 -0400] failshell: chef-server-ctl reconfigure : )
[2013-05-31 01:22:01 -0400] failshell: woot
[2013-05-31 01:22:08 -0400] failshell: chef 11 is awesome
[2013-05-31 01:49:42 -0400] rpcesar: ive recenty set up chef OS 11 server , and am curious as to what regard cloning the skeleton git repository is necessary. We generally use SVN in shop, and it seems like 10 allowed you to manually copy skeletons. im also concerned (as I do not understand) the full function of this cloned directory after its initial creation. we will have multiple developers and users, and I need to know if these should be treated as a check-in/out proc
[2013-05-31 01:50:02 -0400] rpcesar: for developers , or if its local to them
[2013-05-31 01:52:33 -0400] bluekelp: rpcesar: it's just a skeleton - little magic there. but most of the info in it gets pushed/uploaded to the server, so you'll need scripts/etc to ensure the SVN contents are authoratative
[2013-05-31 01:52:58 -0400] bluekelp: that gets tricky with developers.  recommend having a release branch/etc and making the sync with server part of your release process
[2013-05-31 01:53:46 -0400] bluekelp: if you're doing DevOps-type "push to SCM -> live" then something like a Makefile triggered by a commit script might work.  but you might overwrite things if ppl aren't pulling/updating freqently
[2013-05-31 01:54:17 -0400] rpcesar: its not necessary to be perfect, just that we have a protocal
[2013-05-31 01:55:07 -0400] rpcesar: so your saying that when the user knifes to the server, it overwrites, so its necessary that the client (workstation) is fully up to date?
[2013-05-31 01:55:51 -0400] rpcesar: and does git somehow make this sycnhronization (if it exists) easier?
[2013-05-31 01:56:42 -0400] bluekelp: git does not make it easier than SVN, not really
[2013-05-31 01:57:25 -0400] bluekelp: yes - be careful of things like roles, environments, etc.  even cookbooks b/c the code in SVN doesn't matter to the server.  what gets uploaded or sent to it does.  so a script or protocol will help
[2013-05-31 01:58:31 -0400] bluekelp: so things like environments, if they lock cookbook versions -- if you're not careful you might end up with regressions if someone hasn't updatea and runs knife with local mods
[2013-05-31 01:59:04 -0400] bluekelp: SVN actually makes that a little better b/c it won't commit without updating - git will happily commit without knowing/caring someone else committed/pushed changes
[2013-05-31 02:00:28 -0400] rpcesar: ok strange question then. would it be possible to run a git or svn repository ON the chef server. and effectively knife to itself?
[2013-05-31 02:00:34 -0400] bluekelp: i recommend not letting your devs use knife to push to the server unless you're "full devops checkins go live"
[2013-05-31 02:01:07 -0400] bluekelp: you could.  you could setup a local working copy and a cron to pull/update and run a script to refresh all the data
[2013-05-31 02:01:36 -0400] bluekelp: or have someone "release" to the server if you're that sort of shop
[2013-05-31 02:01:46 -0400] rpcesar: yea, we are that sort of shop.
[2013-05-31 02:02:09 -0400] rpcesar: i cant even get authorization on isolated staging and production enviornments
[2013-05-31 02:02:26 -0400] bluekelp: then i recomment *not* letting your devs have access to the production server and/or keys that'll talk to it.  give them a test server to develop against
[2013-05-31 02:02:37 -0400] bluekelp: (if you're paranoid, like me)
[2013-05-31 02:07:34 -0400] rpcesar: well, our frontend logic is in svn at another location. the plan was to have an svn checkout to a revision for front end type deals as part of the roles attributed to frontend servers. So the only commits that would be made would in essence be for underlying server envo installs
[2013-05-31 02:07:44 -0400] rpcesar: mostly dealing with keeping a small farm of mongo servers active
[2013-05-31 02:27:59 -0400] coderanger: Would it be awful to name files _start.rb and ~end.rb to make sure they execute before and after 'normal' files?
[2013-05-31 02:37:47 -0400] bluekelp: why not the more well known 00_start and 99_end -- if you can also control the files in between?
[2013-05-31 02:38:18 -0400] bluekelp: tildes will make some people grumpy
[2013-05-31 02:39:14 -0400] coderanger: bluekelp: Not my fault it is the last printing char in 7bit ascii :)
[2013-05-31 02:39:32 -0400] coderanger: I think I figured out I don't need an end file though
[2013-05-31 02:39:37 -0400] coderanger: so _start.rb works
[2013-05-31 02:40:41 -0400] bluekelp: it's much better than the file __do_not_edit_or_remove_this_file_without_permissiong_from_XXXXXX.php I once saw in a check-in
[2013-05-31 02:41:14 -0400] bluekelp: (typo is mine)
[2013-05-31 02:41:41 -0400] spheromak: got the message across
[2013-05-31 02:42:27 -0400] bluekelp: we rewrote the code and deleted the file >:)
[2013-05-31 02:42:56 -0400] coderanger: So I think phase three should be writing chef recipes in Lua
[2013-05-31 02:43:07 -0400] coderanger: Because thats totally a good idea :)
[2013-05-31 02:43:36 -0400] bluekelp: oh good. then i'm glad i'm getting pulled off ops and back to iphone :)
[2013-05-31 02:44:01 -0400] bluekelp: totally a good idea.  so good, in fact, you should go do it to puppet first... i mean for* puppet :)
[2013-05-31 02:44:16 -0400] coderanger: bluekelp: I'm not kidding, check out the chef-funnel cookbook
[2013-05-31 02:44:37 -0400] bluekelp: it might help keep memory footprint down during chef runs
[2013-05-31 02:45:00 -0400] coderanger: lolno
[2013-05-31 02:45:07 -0400] coderanger: This thing probably leaks like a sieve
[2013-05-31 02:46:31 -0400] bluekelp: you'll need to write chef-sieve for that
[2013-05-31 03:05:26 -0400] jtimberman: spheromak: yo yo
[2013-05-31 03:06:23 -0400] spheromak: jtimberman whats up
[2013-05-31 03:06:34 -0400] jtimberman: spheromak: think you'll have time to hack on that openssl ticket?
[2013-05-31 03:07:08 -0400] spheromak: prob not till saturday
[2013-05-31 03:07:24 -0400] spheromak: :\
[2013-05-31 03:14:01 -0400] jtimberman: ok no worries :)
[2013-05-31 03:18:32 -0400] jtimberman: I'm not going to have cycles to get to that any time soon.
[2013-05-31 07:20:28 -0400] admin0: hi ..  can chef client bootstrap itself ? i.e based on rules or some output download the correct role
[2013-05-31 07:20:54 -0400] admin0: i mean based on output of some file/command, download the specified roles and apply
[2013-05-31 07:51:55 -0400] coderanger: admin0: Generally you bootstrap chef via the knife bootstrap command, or one of the related cloud server commands
[2013-05-31 07:53:11 -0400] admin0: what i want to do is  using bootp/dhcp .. install a server with chef-client, which will register itself to the chef-server and based on lldp output ( rack/datacenter ) gets its role ( web server, hypervisor ) and apply that role
[2013-05-31 07:53:48 -0400] admin0: i mean using bootp, just boot servers, and it will bootstrap itself based on lldp output on what it is .. if the rack is a web rack, it will register itself in a web server role
[2013-05-31 07:58:45 -0400] pehlert: Hey folks. I've just run into a very strange issue where uploading an encrypted data bag item to the server would instead reset it locally. Has that ever happened to anyone?
[2013-05-31 08:02:03 -0400] pehlert: Sorry, my fault. I misunderstood how knife edit works
[2013-05-31 08:02:10 -0400] pehlert: I thought it would modify the files locally
[2013-05-31 08:38:16 -0400] linuxboy_: hi
[2013-05-31 08:38:22 -0400] linuxboy_: do any of you chef your chef-server?
[2013-05-31 08:58:52 -0400] admin0: linuxboy_, you are looking to create a farm of chef-servers ?
[2013-05-31 08:59:34 -0400] n1ko: even if theres only a handful of chef-servers chef is quite handy (combined with version control) if you want to keep track of when and who did the changes
[2013-05-31 08:59:53 -0400] linuxboy_: n1ko: correct
[2013-05-31 08:59:58 -0400] n1ko: and want to verify to exact state of the server or maybe test upgrades etc with vagrant
[2013-05-31 08:59:58 -0400] linuxboy_: we have 1 chef-server
[2013-05-31 09:07:40 -0400] ordos: Hi guys, I did a simulation with a Chef server with 600.000 nodes with 2500 nodes executing Chef each minute. Somehow I still got awesome results! Is my simulation wrong or is the Chef server just this good?
[2013-05-31 09:11:19 -0400] alex88: hi guys, is there a way to compile a template into a string instead of writing into a file?
[2013-05-31 09:12:20 -0400] Dynom`: ordos; I'm curious how you did that simulation
[2013-05-31 09:12:45 -0400] ordos: Dynom, I replicated every API call from a normal chef run
[2013-05-31 09:13:53 -0400] ordos: I did assumed the cookbooks were up to date, so that it did not have to download them on each run
[2013-05-31 09:14:21 -0400] ordos: Every run consists of 5 API calls made to the Chef server
[2013-05-31 09:14:21 -0400] alex88: how you got 600k nodes?
[2013-05-31 09:14:29 -0400] ordos: I inserted them using the API
[2013-05-31 09:14:31 -0400] alex88: just ab?
[2013-05-31 09:14:42 -0400] ordos: with simulated ohai information etc
[2013-05-31 09:16:15 -0400] ordos: With 2500 nodes per minute the Chef server was able to return the 5 API calls in less than 1 second
[2013-05-31 09:17:21 -0400] ordos: 1000 nodes per minute even 0,1 second
[2013-05-31 10:00:41 -0400] mike_k: I am using site-cookbooks recipe which accesses 'nginx' recipe's attributes like "#{node['nginx']['dir']}". It works. Do I have to explicitly include the nginx recipe or make Chef aware that my custom recipe depends on 'nginx'?
[2013-05-31 10:01:16 -0400] mike_k: (other than using them in the same node file)
[2013-05-31 10:18:40 -0400] bubu: hey guys - I have a large postgres DB, gets restarted on provision and next chef block runs a query. It can take several seconds for the db to respond to requests and therefore after the restart it chef blows up as it moves onto the next block and chef cant run. any ideas on a good backoff strategy?
[2013-05-31 10:21:05 -0400] bubu: other than sleep ... ?
[2013-05-31 10:21:58 -0400] svparijs: Hey there, i'm trying to bootstrap a Rackspace instance but debug information says: ERROR: all authorization methods failed (tried none, publickey, hostbased, password)
[2013-05-31 10:22:21 -0400] svparijs: I have no clue where to set the key for authentication, any idea's?
[2013-05-31 10:22:32 -0400] binamov: bubu i was going to suggest sleep perhaps not make the query the next chef block that runs?
[2013-05-31 10:23:02 -0400] bubu: well, the DB will grow in size so a sleep 5 may work for now but not in a few months for example
[2013-05-31 10:23:26 -0400] bubu: I would rather run a check to see if I can run a query, keep trying until it can, then move onto the next block
[2013-05-31 10:23:36 -0400] bubu: binamov: needs to be next block :/
[2013-05-31 10:23:40 -0400] binamov: svparijs you followed this obviously? http://docs.opscode.com/plugin_knife_rackspace.html
[2013-05-31 10:24:26 -0400] bubu: how can I run a query, and if it can't run, rather than blow up, it sleeps, tries again, sleeps, tries again until it can run it successfully ... ?
[2013-05-31 10:24:50 -0400] svparijs: binamov: checking if i have verything
[2013-05-31 10:26:42 -0400] binamov: bubu that's a really good question, not sure i know the answer. you can come back in about 1.5 hours when the east coast wakes up and ask again
[2013-05-31 10:26:53 -0400] bubu: :]
[2013-05-31 10:26:54 -0400] bubu: heh
[2013-05-31 10:26:55 -0400] bubu: thanks
[2013-05-31 10:27:48 -0400] svparijs: binamov: do i need this set: -i IDENTITY_FILE, --identity-file IDENTITY_FILE
[2013-05-31 10:28:04 -0400] binamov: svparijs that's what it looks like, yeah
[2013-05-31 10:28:29 -0400] svparijs: can i set it by default?
[2013-05-31 10:28:46 -0400] binamov: svparijs you can probably set in knife.rb
[2013-05-31 10:30:31 -0400] binamov: svparijs or in your workstation ssh profile?
[2013-05-31 10:30:42 -0400] svparijs: binamov: i have this now: identity-file '/Users/svparijs/.ssh/id_rsa.pub'
[2013-05-31 10:31:01 -0400] svparijs: this is my workstation profile
[2013-05-31 10:31:13 -0400] sleepin1: I want to override settings in the cookbooks I've downloaded; I've added some defaults and overrides to an environment but the overrides don't get applied to nodes in that environment... any ideas?
[2013-05-31 10:31:44 -0400] sleepin1: Should I be overiding cookbook settings elsewhere?
[2013-05-31 10:32:33 -0400] binamov: sleepin1 i think you're looking for this http://docs.opscode.com/essentials_cookbook_attribute_files_attribute_precedence.html ?
[2013-05-31 10:33:25 -0400] sleepin1: my understanding was that an override on an environment (number 12) would take precedence most
[2013-05-31 10:33:32 -0400] binamov: svparijs riiight, and so you have a key you generated with rackspace?
[2013-05-31 10:34:06 -0400] sleepin1: it would certainly override default attributes in the cookbook, shouldn't it?
[2013-05-31 10:34:48 -0400] binamov: sleepin1 sounds like it, yes; perhaps your nodes are not part of your target environment?
[2013-05-31 10:35:18 -0400] svparijs: binamov: im not sure, i have the api key
[2013-05-31 10:36:01 -0400] binamov: svparijs i never worked with rackspace but i did with amazon ec2, i imagine it's similar i had to generate a key with amazon that i would need to be able to ssh
[2013-05-31 10:36:19 -0400] svparijs: ok
[2013-05-31 10:36:23 -0400] svparijs: i will have a look
[2013-05-31 10:38:30 -0400] sleepin1: @binamov: just triple checked and both node I'm interested in both have environments set, any other clues or different approaches?
[2013-05-31 10:39:36 -0400] binamov: sleepin1 have you tried searching those nodes for those attributes you're trying to set?
[2013-05-31 10:41:44 -0400] sleepin1: just for testing i've created a production and development environments, with one node in each environment running the mysql cookbook
[2013-05-31 10:42:35 -0400] sleepin1: I've then got{"overrides":{"mysql":{"innodb_log_buffer_size":"10M"}}} on the development environment
[2013-05-31 10:43:02 -0400] sleepin1: but this value never seems to get updated on the mysql config on the development node
[2013-05-31 10:43:29 -0400] binamov: sleepin1 that looks like a syntax issue more than anything...
[2013-05-31 10:44:12 -0400] sleepin1: how would you express the overrides?
[2013-05-31 10:44:38 -0400] binamov: sleepin1 tell me this: you're testing by looking at the config, or the knife search results for the attribute?
[2013-05-31 10:45:23 -0400] sleepin1: looking at my.cnf on the node
[2013-05-31 10:46:04 -0400] binamov: sleepin1 try actually knife search ?
[2013-05-31 10:47:29 -0400] sleepin1: being a noob you will have to excuse me, how do you mean use knife search?
[2013-05-31 10:48:02 -0400] binamov: sleepin1 chef lets you search your infrastructure for data like this...
[2013-05-31 10:48:39 -0400] binamov: sleepin1 there's like a gazillion ways to set an attribute try one of the examples here: http://docs.opscode.com/essentials_environments.html
[2013-05-31 10:49:39 -0400] sleepin1: how would i use knife to search for this particuler attribute?
[2013-05-31 10:50:26 -0400] binamov: sleepin1 see here, super powerful stuff http://docs.opscode.com/knife_search.html
[2013-05-31 10:52:59 -0400] sleepin1: tata, will get back to ready and trouble you all again later if I get stuck :)
[2013-05-31 10:53:06 -0400] sleepin1: reading
[2013-05-31 10:53:54 -0400] binamov: sleepin1 you can also try knife node show nodename -l and grep for something...
[2013-05-31 11:29:00 -0400] svparijs: binamov: still can't connect to Chef via rackspace, i've looked every where...
[2013-05-31 11:29:49 -0400] binamov: svparijs can't connect to chef or to rackspace? what do you get when you do knife client list ?
[2013-05-31 11:30:19 -0400] svparijs: ill Gist you the Debug log
[2013-05-31 11:30:44 -0400] lclclc: hi, anyone knows how to get the name of the current cookbook programatically in a recipe?
[2013-05-31 11:31:54 -0400] lclclc: this is how you can read chef config data
[2013-05-31 11:31:56 -0400] lclclc: Chef::Config[:cookbook_path]
[2013-05-31 11:32:41 -0400] lclclc: it somehow point to the one config object
[2013-05-31 11:32:43 -0400] svparijs: binamov: https://gist.github.com/svparijs/934060c28171dd8d9dab
[2013-05-31 11:32:44 -0400] lclclc: but this one does not work
[2013-05-31 11:32:53 -0400] lclclc: Chef::Cookbook::Metadata.name
[2013-05-31 11:36:11 -0400] binamov: svparijs that gist says password failed
[2013-05-31 11:37:04 -0400] binamov: svparijs it's an authentication problem with rackspace there
[2013-05-31 11:37:20 -0400] binamov: if you manually up a rackspace node, can you ssh into it?
[2013-05-31 11:37:35 -0400] svparijs:  yes
[2013-05-31 11:37:58 -0400] binamov: svparijs how? password/less/key?
[2013-05-31 11:38:29 -0400] svparijs: i use the Password generated by the server create command
[2013-05-31 11:38:41 -0400] svparijs: that might be an issue right there.
[2013-05-31 11:39:25 -0400] binamov: svparijs like i said, i never used rackspace, but it's obviously an authentication problem
[2013-05-31 11:40:03 -0400] svparijs: yes ill check on the rackspace end, they might ran into similar issues
[2013-05-31 11:40:36 -0400] binamov: svparijs knife rackspace is doing its thing over ssh, so should be told of the ssh authentication method to use
[2013-05-31 11:42:27 -0400] svparijs: binamov: or alteast where the key is to authenticate... asked the question in the rackspace channel, hope they know whats going on.
[2013-05-31 11:42:38 -0400] alex88: deploy resource, I've set symlinks({"data" => "data"}), purge_before_symlink ['data'], symlink_before_migrate({}), create_dirs_before_symlink []
[2013-05-31 11:42:54 -0400] alex88: and what it creates is just data/data -> shared/data
[2013-05-31 11:43:01 -0400] alex88: why data inside data?
[2013-05-31 11:58:14 -0400] alex88: anyone?
[2013-05-31 12:16:17 -0400] buga: Does anybody know how to use the oscode/application_ruby recipe with a custom database.yml?
[2013-05-31 12:16:23 -0400] bubu: I have a cookbook that deploys a postgres server install and then runs a query. The db import can take a while though so chef always fails first time around as it cannot run the query straight away. Any idea how I can raise an exception rather than chef blowing up, try again in 5 secs, if blows up again, wait 10 secs etc?
[2013-05-31 12:20:15 -0400] CaptainQuirk: Hi !
[2013-05-31 12:20:52 -0400] CaptainQuirk: I'm using the community nodejs cookbook
[2013-05-31 12:21:54 -0400] CaptainQuirk: Given the time taken by the chef command to run, I have the feeling that the install from source method used let my machine download and compile everytime I launch it
[2013-05-31 12:22:06 -0400] CaptainQuirk: Which is silly
[2013-05-31 12:26:35 -0400] CaptainQuirk: Is there a way to test if the program is already installed with only_if statements ?
[2013-05-31 12:44:32 -0400] behemphi: @CaptainQuirk I don't know the direct answer to your question, but I do know the Nginx cookbook does just that
[2013-05-31 12:44:40 -0400] behemphi: it uses an Ohai plugin
[2013-05-31 12:45:07 -0400] CaptainQuirk: to test the existence of nodejs ?
[2013-05-31 12:47:37 -0400] behemphi: I think it goes farther and tests the version
[2013-05-31 12:47:43 -0400] behemphi: and if the version changes it recompiles
[2013-05-31 12:47:49 -0400] behemphi: that is how I read it
[2013-05-31 12:49:19 -0400] bubu: :/
[2013-05-31 12:50:34 -0400] tolland: is there any metadata about the remote server available via the server API?
[2013-05-31 12:53:34 -0400] tolland: I mean is there a URL I can poll for status?
[2013-05-31 12:54:22 -0400] CaptainQuirk: behemphi, thanks, I'll take a look
[2013-05-31 12:54:56 -0400] tolland: I presume I  can pull /org/nodes/fiwehfuiewhfuihewif and check get the X-Chef-Version from the reposnse headers, and check for a 404  error, but it seems inelegant
[2013-05-31 12:56:08 -0400] bubu: If I want to use a gem in a recipe is it the chef_gem resource?
[2013-05-31 12:57:54 -0400] tolland: http://www.opscode.com/blog/2009/06/01/cool-chef-tricks-install-and-use-rubygems-in-a-chef-run/
[2013-05-31 13:04:16 -0400] tolland: bubu: you get that url?
[2013-05-31 13:04:18 -0400] tolland: http://www.opscode.com/blog/2009/06/01/cool-chef-tricks-install-and-use-rubygems-in-a-chef-run/
[2013-05-31 13:04:21 -0400] tolland: is a good one
[2013-05-31 13:04:29 -0400] bubu: ah yes thanks tolland :)
[2013-05-31 13:04:34 -0400] bubu: reading now :]
[2013-05-31 13:08:44 -0400] bubu: tolland: is that quite what I need?
[2013-05-31 13:10:14 -0400] thom: bubu: use the chef_gem resource - that article predates it
[2013-05-31 13:10:25 -0400] bubu: right thanks
[2013-05-31 13:10:29 -0400] bubu: chef_gem makes more sense to me
[2013-05-31 13:15:51 -0400] bubu: thom: if I want to use the retryable gem in my recipe
[2013-05-31 13:16:00 -0400] bubu: is it just chef_gem "retryable" do
[2013-05-31 13:16:09 -0400] bubu: action "install"
[2013-05-31 13:16:11 -0400] bubu: end ?
[2013-05-31 13:16:25 -0400] bubu: action :install rather
[2013-05-31 13:27:13 -0400] chris613: Good day, Chefs! I'm using the minitest-handler cookbook and I'm noticing that if I throw a file in mycookbook/files/default/test/myrecipe_test.rb it doesn't actually get delivered to my node and minitest-handler never sees it. However, if I add a cookbook_file resource that targets that file, everything works fine. Do I really need to do that? It's not mentioned anywhere, is there a better way?
[2013-05-31 13:27:50 -0400] dansons: hello #chef
[2013-05-31 13:27:52 -0400] admin0: hi all .. how do i grep a line in a config file and remove that with something else using ruby ?
[2013-05-31 13:28:29 -0400] dansons: At the moment I'm unable to upload cookbooks with knife. This week I upgraded to v11
[2013-05-31 13:28:34 -0400] dansons: now I get this message
[2013-05-31 13:28:47 -0400] dansons: ERROR: The data in your request was invalid
[2013-05-31 13:28:48 -0400] dansons: Response: Bad checksums!
[2013-05-31 13:29:06 -0400] dansons: With -VV it seems to be trying to create a sandbox with no files
[2013-05-31 13:29:31 -0400] dansons: I've seen some issues about this but it seems to have been resolved but my version of chef is the latest
[2013-05-31 13:29:34 -0400] dansons: so I'm stumped :)
[2013-05-31 13:29:41 -0400] dansons: Any assistance would be great!
[2013-05-31 13:31:51 -0400] admin0: dansons, i faced similar issues .. i had to change the server to https:// // and if the server dns does not resolve, add it to /etc/hosts
[2013-05-31 13:32:42 -0400] dansons: Interesting, I've had a few issues with that this week and thought I'd got it all right
[2013-05-31 13:32:56 -0400] dansons: I'll review the server again and see what's what
[2013-05-31 13:33:14 -0400] dansons: What's odd is that I can do everything else with my knife client
[2013-05-31 13:35:33 -0400] admin0: what is everything else :) ?
[2013-05-31 13:36:14 -0400] dansons: ha, sorry, I mean I can interact with clients, users, nodes etc just not cookbooks
[2013-05-31 13:36:28 -0400] dansons: but I have https and DNS is all correct
[2013-05-31 13:36:29 -0400] admin0: hmm.. then i am not sure :) ..
[2013-05-31 13:38:59 -0400] dansons: http://tickets.opscode.com/browse/CHEF-3638
[2013-05-31 13:39:07 -0400] dansons: This is the best resource I've found
[2013-05-31 13:39:27 -0400] dansons: Actually it's my exact problem!
[2013-05-31 13:40:17 -0400] maruq: hey guys
[2013-05-31 13:44:00 -0400] bubu: anyone know why when I do chef_gem in a shef session I get undefined method chef_gem ?
[2013-05-31 13:47:16 -0400] spox: bubu: need to be in recipe mode
[2013-05-31 13:47:31 -0400] bubu: ah ofc
[2013-05-31 13:47:35 -0400] bubu: thx spox
[2013-05-31 13:47:47 -0400] spox: sure :)
[2013-05-31 13:52:20 -0400] bubu: eh, spox:
[2013-05-31 13:52:22 -0400] bubu: NameError: Cannot find a resource for retryable on mac_os_x version 10.8.3
[2013-05-31 13:52:31 -0400] bubu: can see it on a gem install :o
[2013-05-31 13:52:35 -0400] bubu: gem list rather
[2013-05-31 13:53:23 -0400] spox: bubu: maybe gist what you are doing
[2013-05-31 13:53:43 -0400] spox: also, if you are using an omnibus install, chef_gems get installed into the omnibus itself, not the system
[2013-05-31 13:53:55 -0400] bubu: rgr spox
[2013-05-31 13:54:03 -0400] spox: so a regular `gem list` won't show it and those gems won't be what chef is using internally
[2013-05-31 13:54:13 -0400] bubu: ah, how can I see them then?
[2013-05-31 13:54:38 -0400] spox: i haven't used omnibus on os x, so i don't know if the path is the same as linux installs
[2013-05-31 13:54:43 -0400] bubu: https://gist.github.com/joshmyers/33d5ce19888b19a21584
[2013-05-31 13:54:49 -0400] spox: but on linux, /opt/chef/embedded/bin/gem list
[2013-05-31 13:55:17 -0400] bubu: am expecting it to explode on Mixlib::ShellOut::ShellCommandFailed
[2013-05-31 13:55:18 -0400] spox: require 'retryable'
[2013-05-31 13:55:35 -0400] bubu: retry 5 times, 10 secs between each, and then fail ..
[2013-05-31 13:56:14 -0400] spox: okay, i'm not sure about any of that stuff
[2013-05-31 13:56:23 -0400] spox: resources have a retry attribute you can use though
[2013-05-31 13:57:47 -0400] bubu: hmm
[2013-05-31 13:57:48 -0400] bubu: ok
[2013-05-31 14:00:06 -0400] bubu: not on the script resource?
[2013-05-31 14:00:06 -0400] bubu: http://docs.opscode.com/resource_script.html
[2013-05-31 14:00:14 -0400] djstunami: anyone know why partial_search wouldn't be found using chef-shell?  I know the cookbook was located because it lists it: http://pastie.org/7988907
[2013-05-31 14:06:18 -0400] BryanWB_: anyone have a wait_for resource that will wait for some condition to be true up to a time limit?
[2013-05-31 14:09:41 -0400] adnichols: I dont use it in a wait_for but I have a resource I call during a recipe which will poll a URL and wait for it to return a particular result (wait for app to start)
[2013-05-31 14:11:30 -0400] spox: lol
[2013-05-31 14:11:35 -0400] spox: BryanWB_: flock has it
[2013-05-31 14:11:41 -0400] spox: but it's not flock specific
[2013-05-31 14:11:51 -0400] spox: i should pull it out into a standalone cookbook lib
[2013-05-31 14:14:08 -0400] ssd7: BryanWB_: I think someone wrote one after some discussion on the mailing list
[2013-05-31 14:14:20 -0400] ssd7: I'd try searching the ML
[2013-05-31 14:14:33 -0400] BryanWB_: spox: kewl i may jsut pull it out
[2013-05-31 14:14:45 -0400] BryanWB_: ssd7: tks, i will have to search, any idea when that was?
[2013-05-31 14:14:59 -0400] BryanWB_: specifically i want to wait for EBS volumes to attach
[2013-05-31 14:15:11 -0400] BryanWB_: before trying to RAID them
[2013-05-31 14:21:17 -0400] ssd7: hrmm. Trying to remember the time frame. Sympa hates me now.
[2013-05-31 14:26:30 -0400] admin0: https://github.com/nickola/chef-ssh-keys --in which file do I need to put that .. the usage ?
[2013-05-31 14:26:53 -0400] admin0: i have created the data bags and uploaded the ssh-keys cookbook
[2013-05-31 14:27:09 -0400] admin0: and added  "recipe[ssh-keys]"  in the role list
[2013-05-31 14:30:29 -0400] cmwslw: My Chef configuration has been working for the past week, this morning it started failing. Can this randomly happen?
[2013-05-31 14:30:46 -0400] cmwslw: I'm using Chef to configure my Vagrant box
[2013-05-31 14:31:05 -0400] cmwslw: is there any way to tell Chef to just reinstall everything?
[2013-05-31 14:31:24 -0400] mattupstate: cmwslw: there's thousands of reasons it could not work ;)
[2013-05-31 14:31:30 -0400] mattupstate: an error would be helpful
[2013-05-31 14:32:19 -0400] cmwslw: apparently it's trying to run dpkg -i /tmp/vagrant-chef-1/rabbitmq-server_3.0.4-1_all.deb without superuser privs
[2013-05-31 14:32:41 -0400] cmwslw: I'm just wondering why it hasn't ran into this before I guess
[2013-05-31 14:32:48 -0400] ssd7: BryanWB_: Uff..well. I found the mailing list thread
[2013-05-31 14:32:56 -0400] ssd7: But the github repo is no more: https://github.com/erikh/chef-wait
[2013-05-31 14:33:22 -0400] BryanWB_: ssd7: tks, i think erikh moved that into his chef-workflow
[2013-05-31 14:33:34 -0400] chris613: I'm using the minitest-handler cookbook and I'm noticing that if I throw a file in mycookbook/files/default/test/myrecipe_test.rb it doesn't actually gets downloaded from chef-server and delivered to my node and minitest-handler never sees it. However, if I add a cookbook_file resource that targets that file, everything works fine. Do I really need to do that? It's not mentioned anywhere, is there a better way?
[2013-05-31 14:34:03 -0400] BryanWB_: ssd7: tks for looking
[2013-05-31 14:37:10 -0400] mattupstate: cmwslw: whats the error?
[2013-05-31 14:37:17 -0400] defishguy: Can anyone recommend a good chef book for someone with puppet experience?
[2013-05-31 14:39:15 -0400] cwj: theres a dearth of published written material on chef
[2013-05-31 14:39:30 -0400] cmwslw: in my recipes, how do I run a command as root?
[2013-05-31 14:39:32 -0400] cwj: this is one of the only chef books i know of, and its not really 'getting started' material
[2013-05-31 14:39:34 -0400] cwj: http://shop.oreilly.com/product/0636920020042.do
[2013-05-31 14:39:43 -0400] cmwslw: specifically the dpkg_package command
[2013-05-31 14:39:44 -0400] cwj: this one is supposed to be published in august http://shop.oreilly.com/product/0636920025146.do
[2013-05-31 14:40:10 -0400] cwj: cmwslw: are you not running chef as root?
[2013-05-31 14:40:38 -0400] defishguy: <cwj>:  Thank you.
[2013-05-31 14:41:04 -0400] cmwslw: Actually I think I am
[2013-05-31 14:41:10 -0400] cmwslw: there must be a deeper problem
[2013-05-31 14:41:12 -0400] cwj: defishguy: no problem, maybe check out the peepcode meet chef screencasts?
[2013-05-31 14:41:29 -0400] cwj: defishguy: https://peepcode.com/products/chef-i https://peepcode.com/products/chef-ii
[2013-05-31 14:42:47 -0400] cwj: cmwslw: generally chef is going to run commands as which ever user it is executing as. some resources support specifying the user and environment for executing under, assuming you are running as root.
[2013-05-31 14:44:18 -0400] cwj: chris613: thats interesting, i think that setting up a cookbook_file for each test file should not be necessary.
[2013-05-31 14:45:13 -0400] cwj: chris613: i havent had to do that, but ive been running my minitest-handler stuff via chef-solo inside test-kitchen
[2013-05-31 14:45:50 -0400] cwj: chris613: is files/default/test/myrecipe_test.rb present in the node's cached copy of the cookbook?
[2013-05-31 14:48:01 -0400] cmwslw: turns out it was a corrupted rabbitMQ file, nothing to do with chef at all. Thanks for all the help all?
[2013-05-31 14:49:36 -0400] cwj: \m/
[2013-05-31 14:50:38 -0400] nicgrayson: using chefspec to test lwrps. when i use step_into should i be able to test if files where created by a template resource in the lwrp?
[2013-05-31 14:54:07 -0400] axyelp: under what cases could any un-encrypted databag fail to be saved via webserver
[2013-05-31 14:55:25 -0400] eponymi: is there any way to specify the location of a cookbook in metadata.rb? i.e. `depends "mycookbook", git: 'git://github.com/me/mycookbooks.git'` or `depends "mycookbook", path: '../../mycookbook'`
[2013-05-31 14:56:34 -0400] nicgrayson: eponymi: that is what berksfile and the berkfile is for
[2013-05-31 14:57:04 -0400] eponymi: right, but i'm looking at this: http://jtimberman.housepub.org/blog/2013/03/19/anatomy-of-a-test-kitchen-1-dot-0-cookbook-part-1/
[2013-05-31 14:57:06 -0400] nicgrayson: add the depends in your metadata and add the cookbook with special location to the berksfile
[2013-05-31 14:57:12 -0400] eponymi: and its associated part 2
[2013-05-31 14:57:19 -0400] axyelp: ummm,.. editing databags doesn't work via chef's web interface! although chef-server-webui doesn't show any logs!
[2013-05-31 14:57:53 -0400] eponymi: so i have my berksfile in `mycookbook/` and my cookbook tests in `mycookbook/tests/cookbooks/mycookbook_test`
[2013-05-31 14:58:07 -0400] nicgrayson: eponymi: ah, test kichen will look in those specific locations when running tests
[2013-05-31 14:58:42 -0400] eponymi: and in `mycookbook/tests/cookbooks/mycookbook_test/metadata.rb` i have `depends "mycookbook"` which isn't available on the community site.
[2013-05-31 14:58:54 -0400] eponymi: oh, so it won't fail if i'm requiring a cookbook that isn't on site?
[2013-05-31 14:59:01 -0400] nicgrayson: no it's fine
[2013-05-31 14:59:20 -0400] nicgrayson: test kitchen knows you are trying to include the "parent" cookbook
[2013-05-31 14:59:48 -0400] eponymi: cool, thanks!
[2013-05-31 14:59:52 -0400] surge_: Are there any recommended specs for Open Source Chef Server? But I'm not sure how much I should allocate in terms of storage and RAM on AWS. I was going to just try a m1.small for now, but I would like it to handle 150~300 instances (nothing heavy duty since we use other tools to handle a lot of our infrastructure deployment)
[2013-05-31 15:00:14 -0400] nicgrayson: surge_: chef 11 or chef 10?
[2013-05-31 15:00:19 -0400] surge_: 11
[2013-05-31 15:00:43 -0400] nicgrayson: from what i hear a small should be more then fine for that few nodes
[2013-05-31 15:01:42 -0400] surge_: Yeah, okay. Just started installing the .deb file, so I wanted to be sure before I wasted too much time on this machine. Thanks!
[2013-05-31 15:01:58 -0400] eponymi: ok, another question. these resources (http://technology.customink.com/blog/2012/07/06/mvt-knife-test-and-travisci/ and http://technology.customink.com/blog/2012/08/03/testing-chef-cookbooks/) have knife, foodcritic, and spec tests taking place in the `mycookbook` dir instead of `mycookbook/test/cookbooks/mycookbook_test`. I'm assuming those should be moved?
[2013-05-31 15:02:34 -0400] nicgrayson: surge_: http://fnichol.github.io/knife-server/ is pretty cool
[2013-05-31 15:03:35 -0400] nicgrayson: eponymi: they are supposed to live in your cookbook
[2013-05-31 15:03:58 -0400] eponymi: so those live in the cookbook, but functional tests live in the test cookbook?
[2013-05-31 15:04:29 -0400] nicgrayson: yes, the tests just use that 'helper' cookbook to run stuff not in your cookbook
[2013-05-31 15:05:07 -0400] nicgrayson: eponymi: depending on what you are doing you may not need the 'helper' cookbook at all
[2013-05-31 15:05:46 -0400] eponymi: i definitely want to use test kitchen + minitest for functional testing.
[2013-05-31 15:06:28 -0400] eponymi: that can be done without the test subdir? just by placing my tests in `files/default/test/minitest` or whatever that path is?
[2013-05-31 15:06:35 -0400] nicgrayson: eponymi: i've started using bats with test kitchen
[2013-05-31 15:07:43 -0400] nicgrayson: eponymi: i think this is a pretty good example https://github.com/opscode-cookbooks/yum/tree/spec_bats
[2013-05-31 15:09:22 -0400] awgross: hey, is it possible to regenerate my Private Key for talking to the Chef Server (in Hosted Chef)?
[2013-05-31 15:09:25 -0400] eponymi: ok, that's very different from most of the resources i've read.
[2013-05-31 15:09:26 -0400] awgross: I have the original key
[2013-05-31 15:09:33 -0400] awgross: but it doesnt seem to work
[2013-05-31 15:10:03 -0400] eponymi: and i'm a noob. any resource you can recommend on what's going on there? dir structure, branching, actually running the tests
[2013-05-31 15:10:06 -0400] odyssey4me: Is there a way of showing a particular attribute at each of the levels for a node - default, normal, override, force_override? ideally with the source.
[2013-05-31 15:10:14 -0400] awgross: nm found it
[2013-05-31 15:12:17 -0400] nicgrayson: eponymi: it's all in flux right now. there is a good food fight show on testing in practice you might want to check out
[2013-05-31 15:12:49 -0400] eponymi: the approach in that cookbook certainly seems to make berkshelf/chefspec cleaner. but tbh i don't even know how to use guard or bats, so it might be a little too much of a learning curve.
[2013-05-31 15:13:23 -0400] eponymi: is foodfight free?
[2013-05-31 15:15:48 -0400] eponymi: and looking in the spec dir of that branch, it looks like unit tests will be separated into unit/recipes, unit/resources, etc. which i like.
[2013-05-31 15:16:03 -0400] eponymi: maybe i should just hold off on testing my cookbooks for a couple months, until the dust settles a little bit
[2013-05-31 15:17:50 -0400] chris613: cwj: Sorry, had a meeting, thanks for responding. files/default/test/myrecipe_test.rb is NOT present in the node's cache unless it is referenced by a cookbook_file resource. This appears to be the root of my problem. This would suggest that users of chef-solo would never see this problem
[2013-05-31 15:23:21 -0400] spox: chris613: sounds like it might be how the minitest bits are accessing the files, and since they are lazy fetched, they never show up
[2013-05-31 15:23:35 -0400] spox: chris613: you could add a recipe to your runlist to force the files there
[2013-05-31 15:23:45 -0400] spox: let me make a quick gist
[2013-05-31 15:24:16 -0400] spox: chris613: just make a simple recipe with this in it: https://gist.github.com/chrisroberts/18d2e03e19551e883c75
[2013-05-31 15:24:26 -0400] spox: just note that it will force sync all files and templates
[2013-05-31 15:26:43 -0400] chris613: spox: That's essentially the workaround I have found - write a recipe that guarantees that the files are required and therefor downloaded. I'm just confused by this though because it's not mentioned anywhere and enough people are using this that I can't be the first one to have this trouble'
[2013-05-31 15:27:22 -0400] spox: chris613: i've seen the issue previously but i haven't had the time to dig into it
[2013-05-31 15:27:43 -0400] chris613: spox: Cool, well thanks for your help
[2013-05-31 15:27:52 -0400] spox: i'm betting that doing a sync like this may be what's needed, though it could trim down what's synced based on the run list
[2013-05-31 15:27:59 -0400] spox: since it wouldn't need everything
[2013-05-31 15:28:07 -0400] spox: but, that's what i had to copy/paste :)
[2013-05-31 15:33:11 -0400] postwait: fwiw, we converted your chef SVR4 sol10 omnibus packages into IPS packages.
[2013-05-31 15:33:31 -0400] jtimberman: postwait: zomg
[2013-05-31 15:33:53 -0400] jtimberman: postwait: that mean you've fixed this for us? http://tickets.opscode.com/browse/CHEF-4231 :)
[2013-05-31 15:33:56 -0400] postwait: b/c they aren't interactive installs, it doesn't write a client.rb file out.
[2013-05-31 15:34:09 -0400] postwait: build is a strong word ;-)
[2013-05-31 15:34:19 -0400] postwait: "make"
[2013-05-31 15:34:21 -0400] jtimberman: postwait: our omnibus installs don't write a client.rb
[2013-05-31 15:34:38 -0400] postwait: postinstall in that sure looks like it does.
[2013-05-31 15:34:47 -0400] jtimberman: wat
[2013-05-31 15:34:58 -0400] postwait: you have a postinstall script in your package that does *stuff*
[2013-05-31 15:35:06 -0400] jtimberman: it makes links in /usr/bin
[2013-05-31 15:35:10 -0400] postwait: AND....
[2013-05-31 15:35:21 -0400] jtimberman: prints a message thanking you
[2013-05-31 15:35:32 -0400] postwait: and.. check chef_10.24.0-1.solaris2.5.10_i386.solaris
[2013-05-31 15:36:12 -0400] postwait: https://gist.github.com/postwait/5685823
[2013-05-31 15:36:31 -0400] odyssey4me: Is there a way of showing a particular attribute at each of the levels for a node - default, normal, override, force_override? ideally with the source.
[2013-05-31 15:36:47 -0400] odyssey4me: Never mind, figured that one out.
[2013-05-31 15:36:48 -0400] postwait: Also those links are arbitrated well for a package -- they just just be in the pkgmap
[2013-05-31 15:36:54 -0400] jtimberman: postwait: ahhhh yes. it does that *if* you pass in those options.
[2013-05-31 15:37:06 -0400] odyssey4me: Now the real question - how do I implement a force override on a node?
[2013-05-31 15:37:07 -0400] postwait: can't do that in IPS...
[2013-05-31 15:37:25 -0400] postwait: anyway they are currently in our private circonus IPS repo.
[2013-05-31 15:37:28 -0400] jtimberman: postwait: it's fine, imo
[2013-05-31 15:37:36 -0400] jtimberman: do you have 10.24 or 11.4 too?
[2013-05-31 15:37:39 -0400] postwait: but I'll be moving them into some omniti repo too.
[2013-05-31 15:37:42 -0400] jtimberman: er, 10.24 only
[2013-05-31 15:37:45 -0400] postwait: Didn't do 11.4 yet, we don't use it.
[2013-05-31 15:37:47 -0400] jtimberman: 11.4 would be super
[2013-05-31 15:37:49 -0400] postwait: We can do all of them though
[2013-05-31 15:37:52 -0400] jtimberman: <3
[2013-05-31 15:38:03 -0400] jtimberman: I'll have a hug for you at Velocity.
[2013-05-31 15:38:05 -0400] postwait: The issue is: what repo to put them in.
[2013-05-31 15:38:16 -0400] postwait: I feel like we should create a new repo:
[2013-05-31 15:38:21 -0400] postwait: pkg.omniti.com/opscode/
[2013-05-31 15:38:24 -0400] postwait: And just put themthere.
[2013-05-31 15:38:40 -0400] paulmooring: odyssey4me: I'm not sure I understand your question a node only has 1 attribute, you can set it different places with different precedence
[2013-05-31 15:38:54 -0400] paulmooring: but by run time there is only the attribute on the node
[2013-05-31 15:40:08 -0400] paulmooring: if you `knife node edit $MY_NODE` and add an override attribute that will override pretty much anywhere else it's set
[2013-05-31 15:40:22 -0400] jtimberman: postwait: i'll see about making an omnios.opscode.com or similar.
[2013-05-31 15:40:27 -0400] jtimberman: we have apt :)
[2013-05-31 15:40:46 -0400] odyssey4me: paulmooring - in my environment I'm overriding the default attributes for various things. Now what I need to do is for a specific node I need to override one of the attributes. According to http://docs.opscode.com/essentials_node_object.html there is a force_override, but I can't seem to make it stick when using knife to edit the node.
[2013-05-31 15:40:49 -0400] postwait: Can you get an OmniOS box and host the IPS repo?
[2013-05-31 15:40:56 -0400] postwait: That would be super swell
[2013-05-31 15:41:05 -0400] postwait: (then you could sign the packages)!
[2013-05-31 15:41:28 -0400] paulmooring: odyssey4me: oh, I think that means setting it in the recipe
[2013-05-31 15:42:22 -0400] odyssey4me: paulmooring - the page shows either recipe or node... I want to do it on the node using "chef-client -j override.json" as that's the most accessible.
[2013-05-31 15:42:50 -0400] paulmooring: hmm, I think that only applies to recipes and attribute files
[2013-05-31 15:42:55 -0400] paulmooring: jtimberman: ^?
[2013-05-31 15:42:57 -0400] jtimberman: postwait: yeah i'll look into it
[2013-05-31 15:43:05 -0400] odyssey4me: paulmooring - I did this with previous versions of chef server, but the new one doesn't seem to be doing the trick
[2013-05-31 15:43:08 -0400] bearrito: why does deploy_revision resource insist on trying to symlink database.yaml even though I have the following set : symlink_before_migrate nil
[2013-05-31 15:45:51 -0400] geekbri: Is anybody here using the mysql_database_user resource from the database cookbook?
[2013-05-31 15:46:13 -0400] geekbri: I'm trying to deteremine how I should go about granting privs on multiple different databases without having chef spit out 1000000 resource cloning warnings
[2013-05-31 15:46:17 -0400] jtimberman: odyssey4me: doing it on the node directly makes for unique snowflakes, likely
[2013-05-31 15:46:26 -0400] geekbri: Since it uses the username as the name attribute, isn't this basically unavoidable?
[2013-05-31 15:46:43 -0400] geekbri: Or should I did into the resource connection and change it that way then call it again with different priv attributes each time?
[2013-05-31 15:47:21 -0400] odyssey4me: jtimberman: bad practise, I know, but it's necessary for now as I don't have the time for the major refactoring & testing that'll be needed to do it an alternative way
[2013-05-31 15:48:06 -0400] odyssey4me: jtimberman/paulmooring: unless you have a suggestion for an alternative way to override the environment overrides?
[2013-05-31 15:49:32 -0400] nicgrayson: eponymi: had a customer call. i've had the same thought but i think testing is in a pretty good place. tdding cbs is fast and awesome
[2013-05-31 15:50:18 -0400] eponymi: nicgrayson: watching the food fight now. biggest thing for me is having a testing model to work off of; i need to stop learning new things and start making some stuff :) this food fight should help
[2013-05-31 15:50:33 -0400] paulmooring: odyssey4me: an override in the environment?
[2013-05-31 15:50:52 -0400] jtimberman: odyssey4me: you have to use force_override, it appears. http://docs.opscode.com/chef_overview_attributes.html
[2013-05-31 15:51:32 -0400] postwait: So I've got some custom attributes in a role[foo]
[2013-05-31 15:51:44 -0400] postwait: and a role[bar] that has a role[foo] in it.
[2013-05-31 15:51:51 -0400] postwait: And a node that has role[bar] in its runlist.
[2013-05-31 15:51:55 -0400] odyssey4me: jtimberman: yeah, I've been trying to do that - initially through simply editing the node through knife... but it never seems to want to save the force_override... almost like it doesn't recognise it as part of the DSL
[2013-05-31 15:52:10 -0400] postwait: I have an API client and I want to see the attributes for that node.
[2013-05-31 15:52:16 -0400] postwait: how do I get the chef server to do that for me?
[2013-05-31 15:52:27 -0400] jtimberman: postwait: has the node run chef?
[2013-05-31 15:52:37 -0400] postwait: not yet.
[2013-05-31 15:52:58 -0400] jtimberman: i believe it has to run chef first, so that the client will unfold all the roles' attributes and do the merging
[2013-05-31 15:53:05 -0400] postwait: okay.
[2013-05-31 15:57:40 -0400] odyssey4me: postwait - perhaps you're looking for something like this: knife node show node.name -a normal.attribute1.subattribute1
[2013-05-31 15:58:07 -0400] postwait: I don't have knife installed this is an API client on an unrelated machine
[2013-05-31 15:58:20 -0400] postwait: It's not even in ruby it's just using the documented APIs.
[2013-05-31 16:01:21 -0400] mconigliaro: is anyone here using minitest-chef-handler with test-kitchen?
[2013-05-31 16:02:16 -0400] nicgrayson: if i'm using guard-kitchen and guard-spec can i make it stop if the spec fails first?
[2013-05-31 16:04:28 -0400] pwf: i'm getting this error when trying to 'knife show' an encrypted data bag on a chef 11 server http://tickets.opscode.com/browse/CHEF-2255
[2013-05-31 16:04:42 -0400] pwf: does anyone know if chef 11 added extra keys like in this bug, and how to turn it off?
[2013-05-31 16:05:03 -0400] pwf: we can access individual keys in the databag just fine
[2013-05-31 16:05:17 -0400] pwf: maybe it's related to the way we did 'knife upload'?
[2013-05-31 16:05:41 -0400] pwf: 'knife show data bag' runs to_hash, which is the broken bit
[2013-05-31 16:06:30 -0400] odyssey4me: jtimberman: considering that I can't seem to get force_override to work from a json input file, I'm thinking of two alternative strategies - one is to use a separate environment file, but that sounds very messy... another is to use tagging for these specific nodes and to force_override from inside a recipe.
[2013-05-31 16:06:36 -0400] odyssey4me: thoughts?
[2013-05-31 16:08:59 -0400] Cope: mconigliaro: did you actually have a question? or are you just conducting a survey? ;) /troll
[2013-05-31 16:09:09 -0400] mconigliaro: haha
[2013-05-31 16:09:20 -0400] mconigliaro: I'm just wondering if it's working for anyone
[2013-05-31 16:09:28 -0400] Cope: mconigliaro: yep absolutely
[2013-05-31 16:09:38 -0400] mconigliaro: so your tests are part of your chef run?
[2013-05-31 16:09:41 -0400] Cope: just add it to your run list
[2013-05-31 16:09:45 -0400] Cope: right
[2013-05-31 16:09:51 -0400] mconigliaro: yeah, that's the problem..
[2013-05-31 16:10:02 -0400] mconigliaro: because kitchen verify doesn't work
[2013-05-31 16:10:20 -0400] mconigliaro: you need to do a whole chef run to run your tests which kind of stinks
[2013-05-31 16:10:52 -0400] mconigliaro: i've been playing with the bussers, but the minitest one seems to be just plain minitest
[2013-05-31 16:10:53 -0400] Cope: mconigliaro: hmm - what do you *want* to happen, ideally?
[2013-05-31 16:10:59 -0400] Cope: yes, exactly
[2013-05-31 16:11:02 -0400] mconigliaro: not minitest-chef-handler
[2013-05-31 16:11:21 -0400] Cope: so this is the whole debate around true post-chef-run testing
[2013-05-31 16:11:30 -0400] mconigliaro: ah, didn't know this debate was going on
[2013-05-31 16:11:36 -0400] BryanWB_: pls try serverspec w/ busser-serverspec and work out the bugs for the rest of us :)
[2013-05-31 16:11:40 -0400] BryanWB_: mconigliaro: ^^
[2013-05-31 16:11:40 -0400] Cope: an alternative is to use bats / serverspec
[2013-05-31 16:11:46 -0400] Cope: ^^ that
[2013-05-31 16:12:04 -0400] mconigliaro: ok, so here's my problem with the bussers...
[2013-05-31 16:12:31 -0400] mconigliaro: i don't know how to access node attributes from within the tests
[2013-05-31 16:12:35 -0400] mconigliaro: is it even possible?
[2013-05-31 16:12:43 -0400] BryanWB_: mconigliaro: nope
[2013-05-31 16:12:51 -0400] mconigliaro: yeah, i hate that...
[2013-05-31 16:13:06 -0400] Cope: mconigliaro: why do you want to do that?
[2013-05-31 16:13:26 -0400] Cope: mconigliaro: ie what are you -actually- wanting to do?
[2013-05-31 16:13:43 -0400] Cope: minitest-handler absolutely does, as it in the context of a chef run
[2013-05-31 16:13:49 -0400] Cope: likewise chef-spec
[2013-05-31 16:13:57 -0400] mconigliaro: right, i get that
[2013-05-31 16:14:00 -0400] Cope: but after the run has ended, you're not in scope of chef at all
[2013-05-31 16:14:04 -0400] mconigliaro: it works great for the most part
[2013-05-31 16:14:51 -0400] mconigliaro: but i found out about kitchen verify, and how you don't have to scan through a bunch of chef output before you see your test output
[2013-05-31 16:15:04 -0400] Cope: right
[2013-05-31 16:15:05 -0400] mconigliaro: its also much faster
[2013-05-31 16:15:30 -0400] Cope: well - kinda
[2013-05-31 16:15:34 -0400] pwf: sooo the data bag returned by chef 11 is something like {"chef_type": "encrypted_data_bag", "data_bag": "secrets", "id": "dbag_name", "somevalue": "encryptedstuffs"}
[2013-05-31 16:15:51 -0400] pwf: but the code i see to decrypt a data bag in .to_hash only omits "id"
[2013-05-31 16:16:06 -0400] pwf: it's trying to decrypt "chef_type" and "data_bag" and failing
[2013-05-31 16:16:21 -0400] pwf: is this a bug in the chef client, or is my server not supposed to be returning these extra types?
[2013-05-31 16:16:22 -0400] mconigliaro: i might just be missing something. I'm going to watch this food fight show in a bit and see what other people are doing: http://foodfightshow.org/2013/05/testing-in-practice.html
[2013-05-31 16:18:10 -0400] mconigliaro: regarding node attributes in tests, it just makes for more robust tests. for a simple example, if i have an attribute that sets a timezone, i want to ensure that the timezone on the machine is set to whatever the node attribute it set to.
[2013-05-31 16:18:36 -0400] pwf: nevermind... i think my issue was that the data bag was uploaded with chef <= 10.16.0
[2013-05-31 16:18:51 -0400] mconigliaro: or maybe i have an attribute that sets a port to listen on. i'll want to use the same port in my tests. etc.
[2013-05-31 16:19:07 -0400] mconigliaro: i want to define these things in one place
[2013-05-31 16:19:07 -0400] Cope: mconigliaro: so there comes a point when you're testing chef
[2013-05-31 16:19:14 -0400] Cope: chef is already tested
[2013-05-31 16:19:18 -0400] mconigliaro: true, i get it
[2013-05-31 16:19:29 -0400] Cope: what you want to test is your logic
[2013-05-31 16:19:30 -0400] mconigliaro: i don't want to ensure that a package is installed or whatever
[2013-05-31 16:19:38 -0400] Cope: and that what you asked chef to do actually does what you want
[2013-05-31 16:19:40 -0400] mconigliaro: i know chef is doing that
[2013-05-31 16:19:48 -0400] Cope: well you kinda do
[2013-05-31 16:20:05 -0400] pwf: actually i lied, according to the breaking changes bit chef 10.18 and above should be able to read old and new data bag formats
[2013-05-31 16:20:14 -0400] pwf: i think this is an issue with 'knife upload'
[2013-05-31 16:20:16 -0400] Cope: chefspec is great for fast feedback, tests driving design, and for catching dumb typos and logic errors with attributes
[2013-05-31 16:20:26 -0400] mconigliaro: but lets say I'm telling chef which port my app is listening on. my integration tests need to know that too.
[2013-05-31 16:21:19 -0400] eponymi: i think you do want to ensure that a package is installed, service is running, etc. (things done by other cookbooks or chef itself) you're not testing the functionality as much as your code
[2013-05-31 16:21:31 -0400] Cope: ok - i need food; btw I've started a channel ##tdi for folk who want to discuss this stuff generally
[2013-05-31 16:21:42 -0400] mconigliaro: eponymi: depends
[2013-05-31 16:21:55 -0400] Cope: very interested in everyone's views on this
[2013-05-31 16:22:46 -0400] mconigliaro: i mean, some things are just going overboard, right? like you tell chef to write a file, then you test later if the file is there? seems redundant
[2013-05-31 16:22:50 -0400] pwf: yeaaah... so it looks like 'knife upload' is adding additional keys to encrypted data bags and breaking things
[2013-05-31 16:22:51 -0400] mconigliaro: but
[2013-05-31 16:22:53 -0400] pwf: where should i report this?
[2013-05-31 16:23:50 -0400] mconigliaro: say i tell chef to configure something a certain way. i only want my integration tests to verify that my configuration is having the desired result.
[2013-05-31 16:24:07 -0400] mconigliaro: i.e. "its listening on port 80", etc.
[2013-05-31 16:25:33 -0400] mconigliaro: but maybe i'm being naive? i dunno
[2013-05-31 16:26:30 -0400] eponymi: mconigliaro i make a lot of typos
[2013-05-31 16:26:51 -0400] BryanWB_: what's the preferred way to shellout in a recipe? i can never remember
[2013-05-31 16:26:53 -0400] eponymi: so i'm basically building in a check that i've correctly *used* the LWRP when i want to make sure a service is started
[2013-05-31 16:27:03 -0400] geekbri: jtimberman: Question about the mysql_database_user resource in the database cookbook.  If you want to grant priv's on multiple databases for the same user, how should I go about doing that?  Since the username is the name attribute for mysql_database_user resource, you can't seem to do this without sending out resource cloning resources
[2013-05-31 16:27:51 -0400] mconigliaro: eponymi: wouldn't a better check be to see if that service is actually performing the task you want? rather than just running?
[2013-05-31 16:28:10 -0400] mconigliaro: to me, the fact that something is running doesn't really tell me anything
[2013-05-31 16:28:15 -0400] eponymi: probably. i should mention i have no clue what i'm doing.
[2013-05-31 16:28:17 -0400] mconigliaro: i want to know it's doing what i want it to do
[2013-05-31 16:28:24 -0400] mconigliaro: haha, fair enough
[2013-05-31 16:28:56 -0400] mconigliaro: anyway, that's my two cents for Cope
[2013-05-31 16:29:08 -0400] mconigliaro: since he asked
[2013-05-31 16:29:59 -0400] eponymi: i guess what you're saying is more accurate for what i'm describing though. so like, simple example, the purpose of my test is to make sure my site is up. i shouldn't be checking if apache is running, i should be checking whether the domain is serving up a page with the content i want
[2013-05-31 16:30:14 -0400] mconigliaro: eponymi: exactly
[2013-05-31 16:30:26 -0400] mconigliaro: you can test at a higher level than just "the package is installed" i think
[2013-05-31 16:30:46 -0400] eponymi: and package installation would be a prereq of serving up the page anyways; so in essence, you are testing it
[2013-05-31 16:31:24 -0400] mconigliaro: yes, thats exactly what I'm saying
[2013-05-31 16:31:45 -0400] eliklein: just sounds like unit vs. integration?
[2013-05-31 16:31:54 -0400] mconigliaro: i think so
[2013-05-31 16:32:04 -0400] mconigliaro: what would a unit test be in chef?
[2013-05-31 16:32:10 -0400] eponymi: unit test
[2013-05-31 16:32:10 -0400] mconigliaro: thats kind of like testing, chef, right?
[2013-05-31 16:32:17 -0400] eliklein: more or less, yup
[2013-05-31 16:32:20 -0400] mconigliaro: thats what seems redundant to me
[2013-05-31 16:32:29 -0400] mconigliaro: i want to trust chef does what i tell it to do
[2013-05-31 16:32:41 -0400] eliklein: well, if you're doing tdd/bdd, it's just validating that you've implemented what you meant to implement
[2013-05-31 16:32:43 -0400] mconigliaro: my integration tests are more to test that i configured things correctly
[2013-05-31 16:32:55 -0400] mconigliaro: i see
[2013-05-31 16:32:59 -0400] pwf: should i report this possible 'knife upload' bug under 'chef' or 'knife plugins'
[2013-05-31 16:33:07 -0400] eliklein: and gives you a faster feedback loop than the average test kitchen run
[2013-05-31 16:33:19 -0400] eliklein: (we're doing both, for what it's worth)
[2013-05-31 16:33:53 -0400] eliklein: leaning more towards serverspec/test kitchen at the moment
[2013-05-31 16:34:42 -0400] eliklein: (for integration)
[2013-05-31 16:35:45 -0400] mconigliaro: pwf: probably not knife plugins
[2013-05-31 16:36:19 -0400] chris613: spox: I ended up using your code, but only because no_lazy_load is currently broken due to a regression. See https://github.com/opscode/chef/pull/607
[2013-05-31 16:36:23 -0400] mconigliaro: so regarding fast testing...
[2013-05-31 16:36:32 -0400] mconigliaro: kitchen verify is actually really fast
[2013-05-31 16:36:36 -0400] eliklein: indeed
[2013-05-31 16:36:48 -0400] mconigliaro: since it doesn't require a chef converge
[2013-05-31 16:36:51 -0400] mconigliaro: i like that
[2013-05-31 16:36:59 -0400] eliklein: which is why we started leaning towards serverspec/test kitchen lately
[2013-05-31 16:37:08 -0400] eliklein: initially, we were using chefspec to get the speed
[2013-05-31 16:37:41 -0400] eliklein: but similar to you, found that we wanted actual behavior driven integration tests
[2013-05-31 16:37:49 -0400] eponymi: so is kitchen verify a replacement for chefspec
[2013-05-31 16:37:51 -0400] eponymi: ?
[2013-05-31 16:38:09 -0400] mconigliaro: i think i need to look at serverspec/chefspec...
[2013-05-31 16:38:19 -0400] eponymi: can someone help an idiot and point me to a link that describes what bats is?
[2013-05-31 16:38:21 -0400] eliklein: chefspec doesn't load up a box
[2013-05-31 16:38:27 -0400] eliklein: it mocks it all out
[2013-05-31 16:38:46 -0400] eponymi: kitchen verify does load a box?
[2013-05-31 16:38:47 -0400] eliklein: test kitchen actually loads a vm and allows you to converge and/or re-run your specs
[2013-05-31 16:38:48 -0400] mconigliaro: eponymi: https://github.com/opscode/test-kitchen/wiki/Getting-Started
[2013-05-31 16:39:03 -0400] mconigliaro: yeah, i think verify only does one chef run
[2013-05-31 16:39:16 -0400] mconigliaro: then it just runs the tests from there on out
[2013-05-31 16:39:30 -0400] mconigliaro: which is why its so fast
[2013-05-31 16:39:32 -0400] mconigliaro: actually.
[2013-05-31 16:39:49 -0400] eponymi: i thought it didn't require a chef converge?
[2013-05-31 16:39:54 -0400] mconigliaro: oh, maybe I'm wrong
[2013-05-31 16:40:20 -0400] mconigliaro: so another problem i have is all the chef run output mixed in with the test output
[2013-05-31 16:40:30 -0400] mconigliaro: especially when you run it with --parallel
[2013-05-31 16:40:32 -0400] jchauncey: I don't think verify does a converge
[2013-05-31 16:40:33 -0400] mconigliaro: its hard to read
[2013-05-31 16:41:00 -0400] jchauncey: kitchen verify just syncs the tests from the suite over and runs them
[2013-05-31 16:41:18 -0400] eponymi: so my thought process was 1)unit testing: chefspec (fast, no converge) 2) integration testing: test kitchen (slow, but necessary for actual results) 3) system testing: something
[2013-05-31 16:41:43 -0400] eponymi: jchauncey: that's what i was hoping. i'd like to have one tool for unit/integration/system
[2013-05-31 16:42:07 -0400] jchauncey: eponymi: We are also using chefspec for unit testing and kitchen for integration
[2013-05-31 16:42:49 -0400] eponymi: so you don't use `kitchen verify` like you would chefspec?
[2013-05-31 16:43:47 -0400] eliklein: eponymi: chefspec doesn't use test kitchen
[2013-05-31 16:44:05 -0400] jchauncey: eponymi: I am not sure what you mean by that.
[2013-05-31 16:48:05 -0400] eponymi: like, can i replace chefspec with kitchen verify
[2013-05-31 16:51:35 -0400] eponymi: what would be really cool is if there was a "chef" breakdown of http://www.computer.org/portal/web/swebok/html/ch5
[2013-05-31 16:53:08 -0400] eponymi: ok, so stephen nelson-smith on unit testing in that food fight @ 9:38 "we need to verify that we're passing the right information to chef". i think that's a succinct explanation of the value of unit tests.
[2013-05-31 16:57:33 -0400] jchauncey: :eponymi chefspec is run by executing rspec.  kitchen test does kitchen testing.  More specifically kitchen runs in multiple stages.  It creates the instance, then converges, then sets up the testing framework, then does the verify and finally destroys the instance (provided the tests passed).  And each of these stages can be run seperately.  This is nice because if the create and converge works and you just want to add or fix tests you can just do the
[2013-05-31 16:57:34 -0400] jchauncey: verify.
[2013-05-31 16:58:21 -0400] eponymi: ok, that last sentence was it for me. to run verify, you need to have a box. that seems to be the benefit of chefspec, is that you don't need a box, or a converge, or what have you.
[2013-05-31 16:58:36 -0400] bean__: but sometimes you want a box, no?
[2013-05-31 16:58:43 -0400] bean__: what if you're developing on osx.
[2013-05-31 16:58:53 -0400] bean__: but all of your chef stuff is on ubuntu servers
[2013-05-31 16:59:15 -0400] eponymi: you certainly want a box. i'm saying you want chefspec and you want integration tests.
[2013-05-31 16:59:25 -0400] eliklein: bean__: that's where virtualbox/test kitchen come in
[2013-05-31 16:59:27 -0400] bean__: i think thats valid.
[2013-05-31 16:59:29 -0400] bean__: yep
[2013-05-31 16:59:30 -0400] eliklein: chefspec will still work, even on your mac
[2013-05-31 16:59:33 -0400] eliklein: that's what we're doing
[2013-05-31 16:59:39 -0400] bean__: ah okay, i must have misread
[2013-05-31 16:59:42 -0400] eponymi: my question was whether the verification tool replaced chefspec in the sense of unit testing. and it would appear that it doesn't.
[2013-05-31 17:01:18 -0400] jchauncey: chefspec is great for testing the varying portions of your cookbooks.  For example, if you want to test that the if statement based on attribute is working correctly.  kitchen integration tests are great for making sure that your cookbooks is actually doing what you think on an actual running VM
[2013-05-31 17:01:34 -0400] ateetor: Hello; I'm having some trouble with knife-windows.  on my workstation when I run "knife bootstrap windows winrm IP_HERE -x USER_HERE" it says it cannot connect to windows:22 as if windows was the ip.   I have ran "gem install knife-windows" succesfully on my workstation.  Does anyone have an idea what might be wrong?
[2013-05-31 17:02:18 -0400] eponymi: right, which is what i thought before someone mentioned kitchen verify, and then my brain started hurting
[2013-05-31 17:02:44 -0400] ateetor: I've also tried  "knife bootstrap windows ssh IP_HERE -x USER_HERE -p 2222" with a ssh server running on that port too and that got the same result
[2013-05-31 17:02:54 -0400] wdpro_kevin: jtimberman: Can you have a look at an error I'm getting running test-kitchen job in Jenkins?  https://gist.github.com/crackmac/5686367
[2013-05-31 17:03:03 -0400] eliklein: eponymi: haha yeah, getting started with the testing frameworks will induce serious brain pain
[2013-05-31 17:05:12 -0400] eponymi: yeah, now i have to figure out bats vs. minitest. i wish this food fight was just a thirty second video of Jor-El saying "you will use knife cookbook test. you will use foodcritic. you will use chefspec. you will use test-kitchen with [some testing tool]. follow these links to learn how to use each."
[2013-05-31 17:06:06 -0400] eliklein: i would consider serverspec as well
[2013-05-31 17:06:35 -0400] eponymi: well i have to learn what that is first :)
[2013-05-31 17:06:43 -0400] eliklein: bats = bash based testing
[2013-05-31 17:06:59 -0400] eliklein: minitest = rspec-similar, but some strange matchers
[2013-05-31 17:07:18 -0400] eliklein: serverspec = much closer to rspec from my experience so far
[2013-05-31 17:07:41 -0400] eponymi: ok, so server spec is system testing in SWEBOK parlance
[2013-05-31 17:08:41 -0400] eliklein: i suppose so, yes
[2013-05-31 17:08:58 -0400] eliklein: we ran into some really strange syntax in minitest
[2013-05-31 17:09:11 -0400] eliklein: things worked as they should in rspec in serverspec
[2013-05-31 17:09:16 -0400] eliklein: so we're moving forward with serverspec
[2013-05-31 17:09:35 -0400] eliklein: sorry, it was the chef-minitest-handler matchers
[2013-05-31 17:09:58 -0400] eponymi: well i would think that serverspec and minitest/bats are in different domains entirely
[2013-05-31 17:11:47 -0400] eliklein: not really, they all accomplish the same thing.. it's just a decision you need to make about which framework you prefer to write your tests in
[2013-05-31 17:12:22 -0400] ateetor: does anyone here have experiance with knife plugins?  I'm trying to use knife-windows and cannot even get the bootstrap command working
[2013-05-31 17:13:12 -0400] eponymi: perhaps not in their actual capabilities, but the usages i've seen of minitest/bats versus what i understand serverspec to do in use
[2013-05-31 17:14:20 -0400] eponymi: my understanding of minitest/bats is within test-kitchen, which i've seen primarily used in what i'd call integration testing for development of cookbooks.
[2013-05-31 17:14:48 -0400] eponymi: whereas serverspec would be system testing, where you're not necessarily focused on an individual cookbook so much as an extant node
[2013-05-31 17:16:28 -0400] eliklein: oh, we're using serverspec within test-kitchen
[2013-05-31 17:16:40 -0400] eliklein: that said, you can absolutely use serverspec to test systems
[2013-05-31 17:16:42 -0400] TrinitronX: question regarding chefspec: Anyone seen this error "https://gist.github.com/5686441"
[2013-05-31 17:16:43 -0400] wdpro_kevin: Anyone want to take a crack at a Jenkins/test-kitchen problem? https://gist.github.com/crackmac/5686367
[2013-05-31 17:17:31 -0400] wdpro_kevin: I've done the setup through jtimberman's kitchen-jenkins cookbook
[2013-05-31 17:17:40 -0400] eliklein: eponymi: here's an example of how we're using serverspec: https://github.com/RallySoftware-cookbooks/chrome
[2013-05-31 17:17:55 -0400] eliklein: super basic cookbook, just getting out feet wet with testing
[2013-05-31 17:18:01 -0400] eliklein: our
[2013-05-31 17:18:18 -0400] eliklein: look at test/integration
[2013-05-31 17:18:37 -0400] eliklein: spec_helper.rb has the info needed to run serverspec without ssh (standalone)
[2013-05-31 17:19:54 -0400] ibash: hello
[2013-05-31 17:20:45 -0400] eponymi: agh ok, that was the main disconnect for me; the requirement of sshing into the machine
[2013-05-31 17:21:06 -0400] eliklein: gotcha
[2013-05-31 17:21:11 -0400] eliklein: yeah, it's called "exec" mode
[2013-05-31 17:21:33 -0400] ibash: I have a question about using chef-solo, I have a vagrant file that uses to provision a vm with chef-solo and it works fine. I used that to generate a dna.json and tried to use that dna.json on a server. On the server attributes are not merged in with their defaults, while in vagrant they are, is there a way to make chef-solo merge attributes into their defaults?
[2013-05-31 17:21:41 -0400] eponymi: in the foodfight @~27:40  stephen nelson-smith describes what i was trying to say much more eloquently.
[2013-05-31 17:22:00 -0400] cjs226: after upgrading chef-client from 10.16.2 to 11.4.4, it thinks it's runnin as solo which causes failures such as when attempting to use data bags.  any ideas?
[2013-05-31 17:24:35 -0400] timsmith: Is there a way to use node.attribute? with a nested attribute.  All the examples I can find are for things like ipaddress that exist at the top level
[2013-05-31 17:27:31 -0400] coredump: timsmith: you mean node[:attribute][:attribute] ?
[2013-05-31 17:27:37 -0400] timsmith: yep
[2013-05-31 17:27:54 -0400] wdpro_kevin: timsmith: looks like that provider was just updated a few days ago
[2013-05-31 17:27:56 -0400] wdpro_kevin: https://github.com/opscode-cookbooks/apt/tree/master/providers
[2013-05-31 17:28:52 -0400] timsmith: wdpro_kevin: that's the fix I posted here yesterday to avoid failures, but it requires chef 11
[2013-05-31 17:31:55 -0400] awgross: timsmith: I just wrote a quick set of helper functions to search for nested keys
[2013-05-31 17:32:16 -0400] awgross: timsmith: such a common use case
[2013-05-31 17:34:06 -0400] timsmith: I realized I can just access the node attribute directly
[2013-05-31 17:34:18 -0400] timsmith: since attribute1 is set earlier
[2013-05-31 17:34:21 -0400] timsmith: so no chance of error
[2013-05-31 17:34:29 -0400] timsmith: but it would be a nice built in function in chef
[2013-05-31 17:34:32 -0400] timsmith: hint hint
[2013-05-31 17:34:34 -0400] awgross: haha
[2013-05-31 17:34:41 -0400] awgross: my solution works, but its recursive
[2013-05-31 17:34:53 -0400] awgross: so the runtime is heavily dependent on the number of keys and depth
[2013-05-31 17:35:08 -0400] awgross: could be refactored if you could give hints by providing the key path
[2013-05-31 17:35:16 -0400] awgross: atm it just does a depth first searth
[2013-05-31 17:35:19 -0400] awgross: search*
[2013-05-31 17:35:51 -0400] timsmith: I'm hope that people don't have insane numbers of attributes, but you never know
[2013-05-31 17:36:03 -0400] barefoot: anyone know why I would get this with `knife file decrypt databag.json`? NoMethodError: undefined method `decrypt_value' for Chef::EncryptedDataBagItem:Class
[2013-05-31 17:36:19 -0400] barefoot: --secre-file is in there also
[2013-05-31 17:36:34 -0400] barefoot: secret*
[2013-05-31 17:40:45 -0400] jtimberman: wdpro_kevin: looks like the gems were installed in a system ruby.
[2013-05-31 17:40:55 -0400] jtimberman: (which is what i'm doing rather than installing in chef's ruby)
[2013-05-31 17:44:11 -0400] wdpro_kevin: jtimberman: That is what I'm learning... is there a way to manipulate the GEM PATH or something?
[2013-05-31 17:45:02 -0400] wdpro_kevin: weird that the GEM PATH printed out from GEM ENV is diff from the actual GEM PATH being used
[2013-05-31 17:53:25 -0400] HAPPYFUNBALL_: is this man in here? http://farm4.static.flickr.com/3424/3393701468_077167770e.jpg
[2013-05-31 17:53:55 -0400] cwj: i think that is coderanger
[2013-05-31 17:54:08 -0400] timsmith: yepo
[2013-05-31 17:54:09 -0400] coderanger: That is indeed me
[2013-05-31 17:54:20 -0400] coderanger: from the Beards of Python photo series
[2013-05-31 17:54:39 -0400] HAPPYFUNBALL_: I salute your facial hair, good sir
[2013-05-31 17:54:53 -0400] HAPPYFUNBALL_: also, reusable cookbooks
[2013-05-31 17:55:03 -0400] bean__: lol
[2013-05-31 17:55:17 -0400] bean__: a beard is essential, i've found.
[2013-05-31 17:55:20 -0400] justizin: anyone use community aide cookbook?
[2013-05-31 17:55:55 -0400] nd__: Maybe someone of you guys can help me out how to solve a certain problem: I want to use the opscode-cookbooks/php cookbook as it's great and flexible, but I want to switch repos so I can get a PHP 5.4 on ubuntu precise. For testing I forked the cookbook and modified it to add another repo. Know I wonder if it would be a way to integrate that into the normal cookbook via pull request or if something like that should correctly be solved in stan
[2013-05-31 18:00:03 -0400] monokrome: application_python doesn't tell celery daemons to start on server boot
[2013-05-31 18:00:09 -0400] monokrome: autostart=false is in the supervisor settings
[2013-05-31 18:00:12 -0400] monokrome: Is this intentional?
[2013-05-31 18:01:49 -0400] annirun: If anyone could look at my problem i'm having with knife-windows it would be much appreciated
[2013-05-31 18:01:51 -0400] annirun: http://stackoverflow.com/questions/16863158/knife-windows-network-error-getaddrinfo-name-or-service-not-known-windows22
[2013-05-31 18:02:03 -0400] HAPPYFUNBALL_: actually, are there any good examples of instances in which cookbooks have been made reusable (with tutrotials for doing so)? specifically, I am not clear on how to add custom information / configurations to generic recipes.
[2013-05-31 18:02:18 -0400] coderanger: monokrome: Yes
[2013-05-31 18:02:37 -0400] monokrome: coderanger: How am I supposed to make it autostart these services then? :/
[2013-05-31 18:02:53 -0400] surge_: How would I go about adding an existing node in ec2 to chef-server (hosted or open source)?
[2013-05-31 18:03:07 -0400] coderanger: monokrome: They will start on the first chef run, the issue is if you set autostart, it starts them when you load the service def
[2013-05-31 18:03:24 -0400] monokrome: Isn't that the point?
[2013-05-31 18:03:35 -0400] coderanger: HAPPYFUNBALL_: Check out the haproxy and stud cookbooks in my psf-chef repo
[2013-05-31 18:03:41 -0400] HAPPYFUNBALL_: ok
[2013-05-31 18:03:46 -0400] coderanger: monokrome: No, enable and start are supposed to be separate
[2013-05-31 18:04:40 -0400] monokrome: So, what is the appropriate way to set autostart?
[2013-05-31 18:04:53 -0400] monokrome: Also, doesn't using `notifies` solve the "issue"?
[2013-05-31 18:05:30 -0400] coderanger: monokrome: You do not set autostart
[2013-05-31 18:05:48 -0400] coderanger: monokrome: autostart is currently incompatible with the structural requirements of a CM system
[2013-05-31 18:05:52 -0400] annirun: sure_: there is a chef plugin for that but i've been having no luck for getting the chef plugins to work
[2013-05-31 18:06:04 -0400] monokrome: Are you saying that I should run chef-client on machine start instead and it'll start the service?
[2013-05-31 18:06:14 -0400] annirun: surge_: sure surge same thing
[2013-05-31 18:06:33 -0400] coderanger: monokrome: Thats the best workaround right now, yet
[2013-05-31 18:06:35 -0400] coderanger: er, yes
[2013-05-31 18:06:50 -0400] coderanger: surge_: knife bootstrap
[2013-05-31 18:07:34 -0400] monokrome: You keep saying that the solution is not to start my service when the machine starts up, but my problem is that the service doesn't start when the machine starts
[2013-05-31 18:07:43 -0400] monokrome: Seems like running "chef-client" is a pretty silly solution
[2013-05-31 18:07:53 -0400] epocsquadron: I'm having an issue where when a vm with mysql on it gets restarted, on restart chef_solo is unable to access the mysql server, reporting that root@localhost is denied with password
[2013-05-31 18:08:00 -0400] epocsquadron: has anyone had a similar issue?
[2013-05-31 18:08:08 -0400] monokrome: Is the issue that if you set autostart, the first deploy breaks because dependencies aren't set up before the supervisor stuff is set up?
[2013-05-31 18:09:02 -0400] surge_: coderanger: Looks like I need to have a knife.rb file on the node to be added to chef server, and it looks like I need to scp the 'validation.pem' file as well
[2013-05-31 18:09:37 -0400] coderanger: monokrome: Yes, it means you can't use a delayed start pattern like with other systems
[2013-05-31 18:10:00 -0400] coderanger: monokrome: There is no way to set 'start at supervisor startup, but do not try to always start it'
[2013-05-31 18:10:04 -0400] monokrome: Doesn't Chef have some sort of dependency resolution to solve these problems? :/
[2013-05-31 18:10:15 -0400] coderanger: surge_: bootstrap copies over everything you need
[2013-05-31 18:10:24 -0400] coderanger: surge_: You run the bootstrap on your workstation, not the server
[2013-05-31 18:10:28 -0400] monokrome: coderanger: It should "always start it". If it doesn't start, that's a service outage.
[2013-05-31 18:10:29 -0400] surge_: doh
[2013-05-31 18:10:42 -0400] surge_: -_- long day! thanks coderanger
[2013-05-31 18:10:53 -0400] coderanger: monokrome: Then the chef run fails because on initial enable the service can't start :)
[2013-05-31 18:11:23 -0400] coderanger: monokrome: I've got a long diatribe about this on some ticket somewhere
[2013-05-31 18:11:52 -0400] monokrome: coderanger: My point is that Chef shouldn't set up supervisor unless it's ready to use it. That's a super primitive dependency resolution issue...
[2013-05-31 18:12:05 -0400] monokrome: IE, why create these services when they aren't ready yet?
[2013-05-31 18:12:07 -0400] monokrome: That's the problem :/
[2013-05-31 18:12:52 -0400] monokrome: A deploy should shut down the supervisor service if it's running, update related files, restart the service
[2013-05-31 18:13:12 -0400] monokrome: If supervisor start fails, that IS a deploy failure
[2013-05-31 18:13:22 -0400] monokrome: shouldn't be ignored
[2013-05-31 18:13:32 -0400] coderanger: monokrome: because the app_* cookbooks are limited by the hooks provided by the deploy resource
[2013-05-31 18:14:34 -0400] monokrome: The deploy resource sets up the services instead of the app_* projects?
[2013-05-31 18:15:31 -0400] coderanger: monokrome: the app cookbooks are wrappers around the deploy resource
[2013-05-31 18:16:00 -0400] coderanger: This will be corrected in some eventual future version of the app cookbooks
[2013-05-31 18:16:19 -0400] monokrome: okay
[2013-05-31 18:16:26 -0400] monokrome: Well, thanks for explaining. At least it makes sense now. :)
[2013-05-31 18:16:28 -0400] epocsquadron: icymi:  I'm having an issue where when a vm with mysql on it gets restarted, on restart chef_solo is unable to access the mysql server, reporting that root@localhost is denied with password, anyone know why?
[2013-05-31 18:16:40 -0400] barefoot: cparedes: any hints on how to deal with "NoMethodError: undefined method `decrypt_value' for Chef::EncryptedDataBagItem:Class" ?
[2013-05-31 18:17:29 -0400] coderanger: monokrome: The other thing that needs to get fixed is have Chef talk to supervisor natively, instead of shelling out to supervisorctl
[2013-05-31 18:17:40 -0400] coderanger: monokrome: With that, would could differentiate failures better
[2013-05-31 18:17:45 -0400] miah: indeed
[2013-05-31 18:17:51 -0400] annirun: If anyone could look at my problem i'm having with knife-windows it would be much appreciated http://stackoverflow.com/questions/16863158/knife-windows-network-error-getaddrinfo-name-or-service-not-known-windows22
[2013-05-31 18:17:52 -0400] surge_: coderanger: Should my workstation have /etc/chef/validation.pem ?
[2013-05-31 18:17:52 -0400] coderanger: (and also make it more correctly idemopotent)
[2013-05-31 18:18:10 -0400] coderanger: surge_: You should have the validation cert, more likely in ~/.chef or ./.chef though
[2013-05-31 18:18:21 -0400] nd__: jtimberman: As one of the authors of the PHP cookbook, could you tell me if such a pull-request would be wanted or if it is not the domain of such a cookbook to add another repository to the system?
[2013-05-31 18:19:37 -0400] surge_: coderanger: Yeah, my ~/.chef/knife.rb file specifies a validation_key '~/.chef/chef-validator.pem'
[2013-05-31 18:19:38 -0400] coderanger: nd__: In most cases, our cookbooks only support OS packages
[2013-05-31 18:19:51 -0400] coderanger: surge_: Sounds about right :)
[2013-05-31 18:19:59 -0400] coderanger: surge_: (as long as that file exists)
[2013-05-31 18:20:02 -0400] surge_: the bootstrap claims the file doesn't @ /etc/chef/....
[2013-05-31 18:20:09 -0400] surge_: That's why I ask
[2013-05-31 18:20:42 -0400] coderanger: surge_: bootstrap should be copying that file to the target as /etc/chef/validation.pem
[2013-05-31 18:21:11 -0400] coderanger: surge_: make sure you don't have another knife.rb in a local folder that it is finding
[2013-05-31 18:21:51 -0400] surge_: it was a --sudo thing
[2013-05-31 18:21:52 -0400] nd__: coderanger: Yes. But my question is, is this because that's enough for most or intentional, because the good-cititzen cookbook does this and I have to write another cookbook to change that only for my special need?
[2013-05-31 18:22:04 -0400] coderanger: surge_: :)
[2013-05-31 18:22:31 -0400] coderanger: nd__: Intentional, we don't want to support non-OS repos unless there is a major reason (for example, we support EPEL)
[2013-05-31 18:22:42 -0400] jtimberman: coderanger: "we support"
[2013-05-31 18:22:46 -0400] jtimberman: in air quotes
[2013-05-31 18:23:04 -0400] coderanger: yeah, its all nebulous to start with
[2013-05-31 18:23:09 -0400] nd__: coderanger: Alright, thanks. So I will not make a pull request and work with my local fork
[2013-05-31 18:23:13 -0400] coderanger: but random PPAs are even further down the long tail
[2013-05-31 18:23:16 -0400] jtimberman: in that EPEL is commonly used enough (and required for some software), AND trusted by the community that uses it, that our including it as a thing is ok.
[2013-05-31 18:23:47 -0400] jtimberman: generally we want to only add repositories for packages that are being installed when the repositories are the upstream vendor/publisher of a particular thing.
[2013-05-31 18:24:12 -0400] jtimberman: for example, rabbitmq project has yum/apt repositories, as does postgresql, so we make it an option to install the packages from those repositories.
[2013-05-31 18:25:28 -0400] jtimberman: if the php project published package repositories, that'd be one thing.
[2013-05-31 18:25:43 -0400] nd__: Ok, I see. The plan for my fork was not to specify a repository in a hard way but to add the option to specify a repo/key (for apt) as attributes that gets added if present. So by default the system repo would kick in, but one could override it with a special repo if one would need it.
[2013-05-31 18:25:58 -0400] jtimberman: why does it need to be a fork of the cookbook, anyway?
[2013-05-31 18:26:14 -0400] jtimberman: set up the package repo before the recipe that needs those packages, and bob's your uncle
[2013-05-31 18:26:29 -0400] nd__: jtimberman: It does not. So far, I simply took your cookbook and made the changes locally to see if this works for me.
[2013-05-31 18:27:25 -0400] nd__: jtimberman: Yes, I thought about that too. I'm fairly new to chef, so I wasn't sure that this would always work in this order.
[2013-05-31 18:28:56 -0400] rpcesar: ok. i set up a user account in chef open server, and got the public and private keys from it. ive gotten the client and repository mostly set, but i havent gotten knife fully configured. the web-ui gave me a public and private key, and the knife asks me for a validation key and client key. where do i put what?
[2013-05-31 18:29:18 -0400] nd__: Thanks jtimberman and coderanger for helping out
[2013-05-31 18:36:53 -0400] TrinitronX: quick question about using chefspec... should I be putting chefspec tests in an individual cookbook's repo, or in a higher level vagrant repo that includes many cookbooks?
[2013-05-31 18:38:09 -0400] TrinitronX: Reason I ask: the cookbook I'm working on depends on a couple other cookbooks, but I'm getting this error Chef::Exceptions::CookbookNotFound: Cookbook apache2 not found. If you're loading apache2 from another cookbook, make sure you configure the dependency in your metadata
[2013-05-31 18:47:22 -0400] monokrome: coderanger: Apparently running chef-client doesn't start the services either?
[2013-05-31 18:48:13 -0400] monokrome: I reboot, run chef-client, and since nothing changed it doesn't run that configuration which means there's no running services
[2013-05-31 18:48:17 -0400] monokrome: Pretty fail.
[2013-05-31 18:48:58 -0400] annirun: [14:01] <annirun> If anyone could look at my problem i'm having with knife-windows it would be much appreciated http://stackoverflow.com/questions/16863158/knife-windows-network-error-getaddrinfo-name-or-service-not-known-windows22
[2013-05-31 18:52:11 -0400] hughsaunders: Hey all, I'm getting a bad clock message from erchef, but my client and server and both synced with ntp and accurate to within a second or so. 2013-05-31T17:19:52Z erchef@127.0.0.1 INFO req_id=7yUMOp/F6f6b4l7g4Vg5NQ==; status=401; method=POST; path=/environments/grizzlyupgrade/cookbook_versions; user=grizzlyupgrade1; msg=bad_clock; req_time=17
[2013-05-31 18:53:02 -0400] hughsaunders: annirun: the hostname "windows" is not known, is it in your internal dns or in your hosts file?
[2013-05-31 18:54:05 -0400] hughsaunders: ignore me, should have read the post more carefully..
[2013-05-31 18:55:18 -0400] hughsaunders: so you probably need to reorganise the bootstrap command as the first arg is the fqdn of the machine to install chef on, which is why knife is attempting to connect to "windows"
[2013-05-31 18:55:27 -0400] annirun_:  knife bootstrap windows ssh (options)
[2013-05-31 18:55:34 -0400] annirun_: is the syntax
[2013-05-31 18:55:50 -0400] annirun_: that the documentation referances... and it says the ip should be part of the optons
[2013-05-31 18:56:05 -0400] hughsaunders: knife bootstrap --help:
[2013-05-31 18:56:10 -0400] hughsaunders: knife bootstrap FQDN (options)
[2013-05-31 18:56:41 -0400] annirun: test
[2013-05-31 18:56:46 -0400] annirun: it keeps disconnecting me TT
[2013-05-31 18:57:03 -0400] annirun: ok as i was saying, the documentation states the syntax is " knife bootstrap windows ssh (options)"
[2013-05-31 18:57:22 -0400] jtimberman: nd__: yeah, chef runs your recipes in the order they are specified on the node, and it configures the resources the recipes contain in the order they're written.
[2013-05-31 18:57:34 -0400] annirun: and other orders of the words don't work with various errors about this or that being invalid
[2013-05-31 18:58:12 -0400] annirun: knife bootstrap (options) at least makes a connection... but errors out because it isn't the right command
[2013-05-31 19:00:16 -0400] hughsaunders: its odd, all the documentation says that knife bootstrap windows is correct, but your output clearly shows that its trying to connect to a machine called windows :-/
[2013-05-31 19:00:44 -0400] annirun: which is exactly why 6 hours of my workday so far has been spent on this TT
[2013-05-31 19:01:48 -0400] annirun: the plugin documentation says that running the gem install sets everything up and no more configuration is needed... but it's apperant there is some problem with the knife-windows plugin instilation
[2013-05-31 19:05:52 -0400] surge_: I cant seem to upload cookbooks to my open source chef server... everything seems to be set up correctly. Registered the subdomain, added the SSL certs... at a loss really
[2013-05-31 19:05:57 -0400] surge_: initialize': getaddrinfo: nodename nor servname provided, or not known (SocketError)  is pretty vague
[2013-05-31 19:06:13 -0400] surge_: I thought this looked promising: http://community.opscode.com/questions/281
[2013-05-31 19:06:19 -0400] surge_: but that's for a virtual VM on a local machine
[2013-05-31 19:06:58 -0400] spheromak: surge_ your box can't resolve your chef servers name
[2013-05-31 19:08:23 -0400] surge_: Any recommendations?
[2013-05-31 19:09:00 -0400] surge_: I was able to `knife bootstrap` previously and add a node to the chef server
[2013-05-31 19:09:10 -0400] surge_: so it's strange i can't upload
[2013-05-31 19:09:18 -0400] surge_: and it's not like i changed the knife.rb file between now and then
[2013-05-31 19:10:06 -0400] hughsaunders: surge_: there is an issue where in some circumstances chef_server_url is ignored and 'chefserver' is used instead, could try adding chefserver to your hosts file.
[2013-05-31 19:10:41 -0400] surge_: =/ that's seem kinda hacky
[2013-05-31 19:10:50 -0400] hughsaunders: telling me.
[2013-05-31 19:12:46 -0400] surge_: It's using the internal ip address -___-
[2013-05-31 19:13:49 -0400] surge_: INFO: Uploading /Users/Sergio/Desktop (checksum xxxxx) to ttps://ip-xx-xxx-xxx-xx.ec2.internal:443/bookshelf/organization---
[2013-05-31 19:14:42 -0400] hughsaunders: so you aren't running into that particular issue..
[2013-05-31 19:15:05 -0400] surge_: gotta update ohai data i presume?
[2013-05-31 19:22:32 -0400] surge_: ugh
[2013-05-31 19:29:36 -0400] monokrome: If I am running a recipe in the staging environment and do a search for nodes with a role, will it only find nodes in that same environment?
[2013-05-31 19:29:40 -0400] surge_: Doesn't appear to be any way to reconfigure the chef server with an attribute override either
[2013-05-31 19:29:43 -0400] kallistec: surge_: either update the hostname on your chef-server box, then run chef-server-ctl reconfigure, or manually set it in etc/chef-server/chef-server.rb and then run reconfigure
[2013-05-31 19:29:50 -0400] monokrome: or do I have to manually make sure that the nodes are in the correct environment?
[2013-05-31 19:30:12 -0400] surge_: kallistic: Didn't see an attribute for hostname, what would i pass in?
[2013-05-31 19:30:25 -0400] cwj: monokrome: include chef_environment:staging as part of the search query
[2013-05-31 19:30:33 -0400] cwj: or chef_environment:#{node.chef_environment}
[2013-05-31 19:30:37 -0400] cwj: more likely
[2013-05-31 19:30:41 -0400] kallistec: surge_: IIRC the lb["api_fqdn"] setting is the one to change: http://docs.opscode.com/config_rb_chef_server.html#load-balancer
[2013-05-31 19:30:41 -0400] monokrome: :(
[2013-05-31 19:32:06 -0400] isotope1: if there step to adding ohai plugins besides adding it to the cookbook and uploading it?
[2013-05-31 19:32:11 -0400] surge_: kallistic: thanks, i'll give it a shot
[2013-05-31 19:32:27 -0400] kallistec: surge_: http://tickets.opscode.com/browse/CHEF-4226 has an example of what one user did to resolve same issue
[2013-05-31 19:32:42 -0400] kallistec: I don't know if *all* of those config settings are required
[2013-05-31 19:33:03 -0400] monokrome: so how do I search for a machine with role:web and environment:staging? :/
[2013-05-31 19:33:38 -0400] isotope1: monokrome use AND
[2013-05-31 19:33:41 -0400] cwj: monokrome: in a recipe? search("role:web AND chef_environment:staging")
[2013-05-31 19:33:43 -0400] monokrome: oh ok
[2013-05-31 19:33:45 -0400] monokrome: thanks :}
[2013-05-31 19:34:01 -0400] isotope1: np
[2013-05-31 19:34:09 -0400] rpcesar: ok, im really confused, i go to bootstrap a node from a workstation after placing the private key, and it says No such file or direectory for the validation.pem. I do a bit of research and it seems like im supposed to copy that from /etc/chef on the chef server, but that folder is empty
[2013-05-31 19:34:33 -0400] isotope1: is this chef 11?
[2013-05-31 19:34:33 -0400] rpcesar: how exactly does one get the validation.pem
[2013-05-31 19:34:39 -0400] isotope1: is so its in /etc/chef-server/
[2013-05-31 19:34:40 -0400] rpcesar: correct
[2013-05-31 19:35:40 -0400] rpcesar: and the one to use is chef-validator.pem? Note I created said users through the web-ui, and ive run across topics mentioning that pem file, so i want to confirm its chef-validator.pem I need
[2013-05-31 19:36:57 -0400] isotope1: yeah thats it
[2013-05-31 19:45:55 -0400] chance: in reference to http://docs.opscode.com/resource_common_conditionals.html#only-if-examples, does only_if prevent the entire block its in from running, or only whats in the brackets?
[2013-05-31 19:47:23 -0400] cjs226: after upgrading chef-client from 10.26.0-1 to 11.4.4-2, it thinks it's runnin as solo which causes failures such as when attempting to use data bags.  any ideas?  here's a gist: https://gist.github.com/cjs226/5687503
[2013-05-31 19:49:00 -0400] surge_: kallistic: looks like the 4 attributes might be needed but it's timing out now
[2013-05-31 19:49:05 -0400] surge_: getting 500s
[2013-05-31 19:49:44 -0400] isotope1: adding a plugin to ohai, is their a step besides adding it to the ohai cookbook?
[2013-05-31 19:50:10 -0400] isotope1: I added it to plugins and uploaded the cookbook but its doesn't appear on the node
[2013-05-31 19:50:14 -0400] isotope1: when I run chef-client
[2013-05-31 19:53:16 -0400] kallistec: surge_: try a chef-server-ctl restart to ensure all the components have the config updates, if that doesn't work, chef-server-ctl tail will do an "omni-tail" of all logs
[2013-05-31 20:01:02 -0400] btm: @opscode #opschef cookbook code review now, join: https://plus.google.com/hangouts/_/49b4dfaf3cb5fcfebc5e90c47770baf7f07fc29d, watch: http://youtu.be/_JOWlFDpCpo
[2013-05-31 20:01:43 -0400] rpcesar: ok, im not getting a 403 error when attempting to bootstrap a node: your validation client is not authorized to create the client for this node
[2013-05-31 20:03:00 -0400] rpcesar: what is it that I am missing in the stack? the workstation user i am using is marked as administrator, and the chef-validator.pem was copied to the directory chef requested
[2013-05-31 20:04:31 -0400] barefoot: btm: Im watching :)
[2013-05-31 20:07:44 -0400] rpcesar: what all can "Your validation client is not authorized to create the client for this node (HTTP 403) indicitive of?
[2013-05-31 20:13:10 -0400] btm: barefoot: yay!
[2013-05-31 20:13:20 -0400] btm: barefoot: let us know if we're boring.
[2013-05-31 20:13:45 -0400] barefoot: hehe
[2013-05-31 20:14:22 -0400] barefoot: its interesting insight, thanks for broadcasting
[2013-05-31 20:29:31 -0400] Twirrim: Is there a way to get the actual API output from "knife ec2 create"?  It's returning a BadRequest but that's not particularly helpful.
[2013-05-31 20:33:32 -0400] jameson__: that might be your AWS Keys are bad
[2013-05-31 20:34:02 -0400] jameson__: unless 403/400, then that's probably your validator keys are bad
[2013-05-31 20:36:10 -0400] Twirrim: that's not it.  my keys are fine.  I'm able to make normal ec2 servers okay, it's vpc ones that won't create.
[2013-05-31 20:40:20 -0400] rpcesar: what all can "Your validation client is not authorized to create the client for this node (HTTP 403) indicitive of? im trying to bootstrap a server and it keeps failing with a 403 caused by this error
[2013-05-31 20:40:42 -0400] rpcesar: ive searched the common errors , but nothing seems to match this
[2013-05-31 20:41:23 -0400] rpcesar: ive found a few hints to others having a similar problem. if it helps the clients im trying to bootstrap are centos6.4x64 machines
[2013-05-31 21:39:28 -0400] kallistec: rpcesar: is there an existing client with the same name as the one you're trying to create?
[2013-05-31 22:21:56 -0400] chef_tester: @timsmith: btw, also fails if I comment out files_group, files_owner, and files_mode
[2013-05-31 22:22:29 -0400] rayrod2030: is it possible to run individual suites with test-kitchen?
[2013-05-31 22:22:45 -0400] chef_tester: @timsmith: i.e., http://pastebin.com/Rv2Ay6su
[2013-05-31 22:24:41 -0400] timsmith: gabceb:  same ruby version on both boxes?
[2013-05-31 22:26:17 -0400] chef_tester: timsmith: in fact, same problem with directory instead of remote_directory... problem seems to lie there..
[2013-05-31 22:27:05 -0400] chef_tester: timsmith: can you reproduce the problem?
[2013-05-31 22:27:28 -0400] timsmith: chef_tester:  Is there a reason you're trying to create the same directory twice?
[2013-05-31 22:28:39 -0400] gabceb: i assume. I triggered a server create using knife ec2
[2013-05-31 22:29:02 -0400] chef_tester: no practical reason, indeed. I am working on testing idempotence of Chef recipes and resources (providers)
[2013-05-31 22:29:16 -0400] chef_tester: so, more of an "academic" interest ;)
[2013-05-31 22:29:23 -0400] gabceb: i also had to specify -d ubuntu12.04-gems on the command but I used the same command for both boxes
[2013-05-31 22:29:55 -0400] chef_tester: still interesting, though..
[2013-05-31 22:30:07 -0400] timsmith: does that user actually exist?
[2013-05-31 22:30:15 -0400] chef_tester: might be worth a bug report, just wanted to confirm back with you experts
[2013-05-31 22:30:22 -0400] chef_tester: no, that's the point
[2013-05-31 22:31:04 -0400] timsmith: I suspect it has something to do with the first time it's created the code path creating a directory and the second time it has to modify an existing directory.
[2013-05-31 22:31:08 -0400] timsmith: not sure though
[2013-05-31 22:34:49 -0400] chef_tester: yes, I've been digging into the resource provider hierarch for remote_directory, directory, and file
[2013-05-31 22:35:02 -0400] rpcesar: are there any precautions I need to take in regards to installing chef scripts that manage/take over management of services that were previously installed? namely because my intent is to bootstrap onto an existing sharded replica set in mongo
[2013-05-31 22:35:38 -0400] gabceb: Any clues timsmith. I will try to create a new server now and see if I get the same error
[2013-05-31 22:35:49 -0400] gabceb: Any clues timsmith?*
[2013-05-31 22:35:49 -0400] chef_tester: the problem seems to be with "access_controls" in chef/provider/file.rb
[2013-05-31 22:36:27 -0400] timsmith: gabceb:  not sure about that one
[2013-05-31 22:36:41 -0400] timsmith: the file provider is getting revamped at the moment
[2013-05-31 22:36:46 -0400] gabceb: ok. i will try getting a new server up and see if it repros again
[2013-05-31 22:36:49 -0400] gabceb: thanks!
[2013-05-31 22:36:54 -0400] timsmith: just a heads up chef_tester
[2013-05-31 22:37:20 -0400] timsmith: not sure if they've spun up any prerelease gems yet
[2013-05-31 22:37:33 -0400] timsmith: but if you're goal is to test stuff you probably want to be using a build off master now
[2013-05-31 22:38:11 -0400] chef_tester: makes sense, will do that.. thanks
[2013-05-31 23:16:39 -0400] miah: herp derp
[2013-05-31 23:24:27 -0400] aneto: derp? https://i.chzbgr.com/maxW500/4469544704/h512F3588/
[2013-05-31 23:36:03 -0400] coderanger: miah: permaderp
[2013-05-31 23:58:57 -0400] banachtarski: Why is that when I specify --bootstrap-version 11.4.2, it still uses 11.4.4?
