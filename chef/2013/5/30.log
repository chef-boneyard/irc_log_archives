[2013-05-30 00:13:53 -0400] jsookiki: is anyone familiar with invoking the knife.rb class in the chef gem in a ruby program?
[2013-05-30 00:18:37 -0400] jmickle: hey guys whats the best way to bootstrap and get chef-client 11
[2013-05-30 00:18:47 -0400] jmickle: anyone have an example template for that yet?
[2013-05-30 00:22:19 -0400] spheromak: BryanWB: https://github.com/cl-lab-k/busser-serverspec
[2013-05-30 00:28:36 -0400] chip-: spheromak: hot!
[2013-05-30 00:33:35 -0400] airtonix: do people here not like opsworks?
[2013-05-30 00:34:23 -0400] airtonix: perhaps I asked during a dead period. I'll ask my question again. hi there, new to chef, ruby and so forth. big django user and I find ruby to be unpleasant. I have a few questions: 1. how to locally test aws opsworks recipes locally with vagrant (considering the stacks and layers data is missing locally) 2. are aws opsworks layers just chef roles? 3. has someone already created a nginx load balancher recipe ?
[2013-05-30 00:35:24 -0400] spox: spheromak: very nice
[2013-05-30 00:35:37 -0400] airtonix: regarding the last point, I've actually already found 3 cookbooks for nginx. but the problem of missing AWS data is something I'm not familiar with solving.
[2013-05-30 00:36:04 -0400] josephholsten: reset: cookbooks with paths seem to be acting wonky with berks master. has it been known to work?
[2013-05-30 00:37:18 -0400] reset:  should be working
[2013-05-30 00:37:31 -0400] reset: post an issue with your results if you can
[2013-05-30 00:37:35 -0400] reset: we'll take a peek at it
[2013-05-30 00:37:41 -0400] josephholsten: working on repro steps nao
[2013-05-30 00:38:09 -0400] reset: thanks man
[2013-05-30 00:38:37 -0400] reset: coderanger: is there an uninstaller that goes with the omnibus installer?
[2013-05-30 00:38:55 -0400] coderanger: reset: rm -rf /opt/opscode
[2013-05-30 00:38:58 -0400] reset: haha
[2013-05-30 00:39:10 -0400] reset: think it also installs a package on CentOS for example
[2013-05-30 00:39:31 -0400] coderanger: reset: Generally speaking, no, since both dpkg and rpm support uninstalling
[2013-05-30 00:39:32 -0400] spox: airtonix: opsworks is a weird setup. they do a lot of crazy things you won't be able to reproduce locally for testing
[2013-05-30 00:39:47 -0400] spheromak: spox you see that issue i popped last nght ? any direction. I started looking @ lxc-create to see if its in there. sorta going outside-in on the lxc stuff.
[2013-05-30 00:40:06 -0400] reset: coderanger: ok no prob. It would be useful I think to abstract the uninstall steps on a per OS level
[2013-05-30 00:40:11 -0400] coderanger: reset: We install nothing outside of the blob that gets dropped into /opt, and then stuff created at runtime (/var/chef, /etc/chef)
[2013-05-30 00:40:20 -0400] spox: spheromak: sorry, so much stuff has changed and my connection died in the middle of talking about it last night
[2013-05-30 00:40:26 -0400] airtonix: spox: frustrating, how do they expect us to create our own custom cookbooks in a viable manner?
[2013-05-30 00:40:27 -0400] spox: but, it did force me to go to bed :P
[2013-05-30 00:40:30 -0400] coderanger: and runtime-created stuff is generally not something you want to remove at uninstall (config files, logs, etc)
[2013-05-30 00:40:41 -0400] reset: alright, thanks man
[2013-05-30 00:40:43 -0400] coderanger: reset: So nuking the opt blob is about the only thing we would do :)
[2013-05-30 00:40:55 -0400] spheromak: spox no worries its why i opened an issue, even though I don't think its vagabond.
[2013-05-30 00:41:04 -0400] spox: spheromak: i remember seeing that issue, and i might have a fix in a branch some where
[2013-05-30 00:41:15 -0400] spheromak: spox awesome
[2013-05-30 00:41:23 -0400] spox: i'll dig it out. i know that it was pulling back the wrong info, which led to bad release numbers in the download
[2013-05-30 00:41:26 -0400] spheromak: spox its the lx cook ?
[2013-05-30 00:41:37 -0400] jmickle: hey coderanger how are you
[2013-05-30 00:41:38 -0400] spox: nah, it's in vagabond cookbook
[2013-05-30 00:41:45 -0400] spox: yar (yet another repo)
[2013-05-30 00:41:46 -0400] spox: :P
[2013-05-30 00:41:48 -0400] spheromak: :D
[2013-05-30 00:41:52 -0400] spox: it ships a cent template
[2013-05-30 00:42:00 -0400] spheromak: gotcha
[2013-05-30 00:42:03 -0400] spheromak: and thats out of date
[2013-05-30 00:42:22 -0400] spheromak: PM or resppond to the issue I have to bounce for about an hour
[2013-05-30 00:42:30 -0400] spox: cookbook should be up to date i think. it's a subtree in vagabond proper and i keep them pretty synced
[2013-05-30 00:42:33 -0400] spheromak: And I appreciate your work :D
[2013-05-30 00:42:39 -0400] spox: will do, i'll probably be looking at it in an hour or two
[2013-05-30 00:42:43 -0400] spox: :)
[2013-05-30 00:50:16 -0400] josephholsten: aww, running all berks features is not snappy
[2013-05-30 00:50:29 -0400] coderanger: jmickle: Grumpy at Rails config loading
[2013-05-30 00:51:00 -0400] jmickle: ha
[2013-05-30 00:51:14 -0400] jmickle: coderanger: i am pulling my hair out fixing community cookbooks for chef 11
[2013-05-30 00:51:37 -0400] jmickle: coderanger: did i mention how much i HATE ruby :-P
[2013-05-30 00:55:15 -0400] coderanger: Solution: Rails.application.config.after_initialize do
[2013-05-30 00:55:59 -0400] jmickle: hahaha
[2013-05-30 00:56:20 -0400] jmickle: it makes me sad that cookbooks are written in ruby :(
[2013-05-30 00:56:32 -0400] jmickle: lets switch this to scala :-P
[2013-05-30 00:56:56 -0400] jmickle: or lets just go straight C
[2013-05-30 00:56:57 -0400] jmickle: haha
[2013-05-30 00:56:57 -0400] denken: then you'd have two problems
[2013-05-30 00:57:29 -0400] jmickle: denken: probably true, the jdk for one
[2013-05-30 00:57:29 -0400] jmickle: haha
[2013-05-30 00:59:35 -0400] silk1: When did http://wiki.opscode.com/display/chef/Release+Notes get created? (Thanks by the way)
[2013-05-30 01:02:49 -0400] josephholsten: reset: looks like it's another variant of https://github.com/RiotGames/berkshelf/issues/103
[2013-05-30 01:03:35 -0400] reset: that's still underwary but a bit of a break happening because of an internal push on another project
[2013-05-30 01:05:13 -0400] philsturgeon: just tried running chef-client and got "NoMethodError: undefined method `close!' for nil:NilClass"
[2013-05-30 01:06:02 -0400] philsturgeon: got it, running out of space
[2013-05-30 01:13:53 -0400] zackf: anyone familar with the knife code base?
[2013-05-30 01:15:55 -0400] coderanger: zackf: I know enough to be dangerous
[2013-05-30 01:20:03 -0400] zackf: Let me make sure I know what I"m talking about before i ask I'm going to make sure i know whats going on and then I'll ping you
[2013-05-30 01:21:00 -0400] zackf: Trying to figure out where in the bootstrap logic it makes the call to create the client
[2013-05-30 01:21:59 -0400] airtonix: ,do we have to use ruby? i'd much rather use python.
[2013-05-30 01:33:05 -0400] stormerider: im sure you can write a python client if you want, but i think it's a bit late to change the language choice of the entire ecosystem.
[2013-05-30 01:43:00 -0400] airtonix: ugh
[2013-05-30 01:46:08 -0400] stormerider: im not sure what the point of complaining about the language choice is when there's already thousands of lines of code written...
[2013-05-30 01:47:43 -0400] harrisony: with chef solo, in defining my json files do I really need   "json_class": "Chef::Role"
[2013-05-30 01:48:33 -0400] stormerider: harrisony: i know that i dont with chef server, im pretty sure that's a completionism thing.
[2013-05-30 01:50:34 -0400] jtimberman: airtonix: hey, just saw your opsworks questions. i don't know if many people here use it, but it's not a super common use of chef, I think, given that it was built on Scalarium and we didn't really get a lot of traffic here about it.
[2013-05-30 01:50:49 -0400] harrisony: ah wait, I think its to do with the version of chef this vagrant box is using
[2013-05-30 01:53:34 -0400] jtimberman: airtonix: 1. i don't know whether it translates well from opsworks -> vagrant; 2. layers are "kind of" like a group of roles for a specific purpose like an application; 3. i don't know if there's an nginx load balancer recipe, i imagine the path of least resistance being AWS ELB.
[2013-05-30 01:54:54 -0400] jtimberman: as for a python client, Opscode doesn't plan to make a python client, but if someone in the community wants to build something we won't stop you :). there is already pychef by coderanger, a python library for Chef's server API. https://github.com/coderanger/pychef
[2013-05-30 01:56:07 -0400] jtimberman: the concept of using a different language for writing cookbooks is possible, but that's not something Opscode is planning
[2013-05-30 01:56:34 -0400] coderanger: I'm planning it, but haven't actually done much
[2013-05-30 01:56:35 -0400] coderanger: :)
[2013-05-30 01:57:18 -0400] jtimberman: coderanger: pipe down ;)
[2013-05-30 01:57:28 -0400] jtimberman: write it in ocaml!
[2013-05-30 01:58:09 -0400] coderanger: jtimberman: If I can get a python recipe loader working, I would expect it to work in any language you can embed in ruby :)
[2013-05-30 01:58:15 -0400] airtonix: jtimberman: 3. i did find at least three load balancer cookbooks for nginx.
[2013-05-30 01:58:21 -0400] coderanger: jtimberman: Python and JS are just my first targets
[2013-05-30 01:58:35 -0400] airtonix: coderanger: so many people would love you for that
[2013-05-30 01:58:58 -0400] coderanger: airtonix: It would only ever be a 'because I can' side project
[2013-05-30 01:59:13 -0400] coderanger: airtonix: Nothing I would ever probably recommend using in production, not that it will stop people :)
[2013-05-30 01:59:18 -0400] airtonix: at the moment I'm using a fabfile to deploy to all my nodes.
[2013-05-30 02:00:08 -0400] coderanger: airtonix: As am I :)
[2013-05-30 02:00:14 -0400] coderanger: PyChef + Fabric = <3
[2013-05-30 02:01:46 -0400] airtonix: yeah I'd love to make chef or opsworks a main part of my toolkit, but ruby i hate and i'm always going to be in the middle of a project that prevents me from learning a language i really dislike. so i guess until chef supports python it'll always be something i'll hope for.
[2013-05-30 02:02:02 -0400] jtimberman: coderanger: did you ever check out the perl stuff adam did?
[2013-05-30 02:02:09 -0400] coderanger: airtonix: You don't need to learn much Ruby for chef, sec
[2013-05-30 02:02:21 -0400] coderanger: airtonix: http://docs.opscode.com/just_enough_ruby_for_chef.html
[2013-05-30 02:02:31 -0400] coderanger: airtonix: It fits on one 8.5x11 page, you have no excuse ;-)
[2013-05-30 02:02:57 -0400] coderanger: airtonix: and http://pychef.readthedocs.org/en/latest/fabric.html shows how to use the fab integration
[2013-05-30 02:08:08 -0400] airtonix: coderanger: i've actually seen stuff used in the erbs and recipes of cookbooks  that isn't on that page, like for instance what's the difference between {%= @application_name %} and {%= application_name %}
[2013-05-30 02:10:03 -0400] coderanger: airtonix: <%= @application_name %> is how you reference the thing you passed in as variables application_name: 'foo'
[2013-05-30 02:10:12 -0400] coderanger: <%= application_name %> is an error :)
[2013-05-30 02:10:51 -0400] coderanger: In general the only thing you see in templates not from the provided variables is stuff like <%= node['foo'] %>
[2013-05-30 02:11:03 -0400] coderanger: since we make that globally available for people that are lazy :)
[2013-05-30 02:17:39 -0400] airtonix: coderanger: so if it has @ in front then the variable is from a certain place?
[2013-05-30 02:17:58 -0400] airtonix: i feel like this must be ruby 101
[2013-05-30 02:18:13 -0400] jtimberman: airtonix: yes; template resource has a 'variables' parameter that you can pass in a hash of variables to use in the recipe.
[2013-05-30 02:18:20 -0400] jtimberman: er, sorry, in the erb template itself
[2013-05-30 02:19:22 -0400] coderanger: airtonix: Do you do Django-y things?
[2013-05-30 02:20:24 -0400] airtonix: coderanger: do you mean "do i approach ruby or chef as i would django and python" ?
[2013-05-30 02:20:27 -0400] coderanger: Basically the #variables stuff you pass to the template resource forms the context passed to the template
[2013-05-30 02:20:41 -0400] coderanger: airtonix: No, just trying to phrase my metaphors in whatever system you know best :)
[2013-05-30 02:21:09 -0400] airtonix: coderanger: ok, yes i'm mainly a django and angular person
[2013-05-30 02:21:29 -0400] coderanger: Okay, so yeah in general {{ foo }} == <%= @foo %>
[2013-05-30 02:21:44 -0400] coderanger: @foo in ruby is how you access an instance variable, like self.foo
[2013-05-30 02:21:58 -0400] coderanger: so that is accessing the instance variable foo from the template context
[2013-05-30 02:22:13 -0400] coderanger: and then there are a few global thangs mixed in to the template context for laziness
[2013-05-30 02:22:44 -0400] airtonix: therefor globals are not prefixed with @ ?
[2013-05-30 02:23:45 -0400] coderanger: yahr
[2013-05-30 02:23:51 -0400] coderanger: equivalent to template tags
[2013-05-30 02:24:07 -0400] coderanger: just magically available everywhere
[2013-05-30 02:24:15 -0400] coderanger: (except unlike tags, they can be used in expressions)
[2013-05-30 02:43:44 -0400] three18ti: does the concept of chef solo not exist in chef 11.4?
[2013-05-30 02:45:15 -0400] three18ti: will... I just found the chef-solo command...
[2013-05-30 04:07:28 -0400] stormerider: jtimberman: updated that nagios pull request :) danke.
[2013-05-30 04:29:47 -0400] coderanger: $ cat recipes/default.js
[2013-05-30 04:29:47 -0400] coderanger: debug('Oh god');
[2013-05-30 04:29:52 -0400] coderanger: [2013-05-29T21:28:12-07:00] DEBUG: Oh god
[2013-05-30 04:29:54 -0400] coderanger: :3
[2013-05-30 04:30:00 -0400] coderanger: I'm a terrible person
[2013-05-30 04:30:48 -0400] spox: :O
[2013-05-30 04:35:22 -0400] coderanger: debug(node.kernel.name);
[2013-05-30 04:35:24 -0400] coderanger: totally works
[2013-05-30 04:35:31 -0400] coderanger: [2013-05-29T21:35:08-07:00] DEBUG: Darwin
[2013-05-30 04:35:35 -0400] coderanger: Now to expose resources
[2013-05-30 04:37:51 -0400] stormerider: coderanger: cool :)
[2013-05-30 04:48:51 -0400] jtimberman: coderanger: terrifying :D
[2013-05-30 04:49:52 -0400] kcb_: is there a way to access the node object from a library? not a method defined in a library and called in a recipe, but code that runs when the library is loaded?
[2013-05-30 04:50:12 -0400] coderanger: kcb_: No, since the node isn't fully loaded at that point
[2013-05-30 04:50:42 -0400] coderanger: kcb_: Libraries can't access anything, they are run in a blank ruby context
[2013-05-30 04:50:54 -0400] kcb_: coderanger, ok, what about the ohai attributes that are about to be in the node?
[2013-05-30 04:51:11 -0400] kcb_: btw, i know even doing this is terrible
[2013-05-30 04:51:16 -0400] jtimberman: kcb_: i wouldn't rely on that :)
[2013-05-30 04:51:25 -0400] coderanger: kcb_: As I said, library files are run via Kernel.load, nothing there period
[2013-05-30 04:51:29 -0400] jtimberman: at least you know you're doing something sharp and pointy
[2013-05-30 04:51:36 -0400] coderanger: kcb_: Anything you want, you need to pass in as args
[2013-05-30 04:52:12 -0400] jtimberman: coderanger: ha!
[2013-05-30 04:52:31 -0400] jtimberman: coderanger: you're closer to the metal, it's all json in the end ;)
[2013-05-30 04:52:43 -0400] kcb_: ok, maybe i should step back. i have an ohai plugin that provides important attributes, but i don't trust it. i want to abort the run if it failed to provide data i need . and i want to do this before any attributes file has a chance to try to use the data that might not be there
[2013-05-30 04:53:05 -0400] coderanger: jtimberman: I'm about 3 meters below the metal looking back up at a gaping hole
[2013-05-30 04:53:14 -0400] kcb_: any thoughts?
[2013-05-30 04:53:17 -0400] coderanger: kcb_: Then do it in your attributes file
[2013-05-30 04:53:33 -0400] kcb_: and somehow guarantee it runs first?
[2013-05-30 04:53:52 -0400] coderanger: Put it above the relevant lines
[2013-05-30 04:54:27 -0400] kcb_: the goal is to protect other people who use this data in their attributes files that i may not code review
[2013-05-30 04:54:54 -0400] coderanger: Then perhaps check the value in your ohai plugin and return nil if it is bad?
[2013-05-30 04:55:42 -0400] kcb_: ok, well at least that proves libraries can't work. i can attack it in ohai, or attributes. or i think i got a start handler to work
[2013-05-30 04:55:46 -0400] kcb_: will find another way
[2013-05-30 04:55:46 -0400] kcb_: thx
[2013-05-30 04:57:24 -0400] stormerider: oh, that reminds me, is there a good doc on how to add stuff into the Ohai data? i have a JSON endpoint on some boxes that i would like to find a way to access via search, im just not sure how one goes about telling Ohai about stuff it doesn't natively know how to probe
[2013-05-30 04:59:17 -0400] coderanger: stormerider: Just search for 'ohai plugin'
[2013-05-30 04:59:24 -0400] coderanger: there is a resource for it
[2013-05-30 04:59:37 -0400] coderanger: you just have to write a little snippet of ruby code in the ohai DSL
[2013-05-30 05:15:43 -0400] coderanger: Yeah, so this works, and I'm a terrible person
[2013-05-30 05:15:49 -0400] coderanger: (again)
[2013-05-30 05:17:03 -0400] coderanger: file('/Users/coderanger/src/chef-funnel-js/somefile', {
[2013-05-30 05:17:03 -0400] coderanger:   content: 'foobar',
[2013-05-30 05:17:03 -0400] coderanger: });
[2013-05-30 05:27:57 -0400] coderanger: https://github.com/coderanger/chef-funnel-js
[2013-05-30 05:28:00 -0400] coderanger: Who dares try it?
[2013-05-30 05:30:05 -0400] isotope: coderanger I just tried it
[2013-05-30 05:30:11 -0400] isotope: now my site is down :-)
[2013-05-30 05:30:27 -0400] coderanger: isotope: Closed: Working as intended
[2013-05-30 05:31:17 -0400] stormerider: feature, not a bug :)
[2013-05-30 05:40:12 -0400] jrclouda: node name and client key not working with knife bootstrap windows winrm. getting 401
[2013-05-30 05:40:25 -0400] jrclouda: anyone seen this beahvaoir
[2013-05-30 06:08:46 -0400] spheromak: coderanger thats nuts.
[2013-05-30 06:09:00 -0400] coderanger: spheromak: For bonus points, adding Python support now
[2013-05-30 06:10:01 -0400] coderanger: Or at least trying
[2013-05-30 06:11:47 -0400] spheromak: lol @ https://github.com/coderanger/chef-funnel/blob/master/libraries/default.rb#L36
[2013-05-30 06:13:15 -0400] spheromak: yea i see you're handling of  .py  there
[2013-05-30 06:13:53 -0400] coderanger: I have libpython loading, I just need to setup the same kind of magic variable stuff and then exec the recipe file
[2013-05-30 06:26:48 -0400] coderanger: Okay, for any brave souls willing to play along, what would a Chef recipe in Python look like?
[2013-05-30 06:29:40 -0400] spheromak: coderanger to throw fire on that, lots of whitespace ?
[2013-05-30 06:29:43 -0400] spheromak: :D
[2013-05-30 06:30:24 -0400] coderanger: The most natural thing that is still valid syntax I can come up with is this
[2013-05-30 06:30:25 -0400] coderanger: class Package('ntp'):
[2013-05-30 06:30:25 -0400] coderanger:     version = '1.0'
[2013-05-30 06:56:46 -0400] realityforge: Hi, I have recently reinstalled our opensource chef server (11.0.8-1) and have started to experience some bizarre behaviour. The erchef process starts consuming all available CPU and we get timeout issues when attempting to connect to it (or gateway errors reported by nginx). Our postgres log also started to fill up with entries like
[2013-05-30 06:56:50 -0400] realityforge: DETAIL:  Key (org_id, checksum)=(00000000000000000000000000000000, f6944e066f3aa35993aff3e3c62cea6c) already exists. 2013-05-30_06:22:21.07311 STATEMENT:  INSERT INTO checksums(org_id, checksum) 2013-05-30_06:22:21.07311      VALUES ($1, $2)
[2013-05-30 06:56:58 -0400] realityforge: has anyone seen anything like this before?
[2013-05-30 06:58:05 -0400] spheromak: realityforge I've seen this behavior when a version constraint was not matched
[2013-05-30 06:58:52 -0400] realityforge: okay. Time out in the resolver?
[2013-05-30 06:58:55 -0400] realityforge: thanks
[2013-05-30 06:58:57 -0400] spheromak: the solver in chef11 has some race that can blow up when some cook is dependant on another that can't be solved IIRC. I created a ticket i dont think its been resolved. It shouldn't happen if you are using knife ot upload, but other tools can actually get around the knife checks
[2013-05-30 06:59:41 -0400] spheromak: lemme find my ticket
[2013-05-30 07:01:33 -0400] spheromak: realityforge http://tickets.opscode.com/browse/CHEF-3921
[2013-05-30 07:01:43 -0400] realityforge: Awesome - thanks a lot!
[2013-05-30 07:07:55 -0400] axyelp: what action should i use if i wish to copy a cookbook_file to some location
[2013-05-30 07:08:44 -0400] spheromak: realityforge If that seems to be whats happening can you add your info to the ticket, and If possible supply the info to re-create. I hit it in a project that i was working on, and when I figured out what was up I moved on. I just noticed that they were un-able to reproduce the issue to debug :\
[2013-05-30 07:09:17 -0400] spheromak: axyelp that wil be the default action of :create ibelive (you don't have to specify it)
[2013-05-30 07:29:07 -0400] axyelp1: spheromak: oh! thanks! was using create_if_missing with 'file' method.
[2013-05-30 07:30:42 -0400] spheromak: well create_if_missing will do the same thing but only iff the destination file is missing
[2013-05-30 08:04:59 -0400] novatech1: hullo
[2013-05-30 08:12:17 -0400] axyelp1: i'm hitting ERROR: OpenSSL::SSL::SSLError: SSL_connect SYSCALL returned=5 errno=0 state=SSLv2/v3 read server hello A
[2013-05-30 08:12:17 -0400] axyelp1: on just one particular cookbook upload!
[2013-05-30 08:16:20 -0400] laurent\: qtop
[2013-05-30 08:16:29 -0400] laurent\: oops, sorry :)
[2013-05-30 08:22:44 -0400] isbaran: that redirect problem in chefs 11 is killing me, anyone got it working on ec2 ?
[2013-05-30 08:54:23 -0400] coderanger: [2013-05-30T01:54:17-07:00] DEBUG: Haldo from Python
[2013-05-30 08:54:27 -0400] coderanger: And with that, I sleep
[2013-05-30 10:03:12 -0400] jedi4ever: just a quick sanity question: if you run chef-solo with loglevel info,
[2013-05-30 10:03:29 -0400] jedi4ever: should it output the processing? even if it's not doing anything on a resource?
[2013-05-30 10:42:45 -0400] grant2: is it possible to call notify in a resource and have the target be a recipe rather than a given individual resource?
[2013-05-30 10:43:36 -0400] grant2: e.g. notifies :run, "recipe[blah::app_restart]"
[2013-05-30 10:48:15 -0400] meineerde: grant2: no, you can only notify individial resources. however, you could change the contents of your recipe into an LWRP which then can be notified as a regular resource
[2013-05-30 10:49:17 -0400] kreisys: hey.. what's the best way to update all my chef-clients to the latest version?
[2013-05-30 10:49:32 -0400] grant2: meineerde: got it. thx
[2013-05-30 11:17:05 -0400] aruntomar: kreisys: r u using omnibus?
[2013-05-30 11:37:24 -0400] leonard: Hi there !
[2013-05-30 11:38:23 -0400] leonard: I can't find any cron entry in /etc/crontab after running a recipe using the cron resource
[2013-05-30 11:40:30 -0400] admin0: hi all
[2013-05-30 11:40:49 -0400] admin0: is it possible to de-bootstrap so that all things done by chef is automaitically deleted and the node can be bootstrapped again
[2013-05-30 11:41:53 -0400] leonard: test
[2013-05-30 11:42:11 -0400] leonard: exit
[2013-05-30 11:42:12 -0400] leonard: exit
[2013-05-30 11:44:10 -0400] CaptainQuirk: Hi ...
[2013-05-30 11:44:18 -0400] CaptainQuirk: Like I said, problem with the cron resource
[2013-05-30 11:45:59 -0400] CaptainQuirk: did my previous message appear ?
[2013-05-30 11:57:29 -0400] stormerider: if you were leonard before yes
[2013-05-30 12:03:58 -0400] stormerider: i'd look in /etc/cron.d instead
[2013-05-30 12:09:57 -0400] zaargy: if i am creating a wrapper cookbook on top of an opcode cookbook and i need to override a package resource to specify some extra params, is that possible?
[2013-05-30 12:16:52 -0400] kreisys: aruntomar: I use knife bootstrap.. I have a bunch of nodes running different versions of chef-client and I want to get them all to 11.4+
[2013-05-30 12:22:42 -0400] CaptainQuirk: stormerider, I have nothing under /etc/cron.d but anacron
[2013-05-30 12:27:36 -0400] Dynom: Hi, I've updated Chef to 11.4 (I was on 10.x) and now recipes complain about missing recipes. Such as "runit", "yum" and "windows". Any pointers in the right direction are appreciated
[2013-05-30 12:46:16 -0400] siezer: Dynom you make sure your cookbook metadata uses the "depends" directive where appropriate
[2013-05-30 12:47:19 -0400] siezer: chef 10 used to not care, so long as the appropriate cookbooks were already loaded into the chef-client, chef11 enforces the metadata constraints so things work with depensency solvers
[2013-05-30 12:49:15 -0400] Dynom: siezer; I see
[2013-05-30 12:49:53 -0400] suresh: Hello, Can we have Chef server and workstation on one system
[2013-05-30 12:51:05 -0400] Dynom: siezer; I'm re-using existing cookbooks. I just switched to Chef 11 for a certain cookbook (ark) to work. Now I suddenly need a bunch more cookbooks, it's a bit akward. Especially 'Yum' since I don't use any distribution that use Yum as packagemanager. I'll just add the cookbooks and see where I'll end up
[2013-05-30 12:51:25 -0400] Dynom: siezer; thanks for the info :-)
[2013-05-30 12:52:27 -0400] siezer: Dynom ah. try using berkshelf as a cookbook manager to do that dep resolution for you automatically
[2013-05-30 12:53:00 -0400] siezer: also, when you see a cookbook depending on something you don't use (like yum, windows, openssl, etc), it only means that the cookbook support it. not necessarily uses it
[2013-05-30 12:53:19 -0400] siezer: the "library cookbook" pattern if you will
[2013-05-30 12:53:19 -0400] Dynom: siezer; perhaps, but it's currently b0rking on a missing dep such as "Yum"
[2013-05-30 12:53:40 -0400] Dynom: I just installed libarian-chef, is that any good?
[2013-05-30 12:53:45 -0400] Dynom: ( I use chef-solo btw )
[2013-05-30 12:53:46 -0400] siezer: right. like I said, use a cookbook manager
[2013-05-30 12:53:50 -0400] siezer: berkshelf is better imho
[2013-05-30 12:53:59 -0400] Dynom: ok, will check that one out also then. Thanks
[2013-05-30 12:54:19 -0400] siezer: no prob!
[2013-05-30 13:02:47 -0400] admin0: hi .. how do I get the default gateway under node in chef template ..  ..  for ipaddress i use  node[:ipaddress] .. .. but default gateway is inside network
[2013-05-30 13:03:21 -0400] ctennis: admin0   node[:network][:default_gateway]
[2013-05-30 13:03:35 -0400] admin0: ctennis,  ..thank you
[2013-05-30 13:47:43 -0400] morr_: having issues uploading the getting started cookbook. Used '-VV' shows a timeout midway through: INFO: Uploading /home/morr/Development/chef-repo/cookbooks/apache2/templates/default/mods/mime.conf.erb (checksum hex = 70aded22e5640b4b01d9acc61db4f781) to https://s3-external-1.amazonaws.com/opscode-platform-production-data/organization-17ec35d5b83d47c2b5babfd64b7503c6/sandbox-676b905ff3344d9fb335e701910944e9/checksum-70aded22e5640b4b01d9acc
[2013-05-30 13:47:49 -0400] morr_: any thoughts?
[2013-05-30 13:51:48 -0400] HAPPYFUNBALL_: how would I go about determining whether if a specific package is installed on a node?
[2013-05-30 13:54:49 -0400] isbaran: HAPPYFUNBALL_: use package resource, it won't install if already installed
[2013-05-30 13:55:24 -0400] HAPPYFUNBALL_: is there any way to determine whether if a package is installed though?
[2013-05-30 13:55:58 -0400] isbaran: what is your exact use case ? do you need this check in recipe ?
[2013-05-30 13:57:35 -0400] HAPPYFUNBALL_: basically, I want to check if a package exists on a node. if the package exists, I want to check its version. if it's version matches a specific number (or is less than said number), I want to upgrade
[2013-05-30 13:57:43 -0400] isbaran: http://docs.opscode.com/chef/resources.html search for "An anti-pattern"
[2013-05-30 13:58:07 -0400] isbaran: HAPPYFUNBALL_: you can do this with package resource
[2013-05-30 13:58:43 -0400] HAPPYFUNBALL_: ok
[2013-05-30 14:00:40 -0400] HAPPYFUNBALL_: will chef install a package on a new node if I specify upgrade in my code?
[2013-05-30 14:01:49 -0400] isbaran: HAPPYFUNBALL_: provide a version, if its not installed or not at that version, it should install it
[2013-05-30 14:02:22 -0400] isbaran: also check the docs first pls http://docs.opscode.com/resource_package.html
[2013-05-30 14:13:57 -0400] afaundez: Hi. Is there any limitation to execute "package" within a custom provider action? I'm trying to install 'bulid-essentials', but the line is silently skipped.
[2013-05-30 14:23:43 -0400] afaundez: I've found thaht the problem was that a chef_gem after the package was executing before the package install. Adding package('build-essential').run_action(:install) worked for me.
[2013-05-30 14:27:16 -0400] cwj: afaundez: the build-essential cookbook also tries to handle that case by exposing a node['build_essential']['compiletime'] attribute
[2013-05-30 14:27:37 -0400] cwj: so you set the value of that attribute to true, and the cookbook will install the build essentials for your platform at compile time
[2013-05-30 14:27:38 -0400] cwj: fwiw
[2013-05-30 14:28:25 -0400] afaundez: Thanks cwj, I will try that option too.
[2013-05-30 14:40:16 -0400] kreisys: Is there a way to retrieve the version of an installed package in a recipe? In case I need to generate different configurations for different versions for example
[2013-05-30 14:49:34 -0400] jtgiri_: kreisys: you get that information from ohai, for example node['php']['version'] should give you the version installed on the node
[2013-05-30 14:52:41 -0400] kreisys: jtgiri_: it doesn't seem to be the case with redis :/
[2013-05-30 14:55:03 -0400] jujugre: Hello there. I'm trying to to run a bash script on chef only if a bash cmd succeed. However I don;t have the same result from bash than from chef.
[2013-05-30 14:55:08 -0400] jujugre: Here is the output
[2013-05-30 14:55:09 -0400] jujugre: Skipping bash[Kill tomcat if still running with openjdk] due to only_if command `readlink /proc/$(pgrep -f tomcat)/exe | grep openjdk`
[2013-05-30 14:55:35 -0400] jujugre: readlink /proc/$(pgrep -f tomcat)/exe | grep openjdk is working well on a shell, but chef doesn't seem to like the $() or even ``
[2013-05-30 14:56:00 -0400] jujugre: if I do that on chef "readlink /proc/9999/exe" then it works well
[2013-05-30 14:56:30 -0400] jujugre: Do you have any idea how to tell chef to let the bash interpret $() ?
[2013-05-30 15:03:00 -0400] isbaran: jujugre: why not use ruby code instead ? I'd try with ruby block there
[2013-05-30 15:04:53 -0400] jujugre: isbaran: I think it's because I know more bash than ruby ;-), how simple is it to do that in ruby? prep + check symlink value?
[2013-05-30 15:06:14 -0400] cwj: jujugre: is your bash command inside backticks or inside quotes?
[2013-05-30 15:06:22 -0400] isbaran: jujugre: are you using tomcat cookbook ? i mean it could have a service status check, instead of grepping ps you can use that i guess
[2013-05-30 15:06:29 -0400] cwj: maybe you could gist your recipe
[2013-05-30 15:07:00 -0400] jujugre: only_if "readlink /proc/`pgrep -f tomcat`/exe | grep openjdk"
[2013-05-30 15:07:10 -0400] jujugre: isbaran: there is a bug in the tomcat cookbook
[2013-05-30 15:07:19 -0400] jujugre: when you use oracle java
[2013-05-30 15:07:48 -0400] jujugre: https://github.com/opscode-cookbooks/tomcat/pull/15
[2013-05-30 15:07:51 -0400] jujugre: See my comment :-)
[2013-05-30 15:08:26 -0400] jujugre: the cookbook is really nice, just a weird condition with ubuntu tomcat6 depency
[2013-05-30 15:08:31 -0400] aruntomar: kreisys: use cookbook "omnibus_updater"
[2013-05-30 15:08:45 -0400] jujugre: cwj: only_if "readlink /proc/`pgrep -f tomcat`/exe | grep openjdk"
[2013-05-30 15:10:11 -0400] cwj: jujugre: hrm ok. that seems like it could work
[2013-05-30 15:10:13 -0400] kreisys: aruntomar: looks like it's exactly what I was looking for. thanks!
[2013-05-30 15:10:19 -0400] BryanWB: anybody used the busser-serverspec plugin? https://github.com/cl-lab-k/busser-serverspec
[2013-05-30 15:10:24 -0400] cwj: maybe the backticks need to be escaped inside the string
[2013-05-30 15:10:38 -0400] jujugre: I've tried that as well
[2013-05-30 15:10:44 -0400] jujugre: only_if "readlink /proc/\$\(pgrep -f tomcat\)/exe | grep openjdk"
[2013-05-30 15:11:04 -0400] isbaran: is the default interpreter bash or dash ? backticks could cause problem in dash if i remember correctly
[2013-05-30 15:11:31 -0400] aruntomar: kreisys: we are using this cookbook. works well. fyi, knife bootstrap by default install chef using omnibus packages
[2013-05-30 15:11:53 -0400] jujugre: isbaran: I'm using the resource called bash
[2013-05-30 15:12:08 -0400] jujugre: not script, so it should use bash
[2013-05-30 15:12:36 -0400] isbaran: jujugre: yep, but chef uses dash, i saw it today while deploying, just keep it in mind
[2013-05-30 15:12:37 -0400] cwj: the only_if might not be executed in the same context as the command for the bash resource
[2013-05-30 15:12:48 -0400] jujugre: A cheers
[2013-05-30 15:12:51 -0400] kreisys: aruntomar: yeah I know it does now but not sure it's always been the case and I have a lot of instances bootstrapped with older versions of knife. this cookbook seems like it's supposed to handle it.
[2013-05-30 15:12:55 -0400] jujugre: I'm trying with xargs ;-)
[2013-05-30 15:13:42 -0400] kreisys: and I should really start using punctuation :>
[2013-05-30 15:14:02 -0400] jujugre: I've tried to escape backticks same result :-)
[2013-05-30 15:15:45 -0400] isbaran: jujugre: you sure pgrep returns one process ? that is nasty if it does multiple
[2013-05-30 15:16:38 -0400] jujugre: I know but I was not clever enough to find something better
[2013-05-30 15:16:49 -0400] isbaran: jujugre: also that thing you pasted is flawed
[2013-05-30 15:16:58 -0400] jujugre: the tomcat init script does a loop on all the possible JVM and take the first one
[2013-05-30 15:17:10 -0400] isbaran: you should put an echo or sth before readlink
[2013-05-30 15:21:49 -0400] HAPPYFUNBALL_: YO
[2013-05-30 15:21:51 -0400] HAPPYFUNBALL_: MOTHERFUCKERS
[2013-05-30 15:23:03 -0400] isbaran: jujugre: [ "/usr/sbin/haproxy" = $(readlink /proc/`pgrep -f haproxy`/exe) ]
[2013-05-30 15:23:34 -0400] jujugre: isbaran: Thanks, where should I put that?
[2013-05-30 15:23:47 -0400] isbaran: jujugre: only_if i guess
[2013-05-30 15:23:57 -0400] isbaran: replace your binary thouh :)
[2013-05-30 15:24:07 -0400] jujugre: I've done that and it worked : only_if "pgrep -f tomcat | xargs -I {} readlink /proc/{}/exe | grep openjdk"
[2013-05-30 15:24:32 -0400] jujugre: only_if [ "/usr/sbin/haproxy" = $(readlink /proc/`pgrep -f haproxy`/exe) ]
[2013-05-30 15:24:39 -0400] jujugre: let me do it we your test
[2013-05-30 15:25:07 -0400] isbaran: jujugre: you can't pipe readlink to grep, that was wrong in your previous post
[2013-05-30 15:25:55 -0400] jujugre: isbaran: why do you mean by I can't ? it's not clean or it doesn't work?
[2013-05-30 15:32:47 -0400] jujugre: It works well
[2013-05-30 15:32:52 -0400] jujugre: Thanks guys :-)
[2013-05-30 15:33:07 -0400] isbaran: jujugre: that is weird  readlink -- /proc/"$(pgrep -f haproxy)"/exe | grep "haprox" works but if i grep "haproxy" it fails
[2013-05-30 15:33:28 -0400] jujugre: isbaran: weird indeed
[2013-05-30 15:33:46 -0400] isbaran: jujugre: why is that
[2013-05-30 15:33:47 -0400] jujugre: what does /proc/"$(pgrep -f haproxy)"/exe return
[2013-05-30 15:33:59 -0400] jujugre: readlink /proc/"$(pgrep -f haproxy)"/exe I mean
[2013-05-30 15:34:12 -0400] isbaran: /usr/sbin/haproxy
[2013-05-30 15:38:03 -0400] isbaran: jujugre: also note that readlink fails silently if it doesnt have permissions to read
[2013-05-30 15:38:26 -0400] isbaran: so you should also put a user => attribute there just in case
[2013-05-30 15:38:52 -0400] jujugre: is the only_if not run as root?
[2013-05-30 15:39:43 -0400] BryanWB: spheromak: have u tried that busser-serverspec plugin?
[2013-05-30 15:41:29 -0400] isbaran: jujugre: yes, its not important in that case, can you try that grep i pasted ?
[2013-05-30 15:42:04 -0400] isbaran: jujugre: readlink -- "/proc/$(pgrep -f kopete)/exe" | grep "kopet"
[2013-05-30 15:42:14 -0400] isbaran: this works for example, but grepping kopete returns 1
[2013-05-30 15:44:05 -0400] isbaran: something is going on with subshell and grep dont know what it is
[2013-05-30 15:44:31 -0400] jujugre: I don;t have kopek. but for me everything work
[2013-05-30 15:44:43 -0400] jujugre: readlink -- "/proc/$(pgrep -f tomcat)/exe" | grep "/usr/lib/jvm/jdk1.6.0_45/bin/java"
[2013-05-30 15:44:44 -0400] jujugre: /usr/lib/jvm/jdk1.6.0_45/bin/java
[2013-05-30 15:44:44 -0400] jujugre: readlink -- "/proc/$(pgrep -f tomcat)/exe" | grep "java"
[2013-05-30 15:44:45 -0400] jujugre: /usr/lib/jvm/jdk1.6.0_45/bin/java
[2013-05-30 15:45:04 -0400] isbaran: jujugre: which distro is this
[2013-05-30 15:45:13 -0400] jujugre: Ubuntu precise LTS
[2013-05-30 15:45:42 -0400] jujugre: Ubuntu 12.04.2 LTS
[2013-05-30 15:49:55 -0400] isbaran: jujugre: not sure, maybe pgrep is putting a line end at the end it all acts strange on my system, i even tested on fresh instance
[2013-05-30 15:50:30 -0400] jujugre: what about that
[2013-05-30 15:50:49 -0400] jujugre: pgrep -f kopete | xargs -I {} readlink /proc/{}/exe | grep kopete
[2013-05-30 15:50:54 -0400] isbaran: readlink -- /proc/$(pgrep -f kopete)/exe | grep kopete
[2013-05-30 15:50:54 -0400] isbaran: readlink: extra operand `30409/exe'
[2013-05-30 15:51:08 -0400] isbaran: that on works
[2013-05-30 15:51:14 -0400] isbaran: with xargs
[2013-05-30 15:52:29 -0400] isbaran: that is why you should never use tools like these :) that are not intented to use like some kind of api, they are just printing out garbage
[2013-05-30 15:52:40 -0400] jujugre: :-)
[2013-05-30 15:53:18 -0400] isbaran: like parsing ps output etc. whatever, i gotto go, see you
[2013-05-30 15:53:29 -0400] jujugre: For now I need a fix because it avoid me to autoscale on AWS priorly. But i'd be happy to do something better and to do a pull request
[2013-05-30 15:53:41 -0400] jujugre: isbaran: see you, thanks again for your help!
[2013-05-30 15:53:54 -0400] isbaran: jujugre: thank you too, see you around
[2013-05-30 16:02:41 -0400] alex88: hi guys is there a way to compile a template into a string instead of writing to file?
[2013-05-30 16:05:01 -0400] RJ2: this really needs merging: http://tickets.opscode.com/browse/CHEF-3910?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel
[2013-05-30 16:05:25 -0400] RJ2: I haven't had to use `expect` in years.. but i think i need to in order to automate some stuff with the current chef
[2013-05-30 16:05:46 -0400] spheromak: BryanWB no I haven't  I just found it, and I saw Adams rspec one as well.
[2013-05-30 16:20:28 -0400] juliancdunn: RJ2: needs tests
[2013-05-30 16:21:04 -0400] juliancdunn: user has signed the CLA now though, so once the test is written he can transition it to 'fix provided'
[2013-05-30 16:21:15 -0400] caryp: I have a ruby_block that calculates a value which I want to use in another, say 'mount', resource.  Is there a documented way or best practice on how to do this?
[2013-05-30 16:23:02 -0400] RJ2: juliancdunn: yeah.. not my call, but insisting on tests for that patch is overkill imo
[2013-05-30 16:23:32 -0400] ambz: hi all, i learning to use knife, have a question: i want to emit two attributes at once from 'knife search node'
[2013-05-30 16:23:38 -0400] ambz: i wanted to do something like this: knife search node "chef_environment:production AND name:i-7a421114" -a cloud.local_hostname -a cloud.public_hostname
[2013-05-30 16:23:52 -0400] ambz: any idea how this could be achieved?
[2013-05-30 16:24:20 -0400] matti: How do I replace node.default['x']['y'] = 'bazinga' in Chef 10 to smae thing in Chef 11? My template is not picking change set this way in Chef 11.
[2013-05-30 16:24:50 -0400] rava: node.set
[2013-05-30 16:25:36 -0400] matti: rava: Does not work either.
[2013-05-30 16:26:02 -0400] rava: matti: where are you setting it and what code isn't seeing it?
[2013-05-30 16:26:25 -0400] matti: In a recipe, where is true and in ERB is false.
[2013-05-30 16:26:31 -0400] matti: Works fine in 10.
[2013-05-30 16:26:50 -0400] rava: in ERB?
[2013-05-30 16:27:02 -0400] matti: Yes, in ERB.
[2013-05-30 16:27:04 -0400] ambz: anyone have any suggestions?
[2013-05-30 16:27:45 -0400] rava: take a look at this page: http://www.opscode.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/
[2013-05-30 16:30:08 -0400] ambz: @rava: so basically i can't do this with a simple knife command, and will have to write a recipe?
[2013-05-30 16:30:30 -0400] rava: ambz: sorry what?
[2013-05-30 16:30:34 -0400] rava: ambz: that link was for matti
[2013-05-30 16:30:44 -0400] ambz: oh
[2013-05-30 16:30:51 -0400] ambz: i wanted to do something like this: knife search node "chef_environment:production AND name:i-7a421114" -a cloud.local_hostname -a cloud.public_hostname
[2013-05-30 16:30:53 -0400] rava: ambz: what are you running into?
[2013-05-30 16:31:16 -0400] ambz: i want both attributes in one knife command
[2013-05-30 16:32:12 -0400] bearrito: How does one utilize the Deploy resource with a  git deploy key? I know there is an attribute for the Application resource, but none for deploy.
[2013-05-30 16:33:20 -0400] jamo: when i try to run knife ... something it says that it finds the node(s) but it doesn't have the attribute(fqdn), i've tried having it use other attributes such as ipaddress and it does the same. if i run a show of the node it has the fqdn and ipaddress attributes populated correctly. any ideas?
[2013-05-30 16:34:59 -0400] matti: rava: I see what is going on.
[2013-05-30 16:35:11 -0400] rava: ambz: your best bet is likely going to be a simple knife plugin
[2013-05-30 16:35:29 -0400] matti: rava: I have foo = { :x => node['x'] } which I pass later to template resource as variables.
[2013-05-30 16:35:30 -0400] rava: ambz: -a only returns the last flag/attribute label it sees
[2013-05-30 16:35:53 -0400] matti: rava: In 10 it works fine, in 11 the old value is there in the hash.
[2013-05-30 16:36:08 -0400] ambz: rava: could you please give me a link or further pointers?
[2013-05-30 16:36:20 -0400] matti: rava: I thought that Ruby passes everything by reference, so where do they call .clone or something.
[2013-05-30 16:36:47 -0400] rava: matti: ruby never seems to comply with what i think is happening >.>
[2013-05-30 16:36:48 -0400] ambz: i'm a total n00b at knife/chef...
[2013-05-30 16:36:59 -0400] matti: rava: ?
[2013-05-30 16:37:17 -0400] rava: though it could be because i only touch it when i have to do something in chef
[2013-05-30 16:37:32 -0400] matti: rava: This has nothing to do with Ruby. Same Ruby, different Chef and it breaks 10 vs 11.
[2013-05-30 16:37:35 -0400] rava: ambz: this should get you started, http://docs.opscode.com/plugin_knife_custom.html
[2013-05-30 16:38:22 -0400] rava: ambz: anything more complicated than getting a return of N attributes from a node search will require your own google fu ;)
[2013-05-30 16:39:17 -0400] rava: matti: my bad, i misread and thought you were talking about using the values in a ruby script or some such out of chef
[2013-05-30 16:39:58 -0400] ambz: rava: thank you!
[2013-05-30 16:42:03 -0400] rava: ambz: no sweat. give 3 months and a deadline to get something out the door and you'll learn ;)
[2013-05-30 16:42:14 -0400] matti: Hm, how does this worked before.
[2013-05-30 16:42:15 -0400] matti: ;d
[2013-05-30 16:43:18 -0400] matti: Ah,OK I see.
[2013-05-30 16:46:15 -0400] BryanWB: spheromak: argh, it almost works
[2013-05-30 16:46:26 -0400] BryanWB: and i don't have to time to improve it, back to bats i guess
[2013-05-30 16:47:16 -0400] matti: rava: My fault actually.
[2013-05-30 16:47:25 -0400] matti: rava: But .set works, so thanks :)
[2013-05-30 16:49:30 -0400] BryanWB: spheromak: btw Pry.rescue do ... end is the bomb
[2013-05-30 16:52:07 -0400] rava: matti: nice
[2013-05-30 16:55:54 -0400] djstunami: Anyone know if partial search is supported on the newest open source Chef server?
[2013-05-30 16:58:57 -0400] madteckhead: Hey devops, I'm looking for a freelancer to audit and improve our deployment setup. Where should I look?
[2013-05-30 16:59:07 -0400] madteckhead: Tried elance and twitter without much luck
[2013-05-30 16:59:15 -0400] rava: linkedin?
[2013-05-30 16:59:35 -0400] alex88: hi guys is there a way to compile a template into a string instead of writing to file?
[2013-05-30 16:59:39 -0400] Cope: madteckhead: you could ask me :)
[2013-05-30 16:59:43 -0400] madteckhead: good idea i guess i should just pay for a premoim account abit annotying
[2013-05-30 16:59:49 -0400] BryanWB: madteckhead: send a message to the chef ml, u should get a # of responses
[2013-05-30 17:00:02 -0400] BryanWB: or hire Cope, he's a very smart guy ;)
[2013-05-30 17:00:04 -0400] madteckhead: awesome cope thanks bryan
[2013-05-30 17:00:08 -0400] matti: alex88: You can do it yourself.
[2013-05-30 17:00:09 -0400] madteckhead: cool
[2013-05-30 17:00:10 -0400] djstunami: madteckhead: oDesk ?
[2013-05-30 17:00:10 -0400] madteckhead: :)
[2013-05-30 17:00:21 -0400] matti: alex88: But why would you do it?
[2013-05-30 17:00:24 -0400] madteckhead: i prefer elance, but no dice
[2013-05-30 17:00:46 -0400] BryanWB: u won't find ppl w/ devops knowlege on elance or odesk, ppl w/ devops knowledge are probably too expensive and highly sought
[2013-05-30 17:00:46 -0400] madteckhead: I've done it myself, but its hard to audit your own work
[2013-05-30 17:00:48 -0400] madteckhead: :)
[2013-05-30 17:01:16 -0400] madteckhead: yeah, i figured that and contected some via twitter bio searches, they were busy
[2013-05-30 17:01:26 -0400] alex88: matti: you mean compiling the erb directly? btw, because we've a config file we want to keep in the application source, but add something within the chef recipe
[2013-05-30 17:01:26 -0400] madteckhead: okay ill talk to cope off list, thanks
[2013-05-30 17:01:35 -0400] alex88: so we don't have to edit the same file in 2 places
[2013-05-30 17:01:52 -0400] alex88: matti: makes sense?
[2013-05-30 17:04:55 -0400] HAPPYFUNBALL_: what do I need to do to add a custom (non-default) repository for a certain OS?
[2013-05-30 17:05:35 -0400] Cope: HAPPYFUNBALL_: there are LWRPs for apt and yum
[2013-05-30 17:05:40 -0400] Cope: check the apt and yum cookbooks
[2013-05-30 17:10:17 -0400] jbz: A question, folks.  Using an example somewhere on the Opscode site, I've been checking what platform I'm running on within a recipe using something like "if platform?("ubuntu")".  Is this correct?  If so, where is that defined, is that a chef function?
[2013-05-30 17:11:29 -0400] jbz: If it's not, how should I be testing what I'm running on?
[2013-05-30 17:12:31 -0400] stormerider: jbz: that's probed by ohai
[2013-05-30 17:12:45 -0400] jbz: ah, so that's an attribute it's checking?
[2013-05-30 17:12:49 -0400] Cope: jbz: it comes from 'ohai' - which profiles your machine and returns a bunch of handy info
[2013-05-30 17:12:52 -0400] Cope: right
[2013-05-30 17:13:01 -0400] jbz: and the 'platform' call is something chef provides?
[2013-05-30 17:13:29 -0400] Cope: yeah, it's a convenience method which looks at the node attributes populated by ohai
[2013-05-30 17:13:34 -0400] jbz: thanks!
[2013-05-30 17:17:58 -0400] matti: wlll: ;]
[2013-05-30 17:18:17 -0400] matti: wlll: I've noticed.
[2013-05-30 17:24:36 -0400] coderanger: Python folks: which of these looks better to you http://hastebin.com/qubucakewa.py
[2013-05-30 17:28:43 -0400] ponyofdeath: does foodcritic check for syntax errors?
[2013-05-30 17:29:42 -0400] coderanger: ponyofdeath: Some, but there is also a knife cookbook syntax checker already
[2013-05-30 17:29:53 -0400] ponyofdeath: coderanger: ok thanks!
[2013-05-30 17:30:36 -0400] coderanger: ponyofdeath: knife cookbook test I think
[2013-05-30 17:31:43 -0400] ponyofdeath: coderanger: is it possible to specify an FS path
[2013-05-30 17:31:47 -0400] ponyofdeath: instead of just cookbook name
[2013-05-30 17:31:55 -0400] coderanger: ponyofdeath: Probably not
[2013-05-30 17:32:12 -0400] coderanger: But if you have the path you can just use `ruby -c`
[2013-05-30 17:32:24 -0400] coderanger: That won't check templates, but template syntax checks are pretty minimal anyway
[2013-05-30 17:32:59 -0400] stormerider: coderanger: when you're using cookbook_file / template, can you use subdirectories? like files/default/something/file.txt?
[2013-05-30 17:33:13 -0400] coderanger: stormerider: yep
[2013-05-30 17:33:47 -0400] stormerider: thanks. ive kept forgetting to ask about that, i need to clean up one of my cookbooks... the files directory is getting disorganized, heh
[2013-05-30 17:39:40 -0400] spheromak: BryanWB  :D  pry is the bomb
[2013-05-30 17:46:28 -0400] Cope: coderanger: i prefer the first; but I might be too ruby-polluted now to count as a python person any more
[2013-05-30 17:50:28 -0400] stormerider: jtimberman: so i have conflicting comments on COOK-3014, do you folks want me to revert the AND change, or? im not sure who the authoritative decision maker is on this :)
[2013-05-30 17:57:37 -0400] deviosity: Is there a way to get erchef or bookshelf to properly restart? Anytime either of these restart they end up in a terminating immediately.
[2013-05-30 17:58:54 -0400] deviosity: The only way to get this to start up properly is a complete reboot of the server, which is far from ideal.
[2013-05-30 17:59:50 -0400] coderanger: deviosity: How are you restarting them?
[2013-05-30 18:00:04 -0400] deviosity: with chef-server-ctl
[2013-05-30 18:00:14 -0400] coderanger: That should be working, what OS are you on?
[2013-05-30 18:00:22 -0400] deviosity: ubuntu 12.04
[2013-05-30 18:00:28 -0400] coderanger: and/or what is logged when they terminate
[2013-05-30 18:01:47 -0400] deviosity: https://gist.github.com/anonymous/5679803
[2013-05-30 18:01:57 -0400] deviosity: I can't decipher the erlang logs
[2013-05-30 18:02:35 -0400] deviosity: perhaps it is the protocol register error
[2013-05-30 18:07:52 -0400] coderanger: deviosity: That means it can't bind to the port because something is still listening
[2013-05-30 18:08:03 -0400] coderanger: deviosity: Make sure that you don't have orphaned procs
[2013-05-30 18:11:30 -0400] deviosity: nothing on port 4321
[2013-05-30 18:11:36 -0400] deviosity: is there a hidden port it uses?
[2013-05-30 18:16:04 -0400] deviosity: is there a log file for epmd?
[2013-05-30 18:16:17 -0400] CharlieSu: Anyone see a reason why the apt cookbook isn't working for me here?  https://gist.github.com/CharlieSu/fe061aac93fab96f00cc
[2013-05-30 18:16:42 -0400] timsmith: what version of chef are you on
[2013-05-30 18:16:49 -0400] timsmith: and what version of apt cookbook
[2013-05-30 18:17:38 -0400] CharlieSu: apt (1.10.0)     10.14.2
[2013-05-30 18:17:54 -0400] timsmith: is that in why run mode
[2013-05-30 18:18:14 -0400] CharlieSu: I'm using Berkshelf/Vagrant
[2013-05-30 18:18:42 -0400] timsmith: I've had some very similar errors with the apt cookbook with chef 10.X
[2013-05-30 18:18:48 -0400] timsmith: but only in why-run
[2013-05-30 18:19:05 -0400] timsmith: http://tickets.opscode.com/browse/COOK-2258
[2013-05-30 18:19:09 -0400] CharlieSu: what is why-run ?
[2013-05-30 18:19:12 -0400] cwj: there seem to be a number of cookbooks which need chef ~> 10.18.0
[2013-05-30 18:19:26 -0400] timsmith: that was going to be the other thing I was going to suggest
[2013-05-30 18:19:36 -0400] timsmith: you probably want to upgrade to the latest 10.X release
[2013-05-30 18:19:42 -0400] justizin: CharlieSu: i was wondering the same thing myself a little while ago..
[2013-05-30 18:20:08 -0400] timsmith: why run mode shows you what chef would do
[2013-05-30 18:21:06 -0400] justizin: how can i troubleshoot a cookbook just not seeming to be changed? i've removed the files in /var/cache/apt/cookbooks/my-cookbook, done fresh berks upload, and the traceback i'm seeing has lines that i've removed.. any thoughts?
[2013-05-30 18:24:23 -0400] cwj: justizin: have you checked the node's environment to ensure it isn't locked to the old version of the cookbook?
[2013-05-30 18:24:37 -0400] justizin: it's in _default, everything is in _default right now
[2013-05-30 18:24:41 -0400] justizin: that was one of the first things i thought
[2013-05-30 18:24:47 -0400] matti: How do you guys test defines?
[2013-05-30 18:31:15 -0400] Cope: justizin: i think there's a bug with berks upload
[2013-05-30 18:31:54 -0400] Cope: justizin: you'll need to either blow away the .berkshelf/cookbook-x.y.z directory and then berk install again and then upload; or upload with knife
[2013-05-30 18:36:40 -0400] stormerider: justizin: i believe that's fixed in berks 2.0.0.beta
[2013-05-30 18:36:56 -0400] justizin: ah-ho
[2013-05-30 18:37:06 -0400] justizin: brilliant!
[2013-05-30 18:37:44 -0400] stormerider: specifically i know git tracking for berks is adjusted in 2.x
[2013-05-30 18:38:21 -0400] justizin: bumping the version oughta do it as well, yes?
[2013-05-30 18:38:32 -0400] stormerider: *nod*
[2013-05-30 18:39:09 -0400] justizin: anyone have great notes on CI pipeline? we had a nice setup at gap, but i'm starting from scratch here. :)
[2013-05-30 18:39:35 -0400] justizin: i had a good habit of bumping the version, because that's the only way we could get changes out
[2013-05-30 18:41:33 -0400] stormerider: i havent gotten that far yet myself :) but im looking to tie mine in with maven + bamboo
[2013-05-30 18:43:40 -0400] jchauncey: if my recipe sets up a yum repo and i want to test that those attributes get properly setup using ChefSpec does anyone know how to get them to actually converge?
[2013-05-30 18:45:21 -0400] jchauncey: i tried telling chefspec to :step_into the yum_repository and yum_key but those attributes arnt actually set for the converged node
[2013-05-30 18:48:20 -0400] stormerider: justizin: the chef survival guide has info on setting up CI with Travis, btw
[2013-05-30 18:53:33 -0400] geekbri: Can you load an entire encrypted data bag in the same way you can load an entire unencrypted one?
[2013-05-30 18:54:33 -0400] geekbri: My guess is no.
[2013-05-30 18:56:14 -0400] justizin: stormerider : right on, i have it talking to jenkins, i'm just trying to determine what should be run.. looking at cucumber-chef..
[2013-05-30 18:56:43 -0400] stormerider: justizin: i'd suggest foodcritic as well
[2013-05-30 18:56:50 -0400] justizin: yah i'm doing that
[2013-05-30 18:56:55 -0400] stormerider: :)
[2013-05-30 18:57:38 -0400] justizin: right now actually what i'm fighting with is, i'm trying to install foodcritic on my jenkins build node as chef_gem, and that's failing because of dependencies that i need to install during compile phase, and i was having trouble getting berks to upload the cookbook
[2013-05-30 18:58:46 -0400] stormerider: heh, yeah, i havent gotten that far myself
[2013-05-30 18:59:04 -0400] stormerider: im just running those kind of tools locally on my workstation right now
[2013-05-30 18:59:30 -0400] justizin: so, does berks care what is in git?
[2013-05-30 18:59:48 -0400] justizin: it feels like i just fixed a recipe being missing by git add-ing the file
[2013-05-30 18:59:50 -0400] stormerider: what do you mean?
[2013-05-30 19:00:06 -0400] justizin: just, different from what i'd expect with knife cookbook upload
[2013-05-30 19:00:29 -0400] stormerider: what's the source you have in your Berksfile for the cookbook?
[2013-05-30 19:01:09 -0400] justizin: que?
[2013-05-30 19:01:32 -0400] stormerider: where is berks pulling the cookbook from?
[2013-05-30 19:01:42 -0400] justizin: the current directory?
[2013-05-30 19:01:53 -0400] justizin: CWD = ~/chef/cookbooks/my-cookbook/
[2013-05-30 19:01:57 -0400] justizin: and i 'berks upload'
[2013-05-30 19:02:17 -0400] stormerider: ah, i havent done that. mine are all pointed at either the opscode community site or my own specific git repos
[2013-05-30 19:02:35 -0400] justizin: i just added a recipe ~/chef/cookbooks/my-cookbook/cookbooks/something.rb, added my-cookbook::something to a run_list, and got a "no such recipe"
[2013-05-30 19:02:36 -0400] jchauncey: why are you doing a berks upload?
[2013-05-30 19:02:37 -0400] stormerider: the only thing in chef-repo/cookbooks is the getting-started example cookbook at this point.
[2013-05-30 19:02:45 -0400] jchauncey: berks install
[2013-05-30 19:02:55 -0400] jchauncey: that will install any cookbooks that might be missing
[2013-05-30 19:03:05 -0400] justizin: and then upload sends them to the chef server..
[2013-05-30 19:03:08 -0400] justizin: i'm not missing cookbooks..
[2013-05-30 19:03:11 -0400] justizin: i added a file within this cookbook
[2013-05-30 19:03:31 -0400] justizin: it doesn't seem to have been uploaded by berks upload until i git add-ed the .rb file in the git repo
[2013-05-30 19:04:05 -0400] stormerider: berks working with the local filesystem seemed a little too confusing to me in the docs; git repos made more sense.
[2013-05-30 19:04:34 -0400] justizin: i'm not listing a dependency in the local filesystem
[2013-05-30 19:04:43 -0400] justizin: i'm developing my own cookbook, which is directly referenced in run_lists
[2013-05-30 19:05:09 -0400] justizin: so this, e.g., depends on 'wordpress' cookbook, and that's getting pulled from git..
[2013-05-30 19:05:10 -0400] justizin: anyway
[2013-05-30 19:05:22 -0400] justizin: not a big deal, just didn't seem clearly documented.
[2013-05-30 19:06:26 -0400] stormerider: right, but how does berks know about your cookbook?
[2013-05-30 19:06:39 -0400] stormerider: or are you pushing your cookbook via knife?
[2013-05-30 19:10:55 -0400] ponyofdeath: hi, how can I point knife to an specific .chef/knife.rb ?
[2013-05-30 19:11:39 -0400] stormerider: knife-block or knife -c <path/to/knife.rb>
[2013-05-30 19:11:43 -0400] jchauncey: ponyofdeath: https://github.com/greenandsecure/knife-block
[2013-05-30 19:13:08 -0400] ponyofdeath: thanks
[2013-05-30 19:18:38 -0400] ptrstr: kife-block uses a symlink?
[2013-05-30 19:19:52 -0400] ptrstr: how does it handle running knife multiple times against different chef servers?
[2013-05-30 19:21:31 -0400] stormerider: you have to do "knife block use <blah>" to switch between servers
[2013-05-30 19:25:57 -0400] rubbish: i just make shell wrappers for each chef-server i.e. knife-hosted, knife-stage-uat, etc.
[2013-05-30 19:26:25 -0400] rubbish: with 'knife "$@" -c $HOME/.chef/knife-hosted.rb'
[2013-05-30 19:27:55 -0400] deviosity: any ideas on how to get erchef and bookshelf to restart properly without a complete reboot of the server?
[2013-05-30 19:30:00 -0400] deviosity: I get these awesome errors trying to manually run it, since they only seem to start up on reboot.
[2013-05-30 19:30:01 -0400] deviosity: https://gist.github.com/anonymous/5680459
[2013-05-30 20:18:01 -0400] pithagorians: hi all. how can i use knife ec2 to start an idle instance ?
[2013-05-30 20:20:27 -0400] coderanger: pithagorians: What is an idle instance?
[2013-05-30 20:20:38 -0400] justizin: pithagorians: an idle instance?
[2013-05-30 20:20:44 -0400] justizin: oh, coderanger's already on that ;d
[2013-05-30 20:21:57 -0400] pithagorians: stopped
[2013-05-30 20:21:58 -0400] pithagorians: :)
[2013-05-30 20:22:03 -0400] coderanger: If you mean can you use it to create an instance in the stopped state, I don't think so
[2013-05-30 20:22:07 -0400] coderanger: Does the API even allow that?
[2013-05-30 20:22:40 -0400] pithagorians: i mean i want to start it
[2013-05-30 20:22:50 -0400] pithagorians: don't want to keep it running
[2013-05-30 20:23:07 -0400] pithagorians: want to start it automatically on demand
[2013-05-30 20:24:09 -0400] coderanger: No, I don't think we support that, knife ec2 server create is for bootstrapping a blank server, so it doesn't make much sense to use it on a server that has already been initialized
[2013-05-30 20:24:24 -0400] pithagorians: i see
[2013-05-30 20:24:27 -0400] coderanger: If you want a general-purpose EC2 API, just use Fog directly
[2013-05-30 20:24:53 -0400] coderanger: (or boto, libcloud, jclouds, whatever you prefer)
[2013-05-30 20:28:46 -0400] revattar: Anyone here looking for a "devops" engineering postion?  Basically looking for operational engineers with solid devops exposure and familiarity with CI/CD (jenkins, capistrano, et al) and CM utilizing puppet and chef.
[2013-05-30 20:29:20 -0400] miah: puppet _AND_ chef? lulz.
[2013-05-30 20:30:02 -0400] miah: pithagorians: you probably want to look at amazon auto scaling groups.
[2013-05-30 20:31:45 -0400] pithagorians: miah: we wanna control it using our monitoring :)
[2013-05-30 20:32:40 -0400] pithagorians: because of this i'm looking for methods to control instances
[2013-05-30 20:32:54 -0400] pithagorians: and in parallel i'm learning chef
[2013-05-30 20:33:06 -0400] pithagorians: and found the knife ec2
[2013-05-30 20:33:16 -0400] pithagorians: thought maybe it works
[2013-05-30 20:34:22 -0400] revattar: miah: it's an environment slowly migrating from puppet CM to a chef environment
[2013-05-30 20:34:45 -0400] revattar: no need to snub a nose :P
[2013-05-30 20:35:31 -0400] coderanger: revattar: You and everyone else
[2013-05-30 20:35:54 -0400] coderanger: revattar: Also this isn't a great place for recruiting, the kind of people that hang out in IRC generally don't take kindly to it
[2013-05-30 20:36:04 -0400] coderanger: revattar: You can ask on the main chef mailing list, thats about all we have right now
[2013-05-30 20:36:52 -0400] revattar: coderanger.  never hurts to ask
[2013-05-30 20:36:53 -0400] revattar: ;)
[2013-05-30 20:37:03 -0400] bean__: in general IRC is not the place to recruit :)  Some people get rather upset about it
[2013-05-30 20:37:15 -0400] coderanger: revattar: The above lines clearly show the opposite
[2013-05-30 20:37:31 -0400] revattar: :)
[2013-05-30 20:37:49 -0400] miah: at least it wasn't a ctcp query to everybody in the channel
[2013-05-30 20:41:36 -0400] thanatas: Got my cookbook working, now I want to write some tests.  I see there are a handful of tools on http://docs.opscode.com.  Is chef spec a good one or are people starting to move away from it in favor of something else?
[2013-05-30 20:43:02 -0400] pithagorians: cucumber
[2013-05-30 20:44:06 -0400] pithagorians: thanatas: https://github.com/Atalanta/cucumber-chef
[2013-05-30 20:44:20 -0400] thanatas: ok thanks pithagorians
[2013-05-30 20:44:40 -0400] coderanger: thanatas: test-kitchen + berkshelf + vagrant + chefspec is probably the most common test start
[2013-05-30 20:44:43 -0400] coderanger: er, stack
[2013-05-30 20:44:54 -0400] miah: minitest :P
[2013-05-30 20:45:10 -0400] thanatas: so i see there is no clear winner yet ha
[2013-05-30 20:45:17 -0400] miah: it depends on how you write cookbooks
[2013-05-30 20:45:38 -0400] miah: and if you want to write assertions that basically prove that chef did the work it already proved it did
[2013-05-30 20:45:48 -0400] thanatas: test-kitchen is to make testing over multiple platforms faster/easier?  Do you write tests with it?
[2013-05-30 20:46:31 -0400] miah: test kitchen is great to ensuring that convergence works properly on multiple platforms
[2013-05-30 20:49:46 -0400] jeremydei: what's the best ruby lib to use for talking to chef-server's api for something simple like editing a node attribute ..
[2013-05-30 20:50:12 -0400] miah: i tend to use spice, but lots of people use ridley?
[2013-05-30 20:50:28 -0400] revattar: jeremydei: knife
[2013-05-30 20:50:30 -0400] miah: https://github.com/danryan/spice
[2013-05-30 20:50:55 -0400] miah: https://github.com/RiotGames/ridley
[2013-05-30 20:52:58 -0400] awgross: Hey, anyone have experience running Kibana under Unicorn (or something similar?)
[2013-05-30 20:53:17 -0400] awgross: not super familiar with good ways to host ruby web apps
[2013-05-30 20:53:29 -0400] awgross: the Chef Unicorn cookbook states it is for Rack apps
[2013-05-30 20:53:56 -0400] miah: rack is a common web framework that many other frameworks (sinatra, rails etc) all use
[2013-05-30 20:54:09 -0400] jeremydei: cool, thx miah and revattar
[2013-05-30 20:54:10 -0400] miah: its the middleware between unicorn/rainbows/passenger and rails/sinatra/etc
[2013-05-30 20:54:41 -0400] jeremydei: spice seems to have a leaner gemspec deps :) /me likes
[2013-05-30 20:54:42 -0400] awgross: awesome
[2013-05-30 20:55:06 -0400] coderanger: awgross: kibana uses the built-in webbrick in sinatra by default, for a small internal deploy thats likely fine
[2013-05-30 20:56:00 -0400] awgross: coderanger: yeah, i was using that for trying it out, though i would like to make it a bit more robust before exposing to the whole company
[2013-05-30 20:56:17 -0400] coderanger: awgross: How many people will be using it on a regular basis?
[2013-05-30 20:56:18 -0400] miah: best to run on unicorn with haproxy or varnish sitting infront
[2013-05-30 20:56:25 -0400] miah: putting it behind nginx is mostly pointless
[2013-05-30 20:56:33 -0400] awgross: coderanger: for our python apps we use nginx -> gunicorn, i figured it would be similar for this
[2013-05-30 20:56:35 -0400] coderanger: awgross: if its ~10, just use the easy default and worry about it later
[2013-05-30 20:56:55 -0400] awgross: coderanger: fair enough, i may just do that then
[2013-05-30 20:57:15 -0400] coderanger: awgross: Easier to put in more time later when you need it than to get back a few hours of yelling at rackup :)
[2013-05-30 20:57:22 -0400] miah: lulz
[2013-05-30 20:58:04 -0400] awgross: coderanger: what strategy do you use to run the basic sinatra ap as a service, i dont want to shellout from a chef run to start it in the background
[2013-05-30 20:58:20 -0400] awgross: coderanger: just a simple init script?
[2013-05-30 20:59:00 -0400] coderanger: awgross: Throw it under supervisord or something
[2013-05-30 20:59:06 -0400] awgross: that i can do
[2013-05-30 20:59:13 -0400] awgross: thanks coderanger, miah
[2013-05-30 20:59:17 -0400] bean__: or runit, or what have you
[2013-05-30 20:59:40 -0400] coderanger: bean__: suggesting runit is is like handing a drowning man a glass of water
[2013-05-30 20:59:54 -0400] awgross: lol
[2013-05-30 21:00:53 -0400] bean__: coderanger: j/w, what's wrong with runit? we're considering using it for some things.
[2013-05-30 21:02:35 -0400] coderanger: bean__: documentation was written by serious neckbeards (read: there isn't much), configuration is all handled via 'add a bash script in a special path', it has no way to do things like restart throttling or modular event watchers
[2013-05-30 21:02:57 -0400] bean__: ah okay.
[2013-05-30 21:05:14 -0400] coderanger: It is rather popular with the Rails community, and with Opscode in particular
[2013-05-30 21:05:23 -0400] coderanger: I've yet to hear a convincing reason as to why :)
[2013-05-30 21:05:33 -0400] miah: its better than init and isnt upstart
[2013-05-30 21:05:44 -0400] coderanger: Both true :)
[2013-05-30 21:07:07 -0400] paulmooring: coderanger: it's pretty prevelent in the Opscode community cookbooks
[2013-05-30 21:07:22 -0400] paulmooring: that might explain some of it's momentum around Chef-y stuff
[2013-05-30 21:07:39 -0400] coderanger: paulmooring: Yeah, I think jtimberman is single-handedly responsible for that
[2013-05-30 21:07:52 -0400] paulmooring: coderanger: I was about to say, I blame jtimberman
[2013-05-30 21:08:34 -0400] paulmooring: coderanger: PRs accepted, you'd paint my bikeshed if you added systemd to all the things
[2013-05-30 21:09:25 -0400] chris613: Any theories on why the files/ directory for my cookbook might never make it to the client's cache? I have minitest-handler tests in base/files/default/test/motd_test.rb and I can see that file via the Chef Server UI, but when I run chef-client the copy of the cookbook that ends up in the cache has no files/ directory
[2013-05-30 21:09:58 -0400] chris613: So of course my tests don't run. I checked the metadata.rb version in the cache and it matches the server, just no files/ :(
[2013-05-30 21:10:09 -0400] miah: you can get around the 'restart throttling' issues by using 'once' rather than 'start' with runit =)
[2013-05-30 21:10:15 -0400] miah: or writing finish scripts
[2013-05-30 21:10:30 -0400] miah: and there is no reason why it has to be 'bash script' in the special path, just a script :P
[2013-05-30 21:11:18 -0400] miah: as for event watchers. eh. you should be using chpst or lxc anyways ;)
[2013-05-30 21:11:21 -0400] paulmooring: miah: if you're using 'once' and writing bash scripts, isn't it just an overengineered SysV ;)
[2013-05-30 21:11:35 -0400] miah: depends on how you actually control your daemons
[2013-05-30 21:11:48 -0400] miah: and if you  have other software that can watch and manage things
[2013-05-30 21:12:22 -0400] miah: you shouldn't really have software 'not start' in production. if its something that is failing mid run you probably dont want it to automatically restart anyways.
[2013-05-30 21:12:57 -0400] paulmooring: miah: I completely agree, but I actually like just regular old SysV init scripts
[2013-05-30 21:13:03 -0400] paulmooring: bash is easy for me to debug
[2013-05-30 21:13:14 -0400] miah: true
[2013-05-30 21:14:00 -0400] miah: i think systemd and smf are interesting though
[2013-05-30 21:15:00 -0400] coderanger: paulmooring: lmao if you think I run new enough linux for systemd
[2013-05-30 21:15:10 -0400] awgross: haha
[2013-05-30 21:15:28 -0400] paulmooring: coderanger: EL6?
[2013-05-30 21:15:30 -0400] coderanger: My personal VPS was still on a 2.6 kernel until like a month ago
[2013-05-30 21:15:46 -0400] coderanger: paulmooring: 10.04 until recently
[2013-05-30 21:16:02 -0400] coderanger: an 6.something before that I think
[2013-05-30 21:16:12 -0400] paulmooring: <troll>oh so you like upstart?</troll>
[2013-05-30 21:16:53 -0400] jeremydei: miah: does spice let you set node attributes or just read them? looks like just read .. (looking at the code)
[2013-05-30 21:17:30 -0400] coderanger: paulmooring: The one true daemon system, `bash -c 'nohup ruby main.rb &'`
[2013-05-30 21:17:35 -0400] awgross: lol
[2013-05-30 21:17:54 -0400] coderanger: jeremydei: Just use PyChef!</unhelpful>
[2013-05-30 21:18:04 -0400] jeremydei: lulz coderanger
[2013-05-30 21:18:26 -0400] ivey: jeremydei: ridley supports full read/write ops
[2013-05-30 21:18:39 -0400] coderanger: I tell Python people they should shut up and learn Ruby, I suppose I should be equal opportunity about it
[2013-05-30 21:20:48 -0400] bluekelp: thinking of swapping out a provider for a resource and having the new/patched provider subclass from the original, overriding where necessary.  anyone have example, or wisdom, on this?  i've never seen it done, just hoping it'll work
[2013-05-30 21:21:41 -0400] coderanger: bluekelp: How are you planning to do it?
[2013-05-30 21:23:02 -0400] bluekelp: i think i have to specify the override of provider in the recipe, then subclass that provider from the original/default.  and override just the method that's broken
[2013-05-30 21:23:23 -0400] coderanger: bluekelp: Whats your end goal
[2013-05-30 21:23:35 -0400] bluekelp: i'm not aware of a cleaner way to patch - and forking, while endemic here, is generally wrong
[2013-05-30 21:24:05 -0400] bluekelp: coderanger: the runit cookbook doesn't allow overriding the timeout value and it's causing a recipe failure for a slow starting service of ours
[2013-05-30 21:24:14 -0400] bluekelp: (timeout value to sv)
[2013-05-30 21:24:15 -0400] coderanger: bluekelp: Derp, was afraid you might say that
[2013-05-30 21:24:39 -0400] coderanger: bluekelp: Actually no, that works
[2013-05-30 21:24:45 -0400] coderanger: runit_service isn't an LWRP
[2013-05-30 21:25:03 -0400] coderanger: So just make a library file that subclasses the resource and provider for runit
[2013-05-30 21:25:10 -0400] coderanger: override as needed
[2013-05-30 21:25:20 -0400] coderanger: and then ues mycompany_runit_service instead
[2013-05-30 21:25:45 -0400] bluekelp: do i need to override the resource and provider?  or just the provider?
[2013-05-30 21:26:26 -0400] coderanger: you could either do just a provider and manually specify that in each runit_service resource, or you could override the resource too and have it set to use your modified provider
[2013-05-30 21:27:51 -0400] bluekelp: ah, understand what you meant now
[2013-05-30 21:29:03 -0400] miah: you should just be able to write a provider and put it into the chef namespace then pass 'provider Chef::Provider:MySpecialSauce' to the resource
[2013-05-30 21:30:06 -0400] miah: you could probably also write a library that monkeypatches the runit library but i dont know how/if that would actually work
[2013-05-30 21:31:14 -0400] coderanger: miah: yeah, just would have to do that on every use of runit_service, and that doesn't work if you want to pass new data into the provider (like a timeout value)
[2013-05-30 21:32:31 -0400] paulmooring: coderanger: Isn't the runit provider itself a library in a cookbook?
[2013-05-30 21:32:43 -0400] bluekelp: ugh. right. for a new value like timeout i need to subclass the resource too, since resource=interface yes?
[2013-05-30 21:32:47 -0400] coderanger: paulmooring: yeah, thats fine though
[2013-05-30 21:32:52 -0400] paulmooring: so any library in a cookbook later in the run_list should be able to monkey patch it
[2013-05-30 21:32:56 -0400] coderanger: paulmooring: lib files load in run-list order
[2013-05-30 21:33:01 -0400] paulmooring: yep
[2013-05-30 21:33:07 -0400] coderanger: bluekelp: yarp
[2013-05-30 21:33:23 -0400] coderanger: paulmooring: After last night I know far too much about the lib load process :)
[2013-05-30 21:34:28 -0400] miah: or you could just patch the runit cookbook to allow specifying the timeout value =)
[2013-05-30 21:35:30 -0400] bluekelp: miah: that might be even easier :)  been too busy to push local fixes back to anyone, to date
[2013-05-30 21:35:53 -0400] miah: know that feeling
[2013-05-30 21:37:46 -0400] bluekelp: and coworkers are happily forking everything to work under vagrant/chef-solo which is going to hit us hard at some point
[2013-05-30 21:38:26 -0400] miah: ya
[2013-05-30 21:39:01 -0400] pithagorians: any clue why getting ERROR: IOError: Cannot open or read /var/chef/cookbooks/nginx/metadata.rb!
[2013-05-30 21:39:01 -0400] pithagorians:  when doing knife cookbook site download nginx?
[2013-05-30 21:42:23 -0400] sprack: pithagorians: does that file exist?
[2013-05-30 21:42:29 -0400] pithagorians: no
[2013-05-30 21:42:38 -0400] bean__: it likely can't write to that path.
[2013-05-30 21:42:48 -0400] bean__: unless your user has access to write to it.
[2013-05-30 21:42:54 -0400] pithagorians: i have only Gemfile.lock into nginx folder
[2013-05-30 21:43:10 -0400] pithagorians: i'm doing it with root
[2013-05-30 21:43:14 -0400] bean__: :|
[2013-05-30 21:43:19 -0400] bean__: why are you doing it as root.
[2013-05-30 21:43:43 -0400] pithagorians: i feel ok like this :)
[2013-05-30 21:43:56 -0400] awgross: one of my coworkers just discovered that the default Directory Resource example makes a directory that no one can enter http://docs.opscode.com/resource_directory.html
[2013-05-30 21:44:00 -0400] awgross: those 00644 perms
[2013-05-30 21:45:59 -0400] bean__: pithagorians: in general being root for non-admin tasks is a bad idea...  Anyways, i'd check the permissions on those folders and make sure that you can browse to them.
[2013-05-30 21:46:09 -0400] jordane: awgross: the first 0 signifies that the number is octal, and mode accepts an octal number for perms
[2013-05-30 21:46:37 -0400] pithagorians: bean__: thats fine for learning env
[2013-05-30 21:46:48 -0400] bean__: I disagree, but okay.
[2013-05-30 21:47:25 -0400] bean__: jordane: awgross: yes, but if a directory is 644 it has no execute permissions, aka you can't enter it.
[2013-05-30 21:47:48 -0400] awgross: im more worried about the execute bit than the octal stuff
[2013-05-30 21:47:52 -0400] bean__: ^
[2013-05-30 21:48:05 -0400] awgross: my coworker was very confused when he could not get in to a directory he owned
[2013-05-30 21:48:29 -0400] jordane: bean__: ah, right.
[2013-05-30 21:50:03 -0400] miah: you need to grant search permission on directories
[2013-05-30 21:53:50 -0400] bean__: miah: "search permission" meaning what
[2013-05-30 21:56:45 -0400] miah: http://content.hccfl.edu/pollock/aunix1/filepermissions.htm
[2013-05-30 21:57:25 -0400] miah: i got asked that once on a interview. that was a fun one.
[2013-05-30 21:58:37 -0400] gleam: like, they used that term and asked you to define it?
[2013-05-30 21:58:38 -0400] gleam: or what
[2013-05-30 21:58:51 -0400] bean__: miah: oh, i've always called that "execute" permissions, cuz, you know, its the "x" flag.
[2013-05-30 21:58:56 -0400] gleam: right, same
[2013-05-30 21:59:00 -0400] gleam: and i've never heard it called "search"
[2013-05-30 21:59:11 -0400] gleam: so it'd be kind of dickish/tricky to rely on knowing that specific name for it
[2013-05-30 21:59:28 -0400] bean__: i'd probably be like "sorry bro, that's called the execute permissions, not search"
[2013-05-30 21:59:31 -0400] _Spike_: Playing trick the interviewee is kind of a sad thing to do.
[2013-05-30 21:59:34 -0400] _Spike_: Proves nothing.
[2013-05-30 21:59:57 -0400] bean__: fwiw, the `man chmod` man page does call it "           x       The execute/search bits."
[2013-05-30 22:00:52 -0400] miah: gleam: no, they asked me why directories needed the execute bit
[2013-05-30 22:00:58 -0400] gleam: oh ok
[2013-05-30 22:01:05 -0400] gleam: that's fine then
[2013-05-30 22:01:09 -0400] miah: its generally called 'search' when applied to directories. since you dont really execute a directory.
[2013-05-30 22:01:27 -0400] gleam: yeah, but there's not really any reason to call it something else when it's the same bit
[2013-05-30 22:01:31 -0400] gleam: (personally)
[2013-05-30 22:01:37 -0400] gleam: you just understand that it acts differently
[2013-05-30 22:01:43 -0400] miah: sure
[2013-05-30 22:01:45 -0400] thanatas: they don't need it as you can still read files in it if you know the name of the file, and you can also write to the dir without X
[2013-05-30 22:02:13 -0400] thanatas: its very odd but it has some rare usefulness
[2013-05-30 22:02:20 -0400] miah: well. if the file inside the directory is another directory, it wont work =)
[2013-05-30 22:10:39 -0400] deviosity: is there a way to force bookshelf to regenerate the checksum files
[2013-05-30 22:20:30 -0400] CharlieSu: schisamo: does vagrant-omnibus work in a multi VM Vagrant setup?  I'm trying without luck.
[2013-05-30 22:21:05 -0400] CharlieSu: https://gist.github.com/CharlieSu/ae122505707a1bb7135f
[2013-05-30 22:44:43 -0400] aneto: I'm creating a directory with a lwrp, but when I use it multiple times the log shows warnings about cloning resources. Is there anyway to avoid the warnings?
[2013-05-30 22:45:16 -0400] miah: no
[2013-05-30 22:45:55 -0400] miah: unless you check the resource collection for the existence of the resource before instantiting a new resource with that name
[2013-05-30 22:47:09 -0400] aneto: k thank miah for the answer
[2013-05-30 22:47:15 -0400] awgross: or name all of your resources in your LWRP based off the name of your name attribute for your LWRP
[2013-05-30 22:48:06 -0400] aneto: hmm
[2013-05-30 22:49:47 -0400] miah: well you should be doing that anyway
[2013-05-30 22:50:01 -0400] miah: but you'
[2013-05-30 22:50:07 -0400] VonGuard: hah
[2013-05-30 22:50:08 -0400] VonGuard: there you are
[2013-05-30 22:50:29 -0400] miah: will still see that error if you create a resource and then later instantiate it to send it a different action.
[2013-05-30 22:51:32 -0400] chaosmaker: Hi all, someone knows which package is referred in the sql_server cookbook? on my SPLA account I can only find sql server iso images for download.
[2013-05-30 22:52:57 -0400] miah: because often you are redeclaring the same resource rather than looking up the object in the resource collection and then sending it the action
[2013-05-30 22:53:24 -0400] aneto: miah would the aws cookbook have a similar situation? I'm really new to lwrp, which opscode cookbook would have an example?
[2013-05-30 22:53:57 -0400] miah: none because they are all written without object orientation in mind =)
[2013-05-30 22:54:21 -0400] miah: its mostly safe to ignore that warning
[2013-05-30 22:54:46 -0400] aneto: ok thanks for the information =)
