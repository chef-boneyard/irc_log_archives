[2013-05-13 02:29:04 -0400] llakey: Using Berkshelf, I'm adding all cookbook/library dependencies to metadata.rb. Why do some library dependencies such as "ntp" also need to be include_recipe'd in my application recipe/default.rb and others such as "ulimit" or "sysctl" don't? In general am I supposed to both add libraries as dependencies and include_recipe?
[2013-05-13 07:52:32 -0400] m4rcu5: now woth the new onmi installs, how does one update chef when a new version arrives?
[2013-05-13 07:52:52 -0400] zts: llakey: does the library cookbook's default recipe have stuff in it?  If so, you'll need to include_recipe
[2013-05-13 07:54:43 -0400] zts: llakey: sometimes, a cookbook provides definitions or LWRP without needing anything else installed on the system, and in those cases you can just list them as dependencies
[2013-05-13 08:01:07 -0400] llakey: zts: thanks. in the case of the "ulimit" cookbook, yes, recipes/default.rb does contain stuff. but "ulimit" is one of the cookbooks i'm finding i apparently don't need to include_recipe. the "ulimit" cookbook does contain a definitions/user_ulimit.rb file
[2013-05-13 08:02:42 -0400] zts: m4rcu5: I've used the omnibus_updater cookbook, but you could equally run the install script again, or download the updated packages and do it manually
[2013-05-13 08:05:13 -0400] zts: llakey: looking at that, you don't need that default recipe if you're only using the user_ulimit definition in your cookbook.
[2013-05-13 08:05:34 -0400] m4rcu5: zts: running the script again on all 500 machines is no option :)
[2013-05-13 08:06:05 -0400] zts: m4rcu5: sure it is, it's just one you're rightly placing at the bottom of the pile of options :)
[2013-05-13 08:06:23 -0400] m4rcu5: zts: the chef-client cookbook will not do any updating on the omni side of things? just install the cron/init to keep it running?
[2013-05-13 08:06:48 -0400] zts: m4rcu5: I'm personally a bit wary of updating Chef from within Chef, but my early experiments with the omnibus_updater cookbook haven't caused any tears yet
[2013-05-13 08:07:02 -0400] m4rcu5: zts: nah at the bottom is the engineer with the usb stick running through the DC ;)
[2013-05-13 08:07:47 -0400] llakey: zts: by "you don't need that default recipe" you mean i don't need to include_recipe "ulimit" in my new application cookbook. i just need to add "ulimit" as a dependency in my metadata.rb file? that's what i did anyway and it seems to be working
[2013-05-13 08:07:47 -0400] zts: as for the chef-client cookbook, last time I checked it didn't have any features to update omnibus installs
[2013-05-13 08:09:09 -0400] zts: llakey: correct.  The thing to understand is that adding a cookbook as a dependency does not put any of that cookbook's recipes onto your run list.  If you need some of its recipes to run, you'll need to use include_recipe, or put them in a node or role run_list
[2013-05-13 08:09:50 -0400] m4rcu5: zts: your right, so it is basicly installing with a bootstrap that installs the omnibus, run the chef-client to get an init script or cron to run the client, and keep it up2date with omnibus_updater?
[2013-05-13 08:11:33 -0400] llakey: zts: ahh. which is why i need to include_recipe with the "ntp" cookbook. because the "ntp" cookbook recipes/default.rb installs the ntp package among other things
[2013-05-13 08:11:55 -0400] zts: m4rcu5: yeah, that's the approach I take
[2013-05-13 08:12:48 -0400] m4rcu5: zts sounds legit :)
[2013-05-13 08:13:08 -0400] zts: llakey: exactly!  Sometmes the cookbook documentation will tell you what's appropriate, but I normally look at the default recipe myself
[2013-05-13 08:13:29 -0400] m4rcu5: btw the chef naming scheme is really cook, try this with a new manager: explanation to manager: Yes,yes we are working with chef to get the server up 2 date with the cookbooks of the grocery_delivery...
[2013-05-13 08:14:41 -0400] zts: m4rcu5: perfect cover should your team want to start running a small cafe on the side :)
[2013-05-13 08:15:15 -0400] m4rcu5: zts: prolly have to hit the drugs test afterwards ;)
[2013-05-13 08:18:45 -0400] llakey: i've set up an ubuntu chef 11 server on EC2 using the omnibus package. when i try to access the web interface or run "berks upload" etc. i seem to be having http redirection issues related to the chef server having configured itself with an AWS EC2 internal FQDN which isn't resolvable from the outside world ala ip-X-X-X-X.us-west-1.compute.internal. i tried creating a /etc/chef-server/chef-server.rb file and running ...
[2013-05-13 08:18:51 -0400] llakey: ... chef-server-ctl reconfigure but that still didn't resolve this issue
[2013-05-13 08:20:20 -0400] m4rcu5: zts, are you also running the chef-server as an omni package? its a shame that nginx and all is in there, there is no way of using it for other vhosts as well (jenkins for example)
[2013-05-13 09:25:18 -0400] aruntomar: llakey: configure proper fqdn on your ec2 server. then chef-server-ctl reconfigure
[2013-05-13 09:27:11 -0400] llakey: aruntomar: i think one issue i may have had was: I think i need to run chef-server-ctl reconfigure and then also chef-server-ctl restart
[2013-05-13 09:27:53 -0400] vrturbo: HI All, wondering how I separate services in chef recipes, ie wordpress (apache2 php etc..) on one node and database server on another, can't seem to find the answer
[2013-05-13 09:28:30 -0400] aruntomar: llakey: k, try it without restart, if that doesn't work, then you can certainly restart, and we'll know for sure, whether we really need restart or not.
[2013-05-13 09:28:45 -0400] aruntomar: llakey: once you figure out whether restart is required or not, do let me know also.
[2013-05-13 09:29:47 -0400] aruntomar: vrturbo: fire different roles or recipes on different vm's/instances.
[2013-05-13 09:30:13 -0400] llakey: aruntomar: i say that because after i restarted this particular issue went away. i had already created an /etc/chef-server/chef-server.rb file and run reconfigure but that wasn't enough apparently
[2013-05-13 09:30:21 -0400] vrturbo: but will the web node know to use the mysql on the database node ?
[2013-05-13 09:31:35 -0400] aruntomar: vrturbo: obviously the system will do whatever you tell it to do
[2013-05-13 09:32:53 -0400] llakey: i'm having an issue connecting clients to my new omnibus installed chef 11 server with irb or berkshelf etc. the error i'm getting is SSL_connect certificate verify failed etc. i imagine i need to add SSL certs to chef-server somewhere somehow but i'm not sure where/how ?
[2013-05-13 09:32:59 -0400] vrturbo: should I say how do I pass mysql options in chef like host, username password when deploying a lamp app like wordpress of phpmyadmin ?
[2013-05-13 09:33:10 -0400] aruntomar: vrturbo: so while deploying, if you configure or provide proper parameters/attributes to tell wordpress, to use a remote db rather than local db, then it'll do that.
[2013-05-13 09:33:32 -0400] aruntomar: llakey: are you behind a LB?
[2013-05-13 09:34:06 -0400] llakey: aruntomar: none other than the nginx installed by the chef-server omnibus itself
[2013-05-13 09:34:08 -0400] vrturbo: great, any doco you recommend on passing the attributes ?
[2013-05-13 09:34:52 -0400] vrturbo: I've worked with juju before but I"m trying to move away from that as I don't always want to be running ubuntu etc..
[2013-05-13 09:35:54 -0400] aruntomar: llakey: do you have https opened in your security group
[2013-05-13 09:37:26 -0400] aruntomar: vrturbo: you can override default attributes in various ways, http://docs.opscode.com/chef_overview_attributes.html
[2013-05-13 09:37:36 -0400] vrturbo: thanks
[2013-05-13 09:38:02 -0400] llakey: aruntomar: yes
[2013-05-13 09:38:40 -0400] aruntomar: vrturbo: https://learnchef.opscode.com/common-use-cases/multi-node-ec2/
[2013-05-13 09:39:52 -0400] vrturbo: thanks, i'm using knife openstack but I'll do some reaing and should be able to figure it out, hopefully ha ha
[2013-05-13 09:39:59 -0400] vrturbo: reading
[2013-05-13 09:45:55 -0400] aruntomar: vrturbo: commands are almost the same for most of the cloud platforms. you need knife-openstack gem, and rather than firing commands like eg:  knife ec2 server list , you'll have to use something like knife openstack server list
[2013-05-13 09:47:30 -0400] aruntomar: llakey: can you try uploading any single cookbook just with knife eg: knife cookbook upload <cb name>
[2013-05-13 09:55:37 -0400] llakey: aruntomar: done. INFO: HTTP Request Returned 500 Internal Server Error: internal service error
[2013-05-13 09:56:32 -0400] aruntomar: llakey: what does hostname -f returns?
[2013-05-13 09:57:09 -0400] llakey: aruntomar: ip-X-X-X-X.us-west-1.compute.internal
[2013-05-13 09:57:34 -0400] aruntomar: llakey: set the proper hostname, which linux r u using?
[2013-05-13 09:57:42 -0400] llakey: ubuntu
[2013-05-13 09:58:49 -0400] aruntomar: you'll need to modify /etc/hostname and /etc/hosts
[2013-05-13 09:58:54 -0400] aruntomar: llakey: https://library.linode.com/networking/configuring-static-ip-interfaces#sph_debian-and-ubuntu
[2013-05-13 09:59:11 -0400] llakey: aruntomar: reading
[2013-05-13 09:59:46 -0400] aruntomar: llakey: once you've properly configured it, then hostname -f will return the properly fully qualified domain name
[2013-05-13 10:00:43 -0400] aruntomar: llakey: and then reconfigure your chef server
[2013-05-13 10:00:48 -0400] aruntomar: and restart it
[2013-05-13 10:09:05 -0400] svparijs: Hey guys im trying to get my WebUi back up but something weird is happening with the lookup it keeps begin forwarded to https://chef instead of 10.10.0.27 the way i configured it...
[2013-05-13 10:09:57 -0400] svparijs: what i keep getting is nginx returning the Welcome to Nginx page
[2013-05-13 10:11:06 -0400] aruntomar: svparijs: when you run reconfigure on your chef 11 server, it takes the fqdn of the system and configures it with nginx server.
[2013-05-13 10:11:44 -0400] svparijs: can i change that to something proper like the IP or something?
[2013-05-13 10:13:40 -0400] llakey: aruntomar: thanks. i'm reconfiguring the hostname and chef-server now. i had assumed i could leave the hostname at the weird ec2 internal address if i configured chef-server.rb and reconfigured and restarted the server but now i see that's not the case.
[2013-05-13 10:13:48 -0400] svparijs: the weird thing is i get a welcome to nginx page instead of the webui
[2013-05-13 10:13:52 -0400] svparijs: i had i before....
[2013-05-13 10:13:56 -0400] svparijs: it*
[2013-05-13 10:14:22 -0400] aruntomar: svparijs: you could try to modify the fqdn to represent your ip address, not sure about this one. or you can have a proper fqdn and have your dns server point to it or modify your systems hosts file to use that fqdn for your chef servers ip.
[2013-05-13 10:17:12 -0400] aruntomar: svparijs: ofcourse u'll get the welcome page. check the server name in this file /var/opt/chef-server/nginx/etc/nginx.conf
[2013-05-13 10:21:47 -0400] helllen: helllo
[2013-05-13 10:22:11 -0400] helllen: how do I generate a encrypted_data_bag_secret ?
[2013-05-13 10:22:19 -0400] helllen: at new version 11.X??
[2013-05-13 10:26:32 -0400] zts: helllen: however you did it on version 10 still works on version 11 - it is just a piece of text
[2013-05-13 10:26:48 -0400] zts: helllen: the docs have a suggestion for creating a random key using openssl: http://docs.opscode.com/essentials_data_bags_encrypt.html
[2013-05-13 10:26:58 -0400] helllen: ok
[2013-05-13 10:27:00 -0400] helllen: thanks
[2013-05-13 10:27:01 -0400] railsraider: is there a way to manage upstart with instance id on notify?
[2013-05-13 10:32:47 -0400] llakey: aruntomar: i made the hostname changes. after the hostname changes I was able to successfully run "knife cookbook upload". i still got an SSL error from "berks upload". along with the hostname changes and then setting my Berkshelf configuration to "ssl verify false" now i'm able to successfully run "berks upload". i'm not sure if the problem with "berks upload" was a Berkshelf SSL issue or a chef-server SSL issue but ...
[2013-05-13 10:32:53 -0400] llakey: ... it's working atm.
[2013-05-13 10:33:03 -0400] llakey: aruntomar: thanks for the help
[2013-05-13 10:34:28 -0400] aruntomar: llakey: welcome :). good to know that it finally works for you.
[2013-05-13 12:50:01 -0400] helllen: helllo
[2013-05-13 12:50:15 -0400] helllen: how do you run chef-server in high availabilty mode ?
[2013-05-13 12:50:34 -0400] helllen: I mean two chef-servers balancig load
[2013-05-13 12:50:38 -0400] helllen: is that possible ?
[2013-05-13 12:52:40 -0400] Doc_X: from what i understand, you would point different boxes at different chef servers for load balancing.... for HA, you run servers in an active-passive mode.
[2013-05-13 12:53:02 -0400] Doc_X: i think there was a talk at chefconf about that, but i haven't viewed them all so i'm not positive.
[2013-05-13 13:04:15 -0400] svparijs: does anyone know how to handle this error: ArgumentError: Cannot find a provider for firewall[ufw] on debian version 7.0
[2013-05-13 13:04:29 -0400] svparijs: google didn't help...
[2013-05-13 13:28:45 -0400] railsraider: Hi, i need some help with an execute block doesnt seem to work
[2013-05-13 13:29:29 -0400] flipture: Anyone good with resource ordering and best  practices? Specifically involving a ruby block that needs to execute after other resources but every chef run?
[2013-05-13 13:39:59 -0400] gchristensen: flipture: have the first resource  notify the second resource will the first one run each time?
[2013-05-13 13:40:52 -0400] flipture: gchristensen: i think my issue is that i have a remote_file resource that will nto run each time but i want to process the templates in that archive every time even if its changed or not (the attributes that parse the template could have changed)
[2013-05-13 13:41:34 -0400] flipture: the template parsing bits are in a ruby block. is it good practice to simply have the ruby block run every time and include_recipe my template.rb (thats where the ruby block is) after the other resources?
[2013-05-13 13:42:12 -0400] flipture: i'd thought that the ruby block would run in the first stage of the chef run, before all other resources even if it was at the end of the recipe
[2013-05-13 13:42:29 -0400] flipture: unless i had action :nothing, and notified it from somewhere. do you know if this is the case or not?
[2013-05-13 14:19:12 -0400] Hound: Hi all.  I am trying to get the opscode mysql cookbook running on windows.  I keep running into issues.  The current issue I am receiving is "Chef::Exceptions::Override: You must override load_current_resource in #<Chef::Provider::Package:0x4022970>"
[2013-05-13 14:19:17 -0400] Hound: any thoughts?
[2013-05-13 14:38:30 -0400] zts: flipture: no, that's not the case.  a ruby_block will be converged in the order it's declared, like any other resource
[2013-05-13 14:38:47 -0400] zts: flipture: it is only ruby code in your recipes (outside of ruby_block) that will be run during the compile phase
[2013-05-13 14:39:12 -0400] flipture: zts: awesome! gotcha.
[2013-05-13 14:39:32 -0400] flipture: zts: i realized that earlier when i simply tried it... but i misunderstood prior...
[2013-05-13 14:39:44 -0400] flipture: thanks!
[2013-05-13 14:40:00 -0400] zts: no problem :)
[2013-05-13 14:46:14 -0400] phessler: hi, I am having major problems installing chef-server.  I have installed the chef-server and chef(client) rpms on my server, and are running the "knife configure --initial" command, but it is whinging at me with "Please enter the location of the existing admin's private key: [/etc/chef/admin.pem]".  I don't have an existing admin yet.
[2013-05-13 14:46:59 -0400] phessler: any ideas?
[2013-05-13 14:48:22 -0400] Hound: I am trying to get the opscode mysql cookbook running on windows.
[2013-05-13 14:48:35 -0400] Hound: I keep running into issues.
[2013-05-13 14:48:42 -0400] Hound: The current issue I am receiving is "Chef::Exceptions::Override: You must override load_current_resource in #<Chef::Provider::Package:0x4022970>"
[2013-05-13 14:48:52 -0400] Hound: any thoughts?
[2013-05-13 14:55:50 -0400] daimonic: phessler: if I recall correctly then you can find the private key in the UI
[2013-05-13 14:55:56 -0400] daimonic: the first time you use it
[2013-05-13 14:56:14 -0400] daimonic: the documentation is not very helpful there
[2013-05-13 14:57:08 -0400] daimonic: is chef-server the only option for non external cloud hosted chef?
[2013-05-13 14:58:01 -0400] queso: If I need to modify some values in /etc/php.ini, what's the right way to do this? I assumed the PHP cookbook would be able to do this, but it doesn't look like it.
[2013-05-13 14:58:29 -0400] daimonic: lots of questions and hardly any answers in this chan
[2013-05-13 14:58:44 -0400] phessler: daimonic: so, just chuck the private key in the pem file?  what about the public key?
[2013-05-13 14:59:10 -0400] daimonic: dont think knife it cares about the public key
[2013-05-13 14:59:10 -0400] adnichols: daimonic depends on the day - there's private chef & open source chef - you are looking for an alternative to that?
[2013-05-13 14:59:13 -0400] daimonic: -it
[2013-05-13 14:59:32 -0400] phessler: ok, thanks
[2013-05-13 14:59:59 -0400] daimonic: adnichols: just wondering if you have a few datacenters with thousands of machines and you want a federated solution, what one should be going for
[2013-05-13 15:00:49 -0400] daimonic: seems like unless you use chef-server (which doesnt look suitable for many sites/federation), only other options are hosted on the cloud?
[2013-05-13 15:01:16 -0400] daimonic: maybe im wrong about chef-server, but it looks very basic
[2013-05-13 15:01:42 -0400] adnichols: daimonic they are all chef-server, for private installs there are really two variants - private chef (commercial) and open source chef
[2013-05-13 15:02:04 -0400] daimonic: ah ok
[2013-05-13 15:02:16 -0400] adnichols: daimonic I'm not sure that either deals with federation, but the former would get you support and you could probably talk to em about how to use it at your scale
[2013-05-13 15:02:23 -0400] daimonic: I guess I need to know more about what private chef is actually capable of
[2013-05-13 15:02:55 -0400] adnichols: I'd give em a call and ask - it's a commercial product
[2013-05-13 15:03:01 -0400] phessler: hmm.  I ignored the private key when it showed it to me the first time (yesterday).  is there a way to get it back?
[2013-05-13 15:03:10 -0400] daimonic: aye I'll do that, cheers
[2013-05-13 15:03:11 -0400] phessler: or am I just hosed at this point?
[2013-05-13 15:03:15 -0400] daimonic: mmm
[2013-05-13 15:03:50 -0400] nathenharvey: phessler: you need your individual key?
[2013-05-13 15:03:51 -0400] daimonic: not sure man, it was such a ballache to get working initially that my mind did a good job forgetting the details ;)
[2013-05-13 15:04:09 -0400] phessler: nathenharvey: I need *any* key, so I can run "knife configure --initial"
[2013-05-13 15:04:40 -0400] phessler: daimonic: yes, this is a nasty ballache so far
[2013-05-13 15:04:44 -0400] nathenharvey: phessler: ahh....ok.  what chef are you using?  hosted, private, or open source?
[2013-05-13 15:04:49 -0400] phessler: open source
[2013-05-13 15:05:02 -0400] phessler: I installed the server and client rpms on my server
[2013-05-13 15:05:21 -0400] phessler: ran the chef-server-ctl reconfigure, then knife configure --initial
[2013-05-13 15:05:39 -0400] phessler: and now it is whinging at me because I don't have /etc/chef/admin.pem (or any files in /etc/chef)
[2013-05-13 15:06:49 -0400] daimonic: take a look in /etc/chef-server/
[2013-05-13 15:06:50 -0400] phessler: (to be honest: I expected --inital to create everything it needed, and not make me do silly stuff like this)
[2013-05-13 15:07:36 -0400] daimonic: oops late for an appt
[2013-05-13 15:07:42 -0400] daimonic: thanks for the help lads, bbl
[2013-05-13 15:08:21 -0400] phessler: that is kinda helpful.  at least now i get a different error.
[2013-05-13 15:09:57 -0400] ssd7: phessler: If you post the error somewhere, I'd be happy to take a look
[2013-05-13 15:10:21 -0400] phessler: ERROR: Connection refused connecting to localhost:4000 for /users, retry 1/5
[2013-05-13 15:10:34 -0400] phessler: I am accepting the defaults in knife configure --initial
[2013-05-13 15:11:13 -0400] jtimberman: phessler: don't accept the defaults. they're not updated for Chef 11. Sorry about that.
[2013-05-13 15:11:18 -0400] phessler: ARG!
[2013-05-13 15:11:20 -0400] ssd7: phessler: Change that to just https://localhost
[2013-05-13 15:11:42 -0400] phessler: jtimberman: please update -HEAD then, so at least the next update will have it
[2013-05-13 15:11:48 -0400] jtimberman: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/
[2013-05-13 15:12:02 -0400] BryanWB_: is there a public vagrant box for windows server 2k8 w/ chef on it>
[2013-05-13 15:12:05 -0400] BryanWB_: ?
[2013-05-13 15:13:08 -0400] phessler: getting farther....
[2013-05-13 15:13:15 -0400] phessler: but I think I broke lots of things with my experimentation
[2013-05-13 15:13:31 -0400] phessler: I'll trash and rebuild the box, then follow the blog instead of the official docs
[2013-05-13 15:13:32 -0400] phessler: thanks
[2013-05-13 15:14:09 -0400] ssd7: phessler: Re getting it fixed in the next release.  We are on it: http://tickets.opscode.com/browse/CHEF-4176  I'll make sure the issue with the key path makes it in as well
[2013-05-13 15:15:26 -0400] juliancdunn: BryanWB_: we can't distribute that
[2013-05-13 15:15:30 -0400] juliancdunn: for obvious reasons :)
[2013-05-13 15:15:40 -0400] juliancdunn: but the bento def will build you one
[2013-05-13 15:15:49 -0400] BryanWB_: juliancdunn: but there is one for puppet :(
[2013-05-13 15:15:54 -0400] jtimberman: juliancdunn: ohai, i sent a pull request for bento
[2013-05-13 15:16:25 -0400] juliancdunn: BryanWB_: I can't speak to that but for legal reasons it's best for us not to distrib commercial s/w :)
[2013-05-13 15:16:28 -0400] BryanWB_: juliancdunn: maybe it isn't legit Copy http://dl.dropbox.com/u/58604/vagrant/win2k8r2-core.box
[2013-05-13 15:16:30 -0400] juliancdunn: jtimberman: ohai, I will look at it
[2013-05-13 15:16:48 -0400] BryanWB_: i thot MS made this easier recently, darn
[2013-05-13 15:17:50 -0400] juliancdunn: BryanWB_: there are 180-day evals but I'm still not clear that it's kosher to distrib those baseboxes
[2013-05-13 15:17:59 -0400] juliancdunn: (built off the evals)
[2013-05-13 15:18:28 -0400] BryanWB_: juliancdunn: will look at the bento def, tks
[2013-05-13 15:47:33 -0400] jeekl: https://gist.github.com/jeekl/5569294 I need some chefspec assistance... It seems like chefspec can't handle a loop, where I want to install multiple packages... What am I doing wrong?
[2013-05-13 15:54:53 -0400] tehlers__: when you make a directory like "/opt/apps/myapp/myapppart2" and own it to "myuser"
[2013-05-13 15:55:01 -0400] tehlers__: how come /opt/apps/myapp is owned by root
[2013-05-13 15:55:02 -0400] tehlers__: ?
[2013-05-13 15:55:08 -0400] tehlers__: what have i done wrong?
[2013-05-13 15:55:55 -0400] tehlers__: im using recursive true
[2013-05-13 15:58:17 -0400] jeekl: tehlers__: recursive true only creates the directories recursively, it does not set owners/permissions recursively. that is by design, but there is discussion on changing it, see, for example: http://tickets.opscode.com/browse/CHEF-1621
[2013-05-13 16:00:00 -0400] tehlers__: Thanks Jeekl
[2013-05-13 16:02:29 -0400] jeekl: tehlers__: you could write something like https://gist.github.com/jeekl/5569416
[2013-05-13 16:04:34 -0400] jwilf: anyone got any tips for speedig up rake install? it takes forever
[2013-05-13 16:07:51 -0400] gleam: rake install where?
[2013-05-13 16:09:19 -0400] jwilf: on my chef server
[2013-05-13 16:09:30 -0400] jwilf: to import all cookbooks and roles
[2013-05-13 16:20:08 -0400] prana: Is there a tool that takes a base AMI image but then applies say, some chef-solo configuration to it, and then creates a new AMI with that configuration?
[2013-05-13 16:23:17 -0400] mattupstate: can anyone recommend an s3 file LWRP?
[2013-05-13 16:26:22 -0400] willejs: in chef 10 client, is there anyway to see how and where a specific attribute is set>
[2013-05-13 16:26:23 -0400] willejs: ?
[2013-05-13 16:42:40 -0400] ieldib: hi everybody
[2013-05-13 16:43:20 -0400] ieldib: i am trying to  start up a ec2 instance using the following command
[2013-05-13 16:43:21 -0400] ieldib: knife ec2 server create -I ami-b89842d1 --flavor m1.small -x ubuntu -r "role[web]" -G my-pair -N testnode
[2013-05-13 16:43:27 -0400] ieldib: but ig et the following error when i do so
[2013-05-13 16:43:33 -0400] ieldib: ERROR: Excon::Errors::SocketError: getaddrinfo: nodename nor servname provided, or not known (SocketError)
[2013-05-13 16:43:46 -0400] ieldib: i clearly specify the nodename    in the very last  argument
[2013-05-13 16:43:52 -0400] ieldib: any ideas what  i am doing wrong ?
[2013-05-13 16:46:33 -0400] ieldib: anybody ?
[2013-05-13 16:46:41 -0400] Otterley: ieldib, this appears to be a hostname resolution error
[2013-05-13 16:46:46 -0400] zackf: anyone know with the chef service resource what return code it needs from status to be considered not running?
[2013-05-13 16:47:01 -0400] ieldib: Otterly,  the nodename hostname resolution error ?
[2013-05-13 16:47:10 -0400] ieldib: the instance isn't created yet so there is no way it can resolve to anything
[2013-05-13 16:47:13 -0400] agarson1: zackf: 1 for running 0 for not
[2013-05-13 16:47:14 -0400] Otterley: ieldib, or maybe knife
[2013-05-13 16:47:20 -0400] zackf: Hmmm
[2013-05-13 16:47:22 -0400] zackf: Ok thanks
[2013-05-13 16:47:29 -0400] zackf: What i thought, not sure why it's dying
[2013-05-13 16:47:31 -0400] zackf: i'll dig on it
[2013-05-13 16:47:32 -0400] zackf: thks
[2013-05-13 16:47:44 -0400] Otterley: agarson1, do you have that backwards?
[2013-05-13 16:47:51 -0400] agarson1: very possibly
[2013-05-13 16:47:52 -0400] Otterley: usually 0 means it's good
[2013-05-13 16:48:07 -0400] agarson1: status isn't good vs bad though, its on vs off
[2013-05-13 16:48:13 -0400] Otterley: agarson1, easy to test:
[2013-05-13 16:48:31 -0400] Otterley: [mfischer@admin1]:~ $ service ssh status
[2013-05-13 16:48:33 -0400] Otterley: ssh start/running, process 1860
[2013-05-13 16:48:35 -0400] Otterley: [mfischer@admin1]:~ $ echo $?
[2013-05-13 16:48:37 -0400] Otterley: 0
[2013-05-13 16:48:40 -0400] ieldib: Otterly,  what resolution were you referring to ?
[2013-05-13 16:48:53 -0400] ieldib: i can run a knife cookbook list and get a list of cookbooks from my chef server
[2013-05-13 16:49:01 -0400] agarson1: zackf: you can also ssh into node and run chef-client in whyrun mode to get more info
[2013-05-13 16:49:07 -0400] ieldib: not sure what you are referring to in regards to name resolution
[2013-05-13 16:49:48 -0400] zackf: agarson1: that's a nice tip
[2013-05-13 16:49:48 -0400] Otterley: ieldib, it could be any number of things.  you've ruled out the chef server, how about the AWS API endpoint?
[2013-05-13 16:49:49 -0400] zackf: Thank you
[2013-05-13 16:50:21 -0400] Otterley: ieldib, there are a lot of moving parts here
[2013-05-13 16:50:40 -0400] ieldib: i ran a vv
[2013-05-13 16:50:54 -0400] ieldib: from /Users/ieldib/.rvm/gems/ruby-1.9.3-p392/gems/excon-0.21.0/lib/excon/socket.rb:149:in `connect'
[2013-05-13 16:50:56 -0400] ieldib: first error
[2013-05-13 16:51:21 -0400] zackf: Yeah it appears 0 means running
[2013-05-13 16:51:36 -0400] Otterley: unfortunately excon isn't nice enough to tell you what it failed to resolve, it may be quickest to strafe it
[2013-05-13 16:51:43 -0400] Otterley: s/strafe/strace/
[2013-05-13 16:52:08 -0400] ieldib: http://pastebin.com/rzMswy9b
[2013-05-13 16:52:38 -0400] Otterley: ieldib, given the backtrace, looks like trouble talking to the AWS API
[2013-05-13 16:54:03 -0400] ieldib: Otterly,  thakns i'l take a look
[2013-05-13 16:57:30 -0400] ieldib: Otterly,  just tripple checked my key id and key, both are correct, anything else i should look at ?
[2013-05-13 16:58:10 -0400] ieldib: is there any special ports aside from 22, 80 and 443 that the ec2 plugin uses
[2013-05-13 16:58:13 -0400] Cheeezit: is there a recommended way for storing a private ssh key (for accessing git hub) using chef?
[2013-05-13 17:00:11 -0400] mattupstate: Cheeezit: encrypted data bag is a good choice
[2013-05-13 17:00:44 -0400] Cheeezit: cool that's what I was thinking just wanted some community validation
[2013-05-13 17:01:36 -0400] ieldib: Otterley, ?
[2013-05-13 17:02:10 -0400] Otterley: ieldib, this is a hostname resolution error
[2013-05-13 17:02:15 -0400] Otterley: check your AWS config
[2013-05-13 17:04:37 -0400] makerbrakr: is it possible to only allow a client access to a subset of all machines?
[2013-05-13 17:05:13 -0400] doomviki1g: makerbrakr: access, in what sense?
[2013-05-13 17:05:59 -0400] makerbrakr: private chef server, w/ 10 nodes, and 3 users, 1 being admin
[2013-05-13 17:06:27 -0400] makerbrakr: I want admin to perform as normally, user 1 only access to nodes 1-5, and user 2 only access to nodes 6-10
[2013-05-13 17:06:55 -0400] makerbrakr: apply recipes, edit databags etc
[2013-05-13 17:07:06 -0400] bean: as in actual private chef, or chef-server
[2013-05-13 17:07:20 -0400] makerbrakr: private chef
[2013-05-13 17:07:50 -0400] bean: yeah, in private chef there is role-based access control apparently
[2013-05-13 17:08:10 -0400] thehar: role based acls?
[2013-05-13 17:08:11 -0400] thehar: woof
[2013-05-13 17:13:04 -0400] doomviking: I heard thats there
[2013-05-13 17:21:29 -0400] ermajn: hello, I have installed chef-server and I have setup workstation with berkshelf, now.. I do not know how to upload cookbook to chef-server that is managed by berkshelf
[2013-05-13 17:21:44 -0400] ermajn: I have added berkshelf cookbook path to my knife.rp
[2013-05-13 17:22:04 -0400] ermajn: knife.rb*
[2013-05-13 17:24:07 -0400] prana: berks upload
[2013-05-13 17:25:08 -0400] mattupstate: how can I evaluate the contents of a remote_file during the chef-client run after its been downloaded?
[2013-05-13 17:25:25 -0400] mattupstate: (within a provider)
[2013-05-13 17:32:04 -0400] agarson1: mattupstate:  what do you mean evaluate?
[2013-05-13 17:32:11 -0400] agarson1: like an instance_eval?
[2013-05-13 17:32:21 -0400] mattupstate: sorry, read its contents
[2013-05-13 17:32:57 -0400] Cope_: mattupstate: why do you want to do that?
[2013-05-13 17:33:48 -0400] mattupstate: Cope_: i need to do something conditionally based on its contents
[2013-05-13 17:36:31 -0400] agarson1: mattupstate:  are you going to be doing something with the value immediately or are you trying to get some future resource to use it?
[2013-05-13 17:37:24 -0400] mattupstate: its all in the scope of a LWRP action
[2013-05-13 17:38:15 -0400] agarson1: and you can't pass the data into the lwrp from a note attr or something?
[2013-05-13 17:39:03 -0400] mattupstate: the data is in the remote file
[2013-05-13 17:39:32 -0400] agarson1: ok
[2013-05-13 17:39:34 -0400] mattupstate: the remote file contains some stateful information, specifically a version number
[2013-05-13 17:39:52 -0400] mattupstate: and i need to compare it to the current one in the scope of the action in the LWRP
[2013-05-13 17:40:06 -0400] agarson1: you could do something sneaky like run the remote_file at compile time and then read the contents before your other resource needs it
[2013-05-13 17:40:17 -0400] mattupstate: ah right
[2013-05-13 17:40:21 -0400] mattupstate: how can i run it at compile time?
[2013-05-13 17:40:42 -0400] agarson1: some_resource "name" do; action :nothing; end.run_action(:some_action)
[2013-05-13 17:40:55 -0400] agarson1: with whatever other attrs it needs
[2013-05-13 17:41:02 -0400] mattupstate: got it
[2013-05-13 17:41:08 -0400] agarson1: but that feels really strange
[2013-05-13 17:41:09 -0400] mattupstate: let me give that a go
[2013-05-13 17:41:18 -0400] mattupstate: maybe to you ;)
[2013-05-13 17:47:17 -0400] Cope_: mattupstate: it does feel like a slightly unusual case; what are you actually trying to do? maybe there's a different approach that might be easier?
[2013-05-13 17:48:30 -0400] mattupstate: i'm trying to write an LWRP that allows me to install versioned code packages that i store on s3
[2013-05-13 17:48:52 -0400] mattupstate: i have a file that has the 'latest' version in it
[2013-05-13 17:49:02 -0400] mattupstate: and i need to compare that to the currently installed version
[2013-05-13 17:50:09 -0400] wamilton: mattupstate: would this do exactly that: http://community.opscode.com/cookbooks/ark ()
[2013-05-13 17:50:13 -0400] wamilton: ?
[2013-05-13 17:50:54 -0400] mattupstate: if it support s3, perhaps
[2013-05-13 17:51:07 -0400] mattupstate: but i'm not sure
[2013-05-13 17:53:29 -0400] makerbrakr: is it possible to have more than one set of cookboks on chef-server?
[2013-05-13 17:53:51 -0400] wamilton: makerbrakr: depends on how you define 'set' ?
[2013-05-13 17:54:27 -0400] makerbrakr: node specific sets of cookbooks
[2013-05-13 17:54:44 -0400] wamilton: makerbrakr: the chef server will store all cookbooks the same way, it's on you to define how nodes figure out what cookbooks to use
[2013-05-13 17:54:47 -0400] makerbrakr: I have 2 clients, and I want to allow them to knife upload cookbook XYZ
[2013-05-13 17:55:20 -0400] makerbrakr: but I want client 1 to see their version, nad client 2 to see their version, with no crossover
[2013-05-13 17:55:34 -0400] wamilton: makerbrakr: no, that's not possible, and it's good that it isn't
[2013-05-13 17:55:47 -0400] CaptainQuirk: Hi there !
[2013-05-13 17:56:04 -0400] CaptainQuirk: Can I use several providers for a recipe ?
[2013-05-13 17:56:05 -0400] makerbrakr: wamilton how does hosted chef do it then?
[2013-05-13 17:56:19 -0400] wamilton: makerbrakr: if you need them to have their own version of cookbooks, the right thing to do is to have them use different wrapper cookbooks around the things they would be patching
[2013-05-13 17:56:30 -0400] CaptainQuirk: I have this package I'd like to install but I would like the configuration files to be synced from github
[2013-05-13 17:58:02 -0400] wamilton: makerbrakr: are you referring to how you can have different organizations in hosted chef?
[2013-05-13 17:58:11 -0400] makerbrakr: yes
[2013-05-13 18:01:16 -0400] helllen_: helllo
[2013-05-13 18:01:31 -0400] helllen_: is chef ruby gem compatible with ruby 2.1.0 ?
[2013-05-13 18:01:45 -0400] wamilton: makerbrakr: open source chef server is always just one organization. If you absolutely need things to work this way, you pretty much need a chef server for each client/cluster that needs to be separate
[2013-05-13 18:02:33 -0400] wamilton: helllen_: compatible how? If you install with omnibus, chef executables just use their own hermetically sealed ruby
[2013-05-13 18:02:54 -0400] helllen_: I would like to use chef gem into my server but I am using ruby 2.1.0
[2013-05-13 18:03:03 -0400] helllen_: and it says it don's find the gem and it is there
[2013-05-13 18:03:11 -0400] Cope_: makerbrakr: can you clarify what you mean by client?
[2013-05-13 18:03:35 -0400] helllen_: http://pastebin.com/5HbZFzdp
[2013-05-13 18:03:49 -0400] wamilton: helllen_: yeah, you really should just use the omnibus installer so that you don't have to worry about ruby versions conflicting
[2013-05-13 18:04:20 -0400] helllen_: I would like to use into other server I have
[2013-05-13 18:04:24 -0400] helllen_: using as client
[2013-05-13 18:04:33 -0400] helllen_: I would like to access to chef
[2013-05-13 18:04:43 -0400] ieldib: yeah
[2013-05-13 18:04:46 -0400] ieldib: i've watched it before
[2013-05-13 18:05:00 -0400] makerbrakr: Cope_, freelance clients actually
[2013-05-13 18:05:18 -0400] makerbrakr: I have 2 different companies, that I freelance for, and I manage their VMs
[2013-05-13 18:05:57 -0400] makerbrakr: what Im trying to figure out, is whether I can write one set of cookbooks, and allow them to pull them down to a llocal repo, and work on stuff themselves
[2013-05-13 18:06:32 -0400] helllen_: I have installed into my system and the chef gem is there
[2013-05-13 18:06:45 -0400] helllen_: but I don't know why it doesn't find it
[2013-05-13 18:06:59 -0400] makerbrakr: but, I think it just occured to me, that I can just use open source chef server, the one-org/acl based perms, and name the cookbooks
[2013-05-13 18:07:06 -0400] makerbrakr: client_name-apache
[2013-05-13 18:07:13 -0400] makerbrakr: client_name1-apache
[2013-05-13 18:07:44 -0400] CaptainQuirk: I'm using chef-solo by the way
[2013-05-13 18:08:04 -0400] miah: you could also just use multiple open source chef servers..
[2013-05-13 18:08:21 -0400] makerbrakr: miah, ya, but that costs money lol
[2013-05-13 18:08:30 -0400] miah: howso?
[2013-05-13 18:08:35 -0400] miah: if you can run vm's?
[2013-05-13 18:08:42 -0400] makerbrakr: I have to pay for the VM
[2013-05-13 18:08:55 -0400] miah: charge them for that shit y0
[2013-05-13 18:09:12 -0400] doomviking: heh
[2013-05-13 18:09:14 -0400] makerbrakr: heh
[2013-05-13 18:09:17 -0400] makerbrakr: easier said then done
[2013-05-13 18:09:19 -0400] doomviking: big money.
[2013-05-13 18:09:41 -0400] makerbrakr: plus, im obviously hoping for more clients, so its not scalable
[2013-05-13 18:09:52 -0400] miah: a vm from linode is like $20/mo
[2013-05-13 18:09:59 -0400] miah: they aren't willing to pay that, you have bigger problems
[2013-05-13 18:10:29 -0400] makerbrakr: its not that as much as, if I have 50 cients, then Im managing 50 vms, then Im manaing 50 chef servers via my chef server etc
[2013-05-13 18:10:37 -0400] makerbrakr: pretty sure the world explodes at that point
[2013-05-13 18:10:49 -0400] Cope_: makerbrakr: right; then what you're describing is an organization
[2013-05-13 18:11:00 -0400] Cope_: makerbrakr: or if you use open source chef, a chef server
[2013-05-13 18:11:01 -0400] miah: you can definitely use chef to manage chef
[2013-05-13 18:12:41 -0400] helllen_: could someone help me with the error please ?
[2013-05-13 18:12:43 -0400] helllen_: any idea?
[2013-05-13 18:12:47 -0400] helllen_: http://pastebin.com/5HbZFzdp
[2013-05-13 18:14:26 -0400] miah: your bug isn't chef related
[2013-05-13 18:14:32 -0400] miah: /usr/local/rvm/rubies/ruby-head/lib/ruby/site_ruby/2.1.0/rubygems/core_ext/kernel_require.rb:45:in `require': cannot load such file -- rubygems/format (LoadError)
[2013-05-13 18:14:53 -0400] makerbrakr: what version of ruby are you using?
[2013-05-13 18:14:56 -0400] makerbrakr: nm
[2013-05-13 18:15:03 -0400] doomviking: #chef. We'll google that for you.
[2013-05-13 18:15:17 -0400] miah: i didnt google anything
[2013-05-13 18:15:20 -0400] miah: i jsut read the error
[2013-05-13 18:15:44 -0400] doomviking: yeah I'm kidding.
[2013-05-13 18:16:43 -0400] makerbrakr: hrm, the naming cookbooks wont work either
[2013-05-13 18:16:55 -0400] makerbrakr: nothing to prevent the 2 clients from overwriting eachothers stuff
[2013-05-13 18:17:12 -0400] miah: exactly
[2013-05-13 18:17:19 -0400] miah: multiple chef servers =)
[2013-05-13 18:17:23 -0400] makerbrakr: i cant
[2013-05-13 18:17:35 -0400] miah: enjoy the pain
[2013-05-13 18:17:39 -0400] makerbrakr: heh
[2013-05-13 18:17:50 -0400] makerbrakr: i guess i could goto chef solo, and do it that way
[2013-05-13 18:17:53 -0400] makerbrakr: via some automation
[2013-05-13 18:18:04 -0400] miah: that always makes a sad panda
[2013-05-13 18:18:30 -0400] miah: but definitly good luck figuring out which workflow will work best for your problem
[2013-05-13 18:18:37 -0400] makerbrakr: ya
[2013-05-13 18:18:41 -0400] makerbrakr: ty
[2013-05-13 18:18:53 -0400] miah: multiple chef servers will be the easiest and still feature filled way =)
[2013-05-13 18:19:12 -0400] miah: or maybe https://github.com/jkeiser/chef-zero
[2013-05-13 18:19:57 -0400] miah: going to solo you lose some useful things. i've been working in a solo infrastructure for a while now and it just drives me fucking crazy.
[2013-05-13 18:20:35 -0400] makerbrakr: im assuming hosted chef, is just a completely proprietary etc seperate way to do things
[2013-05-13 18:21:19 -0400] Cope: makerbrakr: Hosted Chef is Open Source Chef with a few extra "enterprise" features
[2013-05-13 18:21:24 -0400] miah: nah. the only things you gain from hosted chef are organizations, finer grained acl's, and somebody else is responsible for keeping your chef server up
[2013-05-13 18:21:28 -0400] Cope: plus Opscode looks after it for you
[2013-05-13 18:21:41 -0400] miah: Cope: missed you at chefconf
[2013-05-13 18:21:47 -0400] Cope: miah: for sure :(
[2013-05-13 18:21:50 -0400] Cope: miah: velocity?
[2013-05-13 18:21:54 -0400] miah: possiblyy
[2013-05-13 18:22:01 -0400] makerbrakr: are the enterprise features available to the public?
[2013-05-13 18:22:09 -0400] Cope: I'll be in town a bit early - I'm speaking at Cisco before
[2013-05-13 18:22:16 -0400] makerbrakr: ie, can I recreate enterprise chef somehow?
[2013-05-13 18:22:23 -0400] miah: Cope: cool. i'll likely be at devopsdays
[2013-05-13 18:22:26 -0400] Cope: makerbrakr: no; you can pay for it.
[2013-05-13 18:22:27 -0400] miah: makerbrakr: know erlang?
[2013-05-13 18:22:47 -0400] Cope: miah: will be awesome to see you
[2013-05-13 18:23:01 -0400] miah: you could certainly add those features, but erlang is a high barrier to entry for most people =)
[2013-05-13 18:23:09 -0400] miah: Cope: certainly
[2013-05-13 18:32:53 -0400] Cope: makerbrakr: why can't you have multiple chef servers?
[2013-05-13 18:33:36 -0400] makerbrakr: well, Im a shitty salesman
[2013-05-13 18:34:04 -0400] Cope: I'd always recommend OHC tbh - treat it as a given - you care about it, so you pay a little to have it always there and always working; and you can focus on delivering value, and not managing erlang and solr
[2013-05-13 18:35:23 -0400] jtimberman: makerbrakr: we have Opscode Private Chef.
[2013-05-13 18:35:33 -0400] jtimberman: makerbrakr: it has feature parity with hosted chef.
[2013-05-13 18:35:54 -0400] jtimberman: http://www.opscode.com/chef/#which-chef
[2013-05-13 18:37:11 -0400] makerbrakr: jtimberman, so with private chef, I could almost be a "reseller" of open source chef serveres?
[2013-05-13 18:37:13 -0400] makerbrakr: servers
[2013-05-13 18:37:34 -0400] jtimberman: makerbrakr: they wouldn't be open source chef servers.
[2013-05-13 18:37:47 -0400] jtimberman: they would be organizations of the Private Chef Server (to get frankly pedantic about it :))
[2013-05-13 18:37:52 -0400] Cope: makerbrakr: no, private chef and hosted chef are the same; one is hosted, one is on premis.
[2013-05-13 18:37:53 -0400] phessler: with private chef, you still need to talk to their sales department
[2013-05-13 18:38:14 -0400] jtimberman: And as far as reselling goes, I am not sure what that looks like, but we have an account team that would be able to answer that.
[2013-05-13 18:38:35 -0400] makerbrakr: could I build a service on top of that?
[2013-05-13 18:38:46 -0400] Cope: sure
[2013-05-13 18:38:55 -0400] jtimberman: Probably :)
[2013-05-13 18:39:12 -0400] makerbrakr: ie, if I wanted a 1 click deploy of a VM w/ passenger, I could utilize hosted/private chef
[2013-05-13 18:40:18 -0400] miah: you could utilize any chef server so long as yu built out a way to do '1 click deploy' ontop of it =)
[2013-05-13 18:40:38 -0400] makerbrakr: ok, but hosted chef, I can still create orgs, which in my case would a single client
[2013-05-13 18:41:01 -0400] jtimberman: yeah
[2013-05-13 18:41:15 -0400] jtimberman: that's probably easier than standing up a whole chef server ;)
[2013-05-13 18:41:22 -0400] makerbrakr: and then, I could have a completely seperate site that I built, that could bootstrap a VM on some random cloud host, privsion a VM, and check it into the org
[2013-05-13 18:41:25 -0400] jtimberman: which is what you'd have to do with open source chef server.
[2013-05-13 18:41:55 -0400] makerbrakr: ok, Im pretty familiar with open source chef serve, just not the hosted stuff
[2013-05-13 18:44:54 -0400] makerbrakr: what are prices at 1000 nodes?
[2013-05-13 18:45:13 -0400] Cope: makerbrakr: we can take this offline
[2013-05-13 18:50:54 -0400] kgraham: hello, i am encountering this https://github.com/opscode/chef/pull/734 , and also the '/root/.git/config' error, is there a fix i can use by installing/updating chef via rubygems
[2013-05-13 18:58:51 -0400] kgraham: i am currently using 10.26.0, but get the git error, when i upgrade to 11.4 i get both
[2013-05-13 18:59:03 -0400] kgraham: i don't know which verison will not cause the error
[2013-05-13 19:16:05 -0400] justizin: anyone use knife-cfn (for aws cloudformation) or knife-aws-extensions, and know if there are branches which get them working on chef 11?
[2013-05-13 19:42:38 -0400] denken: https://gist.github.com/anonymous/21041e04e44a836bee4e database::mysql provides Mysql.new, right? i cant figure out why this wont work.
[2013-05-13 19:43:13 -0400] denken: im a ruby noob though. it may be obvious to anyone experienced.
[2013-05-13 19:47:32 -0400] gyre008: guys I have the following resource in one of my packages https://gist.github.com/milosgajdos83/5570928
[2013-05-13 19:47:56 -0400] gyre008: when I check the list of updated resources on every chef run this resource is being shown as UPDATED..on every run
[2013-05-13 19:48:14 -0400] gyre008: is there some kind of idempotency problem with service resource or am I missing something ?
[2013-05-13 19:48:27 -0400] gyre008: strangely other services are not being reported as updated mm
[2013-05-13 19:48:56 -0400] gleam: you may need to set a pattern for it
[2013-05-13 19:49:14 -0400] gleam: if the process it starts is named "accounting" or something instead of acct, it won't match
[2013-05-13 19:49:47 -0400] gleam: if the init script supports the status command then it'll do that instead of looking in the process list
[2013-05-13 19:49:51 -0400] gleam: so that'd be the other thing to look at
[2013-05-13 19:50:27 -0400] gyre008: gleam: I see...well status doesnt seem to be supported...mm
[2013-05-13 19:50:53 -0400] gleam: if status isn't supported + the process that's spawned doesn't match against the service name
[2013-05-13 19:50:58 -0400] gleam: then use the pattern option
[2013-05-13 19:51:06 -0400] gleam: pattern attribute
[2013-05-13 19:51:44 -0400] gyre008: I see...damn I just need to find out how is that damn service named :) I mean how is it name in proctile
[2013-05-13 19:51:45 -0400] gyre008: messy
[2013-05-13 19:52:16 -0400] mattupstate: am I crazy or can you not link directories with the `link` resource in chef?
[2013-05-13 19:53:08 -0400] mattupstate: I keep getting the "Errno::EISDIR"  "is a directory" error
[2013-05-13 19:54:14 -0400] jessicab1: mattupstate: the name attribute needs to be the directory youre creating, cant already exist.. maybe you have the paths swapped?
[2013-05-13 19:55:02 -0400] mattupstate: oh
[2013-05-13 19:55:02 -0400] mattupstate: ha
[2013-05-13 19:55:15 -0400] mattupstate: i feel dumb now
[2013-05-13 19:55:21 -0400] awgross: Is there a good way to define logstash inputs/outputs outside of the chef-logstash attributes file? Seems a little off to have to define them all in one place
[2013-05-13 19:58:08 -0400] gleam: presumably you could put them in an environment, a role, or a recipe
[2013-05-13 19:58:11 -0400] gleam: or an individual node
[2013-05-13 20:07:19 -0400] jameson__: mattupstate: i do the which side is the right one for link provider every time, usually twice.
[2013-05-13 20:11:37 -0400] miah: 'man ln' will save you some time in the future
[2013-05-13 20:13:31 -0400] mattupstate: oh give me a break
[2013-05-13 20:14:29 -0400] jameson__: :\
[2013-05-13 20:19:09 -0400] ieldib: Otterley, thanks for the help earlier, I was able to identify the problem as being a misspelled region zone :)
[2013-05-13 20:24:42 -0400] AckZ: hey all, I notice that in chef-client 11.4, when a template is rendered, the contents of the rendered file are displayed on the screen.. is that something that can be disabled?  makes me a little nervous
[2013-05-13 20:28:01 -0400] zackf: why in chef 11, the template is not defaulted to chef-full?
[2013-05-13 20:28:04 -0400] zackf: knife
[2013-05-13 20:29:19 -0400] pcn: Ohai chefs, I'm looking for help with a cron failure in 10.24.0.  It doesn't look like the issues I see that have been addressed recently based on their description.  Does anyone have any theories on this: https://gist.github.com/pcn/5571233
[2013-05-13 20:29:21 -0400] pcn: ?
[2013-05-13 20:41:41 -0400] juliancdunn: pcn: that looks like the cron command is returning exit code 1
[2013-05-13 20:41:58 -0400] juliancdunn: turn on debugging and try to run the provider's command by hand?
[2013-05-13 20:46:22 -0400] Otterley: pcn: also, I recommend using cron_d (provided by the Opscode cron cookbook) instead of the builtin cron provider
[2013-05-13 20:47:00 -0400] Otterley: also, "%" must be escaped in crontabs, see the manpage
[2013-05-13 20:47:24 -0400] juliancdunn: Otterley: yup, I've shot myself in the foot with that too :-(
[2013-05-13 20:47:49 -0400] gyre008: is there some bug in Opscode chef_handler cookbook which is updating resources even when they havent changed ?
[2013-05-13 20:48:17 -0400] Otterley: you're probably better off making that cron job a script
[2013-05-13 20:48:28 -0400] juliancdunn: gyre008: haven't seen such a thing - gist more deets?
[2013-05-13 20:48:41 -0400] gyre008: https://gist.github.com/milosgajdos83/5571394
[2013-05-13 20:48:44 -0400] pcn: Thanks for those words.  Let me check a couple of versions of the the manpage
[2013-05-13 20:48:48 -0400] gyre008: is being reported as updated on every run
[2013-05-13 20:51:29 -0400] juliancdunn: gyre008: that's weird
[2013-05-13 20:51:41 -0400] gyre008: yess
[2013-05-13 20:52:48 -0400] juliancdunn: gyre008: I'm suspicious of the code in the cookbook
[2013-05-13 20:52:52 -0400] juliancdunn: in particular this: https://github.com/opscode-cookbooks/chef_handler/blob/master/providers/default.rb#L43
[2013-05-13 20:53:26 -0400] gyre008: yeah I was literally JUST looking at the same piece of code...
[2013-05-13 20:54:28 -0400] juliancdunn: really should do some checksum comparisons on the current resource versus new resource before doing converge_by
[2013-05-13 20:55:34 -0400] juliancdunn: so in short, possibly/probably a bug :-P
[2013-05-13 20:55:49 -0400] miah: chef_handler is written as a lwrp?
[2013-05-13 20:56:04 -0400] juliancdunn: miah: yup
[2013-05-13 20:56:05 -0400] miah: wouldn't have thought that
[2013-05-13 20:57:01 -0400] gyre008: I guess the reason for that is to make it available at compile time - ie first run it has been  "introduced" ?
[2013-05-13 20:57:24 -0400] gyre008: although...mm
[2013-05-13 21:05:41 -0400] rava: anyone know if there's a way to pass options to the subversion provider beyond the listed attributes in the docs?
[2013-05-13 21:09:13 -0400] juliancdunn: rava: svn_arguments parameter?
[2013-05-13 21:10:13 -0400] rava: juliancdunn: thanks, somehow i missed that param when reading the docs
[2013-05-13 21:10:14 -0400] juliancdunn: lol
[2013-05-13 21:44:30 -0400] gzc: out of curiosity, where should someone go to find videos from chefconf? :)
[2013-05-13 21:44:33 -0400] rava: hrm, i'm passing a destination to the subversion resource just to have it do a :sync action, but keeps puking with a '.' is not a working copy
[2013-05-13 21:44:51 -0400] gzc: oh wait durr of course it's the last thing i try http://www.youtube.com/playlist?list=PL_UKe_Br3FSWzbKALVLLz5Hig3DlxMQqh
[2013-05-13 21:44:58 -0400] rava: the directory passed to the destination attr exists, and has a current checkout
[2013-05-13 21:49:37 -0400] rava: turns out repository attr isn't optional ^^;
[2013-05-13 21:55:07 -0400] miah: go figure =)
[2013-05-13 21:56:03 -0400] awgross: is it possible to call library methods directly without running Chef::Blah include MyModule::Namespace end
[2013-05-13 21:56:26 -0400] awgross: something similar to MyModule::Namespace.my_metyh
[2013-05-13 21:56:44 -0400] awgross: well, not, its it possible (because it is not be default), but is there someway to get it to that point
[2013-05-13 21:57:42 -0400] miah: yes
[2013-05-13 21:57:51 -0400] jtnz: Hi there, I have a question about upgrading from Chef 10 server to Chef 11, following this guide: http://www.opscode.com/blog/2013/03/12/5106/
[2013-05-13 21:57:55 -0400] awgross: miah: can you point me to an example?  having trouble navigating it
[2013-05-13 21:58:07 -0400] miah: just make a file called 'default.rb' in your libraries directory. put methods in it.
[2013-05-13 21:58:13 -0400] miah: dont wrap it in class ceramony
[2013-05-13 21:58:21 -0400] miah: use those methods in your recipes
[2013-05-13 21:58:21 -0400] awgross: so only default.rb gets autoloaded?
[2013-05-13 21:58:31 -0400] miah: afaik, but i am often wrong
[2013-05-13 21:58:40 -0400] awgross: i have them in a lib file, but not called default.rb
[2013-05-13 21:58:43 -0400] awgross: ill check it out, thanks
[2013-05-13 21:58:45 -0400] spox: awgross: you can just inject it directly into the recipe class
[2013-05-13 21:58:55 -0400] miah: that requires more ceramony :P
[2013-05-13 21:58:56 -0400] spox: that way the methods stay confined within
[2013-05-13 21:59:02 -0400] jtnz: One problem is that Chef 10 has the api on port 4000, non https. Chef 11 is https (on port 443). How can I easily migrate nodes over without having to change all the client.rb files?
[2013-05-13 21:59:04 -0400] spox: also reduces pollution
[2013-05-13 21:59:17 -0400] spox: module MyCoolStuff; def do_stuff; end; end;
[2013-05-13 21:59:28 -0400] spox: Chef::Recipe.send(:include, MyCoolStuff)
[2013-05-13 21:59:32 -0400] spox: that's your lib file
[2013-05-13 21:59:34 -0400] miah: jtnz: man iptables search 'redirect'
[2013-05-13 21:59:38 -0400] awgross: spox: i used ot inject it, been running in to some namespace collisions.  Ideally I will refactor a bit and create some library cookbooks instead of replicating
[2013-05-13 21:59:39 -0400] spox: now all recipes have do_stuff
[2013-05-13 22:00:13 -0400] jtnz: miah, ah, so have iptables on the Chef 11 server redirect any 4000 connections to 443. nice
[2013-05-13 22:01:08 -0400] jtnz: then work on changing client.rb (via template) to use the new port. Another related question: Chef 10 was port 4000 for the API and 4040 for webui. Chef 11 just uses the one endpoint now?
[2013-05-13 22:04:56 -0400] awgross: on a different note, anyone experience issues with hosted chef where a chef-client daemon run will keep failing due to some old bug in your code, but manual runs of Chef-client will work fine.  It's like there is some cache that is not being cleared
[2013-05-13 22:06:03 -0400] willejs: i haven't, but you could try to clear /var/chef/cache
[2013-05-13 22:06:18 -0400] willejs: its a longshot
[2013-05-13 22:06:42 -0400] willejs: how does everyone pre bake their aim's? script it with boto/fog?
[2013-05-13 22:08:28 -0400] willejs: *AMI's
[2013-05-13 22:12:25 -0400] awgross: miah: doesnt look like using the default.rb lets you access methods just be prefixing their module namespace
[2013-05-13 22:13:24 -0400] miah: i gueess i was wrapping it
[2013-05-13 22:13:24 -0400] miah: https://github.com/miah/percona-install/blob/master/libraries/default.rb
[2013-05-13 22:13:34 -0400] jtnz: Just confirming, Chef 11 now uses port 443 for both API and webui? vs 4000 & 4040 respectively in Chef 10.
[2013-05-13 22:13:59 -0400] miah: jtnz: yes, use netstat to verify =)
[2013-05-13 22:14:10 -0400] mattupstate: is it possibly to subscribe to a resource's notification from another recipe/cookbook?
[2013-05-13 22:14:38 -0400] awgross: ok, thanks anyways
[2013-05-13 22:21:21 -0400] techminer: running chef-client 11.4.4.  Any thoughts as to why ohai would not be getting data for the dmi plugin?
[2013-05-13 22:21:53 -0400] techminer: all my nodes have empty ohai attributes under the dmi heading
[2013-05-13 22:29:14 -0400] shane__: how do you rotate the validation.pem ?
[2013-05-13 22:31:39 -0400] silk: rotate?
[2013-05-13 22:33:12 -0400] miah: you can delete validation.pem as soon as the client is registered.
[2013-05-13 22:33:49 -0400] behemphi: OK, I have a _very_ strange issue.  If I use a script resource and issue tar -xzf file.name I get permission denied.  BUT if I change `script` to `bash` it works just fine
[2013-05-13 22:34:12 -0400] behemphi: I cannot come up with any explanation for this
[2013-05-13 22:35:20 -0400] behemphi: Is there a reasonable explanation for this.  To my knowledge tar is not tied to any shell
[2013-05-13 22:35:31 -0400] behemphi: so I am sort of stunned at this point
[2013-05-13 22:45:52 -0400] ermajn_: hello, after changing default ruby version from 1.8 to 1.9, I can not start chef-client
[2013-05-13 22:45:57 -0400] jameson__: what was the benefit of doing
[2013-05-13 22:46:02 -0400] ermajn_: I got: /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mixlib/authentication/signedheaderauth (LoadError)
[2013-05-13 22:46:30 -0400] ermajn_: i have changed it because one of my cookbooks, it is 1.9 only
[2013-05-13 22:46:49 -0400] jameson__: notifies :reload, "service(nginx)" vs service "nginx" do action :reload end ?
[2013-05-13 22:49:06 -0400] spheromak: jameson__, one is a service action in a resrource, the other is a notification of a service to take an action
[2013-05-13 22:49:19 -0400] spheromak: with notfies you can have a resource tell another resource to do something
[2013-05-13 22:50:10 -0400] jameson__: aren't I achieving the same goal if I add "service  do " after say a provider action as if i did "notifies :immediately"
[2013-05-13 22:51:34 -0400] jameson__: specialsauce: I'm having issues with 'notifies :reload, "service[nginx]"' again.
[2013-05-13 22:51:50 -0400] jameson__: spheromak: ^
[2013-05-13 22:52:00 -0400] jameson__: whoops wrong mention
[2013-05-13 22:52:02 -0400] spheromak: well you are redefining the service.  and you aren't being declarative about the dependencies of the calling resource on the service action. Notifications should be the way to go here.
[2013-05-13 22:52:10 -0400] spheromak: jameson__, whats the issue ?
[2013-05-13 22:53:17 -0400] jameson__: it was the "resource not defined nginx"
[2013-05-13 22:53:27 -0400] spheromak: service not defined.
[2013-05-13 22:53:34 -0400] jameson__: when it was resource(:service, "nginx")
[2013-05-13 22:53:41 -0400] tlr00: I am trying to find a way to generate random passwords in chef. Is it best to just keep it stored in a data_bag and call it good?
[2013-05-13 22:54:01 -0400] jameson__: switched it to "service[nignx]"
[2013-05-13 22:54:14 -0400] spheromak: jameson__, thats the older syntax on notification, and yea should use the newer syntax.
[2013-05-13 22:54:25 -0400] jameson__: but now it's giving me the NoMethodError - undefined method `run_action' for "service[nginx]":String
[2013-05-13 22:54:32 -0400] spheromak: tlr00, depending on how secure you want to be
[2013-05-13 22:54:38 -0400] jameson__: maybe because this is on OpsWorks(?) on chef9?
[2013-05-13 22:54:44 -0400] spheromak: jameson__, gimme a gist
[2013-05-13 22:54:57 -0400] spheromak: jameson__, ah .. yea
[2013-05-13 22:55:17 -0400] jameson__: the service string isn't introduced until chef10 aint it?
[2013-05-13 22:55:40 -0400] spheromak: jameson__, use the old syntax, should be fine.. but chef 0.9 needed a resource to be defined before it was refrenced in a notification
[2013-05-13 22:56:05 -0400] spheromak: so you need to do a service "nginx"  do action :nothing end
[2013-05-13 22:56:13 -0400] spheromak: before your resource that notifies..
[2013-05-13 22:56:16 -0400] jameson__: +_+
[2013-05-13 22:56:27 -0400] spheromak: otherwise compile phase will puke with resource not found
[2013-05-13 22:56:31 -0400] miah: order matters
[2013-05-13 22:56:51 -0400] spheromak: miah it did in 0.9  for this stuff. no so much anymore
[2013-05-13 22:57:01 -0400] jameson__: I was hoping that the resource definition would hang around somewhere.
[2013-05-13 22:57:09 -0400] miah: true, but its still tricky if the resource doesnt 'exist' in some way prior to being sent an action
[2013-05-13 22:57:21 -0400] miah: its still crazy frustrating to see issues like that =)
[2013-05-13 22:57:24 -0400] spheromak: yeap
[2013-05-13 22:57:26 -0400] jameson__: i just realized that it's breaking because I am not making it re-run the nginx cookbook.
[2013-05-13 22:57:49 -0400] jameson__: and it used do include_recipe nginx.
[2013-05-13 22:58:02 -0400] spheromak: why did opsworks launch on 0.9 :(  hope it gets up to 11 soon :\
[2013-05-13 22:58:09 -0400] jameson__: i pray to god it does
[2013-05-13 22:58:17 -0400] jameson__: if they aren't by the end of the year
[2013-05-13 22:58:22 -0400] miah: opsworks not launching on a recent version of chef means = ignore it
[2013-05-13 22:58:23 -0400] jameson__: I am moving us to hosted chef 11
[2013-05-13 22:58:32 -0400] spheromak: miah, pretty much agree
[2013-05-13 22:58:35 -0400] miah: kind of like going to engine yard
[2013-05-13 22:58:38 -0400] miah: and getting chef 0.6
[2013-05-13 22:58:41 -0400] spheromak: heh]
[2013-05-13 22:58:47 -0400] jameson__: -_-
[2013-05-13 22:58:51 -0400] miah: at least their new ami's have chef 10.16
[2013-05-13 22:59:13 -0400] miah: but you can't directly go from v2 or v3 to v4. have to rebuild your entire environment
[2013-05-13 22:59:23 -0400] miah: might as well say "go fuck yourself"
[2013-05-13 22:59:41 -0400] jameson__: miah, spheromak: I do have to redeclare the service resource in an lwrp?
[2013-05-13 22:59:51 -0400] miah: in a lwrp?
[2013-05-13 22:59:56 -0400] jameson__: yeah
[2013-05-13 23:00:12 -0400] miah: if you are sending a notification to a resource that might not yet exist you must define it
[2013-05-13 23:00:24 -0400] jameson__: mm, that's the real issue then.
[2013-05-13 23:00:29 -0400] jameson__: ok I will try that.
[2013-05-13 23:01:27 -0400] miah: observer pattern is tricky, and i dont think chef's notify/subscription stuff is really based onit =) http://en.wikipedia.org/wiki/Observer_pattern
[2013-05-13 23:01:49 -0400] miah: thats kind of the idea though
[2013-05-13 23:02:58 -0400] miah: chef just plays run list games with notifications, either inserting things next in the run list (immediate) or appending to the end (delayed) rather than modifying the object and adding a object to the list of subscribers
[2013-05-13 23:07:36 -0400] jameson__: miah: does this mean that in every lwrp, should do service :nothing?
[2013-05-13 23:08:06 -0400] miah: every resource should support :nothing and if you subclass Chef::Resource or Chef::Provider then those methods are already defined
[2013-05-13 23:08:19 -0400] miah: you just need to make sure that allowed_actions also lists :nothing
[2013-05-13 23:08:28 -0400] miah: but yes, all resource providers should/do support nothing
[2013-05-13 23:14:59 -0400] jameson__: mm sounds reasonable, thx miah, spheromak.
[2013-05-13 23:15:40 -0400] miah: erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-05-13 23:15:43 -0400] miah: ^- good reading
[2013-05-13 23:39:53 -0400] shane_: Invalid signature for user or client 'chef-validator'
[2013-05-13 23:40:04 -0400] shane_: getting this when trying to bootstrap after upgrading server to chef 11
[2013-05-13 23:40:24 -0400] shane_: made sure validation.pem being used on the client is the same one on the server
[2013-05-13 23:45:07 -0400] miah: did you restart chef to really verify that its the same validation.pem being used? =)
[2013-05-13 23:45:21 -0400] miah: you could also rm the validation.pem on your chef server and restart it, when it starts it will create a new one
[2013-05-13 23:46:05 -0400] shane_: yes
[2013-05-13 23:46:11 -0400] Chef: ugh how do I get a list of names from search(:node, "") instead of a list of node objects?
[2013-05-13 23:46:18 -0400] Chef: my ruby-fu is weak :(
[2013-05-13 23:46:36 -0400] shane_: then i copied the chef-validator.pem to the client
[2013-05-13 23:46:41 -0400] shane_: from /etc/chef-server
[2013-05-13 23:46:52 -0400] awgross: Chef: i think by default search will always return node objects, but you can access it
[2013-05-13 23:46:58 -0400] whack: what would prevent 'knife bootstrap' from working but 'knife node list' and other stuff works? I get 'Failed to authenticate as jsissel-validator'
[2013-05-13 23:47:12 -0400] miah: foo = search(). foo.each {|i| i.name }
[2013-05-13 23:47:35 -0400] Chef: oh
[2013-05-13 23:47:36 -0400] Chef: duh
[2013-05-13 23:47:36 -0400] awgross: ^
[2013-05-13 23:47:41 -0400] awgross: dont worry
[2013-05-13 23:47:41 -0400] Chef: thanks!
[2013-05-13 23:47:43 -0400] miah: whack: node list etc uses your actual client key
[2013-05-13 23:47:44 -0400] awgross: search can be a bit confusing
[2013-05-13 23:47:54 -0400] whack: miah: and bootstrap uses what?
[2013-05-13 23:47:56 -0400] miah: the valiidator is a one-off key thats only used for authenticating unauthenticated clients
[2013-05-13 23:48:06 -0400] whack: miah: hmm
[2013-05-13 23:48:16 -0400] miah: you could tehnically use any key that has admin privileges
[2013-05-13 23:48:29 -0400] miah: for bootstrapping, but validator is easier to deal with
[2013-05-13 23:48:33 -0400] whack: I guess I'll generate a new validation key
[2013-05-13 23:51:15 -0400] log1kal: whack: : I had that issue becuase I hadn't set validation_key in my knife.rb
[2013-05-13 23:51:35 -0400] log1kal: or because my validation_client_name was incorrect
[2013-05-13 23:52:35 -0400] miah: good points
[2013-05-13 23:52:37 -0400] whack: log1kal: I don't know what the cause was, since I've bootstrapped many servers before. Probably fatfingered a new chef server user setup or something a while ago
[2013-05-13 23:52:50 -0400] whack: we have too many chef servers+orgs here (more than 1 is too many!)
[2013-05-13 23:53:08 -0400] miah: sounds fun
[2013-05-13 23:53:18 -0400] miah: i just have a single org with many environments
[2013-05-13 23:53:27 -0400] shane_: is the process for recreating the chef-validator.pem different on chef server 11.x ?
[2013-05-13 23:53:38 -0400] shane_: i've removed the key and restarted everything via the ctl
[2013-05-13 23:53:44 -0400] shane_: no key regenerated
[2013-05-13 23:53:45 -0400] whack: miah: that'd be my preference :(
[2013-05-13 23:58:29 -0400] benkay: here's a hilarious: i ssh into node, enter 'sudo chef-client', and abso-freaking-lutely nothing happens. any ideas on what i broke?
