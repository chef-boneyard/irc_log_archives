[2013-05-10 00:17:00 -0400] silk: Seeing elevated error rates for hosted chef
[2013-05-10 00:17:20 -0400] heydrick: same here
[2013-05-10 00:18:31 -0400] silk: Havent seen anything on status.opscode.com yet.
[2013-05-10 01:13:29 -0400] felipe__: Guys, I have a quick question on the 'berkshelf way'. Am I supposed to have one Git repository per cookbook?
[2013-05-10 01:14:40 -0400] denken: felipe__: thats the idea, yes
[2013-05-10 01:15:49 -0400] felipe__: denken: could you have several cookbooks in a single repository or would it break?
[2013-05-10 01:15:50 -0400] denken: so this is frustrating... 'knife node from file blah.json' basically nukes the state of that node on the chef server, even if it doesnt change the node in any way
[2013-05-10 01:16:57 -0400] denken: im trying to store all nodes in git along with data bags and everything else... so automating a 'git pull && knife upload <blah' doesnt seem workable if i want node searching and so forth to work properly
[2013-05-10 01:17:38 -0400] denken: felipe__: i believe that would break the way berkshelf works... but implementing berkshelf is next on my list ;)
[2013-05-10 01:17:43 -0400] denken: so i am not an authority just yet
[2013-05-10 01:19:31 -0400] |rt|: berkshelf would work fine with multiple cookbooks in a repo but it does hinder leveraging all the benefits that having a 1 cookbook per repo gives you
[2013-05-10 01:19:56 -0400] |rt|: for instance using tags and keeping pull requests and branches sane
[2013-05-10 01:20:43 -0400] |rt|: add to that continuous integration testing with something like Jenkins and having multiple cookbooks in a repo gets messy quick
[2013-05-10 01:21:56 -0400] felipe__: rt - thanks a lot
[2013-05-10 01:22:07 -0400] |rt|: it may break a couple of things in berkshelf now that I think about it
[2013-05-10 01:22:49 -0400] |rt|: if you have a Berksfile setup to satisfy cookbook dependancies using git repos it may not work in that case
[2013-05-10 01:57:02 -0400] denken: https://github.com/adamhjk/chef-github-hook
[2013-05-10 01:57:05 -0400] denken: that looks promising
[2013-05-10 02:00:43 -0400] chip-: If you're really into the idea of uploading untested code directly from your source repo to your artifact repo, then that is an excellent way to make the mistake.
[2013-05-10 02:01:26 -0400] chip-: Amended: That may e an excellent way to make the mistake.
[2013-05-10 02:05:54 -0400] denken: im just looking for an automated way to keep a given chef server in sync with a given git branch
[2013-05-10 02:05:57 -0400] BrianJ: hey I'm getting RedirectLimitExceeded when i try to install sql server on a windows ec2 machine windows 2008 rc2
[2013-05-10 02:06:06 -0400] BrianJ: not too much luck googling this.. anyone else experience this problem?
[2013-05-10 02:06:19 -0400] denken: testing is another question entirely, im my mind... but im interested in your thoughts chip-
[2013-05-10 02:06:40 -0400] coderanger: denken: We generally see people using Jenkins rather than github hooks
[2013-05-10 02:06:45 -0400] chip-: denken: My short answer is Jenk- what he said.
[2013-05-10 02:06:53 -0400] coderanger: denken: And in Chef 11 you can just use knife upload *
[2013-05-10 02:07:12 -0400] denken: coderanger: that doesnt remove any stale data from the chef server
[2013-05-10 02:07:14 -0400] coderanger: (some additional logic to deal with removing stuff I suppose, but thats rather rare)
[2013-05-10 02:07:24 -0400] denken: right
[2013-05-10 02:07:54 -0400] coderanger: But as others have said, this is reeeeeally not recommended in such a raw form
[2013-05-10 02:08:31 -0400] denken: also, 'knife upload *' of unchanged data (say, a node.json file) does bad things to 'knife search'... i havent given much thought to how much of a problem that really is, but its there.
[2013-05-10 02:09:00 -0400] denken: nagios hosts.cfg comes to mind
[2013-05-10 02:09:27 -0400] coderanger: denken: Storing nodes in scm is also generally not recommended :)
[2013-05-10 02:09:50 -0400] denken: where else should you store them?
[2013-05-10 02:09:55 -0400] coderanger: The chef server?
[2013-05-10 02:10:24 -0400] coderanger: Node objects should generally be considered a disposable implementation detail, if a server goes down you just make a new one :)
[2013-05-10 02:10:56 -0400] denken: and if the chef server goes does and you make a new one?
[2013-05-10 02:11:03 -0400] denken: s/does/down/
[2013-05-10 02:11:22 -0400] coderanger: You restore from backup?
[2013-05-10 02:11:30 -0400] coderanger: (via pgrestore or similar)
[2013-05-10 02:12:08 -0400] denken: backup = git, hopefully :)
[2013-05-10 02:12:25 -0400] denken: i'd like the chef server to be a disposable object like any other, with scm being the authority for all the things
[2013-05-10 02:12:43 -0400] denken: its not out of the question that i might be crazy though heh
[2013-05-10 02:12:44 -0400] coderanger: Then you probably want to be using chef-solo
[2013-05-10 02:13:00 -0400] coderanger: Chef-server is the authority, you can't really work around that
[2013-05-10 02:13:51 -0400] coderanger: If you want to build your own SPoT around git instead, chef-solo gives you the chef side of things, but you still need to build all the other pieces of the backplance
[2013-05-10 02:13:55 -0400] coderanger: er, backplane
[2013-05-10 02:14:26 -0400] coderanger: Which is fine, I mean thats basically what things like rightscale and opsworks are, but its definitely not a small amount of work
[2013-05-10 02:15:15 -0400] denken: interesting
[2013-05-10 02:15:25 -0400] denken: in your opinion, what should be in version control then?
[2013-05-10 02:15:30 -0400] coderanger: (and it also isn't impossible to do what you are describing where you setup a one-directional sync into the chef server from another SPoT, just ends up being error prone)
[2013-05-10 02:15:30 -0400] denken: just cookbooks and roles?
[2013-05-10 02:15:40 -0400] coderanger: And some bags, depending on how they are used
[2013-05-10 02:15:42 -0400] coderanger: and envs
[2013-05-10 02:16:15 -0400] denken: so everything but node objects
[2013-05-10 02:16:32 -0400] coderanger: cookbooks+roles+envs == the code that describes your infra
[2013-05-10 02:16:45 -0400] coderanger: nodes == the implementation of that code on actual machines
[2013-05-10 02:17:08 -0400] coderanger: and data bags just kind of sit off to the side, in a theoretically perfect world you would never use them, but they turn out to be handy :)
[2013-05-10 02:17:53 -0400] denken: the facebook talk at chefconf got me interesting in the idea of putting hashes in databags
[2013-05-10 02:18:07 -0400] denken: interested*
[2013-05-10 02:18:17 -0400] coderanger: hashes?
[2013-05-10 02:18:41 -0400] denken: every possible sysctl value, for example
[2013-05-10 02:18:59 -0400] denken: then use attribute overrides
[2013-05-10 02:19:12 -0400] denken: remove the override and the value reverts
[2013-05-10 02:19:24 -0400] |rt|: denken: why not put that hash in the attributes for the cookbook managing them
[2013-05-10 02:19:25 -0400] denken: idempotency, up a level, basically
[2013-05-10 02:20:09 -0400] coderanger: Ahh, I mean they do it in node attrs, but bags works too I guess?
[2013-05-10 02:20:15 -0400] denken: |rt|: im just saying it was interesting ;)
[2013-05-10 02:20:21 -0400] coderanger: But yeah, thats the same model I've been working on for other things
[2013-05-10 02:20:32 -0400] |rt|: denken: yes but I believe facebook was doing it in the attributes
[2013-05-10 02:20:33 -0400] coderanger: You can do it in other ways though :)
[2013-05-10 02:20:48 -0400] coderanger: Trying to keep things resource-oriented
[2013-05-10 02:21:01 -0400] coderanger: but have enough logic to remove things on the system that don't have a matching resource
[2013-05-10 02:21:06 -0400] coderanger: (for managed collections)
[2013-05-10 02:22:04 -0400] denken: so, to go back to the question of node objects in scm... are you just not worried about tracking what objects were changed, by who, etc. ?
[2013-05-10 02:22:20 -0400] denken: or do you spelunk through logs to find that out if it ever comes up?
[2013-05-10 02:24:42 -0400] coderanger: Yeah, and we are also working on audit logging inside the server, though that will probably be a OHC/OPC feature (and not any time soon)
[2013-05-10 02:26:23 -0400] coderanger: (yeah as in we just check the erchef logs)
[2013-05-10 02:27:05 -0400] denken: interesting
[2013-05-10 02:27:23 -0400] denken: well youve given me a couple things to ponder
[2013-05-10 02:27:25 -0400] denken: thanks :)
[2013-05-10 02:28:00 -0400] coderanger: The issue with nodes in git is mostly that any changes in the node will get overwritten, which screws with search results et al
[2013-05-10 02:28:22 -0400] coderanger: You could build something a little more custom that just stores run lists in git maybe
[2013-05-10 02:28:30 -0400] coderanger: so that it doesn't stomp on attr data
[2013-05-10 02:30:08 -0400] coderanger: But at least with OHC/OPC that will prevent anyone from making changes through the webui ;-)
[2013-05-10 03:21:58 -0400] AntonioR1beiro: One thing I didn't got yet, do I need vagrant to run chef? Can't I just run it on a box I already have?
[2013-05-10 03:28:52 -0400] denken: AntonioR1beiro: no, you dont need it
[2013-05-10 03:29:03 -0400] denken: vagrant and chef are just complementary tools
[2013-05-10 03:29:50 -0400] AntonioR1beiro: denken: how would you run chef on this repository? https://github.com/englishm/chef-solo-pattern
[2013-05-10 03:29:55 -0400] AntonioR1beiro: I mean chef-solo
[2013-05-10 03:30:08 -0400] AntonioR1beiro: chef-solo chef/solo.rb?
[2013-05-10 03:31:21 -0400] AntonioR1beiro: denken: the problem is that in every single example I found about chef-solo and berkshelf vagrant was involved... :/
[2013-05-10 03:32:30 -0400] AntonioR1beiro: even in learnchef: https://learnchef.opscode.com/
[2013-05-10 03:49:36 -0400] denken: i havent done a lot with chef-solo, but it is intended to be run locally without chef server
[2013-05-10 03:49:42 -0400] ssd7: AntonioRibeiro: So, one reason you see lots about berkshelf and vagrant with regard to chef-solo is they help with getting all the right data into place for use with Chef solo.  Unlike with chef-client where the server holds all your cookbooks and other data, using solo requires that you come up with a way to move your cookbooks onto the disk of the target machine
[2013-05-10 03:49:56 -0400] denken: so, you clone a git repo, cd into it, and run chef-solo against the host your currently on
[2013-05-10 03:50:20 -0400] denken: yep. what ssd7 said.
[2013-05-10 03:52:18 -0400] AntonioRibeiro: ssd7: berkshelf already did that for me, berks install downloads all cookboks I need to ~/.berkshelf
[2013-05-10 03:53:23 -0400] AntonioRibeiro: but when I run chef-solo in the my chef dir it says "Did not find config file: /etc/chef/solo.rb, using command line options."
[2013-05-10 03:53:36 -0400] AntonioRibeiro: right, solo.rb is in chef/ dir
[2013-05-10 03:54:00 -0400] AntonioRibeiro: but a chef-solo -c chef/solo.rb also gives me an error
[2013-05-10 03:54:33 -0400] ssd7: AntonioRibeiro: I'm not sure that the format of the ~/.berkshelf directory will match what chef-solo expects
[2013-05-10 03:54:39 -0400] ssd7: What is the error you recieved?
[2013-05-10 03:55:15 -0400] AntonioRibeiro: No cookbook found in "/etc/chefsolo/chef-solo-pattern/chef/cookbooks", make sure cookbook_path is set correctly.
[2013-05-10 03:55:35 -0400] AntonioRibeiro: it's right, this is not the right dir
[2013-05-10 03:57:53 -0400] AntonioRibeiro: this is the nginx cookbook dir: http://puu.sh/2Qnlf.png
[2013-05-10 03:58:14 -0400] AntonioRibeiro: inside the berkshelf dir
[2013-05-10 03:58:48 -0400] ssd7: AntonioRibeiro: Chef solo is going to expect to be pointed at a directory in which each subdirectory is the name of the cookbook without the version I believe
[2013-05-10 04:00:55 -0400] AntonioRibeiro: ssd7: looks like I'm missing something from berkshelf, it should be informing chef the correct location of those cookbooks, so it's not a chef-solo problem, but a berkshelf one, I think.
[2013-05-10 04:08:13 -0400] normanjoyner: hey I was wondering if the following endpoint is available for the hosted chef api: http://docs.opscode.com/chef/api_chef_server.html#principals-name ... or if this doc is outdated or only for use with open source / private chef
[2013-05-10 04:09:03 -0400] normanjoyner: i'm not having any success using it with hosted chef
[2013-05-10 04:13:02 -0400] ssd7: AntonioRibeiro: So, maybe this will help clarify
[2013-05-10 04:13:10 -0400] ssd7: here is the smallest example of using solo I could make: https://gist.github.com/stevendanna/5552324
[2013-05-10 04:13:38 -0400] ssd7: normanjoyner: Unfortunatley that was published a bit too soon I think.  It is not yet available publically as far as I know.
[2013-05-10 04:14:17 -0400] AntonioRibeiro: fantastic, ssd7! thanks a lot
[2013-05-10 04:15:00 -0400] normanjoyner: ssd7: ahhh okay thank you! good to know.
[2013-05-10 04:44:51 -0400] AntonioRibeiro: ssd7: worked like a charm, doing something bigger (nginx), I just had to download all its dependencies (apt, build-essential, ohai, etc.)
[2013-05-10 04:44:54 -0400] AntonioRibeiro: thanks a lot
[2013-05-10 06:50:57 -0400] alisdair: what does the attribute? method actually do?
[2013-05-10 06:51:02 -0400] alisdair: the documentation isn't really clear
[2013-05-10 07:33:56 -0400] harrisony: Hiya! Am I able to require a ruby module inside a recipe? I've tried doing that although my chef runs kinda blow up :(
[2013-05-10 07:39:46 -0400] Cyngus: Hi!
[2013-05-10 07:39:50 -0400] Cyngus: i'm new to chef and ruby - i'd like to symlink all subdirs inside a directory. How can i loop over all subdirs of a dir?
[2013-05-10 08:09:19 -0400] GianArb: hi! sorry can you help me? I'm looking a SphinxSearch cookbooks, have you a good cookbook to share?Thanks!
[2013-05-10 09:29:57 -0400] ermajn: is it suggest to use berkshelf in chef-clien to chef-server (so, no vagrant) mode ?
[2013-05-10 13:13:26 -0400] BryanWB: any chefspecers around? i have few qs?
[2013-05-10 13:13:29 -0400] BryanWB: any chefspecers around? i have few qs
[2013-05-10 13:26:58 -0400] jwilf_: hello, error in Chef 11 webui - ERROR: No such file or directory - /opt/chef-server/embedded/service/gem/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/locale/en.yml
[2013-05-10 13:28:03 -0400] jwilf_: if i look on the server, i have activesupport-3.2.13, but the server seems to be looking for 3.2.12
[2013-05-10 13:28:11 -0400] jwilf_: can anyone help please? i tried restarting the server already
[2013-05-10 13:29:57 -0400] epocsquadron: when one creates a role with knife, does one not expect to see a corresponding file appear in the roles/ directory of their chef repo?
[2013-05-10 13:36:08 -0400] cassianoleal: epocsquadron: it doesn't. it creates the role on the chef server only. To download the file, there's a separate knife command.
[2013-05-10 13:36:48 -0400] eherot: Does anyone else think that this knife behavior is maybe a bit of a bad idea from a security perspective? https://github.com/opscode/chef/blob/master/lib/chef/knife.rb#L324
[2013-05-10 13:36:55 -0400] cassianoleal: the easiest is probably just knife download roles/role.json
[2013-05-10 13:38:52 -0400] epocsquadron: cassianoleal: I've heard around that avoiding roles and using cookbooks is a better idea, what's your opinion?
[2013-05-10 13:39:29 -0400] cassianoleal: epocsquadron: I'm not yet 100% convinced about the arguments, although I see where they're coming from.
[2013-05-10 13:39:48 -0400] cassianoleal: I find roles to be really useful as run_list aggregators and simple tagging mechanisms
[2013-05-10 13:40:50 -0400] epocsquadron: that's where i was leaning too, but I'm very new to chef and trying to wrap my head around it all
[2013-05-10 13:40:56 -0400] cassianoleal: I like the idea of getting rid of a chef repo, though, and getting rid of roles would be a step in that direction
[2013-05-10 13:41:18 -0400] cassianoleal: if you're just starting, I'd say that you're probably better off not banging your head too much on that
[2013-05-10 13:41:42 -0400] cassianoleal: use roles as you see fit, and if you find that unsuitable try a different approach.
[2013-05-10 13:42:43 -0400] epocsquadron: fair enough, thanks
[2013-05-10 13:43:23 -0400] cassianoleal: sure thing
[2013-05-10 13:43:28 -0400] cassianoleal: start out simple, then evolve
[2013-05-10 13:43:36 -0400] cassianoleal: chef has a lot of moving parts
[2013-05-10 13:44:15 -0400] cassianoleal: it's got a quite steep learning curve, so choosing a path and following it until you're more comfortable with things is probably a good idea
[2013-05-10 13:57:09 -0400] cpasmoi: Can I use a "Time.now.to_i" in a recipe, or should I use "::Time.now.to_i" ?
[2013-05-10 13:57:57 -0400] cassianoleal: cpasmoi: If you're in doubt, use ::  It will guarantee that you're using the core Time class.
[2013-05-10 13:58:21 -0400] cpasmoi: ok, great =)
[2013-05-10 14:01:41 -0400] jwilf_: error in Chef 11 webui - ERROR: No such file or directory - /opt/chef-server/embedded/service/gem/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/locale/en.yml
[2013-05-10 14:02:08 -0400] jwilf_: can anyone help please? i'd really appreciate it
[2013-05-10 14:03:25 -0400] wildahunden: I want to change the environment for a set of nodes, but I'm not sure how to do it as a group.  I have a search:  knife search node 'asq1*' -i which works and returns a list of nodes.  Is there a way to change the environment for the set?
[2013-05-10 14:04:04 -0400] jwilf_: can anyone actually see me at all? :)
[2013-05-10 14:04:25 -0400] wildahunden: jwilf_: only your post ;)
[2013-05-10 14:04:38 -0400] jwilf_: wildahunden: :)
[2013-05-10 14:06:03 -0400] wildahunden: jwilf_: in the words of Chicago...Does anybody really know what time it is?
[2013-05-10 14:06:18 -0400] jwilf_: i make it 15:03
[2013-05-10 14:06:27 -0400] jwilf_: er i mean 15:06
[2013-05-10 14:07:34 -0400] wildahunden: 9:07 here
[2013-05-10 14:08:13 -0400] wildahunden: anybody know how to use knife search to change a notes environment?
[2013-05-10 14:08:23 -0400] wildahunden: node*
[2013-05-10 14:08:43 -0400] wildahunden: I thought the -E would do it.
[2013-05-10 14:08:45 -0400] jwilf_: ok so i found the Gemfile for chef-server-webui... it says gem "rails", "~> 3.2.13"
[2013-05-10 14:09:10 -0400] jwilf_: so why does the webui keep looking for activesupport-3.2.12 ?
[2013-05-10 14:09:42 -0400] svparijs: hey guys, knife bootstrap 10.10.0.28 -x user -P pw --sudo throws an error: Downloading Chef 11.4.4 for debian.. 10.10.0.28 Unable to retrieve a valid package!
[2013-05-10 14:09:55 -0400] svparijs: any ideass
[2013-05-10 14:10:44 -0400] eherot: that 10.10.0.28 needs to go at the end of the command afaik
[2013-05-10 14:11:12 -0400] wildahunden: svparijs:  some commands accept -VV for very verbose.  Maybe that would help.
[2013-05-10 14:11:28 -0400] svparijs: ah ok ill check
[2013-05-10 14:11:28 -0400] jwilf_: eherot: no it goes at the start
[2013-05-10 14:11:31 -0400] jblaine: eherot: That's what I always do too, though just noticing that knife bootstrap --help shows all options are supposed to go after the FQDN as svparijs did
[2013-05-10 14:12:12 -0400] jwilf_: svparijs: can you ssh into 10.10.0.28 and install chef from there?
[2013-05-10 14:12:13 -0400] jblaine: svparijs: Looks like you're doing things right, IMO
[2013-05-10 14:12:29 -0400] eherot: jwilf_: ah my bad you're right
[2013-05-10 14:12:40 -0400] svparijs: jwilf_: i can install it from there yes
[2013-05-10 14:12:49 -0400] svparijs: what command would i use?
[2013-05-10 14:13:37 -0400] svparijs: wildahunden: verbose doesn't do anything for me.
[2013-05-10 14:14:07 -0400] jblaine: svparijs: http://www.opscode.com/chef/install/ select options, run the command shown at the end
[2013-05-10 14:14:57 -0400] jwilf_: svparijs: try somthing like this
[2013-05-10 14:15:16 -0400] jwilf_: curl -L http://opscode.com/chef/install.sh | bash
[2013-05-10 14:16:06 -0400] jwilf_: wildahunden: hoorah, i fixed my chef-webui issue
[2013-05-10 14:16:16 -0400] jwilf_: lucky, as nobody seemed interested :)
[2013-05-10 14:16:36 -0400] wildahunden: svparijs:  https://tickets.opscode.com/browse/CHEF-3605 is this similar?
[2013-05-10 14:16:43 -0400] jwilf_: it seems that chef-server-ctl restart didn't actually restart unicorn
[2013-05-10 14:16:54 -0400] jwilf_: i killed the unicorn master process, it respawned, problem solved
[2013-05-10 14:17:13 -0400] svparijs: wildahunden: yes exactly the same
[2013-05-10 14:17:33 -0400] svparijs: wildahunden: only its debian
[2013-05-10 14:18:56 -0400] svparijs: jwilf_, wildahunden this : curl -L http://opscode.com/chef/install.sh | bash throws the same except
[2013-05-10 14:19:05 -0400] wildahunden: svparijs:  https://tickets.opscode.com/browse/CHEF-3525 shows a resolution
[2013-05-10 14:19:55 -0400] jwilf_: svparijs: you might need to write your own bootstrap template in the meantime
[2013-05-10 14:20:10 -0400] svparijs: jikkes
[2013-05-10 14:21:17 -0400] svparijs: jwilf_: i'd prefer to keep it simple
[2013-05-10 14:22:51 -0400] jwilf_: svparijs: its actually quite easy
[2013-05-10 14:22:59 -0400] jwilf_: you can base it on one of the provided templates
[2013-05-10 14:24:01 -0400] svparijs: as far as i can see i just need to add to add the repo in apt to get it working. but ill try your approach if it fails
[2013-05-10 14:24:29 -0400] jwilf_: svparijs: ah ok, yeah that sounds easier
[2013-05-10 14:24:31 -0400] teukka: svparijs: debian wheezy? it is not yet supported by the omnibus platform: https://tickets.opscode.com/browse/CHEF-4125
[2013-05-10 14:25:51 -0400] Janaka: hi
[2013-05-10 14:26:33 -0400] Janaka: How do I update or add data to a data bag item using Knife?
[2013-05-10 14:26:56 -0400] jwilf_: Janaka: knife data bag from file <bag> <filename>
[2013-05-10 14:27:16 -0400] jwilf_: or if your data bag isn't coming from a file
[2013-05-10 14:27:37 -0400] jwilf_: knife data bag edit
[2013-05-10 14:28:29 -0400] jwilf_: knife data bag -h to see help
[2013-05-10 14:28:31 -0400] svparijs: teukka: thanks
[2013-05-10 14:28:44 -0400] svparijs: jwilf_: what way do i create a custom template?
[2013-05-10 14:29:26 -0400] Janaka: scheuk: I don;t want to persist this data anywhere else, can I not push it through as a string
[2013-05-10 14:32:08 -0400] jwilf_: svparijs: this blog post seems to address your exact issue - http://www.citytechinc.com/us/en/blog/2012/05/bootstrapping_chefo.html
[2013-05-10 14:32:33 -0400] Janaka: have looked at the documentation and cannot see any other way - hoping there's an undocumented param
[2013-05-10 14:34:34 -0400] svparijs: jwilf_: thanks guys
[2013-05-10 14:35:02 -0400] jwilf_: Janaka: what's the issue?
[2013-05-10 14:35:27 -0400] jwilf_: you should be able to use knife data bag edit
[2013-05-10 14:39:05 -0400] Janaka: jwilf: I would like to use a data bag to persist some data and update it from a powershell script
[2013-05-10 14:40:15 -0400] Janaka: knife doesn't seem to allow create or update where the data source is a string. And there are no client libs for windows and the the API auth is an pain to implement
[2013-05-10 14:42:22 -0400] svparijs: jwilf_: thanks so much! im running into the next issue X-)
[2013-05-10 14:42:51 -0400] jwilf_: svparijs: you're welcome :)
[2013-05-10 14:48:55 -0400] svparijs: jwilf_: small question the template works nicely BUT it keeps refering to my url setting https://10.10.0.27 instead of the http version...
[2013-05-10 14:51:08 -0400] svparijs: im probably missing some cache or config file
[2013-05-10 14:52:49 -0400] countdigi: ohai ... curious if anyone has hacked chefspec to doctor 'not_if' returns in script execution or similar?
[2013-05-10 14:59:19 -0400] cassianoleal: anyone with experience on test-kitchen + bats + rbenv ? :)
[2013-05-10 15:00:01 -0400] cassianoleal: I'm trying to verify that rbenv is installed and that my choice of Ruby is there as well, but it seems like bats (or test-kitchen) doesn't load the environment
[2013-05-10 15:00:09 -0400] cassianoleal: so it can't find rbenv in the first place
[2013-05-10 15:00:42 -0400] jwilf_: svparijs: can you pastebin your template
[2013-05-10 15:06:27 -0400] svparijs: jwilf_: ill do that but i have a different issue
[2013-05-10 15:08:08 -0400] svparijs: jwilf_: https://gist.github.com/svparijs/3c7b49d4e3a6b518f25f
[2013-05-10 15:10:51 -0400] jwilf_: svparijs: did you create /etc/chef/validation.pem
[2013-05-10 15:11:04 -0400] svparijs: the file on the node is created
[2013-05-10 15:12:44 -0400] svparijs: it might be the contents that are wrong... do i need the public of the private key?
[2013-05-10 15:15:27 -0400] svparijs: it currently has the privagte key
[2013-05-10 15:16:47 -0400] jstallard: Hey folks. I'm trying to pass a hash as a parameter to a definition I created. It works if I declare the hash, then specify the variable as the parm. It doesn't work if I try specify the hash inline. https://gist.github.com/jstallard/5555064
[2013-05-10 15:16:52 -0400] jstallard: Anyone know why?
[2013-05-10 15:17:37 -0400] jstallard: Perhaps this is some ruby-ism that I'm unfamiliar with?
[2013-05-10 15:25:21 -0400] zts: jstallard: the problem is that the hash is parsed as a ruby block, not a hash
[2013-05-10 15:25:36 -0400] zts: jstallard: try wrapping your hash inside Hash[] and it might work
[2013-05-10 15:25:50 -0400] jstallard: zts: I'll give that a shot, thanks
[2013-05-10 15:25:52 -0400] jwilf_: svparijs: the validation key should match the one on the server
[2013-05-10 15:25:57 -0400] jwilf_: its the same for all nodes
[2013-05-10 15:26:21 -0400] jwilf_: so just copy it from another node, unless this is your first node :)
[2013-05-10 15:26:31 -0400] svparijs: its my first node
[2013-05-10 15:26:36 -0400] svparijs: im a chef rookie
[2013-05-10 15:26:38 -0400] jwilf_: svparijs: ok
[2013-05-10 15:26:51 -0400] jwilf_: have you got /etc/chef/validation.pem on the chef server?
[2013-05-10 15:27:20 -0400] svparijs: i got a chef-validation.pem
[2013-05-10 15:27:30 -0400] jstallard: zts: that did the trick. Thank you!
[2013-05-10 15:27:52 -0400] svparijs: should there be a validation.pem?
[2013-05-10 15:28:05 -0400] jwilf_: there might be, no worries if not
[2013-05-10 15:28:12 -0400] jwilf_: have you got access to your chef webui?
[2013-05-10 15:30:33 -0400] svparijs: jwilf_: yes
[2013-05-10 15:30:45 -0400] jwilf_: svparijs: ok, go to client
[2013-05-10 15:30:49 -0400] jwilf_: clients
[2013-05-10 15:30:58 -0400] svparijs: yes
[2013-05-10 15:31:03 -0400] jwilf_: and edit the chef-validator client
[2013-05-10 15:31:19 -0400] jwilf_: tick the box to regenerate the key
[2013-05-10 15:31:41 -0400] jwilf_: it will show you a new private key you can put in validation.pem on your nodes
[2013-05-10 15:32:32 -0400] svparijs: ok
[2013-05-10 15:32:53 -0400] jwilf_: you should also save it to .chef/validation.pem on your local machine
[2013-05-10 15:33:07 -0400] jwilf_: so that when you bootstrap, knife will copy it over
[2013-05-10 15:33:29 -0400] svparijs: ok done
[2013-05-10 15:33:46 -0400] svparijs: done!
[2013-05-10 15:33:49 -0400] svparijs: Sweet!
[2013-05-10 15:33:52 -0400] jwilf_: it works?
[2013-05-10 15:33:56 -0400] svparijs: It has nothing to do :P
[2013-05-10 15:34:01 -0400] jwilf_: :)
[2013-05-10 15:34:05 -0400] jwilf_: empty runlist?
[2013-05-10 15:34:06 -0400] svparijs: Chef Client finished, 0 resources updated
[2013-05-10 15:34:09 -0400] svparijs: yes
[2013-05-10 15:34:10 -0400] jwilf_: awesome
[2013-05-10 15:34:25 -0400] svparijs: jwilf_: thanks so much ill be back for more :-) later on
[2013-05-10 15:34:37 -0400] jwilf_: glad i could help :)
[2013-05-10 15:57:40 -0400] epocsquadron: I'm attempting to build a dev environment in a vagrant vm (ubuntu 12.10) with chef-php-extra (https://github.com/inviqa/chef-php-extra) and I'm getting this error: ERROR: php_pear[PHP_CodeSniffer] (/tmp/vagrant-chef-1/chef-solo-1/cookbooks/chef-php-extra/recipes/PHP_CodeSniffer.rb:22:in `from_file') had an error:
[2013-05-10 15:57:40 -0400] epocsquadron: php_pear[PHP_CodeSniffer] (chef-php-extra::PHP_CodeSniffer line 22) had an error: NameError: Cannot find a resource for converge_by on ubuntu version 12.10
[2013-05-10 15:58:09 -0400] epocsquadron: relevant recipe contains: include_recipe "chef-php-extra::pear"
[2013-05-10 15:58:09 -0400] epocsquadron: php_pear "PHP_CodeSniffer" do
[2013-05-10 15:58:10 -0400] epocsquadron:   version "1.3.5"
[2013-05-10 15:58:10 -0400] epocsquadron:   action :install
[2013-05-10 15:58:10 -0400] epocsquadron: end
[2013-05-10 15:59:08 -0400] epocsquadron: any suggestions on how to fix that? I dont see any platform specific code there so i dont really know where to look
[2013-05-10 15:59:30 -0400] wamilton: epocsquadron: are you ensuring that the php::default recipe runs first?
[2013-05-10 16:00:00 -0400] epocsquadron: here's the relevant part of the runlist:   "run_list": [
[2013-05-10 16:00:00 -0400] epocsquadron:     "recipe[vim]",
[2013-05-10 16:00:00 -0400] epocsquadron:     "recipe[openssl]",
[2013-05-10 16:00:00 -0400] epocsquadron:     "recipe[php]",
[2013-05-10 16:00:00 -0400] epocsquadron:     "recipe[chef-php-extra::development]",
[2013-05-10 16:00:00 -0400] epocsquadron:     "recipe[chef-php-extra::pear]",
[2013-05-10 16:00:01 -0400] epocsquadron:     "recipe[php::module_mysql]",
[2013-05-10 16:00:01 -0400] epocsquadron:     "recipe[php::module_curl]",
[2013-05-10 16:00:02 -0400] epocsquadron:     "recipe[chef-php-extra::module_mbstring]",
[2013-05-10 16:00:02 -0400] epocsquadron:     "recipe[chef-php-extra::module_mysql]",
[2013-05-10 16:00:14 -0400] epocsquadron: ahh pear should be first shouldnt it..
[2013-05-10 16:01:21 -0400] epocsquadron: nope, thats not the error
[2013-05-10 16:01:47 -0400] wamilton: epocsquadron: that's not liable to be the issue... I think the issue is that you need to install that cookbook as php
[2013-05-10 16:01:56 -0400] wamilton: https://github.com/inviqa/chef-php-extra/blob/master/resources/pear.rb
[2013-05-10 16:02:29 -0400] wamilton: the cookbook internally expects its name to be 'php'
[2013-05-10 16:02:48 -0400] wamilton: wait...
[2013-05-10 16:02:58 -0400] wamilton: why the hell does it depend on the php cookbook then...?
[2013-05-10 16:03:13 -0400] epocsquadron: hm
[2013-05-10 16:03:39 -0400] epocsquadron: "The following Opscode cookbooks are dependencies:
[2013-05-10 16:03:39 -0400] epocsquadron: git
[2013-05-10 16:03:39 -0400] epocsquadron: yum
[2013-05-10 16:03:39 -0400] epocsquadron: apt
[2013-05-10 16:03:39 -0400] epocsquadron: php
[2013-05-10 16:03:40 -0400] epocsquadron: "
[2013-05-10 16:05:09 -0400] epocsquadron: metadata.rb specifies itself as chef-php-extra
[2013-05-10 16:05:25 -0400] wamilton: yeah... but the reason you're getting an internal provider error is ostensibly that they are providing their own lwrp's...
[2013-05-10 16:06:10 -0400] epocsquadron: this guy? https://github.com/inviqa/chef-php-extra/blob/master/providers/pear.rb
[2013-05-10 16:06:49 -0400] wamilton: yeah, the note at the top of the readme about CentOS makes me think that the idea though is to not call the default php recipe ever
[2013-05-10 16:07:47 -0400] epocsquadron: ah, id ignored that since i was using ubuntu, giving that a try..
[2013-05-10 16:10:23 -0400] wamilton: hrm... I guess that won't do it either though because that PHPCS recipe eventually includes the default recipe, which then includes the php cookbook default recipe when the platform is ubuntu...
[2013-05-10 16:11:42 -0400] epocsquadron: negative, same results with this runlist:   "run_list": [
[2013-05-10 16:11:43 -0400] epocsquadron:     "recipe[vim]",
[2013-05-10 16:11:43 -0400] epocsquadron:     "recipe[openssl]",
[2013-05-10 16:11:43 -0400] epocsquadron:     "recipe[chef-php-extra::development]",
[2013-05-10 16:11:43 -0400] epocsquadron:     "recipe[php::module_curl]",
[2013-05-10 16:11:43 -0400] epocsquadron:     "recipe[chef-php-extra::module_mbstring]",
[2013-05-10 16:11:43 -0400] epocsquadron:     "recipe[chef-php-extra::module_mysql]",
[2013-05-10 16:11:58 -0400] joonas: epocsquadron: you should try using gist.github.com :)
[2013-05-10 16:12:15 -0400] wamilton: I'm thinking now that the issue is that it's not calling its own resource in the recipe you're using... if you look at the ones updated more recently, they're specifying the chef-php-extra_pear resource: https://github.com/inviqa/chef-php-extra/blob/master/recipes/PHPUnit.rb#L37
[2013-05-10 16:13:18 -0400] wamilton: I think the maintainers just aren't showing PHPCS any love :) try just running the PHPUnit recipe and see if that works, or at least has a different problem...
[2013-05-10 16:14:21 -0400] epocsquadron: checking now
[2013-05-10 16:14:50 -0400] wamilton: if that doesn't have the same problem, then you may be the lucky dev to submit a pull request
[2013-05-10 16:15:06 -0400] epocsquadron: that seems to have fixed it
[2013-05-10 16:15:18 -0400] epocsquadron: yay pull request
[2013-05-10 16:16:07 -0400] epocsquadron: wamilton: thanks so much for the help, that would have been hours of digging for me
[2013-05-10 16:16:16 -0400] wamilton: epocsquadron: yw
[2013-05-10 16:17:02 -0400] wamilton: now I'm kind of curious why it is that invoking the php_pear resource in that cookbook is broken and whether it breaks it for every other recipe that runs after its default recipe...
[2013-05-10 16:20:25 -0400] epocsquadron: not sure, but it seems like something where the author simply forgot to update that particular recipe, likely because php_pear works fine on CentOS
[2013-05-10 16:21:29 -0400] queso: I was provisioning a new node and it downloaded and ran all the cookbooks it was supposed to, then at the end I got a networking error: "Error connecting to https://chef.example.com/nodes/app-stage.example.com - Connection timed out - connect(2)"  The same thing is happening with another node I'm trying to provision. Any ideas?
[2013-05-10 16:22:17 -0400] queso: (I can ping the Chef server and attempted to rerun it multiple times, so it wasn't a networking fluke.)
[2013-05-10 16:39:10 -0400] steveb: is the chef download-server down?
[2013-05-10 16:39:32 -0400] steveb: I'm trying to get a vagrant box up with chef 11 and the chef-server cookbook is failing with and error downloading
[2013-05-10 16:39:36 -0400] steveb: http://www.opscode.com/chef/download-server?p=ubuntu&pv=12.04&m=x86_64&v=latest&prerelease=false&nightlies=false
[2013-05-10 16:43:07 -0400] Kyle11: steveb: i also get an internal server error
[2013-05-10 16:44:04 -0400] Kyle11: new to chef, i'm using the 'users' cookbook -- http://community.opscode.com/cookbooks/users
[2013-05-10 16:44:35 -0400] Kyle11: it doesn't seem to have a way to handle bashrc or vimrc files.  I cannot find another cookbook that seems to solve this.  Any suggestions on how to handle this?
[2013-05-10 16:45:19 -0400] wamilton: Kyle11: version your dotfiles in a gitrepo with a rakefile or similar that links them all into place
[2013-05-10 16:46:20 -0400] wamilton: Kyle11: http://pbrisbin.com/posts/escalate_your_scripts
[2013-05-10 16:48:16 -0400] Kyle11: cool, thanks.  Also is there a way to store "files" in databags, or is that a terrible idea?  The users cookbook uses the databag and I'm hoping to keep all the users info together (else i will github url pull thlem)
[2013-05-10 16:58:22 -0400] c_t: someone with ops, cleanup on aisle 3
[2013-05-10 16:59:44 -0400] pcn: ohai chefs
[2013-05-10 16:59:51 -0400] pcn: Does anyone know if there's a workaround for http://tickets.opscode.com/browse/CHEF-3953
[2013-05-10 17:00:37 -0400] queso: Okay, regarding my above question, it was a firewall issue installed during one of the runs, lol. :)
[2013-05-10 17:01:04 -0400] pcn: I'm getting stuff that worked in 0.10.x where I can say YAML.dump(node['foo']['bar'].to_hash) and it turns into yaml as a nested set of string keys and values and lists and hashes, etc.
[2013-05-10 17:01:41 -0400] pcn: Now it's giving me values that are serialized  !ruby/hash:Mash types
[2013-05-10 17:01:58 -0400] pcn: which super sucks
[2013-05-10 17:03:12 -0400] pcn: Using 10.24.0 for now
[2013-05-10 17:05:30 -0400] spox: pcn: i just have a to_hash_recursive helper that formats them all down to proper hashes
[2013-05-10 17:05:55 -0400] CharlieSu: Anyone using IAM roles w/ Chef?  I'd love to see a modified s3_file resource that uses IAM roles
[2013-05-10 17:08:06 -0400] pcn: CharlieSu have you tried it?  In theory if you don't provide most of the APIs with explicit auth info now, they'll check instance roles
[2013-05-10 17:08:22 -0400] pcn: So far I've seen it documented with the java and boto libs
[2013-05-10 17:08:47 -0400] CharlieSu: pcn: I've used it w/ the aws-sdk..  No problem.  Do you know of a s3_file chef resource that uses the sdk?
[2013-05-10 17:09:41 -0400] pcn: CharlieSu: no, we use in-house python tools and just call them since they work for us
[2013-05-10 17:11:05 -0400] CharlieSu: pcn: I actually just verified that https://gist.github.com/DavidAllison/5288249 works if you have nil values for the keys...  nice
[2013-05-10 17:11:27 -0400] pcn: Cool
[2013-05-10 17:12:49 -0400] pcn: spox: do you have a gist of your to_hash_recursive?
[2013-05-10 17:13:10 -0400] spox: pcn: dunno. give me a sec and i'll dig around
[2013-05-10 17:15:22 -0400] spox: pcn: https://gist.github.com/chrisroberts/5555864
[2013-05-10 17:26:57 -0400] pcn: Thanks for that
[2013-05-10 17:41:48 -0400] pcn: spox: do you need the test for type?  {}.to_hash == {} right?
[2013-05-10 17:54:32 -0400] cassianoleal: how do I tell the application_ruby cookbook to deploy passenger in a rbenv-managed Ruby ?
[2013-05-10 17:56:53 -0400] CaptainQuirk: Hi there
[2013-05-10 17:57:25 -0400] CaptainQuirk: I'm trying to use chef-solo on my ubuntu 13.04 desktop
[2013-05-10 17:57:45 -0400] CaptainQuirk: I'm trying to install tmux but chef-solo fails because of apt
[2013-05-10 17:57:59 -0400] CaptainQuirk: seems like the version number is a problem
[2013-05-10 17:58:24 -0400] whilp: CaptainQuirk: `sudo apt-get update` first?
[2013-05-10 17:58:29 -0400] gchristensen: cassianoleal: I have some code for you re: rubenv :)
[2013-05-10 17:58:32 -0400] kindsol: CaptainQuirk: you should have apt::default as one of the first recipes in your runlist
[2013-05-10 17:58:48 -0400] kindsol: which will do the apt-get update for you
[2013-05-10 17:59:16 -0400] kindsol: CaptainQuirk: http://community.opscode.com/cookbooks/apt
[2013-05-10 18:00:18 -0400] jforce: Is there a way to ensure that an action occurs before a specific recipe is included with include_recipe? I want to make sure that a data bag operation is done before include_recipe 'users::sysadmin' is executed, and I'd rather not rely on simply ordering the steps in the recipe.
[2013-05-10 18:01:26 -0400] CaptainQuirk: so I should copy the apt cookbook, is that it ?
[2013-05-10 18:04:31 -0400] kindsol: CaptainQuirk: probably better to use it as-is, just add it to your run list. are you using Chef Server?
[2013-05-10 18:04:50 -0400] CaptainQuirk: no, chef-solo on my desktop ubuntu
[2013-05-10 18:05:04 -0400] CaptainQuirk: not really the standard use case I imagine
[2013-05-10 18:05:16 -0400] CaptainQuirk: another question if possible
[2013-05-10 18:05:39 -0400] CaptainQuirk: I'm having issue with the template command in one of my recipes
[2013-05-10 18:06:07 -0400] CaptainQuirk: does the target file need to exist for the whole templating thing to work ?
[2013-05-10 18:06:10 -0400] kindsol: just add the "apt" cookbook to your cookbook_path, then add apt::default to the start of your run list.
[2013-05-10 18:06:23 -0400] CaptainQuirk: kindsol, that worked alright, thank you !
[2013-05-10 18:06:56 -0400] kindsol: or alternatively add "execute 'apt-get update'" to the start of your recipe
[2013-05-10 18:06:58 -0400] crazysim: sometimes i wonder if the berkshelf people should just add the apt recipe to their default template
[2013-05-10 18:07:03 -0400] crazysim: for their cookbooks
[2013-05-10 18:07:10 -0400] cassianoleal: gchristensen: I'm all ears (or should it be eyes?)
[2013-05-10 18:07:22 -0400] gchristensen: cassianoleal: heh, I actually ended up sending it over the ML
[2013-05-10 18:07:23 -0400] crazysim: it's the first thing i do when developing a cookbook, readd the apt recipe
[2013-05-10 18:07:33 -0400] cassianoleal: gchristensen: ah, that was you :D
[2013-05-10 18:07:35 -0400] cassianoleal: thanks!
[2013-05-10 18:07:39 -0400] crazysim: oh wait i know why. they're a centos shop
[2013-05-10 18:07:39 -0400] gchristensen: you're welcome!
[2013-05-10 18:07:40 -0400] cassianoleal: I'm looking into it now :)
[2013-05-10 18:07:41 -0400] crazysim: damn
[2013-05-10 18:08:14 -0400] kindsol: CaptainQuirk: nope, the target file will be created if it does not exist.  But I think the directory needs to exist.
[2013-05-10 18:08:22 -0400] gchristensen: cassianoleal: before I came to that solution, my to-do list was "1) successfully deploy a ruby application, 2) shoot myself in the face" with the pretense that I'd never actually get to step 2... I did :(
[2013-05-10 18:08:37 -0400] kindsol: CaptainQuirk: you can ensure it does by using the "directory" resource
[2013-05-10 18:08:45 -0400] kindsol: before your template reosurce
[2013-05-10 18:09:08 -0400] cassianoleal: gchristensen: heh I know what you mean. It seems like managing ruby/rubies in Chef should be a lot simpler, since it's something that many of us do all the time
[2013-05-10 18:09:29 -0400] cassianoleal: Sometimes I feel like I'm missing something very obvious since information about that is not readily available on the net
[2013-05-10 18:09:30 -0400] CaptainQuirk: ok, it worked, but I run into a small pb, since I had to run the command with sudo
[2013-05-10 18:09:32 -0400] gchristensen: definitely. also, you probably have a solution for this already, but this is a byproduct of this latest deployment: https://github.com/zippykid/chef-github-deploy-key
[2013-05-10 18:09:36 -0400] CaptainQuirk: the file was created as root
[2013-05-10 18:10:07 -0400] cassianoleal: gchristensen nice one. we have our code on Bitbucket, but I might be able to adapt that, thanks again
[2013-05-10 18:10:18 -0400] gchristensen: sure thing
[2013-05-10 18:10:19 -0400] CaptainQuirk: there is something about sudoers in opscode I think, isn't it ?
[2013-05-10 18:10:31 -0400] ryanisnan: I'm having an issue with the database cookbook (http://community.opscode.com/cookbooks/database) . I'm using it (with the postgresql cookbook) to provision Postgresql and to create two databases locally, and a user to access them. My custom recipe that uses the resources provided by `database` is shown here: http://dpaste.com/1136035/
[2013-05-10 18:10:32 -0400] cassianoleal: (right now I'm keeping a key in an encrypted databag, but that's messy in itself)
[2013-05-10 18:11:02 -0400] gchristensen: cassianoleal: that is what I usually do, but then every once in a while I hear people talking about how a single key is a Bad Idea.
[2013-05-10 18:11:09 -0400] ryanisnan: I'm unable to connect to the database using the created user, however. I've checked in pg_hba.conf, and the corresponding user account doesn't seem to have been created. Any idea what I'm doing wrong?
[2013-05-10 18:12:04 -0400] cassianoleal: gchristensen: yeah my problem with uploading a new deploy key to the git server every time is that it might create a lot of cruft as machines get decommissioned
[2013-05-10 18:12:41 -0400] gchristensen: I haven't resolved that yet :) this deployment is still very small. I'm considering creating a recipe which does a search and pruning
[2013-05-10 18:13:01 -0400] gchristensen: the other thing is periodically removing every key wouldn't be disastrous, since the servers will re-add themselves on the next chef run.
[2013-05-10 18:13:15 -0400] cassianoleal: makes sense
[2013-05-10 18:13:54 -0400] dfrey_: I have an attribute in a nginx.rb file depending on a previously set attribute in default.rb, but the attribute is coming up nil. Aren't the attributes files run in alphabetical order?
[2013-05-10 18:20:22 -0400] ignatz: so it looks like if I do a 'knife ec2 server create' at least using winrm, it bombs not finding a bootstrap template. It doesn't just default to chef-full.
[2013-05-10 18:22:40 -0400] ignatz: but since winrm bombs out on auth anyway...
[2013-05-10 18:29:29 -0400] CaptainQuirk: Can i use a url as argument to dpkg_package in a recipe ?
[2013-05-10 18:30:16 -0400] gchristensen: CaptainQuirk: I don't know, but if you can't, just remote_file it.
[2013-05-10 18:30:31 -0400] CaptainQuirk: remote_file is an attribute right ?
[2013-05-10 18:30:55 -0400] cassianoleal: CaptainQuirk: it's a resource that downloads files over HTTP
[2013-05-10 18:31:13 -0400] CaptainQuirk: where must the remote_file parameter go
[2013-05-10 18:31:15 -0400] CaptainQuirk: in which file
[2013-05-10 18:31:19 -0400] CaptainQuirk: sorry, noob question
[2013-05-10 18:32:19 -0400] cassianoleal: you'd have to use remote_file before doing the dpkg stuff. you download the package to a local dir, then call dpkg_package pointing to it
[2013-05-10 18:32:52 -0400] gchristensen: good lord. jtimberman would you have the heart to remove this special kevin?
[2013-05-10 18:32:53 -0400] CaptainQuirk: ok, remote_file is a  function  (?) in the same sense as dpkg_package
[2013-05-10 18:33:21 -0400] cassianoleal: it's a resource, same as dpkg_package, or template, or most of the stuff you do in chef :)
[2013-05-10 18:33:38 -0400] cassianoleal: CaptainQuirk: http://docs.opscode.com/resource_remote_file.html
[2013-05-10 18:33:53 -0400] CaptainQuirk: i'm on it thanks !
[2013-05-10 18:34:01 -0400] cassianoleal: np!
[2013-05-10 18:41:15 -0400] cjerdonek: when defining a custom LWRP, do you need to do something special in the provider for notifications to work?
[2013-05-10 18:41:46 -0400] cjerdonek: i don't see a "ran successfully" message after executing my custom LWRP
[2013-05-10 18:47:06 -0400] gchristensen: cassianoleal: let me know if you manage to make that wrapper work with passenger
[2013-05-10 18:47:57 -0400] cassianoleal: gchristensen: I don't think I will manage I just found that the apache2_passenger cookbook has attributes for gem_path and such, but I can't get it to work with that either :-/
[2013-05-10 18:48:11 -0400] gchristensen: :(
[2013-05-10 18:49:00 -0400] cassianoleal: the weird thing is  ohai is reporting my rbenv ruby in languages[:ruby], but passenger is still trying to install itself to the system ruby
[2013-05-10 18:52:14 -0400] heathsnow: Has anyone successfully clustered rabbit servers with the rabbitmq cookbook?  I applied this fix:  https://github.com/tchoi80/rabbitmq/commit/516ff14c8c6d626b453a733372d8094261908bed
[2013-05-10 18:52:40 -0400] heathsnow: but it still won't cluster......restarting the service isn't picking up the configuration file and applying the cluster  :S
[2013-05-10 18:53:43 -0400] heathsnow: I can manually cluster it using rabbitmqctl join_cluster but I thought maybe someone has it working with the cookbook that's provided.  I really hate writing wrapper cookbooks to fix these things
[2013-05-10 18:59:52 -0400] djustin: In the chef server WebUI, is it possible to search by multiple  attributes?
[2013-05-10 19:00:26 -0400] isotope1: djustin yes
[2013-05-10 19:00:31 -0400] djustin: got it
[2013-05-10 19:00:38 -0400] djustin: just space seperated, duh
[2013-05-10 19:01:06 -0400] isotope1: MTPR23Z6
[2013-05-10 19:02:03 -0400] ignatz: bless you
[2013-05-10 19:13:26 -0400] ryanisnan: Does anybody with experience with the database cookbook and postgres databases have a moment to help me sort out a basic auth issue?
[2013-05-10 19:23:42 -0400] mattupstate: i'm looking for help getting my custom LWRP to notify other resources that want to subscribe to updates
[2013-05-10 19:24:10 -0400] mattupstate: i'm setting new_resource.updated_by_last_action(true) when an update happens in my custom LWRP
[2013-05-10 19:24:17 -0400] mattupstate: but anything that subscribes to it never gets notified
[2013-05-10 20:01:13 -0400] CharlieSu: Anyone know if Omnibus Chef will ever ship w/ aws-sdk ?
[2013-05-10 20:01:48 -0400] david__: hi all.  does anyone have experience with the 10>11 migration?  can't seem to get chef 0.10.x clients to connect to the new server...
[2013-05-10 20:03:21 -0400] david__: i get 401 "Unauthorized", despite deleting the node, client and client.pem
[2013-05-10 20:03:25 -0400] CharlieSu: david__: I do..  Did you migrate to a new server or upgrade your server inplace?
[2013-05-10 20:03:54 -0400] david__: new server.  i'm still just testing nodes right now.
[2013-05-10 20:04:10 -0400] CharlieSu: david__: cool.. I used a new server too.. This article worked perfectly for me
[2013-05-10 20:04:11 -0400] CharlieSu: https://engineering.emcien.com/2013/02/2-upgrading-from-chef-10-to-chef-11
[2013-05-10 20:05:10 -0400] david__: i looked at that a bit ago.  are you running any 0.10.x clients still, or did you upgrade those too?
[2013-05-10 20:05:55 -0400] jtimberman: Opscode COOK code review starting soon, watch: http://t.co/GISGKEDvGe - join: http://t.co/dCSFHsOWDI
[2013-05-10 20:07:09 -0400] david__: i suppose that recipe upgrades the clients
[2013-05-10 20:07:19 -0400] david__: thanks for the link
[2013-05-10 20:07:50 -0400] CharlieSu: david__: I'm actually running 10.24.4 clients
[2013-05-10 20:07:59 -0400] CharlieSu: david__: across the board..  no 11 clients yet.
[2013-05-10 20:08:17 -0400] CharlieSu: david__: i was really referring to the upload and download scripts..
[2013-05-10 20:08:30 -0400] david__: yeah i definitely intend to use those when we do the switchover
[2013-05-10 20:22:01 -0400] ignatz: has anyone got knife ec2 server create to work with winrm? now I'm getting 500 errors from the winrm service because of some timeout problem with ec2. It alllllmost works.
[2013-05-10 20:22:36 -0400] ignatz: bootstrap with winrm works after the server is ready, but winrm waiting for the server to create doesn't, so I have to run two commands and wait between them.
[2013-05-10 20:35:27 -0400] jujupoker: Hello, i am trying to use git resource on windows, i added git recipe and it installs but when a recipe tries to use git resource it says command not recognized.  I suppose I can create a recipe to add path to environment variable but is there a better way?
[2013-05-10 20:37:24 -0400] djustin: Through the web UI, is there a URL you can initiate to return the value of an attribute?  So I don't have to actually load the node screen?
[2013-05-10 20:38:14 -0400] djustin: Trying to do queries outside of knife...takes 30+ seconds to return
[2013-05-10 20:41:30 -0400] jujupoker: hmm, git is already in path, i had to close and reopen command windows
[2013-05-10 20:42:26 -0400] paulmooring: jujupoker: that's normal, it loads %PATH% when you first open the window so changes made to that variable aren't propigated
[2013-05-10 20:43:38 -0400] jujupoker: i am running on the node itself now, i guess in future that wont be a problem when i am using knife-windows
[2013-05-10 20:43:53 -0400] paulmooring: it shouldn't be
[2013-05-10 20:44:01 -0400] paulmooring: ignatz: https://github.com/opscode/knife-ec2/pull/107
[2013-05-10 20:44:10 -0400] paulmooring: I believe that's a known issue
[2013-05-10 20:44:48 -0400] jujupoker: thx
[2013-05-10 20:45:40 -0400] paulmooring: djustin: I'm not aware of a way to do that via the webui, is it knife taking 30 seconds or the webui?
[2013-05-10 21:00:46 -0400] ignatz: thanks Paul. I'm not sure how to solve my problem with this because I'm kind of a noob with git, but it's a start :)
[2013-05-10 21:01:21 -0400] paulmooring: ignatz: want to put the error in a gist and post it here?
[2013-05-10 21:02:30 -0400] ignatz: sure...
[2013-05-10 21:21:51 -0400] djustin: paulmooring the load page to open the 'node' page takes a bit of time, but knife takes forever.  I'm creating a little app that initiates, on demand, and waits for the end of the run
[2013-05-10 21:22:27 -0400] djustin: so i'd like to be able to query for a particular attribute, quickly
[2013-05-10 21:24:59 -0400] ponyofde1th: hi, is it possible to exclude an node from a certain recepie that is included in an base role?
[2013-05-10 21:25:22 -0400] ponyofde1th: or inside the recepie have an exception to skip over certain hosts
[2013-05-10 21:25:40 -0400] paulmooring: djustin: what server version is this?
[2013-05-10 21:25:53 -0400] paulmooring: sounds like knife-psearch might be the answer to your woes
[2013-05-10 21:25:55 -0400] ponyofde1th: ie having the default ntp client config not affect ntp servers
[2013-05-10 21:26:04 -0400] djustin: 11.04
[2013-05-10 21:26:16 -0400] djustin: ok, i'll look into that
[2013-05-10 21:26:18 -0400] djustin: thanks
[2013-05-10 21:26:24 -0400] paulmooring: I meant chef server
[2013-05-10 21:26:40 -0400] paulmooring: I believe partial search is not supported in Server 10
[2013-05-10 21:27:05 -0400] paulmooring: but Hosted, Private, and Chef 11 should all handle it
[2013-05-10 21:33:11 -0400] ignatz: paulmooring: https://gist.github.com/gl-conradheiney/5557602
[2013-05-10 21:34:35 -0400] paulmooring: ignatz: yep that's definitely the ticket I linked too
[2013-05-10 21:34:44 -0400] ignatz: yeah.
[2013-05-10 21:36:08 -0400] paulmooring: If you're comfortable just applying that fix yourself to your local knife, that should fix it
[2013-05-10 21:36:23 -0400] paulmooring: otherwise you're probably stuck until it gets released
[2013-05-10 21:36:47 -0400] ignatz: right. I'll look around. it's worth a little risk.
[2013-05-10 21:37:13 -0400] ignatz: q
[2013-05-10 21:37:18 -0400] ignatz: oops.
[2013-05-10 21:55:50 -0400] maek: anyone running a mirror of rubygems for internal use? if so how do you generate the index? gem generate_index is not working for me.
[2013-05-10 21:55:58 -0400] maek: ot ^
[2013-05-10 21:57:22 -0400] ignatz: hm, even with that it still tries to connect before the instance is ready, and blows up.
[2013-05-10 21:57:25 -0400] ignatz: silly software.
[2013-05-10 22:01:48 -0400] new2chef: happy friday fellow cooks.  I was wondering if someone could help me figure out a head scratcher.  I'm trying to assign an array of a unique list of all the roles from chef_environment:production nodes.  so if I had             nodes = search(:node, "chef_environment:production")            I'd like to somehow get:     prod_roles = "iterate through @nodes and get a unique list of the roles"
[2013-05-10 22:01:51 -0400] new2chef: any pointers?
[2013-05-10 22:03:27 -0400] new2chef: by unique i mean, there are several roles that are common between nodes, however some that aren't.  I just need a list without dupes of all the roles
[2013-05-10 22:05:01 -0400] spox: u_roles = nodes.map(&:roles).uniq
[2013-05-10 22:05:02 -0400] justizin: guys i moved a knife config from my macbook air at work to my macbook pro at home, and i did a chef 11 install over top of the chef 10 install that was on this box, now knife node list works, but knife ec2 server list stalls and eventually fails to connect ssl.  is it possible some part of knife 10 is still around? i used the gem install from /opt/chef.
[2013-05-10 22:05:32 -0400] justizin: these are also same version of OSX, this MBP was rebuilt fresh less than a month ago with mountain lion, to install an SSD, and the air is brand new.
[2013-05-10 22:05:49 -0400] new2chef: thanks spox! i'll give that a whirl
[2013-05-10 22:06:52 -0400] cheeseplus: justizin: have you tried reinstalling the gem into the embedded chef gems?
[2013-05-10 22:07:23 -0400] justizin: well, i just installed it.  i guess i can gem install again, but i'm not sure i see why that's a suspect?
[2013-05-10 22:07:37 -0400] justizin: also it doesn't have an error using the knife-ec2 gem, it just fails to connect ssl
[2013-05-10 22:07:43 -0400] cheeseplus: ahh
[2013-05-10 22:08:03 -0400] cheeseplus: yea, I've seen odd issues especially if there is a system gem vs the embedded one
[2013-05-10 22:08:07 -0400] justizin: it's definitely using the right knife config, though, because my previous config was for our internal server at gap, and this is for hosted chef (new employer)
[2013-05-10 22:08:27 -0400] justizin: i think chef 10 was installed omnibus, too
[2013-05-10 22:08:30 -0400] justizin: there is no system chef gem
[2013-05-10 22:08:40 -0400] justizin: gem list is, in fact, empty
[2013-05-10 22:08:53 -0400] cheeseplus: well that was my easy fix out the window
[2013-05-10 22:08:55 -0400] justizin: as you'd imagine, since chef is really the only ruby thing i use, and i just built this box as a chef workstation.
[2013-05-10 22:09:00 -0400] justizin: cheeseplus: hah, well, you gotta try ;d
[2013-05-10 22:09:06 -0400] justizin: if you'd have been right i'd owe ya a beer!
[2013-05-10 22:09:17 -0400] justizin: (which i'm not hard to talk out of, anyhow ;d)
[2013-05-10 22:09:23 -0400] cheeseplus: Oh low hanging fruit question? Sure, OH GOD NO IT'S BAD
[2013-05-10 22:09:29 -0400] justizin: right
[2013-05-10 22:09:36 -0400] justizin: "Do you have a ~/.chef/knife.rb file?"
[2013-05-10 22:09:41 -0400] justizin: "well, i dunno then.  i'm spent."
[2013-05-10 22:09:43 -0400] justizin: :-P
[2013-05-10 22:10:19 -0400] cheeseplus: yea failing to connect SSL could mean a few things
[2013-05-10 22:10:45 -0400] cheeseplus: this may be a left field one but is your clock in sync?
[2013-05-10 22:10:58 -0400] justizin: i hope so? ;d
[2013-05-10 22:11:14 -0400] justizin: osx usually does that.. it seems to agree with my iphone
[2013-05-10 22:11:29 -0400] justizin: and, to take apple out of the picture, an ec2 vm ;)
[2013-05-10 22:11:37 -0400] justizin: oh wow
[2013-05-10 22:11:39 -0400] justizin: hang on
[2013-05-10 22:11:48 -0400] justizin: my linode is 3m ahead of those..
[2013-05-10 22:11:53 -0400] justizin: what's you're clock minute?
[2013-05-10 22:11:56 -0400] justizin: er your
[2013-05-10 22:12:04 -0400] justizin: i have three 11's and a 14
[2013-05-10 22:12:11 -0400] justizin: is the linode off or are apple and amazon plotting something?
[2013-05-10 22:12:23 -0400] cheeseplus: probably just normal drift
[2013-05-10 22:12:26 -0400] justizin: i'm thinking the linode is off
[2013-05-10 22:14:00 -0400] justizin: any other idears? again, i can talk to hosted chef, but not aws
[2013-05-10 22:14:08 -0400] justizin: knife node list works, knife ec2 server list not so much
[2013-05-10 22:14:18 -0400] justizin: which would also explain away clock
[2013-05-10 22:14:40 -0400] justizin: and it's the first time on this box, so i expect it's environment and not some networky thing..
[2013-05-10 22:14:51 -0400] justizin: i just tar-ed up .chef from my air and airdrop-ed it while i had both at home the other day.
[2013-05-10 22:14:52 -0400] cheeseplus: yea, just went there cause SSL likes timing to be good
[2013-05-10 22:14:57 -0400] justizin: right
[2013-05-10 22:15:13 -0400] justizin: i should try the same .chef on my linode
[2013-05-10 22:15:32 -0400] justizin: don't really want to rely on that as a management workstation because, well, people seem to steal a lot of bitcoin from linodes ;d
[2013-05-10 22:15:37 -0400] cheeseplus: I expect knife-ec2 is using your amazon key, did that get moved over
[2013-05-10 22:15:38 -0400] cheeseplus: ?
[2013-05-10 22:15:43 -0400] cheeseplus: and are the perms on it good?
[2013-05-10 22:15:46 -0400] justizin: should be in ~/.chef but i'll chef
[2013-05-10 22:15:49 -0400] justizin: i used -p on tar
[2013-05-10 22:15:51 -0400] justizin: both ways
[2013-05-10 22:16:17 -0400] cheeseplus: I have keys in a number of random places, don't think my AWS key is in there
[2013-05-10 22:16:20 -0400] justizin: and i am 'justizin' on both machines
[2013-05-10 22:16:30 -0400] cheeseplus: but I also don't use knife-ec2 all that much
[2013-05-10 22:16:33 -0400] justizin: the aws key is in knife.rb
[2013-05-10 22:21:20 -0400] cheeseplus: justizin: I'm out of ideas as to why it wouldn't just work
[2013-05-10 22:21:35 -0400] cheeseplus: figuring there might be something useful in the debug output of the knife-ec2 gem
[2013-05-10 22:23:07 -0400] justizin: not getting anything fun with -V, how do i get debug output?
[2013-05-10 22:27:06 -0400] cheeseplus: -VV?
[2013-05-10 22:27:09 -0400] cheeseplus: lol
[2013-05-10 22:31:20 -0400] miah: chef-client -l debug
[2013-05-10 22:35:55 -0400] cheeseplus: for some reason I was thinking the options passed to ssh there
[2013-05-10 22:36:06 -0400] cheeseplus: maybe it's time to back away from the console
[2013-05-10 22:54:56 -0400] Kyle11: I'm trying to specify multiple depends in a cookbook and am unsure of the syntax  https://gist.github.com/kylesloan/eb155491cacd815c8914
[2013-05-10 22:55:53 -0400] Kyle11: gah nevermind... helps when I save the metadata.rb before uploading the cookbook
[2013-05-10 23:01:41 -0400] rava: curious about the whole wrapper cookbook idea vs roles, for those following that pattern, do you just manage run lists using cookbook default recipes?
[2013-05-10 23:02:11 -0400] rava: and move away from roles entirely? a hodge podge of both?
[2013-05-10 23:05:58 -0400] yfeldblum: rava, a top-level recipe may simply include a number of other recipes as its implementation
[2013-05-10 23:06:23 -0400] yfeldblum: rava, and not just other recipes from within the same cookbook, but certainly recipes from other cookbooks too
[2013-05-10 23:06:33 -0400] rava: yes, and that's how i've started to use this pattern. i'm mainly curious as to where people are using roles as opposed to a cookbook and vise versa
[2013-05-10 23:07:13 -0400] yfeldblum: rava, when the role maps specifically to a distinct class of function that may be assigned to a server
[2013-05-10 23:07:31 -0400] hdee: <yfeldblum> rava, and not just other recipes from within the same cookbook, but certainly recipes from other cookbooks too
[2013-05-10 23:07:32 -0400] hdee: [16:06] <rava> yes, and that's how i've started to use this pattern. i'm mainly curious as to where people are using roles as opposed to a cookbook and vise versa
[2013-05-10 23:07:33 -0400] hdee: oops
[2013-05-10 23:07:38 -0400] yfeldblum: rava, the role does not need to include dozens of items in its run-list; it may instead include a single top-level recipe in its run-list
[2013-05-10 23:07:40 -0400] hdee: http://realityforge.org/code/2012/11/19/role-cookbooks-and-wrapper-cookbooks.html
[2013-05-10 23:08:10 -0400] hdee: great question rava... didn't know about that wrapper cookbook concept
[2013-05-10 23:08:31 -0400] hdee: i have like copies of roles for each environment... is starting to get crazy
[2013-05-10 23:09:17 -0400] rava: ya, roles get real sticky and painful quick if you haven't preplanned very, very well
[2013-05-10 23:10:49 -0400] miah: i still think that wrapper cookbook role is a bad idea
[2013-05-10 23:11:19 -0400] rava: miah: isn't it just an extension of the application cookbook idea?
[2013-05-10 23:11:25 -0400] miah: the only reasons roles get painful is because everybody writes cookbooks incorrectly =)
[2013-05-10 23:11:36 -0400] rava: miah: lol, truth
[2013-05-10 23:12:08 -0400] miah: i think that a wrapper cookbook should be defined as one that implements your business logic ontop of resources provided by Chef or other Cookbooks
[2013-05-10 23:12:16 -0400] yfeldblum: miah, the reason i've seen for roles getting painful is when they include too many implementation details
[2013-05-10 23:12:17 -0400] miah: and i mean resources in the very technical sense
[2013-05-10 23:12:24 -0400] miah: yfeldblum: yup
[2013-05-10 23:12:38 -0400] miah: because all those implementation details are numerous attributes :/
[2013-05-10 23:12:53 -0400] rava: yfeldblum: but then you're bouncing implementation details all over the place, between roles and data bags and what not
[2013-05-10 23:13:02 -0400] miah: yup
[2013-05-10 23:13:15 -0400] rava: one thing i really appreciate about the wrapper is that it encapsulates almost everything in one place
[2013-05-10 23:13:28 -0400] hdee: so whats the ideal setup then?
[2013-05-10 23:13:30 -0400] rava: WITH the business logic, but decoupled enough to be reusable
[2013-05-10 23:13:43 -0400] rava: hdee: whatever ends up working best for your org :D
[2013-05-10 23:13:50 -0400] hdee: heh
[2013-05-10 23:13:57 -0400] miah: well, the original cookbook should be completely decoupled from business logic (eg, dont include 'search', etc)
[2013-05-10 23:14:14 -0400] miah: create a resource, and allow me to manage it
[2013-05-10 23:14:30 -0400] miah: i'll write a wrapper that does search or whatever and passes that to a resource as a argument
[2013-05-10 23:14:30 -0400] rava: miah: no argument there, but i'm assuming a lib cookbook is implied :)
[2013-05-10 23:14:36 -0400] miah: ya
[2013-05-10 23:14:47 -0400] miah: there arent enough lib cookbooks in the community though
[2013-05-10 23:15:08 -0400] yfeldblum: rava, no, all implementation details go in cookbooks; never in roles and never in data-bags
[2013-05-10 23:15:09 -0400] miah: and the most popular cookbooks aren't lib cookbooks
[2013-05-10 23:15:34 -0400] yfeldblum: rava, top-level classification of nodes goes in roles and data goes in data-bags
[2013-05-10 23:16:04 -0400] yfeldblum: rava, the data in data-bags is the orthogonal important non-stupid stuff; paths to executables do *not* go in data-bags
[2013-05-10 23:17:44 -0400] miah: agreed
[2013-05-10 23:17:53 -0400] rava: yfeldblum: hah, i cringe at the thought of someone doing that
[2013-05-10 23:17:53 -0400] miah: i dont think stuff like 'paths' should even be in attributes
[2013-05-10 23:18:01 -0400] miah: in the majority of cookbooks
[2013-05-10 23:18:13 -0400] miah: they can be default attributes in a resource
[2013-05-10 23:18:22 -0400] miah: and you might define them as an attribute for your business logic
[2013-05-10 23:18:29 -0400] miah: but they shouldn't be defaulted to node attributes
[2013-05-10 23:18:36 -0400] rava: miah: amen
[2013-05-10 23:25:01 -0400] miah: i think this will improve as the number of ops folks doing chef dev learn more about object oriented programming in ruby
[2013-05-10 23:26:33 -0400] rava: miah: chef's almost too unopinnionated. i have to keep poking my guys to stop writing recipes like shell scripts
[2013-05-10 23:26:55 -0400] miah: ya
[2013-05-10 23:26:56 -0400] rava: and the whole structure like it's going to pull everything from env variables
[2013-05-10 23:27:06 -0400] miah: ya. its painful
[2013-05-10 23:27:41 -0400] rava: the worse are the ones that try sed/awk magic in the goddamn recipe...
[2013-05-10 23:27:45 -0400] miah: its like "now, if all of these attributes are set correctly, and these case statements match, and if these conditionals are good. we'll have a usable node."
[2013-05-10 23:27:50 -0400] miah: YA. HAVE FUN TESTING THAT.
[2013-05-10 23:28:02 -0400] rava: hahah
[2013-05-10 23:29:31 -0400] rava: if i see another "cat << EOF ... EOF | sed/awk" i might murder half my team
[2013-05-10 23:31:59 -0400] rava: feeling kinda silly i didn't follow the logic train past wrapper cookbooks to role cookbooks, this makes a lot of sense to my sleep deprived brain
[2013-05-10 23:32:29 -0400] rava: hdee: thanks for the link, i missed this article in my trolling for ideas on this subject
[2013-05-10 23:33:32 -0400] rava: now i want to rework all my role stacking i did when we first started with chef
