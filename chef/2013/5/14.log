[2013-05-14 00:01:01 -0400] makerbreaker: whats the verbose output
[2013-05-14 00:01:20 -0400] benkay: chef 11.4.0
[2013-05-14 00:01:32 -0400] benkay: literally
[2013-05-14 00:01:35 -0400] benkay: it's a hilarious :)
[2013-05-14 00:01:51 -0400] benkay: oh wait that was -v not verbose
[2013-05-14 00:01:52 -0400] benkay: derp
[2013-05-14 00:02:35 -0400] benkay: what is the verbose option?
[2013-05-14 00:03:08 -0400] silk: -l debug
[2013-05-14 00:03:24 -0400] benkay: shanks
[2013-05-14 00:03:58 -0400] silk: no drama
[2013-05-14 00:04:16 -0400] benkay: it says chef is already running, but a `ps aux | grep chef` returns only the grep
[2013-05-14 00:04:18 -0400] benkay: :(
[2013-05-14 00:04:55 -0400] silk: you ran chef-client -l debug from the cmdline?
[2013-05-14 00:05:21 -0400] silk: but there is no chef-client in the process list?
[2013-05-14 00:05:42 -0400] silk: Has it left behind a pid file?
[2013-05-14 00:07:34 -0400] benkay: where does chef keep its pidfile?
[2013-05-14 00:08:16 -0400] benkay: i was expecting /var/run but moar sadface
[2013-05-14 00:15:56 -0400] organicveggie: When using the deploy resource to install something from GitHub, is it possible to control the key or credentials used?
[2013-05-14 00:18:50 -0400] organicveggie: Basically, I'm trying to use the deploy resource against a private GitHub repo and I can't seem to get it work from within Chef.
[2013-05-14 00:20:59 -0400] silk: benkay, /var/run/chef/
[2013-05-14 00:21:36 -0400] silk: or check for a pid_file directive in your client.rb
[2013-05-14 00:24:12 -0400] ponyofdeath: hi, is there a good way to only change ownership of a file if the user exists or to not cause chef to error out if the user does not exist?
[2013-05-14 00:25:33 -0400] shane_: why would chef client try to connect to the local hostname:443/bookshelf during a bootstrap ?
[2013-05-14 00:26:05 -0400] shane_: all the other components are connecting to the proper chef server fqdn that is defined in client.rb
[2013-05-14 00:26:11 -0400] silk: ponyofdeath, is that in a cookbook_file resource?
[2013-05-14 00:26:38 -0400] ponyofdeath: silk: yup
[2013-05-14 00:26:55 -0400] silk: its ugly, but you could set ignore_failure true
[2013-05-14 00:26:58 -0400] silk: on that resource
[2013-05-14 00:27:39 -0400] silk: or you could set a not_if {} and perform a test for the presence of the user
[2013-05-14 00:27:47 -0400] ponyofdeath: silk: ok thanks!
[2013-05-14 00:27:51 -0400] silk: except that would prevent the file from being provisioned as well
[2013-05-14 00:28:01 -0400] silk: ponyofdeath, test it
[2013-05-14 00:28:05 -0400] silk: its a theory :)
[2013-05-14 00:28:18 -0400] ponyofdeath: silk: do you know if I can only call yum or apt repo based on which os it is from other recepies or an role?
[2013-05-14 00:29:02 -0400] silk: just use a package resource, it should figure out which it wants based on the OS
[2013-05-14 00:29:09 -0400] ponyofdeath: i have a base recepie and i want to call apt-get update or yum update and set up the default repos
[2013-05-14 00:29:15 -0400] ponyofdeath: silk: i do use the package resoure
[2013-05-14 00:29:17 -0400] ponyofdeath: which failes
[2013-05-14 00:29:25 -0400] ponyofdeath: because apt-get update has not been performed
[2013-05-14 00:29:55 -0400] benkay: fascinatingly, silk, there is no pidfile directive in client.rb
[2013-05-14 00:30:03 -0400] ponyofdeath: how can i inside an recepie call another recepie such as apt only if node os is ubuntu/debian
[2013-05-14 00:31:05 -0400] silk: you woujld have to do an include_recipe within a conditional statement
[2013-05-14 00:31:49 -0400] ponyofdeath: silk: ok thanks!
[2013-05-14 00:32:46 -0400] silk: benkay can you gist the output? of your chef run with -l debug?
[2013-05-14 00:35:12 -0400] benkay: homes I hammered that server
[2013-05-14 00:35:20 -0400] benkay: chef is no longer running
[2013-05-14 00:36:40 -0400] benkay: fairly confident of that :)
[2013-05-14 00:38:31 -0400] organicveggie: Any one had any luck cloning private repositories from GitHub in a Chef recipe?
[2013-05-14 00:52:49 -0400] bluekelp_: organicveggie: you might need to pull a SSH key down from somewhere for that to work
[2013-05-14 00:53:23 -0400] bluekelp_: i haven't with chef but i've had good luck with other projects adding a "readonly" user to the org whose SSH key is semi-public (within the org)
[2013-05-14 00:53:46 -0400] organicveggie: bluekelp_:I've got a key, but the deploy resource doesn't seem to use it. And just writing a bash script within a recipe doesn't work either unless I explicitly add GitHub to known_hosts.
[2013-05-14 00:55:57 -0400] bluekelp_: sounds like the lwrp needs a ssh_key attribute; unfortunately i haven't tried yet to can't be of much help -- i'm still trying to undo all of the "magic" that's baked into our AMIs so i'll run across it soon enough though
[2013-05-14 00:56:07 -0400] organicveggie: :)
[2013-05-14 01:08:57 -0400] pcn: organicveggie have you tried also writing out a ~/.ssh/config for the user with chef?  My understanding is that Net::SSH tries to parse and honor such things
[2013-05-14 01:09:45 -0400] organicveggie: pcn: yeah, no luck. after more experimentation, i think it's tied to github not being in the known_hosts.
[2013-05-14 01:10:14 -0400] organicveggie: i tried creating ~/.ssh/config *and* updating known_hosts within the recipe and that seems to work.
[2013-05-14 01:10:24 -0400] organicveggie: just feels like a real kludge.
[2013-05-14 01:16:52 -0400] bluekelp_: Net::SSH might not (?) accept unknown host keys w/o some sort of option?  indeed seems kludgy
[2013-05-14 01:17:28 -0400] organicveggie: bluekelp_:Ugh. I haven't actually sat down with Net::SSH and dived into it. SSH in generally is pretty fussy (for good reasons).
[2013-05-14 01:19:07 -0400] bluekelp_: yeah.  ppl were freaked out when i asked how to auto-accept host keys (for good reason) -- but in an anonymous, dynamic, node-plasma with new nodes coming up/down all the time my scripts can't pause for confirmation of host keys on new transient nodes, etc.
[2013-05-14 01:20:20 -0400] bluekelp_: i don't know of a better way yet - since i'm always "doing stuff" to bunches of nodes -- many of which i spun up just for a test (mainly forcing chef runs)
[2013-05-14 02:17:02 -0400] halcyonCorsair: hey, so anyone around? i'm having a chef-server 11 go crazy with beam processes pegging at 100%
[2013-05-14 02:18:38 -0400] halcyonCorsair: can anyone point me in the direction of what to look for?
[2013-05-14 03:20:56 -0400] maek: anyone know whats up with the dmg cookbook and the lwrp? Im getting 'wrong number of arguments (2 for 1)' from the package resource ? if Resource.const_defined?(class_name, false)
[2013-05-14 03:21:02 -0400] maek: jtimberman: ^ by chance?
[2013-05-14 03:24:17 -0400] maek: oh I see, its the fact that I have ruby 1.8.7 and chef 11.4 - ty sorry for spam
[2013-05-14 03:24:23 -0400] maek: fwiw https://github.com/opscode/chef/commit/7639ae987aaf7fe573ee0e50feb284fbedca1171
[2013-05-14 03:54:37 -0400] densone: Is there a quick way to upgrade a chef client that was installed with omnibus.
[2013-05-14 03:54:57 -0400] densone: Having trouble finding a doc on the wiki that covers this.
[2013-05-14 04:00:18 -0400] pcn: Docs?  That's a good question.  Omnibus is usually a packaged installation, so it should be upgradable on most platforms
[2013-05-14 04:00:28 -0400] pcn: You could check inside the install script
[2013-05-14 04:03:46 -0400] densone: pcn: got it
[2013-05-14 04:04:01 -0400] densone: Just rerun install.sh and pass -v
[2013-05-14 04:05:13 -0400] densone: Wasn't clear anywhere.
[2013-05-14 04:31:46 -0400] jtimberman: densone: there's an "omnibus updater" cookbook by heavywater on the community site, i know some folks have had success with it.
[2013-05-14 04:32:52 -0400] densone: cool. thanks for the info. It's rare that I'd need to update, but have a dependency issue with the apt cookbook.
[2013-05-14 04:34:12 -0400] densone: knife ssh 'name:*' 'curl -L https://www.opscode.com/chef/install.sh > /tmp/install.sh && bash /tmp/install.sh -v 10.24.0' should work for me :)
[2013-05-14 04:35:33 -0400] jtimberman: densone: curl -L https://opscode.com/chef/install.sh | sudo bash -- -v 10.24.0
[2013-05-14 04:35:40 -0400] densone: heh
[2013-05-14 04:35:42 -0400] jtimberman: if you want to avoid writing the file :)
[2013-05-14 04:36:04 -0400] densone: I actually really appreciate that.
[2013-05-14 04:36:21 -0400] llakey: by default, ec2 instances have an ec2 "internal" FQDN. what's the best practice for replacing/updating that FQDN so that when i run "knife ec2 server create" i end up with a public FQDN on the node and stored in the chef server?
[2013-05-14 04:36:56 -0400] jtimberman: densone: i look forward to having the private chef push client aroudn so i can do 'knife job start upgrade-chef' :)
[2013-05-14 04:37:29 -0400] densone: Ahh, I keep hearing about pushy
[2013-05-14 04:37:33 -0400] densone: Is that going to OSS?
[2013-05-14 04:40:34 -0400] jtimberman: "eventually" - the primitives will.
[2013-05-14 04:40:48 -0400] jtimberman: i don't know the detail of what that means yet.
[2013-05-14 04:40:50 -0400] densone: That's one of the big missing things for me.
[2013-05-14 04:40:54 -0400] densone: Looking forward to it.
[2013-05-14 04:41:03 -0400] jtimberman: or you could get private chef :D
[2013-05-14 04:41:33 -0400] densone: haha.
[2013-05-14 04:41:38 -0400] densone: Doesn't that cost money?
[2013-05-14 04:41:55 -0400] jtimberman: It does, as a matter of fact ;)
[2013-05-14 04:42:05 -0400] ssd7: Ohai Chefs
[2013-05-14 04:42:15 -0400] jtimberman: ssd7: what kind of damage did your editor + wine do?
[2013-05-14 04:43:29 -0400] ssd7: well, right now I am squashing some more foodcritic warnings
[2013-05-14 04:44:29 -0400] jtimberman: nice!
[2013-05-14 04:50:49 -0400] densone: llakey: use json attributes with knife ec2 server create?
[2013-05-14 04:51:21 -0400] densone: Then set the fqdn with that.
[2013-05-14 04:55:01 -0400] llakey: densone: interesting. i think it looks like people may be using a recipe which runs after the instance boots, queries the local ec2 instance "meta-data" for the ec2 instance's public hostname, writes that to the hostname and hosts files, and maybe reloads ohai.
[2013-05-14 04:55:33 -0400] jtimberman: llakey: yup
[2013-05-14 04:56:14 -0400] llakey: cool
[2013-05-14 05:01:43 -0400] densone: I was wrong actually. We don't use json attributes.
[2013-05-14 05:02:20 -0400] densone: We do something very similar with the ec2 metadata.
[2013-05-14 05:02:30 -0400] densone: and also hack in route53
[2013-05-14 05:02:39 -0400] mksm: Hello. I'm having issues with the deploy_branch resource symlinks. The shared folder is created, but not the {pids, log} (in my case) subdirs. So, for example, when symlinks are created from current/tmp/pids -> shared/pids, the target does not exist
[2013-05-14 05:03:32 -0400] densone: deploy_branch or deploy_revision?
[2013-05-14 05:03:56 -0400] mksm: deploy_branch
[2013-05-14 05:04:38 -0400] densone: ahh. deploy is deploy_branch, just a short name.
[2013-05-14 05:04:40 -0400] densone: Cool.
[2013-05-14 05:07:26 -0400] mksm: I could manually create shared/{log,pids} but it doesn't seem right
[2013-05-14 05:19:24 -0400] martinisoft: *hears the clackety clack of his mechanical keyboard amongst the crickets in this room*
[2013-05-14 05:19:57 -0400] martinisoft: anyone else up late hacking away at cookbooks with test kitchen?
[2013-05-14 05:20:07 -0400] miah: not at the moment
[2013-05-14 05:20:12 -0400] miah: i am hacking on cookbooks though
[2013-05-14 05:21:38 -0400] martinisoft: ah, hiya miah :)
[2013-05-14 05:22:05 -0400] martinisoft: I seriously still need to level up my LWRP-fu
[2013-05-14 05:22:06 -0400] jtimberman: martinisoft: I am :)
[2013-05-14 05:22:26 -0400] martinisoft: jtimberman: hiya! *wave*
[2013-05-14 05:23:27 -0400] ssd7: So, going through these foodcritic errors, I just came across an instance in the old notification style that never occured to me before:
[2013-05-14 05:23:30 -0400] ssd7:   notifies :run, resources(:execute => [ "nscd-clear-passwd", "nscd-clear-group" ]), :immediately
[2013-05-14 05:24:13 -0400] jtimberman: ssd7: ha!
[2013-05-14 05:24:15 -0400] jtimberman: yeah :)
[2013-05-14 05:24:19 -0400] martinisoft: right now I am breaking apart my monolithic chef-repo, guided by test-kitchen
[2013-05-14 05:24:40 -0400] jtimberman: \o/
[2013-05-14 05:24:44 -0400] martinisoft: I started by deleting the cookbooks/ directory, now the roles/ directory is gone
[2013-05-14 05:25:11 -0400] martinisoft: but now, 'splosion of tiny, isolated cookbooks
[2013-05-14 05:26:25 -0400] jtimberman: ssd7: hey so
[2013-05-14 05:26:27 -0400] martinisoft: its making me want to write a wrapper-cookbook generator
[2013-05-14 05:28:10 -0400] miah: heh
[2013-05-14 05:28:52 -0400] martinisoft: had to write so many of them to break all the fork/git submodule mess I had made apart
[2013-05-14 05:29:04 -0400] miah: oh
[2013-05-14 05:29:28 -0400] ssd7: jtimberman: what's up?
[2013-05-14 05:29:56 -0400] martinisoft: miah: I was one of those people who did all the wrong things with their chef-repo initially.. everything (I mean everything) in git
[2013-05-14 05:30:51 -0400] jtimberman: ssd7: that whole loading things in the right order bit
[2013-05-14 05:31:08 -0400] jtimberman: ssd7: makes it awkward to test recipes that use library files that they contain.
[2013-05-14 05:31:13 -0400] jtimberman: inside chefspec
[2013-05-14 05:32:44 -0400] ssd7: How so, I haven't come across this much yet
[2013-05-14 05:33:03 -0400] jtimberman: ssd7: in the java cookbook
[2013-05-14 05:33:10 -0400] jtimberman: ssd7: i created a libraries/helpers.rb
[2013-05-14 05:34:23 -0400] jtimberman: ssd7: but the recipe can't find the module, because it didn't load the libraries
[2013-05-14 05:34:58 -0400] jtimberman: because 'java' is included via the ChefSpec::ChefRunner, rather than being in the node's run list or the cookbook metadata (the windows cookbook, a dependency, DOES have its libraries loaded)
[2013-05-14 05:35:59 -0400] ssd7: OIC
[2013-05-14 05:36:51 -0400] jtimberman: e.g., https://gist.github.com/jtimberman/ff0519a959fbe259f5e2
[2013-05-14 05:38:45 -0400] miah: interesting
[2013-05-14 05:39:23 -0400] ssd7: Feels like the thing to do is to fix ChefSpec to load cookbooks that it will be testing in a manner similar to chef-client
[2013-05-14 05:41:41 -0400] jtimberman: indeed.
[2013-05-14 05:43:11 -0400] ssd7: Heh, a folder called monkey patches is always a good sign
[2013-05-14 05:44:21 -0400] jtimberman: where?
[2013-05-14 05:44:39 -0400] ssd7: in ChefSpec
[2013-05-14 05:45:01 -0400] ssd7: jtimberman: So, I'm a little confused as there seems to be a line in that debug output where it is loading the library in question
[2013-05-14 05:45:04 -0400] ssd7: before the failure
[2013-05-14 05:47:03 -0400] jtimberman: ssd7: oho?
[2013-05-14 05:47:29 -0400] jtimberman: which line
[2013-05-14 05:47:32 -0400] jtimberman: in the gist
[2013-05-14 05:47:39 -0400] ssd7: 18
[2013-05-14 05:47:55 -0400] jtimberman: well shit :(
[2013-05-14 05:48:35 -0400] jtimberman: thanks, I r stupid :)
[2013-05-14 05:48:36 -0400] ssd7: I think I see your issue
[2013-05-14 05:48:44 -0400] ssd7: jdk -> JDK :)
[2013-05-14 05:48:46 -0400] jtimberman: OpenJDK vs Openjdk
[2013-05-14 05:48:47 -0400] jtimberman: ya
[2013-05-14 05:49:17 -0400] jtimberman: well now it's failing elsewhere
[2013-05-14 05:49:30 -0400] ssd7: Yeah, looking at the ChefSpec code.  The way it is doing cookbook loading looks OKish.
[2013-05-14 05:50:07 -0400] ssd7: Also an oddity, your cookbooks to load has :java rather than "java" but it doesn't seem to matter since we tend to Mash all the things
[2013-05-14 05:51:08 -0400] jtimberman: yeah it's passing that test now
[2013-05-14 05:53:16 -0400] jtimberman: okay, running TK and now bed time :)
[2013-05-14 05:53:24 -0400] jtimberman: thanks for pointing out my typo :)
[2013-05-14 05:57:21 -0400] ssd7: np, have a nice night :)
[2013-05-14 08:22:51 -0400] m4rcu5: i have some keys which come in XML format, they are specific to a node. how would i get these on the nodes in the RightWay(tm)?
[2013-05-14 08:24:41 -0400] tolland_: does the windows client support the http_proxy options in knife.rb?
[2013-05-14 08:50:20 -0400] nejsum: anyone seeing issues with Hosted Chef? Seeing lots of permission denied errors
[2013-05-14 08:50:21 -0400] helllen: helllom has the new version of chef init script to stop and start services
[2013-05-14 08:50:21 -0400] helllen: for example postgres
[2013-05-14 08:50:21 -0400] helllen: for example I know it is done with:   chef-server-ctl restart postgresql
[2013-05-14 08:50:21 -0400] helllen: but is there any init script ?
[2013-05-14 09:02:58 -0400] n0xie: http://i.imgur.com/CFYgRxX.jpg
[2013-05-14 10:46:50 -0400] helllen: helllo, what is bookshelf used for ?
[2013-05-14 11:04:28 -0400] silk: I dont imagine thereis anyone awake that can help with a chefspec issue though I dare say its an underlying chef issue
[2013-05-14 11:14:39 -0400] ermajn: I have a problem.. that everything works wine with chef-solo, but with chef-client I have error and I can not understand the problem..
[2013-05-14 11:14:49 -0400] silk: gist?
[2013-05-14 11:16:29 -0400] ermajn: silk, here it is: https://gist.github.com/ermajn/5575219
[2013-05-14 11:16:38 -0400] ermajn: that is my client.log output... with debug mode on
[2013-05-14 11:17:40 -0400] silk: can you include /monitor/recipes/_master_search.rb as well
[2013-05-14 11:17:59 -0400] silk: im guessing you arent populating a variable, and calling .has_key?() on it
[2013-05-14 11:20:28 -0400] ermajn: silk, ok, i have added the fie
[2013-05-14 11:20:29 -0400] ermajn: file*
[2013-05-14 11:21:33 -0400] ermajn: this is coomunity cookbook, sensu... and I have set in my cookbook that depends on sensu in attributes.rb this: default["sensu"]["use_ssl"] = false
[2013-05-14 11:21:44 -0400] ermajn: but, it looks like sensu cookbook does not see it
[2013-05-14 11:22:01 -0400] ermajn: or it takes he's own paramter, not that from my cookbook
[2013-05-14 11:23:33 -0400] silk: ok so im guessing that your not finding a node with your search for  recipes:monitor::master
[2013-05-14 11:24:21 -0400] silk: if you do a 'knife node search "recipes:monitor\:\:master"' what do you get?
[2013-05-14 11:25:20 -0400] ermajn: silk, on node? I can not execute that on node..I got error, that could be a problem... right?
[2013-05-14 11:25:31 -0400] silk: search node sorry
[2013-05-14 11:26:07 -0400] silk: knife search node "recipes:monitor\:\:master"
[2013-05-14 11:26:23 -0400] ermajn: silk, on node computer or on workstation
[2013-05-14 11:26:29 -0400] ermajn: i have no knife configuration on node
[2013-05-14 11:26:40 -0400] ermajn: on workstation I get: 0 items found
[2013-05-14 11:26:40 -0400] silk: workstatin with an appropriately configured knife.rb
[2013-05-14 11:26:56 -0400] silk: so, the recipe is searching for a node with that recipe
[2013-05-14 11:27:21 -0400] silk: and doesnt appear to be finding anything
[2013-05-14 11:27:50 -0400] silk: sorry, im being stupid.
[2013-05-14 11:28:01 -0400] silk: you said it worked with chef-solo, and not against a server?
[2013-05-14 11:28:05 -0400] ermajn: yes
[2013-05-14 11:29:21 -0400] silk: ok, so I think your real problem is that there is no server with the recipe monitor::master
[2013-05-14 11:30:17 -0400] silk: you can avoid the search by populating the attribute monitor.master_address
[2013-05-14 11:30:42 -0400] silk: but if you want the search to work, then you need a node with the monitor::master recipe
[2013-05-14 11:31:51 -0400] silk: it works with chef-solo, because the case statement populates master_node with localhost if that attribute is empty
[2013-05-14 11:32:57 -0400] maruq: hellen: I think you mean berkshelf?
[2013-05-14 11:33:31 -0400] maruq: It's a cookbook dependency manager. Like bundler from the Ruby world, but for cookbooks instead of gems
[2013-05-14 11:37:00 -0400] ermajn: hmmmm
[2013-05-14 12:21:10 -0400] thom: maruq: bookshelf is part of the server; it exposes an s3 compatible api
[2013-05-14 12:21:25 -0400] thom: (https://github.com/opscode/bookshelf)
[2013-05-14 12:21:37 -0400] thom: helllen: guess i answered your question too :)
[2013-05-14 12:21:58 -0400] maruq: thom: oh, it's new in 11. I'm still running 10.x here ;)
[2013-05-14 12:27:55 -0400] linuxboy: I see that chef 11 has removed the init script. What is the recommended method to run chef now? cron or daemon?
[2013-05-14 12:28:03 -0400] linuxboy: (I'm talking chef-client)
[2013-05-14 12:37:06 -0400] helllen: I have a look sorry I was out
[2013-05-14 12:37:34 -0400] helllen: does it replace postgres ?
[2013-05-14 12:37:44 -0400] helllen: why does chef needs s3 ?
[2013-05-14 12:40:22 -0400] helllen: and what is the bucket name ?
[2013-05-14 13:25:31 -0400] wamilton: can anyone provide an example of this approach: http://docs.opscode.com/essentials_cookbook_lwrp_providers_extend.html ? please and thanks
[2013-05-14 13:29:01 -0400] cwj: wamilton: the application cookbook and the application_(ruby|python|php|java) cookbooks which depend on it might be a good example
[2013-05-14 13:29:29 -0400] cwj: application cookbook provides an 'application' lwrp which is extended by the other cookbooks
[2013-05-14 13:30:38 -0400] cwj: and then one can write cookbooks that depend on, for example, application_python and use the lwrps it provides to deploy a python app
[2013-05-14 13:39:42 -0400] wamilton: cwj: thanks. The application cookbooks sure have come a long way... I remember them being nigh unreadable
[2013-05-14 13:40:42 -0400] cwj: yeah major rewrite circa 1.0
[2013-05-14 14:05:16 -0400] nd__: I have the feeling that the remote_file provider is downloading the file on every run, even though the checksum is provided (and matches). Can this be? Some examples do have a not_if { ::File.exists?(the_file) } why is this needed? The checksum should suffice, shouldn't it?
[2013-05-14 14:08:00 -0400] knuckolls: nd__: does the remote_file resource show up in the report handler as actually having run?
[2013-05-14 14:08:20 -0400] ermajn_: is it possible to override metadata.rb
[2013-05-14 14:08:22 -0400] aruntomar: nd__: you can use this action ":create_if_missing"
[2013-05-14 14:11:49 -0400] nd__: knuckolls: I'm unsure about the terminology, it shows up in the log of the run, yes and it takes longer than just running through, so I suspect it of downloading it every time
[2013-05-14 14:12:06 -0400] knuckolls: nd__: http://jtimberman.housepub.org/blog/2011/04/24/a-simple-report-handler/
[2013-05-14 14:12:15 -0400] knuckolls: i enable that report handler on every server, everywhere
[2013-05-14 14:12:27 -0400] knuckolls: so i can very clearly see in the logs exactly what resources fired that run
[2013-05-14 14:12:32 -0400] knuckolls: instead of what seemed to run by taking a while
[2013-05-14 14:12:36 -0400] nd__: aruntomar: Alright, thanks. Just to fully understand that, will :create_if_missing fetch the file if the checksum does *not* match any more (e.g. on an update)?
[2013-05-14 14:12:57 -0400] aruntomar: nd__: http://docs.opscode.com/resource_remote_file.html
[2013-05-14 14:13:12 -0400] knuckolls: you can also use the --why-run flag on the chef-client process to have chef explain itself
[2013-05-14 14:14:27 -0400] nd__: aruntomar: Well, it's the docs I am not sure about, that's why I am here
[2013-05-14 14:14:54 -0400] nd__: knuckolls: Ok, I will read about the handler and try why-run for a shortterm explanation :)
[2013-05-14 14:16:19 -0400] aruntomar: nd__: ok, so you don't need to have checksum, if all you need if to download the file if it's not does not exists.
[2013-05-14 14:17:18 -0400] nd__: No, I want to download the file if it does not exist or if it exists but without a matching checksum
[2013-05-14 14:17:21 -0400] aruntomar: nd__: probably it's taking time currently, because on every chef run, it will create the checksum of the file and match it with what you've provided in the recipe.
[2013-05-14 14:18:04 -0400] nd__: I thought about that too, but when I ssh in and calculate the sum, it's really fast
[2013-05-14 14:19:05 -0400] BryanWB_: dumb q, once i start windows box w/in a virtualbox from vagrant, how do i log into it? i assume that there won't be ssh installed on the windows vm
[2013-05-14 14:19:10 -0400] aruntomar: nd__: i'm assuming that you are running chef 11+
[2013-05-14 14:19:18 -0400] nd__: aruntomar: yes
[2013-05-14 14:19:50 -0400] aruntomar: nd__: chef-client 11+ gives a very good output when run, so it'll tell you whether the resource is up to date or whether it downloaded the file again.
[2013-05-14 14:20:28 -0400] nd__: oh, well actually the chef-client is 10.x, darn
[2013-05-14 14:20:42 -0400] knuckolls: BryanWB: never done it but remote desktop is probably enabled. that or you just hop into virtualbox itself and log in via the gui. i bet vagrant / vagrant is the login.
[2013-05-14 14:21:23 -0400] aruntomar: nd__: so update you chef-client and try out the stuff again
[2013-05-14 14:21:25 -0400] BryanWB_: fml, another thing i have no idea how to setup
[2013-05-14 14:21:32 -0400] BryanWB_: knuckolls: missed u at chefconf btw :)
[2013-05-14 14:21:59 -0400] aruntomar: nd__: another way is to use chef-shell, it's like irb, just take the piece of code that you want to test, and run it there
[2013-05-14 14:22:04 -0400] nd__: aruntomar: Yes, will do. Thank you so far
[2013-05-14 14:22:34 -0400] aruntomar: nd__: here's an example https://gist.github.com/aruntomar/5480702
[2013-05-14 14:26:53 -0400] knuckolls: BryanWB_: after watching a lot of the talks and missing out on connecting with everyone i'm pretty certain i'm not going to miss it again.
[2013-05-14 14:27:16 -0400] BryanWB_: knuckolls: awesome, look forward to seeing u at the next one
[2013-05-14 14:27:18 -0400] knuckolls: if you're on osx you should just be able to pull up virtualbox and log in by hand.
[2013-05-14 14:28:01 -0400] BryanWB_: knuckolls: may have to try that, tho winrm seems to be a gem dependency for bento
[2013-05-14 14:28:24 -0400] knuckolls: oh god something new in microsoft land i didn't know existed
[2013-05-14 14:29:06 -0400] knuckolls: if rdp is enabled, you may have to forward the port 3389 so you can use CoRD or something like it to log in
[2013-05-14 14:29:11 -0400] knuckolls: otherwise, godspeed :)
[2013-05-14 14:36:09 -0400] m4rcu5: can one split the execute command line in several lines, it is kinda long and unreadable ;)
[2013-05-14 14:39:22 -0400] jschneiderhan: I'm getting "dpkg: error: requested operation requires superuser privilege" when running test-kitchen with require_chef_omnibus:true. Has anyone seen this before by any chance?
[2013-05-14 14:46:36 -0400] eponymi: i'm using librarian to install cookbooks but i'm getting funny behavior and hoping for help. my repository has three branches: master, sys, proj. sys is for vagrant/chef, proj is for app, and master is for both read in as subtrees. but when i run librarian-chef install, it installs the cookbooks in the root of all three branches.
[2013-05-14 14:47:44 -0400] eponymi: is there any way to tell librarian what git branch i want cookbooks installed on?
[2013-05-14 14:54:59 -0400] nd__: Ah, well -l debug brought light onto this issue. So chef downloads the file to a temporary place, then calculates the checksum and decides wether to replace the file or not which is not what the docs state (IMHO).
[2013-05-14 14:58:06 -0400] nd__: And using action :create_if_missing does not look at the checksum at all Too bad. No auto-updating the file based on checksum (without polling the url on every run) it seems
[2013-05-14 15:01:33 -0400] sascha_d: @nd__  If your local file matches the checksum in the remote file block, it should not re-download the file
[2013-05-14 15:01:49 -0400] sascha_d: but if your local version doesn't match it will download again
[2013-05-14 15:05:31 -0400] nd__: sascha_d: This is what the docs say, but not what's happening: https://gist.github.com/alappe/5576645
[2013-05-14 15:06:41 -0400] sascha_d: @nd__ you need to put a checksum attribute in your remote file block
[2013-05-14 15:06:47 -0400] juliancdunn: nd__: remote_file will always redownload first... otherwise it doesn't know if the checksum has changed
[2013-05-14 15:06:50 -0400] sascha_d: otherwise chef doesn't know what the checksum SHOULD be
[2013-05-14 15:07:00 -0400] nd__: sascha_d: I do have that
[2013-05-14 15:07:30 -0400] sascha_d: @nd__ your gist is a little tough to read, but I don't see it in there
[2013-05-14 15:07:33 -0400] nd__: juliancdunn: What I understood from the docs: chef checks the local file against the checksum in the remote_file block. If it matches, the file clearly is up to date, so let it be. If not, download this file.
[2013-05-14 15:07:53 -0400] juliancdunn: nd__: not really. there's no checksumming in the HTTP protocol so the download has to happen every time.
[2013-05-14 15:08:05 -0400] juliancdunn: the checksum is used to see whether the resource should be updated and copy it over if it should.
[2013-05-14 15:08:27 -0400] juliancdunn: you can use some http_request resource trickery to leverage If-Modified-Since if you like, search for "Transfer a file only when the source has changed" on the remote_file page
[2013-05-14 15:09:49 -0400] nd__: juliancdunn: actually, it simply can checksum the local file no need for anything http in there
[2013-05-14 15:10:12 -0400] juliancdunn: yeah sorry, I think sascha_d is right
[2013-05-14 15:12:09 -0400] nd__: sascha_d: sorry, copied from tmux and another split was in there fixed no. I also added my remote_file block (which is not in the log)
[2013-05-14 15:12:14 -0400] BryanWB_: juliancdunn: this bento thing is super slick, tks for directing me
[2013-05-14 15:12:30 -0400] Cheeezit: is there a way to capture the return results of execute command
[2013-05-14 15:12:32 -0400] BryanWB_: no problems so far w/ win2k8r2, tho not done yet
[2013-05-14 15:12:36 -0400] juliancdunn: BryanWB_: sure
[2013-05-14 15:12:49 -0400] juliancdunn: BryanWB_: the Win2K12 def is still broken though, I'm still working on fixing it
[2013-05-14 15:13:01 -0400] juliancdunn: but Win 8 enterprise does work
[2013-05-14 15:16:04 -0400] jschneiderhan: in case anyone hits the same problem I was having above (privilege issue when test-kitchen installs chef) - it went away after updating test-kitchen
[2013-05-14 15:17:12 -0400] nd____: And then it works as stated beautiful
[2013-05-14 15:23:07 -0400] sascha_d: @nd____ I missed something
[2013-05-14 15:23:14 -0400] sascha_d: did you have a typo in your block?
[2013-05-14 15:24:32 -0400] BryanWB_: juliancdunn: the chef-install.bat failed for me , any way to rerun that w/out redoing the entire build?
[2013-05-14 15:25:44 -0400] Oct: ohai
[2013-05-14 15:25:50 -0400] Oct: apt repository down ?
[2013-05-14 15:26:10 -0400] juliancdunn: BryanWB_: you could winrm to the box. also what's the failure?
[2013-05-14 15:26:30 -0400] BryanWB_: juliancdunn: gets 500 from opscode.com when trying to download omnibus
[2013-05-14 15:27:10 -0400] BryanWB_: juliancdunn: y i will have to winrm in and do it
[2013-05-14 15:36:23 -0400] cburroughs: just to make sure I"m not crazy.  Should this recipie snippet only restart the daemon called gmond if the template changes, or every time? http://pastebin.com/6vgZsepw
[2013-05-14 15:37:22 -0400] juliancdunn: just if it changes cburroughs
[2013-05-14 15:38:20 -0400] cburroughs: thanks
[2013-05-14 15:39:28 -0400] cburroughs: I *think* just had an unstable sort int the template
[2013-05-14 16:04:32 -0400] mattupstate: is there a way to skip everything in a recipe if its running chef-solo?
[2013-05-14 16:07:05 -0400] mattupstate: trying to avoid nesting when possible
[2013-05-14 16:07:58 -0400] btm: mattupstate: try: return if Chef::Config[:solo]
[2013-05-14 16:08:26 -0400] mattupstate: i was thinking that, but i guess i was too lazy to try that quickly ;)
[2013-05-14 16:11:21 -0400] treanet: HI
[2013-05-14 16:15:56 -0400] magoo_: I need to implement file integrity monitoring across our production. I like how lightweight aide is (and there's a cookbook available for it) but I need to integrate it with chef in a way that the file integrity database is not stored on the local system. I'm not sure of the best approach here.
[2013-05-14 16:17:18 -0400] magoo_: if it just stays on the system, such as the current cookbook has it, an attacker can just rebuild the database after modifying the files it's monitoring... this pretty much defeats the purpose
[2013-05-14 16:18:28 -0400] gleam: you could look at an alternative with a client/server architecture
[2013-05-14 16:18:30 -0400] gleam: samhain or something
[2013-05-14 16:19:00 -0400] gleam: it has the advantage of supporting inotify too
[2013-05-14 16:19:01 -0400] magoo_: haven't seen that one yet, i'll have a look
[2013-05-14 16:19:12 -0400] magoo_: does seem ideal to have a client/server architecture for this
[2013-05-14 16:19:26 -0400] gleam: you ship prebuilt binaries to the nodes, they're signed + have the destination server built in
[2013-05-14 16:19:29 -0400] gleam: to the binary
[2013-05-14 16:19:38 -0400] gleam: generate them on the server side
[2013-05-14 16:20:24 -0400] magoo_: this looks promising
[2013-05-14 16:23:20 -0400] magoo_: gleam: thanks for that... i think this is the right solution
[2013-05-14 16:23:47 -0400] gleam: sure
[2013-05-14 16:29:37 -0400] gchristensen: is sysctl data put into attributes anywhere?
[2013-05-14 16:30:32 -0400] jtimberman: gchristensen: not by default
[2013-05-14 16:31:00 -0400] gchristensen: is there a way to enable specific elements of it? or is it whole-sale?
[2013-05-14 16:34:01 -0400] jtimberman: gchristensen: you could write a plugin that gathers any data from sysctl you want.
[2013-05-14 16:34:43 -0400] gchristensen: fair enough :) thank you.
[2013-05-14 16:40:24 -0400] ughani: can i include_recipe "blah" only_if "something is true" ?
[2013-05-14 16:41:26 -0400] jschneid1rhan: a
[2013-05-14 16:42:12 -0400] cwj: ughani: i think you need to wrap it in a regular conditional statement, e.g. if something.is_true? include_recipe "blah" end
[2013-05-14 16:42:54 -0400] jtimberman: include_recipe "foo" if something
[2013-05-14 16:43:22 -0400] cwj: even bettar
[2013-05-14 16:44:37 -0400] ughani: I want to check if a certain package is installed so i can do like include_recipe "blah" if package "some_package" ?
[2013-05-14 16:46:20 -0400] bean: I've never really had a need for that.
[2013-05-14 16:51:02 -0400] JasonG_: question about file resources like cookbook_file, and template There's no action for something simple like "replace this file or template if it has been updated in the cookbook". It seems to me a :create_if_changed action or something similar would be hugely helpful. Any good workarounds?
[2013-05-14 16:52:38 -0400] cwj: ughani: i dont think that would work, package "some_package" is a resource and i imagine that would always evaluate to true
[2013-05-14 16:54:38 -0400] cwj: ughani: there are ohai plugins you could install which collect information about installed packages as node attributes
[2013-05-14 16:55:26 -0400] cwj: of course you could also shell out and do it all manually
[2013-05-14 16:55:29 -0400] gleam: you'd have to trigger them to reload
[2013-05-14 16:55:32 -0400] jtimberman: Getting the current state of a resource is possible, but not intuitive.
[2013-05-14 16:58:49 -0400] jtimberman: You can tell Chef to inspect the state of the resource with something like: Chef::Platform.provider_for_resource(package('apache2') { action :nothing }).load_current_resource.version
[2013-05-14 16:58:58 -0400] jtimberman: version will be populated if the package is already installed.
[2013-05-14 16:59:25 -0400] jtimberman: you do get a resource added to the resource collection though :-|
[2013-05-14 16:59:29 -0400] c_t: gah
[2013-05-14 16:59:56 -0400] c_t: jtimberman: what was that convenient way to copy node attributes so you can modify them without chef griping?
[2013-05-14 17:05:10 -0400] jtimberman: c_t: uhm... i forget offhand.
[2013-05-14 17:05:16 -0400] c_t: nooooooooo
[2013-05-14 17:06:52 -0400] JasonG_: ughani: if you're into simplicity over purity, you can just use an execute resource like: "aptitude show xterm | egrep "State: installed"" and catch the return code. 0 = installed, 1 = not installed (or package doesn't exist)
[2013-05-14 17:12:10 -0400] mattupstate: jtimberman: has there ever been a ticket or feature request for configuring a download cache for the python_pip provider?
[2013-05-14 17:13:56 -0400] masterkorp: what is the file attribute that we can use a string as source
[2013-05-14 17:13:58 -0400] masterkorp: is it contents ?
[2013-05-14 17:14:04 -0400] jtimberman: mattupstate: not sure
[2013-05-14 17:14:27 -0400] masterkorp: yeah its content
[2013-05-14 17:14:31 -0400] masterkorp: sorry to bother
[2013-05-14 17:40:06 -0400] SirFunk_: Anyone know a way to create a postgresql user that can create databases ?
[2013-05-14 17:40:16 -0400] SirFunk_: I can't seem to figure out how to give them the superuser role
[2013-05-14 17:41:34 -0400] Jahkeup: SirFunk_ check out http://community.opscode.com/cookbooks/database
[2013-05-14 17:41:49 -0400] Jahkeup: you can run sql directly from your recipes
[2013-05-14 17:42:01 -0400] SirFunk_: ahh, i guess that would work
[2013-05-14 17:42:23 -0400] steveh__: Goodmorning. Is this a good place to ask a question about installing chef 11?
[2013-05-14 17:43:16 -0400] btm: steveh__: yes.
[2013-05-14 17:43:51 -0400] steveh__: I'm googling but not finding an answer. Basically, I get the 'Expected process to exit with [0], but recieved '7' error when running chef-ctl reconfigure.
[2013-05-14 17:44:15 -0400] steveh__: Google has errors for 22 but not 7. I've checked my hostname and it's resolvable and reverse-lookupable.
[2013-05-14 17:44:50 -0400] steveh__: This is on RHEL 5 using the chef 11 rpm off the opscode site.
[2013-05-14 17:50:44 -0400] organicveggie: Anyone had any luck using the deploy resource with a private GitHub repo?
[2013-05-14 17:51:00 -0400] steveh__: Does anyone know what it means when chef-server-ctl gives the error Expected process to exit with [0], but received '7'
[2013-05-14 17:51:51 -0400] ssd7: steveh__: Can you use pastebin or gist and post the full output you are getting somewhere?
[2013-05-14 17:53:47 -0400] barefoot: can you use both only_if and not_if in the same block? which would win? I assume you use one and negate part of the expression?
[2013-05-14 17:55:16 -0400] knuckolls: steveh__: i wouldn't install a chef server any way but knife-server, and chef-client any way but the omnibus installer. they've both just worked out of the box for me.
[2013-05-14 17:56:36 -0400] Jahkeup: Anyone had issues with a system ruby causing issues with the embedded ruby and its gems/bin?
[2013-05-14 17:57:08 -0400] steveh__: Thanks everyone. Here is the pastebin.
[2013-05-14 17:57:10 -0400] steveh__: http://pastebin.com/q5w4ZUqg
[2013-05-14 17:57:24 -0400] steveh__: I am using chef 11 off the opscode site I'm not doing anything that isn't out of the box.
[2013-05-14 17:57:37 -0400] steveh__: This is a freshly installed server with RHEL 5.9.
[2013-05-14 17:57:42 -0400] steveh__: Not even a yum update.
[2013-05-14 17:57:43 -0400] gleam: curl error 7 is "couldn't connect to host"
[2013-05-14 17:57:58 -0400] gleam: so it can't load 127.0.0.1:8000
[2013-05-14 17:58:17 -0400] steveh__: Thanks gleam. That helps more than google has. I couldn't find that googling for the error.
[2013-05-14 17:58:30 -0400] ssd7: Can you post chef-server-ctl status
[2013-05-14 17:58:54 -0400] ssd7: you should be able to see whether or not one of the services is down (or only has an up time of a few seconds and is in a restart loop)
[2013-05-14 17:59:45 -0400] steveh__: https://gist.github.com/anonymous/e95b47da416f33d40293
[2013-05-14 17:59:51 -0400] steveh__: That's my status
[2013-05-14 18:00:03 -0400] steveh__: The services look up. My firewall is disabled.
[2013-05-14 18:00:18 -0400] ssd7: Ok, it looks like erchef isn't starting up
[2013-05-14 18:00:40 -0400] ssd7: is there anyting in the logs at /var/log/chef-server/erchef/current or /var/log/chef-server/erchef/erchef.log.1
[2013-05-14 18:02:08 -0400] steveh__: https://gist.github.com/anonymous/6332362b22467fa411dd
[2013-05-14 18:02:29 -0400] steveh__: That's the tail from /var/log/chef/chef-server/erchef/current
[2013-05-14 18:03:55 -0400] cburroughs: jonlives, Thanks for doing the webinar.  Team here found seeing the workflow helpful
[2013-05-14 18:04:14 -0400] jonlives: cburroughs: no problem, thanks for watching :)
[2013-05-14 18:04:20 -0400] steveh__: Oh I see, I didn't noticed that erchef had run of 0s. I guess it isn't up despite the pid.
[2013-05-14 18:08:04 -0400] steveh__: @ssd7, is there a way to try to start/debug erchef manually?
[2013-05-14 18:09:16 -0400] jsnapp: steveh__: can you try running chef-server-ctl erchef restart ?
[2013-05-14 18:09:42 -0400] SirFunk_: Jahkeup: so I added a sql query that should grant my user create privileges but it either doesn't execute or doesn't work.. is there any way i can debug to see if it is running?
[2013-05-14 18:10:33 -0400] Jahkeup: Can you show me the resource block you used?
[2013-05-14 18:10:39 -0400] SirFunk_: Jahkeup: yup
[2013-05-14 18:10:44 -0400] Jahkeup: pastebin or otherwise :)
[2013-05-14 18:10:51 -0400] steveh__: @jsnapp Yes I seem to have it running after that so I'm running the reconfigure script.
[2013-05-14 18:11:01 -0400] steveh__: And it crashed with status 7 again.
[2013-05-14 18:11:34 -0400] SirFunk_: Jahkeup: https://gist.github.com/jeffutter/122c2b4da756531b8369
[2013-05-14 18:12:11 -0400] SirFunk_: when i login with: psql -U postgres  and run \du it shows no privileges for the vagrant user.
[2013-05-14 18:13:46 -0400] Jahkeup: SirFunk_ Hrm, does it in fact create the user?
[2013-05-14 18:13:52 -0400] SirFunk_: Jahkeup: yup
[2013-05-14 18:15:12 -0400] Guest65073: Hey, was wondering if anyone could help me out with updating the ERB files? How do I actually update them within Chef, after I update tehm locally
[2013-05-14 18:15:13 -0400] Guest65073: them*
[2013-05-14 18:15:51 -0400] steveh__: How do we get it so that IRC highlights someone when we want to respond to them?
[2013-05-14 18:16:16 -0400] jsnapp: steve__: i'm reviewing your logs
[2013-05-14 18:16:19 -0400] SirFunk_: Jahkeup: the only output i get is: Processing postgresql_database[grant vagrant create privileges] action query (gswd::database line 21
[2013-05-14 18:16:56 -0400] jsnapp: i'm covering for ssd7 who isn't available at the moment
[2013-05-14 18:17:35 -0400] Jahkeup: SirFunk_ hang on I'm looking through the cookbook and your resource looks good to me :/ let me double check something real quick
[2013-05-14 18:18:12 -0400] SirFunk_: Jahkeup: thanks
[2013-05-14 18:19:09 -0400] ughani: jtimberman: based on your commentcan i do
[2013-05-14 18:19:10 -0400] ughani: has_package = Chef::Platform.provider_for_resource(package('somepackage') { action :nothing }).load_current_resource.version
[2013-05-14 18:19:10 -0400] ughani: include_recipe "blah::blah1" unless has_package
[2013-05-14 18:22:16 -0400] Jahkeup: SirFunk_ check out the gist
[2013-05-14 18:24:14 -0400] jsnapp: steveh__: is there something running on port 8000 already?
[2013-05-14 18:24:25 -0400] SirFunk_: Jahkeup: i'll give that a try. should vagrant reload fix it or should i destroy ?
[2013-05-14 18:25:34 -0400] steveh__: jsnapp: I don't get anything when I run netstat -anp|grep 8000
[2013-05-14 18:25:47 -0400] SirFunk_: Jahkeup: ahh yes. I tried your solution earlier it doesn't work i get this: "PG::Error: postgresql_database_user[vagrant] (gswd::database line 14) had an error: PG::Error: ERROR:  relation "database" does not exist"   if you don't specify a database name it doesn't grant global privileges it tries to grant them to a database named database
[2013-05-14 18:26:07 -0400] Jahkeup: SirFunk_ oh! That's interesting.
[2013-05-14 18:26:35 -0400] SirFunk_: going to try removing that semicolon now
[2013-05-14 18:26:37 -0400] jsnapp: steveh__: try netstat -plan | grep 8000
[2013-05-14 18:27:19 -0400] steveh__: jsnapp: nothing. I like the mnemonic of -plan. I'm going to use that.
[2013-05-14 18:27:19 -0400] SirFunk_: Jahkeup: no difference without semicolon
[2013-05-14 18:27:45 -0400] jsnapp: yeah , i wanted to make sure you had 'l' in there .. to get listening ports
[2013-05-14 18:29:48 -0400] Jahkeup: SirFunk_ man oh man, that's irksome. I've not the machine to test it right now, but one last go referencing the examples where you do not specify the privileges and just `action :create`
[2013-05-14 18:30:44 -0400] steveh__: jsnapp: Thanks, I'm working on clean boxes. Selinux is disabled. No firewall. No apache/java/tomcat.
[2013-05-14 18:30:52 -0400] steveh__: This should just owrk.
[2013-05-14 18:31:54 -0400] jsnapp: yeah, i'm going to see if i can reproduce it here .. it will take a little time though
[2013-05-14 18:33:15 -0400] steveh__: This is RHEL, not CentOS, which might make a difference in this case.
[2013-05-14 18:33:47 -0400] SirFunk_: Jahkeup: ok, trying now
[2013-05-14 18:35:11 -0400] SirFunk_: Jahkeup: same error
[2013-05-14 18:35:25 -0400] Jahkeup: SirFunk_ no kiddin.
[2013-05-14 18:35:35 -0400] SirFunk_: Jahkeup: very frustrating. Should be able to be some way to create a user who can create databases.. especially if using vagrant/chef for development
[2013-05-14 18:36:08 -0400] Jahkeup: SirFunk_ yeah that's why I thought the database cookbook would have had the facilities for that
[2013-05-14 18:37:05 -0400] Jahkeup: SirFunk_ what's more the examples clearly refer to this type of situation..though for mysql
[2013-05-14 18:37:43 -0400] SirFunk_: Jahkeup: it looks like i have a slightly old version of the cookbook. let me update
[2013-05-14 18:38:48 -0400] digitallogic: I have a question about the compile phase of a chef run
[2013-05-14 18:39:03 -0400] digitallogic: I'm reading here: http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-05-14 18:39:09 -0400] Jahkeup: SirFunk_ I've spotted what I was looking for earlier in the source, looks like the `action_grant` method for pgsql actually specifies the database
[2013-05-14 18:39:28 -0400] digitallogic: it says "During the compile phase, these resources will get arranged in a queue in order of appearance"
[2013-05-14 18:39:43 -0400] Jahkeup: SirFunk_ you could fork the repo and give it a whirl, though the sql statement should have been capable of doing the same
[2013-05-14 18:39:43 -0400] digitallogic: it's not clear to me what "appearance" means
[2013-05-14 18:39:46 -0400] droy: hi everyone, question about VPC instances and knife ec2....
[2013-05-14 18:40:01 -0400] digitallogic: is that the run list ordering?
[2013-05-14 18:40:03 -0400] droy: do I need to add any keys to the bastion host for it to allow a connection to a private subnet instance?
[2013-05-14 18:40:22 -0400] droy: or is the key passed by knife?
[2013-05-14 18:42:25 -0400] Jahkeup: SirFunk_ and the query block is on a database. sigh, looks like you'll have to modify to fit your needs.
[2013-05-14 18:43:10 -0400] SirFunk_: Jahkeup: yeah, new version doesn't make a difference ... my query block doesn't actually specify a database, maybe I should specify one even though it doesn't matter
[2013-05-14 18:43:42 -0400] SirFunk_: well there's examples with no database
[2013-05-14 18:44:14 -0400] Jahkeup: SirFunk_ https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_postgresql.rb#L76
[2013-05-14 18:45:15 -0400] SirFunk_: Jahkeup: wow.. well.. that looks like it would do it
[2013-05-14 18:45:28 -0400] Jahkeup: SirFunk_ sadly.
[2013-05-14 18:46:11 -0400] SirFunk_: Jahkeup: I wonder how mysql gets around that.. i'll try rerunning with a table name in a sec
[2013-05-14 18:46:44 -0400] Jahkeup: SirFunk_ MySQL: https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_mysql_user.rb#L67
[2013-05-14 18:47:04 -0400] Jahkeup: SirFunk_ PgSQL: https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_postgresql_user.rb#L61
[2013-05-14 18:47:10 -0400] Jahkeup: SirFunk_ Im confused.
[2013-05-14 18:47:53 -0400] SirFunk_: Jahkeup: well.. that looks like it just grants on a speciffic database
[2013-05-14 18:48:13 -0400] Jahkeup: SirFunk_ looks like you'll have to create the tables in general using the resource, and then grant a user on it :/
[2013-05-14 18:48:19 -0400] Jahkeup: SirFunk_ no catchall it seems :/
[2013-05-14 18:49:07 -0400] SirFunk_: Jahkeup: well... I'm thinking the query will work if i specify a table name (like template1 which should always exist i think.. I'm pretty sure _that_ query would still be global). Trying this now
[2013-05-14 18:49:33 -0400] Jahkeup: SirFunk_ I should  think so, its worth a shot!
[2013-05-14 18:50:24 -0400] mattupstate: do the default attributes of a role get merged with the default attributes of a recipe?
[2013-05-14 18:50:35 -0400] mattupstate: more specifically, if a default attribute in a cookbook is an array
[2013-05-14 18:50:47 -0400] SirFunk_: Jahkeup: BINGO! that worked
[2013-05-14 18:50:51 -0400] mattupstate: and the role specifies a default for that same attribute, is the array appended?
[2013-05-14 18:51:14 -0400] SirFunk_: mattupstate: ... upstate NY?
[2013-05-14 18:51:19 -0400] Jahkeup: SirFunk_ Sweet! Glad to hear! I'll remember that one for later, man that one was quite a bugger
[2013-05-14 18:51:27 -0400] mattupstate: yes, the "real" upstate though ;)
[2013-05-14 18:51:35 -0400] mattupstate: although i live in brooklyn now
[2013-05-14 18:51:50 -0400] SirFunk_: mattupstate: hm.. ahh. I grew up in "real" upstate :)
[2013-05-14 18:51:53 -0400] SirFunk_: I'm in nebraska now
[2013-05-14 18:52:30 -0400] mattupstate: i grew up in syracuse
[2013-05-14 18:52:41 -0400] SirFunk_: mattupstate: ahh. I'm more upstate than you :) Canton
[2013-05-14 18:53:09 -0400] mattupstate: ha! oh yeah
[2013-05-14 18:53:15 -0400] mattupstate: you're nearly canadian ;)
[2013-05-14 18:53:36 -0400] SirFunk_: ey? :-P
[2013-05-14 18:53:45 -0400] SirFunk_: ok, enough OT.. back to playing with chef
[2013-05-14 18:54:11 -0400] Jahkeup: SirFunk_ good luck!
[2013-05-14 18:54:21 -0400] SirFunk_: Jahkeup: Thanks. Thanks for the help
[2013-05-14 18:54:37 -0400] Jahkeup: SirFunk_ no problemo!
[2013-05-14 19:00:03 -0400] jsnapp: steveh__: what version of chef server are you installing?
[2013-05-14 19:00:26 -0400] steveh__: 11.04 on one machine and 11.08 on another. Both give same issue.
[2013-05-14 19:00:42 -0400] jsnapp: thanks
[2013-05-14 19:02:12 -0400] Cheeezit: am i missing something
[2013-05-14 19:02:31 -0400] Cheeezit: user "foo" do action :create end
[2013-05-14 19:02:42 -0400] Cheeezit: should create a home dir for the user right?
[2013-05-14 19:04:15 -0400] steveh__: jsnapp: Should I try 11.06 for completeness?
[2013-05-14 19:04:46 -0400] aruntomar: i'm on ruby 1.9.3, with chef 11.4.4 and chefspec 1.1.0. when i try to run "knife cookbook create_specs -o . <cb name>" it gives error FATAL: Cannot find sub command for: 'cookbook create_specs -o . new_book'. anyone else facing this issue?
[2013-05-14 19:05:12 -0400] cwj: Cheeezit: take a look at the 'supports' attribute for the user resource http://docs.opscode.com/resource_user.html
[2013-05-14 19:06:45 -0400] jsnapp: steveh__: i wouldn't bother trying 11.06 at this point
[2013-05-14 19:07:23 -0400] steveh__: I installed 11.04 earlier when we started the conversation just to see if maybe I was encountering a 'new' problem with chef.
[2013-05-14 19:08:55 -0400] rava: jsnapp: what's up with 11.06?
[2013-05-14 19:09:59 -0400] steveh__: rava: Nothing is up, I was asking if I should try it to get around a problem I'm having.
[2013-05-14 19:11:04 -0400] jsnapp: rava: yeah sorry for the confusion .. nothing's wrong with 11.06
[2013-05-14 19:12:08 -0400] rava: no worries, was just pondering how critical an upgrade to 11 would be for my org and that statement snatched my attention in the myriad windows of scrolling txt :)
[2013-05-14 19:13:25 -0400] steveh__: rava: I went with 11 because it was easier to install than 10, but now I'm running into problems that are probably due to RHEL 5.
[2013-05-14 19:13:51 -0400] digitallogic: is it a bad practice to reference attributes from a cookbook in another cookbook's attribute file?
[2013-05-14 19:13:53 -0400] rava: ah
[2013-05-14 19:15:03 -0400] rava: digitallogic: i've started using cookbooks that are almost entirely for setting attributes for other cookbooks
[2013-05-14 19:15:41 -0400] rava: they do some specific logic with a few propriety pieces of software and expose the results as node attributes
[2013-05-14 19:17:07 -0400] digitallogic: that's the pattern I'm trying to follow, but I'm running into an issue with chef-solo
[2013-05-14 19:18:03 -0400] jsnapp1: steveh__: of course my test works fine :(
[2013-05-14 19:18:19 -0400] digitallogic: I have an apache wrapper cookbook, and I'm setting an attribute along the lines of `default['foo'] = node['apache']['blah']` fails sometimes saying that node['apache'] is null
[2013-05-14 19:18:42 -0400] jsnapp1: can you post your entire erchef log file instead of just the tail?
[2013-05-14 19:18:54 -0400] steveh__: jsnapp1: I figured that might happen. The problem I'm guessing is that these are managed servers and even in my RHEL 5.9 virtualbox it works, just not here.
[2013-05-14 19:19:00 -0400] digitallogic: I threw some print statements into the src, and it looks like it's loading attribute files in a non-deterministic order
[2013-05-14 19:19:20 -0400] digitallogic: and sometimes my recipe's attribute file gets loaded before the apache recipe
[2013-05-14 19:19:27 -0400] jsnapp1: what do you mean by managed servers ?
[2013-05-14 19:20:01 -0400] spox: include_attribute 'othercookbook::attr_file'
[2013-05-14 19:21:05 -0400] steveh__: jsnapp1: These are servers in Verizon CaaS, which means they have a little bit of management software installed like monitoring and so forth but it otherwise is a clean OS.
[2013-05-14 19:21:09 -0400] steveh__: Here is my log:
[2013-05-14 19:21:18 -0400] steveh__: https://gist.github.com/anonymous/b19cf7e5f4c30de6a51c
[2013-05-14 19:24:21 -0400] digitallogic: spox: that looks to have fixed it, thanks!
[2013-05-14 19:28:08 -0400] aruntomar: is anyone using chefspec currently?
[2013-05-14 19:32:50 -0400] BryanWB_: aruntomar: yeah, i like it
[2013-05-14 19:33:12 -0400] Jahkeup: how do you cope with multiple rubies being installed on a host system?
[2013-05-14 19:33:13 -0400] BryanWB_: it is good for testing your libraries/
[2013-05-14 19:33:54 -0400] BryanWB_: wow, is it just me or is vagrant w/ win2k8 mega-slow?
[2013-05-14 19:34:07 -0400] miah: i havent seen the magic of chefspec yet, but i also dont rspec.. too much shit to learn. sticking with minitest =)
[2013-05-14 19:34:31 -0400] aruntomar: BryanWB_: which version are you using? i'm getting an error. filed a bug for it. https://github.com/acrmp/chefspec/issues/136
[2013-05-14 19:34:33 -0400] jtimberman: BryanWB_: ohai!
[2013-05-14 19:34:35 -0400] rava: miah: amen :D
[2013-05-14 19:34:42 -0400] BryanWB_: jtimberman: ohai dude :)
[2013-05-14 19:34:52 -0400] jtimberman: aruntomar: i'm doing a fair amount of chefspec in the java cookbook.
[2013-05-14 19:35:01 -0400] BryanWB_: aruntomar: not sure, whatever gem install does
[2013-05-14 19:35:04 -0400] jtimberman: encapsulated in this pull request: https://github.com/opscode-cookbooks/java/pull/57
[2013-05-14 19:35:23 -0400] BryanWB_: it's also good if u have complex logic in ur lwrps
[2013-05-14 19:35:28 -0400] miah: it'd be different if i actually pair'd with people daily and was forced into learning rspec. =)
[2013-05-14 19:35:49 -0400] BryanWB_: rspec rocks
[2013-05-14 19:35:59 -0400] jtimberman: rspec is ok :)
[2013-05-14 19:36:01 -0400] jtimberman: minitest rocks
[2013-05-14 19:36:05 -0400] BryanWB_: meh
[2013-05-14 19:36:06 -0400] miah: minitest works =)
[2013-05-14 19:36:07 -0400] jtimberman: because minitest is in Ruby 1.9 stdlib ;)
[2013-05-14 19:36:17 -0400] miah: it has a rspec like dsl
[2013-05-14 19:36:27 -0400] jtimberman: and i don't have to install f'in libxml2-dev/libxslt-dev for nokogiri so i can use rspec :)
[2013-05-14 19:36:35 -0400] miah: http://docs.seattlerb.org/minitest/Minitest/Spec/DSL.html
[2013-05-14 19:36:42 -0400] jtimberman: but whatever, chef itself uses rspec
[2013-05-14 19:36:46 -0400] thom: there's no real escaping nokogiri tho
[2013-05-14 19:36:46 -0400] miah: ya
[2013-05-14 19:37:14 -0400] BryanWB_: miah: loved ur talk at chefconf
[2013-05-14 19:37:16 -0400] miah: nokogiri is like basement cat?
[2013-05-14 19:37:23 -0400] miah: BryanWB_: thanks
[2013-05-14 19:37:27 -0400] jtimberman: i wish nokogiri itself were in stdlib :)
[2013-05-14 19:37:36 -0400] BryanWB_: miah: wasn't ther in person cuz i was practicing my own talk
[2013-05-14 19:38:01 -0400] thom: jtimberman: yeah, it'd make life so much easier. or something that does enough xml for day to day use
[2013-05-14 19:38:12 -0400] miah: ya
[2013-05-14 19:38:22 -0400] BryanWB_: how long does windows take to boot in vagrant? how long on aws? i hear it is like 15 mins on aws
[2013-05-14 19:38:31 -0400] jtimberman: BryanWB_: 15 minutes is about right.
[2013-05-14 19:38:32 -0400] miah: i kind of feel like that was my whole experience at chefconf this year. missing all the awesome talks because i was dealing with my own shit.
[2013-05-14 19:38:49 -0400] miah: ya, ~15 minutes for ec2
[2013-05-14 19:38:49 -0400] jtimberman: BryanWB_: thats why cb's demo in his keynote didn't show the full "look, windows booted in ec2 and now we see it in the dashboard'
[2013-05-14 19:38:49 -0400] aruntomar: jtimberman: any ideas/workaround related to this issue https://github.com/acrmp/chefspec/issues/136
[2013-05-14 19:38:56 -0400] BryanWB_: miah: well the rest of us benefitted fromur talk
[2013-05-14 19:38:57 -0400] thom: miah: yeah, i found the same last year a bit
[2013-05-14 19:39:29 -0400] miah: BryanWB_: i hope so
[2013-05-14 19:40:01 -0400] jtimberman: aruntomar: dunno, sorry
[2013-05-14 19:40:15 -0400] BryanWB_: aruntomar: just writ ur own spec file, the create_specs doesn't do that much for u anyways
[2013-05-14 19:40:34 -0400] BryanWB_: miah: i m reading poodr just cuz of u
[2013-05-14 19:40:44 -0400] miah: awesome
[2013-05-14 19:40:49 -0400] miah: its such a good book. i need to read it again.
[2013-05-14 19:41:04 -0400] miah: working my way through 'pragmatic thinking and learning' mostly right now. while reading a bit of several other books =)
[2013-05-14 19:41:09 -0400] miah: i guess thats always my case
[2013-05-14 19:41:14 -0400] miah: a dozen books in my queue
[2013-05-14 19:41:38 -0400] jtimberman: i have poodr on my bookshelf
[2013-05-14 19:42:13 -0400] miah: i have it on my desk, and on my phone
[2013-05-14 19:42:14 -0400] masterkorp: my bookshelf is filled with old broken greasy parts
[2013-05-14 19:43:59 -0400] Guest12349: 12:40 < miah> its such a good book. i need to read it again.
[2013-05-14 19:44:10 -0400] Guest12349: which book
[2013-05-14 19:44:27 -0400] aruntomar: BryanWB_: ok, i'll give it a try.
[2013-05-14 19:44:27 -0400] miah: Guest33924: http://www.poodr.info/
[2013-05-14 19:44:32 -0400] senthilr: thx
[2013-05-14 19:44:42 -0400] miah: BryanWB_: i also recommend: http://www.justin.tv/confreaks/c/2247122
[2013-05-14 19:45:05 -0400] miah: (and any of her other talks, watch them all, a dozen or more times)
[2013-05-14 19:45:54 -0400] aruntomar: so by the way, what's the recommended for someone who's newbie in chef cookbook testing minitest or rspec?
[2013-05-14 19:46:45 -0400] jameson__: test-kitchen?
[2013-05-14 19:46:53 -0400] jameson__: (has no idea about testing cookbooks)
[2013-05-14 19:47:12 -0400] anthroprose: I started with minitest, but its very rudamentary... we're thinking of switching to the newer rspec suites like chefspec
[2013-05-14 19:47:53 -0400] anthroprose: it allows for way more convergence testing
[2013-05-14 19:47:59 -0400] anthroprose: that & whyrun
[2013-05-14 19:50:43 -0400] miah: minitest works fine, you just have to build cookbooks correctly =)
[2013-05-14 19:50:59 -0400] miah: i havent added whyrun to any of my 'books yet though
[2013-05-14 19:53:53 -0400] ivey: hey where do we go for TK conversations
[2013-05-14 19:54:07 -0400] miah: #chef or #chef-hacking, but mostly here.
[2013-05-14 19:54:16 -0400] ivey: but no fnichol here :-)
[2013-05-14 19:54:52 -0400] ivey: is minitest-handler still needed?
[2013-05-14 19:54:58 -0400] miah: no
[2013-05-14 19:55:00 -0400] ivey: or just busser-minitest?
[2013-05-14 19:58:38 -0400] miah: guh. why does the cookbook uploader ignore directories in libraries?
[2013-05-14 19:59:04 -0400] miah: er, maybe it doesnt. i might be derp
[2013-05-14 19:59:06 -0400] jtimberman: miah: bug
[2013-05-14 20:00:06 -0400] masterkorp: why does knife status return 100 ?
[2013-05-14 20:00:33 -0400] masterkorp: i had a execute block runing knife to test the configs and it just fails because of that
[2013-05-14 20:01:16 -0400] jtimberman: miah: http://tickets.opscode.com/browse/CHEF-672
[2013-05-14 20:03:20 -0400] steveh__: jsnapp: Are you still on?
[2013-05-14 20:04:16 -0400] miah: jwow thats a old one
[2013-05-14 20:05:37 -0400] miah: gonna need to prod somebody on that one
[2013-05-14 20:07:24 -0400] masterkorp: any ideas ?
[2013-05-14 20:07:34 -0400] matticulous: trying to get some advice on how to handle a situation using the "wrapper" pattern. i am writing a company cookbook that wraps the postgresql cookbook.
[2013-05-14 20:09:13 -0400] miah: what kind of derp am i getting wrong if i 'class Chef class Resource class Logstash class Instance < Chef::Resource'
[2013-05-14 20:09:22 -0400] matticulous: running into some trouble b/c my cookbook overrides some directory locations (postgresql_dir) etc. initdb is run as part of the wrapped cookbook, which creates a little bit of a problem for me. i can re-run initdb after my cookbook has replaced the init.d script, but i need to stop the service (started as part of the wrapped cb) in order to do it sanely.
[2013-05-14 20:09:35 -0400] miah: that seems invalid, but 'class Chef class Resource class LogstashInstance < Chef::Resource' is okie dokie
[2013-05-14 20:09:40 -0400] matticulous: too long-winded for irc?
[2013-05-14 20:09:44 -0400] miah: i suspect im just missing something on ruby classing structure
[2013-05-14 20:10:20 -0400] miah: chef doesn't find my class if i go deep i guess?
[2013-05-14 20:10:43 -0400] masterkorp: ERROR: You authenticated successfully to server as chef-server but you are not authorized for this actio
[2013-05-14 20:10:57 -0400] masterkorp: why am I not authorized
[2013-05-14 20:10:59 -0400] masterkorp: ?
[2013-05-14 20:11:04 -0400] masterkorp: it my goddman server
[2013-05-14 20:11:26 -0400] Kyle11: did you try the web interface masterkorp
[2013-05-14 20:11:38 -0400] Kyle11: see if your user is listed as an admin user
[2013-05-14 20:12:08 -0400] Kyle11: knife user list
[2013-05-14 20:12:12 -0400] magoo_: jtimberman: I'm looking at solutions for file integrity monitoring and just came upon your ossec cookbook
[2013-05-14 20:12:12 -0400] Kyle11: knife user list $YOU
[2013-05-14 20:12:33 -0400] Kyle11: sorry knife user show $YOU
[2013-05-14 20:12:51 -0400] magoo_: it looks like it should be configurable to disable any of the features I don't need
[2013-05-14 20:13:05 -0400] magoo_: how's your experience been with it?
[2013-05-14 20:13:56 -0400] miah: i think chef just needs to build their run interval to be a background thread and have fnotify built into their standard client.
[2013-05-14 20:13:59 -0400] miah: make ossec obsolete
[2013-05-14 20:14:10 -0400] miah: since chef is already managing files and verifying their checksums anyways..
[2013-05-14 20:14:33 -0400] hatchetation: so, I just hit an issue that I'm having a hard time understanding... are there docs somewhere that explain what chef-client caches on a node?
[2013-05-14 20:14:47 -0400] magoo_: miah: I agree, this would be a great extension of what chef already provides
[2013-05-14 20:14:52 -0400] miah: the source code is more up to date than the docs
[2013-05-14 20:15:15 -0400] hatchetation: removed a cookbook from our base role (ossec, ironically enough), and 99% of the infrastructure respected the change except for a single node that was still attempting to install that package on fresh client runs.
[2013-05-14 20:16:15 -0400] hatchetation: removing the contents of /var/cache/chef fixed it, and the recipe was removed from the runlist on the next run. this is with chef 11.4.4
[2013-05-14 20:16:19 -0400] hatchetation: any ideas or pointers?
[2013-05-14 20:16:36 -0400] masterkorp: Kyle11: yeah, i checked with my knife
[2013-05-14 20:17:55 -0400] jtimberman: magoo_: is it working for you?
[2013-05-14 20:18:09 -0400] jtimberman: miah: ossec is neat  :P
[2013-05-14 20:18:27 -0400] magoo_: I've just been reading on it... just wanted your opinion of the software
[2013-05-14 20:18:39 -0400] magoo_: looks like you've made it pretty configurable
[2013-05-14 20:19:01 -0400] magoo_: i'll probably disable the automatic firewall rules, etc
[2013-05-14 20:19:07 -0400] jtimberman: :)
[2013-05-14 20:19:18 -0400] jtimberman: yeah, that cookbook was a foray into learning ossec.
[2013-05-14 20:19:26 -0400] jtimberman: and i've since forgotten everything i know about it ;)
[2013-05-14 20:19:35 -0400] miah: eh. im a fan of Samhain
[2013-05-14 20:19:38 -0400] magoo_: at a bare minimum, i want to start monitoring all the config files for daemons with open ports
[2013-05-14 20:19:48 -0400] miah: http://la-samhna.de/samhain/ 
[2013-05-14 20:20:24 -0400] jtimberman: magoo_: a noble cause
[2013-05-14 20:20:44 -0400] miah: indeed. thats a good thing.
[2013-05-14 20:20:46 -0400] magoo_: i was originally looking at samhain... right now, I need to get this in place yesterday for pci compliance
[2013-05-14 20:21:13 -0400] magoo_: the deadline is quickly approaching and I have a list of things to address
[2013-05-14 20:23:08 -0400] matticulous: jtimberman: since you wrote the postgresql cookbook and i now find myself wrapping it, can you give me a little direction on an issue i'm having while wrapping it? it stems from initdb + my need to change directory paths.
[2013-05-14 20:24:55 -0400] Kyle11: ossec is great... i didn't realize it even bans people trying to hack your server... and also your pci scanner which was fun to figure out
[2013-05-14 20:28:11 -0400] ivey: miah: is there a good example busser-minitest test out there?
[2013-05-14 20:28:16 -0400] miah: no idea.
[2013-05-14 20:28:52 -0400] josephholsten: ivey: I've grown fond of busser-bats to verify that my nagios plugins think the box works
[2013-05-14 20:29:02 -0400] ivey: bats is horrifying though
[2013-05-14 20:29:19 -0400] josephholsten: that way my CI tests matche prod monitoring
[2013-05-14 20:31:11 -0400] jtimberman: ivey: i prefer bats when the use case is simple.
[2013-05-14 20:31:26 -0400] jtimberman: like: curl https://localhost:8080 | grep "Jenkins"
[2013-05-14 20:31:47 -0400] jtimberman: or even better, which zsh :)
[2013-05-14 20:31:54 -0400] cwj: i already have minitests written for minitest-handler, i too am interested in a busser-minitest example
[2013-05-14 20:34:08 -0400] wamilton: zsh - for those who want their terminal to be as slow as a gui
[2013-05-14 20:34:23 -0400] gchristensen: is it considered poor form to put logit in the attributes/xyz.rb file for a cookbook?
[2013-05-14 20:34:35 -0400] gchristensen: logic* I'm considering switching on the deployment environment.
[2013-05-14 20:34:43 -0400] gchristensen: (as it production / development)
[2013-05-14 20:35:01 -0400] miah: imho attribute files shouldn't exist in most cases and shouldn't contain logic when they do
[2013-05-14 20:35:14 -0400] gchristensen: miah: can you tell me more about that opinion?
[2013-05-14 20:35:35 -0400] miah: remember the term 'KISS'
[2013-05-14 20:35:51 -0400] miah: http://en.wikipedia.org/wiki/KISS_principle
[2013-05-14 20:36:02 -0400] jsnapp: steveh__: i'm back .. are you still there?
[2013-05-14 20:36:13 -0400] miah: putting logic all over the place => have fun mentally modelling that.
[2013-05-14 20:36:32 -0400] magoo_: i think this ossec cookbook is revealing a chef-zero bug
[2013-05-14 20:36:58 -0400] gchristensen: miah: not the logic bit, the "shouldn't exist"
[2013-05-14 20:37:59 -0400] miah: ah, yes. well. i think most recipes are also a bad implementation. build resources because that is what chef manages.
[2013-05-14 20:38:25 -0400] miah: and most recipes are an abstract representation of a resource, but not really a resource.
[2013-05-14 20:38:34 -0400] miah: go watch my chefconf talk =)
[2013-05-14 20:39:14 -0400] gchristensen: link?
[2013-05-14 20:39:56 -0400] miah: http://www.youtube.com/watch?v=u5wfN1OEFmY
[2013-05-14 20:41:10 -0400] gchristensen: I'll watch it some point in the future :) thank you
[2013-05-14 20:45:38 -0400] jtimberman: miah: https://gist.github.com/jtimberman/3d9c5d725d59a761eef9
[2013-05-14 20:46:26 -0400] miah: jtimberman: too many.
[2013-05-14 20:46:36 -0400] miah: but i think if we give people _good examples_ to learn from we'll see a shift.
[2013-05-14 20:46:42 -0400] miah: cargo cult some education into these savages ;)
[2013-05-14 20:46:55 -0400] miah: chef/lib/chef/resource.rb:      if Chef::Resource.strict_const_defined?(class_name)
[2013-05-14 20:47:00 -0400] miah: ^- this is why im having problems
[2013-05-14 20:47:14 -0400] steveh__: jsnapp: Still here, though I ran out for lunch
[2013-05-14 20:47:25 -0400] jsnapp: yep, me too
[2013-05-14 20:47:56 -0400] jsnapp: if you still have your server running can you try running `pgrep -lf runsvdir`
[2013-05-14 20:48:13 -0400] jsnapp: that's lowercase L not a 1
[2013-05-14 20:48:45 -0400] magoo_: https://gist.github.com/mago0/5579408
[2013-05-14 20:48:53 -0400] jsnapp: do you see a bunch of dot's? or do you see error messages
[2013-05-14 20:48:58 -0400] steveh__: jsnapp: Dots.
[2013-05-14 20:49:03 -0400] magoo_: does this look like a chef-zero issue?
[2013-05-14 20:49:18 -0400] jsnapp: steveh__: that's actually good
[2013-05-14 20:50:00 -0400] magoo_: jtimberman: you might be interested in that gist ^
[2013-05-14 20:53:59 -0400] jsnapp: steveh__: can you try `lsof -i :8000`
[2013-05-14 20:56:09 -0400] scalp42: awesome chef talk miah :)
[2013-05-14 20:58:10 -0400] miah: thanks.
[2013-05-14 21:01:51 -0400] steveh__: jsnapp: The command returns nothing on both servers.
[2013-05-14 21:03:19 -0400] jsnapp: ok that's good
[2013-05-14 21:04:25 -0400] steveh__: Oops. Well, I have a demo coming up in 2 hours and now that I've updated my scripts they don't run on chef 10.6. They're now throwing the undefined method 'default_action' error. Hmm. Now I don't have a working chef server on any of my boxes.
[2013-05-14 21:05:33 -0400] jsnapp: can you easily revert your scripts for the demo?
[2013-05-14 21:05:54 -0400] steveh__: I'm not sure I know how to do that. Is it as easy as removing the metadata?
[2013-05-14 21:06:31 -0400] jsnapp: first, what do you mean by scripts? recipes?
[2013-05-14 21:06:48 -0400] ivey: miah: you said you've used busser-minitest, i think? if so, do you have a spec you could share?
[2013-05-14 21:07:47 -0400] steveh__: Sorry. Yes, Recipes. The were working properly on 10 and then I updated to 11 on my vm and I think I checked in some changes from that vm to my git recipe repo.
[2013-05-14 21:08:11 -0400] steveh__: Now I just pulled them down onto my chef 10 server and they're giving me the error.
[2013-05-14 21:09:20 -0400] miah: ivey: nope. i havent.
[2013-05-14 21:09:26 -0400] ivey: ohh
[2013-05-14 21:09:37 -0400] miah: i've used minitest. directly. without test-kitchen.
[2013-05-14 21:10:12 -0400] josephholsten: any advice on minitest-chef vs chefspec?
[2013-05-14 21:10:33 -0400] Pushnell: hey all.  trying to get the hang of chef 11 inside of vagrant.  Running `chef-shell -s -c /tmp/vagrant-chef-1/solo.rb -j /tmp/vagrant-chef-1/dna.json` but cannot for the life of me figure out how to trigger a chef run.  Under shef I used to 'recipe', 'include_recipe "myrecipe"' and run_chef.  But run_chef now just returns true.
[2013-05-14 21:11:18 -0400] miah: im also not using minitest-chef. just minitest.
[2013-05-14 21:11:39 -0400] jtimberman: steveh__: you need Chef 0.10.10+ for default_action in resources.
[2013-05-14 21:12:01 -0400] steveh__: Hmm. Thing is I don't think I'm using it.
[2013-05-14 21:12:17 -0400] jsnapp: steveh__: what version of chef-client are you running?
[2013-05-14 21:12:29 -0400] jsnapp: chef-client -v
[2013-05-14 21:12:44 -0400] steveh__: chef-client 10.6
[2013-05-14 21:12:46 -0400] jsnapp: thanks jtimberman
[2013-05-14 21:12:56 -0400] josephholsten: miah: oh really? so are you just testing resources and libs? I guess that maps with your style of cookbook design
[2013-05-14 21:13:03 -0400] steveh__: Could I get away with just upgrading chef-client?
[2013-05-14 21:13:07 -0400] jsnapp: yes
[2013-05-14 21:14:09 -0400] jsnapp: or a better question .. do you already know how to upgrade chef-client?
[2013-05-14 21:14:14 -0400] steveh__: Well, chef 10 was installed via rubygems. I did something like 'yum install rubygem-chef-server'
[2013-05-14 21:14:27 -0400] miah: josephholsten: yes
[2013-05-14 21:14:34 -0400] steveh__: But right now I'm running the upgrade by grabbing the command line from opscode: curl -L https://www.opscode.com/chef/install.sh | bash
[2013-05-14 21:15:24 -0400] jsnapp: steveh__: ok let me know what chef-client -v gives you once it's installed
[2013-05-14 21:15:46 -0400] steveh__: jsnapp: Now I've got 11.4.4
[2013-05-14 21:16:10 -0400] steveh__: And it seems to be working. It's running through the recipes.
[2013-05-14 21:16:26 -0400] jsnapp: great
[2013-05-14 21:18:10 -0400] jsnapp: steveh__: there are some breaking changes between what chef-client 10.x and 11.x versions do   i'm not sure if you're cookbooks utilize anything that would be affected but I just want you to know
[2013-05-14 21:18:17 -0400] rava: can node.attribute? take dotted notation to drill down into a specific namespace for attribute checks?
[2013-05-14 21:18:41 -0400] jsnapp: did you write and test those cookbooks using a 10.x version of chef-client?
[2013-05-14 21:20:21 -0400] steveh__: jsnapp: Yes, and then I ran them on a chef 11.x server and made a few mods and checked them into my repo and I think it updated the metadata
[2013-05-14 21:20:37 -0400] steveh__: Now with chef-client 11 it's running properly.
[2013-05-14 21:21:08 -0400] steveh__: Still stumped on getting the chef 11 to install on the two servers. Those were supposed to be my demo server/target for today.
[2013-05-14 21:21:27 -0400] Pushnell: (rephrasing my Q) I'm pretty familiar with debugging recipes under shef (chef 10) but I cannot seem to figure out how to trigger a run under chef-shell (chef 11.4.0)   recipe_mode include_recipe "myrecipe" just returns [] and run_chef returns true.  All help appreciated.
[2013-05-14 21:22:30 -0400] steveh__: pushnell: Under chef 11, I install the server and client onto the same box and test my recipes by using knife to add the recipes to a node and executing them with chef-client
[2013-05-14 21:23:15 -0400] Pushnell: steveh__: I'm trying to use solo mode under vagrant.  I'll install the full server if it's the only way I can get a debug going, but I've never had to before.
[2013-05-14 21:23:31 -0400] jsnapp: steveh__: ok so do you want to continue troubleshooting server 11? or do you need to go?
[2013-05-14 21:24:26 -0400] ieldib: has anyone worked with the route53 cookbook before ?
[2013-05-14 21:25:37 -0400] ieldib: trying to figure out what hte zoneid is
[2013-05-14 21:25:40 -0400] jtimberman: rava: "yes", but stylistically it's better to use the hash key syntax, e.g. node['foo'].attribute?("bar") (with the keys as strings)
[2013-05-14 21:27:12 -0400] jsnapp: steveh__: still want to work on server 11?
[2013-05-14 21:27:16 -0400] rava: jtimberman: thanks. i knew of that syntax, but the containing namespace is also not guarantied to be there
[2013-05-14 21:27:34 -0400] rava: thus the dotted syntax to avoid nested if's
[2013-05-14 21:28:47 -0400] steveh__: jsnapp: Sure. I'm curious to figure out the problem. Why would erchef fail...
[2013-05-14 21:29:51 -0400] steveh__: pushnell: I'm not as familiar with solo as I am with the whole server/client so I've always just used the client to debug recipes.
[2013-05-14 21:32:24 -0400] magoo_: i need to put  a private key in a data bag and I'm not sure how to format it
[2013-05-14 21:33:06 -0400] magoo_: with the newlines, I dont' think I can just quote it
[2013-05-14 21:34:21 -0400] josephholsten: magoo_: I tend to just use Base64#encode64 since it's in stdlib
[2013-05-14 21:34:30 -0400] josephholsten: http://www.ruby-doc.org/stdlib-2.0/libdoc/base64/rdoc/Base64.html#method-i-decode64
[2013-05-14 21:34:39 -0400] jsnapp: steveh__: chef-server-ctl stop
[2013-05-14 21:34:45 -0400] jsnapp: chef-server-ctl start
[2013-05-14 21:35:18 -0400] jsnapp: does that give any indication of errors we haven't already seen?
[2013-05-14 21:35:55 -0400] Pushnell: steveh__: thanks for trying.  I'm able to get a debug-level run with chef-solo but was hoping to get some breakpoints with shef/chef-shell
[2013-05-14 21:36:53 -0400] steveh__: jsnapp: No errors, everything appears to start. But when I run status, it shows erchef as only being up for 2s when the others have hundreds.
[2013-05-14 21:38:43 -0400] jsnapp: dump the erchef and rabbitmq status lines in here please
[2013-05-14 21:39:33 -0400] steveh__: https://gist.github.com/anonymous/c11dda7f473bfb1b4b44
[2013-05-14 21:40:46 -0400] jstallar1: do I need to include the partial_search recipe to use partial_search, or is it included with the latest version of chef?
[2013-05-14 21:41:02 -0400] jstallar1: http://docs.opscode.com/essentials_search_partial.html makes no mention of a partial_search cookbook
[2013-05-14 21:41:13 -0400] jstallar1: doh...it does
[2013-05-14 21:41:14 -0400] jstallar1: I'm an idiot
[2013-05-14 21:41:16 -0400] jstallar1: carry on
[2013-05-14 22:01:30 -0400] steveh__: jsnapp: Okay, I'm really confused now. Back on the chef 10 server/chef 11 client. I did a test run and told you everything is okay. After the recipe executed successfully, I added another recipe and suddenly I have problems with authentication to the chef server, even though the client is working knife stopped working. I'm starting to get frustrated because I can't seem to back out of chef 11 now that I've started using it.
[2013-05-14 22:02:07 -0400] steveh__: And I've got a demo in less than an hour that's about adopting chef at our company.
[2013-05-14 22:02:48 -0400] Majost1:  Does anyone know where I can find the slide decks and videos from ChefConf?  There was a talk I wanted to re-visit where they talked about the evolution of the hosts file gem from a cookbook, to lwrp, to the current ruby gem.
[2013-05-14 22:04:02 -0400] cburroughs: http://www.youtube.com/opscode <-- videos
[2013-05-14 22:04:12 -0400] Majost1: cburroughs: thanks! =)
[2013-05-14 22:28:04 -0400] bluekelp_: after uploading and freezing a cookbook (knife cookbook upload derp --freeze) is there a way to see which cookbooks are frozen?
[2013-05-14 22:38:41 -0400] nicgrayson: bluekelp_: it looks like the only way is to look at the output of knife cookbook show <cookbook> <version> |grep frozen
[2013-05-14 22:39:11 -0400] nicgrayson: i would be a really nice thing to see when you run cookbook list
[2013-05-14 22:39:15 -0400] nicgrayson: s/i/it
[2013-05-14 22:39:35 -0400] nicgrayson: bluekelp_: ref: http://docs.opscode.com/knife_cookbook.html
[2013-05-14 22:39:58 -0400] bluekelp_: nicgrayson: ah thanks.  at least i can hack a script together for that - somehow
[2013-05-14 22:40:32 -0400] nicgrayson: bluekelp_: i almost just threw something together
[2013-05-14 22:40:52 -0400] bluekelp_: i'm at the point where i want to run "unit tests" with assertions against the nodes/configs - e.g., all cookbooks should be frozen, in all runlists recipe B must be after recipe A, etc.
[2013-05-14 22:40:54 -0400] nicgrayson: i think pulling from knife cookbook list with -Fj is going to be the best starting place
[2013-05-14 22:41:34 -0400] nicgrayson: makes sense, we are just going to take away knife cookbook upload and use jenkins to deploy them
[2013-05-14 22:42:02 -0400] nicgrayson: so you don't really need to worry about freezing them
[2013-05-14 22:42:17 -0400] nicgrayson: you could also use berks upload which freezes by default
[2013-05-14 22:44:32 -0400] GreatSUN: hi ll
[2013-05-14 22:44:33 -0400] GreatSUN: all
[2013-05-14 22:45:35 -0400] GreatSUN: is it possible to load a library out of another cookbook without referencing a dependency onto that cookbook within metadata?
[2013-05-14 22:45:53 -0400] miah: yes, but i dont suggest it =)
[2013-05-14 22:46:14 -0400] nicgrayson: yeah that sounds like a nightmare to figure out later
[2013-05-14 22:47:32 -0400] GreatSUN: it is just a temporary solution until i moved libraries to an own cookbook
[2013-05-14 22:47:42 -0400] GreatSUN: could you tell me how to do it?
[2013-05-14 22:50:50 -0400] GreatSUN: miah: is there some documentation on how to do it?
[2013-05-14 22:54:45 -0400] miah: @run_context.include_recipe('runit') in a provider =)
[2013-05-14 22:55:00 -0400] miah: possible not a instance variable. depends on how you're using it.
[2013-05-14 22:55:29 -0400] GreatSUN: miah: I need some helper library I have in another cookbook within a recipe
[2013-05-14 22:57:38 -0400] rava: i thought the run_list attribute of a role would take be the default run_list for a node if no env_run_lists were defined, though that doesn't seem to be the case. or am i doing something wrong?
[2013-05-14 23:08:59 -0400] silk: Any chance that there is someone that can help me with a chefspec problem?
[2013-05-14 23:09:12 -0400] silk: well, its probably a chef-solo problem
[2013-05-14 23:15:49 -0400] GreatSUN: tr
[2013-05-14 23:15:51 -0400] GreatSUN: re
[2013-05-14 23:17:17 -0400] jtimberman: miah: def include_recipe(recipe); @run_context.include_recipe(recipe); end
[2013-05-14 23:29:29 -0400] magoo_: jtimberman: I must be missing a step but I'm not certain what.. The ossec client can't connect to its queue and I think client.keys is supposed to be populated
[2013-05-14 23:29:47 -0400] magoo_: the permissions look fine for everything though
[2013-05-14 23:30:32 -0400] miah: jtimberman: ya. thats probably a better method
[2013-05-14 23:31:06 -0400] miah: i am going to have to change the way im currently doing it as i've just implemented a hack to make sure it works =)
[2013-05-14 23:33:25 -0400] kindsol: I love that I can see the top downloaded cookbooks at http://community.opscode.com/cookbooks.  I just wish I could see more than the top 3.
[2013-05-14 23:33:44 -0400] miah: you also wish tha tmy cookbooks were on community ;)
[2013-05-14 23:34:30 -0400] kindsol: I do. why aren't they? ;)
[2013-05-14 23:34:38 -0400] miah: name spacing =)
[2013-05-14 23:35:17 -0400] kindsol: git repo?
[2013-05-14 23:36:05 -0400] Majost1: Is there anything equivalent to Chef::Util::FileEdit for XML?
[2013-05-14 23:36:25 -0400] Majost1: Moreover, what is the future of FileEdit and the Util class?
[2013-05-14 23:37:13 -0400] miah: i'm being bitten by that silly bug we were talking about earlier jtimberman (CHEF-672)
[2013-05-14 23:37:18 -0400] miah: time to get stabby
[2013-05-14 23:37:30 -0400] miah: file edit.. bad bad news
[2013-05-14 23:37:34 -0400] Majost1: heh
[2013-05-14 23:37:45 -0400] Majost1: miah: yeah, I realize this
[2013-05-14 23:38:10 -0400] Majost1: I am probably just going to write a library using nokogiri and builder
[2013-05-14 23:38:45 -0400] Majost1: but it seems like a logical addition to the Util class would be a handler for xml for those "special" files written in xml.
[2013-05-14 23:38:57 -0400] Majost1: and by special.... I think you know what I mean.
[2013-05-14 23:44:03 -0400] cwj: how is busser supposed to get installed on my test-kitchen VMs? I am trying to port my minitest-handler tests to test-kitchen via busser and its looking for bits under /opt/busser that arent there
