[2013-05-16 00:00:32 -0400] doomviking: stormerider: IIRC its based on the chef environment
[2013-05-16 00:01:09 -0400] stormerider: yeah, i just found that out, i have a dev/qa/prod environment, so i just turned on the multi environment stuff and it's working fine. thanks :)
[2013-05-16 00:02:34 -0400] doomviking: yup
[2013-05-16 00:04:40 -0400] itchyouch: When upgrading an rpm from say syslog-ng3 to syslog-ng, I can create a single transaction in the yum shell by doing a remove syslog-ng3, followed with a install syslog-ng then with run.
[2013-05-16 00:05:04 -0400] itchyouch: Any way to replicate this behavior so that i dont uninstall a whole system while trying replace syslog?
[2013-05-16 00:06:54 -0400] markxnelson: Hi Chefs, I am trying to get Chef Server 11.4.4 working on EL, and the rabbitmq thing is killing me... It wont start, I found a bunch of posts/bugs/etc but no answers on this one.  Does anyone know how to get past this?  Thanks!
[2013-05-16 00:10:07 -0400] markxnelson: # chef-server-ctl start rabbitmq
[2013-05-16 00:10:08 -0400] markxnelson: warning: rabbitmq: unable to open supervise/ok: file does not exist
[2013-05-16 00:10:28 -0400] markxnelson: http://tickets.opscode.com/browse/CHEF-3838 is the bug
[2013-05-16 00:17:33 -0400] stormerider: are there any EC2 AZs that are greater than the EC2 region + one alpha character? (ie, us-west-1 + a/b/c/etc.)
[2013-05-16 00:18:23 -0400] jtoft: not that I'm aware of currently
[2013-05-16 00:18:26 -0400] jtoft: but given time, sure
[2013-05-16 00:19:00 -0400] stormerider: i guess 26 AZs will take a long while for them to grow beyond for a given region
[2013-05-16 00:19:43 -0400] stormerider: i guess for now comparing the nagios placement AZ[0..-2] vs the node placement AZ[0..-2] will suffice to compare regionality
[2013-05-16 00:20:02 -0400] stormerider: (i wish Ohai could determine the region directly, rather than the AZ, but this should do for the forseeable future)
[2013-05-16 00:49:48 -0400] Kzim: hi, does anyone use Salt as orchestrator for Chef ?
[2013-05-16 01:15:16 -0400] eph3meral: so I've worked with chef before, I'm about to dig back in to the documentation, mostly I'm wondering recommended route of attack to create dev servers
[2013-05-16 01:16:57 -0400] eph3meral: as in, like I'd like to be able to demo any commit hash or branch
[2013-05-16 01:17:07 -0400] eph3meral: have a nice automated script to spin up a server, do the checkout
[2013-05-16 01:17:11 -0400] eph3meral: give me a link back
[2013-05-16 01:17:16 -0400] eph3meral: and a script to take it down
[2013-05-16 01:17:26 -0400] eph3meral: although it has been put forth that a cluster could be used
[2013-05-16 01:23:36 -0400] pwf: when did knife diff and knife download get added?
[2013-05-16 01:23:46 -0400] pwf: those seem extremely useful but i don't seem to have them
[2013-05-16 01:25:24 -0400] silk: I think they were released initially as a seperate gem (knife-essentials) and then incorporated later in chef11
[2013-05-16 01:25:36 -0400] silk: http://www.opscode.com/blog/2013/02/04/chef-11-released/
[2013-05-16 01:28:40 -0400] eph3meral: I know this is a pretty general question
[2013-05-16 01:29:23 -0400] eph3meral: my ideal scenario would involve having a cluster of X or so VPSes (lets say 10 of them) and at any moment I can use a command to ping one of them and upload the latest version of a branch and then give me a link back so I can get to it
[2013-05-16 01:29:36 -0400] eph3meral: is chef a good candidate for this or would capistrano be better to do this with?
[2013-05-16 01:29:43 -0400] pwf: thanks silk
[2013-05-16 01:29:50 -0400] eph3meral: certainly writing a recipe to replicate X of those servers would be the domain of chef
[2013-05-16 01:41:56 -0400] stormerider: how do you search for nodes with an empty runlist?
[2013-05-16 01:45:13 -0400] markxnelson: Hi all.  Trying to get a chef-server running.  Cannot get it to start rabbitmq.  Was trying on EL, no luck, gave up and went to Ubuntu, same problem!  I had this problem last time I installed on Ubuntu, and I got past it, but I can't remember what I did.  Can anyone helP?
[2013-05-16 02:05:57 -0400] juliancdunn: markxnelson: rabbitmq is really picky about DNS
[2013-05-16 02:06:22 -0400] juliancdunn: if your host doesn't have a reverse record or an entry in /etc/hosts for its own name, rabbitmq will barf, so maybe check that?
[2013-05-16 02:09:05 -0400] markxnelson: juliancdunn: yeah done that
[2013-05-16 02:09:24 -0400] markxnelson: it is giving me this:
[2013-05-16 02:09:25 -0400] markxnelson: # chef-server-ctl start rabbitmq
[2013-05-16 02:09:26 -0400] markxnelson: warning: rabbitmq: unable to open supervise/ok: file does not exist
[2013-05-16 02:09:35 -0400] markxnelson: i installed daemontools too
[2013-05-16 02:10:04 -0400] stormerider: are you using the omnibus package?
[2013-05-16 02:10:20 -0400] markxnelson: i downloaded a deb from the chef install site..
[2013-05-16 02:10:24 -0400] stormerider: if so, you don't need to install daemontools
[2013-05-16 02:10:25 -0400] markxnelson: is that the same thing?
[2013-05-16 02:10:50 -0400] stormerider: actually, i think chef 11 is solely via omnibus, but im not 100% sure on that.
[2013-05-16 02:11:57 -0400] stormerider: what happens if you do "status opscode-runsvdir"?
[2013-05-16 02:14:20 -0400] stormerider: you should see something like: opscode-runsvdir start/running, process 1029
[2013-05-16 02:16:35 -0400] markxnelson: i get no output from that
[2013-05-16 02:17:34 -0400] markxnelson: oh wait: status: Unknown job: opscode-runsvdir
[2013-05-16 02:19:26 -0400] stormerider: then something didn't get installed properly. i'd reinstall the deb.
[2013-05-16 02:20:30 -0400] markxnelson: ok trying that, thanks
[2013-05-16 02:21:48 -0400] stormerider: basically that's the superviser system for /opt/chef-server/service
[2013-05-16 02:22:21 -0400] stormerider: and the deb should put the config file into /etc/init/opscode-runsvdir.conf
[2013-05-16 02:22:43 -0400] markxnelson: ok - installing the deb now - i will see if the file is there
[2013-05-16 02:22:48 -0400] markxnelson: thanks for your help
[2013-05-16 02:24:03 -0400] markxnelson: ok it installed
[2013-05-16 02:24:11 -0400] markxnelson: there is no such file in /etc/init though
[2013-05-16 02:26:04 -0400] markxnelson: i just installed the chef-server deb this time.. do i need a client too?
[2013-05-16 02:31:53 -0400] stormerider: well, you'll likely want it, but that file should be in the server deb. which deb are you using?
[2013-05-16 02:32:09 -0400] markxnelson: chef-server_11.0.8-1.ubuntu.12.04_amd64.deb
[2013-05-16 02:32:34 -0400] markxnelson: https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/x86_64/chef-server_11.0.8-1.ubuntu.12.04_amd64.deb
[2013-05-16 02:32:40 -0400] stormerider: i'd go with 11.4.4
[2013-05-16 02:33:12 -0400] markxnelson: server?
[2013-05-16 02:33:58 -0400] stormerider: yes.
[2013-05-16 02:34:00 -0400] stormerider: er
[2013-05-16 02:34:03 -0400] stormerider: sec
[2013-05-16 02:34:16 -0400] stormerider: no, that's the client, my bad
[2013-05-16 02:35:24 -0400] stormerider: hm. it looks like it might not be installed by the deb but instead as part of the install process.
[2013-05-16 02:35:32 -0400] markxnelson: i tired with chef_11.4.4-2.ubuntu.11.04_amd64.deb and chef_11.4.4-1.ubuntu.11.04_amd64.deb
[2013-05-16 02:35:34 -0400] stormerider: what are you doing after running the dpkg command?
[2013-05-16 02:35:41 -0400] markxnelson: chef-server-ctl reconfigure
[2013-05-16 02:37:00 -0400] stormerider: im not sure exactly where it's going wrong, then. are there any errors during that process?
[2013-05-16 02:37:49 -0400] markxnelson: no. it just stops on the rabbitmq one
[2013-05-16 02:38:01 -0400] stormerider: and can you gist your /etc/chef/chef-server.rb (if you have one), sanitizing anything you want to protect?
[2013-05-16 02:38:20 -0400] markxnelson: i am setting up a brand new vm with a new os install to try on a clean system
[2013-05-16 02:38:25 -0400] stormerider: /etc/chef-server/chef-server.rb, rather
[2013-05-16 02:38:32 -0400] markxnelson: i dont have one
[2013-05-16 02:41:48 -0400] stormerider: coderanger might have a better idea what's going on that i
[2013-05-16 02:41:52 -0400] stormerider: than i*
[2013-05-16 02:42:04 -0400] coderanger: You rang?
[2013-05-16 02:42:09 -0400] jtgiri_: I am trying to import backup from 10 to 11 for migration, I am getting this error message : ERROR: JSON::ParserError: Unsupported `json_class` type 'Chef::WebUIUser'
[2013-05-16 02:43:03 -0400] stormerider: coderanger: markxnelson is trying to set up a new chef 11.0.8 server and it's dying on trying to start the rabbitmq service, and they don't have an /etc/init/opscode-runsvdir.conf file (not sure if they should at that point of the reconfigure setup or not though)
[2013-05-16 02:43:30 -0400] markxnelson: i get the same problem on EL and on ubuntu
[2013-05-16 02:43:44 -0400] markxnelson: i did an install a week ago on ubuntu and got everything working
[2013-05-16 02:43:57 -0400] markxnelson: i cant recall how i got past this rabbtimq issue
[2013-05-16 02:44:02 -0400] stormerider: i forget the exact rabbitmq error (i cant figure out how to backscroll in weechat) but it said something about supervise (if you can repost it, markxnelson, that'd probably be helpful)
[2013-05-16 02:44:26 -0400] markxnelson: i installed daemontools, checked /etc/hosts for fqdn, tried hacking the runit recipe..
[2013-05-16 02:44:49 -0400] markxnelson: # chef-server-ctl start rabbitmq
[2013-05-16 02:44:50 -0400] markxnelson: warning: rabbitmq: unable to open supervise/ok: file does not exist
[2013-05-16 02:44:51 -0400] stormerider: you dont need to install daemontools with the omnibus package, it's all embedded
[2013-05-16 02:51:15 -0400] markxnelson: ok, trying on a brand new install of EL6..
[2013-05-16 02:51:32 -0400] markxnelson: rpm -Uvh https://opscode-omnitruck-release.s3.amazonaws.com/el/6/x86_64/chef-server-11.0.6-1.el6.x86_64.rpm
[2013-05-16 02:55:13 -0400] sascha_d: @markxnelson is this straight up Red Hat?
[2013-05-16 02:55:27 -0400] sascha_d: There's a bug with Amazon linux installs
[2013-05-16 02:55:35 -0400] sascha_d: found it the other night helping someone else debug
[2013-05-16 02:56:07 -0400] markxnelson: the one about adding "amazon" to the runit/recipes/default.rb ?
[2013-05-16 02:56:20 -0400] markxnelson: i am using oracle EL6 right now
[2013-05-16 02:56:28 -0400] markxnelson: i am downloading a new ubuntu server to try too
[2013-05-16 02:57:31 -0400] sascha_d: @markxnelson there is a case statement
[2013-05-16 02:57:37 -0400] markxnelson: yeah
[2013-05-16 02:57:43 -0400] sascha_d: because platforms don't report in exactly the same
[2013-05-16 02:57:48 -0400] markxnelson: i knew about that one
[2013-05-16 02:57:48 -0400] sascha_d: I'd have to go dig up the bug
[2013-05-16 02:58:00 -0400] markxnelson: i already tried that
[2013-05-16 02:58:05 -0400] sascha_d: but we edited like the bug report suggested and it worked
[2013-05-16 02:58:09 -0400] markxnelson: it made no difference
[2013-05-16 02:58:15 -0400] markxnelson: i tried both ways
[2013-05-16 02:58:22 -0400] markxnelson: adding to the end of the existing when
[2013-05-16 02:58:25 -0400] markxnelson: and adding a new when
[2013-05-16 02:58:37 -0400] markxnelson: i also just hardocded it and commented out the whole case statement
[2013-05-16 02:58:41 -0400] markxnelson: no difference
[2013-05-16 02:58:48 -0400] markxnelson: fails every way
[2013-05-16 02:58:58 -0400] markxnelson: tried on different OS too
[2013-05-16 02:59:21 -0400] sascha_d: RabbitMQ does not start on Oracle or Amazon Linux http://tickets.opscode.com/browse/CHEF-3838
[2013-05-16 03:00:06 -0400] markxnelson: and this one: http://tickets.opscode.com/browse/COOK-2545
[2013-05-16 03:00:20 -0400] sascha_d: There is a comment near the bottom: http://tickets.opscode.com/browse/CHEF-3838?focusedCommentId=34297&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-34297
[2013-05-16 03:00:33 -0400] sascha_d: that lays out a slightly different fix than the one further up
[2013-05-16 03:00:42 -0400] markxnelson: yeah did both
[2013-05-16 03:00:47 -0400] markxnelson: :)
[2013-05-16 03:00:55 -0400] markxnelson: i did try to get it to work myself first :)
[2013-05-16 03:01:06 -0400] markxnelson: before asking for help
[2013-05-16 03:01:28 -0400] markxnelson: and I do have one working server+workstation+node
[2013-05-16 03:01:41 -0400] markxnelson: so i have been aable to push out some configs and get stuff happening
[2013-05-16 03:02:04 -0400] markxnelson: but now i am trying to move from a little 2 VM poc to a proper prototype environment with a lot more nodes
[2013-05-16 03:02:11 -0400] markxnelson: and i cant get the server to work :(
[2013-05-16 03:15:29 -0400] stormerider_: markxnelson: can you gist the entire output of chef-server-ctl reconfigure? i'd suggest doing like "script /tmp/chefreconfig.log sudo chef-server-ctl reconfigure" to capture it all
[2013-05-16 03:17:50 -0400] markxnelson: sure
[2013-05-16 03:21:02 -0400] markxnelson: so it is just sitting at the rabbit mq now:
[2013-05-16 03:21:03 -0400] markxnelson: http://tickets.opscode.com/browse/COOK-2545
[2013-05-16 03:21:06 -0400] markxnelson: dopps sorry
[2013-05-16 03:21:24 -0400] markxnelson: do you want me to ctrl-c it and gist the output?
[2013-05-16 03:22:03 -0400] stormerider: let it run and gist it when it fails
[2013-05-16 03:23:10 -0400] markxnelson: ok
[2013-05-16 03:23:44 -0400] stormerider: and sanitize the gist if there's anything you care to protect, of course.
[2013-05-16 03:26:31 -0400] markxnelson: it is still running (or sitting there anyway) - i am starting a parallel install on a fresh ubuntu as well
[2013-05-16 03:41:24 -0400] stormerider: has anyone played with maps in Nagios via Chef? im thinking it might be nice to do something like draw them based on ec2 regionality
[2013-05-16 04:22:11 -0400] markxnelson: ran it on ubuntu and it worked fine
[2013-05-16 04:22:32 -0400] markxnelson: so i guess i have to use ubuntu....
[2013-05-16 04:22:44 -0400] markxnelson: @stormerider
[2013-05-16 04:23:09 -0400] stormerider: huh. what were you using the deb on before?
[2013-05-16 04:23:17 -0400] markxnelson: desktop
[2013-05-16 04:23:23 -0400] markxnelson: i just tried on server 12.04 LTS
[2013-05-16 04:23:33 -0400] stormerider: i know you mentioned rhel before
[2013-05-16 04:23:35 -0400] markxnelson: its weird, i did install it last week and it worked too
[2013-05-16 04:23:46 -0400] markxnelson: ideally, i would want to run it on oracle linux
[2013-05-16 04:23:56 -0400] markxnelson: that is what people like to use here
[2013-05-16 04:24:06 -0400] stormerider: so you tried with ubuntu desktop and it failed but ubuntu server worked?
[2013-05-16 04:24:13 -0400] markxnelson: yeah weird
[2013-05-16 04:24:16 -0400] stormerider: very.
[2013-05-16 04:24:22 -0400] markxnelson: but ubuntu desktop (differnt vm) worked last week
[2013-05-16 04:24:32 -0400] markxnelson: miust be something hosed in that vm i gues
[2013-05-16 04:24:51 -0400] stormerider: huh. im wondering if it's missing something in the init system, i just dont know what to look for.
[2013-05-16 04:25:04 -0400] stormerider: im running 13.04 on my server, but i had been on 12.10 before.
[2013-05-16 04:25:32 -0400] stormerider: i dont really play in the RH ecosystem anymore these days
[2013-05-16 04:26:14 -0400] sascha_d: I popped up a RH 6.3 vm last week helping someone else troubleshoot a serve install and it worked fine
[2013-05-16 04:26:20 -0400] sascha_d: I think I've seen a bug report on 6.4
[2013-05-16 04:29:48 -0400] markxnelson: is there some particular reason why chef does not seem to support rh & co.?   or is it just a lack of volunteers to maintain it ?\
[2013-05-16 04:30:53 -0400] bdha: Running Cheff 11 (and Private Chef) on CentOS with a couple hundred 10.x and 11.x Fedora and CentOS clients.
[2013-05-16 04:31:09 -0400] bdha: Don't really use many community cookbooks, though.
[2013-05-16 04:50:33 -0400] sascha_d: @markxnelson I think Chef does a good job supporting Red Hat. I'm running about 500 servers in 3 color and growing with my current client. Plus I've done a few other projects with Red Hat.
[2013-05-16 04:50:44 -0400] sascha_d: And I use community cookbooks
[2013-05-16 04:51:21 -0400] sascha_d: also that was supposed to be colos not color. Textual is an aggressive spell checker :)
[2013-05-16 04:51:56 -0400] markxnelson: do you mean as the chef server, or just clients?
[2013-05-16 04:52:06 -0400] markxnelson: i had no trouble with the client
[2013-05-16 04:52:09 -0400] markxnelson: only the server
[2013-05-16 04:52:14 -0400] sascha_d: I have a chef server
[2013-05-16 04:52:16 -0400] sascha_d: it just runs
[2013-05-16 04:52:29 -0400] sascha_d: It's a real server which could make a diff
[2013-05-16 04:52:56 -0400] sascha_d: but I seriously popped up a vagrant VM and installed the Chef Server RPM on it last week. No idea how that would actually perform, but it installed fine.
[2013-05-16 04:54:16 -0400] eph3meral: anyone in here tried https://github.com/rubber/rubber ?
[2013-05-16 04:54:23 -0400] eph3meral: my initial inclincation was to go with Chef
[2013-05-16 04:54:43 -0400] eph3meral: then I saw that, I thought wow and now after reading more, it seems more like a Chef replacement so why would I use rubber instead of Chef?
[2013-05-16 04:55:27 -0400] eph3meral: I guess it's a little trollish to ask you guys why to use someone else's thing, but if you wanna answer in the reverse direction
[2013-05-16 04:57:23 -0400] eph3meral: my main goal is this: "Want each of your developers to have their own custom staging server on demand?"
[2013-05-16 06:59:08 -0400] beagile: Hello Guys, currently I have the problem that I'd like to install passenger with the passenger_apache2 recipe. This recipe comes after the chef-rbenv recipe in my run_list. The problem now is that the passenger_apache2 recipe is using the standard 'package' resource to install gems, which install the passenger gem with the system ruby... Is there a smart way to make the standard 'package' aware of rbenv without modifying the passenger
[2013-05-16 08:45:21 -0400] helllen: helllo
[2013-05-16 08:45:50 -0400] helllen: I am reading the app.config file for erchef and I would like to understand what is chef_objects used for?
[2013-05-16 08:45:55 -0400] helllen: someone could help me please ?
[2013-05-16 08:48:44 -0400] helllen: it says: "The s3_url is used by erchef to talk to bookshelf"
[2013-05-16 08:49:01 -0400] helllen: could I use other s3 storage instead of bookshelf ??
[2013-05-16 09:15:39 -0400] woltage: hmm..
[2013-05-16 09:16:07 -0400] woltage: People using minitest-handler-cookbook for testing with vagrant+chef-client?
[2013-05-16 09:42:11 -0400] eph3meral: so this may be obvious to some, but not to me, yet
[2013-05-16 09:42:16 -0400] eph3meral: where do I customize recipes?
[2013-05-16 09:42:39 -0400] eph3meral: with http://community.opscode.com/cookbooks/postgresql specifically I'd like to customize the "pg_hba" setting for my particular node
[2013-05-16 09:42:56 -0400] eph3meral: er, well, actually for any node that I will fire up with this set of cookbooks
[2013-05-16 09:45:08 -0400] masterkorp: hello
[2013-05-16 09:45:26 -0400] eph3meral: hi
[2013-05-16 09:45:40 -0400] masterkorp: I am trying to bootstrap a node
[2013-05-16 09:45:49 -0400] masterkorp: i use --sudo
[2013-05-16 09:46:07 -0400] masterkorp: but knife asks for a pass (wich i give with -P) and fails
[2013-05-16 09:46:21 -0400] masterkorp: sudo requires a pass on the node
[2013-05-16 09:49:12 -0400] zts: masterkorp: when I've done that in the past, knife has prompted me for the sudo password interactively (the -P option is only used for ssh)
[2013-05-16 09:49:35 -0400] masterkorp: zts: it just says wrong pass. here
[2013-05-16 09:49:59 -0400] masterkorp: oh, just prompted
[2013-05-16 09:50:06 -0400] masterkorp: worked... magic..
[2013-05-16 09:50:37 -0400] masterkorp: http://pastie.org/7915261
[2013-05-16 09:50:41 -0400] masterkorp: now i get this
[2013-05-16 09:50:45 -0400] masterkorp: any ideas?
[2013-05-16 09:53:11 -0400] zts: masterkorp: sounds like http://tickets.opscode.com/browse/CHEF-3698
[2013-05-16 09:53:50 -0400] masterkorp: well i dont pass any version ?
[2013-05-16 09:55:43 -0400] admin0: hi guys .. I am facing this issue:  http://tickets.opscode.com/browse/CHEF-3638  .. but I can't seem to work out a solution
[2013-05-16 09:56:27 -0400] admin0: i am using version 11.4.4
[2013-05-16 09:57:39 -0400] masterkorp: easy enough to fix by hand
[2013-05-16 09:59:52 -0400] admin0: masterkorp, you mean the issue i am getting ?
[2013-05-16 10:00:35 -0400] masterkorp: no mune, sorry
[2013-05-16 10:01:06 -0400] masterkorp: admin0: still do you want to upload all your cookbooks ?
[2013-05-16 10:01:43 -0400] masterkorp: just run a for loop on your cookbook path
[2013-05-16 10:24:11 -0400] eph3meral: what's the appropriate way to add a database user?
[2013-05-16 10:24:16 -0400] eph3meral: i.e. how should I add a mysql user
[2013-05-16 10:25:46 -0400] n1ko: eph3meral: by using database cookbook
[2013-05-16 10:26:00 -0400] n1ko: https://github.com/opscode-cookbooks/database
[2013-05-16 10:36:50 -0400] masterkorp: guys welp, runit cookbook is not working on redhat
[2013-05-16 10:37:01 -0400] masterkorp: it just does nothing when runit is not installed
[2013-05-16 10:42:36 -0400] admin0: masterkorp,  that helped .. but now stuck with sandboxes error :D
[2013-05-16 10:43:05 -0400] admin0: ERROR: Server returned error for https://10.0.28.62/sandboxes/000000000000028333f38d68a9668355, retrying 1/5 in 4s -- lines like that
[2013-05-16 10:57:02 -0400] corehook: hi all
[2013-05-16 10:57:18 -0400] corehook: after installing private version of chef server i can login to panel
[2013-05-16 10:57:58 -0400] corehook: i registered user but after trying access to web ui cant log in
[2013-05-16 10:58:01 -0400] corehook: with out errors
[2013-05-16 11:02:45 -0400] binamov: what errors?
[2013-05-16 11:10:09 -0400] corehook: how to log in to web-ui after standart installing and recofigure commands ?
[2013-05-16 11:10:23 -0400] corehook: https://server/ send me to login page
[2013-05-16 11:11:34 -0400] binamov: corehook what errors r u getting?
[2013-05-16 11:11:59 -0400] corehook: nothing
[2013-05-16 11:12:01 -0400] corehook: no errros
[2013-05-16 11:12:09 -0400] corehook: just resend me to login page again
[2013-05-16 11:12:55 -0400] corehook: i am register user on page http://server/users/new
[2013-05-16 11:13:14 -0400] corehook: and try enter entered in the registration form login/passworfd
[2013-05-16 11:13:47 -0400] corehook: root@chef:~# private-chef-ctl show-config
[2013-05-16 11:13:48 -0400] corehook: Starting Chef Client, version 11.4.0
[2013-05-16 11:17:21 -0400] binamov:  ,   :)
[2013-05-16 11:17:32 -0400] corehook:    ?   
[2013-05-16 11:18:06 -0400] binamov: corehook    ?
[2013-05-16 11:18:56 -0400] corehook: ubuntu 12.04
[2013-05-16 11:19:33 -0400] corehook:     .    /opt/opscode/
[2013-05-16 11:19:40 -0400] corehook: ,      Nginx'
[2013-05-16 11:20:02 -0400] corehook:  ,  /var/log
[2013-05-16 11:20:42 -0400] corehook: ns
[2013-05-16 11:20:53 -0400] binamov:       , 
[2013-05-16 11:21:10 -0400] corehook: )
[2013-05-16 11:21:44 -0400] corehook:    webui,   
[2013-05-16 11:22:11 -0400] binamov:     ?
[2013-05-16 11:33:03 -0400] binamov: corehook    http://docs.opscode.com/server/private_chef_1x_install.html#create-users ?
[2013-05-16 11:36:13 -0400] corehook:    ?     ?
[2013-05-16 11:36:49 -0400] binamov: corehook   http://docs.opscode.com/server/_images/private_chef_1x_download_private_key1.png
[2013-05-16 11:37:12 -0400] Mithrandir: could you either switch to english or take it to privmsg?
[2013-05-16 11:37:33 -0400] binamov: :)
[2013-05-16 12:17:43 -0400] BryanWB_: anybody had success spinning up a windows guest w/ vagrant? i am trying to login after spinning it up, can't figure out how
[2013-05-16 12:17:58 -0400] BryanWB_: i have the gui but would like to get a tty
[2013-05-16 12:19:52 -0400] binamov: i suppose vagrant ssh won't work
[2013-05-16 12:21:56 -0400] masterkorp: lol, yeah
[2013-05-16 12:22:21 -0400] masterkorp: windows is a whole new level of butthurting pain when it comes to automation
[2013-05-16 12:22:59 -0400] BryanWB_: masterkorp: it is pain and suffering
[2013-05-16 12:23:14 -0400] masterkorp: BryanWB_: to you, I wish you good luck
[2013-05-16 12:23:16 -0400] mattt: windows is butthurting pain even before you start considering automation
[2013-05-16 12:23:18 -0400] masterkorp: share with us
[2013-05-16 12:23:45 -0400] masterkorp: mattt: still for the ones who have do deal with it, that conversation is old
[2013-05-16 12:23:48 -0400] gokr: Thinking about how to deal with different configs of the "same basic kind of system". First I thought - oh, versions of recipes. Then I felt, nah... better to use Attributes and conditionals in the recipes. I am not afraid of some ifs in the recipes. Is this what people do?
[2013-05-16 12:24:07 -0400] mattt: masterkorp: i would imagine so  and i have nothing against windows, if it's the right tool for the job then great
[2013-05-16 12:24:47 -0400] admin0: guys . i am getting an error during upload .. pastebin here; http://pastebin.com/NTrKqvGX
[2013-05-16 12:24:57 -0400] shay-: hi, i have got some problems with knife-backup: Exception: NoMethodError: undefined method `keys' for #<Array:0x7feb1bca1b20> -- in /usr/lib/ruby/gems/1.8/gems/knife-backup-0.0.5/lib/chef/knife/backup_export.rb line 48, any ideas?
[2013-05-16 12:24:58 -0400] masterkorp: mattt: the only case when window is the right tool for the job is when you want to see trough a wall
[2013-05-16 12:25:00 -0400] admin0: and I cannot figure out the exact cause
[2013-05-16 12:25:13 -0400] admin0: error during knife cookbook upload errir
[2013-05-16 12:32:18 -0400] shay-: by the way is version 11 already production ready?
[2013-05-16 12:53:04 -0400] shay-: where can i bring in a bug of knife backup?
[2013-05-16 13:03:52 -0400] petecheslock: shay- - this project? https://github.com/mdxp/knife-backup - probably can submit an issue or PR with the creator.
[2013-05-16 13:05:00 -0400] shay-: yes right, this one
[2013-05-16 13:14:14 -0400] tinychaos: hey
[2013-05-16 13:14:38 -0400] tinychaos: * execute[bundle install --deployment] action run on ec2 deploy just hangs
[2013-05-16 13:14:49 -0400] tinychaos: well, not hangs, it actually executes it, takes ages
[2013-05-16 13:15:08 -0400] tinychaos: it finishes on the box, disappears from the process list
[2013-05-16 13:15:17 -0400] tinychaos: but chef just hangs, no response whatsoever
[2013-05-16 13:23:03 -0400] binamov: what's the best way to use one physical workstation with multiple servers? just different chef-repo folders?
[2013-05-16 13:23:26 -0400] binamov: w diff knife.rb and .pem obvs
[2013-05-16 13:25:38 -0400] petecheslock: binamov - you could create a custom knife.rb and use environment variables to change where you talk to
[2013-05-16 13:27:45 -0400] masterkorp: binamov: well i use knife block to work with diferent servers
[2013-05-16 13:28:28 -0400] sabooky: chef-solo seems to parse all attribute files (including non-default.rb and from cookbooks that aren't in the run_list), any way to avoid this?
[2013-05-16 13:29:13 -0400] sabooky: How do I have a library cookbook define one set of defaults, and use a application cookbook to override attributes.. since they're all parsed, my attributes are all getting mangled..
[2013-05-16 13:31:37 -0400] binamov: masterkorp that's awesome, thanks!
[2013-05-16 13:42:51 -0400] gchristensen: when deploying a ruby application (with application_ruby) and unicorn, when runit sends a HUP to the service it creates a second sect of unicorn workers. I've documented it here: https://gist.github.com/grahamc/cb6a1ebce09430638aff - I stop the service, start it, HUP it, and then demonstrate the creation of the extra unicorns. Has anyone experienced this before? I'm running out of questions to ask.
[2013-05-16 14:00:32 -0400] BryanWB_: does the plugin for ec2 detect if u are on a vpc?
[2013-05-16 14:08:18 -0400] xtristan: what is 'u' in that sentence BryanWB_ ? is it university?
[2013-05-16 14:08:27 -0400] masterkorp: lol
[2013-05-16 14:09:12 -0400] BryanWB_: xtristan: haha, if ohai detect whether or not the node is on a vpc network on AWS
[2013-05-16 14:11:09 -0400] xtristan: oh, i understand now. yeah one second
[2013-05-16 14:14:04 -0400] xtristan: i think you may need something installed, like ec2-ami-tools or ec2-api-tools to expose it
[2013-05-16 14:14:16 -0400] xtristan: but check `ohai | grep vpc`
[2013-05-16 14:19:02 -0400] xtristan: @BryanWB_ any luck?
[2013-05-16 14:19:23 -0400] BryanWB_: xtristan: argh, will have to check that later sidetracked w/ windoze bs
[2013-05-16 14:19:29 -0400] BryanWB_: tks for trying
[2013-05-16 14:19:34 -0400] xtristan: what's windoze
[2013-05-16 14:19:37 -0400] xtristan: what's tks
[2013-05-16 14:19:45 -0400] xtristan: man, you hate the englishlanguage
[2013-05-16 14:22:09 -0400] BryanWB_: xtristan: i do! mangle it every chance I get
[2013-05-16 14:22:22 -0400] xtristan: haha no worries
[2013-05-16 14:22:33 -0400] xtristan: let me know if you run into trouble later with your ohai ec2 thing
[2013-05-16 14:25:03 -0400] BryanWB_: does rhel 5.x support /etc/security/limits.d ?
[2013-05-16 14:26:03 -0400] BryanWB_: looks like it
[2013-05-16 14:39:12 -0400] a13x212: anyone seen this error before: ERROR: RuntimeError: Server should have transitioned to 'ACTIVE' not 'ERROR'
[2013-05-16 14:39:35 -0400] a13x212: using knife rackspace
[2013-05-16 15:05:14 -0400] gazoombo: where's the best place to talk about test-kitchen specific issues now? #chef? #chef-hacking?
[2013-05-16 15:08:17 -0400] Cope_: gazoombo: pretty mainstream
[2013-05-16 15:09:13 -0400] gazoombo: OK
[2013-05-16 15:09:44 -0400] gazoombo: What I'm wondering: is there a way to do black-box testing from outside a VM with test-kitchen?
[2013-05-16 15:10:07 -0400] gazoombo: it looks like busser will let you use different test frameworks, but runs on the VM
[2013-05-16 15:11:01 -0400] gazoombo: I'd like to run some tests externally (what ports are open, does this URL return 200), etc. and I'm wondering if I can use test-kitchen for that
[2013-05-16 15:11:41 -0400] gazoombo: I'd really like to keep those tests together with my other cookbook tests (in BATS or whatever)
[2013-05-16 15:12:43 -0400] ebel: I'm getting started with chef to deploy our django web app, and I'm using the python cookbook ( http://community.opscode.com/cookbooks/python ), but I can't see how to do pip install with a requirements file, is it possible?
[2013-05-16 15:21:26 -0400] gazoombo: anyone around?
[2013-05-16 15:22:23 -0400] cilquirm: question on attribute files?  if i have multiple attribute files in my cookbook, they're *all* loaded when the recipe is executed?
[2013-05-16 15:23:20 -0400] paulmooring: cilquirm: yes
[2013-05-16 15:24:11 -0400] paulmooring: actually all the attribute files from all of your cookbooks are load before any recipe is executed
[2013-05-16 15:24:37 -0400] cilquirm: i wanted to break down my attribute files per, say , platform_family
[2013-05-16 15:25:13 -0400] cilquirm: like : if platform_family == 'debian'  include_attribute "mycookbook::debian"
[2013-05-16 15:25:43 -0400] paulmooring: my personal preference would be don't put logic in an attribute file
[2013-05-16 15:25:51 -0400] paulmooring: do that in the recipe
[2013-05-16 15:26:20 -0400] paulmooring: but you can have logic (ruby code) in an attributes file if you eant
[2013-05-16 15:26:25 -0400] paulmooring: s/eant/want/
[2013-05-16 15:27:08 -0400] cilquirm: but if i don't put logic to guard against evalutation, then my defaults end up in a funky state, no?
[2013-05-16 15:27:31 -0400] cilquirm: like if i have 2 files, one for "generic" and one for "debian" and put them as 2 attribute files, then they both get evaluated
[2013-05-16 15:27:37 -0400] paulmooring: well I'm not sure what you mean by funky state
[2013-05-16 15:27:49 -0400] paulmooring: but I use attributes files for a single default
[2013-05-16 15:28:01 -0400] paulmooring: and expect users (me) to over ride that default
[2013-05-16 15:28:40 -0400] cilquirm: but if you had standard defaults that differed from platform_family to platform_family ( like centos vs debian )
[2013-05-16 15:28:48 -0400] cilquirm: how do you break that up?
[2013-05-16 15:29:18 -0400] paulmooring: well, again just my opinion not enforced by Chef, but I take that as a sign it shouldn't be a default attribute
[2013-05-16 15:29:48 -0400] paulmooring: but I'm having a hard time picturing a case like that
[2013-05-16 15:30:12 -0400] cilquirm: well, i was trying to clean up https://github.com/bryanwb/chef-tomcat
[2013-05-16 15:31:17 -0400] cilquirm: so what happens there is that there is https://github.com/bryanwb/chef-tomcat/blob/master/recipes/package.rb
[2013-05-16 15:31:25 -0400] cilquirm: which sets all the values for debian  in the recipe
[2013-05-16 15:31:53 -0400] Cope_: ssd7: around yet?
[2013-05-16 15:32:02 -0400] Cope_: paulmooring: ah.... ping
[2013-05-16 15:32:07 -0400] Cope_: jessicab: or ping?
[2013-05-16 15:32:07 -0400] paulmooring: cilquirm: yep, that's sort of the common pattern
[2013-05-16 15:32:13 -0400] paulmooring: what's up Cope_ ?
[2013-05-16 15:32:33 -0400] paulmooring: cilquirm: you would rarely want package names to be attributes
[2013-05-16 15:32:41 -0400] Cope_: paulmooring: manage.opscode.com is giving application error 10000 , and has been for 1+ hr
[2013-05-16 15:32:47 -0400] paulmooring: generally just a case statement in the recipe with hardcoded names
[2013-05-16 15:33:19 -0400] s2r2: Cope_: tried registering with an email you already registered with?  (wild guess)
[2013-05-16 15:40:19 -0400] ssd7: Cope_: Looking into.  Doesn't look global but I do see a number of eceptions.
[2013-05-16 15:49:06 -0400] wamilton: what's the best way of managing a json file in chef? I'm thinking it may be worth it to use template just to reuse all of its functionality although the template would be just a comment and a hash_to_json...
[2013-05-16 15:55:01 -0400] djstunami: Hello all
[2013-05-16 15:57:29 -0400] djstunami: Does anyone know how to craft a partial_search query using the Chef Server API?  If I make a GET request to "/search/node" I get all the nodes, and all their attributes, when what I really want is just a small subset of attributes.
[2013-05-16 16:01:59 -0400] paulmooring: djstunami: here's a library a few of us use for that https://github.com/stevendanna/knife-psearch/blob/master/lib/chef/search/partial_search.rb
[2013-05-16 16:02:30 -0400] paulmooring: you can look through there for an example of the format or just use that library depending on what you want
[2013-05-16 16:05:29 -0400] cbarraford: n00b question: how do i change the number of retries chef-client makes when fails to pull a resouce. The default seems like 5.
[2013-05-16 16:14:44 -0400] cwj: cbarraford: see the "common functionality" section of http://docs.opscode.com/resource.html
[2013-05-16 16:15:49 -0400] stephenking: hi
[2013-05-16 16:16:14 -0400] stephenking: is there a way to remove a dependency of a community cookbook in my wrapper cookbook?
[2013-05-16 16:16:21 -0400] stephenking: (not through forking)
[2013-05-16 16:18:01 -0400] helllen: I am getting: Chef client  is running, will wait for it to finish and then run
[2013-05-16 16:18:10 -0400] helllen: but there is no chef-client proccess
[2013-05-16 16:18:13 -0400] helllen: what can I do ?
[2013-05-16 16:18:42 -0400] stephenking: helllen: check for the lock-file?
[2013-05-16 16:19:29 -0400] helllen: where is located ?
[2013-05-16 16:20:28 -0400] stephenking: dunno
[2013-05-16 16:21:04 -0400] stephenking: $file_cache_path/chef-client-running.pid
[2013-05-16 16:32:42 -0400] djstunami: paulmooring: thanks, I've looked through that, but it's been a few years since I did ruby, so I'm having some trouble imitating what it does
[2013-05-16 16:33:15 -0400] paulmooring: djstunami: the api enpoint is in the query_string variable
[2013-05-16 16:33:24 -0400] paulmooring: that's probably what you want
[2013-05-16 16:50:30 -0400] BryanWB_: how can i determine if my windows vm is running on top of virtualbox?
[2013-05-16 16:50:44 -0400] BryanWB_: node['virtualiation'] doens't exist :(
[2013-05-16 16:51:03 -0400] c_t: should it be node['virtualization']?
[2013-05-16 16:51:32 -0400] BryanWB_: c_t yes, i misspelled _that_ time
[2013-05-16 16:51:43 -0400] c_t: ya never know
[2013-05-16 16:52:03 -0400] c_t: could be worse though; I was battling with an intractable perl problem for a while yesterday
[2013-05-16 16:52:15 -0400] c_t: turned out unsetting $/ had... unintended consequences
[2013-05-16 16:55:36 -0400] djstunami: paulmooring: When I do a GET for /search/nodes (which is what I assume the query_string would be) I get everything (as expected), but from partial_search.rb it looks like I should be doing a post
[2013-05-16 16:56:14 -0400] djstunami: in order to restrict the attributes returned
[2013-05-16 16:56:41 -0400] paulmooring: yeah that's right, it's a POST
[2013-05-16 16:57:05 -0400] paulmooring: see line 49
[2013-05-16 16:58:12 -0400] djstunami: exactly! args[:keys] appears to be an array, but I'm not sure how that's converted when it's actually posted to the api
[2013-05-16 16:58:42 -0400] djstunami: or rather, the contents of args[:keys] appears to be an array
[2013-05-16 16:59:24 -0400] willejs: can anyone help me with this? http://pastebin.com/CH31wTck
[2013-05-16 16:59:36 -0400] willejs: when uploading the cookbook i get unexpected tASSOC, expecting keyword_end
[2013-05-16 16:59:43 -0400] ponyofdeath: hi, how can I prevent an cookbook from running based on certain criteria? ie prevent ntp client cookbook running on servers which are ntp masters etc..
[2013-05-16 16:59:47 -0400] willejs: on the line starting with :Elapsed
[2013-05-16 17:06:44 -0400] spox: BryanWB_: how about hacky and unreliable detection? node[:filesystem].flatten.detect{|x|x.to_s.downcase.include?('vboxsharedfolderfs')}
[2013-05-16 17:09:09 -0400] gleam: wawaweewa
[2013-05-16 17:10:08 -0400] juliankrause: Hello, I am trying to make a flow where I download a file using remote_file into the cache and then I want to declaratively say that this file over here should have the same content as the file I downloaded from the remote. I could execute a cp command but I was wondering if anyone else had an idea on how to do this?
[2013-05-16 17:12:25 -0400] jtimberman: juliankrause: what's the reason for making a copy? could you just make a symlink?
[2013-05-16 17:13:13 -0400] troyready: ponyofdeath, We do that sort of thing with condition checks inside the cookbook, or wrapper recipes with the condition checks
[2013-05-16 17:13:31 -0400] juliankrause: jtimberman: I would prefer to not have symlinks into a directory called cache.
[2013-05-16 17:19:47 -0400] miah: you could also just use the file resource method and specify that its source is ::File.join('', file_cache_dir, 'myfile')
[2013-05-16 17:21:00 -0400] miah: or you could just use remote_file to put the file into the spot you want it in the first place
[2013-05-16 17:21:46 -0400] juliankrause: miah: What file resource method with a source?
[2013-05-16 17:22:00 -0400] miah: http://docs.opscode.com/resource_file.html
[2013-05-16 17:22:29 -0400] juliankrause: That only has content, not source.
[2013-05-16 17:22:55 -0400] miah: then use cookbook_file
[2013-05-16 17:23:28 -0400] miah: content would work just as well but you'd have to load the file into a io object
[2013-05-16 17:25:13 -0400] ponyofdeath: tolland: i see thanks
[2013-05-16 17:25:22 -0400] ponyofdeath: troyready: ^
[2013-05-16 17:29:28 -0400] mattray: anyone have an example of using ChefSpec with roles?
[2013-05-16 17:31:20 -0400] jtimberman: mattray: aren't roles evil?
[2013-05-16 17:31:27 -0400] mattray: indeed they are
[2013-05-16 17:31:32 -0400] mattray: but they need testing too
[2013-05-16 17:31:44 -0400] sascha_d: one might posit they need MORE testing, to overcome their evil
[2013-05-16 17:33:02 -0400] miah: roles are not evil. quit saying it.
[2013-05-16 17:33:18 -0400] miah: instead, teach people _why_ they can be problematic.
[2013-05-16 17:33:19 -0400] mattray: miah: I agree, I was just joshing Joshua
[2013-05-16 17:33:29 -0400] mattray: or, trolilng a troll as it were
[2013-05-16 17:33:33 -0400] miah: i know, but people reading this channel are often seeking answers
[2013-05-16 17:33:56 -0400] miah: and there is a really stupid movement of "roles are bad, forget about DRY principles and write really bad wrappers"
[2013-05-16 17:33:58 -0400] anveo: How safe is the following comment, are there better options with Chef 11? http://tickets.opscode.com/browse/CHEF-2308?focusedCommentId=32211&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-32211
[2013-05-16 17:34:14 -0400] CharlieS2: Has anyone built tooling around Ubuntu's AMI finder to ensure you're alwasy using the latest one when bootstrapping ?
[2013-05-16 17:34:18 -0400] mattray: miah: agreed.
[2013-05-16 17:34:31 -0400] miah: anyways, im grumpy++ today. so i should refrain from speaking here much in the meantime.
[2013-05-16 17:34:39 -0400] jchauncey: so I'm trying to write a clojure lib for interacting with the chef api. and I'm getting a 401 back from /clients. I am using the pem for the machine i am on and that client's name for X-Ops-UserId. Is that what i should be doing or do i need to generate one for an actual user?
[2013-05-16 17:34:59 -0400] jtimberman: jchauncey: i believe the jclouds project has chef integration taht can be used in clojure
[2013-05-16 17:35:13 -0400] miah: http://palletops.com/doc/overview/
[2013-05-16 17:35:13 -0400] mattray: jchauncey: not sure the machine pem is allowed to look at /clients
[2013-05-16 17:35:16 -0400] jchauncey: yeah the clojure support really sucks =\
[2013-05-16 17:35:18 -0400] jtimberman: https://github.com/jclouds/jclouds-chef
[2013-05-16 17:35:23 -0400] jtimberman: :(
[2013-05-16 17:35:27 -0400] jtimberman: help improve it? :)
[2013-05-16 17:35:30 -0400] miah: check out pallet if clojure and ops is youre thing
[2013-05-16 17:35:45 -0400] jtimberman: miah: :)
[2013-05-16 17:35:52 -0400] jtimberman: miah: I totally love roles.
[2013-05-16 17:36:03 -0400] jtimberman: i was trolling mattray ;)
[2013-05-16 17:36:28 -0400] mattray: jtimberman: and since I love roles, we're really trolling the channel. So knock it off
[2013-05-16 17:36:36 -0400] jtimberman: ;)
[2013-05-16 17:37:01 -0400] jmartin: hah
[2013-05-16 17:37:16 -0400] mattray: so within the openstack cookbooks, there are helper methods that search on roles to find the nodes providing services
[2013-05-16 17:37:31 -0400] mattray: with Chef 10, ChefSpec could take a node.roles and append to it
[2013-05-16 17:37:36 -0400] mattray: not so much with Chef 11
[2013-05-16 17:37:52 -0400] jtimberman: mattray: a suggestion!
[2013-05-16 17:37:57 -0400] jtimberman: mattray: search for an attribute
[2013-05-16 17:39:30 -0400] mattray: jtimberman: hrmm so something like node['openstack']['identity']['provider'] = true ?
[2013-05-16 17:39:49 -0400] spheromak: setting an attribute is  latent thing tho. roles are not
[2013-05-16 17:39:58 -0400] spheromak: unless you set it in a role i guess
[2013-05-16 17:40:14 -0400] mattray: as opposed to the way we've been doing it, which is to search for the nodes with ['openstack']['role']['identity'] applied?
[2013-05-16 17:40:37 -0400] mattray: spheromak: it would be easy enough to make the roles apply the attribute
[2013-05-16 17:40:52 -0400] spheromak: yea
[2013-05-16 17:40:57 -0400] spheromak: i was just thinking outloud
[2013-05-16 17:40:58 -0400] spheromak: :)
[2013-05-16 17:41:18 -0400] spheromak: you can't stub the search in spec ?
[2013-05-16 17:41:35 -0400] jtimberman: mattray: yeah something like that.
[2013-05-16 17:42:06 -0400] mattray: spheromak: you can stub the search, you can't monkey around with node.roles
[2013-05-16 17:42:08 -0400] spheromak: matt what are you trying to solve ?
[2013-05-16 17:42:11 -0400] jtimberman: mattray: our rsyslog cookbook does a thing like this:
[2013-05-16 17:42:11 -0400] spheromak: yea
[2013-05-16 17:42:12 -0400] jtimberman: 25:default["rsyslog"]["server_search"]             = "role:loghost"
[2013-05-16 17:42:12 -0400] spheromak: ok
[2013-05-16 17:42:19 -0400] spheromak: so why you need to monkey with node.role ?
[2013-05-16 17:42:20 -0400] jtimberman: search(:node, node['rsyslog']['server_search'])
[2013-05-16 17:42:32 -0400] jtimberman: it used to do
[2013-05-16 17:42:54 -0400] mattray: spheromak: https://github.com/stackforge/cookbook-openstack-common/blob/master/spec/roles_spec.rb#L15 isn't legit with Chef 11
[2013-05-16 17:43:07 -0400] jtimberman: search(:node, "rsyslog_is_server:true"), where node['rsyslog']['is_server'] = true
[2013-05-16 17:43:19 -0400] jtimberman: , where not part of the query / code of course :)
[2013-05-16 17:43:27 -0400] mattray: jtimberman: we currently do search(:node, node['rsyslog']['server_search'])
[2013-05-16 17:43:41 -0400] mattray: but maybe search(:node, "rsyslog_is_server:true"), where node['rsyslog']['is_server'] = true is better
[2013-05-16 17:44:20 -0400] jtimberman: it was changed for some reason i cannot remember right now
[2013-05-16 17:44:20 -0400] spheromak: ugh personally i hate the "is_server" attribute stuff
[2013-05-16 17:44:29 -0400] spheromak: semlls to me
[2013-05-16 17:44:46 -0400] jtimberman: spheromak: why?
[2013-05-16 17:44:50 -0400] jtimberman: name it something else :)
[2013-05-16 17:44:56 -0400] mattray: spheromak: I prefer node['openstack']['identity']['provider'] = true
[2013-05-16 17:45:09 -0400] mattray: or service_provider
[2013-05-16 17:45:12 -0400] spheromak: jtimberman it compells a behavior of creteing foo_server roles
[2013-05-16 17:45:16 -0400] spheromak: where it should be "foo" IMO
[2013-05-16 17:45:25 -0400] jtimberman: wait
[2013-05-16 17:45:31 -0400] spheromak: should be something you can discover vs prescribe
[2013-05-16 17:45:34 -0400] jtimberman: are you pro search for role names?
[2013-05-16 17:45:59 -0400] jtimberman: apparently people are grumpy that we tell them what role names to use.
[2013-05-16 17:46:00 -0400] spheromak: im pro not having to tell something its a server or a master or a blah
[2013-05-16 17:46:06 -0400] mattray: jtimberman: that's the current approach, if we go to attribute search we can drop them completely
[2013-05-16 17:46:12 -0400] jtimberman: since naming things is the biggest bikeshed known to IT/CS :)
[2013-05-16 17:46:27 -0400] spheromak: yea
[2013-05-16 17:46:28 -0400] spheromak: indeed
[2013-05-16 17:46:36 -0400] jtimberman: i like having an attribute that says what query to use.
[2013-05-16 17:46:42 -0400] jtimberman: like the current rsyslog one
[2013-05-16 17:46:46 -0400] jchauncey: jtimberman: hmm i get a 401 on /nodes as well. ill take a look at pallet and see if they could work
[2013-05-16 17:46:47 -0400] jtimberman: seems "right"
[2013-05-16 17:46:49 -0400] spheromak: so my "smells" comment is just htat when we started ages ago I did alot of attrib  "is_server" stuff
[2013-05-16 17:46:51 -0400] mattray: which is why we have things like node['openstack']['role']['identity'] to search on
[2013-05-16 17:46:54 -0400] jtimberman: because if you hate that query, you can change it.
[2013-05-16 17:46:56 -0400] spheromak: and used searches to disover everything
[2013-05-16 17:47:02 -0400] spheromak: and well that has its own issues.
[2013-05-16 17:47:05 -0400] jtimberman: :)
[2013-05-16 17:47:10 -0400] jtimberman: stale search cache
[2013-05-16 17:47:16 -0400] spheromak: ended up having people maing many roles etc.  search issues. latency
[2013-05-16 17:47:25 -0400] spheromak: people then doing node.save after setting attribs
[2013-05-16 17:47:31 -0400] spheromak: so that the search would work latter in the run
[2013-05-16 17:47:32 -0400] spheromak: etc etc
[2013-05-16 17:47:42 -0400] spheromak: so it just smells to me because of all these side effects form that decision
[2013-05-16 17:48:27 -0400] mattray: spheromak: this sounds like it's going to need a whole new thread over on the Chef OpenStack mailing list :(
[2013-05-16 17:48:38 -0400] spheromak: matt lol
[2013-05-16 17:48:46 -0400] spheromak: thats the bikeshed supreme
[2013-05-16 17:49:02 -0400] spheromak: I commend you for trying to stay calm and carry on :)
[2013-05-16 17:49:03 -0400] mattray: I prefer the attribute approach, less stuff to put into the environments
[2013-05-16 17:49:09 -0400] spheromak: yea
[2013-05-16 17:49:16 -0400] spheromak: well are these attribs in roles then ?
[2013-05-16 17:49:17 -0400] spheromak: :D
[2013-05-16 17:50:16 -0400] spheromak: mattray: i prefer we get something shipped. and itterate :)
[2013-05-16 17:50:30 -0400] jtimberman: put the attributes where you want to set them.
[2013-05-16 17:50:41 -0400] mattray: spheromak: worse, they're in the cookbook and surface in the Environment if they need to be overridden
[2013-05-16 17:51:05 -0400] spheromak: ok so thats an issue right ?
[2013-05-16 17:51:13 -0400] spheromak: if its in the cook it wont be sarchable to iend of run
[2013-05-16 17:51:17 -0400] spheromak: *end
[2013-05-16 17:51:27 -0400] spheromak: ok if the cook isn't searching against attribs it sets.
[2013-05-16 17:51:48 -0400] mattray: spheromak: yeah, you usually aren't searching for the identity role if you're the identity box
[2013-05-16 17:51:54 -0400] spheromak: yea
[2013-05-16 17:52:05 -0400] mattray: but it's an extra layer of cruft for sure.
[2013-05-16 17:52:08 -0400] mattray: add it to the yak pile
[2013-05-16 17:52:11 -0400] spheromak: yeap
[2013-05-16 17:52:28 -0400] spheromak: just as long as we don't start peppering node.save's to ensure state (shiver)
[2013-05-16 17:52:35 -0400] jtimberman: node.save is cool!
[2013-05-16 17:52:36 -0400] mattray: no, we shouldn't need that
[2013-05-16 17:52:51 -0400] spheromak: jtimberman easiest way to fuck a chef server :D
[2013-05-16 17:52:54 -0400] jtimberman: unless you're not setting passwords via some random means.
[2013-05-16 17:53:06 -0400] mattray: in my chef-openstack-repo I have a technical-debt.org file
[2013-05-16 17:53:10 -0400] spheromak: hahaa
[2013-05-16 17:53:16 -0400] spheromak: best idea ever
[2013-05-16 17:53:30 -0400] jtimberman: mattray: http://tickets.opscode.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+COOK+AND+status+%3D+Open+ORDER+BY+priority+DESC&mode=hide
[2013-05-16 17:53:37 -0400] jtimberman: that's my technical debt file ;)
[2013-05-16 17:54:02 -0400] mattray: that's what happened when we voted you "King of Sysadmins"
[2013-05-16 17:54:59 -0400] awgross: anyone have any strong opinions on whether to inject Utility libraries directly into Chef Resources/Recipes/Providers vs requiring them to be called via MyModule::Util.my_method style?
[2013-05-16 17:55:00 -0400] jtimberman: I'm not ambitious enough to live up to that title ;)
[2013-05-16 17:55:19 -0400] jtimberman: awgross: i think making them a module
[2013-05-16 17:55:21 -0400] jtimberman: is right
[2013-05-16 17:55:37 -0400] jtimberman: because what if two cookbooks both inject a utility method that has the same name
[2013-05-16 17:55:37 -0400] awgross: jtimberman: i have them in a module atm, just a question of the best way to get them accessible
[2013-05-16 17:55:48 -0400] awgross: im really scared of injecting them directly due to namespace conflicts
[2013-05-16 17:56:03 -0400] awgross: too easy to cause obscure and hard to debug problems
[2013-05-16 17:56:10 -0400] spheromak: awgros module is better. namespaces are good. I've moved away from injecting module methods into resources wherever possible
[2013-05-16 17:56:22 -0400] awgross: esp in thinks like LWRPs where most poeple dont know what its compiling into
[2013-05-16 17:56:25 -0400] awgross: fair enough
[2013-05-16 17:56:26 -0400] awgross: thanks all
[2013-05-16 17:56:43 -0400] spheromak: awgross also in chef 11 you can mixin most of the stuff you might need with chef
[2013-05-16 17:57:02 -0400] spheromak: and pass your class the current node obj/run_context
[2013-05-16 17:57:18 -0400] spheromak: also makes testing/specs way simpler to write :)
[2013-05-16 17:57:30 -0400] awgross: yeah im trying to tdd the utility methods
[2013-05-16 17:57:42 -0400] awgross: going to get more complex once i start working with search stuff
[2013-05-16 17:57:47 -0400] jtimberman: awgross: i *just* did that w/ java :)
[2013-05-16 17:57:52 -0400] awgross: haha
[2013-05-16 17:57:59 -0400] jtimberman: java cookbook, not actual java code.
[2013-05-16 17:58:04 -0400] awgross: heaven forbid
[2013-05-16 17:58:32 -0400] jtimberman: awgross: https://github.com/opscode-cookbooks/java/blob/master/libraries/helpers.rb and https://github.com/opscode-cookbooks/java/blob/master/spec/libraries/helpers_spec.rb
[2013-05-16 17:59:26 -0400] spheromak: awgross https://github.com/opscode/chef/blob/master/lib/chef/dsl/data_query.rb
[2013-05-16 17:59:28 -0400] spheromak: :)
[2013-05-16 17:59:35 -0400] spheromak: actually not bad at all
[2013-05-16 18:00:38 -0400] awgross: spheromak: im not so worried about mocking the actual methods, more concerned about how I can reuse the same fixtures across tests to make it easy to update data
[2013-05-16 18:01:07 -0400] awgross: spheromak: i would prefer to capture the JSON api response and feed that in to create the real object
[2013-05-16 18:01:14 -0400] BryanWB_: spox: lol
[2013-05-16 18:01:14 -0400] awgross: and just store the fixture with the code
[2013-05-16 18:01:23 -0400] BryanWB_: spheromak: hey buddy!
[2013-05-16 18:01:24 -0400] awgross: instead of keeping some hacky mocks in the tests
[2013-05-16 18:01:34 -0400] awgross: but thats for the pointer to the methods
[2013-05-16 18:02:07 -0400] spheromak: sup bryanWB
[2013-05-16 18:02:10 -0400] spheromak: :)
[2013-05-16 18:02:35 -0400] spheromak: awgross yea i have hacky mocks, but im a tdd nub
[2013-05-16 18:02:49 -0400] awgross: i just started learning
[2013-05-16 18:03:11 -0400] awgross: foudn a few tutorials for TDDing API clients
[2013-05-16 18:03:14 -0400] awgross: now trying to apply it to chef
[2013-05-16 18:03:45 -0400] awgross: most of my terror comes from trying to update the Chef tests when adding new features for PR
[2013-05-16 18:03:52 -0400] awgross: it gets hairy
[2013-05-16 18:04:20 -0400] spheromak: yea
[2013-05-16 18:04:30 -0400] spheromak: why with my cooks and stuff i tend to stay outta mixing in
[2013-05-16 18:04:39 -0400] spheromak: easier to spec out your classes in isolation
[2013-05-16 18:05:12 -0400] spheromak: but i've also fell into making all my helpers singletons from this line of though.
[2013-05-16 18:05:15 -0400] spheromak: *thought.
[2013-05-16 18:06:05 -0400] awgross: yeah just running in to that problem now
[2013-05-16 18:06:19 -0400] awgross: atm they are not classes, just methods inside modules
[2013-05-16 18:06:31 -0400] awgross: well see how far ruby lets me go with that line of thought
[2013-05-16 18:08:44 -0400] spheromak: BryanWB ho goes the big cluster building ?
[2013-05-16 18:12:45 -0400] spheromak: mattray:  with that setting the role inthe test couldn't you set that run_list up in a before blockon that test ? instead of trying to muck with the run instance
[2013-05-16 18:13:24 -0400] BryanWB_: spheromak: good
[2013-05-16 18:13:30 -0400] mattray: spheromak: yeah, but it looks like you need to have a real role for the converge
[2013-05-16 18:13:40 -0400] BryanWB_: except for this annoying dalliance w/ windoze :(
[2013-05-16 18:13:58 -0400] mattray: spheromak: which is why I was looking to see if anyone had done it before
[2013-05-16 18:14:07 -0400] mattray: spheromak: which kicked off the whole discussion :)
[2013-05-16 18:14:54 -0400] BryanWB_: anybody know why i get a value for node['virtualization']  when running on linux on vbox but not w/ windows?
[2013-05-16 18:15:31 -0400] mattray: BryanWB_: sounds like an ohai bug
[2013-05-16 18:15:39 -0400] mattray: or a vbox on windows bug
[2013-05-16 18:15:44 -0400] BryanWB_: mattray: yup
[2013-05-16 18:16:07 -0400] BryanWB_: when i do   c:\ ohai | less     i c nothing about virtualization
[2013-05-16 18:17:09 -0400] spheromak: hrm
[2013-05-16 18:18:08 -0400] spheromak: gues syou would look at the registry or network drivers for vbox host stuff ?
[2013-05-16 18:23:09 -0400] isotope1: has something about bootstraping a chef server changed recently
[2013-05-16 18:23:32 -0400] isotope1: It worked last week and since a gem update its failing with an invalid error
[2013-05-16 18:24:13 -0400] spheromak: isotoep1 post a gist/pastie of the error ?
[2013-05-16 18:24:57 -0400] isotope1: https://gist.github.com/dodizzle/5593895
[2013-05-16 18:25:35 -0400] isotope1: it creates the security group but then complains it doesn't exist
[2013-05-16 18:26:04 -0400] isotope1: this is the run when the group already exists
[2013-05-16 18:26:04 -0400] isotope1: https://gist.github.com/dodizzle/5593899
[2013-05-16 18:27:27 -0400] sanguisdex: when I include the git cookbook  in my runlist it tell me that I am missing the dmg required cookbook.  but I am running it in a ubuntu box, why would I want dmg at all?
[2013-05-16 18:27:54 -0400] coderanger: sanguisdex: Cookbooks don't have optional deps
[2013-05-16 18:28:08 -0400] coderanger: so we set deps on all possible required cookbooks
[2013-05-16 18:28:13 -0400] coderanger: but they won't be used
[2013-05-16 18:28:29 -0400] coderanger: same reason so many things depend on the window cookbook
[2013-05-16 18:28:48 -0400] coderanger: Just use Berkshelf to manage deps and you'll never notice anyway :)
[2013-05-16 18:29:25 -0400] jmartin: coderanger: that reminds me, i need to clean up my workflow entirely :-/
[2013-05-16 18:29:39 -0400] jmartin: www.berkshelf.com
[2013-05-16 18:31:28 -0400] coderanger: sanguisdex: What language do you generally use, I can tailor my metaphors a bit :)
[2013-05-16 18:32:22 -0400] sanguisdex: coderanger: what do you mean programming langage, or spoken?
[2013-05-16 18:32:30 -0400] coderanger: programming
[2013-05-16 18:32:37 -0400] sanguisdex: php
[2013-05-16 18:33:30 -0400] coderanger: Berkshelf is comparable to Composer
[2013-05-16 18:34:18 -0400] sanguisdex: kay
[2013-05-16 18:35:33 -0400] miah: yay programming analogies
[2013-05-16 18:35:37 -0400] sanguisdex: coderanger: unless you mean netscape composer, I don't know what that is, but I know what a package manager is
[2013-05-16 18:36:10 -0400] coderanger: I thought composer was the current iteration of PHP package managers after everyone realized Pear was a nightmare
[2013-05-16 18:36:50 -0400] whack: I think knife bootstrap has gone hooribly wrong. https://gist.github.com/jordansissel/4f368969bfc2aaceedc4 - known issue?
[2013-05-16 18:37:19 -0400] sanguisdex: coderanger: I still live that nightmare
[2013-05-16 18:37:29 -0400] miah: whack: do you have a weird loglevel specified?
[2013-05-16 18:37:52 -0400] coderanger: whack: I see ancient Chef and non-omnibus Ruby ... :)
[2013-05-16 18:38:06 -0400] whack: miah: I'm not specifying such a thing to my knowledged ;)
[2013-05-16 18:38:17 -0400] whack: coderanger: I'm just doing 'knife bootstrap' - send medical assitance ;)
[2013-05-16 18:38:27 -0400] whack: technically 'knife bootstrap -x root -E prod <some ip>'
[2013-05-16 18:38:28 -0400] coderanger: whack: Upgrade you chef-gem
[2013-05-16 18:38:32 -0400] coderanger: (locally I mean)
[2013-05-16 18:38:54 -0400] whack: 11.4.4 is ancient? hmm
[2013-05-16 18:39:01 -0400] miah: chef-0.10.2
[2013-05-16 18:39:04 -0400] miah: ^- from the log output
[2013-05-16 18:39:25 -0400] whack: confusing. back to bootstrapping going wrong ;)
[2013-05-16 18:39:33 -0400] coderanger: Yeah, also check that you don't have a custom bootstrap script/override specified
[2013-05-16 18:39:39 -0400] miah: so its very possible that the template you're using is doing something special
[2013-05-16 18:39:48 -0400] whack: I don't know of any template.
[2013-05-16 18:40:00 -0400] coderanger: Look in .chef/ ~/.chef
[2013-05-16 18:40:15 -0400] coderanger: Folder would be bootstrap/ within that
[2013-05-16 18:40:30 -0400] miah: also just look at your knife.rb and make sure nothing is weird for your loglevel
[2013-05-16 18:40:36 -0400] coderanger: Yahr, that too
[2013-05-16 18:41:19 -0400] whack: so, how do I make bootstrap install omnibus chef?
[2013-05-16 18:41:29 -0400] coderanger: It should be the default
[2013-05-16 18:41:50 -0400] coderanger: Unless you have a knife[:distro] in your knife.rb
[2013-05-16 18:42:17 -0400] coderanger: also check knife --version
[2013-05-16 18:42:35 -0400] whack: nope (log_level :info, no :distro setting)
[2013-05-16 18:42:38 -0400] whack: version is 11.4.4
[2013-05-16 18:42:47 -0400] whack: I think the issue is that chef is already installed as a gem on the target system
[2013-05-16 18:43:01 -0400] whack: this is a shared tenancy system (a dedicated server in a hosting provider)
[2013-05-16 18:43:10 -0400] coderanger: Ahh, that would indeed confuse things
[2013-05-16 18:43:19 -0400] whack: I don't know who installed chef in this location, but I want omnibus
[2013-05-16 18:43:25 -0400] whack: seems like it checks if chef exists and uses whatever's there
[2013-05-16 18:43:29 -0400] whack: it == bootstrap
[2013-05-16 18:43:40 -0400] coderanger: Yahr, to protect against double-bootstraps
[2013-05-16 18:43:41 -0400] whack: 'gem list chef' on the target server says chef 0.10.2
[2013-05-16 18:43:52 -0400] coderanger: Easiest solution is gem uninstall
[2013-05-16 18:43:53 -0400] whack: recommendations?
[2013-05-16 18:44:24 -0400] whack: coderanger: I'm not 100% sure that's the correct solution here
[2013-05-16 18:44:30 -0400] coderanger: Having two installs of chef client is usually ungood, you can do it but you have to be very careful to not overlap config files
[2013-05-16 18:44:33 -0400] whack: given I don't know if the customer installed this and is possibly using chef solo?
[2013-05-16 18:45:06 -0400] whack: will ask internally to see wtf is going on ;)
[2013-05-16 18:45:09 -0400] coderanger: Hmm, so the other road would be the grab the deb/rpm for your platform and install manually, and then setup an /etc/chef2 or something
[2013-05-16 18:45:33 -0400] coderanger: and just always specific a manual -c /etc/chef2/client.rb
[2013-05-16 18:45:33 -0400] paigeat: hey guys this is something I came across awhile ago and wrote a hack solution for, https://github.com/connectxyz/ohai/blob/master/files/default/plugins/changeDefaultIPInNodeData.rb#L2 I'd like to be able to specify 'eth0' in an environment override and read it from the environment overrides in this ohai plugin but I haven't been able to find a way... is there away?
[2013-05-16 18:46:27 -0400] coderanger: paigeat: Do you mean as in chef environment attribute override, or Unix env var?
[2013-05-16 18:46:27 -0400] whack: coderanger: ok cool, clarity from the inside says this is safe to uninstall
[2013-05-16 18:46:29 -0400] paigeat: I guess its not that big of a deal if I have to hardcode 'eth0' there for my purposes but I'd like to use environment overrides if possible or something
[2013-05-16 18:46:31 -0400] eph3meral: anyone have some recommended practices/guidelines for installing a database?
[2013-05-16 18:46:31 -0400] whack: confusion resolved :)
[2013-05-16 18:46:39 -0400] paigeat: chef environment attribute
[2013-05-16 18:46:41 -0400] jtoft: I'm trying to get the omnibus chef-server install working, however when I get to chef-server-ctl reconfigure; chef-server-ctl test
[2013-05-16 18:46:49 -0400] jtoft: it reconfigures properly, but all of the search tests fail
[2013-05-16 18:46:52 -0400] jtoft: Centos 6
[2013-05-16 18:46:55 -0400] paigeat: something that could be changed via the webui by an admin instead of having to change the code
[2013-05-16 18:46:56 -0400] jtoft: Anyone have ideas?
[2013-05-16 18:46:58 -0400] eph3meral: like lets say on staging, we want to just duplicate the prod database so that when we test the code we can be testing on "realistic" data
[2013-05-16 18:47:07 -0400] sabooky: chef-solo seems to parse all attribute files (including non-default.rb and from cookbooks that aren't in the run_list), any way to avoid this?
[2013-05-16 18:47:07 -0400] coderanger: paigeat: don't think you can, ohai is designed to be kind of standalone from chef itself
[2013-05-16 18:47:10 -0400] sabooky: How do I have a library cookbook define one set of defaults, and use a application cookbook to override attributes.. since they're all parsed, my attributes are all getting mangled..
[2013-05-16 18:47:10 -0400] eph3meral: I mean, usually as an individual, I would just scp my SQL dump
[2013-05-16 18:47:14 -0400] eph3meral: then import it through SSH
[2013-05-16 18:47:15 -0400] jtoft: 500 Internal Server Error for each
[2013-05-16 18:47:16 -0400] paigeat: coderanger: *nod*
[2013-05-16 18:47:19 -0400] coderanger: paigeat: You could make a custom ohai plugin templated on node attrs
[2013-05-16 18:47:24 -0400] eph3meral: is there any better/more-recommended way to do it than this?
[2013-05-16 18:47:52 -0400] coderanger: sabooky: What version of Chef?
[2013-05-16 18:48:00 -0400] paigeat: coderanger: the way I had done it before was to generate this ohai plugin from an erb file and I had made a quick hack in the default.rb recipe of the ohai cookbook but I'm thinking maybe that would be a good thing to finish up nice and send as a pull request
[2013-05-16 18:48:11 -0400] coderanger: eph3meral: Just write execute resources for whatever you would do by hand?
[2013-05-16 18:48:24 -0400] avishai: yo!
[2013-05-16 18:48:25 -0400] coderanger: eph3meral: It is pretty common to have data restore handled outside of Chef though
[2013-05-16 18:48:38 -0400] coderanger: paigeat: Nah, thats how I would do it too :)
[2013-05-16 18:48:39 -0400] avishai: here to discuss ohai rackspace plugin
[2013-05-16 18:48:43 -0400] avishai: any takers?
[2013-05-16 18:48:56 -0400] sabooky: coderanger: 10.24.0
[2013-05-16 18:49:01 -0400] eph3meral: coderanger: ahh, ok, is it reasonably recommendable to do it "inside" of chef?
[2013-05-16 18:49:11 -0400] coderanger: avishai: Ask your question, if anyone can answer they will
[2013-05-16 18:49:24 -0400] eph3meral: for example, my task is that I need to be able to have (roughly) a "single command" to bootstrap a staging server from the ground up
[2013-05-16 18:49:27 -0400] coderanger: eph3meral: Eh, depends on the size of the dataset, and what kind of security precautions you want
[2013-05-16 18:49:33 -0400] ErebusBat: Where do I file a bug for the windows client msi
[2013-05-16 18:49:34 -0400] ErebusBat: ??
[2013-05-16 18:49:39 -0400] eph3meral: security isn't the biggest deal, we'll put it behind a firewall
[2013-05-16 18:49:43 -0400] eph3meral: firewall/vpn
[2013-05-16 18:49:47 -0400] sabooky: coderanger: Does chef 11.X solve this issue? Basically having a generic say "jboss" cookbook, then a more "myapp::jboss" cookbook that configures jboss just for my app
[2013-05-16 18:49:51 -0400] coderanger: eph3meral: For most of our cases, servers aren't allowed access to the data backups in case one of them is compromised
[2013-05-16 18:50:00 -0400] coderanger: So a human has to do that step using our own creds
[2013-05-16 18:50:04 -0400] eph3meral: size can be hefty-ish for file transfer, around the undreds of megs mark
[2013-05-16 18:50:19 -0400] coderanger: sabooky: Yahr, chef 11 brought solo much more in line with chef-client
[2013-05-16 18:50:23 -0400] eph3meral: coderanger: eh, that's fine, I can make a place that's not backups, that's just dumps for this purpose only
[2013-05-16 18:50:25 -0400] avishai: coderanger, its not a question. i need consulting
[2013-05-16 18:50:28 -0400] sabooky: coderanger: Currently a lot of the settings are in node[:mycontainer]   and myapp was overrideing that.
[2013-05-16 18:50:36 -0400] avishai: coderanger, i'm working on fixing rackspace support in ohai
[2013-05-16 18:50:39 -0400] whack: coderanger, miah: apt-get purge libchef-rubygem fixes that silly issue I was having (ancient chef making bootstrap unhappy)
[2013-05-16 18:50:40 -0400] avishai: or lack thereof
[2013-05-16 18:50:47 -0400] whack: onwards to bootstrapping 1100 servers
[2013-05-16 18:50:49 -0400] eph3meral: I figured maybe I should just put the dump out there on an EBS or something and then wget the thing
[2013-05-16 18:51:00 -0400] coderanger: avishai: Not sure what you mean, if you want to reach Opscode customer support, please email support@opscode.com
[2013-05-16 18:51:12 -0400] coderanger: whack: \o/
[2013-05-16 18:51:22 -0400] sabooky: coderanger: So what's the best way to deal with a lot of node[:mycontainer] attributes, and having different applications inherit/modify that?
[2013-05-16 18:51:30 -0400] coderanger: eph3meral: Sounds entirely reasonable to me, check out the s3_file resource too :)
[2013-05-16 18:51:51 -0400] avishai: coderanger, i'm adding rackspace support to the plugin
[2013-05-16 18:51:54 -0400] coderanger: sabooky: Put each apps settings in their own tree
[2013-05-16 18:52:01 -0400] avishai: don't need customer support
[2013-05-16 18:52:14 -0400] coderanger: avishai: Okay, that sounds good, just submit a pull request when its ready and we'll take a look :)
[2013-05-16 18:52:29 -0400] sabooky: coderanger: I can rewrite the cookbooks to use definitions/lwrp and have everything passed in as a parameter, but I feel this solution isn't very dry, lots of similar node[:myappA][:setting1]   node[:myappB][:setting1]
[2013-05-16 18:52:32 -0400] coderanger: avishai: Still not sure what kind of assistance you are asking for
[2013-05-16 18:52:41 -0400] avishai: advise
[2013-05-16 18:52:48 -0400] eph3meral: coderanger: k will do thanks
[2013-05-16 18:52:51 -0400] sabooky: coderanger: Sounds good, how does one keep common settings without repeating oneself?
[2013-05-16 18:53:00 -0400] avishai: the current situation is there are a ton of bugs about this
[2013-05-16 18:53:01 -0400] coderanger: sabooky: I would do something like node[:myapp][:setting1] || node[:shared][:setting1]
[2013-05-16 18:53:11 -0400] avishai: and a horde of detection methods
[2013-05-16 18:53:23 -0400] sabooky: coderanger: ...
[2013-05-16 18:53:32 -0400] avishai: the question is do i get rid of the lot of them
[2013-05-16 18:53:37 -0400] sabooky: coderanger: so simple.. I feel dumb now, thanks!
[2013-05-16 18:53:38 -0400] avishai: or leave them as fallback
[2013-05-16 18:54:12 -0400] sabooky: coderanger: I'll play around with the "||" solution, makes a lot of sense.
[2013-05-16 18:54:13 -0400] coderanger: avishai: That all depends on Rackspace, we need to support all generations of their cloud servers
[2013-05-16 18:54:24 -0400] kallen: moryang
[2013-05-16 18:54:26 -0400] coderanger: avishai: And things changed a lot as they migration to stock OpenStack
[2013-05-16 18:54:27 -0400] kallen: gah. mischan
[2013-05-16 18:55:26 -0400] whack: is there a way to set environment variables used on the remote host with knife bootstrap? I need to set GEM_HOME and GEM_PATH to avoid the system crap.
[2013-05-16 18:55:37 -0400] sabooky: coderanger: Regarding chef 11.X any major improvements? ("must have" reasons to upgrade)
[2013-05-16 18:55:43 -0400] eph3meral: coderanger: oh something else I noticed, do you know/work much with hosted chef
[2013-05-16 18:55:50 -0400] coderanger: whack: Unfortunately not without copy-pasta the whole bootstrap template :(
[2013-05-16 18:55:53 -0400] eph3meral: might not be hosted chef specific (in fact I would wager it's not)
[2013-05-16 18:55:56 -0400] whack: coderanger: that's fine I suppose
[2013-05-16 18:55:58 -0400] eph3meral: it's probably my PEBKAC
[2013-05-16 18:56:04 -0400] whack: coderanger: will start there
[2013-05-16 18:56:07 -0400] coderanger: eph3meral: I work for Opscode, so yes :)
[2013-05-16 18:56:13 -0400] eph3meral: but still - I can't get setting overrides to work in roles
[2013-05-16 18:56:19 -0400] eph3meral: I got it to work in an environment
[2013-05-16 18:56:46 -0400] eph3meral: specifically I'm overriding "postgresql": { "pg_hba": [ so that I don't need passwords to log in
[2013-05-16 18:56:50 -0400] coderanger: whack: you can just copy it to .chef/bootstrap/dh-omnibus.erb or something, and set knife[:distro] in your .chef/knife.r
[2013-05-16 18:56:51 -0400] whack: coderanger: can I override the default templates? Lots of OS versions being bootstrapped
[2013-05-16 18:56:55 -0400] eph3meral: (these are technically just dev servers, essentially)
[2013-05-16 18:56:57 -0400] whack: ok cool
[2013-05-16 18:57:12 -0400] eph3meral: I'm not sure how to explain "doesn't work" as I know that's quite vague
[2013-05-16 18:57:30 -0400] coderanger: whack: See https://github.com/coderanger/psf-chef/tree/master/.chef for an example :)
[2013-05-16 18:57:48 -0400] paigeat: in a recipe, is there a way to get a quick file list of all the templates in the templates/default directory?
[2013-05-16 18:57:54 -0400] coderanger: eph3meral: Can you pastebin the role?
[2013-05-16 18:57:59 -0400] coderanger: paigeat: No
[2013-05-16 18:58:07 -0400] eph3meral: all i can say is that I have the exact same overrides in my role and my environment, when i -r "role[mydevdemostagingserver]" the overrides do not get applied (as evidenced when I vim /etc/postgresql/.../pg_hba.conf) but when I do this with an environment, the file is updated correctly
[2013-05-16 18:58:21 -0400] coderanger: paigeat: They are only transferred on-demand, so they don't exist until requested
[2013-05-16 18:58:27 -0400] eph3meral: coderanger: not 100% sure how to do that, do I need to knife role edit foo -e vim ?
[2013-05-16 18:58:29 -0400] paigeat: coderanger: oh shit
[2013-05-16 18:58:40 -0400] paigeat: haha
[2013-05-16 18:58:49 -0400] sethvargo: @martinisoft someone in #berkshelf is asking about the rvm cookbook
[2013-05-16 18:58:52 -0400] eph3meral: for some reason I have to use terminal vim, I can't use the gui form of macvim because it just returns immediately with no changes and I get a black file
[2013-05-16 18:59:03 -0400] coderanger: paigeat: You could use the Chef API to get the cookbook metadata, but thats a deep rabbit hole
[2013-05-16 18:59:07 -0400] eph3meral: but if I do that in the terminal with -e vim I get the JSON for the object in question and I can edit/change it
[2013-05-16 18:59:14 -0400] coderanger: eph3meral: knife role show <name>
[2013-05-16 18:59:16 -0400] eph3meral: but so far I've been just editing through the web interface for hosted chef
[2013-05-16 18:59:17 -0400] martinisoft: sethvargo: ah, totally forgot about that channel, on it!
[2013-05-16 18:59:19 -0400] eph3meral: k
[2013-05-16 18:59:22 -0400] coderanger: eph3meral: and then copy that to a pastebin site
[2013-05-16 19:03:41 -0400] jtoft: oh, awesome
[2013-05-16 19:03:41 -0400] jtoft: got it
[2013-05-16 19:03:42 -0400] jtoft: nevermind
[2013-05-16 19:04:20 -0400] nicgrayson: sethvargo: does this method of using strainer still work https://github.com/acrmp/chefspec/wiki/Berkshelf-and-ChefSpec ?
[2013-05-16 19:05:08 -0400] nicgrayson: i'm having trouble getting strainer to work and it's not spitting out any output
[2013-05-16 19:05:40 -0400] sethvargo: @nicgrayson should
[2013-05-16 19:05:42 -0400] sethvargo: what's not would
[2013-05-16 19:05:53 -0400] sethvargo: i have office hours for the next two hours, but I can hop on a call after
[2013-05-16 19:06:28 -0400] nicgrayson: sethvargo: that would be awesome
[2013-05-16 19:06:41 -0400] paigeat: coderanger: https://github.com/connectxyz/ohai/commit/0f9af02d119004e5aec3778968f0c16dbac3e358
[2013-05-16 19:06:44 -0400] sethvargo: Ping me on twitter in 2 h
[2013-05-16 19:06:49 -0400] nicgrayson: k
[2013-05-16 19:07:03 -0400] paigeat: "yuck"
[2013-05-16 19:07:04 -0400] paigeat: lol
[2013-05-16 19:07:06 -0400] btm: @opscode #opschef code review join: bit.ly/11HYAyg, watch: bit.ly/11HYzug
[2013-05-16 19:07:12 -0400] btm: also, omgf google hangouts stop changing.
[2013-05-16 19:07:20 -0400] paigeat: btm: lol
[2013-05-16 19:07:38 -0400] paigeat: im off to lunch
[2013-05-16 19:09:17 -0400] paigeat: I need to add some colescing to that template in case that node data doesn't exist so it doesnt fuck up ohai the first time it runs
[2013-05-16 19:09:33 -0400] btm: apparently youtube is horrible. you can join but not watch.
[2013-05-16 19:09:44 -0400] paigeat: or does ohai run once on its own before running any plugins? if it does thats fine
[2013-05-16 19:10:05 -0400] jtoft: trying to migrate to chef 11: Any idea why knife upload / -VV would show: undefined method `create_url' for ChefFS::RawRequest:Module ?
[2013-05-16 19:10:50 -0400] jtoft: using chef 11.4.4 and knife essentials 0.9.8
[2013-05-16 19:11:34 -0400] avishai: coderanger, should i open a new bug or just reopen previos bugs?
[2013-05-16 19:12:15 -0400] nicgrayson: sethvargo: i figured it out, i had 1.0.0 installed for some reason
[2013-05-16 19:12:26 -0400] sethvargo: @nicgrayson ahhh okay
[2013-05-16 19:12:33 -0400] whack: coderanger: successfully in progress bootstrapping the fleet. Thanks for the pointer at bout bootstrap templates
[2013-05-16 19:13:37 -0400] jtoft: SSL cert problem
[2013-05-16 19:13:38 -0400] jtoft: awesome
[2013-05-16 19:13:47 -0400] coderanger: avishai: I would open a new bug, but you would have to prove very exhaustively that old hacks aren't needed anymore
[2013-05-16 19:14:07 -0400] coderanger: avishai: I can get you in contact with Rackspace dev support if you would like
[2013-05-16 19:14:13 -0400] xtristan: jtoft: what kind of SSL cert problem and what else was in the error vomit stream
[2013-05-16 19:14:35 -0400] jtoft: josh@atla: ~/transfer> curl https://chef.nessops.net:80/clients
[2013-05-16 19:14:35 -0400] coderanger: avishai: They can probably provide more details than I about how to detect if you are on a rackspace machine
[2013-05-16 19:14:35 -0400] jtoft: curl: (35) error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol
[2013-05-16 19:14:49 -0400] jtoft: basically
[2013-05-16 19:14:52 -0400] jtoft: slowly getting it going
[2013-05-16 19:14:54 -0400] coderanger: jtoft: lulz
[2013-05-16 19:14:56 -0400] xtristan: uhhh
[2013-05-16 19:14:58 -0400] jtoft: think this is the last one
[2013-05-16 19:15:05 -0400] xtristan: https:// -- 80 and unknown proto
[2013-05-16 19:15:08 -0400] coderanger: jtoft: https + :80 ...
[2013-05-16 19:15:08 -0400] xtristan: what the fudge
[2013-05-16 19:15:19 -0400] jtoft: josh@atla: ~/transfer> curl https://chef.nessops.net/clients
[2013-05-16 19:15:19 -0400] jtoft: curl: (60) SSL certificate problem, verify that the CA cert is OK. Details:
[2013-05-16 19:15:20 -0400] jtoft: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
[2013-05-16 19:15:21 -0400] jtoft: More details here: http://curl.haxx.se/docs/sslcerts.html
[2013-05-16 19:15:52 -0400] xtristan: just use http, information wants to be free
[2013-05-16 19:17:31 -0400] doomviking: information would rather be encrypted
[2013-05-16 19:17:40 -0400] xtristan: bollocks
[2013-05-16 19:17:56 -0400] xtristan: i don't lock my doors at my apartment.  TVs, couches, and computers want to be free
[2013-05-16 19:19:24 -0400] xtristan: jtoft: do you get the same error if you open the mcrib ruby console and try to access it via the proper port? (e.g. test = Net::HTTP.new('chef.nessops.net',443) ?
[2013-05-16 19:19:54 -0400] coderanger: No, we don't validate SSL certs on our side
[2013-05-16 19:20:04 -0400] coderanger: (though I'm grumpy about that)
[2013-05-16 19:20:11 -0400] xtristan: Hmph.
[2013-05-16 19:20:19 -0400] xtristan: coderanger: i don't know who you are because you're not in my twitters
[2013-05-16 19:20:31 -0400] coderanger: xtristan: me == @kantrn
[2013-05-16 19:20:35 -0400] coderanger: or coderanger on github
[2013-05-16 19:20:57 -0400] xtristan: oh word, followed.
[2013-05-16 19:21:32 -0400] xtristan: i'm @0xtristan-- unfortunately freenode doesn't allow for leading integers in nicks and three other dudes stole things resembling my name
[2013-05-16 19:22:38 -0400] coderanger: Heh, someone else got @coderanger, but he has legit claim, we both started using the name ~10-15 years ago
[2013-05-16 19:22:45 -0400] coderanger: he has coderanger.com, I have coderanger.net
[2013-05-16 19:22:56 -0400] coderanger: each new site is a race to see who gets it :)
[2013-05-16 19:23:03 -0400] xtristan: hah
[2013-05-16 19:23:19 -0400] xtristan: i'm not the creative sort, so i just type in my name and hit the go button on sites
[2013-05-16 19:23:25 -0400] cheflevelramen: Hi guys. I have a question. My workstation has Chef 11.4 installed, and our Chef environment is running 10.16. I've updated my knife ec2 server create command to specify which version of chef to install (10.16.0). But when I exectue it, I get an error about log_level being improperly set. I haven't specified any log level in knife.rb or in my knife command. Here's a pastbin of the error and my setting:
[2013-05-16 19:23:26 -0400] xtristan: [read: lazy ]
[2013-05-16 19:23:30 -0400] cheflevelramen: http://pastebin.com/sRTkSXFw
[2013-05-16 19:24:14 -0400] cheflevelramen: On the remote instance, I can see the client.rb file has log_level :auto, which I guess is not supported in that version of chef. But I'm not sure how to change it
[2013-05-16 19:24:37 -0400] coderanger: cheflevelramen: I think you need to customize your bootstrap script
[2013-05-16 19:24:47 -0400] coderanger: This is apparently a common thing today :)
[2013-05-16 19:26:05 -0400] invsblduck: hello. something i don't see on the wiki: reinstalling a node.  what is recommended practice? is there an easy way not requiring re-registration? or do i have to purge from server and reassign role, etc? thanks
[2013-05-16 19:26:40 -0400] cheflevelramen: @coderanger, okay. I'm just using the default bootstrap at the moment. I'll take a look at that and see if that fixes it
[2013-05-16 19:27:06 -0400] coderanger: invsblduck: define 'reinstalling'?
[2013-05-16 19:27:40 -0400] invsblduck: coderanger: sorry. new os.  same ip/fqdn.  reprovisioning.
[2013-05-16 19:28:11 -0400] coderanger: invsblduck: Unless you save and restore /etc/chef/client.pem, you would need to clear the node+client from the chef server and go again
[2013-05-16 19:29:02 -0400] invsblduck: coderanger: i see. thanks for the help....new user.
[2013-05-16 19:29:59 -0400] coderanger: invsblduck: That key is an RSA private key, which is how API clients identify themselves
[2013-05-16 19:31:45 -0400] invsblduck: yep. i come from puppet world, where certs go into a crl, etc.
[2013-05-16 19:32:35 -0400] b0c1: hi
[2013-05-16 19:33:08 -0400] invsblduck: coderanger: ^^
[2013-05-16 19:33:47 -0400] coderanger: There is no specific CRL, just when you delete the old client from the chef server, it will be useless
[2013-05-16 19:54:54 -0400] rava: anyone watch the fb presentation by phil at the chef conf recently? i'm intrigued by the idea of stateless chef servers (could make them a scaling group this way!), but the only hang up i have is the flexibility encrypted data bags give me. has anyone else implemented this idea with a solution for passing around secure data?
[2013-05-16 19:56:01 -0400] mattray: rava: you can store your encrypted data bags encrypted in your chef-repo
[2013-05-16 19:56:22 -0400] rava: duh.. now i feel silly
[2013-05-16 19:56:33 -0400] mattray: so as long as you're not manipulating them on the server you're "stateless"
[2013-05-16 19:58:08 -0400] jchauncey: when someone executes knife client list, it uses just the users pem file to sign all the request headers right?
[2013-05-16 19:58:39 -0400] cwj: jchauncey: i believe thats correct
[2013-05-16 19:59:02 -0400] coderanger: No, only certain fields are signed
[2013-05-16 19:59:08 -0400] coderanger: not all headers
[2013-05-16 19:59:38 -0400] NirS: Good evening everybody
[2013-05-16 19:59:46 -0400] NirS: or maybe it's good morning?
[2013-05-16 20:00:12 -0400] coderanger: UGT, always morning
[2013-05-16 20:06:19 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/f6747dac1b058e82b477ce798855bdc77694608f, watch: http://youtu.be/X-0gZ6uELvs
[2013-05-16 20:07:36 -0400] shane_: any idea why chef would restart services in reverse order from how they are listed in the recipe?
[2013-05-16 20:07:38 -0400] shane_: http://pastebin.com/LMDhuvvy
[2013-05-16 20:08:40 -0400] Kzim: hi
[2013-05-16 20:09:13 -0400] Kzim: Anyone use SaltStack with Chef ? or any orchestrator ? thanks
[2013-05-16 20:10:04 -0400] coderanger: Kzim: I use fabric + chef +pychef
[2013-05-16 20:10:12 -0400] coderanger: Disclaimer, I also wrote PyChef :)
[2013-05-16 20:10:27 -0400] coderanger: but http://pychef.readthedocs.org/en/latest/fabric.html
[2013-05-16 20:12:00 -0400] rava: coderanger: i love you
[2013-05-16 20:12:12 -0400] Kzim: coderanger, oh nice i'll check that. my main question is when you use an external tool to pop a new cluster for example where do you store the cluster info ? poeple start to put attribute in recipe but i find hard to, for exemple in your case, use Fabric to create a new recipe for your new cluster
[2013-05-16 20:12:18 -0400] rava: i've wrapped most of our teams chef usage through fabric with that lib
[2013-05-16 20:13:02 -0400] coderanger: Kzim: I have utility functions in my fabfile for manipulating data bags, thats where we store our per-app info
[2013-05-16 20:13:08 -0400] Kzim: btw i just opened the pychef doc and this could be great with Salt !
[2013-05-16 20:13:55 -0400] Kzim: coderanger, we actually use databag too but the probleme with that is the versionning. so you use pychef to create a databag, assign the role and do a chef-run ?
[2013-05-16 20:14:15 -0400] jtran: hey all.  does include_attributes not work on Chef 10.x, is it only a chef 11.x thing?
[2013-05-16 20:14:16 -0400] coderanger: Kzim: I don't generally use fabric for creating new nodes/clusters
[2013-05-16 20:14:16 -0400] rava: Kzim: what versioning problem with data bags?
[2013-05-16 20:14:39 -0400] coderanger: Mostly just deploy automation and misc maint tasks like cache busting and opening debug consoles/logs
[2013-05-16 20:14:47 -0400] Kzim: rava, there is no versioning on it
[2013-05-16 20:14:57 -0400] coderanger: jtran: No, it should work in 10
[2013-05-16 20:15:02 -0400] rava: Kzim: slap a version attr to your items?
[2013-05-16 20:15:03 -0400] coderanger: Been around since 0.9 at least :)
[2013-05-16 20:15:21 -0400] Kzim: rava, you have a DB but all your cookbook version use the same and the conf in the DB could change between the version so it's not backward compatible
[2013-05-16 20:15:34 -0400] rava: coderanger: debug consoles/logs ? details? :)
[2013-05-16 20:15:38 -0400] Kzim: rava, could be an idea
[2013-05-16 20:16:16 -0400] coderanger: rava: For apps that use sql, I usually have an appname.dbshell task that gives me a mysql/psql instance connected to the relevant DB
[2013-05-16 20:16:24 -0400] rava: Kzim: i use attrs on my secure bag items to indicate version and thus what encrypted key to grab
[2013-05-16 20:16:26 -0400] jtran: coderanger:  http://pastebin.com/0bW7nXAK   I've tried "include_attribute" and "include_attributes" same results
[2013-05-16 20:16:48 -0400] coderanger: jtran: Ahh, only works in an attributes file, not recipes
[2013-05-16 20:17:05 -0400] coderanger: jtran: By the time recipe code is run, all attr compilation/expansion is complete
[2013-05-16 20:17:19 -0400] jtran: coderanger:  aah i see.  thanks
[2013-05-16 20:17:27 -0400] coderanger: You should only need include_attribute in really weird cases in chef 11 though
[2013-05-16 20:17:28 -0400] failshell: knife search node 'platform:suse' -a chef_packages.chef.version
[2013-05-16 20:17:37 -0400] failshell: how do i specify a version to that attribute?
[2013-05-16 20:17:47 -0400] coderanger: in chef 10, attr files were loaded in alpha order, in chef 11 they are loaded in run-list expansion order
[2013-05-16 20:17:58 -0400] coderanger: So as long as your cookbook deps are correct, you should be fine
[2013-05-16 20:18:04 -0400] jtran: nice.  thanks for the info!
[2013-05-16 20:18:39 -0400] Kzim: rava, so you have a functionm that compare the cookbook version to your attr ?
[2013-05-16 20:19:53 -0400] rava: ya, just a case statement after loading the item. then i check for the pattern v# where # is an integer
[2013-05-16 20:20:00 -0400] rava: in item.version
[2013-05-16 20:20:36 -0400] rava: a few of my items have that version, but for some it indicates file paths to find files and others wether or not that item applies for this run
[2013-05-16 20:22:13 -0400] rava: honestly, it was an ugly hack i implemented because it was thusly implemented in a script the recipe replaced
[2013-05-16 20:22:28 -0400] rava: just haven't had time to slap some sanity on the situation
[2013-05-16 20:22:29 -0400] Kzim: i see very intresting thanks
[2013-05-16 20:23:17 -0400] rava: any reason you aren't using something like roles or environments to partition that data in a less coupled manner to the data?
[2013-05-16 20:28:19 -0400] bearrito: Hey all, I'm getting started writing a LWRP. My recipe can't find the resource which does exist in the /resources. What am I doing that is dumb? Exact error is :  FATAL: NameError: Cannot find a resource for myresource on ubuntu version 12.04
[2013-05-16 20:28:37 -0400] coderanger: bearrito: remember that LWRPs are cookbookname_resourcename
[2013-05-16 20:29:23 -0400] bearrito: yep. That's going to be it. I read that once in the docs and promptly forgot it.
[2013-05-16 20:56:03 -0400] paigeat: we use the 18-parsec route to smuggle glitterstim spice  to the Si'Klaata cluster
[2013-05-16 20:56:40 -0400] kzim_: rava, yes because i want use Salt or other external tool and that role and env doesn't get version. and your version thing is nice in a DB but in role it's kind of ugly
[2013-05-16 20:58:24 -0400] paigeat: I just offered my wife who I haven't spoken to in two years the option to get on my insurance plan since it doesn't cost me much more than I'm already paying to have her on it
[2013-05-16 20:58:42 -0400] xtristan: paigeat: that's a really strange chef error
[2013-05-16 20:58:45 -0400] xtristan: anything else in the logs?
[2013-05-16 20:58:56 -0400] paigeat: uhhhhhhhhhhhhhhhhhhhhhhhhhh
[2013-05-16 20:59:02 -0400] paigeat: energy spiders
[2013-05-16 20:59:14 -0400] xtristan: guys, i think he's stroking out
[2013-05-16 20:59:31 -0400] paigeat: probably
[2013-05-16 20:59:45 -0400] xtristan: why haven't you spoken to your wife in two years
[2013-05-16 21:00:09 -0400] paigeat: I think she hates me
[2013-05-16 21:00:30 -0400] xtristan: not to turn this into a group hug, but pull off the band aid and move on with your life
[2013-05-16 21:00:39 -0400] paigeat: wot
[2013-05-16 21:00:46 -0400] paigeat: oh right
[2013-05-16 21:00:49 -0400] paigeat: yea
[2013-05-16 21:01:43 -0400] paigeat: I need to persuade her to cooperate with me in getting a divorce or get a lawyer
[2013-05-16 21:01:57 -0400] paigeat: and file my taxes this weekend
[2013-05-16 21:02:06 -0400] paigeat: and get my stuff outta pawn and pay off some loans
[2013-05-16 21:11:35 -0400] rava: i leave for 20 minutes and this...
[2013-05-16 21:12:39 -0400] rava: kzim_: what i was referring to is use a role as the comparison case for the logic, trak db gets taskdb role and thus those users/credentials, etc..
[2013-05-16 21:13:32 -0400] helllen_: helllo again
[2013-05-16 21:13:47 -0400] helllen_: I am receiving this error:  Connection refused connecting to 127.0.0.1:443 for /bookshelf/organization-00000000000000000000000000000000/checksum-da7f47337ff2750c4747c343aa69920c
[2013-05-16 21:13:53 -0400] helllen_: but this on remote node
[2013-05-16 21:14:13 -0400] helllen_: why it tries to connect to bookshelf at localhost ?
[2013-05-16 21:17:13 -0400] shane_: is there a way to make a service only start if another one has been started already?
[2013-05-16 21:18:00 -0400] rava: shane_: notifications?
[2013-05-16 21:18:05 -0400] shane_: yeah
[2013-05-16 21:18:20 -0400] rava: shane_: i mean, have you tried them to do what you want?
[2013-05-16 21:19:05 -0400] shane_: yes but one wont start properly if a certain directory has not been created by the other
[2013-05-16 21:19:15 -0400] shane_: changing that would be very complex
[2013-05-16 21:20:15 -0400] rava: shane_: to add a notification or subscription to that event would be complicated?
[2013-05-16 21:24:41 -0400] paigeat: xtristan: https://github.com/connectxyz/ohai/blob/master/recipes/default.rb#L30
[2013-05-16 21:24:56 -0400] xtristan: why are you linking this to me
[2013-05-16 21:25:09 -0400] renchap: win 43
[2013-05-16 21:25:10 -0400] paigeat: because you sem to be a bad ass
[2013-05-16 21:25:11 -0400] renchap: woops
[2013-05-16 21:25:14 -0400] paigeat: renchap: lol
[2013-05-16 21:25:37 -0400] xtristan: i mean, thanks i guess here's a silly cat i found when i googled silly cat http://t3.gstatic.com/images?q=tbn:ANd9GcQrg-1bh4zp7QAwz_AQERKTpR9088Ak6FEqVGSE5hfcSqkvgxjn
[2013-05-16 21:26:17 -0400] paigeat: w/e if you think you can help please by all means
[2013-05-16 21:26:29 -0400] xtristan: haha, okay
[2013-05-16 21:26:36 -0400] xtristan: what do you want it to do, what is it doing?
[2013-05-16 21:26:48 -0400] xtristan: are all things not being created on a solitary run?
[2013-05-16 21:26:55 -0400] paigeat: https://github.com/connectxyz/ohai/blob/master/templates/default/changeDefaultIPInNodeData.rb.erb
[2013-05-16 21:27:18 -0400] paigeat: had to implement templating because node attributes aren't accessible from the ohai cookbook nor are environment attributes as near as I can tell
[2013-05-16 21:27:26 -0400] xtristan: okay, so the interfaces won't be on there until the secondary run, yeah?
[2013-05-16 21:27:35 -0400] paigeat: so it generates the file then ohai needs to reload
[2013-05-16 21:27:44 -0400] paigeat: righ
[2013-05-16 21:27:45 -0400] xtristan: you could fix this with a notifies
[2013-05-16 21:28:04 -0400] miah: you can reload ohai in the middle of a chef run
[2013-05-16 21:28:06 -0400] xtristan: or have that network interfaces doo doo block drop a file
[2013-05-16 21:28:11 -0400] paigeat: what resource would I want to notify
[2013-05-16 21:28:13 -0400] xtristan: and then subscribe to that
[2013-05-16 21:28:15 -0400] helllen_: hi xtristan, could you help me with the chef-server in HA ?
[2013-05-16 21:28:22 -0400] miah: http://docs.opscode.com/resource_ohai.html
[2013-05-16 21:30:42 -0400] xtristan: brb
[2013-05-16 21:31:23 -0400] paigeat: miah: I made the assumption this would work https://github.com/connectxyz/ohai/blob/master/recipes/default.rb#L30
[2013-05-16 21:31:39 -0400] paigeat: I don't know if the template resource has an updated attribute but
[2013-05-16 21:31:47 -0400] paigeat: the cookbook resource does so why the fuck wouldn't it right
[2013-05-16 21:32:50 -0400] helllen_: I have noticed the directory /var/opt/chef-server/bookshelf/data/bookshelf contains data
[2013-05-16 21:33:34 -0400] miah: hard tabs too eh? =)
[2013-05-16 21:38:09 -0400] paigeat: miah: http://rdoc.info/gems/chef/ 'cookbook' as a resource isn't even defined in here but template is. But I see that template has updated so i think I'm right and as I had imagined its inherited from a parent class
[2013-05-16 21:38:40 -0400] solvip: Any news on chef-3045 ? :/
[2013-05-16 21:38:56 -0400] paigeat: miah what is this doing if not reloading ohai: https://github.com/connectxyz/ohai/blob/master/recipes/default.rb#L70
[2013-05-16 21:39:41 -0400] paigeat: hmm
[2013-05-16 21:42:47 -0400] paigeat: yeah sorry about the tabs I dont care enough to setstop 4 or whatever its usually someone elses problem
[2013-05-16 21:42:52 -0400] paigeat: not mine
[2013-05-16 21:44:09 -0400] paigeat: its easy enough to fix with rubymine or gg=G later :)
[2013-05-16 21:50:29 -0400] helllen_: why the chef-client need to contact bookshelf ?
[2013-05-16 21:50:37 -0400] helllen_: I get this error into my chef-client: https://127.0.0.1/bookshelf
[2013-05-16 21:50:44 -0400] coderanger: helllen_: Whats where cookbook data lives
[2013-05-16 21:50:58 -0400] helllen_: I have two machines
[2013-05-16 21:51:07 -0400] helllen_: one is erchef
[2013-05-16 21:51:14 -0400] helllen_: and the other is a simple client
[2013-05-16 21:51:42 -0400] helllen_: but on logs of the chef-client I get:   ERROR: Server returned error for https://127.0.0.1/bookshelf/organization-00000000000000000000000......
[2013-05-16 21:51:45 -0400] paigeat: nm I think I see what I did wrong
[2013-05-16 21:52:14 -0400] helllen_: but the bookshelf is on the erchef machine
[2013-05-16 21:52:31 -0400] helllen_: the chef-client on the server machine works ok
[2013-05-16 21:53:18 -0400] helllen_: but I have uploading a config file into my cookbook and after that the client tries to access to bookshelf
[2013-05-16 21:56:59 -0400] eph3meral: so I'm having issues with my cookbooks and checsking them out when my cookbooks folder is in my main project repo
[2013-05-16 21:57:20 -0400] eph3meral: cuz when it does "git checkout master" it apparently fails to do that to the cookbook repo and instead ends up checking out my project repo's master branch!
[2013-05-16 21:57:33 -0400] coderanger: helllen_: Check your client config
[2013-05-16 21:57:40 -0400] eph3meral: is there a way to prevent this other than having a 100% separate repo from my main project repo?
[2013-05-16 21:57:59 -0400] eph3meral: it would be nice to have the chef/server config right along side the project code so we devs don't have to checkout two separate repos
[2013-05-16 21:58:00 -0400] coderanger: eph3meral: What is doing git checkout master?
[2013-05-16 21:58:11 -0400] helllen_: coderanger, do I need to add bookshelf field ?
[2013-05-16 21:58:22 -0400] coderanger: helllen_: Can you pastebin what it looks like now?
[2013-05-16 21:58:46 -0400] eph3meral: coderanger: knife cookbook site install postgresql
[2013-05-16 21:58:55 -0400] coderanger: eph3meral: Stop using that, use berkshelf
[2013-05-16 21:58:56 -0400] helllen_: http://pastebin.com/MkdDH7Q7
[2013-05-16 21:59:31 -0400] eph3meral: coderanger: https://github.com/hw-cookbooks/cube/issues/1
[2013-05-16 21:59:31 -0400] coderanger: helllen_: Hmm, looks correct, are you doing anything weird in the recipe code?
[2013-05-16 21:59:38 -0400] eph3meral: coderanger: their fix sort of fixes it
[2013-05-16 21:59:43 -0400] helllen_: not really
[2013-05-16 21:59:53 -0400] eph3meral: at least it fixes it enough to check out the cookbook but it still dumps me back to my master branch on my main project
[2013-05-16 22:00:05 -0400] coderanger: helllen_: Can you pastebin a -l debug trace?
[2013-05-16 22:00:10 -0400] eph3meral: coderanger: but that's the exact command and error that i'm getting
[2013-05-16 22:00:16 -0400] coderanger: eph3meral: Seriously, vendor branching is awful
[2013-05-16 22:00:18 -0400] eph3meral: (though of course I'm doing it with postgresql and not cube in this case)
[2013-05-16 22:00:25 -0400] coderanger: We should just yank those commands entirely
[2013-05-16 22:00:26 -0400] eph3meral: coderanger: er, what branching?
[2013-05-16 22:00:39 -0400] coderanger: knife cookbook site install uses a vendor branching (anti)pattern
[2013-05-16 22:00:44 -0400] eph3meral: ahh
[2013-05-16 22:00:45 -0400] coderanger: It is trash, you should be using berkshelf
[2013-05-16 22:00:53 -0400] eph3meral: ah ok thanks I will look in to it
[2013-05-16 22:00:56 -0400] coderanger: (or librarian if that is your thing)
[2013-05-16 22:01:02 -0400] eph3meral: right I saw those mentioned on the docs
[2013-05-16 22:01:05 -0400] coderanger: but knife cookbook site install is ALWAYS WRONG
[2013-05-16 22:01:06 -0400] eph3meral: but hadn't gotten to them yet
[2013-05-16 22:01:15 -0400] eph3meral: hahah, ok awesome, glad to know I'm not just retarded
[2013-05-16 22:01:24 -0400] coderanger: In the interim, you can use knife cookbook site download to just grab the zip
[2013-05-16 22:01:35 -0400] coderanger: and then check it in yourself in whatever way works best for your repo
[2013-05-16 22:06:35 -0400] helllen_: coderanger, this is the output http://pastebin.com/J5ZFRx8a
[2013-05-16 22:07:04 -0400] xtristan: paigeat: your jazz work yet?
[2013-05-16 22:07:17 -0400] helllen_: on the erchef I uploaded cookbook and exactly I modify /opt/rb/etc/keepalived/keepalived.conf file
[2013-05-16 22:07:22 -0400] helllen_: the file cannot be downloaded
[2013-05-16 22:08:53 -0400] coderanger: helllen_: Do you see bookshelf running on the server box?
[2013-05-16 22:09:05 -0400] helllen_: yes it is
[2013-05-16 22:09:37 -0400] helllen_: the cookbooks are stored into s3 or it local file ?
[2013-05-16 22:10:10 -0400] coderanger: helllen_: local files, bookshelf is an S3 API simulator backed by simple files
[2013-05-16 22:10:42 -0400] helllen_: instead of using bookshelf could I use riak-cs S3 api
[2013-05-16 22:10:44 -0400] helllen_: ?
[2013-05-16 22:10:45 -0400] coderanger: I don't see anything obviously wrong, sorry
[2013-05-16 22:10:57 -0400] coderanger: Replacing bookshelf would be "highly unsupported"
[2013-05-16 22:10:59 -0400] helllen_: it is distributed S3 and high availability
[2013-05-16 22:11:08 -0400] coderanger: which is a fancy way of saying "you're on your own"
[2013-05-16 22:11:31 -0400] j^2: coderanger: do you have a good simulator for s3 api sumulator?
[2013-05-16 22:11:33 -0400] helllen_: the problem is how do I implement high availability in this case
[2013-05-16 22:11:40 -0400] j^2: suggestion that is
[2013-05-16 22:12:03 -0400] coderanger: helllen_: Good question :) We offer HA support in Private Chef
[2013-05-16 22:12:13 -0400] coderanger: FOSS is "what you see is what you get"
[2013-05-16 22:12:34 -0400] helllen_: does the private chef use bookshelf ?
[2013-05-16 22:12:39 -0400] coderanger: Yes
[2013-05-16 22:12:52 -0400] jtimberman: helllen_: put /var/opt in something like DRBD
[2013-05-16 22:12:56 -0400] coderanger: Not sure how much more I'm allowed to say beyond that
[2013-05-16 22:13:13 -0400] coderanger: Blah blah trade secret sauce etc
[2013-05-16 22:13:14 -0400] coderanger: :)
[2013-05-16 22:13:19 -0400] helllen_: hahahah
[2013-05-16 22:15:44 -0400] helllen_: but is at least the same software ?
[2013-05-16 22:16:03 -0400] helllen_: I mean chef-server would be prepared to do ha if I prepare it ?
[2013-05-16 22:16:46 -0400] kvad: hey quys quick question I switch to chef 11 this week and notice that  the node automatic attribute now includes the port in the format of <ipaddr>:<port>
[2013-05-16 22:16:51 -0400] kvad: has this always been the case?
[2013-05-16 22:17:27 -0400] kvad: ipaddress automatic attribute that is node['ipaddress']
[2013-05-16 22:18:27 -0400] paigeat: http://tickets.opscode.com/browse/COOK-3003#comment-35500
[2013-05-16 22:18:48 -0400] paigeat: xtristan: I just created a ticket for it and I'll try to attend the next code review and see if I cant get any feedback
[2013-05-16 22:19:04 -0400] paigeat: since the best advice Ive gotten here is.. oh fuck .. about my tab stop vs 4 spaces
[2013-05-16 22:19:05 -0400] xtristan: cool, i'll try to keep an eye out
[2013-05-16 22:19:07 -0400] paigeat: lol
[2013-05-16 22:19:12 -0400] xtristan: uh
[2013-05-16 22:19:16 -0400] xtristan: people told you how to fix it
[2013-05-16 22:19:24 -0400] xtristan: notifies
[2013-05-16 22:19:31 -0400] paigeat: right
[2013-05-16 22:19:39 -0400] xtristan: or drop a file and subscribe to it with that ohai refresh
[2013-05-16 22:19:40 -0400] paigeat: thats already being done though or I think it should be anyway
[2013-05-16 22:20:55 -0400] paigeat: look at line 30, line 57, then line 70
[2013-05-16 22:21:30 -0400] xtristan: no
[2013-05-16 22:21:31 -0400] xtristan: haha
[2013-05-16 22:21:32 -0400] xtristan: sorry
[2013-05-16 22:21:34 -0400] xtristan: i'm doing work too
[2013-05-16 22:21:55 -0400] xtristan: i can't pay rent with good karma
[2013-05-16 22:22:58 -0400] rava: is there a nice resource for grabbing source files with wget/etc ?
[2013-05-16 22:23:03 -0400] paigeat: lol
[2013-05-16 22:23:09 -0400] paigeat: ok
[2013-05-16 22:36:23 -0400] gkra: hey, what are some things to look out for when running chef-client via cron instead of via chef-client::service ?
[2013-05-16 22:37:54 -0400] kallen: question about syntax for the aws cookbook, resource-tags LWRP -- what is the correct syntax for the "tags" attribute. docs say use a hash. but i am all fail.
[2013-05-16 22:38:26 -0400] kallen: aws_resource_tag "whatdoes_this_string_matter" do
[2013-05-16 22:38:33 -0400] kallen: aws_access_key foo
[2013-05-16 22:38:38 -0400] kallen: aws_secret bar
[2013-05-16 22:38:46 -0400] kallen: tags { "Flavor" => "black" }
[2013-05-16 22:38:47 -0400] kallen: end
[2013-05-16 22:38:53 -0400] kallen: tags is where i'm stuck
[2013-05-16 22:40:26 -0400] shane_: is there a way to alter the order of items in qeue for service restarts?
[2013-05-16 22:40:38 -0400] shane_: queue*
[2013-05-16 22:41:16 -0400] cwj: kallen: i wrote that code so i can try to answer your question
[2013-05-16 22:41:55 -0400] kallen: cwj: hi. thanks.
[2013-05-16 22:41:57 -0400] kallen: i'm now trying this:
[2013-05-16 22:41:58 -0400] kallen: tags({ "Flavor" => "black" })
[2013-05-16 22:42:00 -0400] cwj: kallen: the resource name ("whatdoes_this_string_matter") needs to match a taggable aws resource, e.g. ec2 instance
[2013-05-16 22:42:03 -0400] kallen: that passes syntax check
[2013-05-16 22:42:24 -0400] kallen: whatdoes_this_string_matter needs to be a .. an instance-id?
[2013-05-16 22:42:47 -0400] cwj: the id of whatever you are trying to tag
[2013-05-16 22:42:58 -0400] cwj: if it is an ec2 instance, then you need to provide that instance's id yes
[2013-05-16 22:43:10 -0400] cwj: you can tag ebs volumes and other resources as well
[2013-05-16 22:43:44 -0400] jkline: is there any other way to specify the name attribute of a resource than before the do ?
[2013-05-16 22:43:45 -0400] kallen: ok, next i'll work on deriving the instance-id from node data for this code block. i can do that..
[2013-05-16 22:44:05 -0400] kallen: cwj: what about my attempts at getting the tags syntax correct?
[2013-05-16 22:44:24 -0400] jkline: I would expect perhaps: resource_name "gibberish" do name(real name here)
[2013-05-16 22:44:38 -0400] cwj: kallen: that looks correct to me
[2013-05-16 22:45:34 -0400] jameson__: best way to install rabbitmq is with the rabbitmq cookbook?
[2013-05-16 22:45:38 -0400] jkline: how do I know that for the aws_resource_tag resource that the instance id is the magical thing before the word "do" ?
[2013-05-16 22:46:40 -0400] cwj: jkline: the string used to name the resource is accessible as the .name method on that resource
[2013-05-16 22:47:53 -0400] cwj: actually you can name a aws_resource_tag resource "anything_you_want" as long as you pass a valid resource id using the resource_id parameter
[2013-05-16 22:47:57 -0400] cwj: https://github.com/opscode-cookbooks/aws/blob/master/providers/resource_tag.rb#L5-L9
[2013-05-16 22:48:06 -0400] kallen: cwj: thanks. that worked.
[2013-05-16 22:48:42 -0400] jkline: cwj can I similarly name a directory resource "anything_i_want" and set the path to be created on disk some other way?
[2013-05-16 22:49:36 -0400] cwj: jkline: one would probably have to read the source to figure that out
[2013-05-16 22:50:05 -0400] cwj: https://github.com/opscode/chef/blob/master/lib/chef/provider/directory.rb
[2013-05-16 22:50:17 -0400] cwj: looks like it has a .name parameter and a .path parameter
[2013-05-16 22:50:47 -0400] cwj: so try directory "who_cares_what_its_called" with path "/this/is/the/dir/i/want"
[2013-05-16 22:50:57 -0400] cwj: make sense?
[2013-05-16 22:51:51 -0400] jkline: yes, makes sense.
[2013-05-16 22:52:05 -0400] jkline: i see path all over the source file, where is name taken to be the default for path?
[2013-05-16 22:52:39 -0400] cwj: https://github.com/opscode/chef/blob/master/lib/chef/resource/directory.rb
[2013-05-16 22:53:12 -0400] cwj: so from the looks of the resource, path parameter might not really be accessible
[2013-05-16 22:53:30 -0400] cwj: because even if you pass it, it will be set to the value of name
[2013-05-16 22:54:16 -0400] jkline: directory "gibberish" do path('/tmp/jkline-was-here') end
[2013-05-16 22:54:17 -0400] jkline: works for me
[2013-05-16 22:54:27 -0400] jkline: it creates /tmp/jkline-was-here not gibberish
[2013-05-16 22:54:35 -0400] cwj: rock on
[2013-05-16 22:54:58 -0400] jkline: perhaps that is the meaning of "identity_attr :path" ? https://github.com/opscode/chef/blob/master/lib/chef/resource/directory.rb#L29
[2013-05-16 22:55:06 -0400] cwj: yeah thats what i was just thinking
[2013-05-16 22:55:34 -0400] shane_: does chef process notifies for services before mounts?
[2013-05-16 22:55:49 -0400] shane_: i.e. i have a mount with action [ :mount, :enable ]
[2013-05-16 22:56:46 -0400] jkline: cwj identity_attr defined here https://github.com/opscode/chef/blob/master/lib/chef/resource.rb#L187 Looks promisingly like what we think, based on the comment, but I don't yet understand the code
[2013-05-16 22:59:31 -0400] cwj: shane_: dunno for sure but i am inclined to believe that both actions would be completed before notifications fire
[2013-05-16 22:59:44 -0400] cwj: maybe test with some log resources
[2013-05-16 22:59:58 -0400] shane_: can a mount be declared :immediately?
[2013-05-16 23:02:22 -0400] cwj: not exactly. you can cause resources to be acted on during compile phase, but thats different
[2013-05-16 23:07:48 -0400] cwj: http://docs.opscode.com/chef/resources.html#before-other-resources
[2013-05-16 23:18:39 -0400] shane_: does it actually process the service restarts after the entire chef run is over, or at the end of each recipe?
[2013-05-16 23:18:59 -0400] shane_: because i am having delayed restarts happen pretty much immediately
[2013-05-16 23:21:50 -0400] cwj: the default timing for notifications is :delayed, so they should be executed at the very end of a chef run
[2013-05-16 23:22:14 -0400] cwj: is it possible you have a template or some other resource which has a different notification timing?
[2013-05-16 23:22:23 -0400] cwj: for notifying the same service i mean
[2013-05-16 23:24:52 -0400] shane_: nothing is notifying it with a different timing
[2013-05-16 23:27:09 -0400] cwj: gist your recipe maybe? hard to just guess :)
[2013-05-16 23:33:59 -0400] shane_: by end of chef run, does that mean after ALL recipes in the role have been processed?
[2013-05-16 23:34:09 -0400] shane_: or is this a per recipe type ordering
[2013-05-16 23:38:51 -0400] cwj: after the run list is complete
