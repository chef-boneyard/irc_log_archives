[2013-05-01 00:35:00 -0400] pcn: Ohai chefs
[2013-05-01 00:35:33 -0400] pcn: I've got a fix I'd like to propose for the python cookbook's pip provider.  Would anyone be able to give it a look?
[2013-05-01 00:35:35 -0400] pcn: http://tinyurl.com/cnng7om
[2013-05-01 01:40:46 -0400] frazras: anybody have a working recipe that does ssh key deployments to github?
[2013-05-01 01:41:01 -0400] frazras: i have 1 but it keeps giving me
[2013-05-01 01:41:02 -0400] frazras: Error executing action `create` on resource 'ruby_block[upload_key_to_github]'
[2013-05-01 01:41:03 -0400] frazras: OpenSSL::SSL::SSLError
[2013-05-01 02:04:08 -0400] mmmbeezkneez: is anyone currently maintaining the knife-rackspace repo? I noticed there are 17 pull requests open and the last one was accepted 7 months ago
[2013-05-01 02:50:34 -0400] monokrome: Does `knife ssh` require that DNS resolves for all of your machines?
[2013-05-01 02:50:39 -0400] monokrome: I'm trying to debug this issue:
[2013-05-01 02:50:50 -0400] monokrome: WARNING: Failed to connect to  -- SocketError: getaddrinfo: nodename nor servname provided, or not known
[2013-05-01 03:11:06 -0400] miah: pcn: that looks awesome. you should open a ticket or add that to an existing one for further review
[2013-05-01 03:11:17 -0400] miah: i dont know the problems with the python provider much as i dont use it often
[2013-05-01 03:27:22 -0400] felipe1: Hi all. I have a quick question, maybe someone can help. What would be the proper way to get php5 installed with mssql if it is not explicitly available in the opscode recipe?
[2013-05-01 03:32:37 -0400] monokrome: felipe1: Can you just install package-mssql?
[2013-05-01 03:32:57 -0400] monokrome: er
[2013-05-01 03:32:59 -0400] monokrome: php-mssql
[2013-05-01 03:33:50 -0400] monokrome: felipe1: http://docs.opscode.com/resource_package.html
[2013-05-01 03:37:14 -0400] felipe1: monokrome, thanks, I don't see it as a specific package. To clarify: I don't need mssql installed per se, but I need mssql support in PHP. This is usually done through a separate module
[2013-05-01 03:38:11 -0400] felipe1: Since it requires recompiling, I assume if I run the php recipe, then  recompile on my own, it will get replaced back when chef-client runs
[2013-05-01 03:38:18 -0400] jtimberman: felipe1: write a recipe to do it
[2013-05-01 03:39:10 -0400] kallistec: felipe1: when you say "recompile", do you mean it gets compiled into php itself, or is it some sort of extension .so file thing?
[2013-05-01 03:39:31 -0400] felipe1: I believe it is compiled into php itself
[2013-05-01 03:40:09 -0400] jtimberman: felipe1: on my ubuntu 12.04, it appears to be: php5-sybase - Sybase / MS SQL Server module for php5
[2013-05-01 03:40:11 -0400] felipe1: It uses something like --with-mssql=/usr/local/freetds
[2013-05-01 03:40:12 -0400] jtimberman: :)
[2013-05-01 03:40:43 -0400] jtimberman: package freetds-common perhaps
[2013-05-01 03:40:53 -0400] jtimberman: but, i don't know the php module world
[2013-05-01 03:41:24 -0400] felipe1: Thanks jtimberman. So your ubuntu 12.04 has php5-sybase through the regular php recipe?
[2013-05-01 03:41:41 -0400] jtimberman: felipe1: that's what i see in my apt sources.
[2013-05-01 03:41:48 -0400] kallistec: felipe1: according to https://github.com/opscode-cookbooks/php/blob/master/recipes/source.rb you can set arbitrary options to ./configure?
[2013-05-01 03:41:55 -0400] jtimberman: orthogonal to chef
[2013-05-01 03:42:07 -0400] kallistec: if you intend to compile from source anyway
[2013-05-01 03:42:59 -0400] felipe1: awsome. Thanks a lot, it points me in the right direction
[2013-05-01 03:44:47 -0400] monokrome: felipe1: What is your OS
[2013-05-01 03:44:49 -0400] monokrome: ?
[2013-05-01 03:44:57 -0400] monokrome: In Ubuntu, the package is called php-mssql iirc
[2013-05-01 03:44:59 -0400] felipe1: Ubuntu 12.04, but it is a new machine
[2013-05-01 03:45:11 -0400] monokrome: so install Ubuntu's php-mssql package
[2013-05-01 03:45:57 -0400] jtimberman: monokrome: there isn't one.
[2013-05-01 03:46:19 -0400] jtimberman: http://packages.ubuntu.com/search?suite=all&keywords=mssql
[2013-05-01 03:47:12 -0400] pcn: miah: thanks for looking at it
[2013-05-01 03:48:20 -0400] monokrome: well that's fun
[2013-05-01 03:48:32 -0400] monokrome: How is my node supposed to decrypt my databags? :/
[2013-05-01 03:49:30 -0400] felipe1: Would it be this one? http://packages.ubuntu.com/raring/php5-sybase
[2013-05-01 03:51:01 -0400] monokrome: maybe, not sure
[2013-05-01 04:15:47 -0400] hblah: Hi All, I am trying to use some software that is deployed using chef_solo.  It is overwriting my ntp.conf and I was wondering if I could put something in an override file as the recipes are fetched by git.
[2013-05-01 04:18:51 -0400] kallistec: hblah: depends on the cookbook/recipe, is the source available?
[2013-05-01 04:19:19 -0400] kallistec: alternatively, can you modify the run_list to not include the recipe you don't want?
[2013-05-01 04:20:05 -0400] hblah: kallistec: Its the standard Opscode ntp recipe
[2013-05-01 04:20:38 -0400] hblah: it specifies the default ntp servers.  I just wanted to change them to our local NTP server
[2013-05-01 04:23:52 -0400] kallistec: monokrome: http://docs.opscode.com/essentials_data_bags.html#decrypt
[2013-05-01 04:24:55 -0400] tomschlick: anyone seen this error before ? "/Library/Ruby/Gems/1.8/gems/chef-11.4.4/lib/chef/knife/list.rb:6: superclass mismatch for class List (TypeError)" with chef 11.4.4
[2013-05-01 04:25:11 -0400] tomschlick: i get it by running any knife command
[2013-05-01 04:26:12 -0400] kallistec: hblah: https://github.com/opscode-cookbooks/ntp/blob/master/attributes/default.rb#L23
[2013-05-01 04:26:50 -0400] kallistec: hblah: setting the attributes in your node.json file ought to get you straight
[2013-05-01 04:27:41 -0400] kallistec: tomschlick: what knife plugins do you have installed?
[2013-05-01 04:27:46 -0400] hblah: kallistec: that is the bit I'm struggling with.  This is my first introduction to chef.  It looks amazing.
[2013-05-01 04:28:05 -0400] hblah: I'm using chef-solo so its all been automatic.
[2013-05-01 04:28:10 -0400] kallistec: tomschlick: `gem which chef/knife/list` might give you some pointers
[2013-05-01 04:28:30 -0400] kallistec: hblah: what's the command line that gets executed to run chef-solo?
[2013-05-01 04:28:49 -0400] hblah: chef-solo -j node.json -c solo.rb -l debug
[2013-05-01 04:28:53 -0400] tomschlick: kallistec: that outputs "/Library/Ruby/Gems/1.8/gems/chef-11.4.4/lib/chef/knife/list.rb"
[2013-05-01 04:29:31 -0400] kallistec: tomschlick: anything in `ls ~/.chef/plugins/knife` ?
[2013-05-01 04:30:54 -0400] tomschlick: kallistec: doesnt exist
[2013-05-01 04:33:44 -0400] kallistec: hblah: so that node.json file controls the run_list and node attributes used by solo
[2013-05-01 04:35:24 -0400] hblah: kallistec: yes it has a username/password in there for a database and an erlang cookie.  I just wanted to add "ntp": { "servers": "ntp.domain.com" }, or something like that.  Also changing the timezone.
[2013-05-01 04:35:43 -0400] kallistec: hblah: http://docs.opscode.com/chef_solo.html
[2013-05-01 04:35:50 -0400] kallistec: see the section on attributes in there
[2013-05-01 04:36:53 -0400] tomschlick: kallistec: FYI, its not just the list class, this is output when doing "knife cookbook list" "/Library/Ruby/Gems/1.8/gems/chef-11.4.4/lib/chef/knife/upload.rb:6: superclass mismatch for class Upload (TypeError)"
[2013-05-01 04:37:01 -0400] tomschlick: ive tried reinstalling the gem with no luck
[2013-05-01 04:38:41 -0400] kallistec: tomschlick: anything knife or chef related in `gem list -a` ?
[2013-05-01 04:39:09 -0400] tomschlick: i just removed knife-essentials and that seems to have fixed the general issue
[2013-05-01 04:40:02 -0400] kallistec: tomschlick: was it an older version of knife-essentials?
[2013-05-01 04:40:26 -0400] tomschlick: knife-essentials-0.9.8
[2013-05-01 04:40:46 -0400] kallistec: hrm
[2013-05-01 04:41:48 -0400] tomschlick: yeah thats what puzzled me. knife is up to date at 11.4.4 and that seemed to be also
[2013-05-01 04:41:50 -0400] kallistec: tomschlick: John's tracking bugs here: https://github.com/jkeiser/knife-essentials/issues
[2013-05-01 04:42:01 -0400] kallistec: might be a ruby 1.8 vs. 1.9 thing or something
[2013-05-01 04:42:43 -0400] kallistec: we did merge knife-essentials into master for 11.0, but he's been adding new features since then
[2013-05-01 04:43:52 -0400] kallistec: but it's supposed to work when installing it into chef 11
[2013-05-01 04:50:33 -0400] hblah: kallistec: sorry for being dim.  With changing the timezone, attributes/timezone.rb has default.timezone = "UTC" .  I tried "timezone": { "default.timezone": "Australia/Sydney" }, but it didn't seem to work.
[2013-05-01 04:52:54 -0400] kallistec: hblah: in a different cookbook?
[2013-05-01 04:53:44 -0400] hblah: yes, sorry.  Fragment was shorter than in the ntp part.
[2013-05-01 04:54:06 -0400] kallistec: hblah: also, more about attributes here
[2013-05-01 04:54:08 -0400] kallistec: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-05-01 04:54:24 -0400] kallistec: basically there are levels of attributes that shadow each other
[2013-05-01 04:54:39 -0400] kallistec: the `default` bit is setting that to a lower level of priority
[2013-05-01 04:55:15 -0400] kallistec: just `"timezone": "Australia/Sydney"` in your node.json ought to do it
[2013-05-01 04:57:24 -0400] tomschlick: kallistec: kind of odd also, now i dont have "knife cookbook install" in my command list and cant run it ?!? wtf
[2013-05-01 04:58:36 -0400] kallistec: tomschlick: different from `cookbook site install` ?
[2013-05-01 04:58:53 -0400] tomschlick: sorry thats what i meant
[2013-05-01 04:59:23 -0400] tomschlick: just ran the omnibus installer and it seems to have fixed it
[2013-05-01 04:59:27 -0400] tomschlick: weird..
[2013-05-01 05:01:24 -0400] kallistec: strange
[2013-05-01 05:03:43 -0400] rh1n0: Hi all. Im working on an amazon autoscaling setup. We use chef but since amazon autoscaling uses baked AMI's the only place i see chef working is to generate AMI updates to create the baked images. Any ideas? thanks
[2013-05-01 05:04:30 -0400] kallistec: rh1n0: you can keep running chef afterwards to pick up updates
[2013-05-01 05:04:46 -0400] rh1n0: yeah that makes sense.
[2013-05-01 05:04:51 -0400] kallistec: but for autoscaling you definitely want your node pretty close to fully baked at start
[2013-05-01 05:04:55 -0400] miah: just depends on how often you push updates to your servers and how long your asg's keep servers alive
[2013-05-01 05:05:23 -0400] rh1n0: right now I've created a large user data script that executes during the autoscale launch process. I kept thinking I'm doing the same thing as chef should be doing ;)
[2013-05-01 05:06:10 -0400] kallistec: exactly where you draw the line depends on how quickly your app can deploy
[2013-05-01 05:06:15 -0400] rh1n0: @kallistec thanks, i can understand that since its pretty much a complete headless operation
[2013-05-01 05:06:29 -0400] rh1n0: yeah definitely
[2013-05-01 05:08:09 -0400] rh1n0: we use rails - I've been doing all sorts of experiments to get around the infamous bundler delay lol. My current approach is the make it so when we deploy (capistrano ugh), it takes a new snapshot of an updated ebs volume. Next it updates the as launch config to use the new snapshot.
[2013-05-01 05:08:33 -0400] rh1n0: some day we'll get to chef-deploy
[2013-05-01 05:09:04 -0400] rh1n0: thanks for the info
[2013-05-01 05:09:05 -0400] kallistec: rh1n0: you could also look at making omnibus packages
[2013-05-01 05:09:28 -0400] rh1n0: thats an interesting idea. ill look into that
[2013-05-01 05:09:42 -0400] kallistec: tutorial blog post: http://rubiojr.rbel.co/hack/2013/04/29/distributing-complex-ruby-scripts-with-omnibus-generated-debian-packages/
[2013-05-01 05:09:54 -0400] rh1n0: awesome - appreciate it
[2013-05-01 05:10:13 -0400] kallistec: and schisamo did a presentation a chef conf but I think the videos are still in editing or something
[2013-05-01 05:10:18 -0400] rh1n0: @kallistec did you ever hang out in the java irc channels back around say 2006?
[2013-05-01 05:10:24 -0400] kallistec: nope
[2013-05-01 05:10:50 -0400] rh1n0: hmm your alias seems familiar - oh well :)
[2013-05-01 05:11:36 -0400] kallistec: hrm, not ringing any bells. anyway, good luck
[2013-05-01 05:11:44 -0400] rh1n0: ok thanks again
[2013-05-01 06:01:14 -0400] ryker: hi.  I'd like to use the ec2.describe_volumes method defined in the aws cookbook from inside a recipe in another cookbook.  Is this possible?
[2013-05-01 06:01:44 -0400] ryker: I thought adding include Opscode::Aws::Ec2 in my recipe would allow me to use ec2.describe_volumes, but it didn't work
[2013-05-01 06:17:03 -0400] ryker: nvm. I guess I can't do that because there is no class declared.  it was easy enough for me to just use rightaws from within my recipe
[2013-05-01 06:21:22 -0400] hblah: kallistec: or anyone else.  If I have "ntp": { "servers": ["0.au.pool.ntp.org", "1.au.pool.ntp.org", "2.au.pool.ntp.org" ] }, in  a node.json file.  What part of the cookbook would I need to check to see if that is correct.
[2013-05-01 09:50:58 -0400] Flexa: hey guys
[2013-05-01 09:51:03 -0400] Flexa: I know the aws ec2 chef stuff uses right_aws under the hood
[2013-05-01 09:51:16 -0400] Flexa: inbuilt into chef there is no way to tag ec2 volumes
[2013-05-01 09:51:50 -0400] Flexa: so I'm trying to use RightAws::create_tag(bla) in a ruby block
[2013-05-01 09:51:55 -0400] Flexa: should this work ok...?
[2013-05-01 10:02:08 -0400] sraf: Is it possible to do a remote_file with setting the name of the created file?
[2013-05-01 10:02:35 -0400] sraf: I want the file name to be whatever came from the remote source
[2013-05-01 10:02:37 -0400] sraf: e.g.
[2013-05-01 10:03:15 -0400] sraf: remote_file "???" do
[2013-05-01 10:03:15 -0400] sraf:   source "http://www.example.org/someDynamicallyGeneratedFileName"
[2013-05-01 10:03:15 -0400] sraf: end
[2013-05-01 10:04:07 -0400] sraf: the web service i call will generate the filename for me, and i dont want to lose that information
[2013-05-01 10:11:32 -0400] defting: hello
[2013-05-01 10:12:06 -0400] defting: i have a (I presume) silly question about the admin.pem file
[2013-05-01 10:12:51 -0400] defting: this file is generated on the server and then we need to copy it across to the workstation to use when configuring knife there from what I gather
[2013-05-01 10:13:37 -0400] defting: as it is the chef server's admin.pem isn't this a bit of a security risk?
[2013-05-01 10:16:26 -0400] jonlives: defting: the key copied across to the workstations is a validation key for registering clients with the server.
[2013-05-01 10:17:12 -0400] defting: that is "validation.pem" is it not jonlives?
[2013-05-01 10:17:18 -0400] jonlives: yep
[2013-05-01 10:17:28 -0400] defting: but as for the private key "admin.pem"?
[2013-05-01 10:17:55 -0400] jonlives: the only thing you need to copy to the clients is validation.pem
[2013-05-01 10:18:05 -0400] jonlives: defting: oh hang on I see what you mean
[2013-05-01 10:18:31 -0400] jonlives: admin.pem is the private key for the admin user - you'd only share that between clients if you didn't want to create a seperate key for each client - the latter is what is most commonly done.
[2013-05-01 10:18:53 -0400] jonlives: ie, if you want all clients connecting as the admin user then you share admin.pem.
[2013-05-01 10:19:01 -0400] defting: I can see that it works - but it's just confused me, as I this is a no-no - sharing private keys
[2013-05-01 10:19:06 -0400] jonlives: correct
[2013-05-01 10:19:07 -0400] defting: ok i see
[2013-05-01 10:19:20 -0400] jonlives: defting: you'd usually create a new client with a new private key for each knife user
[2013-05-01 10:19:38 -0400] defting: i see
[2013-05-01 10:21:27 -0400] defting: therefore if we are using one box to act as a workstation from which multiple users ssh into and then use knife, it would be best to not share the admin.pem file, if some of the users on the workstation are not admins? i..e give everyone their own separate key?
[2013-05-01 10:32:21 -0400] withnale: is it possible to create a chef user that only has privileges to use knife search and not make changes to cookbooks?
[2013-05-01 10:39:58 -0400] jonlives: defting: yes :)
[2013-05-01 10:47:52 -0400] defting: thanks jonlives :)
[2013-05-01 10:48:04 -0400] jonlives: np :)
[2013-05-01 12:11:36 -0400] Afterglow: does anyone use spice gem to create nodes with chef 11 ?
[2013-05-01 12:12:04 -0400] Afterglow: we used to post inflated_object but that appears to be invalid now just looking for the correct syntax
[2013-05-01 12:16:30 -0400] mahrob: Hi Guys, I have a small question, need help with that!
[2013-05-01 12:17:28 -0400] mahrob: I have bootstrapped a node and it is working fine with chef. In case, this server gets terminated, I will relaunch a new server with the same DNS name assigned to it. Do I have to bootstrap it again?
[2013-05-01 13:49:19 -0400] Doc_X: is there a reasonable way using the directory resource to create a directory with sticky bits?
[2013-05-01 13:49:48 -0400] gleam: couldn't you do mode '1777'?
[2013-05-01 13:50:00 -0400] gleam: (or whatever)
[2013-05-01 13:50:04 -0400] gleam: or 01777
[2013-05-01 13:50:10 -0400] Doc_X: tried.  keeps coming out 'd-wxrwS--t'
[2013-05-01 13:50:19 -0400] Doc_X: instead of 'drwxrwxrwt' like it should
[2013-05-01 13:51:06 -0400] Doc_X: and apparently the docs on the directory resource say the mode doesn't include sticky bits.  just wondering if there's an accepted way of handling that
[2013-05-01 13:51:29 -0400] gleam: you could always execute chmod on it manually, as long as you don't care about windows
[2013-05-01 13:51:35 -0400] gleam: manually via an execute resource
[2013-05-01 13:51:36 -0400] Doc_X: other than using a shell resource and chmod'ing.
[2013-05-01 13:51:40 -0400] gleam: yea
[2013-05-01 13:52:38 -0400] Doc_X: seems hackish to do it that way, but in the interests of GSD, it looks like that's what'll have to be done.
[2013-05-01 13:54:02 -0400] Doc_X: also, seems kind of like false advertising to show four digits for file modes with that leading '0' doing nothing.  violates aesthetics and 'principle of least surprise', IMO.
[2013-05-01 13:55:34 -0400] gleam: i feel like i've used setuid/setgid successfully in the past
[2013-05-01 13:56:33 -0400] zts: Doc_X: 'mode 01777' works for me
[2013-05-01 13:56:40 -0400] gleam: yeah i just tried the same and it worked fine
[2013-05-01 13:56:43 -0400] gleam: 01777
[2013-05-01 13:56:48 -0400] gleam: drwxrwxrwt  2 root root  4096 May  1 08:56 tmp2
[2013-05-01 13:57:10 -0400] Doc_X: lemme try that.
[2013-05-01 13:57:52 -0400] zts: Doc_X: as for the docs, I think they're trying to say that sticky bits won't get translated into Microsoft Windows permissions.  That language could be clearer, so you might want to create an issue to report that they were confusing
[2013-05-01 13:58:41 -0400] zts: (presuming we're both looking at http://docs.opscode.com/resource_directory.html#attributes )
[2013-05-01 13:58:52 -0400] Doc_X: awesome, that works as expected.
[2013-05-01 13:59:25 -0400] gleam: for some reason some people say using the 5 digit octal is inferior to using quoted strings, i've never really understood that
[2013-05-01 13:59:26 -0400] Doc_X: and, yes, that's where i was looking.
[2013-05-01 13:59:41 -0400] gleam: using <5 digits unquoted can cause problems
[2013-05-01 13:59:47 -0400] gleam: shrug
[2013-05-01 14:01:05 -0400] Doc_X: curses... i'm guessing i need to create yet another user account to file an issue.... oh well, once more into the breach
[2013-05-01 14:03:48 -0400] yfeldblum: using octal notation is fine; using octal notation without a leading zero is not
[2013-05-01 14:03:54 -0400] yfeldblum: that's just standard ruby, not chef-specific
[2013-05-01 14:04:19 -0400] yfeldblum: if you don't like the leading zero, quote it; or just always quote it as a rule, and avoid the question
[2013-05-01 14:04:23 -0400] j0sh_: could anyone tell me why this recipe is now working? https://gist.github.com/anonymous/8eaaaaf33898ebd80148 line 47, params[:name] is being interpolated as []
[2013-05-01 14:05:42 -0400] Doc_X: thanks for the information, yfeldblum.  I'll add that to the documentation request to make a note of it when describing the mode attribute.
[2013-05-01 14:05:48 -0400] gleam: well, it seems like quoting it isn't working wtih sticky bits
[2013-05-01 14:05:55 -0400] gleam: since he was saying '1777' was behaving differently from 01777
[2013-05-01 14:06:22 -0400] rayrod2030: d
[2013-05-01 14:06:27 -0400] Doc_X: my mistake... i'd have to git log to make sure, but i likely did not quote.
[2013-05-01 14:06:38 -0400] gleam: ah nevermind then
[2013-05-01 14:06:53 -0400] yfeldblum: chef also delegates straight to `File.chmod`, and passes a number as the mode (it interprets your string as a number in octal notation)
[2013-05-01 14:06:56 -0400] gleam: yeah, it does work fine with '1777' and 01777
[2013-05-01 14:13:23 -0400] bearrito: Why would it be the case that in the run log, that a compiled resource wouldn't align with the resource declaration? Meaning I see two unrelated things there.
[2013-05-01 14:18:07 -0400] xeon22: would anyone know what key I need to use for omnibus git source?
[2013-05-01 14:18:17 -0400] xeon22: wanted to pass a rev
[2013-05-01 14:18:37 -0400] xeon22: not sure what key to set
[2013-05-01 14:20:26 -0400] yfeldblum: bearrito, unrelated how?
[2013-05-01 14:20:35 -0400] gleam: revisionThe revision to be checked out. This can be symbolic, like HEAD or it can be a source control management-specific revision identifier. Default value: HEAD.
[2013-05-01 14:27:05 -0400] xeon22: i have the git url and the revision specified, but the project borks with a Don't know how to build <software>
[2013-05-01 14:27:56 -0400] techminer: ohai chefs..are the chefconf session videos available somewhere?  or will those only be released to the attendees?
[2013-05-01 14:29:21 -0400] knuckolls: techminer: i found a keynote or two on youtube already. haven't searched for the individual sessions
[2013-05-01 14:30:16 -0400] techminer: I've seen all the keynotes too.there's a couple of the afternoon sessions I'm really interested in viewing.  I was just curious if they were going to be made available.
[2013-05-01 14:32:12 -0400] jtimberman: techminer: yes.
[2013-05-01 14:32:27 -0400] techminer: jtimberman:  yay
[2013-05-01 14:32:39 -0400] jtimberman: techminer: all the talks except Disney's were recorded, and will be posted to the Opscode youtube channel. We'll have a blog post soon w/ curated content of videos, slides, etc.
[2013-05-01 14:32:56 -0400] techminer: awesome thanks!
[2013-05-01 14:34:36 -0400] gchristensen: so did oOpsCode abandon this logo: http://s3.amazonaws.com/crunchbase_prod_assets/assets/images/resized/0004/2096/42096v3-max-250x250.png and Chef abandon this logo: http://en.community.dell.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-45/6521.OC_5F00_Chef_5F00_Logo.png ?
[2013-05-01 14:36:24 -0400] gleam: it looks like the opscode logo changed but the chef logo remains
[2013-05-01 14:36:54 -0400] Cheeezit: is there a best practice for extending cookbooks>'
[2013-05-01 14:36:56 -0400] gchristensen: hrmm okay
[2013-05-01 14:38:07 -0400] gchristensen: two companies doing disappointing logo changes so close to each other. (github losing that awesome lowercase g, and opscode having [as far as i understand it] meaningless morse code)
[2013-05-01 14:38:29 -0400] knuckolls: Cheezit: yes, the wrapper cookbook pattern and chef-rewind. http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-05-01 14:39:09 -0400] jtimberman: gchristensen: it's not meaningless morse code, as it's not morse code :)
[2013-05-01 14:39:27 -0400] gchristensen: is it anythin?
[2013-05-01 14:40:15 -0400] jtimberman: What do you see?
[2013-05-01 14:40:17 -0400] jtimberman: :)
[2013-05-01 14:40:37 -0400] jtimberman: I'm not aware that it has any specific representation.
[2013-05-01 14:40:41 -0400] Cheeezit: @knuckolls thx
[2013-05-01 14:40:54 -0400] gchristensen: is this one of those rorschach tests? :)
[2013-05-01 14:41:26 -0400] techminer: beauty is in the eye of the beholder..somebody important said that somewhere
[2013-05-01 14:42:42 -0400] stask_: Hello everyone
[2013-05-01 14:42:46 -0400] gchristensen: techminer: I reckon you're right :) opscode has done a good job getting me to love them. I can tell because I cared even a little when the logo changed. heh.
[2013-05-01 14:42:54 -0400] techminer: :)
[2013-05-01 14:43:16 -0400] stask_: is there are anyone who can help me with migration 0.10.18 - > 0.11.
[2013-05-01 14:43:46 -0400] stask_: i tryed knife-essentials and knife-backup, they both failing
[2013-05-01 14:44:13 -0400] techminer: stask_: http://www.opscode.com/blog/2013/03/12/5106/
[2013-05-01 14:44:53 -0400] techminer: I used that and didn't have TOO many problems
[2013-05-01 14:46:02 -0400] stask_: knife list is not going to fetch clients and nodes
[2013-05-01 14:46:06 -0400] stask_: root@chef2:/home/ubuntu/transfer# knife list -c .chef/knife.rb / /cookbooks     /data_bags     /environments  /roles
[2013-05-01 14:49:10 -0400] bearrito: yfeldblum, The compiled resource is not derived from the resource declaration. I have an error in the compiled resource but it shows a different (earlier) resource declaration.
[2013-05-01 14:52:07 -0400] j0sh_:  could anyone tell me why this recipe is now working? https://gist.github.com/anonymous/8eaaaaf33898ebd80148 line 47, params[:name] is being interpolated as []
[2013-05-01 15:04:14 -0400] rayrod2030: so how is everyone handling cookbook dependencies and versions on chef server in a heterogenous environment (multiple apps, frameworks, os's).  Aside from locking versions down in environments?
[2013-05-01 15:07:01 -0400] rayrod2030: so let's say I want to introduce the latest and greatest elseticsearch cookbook which uses java 1.10.3 to our chef server but we have a java app which is using a much older version of the java cookbook.
[2013-05-01 15:12:32 -0400] yfeldblum: rayrod2030, one option is to treat the whole infrastructure as a single application, where you must upgrade everything together - if you want to upgrade the java cookbook, you must upgrade the cookbooks that rely on it too
[2013-05-01 15:14:12 -0400] rayrod2030: I imagined that.  One thing we are struggling with at my org is with coming to terms that while applications may go into "maintenance mode" and thus not necessarily be supported by the app devs infrastructure really never goes into maintenance mode and we should always keep our cookbooks up to date.
[2013-05-01 15:16:17 -0400] rayrod2030: we are just looking into testing with the whole test-kitchen stack which I imagine will make rolling out new cookbook versions alot more manageable across our envrionments.  it just seems like you can get to a point where cookbook versions are so bespoke per app that you end up not wanting to touch anything for fear of breaking something downstream.
[2013-05-01 15:23:25 -0400] doktrin: having some trouble installing postgres 9.1 on centos using the default postgresql::server recipe. the installer defaults to server v. 8.4 (probably the default YUM version) - is there a simple workaround? - alternatively, is there a nice template I could look at?
[2013-05-01 15:27:20 -0400] juliancdunn: doktrin: you can wrap the postgresql cookbook in one of your own that does the right thing
[2013-05-01 15:27:47 -0400] juliancdunn: this is what I did at my last job - https://github.com/secondmarket-cookbooks/smpostgresql
[2013-05-01 15:30:00 -0400] adamjk-dev: juliancdunn: is there anywhere I can find your anti-patterns talk/writeup from ChefConf?
[2013-05-01 15:30:15 -0400] doktrin: juliancdunn : thanks :)
[2013-05-01 15:31:17 -0400] matticulous: juliancdunn: glad you are on! i was in your authoring class and am trying to get some clarity on berkshelf things.
[2013-05-01 15:32:23 -0400] juliancdunn: adamjk-dev: I'm exporting the slides today :-)
[2013-05-01 15:32:30 -0400] juliancdunn: matticulous: sure, shoot
[2013-05-01 15:32:48 -0400] adamjk-dev: juliancdunn: Okay thanks!
[2013-05-01 15:33:46 -0400] matticulous: trying to work through the flow of using/testing "product" cookbooks. for example, if i want a quick onramp to use the graphite cook (hw-cookbooks) or sense, does it make sense to use the wrapper pattern for this just to get easy berkshelf flow?
[2013-05-01 15:33:55 -0400] matticulous: or should I just be cloning?
[2013-05-01 15:34:39 -0400] matticulous: *sensu rather. not "sense"
[2013-05-01 15:34:59 -0400] juliancdunn: matticulous: usually, I create a dummy cookbook to wrap it
[2013-05-01 15:35:22 -0400] juliancdunn: because if I like it (the product - graphite or sensu, say), I can just extend it with my own attributes & settings & tests
[2013-05-01 15:35:48 -0400] juliancdunn: that way, one also doesn't have Berksfile and/or Vagrantfile conflicts with the upstream's copies of same
[2013-05-01 15:37:07 -0400] matticulous: that conflict was the main thing i was wondering about. if i just cloned: 1) its unlikely i want the exact copies of those files 2) i'm not grabbing them from the community site (which i'm told is the "preferred" manner)
[2013-05-01 15:38:35 -0400] webframp: matticulous: sidenote, if you make improvements we love to consider them upstream for hw-cookbooks :)
[2013-05-01 15:39:40 -0400] matticulous: webframp: i'd love to help where i can! at chefconf, i was so impressed with the community and really want to be a more involved part of it.
[2013-05-01 15:40:00 -0400] matticulous: webframp: just still learning the ropes on how to actively contribute.
[2013-05-01 15:40:27 -0400] doktrin: does chef-solo always requrie a json-attribs file, or can the json params be provided inline?
[2013-05-01 15:41:26 -0400] webframp: matticulous: awesome! that's always great to hear
[2013-05-01 15:42:47 -0400] matticulous: so, an appropriate workflow here would be something like: 1) 'berks cookbook [company]-sensu', 2) edit vagrantfile/berksfile (sensu cb reference) if needed, 3) update metadata.rb to depend on the sensu cb, 4) include_recipe "sensu" in my default.rb, 5) vagrant up 6) profit.
[2013-05-01 15:43:01 -0400] matticulous: sound right? or am i making it more complex than necessary?
[2013-05-01 15:45:44 -0400] realjxn: Anyone had any luck creating ec2 instances with knife-solo ?  No matter what I do, I'm told my AMI image isn't valid.  (using -I ami-4ac9437a or similar)
[2013-05-01 15:48:14 -0400] juliancdunn: doktrin: it would be ... hard to provide that inline. you meant as a CLI parameter?
[2013-05-01 15:48:15 -0400] webframp: matticulous: sounds sensible
[2013-05-01 15:48:37 -0400] juliancdunn: matticulous: +1
[2013-05-01 15:48:49 -0400] juliancdunn: let me know how step 6 goes :-P
[2013-05-01 15:48:56 -0400] juliancdunn: adamjk-dev: http://www.slideshare.net/JulianDunn/beginner-chef-antipatterns
[2013-05-01 15:50:06 -0400] matticulous: juliancdunn: i was told the last step of anything should always be "profit". :)
[2013-05-01 15:50:49 -0400] juliancdunn: matticulous: heh
[2013-05-01 15:51:05 -0400] juliancdunn: last night Mike Fiedler put "money" as a required tool on his slide deck
[2013-05-01 15:51:27 -0400] adamjk-dev: juliancdunn: Thank you sir, I appreciate it
[2013-05-01 15:51:58 -0400] matticulous: juliancdunn: that's awesome
[2013-05-01 15:52:03 -0400] mmmbeezkneez: anyone know who the maintainer of knife-rackspace is?
[2013-05-01 15:52:38 -0400] juliancdunn: mmmbeezkneez: it might be us
[2013-05-01 15:52:41 -0400] adamjk-dev: doktrin: I pass in some params to chef-solo in my Vagrant file
[2013-05-01 15:53:02 -0400] juliancdunn: mmmbeezkneez: https://github.com/opscode/knife-rackspace
[2013-05-01 15:53:12 -0400] mmmbeezkneez: juliancdunn: I was hoping I could ping someone who was responsible for it as I noticed there were 17 pull requests and the last one accepted was 7 months ago
[2013-05-01 15:53:58 -0400] juliancdunn: mmmbeezkneez: yeah, I know... we're bad at the KNIFE code reviews. hit up @mattray on the Twittahs for now
[2013-05-01 15:54:09 -0400] mmmbeezkneez: will do, thanks!
[2013-05-01 15:55:11 -0400] doktrin: juliancdunn : I'm calling chef-solo from a vagrantfile, the whole "do I need an attribs file" is based on a comment I saw in this template https://github.com/nfms4redd/chef-nfms-portal/blob/master/vagrant/Vagrantfile-centos#L67
[2013-05-01 15:55:35 -0400] doktrin: adamjk-dev : cool, that's what I'm currently doing as well
[2013-05-01 15:55:53 -0400] adamjk-dev: doktrin: Ah, good deal. I wasn't sure if that was what you meant or not.
[2013-05-01 15:57:49 -0400] doktrin: specifically : http://pastie.org/7748722
[2013-05-01 15:58:14 -0400] j0sh_: anyone using the aws_resource_tag recipe?
[2013-05-01 15:58:36 -0400] adamjk-dev: doktrin: makes sense
[2013-05-01 15:58:39 -0400] doktrin: wasn't sure why only the user creation params needed to be specified in json_attribs, whereas the other stuff could be specified in the main vagrantfile
[2013-05-01 16:03:14 -0400] techminer: How to update Chef 11 server to latest version?  Just install the latest Omnibus??
[2013-05-01 16:04:53 -0400] j0sh_: jtimberman: does the aws cookbook aws_resource_tag resource only set a tag for an already existing volume? I have a script to create the volume, mount it etc and then tag it, but it can't seem to tag it as the node data hasn't been updated to include the volume, that hasnt actually been created yet
[2013-05-01 16:06:52 -0400] adnichols: techminer I believe that is the idea - then probably run chef-server-ctl reconfigure
[2013-05-01 16:08:41 -0400] techminer: adnichols:  thanks
[2013-05-01 16:09:56 -0400] techminer: jtimberman:  I'm reading your berkshelf conversion blog post.do you separate each of your cookbooks into their own git repo or leave everything in the main chef-repo git repo (say that 10 times fast:) )
[2013-05-01 16:12:01 -0400] jfoy: techminer: can you share a link?
[2013-05-01 16:12:33 -0400] techminer: jfoy:  link to the blog post?  http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/
[2013-05-01 16:12:45 -0400] jfoy: techminer: yes, thx!
[2013-05-01 16:15:12 -0400] djustin: Does anyone know of an esx[i] tool to automate windows vm creation/bootstrapping?  kinfe-esx is not spinning them up properly
[2013-05-01 16:18:36 -0400] MattJ: This is maybe a silly question, but I'm having a problem executing an action on a lwrp (supervisor_service) - I have other resources that 'notify :restart', but at the end of the chef-client run the action isn't taken... just "action restart (up to date)"
[2013-05-01 16:18:51 -0400] techminer: ohai chefs:  Is there a bug here? http://www.opscode.com/chef/install/  I'm using Chrome on Mac and the downloads don't appear when I choose my options.  Works fine on my Windows node in Firefox and Chrome.
[2013-05-01 16:19:00 -0400] techminer: djustin:  knife-vsphere
[2013-05-01 16:20:12 -0400] djustin: thanks techminer...will check it out
[2013-05-01 16:20:21 -0400] techminer: djustin:  I wrote a wrapper script around that tool that works great..but it's pretty customized for my use.  Here's the gist https://gist.github.com/MattMencel/5302820
[2013-05-01 16:20:46 -0400] techminer: I've made some modifications since then but you should get the idea.
[2013-05-01 16:29:10 -0400] a13x212: trying to use provider ifconfig, doesn't configure ifcfg correctly, http://pastebin.com/vd6RwQkZ
[2013-05-01 16:29:22 -0400] djustin: bah, pec': Unable to activate knife-vsphere-0.5.0, because rbvmomi-1.6.0 conflicts with rbvmomi (~> 1.5.1) (Gem::LoadError)
[2013-05-01 16:37:58 -0400] techminer: djustin:  yea I think you have to leave rbvmomi at 1.5.1
[2013-05-01 16:41:16 -0400] djustin: techminer Yes, uninstalling 1.6.1 worked out...I received no error, but it seems the vm did not create
[2013-05-01 16:44:57 -0400] MattJ: If multiple :delayed notifications are made for the same resource (but different actions) during a run, are they all executed?
[2013-05-01 16:45:04 -0400] new2chef: Greetings fellow chefs! I have a weird issue I was hoping someone could shed some light on for me.  I have one particular node where even after a successful chef-client run, the IP attribute typically set by ohai info is not being set.  Other attributes that pulls from ohai data such as FQDN, Platform, etc are being populated, however just the IP attribute is not being set.  When I do an ohai on the node I see the ipaddress correctly
[2013-05-01 16:45:04 -0400] new2chef: displayed.  Any ideas what might be causing this?
[2013-05-01 16:46:22 -0400] new2chef: I've also tried deleting the client/node and re-adding it to no avail.
[2013-05-01 16:46:57 -0400] new2chef: re-adding = bootstrapping again
[2013-05-01 16:48:41 -0400] djustin: new2chef, i've noticed that multiple attributes populate when you bootstrap with a run list (such as adding a role that has a runlist)
[2013-05-01 16:51:55 -0400] new2chef: @djustin I tried bootstrapping the node again with several roles and run-lists, but had the same issue- weird thing is that some the the attributes are being set-
[2013-05-01 17:11:37 -0400] mhalligan: hrm is there a good wordpress cookbook that isn't tied to apache?
[2013-05-01 17:13:24 -0400] tmichael: ohai chefs.  need a sanity check on something.  here's the gist: https://gist.github.com/toddmichael/feaf0aff4e49d9fabfa2
[2013-05-01 17:13:43 -0400] tmichael: i get undefined method `[]' for true:TrueClass as configured in the gist
[2013-05-01 17:13:59 -0400] tmichael: but when i change all my attribs from :opendkim to :dkim it works
[2013-05-01 17:14:26 -0400] tmichael: is there some issue with having base of attrib the same as the name of the cookbook?
[2013-05-01 17:14:54 -0400] tmichael: i'm sure i'm going to learn a valuable lesson here.  swear i've done this before though with no issues so not sure wtf
[2013-05-01 17:15:24 -0400] tmichael: i've diagnosed the issue.  now just need somebody smarter than me to tell me why
[2013-05-01 17:19:11 -0400] haylon: When I identifying a RPM package in a recipe, how would you declare it? I am getting an error with 'rpm_package "rpmpackage.123.rpm" do; action :install; end'  How would I declare the path? nameofcookbook::rpmpackage.123.rpm ?
[2013-05-01 17:22:47 -0400] haylon: whoami
[2013-05-01 17:25:57 -0400] aruntomar: haylon: where is your rpm file? is it already downloaded on the system? or do you want to first download it and then install it?
[2013-05-01 17:28:47 -0400] haylon: aruntomar: its in the 'files' folder in the cookbook
[2013-05-01 17:30:33 -0400] maplebed: Were any of you at #chefconf and took a picture of the jobs board? A friend is looking.
[2013-05-01 17:30:57 -0400] kindsol: there was a jobs board?
[2013-05-01 17:31:05 -0400] maplebed: yeah, it was next to registration.
[2013-05-01 17:32:16 -0400] aruntomar: haylon: so in your recipe are you copying the rpm to the node first?
[2013-05-01 17:33:20 -0400] haylon: aruntomar: I think so? I dont explicitly have any statements that say copy. Just when I upload the cookbook, the RPM is uploaded with it.
[2013-05-01 17:33:32 -0400] aruntomar: haylon: if not, then copy the rpm to the node using  "cookbook_file" resource
[2013-05-01 17:34:26 -0400] haylon: aruntomar: That would copy from the cookbook in the chef server to the client then? And would line be in the recipe?
[2013-05-01 17:34:35 -0400] aruntomar: haylon: in cookbook_file resource, you need to specify the destination of the copied file eg: /tmp/rpm123.rpm
[2013-05-01 17:35:07 -0400] haylon: aruntomar: that would be the destination on the chef-client then?
[2013-05-01 17:36:47 -0400] aruntomar: haylon: then rpm_package "package name" ; do action :install; source /tmp/rpm123.rpm end
[2013-05-01 17:37:45 -0400] haylon: aruntomar: Ok, think I got it. cookbook_file copies it over to the chef-client, then the rpm_package actually runs it
[2013-05-01 17:38:05 -0400] aruntomar: haylon: yes
[2013-05-01 17:39:01 -0400] haylon: aruntomar: thank you. I'll see if i can get it working. Thank you for your help
[2013-05-01 17:39:10 -0400] aruntomar: haylon: ideally, you should keep your rpm or other files in some web/ftp server. that reduces the size of the cookbooks, plus they'll copy it only when needed.
[2013-05-01 17:39:48 -0400] haylon: aruntomar: I will remember that when I revise this after I get it working.
[2013-05-01 17:39:51 -0400] aruntomar: haylon: remote_file resource is good for that matter, and use "create_if_missing" attribute, that'll only copy/create the files when they don't exist on the node.
[2013-05-01 17:42:12 -0400] _Kenny: Hi, using the opscode community couchdb cookbook, do I need to separately install an httpd to get futon?
[2013-05-01 17:43:04 -0400] aruntomar: _Kenny: does the couchdb cb has a dependency mentioned as httpd
[2013-05-01 17:43:25 -0400] _Kenny: I don't see one in the default recipe
[2013-05-01 17:44:23 -0400] _Kenny: nor in metadata.rb
[2013-05-01 17:46:24 -0400] juliancdunn: _Kenny: futon comes by default with couchdb
[2013-05-01 17:46:26 -0400] aruntomar: _Kenny: then you'll have to install it using eg: apache2 cookbook
[2013-05-01 17:46:34 -0400] juliancdunn: you just need to hit couch on port... 5984, I think
[2013-05-01 17:47:32 -0400] _Kenny: ok, then something's gone wrong with the berkshelf/vagrant install to the VM, because I don't get anything on port 5984 (and that is where I expect futon to be)
[2013-05-01 17:47:36 -0400] aruntomar: _Kenny: i've not used the couchdb cookbook, so you'll have try it out. try as juliancdunn suggested, if that works great, othewise install apache2 cookbook later.
[2013-05-01 17:48:43 -0400] _Kenny: thanks
[2013-05-01 18:12:18 -0400] ohadlevy: talks about chef integration to foreman at #theforeman channel
[2013-05-01 18:20:17 -0400] eightbits: I'm new to chef and having trouble getting knife to upload a cookbook.  I can use knife to create users and grab certs, list of users, lists of clients, etc...  But attempting to upload a cookbook results in "ERROR: Network Error: Connection refused - connect(2)/opt/chef/embedded/lib/ruby/1.9.1/net/http.rb:762:in `initialize': Connection refused - connect(2) (Errno::ECONNREFUSED)"
[2013-05-01 18:20:17 -0400] eightbits: I have seen that this could be cuased by not having an FQDN set on the system before installing/configuring chef server, but I did.  I even wiped out the VM, reinstalled, and verified the FQDN before installing chef-server on it again.  What else can I do to find the source of the problem?
[2013-05-01 18:22:26 -0400] david415: good morning!
[2013-05-01 18:24:08 -0400] shane__: what's the best way to do something if a node has a specific role?
[2013-05-01 18:24:24 -0400] a13x212: eightbits, try this https://gist.github.com/spheromak/5017833
[2013-05-01 18:24:36 -0400] shane__: cant seem to find any examples on how to search on something like that and stick it in an if statement
[2013-05-01 18:25:29 -0400] a13x212: eightbits, more info: http://docs.opscode.com/config_rb_chef_server.html
[2013-05-01 18:26:29 -0400] eightbits: Thanks, a13x212.  I'll go through those and see what I can do.
[2013-05-01 18:26:39 -0400] LinuxHorn: back
[2013-05-01 18:28:12 -0400] webframp: shane__: we use this https://github.com/hw-cookbooks/discovery
[2013-05-01 18:28:46 -0400] haylon: Where would I go to find information on downloading a new repo for linux using chef?
[2013-05-01 18:29:40 -0400] shane__: cool
[2013-05-01 18:30:10 -0400] shane__: how would i search the current node executing the recipe run_list ?
[2013-05-01 18:30:43 -0400] shane__: i just want the recipe to make a decision based on the current instance having a specific role
[2013-05-01 18:30:52 -0400] tomdzk: haylon: you mean like registering a new apt/yum repo ?
[2013-05-01 18:30:55 -0400] shane__: current node*
[2013-05-01 18:31:18 -0400] haylon: tomdzk: yes, a yum repo
[2013-05-01 18:31:47 -0400] tomdzk: haylon: look at the yum cookbook, https://github.com/opscode-cookbooks/yum
[2013-05-01 18:32:02 -0400] tomdzk: haylon: specifically yum_key and yum_repository
[2013-05-01 18:32:28 -0400] haylon: tomdzk: ok. But does this mean I have to upload this cookbook too? or just copy a line from it?
[2013-05-01 18:33:18 -0400] tomdzk: haylon: you need to upload the cookbook and depend on in it in yours (metadata.rb), and then you use yum_key/yum_repository just like any other resource (such as file, template, ...)
[2013-05-01 18:35:43 -0400] shane__: if node[:run_list] =~ /^my-role-name/
[2013-05-01 18:35:47 -0400] shane__: would something like this work ?
[2013-05-01 18:36:14 -0400] gleam: node['roles'].include?("my-role-name")
[2013-05-01 18:36:20 -0400] shane__: ah
[2013-05-01 18:37:46 -0400] gleam: node.role?("my-role-name") actually
[2013-05-01 18:43:20 -0400] haylon: tomdzk: I'm not completely following this gihub you sent me to. My understanding of Chef isn't good enough to edit the metadata.rb, or know how to call from other chef cookbooks.
[2013-05-01 18:44:43 -0400] eightbits: After applying the chef-server.rb with my fqdn substituted for "server.vm" and a chef-server-ctl reconfigure, I get the same error with knife: "/opt/chef/embedded/lib/ruby/1.9.1/net/http.rb:762:in `initialize': Connection refused - connect(2) (Errno::ECONNREFUSED)"
[2013-05-01 18:48:00 -0400] eightbits: It's worth noting that it now omits the preceding portion of the message: "ERROR: Network Error: Connection refused - connect(2)"
[2013-05-01 18:48:38 -0400] tomdzk: haylon: have a look at http://gettingstartedwithchef.com/
[2013-05-01 18:49:25 -0400] tomdzk: haylon: it shows how to use an external cookbook (apache2 in that case) and use resources from that cookbook
[2013-05-01 18:50:33 -0400] haylon: tomdzk: thank you, I will read that in a bit. My shift is ending. Than you again
[2013-05-01 18:54:07 -0400] MattJ: If multiple :delayed notifications are made for the same resource (but different actions) during a run, are they all executed?
[2013-05-01 19:01:02 -0400] kallistec: Chef code review starting soon. Youtube: http://youtu.be/bEs-erQ4VgI join: https://plus.google.com/hangouts/_/7bd0f1e596396fc03d2c41c11636b4f6915f94c8?authuser=0&hl=en
[2013-05-01 19:02:53 -0400] MattJ: Ok, can someone suggest a better place for Chef support? StackExchange? A mailing list perhaps?
[2013-05-01 19:07:21 -0400] juliancdunn: MattJ: there is a mailing list
[2013-05-01 19:07:26 -0400] juliancdunn: go to lists.opscode.com
[2013-05-01 19:07:38 -0400] MattJ: Thanks
[2013-05-01 19:07:43 -0400] tomdzk: MattJ: not sure if this helps you but I found this article to be a rather good description of the whole flow incl. notifications: http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-05-01 19:08:01 -0400] MattJ: tomdzk, thanks, I'll take a read :)
[2013-05-01 19:08:47 -0400] juliancdunn: MattJ: I believe they would all be executed at the end of the run, by the way, but only experimentation will tell... I don't know for sure :)
[2013-05-01 19:09:46 -0400] MattJ: juliancdunn, well I'm seeing unexpected behaviour and trying to explain why... have failed so far, and I've been trying to figure it out for a day now
[2013-05-01 19:12:43 -0400] MattJ: I think this might be the key for me from that article: "at this point, any notifications or subscriptions are processed if the resource was told by the provider anything was changed."
[2013-05-01 19:12:46 -0400] juliancdunn: MattJ: what is the behavior you are seeing? that only one notification gets run?
[2013-05-01 19:13:26 -0400] MattJ: juliancdunn, I'm creating a resource (supervisor_service), and several other resources (templates mostly) notify :restart on it during the run
[2013-05-01 19:13:39 -0400] sniperd: Has anyone ever seen the linux memory plugin in ohai hang while doing a File.open("/proc/meminfo"), but everything else can access that file fine?
[2013-05-01 19:13:47 -0400] MattJ: at the end it doesn't actually restart, Chef just skips it and says "up to date"
[2013-05-01 19:14:15 -0400] MattJ: However the :restart action doesn't have any conditions (it contains a simple execute resource, with no only_if/etc.)
[2013-05-01 19:22:10 -0400] juliancdunn: MattJ: that's odd
[2013-05-01 19:22:18 -0400] juliancdunn: gist the code?
[2013-05-01 19:26:07 -0400] wamilton: hi chefs -- wondering if there's a known issue with execute resource and scripts that reference environment variables
[2013-05-01 19:26:56 -0400] wamilton: ie, I have a rakefile that assumes ENV['HOME'] points to $HOME for the user invoking rake, but when I do this, it point to $HOME for root: /root
[2013-05-01 19:31:06 -0400] yfeldblum: wamilton, this is a known issue for everything that assumes `sudo -u` or switching user-id's is equivalent to logging in as another user with envvars and all
[2013-05-01 19:31:22 -0400] sniperd: wamilton: Chef is ran as root, in this resource are you specifying an executing `user`? you should probably be using the environment({'HOME' => myhomedir})
[2013-05-01 19:31:51 -0400] sniperd: http://docs.opscode.com/resource_execute.html --  look at this: 'Run a command which requires an environment variable'
[2013-05-01 19:33:34 -0400] wamilton: yfeldblum, sniperd: ic, thanks. So really, the solution that makes sense to me is to abhor writing scripts that depend on ENV ... shoring up the execute resource on a case by case basis smells of anti-pattern, but I can't be sure....
[2013-05-01 19:34:20 -0400] yfeldblum: wamilton, env vars are quite reasonable; they must simply be documented
[2013-05-01 19:34:34 -0400] wamilton: is there any use for a provider that uses 'su -c' instead of 'sudo -u' ?
[2013-05-01 19:34:53 -0400] yfeldblum: wamilton, you shouldn't do that
[2013-05-01 19:35:06 -0400] yfeldblum: wamilton, your providers should neither su nor sudo
[2013-05-01 19:35:14 -0400] sniperd: wamilton: Consider making an attribute or library method that determines what your env vars should be then do environment(node.my_env_vars || MyLibrary.environment_variables)
[2013-05-01 19:35:21 -0400] MattJ: juliancdunn, here we go: https://gist.github.com/mwild1/b3789dfb8084cabb87dc
[2013-05-01 19:35:23 -0400] sniperd: if your really going to be reusing the same paradigm alot
[2013-05-01 19:35:53 -0400] yfeldblum: wamilton, if your providers need to run a command as another user or with env vars or both, both the execute/script/etc resources and Mixlib::ShellOut support switching users and changing env vars
[2013-05-01 19:36:00 -0400] MattJ: juliancdunn, note that :enable *is* executed, but :restart isn't, even when either of those other resources are updated. And :immediately does make it work (but that makes it restart too early)
[2013-05-01 19:36:25 -0400] yfeldblum: wamilton, what you should do is carefully set the user and env vars required to run the script in your resource attributes or in your call to shell_out
[2013-05-01 19:37:05 -0400] wamilton: yfeldblum: I guess I don't understand how this doesn't violate DRY.... how is it not obvious that I want ENV to be the ENV of the specified user?
[2013-05-01 19:37:26 -0400] yfeldblum: wamilton, there's no such thing
[2013-05-01 19:37:58 -0400] sniperd: right, think of ENV as the computation of the session at runtime, nothing more.
[2013-05-01 19:37:59 -0400] yfeldblum: wamilton, there are only specific env vars that the script depends on, and your script should document them and your chef code should respect that ... it's just a form of providing inputs to the script
[2013-05-01 19:38:44 -0400] yfeldblum: wamilton, your script can read its inputs from the command line, or from the environment, or from a file, or from a socket; whichever way your script reads its inputs, that's the way the calling code should provide the inputs
[2013-05-01 19:38:45 -0400] sniperd: wamilton: how many execute resource to rake scripts do you plan on writing?
[2013-05-01 19:39:17 -0400] wamilton: sniperd, yfeldblum: oic, so if I understand you guys, doing 'su -c' in an execute is "just a bad idea" ?
[2013-05-01 19:39:30 -0400] yfeldblum: wamilton, that's right
[2013-05-01 19:39:44 -0400] wamilton: sniperd: well, I'm not planning on dying soon, so it's predictable that this pattern will get reused :)
[2013-05-01 19:40:22 -0400] sniperd: wamilton: hehe :)
[2013-05-01 19:40:58 -0400] sniperd: If you have a serious set of ENV var's you need set, I suggest you try and store them elsewhere and then just feed them into environment() for the resource
[2013-05-01 19:41:28 -0400] wamilton: so, is it worthwhile for me to conceive of a library that gives me a whitelist of ENV variables to pull through and is generally reusable?
[2013-05-01 19:42:12 -0400] sniperd: It's not a bad idea as far as im concerned, thats probably what I would do (I dont know the situation 100% obviously, but it sounds sane)
[2013-05-01 19:42:12 -0400] wamilton: eg, this all started because I consider it obvious that I will want $HOME to be set as though logging in as the user
[2013-05-01 19:42:27 -0400] yfeldblum: wamilton, that is not at all obvious
[2013-05-01 19:42:46 -0400] sniperd: I mean, Its an assumption alot of people would come to though yfeldblum
[2013-05-01 19:42:56 -0400] yfeldblum: wamilton, that may be obvious in the case that you've got before you, but it's not obvious in general
[2013-05-01 19:43:25 -0400] sniperd: You think most people would be surprised if ENV['HOME'] was set proper/
[2013-05-01 19:43:31 -0400] yfeldblum: sniperd, i cam to that assumption to, and stuck to it for a while; but i've since gone away from it
[2013-05-01 19:43:41 -0400] sniperd: agreed, same here
[2013-05-01 19:44:24 -0400] yfeldblum: sniperd, professionals would be surprised if they set the process uid and the process's environment variables changed too
[2013-05-01 19:45:13 -0400] yfeldblum: sniperd, it's certainly OK to make a helper function that sets both the process uid and a couple related environment variables all at once
[2013-05-01 19:45:48 -0400] wamilton: yfeldblum, sniperd: ok, so the expected behavior of the resource simply is based on people conventionally doing `sudo -c` and I need to grow up and embrace it
[2013-05-01 19:46:53 -0400] yfeldblum: wamilton, the expected behavior of the resource is based on independently altering the process' uid, gid, and env - in the specific ways you instruct and no more
[2013-05-01 19:47:23 -0400] wamilton: yfeldblum: thanks, that's what I needed. all is well
[2013-05-01 19:47:38 -0400] sniperd: yfeldblum: yes, but this is chef -- It's wrapped up in 'magic', knowing how every resource works under the hood is not a pre-requisite
[2013-05-01 19:47:58 -0400] sniperd: wamilton: cool
[2013-05-01 19:48:39 -0400] wamilton: sniperd: fwiw, I'm now convinced that providing the magic that shell junkies would expect is best
[2013-05-01 19:49:21 -0400] yfeldblum: sniperd, wamilton, that would be a royal PITA to everyone who knows what's going on
[2013-05-01 19:49:51 -0400] wamilton: yfeldblum: yes, that's what you've convinced me of, that's what I menat
[2013-05-01 19:49:57 -0400] wamilton: s/menat/meant
[2013-05-01 19:50:18 -0400] yfeldblum: wamilton, perhaps your script should avoid relying on ENV['HOME'] in the first place
[2013-05-01 19:50:24 -0400] dumontster: i'm stuck with this issue. i need to query the file system to get a folder name. then use this folder name throughout the recipe. i am currently retrieving the folder name in a ruby_block resource to a global variable ($folderName) but $folderName is not available in my next resource. Any ideas how to make this information available to the recipe scope?
[2013-05-01 19:50:38 -0400] yfeldblum: wamilton, not all forms of invoking scripts will cause ENV['HOME'] to be set at all, or be set to anything meaningful
[2013-05-01 19:50:40 -0400] sniperd: yfeldblum: yeah, he gets that, this horse is dead :)
[2013-05-01 19:50:42 -0400] wamilton: yfeldblum: yeah, that was my first reaction to this discussion :)
[2013-05-01 19:50:49 -0400] wamilton: thanks guys
[2013-05-01 19:51:01 -0400] sniperd: np man
[2013-05-01 19:51:18 -0400] yfeldblum: wamilton, but if you need to know the homedir of the current user, the user the script is being executed as, you can always fetch that information in other ways
[2013-05-01 19:51:57 -0400] wamilton: yfeldblum: yeah, am I missing the /etc/passwd resource/provider?
[2013-05-01 19:52:23 -0400] sniperd: dumontster: Is your name after the sand dunes? Also, you should probably be setting the directory into an attribute. node.set[:myapplication][:directory_name] = "/path/to/my/dir"
[2013-05-01 19:52:24 -0400] yfeldblum: wamilton, http://www.ruby-doc.org/stdlib-1.9.3/libdoc/etc/rdoc/Etc.html#method-c-getpwnam
[2013-05-01 19:52:40 -0400] yfeldblum: wamilton, /etc/passwd is managed by the `user` resource/provider
[2013-05-01 19:52:52 -0400] dumontster: it's a play on my last name
[2013-05-01 19:52:56 -0400] yfeldblum: sniperd, avoid `node.set`
[2013-05-01 19:53:07 -0400] sniperd: ah, ok, nvm
[2013-05-01 19:53:15 -0400] sniperd: yfeldblum: use node default or ?
[2013-05-01 19:53:22 -0400] dumontster: i tried setting node.default['folderName'] but it is also nil
[2013-05-01 19:53:25 -0400] yfeldblum: sniperd, assigning to `node.default[...]` is better
[2013-05-01 19:53:35 -0400] dumontster: i will try it agin
[2013-05-01 19:53:37 -0400] yfeldblum: sniperd, but there's no strict need to do that
[2013-05-01 19:53:39 -0400] sniperd: ack, my bad habit :)
[2013-05-01 19:53:51 -0400] sniperd: just doing node[:whatever] = "hi"
[2013-05-01 19:53:58 -0400] sniperd: and letting chef assign
[2013-05-01 19:54:27 -0400] yfeldblum: wamilton, you should not need to manage /etc/passwd directly; rather, if you need changes done to it, you should do those changes through the `user` resource
[2013-05-01 19:54:39 -0400] sniperd: dumontster: It should be set after that, although, if the converge fails it wont be saved permanently
[2013-05-01 19:54:45 -0400] yfeldblum: sniperd, that's no longer allowed, and is the same as `node.set`
[2013-05-01 19:54:47 -0400] sniperd: dumontster: either way, an attribute is the way to go
[2013-05-01 19:54:56 -0400] sniperd: yfeldblum: so whats the best way?
[2013-05-01 19:55:23 -0400] yfeldblum: sniperd, `node.default["cookbook_name"]["attribute_name"] = attribue_value`
[2013-05-01 19:55:41 -0400] sniperd: Oh, when you said 'is better' but theres no strict need to do that
[2013-05-01 19:55:47 -0400] sniperd: I was assuming you meant of another way
[2013-05-01 19:55:56 -0400] yfeldblum: sniperd, there's no strict need to use a node attribute at all
[2013-05-01 19:56:30 -0400] sniperd: right, he could just use a variable if he never wants to use it outside of that recipe I guess
[2013-05-01 19:56:30 -0400] wamilton: sniperd: not setting a precedence doesn't work in chef11
[2013-05-01 19:56:40 -0400] yfeldblum: sniperd, but if you're going to use one, whether for convenience or because you need the data to be searchable, then prefer to use the default-level from your cookbooks and not the normal-level in most cases
[2013-05-01 19:56:54 -0400] sniperd: cool
[2013-05-01 19:57:18 -0400] yfeldblum: sniperd, normal-level is ideal for sysadmins using `knife` or for very specific cases in recipes (and most uses of it i've seen in practice in recipes are wrong)
[2013-05-01 19:59:38 -0400] sniperd: gotcha, cool, much appreciated I will have to read up on that
[2013-05-01 20:00:07 -0400] dumontster: the attribute set inside the "block" is nil outside the ruby_block resource
[2013-05-01 20:00:57 -0400] dumontster: i can log the attribute to the console inside the block but it is nil outside of the block
[2013-05-01 20:01:09 -0400] sniperd: hrm
[2013-05-01 20:02:35 -0400] sniperd: dumontster: gist code?
[2013-05-01 20:02:36 -0400] yfeldblum: dumontster, the code outside the `block` all runs at "compile time", which is when all your recipe code runs; the code inside the `block` all runs at "converge time", which is when all the resources that have been declared and inspected, and updates are made to the system (files are created, packages are installed, services are started, etc)
[2013-05-01 20:03:42 -0400] dumontster: sniperd: https://gist.github.com/anonymous/5497931
[2013-05-01 20:03:53 -0400] yfeldblum: dumontster, your recipe code should declare a list of resources, such as directory resources, package resources, service resources, ruby_block resources, etc; once all your recipes are finished running, then the resources declared in all your recipes are acted on
[2013-05-01 20:04:10 -0400] jtimberman: Opscode COOK code review starting soon. Watch: http://youtu.be/XhSg-_6qVVs Join: https://plus.google.com/hangouts/_/67bc5e4d676672a40aa5523575e8801193ade3af
[2013-05-01 20:04:36 -0400] djustin: has anyone else ever witnessed 2 nodes/clients are created?  only diff being the fqdn domain is UPPER in one, lower in the other
[2013-05-01 20:05:41 -0400] sniperd: dumontster: yfeldblum might have a better suggestion, but basically if you remove all that code out of the ruby block and just run it in the recipe at "compile time" it will be available to you.
[2013-05-01 20:05:49 -0400] sniperd: the determination code at least
[2013-05-01 20:06:24 -0400] yfeldblum: dumontster, don't just call `Dir.chdir` in chef ...
[2013-05-01 20:06:41 -0400] yfeldblum: dumontster, that will change the current dir for the remainder of the chef run, which can break potentially everything
[2013-05-01 20:06:55 -0400] sniperd: I would also namespace your attribute differently, just having node.folderName is a bit weird, do node[:app_name][:folder_name] or something
[2013-05-01 20:06:56 -0400] dumontster: yfeldblum: understood. so maybe im using the recipe incorrectly. this folder is dynamic as seen in the gist.
[2013-05-01 20:08:09 -0400] dumontster: ok i will remove the Dir.chdir. i thought it could have unintended side effect
[2013-05-01 20:08:55 -0400] dumontster: the issue is there are resources that execute before that block...to mount the drive the directory is queried from
[2013-05-01 20:09:28 -0400] dumontster: so i had that code at recipe scope and it executes too early, the machine is not in the state to allow for that directory query
[2013-05-01 20:09:29 -0400] sniperd: Ah, gotcha
[2013-05-01 20:10:01 -0400] gad0lin: ohai, i am playing with Ridley, is there a way to get nodes with all attributes from node.all ?  https://gist.github.com/gad0lin/5497969
[2013-05-01 20:11:38 -0400] gad0lin: node.find("node_name") returns node with all attr, so I can get node.automatic['cloud'], but each node from nodes.all does not have those attributes, so I would like nodes.all to return list of nodes with all attr
[2013-05-01 20:11:43 -0400] sniperd: dumontster: So, that attribute will be available in your next resource though
[2013-05-01 20:11:44 -0400] Miscreantt: Hi folks. First time taking a look at Chef. I have just installed chef-11.4.4-1.el6.x86_64.rpm on a centos 6.3 box and chef-server-ctl command is not found. Any clue?
[2013-05-01 20:11:55 -0400] sniperd: dumontster: its just nil in the recipe because thats being run before, make sense?
[2013-05-01 20:12:20 -0400] sniperd: in learn_install it should be available
[2013-05-01 20:12:24 -0400] dumontster: sniperd: im trying to pass it to the next resource/definition
[2013-05-01 20:12:29 -0400] yfeldblum: dumontster, chef expects that you can complete all your queries or determinations of what the data is up-front, when declaring all the resources; then chef can just go through and perform all the resource actions without doing queries in the middle
[2013-05-01 20:12:46 -0400] sniperd: dumontster: your assigning it in the previous resource, it will be available
[2013-05-01 20:14:27 -0400] dumontster: yfeldman: fair enough. ive written cookbooks where the state is known without issue. this is the first where i need to get the machine to a particular state, query for dynamic information, and continue upgrading the state
[2013-05-01 20:14:46 -0400] dumontster: sniperd: it's not. i thought it would be too
[2013-05-01 20:15:09 -0400] sniperd: dumontster: oh...
[2013-05-01 20:15:32 -0400] dumontster: sniperd: the log statement is [2013-05-01T14:59:27-05:00] INFO: nil
[2013-05-01 20:16:13 -0400] dumontster: sniperd: with the Chef::Log.info statement outputting [2013-05-01T14:59:27-05:00] INFO: 9.1.130072.0
[2013-05-01 20:16:14 -0400] sniperd: dumontster: thats expected though
[2013-05-01 20:16:33 -0400] sniperd: yes
[2013-05-01 20:16:39 -0400] dumontster: i guess i need to rethink my approach
[2013-05-01 20:16:41 -0400] sniperd: the log line will not work, because its outside of the scope
[2013-05-01 20:17:07 -0400] MattJ: Is it possible to reference cookbook files directly? For example in the 'source' attribute of a package resource (and so avoiding a cookbook_file to a temporary path)
[2013-05-01 20:17:13 -0400] sniperd: remember, the recipe is run through first to build a list of resources to execute or whatever, so that log line is being run before the Log.info line
[2013-05-01 20:17:37 -0400] sniperd: dumontster: If you remove line 9-11 in the gist, it wont just work, it blows up and passes nil to the version in learn_install?
[2013-05-01 20:17:52 -0400] sniperd: line 9 definitely will NOT work
[2013-05-01 20:17:52 -0400] dumontster: sniperd: i thought log is a resource?
[2013-05-01 20:18:07 -0400] sniperd: Oh
[2013-05-01 20:18:16 -0400] sniperd: perhaps it is
[2013-05-01 20:18:34 -0400] sniperd: if thats the case, then I have no clue why it wont work man.
[2013-05-01 20:19:00 -0400] dumontster: sniperd: log is a resource http://docs.opscode.com/resource_log.html i excluded the do/end
[2013-05-01 20:19:14 -0400] dumontster: sniperd: i know me neither!
[2013-05-01 20:19:36 -0400] sniperd: yfeldblum: can you chime in on this and educate dumontster and I ?
[2013-05-01 20:20:37 -0400] yfeldblum: dumontster, `log` is a resource, but there's usually no reason to use it; better to use Chef::Log.info, which is executed at "compile time" (recipe execution time)
[2013-05-01 20:20:58 -0400] sniperd: In this case though, why is node.folderName nil
[2013-05-01 20:21:12 -0400] sniperd: setting it in the resource prior should make it available to subsequent resources no?
[2013-05-01 20:21:42 -0400] yfeldblum: dumontster, you may need to make your own resource+provider for this; in your custom provider methods, you can perform any sequence of direct queries and updates (you don't need to use resources; just shell out and do them!)
[2013-05-01 20:22:25 -0400] dumontster: yfeldman: i was hoping not to go down that route but i knew it was only a matter of time, thx
[2013-05-01 20:22:43 -0400] yfeldblum: dumontster, sniperd, all aspects of declaring a resource and assigning its attributes occurs during recipe execution time ("compile time"), not converge time
[2013-05-01 20:22:59 -0400] sniperd: ah
[2013-05-01 20:23:00 -0400] mindlace: The vagrant box install seems a bit outdated
[2013-05-01 20:23:58 -0400] dumontster: yfeldman, i even tried reloading the attribute evaluation but it didn't work either
[2013-05-01 20:24:35 -0400] dumontster: sniperd, yfeldman, thanks for your input
[2013-05-01 20:24:49 -0400] sniperd: np, sorry I couldnt be of more help
[2013-05-01 20:31:02 -0400] programmerq: sorry for the off topicness, but I'm trying to update my resume. I have a section called "Objective". I'd like to indicate I want to be an automation/devops engineer. Any suggestions on how to word that?
[2013-05-01 20:31:28 -0400] programmerq: reason I ask here is because I went to the chef conference last week, and all the talks about automation resonated very well with me.
[2013-05-01 20:31:53 -0400] dumontster: programmerq, https://ops-school.readthedocs.org/en/latest/careers.html
[2013-05-01 20:32:16 -0400] dumontster: good reference for someone looking to get into ops
[2013-05-01 20:33:06 -0400] programmerq: I'm definitely already in ops-- the talks at chefconf highlighted the fact that a "system admin" is kind of the old way of doing things
[2013-05-01 20:33:08 -0400] djustin: Why is it that sometimes the node_name fqdn has all UPPER case domain, and sometimes lower case...this is causing me 401 errors while connecting to the chef-server
[2013-05-01 20:33:13 -0400] programmerq: and being an automation engineer is really the next step
[2013-05-01 20:33:20 -0400] programmerq: hmmm
[2013-05-01 20:34:20 -0400] djustin: are objective sections even the norm for resumes anymore?
[2013-05-01 20:34:27 -0400] programmerq: I don't know
[2013-05-01 20:34:32 -0400] programmerq: maybe I'm totally wrong in having one.
[2013-05-01 20:36:32 -0400] djustin: google it :)
[2013-05-01 20:37:05 -0400] programmerq: I did that first. :)
[2013-05-01 20:37:14 -0400] programmerq: I think I might just drop it altogether
[2013-05-01 20:38:47 -0400] wamilton: just call yourself an ops engineer and in your cover letter make a point of what the difference is
[2013-05-01 20:38:54 -0400] djustin: well, added node_name to my client.rb file...seems bootstrapping adds the name in a way which chef-client does not
[2013-05-01 20:52:38 -0400] david415: I'm running into CHEF-3694 when i try to send a delayed action to a LWRP multiple times from within a LWRP
[2013-05-01 20:54:00 -0400] david415: i'm writing a postfix cookbook that needs to update the map files (via the postmap command) only if a template has changed
[2013-05-01 20:54:19 -0400] david415: so i "notify" the lwrp when the template has changed
[2013-05-01 20:55:06 -0400] miah: CHEF-3694 is more a warning than an issue
[2013-05-01 20:55:35 -0400] david415: right. so the postfix_postmap lwrp's default action is :nothing
[2013-05-01 20:56:00 -0400] david415: that way it does nothing when i define it at the beginning of my postfix "multi" lwrp
[2013-05-01 20:56:25 -0400] david415: and the templates used by the multi lwrp are set to notify the postmap lwrp with action :update
[2013-05-01 20:57:03 -0400] david415: this turns out to not work.
[2013-05-01 20:59:05 -0400] miah: ya. so i basically talked about this all last week and weekend :P
[2013-05-01 20:59:38 -0400] miah: check this
[2013-05-01 20:59:38 -0400] miah: http://tickets.opscode.com/browse/CHEF-3681
[2013-05-01 21:00:33 -0400] david415: ok i'll take a look. thanks!
[2013-05-01 21:02:15 -0400] david415: damn... this should be easy!
[2013-05-01 21:02:30 -0400] david415: i want a command to run if a template is updated.
[2013-05-01 21:04:42 -0400] miah: yes, but go read about how chef's compile and convergence actually works and you'll understand why this is tricky.
[2013-05-01 21:10:37 -0400] yfeldblum: allowing resource declarations in bare provider actions was a mistake; it broke the abstraction by default (and doc'd and bragged about it) and relied on people who knew what was going on not to do it
[2013-05-01 21:11:24 -0400] yfeldblum: i'm fine with provider actions implemented as one or multiple sub-chef-runs, so long as they're self-contained
[2013-05-01 21:17:57 -0400] wamilton: yfeldblum: by bare you mean 'heavyweight' ie not LWRP ?
[2013-05-01 21:18:01 -0400] sparr: I want to install chef as part of a kickstart install of CentOS, so that chef is already installed and configured before the first time the OS boots (after which it will run the chef client and connect to the chef server)
[2013-05-01 21:18:14 -0400] yfeldblum: wamilton, no
[2013-05-01 21:18:15 -0400] sparr: are there any guidelines or packages for doing that?
[2013-05-01 21:18:43 -0400] yfeldblum: wamilton, i mean "without taking specific action", such as embedding the sub-chef-run in a block passed to a special method
[2013-05-01 21:23:31 -0400] wamilton: yfeldblum: ic, is there an example of a community cookbook that does this?
[2013-05-01 21:24:24 -0400] miah: i think the application cookbook does something like that
[2013-05-01 21:24:46 -0400] miah: i have a few cookbooks where i create resources inside either lwrp or hwrp
[2013-05-01 21:25:08 -0400] yfeldblum: wamilton, https://gist.github.com/yfeldblum/d85be145f3ff824ccc07#file-provider3-rb
[2013-05-01 21:25:10 -0400] miah: kisoku and i are doing some tests around that
[2013-05-01 21:25:35 -0400] wamilton: I definitely could not more than empirically understand wtf the application cookbook stack was doing...
[2013-05-01 21:25:44 -0400] miah: ya
[2013-05-01 21:25:49 -0400] miah: that whole cookbook needs a rewrite =)
[2013-05-01 21:26:28 -0400] wamilton: miah: I saw your talk at chefconf... is there any barrier to providing a configured resource as an attribute parameter to another resource?
[2013-05-01 21:26:45 -0400] wamilton: seems like that would make most of application cookbook unnecessary....
[2013-05-01 21:27:14 -0400] yfeldblum: wamilton, so odd ...
[2013-05-01 21:27:41 -0400] yfeldblum: wamilton, unless you mean something with a nice resource-like DSL
[2013-05-01 21:29:28 -0400] MattJ: Ok, is there a way to mark a resource as updated, from another resource?
[2013-05-01 21:29:31 -0400] miah:  wamilton shouldnt be, im working on some examples of doing just that by doing resource collection lookups. i still have some hacking to finish to prove or disprove my theorys though. but more importantly is figuring out if its a good workflow that improves cookbook usability
[2013-05-01 21:29:32 -0400] sparr: I've found a half dozen quick tutorials online for using kickstart and then chef to configure a provisioned server
[2013-05-01 21:29:39 -0400] sparr: but none of them cover how to get chef onto the server :(
[2013-05-01 21:30:16 -0400] miah: yfeldblum: yes, that was much of the point of my talk
[2013-05-01 21:30:30 -0400] wamilton: miah, yfeldblum: it seems like elementary oop ... let them use the simple interface, handle the abstraction yourself
[2013-05-01 21:30:32 -0400] miah: stop abusing the dsl, write code that does what you want
[2013-05-01 21:30:32 -0400] tomdzk: sparr: you mean, install the chef package ?
[2013-05-01 21:30:38 -0400] miah: wamilton: exactly
[2013-05-01 21:30:53 -0400] sparr: tomdzk: should there be a chef (client) package? all the chef install instructions I can find indicate it is to be installed as a ruby gem
[2013-05-01 21:31:05 -0400] tomdzk: sparr: use the chef omnibus package
[2013-05-01 21:31:30 -0400] wamilton: after it gets to a certain point, the obvious way to do DI is to allow people to send a configured resource to another resource/provider
[2013-05-01 21:31:35 -0400] tomdzk: sparr: http://www.opscode.com/blog/2012/06/29/omnibus-chef-packaging/
[2013-05-01 21:32:22 -0400] sparr: tomdzk: I'm still not sure how to *use* that. I want chef to be installed during the kickstart, not manually later
[2013-05-01 21:32:43 -0400] yfeldblum: wamilton, DI in ruby is unlike DI in java
[2013-05-01 21:33:09 -0400] tomdzk: sparr: should be as simple as adding the chef omnibus package (a .rpm) to the list of packages in your kickstart configuration
[2013-05-01 21:33:31 -0400] wamilton: yfeldblum: I'm aware, I meant it moreso in the primitive sense of "give it to me as an argument instead of relying on assumptions"
[2013-05-01 21:34:14 -0400] sparr: tomdzk: where do I get the rpm? your link leads me to http://www.opscode.com/chef/install/ which still wants to give me an installer, not a package
[2013-05-01 21:34:28 -0400] miah: sparr: read the installer
[2013-05-01 21:34:31 -0400] miah: it downloads a package
[2013-05-01 21:34:48 -0400] miah: the installer is just a shell script that determines what your os really is so that you download the right package
[2013-05-01 21:35:00 -0400] wamilton: sparr: unless you're talking about preseeding your iso somehow, this is the way to do it ^^
[2013-05-01 21:35:16 -0400] sparr: aga
[2013-05-01 21:35:18 -0400] sparr: aha, thanks
[2013-05-01 21:35:22 -0400] tomdzk: sparr: you select Enterprise Linux etc., e.g the most recent is https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chef-11.4.4-1.el6.x86_64.rpm
[2013-05-01 21:35:23 -0400] sparr: so, I think https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chef-11.4.4-1.el6.x86_64.rpm is the package I want
[2013-05-01 21:37:20 -0400] sparr: thanks all
[2013-05-01 21:37:35 -0400] sparr: ok, harder question...
[2013-05-01 21:38:05 -0400] sparr: from outside of the environment that chef is installed in (such as from the kickstart, or if I had the drive mounted elsewhere), how do I configure chef with the address of the chef server?
[2013-05-01 21:39:03 -0400] djustin: like a bootstrap?
[2013-05-01 21:39:28 -0400] sparr: not sure of the terminology
[2013-05-01 21:39:50 -0400] sparr: When the server boots for the first time, it's going to run the chef client for the first time. I want it to know, then, how to reach the chef server
[2013-05-01 21:42:32 -0400] knuckolls: sparr: dns?
[2013-05-01 21:42:40 -0400] knuckolls: if you want to go that route
[2013-05-01 21:42:42 -0400] sparr: yes, dns will be reachable
[2013-05-01 21:43:03 -0400] knuckolls: chef-server.internal.organization.com
[2013-05-01 21:43:12 -0400] knuckolls: if you want to go that route
[2013-05-01 21:43:30 -0400] knuckolls: i prefer to fire up new stuff with knife and have it bootstrap it once it's up and can ssh in
[2013-05-01 21:45:04 -0400] knuckolls: w/ knife ec2 server create, knife kvm server create, knife bootstrap, etc
[2013-05-01 21:45:50 -0400] shane__: any reason why chef would seemingly ignore a notify for a service start with an immediately priority?
[2013-05-01 21:46:08 -0400] jstallard: sparr: http://docs.opscode.com/config_rb_client.html
[2013-05-01 21:46:19 -0400] jstallard: sparr: you're probably looking for chef_server_url
[2013-05-01 21:46:36 -0400] sparr: knuckolls: that's all later than what I'm doing, but thanks
[2013-05-01 21:47:14 -0400] jstallard: sparr: you essentially want chef to get installed and configured when you kickstart, then register itself automagically w/ the chef server on first boot?
[2013-05-01 21:47:19 -0400] sparr: jstallard: thanks, that's probably what I need. I should be able to modify that file with the kickstart script
[2013-05-01 21:47:22 -0400] sparr: yes
[2013-05-01 21:47:36 -0400] bugoff:  /7
[2013-05-01 21:47:46 -0400] jstallard: yeah...that's the file you'll need. You'll also need to ensure your validation key is installed at kickstart time
[2013-05-01 21:49:43 -0400] jstallard: sparr: also see: http://wiki.opscode.com/display/chef/Configuring+Chef+Client
[2013-05-01 21:50:44 -0400] spheromak: kisoku: you round ?
[2013-05-01 21:58:24 -0400] sparr: I want to have a cookbook and recipe that configure the network on a server (IP, netmask, etc) to some specific-per-server values. How might I accomplish that?
[2013-05-01 22:01:17 -0400] cjerdonek: what is a good way to communicate state across recipes? i'd like one recipe to behave differently depending on whether another recipe updated a file.
[2013-05-01 22:02:24 -0400] sparr: I've heard it suggested that I put the desired configuration into attributes for the node, or into a data bag. I'm not sure on the pros and cons of either, or if there are existing recipes to handle them.
[2013-05-01 22:03:42 -0400] targs: anyone know of a chef cookbook to configure a chef workstation?
[2013-05-01 22:03:43 -0400] cjerdonek: sparr: yeah, that's a possibility
[2013-05-01 22:04:06 -0400] wamilton: nc 0
[2013-05-01 22:04:23 -0400] wamilton: sorry... ignore me wrong xterm etc
[2013-05-01 22:07:57 -0400] djustin: anyone here familiar with knife-vsphere?
[2013-05-01 22:12:22 -0400] programmerq: jtimberman: what was the acronym for the release you were telling me about at the conference?
[2013-05-01 22:12:25 -0400] programmerq: CRA? CMA?
[2013-05-01 22:12:32 -0400] programmerq: (so I can submit code to opscode)
[2013-05-01 22:12:42 -0400] programmerq: I lost the scratch paper I wrote it down on. :/
[2013-05-01 22:13:46 -0400] gleam: cla
[2013-05-01 22:23:46 -0400] hdee: hey guys... i'm trying to bootstrap a client that has to connect to chef server on a secondary ip address... the initial checkin is fine but when client pulls cookbooks, it's getting information that uses the wrong ip address
[2013-05-01 22:23:50 -0400] hdee: http://pastebin.com/6zNQjsEU
[2013-05-01 22:24:05 -0400] hdee: i copied a bit of the output there
[2013-05-01 22:24:31 -0400] hdee: i'm trying to figure out how to make chef-master return the proper ip address for the url field
[2013-05-01 22:24:33 -0400] hdee: any ideas?
[2013-05-01 22:33:31 -0400] shane__: im trying to start a service by specifying "immediately" on the notify but chef seems to be ignoring it
[2013-05-01 22:33:35 -0400] shane__: any reason for that?
[2013-05-01 22:44:29 -0400] drgage: hi folks. this is invalid syntax, but you can see what i wish to do. what's the valid syntax? : <% if node.roles.include?('foo','bar','baz') %>
[2013-05-01 22:46:03 -0400] miah: which part is failing?
[2013-05-01 22:47:07 -0400] drgage: miah, who are you responding to?
[2013-05-01 22:47:26 -0400] miah: ('foo', 'bar', 'baz') looks awful array like but you're passing them in as an argument to a method that probably expects a single argument
[2013-05-01 22:47:46 -0400] drgage: indeed, it says wrong number of arguments (3 for 1)
[2013-05-01 22:47:51 -0400] miah: yup
[2013-05-01 22:47:59 -0400] drgage: this is a problem of drgage doesn't know ruby, i'm sure
[2013-05-01 22:48:16 -0400] miah: its easier when asking for help if you provide stack traces or details of your problem rather than making people figure it out =)
[2013-05-01 22:48:59 -0400] miah: try passing an array to include?() rather than 3 strings.
[2013-05-01 22:49:26 -0400] drgage: ok, i'll look up the syntax for that. thanks.
[2013-05-01 22:53:08 -0400] david415: is it possible for a role attribute to refer to node attribute set from a different cookbook?
[2013-05-01 22:54:09 -0400] miah: no
[2013-05-01 22:54:23 -0400] miah: think of attributes as global variables that get merged on a node
[2013-05-01 22:55:58 -0400] miah: i suppose what i mean by this is, its safe to define attributes in roles and/or cookbooks. but when they get all merged if you cant predict the results you're in for a world of hurt
[2013-05-01 22:56:16 -0400] miah: but you cant have a role refer to a attribute provided by something else so that you can do something to that attribute in the role
[2013-05-01 22:57:01 -0400] miah: you can define an attribute in a role, and assign a precedence level to it. it doesnt matter if its defined elsewhere. when the node converges the attributes it doesnt really matter what their 'source' is, only their precedence level
[2013-05-01 23:03:52 -0400] sniperd: drgage: Im pretty sure you cant pass .include? an array
[2013-05-01 23:04:07 -0400] sniperd: Well, you can, but it will look for that array itself
[2013-05-01 23:04:33 -0400] sniperd: [1,2,3].include?([1,2]) will litterally look for [[1,2],3]
[2013-05-01 23:05:05 -0400] sniperd: look at like... node.roles & ["role[base]"] or some such
[2013-05-01 23:05:26 -0400] joonas: you could do [1,2,3].include?(*[1,2])
[2013-05-01 23:05:27 -0400] joonas: :P
[2013-05-01 23:05:51 -0400] sniperd: This is very true
[2013-05-01 23:06:14 -0400] joonas: oh wait, no you couldn't
[2013-05-01 23:06:20 -0400] joonas: that'd be 2 args :/
[2013-05-01 23:06:41 -0400] sniperd: [[1],2,3].include?(*[2])
[2013-05-01 23:06:44 -0400] sniperd: it works...
[2013-05-01 23:06:51 -0400] joonas: you could do [1, 2, 3] & [1, 2]
[2013-05-01 23:06:56 -0400] sniperd: right
[2013-05-01 23:06:56 -0400] joonas: or something
[2013-05-01 23:07:32 -0400] shane__: why would chef trigger a restart of a service after installing a certain package even though i have not told it to in the recipe?
[2013-05-01 23:07:36 -0400] sniperd: what is *[1,2] doing in that include?
[2013-05-01 23:07:59 -0400] sniperd: shane__: is chef triggering it or is being done in the packages post install scripts?
[2013-05-01 23:08:03 -0400] joonas: * expands the arguments from [1, 2]
[2013-05-01 23:08:19 -0400] sniperd: hrm
[2013-05-01 23:11:20 -0400] whack: Trying to start using berkshelf, getting SSL failures on 'berks upload' (but knife spork upload and knife cookbook upload both are fine)
[2013-05-01 23:13:10 -0400] kisoku: spheromak: am now, briefly
[2013-05-01 23:13:40 -0400] spheromak: ah just was looking for your example on the accumulator
[2013-05-01 23:13:48 -0400] spheromak: also you have no name attribute in the cook :D
[2013-05-01 23:14:09 -0400] whack: here's the error from berks upload: https://gist.github.com/jordansissel/a8a98705eaaef76cd7a9
[2013-05-01 23:16:29 -0400] wc-: hi all, i am trying to bootstrap my first server using hosted chef, when i run bootstrap i get Chef encountered an error attempting to create the client "figs" and a stacktrace with a 400 bad request message in it
[2013-05-01 23:17:07 -0400] eightbits: I've already asked this but wasn't able to get a solution.  With as many people as I've seen come and go I'd like to try again.
[2013-05-01 23:17:07 -0400] eightbits: I'm new to chef and having trouble getting knife to upload a cookbook.  I can use knife to create users and grab certs, list of users, lists of clients, etc...  But attempting to upload a cookbook results in "ERROR: Network Error: Connection refused - connect(2)/opt/chef/embedded/lib/ruby/1.9.1/net/http.rb:762:in `initialize': Connection refused - connect(2) (Errno::ECONNREFUSED)"
[2013-05-01 23:17:08 -0400] eightbits: I have seen that this could be cuased by not having an FQDN set on the system before installing/configuring chef server, but I did.  I even wiped out the VM, reinstalled, and verified the FQDN before installing chef-server on it again.  I've also tried using the chef-server.rb posted here to no avail: https://gist.github.com/spheromak/5017833
[2013-05-01 23:17:08 -0400] eightbits: What else can I do to find the source of the problem?
[2013-05-01 23:17:30 -0400] spheromak: eightbits: you using the newest version of chef-server ?
[2013-05-01 23:17:45 -0400] wc-: i have tried to google around for chef 400 bad request but i dont seem to be finding anything, it seems to be starting the chef client fine
[2013-05-01 23:17:47 -0400] eightbits: Yes.  11.0.6
[2013-05-01 23:19:10 -0400] spheromak: eightbits: run with -VV your upload
[2013-05-01 23:20:14 -0400] wc-: my role only has one run list item, im just trying to install git to test things out
[2013-05-01 23:21:20 -0400] wc-: oh weird, i changed --ssh-user to -x
[2013-05-01 23:21:25 -0400] wc-: and its installing git
[2013-05-01 23:21:56 -0400] spheromak: eightbits: give us a pastie/gist of that looking for info on what host it couldn't connect too.. I suspect your bookshelf service is redirecting to a name from when the server was configured.
[2013-05-01 23:25:10 -0400] eightbits: OK.  I'll get it posted in a sec.
[2013-05-01 23:26:26 -0400] franzaz_: deploy resource question - ruby app is deployed.  I want to update an attribute in the template file within 'current/config/blah.yml'  I changed the attribute and uploaded cookbook.  But when I run, chef says, "You're running the latest revision" and doesn't make the template file change.  Any trickery around this?
[2013-05-01 23:32:56 -0400] eightbits: http://pastie.org/private/mnm0xqol8wvth33a9tajq
[2013-05-01 23:36:49 -0400] eightbits: I spheromak - I do see one line where the hostname gets reversed in an HTTP location header but the upload attempts themselves are going to the proper hostname.
[2013-05-01 23:37:54 -0400] rb1980: greetings, chefs
[2013-05-01 23:39:04 -0400] rb1980: can I get a sanity check on this: I attempted to write a recipe to make sure a particular service is disabled and stopped on certain nodes.
[2013-05-01 23:39:26 -0400] rb1980: however, I get an error when it tries to stop the service because it's already stopped.
[2013-05-01 23:39:33 -0400] yfeldblum: eightbits, is that FQDN actually known to your workstation?
[2013-05-01 23:39:36 -0400] rb1980: surely this seems illogical
[2013-05-01 23:40:48 -0400] josephholsten: rb1980: I know I've hit that before. I don't remember where. what service provider are you using, init, upstart?
[2013-05-01 23:40:57 -0400] rb1980: this is on centos 6.4 with upstart provider
[2013-05-01 23:41:22 -0400] rb1980: I get: Expected process to exit with [0], but received '1'
[2013-05-01 23:41:24 -0400] josephholsten: what's the return code of a 'service foo stop'?
[2013-05-01 23:41:26 -0400] josephholsten: hmm
[2013-05-01 23:41:38 -0400] rb1980: Ran /sbin/service foo stop returned 1
[2013-05-01 23:41:53 -0400] DaveStern: Hello all, I am having a devil of a time getting the mysql::server opscode recipe to work on Ubuntu 12.04. Appears to work correctly in the chef run until it tries to restart mysql, then I get something actually similar to what rb1980 is apparently talking about
[2013-05-01 23:42:35 -0400] rb1980: chef-client version is 11.4.4
[2013-05-01 23:42:42 -0400] josephholsten: DaveStern: is your mysql.cnf valid? it might fail to restart in that case.
[2013-05-01 23:45:27 -0400] DaveStern: josephholsten: I assume it's valid, I'm not doing anything with it besides using standard attributes, the syntax of which I believe is correct. Is there a good way to validate my assumption in the generated conf file itself or on the chef side of things?
[2013-05-01 23:48:30 -0400] rb1980: I just don't understand: if I ask chef to stop the service, and if it's already stopped it results in error due to exit code 1, how is that idempotent?
[2013-05-01 23:48:43 -0400] rb1980: or is this a bug perhaps?
[2013-05-01 23:50:27 -0400] Majost: When writing an LWRP which needs a gem, how does one properly call chef_gem to ensure the gem is available for the LWRP?
[2013-05-01 23:51:09 -0400] spheromak: eightbits: its the response probably
[2013-05-01 23:52:27 -0400] pcn: rb1980: why is the stop script returning an error?
[2013-05-01 23:52:56 -0400] josephholsten: rb1980: do you explicitly say the service "supports status: true"? that may be required to work around a complaining service script
[2013-05-01 23:53:02 -0400] rb1980: if the service is not running, it returns 1, if the service was running and it stops it, it returns 0
[2013-05-01 23:53:23 -0400] rb1980: so chef stops it the first time, then fails on subsequent attempts
[2013-05-01 23:53:42 -0400] josephholsten: also, are you using the "provider Chef::Provider::Service::Upstart"
[2013-05-01 23:53:50 -0400] rb1980: lemme check...
[2013-05-01 23:54:05 -0400] spheromak: eightbits: If setting those setting sin server.rb and running chef-server-ctl reconfigure didn't fix it i dunno. you can try setting the server name to the ip addr and rule out lookup/hosts foo for any of it. I do that in some vagrant stuff i have
[2013-05-01 23:54:36 -0400] josephholsten: DaveStern: you ought to be able to just run mysqld in a shell
[2013-05-01 23:54:38 -0400] rb1980: i am not specifying upstart provider explicitly, but that is clearly what is being chosen
[2013-05-01 23:54:43 -0400] rb1980: and i have: supports :status => true, :start => true, :stop => true, :restart => true
[2013-05-01 23:55:07 -0400] yfeldblum: Majost, demand that the caller install the gem, and require the gem at the start of each provider action
[2013-05-01 23:55:15 -0400] wc-: im trying to create a new user using the users cookbook, i have recipe[users] in my run_list, and a databag where i just copied the example from the users cookbook's github page
[2013-05-01 23:55:33 -0400] wc-: when i run bootstrap, i see it syncrhonizes the users cookbook then nothing happens
[2013-05-01 23:55:38 -0400] wc-: and the user is not created
[2013-05-01 23:55:41 -0400] DaveStern: josephholsten: I'll try once this latest chef run is done, I've been getting an error about the socket file not being found when I try to do so.
[2013-05-01 23:55:58 -0400] wc-: do i need to do something other than add the users recipe to my run list?
[2013-05-01 23:56:10 -0400] josephholsten: wc-: you want the 'users::sysadmins' recipe, not the default
[2013-05-01 23:57:02 -0400] wc-: ok trying that now
[2013-05-01 23:57:04 -0400] yfeldblum: Majost, https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_mysql.rb#L27-L29
[2013-05-01 23:57:11 -0400] wc-: so jsut the users recipe is for including this in your own recipes i guess?
[2013-05-01 23:57:49 -0400] josephholsten: wc-: yep, and you don't even really need to include the recipe. just depend on the cookbook and the lwrps are available
[2013-05-01 23:58:03 -0400] wc-: it worked!
[2013-05-01 23:58:04 -0400] DaveStern: Hrmm, trying to run mysqld get's the following
[2013-05-01 23:58:07 -0400] wc-: looks like i need to set the bash
[2013-05-01 23:58:15 -0400] wc-: whats the right way to add this user to sudoers?
[2013-05-01 23:58:30 -0400] DaveStern: 130501 19:57:23 [Warning] The syntax '--log-slow-queries' is deprecated and will be removed in a future release. Please use '--slow-query-log'/'--slow-query-log-file' instead.
[2013-05-01 23:58:31 -0400] DaveStern: 130501 19:57:23 [Warning] Can't create test file /var/lib/mysql/jarvis.lower-test
[2013-05-01 23:58:33 -0400] DaveStern: 130501 19:57:23 [Warning] Can't create test file /var/lib/mysql/jarvis.lower-test
[2013-05-01 23:58:34 -0400] DaveStern: mysqld: Can't change dir to '/var/lib/mysql/' (Errcode: 13)
[2013-05-01 23:58:35 -0400] DaveStern: 130501 19:57:23 [ERROR] Aborting
[2013-05-01 23:58:36 -0400] DaveStern: 130501 19:57:23 [Note] mysqld: Shutdown complete
[2013-05-01 23:58:52 -0400] wc-: i have the user in the sysadmins group
[2013-05-01 23:59:26 -0400] wc-: is giving a user sudo permissions somethign i should do in my own recipe after the user is created?
[2013-05-01 23:59:53 -0400] monokrome: How can I use data_bag_item from a role file?
