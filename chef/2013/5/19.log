[2013-05-19 00:10:04 -0400] coderanger: gzc: What are you trying to do?
[2013-05-19 00:10:26 -0400] gzc: get chef-server deployed via chef-solo
[2013-05-19 00:10:44 -0400] coderanger: Use omnibus
[2013-05-19 00:10:45 -0400] gzc: (i'm aware that there are also shell scripts from opscode + knife-server to handle this, mostly)
[2013-05-19 00:10:53 -0400] coderanger: That is only way to install chef server at this point
[2013-05-19 00:11:05 -0400] gzc: sounds good, thanks
[2013-05-19 00:11:23 -0400] coderanger: The omnibus server builds include their own solo cookbooks for configuration and whatnot
[2013-05-19 00:11:28 -0400] coderanger: ships as part of the package
[2013-05-19 00:12:08 -0400] gzc: fair enough, I probably shouldn't worry about it
[2013-05-19 00:12:40 -0400] cyclic: hey
[2013-05-19 00:12:44 -0400] gzc: i'm just trying to make it zero-touch to get a chef server installed
[2013-05-19 00:13:02 -0400] coderanger: gzc: We already did that for you :)
[2013-05-19 00:13:16 -0400] gzc: hooray! :)
[2013-05-19 00:14:05 -0400] cyclic: I've configured a new layer in Amazon OpsWorks, and added my git repository to the layer's custom setup section. When I try to start a new instance, it says it' can't find the recipe named mongodb:default: [Sat, 18 May 2013 16:54:27 +0000] ERROR: Caught exception during execution of custom recipe: mongodb::default: ArgumentError - Cannot find a recipe matching default in cookbook mongodb - /opt/aws/opsworks/releases/20130515001926_119/ve
[2013-05-19 00:14:30 -0400] gzc: I'll just have a shell provisioner run the reconfigure part
[2013-05-19 00:14:42 -0400] cyclic: I've tried mongodb:default and default, and just mongodb, and just empty, but they all say that they can't find the recipe.
[2013-05-19 00:15:14 -0400] coderanger: cyclic: Sounds like your repo isn't setup in such a way that solo can find your cookbooks, but that would be something specific to opsworks probably
[2013-05-19 00:15:26 -0400] cyclic: coderanger: here is my repo: https://github.com/Cyclic/chef-mongodb
[2013-05-19 00:15:32 -0400] coderanger: That file should be in cookbooks/mongodb/recipes/default.rb?
[2013-05-19 00:16:44 -0400] cyclic: here is how they have it setup for various cookbooks/recipes... https://github.com/aws/opsworks-cookbooks
[2013-05-19 00:17:14 -0400] cyclic: coderanger: do I need that full in my repo, or should it just be mongodb/recipes/default.rb  ?
[2013-05-19 00:18:18 -0400] cyclic: In their example, they have the recipes folder right off the root:  http://docs.aws.amazon.com/opsworks/latest/userguide/gettingstarted.walkthrough.photoapp.3.html
[2013-05-19 00:19:20 -0400] cyclic: coderanger: I basically copied how they have it setup here:  http://docs.aws.amazon.com/opsworks/latest/userguide/images/psb6a.png
[2013-05-19 00:20:38 -0400] coderanger: Sounds like it should just be mongodb/recipes/default.rb
[2013-05-19 00:20:56 -0400] coderanger: You can't use the cookbook repo you pasted though
[2013-05-19 00:21:00 -0400] coderanger: thats just a single cookbook
[2013-05-19 00:25:34 -0400] cyclic: coderanger: this better?  https://github.com/Cyclic/cookbooks
[2013-05-19 00:25:49 -0400] coderanger: yes
[2013-05-19 00:27:35 -0400] cyclic: k thanks! Testing now :)
[2013-05-19 00:35:28 -0400] cyclic: .../opt/aws/opsworks/current/site-cookbooks/mongodb/definitions/mongodb.rb:24: syntax error, unexpected tASSOC, expecting $end :dbpath => "/data", :configfile => "/etc...
[2013-05-19 01:02:07 -0400] flipture: Hey, if im creating an object in main, how could i access it from a method in the same class (but outside of main) so that I could serialize it?
[2013-05-19 01:12:54 -0400] volker-: hi
[2013-05-19 01:13:08 -0400] volker-: was there a recent change in the way attributes can be called?
[2013-05-19 01:13:25 -0400] volker-: ackages = node['install-pkgs'][node[:platform]][node[:platform_version]] || %w{ } does not work anymore
[2013-05-19 01:14:42 -0400] volker-: when I try to debug, it seems that as soon as it finds node['cookbook']['ubuntu'] a file starting with ubuntu, it only takes the first one and ignores all the later ones
[2013-05-19 01:26:29 -0400] ryker: ssd7: any chance you are around? :) I made some changes and it's better but still one more problem.
[2013-05-19 01:46:22 -0400] guiambros: I'm trying to use knife ec2 server create to automatically launch ec2 instances, but I'm getting "ERROR: Excon::Errors::BadRequest: Expected(200) <=> Actual(400 Bad Request)". Any idea how to troubleshoot knife ec2 scripts?
[2013-05-19 01:46:32 -0400] guiambros: knife ec2 server list works fine
[2013-05-19 01:55:19 -0400] cyclic: is there a way to make filet mignon?
[2013-05-19 01:55:25 -0400] cyclic: I'z hungry
[2013-05-19 02:19:34 -0400] jtran: is it possible to have definitions inside of a recipe?  or do i have to make a provider?
[2013-05-19 02:55:57 -0400] cyclic: Hey, anyone know how I can resolve this?  undefined method `yum_repository'
[2013-05-19 02:56:15 -0400] cyclic: Caught exception during execution of custom recipe: mongodb::10gen_repo: NoMethodError - undefined method yum_repository' for #<Chef::Recipe:0x7fc08690ff80>
[2013-05-19 02:56:55 -0400] cyclic: how can I add a repo to an amazon linux instance?
[2013-05-19 03:01:05 -0400] sax_: maybe you're missing the yum cookbook?
[2013-05-19 03:01:27 -0400] sax_: that looks like you have a recipe that depends on yum but does not declare it in its metadata
[2013-05-19 03:03:33 -0400] cyclic: sax_: even though the amazon linux instance has yum installed by default, I need to add a yum recipe as well? Can you point me to the correct recipe for the yum stuff?
[2013-05-19 03:05:10 -0400] sax_: correct. the recipe you're running is not just trying to install something via yum, it's trying to configure yum.
[2013-05-19 03:05:11 -0400] sax_: http://community.opscode.com/cookbooks/yum
[2013-05-19 03:06:12 -0400] sax_: ah, yeah. is this the recipe you're using? https://github.com/edelight/chef-mongodb/blob/master/recipes/10gen_repo.rb
[2013-05-19 03:06:43 -0400] sax_: that is configuring yum to also install packages from http://downloads-distro.mongodb.org/repo/redhat/os/#{node['kernel']['machine']  =~ /x86_64/ ? 'x86_64' : 'i686'}"
[2013-05-19 03:07:04 -0400] cyclic: sax_: yeah that's the one
[2013-05-19 03:08:01 -0400] cyclic: sax_: do you know which yum recipe I need to use for amazon linux?
[2013-05-19 03:09:26 -0400] sax_: not sure I deploy to a different platform. but try adding yum::default to the run_list before mongodb::10gem_repo
[2013-05-19 03:10:06 -0400] sax_: cyclic: that should ensure that the yum_repository provider is available
[2013-05-19 03:10:45 -0400] jtran: hey all.  anyone ever use resource 'mysql_database "foo" do action :create end?   I've tried using it in one of my recipes but I get   "Host myhost is not allowed to connect to this MySQL server"     when I installed mysql server i made sure  node['mysql']['allow_remote_host'] = true.  what else am i missing?
[2013-05-19 03:10:46 -0400] cyclic: in that link on opscode that you sent me, it says that the default recipe does nothing: http://community.opscode.com/cookbooks/yum
[2013-05-19 03:10:50 -0400] jtran: funny thing is it worked ONCE
[2013-05-19 03:12:27 -0400] cyclic: sax_: I believe yum::yum is the one
[2013-05-19 03:12:55 -0400] sax_: cyclic: correct. but by loading that recipe, chef loads the cookbook. when the cookbook loads, its providers are loaded.
[2013-05-19 03:13:13 -0400] cyclic: oh i see
[2013-05-19 03:13:19 -0400] sax_: cyclic: it's not very intuitive, unfortunately
[2013-05-19 03:13:22 -0400] cyclic: sax_: so really I just need the providers
[2013-05-19 03:13:38 -0400] cyclic: then that stuff will just work that was breaking before
[2013-05-19 03:13:44 -0400] sax_: cyclic: yeah. you'll see that in a lot of open source cookbooks
[2013-05-19 03:13:50 -0400] sax_: cyclic: hopefully ;)
[2013-05-19 03:13:56 -0400] cyclic: haha
[2013-05-19 03:14:03 -0400] cyclic: sax_: and then the next thing will break
[2013-05-19 03:14:36 -0400] sax_: cyclic: yeah, I find it often takes a few tries when bringing in a new community cookbook.
[2013-05-19 03:15:03 -0400] cyclic: sax_: I'm going to put $50 on it working this time. :)
[2013-05-19 03:15:41 -0400] sax_: cyclic: actually, you probably already have the cookbook. the metadata file declares the dependency here https://github.com/edelight/chef-mongodb/blob/master/metadata.rb#L16
[2013-05-19 03:16:11 -0400] cyclic: ah yeah
[2013-05-19 03:16:14 -0400] sax_: cyclic: but it would need to explicitly `include_recipe 'yum'` in order to ensure that the providers are loaded.
[2013-05-19 03:17:05 -0400] cyclic: but if I just do yum::default, like you said, in the setup section of my layer's custom recipe, it should work?
[2013-05-19 03:17:13 -0400] cyclic: sax_: it should load the providers?
[2013-05-19 03:17:16 -0400] sax_: cyclic: it should.
[2013-05-19 03:18:14 -0400] cyclic: ah crap
[2013-05-19 03:18:18 -0400] cyclic: it only allows one repo url
[2013-05-19 03:18:24 -0400] sax_: doh!
[2013-05-19 03:19:38 -0400] cyclic: what if I add include_recipe 'yum' in the forked repo I have of mongodb, and put include_recipe 'yum' inside the 10gen_repo recipe? Where would I put it?
[2013-05-19 03:21:25 -0400] sax_: between these lines https://github.com/edelight/chef-mongodb/blob/master/recipes/10gen_repo.rb#L42-L43
[2013-05-19 03:28:01 -0400] cyclic: k, I added the yum repo to my cookbooks repo to try that first.
[2013-05-19 03:28:07 -0400] cyclic: I'll try yum:default
[2013-05-19 03:34:01 -0400] cyclic: sax_: [Sun, 19 May 2013 03:33:06 +0000] ERROR: ruby_block[Load the custom cookbooks] (/opt/aws/opsworks/releases/20130515001926_119/cookbooks/opsworks_custom_cookbooks/recipes/load.rb:10:in `from_file') had an error: undefined method `default_action' for #<Class:0x7f01e5f63798>
[2013-05-19 03:34:13 -0400] cyclic: That's what happened when I tried using the yum::default
[2013-05-19 03:34:39 -0400] sax_: what version of chef are you using?
[2013-05-19 03:35:37 -0400] cyclic: I don't know. It's whatever amazon opsworks uses
[2013-05-19 03:37:10 -0400] sax_: hm default_action came in chef 0.10.10 going to a newer chef would be nice, but you can also go back to an older version of the cookbook.
[2013-05-19 03:37:35 -0400] sax_: looking up older versions of yum
[2013-05-19 03:38:52 -0400] cyclic: what if I just use yum::yum?
[2013-05-19 03:40:06 -0400] sax_: you know, I'm not seeing default_action in the cookbook. maybe it's not what I think it is.
[2013-05-19 03:40:25 -0400] cyclic: yeah, i think it's because the yum default recipe is totally empty
[2013-05-19 03:40:30 -0400] cyclic: it must be an internal function
[2013-05-19 03:40:36 -0400] sax_: oh, I see
[2013-05-19 03:40:46 -0400] sax_: maybe it's in the yum_key provider?
[2013-05-19 03:42:35 -0400] sax_: yeah. the last version of yum without default_action is 0.8.2
[2013-05-19 03:43:40 -0400] cyclic: oh
[2013-05-19 03:43:41 -0400] sax_: https://github.com/opscode-cookbooks/yum/blob/0.8.2/resources/key.rb vs https://github.com/opscode-cookbooks/yum/blob/2.2.2/resources/key.rb
[2013-05-19 03:43:55 -0400] sax_: so when the cookbook loads, all the providers load
[2013-05-19 03:44:55 -0400] cyclic: so I should use that version instead?
[2013-05-19 03:45:00 -0400] sax_: yeah, try that.
[2013-05-19 03:45:04 -0400] cyclic: k
[2013-05-19 03:46:30 -0400] sax_: you're probably going to run into that problem again with other cookbooks, unfortunately. default_action was added to chef about a year ago.
[2013-05-19 03:47:00 -0400] sax_: though maybe only with newer cookbooks.
[2013-05-19 03:47:59 -0400] cyclic: good to know :)
[2013-05-19 03:48:11 -0400] cyclic: starting a new instance now to see what it says about all this stuff
[2013-05-19 03:48:32 -0400] jtran: can anyone tell me why this is in a ruby_block in a recipe?  http://pastebin.com/4JwJCYnb
[2013-05-19 03:48:46 -0400] jtran: i don't see any advantage of having it inone
[2013-05-19 03:50:49 -0400] sax_: does it need to be set at converge time, after other code has run?
[2013-05-19 03:51:00 -0400] sax_: otherwise it would run at compile time
[2013-05-19 03:57:04 -0400] cyclic: sax_: looks like the setup ran!
[2013-05-19 03:57:11 -0400] sax_: awesome!
[2013-05-19 03:58:43 -0400] cyclic: [Sun, 19 May 2013 03:55:04 +0000] INFO: Adding 10gen repository to /etc/yum.repos.d/10gen.repo
[2013-05-19 03:59:25 -0400] cyclic: sax_: doh!  [Sun, 19 May 2013 03:58:14 +0000] DEBUG: Processing link[] on venus.localdomain [Sun, 19 May 2013 03:58:14 +0000] ERROR: link[] (/opt/aws/opsworks/current/site-cookbooks/mongodb/definitions/mongodb.rb:122:in `from_file') had an error: can't convert nil into String
[2013-05-19 04:00:01 -0400] sax_: the joy of cooking with chef :P
[2013-05-19 04:01:22 -0400] sax_: actually, this is the joy of figuring out whether it's a problem with a cookbook, or a problem with how you're configuring the cookbook.
[2013-05-19 04:01:48 -0400] cyclic: sax_: it's this stuff I added:  https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L122-L127
[2013-05-19 04:02:18 -0400] cyclic: any idea what it is complaining is nil?
[2013-05-19 04:03:10 -0400] cyclic: I'm trying to add a link to /data/journal from the volume /journal
[2013-05-19 04:05:22 -0400] cyclic: oh oops
[2013-05-19 04:05:24 -0400] jtran: if i need to run a select statement against mysql connection and return results, is there a way to do that with the 'mysql_resource'  LWRP?   I see there is an 'action :query' for that LWRP, but how do i receive the return results?
[2013-05-19 04:05:28 -0400] cyclic: can't use owner and group on symbolic links
[2013-05-19 04:05:33 -0400] sax_: oh, yeah
[2013-05-19 04:06:30 -0400] sax_: hm.  you should be able to. though maybe that's a chef version thing.
[2013-05-19 04:06:39 -0400] cyclic: is this a symbolic link?   sudo ln -s /journal /data/journal
[2013-05-19 04:06:39 -0400] sax_: are you sure that user and group are values, and not nil?
[2013-05-19 04:06:45 -0400] sax_: correct
[2013-05-19 04:06:46 -0400] cyclic: yeah
[2013-05-19 04:06:57 -0400] cyclic: it should be ok without them
[2013-05-19 04:07:45 -0400] sax_: is journal the volume, or data\/journal
[2013-05-19 04:07:52 -0400] cyclic: journal
[2013-05-19 04:08:34 -0400] sax_: cool.
[2013-05-19 04:08:37 -0400] cyclic: :)
[2013-05-19 04:08:54 -0400] cyclic: you've been an immense help
[2013-05-19 04:09:14 -0400] cyclic: thank you sax_
[2013-05-19 04:11:36 -0400] sax_: no problem. those types of problems usually drive me to code and fume in anger. glad to help you avoid that :)
[2013-05-19 04:23:28 -0400] cyclic: sax_: haha... I usually just panic and bang my head on the wall for a few hours, and then go to sleep.
[2013-05-19 04:55:29 -0400] cyclic: sax_: it looks like adding that yum version or something might have broken the default yum. It's complaining about installing SQLlite in the opsworks actions, which I can't remove: https://gist.github.com/Cyclic/5606735
[2013-05-19 04:56:38 -0400] sax_: yeah it's probably trying to install it from the wrong repo
[2013-05-19 04:57:36 -0400] sax_: something in opsworks is trying to install an amazon specific version, but it's probably only searching the 10gen yum repo
[2013-05-19 04:59:48 -0400] cyclic: well, there are different steps. If I could somehow go back to the amazon repo before it goes on to their stuff, which would just mean adding a custom recipe after my 10gen repo install runs for mongodb.
[2013-05-19 05:01:09 -0400] sax_: is their installation at all configurable? like could you set it to install a non-amazon version of sqlite?
[2013-05-19 05:01:27 -0400] cyclic: it's not recommended
[2013-05-19 05:01:35 -0400] sax_: or can yum be configured to actually search both repos?
[2013-05-19 05:01:39 -0400] cyclic: but yeah, I think I have to override all of their custom scripts
[2013-05-19 05:01:56 -0400] cyclic: having it search both repos would be ideal
[2013-05-19 05:02:31 -0400] sax_: or this is crazy, but can you wrap the mongodb cookbook with your own recipe that removes the 10gen repo after installing it?
[2013-05-19 05:03:00 -0400] cyclic: that's what I was thinking too
[2013-05-19 05:03:27 -0400] sax_: create your own recipe that does include_recipe to install mongo, then fix the yum repo
[2013-05-19 05:04:31 -0400] sax_: I would try to make it conditional to only actually install mongo once, so you don't update yum on every chef run.
[2013-05-19 05:06:43 -0400] cyclic_: sorry
[2013-05-19 05:06:51 -0400] cyclic_: my safari was about to implode
[2013-05-19 05:06:54 -0400] cyclic_: sax_:
[2013-05-19 05:07:42 -0400] cyclic_: I'm not sure how exactly to only run the 10gen repo during the install
[2013-05-19 05:07:50 -0400] cyclic_: let me see if I can find their repo chef
[2013-05-19 05:07:54 -0400] cyclic_: cause I could just run that again
[2013-05-19 05:09:11 -0400] cyclic_: this might be it: https://github.com/aws/opsworks-cookbooks/blob/master/dependencies/recipes/default.rb
[2013-05-19 05:10:14 -0400] sax_: try it? I'm not sure how that would work with the yum_repository provider running in the mongodb cookbook
[2013-05-19 05:10:17 -0400] cyclic_: this is their initial setup: https://github.com/aws/opsworks-cookbooks/blob/master/opsworks_initial_setup/recipes/default.rb
[2013-05-19 05:11:01 -0400] cyclic_: oh
[2013-05-19 05:11:10 -0400] cyclic_: setup_rhel_repos
[2013-05-19 05:12:31 -0400] sax_: so I think you could also run the mongodb::mongos to configure mongo
[2013-05-19 05:12:41 -0400] sax_: but only run 10gen_repo if mongo is not already installed
[2013-05-19 05:13:06 -0400] cyclic_: mongos? isn't that for the shard or something?
[2013-05-19 05:13:23 -0400] cyclic_: yeah 10gen_repo is needed b/c it can't find the repo for it
[2013-05-19 05:13:28 -0400] cyclic_: err
[2013-05-19 05:13:31 -0400] cyclic_: the package for mongo
[2013-05-19 05:15:46 -0400] sax_: I was thinking write a recipe that runs 10gen_repo and the mongodb install recipe (only if not already installed), then fixes the yum repos and then runs the mongo configuration recipes.
[2013-05-19 05:16:12 -0400] cyclic_: oh I see
[2013-05-19 05:16:24 -0400] cyclic_: well that's kind of what I'm doing, except the last step
[2013-05-19 05:16:49 -0400] cyclic_: I just don't know how to fix the repos :P
[2013-05-19 05:16:53 -0400] cyclic_: yet
[2013-05-19 05:17:43 -0400] sax_: yeah, maybe you're right about the yum::yum recipe for that.
[2013-05-19 05:17:57 -0400] sax_: although yum has a remove provider
[2013-05-19 05:17:58 -0400] sax_: https://github.com/opscode-cookbooks/yum/blob/0.8.2/providers/repository.rb#L31-L39
[2013-05-19 05:18:22 -0400] cyclic_: oh it has add too
[2013-05-19 05:18:58 -0400] cyclic_: do you think the yum::default is basically resetting everything to defaults and adding that 10gen repo?
[2013-05-19 05:19:24 -0400] cyclic_: but if I maybe use yum::yum it will keep the existing repos intact?
[2013-05-19 05:19:52 -0400] cyclic: sax?
[2013-05-19 05:19:56 -0400] cyclic: sax_:  :)
[2013-05-19 05:20:06 -0400] sax_: reading...
[2013-05-19 05:20:41 -0400] sax_: not familiar enough with how yum is configured
[2013-05-19 05:20:52 -0400] cyclic: https://forums.aws.amazon.com/thread.jspa?threadID=121165
[2013-05-19 05:25:57 -0400] cyclic: yeah sax_, I can see the amazon repos in /etc/yum.repos.d
[2013-05-19 05:26:25 -0400] sax_: commenting on your gist
[2013-05-19 05:27:46 -0400] cyclic: got it
[2013-05-19 05:28:09 -0400] sax_: wonder if there's a way to configure yum to look at the amazon repos first, then fall back to 10gen
[2013-05-19 05:28:23 -0400] cyclic: that would be the best
[2013-05-19 05:28:45 -0400] cyclic: but that's kind of what I thought add would do, no?
[2013-05-19 05:29:11 -0400] sax_: yeah, that's what I thought too
[2013-05-19 05:30:19 -0400] sax_: though it 10gen probably sorts before [a-z]
[2013-05-19 05:31:34 -0400] cyclic: haha... well I thought it might be the order it was added in
[2013-05-19 05:31:45 -0400] sax_: actually, maybe you're right about yum::yum. *if* repos in /etc/yum.conf take priority over /etc/yum.repos.d
[2013-05-19 05:31:46 -0400] cyclic: ah
[2013-05-19 05:31:49 -0400] cyclic: the repos have a priority
[2013-05-19 05:32:33 -0400] cyclic: the main repo file for example /etc/yum.repos.d/amzn-main.repo
[2013-05-19 05:33:46 -0400] cyclic: sax_: I added to that gist
[2013-05-19 05:35:38 -0400] sax_: oh. but the 10gen one is added without a priority? maybe the priority of that should be set so that it is the fallback
[2013-05-19 05:35:50 -0400] cyclic: I am looking for the 10gen one
[2013-05-19 05:36:05 -0400] cyclic: it's not in that folder on the machine /etc/yum.repos.d
[2013-05-19 05:36:24 -0400] cyclic: but yeah, if the amazon repo has priority 10, maybe I can set 10gen to 20 ...
[2013-05-19 05:36:25 -0400] cyclic: lol
[2013-05-19 05:36:49 -0400] cyclic: but I don't see it in that folder :/
[2013-05-19 05:36:56 -0400] sax_: weird
[2013-05-19 05:37:17 -0400] cyclic: it probably sets it in memory or something
[2013-05-19 05:37:30 -0400] cyclic: and I wonder if yum whipes out the exising repos
[2013-05-19 05:37:40 -0400] cyclic: the yum recipe that we add that is
[2013-05-19 05:39:13 -0400] cyclic: oh weird, that remove function that you highlighted in the yum recipe tries to remove a repo from the same folder...
[2013-05-19 05:39:32 -0400] cyclic: wtf
[2013-05-19 05:40:09 -0400] cyclic: sax_: is there some way to dump out the repos in the log?
[2013-05-19 05:40:22 -0400] cyclic: just to see what yum is using
[2013-05-19 05:41:09 -0400] sax_: you can run chef in debug mode '-l debug' to get info on everything chef does
[2013-05-19 05:44:34 -0400] cyclic: sax_: first I'm trying the remove function :)
[2013-05-19 05:45:09 -0400] cyclic: erg, I mean remove the repo
[2013-05-19 05:56:01 -0400] cyclic: I wonder why that 10gen repo file isn't in the yum repo folder.
[2013-05-19 05:56:36 -0400] sax_: yeah that's weird
[2013-05-19 06:00:28 -0400] cyclic: even the provider code puts it in there
[2013-05-19 06:01:04 -0400] b0c1: hi
[2013-05-19 06:01:10 -0400] sax_: did something else remove it?
[2013-05-19 06:02:28 -0400] cyclic: hrrm, but what?
[2013-05-19 06:03:12 -0400] cyclic: I mean, if the file were there, I would feel better about adding the priority to the existing yum repository provider and testing it.
[2013-05-19 06:08:42 -0400] cyclic: sax_: It's weird, now it's throwing another error on the link: [Sun, 19 May 2013 06:06:14 +0000] ERROR: link[] (/opt/aws/opsworks/current/site-cookbooks/mongodb/definitions/mongodb.rb:122:in `from_file') had an error: can't convert nil into String
[2013-05-19 06:10:26 -0400] cyclic: sax_: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L122
[2013-05-19 06:12:05 -0400] cyclic: crap it looks like it might be a bug in chef
[2013-05-19 06:12:35 -0400] cyclic: fixed in 10.12
[2013-05-19 06:20:19 -0400] sax_: ahhh
[2013-05-19 06:20:49 -0400] sax_: sorry, hit a very frustrating thing in my own project and had to walk away from my computer for a few minutes
[2013-05-19 06:21:42 -0400] sax_: yeah, there are a lot of bug fixes between there and 11. or even 10.18.
[2013-05-19 06:22:14 -0400] b0c1: Im a beginner in chef (Im a java developer)
[2013-05-19 06:22:22 -0400] b0c1: So I have sooo many stupid question
[2013-05-19 06:23:21 -0400] sax_: on a weekday this room is a lot busier, with people from opscode also helping out with questions.
[2013-05-19 06:23:52 -0400] b0c1: cool :)
[2013-05-19 06:24:21 -0400] cyclic: sax_: will a sudo command run?
[2013-05-19 06:24:41 -0400] cyclic:   execute "" do     command "sudo ln -s /journal /data/journal"     action :nothing   end
[2013-05-19 06:25:10 -0400] cyclic: might be easier than trying to work around that chef bug in 10.10 and link
[2013-05-19 06:25:16 -0400] sax_: yeah, maybe.
[2013-05-19 06:25:59 -0400] cyclic: starting the instance now...
[2013-05-19 06:26:02 -0400] sax_: if it doesn't run as is, you can hack it in
[2013-05-19 06:26:38 -0400] sax_: I'm not sure about opsworks, but in my setup chef runs as root
[2013-05-19 06:28:21 -0400] sax_: but when we need to run something as root with a login shell, we execute with command %[su - #{user} -c 'bash -l -c "..."]
[2013-05-19 06:28:30 -0400] sax_: sorry, as a user
[2013-05-19 06:29:06 -0400] cyclic: oh you mean when you need to run as a user
[2013-05-19 06:29:09 -0400] cyclic: nice
[2013-05-19 06:29:19 -0400] sax_: you can run execute with a user
[2013-05-19 06:29:38 -0400] sax_: but sometimes you need a login shell :/
[2013-05-19 06:30:02 -0400] cyclic: yeah, fortunately in this case I need it to execute as root. But good to know in the future for sure.
[2013-05-19 06:32:53 -0400] b0c1: ok. I want to manage my application deployment with chef. so first I completed the learnchef quickstart guide.
[2013-05-19 06:35:16 -0400] sax_: yup
[2013-05-19 06:43:51 -0400] cyclic: sax! so close :)
[2013-05-19 06:44:06 -0400] cyclic: sax_: so close!
[2013-05-19 06:44:54 -0400] cyclic: one final error:  [Sun, 19 May 2013 06:42:12 +0000] INFO: template[/etc/sysconfig/mongodb] sending restart action to service[mongodb] (delayed) [Sun, 19 May 2013 06:42:12 +0000] ERROR: Running exception handlers [Sun, 19 May 2013 06:42:12 +0000] ERROR: Exception handlers complete [Sun, 19 May 2013 06:42:12 +0000] DEBUG: Re-raising exception: NoMethodError - undefined method `run_action' for "service[mongodb]":String
[2013-05-19 06:45:22 -0400] sax_: hah. as soon as you get it working, I'd suggest tearing down the host and starting it from scratch.
[2013-05-19 06:46:02 -0400] sax_: awwww is that new syntax?
[2013-05-19 06:46:25 -0400] sax_: that's probably a chef version thing as well
[2013-05-19 06:46:30 -0400] cyclic: sax_: I've been tearing it down everytime
[2013-05-19 06:46:35 -0400] sax_: ah, nice
[2013-05-19 06:47:06 -0400] cyclic: sax_: any idea how to fix the syntax?
[2013-05-19 06:47:23 -0400] sax_: there are multiple ways you can refer to resources in chef. if memory serves, you can replace that with service => 'mongodb'
[2013-05-19 06:47:57 -0400] cyclic: where is that getting called?
[2013-05-19 06:49:19 -0400] sax_: probably this: https://github.com/edelight/chef-mongodb/blob/master/definitions/mongodb.rb#L106
[2013-05-19 06:49:28 -0400] sax_: oh, there are more in there
[2013-05-19 06:50:05 -0400] sax_: resources(:template => "/etc/nagios3/configures-nagios.conf")
[2013-05-19 06:50:16 -0400] sax_: so resources(:service => 'mongodb')
[2013-05-19 06:50:26 -0400] sax_: http://docs.opscode.com/resource_common_notifications.html
[2013-05-19 06:50:46 -0400] sax_: it's down in the examples section
[2013-05-19 06:53:03 -0400] cyclic: I should be looking for this?  resources(:service => 'mongodb')
[2013-05-19 06:53:15 -0400] cyclic: in definitions/mongodb.rb ?
[2013-05-19 06:54:15 -0400] sax_: no, you should look for things like "services[#{name}]"
[2013-05-19 06:55:16 -0400] cyclic: notifies :restart, "service[#{name}]" ?
[2013-05-19 06:55:26 -0400] sax_: correct.
[2013-05-19 06:55:34 -0400] sax_: are you familiar with notifications in chef?
[2013-05-19 06:55:52 -0400] cyclic: I understand the concept, but not really. It's basically an event handler, right?
[2013-05-19 06:56:27 -0400] cyclic: so once that template executes, for example, it notifies, which means it runs that code when it's done executing the template.
[2013-05-19 06:57:00 -0400] sax_: correct. providers in chef (well written ones, at least) will check whether they actually made a change before sending notifications
[2013-05-19 06:57:21 -0400] sax_: so it will only restart mongo if the configuration files change
[2013-05-19 06:57:43 -0400] cyclic: but what about this? https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L153-L155
[2013-05-19 06:57:57 -0400] sax_: whoa
[2013-05-19 06:58:17 -0400] sax_: I haven't seen that one before
[2013-05-19 06:58:25 -0400] cyclic: I think that maybe where it bombs... not sure
[2013-05-19 06:58:51 -0400] cyclic: NoMethodError - undefined method `run_action' for "service[mongodb]":String
[2013-05-19 06:59:03 -0400] cyclic: not sure which one it is
[2013-05-19 07:00:51 -0400] cyclic: btw, the 10gen repo got removed successfully :)
[2013-05-19 07:00:59 -0400] cyclic: I think this is literally the very last thing
[2013-05-19 07:01:52 -0400] sax_: nice
[2013-05-19 07:02:12 -0400] cyclic: yeah, it's pretty sweet. Mongo is all setup and running it looks like.
[2013-05-19 07:02:26 -0400] sax_: ahhh
[2013-05-19 07:02:26 -0400] sax_: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L32
[2013-05-19 07:02:59 -0400] sax_: that's actually just ruby code, which happens to run at compile time when the service code runs
[2013-05-19 07:03:44 -0400] cyclic: what do you mean?
[2013-05-19 07:04:17 -0400] cyclic: service_notifies = params[:notifies]<-- notifies is just ruby code?
[2013-05-19 07:05:23 -0400] sax_: I think it's something being sent into the definition
[2013-05-19 07:05:24 -0400] sax_: one sec
[2013-05-19 07:06:58 -0400] sax_: I don't understand where things are being added to that array
[2013-05-19 07:07:56 -0400] cyclic: oh
[2013-05-19 07:08:30 -0400] cyclic: for this loop? service_notifies.each do |service_notify|
[2013-05-19 07:10:29 -0400] sax_: something is adding to that array. Either by sending :notifies into the mongodb_instance definition or inside the definition.
[2013-05-19 07:17:15 -0400] cyclic: oh that param
[2013-05-19 07:17:28 -0400] cyclic: :notifies => []
[2013-05-19 07:18:44 -0400] cyclic: notifies :restart, "service[#{name}]"
[2013-05-19 07:18:51 -0400] cyclic: that?
[2013-05-19 07:19:13 -0400] cyclic: it looks like an array containing the action, and the service name
[2013-05-19 07:19:39 -0400] cyclic: maybe not
[2013-05-19 07:19:59 -0400] sax_: I jumped straight to writing LWRPs, so I don't really understand how definitions work in chef. maybe each :notifies adds to the array?
[2013-05-19 07:21:27 -0400] sax_: notifies :restart, "service[#{name}]" should do the notification by itself.
[2013-05-19 07:21:35 -0400] cyclic: oh
[2013-05-19 07:21:40 -0400] sax_: maybe the service_notifies is a red herring...
[2013-05-19 07:21:57 -0400] sax_: which line is the error being thrown on?
[2013-05-19 07:24:34 -0400] cyclic: here is what I see
[2013-05-19 07:24:35 -0400] cyclic: https://github.com/Cyclic/cookbooks/issues/2
[2013-05-19 07:25:16 -0400] cyclic: https://f.cloud.github.com/assets/553800/522635/1cbe3564-c055-11e2-86e6-c5b9811e59d0.png
[2013-05-19 07:27:55 -0400] cyclic: it has to be one of the templates
[2013-05-19 07:28:08 -0400] cyclic: template[/etc/sysconfig/mongodb] sending restart action to service[mongodb] (delayed)
[2013-05-19 07:29:37 -0400] cyclic: This one looks like the suspect: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L139-L147
[2013-05-19 07:30:34 -0400] sax_: http://www.sharp-tools.net/archives/002187.html
[2013-05-19 07:30:47 -0400] sax_: at the end he says he switched back to the old syntax and it worked.
[2013-05-19 07:30:52 -0400] cyclic: or this one: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L88-L110
[2013-05-19 07:31:13 -0400] sax_: I would try switching all of them
[2013-05-19 07:32:37 -0400] cyclic: ohhh!
[2013-05-19 07:32:43 -0400] cyclic: that's what you were saying to swap out
[2013-05-19 07:32:46 -0400] cyclic: now I get it :)
[2013-05-19 07:36:09 -0400] cyclic: trying now, but hopefully that loop one doesn't get me :)
[2013-05-19 07:37:50 -0400] sax_: now I don't think so
[2013-05-19 07:37:55 -0400] sax_: I think it was just confusing
[2013-05-19 07:38:29 -0400] cyclic: starting the instance ... :)
[2013-05-19 07:38:38 -0400] cyclic: (new one of course)
[2013-05-19 07:40:45 -0400] cyclic: https://github.com/aws/opsworks-cookbooks/issues/28
[2013-05-19 07:41:09 -0400] cyclic: that one is very similar
[2013-05-19 07:46:52 -0400] cyclic: sax_: I have a feeling this is invalid. Is this what you meant? notifies :restart, resources(:service => name)
[2013-05-19 07:48:05 -0400] cyclic:  mongodb::default: Chef::Exceptions::ResourceNotFound - Cannot find a resource matching service[mongodb]
[2013-05-19 07:49:33 -0400] sax_: correct
[2013-05-19 07:54:14 -0400] flaccid: opsworks, yeek
[2013-05-19 07:54:34 -0400] sax_: yeah, this is my first exposure.
[2013-05-19 07:55:21 -0400] cyclic: Wonder why they went with an older version of chef.
[2013-05-19 07:55:26 -0400] flaccid: that thing uses chef 0.9 so more modern/current syntax aint going to work
[2013-05-19 07:55:43 -0400] flaccid: cyclic: because they acquired this, they didn't make it. its scalarium
[2013-05-19 07:55:55 -0400] cyclic: flaccid, I tried to swap it out with older syntax, and got the error seen above.
[2013-05-19 07:56:26 -0400] cyclic: [Sun, 19 May 2013 07:55:56 +0000] ERROR: Caught exception during execution of custom recipe: mongodb::default: Chef::Exceptions::ResourceNotFound - Cannot find a resource matching service[mongodb] (did you define it first?) - /opt/aws/opsworks/releases/20130515001926_119/vendor/bundle/ruby/1.8/gems/chef-0.9.15.5/bin/../lib/chef/resource_collection.rb:115:in `lookup'
[2013-05-19 07:56:45 -0400] flaccid: cyclic: url to the exact cookbook being used?
[2013-05-19 07:57:03 -0400] cyclic: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L88-L110
[2013-05-19 07:57:38 -0400] flaccid: there is already a mongodb cookbook
[2013-05-19 07:57:56 -0400] cyclic: This line is what's breaking: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L146
[2013-05-19 07:58:18 -0400] cyclic: flaccid: that's where I started, but that one wasn't tested with OpsWorks.
[2013-05-19 07:58:24 -0400] flaccid: cyclic: you can't notify a service that doesn't exist yet
[2013-05-19 07:58:38 -0400] flaccid: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L150
[2013-05-19 07:58:54 -0400] workmad3: new syntax of "service[mongodb]" doesn't need the service definition in advance
[2013-05-19 07:59:08 -0400] workmad3: but older syntax of resources(:service => "mongodb") does, afaik
[2013-05-19 07:59:11 -0400] flaccid: opsworks uses 0.9
[2013-05-19 07:59:25 -0400] cyclic: oh i see
[2013-05-19 07:59:25 -0400] sax_: ah, right
[2013-05-19 07:59:50 -0400] sax_: I've gotten so used to the new syntax, I don't remember the issues with the old
[2013-05-19 08:00:08 -0400] cyclic: sheesh
[2013-05-19 08:00:19 -0400] cyclic: so I have to move those templates below the service creation?
[2013-05-19 08:01:01 -0400] workmad3: or only use the "service[mongodb]" style for notifications
[2013-05-19 08:01:46 -0400] cyclic: I don't really see what you mean with only use the "service[mongodb]" style?
[2013-05-19 08:02:15 -0400] workmad3: cyclic: look at L109 and L146 of your definition
[2013-05-19 08:02:20 -0400] cyclic: this is the new style? notifies :restart, "service[#{name}]"
[2013-05-19 08:02:30 -0400] sax_: workmad3: the version of chef used in amazon opsworks is too old for the service[name] syntax
[2013-05-19 08:02:37 -0400] workmad3: sax_: :(
[2013-05-19 08:02:43 -0400] sax_: workmad3: yeah
[2013-05-19 08:03:01 -0400] workmad3: cyclic: for starters, you should only use one style within a cookbook for consistency, IMO
[2013-05-19 08:03:22 -0400] flaccid: cyclic: define the service before you use it
[2013-05-19 08:03:31 -0400] cyclic: workmad3: I'm testing to see what the issue is. I literally just updated it.
[2013-05-19 08:03:55 -0400] cyclic: that's why there are different styles atm
[2013-05-19 08:04:04 -0400] workmad3: ok :)
[2013-05-19 08:04:06 -0400] flaccid: i also recommending using a chef that isn't ancient
[2013-05-19 08:04:28 -0400] cyclic: lol
[2013-05-19 08:04:59 -0400] cyclic: ok so use this style: notifies :restart, resources(:service => name) ... But define the service before using that?
[2013-05-19 08:05:08 -0400] sax_: correct
[2013-05-19 08:05:48 -0400] flaccid: yes0r
[2013-05-19 08:05:50 -0400] cyclic: Sorry, pretty new at this, but where is the service declared and defined?
[2013-05-19 08:05:58 -0400] flaccid: you can even just service "foo"
[2013-05-19 08:06:16 -0400] flaccid: cyclic: [17:58] <flaccid> https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L150
[2013-05-19 08:06:40 -0400] cyclic: move that up?
[2013-05-19 08:07:01 -0400] flaccid: you could yes, but there is a lot of foo in there
[2013-05-19 08:07:12 -0400] flaccid: not the best design
[2013-05-19 08:07:44 -0400] flaccid: definitions should try to be deprecated in place of LWRPs
[2013-05-19 08:09:38 -0400] sax_: that can happen once he has his services up and running and gets more experience with chef :)
[2013-05-19 08:10:00 -0400] cyclic: does this look right? https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L88
[2013-05-19 08:10:02 -0400] sax_: but yeah. I never really understood definitions.
[2013-05-19 08:10:25 -0400] cyclic: yeah, this is my first uhm... 5 hours with chef :P
[2013-05-19 08:10:31 -0400] workmad3: cyclic: the other option you could do... rather than having the templates notify the service, you could have the service subscribe to the templates
[2013-05-19 08:11:35 -0400] cyclic: ah
[2013-05-19 08:11:50 -0400] sax_: you may run into problems here: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L95 and here https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L95
[2013-05-19 08:11:53 -0400] cyclic: I might refactor after I get this rolling, like sax_ said
[2013-05-19 08:12:49 -0400] cyclic: sax_: I'll clean that up in a little while. That's replica stuff I'm not using yet :)
[2013-05-19 08:12:58 -0400] sax_: cool
[2013-05-19 08:13:11 -0400] cyclic: sax_: But did you see how I moved the service definition up?
[2013-05-19 08:13:41 -0400] cyclic: is that right?
[2013-05-19 08:13:50 -0400] flaccid: cyclic: i fink you mean first 5 hours with opsworks lol
[2013-05-19 08:13:51 -0400] workmad3: cyclic: now the problem is... what happens if you try to start or enable the service before you've created the init.d script... ;)
[2013-05-19 08:14:19 -0400] sax_: right
[2013-05-19 08:14:20 -0400] workmad3: (means you could have issues using this recipe on a clean node)
[2013-05-19 08:14:26 -0400] cyclic: oh
[2013-05-19 08:14:26 -0400] sax_: remove action service_action
[2013-05-19 08:14:54 -0400] flaccid: it would be great if you simply learnt chef and contributed back anything new to http://community.opscode.com/cookbooks/mongodb
[2013-05-19 08:15:11 -0400] sax_: and then add another (almost) service block at the end that runs the action
[2013-05-19 08:15:31 -0400] sax_: cyclic: are you locked into opsworks? I'm not at all familiar with it
[2013-05-19 08:15:34 -0400] cyclic: flaccid: basically move stuff into an amazon recipe?
[2013-05-19 08:15:58 -0400] flaccid: cyclic: huh
[2013-05-19 08:16:04 -0400] cyclic: sax_: kind of locked in...
[2013-05-19 08:16:25 -0400] flaccid: get rid of it
[2013-05-19 08:16:28 -0400] cyclic: flaccid: move stuff into an amazon recipe b/c it's ancient code?
[2013-05-19 08:16:43 -0400] flaccid: cyclic: no
[2013-05-19 08:17:11 -0400] cyclic: sax_: define "almost" ;)
[2013-05-19 08:17:33 -0400] sax_: almost duplicate
[2013-05-19 08:17:46 -0400] flaccid: dinner time
[2013-05-19 08:18:08 -0400] cyclic: sax_: almost except that one line?
[2013-05-19 08:18:54 -0400] sax_: when you define the service at the top and then at the bottom call service name do; action service_action; end \
[2013-05-19 08:19:06 -0400] sax_: I don't remember how much of the original service definition you need to include
[2013-05-19 08:19:19 -0400] sax_: you may be able to get away with just that
[2013-05-19 08:19:27 -0400] cyclic: oh just that one line?
[2013-05-19 08:19:32 -0400] workmad3: personally, I just like to declare the service at the top
[2013-05-19 08:20:12 -0400] workmad3: so at the top have 'service "foo" do; action :nothing; end', and then further down have the full definition that includes the actions and notifications (if needed)
[2013-05-19 08:20:16 -0400] cyclic: workmad3: what about the service action?
[2013-05-19 08:20:32 -0400] sax_: well that line as three lines, but yes.
[2013-05-19 08:20:40 -0400] sax_: yeah, what workmad3 said
[2013-05-19 08:20:58 -0400] workmad3: cyclic: in that first place, you just declare that this service exists
[2013-05-19 08:21:03 -0400] cyclic: ah yeah
[2013-05-19 08:21:04 -0400] workmad3: cyclic: you don't want to do anything with it yet
[2013-05-19 08:21:35 -0400] sax_: you want the action service_action to run after the configuration files have been written
[2013-05-19 08:21:53 -0400] workmad3: ^^ same with all your notifications if they're going to fire
[2013-05-19 08:22:26 -0400] workmad3: although you're going to run into the same problems with the notifications there very soon ;)
[2013-05-19 08:23:55 -0400] sax_: if you want to contribute your changes back to upstream, I'd suggest doing it as an opsworks branch. then people will be able to find it, but the main branch will stay current with chef 10+ syntax
[2013-05-19 08:25:02 -0400] cyclic: how does this look? https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb
[2013-05-19 08:25:31 -0400] cyclic: sax_: I'll do that for sure, once I get this sorted out.
[2013-05-19 08:26:13 -0400] sax_: I'd keep the supports in the first definition.
[2013-05-19 08:26:48 -0400] sax_: oh, I see
[2013-05-19 08:26:53 -0400] cyclic: oops
[2013-05-19 08:27:03 -0400] cyclic: I need to move it up
[2013-05-19 08:27:27 -0400] sax_: this one should include the supports https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L88-L90
[2013-05-19 08:27:57 -0400] sax_: then you can remove these lines https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L162 https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L155-L158
[2013-05-19 08:28:22 -0400] workmad3: and this one: https://github.com/Cyclic/cookbooks/blob/master/mongodb/definitions/mongodb.rb#L162
[2013-05-19 08:29:45 -0400] cyclic: k all set
[2013-05-19 08:30:10 -0400] cyclic: testing time ... :>
[2013-05-19 08:31:15 -0400] cyclic: thanks for doing me a solid ;)
[2013-05-19 08:32:57 -0400] cyclic: if this one fails, I'll need to passout
[2013-05-19 08:32:58 -0400] cyclic: so tired
[2013-05-19 08:33:09 -0400] sax_: yeah. getting there myself
[2013-05-19 08:33:50 -0400] cyclic: these machines take forever to boot on amazon
[2013-05-19 08:52:56 -0400] cyclic: Something is definitely taking a lot longer this time.
[2013-05-19 08:58:03 -0400] cyclic: worked!
[2013-05-19 08:58:29 -0400] cyclic: sax_: thanks again! Hopefully I'll see you around here.
[2013-05-19 08:58:41 -0400] sax_: awesome
[2013-05-19 08:59:09 -0400] sax_: ditto!
[2013-05-19 08:59:17 -0400] sax_: ooooh sleep
[2013-05-19 08:59:47 -0400] flaccid: cyclic: next time, ##opsworks
[2013-05-19 09:00:17 -0400] flaccid: :p
[2013-05-19 09:00:44 -0400] flaccid: i'm out
[2013-05-19 09:59:28 -0400] Henrik: Hi - I am trying to knife boostrap some ubuntu 1204 clients from my chef-server and was hoping to do that in offline mode meaning that the standard .erb file which downloads the install.sh file and gets the .deb will not work - Any suggestions? Thank you in advance.
[2013-05-19 10:18:46 -0400] Guest44313: Hi - I am trying to knife boostrap some ubuntu 1204 clients from my chef-server and was hoping to do that in offline mode meaning that the standard .erb file which downloads the install.sh file and gets the .deb will not work - Any suggestions? Thank you in advance.
[2013-05-19 14:17:12 -0400] shevron: hi all. is there an easy way to know the deb package arch for the current node (e.g. i386 or amd64) ?
[2013-05-19 14:27:25 -0400] spox: shevron: node.kernel.machine
[2013-05-19 14:27:56 -0400] shevron: spox: thx.. but would that fit the debian package arch standards e.g. 'amd64' for x86_64 machines ?
[2013-05-19 14:28:04 -0400] shevron: or do I need to manually run dpkg to get that?
[2013-05-19 14:28:37 -0400] spox: shevron: you need to map it, since x86_64 != amd64, but it's just a string mag
[2013-05-19 14:28:39 -0400] spox: map*
[2013-05-19 14:28:55 -0400] shevron: spox: oh right, cool.. thanks!
[2013-05-19 14:29:05 -0400] spox: shevron: sure :)
[2013-05-19 16:34:31 -0400] jasonsmr: Question how do I install a package thats not in the chef repo?
[2013-05-19 16:34:49 -0400] jasonsmr: How easy is it to create a new recipe from git source package** ?
[2013-05-19 16:35:25 -0400] jasonsmr: any help or advice or just pointing me in the right direction is appreaceated^^
[2013-05-19 18:01:23 -0400] z: btm: are the Omnibus builds of Chef Server basically unsupported at this time?
[2013-05-19 18:02:10 -0400] z: btm: Seeing the latest is 11.0.8 for EL6 or Ubuntu LTS (and everything else, in fact) and wondered what was up
[2013-05-19 18:05:56 -0400] wmz: hi, i have two attribute defined in environments file, and I found that chef-client is reading them in random order
[2013-05-19 18:05:59 -0400] wmz: is that normal?
[2013-05-19 18:16:14 -0400] teukka: z: that *is* the latest server version. server versions and releases are not tight to the client since v11. it's different project (erchef)
[2013-05-19 18:16:58 -0400] z: Ugh. Okay. Thanks - that makes sense.
[2013-05-19 18:17:11 -0400] z: Upgrading some shit from 10.x and confusion reigns.
[2013-05-19 18:18:58 -0400] teukka: s/tight/tied/ =)
[2013-05-19 19:21:48 -0400] banachtarski_: are there any instructions anywhere to install chef server 11.x from source?
[2013-05-19 19:22:01 -0400] banachtarski_: I would like to try it out but am using an unsupported linux
[2013-05-19 20:00:42 -0400] b0c1: hi
[2013-05-19 20:01:14 -0400] b0c1: I have two vm (vagrant) first for workstation, second to the node... how can I bootstrap the node from the workstation?
[2013-05-19 20:12:31 -0400] shutchie: hi all. new time user to chef + vagrant. if i want to leverage off of opscode's apache2 cookbook and define attributes, is it better to edit the default.rb or create my own and use that as a dependency?
[2013-05-19 20:16:28 -0400] jtimberman: shutchie: create your own
[2013-05-19 20:16:55 -0400] jtimberman: you can set attributes in a lot of ways, by design so you don't need to edit "upstream" cookbooks.
[2013-05-19 20:24:28 -0400] gzc: speaking of attributes, is there an 'easy' method for altering attributes of the omnibus installer? i really miss having a 'chef-server' cookbook specifically for the attributes it let you set :(
[2013-05-19 20:27:12 -0400] jtimberman: gzc: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/ and http://docs.opscode.com/config_rb_chef_server.html
[2013-05-19 20:28:53 -0400] gzc: unfortunately the link there to the attributes does not work
[2013-05-19 20:29:20 -0400] gzc: but specifically my want/need is to have the same level of 'chef-like' control over the installation of a chef server that was previously available
[2013-05-19 20:29:53 -0400] jtimberman: gzc: the chef server uses the embedded chef-server-ctl command for maintenance/configuration.
[2013-05-19 20:30:35 -0400] gzc: fair enough, I'll start looking for up-to-date chef-server cookbooks
[2013-05-19 20:30:39 -0400] gzc: and/or write one
[2013-05-19 20:31:55 -0400] jtimberman: er, it already has its own cookbook, which is embedded.
[2013-05-19 20:32:13 -0400] shutchie: jtimberman: ah true, makes sense. stupid question, in terms of vagrant+chef, if you need to go through the process of installing ruby+chef+dependencies, isn't it just easier to write bash scripts to install for sharing around your team? that way just virtualbox+vagrant?
[2013-05-19 20:32:35 -0400] gzc: well, I'll give a try to extracting it and running it in the context of a chef server
[2013-05-19 20:34:11 -0400] gzc: are omnibus-cookbooks in a different repo than alluded to in that article?
[2013-05-19 20:34:27 -0400] jtimberman: gzc: https://github.com/opscode-cookbooks/chef-server
[2013-05-19 20:34:29 -0400] gzc: er omnibus-chef cookbooks/etc
[2013-05-19 20:34:56 -0400] gzc: whew, cool, I'll give that a run
[2013-05-19 20:35:06 -0400] gzc: wasn't sure if that was up-to-date, the 'chef 10' thing in there got me :)
[2013-05-19 20:35:49 -0400] gzc: thanks jt
[2013-05-19 20:36:08 -0400] jtimberman: gzc: yeah we haven't released it to the community site yet.
[2013-05-19 20:36:24 -0400] jtimberman: (I don't know why; schisamo maintains that one)
[2013-05-19 22:34:41 -0400] agente0: hi, I am total newbie with Chef, I am looking at engine yard's chef recipes (https://github.com/engineyard/ey-cloud-recipes) and it appears there is a main cookbook that tells which recipes to require. Is that a chef feature? I couldn't find that main cookbook
[2013-05-19 22:35:14 -0400] agente0: chef-solo
