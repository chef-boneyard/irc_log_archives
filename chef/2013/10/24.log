[2013-10-24 00:02:50 -0400] irr: Ohai Chefs. Is there a way to ask for user confirmation to proceed during chef-run?
[2013-10-24 00:02:59 -0400] veetow: chef-server hates my search syntax
[2013-10-24 00:03:01 -0400] veetow: help?
[2013-10-24 00:03:19 -0400] veetow: search(:node, %Q{run_list:recipe[cookbook::recipe] AND chef_environment:"#{node.chef_environment}"})
[2013-10-24 00:03:26 -0400] irr: kind of: "I'm going to run this scary command against your network: ..... Do you want to proceed?"
[2013-10-24 00:03:49 -0400] veetow:  Net::HTTPServerException: 400 "Bad Request"
[2013-10-24 00:08:02 -0400] veetow: even just this
[2013-10-24 00:08:04 -0400] veetow: via the shell
[2013-10-24 00:08:04 -0400] veetow: chef > search(:node, %Q{run_list:recipe[cookbook::recipe]})
[2013-10-24 00:08:04 -0400] veetow: Net::HTTPServerException: 400 "Bad Request"
[2013-10-24 00:08:24 -0400] veetow: what gives? Chef Version: 11.6.2
[2013-10-24 00:09:16 -0400] slillibri: veetow: cookbook\:\:recipe - those colons need to be escaped.
[2013-10-24 00:11:20 -0400] allaire: Anybody using the rbenv cookbook?
[2013-10-24 00:15:25 -0400] veetow: slillibri: i've tried all manner of escaping them
[2013-10-24 00:17:56 -0400] veetow: slillibri: i got it.
[2013-10-24 00:18:03 -0400] veetow: although, it's uglyyyyy
[2013-10-24 00:18:06 -0400] veetow: search(:node, 'run_list:recipe\[cookbook\:\:recipe\] AND ' + %Q{chef_environment:"#{node.chef_environment}"})
[2013-10-24 00:56:35 -0400] coderanger: kallistec: Do you know off hand if remote_file verifies the server cert for HTTPS?
[2013-10-24 01:02:19 -0400] coderanger: Looks like it doesn't
[2013-10-24 01:02:39 -0400] gchristensen: that makes me very sad :(
[2013-10-24 01:02:54 -0400] coderanger: We should fix that
[2013-10-24 01:03:20 -0400] coderanger: So many yaks to shave
[2013-10-24 01:03:32 -0400] coderanger: I can at least build this cookbook so that once remote_file is safe, it will be safe
[2013-10-24 01:03:43 -0400] gchristensen: is https verification a yak to shave? :P
[2013-10-24 01:03:57 -0400] coderanger: Apparently
[2013-10-24 01:34:30 -0400] leofl: Hi, someone could plz help me with application_python cookbook?
[2013-10-24 01:34:37 -0400] leofl: I have the same problem than the guy here: http://community.opscode.com/cookbooks/application_python/comments
[2013-10-24 01:35:01 -0400] leofl: probably just a question of setting a proper header on my recipe
[2013-10-24 02:05:15 -0400] gchristensen: not sure if yak shaving...
[2013-10-24 06:46:03 -0400] brucelee1: does 'template' resource automatically create a file?
[2013-10-24 06:46:12 -0400] brucelee1: if create: is not specified
[2013-10-24 08:23:56 -0400] sgronblom: I'm trying to put a role in the run list when using chef-solo, the roles_path is properly mapped but I can't figure out what argument I should give to chef.add_role
[2013-10-24 08:25:54 -0400] sgronblom: The role is in a file called <rolename>.yml inside of chef-repo/roles/<service_name> and contains an attribute name: <rolename>. I tried both chef.add_role '<rolename>' and chef.add_role '<service_name>::<rolename>' but neither of them work.
[2013-10-24 09:47:48 -0400] rnamF: hey guys, I'm fairly new to chef and I was wondering if there is pdf or nuggets for chef training/learning
[2013-10-24 09:48:04 -0400] rnamF: I know that pretty much everything is on opscode, but I was looking for some offline training
[2013-10-24 09:57:00 -0400] rnamF: anyone, pls? :)
[2013-10-24 10:13:25 -0400] walterheck: rnamF: where are you based?
[2013-10-24 10:32:48 -0400] ichilton: Rebooted chef server and now web interface seems fine, but nodes are giving errors - any ideas?
[2013-10-24 10:33:13 -0400] ichilton: [2013-10-24T11:32:40+01:00] ERROR: Server returned error for https://chef-server.mydomain.com/nodes/chef-server.mydomain.com, retrying 1/5 in 3s
[2013-10-24 10:33:54 -0400] ichilton: if I go to that url in the browser it seems fine...
[2013-10-24 10:47:28 -0400] arussel: has anyone a good doc on writing a provider ?http://dougireton.com/blog/2013/01/07/creating-an-lwrp-part-2/ is good, but I'd like more info on what is available and a wee bit more example
[2013-10-24 10:49:28 -0400] arussel: what is the difference between @new_resource and @current_resource
[2013-10-24 10:51:14 -0400] ichilton: arussel: i'd be interested in that if you find anything!
[2013-10-24 10:56:32 -0400] rnamF: if i'm wrapping a recipe, how do i make my wrapper variables to be global and override the ones on the original one?
[2013-10-24 10:58:35 -0400] arussel: rnamF: in attriubte file: override['foo']['bar'] = "new value"
[2013-10-24 10:58:56 -0400] arussel: is load_current_resource in a provider called by chef ?
[2013-10-24 10:59:01 -0400] rnamF: on my wrapper? the thing is that the recipe will run after
[2013-10-24 10:59:20 -0400] rnamF: for instance
[2013-10-24 10:59:32 -0400] rnamF: i have include_recipe "original.recipe::default"
[2013-10-24 10:59:58 -0400] rnamF: and i want that the "wrapper.original.recipe" to override some of the variabblres/values/etc
[2013-10-24 11:00:01 -0400] ichilton: running chef-server-ctl test and i'm getting a 500 error back from "Creating client pedant_admin_client..." - anyone know how to debug that further?
[2013-10-24 11:00:06 -0400] rnamF: is it with node.override ?
[2013-10-24 11:02:39 -0400] arussel: rnamF: if you set override[...] of an attribute in any of your recipe, it will override any default[...] attribute. (as far as I understand)
[2013-10-24 11:03:22 -0400] arussel: ichilton: did you change your hostanme ?
[2013-10-24 11:04:13 -0400] ichilton: arussel: nope - all was fine, rebooted chef server and now it's all gone pear shaped.
[2013-10-24 11:04:37 -0400] ichilton: arussel: nodes (even chef-client on the chef server) can't seem to connect to the chef server, but the web interface does all seem to work ok
[2013-10-24 11:05:05 -0400] ichilton: Tried running chef-server-ctl reconfigure and then rebooting again, but same failure
[2013-10-24 11:05:14 -0400] rnamF: oki ichilton
[2013-10-24 11:05:18 -0400] rnamF: gonna give it a try
[2013-10-24 11:05:22 -0400] rnamF: on vagrant :-D
[2013-10-24 11:05:44 -0400] rnamF: if you know of any .pdf or nuggets regarding chef that i can use for learning / trainning pls let me know
[2013-10-24 11:05:53 -0400] ichilton: excuse the paste, but am getting this when running chef-server-ctl test:
[2013-10-24 11:05:54 -0400] rnamF: so far i've been checking most of stuff in opscode
[2013-10-24 11:05:55 -0400] ichilton: Creating client pedant_admin_client...
[2013-10-24 11:05:55 -0400] ichilton: Encountered an error attempting to create client pedant_admin_client
[2013-10-24 11:05:56 -0400] ichilton: Response Code was: 500
[2013-10-24 11:05:56 -0400] ichilton: Response Body was: {"error":["internal service error"]}
[2013-10-24 11:05:58 -0400] ichilton: Exception during Pedant credentials setup
[2013-10-24 11:06:04 -0400] ichilton: Any ideas anyone?
[2013-10-24 11:06:14 -0400] arussel: rnamF: https://learnchef.opscode.com is a good start
[2013-10-24 11:06:16 -0400] rnamF: %s/ichilton/arussel
[2013-10-24 11:06:24 -0400] rnamF: yeah, i've been reading that
[2013-10-24 11:06:36 -0400] rnamF: but i wanted something that i could use offline for instance, omore of a book
[2013-10-24 11:07:02 -0400] arussel: none that I know, I would love a book on chef too :-)
[2013-10-24 11:07:17 -0400] _dumfries: ichilton: I presume you're using the Omnibus installer, can you confirm that all the services are available with "chef-server-ctl status"?
[2013-10-24 11:17:24 -0400] workmad3: does anyone know if it's possible to add a value to an encrypted data bag during a client run?
[2013-10-24 11:18:55 -0400] workmad3: alternatively, does anyone know how I could generate a password for a bacula client during a first run and be able to transmit it to the server without it being stored as a plaintext node attribute? :)
[2013-10-24 11:20:01 -0400] workmad3: oh, wait a sec...
[2013-10-24 11:20:09 -0400] arussel: workmad3: have you tried to update a secret data bag from your recipe ?
[2013-10-24 11:20:15 -0400] workmad3: arussel: not yet
[2013-10-24 11:21:01 -0400] workmad3: arussel: but I can't find anything in the code for data bags on updating and saving them, I can see there are some tricky issues to resolve regarding concurrency
[2013-10-24 11:22:11 -0400] workmad3: arussel: and so I'm double checking... but I also just realised - I have the secrets on the client and on the server, so I should be able to encrypt the password using that secret, store the result in a node attribute and read that out and decrypt it on the server
[2013-10-24 11:23:18 -0400] workmad3: arussel: without it then being plaintext on the chef server and in the chef solr index :)
[2013-10-24 11:23:31 -0400] arussel: workmad3: you have the secret on the server ?
[2013-10-24 11:23:35 -0400] workmad3: arussel: yes
[2013-10-24 11:24:04 -0400] arussel: how is that a secret then ? anyone having access to the server has access to the passwod, why encrpyt it ?
[2013-10-24 11:24:12 -0400] workmad3: arussel: client/server here means bacula client and bacula server
[2013-10-24 11:24:24 -0400] arussel: ooops, sorry, I thought chef server.
[2013-10-24 11:25:14 -0400] workmad3: arussel: I'd also prefer that the password not end up in plaintext in the solr index ;)
[2013-10-24 11:25:39 -0400] arussel: you're a security addict :-)
[2013-10-24 11:26:36 -0400] workmad3: arussel: I'm building out infrastructure for a new system... may as well try to be careful :)
[2013-10-24 11:27:05 -0400] workmad3: arussel: especially as it's intended to hold student info
[2013-10-24 11:27:52 -0400] arussel: wouldn't you save yourself a log of pain to create a new password on your workstation, encrypt it and put it in a secret data bag ?
[2013-10-24 11:28:14 -0400] arussel: server/client password update might be a bit painful otherwise
[2013-10-24 11:29:37 -0400] workmad3: I was thinking that... but that would get annoying quickly, generating a new password for each node and updating the databag manually
[2013-10-24 11:30:03 -0400] workmad3: I'd much rather the node itself generated its own password if one doesn't exist
[2013-10-24 11:32:31 -0400] workmad3: and it shouldn't be a lot of pain... the code to encrypt the values is already there in the encrypted databag code :) I can wrap that up in my own helper method to allow a node attribute to be encrypted and decrypted with a secret file
[2013-10-24 11:33:11 -0400] workmad3: I think it's at least worth investigating anyway ;)
[2013-10-24 11:36:53 -0400] arussel: what is the differenct between using @current_resource and current_resource ?
[2013-10-24 11:43:00 -0400] Raboo: hi
[2013-10-24 11:43:34 -0400] Raboo: if i want to get the value of the number of physical cores in a server and use that value in a erb template
[2013-10-24 11:43:38 -0400] Raboo: what is the easiest way?
[2013-10-24 11:45:01 -0400] arussel: Raboo: isn't there a cpu attriubte ?
[2013-10-24 11:45:15 -0400] Raboo: it shows virtual cores.
[2013-10-24 11:45:25 -0400] Raboo: includes the hyperthreaded cores
[2013-10-24 11:45:38 -0400] Raboo: in a terminal i would do this
[2013-10-24 11:45:50 -0400] Raboo: cat /proc/cpuinfo |grep "physical id" |sort -u|wc -l
[2013-10-24 11:45:58 -0400] Raboo: cat /proc/cpuinfo |grep "core id" | sort -u|wc -l
[2013-10-24 11:46:15 -0400] Raboo: and then multiply those two values
[2013-10-24 11:46:38 -0400] Raboo: arussel that would give me a result of physical cores..
[2013-10-24 11:46:41 -0400] arussel: ['cpu']['physical_id'] and core_id is there, can't you work with that
[2013-10-24 11:48:47 -0400] Raboo: hmm
[2013-10-24 11:48:59 -0400] Raboo: i just realized that my terminal way is wrong
[2013-10-24 11:49:17 -0400] Raboo: it currently works on that machine i tried it on because it had two cpu's
[2013-10-24 11:50:10 -0400] Raboo: ['cpu
[2013-10-24 11:51:46 -0400] Raboo: the count of total ['cpu']['physical_id'] * ['cpu']['cores']
[2013-10-24 12:00:32 -0400] ichilton: _dumfries: the .deb, as per: http://www.opscode.com/chef/install/
[2013-10-24 12:00:46 -0400] ichilton: _dumfries: everything looks fine in chef-server-ctl status
[2013-10-24 12:02:57 -0400] Raboo: echo "$(cat /proc/cpuinfo |grep "physical id" |sort -u|wc -l) * $(cat /proc/cpuinfo |grep "cpu cores" |awk '{print $4}' |sort -u)"|bc
[2013-10-24 12:21:30 -0400] arussel: if my provider needs a file that it has downloaded, where should it put it to check if it is there to avoid downloading multiple time ? is there a specific chef cache somewhere for this ?
[2013-10-24 12:27:30 -0400] mc_fail: hi guys, i'm trying to install a chef server on fedora 16 server, i installed a chef-server-11.0.8-1.el6.x86_64.rpm and run a sudo chef-server-ctl reconfigure, it it freeze on  ruby_block[supervise_rabbitmq_sleep] action run
[2013-10-24 12:27:38 -0400] mc_fail: what does it mean?
[2013-10-24 12:28:00 -0400] mc_fail: (ssorry for my terrible engilsh)
[2013-10-24 12:35:25 -0400] Raboo: arussel /var/cache/chef ?
[2013-10-24 12:36:17 -0400] Raboo: it doesn't download the file every run. It keeps a checksum and checks if it got the same checksum
[2013-10-24 12:36:27 -0400] arussel: I was more looking for method that would return the directory in an OS agnostic way.
[2013-10-24 12:37:13 -0400] arussel: Raboo: would you know of a provider that does that so I can have a look at the code ?
[2013-10-24 13:08:39 -0400] arussel: I'm having trouble understanding http://docs.opscode.com/lwrp_custom_provider.html
[2013-10-24 13:09:41 -0400] arussel: it says that @current_resource is the resource at present time, but then it uses load_current_resource to create it ...
[2013-10-24 13:10:25 -0400] arussel: with the value of new_resource
[2013-10-24 13:10:46 -0400] Raboo: arussel nope..
[2013-10-24 13:10:58 -0400] Raboo: i don't know a provider..
[2013-10-24 13:12:32 -0400] zytta: What's the best practice for using notifies :restart and service's :start in the same recipe? I am seeing that both run the first time I run chef-client
[2013-10-24 13:13:10 -0400] zytta: I set the service to only :enable, and rely on :restart in another resource to start the service. It's icky!
[2013-10-24 13:24:05 -0400] ghatak: Can I access node attributes from providers ?
[2013-10-24 13:25:50 -0400] cortex: Hello! I'm trying to use chef-solo to run just one recipe by supplying { "run_list": ["recipe[haproxy]"], "role":"myrole" }, this works, but it doesn't honor the role settings, any hints?
[2013-10-24 13:27:44 -0400] laurent\: cortex: what about "run_list": [ "recipe[haproxy]", "role[myrle]" ] ?
[2013-10-24 13:27:59 -0400] tmichael: cortex - your run_list is an array so put your role in that array.
[2013-10-24 13:28:16 -0400] tmichael: per laurent\'s example
[2013-10-24 13:29:31 -0400] cortex: laurent\: I tried that, but that ended up running everything for that role, not just the haproxy recipe
[2013-10-24 13:30:39 -0400] cortex: does the order matter here in the run_list btw?
[2013-10-24 13:34:08 -0400] workmad3: cortex: when you apply a role to a node, it puts that role's run list into the run list for the node
[2013-10-24 13:34:35 -0400] cortex: workmad3: makes sense, but in this case I just want the attributes for that role to be applied to the recipe
[2013-10-24 13:34:46 -0400] workmad3: cortex: then, afaik, you're out of luck
[2013-10-24 13:35:07 -0400] cortex: =(
[2013-10-24 13:35:13 -0400] workmad3: cortex: when you apply a role you apply the whole thing
[2013-10-24 13:35:31 -0400] workmad3: cortex: if you just want bits of it, then that indicates that there are several sub-roles inside your role
[2013-10-24 13:36:14 -0400] cortex: that sort of makes sense, but in this case what I want to do is to apply only the haproxy recipe for that role, that doesn't seem like a sensible sub-role
[2013-10-24 13:36:52 -0400] cortex: this is for performance reasons, we want to propagate haproxy-related changes faster than the whole role setup
[2013-10-24 13:37:58 -0400] workmad3: cortex: it makes less sense, from an infrastructure PoV, to have nodes that are all filling the same role to actually be doing completely disparate things :)
[2013-10-24 13:38:37 -0400] workmad3: cortex: so there's some sensible subset of attributes and the haproxy recipe that could be split out into a 'fast-haproxy' role ;)
[2013-10-24 13:38:55 -0400] cortex: right, we could do that
[2013-10-24 13:39:19 -0400] cortex: but we have set this up with a base default for haproxy that have overridden defaults per role
[2013-10-24 13:39:20 -0400] workmad3: cortex: you can add roles inside the run-list of other roles btw
[2013-10-24 13:39:38 -0400] cortex: so we'd end up with a fast-haproky-myrole
[2013-10-24 13:39:46 -0400] context: is it normal to do stuff like this? http://pastie.org/pastes/8425571
[2013-10-24 13:40:28 -0400] workmad3: cortex: mmm, sounds like maybe your current role setup isn't able to handle this (which happens... a lot of people abandon roles entirely because they're a bit of a PITA to work with :) )
[2013-10-24 13:41:12 -0400] workmad3: context: I don't know about 'normal' but I've definitely done that sort of thing (and more extereme stuff) inside a Vagrantfile :)
[2013-10-24 13:41:40 -0400] cortex: =( I just convinced people to start using them to get rid of the ugly if hostname == XXX hacks we had in all our config templates
[2013-10-24 13:41:52 -0400] workmad3: cortex: hehe
[2013-10-24 13:42:15 -0400] workmad3: cortex: you know you can put templates in templates/host-whatever for a hostname-specific template, right? :P
[2013-10-24 13:42:41 -0400] workmad3: cortex: http://docs.opscode.com/essentials_cookbook_templates.html#host-notation
[2013-10-24 13:42:52 -0400] context: workmad3: ok :D
[2013-10-24 13:43:09 -0400] cortex: well, I'm pretty new to chef, but finding room  for improvement in our current setup was not that hard =P
[2013-10-24 13:43:19 -0400] tmichael: cortex - could also put your conditionals in attributes files so they don't pollute your templates.
[2013-10-24 13:43:23 -0400] workmad3: ^^
[2013-10-24 13:43:27 -0400] mveitas: Is there a quick way to avoid having to upload all the cookbooks when doing a berks upload?
[2013-10-24 13:44:48 -0400] cortex: tmichael: I guess that could work for this case if I just get something I can do the conditional on, role won't work it seems
[2013-10-24 13:45:26 -0400] gchristensen: mveitas: you can do `berks upload <cookbook>` and it'll only upload that cookbook and dependencies
[2013-10-24 13:46:50 -0400] workmad3: cortex: yeah, a role is really more intended as a way to build up an extra abstraction within your infrastructure... so you have a role 'webserver' that you can apply to a node, and then that role turns a node into a webserver
[2013-10-24 13:46:58 -0400] workmad3: cortex: by providing the recipes and attributes required
[2013-10-24 13:47:08 -0400] mveitas: gchristensen: ok, just trying to make things a bit quicker and having to avoid uploading things like apt, java, nginx cookbooks that are coming from the community site each time
[2013-10-24 13:47:35 -0400] gchristensen: mveitas: try #berkshelf for more advanced quetsions on berks
[2013-10-24 13:47:54 -0400] workmad3: cortex: however, they're not versionable, and they're all-or-nothing... so many people are moving more towards library-cookbooks which expose resources and application/server cookbooks to assemble those resources into a complete system
[2013-10-24 13:47:55 -0400] mveitas: figured I'd try here first
[2013-10-24 13:49:18 -0400] cortex: workmad3: ok, interesting
[2013-10-24 13:49:44 -0400] cortex: workmad3: so then you'd have both services and "roles" in the cookbooks
[2013-10-24 13:54:18 -0400] workmad3: cortex: the way I'm currently doing it with my build is I have a library cookbook that exposes a lot of high-level resources (ossec install and config, full nginx install and config, etc) so that I can then write a server cookbook (e.g. some-app-lb) that has a single recipe and some attributes, and all it does in the recipe is assemble together those building blocks into a complete server
[2013-10-24 13:56:08 -0400] workmad3: cortex: essentially, I'm splitting apart the 'what' (what makes server X) from the how (how is nginx set up? how is ossec installed and configured?)
[2013-10-24 13:56:51 -0400] workmad3: cortex: which is what roles are/were intended for, but they have limits due to lack of versioning and they're only as configurable as the recipes you pull into them :)
[2013-10-24 13:59:17 -0400] otakup0pe: so ruling out cookbooks being pinned in environment / other cookbooks (we don't use roles) why would a version that is *not* the most recent end up in a chef-run
[2013-10-24 13:59:33 -0400] otakup0pe: every time this happens i feel like i am missing something key.
[2013-10-24 14:08:07 -0400] phutchins: Hey, some of us talked about cluster creation automation with chef and a cloud service. We came up with IronFan being probably the best match for what I'm doing. Does anyone know what the other options out there are?
[2013-10-24 14:08:41 -0400] phutchins: I'm trying to write up a comparison on them to make it easier for folks in our shoes to choose...
[2013-10-24 14:10:49 -0400] otakup0pe: is the thing that i am missing the fact that chef will not neccesarily use the most recent ?
[2013-10-24 14:11:13 -0400] cwj: otakup0pe: i have seen that behavior before but cant really account for it
[2013-10-24 14:11:24 -0400] otakup0pe: sweet
[2013-10-24 14:11:31 -0400] cwj: otakup0pe: i usually pin the environment ~> desired version and get on with my life
[2013-10-24 14:11:36 -0400] cwj: but i would like to know why it happens
[2013-10-24 14:12:45 -0400] phutchins: otakup0pe: I've noticed that too. I think its a bug on the chef side. I always pin as cwj said to avoid the issue...
[2013-10-24 14:13:08 -0400] phutchins: we're still using chef 10 tho, what version are you all using?
[2013-10-24 14:13:24 -0400] gchristensen: why aren't you upgraded?
[2013-10-24 14:13:29 -0400] cwj: phutchins: i have seen it on 10 and 11, using hosted chef
[2013-10-24 14:13:44 -0400] otakup0pe: we are 11, private
[2013-10-24 14:13:49 -0400] phutchins: cwj: i'm 10 private...
[2013-10-24 14:13:50 -0400] otakup0pe: actually i think we are running a nightly
[2013-10-24 14:13:51 -0400] cwj: its my understanding that the chef server is doing the version resolution
[2013-10-24 14:14:07 -0400] phutchins: I thoguht it had to do with cookbook caching at one point
[2013-10-24 14:14:13 -0400] cwj: so if it is a bug i would imagine its in erchef somewhere?
[2013-10-24 14:14:16 -0400] phutchins: and it may still... I haven't dug too far into it.
[2013-10-24 14:14:28 -0400] otakup0pe: oh i wonder if it has to do with the mod time of the most recently uploaded cookbook
[2013-10-24 14:14:58 -0400] phutchins: thats a good point
[2013-10-24 14:15:12 -0400] otakup0pe: testing now.
[2013-10-24 14:15:13 -0400] otakup0pe: if so; lol
[2013-10-24 14:15:15 -0400] phutchins: we'd have to go look and see what the logic is looking for
[2013-10-24 14:15:18 -0400] phutchins: :)
[2013-10-24 14:15:23 -0400] cwj: im not sure that squares with what ive seen
[2013-10-24 14:15:33 -0400] phutchins: I'm not either, but worth ruling out
[2013-10-24 14:15:44 -0400] phutchins: we rarely have newer mod times on older cookbooks
[2013-10-24 14:15:59 -0400] cwj: i am starting to think it has to do with what is resolved within the server-side time constraint
[2013-10-24 14:16:09 -0400] cwj: e.g. if you have more than N versions of a given cookbook
[2013-10-24 14:16:24 -0400] phutchins: you think it takes too long to resolve what the newest would be and times out?
[2013-10-24 14:16:25 -0400] cwj: an older version might be the newest one resolved within the time constraint
[2013-10-24 14:17:12 -0400] phutchins: or older as in created sooner than 1 day ago
[2013-10-24 14:17:17 -0400] otakup0pe: yeah in a perfect world one would never be uploading older cookbooks after a newer one has been uploaded
[2013-10-24 14:17:51 -0400] cwj: in my experience older as in way older
[2013-10-24 14:18:05 -0400] otakup0pe: in this case it is within a day
[2013-10-24 14:18:07 -0400] phutchins: yeah. iave had it not pull a cookbook that was a month+ newer
[2013-10-24 14:18:13 -0400] phutchins: all the way up to minutes
[2013-10-24 14:18:14 -0400] otakup0pe: nope that's not it.
[2013-10-24 14:18:23 -0400] otakup0pe: which makes me happy i guess.
[2013-10-24 14:18:35 -0400] phutchins: it never happened before tho, seems i started seeing it around 10.16
[2013-10-24 14:18:48 -0400] otakup0pe: time to dig into wm_chef i guess heh
[2013-10-24 14:41:58 -0400] willejs: any opscode people about?
[2013-10-24 14:42:26 -0400] willejs: whats with the AWS cookbook, right_aws gem is being deprecated, it should be switched to FOG to support VPC?!
[2013-10-24 14:46:07 -0400] dantleech: hi all
[2013-10-24 14:46:27 -0400] willejs: hi
[2013-10-24 14:46:35 -0400] dantleech: i am new to chef - can anybody suggest a good practice for storing server IP addresses?
[2013-10-24 14:46:41 -0400] dantleech: and such related data
[2013-10-24 14:46:48 -0400] willejs: they are stored automatically with ohai
[2013-10-24 14:47:04 -0400] willejs: so all your node data is collected and stored for you
[2013-10-24 14:47:19 -0400] dantleech: ok -- so if I have a server "web1" which needs an NFS mount on server "nfs"
[2013-10-24 14:47:56 -0400] dantleech: how would I get the IP for server "nfs" - also I am using chef-solo :)
[2013-10-24 14:49:16 -0400] dantleech: my first thought was to create some data bag for each server
[2013-10-24 14:52:47 -0400] ichilton: dantleech: you can use search to find the machine
[2013-10-24 14:53:05 -0400] dantleech: ichilton: with chef-solo ?
[2013-10-24 14:53:08 -0400] ichilton: http://docs.opscode.com/essentials_search.html
[2013-10-24 14:53:10 -0400] ichilton: oh, sorry
[2013-10-24 14:53:34 -0400] ichilton: not sure you can then - as chef solo obviously doesn't know about other nodes
[2013-10-24 14:53:56 -0400] ichilton: you'd have to have it as an attribute in your recipes or a data bag
[2013-10-24 14:54:04 -0400] dantleech: ichilton: yeah -- so I guess creating a databag for each node would b.. yeah
[2013-10-24 14:54:23 -0400] ichilton: if you used chef server, you could search for a machine named 'nfs' - or with an nfs role for example and then get it's ip
[2013-10-24 14:54:35 -0400] ichilton: a data bag item
[2013-10-24 14:54:45 -0400] dantleech: ichilton: yeah, chef-server sounds tempting
[2013-10-24 14:55:09 -0400] cheeseplus: dantleech: if you really wanted to avoid chef-server you could use something like etcd to store the value
[2013-10-24 14:55:14 -0400] ichilton: you can also knife ssh and execute commands against all of your machines, or a subset (again, search)
[2013-10-24 14:55:23 -0400] dantleech: etcd ?
[2013-10-24 14:55:27 -0400] cheeseplus: then use the etcd resource in chef-solo
[2013-10-24 14:55:46 -0400] ichilton: you don't have to run your own chef server, you can use hosted chef at opscode.com
[2013-10-24 14:55:51 -0400] ichilton: it's free for a few nodes.
[2013-10-24 14:55:56 -0400] cheeseplus: that too
[2013-10-24 14:55:57 -0400] cheeseplus: https://github.com/coreos/etcd
[2013-10-24 14:56:05 -0400] ichilton: I prefer to run my own chef server though
[2013-10-24 14:56:08 -0400] dantleech: ichilton: well initially we will have at least 4
[2013-10-24 14:56:11 -0400] cheeseplus: https://github.com/ranjib/chef-etcd
[2013-10-24 14:56:16 -0400] dantleech: but the main usecase atm is for a virtual dev env
[2013-10-24 14:56:20 -0400] dantleech: locally
[2013-10-24 14:56:32 -0400] cheeseplus: dantleech: you can run up to 5 for free on hosted chef
[2013-10-24 14:56:49 -0400] zytta: The deploy resource sure is confusing.
[2013-10-24 14:57:00 -0400] cheeseplus: if youre doing it in local dev and using vagrant you can just use attributes in the Vagrantfile
[2013-10-24 14:57:06 -0400] dantleech: heh. would use up that last node pretty quickly
[2013-10-24 14:57:27 -0400] cheeseplus: dantleech: not sure there is a hard limit but I havent pushed it
[2013-10-24 15:00:27 -0400] dantleech: ok, thanks for the suggestions - I guess etcd is basically the same as having data_bags in our git repo for our purposes
[2013-10-24 15:00:41 -0400] dantleech: i think I will try the data bag approach!
[2013-10-24 15:06:43 -0400] jtimberman: willejs: IMO it should switch to aws-sdk. fewer dependencies than fog, and it's aws specific, whereas fog supports allthethings. it will introduce a dependency on libxml2, due to nokogiri though, and that is unfortunate, but i don't know of a pure ruby w/o C-extension way to support as much of the AWS APIs.
[2013-10-24 15:10:42 -0400] willejs: jtimberman: your probably right the aws-sdk is pretty robust. the heavy water route53 cookbook uses fog and introduces the libxml2 dep and its a pain... but i can deal with it...
[2013-10-24 15:11:17 -0400] willejs: jtimberman: is it going to be addressed at some point? i can't help but think that the AWS cookbook could be way way better
[2013-10-24 15:11:25 -0400] thom: doesn't fog pull in nokogiri anyway?
[2013-10-24 15:11:44 -0400] otakup0pe: digging into the source of erchef the cookbooks going into depsolver are sorted by version
[2013-10-24 15:11:57 -0400] willejs: thom: yeah it does, hence libxml2. I'm not massively bothered about the dep, i pre base base amis anyway.
[2013-10-24 15:11:57 -0400] thom: (it does)
[2013-10-24 15:12:08 -0400] willejs: *pre-bake
[2013-10-24 15:12:34 -0400] otakup0pe: i guess the only way to guarantee the most recent cookbook is to pin everything -_-
[2013-10-24 15:12:59 -0400] benesch: Trying to add a user with knife (knife create user test -p testpass) fails with Response: No routes match the request: /organizations/whoop/users. Anyone know why?
[2013-10-24 15:13:06 -0400] benesch: Other knife commands (knife user list) work fine
[2013-10-24 15:15:08 -0400] otakup0pe: are any opscode cats able to speak as to the actual logic behind which cookbook should be used if there are no version constraints being set anywhere ?
[2013-10-24 15:15:47 -0400] otakup0pe: the docs are unfourtunately kinda vauge. and the actual behaviour is inconsistent.
[2013-10-24 15:16:19 -0400] willejs: otakup0pe: if you don't set a constraint, it uses the newest one
[2013-10-24 15:16:25 -0400] otakup0pe: except it doesn't ;)
[2013-10-24 15:16:38 -0400] willejs: it doesn't use the highest version?
[2013-10-24 15:16:41 -0400] otakup0pe: nope.
[2013-10-24 15:16:46 -0400] willejs: how so?
[2013-10-24 15:16:51 -0400] otakup0pe: if i set the constraint to the highest version it works. which rules out dependency issues.
[2013-10-24 15:16:53 -0400] willejs: can you explain?
[2013-10-24 15:17:14 -0400] otakup0pe: sure i can try. we don't have any constraints in our debug/dev envs. but we are seeing cookbooks that are not the most recent show up in runlists.
[2013-10-24 15:17:29 -0400] otakup0pe: there is no pinning in environments/other cookbooks. and we don't use roles.
[2013-10-24 15:17:58 -0400] otakup0pe: and if we actually pin to the most recent it works fine which i think rules out (other) dependency issues at that version.
[2013-10-24 15:18:25 -0400] willejs: what about the depends in metadat of your cookbooks?
[2013-10-24 15:18:27 -0400] otakup0pe: this behaviour is inconsistent. it seems that most of the time it will indeed pull in the most recent verison. but sometimes it just doesn't.
[2013-10-24 15:18:29 -0400] willejs: do they specify versions?
[2013-10-24 15:18:31 -0400] otakup0pe: nope.
[2013-10-24 15:19:03 -0400] otakup0pe: well; there are a few >= that will match both the most recent and the cookbook that is getting picked (and several other versions below the one getting picked)
[2013-10-24 15:19:04 -0400] willejs: is this only for specific cookbooks?
[2013-10-24 15:19:18 -0400] otakup0pe: today it is. but we've seen it other times as well.
[2013-10-24 15:19:34 -0400] otakup0pe: cwj said he has seen it before
[2013-10-24 15:19:49 -0400] willejs: I've never seen this behaviour... hosted chef?
[2013-10-24 15:19:57 -0400] otakup0pe: nope. private with a two week old nightly.
[2013-10-24 15:20:01 -0400] otakup0pe: but we were seeing it with private v11
[2013-10-24 15:20:21 -0400] willejs: what does the client do when you run it in debug?
[2013-10-24 15:20:34 -0400] willejs: when it fetches the cookbooks maybe?
[2013-10-24 15:20:38 -0400] otakup0pe: i'm sure it'll throw lots of ascii at me. is there anything in particular i should look for ?
[2013-10-24 15:20:53 -0400] jtimberman: otakup0pe: the latest will be used if no other constraint is specified.
[2013-10-24 15:21:08 -0400] otakup0pe: (except that's not what we are seeing)
[2013-10-24 15:21:18 -0400] jtimberman: do you have any constraint on the cookbook at all?
[2013-10-24 15:21:21 -0400] jtimberman: >=?
[2013-10-24 15:21:30 -0400] jtimberman: depends "foo"
[2013-10-24 15:21:39 -0400] otakup0pe: yeah there are some >= that match about a half dozen versions including the most recent and the version that got picked
[2013-10-24 15:21:43 -0400] jtimberman: or depends "foo", ">= 1.1.0"
[2013-10-24 15:21:56 -0400] jtimberman: if you have >= it probably will get the lowest version that matches.
[2013-10-24 15:22:04 -0400] otakup0pe: it's not doing that either heh
[2013-10-24 15:22:04 -0400] jtimberman: that's a constraint, fwiw
[2013-10-24 15:22:21 -0400] jtimberman: zero constraint means no operator with a version at all.
[2013-10-24 15:22:23 -0400] otakup0pe: yeah... i mis-spoke earlier. except it didn't seem like the constraint behaviour was consistent.
[2013-10-24 15:22:42 -0400] otakup0pe: lowest version that matches makes sense though.
[2013-10-24 15:22:46 -0400] shmooze: Hi everyone
[2013-10-24 15:22:56 -0400] otakup0pe: except there are at least three versions between what is the lowest version that matches and what is showing up.
[2013-10-24 15:23:02 -0400] shmooze: I have a Module defined in cookbookA/libraries
[2013-10-24 15:23:10 -0400] otakup0pe: i think the only way to stay sane is just pin everything in an environment. is that what most people do ?
[2013-10-24 15:23:16 -0400] otakup0pe: not sure what the best practice is here.
[2013-10-24 15:23:38 -0400] shmooze: when I execute cookbookA's recipes directly, the recipe finds the module and sees its methods.
[2013-10-24 15:24:22 -0400] shmooze: But when I include cookbookA's recipe from inside cookbookB's recipe, the module cannot be found.
[2013-10-24 15:24:34 -0400] jtimberman: otakup0pe: pinning with equality in an environment is the best thing
[2013-10-24 15:24:36 -0400] jtimberman: we do that in production
[2013-10-24 15:24:37 -0400] shmooze: What am I doing wrong?
[2013-10-24 15:24:57 -0400] otakup0pe: oh we do that in non dev/debug envs and it works perfectly.
[2013-10-24 15:25:02 -0400] otakup0pe: it's just in debug/dev wher eit gets wierd
[2013-10-24 15:25:13 -0400] otakup0pe: shmooze: is the cookbook in the metadata as a dependency ?
[2013-10-24 15:25:18 -0400] shmooze: yes
[2013-10-24 15:25:38 -0400] shmooze: cookbookB's metadata.rb contains "depends 'cookbookA' "
[2013-10-24 15:26:28 -0400] willejs: jtimberman: cheers for re-opening that ticket! I've been waiting for that! :D
[2013-10-24 15:26:45 -0400] jtimberman: willejs: i'm opening another related ticket
[2013-10-24 15:27:14 -0400] willejs: jtimberman: aws'some
[2013-10-24 15:27:19 -0400] shmooze: when included via cookbookB, I get the message 'Caught exception while compiling OpsWorks custom run list: NameError - uninitialized constant Chef::Recipe::NameOfMyModule '
[2013-10-24 15:27:54 -0400] gchristensen: mattray: on a scale of 1 to not at all, how maintained and functional is your dhcp cookbook? :)
[2013-10-24 15:28:11 -0400] mattray: gchristensen: take a look at spheromak's version
[2013-10-24 15:28:18 -0400] gchristensen: will do
[2013-10-24 15:28:19 -0400] mattray: he forked it and ran with it
[2013-10-24 15:28:22 -0400] gchristensen: awesome!
[2013-10-24 15:28:23 -0400] mattray: I'm using dnsmasq now
[2013-10-24 15:28:38 -0400] mattray: so dhcp = 2, dnsmasq = 8
[2013-10-24 15:28:47 -0400] gchristensen: right on
[2013-10-24 15:28:57 -0400] mattray: since I actually use dnsmasq in anger
[2013-10-24 15:29:14 -0400] gchristensen: I'm a shred disappointed that the pxe-dust cookbook doesn't complete the magic dust cycle with a simple DHCP installation :(
[2013-10-24 15:29:41 -0400] mattray: gchristensen: it does, check the 2.0 branch
[2013-10-24 15:29:46 -0400] gchristensen: at!
[2013-10-24 15:29:58 -0400] mattray: I'm waiting for my dnsmasq stuff to get pushed to the community site
[2013-10-24 15:30:11 -0400] otakup0pe: jtimberman: interesting. so we are seeing it pick the highest patch version for the next minor version from our dep
[2013-10-24 15:30:24 -0400] gchristensen: mattray: pxe_dust (opscode-cookbooks)  doesn't have  2.0 branch
[2013-10-24 15:30:32 -0400] mattray: gchristensen: https://github.com/mattray/pxe_dust-cookbook/tree/2.0
[2013-10-24 15:30:38 -0400] gchristensen: OH your cookbook
[2013-10-24 15:30:45 -0400] jtimberman: willejs: https://tickets.opscode.com/browse/CHEF-4675
[2013-10-24 15:30:47 -0400] jtimberman: thom ^ :)
[2013-10-24 15:30:50 -0400] otakup0pe: but it is ignoring the next patch version. dep is >= 0.3.0 and it ignores 0.3.1 and 0.4.0-0.4.5 and picks 0.4.6 (instead of 0.5.0 like i want)
[2013-10-24 15:30:52 -0400] mattray: mine will become the opscode one once the deps are all upstream
[2013-10-24 15:31:02 -0400] otakup0pe: so that actually kind of sort of makes sense given what you said
[2013-10-24 15:31:07 -0400] gchristensen: mattray: this pxe_dust one will be merged back in you say?
[2013-10-24 15:31:14 -0400] mattray: yes
[2013-10-24 15:31:15 -0400] otakup0pe: and i think we are goign to go back to fuzzy matching in minor versions heh
[2013-10-24 15:31:34 -0400] gchristensen: mattray: I owe you a beer if we meet up IRL ;)
[2013-10-24 15:31:37 -0400] jtimberman: anyway, gotta run
[2013-10-24 15:31:53 -0400] mattray: gchristensen: going to take a few more patches from skeptomai and push it up once spox pushes up dnsmasq
[2013-10-24 15:32:15 -0400] mattray: gchristensen: my lab is documented here: https://github.com/mattray/lab-repo
[2013-10-24 15:32:25 -0400] mattray: gchristensen: if you want to see how I use it
[2013-10-24 15:32:43 -0400] mattray: gchristensen: and here: http://docs.opscode.com/openstack_example.html
[2013-10-24 15:33:18 -0400] thom: jtimberman: yeah i've been meaning to file that for ages
[2013-10-24 15:33:19 -0400] gchristensen: mattray: is there any reason this PXE setup wouldn't work with bare metal?
[2013-10-24 15:33:27 -0400] thom: procrastination++
[2013-10-24 15:34:11 -0400] mattray: gchristensen: not that I'm aware of
[2013-10-24 15:34:24 -0400] mattray: gchristensen: everything I have and use it with is documented at those 2 links
[2013-10-24 15:34:36 -0400] mattray: gchristensen: my gear is crap
[2013-10-24 15:34:42 -0400] mattray: gchristensen: but documented
[2013-10-24 15:34:44 -0400] spox: mattray: sorry, i've been swamped and it fell down my queue. i'll get it pushed back up to get to it today or tomorrow :/
[2013-10-24 15:34:44 -0400] gchristensen: wonderful :) and why did you switch to dnsmasq from dhcp?
[2013-10-24 15:35:08 -0400] mattray: dnsmasq is used in the openstack stuff
[2013-10-24 15:35:13 -0400] gchristensen: ahh got it
[2013-10-24 15:35:26 -0400] mattray: I figured I had to use it anyway
[2013-10-24 15:35:36 -0400] mattray: so consolidate dhcp and tftp into dnsmasq
[2013-10-24 15:35:44 -0400] gchristensen: awesome
[2013-10-24 15:35:55 -0400] gchristensen: well I suppose I'll throw it up on some hardware and give it a whirl
[2013-10-24 15:36:06 -0400] gchristensen: yesterday was my first PXE based installation, formalizing it now.
[2013-10-24 15:36:17 -0400] mattray: sure, let me know if you have any issues, the chef-docs are all up on github if you want to make tweaks
[2013-10-24 15:36:27 -0400] mattray: my lab is there as an example
[2013-10-24 15:36:31 -0400] gchristensen: ahh nice
[2013-10-24 15:36:41 -0400] gchristensen: I'll be sure to let you know how it goes. thank you for thefantastic wtork
[2013-10-24 15:36:55 -0400] jmartin1: gchristensen: i owe him several beers as well!
[2013-10-24 15:37:40 -0400] mattray: my pleasure, hope to see everyone in Seattle next month
[2013-10-24 15:37:41 -0400] gchristensen: jmartin1: you and me, we'll get mattray drunk and do something embarrassing so he'll have to do our bidding. amirite?
[2013-10-24 15:37:49 -0400] mattray: whoa!
[2013-10-24 15:38:07 -0400] gchristensen: mattray: I wish :( maybe next year :)
[2013-10-24 15:38:17 -0400] mattray: cool
[2013-10-24 15:45:00 -0400] kallistec: coderanger: put a lot of work in recently with an eye towards enabling SSL verification without breaking ppl
[2013-10-24 15:49:24 -0400] kallistec: coderanger: look around here: https://github.com/opscode/chef/tree/master/lib/chef/http
[2013-10-24 15:50:16 -0400] coderanger: kallistec: Yeah, just need to include the curl ca bundle and set it as the default :)
[2013-10-24 15:50:47 -0400] kallistec: coderanger: already do that; but it wasn't picked up on windows because windows
[2013-10-24 15:51:40 -0400] kallistec: coderanger: fixed that here: https://github.com/opscode/chef/blob/master/lib/chef/config.rb#L359
[2013-10-24 15:51:50 -0400] kallistec: https://github.com/opscode/chef/commit/a4bfa94c775fba01b5167a60cb5a0cb629b6965f
[2013-10-24 15:52:44 -0400] coderanger: That looks like it is only setting a default value on windows?
[2013-10-24 15:55:17 -0400] kallistec: coderanger: yeah, the way we configure ruby on unix makes ruby pick it up automatically AFAIK
[2013-10-24 15:55:46 -0400] coderanger: kallistec: Having unified defaults on that seems like a better bet
[2013-10-24 15:56:12 -0400] coderanger: Easier to debug subtle issues between workstation and nodes, etc
[2013-10-24 15:57:12 -0400] gswallow: Hi!  I have a question about templates on windows.  It seems like the templates I fill out aren't getting CR-NL's.  They're just getting NL's, which windows no likey.
[2013-10-24 15:57:23 -0400] kallistec: coderanger: It'd be nice to handle it at the build level, but for windows we're lazy and use devkit so we don't get to
[2013-10-24 15:57:51 -0400] kallistec: gswallow: what version of chef are you on
[2013-10-24 15:58:08 -0400] coderanger: kallistec: If you set it to use the internal cert bundle by default everywhere that seems like it would fix it to be the same everywhere
[2013-10-24 15:58:20 -0400] kallistec: coderanger: we do, just at different times
[2013-10-24 15:58:44 -0400] coderanger: kallistec: What other time is there?
[2013-10-24 15:58:51 -0400] kallistec: ruby compile
[2013-10-24 15:58:57 -0400] kallistec: vs. runtime
[2013-10-24 15:59:05 -0400] gswallow1: kallistec: 11.6.0
[2013-10-24 15:59:07 -0400] coderanger: kallistec: How does that handle gem installs?
[2013-10-24 15:59:27 -0400] kallistec: it doesn't because we don't own that
[2013-10-24 15:59:48 -0400] coderanger: kallistec: So I repeat, that if you remove that on_windows? it fixes it everywhere :P
[2013-10-24 15:59:57 -0400] kallistec: no, it doesn't
[2013-10-24 16:00:29 -0400] coderanger: gem installs need this fixed somehow, its still pretty common for workstation installs and it matters there too
[2013-10-24 16:01:27 -0400] gchristensen: anyone know of a cookbook that will write out /etc/network/interfaces if a databage entry has info for it? (note: the ifconfig and route providers by chef itself aren't sufficient for the task)
[2013-10-24 16:01:52 -0400] coderanger: (also because as long as chef is published to rubygems it is supported, no matter how many times everyone recommends omnibus ;-)
[2013-10-24 16:02:53 -0400] kraM: Hi there. I need to configure clients to disable colorful printing. Is that possible in client.rb and what would such a configuration look like?
[2013-10-24 16:05:10 -0400] kraM: color "no" ?
[2013-10-24 16:05:25 -0400] context: anyone have any helpful hints on how i go about fixing this: http://pastie.org/8427217
[2013-10-24 16:05:53 -0400] kallistec: coderanger: I don't know how I feel about that. SSL certs is a system/ruby level thing. We ship the CA bundle with omnibus becuase we're in charge of that ruby
[2013-10-24 16:06:32 -0400] context: oh i see. i might have it figured out
[2013-10-24 16:07:05 -0400] kallistec: coderanger: also, I think most ruby install methods do the right thing about SSL certs nowadays.
[2013-10-24 16:07:29 -0400] context: or not :x i AM on application 3.0.0
[2013-10-24 16:09:24 -0400] context: yeah still a problem :(
[2013-10-24 16:10:20 -0400] context: oh think i got it :D
[2013-10-24 16:11:51 -0400] dantleech: what is the best way to find people looking for jobs with chef?
[2013-10-24 16:15:50 -0400] dantleech: just wonering how difficult it is going to be to find somebody to manage our system once its up and running
[2013-10-24 16:16:23 -0400] dantleech: judging the number of people on this channel i guess people aren't in very short supply
[2013-10-24 16:19:06 -0400] programmerq: does anyone know of a project that can help with some of the "boilerplate" involved in installing chef, copying cookbooks/config/etc and running chef-solo? berkshelf integration would be nice.
[2013-10-24 16:19:38 -0400] programmerq: https://github.com/mkocher/soloist <-- this is kind of what I'm looking for, but it uses librarian.
[2013-10-24 16:20:09 -0400] dmdeklerk: programmerq: i used this once https://github.com/gilles/chef-boilerplate
[2013-10-24 16:20:11 -0400] spheromak: mattray, gchristensen im actually going to have a new dhcp cook release soon .. getting all chefspec 3'd out atm
[2013-10-24 16:21:20 -0400] dmdeklerk: programmerq: sorry wrong link, its this one
[2013-10-24 16:21:24 -0400] dmdeklerk: https://github.com/jasonrobertfox/chef-broiler-plate
[2013-10-24 16:22:13 -0400] dmdeklerk: programmerq: it comes with a nice 10 part tutorial http://neverstopbuilding.net/chef-best-practices-a-series/
[2013-10-24 16:23:06 -0400] gchristensen: spheromak: nice! I'll definitely check that out.
[2013-10-24 16:24:13 -0400] spheromak: gchristensen, i also want to decouple from bags on it where apropriate. I made it for my more complex scenario, but for simple stuff it shouldn't require all that it currently does.
[2013-10-24 16:24:27 -0400] gchristensen: surely
[2013-10-24 16:24:37 -0400] gchristensen: my DHCP needs are fairly simple :) distribute 4 IPs to my network...
[2013-10-24 16:24:52 -0400] coderanger: kallistec: I disagree, unified SSL defaults is an application level issue
[2013-10-24 16:25:07 -0400] coderanger: kallistec: openssl is explicitly built to make cert policy _not_ global
[2013-10-24 16:25:39 -0400] kallistec: what?
[2013-10-24 16:26:49 -0400] spheromak: gchristensen, them maybe dnsmasq ?
[2013-10-24 16:26:51 -0400] spheromak: :D
[2013-10-24 16:26:52 -0400] kallistec: every OS has its own means of distributing trusted root certs that are the fundamental basis of trust
[2013-10-24 16:27:30 -0400] coderanger: kallistec: Yes, and using the OS trust store by default in Chef would be hell for debugging
[2013-10-24 16:27:43 -0400] coderanger: kallistec: It should be an option, but the default should be the same across all platforms
[2013-10-24 16:27:46 -0400] Skeletor1: Where do I log issues with cookbooks?
[2013-10-24 16:27:56 -0400] coderanger: Skeletor1: Depends on the cookbook
[2013-10-24 16:28:00 -0400] gchristensen: spheromak: perhaps :) I only provision about 10 boxes a month, doing 4 simultaneously is enough, and immediately after the imaging it gets a specified IP from Chef
[2013-10-24 16:28:46 -0400] spheromak: gchristensen, yea this was designed to do dhcp / dyndns for 3 datacneters worth of gear originally
[2013-10-24 16:28:50 -0400] kallistec: coderanger: the reality is it's not that simple. Apple patches openssl to use the keychain CA certs, so any ruby built against apple's openssl is gonna use apple's certs whether you like it or not
[2013-10-24 16:28:58 -0400] gchristensen: spheromak: nice :D a bit over kill, hah.
[2013-10-24 16:29:58 -0400] coderanger: kallistec: You can get much closer than just saying "not our problem"
[2013-10-24 16:30:24 -0400] coderanger: kallistec: The data path should at least be correct, if ruby ignores it then so be it, but the path given to it should be the right thing
[2013-10-24 16:30:36 -0400] kallistec: what?
[2013-10-24 16:30:42 -0400] coderanger: especially when it is as simple as having a default config value
[2013-10-24 16:30:56 -0400] kallistec: the default config value is meaningless
[2013-10-24 16:31:06 -0400] coderanger: Why is it meaningless?
[2013-10-24 16:31:22 -0400] context: hell yeah ! got this shiz working :D
[2013-10-24 16:31:35 -0400] context: nginx load balancer was actually fairly easy
[2013-10-24 16:31:42 -0400] kallistec: coderanger: look at how it works. it finds the CA bundle inside an omnibus package
[2013-10-24 16:31:55 -0400] kallistec: it's not going to do anything for gem installs
[2013-10-24 16:32:18 -0400] kallistec: coderanger: and besides that, it's a hack that is the best we can do for now on windows
[2013-10-24 16:32:35 -0400] coderanger: kallistec: Just make the default path File.expand_path('../cacert.pem', __FILE__) or whatever
[2013-10-24 16:32:38 -0400] kallistec: because we don't own the ruby compile phase
[2013-10-24 16:32:43 -0400] coderanger: distributed next to the code
[2013-10-24 16:33:19 -0400] context: or not :x re-provisioning the load balancer didnt update config file with new web server :-/
[2013-10-24 16:34:03 -0400] coderanger: If you guys are considering Chef to be an omnibus-only tool, then you need to stop releasing on rubygems same way vagrant did
[2013-10-24 16:34:12 -0400] kallistec: coderanger: that's less good. the ssl_ca_file setting only applies for HTTPS connections you make with Chef::HTTP and subclasses
[2013-10-24 16:34:29 -0400] coderanger: kallistec: Yes, those are the ones I'm worried about
[2013-10-24 16:34:40 -0400] kallistec: which we accept as the best we can do given the constraints of windows omnibus packages
[2013-10-24 16:34:51 -0400] coderanger: As thats the vast majority of HTTP connections during a chef run
[2013-10-24 16:35:13 -0400] coderanger: securing random other gems used during a recipe is nice, but shouldn't result in this messy default
[2013-10-24 16:35:26 -0400] kallistec: but if you configure ruby to look in the right place, then all SSL connections use the same root certs, regardless of protocol
[2013-10-24 16:35:43 -0400] kallistec: if your only argument is "debugging", it sound equally shitty
[2013-10-24 16:36:08 -0400] coderanger: My argument is that Chef shouldn't behave differently depending on platform unless needed
[2013-10-24 16:36:11 -0400] coderanger: This isn't needed
[2013-10-24 16:36:13 -0400] coderanger: So its a bug
[2013-10-24 16:36:22 -0400] kallistec: it is needed
[2013-10-24 16:36:23 -0400] context: ok, i brought up webserver, then loadbalancer, it properly put weserver in config, brought up second web server, re-provision balancer, only first webserver is in config
[2013-10-24 16:36:39 -0400] coderanger: kallistec: Why not just do both?
[2013-10-24 16:37:04 -0400] coderanger: kallistec: If in omnibus, use the current logic, if not in omnibus use forced default in the gem
[2013-10-24 16:37:28 -0400] context: ARGH !@#
[2013-10-24 16:37:45 -0400] kallistec: coderanger: the logic is not needed on windows
[2013-10-24 16:37:49 -0400] kallistec: er, on unix
[2013-10-24 16:38:28 -0400] coderanger: kallistec: Yes, because the default shouldn't be the OS trust roots
[2013-10-24 16:38:38 -0400] context: nm. guess second server was not provisioned or something
[2013-10-24 16:38:39 -0400] coderanger: because those are widely varying
[2013-10-24 16:38:57 -0400] coderanger: and "whom does Chef trust" needs to be unified by default
[2013-10-24 16:40:04 -0400] coderanger: Saying "there is some OS trust store, its probably correct" mean exposing Chef users to things like distro politics on what CAs to trust
[2013-10-24 16:40:09 -0400] coderanger: its just not a good user experience
[2013-10-24 16:40:12 -0400] context: or maybe hosted chef is being really weird
[2013-10-24 16:40:24 -0400] coderanger: Pick one and use it (generally the mozilla bundle)
[2013-10-24 16:41:18 -0400] kallistec: coderanger: if you choose not to use omnibus, you get the behavior of the ruby you brought
[2013-10-24 16:41:42 -0400] kallistec: in omnibus, everyone gets the same cert bundle
[2013-10-24 16:41:54 -0400] coderanger: Again, if you are disavowing the user experience of gem installs, stop releasing on rubygems
[2013-10-24 16:42:00 -0400] coderanger: Either it is supported or it isn't
[2013-10-24 16:42:08 -0400] kallistec: wow man
[2013-10-24 16:42:28 -0400] jtimberman: "supported" is a nuanced word that has at least two different meanings in this context.
[2013-10-24 16:42:32 -0400] coderanger: "the ruby you brought" isn't generally considered to dictate SSL policy
[2013-10-24 16:42:32 -0400] kallistec: it supported as a gem install
[2013-10-24 16:42:36 -0400] gchristensen: is this RE verifying SSL certificates?
[2013-10-24 16:43:04 -0400] kallistec: if choose to install as a gem, chef acts like a gem
[2013-10-24 16:43:24 -0400] jtimberman: coderanger: i think that, since Apple monkeypatches openssl, they're dictating the policy here. It shouldn't be an issue on other platforms that behave a bit more sane.
[2013-10-24 16:43:29 -0400] kallistec: if you choose to install as a full stack package, it takes care of the things that come with it
[2013-10-24 16:43:31 -0400] coderanger: kallistec: plenty of gems ship the curl ca bundle and just point to it internally
[2013-10-24 16:43:55 -0400] coderanger: jtimberman: "it shouldn't be an issue" except ubuntu's CA root policy is insane
[2013-10-24 16:44:03 -0400] coderanger: jtimberman: Not something I would ever want to expose people to
[2013-10-24 16:44:36 -0400] coderanger: and if remote_file is going to verify by default (which it should) that means this has to handle all the random certs you'll find out there
[2013-10-24 16:44:41 -0400] coderanger: hence unifying it
[2013-10-24 16:45:19 -0400] bean__: most things /should be fine/ assuming that people have proper CA bundles set up on the remote server.
[2013-10-24 16:45:39 -0400] bean__: granted I'm on mac most of the time so I don't really know the state of ubuntu's root CA.
[2013-10-24 16:45:43 -0400] coderanger: Thats super hand wavey
[2013-10-24 16:45:52 -0400] bean__: Oh, I know.
[2013-10-24 16:46:09 -0400] coderanger: There exists a simple technical solution for this
[2013-10-24 16:46:42 -0400] context: http://pastie.org/8427324 <- why isnt the new node seen until i do a show on it
[2013-10-24 16:47:25 -0400] context: hosted chef, those were executed right after eachother not doing anything in between
[2013-10-24 16:47:32 -0400] coderanger: And given 1) the complexity of figuring out that a url isn't working because of mismatched CA roots and 2) the simplicity of the solution, I don't see why this shouldn't be fixed
[2013-10-24 16:50:12 -0400] dgarstang2: I keep uploading files to my chef server, check on the UI and they aren't there. What's up with that?
[2013-10-24 16:53:29 -0400] dgarstang2: i just bumped the version number, did it again. STILL not there
[2013-10-24 16:54:25 -0400] context: :-/
[2013-10-24 16:54:35 -0400] bean__: dgarstang2: what version of chef server are you on?
[2013-10-24 16:54:52 -0400] dgarstang2: bean__: latest
[2013-10-24 16:55:08 -0400] dgarstang2: bean: seems arbitrary, and common
[2013-10-24 16:55:14 -0400] bean__: so 11.6.2-1?
[2013-10-24 16:55:53 -0400] bean__: dgarstang2: and how are you uploading?
[2013-10-24 16:56:05 -0400] context: can anyone explain my pastie, my load balancer, nor 'knife search' see a new node until i specifically do a 'knife node show' on it
[2013-10-24 16:56:46 -0400] dgarstang2: bean: 11.0.8-1 ... thats the latest server version. Client is 11.0.8
[2013-10-24 16:56:59 -0400] dgarstang2: sorry client is 11.6
[2013-10-24 16:58:46 -0400] bean__: right, right, sorry i was reading incorrectly.
[2013-10-24 16:59:01 -0400] bean__: context: you likely need to reindex your search.
[2013-10-24 16:59:08 -0400] bean__: dgarstang2: so how are you uploading?
[2013-10-24 16:59:11 -0400] dgarstang2: :) did it again, still no workie. Dammit. The version number on the server is right, but the files aren't there
[2013-10-24 16:59:40 -0400] dgarstang2: bean__: /opt/chef/embedded/bin/berks upload -c /var/lib/jenkins/.berkshelf/config-us4.json
[2013-10-24 17:00:45 -0400] bean__: and that's being run in a folder with a berksfil?
[2013-10-24 17:00:46 -0400] bean__: e
[2013-10-24 17:00:50 -0400] bean__: and the command says it uploaded?
[2013-10-24 17:00:56 -0400] bean__: or is it still hanging like the other day
[2013-10-24 17:01:16 -0400] dgarstang2: bean__: Completes. Says it's all good. Yep.
[2013-10-24 17:01:31 -0400] bean__: hmm, and you bumped the version # in the metadata
[2013-10-24 17:01:34 -0400] dgarstang2: I'll try with debug and see if I can see the missing file mentioned
[2013-10-24 17:01:44 -0400] dgarstang2: bean: yes, becasue the server shows the correct version number
[2013-10-24 17:01:52 -0400] dgarstang2: server = chef web UI
[2013-10-24 17:02:03 -0400] bean__: yar.
[2013-10-24 17:02:16 -0400] bean__: so, you bumped it but not all of the files that you're expecting are there?
[2013-10-24 17:02:41 -0400] dgarstang2: bean__: correct
[2013-10-24 17:02:52 -0400] dgarstang2: but the version number reported by the chef server web UI matches
[2013-10-24 17:03:05 -0400] chris613: I swear I see this sort of problem ovvasionally. Usually rm -Rf /var/cache/chef (depending on what you have in client.rb) takes care of it. Never found a root cause
[2013-10-24 17:03:51 -0400] bean__: dgarstang2: what file is missing?
[2013-10-24 17:04:17 -0400] dgarstang2: bean__: uno momento
[2013-10-24 17:06:09 -0400] context: bean__: after everytime i add a new node? im using hosted-chef right now
[2013-10-24 17:06:25 -0400] bean__: context: oh, it should just appear then, odd.
[2013-10-24 17:06:40 -0400] context: gonna remove all and try agian later
[2013-10-24 17:06:41 -0400] bean__: dgarstang2: I've gotta go grab lunch but i'll be back in a bit to see if we can't figure this out
[2013-10-24 17:06:45 -0400] context: time to get real work done :x
[2013-10-24 17:08:51 -0400] dgarstang2: bean__: I think it may be a git/tags issue. Ugh
[2013-10-24 17:17:15 -0400] adamjk-dev: hey all, anyone familiar with fnichol's rvm cookbook?
[2013-10-24 17:17:30 -0400] adamjk-dev: I want to have it set the ruby version it installs to be used and the default and I wasn't sure how
[2013-10-24 17:21:57 -0400] dgarstang2: I'm running "berks upload -c ~/.berkshelf/config-us4.json". The version on the server is right. Files aren't there. How can that happen!?!?
[2013-10-24 17:29:28 -0400] spstarr_work: folks
[2013-10-24 17:29:34 -0400] spstarr_work: does the file block support source?
[2013-10-24 17:30:34 -0400] spstarr_work: file "/etc/foobar.conf" source "config-foobar.conf" ... end ?
[2013-10-24 17:30:56 -0400] spstarr_work: instead of me having to specify in content the file contents?
[2013-10-24 17:31:33 -0400] dgarstang2: chefignore. Do I need it?
[2013-10-24 17:38:43 -0400] cwj: spstarr_work: sounds like you want cookbook_file resource instead of file resource
[2013-10-24 17:39:58 -0400] spstarr_work: cwj: how come template isn't cookbok_template then?
[2013-10-24 17:40:21 -0400] cwj: couldnt say
[2013-10-24 17:42:30 -0400] cwj: but chef always renders a file from a template by using a template provided in the cookbook
[2013-10-24 17:43:07 -0400] cwj: this page is your friend http://docs.opscode.com/resource.html#resources
[2013-10-24 17:46:03 -0400] ch4rlie: hello Chefs.  I'm looking for some assistance with using knife to bootstrap Windows
[2013-10-24 17:46:23 -0400] ch4rlie: specifically, installing the chef-client as a windows service
[2013-10-24 17:46:39 -0400] ch4rlie: using winrm
[2013-10-24 17:49:32 -0400] joe_k: there is a chef-client cookbook, not sure if it will setup chef client as a service
[2013-10-24 17:50:03 -0400] joe_k: you want it to run periodically?
[2013-10-24 17:50:20 -0400] joe_k: do you already have your windows node bootstrapped and doing the initial converge?
[2013-10-24 17:50:25 -0400] ch4rlie: I'd like to have the client run about every 10 mins
[2013-10-24 17:50:39 -0400] ch4rlie: I'm successfully using the chef-client cookbook with my linux clients
[2013-10-24 17:51:24 -0400] ch4rlie: but the runs on windows servers error out saying the recipe cannot find 'which chef-client' for my windows nodes
[2013-10-24 17:52:01 -0400] joe_k: d'oh, http://community.opscode.com/cookbooks/chef-client no windows
[2013-10-24 17:52:24 -0400] DanKest: When will an omnibus for 10.9 be available?
[2013-10-24 17:52:55 -0400] ch4rlie: I should mention I have successfully installed the client as a service in Windows using msiexec commands
[2013-10-24 17:52:59 -0400] joe_k: there's windows_task in the windows cookbook
[2013-10-24 17:53:11 -0400] ch4rlie: but that doesnt really apply to my bootstrapping
[2013-10-24 17:54:03 -0400] joe_k: windows_task "chefclient" do frequency :minute; frequency_modifier 15; command "chef-client" end
[2013-10-24 17:55:15 -0400] joe_k: and windows_package can probably install the msi from wherever bootstrapping puts it if it has options that install it as a service
[2013-10-24 17:55:54 -0400] ch4rlie: how can I reinstall the client by msi when I need the client to run windows_package?
[2013-10-24 17:56:06 -0400] joe_k: bootstrapping installs the client
[2013-10-24 17:56:23 -0400] joe_k: (but not as a service)
[2013-10-24 17:56:25 -0400] joe_k: and runs an initial run
[2013-10-24 17:56:29 -0400] ch4rlie: right, how can I configure bootstrapping to instlal the client as service?
[2013-10-24 17:56:43 -0400] ch4rlie: once bootstrapped, the client is installed
[2013-10-24 17:57:00 -0400] ch4rlie: so how would I install by msi if I have already bootstrapped?
[2013-10-24 17:59:20 -0400] pragmatism: When will a 10.9 omnibus be available?
[2013-10-24 18:00:34 -0400] joe_k: how did you do it with msiexec? id pass those args to windows_package
[2013-10-24 18:01:07 -0400] joe_k: you can maybe also customize bootstrap's arguments to the msi with some attribute, but thats a presumption
[2013-10-24 18:01:59 -0400] arussel: I'm having a hard time understanding: http://docs.opscode.com/lwrp_custom_provider_ruby.html
[2013-10-24 18:02:03 -0400] dgarstang2: Can someone please tell me why a knife-upload keeps showing it's updating the same files? That scares the heck out of me
[2013-10-24 18:02:13 -0400] arussel: what is the load_current_resource method ?
[2013-10-24 18:02:27 -0400] arussel: is it a method we have to implement and called by chef client ?
[2013-10-24 18:02:57 -0400] joe_k: http://docs.opscode.com/knife_bootstrap.html#microsoft-windows
[2013-10-24 18:03:05 -0400] joe_k: the script thats stuffed onto the node to bootstrap it
[2013-10-24 18:03:28 -0400] joe_k: has the msiexec that installs the msi on line.... uh search for @msiexec
[2013-10-24 18:04:26 -0400] joe_k: ch4rlie: i dont see any options on that msiexec command line but I am pretty sure you can give bootstrap a modified copy of that script
[2013-10-24 18:06:07 -0400] arussel: I'm not getting what this method does in here: https://github.com/opscode-cookbooks/windows/blob/master/providers/printer.rb
[2013-10-24 18:06:47 -0400] joe_k: ch4rlie: http://docs.opscode.com/knife_bootstrap.html#custom-templates
[2013-10-24 18:14:41 -0400] mmzyk: joe_k and ch4rlie You might want to look into chef-service-manager, a command line tool installed along side chef-client to manage the chef-client service on windows. https://github.com/opscode/chef/blob/master/bin/chef-service-manager
[2013-10-24 18:15:31 -0400] gchristensen: mattray: what dnsmasq cookbook do you use, and at what reference point?
[2013-10-24 18:16:04 -0400] arussel: what would be the best cookbook to understand lwrp ? the more I read the doc on the site, the less I understand :(
[2013-10-24 18:16:05 -0400] mattray: gchristensen: https://github.com/mattray/dnsmasq/tree/0.2.0
[2013-10-24 18:16:09 -0400] pragmatism: When will a 10.9 omnibus be available?
[2013-10-24 18:16:56 -0400] mattray: gchristensen: if you look at the lab-repo Berksfile, you can see the versions of everything I use: https://github.com/mattray/lab-repo/blob/master/Berksfile
[2013-10-24 18:17:49 -0400] gchristensen: mattray: ahh! got it. thank you. also, I'm digging your annoyances cookbook.
[2013-10-24 18:18:41 -0400] mmzyk: pragmatism There's no certain time frame on that at the moment.
[2013-10-24 18:19:01 -0400] mattray: pragmatism: does the existing OSX one not work?
[2013-10-24 18:19:18 -0400] pragmatism: mattray: I get an error saying that there's no Omnibus for 10.9
[2013-10-24 18:19:34 -0400] mattray: oh, gotcha
[2013-10-24 18:19:37 -0400] mattray: from the API
[2013-10-24 18:19:40 -0400] pragmatism: yeah
[2013-10-24 18:19:45 -0400] pragmatism: can I specify a version I want?
[2013-10-24 18:19:49 -0400] mattray: yeah
[2013-10-24 18:19:51 -0400] mattray: 1 sec
[2013-10-24 18:19:54 -0400] pragmatism: ty
[2013-10-24 18:20:29 -0400] mattray: https://opscode-omnibus-packages.s3.amazonaws.com/mac_os_x/10.7/x86_64/chef-11.6.2_1.mac_os_x.10.7.2.sh
[2013-10-24 18:20:35 -0400] mondo: if I put templates or files into directories outside of "default" how do I reference them?
[2013-10-24 18:20:40 -0400] mattray: pragmatism: http://www.opscode.com/chef/install/
[2013-10-24 18:20:56 -0400] mattray: just pick your OS as 10.7 and it'll give you the direct download link
[2013-10-24 18:21:03 -0400] mondo: so I'd have cookbook/templates/recipename/file.erb
[2013-10-24 18:21:20 -0400] mondo: what would my source line look like?
[2013-10-24 18:21:59 -0400] bean__: so dgarstang2 did you get it figured out?
[2013-10-24 18:22:02 -0400] pragmatism: mattray: awesome, thanks
[2013-10-24 18:22:22 -0400] mattray: pragmatism: I expect the installer just works
[2013-10-24 18:22:25 -0400] walkah: mattray: is there a ticket to track getting the 1 line fix into install.sh ?
[2013-10-24 18:22:55 -0400] walkah: but, for things like vagrant-omnibus (or anything that just uses install.sh) it's kind of a pain
[2013-10-24 18:23:14 -0400] mattray: yeah
[2013-10-24 18:23:36 -0400] mattray: walkah: open a ticket on https://tickets.opscode.com/secure/QuickSearch.jspa I expect it should get fixed pretty soon
[2013-10-24 18:24:01 -0400] walkah: mattray: will do I was going to offer a PR but couldn't figure out if install.sh is actually in any of the omnibus repos (i didn't see it)
[2013-10-24 18:24:15 -0400] mattray: yeah, it's in a private repo we were talking about open sourcing
[2013-10-24 18:24:22 -0400] mattray: omnitruck is the API
[2013-10-24 18:24:29 -0400] mattray: http://docs.opscode.com/api_omnitruck.html
[2013-10-24 18:24:56 -0400] walkah: I don't see omnitruck on github :)
[2013-10-24 18:25:05 -0400] mattray: yeah, private repo :)
[2013-10-24 18:25:15 -0400] mattray: but the wheels are turning
[2013-10-24 18:26:29 -0400] walkah: mattray: awesome. https://tickets.opscode.com/browse/CHEF-4678
[2013-10-24 18:27:09 -0400] walkah: mattray: I think build-essential needs a patch for 10.9 too, but still tinkering with that
[2013-10-24 18:31:34 -0400] gchristensen: hrm... when was lazy {} added to chef? I'm getting an error on chef 11.4.4
[2013-10-24 18:38:14 -0400] miah: lazy {} ?
[2013-10-24 18:50:55 -0400] ichilton: Got a few cookbooks on github - is there a guide anywhere on how to get them onto the community site?
[2013-10-24 18:56:10 -0400] douglaswth: ichilton: I don't know about a guide, but it looks like you just upload a tarball and maybe give it some tags http://community.opscode.com/cookbooks/new
[2013-10-24 18:58:56 -0400] troyready: (not trolling) is there much of a purpose in uploading to the community site now? I get the feeling that most development is centered around github anyway
[2013-10-24 19:00:08 -0400] btm: @opscode no KNIFE tickets awaiting review, so no knife code review today. I'll be looking through PRs offline myself.
[2013-10-24 19:01:53 -0400] douglaswth: troyready: berkshelf uses the community site to download stuff by default
[2013-10-24 19:06:28 -0400] troyready: Ah, nice, good to know
[2013-10-24 19:08:10 -0400] AskSteve: anybody tried HipChat notification with chef-client?
[2013-10-24 19:09:50 -0400] cwj: AskSteve: i wrote a lwrp for that purpose https://github.com/cwjohnston/chef-hipchat
[2013-10-24 19:10:14 -0400] cwj: i need to upload the latest to the community site but i havent had a chance yet
[2013-10-24 19:10:38 -0400] AskSteve: does that work as an error handler?
[2013-10-24 19:10:51 -0400] cwj: nope that would be something different
[2013-10-24 19:10:51 -0400] AskSteve: as in a generic error handler
[2013-10-24 19:11:27 -0400] AskSteve: I've been working with this one: https://github.com/mojotech/hipchat/blob/master/lib/hipchat/chef.rb
[2013-10-24 19:13:04 -0400] cwj: might try that myself, is it working for you?
[2013-10-24 19:13:10 -0400] AskSteve: nope ;-)
[2013-10-24 19:13:17 -0400] cwj: what happens?
[2013-10-24 19:13:36 -0400] AskSteve: I setup a new repo, created a node that calls a recipe that is not on the server
[2013-10-24 19:13:51 -0400] AskSteve: client gives me a FATAL error on screen, but nothing goes to hipchat
[2013-10-24 19:14:55 -0400] AskSteve: [2013-10-24T19:14:21+00:00] ERROR: Running exception handlers
[2013-10-24 19:14:56 -0400] AskSteve: [2013-10-24T19:14:22+00:00] FATAL: Saving node information to /var/chef/cache/failed-run-data.json
[2013-10-24 19:14:56 -0400] AskSteve: [2013-10-24T19:14:22+00:00] ERROR: Exception handlers complete
[2013-10-24 19:17:19 -0400] dmdeklerk: Anyone using leibniz in cucumber features ? Running `$ bundle exec cucumber` works but will shows MINIMAL feedback STDOUT. 5 minutes of silence
[2013-10-24 19:17:46 -0400] cwj: AskSteve: by what means are you activating the handler
[2013-10-24 19:19:06 -0400] AskSteve: adding the code to /etc/chef/client.rb on the node
[2013-10-24 19:24:08 -0400] mondo: if I set an attribute default to [nil] and then in a role I do :attribute => ["v1", "v2"], v1 is at attribute[1] instead of attribute[0]
[2013-10-24 19:24:36 -0400] mondo: so when I do :attribute =>  Am I adding to the existing array set by the attribute default?
[2013-10-24 19:26:06 -0400] dJustin: I updated an environment, with several nodes associated.  Specifically, an attribute on the environment.  Is there any way to update all the nodes, via knife exec, to reload these attributes to the node?  Something easier than running chef-client on each node...?
[2013-10-24 19:30:56 -0400] mondo: So yeah wtf it's merging the array I set in my role overrides and the array set in my attribute defaults.  Is there any way to stop this?
[2013-10-24 19:31:38 -0400] mondo: I want my role override to replace the array set in the attribute defaults
[2013-10-24 19:37:02 -0400] dJustin: http://docs.opscode.com/chef_overview_attributes.html  looks like the node can only be updated via chef-client, bummer
[2013-10-24 19:37:37 -0400] dJustin: updated through inheritance, that is...I know how to update a node's direct attributes via knife
[2013-10-24 19:44:55 -0400] wdilly: I am randomly getting this error at various places throughout my chef run: Encoding::UndefinedConversionError: "\x8B" from ASCII-8BIT to UTF-8
[2013-10-24 19:45:12 -0400] wdilly: using recipes that are unchanged
[2013-10-24 19:45:20 -0400] wdilly: anybody have any idea where to begin?
[2013-10-24 19:46:03 -0400] mondo: looks like this is what I was talking about https://tickets.opscode.com/browse/CHEF-2780
[2013-10-24 19:46:58 -0400] heathsnow_: Anyone have a technique where an LWRP uses the template resource...but the template lives in another cookbook?
[2013-10-24 19:48:15 -0400] mveitas: heathsnow_: as in you want to override the source or other attributes of the template resource correct?
[2013-10-24 19:49:40 -0400] heathsnow_: mveitas:  yes, I want my LWRP to call 'template'...but I don't want the erb file to be part of my LWRP cookbook...but it should be in the cookbook that's calling it
[2013-10-24 19:50:29 -0400] mveitas: heathsnow_: https://gist.github.com/mveitas/7143822
[2013-10-24 19:50:49 -0400] mveitas: you can retrieve the resource and then just set the source, cookbook, and anything else you want :)
[2013-10-24 19:52:16 -0400] gchristensen: mattray: it appears that the pxe_dust cookbook writes out an apache config which redirects from the raw IP to the hostname, which ends up breaking the preseed
[2013-10-24 19:55:03 -0400] crombar: I am trying to install curl on ubuntu 12.04. The recipe just conttains: package 'curl' . However, this fails. The log shows this line:
[2013-10-24 19:55:04 -0400] crombar: Chef::Exceptions::Exec: package[curl] (oracle-java::default line 12) had an error: Chef::Exceptions::Exec: apt-get -q -y install curl=7.22.0-3ubuntu4.1 returned 100, expected 0
[2013-10-24 19:55:06 -0400] heathsnow_: mveitas: I did not know that....I'll test it now :)
[2013-10-24 19:55:19 -0400] gswallow: ah ha
[2013-10-24 19:55:20 -0400] gswallow: https://tickets.opscode.com/browse/CHEF-4145
[2013-10-24 19:55:47 -0400] tscanausa: crombar: you need to run the apt package as well
[2013-10-24 19:56:10 -0400] tscanausa: sorry the apt cookbook
[2013-10-24 19:56:10 -0400] crombar: If I try to run that in the shell, the output is Version '7.22.0-3ubuntu4.1' for 'curl' was not found. Any ideas where that version number comes from?
[2013-10-24 19:56:41 -0400] tscanausa: crombar: thats because you need apt-get update
[2013-10-24 19:56:44 -0400] tscanausa: to run
[2013-10-24 19:57:13 -0400] crombar: tscanausa: If I run apt-get update in the comman line first, it still won't find that package
[2013-10-24 19:57:24 -0400] gswallow: @kallistec re my question hours ago. the solution is to a) create a templates/windows/ directory, copy your .erb template to it, and perl -pi -e 's/\012/\015\012/' it.  And to not use Chef 11 on Windows apparently.
[2013-10-24 19:59:02 -0400] tscanausa: crombar: that seems like an old version of curl.
[2013-10-24 19:59:38 -0400] crombar: tscanausa: k,thx. I'll give it a try
[2013-10-24 20:00:31 -0400] tscanausa: crombar: http://packages.ubuntu.com/search?keywords=curl&searchon=names&suite=all&section=all
[2013-10-24 20:14:32 -0400] crombar: tscanausa: thank you. that did the trick
[2013-10-24 20:15:09 -0400] heathsnow_: mveitas: do you know how my LWRP can identify which cookbook is calling it so I can set the motd_template.cookbook 'cookbook name'?
[2013-10-24 20:15:48 -0400] cwj: heathsnow_: new_resource.cookbook should contain the name of the cookbook where the resource is being used
[2013-10-24 20:16:21 -0400] heathsnow_: cwj: sweet, thx :)
[2013-10-24 20:20:30 -0400] cwj: AskSteve: just for you https://github.com/cwjohnston/chef-hipchat/tree/handler
[2013-10-24 20:20:47 -0400] cwj: added that handler and the means to activate it
[2013-10-24 20:22:10 -0400] AskSteve: checking
[2013-10-24 20:23:00 -0400] cwj: the test-kitchen suite work for me
[2013-10-24 20:23:26 -0400] cwj: https://dl.dropboxusercontent.com/s/u3uopmh0zv85fww/2013-10-24%20at%202.23%20PM.png
[2013-10-24 20:24:21 -0400] AskSteve: looks good so just include the recipe in the run list or do I have to edit client.rb as well?
[2013-10-24 20:25:00 -0400] cwj: that recipe does the work of loading the handler early on in the chef run
[2013-10-24 20:25:26 -0400] cwj: so youd need to put it early in your run list (eg in a base role) and make sure node['hipchat']['handler']['enabled] = true
[2013-10-24 20:25:50 -0400] cwj: and set up the node attrs for credentials
[2013-10-24 20:27:12 -0400] AskSteve: testing it out now
[2013-10-24 20:31:30 -0400] ssd7: Ohai Chefs
[2013-10-24 20:31:56 -0400] ggolin_: hey all
[2013-10-24 20:33:00 -0400] ggolin_: do attributes inside roles get evaluated? can i do things like sysctl: { "kernel.shmmax" : ((node.memory.total.to_i * 1024) * 0.80).to_i }
[2013-10-24 20:33:02 -0400] ggolin_: ?
[2013-10-24 20:36:12 -0400] AskSteve: @cwj when I do a git clone https://github.com/cwjohnston/chef-hipchat.git
[2013-10-24 20:36:20 -0400] AskSteve: some files are missing like handler.rb ;-)
[2013-10-24 20:37:07 -0400] cwj: AskSteve: check out the handler branch?
[2013-10-24 20:37:21 -0400] ssd7: ggolin_: Not inside roles, no
[2013-10-24 20:37:33 -0400] ggolin_: ssd7, thank you
[2013-10-24 20:38:55 -0400] AskSteve: yup, doing that now
[2013-10-24 20:38:59 -0400] mondo: When I add something to a databag it takes a minute or two to be accessible by a node, is this a caching thing or does the chef-server delay writes to its database or something?  Just curious what's happening behind the scenes.
[2013-10-24 20:42:12 -0400] AskSteve: @cwj in my case, I'm missing recipes on the server (on purpose that's the current failure I'm testing)  running chef-client fails due to missing cookbooks as expected but no hipchat notice
[2013-10-24 20:43:05 -0400] cwj: a failure at that point in the run would prevent the handler from being activated by the recipe
[2013-10-24 20:44:19 -0400] cwj: AskSteve: https://github.com/needle-cookbooks/chef-exception-test
[2013-10-24 20:44:33 -0400] cwj: that will cause an exception during the chef run
[2013-10-24 20:45:03 -0400] AskSteve: is it just because this specific type of failure is so early on that no handlers are loaded?
[2013-10-24 20:45:07 -0400] cwj: right
[2013-10-24 20:45:38 -0400] cwj: if chef-client cant get all the cookbooks in its run list, none of the cookbooks will get executed
[2013-10-24 20:45:51 -0400] cwj: therefore the handler wont be installed and activated
[2013-10-24 20:46:16 -0400] AskSteve: ok, adding the rest of the cookbooks
[2013-10-24 20:52:47 -0400] perlphil: I know that changed node attributes are saved back to the chef server. Is there a size limit to that information?
[2013-10-24 20:53:23 -0400] spheromak: perlphil, Im not sure if theres a hard limit. there are practical limits from a performance perspective
[2013-10-24 20:53:31 -0400] perlphil: Yeah
[2013-10-24 20:54:09 -0400] perlphil: I'd like to pass data back that will be collected by another system. And the ability to add and remove node information seems one hackish way of doing that via the secure channels chef has set up
[2013-10-24 20:54:13 -0400] perlphil: Is there a better way?
[2013-10-24 20:54:28 -0400] AskSteve: @cwj added the rest of the cookbooks and that exception creator no dice still
[2013-10-24 20:54:54 -0400] spheromak: perlphil can you send the data you want to that other system from your chef-run ?
[2013-10-24 20:55:05 -0400] AskSteve: @cwj https://gist.github.com/stevemcgrane/204c036ee0e81c236b43
[2013-10-24 20:55:12 -0400] spheromak: perlphil, depending on what the data is. you can store it to anything more suited to do so :)
[2013-10-24 20:55:44 -0400] perlphil: I've experimented with sending it out of band. And that works.
[2013-10-24 20:56:15 -0400] perlphil: Basically trying to implement a file-watching system that catches changes. sort of a poor-mans tripwire on some files. But I don't want to actually overwrite the files.
[2013-10-24 20:56:50 -0400] perlphil: I'm thinking of keeping checsums for the file as node data. It strikes me that stuffing a whole file there would be a very poor implementation
[2013-10-24 20:57:36 -0400] cwj: AskSteve: wheres the rest of your chef run? you should see a line indicating that the handler is registered
[2013-10-24 20:58:11 -0400] spheromak: perlphil, so you want to know if a file changed, but not actually change it on disk ?
[2013-10-24 20:58:55 -0400] perlphil: spheromak: yes. And also track that over time ... when a file has changed, I'd need to baseline what that change was so on the next run I'd see another change if it happened, not the same change again
[2013-10-24 20:58:56 -0400] spheromak: or you want to log the file to an external system, but not overwrite unless its changd ?
[2013-10-24 20:59:20 -0400] spheromak: perlphil, the report handlers can get you all that info on resources.
[2013-10-24 20:59:29 -0400] perlphil: I want to see and report changes in a file over time. I am assuming that I will need to log the file to an external system to identify what the change was.
[2013-10-24 20:59:44 -0400] spheromak: https://github.com/realityforge/chef-graphite_handler
[2013-10-24 20:59:48 -0400] spheromak: so
[2013-10-24 20:59:58 -0400] spheromak: yea i've done this with splunk and you could do it in logstash
[2013-10-24 21:00:06 -0400] AskSteve: @cwj what should the line say?  I'm not seeing anything related to "*reg*" or "*hand*" in output about adding a handler or using a handler
[2013-10-24 21:00:08 -0400] perlphil: Won't the report handler always return the difference between a template and an existing file on the system though? I'd have to change out the template on each change?
[2013-10-24 21:00:09 -0400] spheromak: when chef filre resource takes action it outputs the diff
[2013-10-24 21:00:12 -0400] spheromak: so you can log the dif
[2013-10-24 21:00:31 -0400] minx: Hi All
[2013-10-24 21:00:34 -0400] spheromak: the file resource in chef only acts when something changes.
[2013-10-24 21:00:49 -0400] spheromak: or you tell it to do so via a notification
[2013-10-24 21:00:49 -0400] minx: I get this error while trying to deploy tomcat cookbook on a node
[2013-10-24 21:00:50 -0400] minx: Error executing action `install` on resource 'package[tomcat6-admin-webapps]'
[2013-10-24 21:01:05 -0400] cwj: AskSteve: INFO: Processing chef_handler[HipChat::NotifyRoom] action enable (hipchat::handler line 42)
[2013-10-24 21:01:12 -0400] cwj: AskSteve: INFO: Enabling chef_handler[HipChat::NotifyRoom] as a exception handler
[2013-10-24 21:02:08 -0400] cwj: did you follow my instructions re node attributes that the handler recipe expects? when in doubt, read the source code
[2013-10-24 21:02:25 -0400] AskSteve: @cwj https://gist.github.com/stevemcgrane/3f2dda4a1237b4fb90cd
[2013-10-24 21:02:45 -0400] gchristensen: mattray: I may end up sending you some PRs. all my PXE-booting is done with a kickstart, not a preseed
[2013-10-24 21:03:01 -0400] mattray: gchristensen: SWEET
[2013-10-24 21:03:10 -0400] mattray: gchristensen: I assume KS means RHEL?
[2013-10-24 21:03:11 -0400] jperry: ohai!
[2013-10-24 21:03:23 -0400] jperry: anyone familiar with the ntp cookbook?
[2013-10-24 21:03:37 -0400] gchristensen: mattray: actually .... kickstart on ubuntu O.o
[2013-10-24 21:03:51 -0400] AskSteve: @cwj https://gist.github.com/stevemcgrane/fe3addc55754770d8a81
[2013-10-24 21:03:51 -0400] mattray: gchristensen: welp, it's a start
[2013-10-24 21:03:52 -0400] jperry: I want to set the timezone to 'America/New_York'
[2013-10-24 21:04:05 -0400] jperry: anyone know how to do that through the ntp cookbook, I don't see any attributes
[2013-10-24 21:04:05 -0400] gchristensen: mattray: it exists, I'm not sure how feature-rich it is, but: http://thornelabs.net/documentation/2013/09/05/create-vmware-fusion-pxe-boot-environment-and-use-kickstart-profiles-to-create-ubuntu-virtual-machines.html
[2013-10-24 21:04:18 -0400] mattray: gchristensen: looking forward to it. Sometime before too long I want to do RHEL
[2013-10-24 21:05:04 -0400] spheromak: mattray, i have ubu/rhel in that pxe menu stuff i pushed up
[2013-10-24 21:05:31 -0400] mattray: spheromak: oh yeah, I'll dig into that eventually
[2013-10-24 21:05:45 -0400] spheromak: https://github.com/spheromak/pxe-cookbook/tree/master/examples
[2013-10-24 21:06:13 -0400] spheromak: its meant to tie in with dhcp/dyndns
[2013-10-24 21:06:34 -0400] spheromak: I haven't pushed the dns cook cause its absolutely terrible code. :\
[2013-10-24 21:06:49 -0400] mattray: spheromak: I'm pretty happy with dnsmasq for my dns/dhcp/tftp
[2013-10-24 21:06:56 -0400] spheromak: yea
[2013-10-24 21:07:03 -0400] spheromak: cept can't run 2 servers for that
[2013-10-24 21:07:15 -0400] mattray: 2 servers?
[2013-10-24 21:07:18 -0400] spheromak: and if you're building infra.  you have to do some dumb stuff to run a "cluster"
[2013-10-24 21:07:21 -0400] spheromak: of dnsmasq
[2013-10-24 21:07:38 -0400] spheromak: with isc dhcpd/bind you can run a cluster of dhcpd's and dns servers to handle all of that.
[2013-10-24 21:07:42 -0400] mattray: gotcha
[2013-10-24 21:07:47 -0400] mattray: keepalived?
[2013-10-24 21:07:54 -0400] wdilly: guys I am having a weird problem I get the following error at the very end of every chef-client run no matter what recipe is used at the end of the run list: Encoding::UndefinedConversionError: "\x8B" from ASCII-8BIT to UTF-8
[2013-10-24 21:08:08 -0400] spheromak: mattray, have to sync the dnsmasq state
[2013-10-24 21:08:17 -0400] spheromak: so yea keepalived + rsync !!!
[2013-10-24 21:08:19 -0400] spheromak: wheee
[2013-10-24 21:08:25 -0400] spheromak: hoakey at best
[2013-10-24 21:08:28 -0400] mattray: spheromak: yeah, too many yaks to shave to get to that
[2013-10-24 21:08:49 -0400] spheromak: vs the protocol support in isc dhcpd. where you can handle different pools on different nodes with failover between the clusters.
[2013-10-24 21:09:19 -0400] spheromak: basically if you're gonna do anything serious with dhcp  dnsmasq shouldn't be the answer IMO.  This is why I boggle at the dnsmasq at the center of openstack.
[2013-10-24 21:09:31 -0400] spheromak: nice if your just playing around cause.. it JFW.
[2013-10-24 21:09:56 -0400] perlphil: spheromak: Thanks , BTW
[2013-10-24 21:10:29 -0400] perlphil: wdilly: If you're using the Mac text edit to edit your recipes, you're putting in UTF8 spaces
[2013-10-24 21:10:52 -0400] perlphil: drop into vi, use :set list, to look for control codes. Or use TextWranglers "zap gremlins" function
[2013-10-24 21:11:31 -0400] wdilly: perlphil, thanks, I do not use mac text edit but someone on the team may be doing so will check this
[2013-10-24 21:11:40 -0400] perlphil: Yeah
[2013-10-24 21:11:55 -0400] perlphil: I have a special place of hatred for text editors that insert UTF spaces.
[2013-10-24 21:14:22 -0400] derebos: hello
[2013-10-24 21:14:41 -0400] perlphil: Hello
[2013-10-24 21:14:48 -0400] derebos: how can i do this in chef : sudo service postgresql-9.2 initdb , when i want to restart the service i use action :restart
[2013-10-24 21:14:56 -0400] derebos: i must do this as a bash ?
[2013-10-24 21:15:01 -0400] derebos: or chef support this
[2013-10-24 21:17:18 -0400] theCzar: derebos: you'll probably want to do that as an Execute block
[2013-10-24 21:17:31 -0400] derebos: theCzar, how?
[2013-10-24 21:17:53 -0400] theCzar: execute "service postresql-9.2 initdb"
[2013-10-24 21:18:19 -0400] wdilly: perlphil, all of my spaces show as ^I (normal?)
[2013-10-24 21:18:47 -0400] theCzar: derebos: although you will likely want to add some not_if/only_if stuff or a notifies somewhere to ensure that it is idempotent
[2013-10-24 21:18:59 -0400] perlphil: wdilly: ^I is tab.. that's good
[2013-10-24 21:19:23 -0400] perlphil: ^M is CR..that's good to. You're looking for something else out of the ordinary
[2013-10-24 21:19:58 -0400] gchristensen: mattray: I'm torn between doing it right and getting my hardware provisioned :( by definition my pxe-boot server is a snowflake (only one) replicable with chef adds value, but if my kickstart file is versioned, negligable :(
[2013-10-24 21:20:05 -0400] perlphil: You're looking for \x8B.. but if the top of my head I don't remember what that is
[2013-10-24 21:20:47 -0400] mattray: gchristensen: my pxe-server is a snowflake that's been changed out many times
[2013-10-24 21:20:56 -0400] mattray: it's always my oldest, crappiest hardware :)
[2013-10-24 21:21:12 -0400] mattray: and the preseed is included in pxe_dust
[2013-10-24 21:21:28 -0400] perlphil: wdilly: It looks like other folks have had similar issues when transferring image files: https://github.com/rest-client/rest-client/pull/145
[2013-10-24 21:22:16 -0400] mattray: gchristensen: yeah, preseeds are black magic. How did it fail? LVM?
[2013-10-24 21:23:07 -0400] jperry: looks like I wanted the timezone chef cookbook
[2013-10-24 21:24:04 -0400] gchristensen: mattray: it can't find my hard drives? which may be because I'm using a full installer, and the cookbook is asking for a netboot
[2013-10-24 21:24:12 -0400] gchristensen: it uses a netboot, then boots to a full instwaller
[2013-10-24 21:24:21 -0400] wdilly: so perlphil my vim is set fileencoding=utf-8
[2013-10-24 21:24:30 -0400] wdilly: sounds like this is may be the problem?
[2013-10-24 21:24:34 -0400] perlphil: Yah
[2013-10-24 21:24:35 -0400] dgarstang: Anyone seen this with bringing up vagrant from berkshelf? /Users/dgarstang/.vagrant.d/gems/gems/celluloid-0.14.1/lib/celluloid/responses.rb:29:in `value': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (Ridley::Errors::ConnectionFailed)
[2013-10-24 21:24:44 -0400] perlphil: It detected the file as UTF8
[2013-10-24 21:24:46 -0400] mattray: gchristensen: maybe look at the examples from lab-repo, those are netboots
[2013-10-24 21:24:51 -0400] perlphil: Damn vim :)
[2013-10-24 21:25:48 -0400] gchristensen: mattray: I did :) I'll switch over to using more common hardware and see if the existing pxe boot works on that.
[2013-10-24 21:26:29 -0400] perlphil: wdilly: You can try using iconv to fix it: iconv -f utf-8 -t ascii -f infile.txt -o outfile.txt
[2013-10-24 21:26:59 -0400] bean__: dgarstang: I'd disable SSL validation in your berkshelf
[2013-10-24 21:28:23 -0400] dgarstang: bean__: Why does it need to talk to an upstream chef server (not vagrant) to run a vagrant box?
[2013-10-24 21:28:45 -0400] bean__: because it'll pull the cookbooks from your chef server?
[2013-10-24 21:28:57 -0400] bean__: i'd guess at least.
[2013-10-24 21:29:15 -0400] dgarstang: bean__: Were pulling from git tho
[2013-10-24 21:29:29 -0400] dgarstang: now it works. design flaw... :)
[2013-10-24 21:29:30 -0400] bean__: and thats whats in your Berksfile / Metadata.rb?
[2013-10-24 21:29:34 -0400] bean__: ha ok
[2013-10-24 21:29:37 -0400] dgarstang: bean__: Yep
[2013-10-24 21:41:34 -0400] ggolin_: hey spheromak got a minute?
[2013-10-24 21:41:45 -0400] spheromak: ggolin sure
[2013-10-24 21:42:05 -0400] ggolin_: im using sysctl-cookbook here, its generating a sysctl that my centos system does not like :P
[2013-10-24 21:42:24 -0400] spheromak: uh-oh
[2013-10-24 21:42:38 -0400] ggolin_: error: "Invalid argument" setting key "kernel.core_uses_pid"
[2013-10-24 21:42:43 -0400] spheromak: ggolin send me a gist
[2013-10-24 21:42:59 -0400] ggolin_: kernel.core_uses_pid="1"
[2013-10-24 21:43:00 -0400] ggolin_: sec
[2013-10-24 21:43:05 -0400] spheromak: uses pid /
[2013-10-24 21:43:06 -0400] spheromak: ?
[2013-10-24 21:43:30 -0400] heathsnow_: This seems silly, but how do I get the @new_resource.updated_by_last_action value from a resource I consume in my LWRP?
[2013-10-24 21:44:37 -0400] ggolin_: https://gist.github.com/anonymous/7145582
[2013-10-24 21:44:43 -0400] ggolin_: spheromak, there it is
[2013-10-24 21:45:59 -0400] ggolin_: spheromak, im wondering if its the "s
[2013-10-24 21:47:55 -0400] ggolin_: spheromak, yeah, im just recreating the original file
[2013-10-24 21:48:14 -0400] spheromak: ggolinthanks
[2013-10-24 21:48:17 -0400] spheromak: ill take a look
[2013-10-24 21:48:25 -0400] ggolin_: i appreciate it
[2013-10-24 21:49:43 -0400] heathsnow_: nvm...feels lame but I think I have to do something like updated |= resource "something" do something here end...then call new_resource.updated_by_last_action(updated.updated_by_last_action?)
[2013-10-24 21:50:34 -0400] ggolin_: spheromak, yep. removed the "s, settings get applied.. it could be the version of sysctl, this is an old system..
[2013-10-24 21:51:01 -0400] spheromak: ggolin what platform ?
[2013-10-24 21:51:09 -0400] spheromak: yea
[2013-10-24 21:51:17 -0400] ggolin_: CentOS release 5.8 (Final)
[2013-10-24 21:51:19 -0400] spheromak: I think this is a regression.  at one point it didn't support quotes
[2013-10-24 21:51:20 -0400] spheromak: yea
[2013-10-24 21:51:22 -0400] spheromak: 5.8
[2013-10-24 21:51:30 -0400] spheromak: I think i have to add in some fu to handle that
[2013-10-24 21:51:41 -0400] spheromak: if you unquote the values in sysctl.conf does it work ?
[2013-10-24 21:51:44 -0400] stonith: having a problem with chef-solo
[2013-10-24 21:52:00 -0400] stonith: I'm copying all the examples but it keeps bombing out on syntax
[2013-10-24 21:52:06 -0400] ggolin_: spheromak, yes. hold on, i just upgraded the package, let me see if this goes away.
[2013-10-24 21:52:49 -0400] minx: Anyone worked with tomcat cookbook?
[2013-10-24 21:53:01 -0400] spheromak: ggolin i think its one of those things where rhel worked one way.
[2013-10-24 21:53:37 -0400] ggolin_: spheromak, no, still broken with ktune.noarch 0:0.2-6.el5
[2013-10-24 21:55:48 -0400] spheromak: hrm
[2013-10-24 21:56:01 -0400] spheromak: so is it some kernel param that isn't supported on that kernel
[2013-10-24 21:56:02 -0400] spheromak: ?
[2013-10-24 21:56:05 -0400] spheromak: or is it anything
[2013-10-24 21:56:18 -0400] ggolin_: nono, i mean the "s still upset sysctl
[2013-10-24 21:57:04 -0400] ggolin_: its definitely the quotes
[2013-10-24 21:58:19 -0400] ggolin_: i dont know that this is a bug per se. i dont think so. i think maybe a blurb in the readme about EOLed centos version would be enough.
[2013-10-24 22:01:08 -0400] spheromak: ggolin yea so if you remove quotes it works
[2013-10-24 22:01:16 -0400] spheromak: i just need to detect platform
[2013-10-24 22:01:18 -0400] spheromak: and do the right thing
[2013-10-24 22:01:20 -0400] spheromak: not a problem
[2013-10-24 22:02:10 -0400] spheromak: ggolin might have some time tonight to fix it. did you pop an issue on github ?
[2013-10-24 22:03:23 -0400] ggolin_: spheromak, sorry i bothered you you fixed this a month ago, it seems
[2013-10-24 22:03:36 -0400] spheromak: oh
[2013-10-24 22:03:37 -0400] spheromak: shit
[2013-10-24 22:03:39 -0400] spheromak: sorry ;)
[2013-10-24 22:03:41 -0400] ggolin_: :-D
[2013-10-24 22:03:42 -0400] spheromak: busy busy!
[2013-10-24 22:04:01 -0400] ggolin_: i just forked and im looking at the last commit going "oh im an idiot, ok then"
[2013-10-24 22:04:04 -0400] spheromak: ggolin ok Ill get the fix in the provider
[2013-10-24 22:04:50 -0400] spheromak: ggolin yea  https://github.com/spheromak/sysctl-cookbook/commit/ce5be41b1017988ef805de7bcfadfab4ee9dcbdd
[2013-10-24 22:04:56 -0400] ggolin_: exactly
[2013-10-24 22:05:00 -0400] ggolin_: sorry ma n:)
[2013-10-24 22:05:07 -0400] spheromak: I had it flipped in my head
[2013-10-24 22:05:13 -0400] spheromak: i though i had added them in
[2013-10-24 22:05:21 -0400] spheromak: there still might be a bad interaction
[2013-10-24 22:05:26 -0400] spheromak: I need a better kitchen matrix
[2013-10-24 22:05:53 -0400] spheromak: cause im pretty sure theres subtle differences from  ubu/deb and rhel  depending on the version of the platfom and the verison of the tools
[2013-10-24 22:06:15 -0400] ggolin_: i wonder if ubu cares about the quotes at all
[2013-10-24 22:06:54 -0400] dgarstang: Anyone used the rabbitmq cookbook from opscode?
[2013-10-24 22:08:38 -0400] dgarstang: The rabbitmq cookbook depends on the erlang cookbook. It fails because I haven't defined node["erlang"]["install_method"]. I guess I gotta wrap erland in bc-erlang just to set a single value
[2013-10-24 22:16:49 -0400] chgravier: anyone received "test-kitchen-1.0.0.dev/lib/kitchen/config.rb:97:in `[]': can't convert Symbol into Integer (TypeError)" when using kitchen-test please ? Sounds like a kitchen-test bug, but I'm no confident enough in ruby to have a clue
[2013-10-24 22:30:58 -0400] jhulten: dgarstang: If you are wrapping the rabbitmq cookbook as bc-rabbitmq you can put it there. I personally don't think adding another cookbook for one attribute is useful.
[2013-10-24 22:34:58 -0400] dgarstang: jhulten: that's downright confusing though, putting a setting for erland in rabbitmq
[2013-10-24 22:35:50 -0400] dgarstang: So, chef is making my head spin. I've put the roles for a rabbitmq server in roles/rabbitmq_server, which contains include_recipe "base" and so on... that's fine. However, what goes in rabbitmq's default?
[2013-10-24 22:41:46 -0400] dgarstang: So, chef is making my head spin. I've put the roles for a rabbitmq server in roles/rabbitmq_server, which contains include_recipe "base" and so on... that's fine. However, what goes in rabbitmq's default?
[2013-10-24 22:49:30 -0400] dgarstang: chef is installing rabbitmq-server in a vagrant box, but it's not logging it at all. Why?
[2013-10-24 22:58:29 -0400] dgarstang: chef is installing rabbitmq-server in a vagrant box, but it's not logging it at all. Why?
[2013-10-24 22:59:30 -0400] troyready: I'm trying to integrate a new OS X server into our Chef infrastructure (it's 10.9, in case it ends up being relevant). What I'm stuck on right now is how to handle passwords for the user resource
[2013-10-24 23:00:19 -0400] troyready: Looking at the resource source, it looks like it'll directly write a password hash to the system if that's what I specify as the user's password
[2013-10-24 23:00:37 -0400] troyready: (which is how we handle it with Linux, with SHA512 passwords)
[2013-10-24 23:01:26 -0400] troyready: The OS X provider looks like it will be looking for a sha1 password though -- any suggestions on how to generate or retrieve a salted sha1 password to pass to the user resource for our OS X 10.9 machine?
[2013-10-24 23:03:28 -0400] GeoffC_: can anyone help me with some beginner questions, #learnchef is dead right now
[2013-10-24 23:04:25 -0400] troyready: I'd love to help GeoffC_, but I don't really have any experience with EC2, sorry :(
[2013-10-24 23:04:46 -0400] GeoffC_: what about vsphere?
[2013-10-24 23:05:17 -0400] troyready: I actually have a smidge of experience with that; would be glad to help if I can
[2013-10-24 23:06:09 -0400] GeoffC_: ok so I am interested in connecting my windows chef workstation to an ubuntu server I installed chef on that runs on our vsphere server to subsequently manage other vms (specifically nagios but otherwise general config stuff)
[2013-10-24 23:06:16 -0400] troyready: FWIW, to answer my own previous question: looks like the user provider has code it in to generate the SHA1 hash for OSX. I'll just adapt that into my own script to generate the hash first, then pass that to the user resource
[2013-10-24 23:07:01 -0400] troyready: GeoffC_, the ubuntu server is running the vsphere server in a VM?
[2013-10-24 23:07:26 -0400] GeoffC_: no sorry, vsphere is running on hosts, the ubuntu server is a vm within vsphere
[2013-10-24 23:07:33 -0400] GeoffC_: but I installed chef server on it
[2013-10-24 23:07:44 -0400] GeoffC_: thinking that was the correct thing to do to house the cookbooks, etc
[2013-10-24 23:07:52 -0400] troyready: ok, right, makes sense
[2013-10-24 23:08:05 -0400] GeoffC_: ok so now, I downloaded the gem knife-vsphere
[2013-10-24 23:08:13 -0400] GeoffC_: but I can't figure out where it is and how to add my credentials
[2013-10-24 23:08:13 -0400] troyready: Sounds similar to our setup
[2013-10-24 23:09:02 -0400] troyready: It functions as a plugin to knife, so if the gem was installed correctly into your chef installation, knife should now have some extra commands built into it
[2013-10-24 23:09:02 -0400] flagg0204: when using chef in aws, do cookbooks have access to user_data from the ec2 instance?
[2013-10-24 23:09:35 -0400] GeoffC_: ah so you are correct
[2013-10-24 23:09:37 -0400] GeoffC_: thanks
[2013-10-24 23:09:42 -0400] flagg0204: e.g. if i wanted to provide an attribute within user_data, the cookbook could read that data and tehn apply the attribute to a template
[2013-10-24 23:10:36 -0400] troyready: GeoffC_, my pleasure; let me know if you have any other questions with it.
[2013-10-24 23:10:38 -0400] GeoffC_: troyready there is supposed to be some knife.rb that gets my vsphere IP address and login information
[2013-10-24 23:10:46 -0400] GeoffC_: thats what I need to find first
[2013-10-24 23:11:58 -0400] troyready: Right. So that's something that knife uses all the time (i.e., if knife is working at all now then you almost certainly have one setup). For the knife-vsphere plugin, you just add some options to it to save yourself from having to pass them to the command every time you run it
[2013-10-24 23:12:45 -0400] GeoffC_: oh so I'm not looking for a specific knife.rb for vsphere, just the regular one in .chef?
[2013-10-24 23:12:51 -0400] troyready: Preciesly
[2013-10-24 23:12:54 -0400] GeoffC_: got it
[2013-10-24 23:12:59 -0400] troyready: precisely even
[2013-10-24 23:15:02 -0400] troyready: My extremely tiny contribution to the plugin was a patch to make it query you for a password if you don't specify one in your knife.rb
[2013-10-24 23:15:17 -0400] troyready: So you probably only need to specify knife[:vsphere_host] = "blah.domain", knife[:vsphere_user] = "user@domain", knife[:vsphere_dc] = "datacentername", & possibly knife[:vsphere_insecure] = true
[2013-10-24 23:15:43 -0400] troyready: on separate lines in your knife.rb to get it to work
[2013-10-24 23:18:49 -0400] GeoffC_: ya thats a good idea so I don't have to store it clear text
[2013-10-24 23:19:30 -0400] dgarstang: is there some trick to gettig an app to log to an lvm volume? I need to change /var/log/rabbit to be on an lvm vol
[2013-10-24 23:26:04 -0400] dgarstang: Can I create a dir in chef, with root perms and then later 'update' it to be owned by someone else?
[2013-10-24 23:28:02 -0400] flaccid: dgarstang: doesn't sound right, but you could if you put some kind of logic in or around the resource in your chef code
[2013-10-24 23:35:44 -0400] stormerider: gah. not chef specific, but how can i print the contents of an object in ruby without knowing the elements? does it have a module like perl's data::dumper?
[2013-10-24 23:42:03 -0400] cwj: have you tried #inspect?
[2013-10-24 23:42:09 -0400] cwj: foo.inspect
[2013-10-24 23:43:02 -0400] stormerider: yeah, that gave me the same thing.... <AWS::EC2::Instance id:i-2d9a1b76>
[2013-10-24 23:45:02 -0400] flaccid: stormerider: you'll probably get more from in there by using .to_yaml
[2013-10-24 23:46:38 -0400] stormerider: aha, thanks, flaccid
[2013-10-24 23:49:03 -0400] flaccid: np
