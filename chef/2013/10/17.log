[2013-10-17 00:18:24 -0400] Josh_: [newbie alert!] I'm installing a package using yum_package. I'm trying to create a link to the newly installed package. However the package installs to a directory with a version number. Is there a way to determine the name of the recently added directory or to determine the version number from the yum package?
[2013-10-17 00:19:52 -0400] Josh_: I've been searching the net for an hour now and I can't find any relevant info.
[2013-10-17 00:27:36 -0400] Skeletor1: Josh_:  you can set the version number in the package resource and then you have an expected result when its installed
[2013-10-17 00:28:08 -0400] Josh_: So as part of my recipe I need to specify a version number?
[2013-10-17 00:28:45 -0400] Josh_: If I don't specify the version number then I get the latest in the yum repository. Is there a way to figure out what that version is?
[2013-10-17 00:31:39 -0400] Skeletor1: Josh_:  Yes, you can specify the version in the resource. As for finding the version you have available it will be as easy as running 'yum info <package>'. One thing to consider is that when you start specifying version you run into a dependency of having the repo purging that RPM once it gets updated
[2013-10-17 00:32:36 -0400] Skeletor1: and then you your recipe breaks cause it cant find the version you want installed.
[2013-10-17 00:32:38 -0400] Josh_: I don't understand your 2nd point about purging.
[2013-10-17 00:32:50 -0400] Josh_: Oh, wait.
[2013-10-17 00:33:11 -0400] Josh_: If I specify a version, then as new versions come out my recipe will need to be updated for the newer versions.
[2013-10-17 00:33:18 -0400] Skeletor1: Correct
[2013-10-17 00:33:22 -0400] Josh_: Because the newer one displaced the older one.
[2013-10-17 00:33:44 -0400] Josh_: So can I use yum info from inside my recipe?
[2013-10-17 00:42:26 -0400] N00bChef: Hi all, I am having an ordering issue I don't fully understand or know how to fix. I have the following setup
[2013-10-17 00:42:42 -0400] N00bChef: recipe A: yum install ruby dev tools
[2013-10-17 00:42:58 -0400] N00bChef: recipe B: chef_gem a package that has native components and thus requires ruby dev tools
[2013-10-17 00:43:18 -0400] N00bChef: role A: recipe[A], recipe[B]
[2013-10-17 00:43:37 -0400] N00bChef: when I run this setup, I get a compilation error in B complaining that the dev tools are not installed
[2013-10-17 00:44:02 -0400] N00bChef: AFAICT, this is because chef_gem is running at compilation time and the recipe A hasn't been run yet
[2013-10-17 00:44:45 -0400] N00bChef: NOTE: Recipe B does require this gem during its execution, hence the chef_gem usage
[2013-10-17 00:45:23 -0400] N00bChef: Any ideas or am I SOL?
[2013-10-17 00:49:43 -0400] N00bChef: @Skeletor1, this is what I am trying given our previous conversation, would welcome any suggestions
[2013-10-17 00:50:02 -0400] gchristensen: N00bChef: chef_gem do ... action :nothing end ... package "dev-tools" do action :install notifies :install, "chef_gem[foogem]" end
[2013-10-17 00:50:13 -0400] gchristensen: N00bChef: ^ that might work
[2013-10-17 00:54:06 -0400] N00bChef: @gchristensen: can you quickly explain of what you are trying to achieve so I can understand?
[2013-10-17 00:55:26 -0400] N00bChef: @gchristensen: also, just to be clear, the first chef_gem call is still targeted at foogem right?
[2013-10-17 00:57:50 -0400] Skeletor1: N00bChef: what gchristensen did is a notification that if dev-tools is installed successfully notify chef_gem "foogem" and install it.
[2013-10-17 00:58:54 -0400] N00bChef: I see, got it
[2013-10-17 00:59:22 -0400] N00bChef: Let me give it a shot
[2013-10-17 01:00:32 -0400] sheldor: any?one there
[2013-10-17 01:05:32 -0400] sheldor: I'm having difficulty creating a chef repo for a rails app from a git repo
[2013-10-17 01:05:37 -0400] sheldor: anyone there that can help?
[2013-10-17 01:07:30 -0400] estahn: any idea how to circumvent that opsworks has no roles? so how can role specific attribute be managed?
[2013-10-17 01:07:42 -0400] Josh_: @Skeletor1 Thanks for the tip. I got the version number like this...
[2013-10-17 01:08:18 -0400] Josh_: installed_version = `yum info pkg-name | grep "Version" | cut -d ":" -f 2`.strip
[2013-10-17 01:20:28 -0400] sheldor: All - I'm having trouble deploying a rails app inside a git repo via chef .... anyone out there that can help?
[2013-10-17 01:28:14 -0400] sgronblom: http://reiddraper.com/first-chef-recipe/ Wouldn't this recipe run make & make install on each chef-client run?
[2013-10-17 01:28:35 -0400] sgronblom: Trying to figure out how to prevent unnecessary work in a recipe?
[2013-10-17 01:30:57 -0400] sgronblom: And ugh, this project has such a bad name
[2013-10-17 01:31:21 -0400] sgronblom: I google for "chef recipes prevent unnecessary work" and 7/10 hits are cooking related...
[2013-10-17 01:32:04 -0400] sgronblom: Hooray theres "Chef's Chocolate Salty Balls" on page 2
[2013-10-17 01:33:55 -0400] shimo: sgronblom: no it would not run them every time
[2013-10-17 01:34:12 -0400] shimo: it says 'creates "/usr/local/bin/redis-server"'
[2013-10-17 01:34:37 -0400] shimo: which basically means "don't run if this file exists"
[2013-10-17 01:34:49 -0400] sgronblom: I see, thanks :)
[2013-10-17 01:34:53 -0400] shimo: so assuming make install creates the file you're golden
[2013-10-17 01:36:26 -0400] shimo: there's a problem with that solution though
[2013-10-17 01:37:13 -0400] shimo: you'll have a bad time if you ever want to upgrade redis
[2013-10-17 01:37:53 -0400] shimo: because it will still be seeing the same file in the same location and will not see a need to recompile anything
[2013-10-17 01:38:02 -0400] sgronblom: Yeah I was wondering about that too
[2013-10-17 01:38:35 -0400] shimo: personally i either use flag files or symlinks
[2013-10-17 01:39:07 -0400] shimo: for example you could make it install redis to /opt/local/redis-2.6.18
[2013-10-17 01:39:29 -0400] shimo: and then symlink it where you like
[2013-10-17 01:39:40 -0400] shimo: then you could use the 'creates' thing again
[2013-10-17 01:39:44 -0400] shimo: HOWEVER
[2013-10-17 01:39:49 -0400] shimo: there's still a problem
[2013-10-17 01:40:07 -0400] shimo: if you want to install the same version, but specify different configuration flags, you're screwed again
[2013-10-17 01:41:30 -0400] shimo: my current solution is to create a file to chef's cache path (along with the .tar etc) where i put the configuration flags
[2013-10-17 01:42:07 -0400] shimo: first i construct the configure line and store it to the file
[2013-10-17 01:42:31 -0400] shimo: and using :notifies let the compile task know if the contents change
[2013-10-17 01:43:05 -0400] shimo: i would be interested in hearing what other people do, though.
[2013-10-17 01:46:38 -0400] sgronblom: It's a bit puzzling if this case cannot be handled without some manual trickery
[2013-10-17 01:47:50 -0400] shimo: well. one simple solution is to spawn a new instance and nuke the old one when you want to upgrade
[2013-10-17 01:48:17 -0400] shimo: which is pretty good if you ask me. however it's not always possible..
[2013-10-17 01:49:01 -0400] sgronblom: That would simplify things quite a bit
[2013-10-17 01:57:25 -0400] sgronblom: Maybe should create a new resource for the tarball installation case. Compile with frecord-gcc-switches, then define a command to run to get the current version.
[2013-10-17 02:58:35 -0400] jhayden: Question: Can a variable be set inside a ruby block and be used immediately after the ruby_block closes?
[2013-10-17 02:59:06 -0400] jhayden: ie: I do a curl statement inside the block to see if a file exists
[2013-10-17 02:59:23 -0400] jhayden: if 200 (yes) do something
[2013-10-17 02:59:26 -0400] jhayden: else
[2013-10-17 02:59:29 -0400] afirth: http://stackoverflow.com/questions/11685965/block-scope-in-ruby
[2013-10-17 02:59:32 -0400] jhayden: do something else
[2013-10-17 03:03:34 -0400] jhayden: Were you waiting for me to ask that question? ;-)
[2013-10-17 03:04:06 -0400] afirth: no, i just figured the key word you were leaving out of your google search was "scope"
[2013-10-17 03:04:31 -0400] afirth: HTH
[2013-10-17 03:08:49 -0400] jhayden: I'm trying to figure out to determine if a remote file exists
[2013-10-17 03:08:56 -0400] jhayden: do one thing or the other
[2013-10-17 03:10:47 -0400] afirth: perhaps rescue? http://docs.opscode.com/essentials_cookbook_definitions.html under Many Recipes, One Definition
[2013-10-17 03:11:24 -0400] afirth: not quite your use case, but same principle
[2013-10-17 04:04:18 -0400] oofoof: oh tiered deployment model.  you're so much fun
[2013-10-17 04:05:31 -0400] estahn: if something like this is specified in a recipe "notifies :create, "template[solr.xml]"
[2013-10-17 04:05:51 -0400] estahn: can i change the solr.xml from another recipe? can i somehow hook into that notification?
[2013-10-17 04:08:08 -0400] segv: any of you guys know of a good vim plugin to hightlight def/end ruby syntax?
[2013-10-17 04:34:35 -0400] sgronblom: segv: I think vim should have decent highlighting for ruby built in already
[2013-10-17 04:34:49 -0400] segv: yeah syntax highlighting is fine
[2013-10-17 04:35:04 -0400] segv: but I am talking put cursor in vim over the "def" portion and it shows you where its corresponding "end" is
[2013-10-17 04:35:29 -0400] segv: Just like highlighting [ and you get the corresponding ] highlighted with matchparen
[2013-10-17 04:35:30 -0400] estahn: found my answer
[2013-10-17 04:35:31 -0400] estahn: http://stackoverflow.com/questions/15933157/replacing-a-template-in-a-wrapper-cookbook
[2013-10-17 04:37:59 -0400] sgronblom: segv: oh i see
[2013-10-17 04:38:15 -0400] segv: sgronblom: yeah, I figured someone else has done this before
[2013-10-17 04:38:30 -0400] sgronblom: segv: Can you use % to jump to the matching def or end?
[2013-10-17 04:38:33 -0400] segv: the plugin "matchit" when you hit % (or shift+5) matches the end tag
[2013-10-17 04:39:13 -0400] segv: but the visual helps me a lot cause sometimes you can miss a "do" and an end tag won't really 'fix' it without a visual error you know?
[2013-10-17 04:39:47 -0400] sgronblom: but if you reindent the section you will usually see where something is missing
[2013-10-17 04:39:57 -0400] segv: true
[2013-10-17 04:40:18 -0400] segv: I guess it's just habit of using that for other languages
[2013-10-17 04:42:52 -0400] segv: sgronblom: you would think it would be possible since "matchit" or % knows the start and end tag
[2013-10-17 04:42:57 -0400] segv: but I digress, guess I'll just deal with it
[2013-10-17 04:45:46 -0400] sgronblom: segv: yeah its possible i have a similar plugin for matching html tags
[2013-10-17 04:45:58 -0400] segv: sgronblom: yeah i found Matchtagalways
[2013-10-17 04:46:12 -0400] segv: might be able to convert it over to ruby and create a plugin for the rest of us to use
[2013-10-17 04:46:13 -0400] segv: :D
[2013-10-17 04:46:19 -0400] segv: or add it to vim-chef
[2013-10-17 04:46:50 -0400] sgronblom: Maybe Matchtagalways is modular enough that you would just define a different set of open/close tags based on the vim filetype
[2013-10-17 04:46:54 -0400] arussel: anyone using artifact_deploy with cloud be ? I'm having a hard time having anything else than 404
[2013-10-17 04:47:32 -0400] sgronblom: Anyway, if you can do Ruby you can do Python too
[2013-10-17 04:47:51 -0400] segv: sgronblom: yeah possibly
[2013-10-17 04:47:56 -0400] segv: Lurv me some python <3 haha
[2013-10-17 04:50:18 -0400] sgronblom: Hey, anyone know where the source code for the cassandra cookbook on opscode community is stored?
[2013-10-17 07:13:55 -0400] Garo_: Has people here used Ironfan to orchestrate clusters with Chef?
[2013-10-17 07:15:10 -0400] sgronblom: How are you supposed to install knife plugins?
[2013-10-17 07:42:27 -0400] [1]sam: Hello
[2013-10-17 07:42:44 -0400] Garo_: hi
[2013-10-17 07:42:54 -0400] [1]sam: I was wondering if there is a way to use knife commands in cookbooks and how to do so
[2013-10-17 07:44:26 -0400] [1]sam: I have the command knife vsphere vm clone --bootstrap --template 'TEMPLATE' NEWSERVERNAME
[2013-10-17 08:14:20 -0400] danny: hi all, is there any remedy for the chef-client running in daemon mode spawning loads of children when there is network latency or something to the master chef server?  I have some nodes in remote datacenters that are spawning tens of chef-clients.  None of the recipes / cookbooks are bombing out and the only thing I can think of is network latency to the master node.
[2013-10-17 08:53:24 -0400] mediaarte: hello
[2013-10-17 09:05:41 -0400] bcave: good morning all.
[2013-10-17 09:06:32 -0400] Cope: moin
[2013-10-17 09:07:10 -0400] Heis__: hey
[2013-10-17 09:07:50 -0400] bcave: how are you all doing?
[2013-10-17 09:08:12 -0400] dmdeklerk: ohai chefs
[2013-10-17 09:08:20 -0400] bcave: lol dmdeklerk
[2013-10-17 09:08:55 -0400] bcave: i have a question about data bags
[2013-10-17 09:09:12 -0400] bcave: I am using data bags that have been purely configured by knife, and don't have any file-based persistence in my local chef workspace.
[2013-10-17 09:09:36 -0400] bcave: I'd like to track changes in my (vcs enabled) workspace, but don't want to store clear-text values. Is there a way to store local encryted data bags?
[2013-10-17 09:09:43 -0400] bcave: Can't figure out how to by referencing http://docs.opscode.com/chef/essentials_data_bags.html
[2013-10-17 09:13:39 -0400] ktsunoda: Hello. I have a quick question. I've created a provider in my cookbook, and I'm trying to call it from within the same cookbook's recipe. For some reason tho, when I try to use the provider (by using the name of the cookbook), it's unable to tell that it's a provider. I'm wondering what I'm missing. I've created a provider before that I've been able to call from other cookbook's recipe, but I can't call from within the same cookbook for some r
[2013-10-17 09:19:31 -0400] ktsunoda: I'm wondering if it matters that the one that I can't get it to work has a hyphen in the name.
[2013-10-17 10:03:52 -0400] sgronblom: I'm getting the error "You must supply a name when declaring a default resource" on a line that contains a call to File.join
[2013-10-17 10:04:04 -0400] sgronblom: Could this be some sort of incorrect exception catching?/
[2013-10-17 10:05:01 -0400] workmad3: sgronblom: try ::File.join
[2013-10-17 10:09:00 -0400] sgronblom: workmad3: Same error
[2013-10-17 10:11:15 -0400] workmad3: sgronblom: hmm, any chance you could put the offending code online @ gist.github.com?
[2013-10-17 10:11:32 -0400] workmad3: (more than just the one line please :) more context is needed)
[2013-10-17 11:19:18 -0400] ermajn: my chef-solo won't read attribute in recipe, while it is correctly set in attribute file (default.rb). I have it defined like this: default['mycookbook']['git']['repo'] = "git://github.com/user/repo.git"
[2013-10-17 11:19:58 -0400] ermajn: and I'm trying to use it like this:    revision "#{node['mycookbook']['git']['repo']}"
[2013-10-17 11:20:12 -0400] ermajn: I'm getting: undefined method `[]' for nil:NilClass
[2013-10-17 11:20:16 -0400] ermajn: what am I doing wrong..
[2013-10-17 11:25:39 -0400] juozas: are you reading in the same cookbook?
[2013-10-17 11:26:28 -0400] ermajn: i'm trying to access from mycookbook's recipe, attribute that is in mycookbook attribute file
[2013-10-17 11:29:54 -0400] juozas: maybe try revision node['mycookbook']['git']['repo'] just in case. this really should just work. try one level attribute also like default['mycookbook_git_repo']. sorry can't imagine why it wouldn't work.
[2013-10-17 11:30:42 -0400] ermajn: juozas: already tried `revision node['mycookbook']['git']['repo']`
[2013-10-17 12:18:46 -0400] mveitas: I am having some troubles with encrypted data bags and vagrant:  Error decrypting data bag value: 'bad decrypt'
[2013-10-17 12:19:18 -0400] mveitas: I have verified that the secret key is as expected on the vagrant vm
[2013-10-17 12:21:43 -0400] scarolan: mveitas: how did you put the key there?  Sometimes copypasta can be troublesome...
[2013-10-17 12:23:37 -0400] mveitas: scarolan: I ended up using knife-solo_data_bag plugin to be able to create my encrypted data bag, and cut and paste the contents of the data bag using vim
[2013-10-17 12:24:45 -0400] scarolan: mveitas: In your recipe how are you trying to fetch the data
[2013-10-17 12:25:35 -0400] mveitas: scarolan: I am using the certificate cookbook. https://github.com/atomic-penguin/cookbook-certificate
[2013-10-17 12:26:29 -0400] mveitas: but I did put in this bit of code to help troubleshoot it
[2013-10-17 12:26:30 -0400] mveitas: http://pastebin.com/5m6sTX3s
[2013-10-17 12:28:08 -0400] scarolan: mveitas: by default, this: Chef::EncryptedDataBagItem.load, looks in /etc/chef/encrypted_data_bag_secret.  If you 'vagrant ssh' and look there, is the secret key there?
[2013-10-17 12:28:35 -0400] teukka: scarolan: vagrant overrides it with it's own config
[2013-10-17 12:28:53 -0400] mveitas: no, it's in /tmp/encrypted_data_bag_secret
[2013-10-17 12:29:06 -0400] scarolan: scarolan: my bad...so does that file match your secret key that you used to encrypt the data?
[2013-10-17 12:29:25 -0400] mveitas: puts ssl_secret matches exactly to what I used to encrypt the data
[2013-10-17 12:30:02 -0400] mveitas: and the contents of that file are exactly the same too
[2013-10-17 12:30:49 -0400] mveitas: I used EDITOR=vi knife solo data bag create certificates mydomain -s encrypted_data_bag_secret --data-bag-path data_bags  to generate the encrypted data bag
[2013-10-17 12:33:25 -0400] mveitas: executing  puts Chef::Config['encrypted_data_bag_secret']   prints out /tmp/encrypted_data_bag_secret
[2013-10-17 12:33:31 -0400] teukka: mveitas: note that chef 10 can't read data bags encrypted in chef 11 format. not sure what knife-solo_data_bag does
[2013-10-17 12:34:07 -0400] teukka: mveitas: also there seems to be https://github.com/thbishop/knife-solo_data_bag/issues/6
[2013-10-17 12:35:34 -0400] mveitas: <smacks forehead>, I can't believe I missed that issue, but I was also pissed b/c the Red Sox pissed all over themselves last night!
[2013-10-17 12:37:07 -0400] scarolan: mveitas: Oh, you're on Chef 10...yea, try to upgrade if you can!
[2013-10-17 12:37:28 -0400] mveitas: I am using Chef 11.6
[2013-10-17 12:39:48 -0400] mveitas: https://github.com/thbishop/knife-solo_data_bag/blob/master/lib/chef/knife/solo_data_bag_create.rb
[2013-10-17 12:41:54 -0400] mveitas: it's got to be doing something strange during the encryption that is not compatible with 11
[2013-10-17 12:58:32 -0400] mveitas: is it normal to have \n in the encrypted data bag json?
[2013-10-17 13:08:12 -0400] tcate: msg NickServ identify wittmansampler
[2013-10-17 13:08:21 -0400] tcate: crap
[2013-10-17 13:16:38 -0400] mattjalexander: does chef have builtin ways to handle tarballs, or do i need to do my own remote_file and exec "tar -xf" ?
[2013-10-17 13:23:59 -0400] droy: hi all, is the best way to install Oracle Java with Chef to use a private HTTP repository for the actual tgz?
[2013-10-17 13:27:49 -0400] mveitas: droy: you could use the java cookbook and override the node['java']['jdk']['7'][arch]['url'], node['java']['jdk']['7'][arch]['checksum'] attributes
[2013-10-17 13:28:39 -0400] droy: mveitas: thanks, i'm having a hard time provisioning a test vagrant vm with java.  it fails with an error i've not seen before
[2013-10-17 13:28:49 -0400] droy: mveitas: I'm guessing it's the license part at oracle
[2013-10-17 13:29:08 -0400] mveitas: droy: the license part is normally to download it though
[2013-10-17 13:29:14 -0400] mveitas: droy: can you pastebin the error
[2013-10-17 13:30:19 -0400] droy: mveitas: http://pastebin.com/BQj6HyNj
[2013-10-17 13:31:44 -0400] s2r2: droy: old chef version?
[2013-10-17 13:31:49 -0400] s2r2: converge_by is why_run stuff
[2013-10-17 13:32:38 -0400] mtpereira: mattjalexander: I've found 2 cookbooks for that: https://github.com/bryanwb/chef-ark and https://github.com/cramerdev/tar-cookbook
[2013-10-17 13:33:05 -0400] tmichael: @mattjalexander ark is great.  recommend it
[2013-10-17 13:33:15 -0400] droy: mveitas: hmm, i'll check
[2013-10-17 13:39:35 -0400] droy: mveitas: updated to 11.6.2, now getting other errors :)  fun day ahead for me!
[2013-10-17 13:40:18 -0400] droy: mveitas: chef solo is running fine for simple cookbooks, so it's something else now.  thanks
[2013-10-17 13:40:37 -0400] mveitas: droy: happy cooking!
[2013-10-17 13:41:50 -0400] droy: mveitas: i'm evaluating OpsWorks - it's a different way of using Chef, pared down to just cookbooks really
[2013-10-17 13:41:53 -0400] droy: mveitas: thanks
[2013-10-17 13:42:20 -0400] laurent\: nico: /win 17
[2013-10-17 13:42:27 -0400] laurent\: oops :)
[2013-10-17 13:42:34 -0400] nico: laurent\: ok
[2013-10-17 13:42:45 -0400] nico: laurent\: what's up ?
[2013-10-17 13:43:11 -0400] laurent\: nico: playing with logstash/statsd but still using chef10 :)
[2013-10-17 13:43:21 -0400] nico: he
[2013-10-17 13:43:34 -0400] nico: even lennys are running 11.6 here
[2013-10-17 13:43:58 -0400] laurent\: oh do you also have some lennys still running ? :)
[2013-10-17 13:45:17 -0400] laurent\: btw, do you package chef by yourself or do you the omnibus build ?
[2013-10-17 13:46:23 -0400] laurent\: with chef 0.{8,9,10} i was gem installing it everywhere, i don't want to do that anymore :)
[2013-10-17 13:46:48 -0400] EricL: Is there a way to make Chef show you the output of a template if it were run on a specific node?
[2013-10-17 13:48:01 -0400] nico: laurent\: 2, meant to die soon
[2013-10-17 13:48:21 -0400] nico: laurent\: omnibus repackaged
[2013-10-17 13:48:59 -0400] laurent\: nico: ok
[2013-10-17 13:51:49 -0400] nico: laurent\: https://gist.github.com/baloo/4bfd477360ab99b42cee
[2013-10-17 13:53:12 -0400] laurent\: ok, i'm not too keen on using omnibus packages
[2013-10-17 13:53:29 -0400] bean__: why?
[2013-10-17 13:55:03 -0400] JeanMertz: Is there any convention to print a specific message at the end of a Chef run?
[2013-10-17 13:55:26 -0400] bean__: JeanMertz: sure, I'd probably use a handler.
[2013-10-17 13:55:43 -0400] laurent\: bean:  i don't like the idea of the huge blob of libraries and binaries that I would need to install on every servers
[2013-10-17 13:55:45 -0400] bean__: JeanMertz: http://docs.opscode.com/essentials_handlers.html
[2013-10-17 13:56:06 -0400] JeanMertz: bean__ thank you, looks perfect for this
[2013-10-17 13:57:21 -0400] laurent\: nico: ok thanks for the link
[2013-10-17 13:58:20 -0400] nico: laurent\: you're welcome, but thank superbaloo for writing the makefile
[2013-10-17 13:58:44 -0400] laurent\: nico: 1 sarge, 2 etch, 12 lenny :-(
[2013-10-17 13:59:13 -0400] nico: welcome to the past
[2013-10-17 14:01:03 -0400] bean__: fwiw, laurent\, the omnibus is less than 100mb
[2013-10-17 14:01:21 -0400] fak3r: laurent\: apt-get update; apt-get upgrade; apt-get dist-upgrade; reboot :)
[2013-10-17 14:03:26 -0400] laurent\: waste of time :) for that kind of server i'll bootstrap some new wheezy servers
[2013-10-17 14:04:03 -0400] laurent\: hmm by the time i do it jessie might be the stable release :)
[2013-10-17 14:07:40 -0400] JeanMertz: bean__: about handlers, can you access the node in a handler? (ie. read out a file on the filesystem)?
[2013-10-17 14:10:13 -0400] bean__: JeanMertz: I'd imagine so :)
[2013-10-17 14:10:37 -0400] mveitas: I was hoping to get some more help regarding an issue I am having with vagrant and encrypted data bags. I am using knife-solo_data_bag plugin
[2013-10-17 14:11:44 -0400] Cope: what happened next?!
[2013-10-17 14:12:07 -0400] superbaloo: laurent\: please see https://github.com/baloo/chef-omnibus which is the same (almost)
[2013-10-17 14:12:26 -0400] superbaloo: but it will be easier to make bugfixes there :)
[2013-10-17 14:12:41 -0400] mveitas: I keep getting an Error decrypting data bag value: 'bad decrypt'
[2013-10-17 14:13:41 -0400] laurent\: superbaloo: je garde sous la main, merci :)
[2013-10-17 14:13:43 -0400] laurent\: oops :)
[2013-10-17 14:14:04 -0400] superbaloo: :)
[2013-10-17 14:35:04 -0400] bcave: white spaces in your key
[2013-10-17 14:35:43 -0400] EricL: Is there a way to make Chef show you the output of a template if it were run on a specific node?
[2013-10-17 14:36:33 -0400] Cope: EricL: why do you want to do that?
[2013-10-17 14:37:00 -0400] Cope: not being a troll... just if you explain what you're trying to achieve we may be able to help you with solutions you hadn't thought of
[2013-10-17 14:37:01 -0400] EricL: To make sure all the variables that it outputs for that node is correct.
[2013-10-17 14:37:18 -0400] Cope: right - so chefspec is perfect for this
[2013-10-17 14:37:34 -0400] EricL: The template file has a lot of stuff in it that includes searche and attributes, etc and I want to make sure I did it right before I deploy and totally screw myself.
[2013-10-17 14:38:16 -0400] Cope: http://acrmp.github.io/chefspec/
[2013-10-17 14:38:28 -0400] jmartin: EricL: as Cope mentioned...testing of any kind, chefspec/test-kitchen/whatever
[2013-10-17 14:39:01 -0400] EricL: I don't really want to "test" this.  I just want to see the output of the template when run in the context of a node.
[2013-10-17 14:39:12 -0400] jmartin: that sounds like a test to me
[2013-10-17 14:39:14 -0400] Cope: the advantage of chefspec is it doesn't really converge the node
[2013-10-17 14:39:19 -0400] Cope: so it's very fast
[2013-10-17 14:39:28 -0400] Cope: which is pretty much what you are describing
[2013-10-17 14:39:49 -0400] EricL: jmartin: It is a test, but not in a "spec" sense.
[2013-10-17 14:39:57 -0400] mondo: So say I have 100+ nodes, and I need to know when a chef-client run fails.  What's everyone using for notification of failiures?
[2013-10-17 14:40:42 -0400] EricL: mondo: I wrote a Chef handler that pushes a notification of all failures to Nagios as a passive check and additoinally writes all failures to our company Campfire.
[2013-10-17 14:40:53 -0400] EricL: mondo: And I have 180 nodes.
[2013-10-17 14:41:08 -0400] Cope: EricL: the recommended way to achieve what you desribe is to write a test using chefspec; there may be other approaches that others have tried, but that's what I recommend you do.
[2013-10-17 14:41:59 -0400] EricL: Cope: I'm reading through that doc now.  I am trying to find the quickest path here to view this thing so I can just get it deployed.
[2013-10-17 14:42:34 -0400] cwj: mondo: if your organization already uses a service for collecting exceptions, e.g. airbrake or sentry, you can probably find a chef exception handler which will report exceptions to that service
[2013-10-17 14:42:46 -0400] Cope: EricL: roger that
[2013-10-17 14:42:47 -0400] mondo: I'm surprised that basic email notification isn't just built into Chef, but I guess everyone's needs are different.
[2013-10-17 14:42:54 -0400] EricL: mondo: The handler also sends all exceptions to datadog.
[2013-10-17 14:43:05 -0400] mondo: cwj: we're in the dark ages :)
[2013-10-17 14:43:06 -0400] cwj: http://docs.opscode.com/essentials_handlers.html has a list that might help you, including a simple email handler
[2013-10-17 14:43:08 -0400] EricL: mondo: Email is dangerous because it's easy to get flooded.
[2013-10-17 14:43:31 -0400] EricL: mondo: If Github goes down (which it does often), we get literally thousands of notifications.
[2013-10-17 14:44:04 -0400] EricL: So we use the passive check to Nagois and let Nagios handle the notifications for us.
[2013-10-17 14:44:11 -0400] mondo: I guess splunk is an option for us and then we can use splunk to manage notification
[2013-10-17 14:44:44 -0400] EricL: mondo: I highly recommend Datadog if you have over 100 nodes.  It's a fantastic service.
[2013-10-17 14:45:04 -0400] mondo: EricL: thanks, I'll check it out.
[2013-10-17 14:45:31 -0400] thom: yeah, we use splunk to notify on failed chef runs
[2013-10-17 14:45:32 -0400] thom: works pretty well
[2013-10-17 14:45:49 -0400] EricL: Cope: It doesn't mention how this works with templates.
[2013-10-17 14:46:05 -0400] Cope: do you also go to expensive cocktail bars with a company card and yell: the drinks are on us!!
[2013-10-17 14:46:10 -0400] Heis___: by the way, does anyone knows splunk alternatives (open source ones if possible)?
[2013-10-17 14:46:54 -0400] mondo: them: are you monitoring the chef client log with splunk or do you use a chef handler to actively push to splunk?
[2013-10-17 14:46:54 -0400] jmartin: Heis___: while maybe not a full alternative, logstash is quite nice
[2013-10-17 14:46:54 -0400] EricL: Heis___: Logsumo, logly, logstash (open source)
[2013-10-17 14:47:00 -0400] Heis___: ive already heard about logstash, looks promising
[2013-10-17 14:47:15 -0400] Heis___: thanks guys, i will look at the ones you seggested
[2013-10-17 14:48:19 -0400] cwj: +1 for logstash
[2013-10-17 14:48:28 -0400] gleam: +2
[2013-10-17 14:48:40 -0400] gleam: the new stuff in 1.2 is nice, also
[2013-10-17 14:48:42 -0400] gleam: conditionals and whatnot
[2013-10-17 14:49:00 -0400] gleam: and kibana 3 keeps improving rapidly
[2013-10-17 14:54:04 -0400] Cope: EricL: there's more (and more up to date) stuff here: https://github.com/acrmp/chefspec
[2013-10-17 14:58:24 -0400] EricL: This seems like an awful lot of work for what I am looking for.  Especially since I have to stub out all the searches and attributes and returns.
[2013-10-17 14:59:18 -0400] EricL: It doesn't use the real search either (which is primarily what I need to test).
[2013-10-17 15:00:54 -0400] Cope: you said you wanted to test the template
[2013-10-17 15:01:03 -0400] Cope: so whether it uses real search is immaterial
[2013-10-17 15:01:32 -0400] Cope: if you're saying you aren't sure you're making valid search queries, that's a different thing to test, I grant
[2013-10-17 15:02:08 -0400] mveitas: does anyone have encrypted databags working with Vagrant?
[2013-10-17 15:03:39 -0400] Cope: mveitas: market research? if you have a question, ask :) You might have missed the reply: you may have white space in your keys somewhere
[2013-10-17 15:06:21 -0400] mveitas: cope:  http://pastebin.com/FT4cQvkX   This is the json I have for the data bag
[2013-10-17 15:09:06 -0400] Cope: mveitas: i'd start with something really dumb and simple
[2013-10-17 15:09:11 -0400] Cope: see if you can get taht working
[2013-10-17 15:09:14 -0400] Cope: then work up
[2013-10-17 15:09:30 -0400] Cope: every time I've had issues liek you describe it's been white space or new line issues
[2013-10-17 15:09:44 -0400] EricL: Cope: It's more along the lines of I want to make sure all my queries are returning the right things.  And that each node has all the proper attributes to fill out the template in the way I expect.
[2013-10-17 15:09:52 -0400] Cope: so start with something super-dumb like a single string
[2013-10-17 15:10:25 -0400] EricL: Cope: So stubbing out the template file is rebuilding the entire solr instance of all nodes in order to test this.
[2013-10-17 15:11:05 -0400] Cope: EricL: well at some stage you need to decide what you're actually testing
[2013-10-17 15:11:07 -0400] jmartin: EricL: if you need to be 100% sure, you need to replicate your production env, or you just wont know
[2013-10-17 15:11:07 -0400] EricL: I guess it's not possible to do what I want to do without hacking up a cookbook and deploying the template file to /tmp/
[2013-10-17 15:11:13 -0400] Cope: you can get fast search results using chef-zero and test kitchen, for example
[2013-10-17 15:11:39 -0400] Cope: but if yu just want to test the logic of your recipes and template, chefspec is the way to go
[2013-10-17 15:11:49 -0400] Cope: otherwise you need to really converge your node and look at the result
[2013-10-17 15:12:02 -0400] Cope: for this, testkitchen is great, plus whatever you want to use to test
[2013-10-17 15:12:16 -0400] Cope: and with chef-zero, you get a real search, and its quick
[2013-10-17 15:15:35 -0400] EricL: Ok, since I can't mimic the production environment of a full cluster of machines and I need to actually converge the node to see the results of everything, this sounds like a non-starter.
[2013-10-17 15:15:48 -0400] axsuul: How does Berkshelf handle site-cookbooks?
[2013-10-17 15:16:08 -0400] jmartin: EricL: you cant even mimic a reduced version of it?
[2013-10-17 15:16:20 -0400] Cope: EricL: not sure I agree... it sounds like this is just the sort of thing you do need to test; yeah it isn't easy, but it's surely valuable.
[2013-10-17 15:16:31 -0400] EricL: jmartin: The reduced version of it doesn't help me.  I need to check the full output.
[2013-10-17 15:16:59 -0400] Cope: EricL: so what you're describing, I think, is exactly the sort of thing I feel is hardest to achieve and has most value.
[2013-10-17 15:17:19 -0400] Cope: you need to stand up a multi-node setup, and verify it works as it should.
[2013-10-17 15:17:35 -0400] jmartin: EricL: what i mean is that if you have several clusters, you cant reduce the size of the cluster to 2 or 1 just for testing?
[2013-10-17 15:17:35 -0400] Cope: I've done this for simple cases, and it's something I'm very interested in.
[2013-10-17 15:19:10 -0400] EricL: I am trying to test something at the intersection of several clusters.
[2013-10-17 15:19:38 -0400] EricL: Which means I would have to drop several clusters down to 1 or 2 nodes and then run the template agasint a converged node.
[2013-10-17 15:21:25 -0400] EricL: Basically what I would like is to do something like jump on the node, open up a chef-shell and type something like, "output template(:source => '/foo/bar/baz')"
[2013-10-17 15:21:42 -0400] EricL: And it will just show me what the converged version of that file is.
[2013-10-17 15:21:59 -0400] EricL: Even that isn't great because it means I have to upload the cookbook.  But it's better than guessing.
[2013-10-17 15:22:00 -0400] jmartin: EricL: why-run maybe?
[2013-10-17 15:22:14 -0400] mveitas: Cope: I tried something DIRT simple:  http://pastebin.com/DSTTdi4r   Data bag of {"id": "test", "foo": "bar" }
[2013-10-17 15:22:19 -0400] EricL: ideally I would be able to do it without uploading the cookbook so I don't break things.
[2013-10-17 15:26:14 -0400] duckdive: Is there a way to enable why-run mode other than the command line option.  For instance, can I turn it on in a recipe?
[2013-10-17 15:27:15 -0400] EricL: Hmm, why-run is a step in the right direction.  It still means uploading the cookbook, but if I pin everything, then I can stick to only breaking one node at a time.
[2013-10-17 15:27:54 -0400] fak3r: Think that could be my new byline: "only breaking one node at a time"
[2013-10-17 15:30:06 -0400] mveitas: fak3r: you need to make the tshirt too
[2013-10-17 15:31:01 -0400] EricL: I would buy that shirt.
[2013-10-17 15:31:13 -0400] EricL: (though I shouldn't have to because I should get credit for the saying)
[2013-10-17 15:31:15 -0400] EricL: :)
[2013-10-17 15:35:23 -0400] fak3r: yep, gratis for you, will have to figure out if the phrase is Creative Commons :)
[2013-10-17 15:36:32 -0400] Cope: hehe
[2013-10-17 15:36:34 -0400] mveitas: cope: So the problem turns out that there is a BIG difference in -s and --secret-file on the knife command line!!!!  That's a few hours I won't get back
[2013-10-17 15:36:58 -0400] EricL: fak3r: I can just stop by your office when you make them.  It's only 4 blocks from mine. I was in there 2 weeks ago.
[2013-10-17 15:37:12 -0400] mveitas: lesson learned, probably better to use the long notation for knife command line parameters
[2013-10-17 15:37:53 -0400] Cope: mveitas: wow
[2013-10-17 15:38:14 -0400] fak3r: EricL: oh, really? cool
[2013-10-17 15:38:26 -0400] Cope: yeah i actually agree about long knife notation...
[2013-10-17 15:38:32 -0400] EricL: fak3r: You do work for Datadog, right?
[2013-10-17 15:39:00 -0400] mveitas: cope: lesson learned and will put that one into the memory banks!
[2013-10-17 15:39:33 -0400] fak3r: EricL: no, sorry - maybe someone else faking things over there?
[2013-10-17 15:39:49 -0400] mveitas: having both the short and long versions of command line args can screw you over!
[2013-10-17 15:40:09 -0400] EricL: fak3r: Oh well.  You can still ship it :)
[2013-10-17 15:42:17 -0400] dmdeklerk: Hi chefs; I get the following error in "chefspec" and I can't find the solution.
[2013-10-17 15:42:28 -0400] dmdeklerk: Failure/Error: let (:chef_run) { ChefSpec::Runner.new.converge(described_recipe)}
[2013-10-17 15:42:47 -0400] dmdeklerk: Chef::Exceptions::CannotDetermineNodeName: Unable to determine node name: configure node_name or configure the system's hostname and fqdn
[2013-10-17 15:43:32 -0400] dmdeklerk: I'm using ubuntu 12.04 that I set in my RSpec.configure.
[2013-10-17 15:43:43 -0400] mondo: dmdeklerk: check the output of hostname -f
[2013-10-17 15:44:00 -0400] dmdeklerk: mondo: there is no server its chefspec
[2013-10-17 15:44:22 -0400] dmdeklerk: it uses fauxhai instead of ohai.
[2013-10-17 15:45:04 -0400] mondo: ohisee!
[2013-10-17 15:45:37 -0400] dmdeklerk: I am guessing I should provide things like node_name and fqdn, but cant seem to find where to place these things.
[2013-10-17 15:46:12 -0400] dmdeklerk: I'm using chefspec 3.0.0 (beta)
[2013-10-17 15:53:41 -0400] laurent\: hmm chef-shell -z == chef-client ?
[2013-10-17 15:54:30 -0400] jtimberman: laurent\: "client mode" yes. it will connect to the server, resolve cookbooks and download them etc.
[2013-10-17 15:54:40 -0400] jtimberman: and be able to do search across nodes in the server
[2013-10-17 15:54:42 -0400] laurent\: and run them
[2013-10-17 15:54:57 -0400] laurent\: i'm just trying v11, i'm was using shef -z before
[2013-10-17 15:56:08 -0400] tmichael: lovingly referred to on my team as "you know: chef with an s" :)
[2013-10-17 15:57:12 -0400] laurent\: i was running shef -z on my wrkstation with only some config and credential in .chef, it now defaults to /etc/chef/* when using -z
[2013-10-17 16:05:50 -0400] laurent\: what's to best way to convert an attribute and its childs to a hash. for instance node["blah"].to_hash["hey"].class is Chef::Node::ImmutableMash
[2013-10-17 16:06:15 -0400] jtimberman: laurent\: node['blah'].to_hash should DWIM
[2013-10-17 16:12:06 -0400] laurent\: jtimberman: that's not really helping
[2013-10-17 16:15:45 -0400] laurent\: with v10 node["blah"].to_hash["hey"].class => Mash, it's Chef::Node::ImmutableMash with v11. i'll find my way around this, not a big deal
[2013-10-17 16:15:56 -0400] laurent\: s/it's/with/
[2013-10-17 16:30:17 -0400] laurent\: https://gist.github.com/llaurent/7027990 <= that's a weird one :)
[2013-10-17 16:38:50 -0400] laurent\: jtimberman: there's ticket for it already https://tickets.opscode.com/browse/CHEF-3857
[2013-10-17 16:42:20 -0400] laurent\: from http://stackoverflow.com/questions/14738364/chef-11-any-way-to-turn-attributes-into-a-ruby-hash
[2013-10-17 16:46:44 -0400] pabst^: our chef server goes to production today... YAY!
[2013-10-17 16:47:01 -0400] jmartin: pabst^: nice
[2013-10-17 16:47:15 -0400] jmartin: pabst^: i hope you are deploying it with chef
[2013-10-17 16:47:17 -0400] jmartin: heh
[2013-10-17 16:47:26 -0400] pabst^: jmartin: it was deployed with chef
[2013-10-17 16:47:33 -0400] pabst^: jmartin: which blew everyones mind.
[2013-10-17 16:47:37 -0400] jmartin: hah
[2013-10-17 16:47:58 -0400] jmartin: excellent news then!
[2013-10-17 16:47:58 -0400] pabst^: when I first proposed chef i got, so are we going to use our old method of deployment to deploy chef
[2013-10-17 16:48:05 -0400] pabst^: I said no, we are going to deploy chef with chef
[2013-10-17 16:48:11 -0400] pabst^: blank stares followed
[2013-10-17 16:55:34 -0400] jhayden: is there a way to get remote_file to exit cleanly when the remote file does not exist instead of throwing a 404 exception?
[2013-10-17 17:04:43 -0400] coderanger: jhayden: cleanly no, but you can get it to not fail the run with ignore_errors
[2013-10-17 17:04:54 -0400] coderanger: it will still display the error, but keep going
[2013-10-17 17:05:08 -0400] coderanger: In general thats not a great way to use remote_file though
[2013-10-17 17:06:42 -0400] jhayden: understood but I am trying to figure a way to trigger a local action based upon the existence of a remote file (s3)
[2013-10-17 17:06:56 -0400] Skeletor1: How do you all limit access to the chef ports in production, specifically in AWS?
[2013-10-17 17:07:00 -0400] jhayden: and this is as close as I have come t getting it to work
[2013-10-17 17:10:59 -0400] coderanger: jhayden: Just use a ruby_block and net/http
[2013-10-17 17:11:21 -0400] coderanger: Skeletor1: The only "chef port" is 443, and you can use any normal firewall tool
[2013-10-17 17:11:30 -0400] coderanger: Skeletor1: There are nice cookbooks for iptables and ufw
[2013-10-17 17:12:40 -0400] jhayden: coderanger: I tried that but I ran into scoping issues i.e.: testing for file existence inside ruby boock means I don't know about it outside of block
[2013-10-17 17:12:56 -0400] jhayden: block
[2013-10-17 17:13:05 -0400] Skeletor1: coderanger: Figured that was it, just didnt know if you all just left your instance open to the world and call it good
[2013-10-17 17:13:11 -0400] Skeletor1: coderanger:  thanks
[2013-10-17 17:17:18 -0400] coderanger: jhayden: That is correct, you would need to use the Chef API to run whatever it is you wanted to do afterwards
[2013-10-17 17:17:37 -0400] coderanger: Skeletor1: You can also use Amazon's Security Groups too
[2013-10-17 17:24:30 -0400] techminer: Is there a way to specify a block in a recipethat only runs if git version < 1.8.3 ??
[2013-10-17 17:26:18 -0400] Skeletor1: techminer: add only_if { git =< "1.8.3" } for your resource is one way
[2013-10-17 17:26:28 -0400] coderanger: techminer: Yes, check out seth vargo's new chef-sugar project
[2013-10-17 17:26:39 -0400] coderanger: But a better way is to assert the state one way or the other
[2013-10-17 17:26:45 -0400] coderanger: (as opposed to reacting to state)
[2013-10-17 17:27:43 -0400] techminer: I am upgrading git in a block..but I only want it to run if git actually needs to be upgraded..and it actually has to remove the old git and perl-Git packages first....
[2013-10-17 17:28:10 -0400] techminer: So assert the state prior to the block?
[2013-10-17 17:28:30 -0400] coderanger: techminer: Are you using apt or similar?
[2013-10-17 17:28:37 -0400] techminer: yum/rpm
[2013-10-17 17:28:45 -0400] techminer: I'm using the package resource
[2013-10-17 17:28:58 -0400] samsonasu: so I'm running into this problem (https://tickets.opscode.com/browse/CHEF-3581) on a vagrant box and I'm not sure how to fix it since the omnibus vagrant plugin overwrites my changes to /usr/bin/chef-client every time i run vagrant provision, any ideas?
[2013-10-17 17:29:14 -0400] coderanger: techminer: it is already idempotent then
[2013-10-17 17:29:22 -0400] coderanger: techminer: So if the version is correct, it won't do anything
[2013-10-17 17:30:43 -0400] techminer: coderanger:  the issue I'm having is git won't upgrade until perl-Git is upgraded.and vice versa.  My solution is to uninstall previous versions of both packagers first.then install both new packages.but only if the old packages actually are not 1.8.3 already.
[2013-10-17 17:31:48 -0400] techminer: I don't think the package resource accepts the attribute "version "<1.8.3" does it?  if it does than that would be my answer.
[2013-10-17 17:32:24 -0400] coderanger: I don't think so, no. Hmm, so the two packages just have a mutual dependency it sounds like
[2013-10-17 17:32:56 -0400] coderanger: You could probably make it work by skipping the package resource and doing something like execute 'apt-get install git==1.8.3 perl-Git==1.8.3
[2013-10-17 17:33:06 -0400] coderanger: I'm a bit fuzzy on the exact syntax, been a while
[2013-10-17 17:33:23 -0400] coderanger: but usually that will allow mutual deps to sort out since it does a single solution check on the depgraph
[2013-10-17 17:34:00 -0400] techminer: coderanger:  yesseems like I can't upgrade one without the other.  hmmm yea I'll give that a try  but it will still run in every Chef run unless I can figure out an only_if or not_if
[2013-10-17 17:34:17 -0400] coderanger: techminer: It will run, but apt is idempotent itself so I wouldn't worry too much
[2013-10-17 17:35:24 -0400] coderanger: Er sorry, you said you are using yum
[2013-10-17 17:35:24 -0400] coderanger: spaced on that
[2013-10-17 17:35:35 -0400] coderanger: yum is also idempotent, but slower so hmm
[2013-10-17 17:35:44 -0400] coderanger: Then yeah, check out chef-sugar
[2013-10-17 17:36:52 -0400] BriGuy: I cannot find any information on this at all, but how do you upgrade a standalone chef-server that was installed with the RPM?
[2013-10-17 17:37:11 -0400] coderanger: BriGuy: Just install the new rpm over the old one
[2013-10-17 17:37:39 -0400] BriGuy: with just: yum install newRPMfile
[2013-10-17 17:38:18 -0400] BriGuy: it tells me it is obsoleted by the old RPM package
[2013-10-17 17:39:45 -0400] techminer: coderanger:  yep I think chef-sugar might be what I need.  I have to know the version of git first and uninstall it and perl-Git first if they are older.  Yum is apparently not smart enough to figure out the dependencies even when I pass it both packages together.  derp...
[2013-10-17 17:40:22 -0400] coderanger: techminer: Yeah, I don't think yum itself does that single-pass solution thing, though RPM itself does but thats not super helpful here
[2013-10-17 17:40:26 -0400] coderanger: lolpackaging
[2013-10-17 17:42:03 -0400] BriGuy: can I safely uninstall the older RPM and reinstall the new one without loosing anything
[2013-10-17 17:42:24 -0400] BriGuy: or force it?
[2013-10-17 17:42:47 -0400] coderanger: BriGuy: I don't know the details on rpm-based systems to say 100%, sorry
[2013-10-17 17:42:59 -0400] coderanger: BriGuy: What are you upgrading from/to?
[2013-10-17 17:43:12 -0400] BriGuy: 11.0.6 to 11.0.8
[2013-10-17 17:43:16 -0400] techminer: coderanger:  you're rightRPM itself worked  "rpm -Uvh git perl-Git"  .so I don't need to uninstall firstjust need to run "only_if {git <= 1.8.3}"
[2013-10-17 17:43:19 -0400] coderanger: Chef 11 omnibus -> newer chef 11 omnibus should but just a thing
[2013-10-17 17:44:34 -0400] coderanger: So if thats not working, its definitely a bug
[2013-10-17 17:44:55 -0400] coderanger: techminer: Next question, why are all these special cases still taking up space in my brain :(
[2013-10-17 17:45:43 -0400] techminer: special cases?
[2013-10-17 17:45:59 -0400] coderanger: techminer: Edge cases wrt package upgrades
[2013-10-17 17:46:47 -0400] coderanger: BriGuy: You might have better luck asking on the ML, or pinging kallistec or btm
[2013-10-17 17:46:55 -0400] coderanger: (or ssd7)
[2013-10-17 17:46:58 -0400] techminer: coderanger:  Because a git bug that affects Chef is killing me.  https://tickets.opscode.com/browse/CHEF-3940
[2013-10-17 17:47:12 -0400] BriGuy: ok ty - one last question - is there anyway to use the subversion resource to diff a file with the HEAD revision first before doing anything, so I can use notify only when different?
[2013-10-17 17:47:53 -0400] BriGuy: it seems to just pull it down and overwrite it everytime even if it is the same
[2013-10-17 17:48:21 -0400] techminer: There is no 1.8.3 package in EPEL for CentOS.  I figured out how to compile my own RPM on one of my hosts with a cookbook recipe.  So now I just want to install it on all my CentOS nodes that are failing because of this git bug.
[2013-10-17 17:48:46 -0400] techminer: It's kind of an ugly fix..
[2013-10-17 17:50:10 -0400] coderanger: BriGuy: It should only notify when the repo changes
[2013-10-17 17:50:19 -0400] techminer: BriGuy:  look a t the revision attribute
[2013-10-17 17:51:07 -0400] techminer: nevermind that's not what you are looking for
[2013-10-17 17:51:15 -0400] BriGuy: with the export action, it seems to just overwrite it everytime
[2013-10-17 17:54:42 -0400] coderanger: Ahh yeah, thats how export works
[2013-10-17 17:54:46 -0400] coderanger: you want the default sync action
[2013-10-17 17:56:03 -0400] BriGuy: I was confused by that one on the docs site - when it says "use to update the source to the specified version" will chef actually change the source repo file if the local file is different?
[2013-10-17 17:57:46 -0400] coderanger: BriGuy: No, its purely just an svn up
[2013-10-17 17:58:10 -0400] coderanger: export works like git/svn export and creates an unversioned copy of the repo
[2013-10-17 17:59:09 -0400] BriGuy: okay... thank you so much - been searching that one forever, the description really through me off for some reason
[2013-10-17 18:04:52 -0400] ponyofdeath: hi, I installed latest chef client 11.6.2 and am now seeing an issue in one of my cookbooks: http://paste.ubuntu.com/6252342 any ideas what I need to fix?
[2013-10-17 18:04:59 -0400] gchristensen: FFS, ssh-agent doesn't appear to actually play nice with `knife ssh` (net-ssh) on keys with passwords.
[2013-10-17 18:07:03 -0400] yvan_: Question: what are the ports used between chef-server 1108-1 and chef-client 1106 in HTTPS ? Only 443 ?
[2013-10-17 18:12:06 -0400] yvan_: <yvan_> Question: what are the ports used between chef-server 1108-1 and chef-client 1106 in HTTPS ? Only 443 ?
[2013-10-17 18:17:29 -0400] coderanger: yvan_: yes
[2013-10-17 18:17:43 -0400] coderanger: the server also listens on port 80 by default, but it just redirects to https
[2013-10-17 18:25:08 -0400] yvan_: @coderanger: thx man. not easy to open corporate firewalls these days
[2013-10-17 18:25:15 -0400] gkra: oh for frak's sake
[2013-10-17 18:25:35 -0400] gkra: a cookbook got uploaded with updated version constraints
[2013-10-17 18:25:42 -0400] gkra: now erchef is eating all CPU and not repsonding to anything
[2013-10-17 18:27:22 -0400] |rt|: does the cron.d lwrp support having more than one command in the resulting cron.d file
[2013-10-17 18:27:39 -0400] |rt|: it looks like no from the template and code but want to make sure I'm not overlooking something
[2013-10-17 18:28:08 -0400] gkra: oh wait, it's Couchbase, not erchef
[2013-10-17 18:28:37 -0400] BriGuy: coderanger: on that subversion question - I cannot use checkout/update for a single file only export - so is there anyway you know of to compare a single file against the repo and only pull down if different?
[2013-10-17 18:28:57 -0400] coderanger: BriGuy: Are you using mod_dav_svn?
[2013-10-17 18:29:10 -0400] coderanger: BriGuy: If so, you can just use remote_file and ignore the fact that its a subversion repo
[2013-10-17 18:35:34 -0400] gkra: okay, so who can help me hammer couchdb back into shape?
[2013-10-17 18:40:31 -0400] CPS: does chef have a way to edit files? I've got a set of config files that need to have values inserted into them (hostname, for example) that vary for each node
[2013-10-17 18:40:53 -0400] gkra: CPS: easiest way I've found is with templates
[2013-10-17 18:41:16 -0400] CPS: can you link to that documentation?
[2013-10-17 18:41:55 -0400] dmdeklerk: CPS: are you allready using the knife cli?
[2013-10-17 18:42:04 -0400] BriGuy: coderanger: will remote_file handle authentication though?
[2013-10-17 18:42:04 -0400] CPS: yeah
[2013-10-17 18:42:17 -0400] CPS: i'm on windows, if that matters
[2013-10-17 18:43:07 -0400] dmdeklerk: CPS: I dont know any windows ;(
[2013-10-17 18:43:25 -0400] CPS: i just need to fill in values into these config files
[2013-10-17 18:43:29 -0400] CPS: how is that normally done?
[2013-10-17 18:43:34 -0400] coderanger: BriGuy: Yes, it will
[2013-10-17 18:44:06 -0400] dmdeklerk: CPS: with attributes in templates, and then run the chef-client
[2013-10-17 18:44:26 -0400] CPS: thanks, i'll look into that
[2013-10-17 18:45:06 -0400] dmdeklerk: CPS: or with databags that are then used in templates. databags can be edited on the command line with knife
[2013-10-17 18:45:09 -0400] BriGuy: coderanger: didn't see that on the docs - what are the attributes for username/password then?
[2013-10-17 18:45:25 -0400] coderanger: BriGuy: No attribute, just put it in the URL as normal
[2013-10-17 18:45:35 -0400] coderanger: BriGuy: scheme://username:password@host/path
[2013-10-17 18:45:47 -0400] BriGuy: coderanger: ahhh nice!
[2013-10-17 18:46:23 -0400] gkra: coderanger: any suggestions for erchef / beam.smp that's gone off the rails?
[2013-10-17 18:47:20 -0400] coderanger: gkra: kill --withfire?
[2013-10-17 18:48:23 -0400] gkra: 400% CPU, and nothing can do cookbook dependency resolution. nothing of interest in the logs
[2013-10-17 18:48:42 -0400] gkra: restarting the service doesn't help, it goes right back to what it was doing
[2013-10-17 18:49:36 -0400] coderanger: gkra: Sorry, not my area of expertise, usually caused by a weird loop in the cookbook deps
[2013-10-17 18:50:02 -0400] gkra: ugh.
[2013-10-17 18:50:19 -0400] gkra: I *really* don't want to have to delete and re-upload all the cookbooks
[2013-10-17 18:50:32 -0400] gkra: primarily because we have a couple environments that are version-locked behind current :(
[2013-10-17 18:52:37 -0400] coderanger: gkra: No, its likely a recent metadata change
[2013-10-17 18:53:19 -0400] gkra: So, uploaded an internal policy cookbook. erchef went bananas.
[2013-10-17 18:53:25 -0400] gkra: deleting said cookbook version didn't fix anything
[2013-10-17 18:53:48 -0400] gkra: meanwhile I've got ~2000 nodes trying to check in
[2013-10-17 18:53:54 -0400] arussel: the java cookbook the the second recipe after the maven cookbook, where in the attribute file I have something like: default['foo'] = default['bar'] and default['bar'] = xxx
[2013-10-17 18:54:12 -0400] arussel: I override default['bar'] = yyy but ['foo'] stays xxx, is that  something expected ?
[2013-10-17 18:54:21 -0400] d```: gkra: I've had somethign similar happen, restarting couch fixed it for me
[2013-10-17 18:54:26 -0400] arussel: so I have to override every attribute that depends on the attribute I override, this is not very convenient
[2013-10-17 18:55:34 -0400] jbz: arussel:  The 'default' is a method used to set it, not read it
[2013-10-17 18:55:50 -0400] EricL: gkra: I get that all the time.
[2013-10-17 18:55:52 -0400] jbz: arussel: ALthough I'm not sure if that construct is a good idea, it should read something like:
[2013-10-17 18:56:08 -0400] gkra: EricL: how do you fix it?
[2013-10-17 18:56:15 -0400] EricL: gkra: It always hapepsn for the same reason and I always fix it the same way.
[2013-10-17 18:56:21 -0400] jbz: arussel: actually, wait, that won't work
[2013-10-17 18:56:40 -0400] arussel: jbz: I'm just setting it using override['bar'] = "yyy" or putting node. before in a recipe
[2013-10-17 18:56:40 -0400] EricL: It's a result of Chef not being able to do dependency resolution because a cookbook is either missing from a pin or does not exist.
[2013-10-17 18:56:47 -0400] spstarr_work: aruo?
[2013-10-17 18:56:49 -0400] spstarr_work:  knife cookbook upload --all -V ERROR: The data in your request was invalid Response: Bad checksums!
[2013-10-17 18:56:49 -0400] jbz: arussel: The attribs file defaults are evaluated first, so no other attribs will be set yet
[2013-10-17 18:56:54 -0400] spstarr_work: Chef 11.4.4
[2013-10-17 18:56:59 -0400] spstarr_work: any debug on why?
[2013-10-17 18:57:10 -0400] EricL: Once I track down the missing cookbook or f'd up pin, I fix it, then I have to kill all the dep resolution processes on the Chef server and things slowly recover.
[2013-10-17 18:57:42 -0400] EricL: I personally think Chef should be better about failing and not spin everything into the ground.  But I don't know the complexities around making that happen.
[2013-10-17 18:58:46 -0400] EricL: It's also been known to happen if you upgrade to a new cookbook and delete the old one from the chef-server before the new one has propagated and it will try to use the cached one locally.  But since it can't verify the cached version, it just spins itself into the ground.
[2013-10-17 18:58:54 -0400] EricL: gkra: Make sense?
[2013-10-17 18:59:07 -0400] arussel: jbz:  the problem is that default are evaluated, all of them so ['bar'] is xxx, and ['foo'] is xxx, and then overriding is evaluated so ['bar'] becomes yyy but not ['foo'], this makes no sense for me.
[2013-10-17 18:59:19 -0400] gkra: EricL: yeah, but not quite sure as to the fix.
[2013-10-17 18:59:47 -0400] arussel: (and for most recipe)
[2013-10-17 18:59:48 -0400] EricL: gkra: Figure out what cookbook or pin'd version of something is casuing the dependency loop.
[2013-10-17 19:00:18 -0400] EricL: Make sure no one deleted any old cookbooks or uploaded new ones that don't properly resolve.
[2013-10-17 19:01:06 -0400] arussel: is chef behavior to really compute all default attribute and the override the overriden one, wihtout taking into account attribute depending on other attribute ?
[2013-10-17 19:02:33 -0400] arussel: I can't find a use case where this make sense (not that I've seen that many cookbook :-), but still ...)
[2013-10-17 19:02:41 -0400] EricL: gkra: The process is a huge PITA, but you get used to it.  I figure it's just part of admining a chef setup.
[2013-10-17 19:03:57 -0400] jmartin: arussel: it sounds to me like you might be doing something funky, can you gist your example?
[2013-10-17 19:04:23 -0400] arussel: jmartin: https://github.com/opscode-cookbooks/maven/pull/27
[2013-10-17 19:04:55 -0400] arussel: and the exact same thing is happening with the java cookbook: https://github.com/opscode-cookbooks/java/blob/master/attributes/default.rb
[2013-10-17 19:05:36 -0400] arussel: I override node['java']['jdk_version'] but then default['java']['openjdk_packages']  is using not the overriden value but the original default value
[2013-10-17 19:07:59 -0400] gchristensen: gosh durnit chef :(
[2013-10-17 19:08:02 -0400] njero: hey all, when running knife-solo on a box it appears that chef is not running the recipes in the order that I specified. Is that right?
[2013-10-17 19:11:00 -0400] jmartin: arussel: yeah, i see what you mean, that dependency isnt enforced in anyway, because it collects the defaults first, then applies overrides, but there is no way for chef to know there is a dependency there as by that time its just a string
[2013-10-17 19:11:13 -0400] jmartin: since its a variable sub
[2013-10-17 19:11:48 -0400] arussel: jmartin: you mean that chef code has to be changed to work properly ?
[2013-10-17 19:12:22 -0400] jmartin: arussel: i mean that if you look at http://docs.opscode.com/essentials_cookbook_attribute_files.html#attribute-precedence you will see why it works that way
[2013-10-17 19:12:53 -0400] jmartin: basically it collects the default attributes (does the variable substitution there as well so its just a string after that) THEN applies overrides to the attributes
[2013-10-17 19:12:59 -0400] jmartin: at least as far as i understand
[2013-10-17 19:13:29 -0400] jmartin: coderanger: that seem true?
[2013-10-17 19:13:50 -0400] arussel: jmartin: do you agree that this make very little sense ? and that attribute value should be computed only after a dependency tree of attribute has been computed ?
[2013-10-17 19:15:26 -0400] mattray: KNIFE ticket review: https://plus.google.com/hangouts/_/8077bb7db69c9e60cf221c5e761790656eaf3642?authuser=0&hl=en
[2013-10-17 19:15:39 -0400] arussel: default and override should be method call that create that tree, not just a map of attribute string :(
[2013-10-17 19:15:59 -0400] gchristensen: i there a way to have chef output the searches it performs against the chef server? I'm having one return improper content, and -l debug doesn't seem to output the actual query
[2013-10-17 19:18:35 -0400] EricL: miah: Do you have an example of what the full data bag should look like if I was creating a full redis instance from it?
[2013-10-17 19:19:20 -0400] arussel: could a kine advance user confirm that attribute dependency (ie: default['a']['b'] = "#{default['x']['y']}")  is not taken into account when setting the attribute value ?
[2013-10-17 19:19:26 -0400] arussel: s/kine/kind/
[2013-10-17 19:19:30 -0400] CPS: what does this notation mean? node[:monit][:server]
[2013-10-17 19:19:50 -0400] EricL: CPS: It's Ruby's symbol notation.
[2013-10-17 19:20:39 -0400] EricL: node['monit'] != node[:monit] by default in a Ruby Hash. It must be a HashWithIndifferentAccess for those 2 values to be equivalent.
[2013-10-17 19:21:15 -0400] CPS: the node[attr] is an attribute of the node? if so, how do you set those?
[2013-10-17 19:22:06 -0400] arussel: CPS: http://docs.opscode.com/essentials_cookbook_attribute_files.html you can set it in a lot of different way
[2013-10-17 19:22:23 -0400] arussel: in a recipe, in an attribute file ...
[2013-10-17 19:23:17 -0400] CPS: thanks
[2013-10-17 19:26:30 -0400] arussel: if chef isn't taking into account attribute dependency, then isn't this https://github.com/opscode-cookbooks/java/blob/master/attributes/default.rb bad practice
[2013-10-17 19:27:24 -0400] arussel: should we use in the attribute file only 'string' attribute and put all computed attribute in the recipe, so the user of the cookbook wouldn't have to override everything ?
[2013-10-17 19:29:03 -0400] admin0: hi .. when I install chef-server on a server and do http:// or https://ip, it shows me a login page .. is it possible to rename this page to something else and show a different page there ?
[2013-10-17 19:30:47 -0400] arussel: admin0: isn't it more the job of a proxy to do this ?
[2013-10-17 19:31:50 -0400] admin0: you mean the embedded nginx ? sorry . i am trying to learn more
[2013-10-17 19:33:07 -0400] arussel: admin0: did you mean you want to customize your login page (but still keeping it as a login page)
[2013-10-17 19:33:27 -0400] admin0: i want to rename the login page to say login or chef-login and put another page there
[2013-10-17 19:34:27 -0400] arussel: 'put another page' == a complete different page ? (btw, using your own chef server might not be the best way to learn chef)
[2013-10-17 19:34:49 -0400] CPS: is it possibleto use XML templates?
[2013-10-17 19:34:55 -0400] daw13: Hello, I'm having a validator client permission issue
[2013-10-17 19:34:59 -0400] CPS: does the <> markup stuff blow it up?
[2013-10-17 19:35:11 -0400] arussel: CPS: in erb ?
[2013-10-17 19:35:14 -0400] CPS: yes
[2013-10-17 19:35:15 -0400] daw13: Your validation client is not authorized to create the client for this node (HTTP 403).
[2013-10-17 19:35:21 -0400] daw13: is the error I get
[2013-10-17 19:35:27 -0400] admin0: arussel: this is not about using chef .. chef is working fine .. just that I do not want the chef login page to load when people do http://ip
[2013-10-17 19:36:07 -0400] CPS: admin0: track down the html/php files it's using and hard code it to automatically authenticate?
[2013-10-17 19:37:02 -0400] arussel: CPS: does this help: http://api.rubyonrails.org/classes/ERB/Util.html
[2013-10-17 19:37:27 -0400] admin0: CPS, if i do  http://IP,  it redirects to https://IP:443/users/login  and shows the login form .. all I want to do is show a blank page here on default redirection .. ..
[2013-10-17 19:37:37 -0400] CPS: arussel: probably not, i'm not using rails
[2013-10-17 19:37:48 -0400] CPS: unless chef has some built in
[2013-10-17 19:37:57 -0400] arussel: ERB is neither chef nor rail, it is its own template stuff
[2013-10-17 19:38:10 -0400] gchristensen: its straight-up ruby
[2013-10-17 19:38:27 -0400] CPS: admin0: instead of redirecting you just want it to be blank?
[2013-10-17 19:38:37 -0400] admin0: yes
[2013-10-17 19:38:43 -0400] gchristensen: stormerider: ping
[2013-10-17 19:38:54 -0400] gkra: EricL: Hey, you were right. Deleted the two cookbooks involved in the depresolv hell (knife cookbook delete -yap), kicked the service, and everything was happy again.
[2013-10-17 19:39:17 -0400] gkra: now I get to re-stage the updates to see where things went wrong.
[2013-10-17 19:39:20 -0400] CPS: track down the index page, there's probably something in there that checks protocol and redirects if it's on http
[2013-10-17 19:39:23 -0400] gkra: where would I be without git?
[2013-10-17 19:39:33 -0400] admin0: for internal users allowed to access the server from firewall, i do not want this default username/password form to load so that they stop trying get in :) and instead replace it with some blank page ..
[2013-10-17 19:41:16 -0400] njero: hey all, my chef role includes postgres. Everything works great on a vagrant box, but on my live VPS for some reason it fails. IT says it doesn't have make even though the postgres recipe depends on build-essential. Anyone seen this before?
[2013-10-17 19:42:32 -0400] CPS: admin0: i'm not familiar with the inner workings of the web ui but it should be a simple task to comment out the redirect once you locate the resource
[2013-10-17 19:42:50 -0400] admin0: i located the resource :)
[2013-10-17 19:42:54 -0400] admin0: and customizing it
[2013-10-17 19:42:57 -0400] CPS: where is it?
[2013-10-17 19:43:39 -0400] admin0:  opt/chef-server/./embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/distro/common/html/chef-server-webui.8.html
[2013-10-17 19:43:53 -0400] admin0:  i used find . -exec grep -Hn "p@ssw0rd1" '{}' ';'  inside /opt/chef-server
[2013-10-17 19:44:00 -0400] admin0: -Hn prints both the filename and line number
[2013-10-17 19:44:06 -0400] admin0: so i  was able to find exactly where it is
[2013-10-17 19:44:29 -0400] arussel: why not just grep ? (slightly off topic :) )
[2013-10-17 19:44:39 -0400] EricL: gkra: No problem.  Glad it worked out.  Chef cookbook dependency resolutoin is definitely a big problem and you have to keep a close eye on it or you are going to screw yourself.
[2013-10-17 19:44:43 -0400] admin0: just grep will print the match, but not which file or which line
[2013-10-17 19:44:54 -0400] admin0: grep -Hn will print in which file it matched, and the exact line number also
[2013-10-17 19:45:39 -0400] arussel: grep -nr should do it (or l, not sure)
[2013-10-17 19:45:54 -0400] gkra: EricL: noted. There's a very strong desire here to version everything and control them tightly. I'm having to push back a bit because of exactly things like this.
[2013-10-17 19:45:59 -0400] admin0: same :)
[2013-10-17 19:46:04 -0400] admin0: didn't knew nr
[2013-10-17 19:46:55 -0400] EricL: gkra: I'm currently trying to figure out what dependency changed and is screwing my system now.  This definitely happen s a lot.
[2013-10-17 19:47:42 -0400] CPS: http://agirlwalksintoablog.blogspot.com/2008/10/using-ruby-and-erb-to-dynamically.html looks like a good resource for XML in erb
[2013-10-17 19:49:14 -0400] arussel: erb is a nice lib :-)
[2013-10-17 19:54:09 -0400] gchristensen: erb is a horrible pain in the ass :P don't lie!
[2013-10-17 19:56:10 -0400] arussel: hmm, apparently this is the case, http://www.opscode.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/ attribute dependency is not taken into account.
[2013-10-17 19:56:15 -0400] arussel: I really don't understand why
[2013-10-17 19:57:08 -0400] EricL: I really wish there was a way to figure out which server was unable to resolve it's dependencies and DoSing the Chef server.
[2013-10-17 19:59:25 -0400] gkra: EricL: there definitely needs to be more visibily when things go sideways
[2013-10-17 19:59:56 -0400] gkra: only way you know "oh, depresolve failure" is "Oh, beam.smp is eating all the CPU and there's nothing in the logs."
[2013-10-17 20:00:12 -0400] EricL: gkra: Yep.
[2013-10-17 20:00:37 -0400] EricL: I basically have to create a cron job to kill off anything using too much CPU on the chef-server every 5 minutes so my infrastructure doesn't fall apart.
[2013-10-17 20:00:40 -0400] EricL: It's really stupid.
[2013-10-17 20:01:11 -0400] gkra: I'm beginnig to take the theory "last commit to master before Chef ate it gets slapped."
[2013-10-17 20:01:35 -0400] EricL: Except in my case, this wasn't a commit.  This was someone cleaning up old cookbooks off the Chef server.
[2013-10-17 20:02:08 -0400] gkra: hah
[2013-10-17 20:02:26 -0400] EricL: So I really have no idea what's going on and I have no idea how to even go about recovering this.
[2013-10-17 20:02:48 -0400] gkra: I really get the idea that the fewer people touch chef, the better.
[2013-10-17 20:03:10 -0400] gkra: i.e., many may submit code, only one shall review & upload.
[2013-10-17 20:03:26 -0400] gkra: also speaks volumes fo ra test infrastructure.
[2013-10-17 20:04:35 -0400] EricL: Even a test infrastructure wouldn't help m.e
[2013-10-17 20:04:58 -0400] EricL: With no logging, this Chef install is completely screwed since I have no idea what's going wrong or how to figure out why.
[2013-10-17 20:05:48 -0400] ricin: anyone know how to properly get knife ec2 to let me use security group ids AND define a subnet?
[2013-10-17 20:06:39 -0400] troyready: Dumb question that I'm having a hard time answering via irb: would Mash.new evaluate to True in a recipe?
[2013-10-17 20:07:19 -0400] troyready: That is, if an attribute is set to Mash.new, and my recipe references if ['attribute'], will it execute?
[2013-10-17 20:07:26 -0400] EricL: ricin: I had to hack the crap out of knife ec2 to get it to do most things I wanted to do.
[2013-10-17 20:07:33 -0400] ricin: :\
[2013-10-17 20:07:53 -0400] arussel: ricin: I've gave up on it and I'm using Cloudformation + chef
[2013-10-17 20:07:55 -0400] EricL: ricin: There are so many un-merged pull requests.  I am going to fork knife (hehe) and then open source it sometime next month.
[2013-10-17 20:08:32 -0400] ricin: i think this is going to end up taking me a lot longer than i originally thought :P
[2013-10-17 20:09:28 -0400] CPS: how do i call data_bag_item in a template?
[2013-10-17 20:09:45 -0400] CPS: i want to pull a path from a data bag and dump it into the file
[2013-10-17 20:09:47 -0400] arussel: ricin: I'm building the whole aws infrastructure with cloud formation (this is what it is made for) and run chef on the ec2 node, if this could work for you, you should have  a look
[2013-10-17 20:09:55 -0400] spheromak: CPS pass it in variables from recipe template resource.
[2013-10-17 20:10:24 -0400] CPS: i can't call functions in an erb? only variables
[2013-10-17 20:10:25 -0400] CPS: ?
[2013-10-17 20:11:01 -0400] spheromak: you can but if  Chef::DataQuery isn't in Chef::Template you wont get access to  data_bag_item
[2013-10-17 20:11:14 -0400] arussel: CPS: no, but in your recipe you can set a variable from your databag and use it in your template definition
[2013-10-17 20:11:15 -0400] spheromak: also sorta putting some logic down in templates probably that you don't wnat there
[2013-10-17 20:11:39 -0400] spheromak: i've never done data_bag_item in template.. It's probably available
[2013-10-17 20:11:58 -0400] spheromak: <% bag = data_bag_item :bag, "foo" %>
[2013-10-17 20:12:06 -0400] spheromak: should do it if you _really_ must do it that way
[2013-10-17 20:12:47 -0400] CPS: i'm still learning, not sure what the best way to do this is
[2013-10-17 20:13:01 -0400] CPS: i figure storing all this stuff in data bags will make it more maintainable
[2013-10-17 20:13:02 -0400] spheromak: IMO best way is to pull the bag and validate the content in recipe
[2013-10-17 20:13:03 -0400] ricin: arussel: yeah, that's where i have chef. it's on an ec2 node.  i'm trying to create an easy way to clone our site stack in ec2 when needed
[2013-10-17 20:13:25 -0400] spheromak: and then pass variables to your template via  variables()  resource attribute
[2013-10-17 20:14:36 -0400] CPS: so <%= @variable %> in the erb, :variable => databag() in the recipe?
[2013-10-17 20:15:19 -0400] spheromak: yea    variables(  :foo => "bar" )    ==   <% @foo %>  in the template
[2013-10-17 20:15:30 -0400] CPS: got it, thanks
[2013-10-17 20:17:47 -0400] CPS: so, i'm on windows. when it creates the config file the file icon has a little lock on it
[2013-10-17 20:17:51 -0400] CPS: i can read it and it looks fine
[2013-10-17 20:18:05 -0400] CPS: is there some file permissions thing i should specify?
[2013-10-17 20:23:14 -0400] jmickle: anyone use the sensu cookbook?
[2013-10-17 20:29:58 -0400] j^2: i've been trying to wrap my head around sensu for ever. never been able to
[2013-10-17 20:30:09 -0400] j^2: just in general
[2013-10-17 20:32:22 -0400] jmickle: j^2: yea its got a bit of a ramp
[2013-10-17 20:37:18 -0400] njero: Nobody has answered my question but somebody has got to know. Why OH Why does chef-solo not run things in the order specified in the run_list?
[2013-10-17 20:39:16 -0400] poldo_: @njero do you have any include_recipe'
[2013-10-17 20:39:20 -0400] poldo_: s in the recipes?
[2013-10-17 20:39:55 -0400] njero: poldo_: I am using berkshelf and knife-solo. I have only one recipe and a run list. The rest is all default
[2013-10-17 20:41:30 -0400] njero: poldo_: looks like this https://gist.github.com/jeffrafter/76bc4d9b02a24d3c3358
[2013-10-17 20:43:17 -0400] spheromak: poldo_, it will run in that order unless a recipe calls include_recipe .
[2013-10-17 20:43:36 -0400] spheromak: include_recipe will reorder execution of recipe's cause it is evaluated @ compile time
[2013-10-17 20:47:02 -0400] azret: why would i get Data Bag Items must contain a Hash or Mash! i created the data_bag with knife
[2013-10-17 20:47:13 -0400] njero: spheromak: that doesn't seem to explain why it would choose a recipe from the third listed role as the first recipe to run
[2013-10-17 20:47:53 -0400] spheromak: are you using -j for your solo ? is that how you are controlling the role execution
[2013-10-17 20:48:56 -0400] spheromak: njero, whats the output say ? when you run it and it dumps the recipe order
[2013-10-17 20:49:16 -0400] njero: spheromak: I am running with knife solo. I have tried running from the machine directly and it breaks right out
[2013-10-17 20:49:24 -0400] njero: spheromak: is there a command to dump the order?
[2013-10-17 20:50:41 -0400] spheromak: njero, knife-solo doing something to the run-ordering ?
[2013-10-17 20:51:09 -0400] njero: not sure
[2013-10-17 20:51:11 -0400] spheromak: you can setup a  json to controll the run_list and  run chef-solo -j myrun.json
[2013-10-17 20:51:11 -0400] njero: this is the output https://gist.github.com/jeffrafter/3406e1df8bd41540a04b
[2013-10-17 20:52:04 -0400] joe_k: i am starting ec2 instances with knife-ec2
[2013-10-17 20:52:12 -0400] joe_k: is there an option to override the root device size?
[2013-10-17 20:52:23 -0400] CPS: i want to break down servers in to environments (dev, qa, prod) and by role (web, app, cache). what's the best way to do this with chef?
[2013-10-17 20:52:37 -0400] spheromak: by default chef-solo/client honor the run_list ordering.  the only thing that mucks with it is include_recipe.
[2013-10-17 20:52:41 -0400] joe_k: i found http://www.jayway.com/2010/03/31/how-to-get-a-large-c-drive-for-windows-on-amazon/ but not sure how to get that param into knife-ec2
[2013-10-17 20:52:45 -0400] spheromak: CPS, use environments
[2013-10-17 20:52:48 -0400] spheromak: and roles ?
[2013-10-17 20:52:56 -0400] joe_k: lol
[2013-10-17 20:53:11 -0400] njero: spheromak: I think I may have just found a clue running it verbose on the machine
[2013-10-17 20:53:25 -0400] spheromak: gist
[2013-10-17 20:54:06 -0400] njero: spheromak: https://gist.github.com/jeffrafter/087a4840caae281711cb
[2013-10-17 20:54:57 -0400] CPS: how do i access which role/env a server is in in a recipe/
[2013-10-17 20:54:58 -0400] spheromak: yea you got some missing role data.
[2013-10-17 20:55:09 -0400] spheromak: CPS,  node attribs
[2013-10-17 20:55:41 -0400] spheromak: CPS, http://docs.opscode.com/essentials_environments.html
[2013-10-17 20:55:46 -0400] xmltok: is there something like external node classifiers in puppet for chef? something similar to the execution of a script to determine what runlist should be used
[2013-10-17 20:56:15 -0400] CPS: thanks spheromak
[2013-10-17 20:57:54 -0400] spheromak: xmltok,  server has a node/client  REST api. you can build them up from whatever data you want. and controll the run_lists as such.  the ridley gem provides a handy ruby interface to chef-server
[2013-10-17 20:58:28 -0400] njero: spheromak: actually, that was just because I left out the -c chef-solo/solo.rb param. With that I get the same output I get from knife-solo. It starts with the postgres install for some reason
[2013-10-17 20:58:50 -0400] spheromak: njero, should have an expanded-runlist in the output of the run right ?
[2013-10-17 20:58:56 -0400] xmltok: im thinking more along the lines of when a new node is built out, i would like chef to run something to determine what should be on the node. i guess i would need to put that logic into something else to run before the chef client is executed
[2013-10-17 20:59:02 -0400] spheromak: njero, dump your dna.json to a gist and the output from the run
[2013-10-17 20:59:03 -0400] xmltok: so, no there isnt really anything
[2013-10-17 20:59:12 -0400] spheromak: xmltok, well its sorta built in
[2013-10-17 20:59:22 -0400] spheromak: since you have server that is a classifier
[2013-10-17 20:59:41 -0400] xmltok: but doesnt the server just run whatever is in the run list? i am missing something
[2013-10-17 20:59:57 -0400] spheromak: no server doens't run anything it tells the node what to run
[2013-10-17 21:00:23 -0400] spheromak: fundamental difference in chef/puppet
[2013-10-17 21:00:39 -0400] xmltok: well that is what i mean, the server has a run list and it tells the node what to do. there isnt any way to put logic around what the server thinks the run list is. I need to have an external process running to modify/create the runlist for a new node before the new node itself connects to chef
[2013-10-17 21:00:41 -0400] spheromak: chef server doesn't compile anything, it solves versions and services cookbooks / data
[2013-10-17 21:00:59 -0400] spheromak: well you can reflect in the cookbooks as well
[2013-10-17 21:01:02 -0400] spheromak: to change that run_list
[2013-10-17 21:01:20 -0400] xmltok: ah ok, so i could have a bootstrap cookbook that has that logic in it and changes the run list
[2013-10-17 21:01:32 -0400] spheromak: indeed
[2013-10-17 21:01:52 -0400] spheromak: if you wanted too..  not a lot of people do it liek that, but you can
[2013-10-17 21:02:15 -0400] xmltok: i have a lot of nodes, its not really feasible to manually enforce run lists via knife commands
[2013-10-17 21:02:20 -0400] spheromak: since you have environements roles and such
[2013-10-17 21:02:35 -0400] spheromak: you already have a rich set of tools to do classification  at create/bootstrap
[2013-10-17 21:02:53 -0400] spheromak: theres knife-bootstrap to handle classification in the "puppet" sense
[2013-10-17 21:03:03 -0400] spheromak: you can programatically do so
[2013-10-17 21:03:07 -0400] spheromak: you assign it one time
[2013-10-17 21:03:13 -0400] spheromak: there is  chef-shell
[2013-10-17 21:03:18 -0400] xmltok: thats true, but then what if those classification rules change later. i then need to go back and try to reclassify all of my existing nodes manually (not through automated chef runs)?
[2013-10-17 21:03:21 -0400] spheromak: which also has the nifty transform
[2013-10-17 21:03:39 -0400] spheromak: well if they really change. I think your being too specific.
[2013-10-17 21:03:43 -0400] spheromak: if you have a node with a role
[2013-10-17 21:03:47 -0400] spheromak: that role can change
[2013-10-17 21:03:53 -0400] spheromak: and htat updates all nodes with that role
[2013-10-17 21:04:07 -0400] spheromak: so if your  aweseom_webserver role  changes the run_list.. then they all pick that up
[2013-10-17 21:04:27 -0400] joe_k: yay. --ebs-size
[2013-10-17 21:04:41 -0400] xmltok: it will probably be a set of roles, but yeah maybe they wont even change. im just weary of having to track down which nodes would need to change and make sure they all change
[2013-10-17 21:04:52 -0400] xmltok: anyway, if i can do it through a cookbook, that pretty much solves the problem
[2013-10-17 21:04:53 -0400] spheromak: well thats what roles do
[2013-10-17 21:04:58 -0400] spheromak: and environments
[2013-10-17 21:05:22 -0400] spheromak: xmltok, honestly those contructs in chef were created as a reaction to what we had in puppet land back in the day.
[2013-10-17 21:05:39 -0400] spheromak: node bootstrap and classification was a pita to manage in puppet (circa 2.3 iirc)
[2013-10-17 21:05:42 -0400] xmltok: im not sure puppet has it right either :)
[2013-10-17 21:06:11 -0400] spheromak:  least i was frustrated with it back then. My puppet fu is quite antiquated tho these days
[2013-10-17 21:06:29 -0400] xmltok: ive been looking at salt, they manage it through a top file which can be code. its pretty cool because then on every run it can hit other resources to determine what should be running on a given node
[2013-10-17 21:06:38 -0400] xmltok: id like to be able to do something like that
[2013-10-17 21:06:46 -0400] spheromak: you get higher level concepts that you apply to nodes, then write the logic in recipes to do the right thing.  based on the rich set of node and search data available to you.
[2013-10-17 21:06:59 -0400] spheromak: so you end up not having all the  "class creep" that we had in puppet
[2013-10-17 21:07:23 -0400] spheromak: theres other things that are like that.. and you can build that with chef-solo if you want
[2013-10-17 21:07:46 -0400] spheromak: there was a good post on what airbnb does with solo
[2013-10-17 21:08:09 -0400] spheromak: xmltok, http://nerds.airbnb.com/making-breakfast-chef-airbnb/
[2013-10-17 21:08:17 -0400] xmltok: cool thanks ill give it a read
[2013-10-17 21:08:21 -0400] spheromak: and was a good discussion on theML of similar workflows
[2013-10-17 21:09:01 -0400] spheromak: Im not convinced tho that a big top-level config is what everyone needs (ala salt) .. its nice at a small scale
[2013-10-17 21:09:31 -0400] spheromak: but thinking you can describe the entire world at larger scales is problematic IMO.
[2013-10-17 21:09:54 -0400] xmltok: yeah, i was thinking i would write a python script to act as the top file
[2013-10-17 21:09:57 -0400] spheromak: but im with coderanger on emergent infra ;)
[2013-10-17 21:10:14 -0400] spheromak: but where is it magicing up its description of the world ?
[2013-10-17 21:10:18 -0400] spheromak: some db or something
[2013-10-17 21:10:20 -0400] xmltok: it could hit my inventory database to determine what kind of server it is, also use the hostname (which is very descriptive)
[2013-10-17 21:10:23 -0400] spheromak: which is what chef-server is ;)
[2013-10-17 21:10:32 -0400] spheromak: and you got shit like razor and such
[2013-10-17 21:10:46 -0400] spheromak: which allows you to set policies and then apply roles based on policy
[2013-10-17 21:10:55 -0400] xmltok: after seeing what fb had to do to the chef server to get it to work (removing states, no search, no databags) i am planning for the same requirements
[2013-10-17 21:10:57 -0400] spheromak: which I tink is what you're trying to get too maybe ?
[2013-10-17 21:11:03 -0400] spheromak: well
[2013-10-17 21:11:05 -0400] xmltok: i have no idea what razor is :)
[2013-10-17 21:11:10 -0400] spheromak: you got >20k  instances ?
[2013-10-17 21:11:19 -0400] xmltok: i will need to support 30k
[2013-10-17 21:11:34 -0400] xmltok: not all in one colo, i will probably need to break it up into several chef instances
[2013-10-17 21:11:55 -0400] spheromak: xmltok, we use state. don't goto the crazy things that fb did.  and its not a problem. if you code recipes that don't  abuse node.save and  search its not a huge deal to scale  into those areas.
[2013-10-17 21:12:57 -0400] spheromak: we also moved to using   etcd  for some realtime state sync stuff.
[2013-10-17 21:13:19 -0400] spheromak: xmltok, https://www.bluebox.net/insight/blog-article/provisioning-with-razor-and-chef-an-interactive-demo
[2013-10-17 21:15:10 -0400] njero: spheromak: sorry that took so long to get a clean output https://gist.github.com/jeffrafter/7808291cd34e1b19d390 if you are still around
[2013-10-17 21:15:19 -0400] spheromak: njero, np
[2013-10-17 21:15:29 -0400] njero: Runlist is https://gist.github.com/jeffrafter/7808291cd34e1b19d390#file-gistfile1-txt-L13
[2013-10-17 21:16:04 -0400] spheromak: njero, that looks right
[2013-10-17 21:16:09 -0400] spheromak: you see line12 and 13 ?
[2013-10-17 21:16:13 -0400] xmltok: cool spheromak thanks for all the info and links
[2013-10-17 21:16:18 -0400] spheromak: xmltok, np
[2013-10-17 21:17:14 -0400] njero: spheromak: yeah it looks totally right. Something weird happens around 388
[2013-10-17 21:17:28 -0400] spheromak: xmltok, you're run is in the right order.
[2013-10-17 21:17:35 -0400] spheromak: that is a compile-time action
[2013-10-17 21:18:07 -0400] spheromak: looks like you're running into the pg-gem   issue. Which im not intimate with, but have seen some discussion around
[2013-10-17 21:18:27 -0400] njero: ah, okay I can dig into that if it is a known thing
[2013-10-17 21:19:23 -0400] gkra: Hey I thought a notifies only triggers when something was actually done....
[2013-10-17 21:19:29 -0400] spheromak: njero, http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/ great post that talks about how  that all works under the hood  (compile / runtime) stuff if you want to know more
[2013-10-17 21:19:44 -0400] gkra: I've got an ark stanza that's declaring that nothing needs to be done, but then firing off the notifies anyway.
[2013-10-17 21:19:47 -0400] njero: thank you thank you... reading
[2013-10-17 21:19:47 -0400] spheromak: gkra, it triggers if the resource  has taken action
[2013-10-17 21:20:11 -0400] spheromak: gkra, is the resource redefined or signaled someplace else
[2013-10-17 21:20:31 -0400] gkra: no, this is in a custom policy cookbook
[2013-10-17 21:20:36 -0400] gkra: https://gist.github.com/gkra/ca4623c0209e4d5974de
[2013-10-17 21:21:23 -0400] spheromak: gkra there is an implicit action in that resource
[2013-10-17 21:21:44 -0400] spheromak: you would have to set action :none if you want it to not take any action.
[2013-10-17 21:22:17 -0400] spheromak: https://github.com/opscode-cookbooks/ark/blob/master/resources/default.rb#L25
[2013-10-17 21:22:23 -0400] gkra: I thought the checksum was supposed to be the determination....
[2013-10-17 21:22:29 -0400] spheromak: deafult action is  :install
[2013-10-17 21:22:33 -0400] spheromak: ah it will
[2013-10-17 21:22:33 -0400] gkra: i.e., if checksum matches, do nothing, if it doesn't, :install
[2013-10-17 21:22:37 -0400] spheromak: but
[2013-10-17 21:23:24 -0400] spheromak: you gotta be carefull cause if any sub resource actually fires and takes action with "use_inline_resources" it will indicate that the ark resource has taken action.
[2013-10-17 21:23:34 -0400] gkra: [2013-10-17T21:12:29+00:00] DEBUG: remote_file[/var/chef/cache/open-mq.zip] checking for changes
[2013-10-17 21:23:37 -0400] gkra: [2013-10-17T21:12:29+00:00] DEBUG: remote_file[/var/chef/cache/open-mq.zip] checksum matches target checksum (ac972acf455138b1705d6fca4772f4760090afd7a1cda3cb8c51413b561abf07) - not updating
[2013-10-17 21:23:40 -0400] spheromak: im not 100% on the intricacies of ark here.  so I can't comment directly on that.
[2013-10-17 21:23:41 -0400] gkra:  (up to date)
[2013-10-17 21:23:48 -0400] gkra: ugh
[2013-10-17 21:23:55 -0400] gkra: I'd swear this was behving properly before :(
[2013-10-17 21:24:08 -0400] spheromak: if it says up to date. it prob didn;'t signal it took action and your notifies shouldnt' fire
[2013-10-17 21:24:30 -0400] spheromak: so looks all correct to me, but hard to debug from here :\
[2013-10-17 21:24:43 -0400] gkra: yeah...
[2013-10-17 21:25:20 -0400] gkra:   * ruby_block[adding path to chef-client ENV['PATH']] action run[2013-10-17T21:12:30+00:00] INFO: Processing ruby_block[adding path to chef-client ENV['PATH']] action run (/var/chef/cache/cookbooks/ark/providers/default.rb line 90)
[2013-10-17 21:25:24 -0400] gkra: [2013-10-17T21:12:30+00:00] INFO: ruby_block[adding path to chef-client ENV['PATH']] called
[2013-10-17 21:25:27 -0400] gkra:     - execute the ruby block adding path to chef-client ENV['PATH']
[2013-10-17 21:25:33 -0400] gkra: wtf is that?
[2013-10-17 21:28:21 -0400] spheromak: gkra, https://github.com/opscode-cookbooks/ark/blob/master/libraries/default.rb#L104-L120
[2013-10-17 21:28:44 -0400] gkra: wonder if that's what's triggering the notifies....
[2013-10-17 21:28:48 -0400] spheromak: yea
[2013-10-17 21:28:50 -0400] spheromak: could be
[2013-10-17 21:29:18 -0400] spheromak: but i don't see it actually calling any resource action
[2013-10-17 21:29:40 -0400] spheromak: or mucking  updated_by_last_action
[2013-10-17 21:43:12 -0400] redondos: how can I tell chef to keep running the recipe when a resource fails?
[2013-10-17 21:43:35 -0400] Kzim: hi i'm surprise: in Chef 11 if i have a list on a nested dict, the list does not merge value across the attributes layers ?
[2013-10-17 21:44:01 -0400] tcate: redondos: setting ignore_failure to true should handle that
[2013-10-17 21:44:09 -0400] redondos: thanks
[2013-10-17 21:50:52 -0400] Kzim: why does list in normal level attributes are not merging ? :(
[2013-10-17 21:51:18 -0400] gchristensen: Kzim: list as in [1, 2, 3]?
[2013-10-17 21:51:42 -0400] gchristensen: Kzim: I consider them harmful: https://coderanger.net/2013/06/arrays-and-chef/
[2013-10-17 22:00:02 -0400] Kzim: gchristensen, yes like that i've read quickly this article but in the first example he use override and i use normal level on the node
[2013-10-17 22:02:50 -0400] ricin: i have a specific rpm that i want installed.  what's the best way to go about that in a recipe?
[2013-10-17 22:10:45 -0400] Skeletor1: ricin: use the package resource and specify a version
[2013-10-17 22:12:18 -0400] ricin: i mean i have an rpm file
[2013-10-17 22:12:29 -0400] ricin: it isn't in the repository
[2013-10-17 22:16:31 -0400] Skeletor1: ricin: you can use the "source" to specify the file that you want to install locally, with a remote_file to download the file onto the system
[2013-10-17 22:18:07 -0400] jtgiri_: hey guys, I was wondering if there is a way to save output from a command into an attribute ? https://gist.github.com/jtgiri/7f3a9aab8b33f33fbf06
[2013-10-17 22:23:45 -0400] ricin: Skeletor1: thanks. i did it by using cookbook_file and then package with source
[2013-10-17 22:28:04 -0400] Skeletor1: ricin: yup cookbook_file is right also, np
[2013-10-17 22:36:48 -0400] teukka: njero: you can trigger the debug output with knife solo (as with all knife commands) with `-VV` option. yeah, two Vs
[2013-10-17 22:37:07 -0400] teukka: njero: knife solo will then also pass the debug flag to chef-solo run
[2013-10-17 22:37:15 -0400] njero: hey teukka: yeah, I had that running... it is just a bit more verbose
[2013-10-17 22:37:56 -0400] njero: teukka: chef is ruining my life. I had everything running but the postgres thing is running first. The pg-gem. I hate it.
[2013-10-17 22:39:11 -0400] njero: This is my issue as near as I can tell http://stackoverflow.com/a/13118034/700536
[2013-10-17 22:39:13 -0400] teukka: maybe some dev libs are missing
[2013-10-17 22:41:37 -0400] teukka: ah, yeah. it's using chef_gem which installs it at "compile" phase
[2013-10-17 22:42:09 -0400] teukka: so you have to install build-essential and probably some dev-libs also at compile time
[2013-10-17 22:43:09 -0400] teukka: or divide the the magic to two distinct chef runs. first install the build env, then with another run install the pg-gem etc
[2013-10-17 22:43:22 -0400] teukka: both are quite bad options :(
[2013-10-17 22:45:37 -0400] njero: teukka: is there any way to just say you don't want that gem?
[2013-10-17 22:46:19 -0400] njero: teukka: I don't know that I even want the ruby from PG. I install ruby separately
[2013-10-17 22:47:09 -0400] teukka: some other cookbook/recipe is including it if *you* didn't put it to the run_list. lemme see...
[2013-10-17 22:47:30 -0400] njero: ah I found it
[2013-10-17 22:47:35 -0400] netty195: hi all
[2013-10-17 22:47:39 -0400] njero:  "recipe[database::postgresql]"
[2013-10-17 22:47:48 -0400] netty195: how can I know node's chef role from within a recipe?
[2013-10-17 22:49:15 -0400] cwj: netty195: inspect node.roles
[2013-10-17 22:49:49 -0400] cwj: er i guess its an attribute, not a method, so node[roles]
[2013-10-17 22:50:39 -0400] azret: encrypted data bags are tough to get working, can someone tell me why I'm getting this error? Chef::Exceptions::ValidationFailed
[2013-10-17 22:50:39 -0400] azret: ----------------------------------
[2013-10-17 22:50:40 -0400] azret: Data Bag Items must contain a Hash or Mash!
[2013-10-17 22:50:49 -0400] azret: the json is hashed as it should be
[2013-10-17 22:51:19 -0400] netty195: @cwj thanks
[2013-10-17 22:51:46 -0400] cwj: azret: gist what you are trying to do?
[2013-10-17 22:51:59 -0400] azret: send ssl certificates over an encrypted data bag
[2013-10-17 22:52:52 -0400] azret: is there a limit on how many characters it allows? my cert has both the cert and intermediate cert defined
[2013-10-17 22:53:00 -0400] redondos: what's a good way to compare kernel versions with chef? e.g. if kernel  > 3.2
[2013-10-17 22:53:01 -0400] azret: as one large string, so I'm wondering if json will not let it pass
[2013-10-17 22:53:48 -0400] cwj: azret: we do that, it works fine
[2013-10-17 22:54:11 -0400] cwj: when you say "send ssl certificates over an encrypted data bag it doesnt really tell me what command or code you are using
[2013-10-17 22:54:28 -0400] azret: here ill show ya
[2013-10-17 22:54:33 -0400] cwj: e.g. is this error youve pasted the result of running knife?
[2013-10-17 22:56:26 -0400] azret: http://pastebin.com/h95djKZw
[2013-10-17 22:56:53 -0400] azret: yea thats the errorthe json file is configured properly to hash, but I'm wondering if there is a character limit for the value of the key
[2013-10-17 22:57:19 -0400] cwj: what version of chef-client are you using?
[2013-10-17 22:57:38 -0400] azret: this is a test, so its chef-solo with vagrant and berkshelf
[2013-10-17 22:57:48 -0400] cwj: ok, what version of chef-solo are you using
[2013-10-17 23:01:12 -0400] azret: 0.3.0 but i don't think thats the one I'm using in particular, I'm wondering what ships with vagrant
[2013-10-17 23:02:03 -0400] cwj: i doubt if that is actually a version of chef you are using
[2013-10-17 23:02:40 -0400] cwj: i am mostly trying to understand if you encrypted the data bag item with a version of knife that is compatible with the version of chef-solo running inside the vm
[2013-10-17 23:02:57 -0400] cwj: i kind of think you would be getting a different error if that were the case, but its something to check
[2013-10-17 23:03:51 -0400] azret: 11.6.2
[2013-10-17 23:04:22 -0400] cwj: ok thats probably fine
[2013-10-17 23:04:37 -0400] azret: the values are obviously hashed, i can confirm that
[2013-10-17 23:04:48 -0400] azret: i found a bug where it was talking about the id
[2013-10-17 23:04:51 -0400] azret: but the id is also fine
[2013-10-17 23:07:24 -0400] cwj: the key and the data bag item are the same inside the VM as they are on the host file system?
[2013-10-17 23:07:42 -0400] njero: teukka: I got around it... I set build-essential to compile time
[2013-10-17 23:08:07 -0400] cwj: your usage of the Chef::EncryptedDataBagItem methods appear to be correct so i am thinking there is something wrong with your key or data bag item
[2013-10-17 23:09:10 -0400] njero: teukka: I had a knife-solo question... on the first run, before my users cookbook is played there are a ton of password prompts to login via ssh (for rsync). Is there a reason why you didn't have the default layout be one parent folder that gets synced so there is only one login? Or are you just expecting that to be setup using a bootstrap template?
[2013-10-17 23:09:12 -0400] azret: doesn't seem to be being pushed to the server
[2013-10-17 23:09:19 -0400] Skeletor1: Question for you all, how are you all installting ruby 2.0.0-p247? Downloading a tar file and compiling by using the bash resource? This is on ubuntu btw
[2013-10-17 23:09:21 -0400] azret: at least it doesn't exist in /var/chef/data_bags
[2013-10-17 23:10:00 -0400] cwj: is that the path configured in the solo.rb you are using?
[2013-10-17 23:10:07 -0400] njero: Skeletor1: I am using rbenv to install it
[2013-10-17 23:10:28 -0400] njero: Skeletor1: with ruby-build. But I have used the download and compile method before
[2013-10-17 23:12:08 -0400] Skeletor1: njero:  thanks, im starting clean for this new app, so ill use rbenv.
[2013-10-17 23:13:10 -0400] azret: i think i found the issue
[2013-10-17 23:13:22 -0400] azret: its because the data_bag exists entirely somewhere else
[2013-10-17 23:15:30 -0400] njero: Skeletor1: if I were smart I would download an compile it, then capture that to a package using http://asic-linux.com.mx/~izto/checkinstall/
[2013-10-17 23:15:53 -0400] njero: then use the targeted 12.04 2.0.0 build and not have to wait on compiles
[2013-10-17 23:17:53 -0400] Skeletor1: njero:  So you mean create the package on a system and then just download and install the ruby package with the recipes?
[2013-10-17 23:18:54 -0400] Skeletor1: njero:  Makes sense, lees time waiting on compile, thanks man!
[2013-10-17 23:23:05 -0400] njero: Skeletor1: yeah. checkinstall is awesome
[2013-10-17 23:50:11 -0400] pixlpushr: in the deploy resource, why would current not be symlinked to the releases directory? in fact, my releases/ dir doesn't exist, and current is a directory that holds my app's code instead of being a symlink
[2013-10-17 23:50:27 -0400] pixlpushr: tried reading chef's source with no luck
