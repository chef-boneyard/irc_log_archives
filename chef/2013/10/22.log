[2013-10-22 00:12:52 -0400] Hank_: Hello
[2013-10-22 00:13:19 -0400] Hank_: I am very new to ruby and chef and i have basic question wrt to reciepies
[2013-10-22 00:14:11 -0400] coderanger: Sure
[2013-10-22 00:15:03 -0400] Hank_: i am trying to run a select query  using the following block execute "do something" do command "./psql -U #{node[:configure_mss][:ms_db_username]} -c \"select mss_server_id from table where is=0 " end
[2013-10-22 00:15:22 -0400] Hank_: how can i store the response of the select query in a variable?
[2013-10-22 00:15:31 -0400] Hank_: can someone please help me out?
[2013-10-22 00:18:36 -0400] coderanger: Hank_: That is not something easy to do
[2013-10-22 00:18:52 -0400] coderanger: And generally not a great idea in a feed-forward idempotent system
[2013-10-22 00:19:14 -0400] coderanger: Store that value in a node attribute and enforce it on both dieas
[2013-10-22 00:19:17 -0400] coderanger: sides
[2013-10-22 00:20:24 -0400] Hank_: @Coderanger_: the value i need to retrieve is generated by a trigger while inserting a a row in the database
[2013-10-22 00:21:01 -0400] coderanger: What do you need to do with that value?
[2013-10-22 00:21:16 -0400] Hank_: here is the rough flow
[2013-10-22 00:21:25 -0400] coderanger: The easiest way to get it would be instead of shelling out to psql, use the pg gem API directly
[2013-10-22 00:21:32 -0400] coderanger: the postgresql::ruby recipe will install it
[2013-10-22 00:21:45 -0400] coderanger: this can be slightly problematic when using ident/peer auth though
[2013-10-22 00:22:53 -0400] Hank_: 1.insert a,b in table T which will generate the primary key for (a,b)
[2013-10-22 00:23:09 -0400] Hank_: 2.retrieve the pk for (a,b)
[2013-10-22 00:23:16 -0400] Hank_: 3. write to a  file
[2013-10-22 00:24:05 -0400] Hank_: should i try using postgresql::ruby for this?
[2013-10-22 00:25:43 -0400] Hank_: Also , since i am new to chef , i am not sure how the identity/peer authorization will affect me.
[2013-10-22 00:25:44 -0400] coderanger: Probably
[2013-10-22 00:25:54 -0400] coderanger: The peer auth thing isn't related to chef
[2013-10-22 00:26:08 -0400] coderanger: its just that you are making the call from a process that is running as root
[2013-10-22 00:26:17 -0400] coderanger: if that isn't part of your ident map, no auth :)
[2013-10-22 00:27:13 -0400] ikrima: dmg_packagewon't install a resource from a local path? Am I missing something?
[2013-10-22 00:29:01 -0400] Hank_: oh alrite , i shall try using Pg gem then , thanks
[2013-10-22 00:41:42 -0400] samsonasu: So I have a brand new server and when I run bootstrap it says "Failed to authenticate root - trying password auth" but I can definitely ssh there using public key suth.  I tried -i ~/.ssh/id_rsa and same thing, any ideas or thought?  Can I get it to spit out more log messages?
[2013-10-22 00:46:13 -0400] fak3r: samkottler: so did you use identity-file /home/user/.ssh/id_rsa.pub ?
[2013-10-22 00:50:51 -0400] rayrod2030: So I'm trying to create a runit template for a java app I'm trying to manage via a cookbook and this app takes all it's parameters as command line options instead of a config file.  What's the best way to make sure the runit template has the correct paremeters?
[2013-10-22 00:52:06 -0400] gkra: GAH
[2013-10-22 00:52:15 -0400] gkra: why is one attribute properly set, and another left blank?
[2013-10-22 00:52:17 -0400] rayrod2030: I'm using the runit cookbook btw and currently passing my runit_service resource @options which works but now I'm wondering if I need to parse the command line options dynamically in the runit template
[2013-10-22 00:53:47 -0400] gkra: https://gist.github.com/gkra/60f12003340abe64737b
[2013-10-22 00:53:50 -0400] gkra: any ideas?
[2013-10-22 00:58:40 -0400] douglaswth: gkra: maybe the attribute is set to an empty string or something?
[2013-10-22 01:04:14 -0400] gkra: douglaswth: but where?
[2013-10-22 01:14:37 -0400] gkra: bizzare no idea *what* could have been overriding it, but when I switched from "default" to "normal", it started working...
[2013-10-22 01:34:52 -0400] gkra: HAH. it was getting stomped by a different attributes file.
[2013-10-22 02:03:28 -0400] benlangfeld: Guys, I'm having trouble uploading a cookbook to the community site. Any ideas what this could be? https://gist.github.com/benlangfeld/ca8e6831e350d34ab013
[2013-10-22 02:03:45 -0400] benlangfeld: I can't find any mention of the same error from Google :(
[2013-10-22 02:05:43 -0400] estahn: hi guys .. hi have an issue with cookbooks not getting executed. when chef loads cookbooks are they getting also executed or just evaluated?
[2013-10-22 02:08:29 -0400] estahn: i specified too create zookeeper before solr because the solr receipt has a method that uses the zookeeper connection. but this method throws an exception
[2013-10-22 02:08:32 -0400] estahn: any ideas?
[2013-10-22 02:09:34 -0400] benlangfeld: estahn: Knowing the exception raised would certainly be useful, I'm sure ;)
[2013-10-22 02:09:52 -0400] estahn: DEBUG: Re-raising exception: ExhibitorError - Connection refused - connect(2)
[2013-10-22 02:10:43 -0400] estahn: http://dl.dropbox.com/u/520146/Screenshots/l0mh.png
[2013-10-22 02:11:24 -0400] estahn: the exception is thrown by discover_zookeeper i guess i need to move it to execution time somehow
[2013-10-22 02:11:33 -0400] pabst^: chef is dynamically creating my resolv.conf file... afterward, if i try and run dig, i get an error statin gthat dig cannot parse /etc/resolv.conf
[2013-10-22 02:11:55 -0400] pabst^: if I copy the contents of that file, delete the file, create a new file and paste the contents back in it works fine
[2013-10-22 02:12:01 -0400] pabst^: permissions are exactly the same
[2013-10-22 02:12:04 -0400] pabst^: any ideas?
[2013-10-22 02:13:12 -0400] benlangfeld: pabst^: Encoding?
[2013-10-22 02:14:39 -0400] pabst^: benlangfeld: im not sure, how do I tell?
[2013-10-22 02:14:47 -0400] pabst^: ive tried to dos2unix the file, just in case
[2013-10-22 02:16:58 -0400] estahn: how can i postpone the discover_zookepers method execution? so its getting executed during execution time and not compile time?
[2013-10-22 02:26:55 -0400] benlangfeld: Could anyone take a look at this ticket for me? https://tickets.opscode.com/browse/CHEF-4659 I'd really like to get this cookbook live, but right now I can't because the tools are all broken :(
[2013-10-22 02:30:01 -0400] johncolombia: hi,
[2013-10-22 02:30:32 -0400] johncolombia: I'm using the knife solo command for cooking a particular
[2013-10-22 02:30:34 -0400] johncolombia: node
[2013-10-22 02:30:54 -0400] johncolombia: for example "knife solo  cook vagrant@<some_ip>"
[2013-10-22 02:31:22 -0400] johncolombia: there is a file in the directory "nodes" named "<some_ip>.json"
[2013-10-22 02:31:32 -0400] johncolombia: which is used by the knife solo cook command
[2013-10-22 02:32:15 -0400] johncolombia: how I could use the "knife solo" command but this time instead of <some_ip> I use a role
[2013-10-22 02:32:34 -0400] johncolombia: hmmm! I make myself clear :-/
[2013-10-22 02:33:21 -0400] johncolombia: ok, roles are defined in roles directory but how I attach <some_ip> to a role
[2013-10-22 02:33:54 -0400] teukka: johncolombia: you can edit the run_list in the json file to include the role
[2013-10-22 02:34:29 -0400] johncolombia: hmm ok, I got it, thanks
[2013-10-22 03:16:53 -0400] n00bc00k: hello guys, newbie here, is there  a way where i can have a resource block execute immediately (remote_file), so that i can use the downloaded file in a ruby statement inside a recipe
[2013-10-22 03:17:17 -0400] n00bc00k: google's not helping, might get some traction here
[2013-10-22 03:21:13 -0400] silk: You can force a resource to run at compile time, rather than convergence if thats what you mean
[2013-10-22 03:21:31 -0400] silk: see: https://wiki.opscode.com/display/ChefCN/Evaluate+and+Run+Resources+at+Compile+Time
[2013-10-22 03:38:23 -0400] n00bc00k: thanks Silk!
[2013-10-22 03:38:30 -0400] n00bc00k: silk: thanks
[2013-10-22 03:38:45 -0400] silk: you're welcome
[2013-10-22 05:11:33 -0400] ckwalsh: Hey, trying to learn chef server here. Got server 11.0.8 installed, and working on setting up a workstation. The docs say I can download a knife.rb file from the webui, but I can't figure out where, as I can't find an "Organizations" page. Any help?
[2013-10-22 05:13:28 -0400] ckwalsh: Bah, never mind. I was reading the instructions for "Hosted Chef and Private Chef", not the open source chef server
[2013-10-22 05:13:31 -0400] coderanger: ckwalsh: The instructions are written for Hosted
[2013-10-22 05:13:38 -0400] coderanger: Yeah, scroll down :)
[2013-10-22 05:13:52 -0400] ckwalsh: Yup, I noticed right before your message. Thanks
[2013-10-22 05:14:05 -0400] ckwalsh: Will certainly be back with more questions :D
[2013-10-22 05:27:18 -0400] Bryan: Hello everyone
[2013-10-22 05:29:43 -0400] Guest37887: I have a quetion about during chef cookbook execution on a node, whether it can wait a recipe execution complete on another node
[2013-10-22 05:54:07 -0400] coderanger: Guest37887: Not directly
[2013-10-22 05:54:14 -0400] coderanger: Guest37887: You would have to build something that does that
[2013-10-22 05:54:41 -0400] coderanger: Guest37887: Pushy is supposed to contain systems like that, but I'm not clear what the status on that is and it likely will be enterprise-only
[2013-10-22 06:10:48 -0400] emiles: hey everyone
[2013-10-22 06:11:04 -0400] emiles: is it possible to use the vagrant vm uuid to set the node_name with chef_client in vagrant?
[2013-10-22 06:17:14 -0400] coderanger: emiles: I don't think vagrant supports that
[2013-10-22 06:19:45 -0400] emiles: coderanger: alright. sent an email to hashicorp. apparently as an owner of the vmware provider i am eligible for some basic email support..
[2013-10-22 06:20:46 -0400] coderanger: emiles: If there is a way to find the UUID inside the VM, or to get Vagrant to set the hostname or chef.node_name based on the UUID in the vagrant config then you can do it
[2013-10-22 06:23:08 -0400] emiles: well, manually setting the node name is possible inside the config, i just need a way to get the uuid. but i suspect the uuid will not be there yet at the first run :)
[2013-10-22 06:23:47 -0400] emiles: the goal is, to require no additional plugins. it should all be contained in the config.
[2013-10-22 06:24:12 -0400] emiles: i just think it's a bit weird that there is no standard way to avoid node name collisions
[2013-10-22 06:24:31 -0400] emiles: i would've thought my use case is a pretty standard one
[2013-10-22 06:31:03 -0400] coderanger: emiles: It is somewhat rare to use vagrant with a real chef server
[2013-10-22 06:31:10 -0400] coderanger: I generally stick to the chef-zero server
[2013-10-22 06:31:15 -0400] coderanger: or soon, the new local model
[2013-10-22 06:31:58 -0400] emiles: hm what is the advantage over chef solo? never heard of chef zero.
[2013-10-22 06:32:48 -0400] coderanger: zero is a minimal chef server that can directly expose your chef repo via the server API
[2013-10-22 06:33:07 -0400] emiles: coderanger: the reason i want to use chef server is because i want to minimize setup effort for new vagrant clients. just install vagrant&virtualbox, check out the project repo, vagrant up and it's ready. if i use chef solo, i need to supply all cookbooks in the project repo.
[2013-10-22 06:33:11 -0400] coderanger: chef-client local mode is built on top of that, but its only available in chef master
[2013-10-22 06:33:32 -0400] coderanger: emiles: No, with solo you can use the vagrant-berkshelf plugin
[2013-10-22 06:33:50 -0400] coderanger: It will use the local Berksfile to grab all needed cookbooks
[2013-10-22 06:34:04 -0400] emiles: yeah, but then the client needs the vagrant berkshelf plugin, it needs to be installed separately, right?
[2013-10-22 06:34:55 -0400] emiles: another reason for me to use chef server is that i can then manage the live systems with it as well.
[2013-10-22 06:34:56 -0400] coderanger: Depends on how you do it, you can bundle the plugin locally, though thats more work and makes upgrading annoying
[2013-10-22 06:36:41 -0400] emiles: i guess specifying plugin dependencies in a vagrant file would be a nice feature..
[2013-10-22 06:37:25 -0400] emiles: hm, still. if i run a chef server for live operations, i might as well use it for the devs as well..
[2013-10-22 06:37:32 -0400] coderanger: I don't see why
[2013-10-22 06:37:52 -0400] emiles: so how would you do it?
[2013-10-22 06:37:59 -0400] emiles: chef zero? hm
[2013-10-22 06:38:00 -0400] coderanger: As I said, chef-zero
[2013-10-22 06:38:04 -0400] coderanger: its a drop-in replacement
[2013-10-22 06:38:11 -0400] coderanger: You just set your server URL to localhost
[2013-10-22 06:38:24 -0400] coderanger: there is probably a vagrant plugin for it by now too
[2013-10-22 06:38:31 -0400] emiles: so you would run a chef zero server on each developer machine?
[2013-10-22 06:38:49 -0400] coderanger: Yes, its just part of the vagrant bootup process
[2013-10-22 06:39:01 -0400] coderanger: Got to run, need to pass out
[2013-10-22 06:39:04 -0400] emiles: my goal is to have graphic designers and even clients run local vagrant boxes.
[2013-10-22 06:39:09 -0400] emiles: alright thanks.
[2013-10-22 06:39:10 -0400] emiles: have fun
[2013-10-22 06:39:22 -0400] coderanger: emiles: That use case is far better addressed by something like packer
[2013-10-22 06:39:32 -0400] coderanger: where all the needed stuff is in the box image to start wtih
[2013-10-22 06:39:42 -0400] coderanger: very very different than a dev setup, but also way easier
[2013-10-22 06:39:48 -0400] coderanger: and packer makes it super easy to build :)
[2013-10-22 06:39:53 -0400] emiles: yeah but then i'd be using different technologies.. hm
[2013-10-22 06:39:56 -0400] emiles: i'll have a look at packer
[2013-10-22 06:40:06 -0400] coderanger: Yep, the use cases are just in opposition in some key areas
[2013-10-22 06:40:19 -0400] coderanger: Its ~80% overlap, but that last 20% is killer ;-)
[2013-10-22 06:40:50 -0400] emiles: coderanger: well i think i am very close to have a system that works great for what i want, except for potential node name collisions
[2013-10-22 06:44:18 -0400] emiles: packer looks pretty great
[2013-10-22 06:49:27 -0400] pabst^: Does chef do anything silly with characters?
[2013-10-22 06:49:39 -0400] pabst^: when creating a file from template?
[2013-10-22 06:52:28 -0400] edwardc: hi, my chef-solo suddenly have problem while bootstrap ... here's logo: https://gist.github.com/edwardchuang/2eed2e4ff03ea8509f05
[2013-10-22 06:54:02 -0400] s2r2: edwardc: that's knife solo, not ("only") chef-solo...
[2013-10-22 06:54:23 -0400] edwardc: s2r2: arrgh, i just notice there's permission denined error message
[2013-10-22 06:54:27 -0400] s2r2: edwardc: seems like "knife solo bootstrap" wasn't allowed to create (download) install.sh
[2013-10-22 06:54:31 -0400] edwardc: it seems my user home directory permission problem
[2013-10-22 06:54:36 -0400] edwardc: s2r2: yep ..
[2013-10-22 06:54:39 -0400] edwardc: my bad
[2013-10-22 06:54:44 -0400] s2r2: you'd probably run it as root anyways, right?
[2013-10-22 06:54:53 -0400] s2r2: (I'm not sure about knife-solo)
[2013-10-22 06:55:23 -0400] s2r2: ah, never mind, knife solo is the workstation
[2013-10-22 06:55:35 -0400] edwardc: it's worked fine after fix home directory permission
[2013-10-22 06:55:44 -0400] s2r2: SSHing into appier-user@50.18.9.147. ah, good :)
[2013-10-22 06:57:05 -0400] edwardc: s2r2: ha, i am using sudo mode, so i am running knife with regular user account
[2013-10-22 08:50:06 -0400] arussel: how does chef decide a version is 'frozen'. When doing knife cookbook upload foo, it tells me foo is frozen on version x, but I can't see anywhere where this is set.
[2013-10-22 09:01:57 -0400] s2r2: arussel: check "knife environment show", it might tell you about cookbook_versions
[2013-10-22 09:03:26 -0400] arussel: s2r2: no, I had a look already in the console, and it doesn't show anything
[2013-10-22 09:03:35 -0400] DenisK: is there a way to not allow empty attributes? I mean if not default attribute set for the recipe then throw error like puppet does?
[2013-10-22 09:03:35 -0400] arussel: (I've checked now with knife with same result)
[2013-10-22 09:04:22 -0400] arussel: DenisK: can you do that with attribute? http://docs.opscode.com/dsl_recipe_method_attribute.html
[2013-10-22 09:04:43 -0400] s2r2: DenisK: you can check that in your recipe and then just do Chef::Application.fatal! "warning."
[2013-10-22 09:05:04 -0400] DenisK: so I have to check each attribute?
[2013-10-22 09:05:21 -0400] s2r2: DenisK: http://stackoverflow.com/questions/14290397/how-do-you-abort-end-a-chef-run << pretty comprehensive answer
[2013-10-22 09:05:56 -0400] s2r2: DenisK: only those without any meaningful default?
[2013-10-22 09:07:40 -0400] arussel: DenisK: yes, this is not a flag you can put on in an attribute file.
[2013-10-22 09:08:19 -0400] DenisK: yes. puppet will throw error if it doesn't know what to put instead of variable.
[2013-10-22 09:08:55 -0400] DenisK: I mean if value for variable is unknown.
[2013-10-22 09:13:37 -0400] arussel: chef attribute manages to be basic in there functionnality but still difficult to understand :-)
[2013-10-22 09:14:37 -0400] DenisK: not so difficult. if value not set then it's empty :)
[2013-10-22 09:15:03 -0400] arussel: DenisK: try to understand how everything is merged and you'll see ...
[2013-10-22 09:15:57 -0400] DenisK: currently I have to deal with puppet... it's much more complicated then chef :D
[2013-10-22 09:16:21 -0400] arussel: good to know, I'll stay with chef :-)
[2013-10-22 09:17:25 -0400] DenisK: and this is the right choice :)
[2013-10-22 09:18:59 -0400] DenisK: I'm trying to migrate to chef from puppet. both have good and bad sides.
[2013-10-22 09:19:59 -0400] arussel: DenisK: if you ever blog about the pro and cons of both, let me know, I'll be very interested to know.
[2013-10-22 09:20:27 -0400] DenisK: I'll try
[2013-10-22 09:20:51 -0400] DenisK: what I found for the moment:
[2013-10-22 09:21:10 -0400] DenisK: 1. default attributes (see above)
[2013-10-22 09:23:19 -0400] DenisK: 2. in puppet you can define one manifest/recipe for group of hosts with same name. i.e. dbX.example.com, there X can be 1,2,3,N. Don't know how to realize same thing in chef.
[2013-10-22 09:24:28 -0400] DenisK: I guess I can create role and assign hosts to that role
[2013-10-22 09:25:31 -0400] DenisK: but in puppet you can use regexp for hosts name, i.e. /^db\d+\.example\.com$/
[2013-10-22 09:29:06 -0400] s2r2: DenisK: chef doesn''t care much about node names or host names. so assigning roles as you just mentioned is probably the way to go
[2013-10-22 09:29:23 -0400] arussel: if puppet knows about it, I'm assuming they're already under puppet control. In chef you can use http://docs.opscode.com/knife_ssh.html
[2013-10-22 09:29:40 -0400] s2r2: DenisK: there's no such thing as a "node classifier" in chef-land.  You can, however, create some tools around what is there already
[2013-10-22 09:30:04 -0400] arussel: you have a query to select nodes (based on recipe, role name ...) and the run chef-client on it (to add recipe/role)
[2013-10-22 09:30:05 -0400] DenisK: but there could be up to 80 hosts :)
[2013-10-22 09:30:22 -0400] s2r2: DenisK: it should be rather easy to parse ohai data and decide what to do according to, well, data --- number of NICs, RAM,  --- not just a tag-like hostname.
[2013-10-22 09:30:29 -0400] DenisK: thanks, I'll try this
[2013-10-22 09:30:56 -0400] s2r2: DenisK: IIRC knife-{openstack, ec2,} let's you bulk create servers
[2013-10-22 09:31:28 -0400] DenisK: we have the script which runs our instances (we use AWS) so it could be easy to assign roles at start time.
[2013-10-22 09:31:31 -0400] s2r2: DenisK: plus, you could, depending on your cloud, make use of user data (cloud init) to tell the node to a) talk to the chef-server and b) take a specified role
[2013-10-22 09:32:00 -0400] s2r2: DenisK: yes, exactly
[2013-10-22 09:32:15 -0400] arussel: DenisK: I'm use cloud formation for this. we start instances using cloudformation that install chef-client and set a role
[2013-10-22 09:32:21 -0400] s2r2: DenisK: cloud-init allows for doing that, but any homegrown script should be fine.
[2013-10-22 09:32:35 -0400] DenisK: will try that. It a little bit difficult to change mind from puppet to chef :)
[2013-10-22 09:45:07 -0400] wildfire: after knife has performed a bootstrap, should the chef-client be running continuously (in order to check in with the chef-server) ?
[2013-10-22 09:54:51 -0400] DenisK: wildfire, you launch it via cron
[2013-10-22 09:55:04 -0400] DenisK: but I prefer manual run
[2013-10-22 09:57:11 -0400] wildfire: DenisK: oh. I thought it (bootstrap) might do 'chef-client -d -s X -i Y' (i.e. daemonize, splaytime of X and interval of Y) at the end
[2013-10-22 09:58:31 -0400] DenisK: if you assign recipe 'chef-client' to the node it will
[2013-10-22 09:58:43 -0400] DonkeyScience: hey hey
[2013-10-22 09:59:31 -0400] DonkeyScience: Anyone around? I'm having trouble debugging some problems and am in a world of pain :C
[2013-10-22 10:00:59 -0400] TCMSLP: DonkeyScience: Ask your question - I'm sure someone will respond :)
[2013-10-22 10:01:51 -0400] DonkeyScience: I believe I've somehow broken my chef-repo
[2013-10-22 10:02:06 -0400] DonkeyScience: I have a cookbook checked out called 'rvm'
[2013-10-22 10:02:11 -0400] DonkeyScience: the folder is there
[2013-10-22 10:02:21 -0400] DonkeyScience: I see it on the hosted chef list of cookbooks
[2013-10-22 10:02:37 -0400] DonkeyScience: but my node comes up with the error:
[2013-10-22 10:02:37 -0400] DonkeyScience: Chef::Exceptions::RecipeNotFound -------------------------------- could not find recipe system for cookbook rvm
[2013-10-22 10:02:58 -0400] wildfire: DenisK: ahh, thanks. Wasn't aware of that cookbook
[2013-10-22 10:03:07 -0400] DonkeyScience: on the nodes chef cache, the rvm folder exists
[2013-10-22 10:03:11 -0400] DonkeyScience: so it's getting there
[2013-10-22 10:03:16 -0400] DonkeyScience: but not.. seeing it?
[2013-10-22 10:03:27 -0400] DonkeyScience: <sobs of desperation>
[2013-10-22 10:04:03 -0400] DonkeyScience: I can't figure out how best to debug this type of situation
[2013-10-22 10:04:06 -0400] DonkeyScience: any suggestions?
[2013-10-22 10:04:40 -0400] DonkeyScience: I'm listening to loads of Rush to try and make it work, but it's not helping
[2013-10-22 10:04:48 -0400] DonkeyScience: well, it's helping a bit
[2013-10-22 10:06:25 -0400] TCMSLP: I'm a chef n00b but I'd also suggest Rush.  I hope someone else can provide suitable clues...
[2013-10-22 10:07:33 -0400] shimo: which cookbook did you check out?
[2013-10-22 10:07:46 -0400] DonkeyScience: knife cookbook site install rvm
[2013-10-22 10:07:50 -0400] DonkeyScience: which leads to
[2013-10-22 10:08:06 -0400] DonkeyScience: rvm 0.0.4
[2013-10-22 10:08:09 -0400] shimo: most likely here: https://github.com/jamesotron/cookbooks/tree/master/rvm/recipes
[2013-10-22 10:08:23 -0400] shimo: which doesn't have a 'system' recipe, which is what the error is about
[2013-10-22 10:08:33 -0400] shimo: perhaps you were thinking about https://github.com/fnichol/chef-rvm/tree/master/recipes
[2013-10-22 10:09:00 -0400] daxroc: Morning all
[2013-10-22 10:09:09 -0400] DonkeyScience: OH, it's saying it can't find the recipe 'system'
[2013-10-22 10:09:28 -0400] DonkeyScience: not the 'recipe system'
[2013-10-22 10:10:17 -0400] DonkeyScience: okay could I suggest that message gets some quote marks, because that was pretty confusing stuff
[2013-10-22 10:10:23 -0400] DonkeyScience: but I can figure it out from here :>
[2013-10-22 10:12:55 -0400] DonkeyScience: <EPIC GUITAR SOLO>
[2013-10-22 10:12:57 -0400] DonkeyScience: melelelelellelelelelelele
[2013-10-22 10:13:16 -0400] DonkeyScience: http://www.youtube.com/watch?v=QnATFkU-we8
[2013-10-22 10:15:21 -0400] wildfire: I'm doing 'knife ec2 server create -N <node> ...' and occassionally I decide that I want to delete the node. At the moment I'm confused between 'knife client delete <node>' and 'knife server delete <node>' and 'knife ec2 server delete <node>' -- which should I be using to completely remove a node?
[2013-10-22 10:15:50 -0400] wildfire: I've found that occassionally I get an error like: 'Your validation client is not authorized to create the client for this node (HTTP 403).' when I attempt to create the node
[2013-10-22 10:18:24 -0400] DonkeyScience: Hey wildfire, I think the knife ec2 server create thing actually creates a physical cloud machine
[2013-10-22 10:18:36 -0400] wildfire: DonkeyScience: yes, it does - which is what I want
[2013-10-22 10:18:36 -0400] DonkeyScience: the 'node' is like a chef presence on that machine
[2013-10-22 10:18:54 -0400] DonkeyScience: but I get confused by this also
[2013-10-22 10:19:03 -0400] DonkeyScience: because there are clients too
[2013-10-22 10:19:34 -0400] wildfire: my issues is that I'd like to remove both at the same time; using manage.opscode.com, I can delete either the node definition (and not the cloud machine) or using aws console, I can delete the cloud machine (but not the node definition).
[2013-10-22 10:19:42 -0400] wildfire: I'd like to work out the right way to delete them together
[2013-10-22 10:19:53 -0400] DonkeyScience: hmm yeah not sure
[2013-10-22 10:20:04 -0400] DonkeyScience: having them separate might make sense sometimes
[2013-10-22 10:20:15 -0400] DonkeyScience: like right now I'm moving our system from Lineode to Rackspace
[2013-10-22 10:20:26 -0400] DonkeyScience: so we want the same nodes, but on new...clients?
[2013-10-22 10:20:31 -0400] DonkeyScience: or the same clients on new nodes
[2013-10-22 10:20:33 -0400] DonkeyScience: or something
[2013-10-22 10:21:08 -0400] DonkeyScience: Sorry I can't be more helpful, have you tried playing Rush while typing commands?
[2013-10-22 10:21:20 -0400] DonkeyScience: HELPS :D
[2013-10-22 10:21:24 -0400] wildfire: no, I'm unaware what Rush is.
[2013-10-22 10:21:52 -0400] DonkeyScience: http://www.youtube.com/watch?v=QnATFkU-we8
[2013-10-22 10:21:54 -0400] DonkeyScience: Boom.
[2013-10-22 10:23:17 -0400] fitzdsl_: is version "~> 5.4.21" allowed in package resource context ?
[2013-10-22 10:59:36 -0400] DonkeyScience: I'm back :D
[2013-10-22 10:59:39 -0400] DonkeyScience: with more problems
[2013-10-22 11:00:04 -0400] DonkeyScience: blank chef-repo checked out from opscode
[2013-10-22 11:00:11 -0400] DonkeyScience: knife cookbook site install rvm
[2013-10-22 11:00:12 -0400] DonkeyScience: fine
[2013-10-22 11:00:20 -0400] DonkeyScience: knife cookbook site install system
[2013-10-22 11:00:37 -0400] DonkeyScience: > #   (commit or discard the untracked or modified content in submodules) # #modified:   cookbooks/system (untracked content)
[2013-10-22 11:00:48 -0400] DonkeyScience: git add cookbooks/system
[2013-10-22 11:00:54 -0400] DonkeyScience: git commit -am "COMMIT DAMN YOU"
[2013-10-22 11:01:00 -0400] DonkeyScience: git status
[2013-10-22 11:01:13 -0400] DonkeyScience: #   (commit or discard the untracked or modified content in submodules) # #modified:   cookbooks/system (untracked content)
[2013-10-22 11:01:19 -0400] DonkeyScience: SAD. FACE
[2013-10-22 11:01:23 -0400] DonkeyScience: :C
[2013-10-22 11:02:08 -0400] DonkeyScience: any ideas as to what's going on? Knife looks like it does some scary submodule stuff that is beyond my git-fuu
[2013-10-22 11:02:11 -0400] DonkeyScience: halp.
[2013-10-22 11:02:53 -0400] s2r2: does cookbooks/system contain a ".git"?
[2013-10-22 11:04:54 -0400] DonkeyScience: it does not, but I added one and it's still unhappy
[2013-10-22 11:06:04 -0400] s2r2: what are you trying to do, btw?
[2013-10-22 11:06:45 -0400] DonkeyScience: the new rvm cookbook requires the 'system' one
[2013-10-22 11:06:49 -0400] DonkeyScience: which I can't for the life of me install
[2013-10-22 11:07:01 -0400] DonkeyScience: so I'm trying to run 'knife cookbook site install system'
[2013-10-22 11:07:03 -0400] DonkeyScience: which breaks
[2013-10-22 11:08:35 -0400] arussel: DonkeyScience: have you tried berkshelf to manage recipes ?
[2013-10-22 11:08:42 -0400] s2r2: you know berkshelf?
[2013-10-22 11:08:47 -0400] s2r2: heh
[2013-10-22 11:08:54 -0400] arussel: that might be as easy as 'berks, berks upload'
[2013-10-22 11:08:55 -0400] s2r2: librarian-chef, too.
[2013-10-22 11:09:24 -0400] DonkeyScience: I've not tried these things, nope. Just using standard KNIFE
[2013-10-22 11:09:37 -0400] DonkeyScience: with knife-git plugin thing
[2013-10-22 11:10:27 -0400] arussel: DonkeyScience: https://learnchef.opscode.com/starter-use-cases/wordpress/
[2013-10-22 11:10:47 -0400] arussel: the beginning of it explains how to use berks
[2013-10-22 11:11:22 -0400] DonkeyScience: alright cool, trying that jazz
[2013-10-22 11:11:29 -0400] DonkeyScience: THNX
[2013-10-22 11:18:53 -0400] DonkeyScience: Berks is awesome!
[2013-10-22 11:20:35 -0400] arussel: it does save a lot of pain :-)
[2013-10-22 11:30:12 -0400] arussel: there is a recipe foo, with attribute defautl["bar"] = "x". In my recipe I've got:
[2013-10-22 11:30:41 -0400] arussel: node.override["bar"] = "y" and then include_recipe "foo"
[2013-10-22 11:31:04 -0400] arussel: the recipe run with bar === "x", what am I doing wrong ?
[2013-10-22 11:33:30 -0400] wildfire: right, I think I understand. A node is (effectively) a template. And a client instantiates a template. When you do: 'knife ec2 server create -N <node>' *three* things happen: A node is registered, an ec2 instance is started. The ec2 instance is registered as a client and it instantiates the node definition.
[2013-10-22 11:33:35 -0400] wildfire: Is that roughly right?
[2013-10-22 11:34:39 -0400] arussel: yes, if you want to remove everything, you need to pass --purge to knife ec2 iirc
[2013-10-22 11:35:50 -0400] wildfire: arussel: that doesn't seem to work I've found (Chef v11.6.2), so I've been trying to understand the relationship between the various bits and pieces
[2013-10-22 11:37:14 -0400] arussel: do you terminate the instance but without deleting client and node ?
[2013-10-22 11:39:02 -0400] wildfire: arussel: I am now, but I was trying to do the --purge and knife ec2 doesn't even stop the instance (let alone remove the client / node definitions)
[2013-10-22 11:42:35 -0400] arussel: I've found that our aws needs were too complex for 'knife ec2' which just, well, do ec2 stuff, so we stopped using it.
[2013-10-22 12:04:08 -0400] fitzdsl_: in a package resource, what control do we have on version attribute ? is ~> 2.5 is supposed to work ?
[2013-10-22 12:05:45 -0400] arussel: >= is
[2013-10-22 12:06:06 -0400] arussel: probably depends on the provider
[2013-10-22 12:06:42 -0400] fitzdsl_: for instance I want to install php >= 5.4 but < 5.5. is there any way to do that ?
[2013-10-22 12:10:02 -0400] fitzdsl_: arussel: and with >= I get "Version >= 5.4 of php-cli not found" but when I do a yum info php-cli I have a php-cli package version 5.4.21 available
[2013-10-22 12:10:52 -0400] arussel: can you try with yum_package ?
[2013-10-22 12:11:42 -0400] fitzdsl_: arussel: I try
[2013-10-22 12:23:01 -0400] fitzdsl_: arussel: yum_package not working neither. I define it like version ">= #{node['php']['version']}"
[2013-10-22 12:23:27 -0400] fitzdsl_: arussel: could that be a problem of version should be integer not string or something like that ?
[2013-10-22 12:25:09 -0400] arussel: yum_package "netpbm >= 10.35.58-8.el5"
[2013-10-22 12:25:18 -0400] arussel: this comes from : http://docs.opscode.com/resource_yum.html
[2013-10-22 12:25:36 -0400] fitzdsl_: I don't use version attribute ?
[2013-10-22 12:26:13 -0400] fitzdsl_: on the doc it's the same
[2013-10-22 12:42:47 -0400] garnertb: hello all, I have a large http POST request I'd like to make from a chef recipe.  I'd like to use an erb template to generate the http message.  Is there any way to do this using only the http_request resource or will I need to generate a temporary file for the template, send the request and then delete the file?
[2013-10-22 12:47:43 -0400] Multiply: What is the best way, to keep a simply bash script running, one for each core on a given server?
[2013-10-22 12:47:47 -0400] Multiply: simple*
[2013-10-22 12:49:42 -0400] laurent\: Multiply: the best way i don't know, have you looked at taskset ?
[2013-10-22 12:53:16 -0400] daxroc: Is Ohai data available to use in a recipe, how do I access it ?
[2013-10-22 13:10:24 -0400] fitzdsl_: argh !!! package "php >= 5.0" is not equal to package "php" do \n version ">= 5.0"\n end
[2013-10-22 13:14:08 -0400] arussel: does one do 'yum install php >= 5.0" when the other do 'yum install php --version='>=5.0' ' ?
[2013-10-22 13:30:08 -0400] fitzdsl_: arussel: I don't know what command is issued but one is working and not the other
[2013-10-22 13:32:16 -0400] ocholetras: anyone knows a place where chef-client run phases are explained with detail
[2013-10-22 13:32:44 -0400] ocholetras: im interested on the part of making attribute modification on recipes and when exactly is available this modification...
[2013-10-22 13:46:52 -0400] laurent\: ocholetras: http://docs.opscode.com/essentials_nodes_chef_run.html ?
[2013-10-22 13:47:32 -0400] ocholetras: laurent\:  hehe
[2013-10-22 13:47:47 -0400] ocholetras: already saw that
[2013-10-22 13:48:11 -0400] ocholetras: Normaly i only ask after googling a lot ! ^^
[2013-10-22 13:49:17 -0400] ocholetras: anyway
[2013-10-22 13:49:23 -0400] ocholetras: aswered myself! ^^thx
[2013-10-22 13:49:28 -0400] laurent\: you want to change an attribute from a cookbook, is that it ? what's your problem ?
[2013-10-22 13:49:34 -0400] ocholetras: yea
[2013-10-22 13:49:37 -0400] ocholetras: but
[2013-10-22 13:49:41 -0400] ocholetras: more especifically
[2013-10-22 13:49:44 -0400] ocholetras: from a recipe
[2013-10-22 13:49:50 -0400] laurent\: really ?
[2013-10-22 13:49:52 -0400] laurent\: from
[2013-10-22 13:49:53 -0400] ocholetras: then you have to put that recipe before the one that uses it
[2013-10-22 13:49:53 -0400] laurent\: a
[2013-10-22 13:49:54 -0400] ocholetras: right?
[2013-10-22 13:49:57 -0400] laurent\: recipe ?
[2013-10-22 13:50:22 -0400] ocholetras: yea you can, as docs said! ^ ^
[2013-10-22 13:50:58 -0400] laurent\: i guess docs also say recipes run sequencially :)
[2013-10-22 13:51:03 -0400] ocholetras: Yea
[2013-10-22 13:51:16 -0400] ocholetras: i dont know why
[2013-10-22 13:51:38 -0400] ocholetras: but thought on something like black magic parsing all attrs and doing the deep merge, including recipes he he
[2013-10-22 13:51:51 -0400] ocholetras: ><'
[2013-10-22 13:52:09 -0400] laurent\: i guess you're having a lot of fun :)
[2013-10-22 13:52:16 -0400] ocholetras: hahaah
[2013-10-22 13:52:21 -0400] ocholetras: yEah!
[2013-10-22 13:52:23 -0400] laurent\: enjoy
[2013-10-22 13:52:28 -0400] ocholetras: but fun is over xD
[2013-10-22 13:52:41 -0400] laurent\: get something new to do then !
[2013-10-22 13:52:48 -0400] ocholetras: nah
[2013-10-22 13:52:56 -0400] ocholetras: have to design some policy
[2013-10-22 13:53:02 -0400] ocholetras: with recipes that "touchs" attrs
[2013-10-22 13:53:10 -0400] ocholetras: naming convention and order.
[2013-10-22 13:55:26 -0400] laurent\: modifying attributes from a recipe is not a good convention afaik :)
[2013-10-22 13:55:39 -0400] ocholetras: umm
[2013-10-22 13:55:40 -0400] ocholetras: so
[2013-10-22 13:55:53 -0400] ocholetras: when you need to do that
[2013-10-22 13:56:02 -0400] gchristensen: laurent\: my understanding is the opposite: make recipes which modify attributes so you can version them, instead of modifying attributes in roles.
[2013-10-22 13:56:17 -0400] ocholetras: that was the thing...
[2013-10-22 13:56:24 -0400] ocholetras: the famous gangman style xD
[2013-10-22 13:56:31 -0400] ocholetras: but, the thing with recipes is the order...
[2013-10-22 13:56:38 -0400] ocholetras: that is a pain in the ass...
[2013-10-22 13:56:41 -0400] ocholetras: -_-
[2013-10-22 13:56:52 -0400] ocholetras: i.e.
[2013-10-22 13:57:24 -0400] ocholetras: we allow ssh access (with allow_groups attribute on openssh) by addign a 3rdparty role to the node.
[2013-10-22 13:57:57 -0400] ocholetras: But have to put that role before the base_system role, wich configures all base system including ssh..
[2013-10-22 13:58:04 -0400] laurent\: gchristensen: do you mean cookbook and attribute files, do you ? i really think (s)he means recipe
[2013-10-22 13:58:14 -0400] ocholetras: he
[2013-10-22 13:58:19 -0400] ocholetras: and yea, i mean recipes
[2013-10-22 13:58:30 -0400] ocholetras: and attribute files also
[2013-10-22 13:58:42 -0400] ocholetras: because i have to "add" another group to the allowed ones..
[2013-10-22 13:58:52 -0400] ocholetras: but not by default...
[2013-10-22 13:59:00 -0400] ocholetras: so you have to modify the attribute...
[2013-10-22 13:59:04 -0400] ocholetras: role or recipe
[2013-10-22 13:59:15 -0400] ocholetras: no much more ways..
[2013-10-22 13:59:38 -0400] ocholetras: unless you create another cookbook for 1 attr modification using the defaults.rb attribute file he he
[2013-10-22 13:59:41 -0400] ocholetras: am i wrong?
[2013-10-22 14:00:18 -0400] Cope: BTW for those of you interested in the "Definitive Guide: Cancelled OMG" saga: http://www.agilesysadmin.net/chef-definitive-guide
[2013-10-22 14:01:24 -0400] ocholetras: in addition.. some stuff have much detailed docs on the old wiki than on the new docs...
[2013-10-22 14:20:45 -0400] countdigi: Cope: read your post - completely understand - its such a moving target - so i bought the first addition and just spent a half hour looking through 2nd ed on safari - ill take a closer look over the weekend - appreciate the work!
[2013-10-22 14:21:09 -0400] countdigi: s/add/ed/ :-)
[2013-10-22 14:21:34 -0400] ichilton: No way...
[2013-10-22 14:22:05 -0400] ichilton: Ran chef-client on all nodes using knife ssh and it's gone crazy and installed sensu server with rabbitmq on all of my nodes :(
[2013-10-22 14:24:43 -0400] cpuguy83: ichilton: ruh-roh
[2013-10-22 14:25:14 -0400] gchristensen: ichilton: ahh nice ... chef can be a wonderful entropy engine :)
[2013-10-22 14:28:01 -0400] ichilton: :(
[2013-10-22 14:28:31 -0400] ichilton: Really don't understand why - it looks like it's just gone on a bender and started running recipes or roles it shouldn't have :(
[2013-10-22 14:32:32 -0400] cpuguy83: ichilton: Aaah, the old "bug in the compiler" syndrome :)
[2013-10-22 14:33:51 -0400] s2r2: ichilton: try to figure out what was the reason for what happened things like this hinder confidence...
[2013-10-22 14:45:43 -0400] pwelch: anyone have issues using guard and strainer?
[2013-10-22 14:45:55 -0400] ichilton: jtimberman: around?
[2013-10-22 14:52:41 -0400] azret: has anyone figured out how to get the database cookbook to work when using mysql::percona ? I know the problem, but changing it breaks installs for other things, its because the cookbook requires mysql::ruby, which requires mysql::server
[2013-10-22 14:53:29 -0400] cwarner: Is there anyway beyond forking a plugin to add a "sub" plugin to a plugin?
[2013-10-22 14:54:42 -0400] mondo: how do I output something to the chef-client console?  puts doesn't seem to work
[2013-10-22 14:55:46 -0400] cwarner: so for instance I'm using knife-spork and created a quick email plugin for promoted cookbooks, the only problem now is there is no place to really PUT that plugin in the main knifespork gem
[2013-10-22 14:55:50 -0400] tcate: mondo: you're going to want to use chefLog
[2013-10-22 14:56:07 -0400] stormerider: mondo: Chef::Log,info("blah")
[2013-10-22 14:56:18 -0400] stormerider: s/,/./
[2013-10-22 14:56:30 -0400] cwarner: so it's like I have to fork knifespork and add the email plugin into the plugins directory
[2013-10-22 14:56:32 -0400] Glace: Hi, is there a way to fix the UI behavior.. that when you edit a node run_list it resets the environment to _default?
[2013-10-22 14:56:40 -0400] cwarner: it just seems like a waste
[2013-10-22 14:56:42 -0400] mondo: tcate, stormerider thanks!
[2013-10-22 14:57:50 -0400] cwarner: so I was thinking that the main chef-repo should probably get a /plugins/pluginname/config and /plugins/pluginname/actually sub plugs
[2013-10-22 14:59:33 -0400] Cope: pwelch: <broken_record> Are you conducting a survey? Do *you* have a problem? What is it? Maybe we can help! Conducting market research is just noise. </broken_record>
[2013-10-22 15:00:29 -0400] Cope: pwelch: as it happens I'm going to be looking at guard and strainer (again) very soon, so it's topical, and I have done it fairly recently, so may have relevant experience.
[2013-10-22 15:00:32 -0400] pwelch: Cope, it was more of a "is it known this doesnt work" question. It turns out using the guard-strainer gem was breaking. Instead I am just doing "run strainer"
[2013-10-22 15:01:32 -0400] Cope: is there a bug for guard-strainer?
[2013-10-22 15:01:53 -0400] CPS: i have a recipe that installs a program. the program has a soft dependency on another program (it will install without it being present but not run properly). I'd like to make a recipe to install the dependency if it isn't installed. how would i go about that?
[2013-10-22 15:02:13 -0400] bcave: CPS: include_recipe
[2013-10-22 15:02:29 -0400] Cope: bcave: I'mnot sure thays what CPS means
[2013-10-22 15:03:10 -0400] Cope: CPS: so program A need program B, but will install without it, but not work?
[2013-10-22 15:03:42 -0400] CPS: program X uses program Y. program X will install fine if program Y is not installed but will not run correctly. in the install recipe for program X i want to also install program Y if it isn't already installed.
[2013-10-22 15:06:07 -0400] Cope: CPS: just put them in order
[2013-10-22 15:06:15 -0400] Cope: and let idempotence happen
[2013-10-22 15:07:20 -0400] CPS: Cope: the issue is that program X is updated frequently and will be removed and reinstalled regularly. program Y does not and will really only be installed once
[2013-10-22 15:11:25 -0400] dgarstang2: *sigh* berks upload ~/.berkshelf/config-us4.json -VV ... nada.... bupkiss. y?
[2013-10-22 15:13:09 -0400] stormerider: CPS: but if you say install Y, install X, assuming you're using something like packages, then idempotence will handle that
[2013-10-22 15:15:05 -0400] CPS: i guess that works
[2013-10-22 15:16:35 -0400] bean: dgarstang2: are you trying to specify a different config?
[2013-10-22 15:16:50 -0400] bean: its berks -c /path/to/config
[2013-10-22 15:23:05 -0400] dgarstang2: bean: Yes. I was. Seems like it's not honoring -c. I see old bugs on this. I had two versions of berkshelf installed. I removed the older one. Sorta works now. Ah gems, what an abomination. NOW, it's just plain hanging
[2013-10-22 15:23:26 -0400] dgarstang2: of course, the chef logs are totally useless
[2013-10-22 15:23:54 -0400] bean: dgarstang2: in the command you posted ^^ you don't have a -C
[2013-10-22 15:23:55 -0400] bean: er
[2013-10-22 15:23:57 -0400] bean: -c*
[2013-10-22 15:24:12 -0400] dgarstang2: bean: typo. :)
[2013-10-22 15:24:23 -0400] bean: it probably helps to copy paste ;)
[2013-10-22 15:24:39 -0400] dgarstang2: Now a 'berks upload -c ~/.berkshelf/config-us4.json' gets me as far as 'Uploading bc-role (0.15.0) to: 'https://10.37.161.208:443/'' and then it just hangs
[2013-10-22 15:24:54 -0400] dgarstang2: I can connect to that IP on port 443
[2013-10-22 15:25:01 -0400] bean: that was my next question :P
[2013-10-22 15:25:15 -0400] dgarstang2: happening from two different clients
[2013-10-22 15:25:30 -0400] bean: and the server log is p useless?
[2013-10-22 15:25:57 -0400] dgarstang2: bean: well, which log? There's several and none seem to be relevant
[2013-10-22 15:26:14 -0400] dgarstang2: I see this with debug... "request env: {:method=>:get, :body=>"{\"error\":[\"Cannot find a cookbook named bc-role with version 0.15.0\"]}"" ?!
[2013-10-22 15:26:16 -0400] bean: I'm still on a slightly older chef server.
[2013-10-22 15:26:21 -0400] bean: hmm
[2013-10-22 15:26:27 -0400] dgarstang2: duh.
[2013-10-22 15:26:36 -0400] dgarstang2: maybe that's normal
[2013-10-22 15:26:37 -0400] s2r2: ichilton: found it?
[2013-10-22 15:26:51 -0400] dgarstang2: Last thing is '==> performing authenticated Chef request as 'doug''
[2013-10-22 15:27:05 -0400] dgarstang2: request env: {:method=>:post, :body=>"{\"checksums\":{\"03 and then NADA
[2013-10-22 15:27:50 -0400] bean: odd
[2013-10-22 15:28:09 -0400] bean: if that exists on your version
[2013-10-22 15:28:21 -0400] dgarstang2: bean: nope.
[2013-10-22 15:28:32 -0400] bean: bah, i'm less than helpful then
[2013-10-22 15:28:33 -0400] dgarstang2: bean: every app has it's own log file, which makes it hard to kind see what's going on
[2013-10-22 15:28:41 -0400] dgarstang2: bean: also seems like most have debug turned way down
[2013-10-22 15:29:00 -0400] dgarstang2: bean: the bookshelf one for example, has nothing except a few lines when it was started up
[2013-10-22 15:29:14 -0400] bean: alright.
[2013-10-22 15:29:33 -0400] dgarstang2: Running tcpdump on chef server. It's getting the traffic from the client and choosing not to respond. *sigh*
[2013-10-22 15:29:55 -0400] Glace: Hi, is there a way to fix the UI behavior.. that when you edit a node run_list it resets the environment to _default?
[2013-10-22 15:30:00 -0400] dgarstang2: repeated "IP chefs01.us4.foo.net.https > 10.48.244.112.55598:" and noting. FFS
[2013-10-22 15:30:04 -0400] Glace: I run chef server 11
[2013-10-22 15:30:55 -0400] bean: dgarstang2: you could record that into a file and load it up in wireshark and try to figure out what's happening
[2013-10-22 15:31:38 -0400] dgarstang2: bean: i think it's pretty clear. The server isn't responding. The traffic is all incoming. No reply.
[2013-10-22 15:31:54 -0400] bean: hmm
[2013-10-22 15:31:58 -0400] dgarstang2: bean: sides, it's https
[2013-10-22 15:31:58 -0400] bean: restart the server maybe?
[2013-10-22 15:32:06 -0400] dgarstang2: already done that
[2013-10-22 15:32:19 -0400] dgarstang2: reinstall I guess
[2013-10-22 15:32:27 -0400] dgarstang2: not a good user experience
[2013-10-22 15:32:55 -0400] dgarstang2: bean: thanks for trying
[2013-10-22 15:45:24 -0400] bcave: is there a way to get chef client to retry on failure?
[2013-10-22 15:46:10 -0400] bcave: I get random failures, due to network for example, where chef client will fail while trying to sync cookbooks for example, and a simple retry will often fix
[2013-10-22 15:49:01 -0400] bcave: (i mean globally, not localized to a resource)
[2013-10-22 15:55:14 -0400] azret: is there a way to get the git provider in chef to not whine about host key verification on a host without editing the ssh config?
[2013-10-22 15:57:10 -0400] cwj: azret: drop off a wrapper script for git which disables host key checking, then provide the path to that script as the value of the git resources ssh_wrapper parameter
[2013-10-22 15:57:33 -0400] cwj: azret: i wrote http://cookbooks.opscode.com/cookbooks/deploy_wrapper to make that a little less repetitive
[2013-10-22 15:59:01 -0400] azret: thanks, i feel like that little feature should be added as a default, would make our lives a little easy
[2013-10-22 16:09:16 -0400] otakup0pe: hey so question about using node.override in a recipe
[2013-10-22 16:09:30 -0400] otakup0pe: the documentation seems to claim that such instances are interpreted prior to the recipe actually being run
[2013-10-22 16:09:34 -0400] otakup0pe: but that is not what we are seeing in practice
[2013-10-22 16:09:39 -0400] otakup0pe: are we doing it wrong or is the documentation wrong
[2013-10-22 16:10:02 -0400] gchristensen: otakup0pe: you may need to use lazy attribute evaluation
[2013-10-22 16:10:11 -0400] otakup0pe: when reading the attribute ?
[2013-10-22 16:10:18 -0400] gchristensen: yeah
[2013-10-22 16:10:42 -0400] otakup0pe: so what i'm hearing is the opscode documentation is wrong
[2013-10-22 16:12:37 -0400] otakup0pe: i'm going to refactor to not use override it hink
[2013-10-22 16:15:36 -0400] pcn: otakup0pe: normally the interpretation depends more on whether the node.override is declared in the context of the receipe, in which case it should be evaluated during compile time.
[2013-10-22 16:15:59 -0400] otakup0pe: i'm moving it to an attribute file so this will be a non issue
[2013-10-22 16:16:12 -0400] otakup0pe: well less of one anyway heh
[2013-10-22 16:16:16 -0400] pcn: Which documentation are you seeing that says the interpretation is done prior to the receipe being run?
[2013-10-22 16:16:44 -0400] otakup0pe: http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence item 11
[2013-10-22 16:17:10 -0400] otakup0pe: but what we see is node.override only works if the recipe that requires the attribute comes after the node.override
[2013-10-22 16:17:16 -0400] otakup0pe: sorry i meant item 10
[2013-10-22 16:21:45 -0400] daos: I recently upgraded Chef Server 10 to Chef Server 11 and am getting some errors when running `service chef-client restart` on new nodes. Basically, the run dies around some of my execute resources and the stacktrace doesn't point to any particular error in the recipe. Instead, I get the following error: Chef::Exceptions::ChildConvergeError. I can also paste the full output from the stacktrace in a pastebin. I'm wondering if there are none problems ...
[2013-10-22 16:21:51 -0400] daos: ... between Chef Server 10 and Chef Server 11 when it comes to execute resources.
[2013-10-22 16:22:12 -0400] daos: s/none/known/g
[2013-10-22 16:24:09 -0400] pcn: opscode folks - I can see attributes in the web console for a node that I can't see via "knife node show -V -Fj <node name>"
[2013-10-22 16:24:13 -0400] pcn: What's the story there?
[2013-10-22 16:28:07 -0400] fak3r: pcn: so `knife node list` shows your node name?
[2013-10-22 16:28:18 -0400] cwj: pcn: i am not an opscodian, but add -l to your command
[2013-10-22 16:30:01 -0400] pcn: otakup0pe: that page is referring to precedence, not ordering.  Usually order will happen based on the recipes being compiled, and some things happen in the compile phase, and some in the run/convergence phase, and order comes from that
[2013-10-22 16:30:07 -0400] pcn: cwj thanks that's probably what I need
[2013-10-22 16:31:56 -0400] pcn: Yeah, that's it.  Can you remind me what criteria knife/the server use when filtering out data?
[2013-10-22 16:32:31 -0400] chip-: pcn: The 'knife node show' command will give you the (9? I think?) most interesting attributes from a Chef point of view. If you want to see ALL attributes, use the -l flag.
[2013-10-22 16:32:52 -0400] chip-: If you want to see a single attribute, use the -a command. knife node show mynode -a cpu
[2013-10-22 16:33:04 -0400] pcn: chip- thanks.  That is extremely frustrating to remember.  If I use e.g. -Fj I want everything.
[2013-10-22 16:33:46 -0400] chip-: or -a cpu.total
[2013-10-22 16:33:47 -0400] chip-: or the like
[2013-10-22 16:34:23 -0400] pcn: Hmm... edit doesn't seem to provide everything for editing, either.
[2013-10-22 16:34:26 -0400] chip-: If you want to see multiple nodes and a particular attribute, you can also do "knife search node 'role:web server' -a cpu"
[2013-10-22 16:34:39 -0400] chip-: You probably don't want to run knife node edit, imho
[2013-10-22 16:34:49 -0400] chip-: Unless you're modifying chef_environment
[2013-10-22 16:34:57 -0400] gchristensen: knife-flip ftw
[2013-10-22 16:34:59 -0400] chip-: knife node run_list for setting run lists.
[2013-10-22 16:35:13 -0400] pcn: Oh, I do.  I need to expunge some node vars.
[2013-10-22 16:35:22 -0400] chip-: Gotcha.
[2013-10-22 16:38:54 -0400] fak3r: I have a remote .deb I need to install via a recipe, it's not in apt, looking for a remote_file example recipe
[2013-10-22 16:38:57 -0400] allaire: what's the standard naming  when creating a git repo of a new cookbook? chef-redis? redis-cookbook? cookbook-redis?
[2013-10-22 16:39:29 -0400] allaire: because only naming it redis is kind of confusing (if not under a dedicated github account with only chef cookbooks)
[2013-10-22 16:39:54 -0400] stormerider: allaire: ive seen variations of all of those
[2013-10-22 16:40:16 -0400] allaire: gotcha
[2013-10-22 16:40:16 -0400] stormerider: the metadata name is more important than the repo name
[2013-10-22 16:41:58 -0400] allaire: stormerider: in my berksfile, should I use the metadata name when referring to a github repo? somehting like: cookbook 'monit', git: 'https://github.com/phlipper/chef-monit.git'
[2013-10-22 16:42:14 -0400] allaire: or I should use cookbook 'chef-monit', ...
[2013-10-22 16:42:25 -0400] stormerider: cookbook 'monit'
[2013-10-22 16:42:26 -0400] teukka: allaire: no, use the metadata name
[2013-10-22 16:42:37 -0400] pcn: Aha, looks like edit is doing what I need.  Don't know why I thought it wasn't.
[2013-10-22 16:42:56 -0400] allaire: teukka: so I should always look it up first in the metadata.rb before adding it in my berksfile :)
[2013-10-22 16:43:13 -0400] teukka: allaire: berkshelf also supports a shotcut for github repos: cookbook 'monit', github: 'phlipper/chef-monit'
[2013-10-22 16:44:01 -0400] teukka: allaire: you still need to check the name yourself. you need it for run_list and metadata dependencies anyway
[2013-10-22 16:44:16 -0400] allaire: perfect!
[2013-10-22 17:13:15 -0400] gchristensen: does anyone partition their disks from chef? that seems risky / silly to me, when it could be implemented in the kickstart.
[2013-10-22 17:14:36 -0400] daos: gchristensen: i do it
[2013-10-22 17:14:42 -0400] daos: on ec2 though
[2013-10-22 17:14:47 -0400] alexbst_: gchristensen - lol, well, I've put up a filesystems cookbook to do the mkfs bit :-)
[2013-10-22 17:14:49 -0400] daos: so i RAID the ephemeral storage thorugh chef
[2013-10-22 17:16:09 -0400] gchristensen: hrmm... I suppose this is a bit fringe in the terms of configuration management :P is there a good argument against doing it with chef vs. doing it with a kickstart? still automated, still standardized
[2013-10-22 17:16:50 -0400] gchristensen: btw, this is all with bare metal machines
[2013-10-22 17:17:03 -0400] gchristensen: which changes things (I don't think you can preeseed on AWS etc )
[2013-10-22 17:17:13 -0400] alexbst_: the OS obviously needs to mkfs the base os's partitions
[2013-10-22 17:17:22 -0400] gchristensen: oh for sure
[2013-10-22 17:18:00 -0400] alexbst_: I've just put that cookbook live, to do the rest.
[2013-10-22 17:18:45 -0400] gchristensen: alexbst_: do you use that cookbook on dedicated hardware, or in a cloud provider?
[2013-10-22 17:18:47 -0400] alexbst_: I like cookbooks that do as little as possible - the ebs cookbook tries to do raid, the volumes cookbook tries to do lvm, I wanted a cookbook that just did filesystems.
[2013-10-22 17:18:49 -0400] alexbst_: cloud
[2013-10-22 17:18:53 -0400] alexbst_: but it could work elsewhere
[2013-10-22 17:18:55 -0400] gchristensen: yeah
[2013-10-22 17:19:23 -0400] alexbst_: I've 'collated' (sourced components for) an ephemeral_raid cookbook, too.
[2013-10-22 17:19:36 -0400] alexbst_: doesn't make a filesystem.
[2013-10-22 17:19:59 -0400] gchristensen: I think it might be a bit different (thinking out loud) since I can't guarantee all my machines have identical disks etc, given that my providers give me equivalent-or-better hardware
[2013-10-22 17:20:29 -0400] alexbst_: the nicest thing I can say about that is that the ephemeral raid cookbook looks for devices determined to be ephemeral by ohai :-)
[2013-10-22 17:20:32 -0400] alexbst_: under the filesystem key
[2013-10-22 17:20:44 -0400] alexbst_: no, under the cloud key I think
[2013-10-22 17:21:00 -0400] gchristensen: alright, I'm going to do this with my preseed :)
[2013-10-22 17:22:05 -0400] alexbst_: https://github.com/atrullmdsol/filesystems-cookbook <- in case you're curious.
[2013-10-22 17:23:00 -0400] alexbst_: I want to put the ephemeral raid cookbook public, too - it's a combo of librato and rightscale stuff ;)
[2013-10-22 17:23:46 -0400] dgarstang2: I have chef server 11.0.8-1 installed ... I'd like to install the same version another box, but that particular version doesn't appear in the list of versions available on the opscode web site. :(
[2013-10-22 17:26:06 -0400] dgarstang2: you can have any version you want, as long as it's not 11.0.8-1
[2013-10-22 17:26:36 -0400] jbz: 11.0.8-1 sounds like a prerelease version
[2013-10-22 17:26:37 -0400] jbz: ?
[2013-10-22 17:27:48 -0400] dgarstang2: jbz: dunno
[2013-10-22 17:46:22 -0400] gchristensen: so is the ifconfig resoure redhat only? or does it work on Ubuntu andDebian as well?
[2013-10-22 17:48:04 -0400] jtimberman: gchristensen: i see a debian provider for ifconfig... https://github.com/opscode/chef/blob/master/lib/chef/provider/ifconfig/debian.rb
[2013-10-22 17:48:34 -0400] gchristensen: yeah that was a dumb question. it looks like hte docs suggest its redhat only - "Currently, this provider only writes out a start-up configuration file for the interface on Red Hat-based platforms" http://docs.opscode.com/resource_ifconfig.html
[2013-10-22 17:56:19 -0400] jtimberman: gchristensen: the docs might not have been updated, looks like that was added w/ CHEF-3029...
[2013-10-22 17:59:07 -0400] ivanacostarubio: Hi! I updated Chef from 10.16.2 to 11.6.2, but running chef-solo is giving me the error: "Chef::Exceptions::CookbookNotFound: Cookbook dmg not found. If you're loading dmg from another cookbook, make sure you configure the dependency in your metadata" any idea why?
[2013-10-22 18:01:48 -0400] mveitas: I am looking to override a template from a cookbook and using this  syntax: nginx_kibana_conf_template = resources('template[/etc/nginx/sites-available/kibana]')
[2013-10-22 18:02:11 -0400] mveitas: is there a way to be able to override the variables or merge in my own variables
[2013-10-22 18:02:31 -0400] gchristensen: jtimberman: this resource could use extra work :) thank you for pointing it out, I'll file a few issues against it.
[2013-10-22 18:06:41 -0400] gsymons-di1: Hey all, I have a test-kitchen question... is there an easy way to add cookbooks that are only for testing? I need to write a recipe to exercise my resource provider, but I don't want that recipe to exist in the cookbook under test.
[2013-10-22 18:07:18 -0400] douglaswth: you can use berkshelf and have that in a testing or integration group
[2013-10-22 18:07:58 -0400] douglaswth: a common practice is to have a "fake" cookbook under the test/cookbooks directory that gets included by path in the Berksfile
[2013-10-22 18:08:06 -0400] gsymons-di1: Duh. that makes sense. I was coming at it from the wrong direction.
[2013-10-22 18:08:33 -0400] gsymons-di1: I was trying to figure out how to add another cookbook directory to the provisioner configuration:) Thanks.
[2013-10-22 18:27:59 -0400] gsymons-di: Another test-kitchen question... anybody have any tips on testing that resource provider is idempotent?
[2013-10-22 18:29:57 -0400] gsymons-di: In this case, I've got chefspec tests that show that my resource provider is idempotent given all the resources it uses are idempotent, but I want to check that it really is.
[2013-10-22 18:46:35 -0400] mondo: what's everyone using to manage ssh keys?
[2013-10-22 18:46:53 -0400] mondo: for example I have a bunch of jboss servers and a group of users who should have access to all of them via ssh keys
[2013-10-22 18:47:09 -0400] gsymons-di: we're using the community users cookbook.
[2013-10-22 18:48:03 -0400] mondo: this one? https://github.com/fnichol/chef-user
[2013-10-22 18:48:07 -0400] otakup0pe: same. all user junk in a data bag.
[2013-10-22 18:49:12 -0400] mondo: nm, this one probably https://github.com/opscode-cookbooks/users
[2013-10-22 18:50:11 -0400] gsymons-di: That's the one I was talking about...
[2013-10-22 18:50:31 -0400] mondo: yes I figured :)
[2013-10-22 19:05:26 -0400] iverson0881: hi, i'm trying to create a comma separated list of host names i get from the result of a chef search
[2013-10-22 19:05:47 -0400] iverson0881: however i seem to be getting node[node1.something.com],node[node2.something.com]
[2013-10-22 19:05:57 -0400] iverson0881: vs just node1.something.com,node2.something.com etc
[2013-10-22 19:20:47 -0400] jmickle: sensu rocks.....
[2013-10-22 19:27:52 -0400] glen: how do i check that json is not [] but {} ?
[2013-10-22 19:28:13 -0400] glen: like i get some input data from serialized form, and when element is empty it's serialised as foo:[] instead of foo:{}
[2013-10-22 19:28:21 -0400] glen: so how do i check it nicely?
[2013-10-22 19:28:37 -0400] glen: i have such check initially:     if !json.empty? && json['hosts'].has_key?(host_name) then
[2013-10-22 19:29:05 -0400] glen: but that json['hosts'] is being [] (array), so i get errors like: undefined method `has_key?' for []:Array
[2013-10-22 19:29:35 -0400] glen: json={hosts:[]} <- input data (ruby eval)
[2013-10-22 19:32:15 -0400] glen:     if !json.empty? && !json['hosts'].empty? && json[:hosts].has_key?(host_name) then
[2013-10-22 19:32:18 -0400] glen: too long?
[2013-10-22 19:42:48 -0400] ponyofdeath: cookbook_file "/etc/ssl/#{ssl_cert}" do anyone can help me with why this does not work?
[2013-10-22 19:42:53 -0400] ponyofdeath: Error executing action `create` on resource 'cookbook_file[/etc/ssl/]'
[2013-10-22 19:43:30 -0400] mondo: Ok I got a good handle on the users cookbook and how to use that to manage groups of users who need access to groups of servers
[2013-10-22 19:44:09 -0400] mondo: What's the best way to use the users cookbook to manage single users who need access to single systems?
[2013-10-22 19:44:32 -0400] mondo: should I create a recipe for each user and add them to servers as needed?
[2013-10-22 19:45:25 -0400] chris613: ponyofdeath: Judging from that output, ssl_cert is not defined, or is set to an empty string
[2013-10-22 19:47:10 -0400] gchristensen: mondo: I created a cookbook which takes a databag of users and keys which have hostnames in the databag, and then the recipe adds the keys and users to the machines it matches
[2013-10-22 19:47:35 -0400] ponyofdeath: chris613: ssl_cert = node['webcahce']['ssl_cert']
[2013-10-22 19:47:38 -0400] ponyofdeath: is what I have
[2013-10-22 19:47:44 -0400] ponyofdeath: and in attributes it is defined
[2013-10-22 19:48:14 -0400] daos: is there a trick or catch with notifying execute resources with chef server 11? i'm getting a  lot of exceptions raised when running through my recipes
[2013-10-22 19:48:45 -0400] mondo: gchristensen, that's pretty clever.  So each user has an array of hostnames?
[2013-10-22 19:48:54 -0400] chris613: ponyofdeath: s/webcahce/webcache/ ?
[2013-10-22 19:49:18 -0400] ponyofdeath: chris613: omg
[2013-10-22 19:49:20 -0400] ponyofdeath: chris613: thanks!
[2013-10-22 19:49:20 -0400] ponyofdeath: lol
[2013-10-22 19:49:26 -0400] ponyofdeath: need to take a break
[2013-10-22 19:49:30 -0400] chris613: hehe
[2013-10-22 19:49:49 -0400] daos: the aforementioned recipes run fine with chef server 10
[2013-10-22 19:49:57 -0400] daos: no exceptions
[2013-10-22 19:51:38 -0400] glen: i have problem, my bash resource locks up ruby into some mutexes
[2013-10-22 19:52:44 -0400] glen: # ruby -v
[2013-10-22 19:52:45 -0400] glen: ruby 1.9.3p448 (2013-06-27) [i686-linux]
[2013-10-22 19:57:23 -0400] glen: vhttp://sprunge.us/Xfgi < simple as that
[2013-10-22 19:58:26 -0400] glen: and i have to kill with -11 signal
[2013-10-22 19:58:34 -0400] glen: plain sigterm does not kill
[2013-10-22 19:58:42 -0400] gchristensen: mondo: yeah that is what I do
[2013-10-22 20:00:52 -0400] glen: here's some more debug, where's seen that tmp file to be executed IS created and trace when i press ctlr+c: http://sprunge.us/dTdW
[2013-10-22 20:02:17 -0400] glen: oh. wtf. if i remove "user root" it starts to work!
[2013-10-22 20:11:30 -0400] cpuguy83: In chef-shell client mode I've set a node attr.  How do I push that up to the server?
[2013-10-22 20:14:36 -0400] Tuatara: Hi... I am trying to get some good information / resources on using Roles... anyone able to share some insight on how best to leverage them?
[2013-10-22 20:16:15 -0400] mveitas: Tuatara: I only use roles as a marker. I use a wrapper cookbook to act as a role so I can properly version them
[2013-10-22 20:17:35 -0400] Tuatara: mveitas: I have read a couple articles about doing it that way. I haven't seen any docs on how opscode was expecting users to leverage roles. Any specific reason why you took that approach or was versioning the main concern?
[2013-10-22 20:17:58 -0400] gchristensen: jtimberman: here we go, the ifconfig extensions is technically functional, but without `route` to add the gateway information (the ifconfig resource doens't accept route info) it isn't really complete.
[2013-10-22 20:19:24 -0400] mveitas: Tuatara: versioning was the main concern.  I think the community is split. Some people love roles and others hate them.  Rumor has it roles might be versioned in a future release of Chef
[2013-10-22 20:23:32 -0400] glen: i hate those backwards logics of not_if ... it's so brainfuck to make up the conditions
[2013-10-22 20:23:43 -0400] glen: like i want script to run when /etc/mtab is empty or missing
[2013-10-22 20:24:18 -0400] glen: i can pass it with one condition, file exists:  not_if { ::File.file?(motdfile)  }
[2013-10-22 20:24:25 -0400] glen: but when the second one comes, my brain farts
[2013-10-22 20:24:31 -0400] glen: not_if { ::File.file?(motdfile) || !::File.zero?(motdfile) }
[2013-10-22 20:24:37 -0400] glen: not_if { ::File.file?(motdfile) && !::File.zero?(motdfile) }
[2013-10-22 20:24:50 -0400] glen: still fail. not doing it right
[2013-10-22 20:26:22 -0400] gchristensen: glen: use ony_if?
[2013-10-22 20:26:40 -0400] glen: oh
[2013-10-22 20:26:46 -0400] gchristensen: only_if*
[2013-10-22 20:27:05 -0400] glen:     only_if { !::File.file?(motdfile) || ::File.zero?(motdfile) }
[2013-10-22 20:27:08 -0400] glen: lets do testing
[2013-10-22 20:27:26 -0400] glen: now there's another case if it is symlink to empty file
[2013-10-22 20:27:37 -0400] glen: in that case it should not run either
[2013-10-22 20:28:39 -0400] glen: currently that one fails as file.zero checks symlink target size not symlink size
[2013-10-22 20:29:07 -0400] glen: so that .zero must be acoompanied with ISREGULARFILE check
[2013-10-22 20:29:40 -0400] glen: how do i check for regular file?
[2013-10-22 20:30:04 -0400] glen: ah, .file?
[2013-10-22 20:30:31 -0400] glen:     only_if { !::File.file?(motdfile) || (::File.file?(motdfile) && ::File.zero?(motdfile)) }
[2013-10-22 20:30:35 -0400] glen: can this be simplified?
[2013-10-22 20:40:25 -0400] glen: ok. .file? and .exists? both return true on symlink, so that's not real way to check if file is not symlink (is regular file)
[2013-10-22 20:53:28 -0400] josh_gough: I am trying to upload roles with knife, but it's not doing anything. I've tried knife upload   and knife upload .  and even *
[2013-10-22 20:53:33 -0400] josh_gough: any tips?
[2013-10-22 20:54:00 -0400] paulczar: anyone here succeeding in getting Vagabond to work ?
[2013-10-22 20:56:54 -0400] mveitas: I am trying to run a search:   es_nodes = search(:node, 'role:log_elasticsearch_server AND environment:#{node.chef_environment}')   and getting back a 400 error
[2013-10-22 20:57:48 -0400] miah: ' vs "
[2013-10-22 20:58:01 -0400] miah: you are passing a interpolated string (#{node.chef_environment})
[2013-10-22 20:58:15 -0400] miah: ruby will pass _exactly_ #{node.chef_environment} if you ''
[2013-10-22 20:58:31 -0400] miah: but if you " it will pass what that resolves to, eg '_default'
[2013-10-22 20:59:05 -0400] joseph_: Hello!  Is there any way to get the resource name within the block in a recipe?  ex: file "myfile" do .... only_if {resource.name == "notmyfile"} end
[2013-10-22 21:06:09 -0400] crombar: does anyone have a few minutes to help me out with a few issues I am having trying to write a wrapper cookbook to install java using Berkshelf and Vagrant?
[2013-10-22 21:06:17 -0400] redondos: knife.rb points to the correct client.pem yet I am getting this error when running chef-client: [2013-10-22T21:03:12+00:00] ERROR: Server returned error for https://10.33.8.66/nodes/chef-os-1, retrying 1/5 in 3s
[2013-10-22 21:06:54 -0400] redondos: crombar: pastebin your recipe and we might
[2013-10-22 21:10:27 -0400] crombar: redondos: before taking that step: The documentation states "override the node['java']['install_flavor'] attribute with in role". Where would that go in my wrapper cookbook? I don't think I have a role within a wrapper cookbook.
[2013-10-22 21:12:01 -0400] tcate: crombar: I usually set that in the default.rb of the wrapper cookbook. Something along the lines of node.set['java']['install_flavor'] = "blarg"
[2013-10-22 21:15:01 -0400] josh_gough: i found i had to do role from file
[2013-10-22 21:15:04 -0400] josh_gough: that made it work
[2013-10-22 21:15:26 -0400] crombar: ok thanks. That is my recipe: http://pastebin.com/AkV1wKuF It effectively does nothing - no errors - so I guess I am missing something really obvious
[2013-10-22 21:21:58 -0400] tcate: crombar: your node attribute is the issue, try node.default['java']...
[2013-10-22 21:22:52 -0400] crombar: tcate: you mean like this? node.default['java']['oracle']['accept_oracle_download_terms'] = true
[2013-10-22 21:23:02 -0400] tcate: you can verify by looking at the actual node attribs and seeing if that's still false
[2013-10-22 21:25:10 -0400] tcate: yeah, though looking the through the docs just doing node may work
[2013-10-22 21:25:23 -0400] tcate: are you including the java cookbook anywhere?
[2013-10-22 21:25:34 -0400] tcate: with include_recipe for example
[2013-10-22 21:26:23 -0400] crombar: tcate: that unfortunately didn't change anything. I am including the java cookbook in metadata.rb like this: 'depends "java"'
[2013-10-22 21:28:27 -0400] crombar: tcate: I also tried adding 'include_recipe java' to my recipe, but there still is nothing.
[2013-10-22 21:29:06 -0400] tcate: crombar: that should do the default java install, which may not be what you want
[2013-10-22 21:29:35 -0400] tcate: is there a higher version of your cookbook on the chef server?
[2013-10-22 21:30:59 -0400] crombar: tcate: unfortunately it even doesn't do that. This is the output when I run 'vagrant provision' http://pastebin.com/nfcvmZzm  My recipe is added to the runlist in the Vagrantfile
[2013-10-22 21:41:03 -0400] tcate: crombar: how did you generate that checksum?
[2013-10-22 21:41:20 -0400] crombar: That checksum is from the oracle site
[2013-10-22 21:42:06 -0400] crombar: tcate: This is the list with the checksums http://www.oracle.com/technetwork/java/javase/downloads/java-se-binaries-checksum-1956892.html
[2013-10-22 21:42:13 -0400] tcate: can you test it without? I'm thinking it's failing the checksum and skipping the install
[2013-10-22 21:43:19 -0400] tcate: https://github.com/opscode-cookbooks/java/blob/f783db3fd3243230de007fe4e52982401a6ede57/providers/ark.rb
[2013-10-22 21:43:27 -0400] tcate: I think java_ark is using sha_256
[2013-10-22 21:44:13 -0400] crombar: tcate: no luck.. but running chef_solo is way too fast. I don't think there is anything downloaded at all
[2013-10-22 21:49:22 -0400] allaire: how do you manage environements with different stuff installed on each one? I struggle with the run_list
[2013-10-22 21:51:08 -0400] tcate: crombar: I think that link is blocking downloads that don't come from browsers, curl gets a redirect to a 503, wget gets a 5.2k html file titled "unauthorized request"
[2013-10-22 21:51:38 -0400] coderanger: bluepojo: Ping
[2013-10-22 21:51:48 -0400] bluepojo: hi
[2013-10-22 21:51:49 -0400] crombar: tcate: yes, that's what the 'accept_oracle_download_terms' option is for.
[2013-10-22 21:52:10 -0400] crombar: but, I can try to install openjdk to narrow down the problem
[2013-10-22 21:52:29 -0400] bluepojo: coderanger: ?
[2013-10-22 21:53:31 -0400] coderanger: bluepojo: mind if I PM?
[2013-10-22 21:53:40 -0400] bluepojo: go for it
[2013-10-22 21:56:16 -0400] crombar: tcate: If I understand the docs correctly, just adding 'include_recipe java' to my recipe should do that. But that unfortunately still doesn't do anything. Running chef only takes one or two seconds
[2013-10-22 21:58:40 -0400] tcate: crombar: that should run the default.rb which will bring in the package install of openjdk
[2013-10-22 21:59:42 -0400] crombar: tcate: strange. I don't understand what is going on.
[2013-10-22 21:59:45 -0400] tcate: not sure why it's not actually including that
[2013-10-22 22:02:11 -0400] tcate: does it leave the vagrant box up? If so you can look for /var/chef/cache/chef-stacktrace.out that might shed some light
[2013-10-22 22:03:27 -0400] crombar: tcate: I can ssh to the vagrant box. But there is no such file. Even /var/chef doesn't exist
[2013-10-22 22:03:50 -0400] allaire: Hey guys, is using Roles the only way to have Per-environment Run-lists ?
[2013-10-22 22:04:05 -0400] tcate: crombar: I got nothing
[2013-10-22 22:11:31 -0400] crombar: tcate: hm, probably I am missing the config.omnibus.chef_version setting in the Vagrantfile. Now 'vagrant up' says 'Downloading Chef 11.6.2 for ubuntu...' for quite some time now.
[2013-10-22 22:21:52 -0400] amccloud: So I managed to add a cookbook restraint to an environment that is causing javascript errors :(
[2013-10-22 22:21:56 -0400] amccloud: https://gist.github.com/amccloud/0f0e3b9bf8431dac8ff0
[2013-10-22 22:22:50 -0400] amccloud: This is trying to edit a env on a pretty much vanilla install on chef 11
[2013-10-22 22:23:01 -0400] amccloud: How do I remove the corrupted constraint?
[2013-10-22 22:26:53 -0400] silk: knife doesnt work?
[2013-10-22 22:28:23 -0400] amccloud: silk: Was that to me?
[2013-10-22 22:29:27 -0400] silk: yeah
[2013-10-22 22:29:42 -0400] silk: knife environment edit $environemnt
[2013-10-22 22:30:28 -0400] amccloud: duh duh. I don't know why that slipped my mind
[2013-10-22 22:30:38 -0400] amccloud: though I wonder why this happened
[2013-10-22 22:32:08 -0400] silk: ugly cut and paste perhaps
[2013-10-22 22:35:34 -0400] crombar: tcate: thanks for your help. that appears to be the issue: chef wasn't installed on the vagrant box. I got more issues now, but at least I now have some hints to figure them out
[2013-10-22 23:06:31 -0400] Hank_: Hi All
[2013-10-22 23:06:48 -0400] Hank_: I am facing a issue with templates
[2013-10-22 23:07:35 -0400] jmickle: whats your issue?
[2013-10-22 23:07:45 -0400] jmickle: what is your malfunction? :-)
[2013-10-22 23:07:46 -0400] Hank_: i am getting a value from the db and storing in a instance @variable
[2013-10-22 23:08:18 -0400] jmickle: in your recipe?
[2013-10-22 23:08:25 -0400] Hank_: but when i access the that instance @variable in the template "/etc/conf.conf" do block
[2013-10-22 23:08:35 -0400] Hank_: i do not see the actual value
[2013-10-22 23:08:40 -0400] Hank_: yes
[2013-10-22 23:08:44 -0400] jmickle: can you gist it please?
[2013-10-22 23:08:50 -0400] Hank_: yes
[2013-10-22 23:12:07 -0400] Hank_: @jmicle : https://gist.github.com/ankit-s/e6d498f3f24370ebe3f4
[2013-10-22 23:12:48 -0400] jmickle: i am assuming the template line?
[2013-10-22 23:12:51 -0400] allaire: Is using Roles the only way to have Per-environment Run-lists ?
[2013-10-22 23:13:24 -0400] jmickle: allaire: you can override directly on the node
[2013-10-22 23:13:33 -0400] jmickle: allaire: wait could be wrong on that
[2013-10-22 23:14:00 -0400] Hank_: should i paste the temple there too?
[2013-10-22 23:14:07 -0400] allaire: jmickle: I think I got my answer: http://stackoverflow.com/questions/9688959/chef-can-i-share-common-per-environment-run-list-items
[2013-10-22 23:14:13 -0400] jmickle: Hank_: @strongmail_eas_server_id = res.getvalue(0,0) # '1'
[2013-10-22 23:14:27 -0400] jmickle: i don't think you need the @
[2013-10-22 23:14:29 -0400] allaire: jmickle: Weird you can't avoid the repetition
[2013-10-22 23:15:00 -0400] Hank_: so i just get rid of the @
[2013-10-22 23:15:10 -0400] jmickle: and i think you can reference directly in that block
[2013-10-22 23:15:26 -0400] jmickle: Hank_: although you may run into scoping I'm not sure
[2013-10-22 23:15:29 -0400] allaire: thanks jtimberman for this reply :D http://stackoverflow.com/questions/9688959/chef-can-i-share-common-per-environment-run-list-items
[2013-10-22 23:20:16 -0400] allaire: jmickle: so, did you find out if we can have env run lists directly on the node?
[2013-10-22 23:20:22 -0400] allaire: or I must pass by a role
[2013-10-22 23:20:29 -0400] jmickle: allaire: doesn't look like it
[2013-10-22 23:20:42 -0400] jmickle: seems like role
[2013-10-22 23:20:43 -0400] allaire: jmickle: Yeah.. I'm wondering why tho
[2013-10-22 23:20:49 -0400] jmickle: allaire: not sure
[2013-10-22 23:21:16 -0400] allaire: how do you group roles usually?
[2013-10-22 23:21:38 -0400] jmickle: allaire: me? i group roles based on server function
[2013-10-22 23:22:15 -0400] allaire: jmickle: what if my server does it all? :P
[2013-10-22 23:22:29 -0400] jmickle: allaire: create a full stack role?
[2013-10-22 23:22:30 -0400] jmickle: :-P
[2013-10-22 23:22:37 -0400] allaire: Classic nginx / passenger / postgres / rails stack
[2013-10-22 23:22:41 -0400] jmickle: allaire: you can have multi roles on a single server
[2013-10-22 23:22:43 -0400] allaire: wondering how I could split this in diff. roles
[2013-10-22 23:22:56 -0400] jmickle: allaire: sounds like you just answered it
[2013-10-22 23:23:07 -0400] jmickle: allaire: web server, passenger, database, rails
[2013-10-22 23:23:20 -0400] jmickle: passenger + web server + rails seems like it would go togerther
[2013-10-22 23:23:26 -0400] jmickle: db could abstract out later
[2013-10-22 23:23:45 -0400] allaire: yeah
[2013-10-22 23:23:54 -0400] jmickle: i group based on function
[2013-10-22 23:23:56 -0400] allaire: I wrapped the nginx cookbook to create a passenger module
[2013-10-22 23:24:02 -0400] allaire: so it belongs together
[2013-10-22 23:24:08 -0400] jmickle: everything i do has 3-4 roles usually
[2013-10-22 23:24:11 -0400] allaire: I just discovered the beauty of wrapping cookbooks
[2013-10-22 23:24:14 -0400] allaire: ^^
[2013-10-22 23:24:15 -0400] jmickle: base_server, function1 and function 2
[2013-10-22 23:24:32 -0400] allaire: base_server includes openssh stuff, hostname, etc. ?
[2013-10-22 23:24:39 -0400] jmickle: base_server does all my custom server side stuff IE users and groups, keys, monitoring such as sensu agent
[2013-10-22 23:24:40 -0400] allaire: like "system" stuff ?
[2013-10-22 23:24:49 -0400] jmickle: things that are the same across all servers
[2013-10-22 23:25:11 -0400] jmickle: for example i want my ldap settings on all servers
[2013-10-22 23:25:27 -0400] jmickle: + i want dns stuff done plus i want monitoring done for CPU. MEM, DISK
[2013-10-22 23:25:28 -0400] jmickle: etc
[2013-10-22 23:26:22 -0400] allaire: yeah
[2013-10-22 23:26:55 -0400] allaire: good
[2013-10-22 23:27:04 -0400] allaire: my node file will be less bloated :)
[2013-10-22 23:27:10 -0400] jmickle: hehe
[2013-10-22 23:27:30 -0400] jmickle: when I'm building a new env/role/step
[2013-10-22 23:27:43 -0400] jmickle: i usually take a pen and paper and write down everything i would do to make this server
[2013-10-22 23:27:52 -0400] jmickle: that outlines my recipes
[2013-10-22 23:27:59 -0400] jmickle: then based on recipes i can break into functions
[2013-10-22 23:28:01 -0400] allaire: good idea
[2013-10-22 23:28:03 -0400] jmickle: and by functions i can do roles
[2013-10-22 23:28:18 -0400] jmickle: so i can say function is web services, which means web server and mod wsgi or passenger
[2013-10-22 23:28:28 -0400] jmickle: so sounds like a web server role to me
[2013-10-22 23:30:04 -0400] Hank_: can some tell me the problem in this code :https://gist.github.com/ankit-s/e6d498f3f24370ebe3f4
[2013-10-22 23:30:35 -0400] Hank_: i am unable to the correct value from @instance variable in the template block
[2013-10-22 23:31:03 -0400] coderanger: Hank_: Indeed, that isn't how instance variables work
[2013-10-22 23:31:35 -0400] coderanger: So the first thing is rather than installing the pg gem yourself, use the normal postgresql::ruby recipe
[2013-10-22 23:31:41 -0400] coderanger: since as you have it, it may not always work
[2013-10-22 23:32:15 -0400] coderanger: Hank_: In general it isn't recommended to have your recipes depend on additional external state though
[2013-10-22 23:32:36 -0400] coderanger: you can make it work, but it introduces a lot of pitfalls and is strictly an advanced use case
[2013-10-22 23:33:34 -0400] Hank_: @coderanger : what would be correct way to use postgresql::ruby in this scenario , is there a example i can refer to ?
[2013-10-22 23:33:51 -0400] allaire: jmickle: If I may have your opinion. I might do some consulting, hosting multiple client apps on different VPS. I would like maintain them in the same chef setup, what would be the best way, considering some server might go PHP + fCGI + NGINX + mySQL, another one like the setup mentioned above, etc.
[2013-10-22 23:33:55 -0400] coderanger: Hank_: Just include_recipe 'postgresql::ruby'
[2013-10-22 23:34:22 -0400] allaire: jmickle: different node file for every server, and lots of roles I suppose?
[2013-10-22 23:35:13 -0400] jmickle: allaire: I am not really sure, i haven't done anything like that
[2013-10-22 23:38:00 -0400] Hank_: @coderanger: i have updated the gist https://gist.github.com/ankit-s/e6d498f3f24370ebe3f4 , does this look right?
[2013-10-22 23:38:41 -0400] coderanger: Hank_: No, one sec, I can show you how to make that work, but why are you trying to read from Postgres in the recipe?
[2013-10-22 23:39:14 -0400] allaire: jmickle: Maintening one chef setup for each server would be a pain
[2013-10-22 23:39:16 -0400] Hank_: i need to retrieve a value from db and write it to a file
[2013-10-22 23:39:45 -0400] coderanger: Hank_: And why can't that value live within CM?
[2013-10-22 23:40:02 -0400] jmickle: allaire: agree but i certainly don't have enough information to determine how i would set it up, really depends on various factors such as what you are hosting and compliance standards / privacy
[2013-10-22 23:40:26 -0400] coderanger: Hank_: http://hastebin.com/bokoqafilo.rb
[2013-10-22 23:40:28 -0400] Hank_: I am sorry , i am new , what is CM?
[2013-10-22 23:40:36 -0400] coderanger: Hank_: CM == config management == Chef
[2013-10-22 23:41:56 -0400] Hank_: oh , in this case , this value is generated by inserting a record in the server table, since the i am unaware of the id that will be generated next i am trying to do this
[2013-10-22 23:42:35 -0400] coderanger: Hank_: Just be forewarned this has all kinds of nasty effects on your system interaction models and whatnot
[2013-10-22 23:43:03 -0400] coderanger: For example in a disaster recovery scenario you wouldn't be able to bring up the app and DB in parallel
[2013-10-22 23:43:42 -0400] Hank_: @
[2013-10-22 23:44:29 -0400] Hank_: @coderanger: thanks , i shall keep that in mind , i am currently working on POC to show how we can scale our products elastically using cheg
[2013-10-22 23:44:34 -0400] Hank_: *chef
[2013-10-22 23:45:12 -0400] coderanger: If you need globally unique IDs for your app, I would recommend using the machine's MAC address or a UUID :)
[2013-10-22 23:45:31 -0400] coderanger: Or negotiate the ID at runtime via ZooKeeper or similar
[2013-10-22 23:57:01 -0400] Hank_: @coderanger : how do i get the postgresql cookbook
[2013-10-22 23:58:14 -0400] coderanger: Hank_: It is available on the community site or via git
[2013-10-22 23:59:29 -0400] Hank_: thanks , got it
