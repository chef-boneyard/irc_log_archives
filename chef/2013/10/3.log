[2013-10-03 00:17:48 -0400] zenloop: ok silly question.  can use the mysql::server cookbook to provision mysql without a root password?
[2013-10-03 00:19:17 -0400] fak3r: zen, if you don't define it, I believe it generates a random one
[2013-10-03 00:28:05 -0400] doomviking: yep
[2013-10-03 01:08:40 -0400] broconne: is it possible to do a knife configure without it prompting for a password?  I don't see a command line switch to provide the password..
[2013-10-03 01:25:03 -0400] broconne: I see there is a patch in, but not approved yet.. bummer
[2013-10-03 01:52:53 -0400] fujin:  hackity hack
[2013-10-03 02:17:43 -0400] ryker: hi all.  I'm writing a LWRP. I have a template resource defined in one of my actions (:create) and I need to have a 'notifies' to call a :restart action I have in my LWRP.  What's the syntax for doing that?
[2013-10-03 02:18:29 -0400] ryker: would it be something like:   notifies :restart, "#{@current_resource}"
[2013-10-03 02:50:26 -0400] fujin: ryker: you refer to the resource in the lwrp run context directly that you are trying to notify
[2013-10-03 02:50:40 -0400] fujin: are you saying you are trying to trigger the action_restart of your provider from in side of the provider block?
[2013-10-03 02:50:56 -0400] fujin: based on the notification/subscription of another resource in the same provider run context block?
[2013-10-03 02:55:07 -0400] ryker: fujin: hmm, give me a sec to ponder your second statement. :)
[2013-10-03 02:55:29 -0400] ryker: fujin: yes, that's exactly what I'm trying to do
[2013-10-03 04:01:24 -0400] binamov: ***crickets***
[2013-10-03 04:45:09 -0400] pcn: ohai chefs
[2013-10-03 04:45:44 -0400] pcn: I've got a node attribute that's nested 3 deep - node['logstash']['agent']['install_method']
[2013-10-03 04:45:56 -0400] pcn: I'm overriding it in another cookbook, at the set level
[2013-10-03 04:46:41 -0400] pcn: However, after the attributes are evaluated, during the compile, instead of seeing the string I've set for the method ('jar') I see a list of ['jar', '1.2.1'] where 1.2.1 is the version I'm installing
[2013-10-03 04:47:12 -0400] pcn: I have looked at the environment, the node data and the cookbook attribute files and I haven't found anythign that looks like a list
[2013-10-03 04:47:22 -0400] pcn: has anyone seen this in 11.6.0 and 11.4.4?
[2013-10-03 04:48:29 -0400] pcn: (when I say "the method" I mean "the attribute")
[2013-10-03 04:54:26 -0400] pcn: Or has anyone found hidden places where attributes like this may get altered in a non-greppable way?
[2013-10-03 05:21:29 -0400] sgronblom: Learning about Chef. This page says there should be a knife cookbook site command but knife cookbook doesn't show it as a subcommand.
[2013-10-03 05:21:35 -0400] sgronblom: https://learnchef.opscode.com/quickstart/chef-repo/
[2013-10-03 05:39:05 -0400] sgronblom: Ah figured that out. Now how do you specify which nodes should have which roles?
[2013-10-03 05:40:36 -0400] n1ko: is there anyway to get a list of templates in your cookbook? or specifically under certain dir
[2013-10-03 05:41:01 -0400] n1ko: i'm doing a frontend server config with a lot of vhost configs and it seems just silly to manually insert the names into an array
[2013-10-03 05:59:35 -0400] sgronblom: Can someone explain where you configure what roles a node should have?
[2013-10-03 06:10:58 -0400] n1ko: sgronblom: umm, you give a list of them when you bootstrap it
[2013-10-03 06:11:24 -0400] n1ko: or you can create a wrapper role (like webserver) which includes other roles
[2013-10-03 06:14:26 -0400] sgronblom: so theres no way that the chef-server can contain a mapping of node name => [role] ?
[2013-10-03 06:15:12 -0400] n1ko: of course it does
[2013-10-03 06:16:37 -0400] sgronblom: oh? how?
[2013-10-03 06:24:19 -0400] jbz: sgronblom: Each node in the chef server has a runlist.  Roles are part of the runlist.  I think also there is a top-level ohai attribute 'roles' which contains a list of roles applied to the node.
[2013-10-03 06:24:39 -0400] jbz: I may be wrong about the second part.
[2013-10-03 06:36:12 -0400] sgronblom: jbz: But where are the node specific run lists stored?
[2013-10-03 06:36:23 -0400] jbz: uh
[2013-10-03 06:36:24 -0400] sgronblom: So far I've only seen them being set up when bootstrapping
[2013-10-03 06:36:30 -0400] jbz: no
[2013-10-03 06:36:36 -0400] jbz: when a node finishes a successful convergence
[2013-10-03 06:36:44 -0400] jbz: it writes its entire node state up to the server
[2013-10-03 06:36:46 -0400] jbz: including the runlist.
[2013-10-03 06:36:58 -0400] jbz: Then, the *next* time it runs, the first thing the node does is pull down that nodestate and look up the runlist.
[2013-10-03 06:36:59 -0400] sgronblom: Yeah but that requires specification of the runlist at that time?
[2013-10-03 06:37:20 -0400] jbz: Right.  When you bootstrap a node for the first time, it has no runlist, unless you start the chef-client using an attributes file
[2013-10-03 06:38:04 -0400] sgronblom: Ok no runlist... so nothing will happen?
[2013-10-03 06:38:08 -0400] jbz: right
[2013-10-03 06:38:25 -0400] jbz: it'll register with the server and create a node/client record but nothing will happen as far as changes to the node
[2013-10-03 06:38:46 -0400] jbz: so you could also wait for it to register, then change its runlist on the server and it'll execute that runlist next time the client runs
[2013-10-03 06:39:27 -0400] jbz: My preferred method is to hand it a role in the attributes file, and have that role contain a runlist.
[2013-10-03 06:39:48 -0400] sgronblom: So the previous project I was on was using puppet which has a site.pp file or something where you can pattern match the node name to something that looks like chef's runlist. Is that not possible with Chef?
[2013-10-03 06:40:23 -0400] jbz: No.  That data is not kept in a file anywhere, it's kept in the data store on the chef server.
[2013-10-03 06:40:29 -0400] jbz: But
[2013-10-03 06:40:42 -0400] jbz: You can search on the server for all nodes which contain a particular role in their runlist.
[2013-10-03 06:40:48 -0400] jbz: Using knife or from within a receipe.
[2013-10-03 06:40:51 -0400] jbz: *recipe derp
[2013-10-03 06:41:12 -0400] jbz: What are you trying to do?
[2013-10-03 06:41:43 -0400] sgronblom: Was just wondering if it was possible to match a node's name to a run list
[2013-10-03 06:42:24 -0400] jbz: that doesn't really make sense
[2013-10-03 06:42:28 -0400] jbz: because runlists only exist in node context.
[2013-10-03 06:42:32 -0400] jbz: Runlists are things nodes have.
[2013-10-03 06:42:48 -0400] sgronblom: So for puppet a client would authenticate with a cert that maps to a node name on the master. This node name would then be mapped to a runlist on the master.
[2013-10-03 06:43:03 -0400] sgronblom: Well something similar to a runlist
[2013-10-03 06:43:24 -0400] jbz: Yeah, that's not how it works here.  I think you might need to let go of the similarities, the differences are enough to make that a dangerous game :-)
[2013-10-03 06:43:36 -0400] jbz: The nodes validate with a generic validation certificate
[2013-10-03 06:44:05 -0400] jbz: then they either have the runlist applied on the server, and download it next time they start a run, or they have a runlist applied via the client being passed an attributes file for its first run.
[2013-10-03 06:44:32 -0400] jbz: I think what you're trying to do is equivalently accomplished
[2013-10-03 06:44:39 -0400] jbz: by having the node be passed a role in the attribute file.
[2013-10-03 06:44:55 -0400] jbz: Prepopulating that attribs file and role is equiv. to having to provision the particular cert.
[2013-10-03 06:45:13 -0400] sgronblom: Ok, so maybe I should drop the node name mapping idea then
[2013-10-03 06:45:22 -0400] sgronblom: Where do I find out more about this attribs file?
[2013-10-03 06:45:28 -0400] jbz: I'm still unclear what you're trying to do, actually
[2013-10-03 06:46:50 -0400] sgronblom: For now I'm just looking to install some simple dependencies (nodejs etc) on my local vagrant box
[2013-10-03 06:47:46 -0400] jbz: so you need to build a role or role-equivalent cookbook
[2013-10-03 06:47:57 -0400] jbz: and then have the vagrant box declare itself to have that role in its runlist when it comes up.
[2013-10-03 06:48:11 -0400] jbz: (or of course you can just use a straight runlist, no role)
[2013-10-03 06:48:13 -0400] jbz: here: http://docs.opscode.com/chef/chef_client.html
[2013-10-03 06:48:16 -0400] jbz: look at the -j optino
[2013-10-03 06:48:18 -0400] jbz: er, option
[2013-10-03 06:48:57 -0400] jbz: basically, you pass in a json file that contains a representation of the node's attributes for the first run
[2013-10-03 06:49:10 -0400] jbz: then, if it successfully completes the convergence, it writes that runlist up to the server
[2013-10-03 06:49:19 -0400] jbz: so future runs have it
[2013-10-03 06:49:19 -0400] sgronblom: Yeah but at the same time I'm not out to get things accomplished as quickly and easily as possible, I am also trying to learn about the more advanced options.
[2013-10-03 06:49:50 -0400] jbz: ok so
[2013-10-03 06:50:02 -0400] jbz: if you're going to have lots of these vagrant boxes, either at once or over time
[2013-10-03 06:50:21 -0400] sgronblom: Yeah all developers will be running the same dev env in a vagrant box
[2013-10-03 06:50:23 -0400] jbz: you probably want to assemble a set of cookbooks that will do what you want to configure it
[2013-10-03 06:50:32 -0400] jbz: then assemble that into a role
[2013-10-03 06:50:52 -0400] jbz: and whenever you provision a new one, you just pass in the runlist to the chef client at startup which contains that role
[2013-10-03 06:51:30 -0400] sgronblom: http://dougireton.com/blog/2013/02/16/chef-cookbook-anti-patterns/ just found this one saying you should wrap roles in a cookbook too
[2013-10-03 06:51:32 -0400] jbz: the vagrant box will register itself and its client with the server and immediately pull down the requisite cookbooks to fulfill its role
[2013-10-03 06:51:46 -0400] jbz: yeah that's a bit of an argument
[2013-10-03 06:52:02 -0400] jbz: the main reason to wrap roles in a cookbook, as far as I can tell, is that you can't version roles on the server, but you can version cookbooks.
[2013-10-03 06:52:18 -0400] jbz: So if you create a pseudorole out of a wrapper cookbook, you can version it.
[2013-10-03 06:52:29 -0400] sgronblom: so it would be something like --runlist=role[web_server]
[2013-10-03 06:52:33 -0400] jbz: A role is just a set of attributes, which includes a runlist among them.
[2013-10-03 06:53:04 -0400] jbz: yeah, you can do that
[2013-10-03 06:53:09 -0400] jbz: -o or --override-runlist
[2013-10-03 06:53:29 -0400] jbz: but the attrib file is cleaner because you can provision it as part of the vagrant box image
[2013-10-03 06:53:33 -0400] sgronblom: And I would also be able to define a dev_server role that contains the web_server role as part
[2013-10-03 06:53:36 -0400] jbz: or build it from a script
[2013-10-03 06:53:39 -0400] jbz: exactly
[2013-10-03 06:53:45 -0400] jbz: or
[2013-10-03 06:54:09 -0400] jbz: you can have the role 'server' and have the environment 'dev' which gives the 'server' role or cookbook specific information about how to set up a dev server
[2013-10-03 06:54:33 -0400] jbz: you would have either config info or logic in the cookbooks which would Do The Right Thing if they were in the 'dev' or 'production' environment.
[2013-10-03 06:55:10 -0400] jbz: The key to the whole thing, AFAICT, is to understand how the various attribute precedence levels work and how the node assembles its run state at compile time.
[2013-10-03 06:55:38 -0400] jbz: Attributes set in environments take precedence over those set in roles which take precedence over those set in cookbook attribute files
[2013-10-03 06:55:53 -0400] glen: 22:56:01  glen> hey, any ideas why my chef server redirects to short name "chef-server"?
[2013-10-03 06:55:55 -0400] jbz: and all of those can be overridden by specific 'node.set' methods in recipe code
[2013-10-03 06:55:56 -0400] glen: 22:56:32  glen> i set chef_server_url to be https://chef-server.my.org, but then i get error Error connecting to  https://chef-server/bookshelf/organization-00000000....
[2013-10-03 06:55:59 -0400] glen: 22:56:56  glen> i'm ysing chef server in vagrant, but it happens with "plain" client as well
[2013-10-03 06:57:49 -0400] glen: fuller output: http://sprunge.us/eahD
[2013-10-03 06:58:31 -0400] sgronblom: jbz: thanks a lot for the advice
[2013-10-03 06:58:39 -0400] jbz: most welcome, good luck
[2013-10-03 07:00:27 -0400] jbz: glen: did you set the bookshelf['url']?
[2013-10-03 07:00:31 -0400] jbz: See here: http://docs.opscode.com/config_rb_chef_server.html#load-balancer
[2013-10-03 07:00:54 -0400] jbz: whoop I meant http://docs.opscode.com/config_rb_chef_server.html#bookshelf
[2013-10-03 07:01:08 -0400] jbz: It *should* set itself from the FQDN
[2013-10-03 07:01:22 -0400] jbz: what does the FQDN of the chef server show up as in ohai?
[2013-10-03 07:01:53 -0400] jbz: glen: (sorry, in case it's not obvious, the chef server will be redirecting)
[2013-10-03 07:02:00 -0400] glen: jbz:   "fqdn": "chef-server",
[2013-10-03 07:02:03 -0400] jbz: ah
[2013-10-03 07:02:16 -0400] jbz: try ensuring that that is chef-server.my.org
[2013-10-03 07:02:27 -0400] glen: other than that, can i do it in config too?
[2013-10-03 07:02:29 -0400] jbz: or try ensuring the hostname is set to that
[2013-10-03 07:02:35 -0400] jbz: yes you can override it in the config
[2013-10-03 07:02:41 -0400] glen: i did not find much config present in chef-server
[2013-10-03 07:02:57 -0400] jbz: The link I posted has the fields in the config.rb which will do it
[2013-10-03 07:03:00 -0400] glen: i found in fact only one file: /etc/chef-server/chef-server-running.json:      "url": "https://chef-server....
[2013-10-03 07:03:11 -0400] glen: jbz: but that config.rb is where exactly?
[2013-10-03 07:03:33 -0400] jbz: it should be at /etc/chef-server/chef-server.rb
[2013-10-03 07:03:40 -0400] glen: i don't have such file, create?
[2013-10-03 07:03:44 -0400] jbz: if it's not, try putting it there yep
[2013-10-03 07:03:53 -0400] jbz: I think the server will just assume defaults if it doesn't find that
[2013-10-03 07:04:01 -0400] glen: but what is this json? /etc/chef-server/chef-server-running.json
[2013-10-03 07:04:08 -0400] jbz: That's probably the current running state
[2013-10-03 07:04:29 -0400] glen: no, i modified that file, and that file is not modified back after full restart
[2013-10-03 07:05:01 -0400] glen: it seems to me it's just dumped ONCE when chef-server is installed
[2013-10-03 07:05:52 -0400] jbz: oh
[2013-10-03 07:06:00 -0400] jbz: I would try using chef-server-ctl reconfigure
[2013-10-03 07:06:06 -0400] glen: btw, that config.rb is KEY=VALUE or KEY VALUE ?
[2013-10-03 07:06:22 -0400] glen: bookshelf['url'] "https://chef-server or bookshelf['url'] = "https://chef-server ?
[2013-10-03 07:06:26 -0400] jbz: try using reconfigure first it should Do The Right Thing(tm)
[2013-10-03 07:07:18 -0400] glen: ok, seems need to use equal sign, as chef-ctl-reconfig gave syntax error :)
[2013-10-03 07:07:39 -0400] glen: it's rather confusing to understand when there's variable assignment and when there's whatever that's the other thing called
[2013-10-03 07:07:48 -0400] glen: ruby-block?
[2013-10-03 07:08:21 -0400] jbz: you should be able to use chef-server-ctl to nuke the config and start over
[2013-10-03 07:08:27 -0400] jbz: if you need to
[2013-10-03 07:08:32 -0400] jbz: 'cleanse' clears all private data I think
[2013-10-03 07:08:49 -0400] jbz: oh right but your FQDN is incomplete
[2013-10-03 07:08:59 -0400] jbz: so that will probably just do the same wrong thing.
[2013-10-03 07:09:14 -0400] glen: but doesn't setting url do it?
[2013-10-03 07:09:18 -0400] jbz: No
[2013-10-03 07:09:48 -0400] jbz: there are a *BUNCH* of moving parts to chef server and they all need to know their address and so it gets built from available information about the node if you don't specify it
[2013-10-03 07:10:30 -0400] jbz: Is there a reason you can't set the node fqdn?
[2013-10-03 07:12:09 -0400] glen: not really, i want to get to understand how configs could be used
[2013-10-03 07:13:47 -0400] glen: and when i set hostname to fqdn it created stupid dns records like chef-server.domain.domain
[2013-10-03 07:14:01 -0400] glen: i guess i could create the dns record statically
[2013-10-03 07:14:51 -0400] glen: jbz: but seems it helped to change config and run reconfigure
[2013-10-03 07:15:16 -0400] glen: i mean vagrant provision errors now out elsewhere :D
[2013-10-03 07:19:30 -0400] jbz: heh
[2013-10-03 07:20:01 -0400] jbz: Yep I apologize, i think the chef-server-running.json may be a new version of the config, I'm not sure.
[2013-10-03 07:25:16 -0400] glen: anyway, there's some ngix.url param too, but that does not play any role
[2013-10-03 07:26:55 -0400] glen: i mean, it doesn't change anything here
[2013-10-03 07:34:37 -0400] fitzdsl: hello, is it possible to declare multiples report/exception handlers ?
[2013-10-03 08:04:28 -0400] ermajn: hello, i'm having troubles to define attribute in .json file for node.. When I update node from file, I can not see attribute in chef server web UI. Here is my .json file: http://pastebin.com/hWsf8JkA
[2013-10-03 08:36:40 -0400] arussel: is there a way in Berkshelf file to reference a github project ?
[2013-10-03 08:41:18 -0400] ezotrank: cookbook 'some_cookbook', git: 'git@github.com/user/cookbook'
[2013-10-03 09:08:36 -0400] ichilton: I think you can do github:user/proj can't you?
[2013-10-03 09:09:35 -0400] ichilton: yeah:
[2013-10-03 09:09:36 -0400] ichilton: cookbook "keeping_secrets", github: "RiotGames/keeping_secrets-cookbook"
[2013-10-03 09:09:50 -0400] bigbigbang: Ohai chef !   Need information , I'm running Chef OSC and in status page there is no more than 20 node ... currently I have ~50 node .. Is this a limit from OSC ?
[2013-10-03 09:10:08 -0400] ichilton: arussel: ^^
[2013-10-03 09:10:14 -0400] ichilton: arussel: but you can also do: cookbook "mysql", git: "https://github.com/opscode-cookbooks/mysql.git"
[2013-10-03 09:10:17 -0400] bigbigbang: If yes, where can I change this value ?
[2013-10-03 09:10:51 -0400] arussel: ichilton: thanks
[2013-10-03 09:19:38 -0400] bigbigbang: sorry wasn't aware of this limit found doc on it thanks
[2013-10-03 09:22:46 -0400] m4rcu5: im in need of some more advice :) i am using environment files and spork to control which version of a cookbook runs in what environment. we now also splitted all our cookbooks to seperate repositories. Im therefore looking into Librarian and Berkshelf, but they both rely havely on versioning into their files, that seems to be overlapping with my environments. is there a cleaner way to keep the cookbooks in
[2013-10-03 09:22:48 -0400] m4rcu5: sync between git and our server?
[2013-10-03 09:29:15 -0400] sgronblom: jbz
[2013-10-03 09:29:21 -0400] sgronblom: durr
[2013-10-03 09:32:12 -0400] sgronblom: So I was checking out the section of Vagrant's Chef provisiong which claims that by default Vagrant will pull a run list for a node. How does that work?
[2013-10-03 09:45:00 -0400] sgronblom: What happens when you do knife bootstrap server? Does it only run the chef-client once? How do you keep the node up to date?
[2013-10-03 09:50:23 -0400] jameslegg: sgronblom: personally I use the chef-client recipe to configure how I want it to run. (in my case using upstart)
[2013-10-03 09:50:48 -0400] ichilton: sgronblom: by default, yes - it's a once-off
[2013-10-03 09:51:46 -0400] ichilton: sgronblom: you'd need to set the node up to either run chef-client as a deamon or periodically via something like cron (which you can do as part of the chef run) to have it keep up-to-date
[2013-10-03 09:51:57 -0400] sgronblom: ichilton: I see
[2013-10-03 09:52:13 -0400] fishGoM00: or bootstrap it with the chef-client recipe
[2013-10-03 09:52:18 -0400] fishGoM00: knife bootstrap IP_ADDRESS -r 'recipe[chef-client]' -x USER -P PASSWORD --sudo
[2013-10-03 09:52:23 -0400] ichilton: sgronblom: re vagrant, you have to specify a run list in the Vagrantfile afaik
[2013-10-03 09:52:36 -0400] ichilton: sgronblom: although the runlist could be a role
[2013-10-03 09:54:26 -0400] sgronblom: http://docs-v1.vagrantup.com/v1/docs/provisioners/chef_server.html Here you have this claim though: Usually the run list is managed by the chef server. In this case, you dont have to do anything, since by default Vagrant will pull the run list from the chef server.
[2013-10-03 09:54:40 -0400] sgronblom: Which I can't find any information about
[2013-10-03 09:55:15 -0400] ichilton: hmm, yeah - not sure about that!
[2013-10-03 09:55:27 -0400] ichilton: how would it know what the run list should be for a new node?
[2013-10-03 09:55:35 -0400] sgronblom: I have no clue! :)
[2013-10-03 09:55:41 -0400] ichilton: ah wait
[2013-10-03 09:55:48 -0400] sgronblom: Thought you guys would know
[2013-10-03 09:56:01 -0400] sgronblom: I started learning about Chef yesterday
[2013-10-03 09:56:02 -0400] ichilton: looking at the examples below that paragraph
[2013-10-03 09:56:14 -0400] ichilton: it's using chef.add_recipe and chef.add_role
[2013-10-03 09:56:42 -0400] ichilton: so you are effectively specifying the runlist with those
[2013-10-03 09:57:02 -0400] ichilton: but it's saying if you actually want to set the run list as an array in one go, you can.
[2013-10-03 09:57:08 -0400] sgronblom: So it's just vague documentation
[2013-10-03 09:57:11 -0400] ichilton: so what it's saying is you can do:
[2013-10-03 09:57:12 -0400] ichilton: chef.add_recipe("apache2")
[2013-10-03 09:57:20 -0400] ichilton: and/or:
[2013-10-03 09:57:20 -0400] ichilton: chef.add_role("database")
[2013-10-03 09:57:28 -0400] ichilton: or you could do:
[2013-10-03 09:57:36 -0400] sgronblom: They mean "If you specify the role it is similar to you specifying all the recipes manually"?
[2013-10-03 09:57:37 -0400] ichilton: chef.run_list = ["recipe[apache2]", "role[database]"]
[2013-10-03 09:58:05 -0400] ichilton: well
[2013-10-03 09:58:20 -0400] ichilton: your run list can contain any number of roles and/or recipes
[2013-10-03 09:58:24 -0400] ichilton: it's how you manage it
[2013-10-03 09:58:52 -0400] ichilton: I like to have a cookbook for my app, which has a recipe for say a web server, which includes other cookbooks/recipes to install stuff
[2013-10-03 09:59:02 -0400] ichilton: then i'm only including a single thing in the run list
[2013-10-03 09:59:28 -0400] ichilton: (I actually then point to that recipe from a role, which is what I include in the run list)
[2013-10-03 09:59:49 -0400] sgronblom: Yeah, I get that. But the way that doc is written it sounds like Vagrant has some magical way to get the chef-server to send it a run list.
[2013-10-03 10:00:13 -0400] ichilton: Yeah, it does read like that.
[2013-10-03 10:00:44 -0400] sgronblom: Is it common to use Chef to set up chef-client as a service/cron job?
[2013-10-03 10:00:53 -0400] ichilton: Yep
[2013-10-03 10:01:04 -0400] sgronblom: There is some ready made recipe for it?
[2013-10-03 10:01:13 -0400] ichilton: Yeah, in the chef-client cookbook
[2013-10-03 10:01:30 -0400] sgronblom: Will check it out. Thank you very much for your help.
[2013-10-03 10:01:31 -0400] ichilton: https://github.com/opscode-cookbooks/chef-client
[2013-10-03 10:02:55 -0400] sgronblom: I would probably want to have that cookbook executed on all nodes
[2013-10-03 10:03:24 -0400] ichilton: Yeah, I have a mycompany-common cookbook which has recipies which set up stuff like ssh, ntp, firewall etc
[2013-10-03 10:03:39 -0400] ichilton: mycompany-common is included from recipes in my mycompany-app cookbook
[2013-10-03 10:04:36 -0400] sgronblom: And what kind of recipes do you have in mycompany-app?
[2013-10-03 10:05:30 -0400] ichilton: so a new web server node has a run list of role[web]. role[web] has a runlist of recipe[mycompany-app::web_server] and the web_server recipe contains an include for mycompany-common, as well as nginx, web config etc
[2013-10-03 10:06:03 -0400] ichilton: mycompany-app has web_server, db_server, app_server, worker etc
[2013-10-03 10:06:12 -0400] ichilton: there is a good video to watch about this
[2013-10-03 10:06:23 -0400] ichilton: 'src
[2013-10-03 10:06:25 -0400] ichilton: 'sec
[2013-10-03 10:06:36 -0400] ichilton: Here we go: http://www.youtube.com/watch?v=hYt0E84kYUI
[2013-10-03 10:06:53 -0400] ichilton: The above is just my way of doing things - but I took a lot of ideas from the above video
[2013-10-03 10:10:30 -0400] sgronblom: Didn't quite get the intro. What was he trying to set up through Siri?
[2013-10-03 10:10:43 -0400] ichilton: haha
[2013-10-03 10:10:48 -0400] ichilton: he comes back to that at the end!
[2013-10-03 10:11:39 -0400] sgronblom: And does he really have asthma or is he just out of shape?
[2013-10-03 10:11:55 -0400] ichilton: not sure
[2013-10-03 10:21:33 -0400] dn00b: hey gais
[2013-10-03 10:22:04 -0400] dn00b: if i include_recipe , does it include attributes by default?
[2013-10-03 10:23:58 -0400] ichilton: yeah
[2013-10-03 10:24:06 -0400] ichilton: attributes with the same name, or default
[2013-10-03 10:31:21 -0400] ermajn: hello, what is the best practice to merge normal and default attributes of one node..
[2013-10-03 10:31:37 -0400] ichilton: merge them?
[2013-10-03 10:31:56 -0400] ichilton: That happens automatically - so you end up with node['something']
[2013-10-03 10:32:03 -0400] fooJBar: ermajn: Chef is merging themfor you
[2013-10-03 10:32:22 -0400] ichilton: The precidence is shown here: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-10-03 10:32:39 -0400] ermajn: it is not, I have something like this in node.json: node['something']  = ['foo']
[2013-10-03 10:32:52 -0400] ermajn: and in role.json: node['something'] = ['bar']
[2013-10-03 10:33:06 -0400] ermajn: in node.json is under normal, and in role.json under default attributes
[2013-10-03 10:33:22 -0400] ermajn: and I want to merge them into node['something'] = ['foo','bar']
[2013-10-03 10:33:34 -0400] ichilton: I use .rb instead of .json, but not sure that's how you set it
[2013-10-03 10:51:38 -0400] dn00b: thanks ichilton
[2013-10-03 10:56:55 -0400] sgronblom: ichilton: This presentation is pretty good
[2013-10-03 11:02:34 -0400] ermajn: ok, can someone help me read attributes defined in a role, that is in runlist of node
[2013-10-03 11:02:52 -0400] ermajn: I have them under default_attributes
[2013-10-03 11:03:01 -0400] ermajn: and I do not know how to access them in recipe file
[2013-10-03 11:25:52 -0400] alexbst: in chef I want to turn some local variables in a recipe into global vars usable in other recipes.. what is the most sensible way to do this ?
[2013-10-03 11:38:01 -0400] ocholetras: bootsrap cannot verify www.opscode.com's certificate
[2013-10-03 11:38:04 -0400] ocholetras: O_o
[2013-10-03 11:39:33 -0400] alexbst: ah, $ :-)
[2013-10-03 11:41:32 -0400] Breaking_Pitt: I guys I need advice I'm getting this while trying to run a recipe in chef-client
[2013-10-03 11:41:34 -0400] Breaking_Pitt: [2013-10-03T13:40:51+02:00] FATAL: NoMethodError: undefined method `split' for nil:NilClass
[2013-10-03 11:41:48 -0400] Breaking_Pitt: the code worked in chef-solo using a json file
[2013-10-03 11:42:09 -0400] Breaking_Pitt: how can I make it work in chef-client?
[2013-10-03 11:42:16 -0400] Breaking_Pitt: I've defined attributes
[2013-10-03 11:42:24 -0400] Breaking_Pitt: but it didn't seem to work
[2013-10-03 12:01:22 -0400] n1ko: no answers earlier, but does anybody know how to find all templates dynamically
[2013-10-03 12:01:59 -0400] n1ko: meaning i have bunch of vhostfiles and dont want to specify them manually but rather do an for-loop enabling those :)
[2013-10-03 12:07:07 -0400] arussel: n1ko: what do you mean exactly, this is ruby, you can loop on whatever you want
[2013-10-03 12:08:42 -0400] n1ko: well yeah, but those aren't populated before the run
[2013-10-03 12:09:23 -0400] n1ko: meaning if i just #{Chef::Config[:file_cache_path]}/cookbooks/... etc the templates aren't in the cache folder yet
[2013-10-03 12:09:48 -0400] n1ko: or maybe it could be somehow populated, i tried this in a ruby block
[2013-10-03 12:11:04 -0400] n1ko: so basicly i would like to have bunch of files in templates/nginx/customerX/vhostY.erb and just do something like forEach in customerX do |vhost| .. enable
[2013-10-03 12:16:25 -0400] arussel: n1ko: are all those files so different that it makes more sense to have a template for each instead of a different processing for each ?
[2013-10-03 12:16:45 -0400] n1ko: yes
[2013-10-03 12:21:10 -0400] hygo: hi all
[2013-10-03 12:26:33 -0400] ichilton: sgronblom: yeah, useful isn't it!
[2013-10-03 12:31:16 -0400] fitzdsl: Does someone has an example of using EventDispatch for custum reporting ?
[2013-10-03 12:33:07 -0400] hygo: what do u mean fitzdsl?
[2013-10-03 12:33:22 -0400] hygo: do you just want to send some information after some action in your cookbook?
[2013-10-03 12:33:38 -0400] fitzdsl: hygo: https://tickets.opscode.com/browse/CHEF-4580
[2013-10-03 12:34:37 -0400] fitzdsl: currently when I inherit from Chef::Handler, I don't have enough information available in run_status
[2013-10-03 12:35:26 -0400] fitzdsl: hygo: so I would like to add some information and opscode told me to make my on class that inherit from Chef::EventDispatch::Base
[2013-10-03 12:36:32 -0400] hygo: I see that now fitzdsl
[2013-10-03 12:36:40 -0400] hygo: sorry, never used that before
[2013-10-03 12:36:59 -0400] hygo: can't you just use 'log' ?
[2013-10-03 12:37:13 -0400] fitzdsl: hygo: log ?
[2013-10-03 12:47:01 -0400] broconne: anyone seen this before.. I set the user in my execute command in a recipe, but knife still thinks I am root..
[2013-10-03 12:49:17 -0400] teukka: broconne: wild guess, but did you set HOME environment variable accordingly?
[2013-10-03 12:49:34 -0400] broconne: I am essentially trying to run knife configure -i  as the vagrant user and its complaing it can't write to root/.chef..
[2013-10-03 12:49:39 -0400] broconne: I can give that a shot
[2013-10-03 12:50:01 -0400] broconne: sort of assumed it did an su - when it ran it..
[2013-10-03 12:50:36 -0400] teukka: broconne: I think it is just `su` to keep all the chef specific env vars
[2013-10-03 12:51:12 -0400] broconne: well, on the bright side.. more hash rockets
[2013-10-03 12:53:16 -0400] broconne: teukka: thanks, that was it. home dir fixed all
[2013-10-03 12:53:47 -0400] teukka: broconne: I've been bitten by that a couple of times =)
[2013-10-03 12:55:02 -0400] broconne: yep - would be a nice attribute to add to the execute.. ability to source the environment.. but probably more difficult than an su - since I imagine its actually a ruby exec call.
[2013-10-03 13:02:03 -0400] ocholetras: yum or yum-repo
[2013-10-03 13:02:05 -0400] ocholetras: O_o
[2013-10-03 13:02:10 -0400] ocholetras: what is the best?
[2013-10-03 13:03:15 -0400] pixie79: Hi all, i seem to have an issue, recently we upgraded chef and it would appear that the way our data bags are now created they are completly encrypted, as such we can not search them
[2013-10-03 13:03:40 -0400] pixie79: any ideas how to fix this?
[2013-10-03 13:04:14 -0400] ocholetras: can you show them?
[2013-10-03 13:04:19 -0400] ocholetras: knife data bag show ...
[2013-10-03 13:04:19 -0400] ocholetras: ?
[2013-10-03 13:04:27 -0400] ocholetras: if so, they are not encrpyted..
[2013-10-03 13:05:35 -0400] pixie79: that works - but when i run chef-client on the server it no longer finds the entries where it used to, and if i look at the bags via the web client they are encrypted
[2013-10-03 13:11:05 -0400] dmz: does anyone know if there is support for or a hack for  the community web service for chef to have  ldap auth support?
[2013-10-03 13:11:11 -0400] pixie79: if they are not encrypted then how can i debug why the 'search :users' no longer appears to work
[2013-10-03 13:12:41 -0400] dmz: i found this https://tickets.opscode.com/browse/CHEF-541, but it is from 2010
[2013-10-03 13:12:57 -0400] dmz: and closed as a won't fix because they wanted a full AAA system instead of a working system :(
[2013-10-03 13:23:06 -0400] broconne: does anyone have a good workflow for managing vagrantfiles (for example, if you want to switch from chef-solo to chef-client)?
[2013-10-03 13:25:33 -0400] ocholetras: pixie79: what you are saying doesnt have any sense O_o
[2013-10-03 13:25:51 -0400] ocholetras: do you have anything on the knife.rb file that says kinife to encrypt by default ?
[2013-10-03 13:26:08 -0400] ocholetras: it is the only thing that comes to my mind right now
[2013-10-03 13:26:55 -0400] pixie79: only knife secret - but they are encrypted - chef-solo validates that as well
[2013-10-03 13:35:13 -0400] Dink: Hello, is there a way to pass a "flag" when using chef-client?
[2013-10-03 13:36:33 -0400] JeanMertz: Hey guys, quick question. If I use opscode's "openssl" cookbook and use the `secure_password` method, how would I get that password stored somewhere (secure) after Chef is finished? (or even printed out to me to store manually)
[2013-10-03 13:40:52 -0400] cpuguy83: JeanMertz: Check out chef-vault
[2013-10-03 13:46:19 -0400] JeanMertz: cpuguy83: Thank you, but I don't think that solves my question. I am using "::Chef::Recipe.send(:include, Opscode::OpenSSL::Password)" in a recipe, and use `secure_password` to generate a completely random password. But then I need a way to extract that password (possibly storing it in chef-server? or even printing it to stdout?)
[2013-10-03 13:47:11 -0400] cpuguy83: JeanMertz: That's kinda what chef-vault can do for you
[2013-10-03 13:47:21 -0400] cpuguy83: Generate the password, put it in the vault
[2013-10-03 13:49:48 -0400] bougyman: WOOT
[2013-10-03 13:50:02 -0400] JeanMertz: cpuguy83: Ah okay, thanks. Looking at the readme it only talks about retrieving encrypted data, but I do see some interesting methods in there.
[2013-10-03 13:50:03 -0400] bougyman: that crap I was trying to do... get a shef session in a ruby script? I finally got it done
[2013-10-03 13:50:07 -0400] bougyman: much easier than using ridley
[2013-10-03 13:50:42 -0400] cpuguy83: bougyman: How is it easier?
[2013-10-03 13:51:04 -0400] bougyman: cpu: weel, it doesn't add the 30 deps of ridley, for one
[2013-10-03 13:51:25 -0400] bougyman: and it's only 4 lines of code.
[2013-10-03 13:51:39 -0400] cpuguy83: Knife really should be a library you can include that happens to have a CLI
[2013-10-03 13:51:51 -0400] bougyman: that's what I basically have now.
[2013-10-03 13:52:06 -0400] cpuguy83: bougyman: Care to gist it?  Or even gemify it?
[2013-10-03 13:52:20 -0400] bougyman: opts = Shef::Options.new
[2013-10-03 13:52:21 -0400] bougyman: opts.instance_variable_set("@config", {:client => true, :config_file => "/etc/chef/client.rb"})
[2013-10-03 13:52:23 -0400] bougyman: opts.parse_opts
[2013-10-03 13:52:26 -0400] bougyman: sess = Shef.session
[2013-10-03 13:52:29 -0400] bougyman: that's it
[2013-10-03 13:52:32 -0400] bougyman: a bit too small to bother gemming it
[2013-10-03 13:52:58 -0400] bougyman: I then have first-class access to all my recipes.
[2013-10-03 13:53:18 -0400] bougyman: libraries, etc.
[2013-10-03 13:53:23 -0400] cpuguy83: Is it really still internally called Shef and not ChefShell?
[2013-10-03 13:53:32 -0400] cpuguy83: Or Chef::Shell
[2013-10-03 13:53:42 -0400] bougyman: i'm still on chef 10.18 in this env
[2013-10-03 13:53:59 -0400] cpuguy83: Ah.
[2013-10-03 13:54:05 -0400] bougyman: very happy day.
[2013-10-03 13:55:20 -0400] bougyman: i've been wanting this access for a very long time
[2013-10-03 13:55:34 -0400] bougyman: mostly to interact with databags and such in ruby scripts, outside of a chef run
[2013-10-03 13:55:50 -0400] gchristensen: does anyone monitor chef's last run time with agios?
[2013-10-03 14:03:53 -0400] pixie79: looks like my error is here - search :users, :ssh_keys
[2013-10-03 14:04:00 -0400] pixie79: when i run chef-solo -z
[2013-10-03 14:04:10 -0400] pixie79: but they used to be populated
[2013-10-03 14:09:59 -0400] bean__: gchristensen: I do.
[2013-10-03 14:10:04 -0400] bean__: I don't really recommend it though.
[2013-10-03 14:10:11 -0400] bean__: We have notifications disabled for it, cuz its a PITA
[2013-10-03 14:11:34 -0400] pixie79: how with chef-solo do i search for an entry in the bag, I can find all the entries in the bag - but i cant for example search for users who have an ssh_key which is a sub key
[2013-10-03 14:12:24 -0400] lewiz: I'd like to create a service that wraps up a standard Windows service.  When somebody calls :stop I want to pass that to the Windows service but then also run another command and only return when the other command exits.  Is this easy to do?
[2013-10-03 14:13:05 -0400] benjohnson77: so I have a node with 11.4.4 and I want to upgrade it to 11.6.0 ... I updated the gem on my work station but how do i uprage the install on the node
[2013-10-03 14:13:42 -0400] benjohnson77: the omnibus_updater fails with un recognized package version on install
[2013-10-03 14:13:50 -0400] benjohnson77: is there some manual way I can do it
[2013-10-03 14:13:59 -0400] yfeldblum: pixie79, chef-solo does not have search
[2013-10-03 14:14:33 -0400] pixie79: yfeldblum: it must do as 'search :users' works
[2013-10-03 14:14:47 -0400] gchristensen: bean__: why is it a PITA?
[2013-10-03 14:14:56 -0400] pixie79: but i cant seem to filter that by keys to work out why me chef scripts are no longer finding the correct key
[2013-10-03 14:15:08 -0400] yfeldblum: pixie79, if it does, then it's new
[2013-10-03 14:15:18 -0400] bean__: *shrug* alerting on it is dumb, gchristensen, especially because then you get alerts to go restart chef or something on a box that doesnt matter at 3am
[2013-10-03 14:15:44 -0400] yfeldblum: pixie79, one thing you can also do is iterate the data-bag items in the data-bag, and filter them in ruby from within your recipe
[2013-10-03 14:17:13 -0400] yfeldblum: pixie79, data_bag("users").map{|i| data_bag_item("users", i)}.select{|b| b.include?("ssh_key")}
[2013-10-03 14:18:16 -0400] pixie79: ok thanks
[2013-10-03 14:26:29 -0400] lewiz: Is there any way to notify a service to stop without being a part of some other action?  e.g. I just want to stop a service prior to doing some work.
[2013-10-03 14:26:58 -0400] workmad3: lewiz: service "name" do; action :stop; end
[2013-10-03 14:27:38 -0400] lewiz: workmad3: Ah, thanks.  If I have already defined service with name is that okay?
[2013-10-03 14:27:48 -0400] workmad3: yeah
[2013-10-03 14:27:56 -0400] lewiz: workmad3: Cool, thanks :)
[2013-10-03 14:27:57 -0400] workmad3: you might get warnings about cloning an already defined resource :)
[2013-10-03 14:28:03 -0400] workmad3: but I've never had a problem with doing that
[2013-10-03 14:28:07 -0400] gchristensen: bean__: got it. how do you monitor its last run time?
[2013-10-03 14:28:43 -0400] bean__: with a handler.
[2013-10-03 14:28:51 -0400] bean__: that reports to a passive check
[2013-10-03 14:28:54 -0400] bean__: in nagios.
[2013-10-03 14:29:56 -0400] gchristensen: bean__: ahh very cool. thank you!
[2013-10-03 14:30:02 -0400] bean__: np
[2013-10-03 14:32:48 -0400] lewiz: If I've defined a simple function with def function ... end is there any way to call that function with a notifies, e.g. when a file changes?
[2013-10-03 14:58:09 -0400] JeanMertz: (How) can I access helper method in my attributes/default.rb file? Like: https://gist.github.com/JeanMertz/6811215
[2013-10-03 14:58:22 -0400] JeanMertz: That one returns "Undefined method or attribute `secure_password' on `node'"
[2013-10-03 14:59:13 -0400] JeanMertz: Hmm, I'm calling Chef::Recipe inside an attributes file, that sounds like a smell
[2013-10-03 15:02:04 -0400] adnichols: JeanMertz I don't see you actually assigning a value to secure_password
[2013-10-03 15:02:32 -0400] adnichols: or is that a method you've defined?
[2013-10-03 15:02:47 -0400] JeanMertz: adnichols secure_password is a method which should become available when including OpenSSL::Password
[2013-10-03 15:03:09 -0400] JeanMertz: But, it's not available, so OpenSSL Isn't included properly/at the right time
[2013-10-03 15:03:09 -0400] bean__: https://github.com/opscode-cookbooks/openssl
[2013-10-03 15:03:14 -0400] bean__: apparently
[2013-10-03 15:03:48 -0400] JeanMertz: Well, I guess I can move this to the recipe level and use "node.default"
[2013-10-03 15:04:03 -0400] chris613: Is there any way to catch exceptions during resource convergence? Like say I have a git resource that tries to check out a repo which is sometimes empty. The git resource defaults to 'HEAD' revision which doesn't exist in an empty repo, and setting revision to '' doesn't work. I want to follow my normal notifies if the checkout suceeds, and continue on with the rest of the run if it fails. Is possible?
[2013-10-03 15:04:04 -0400] adnichols: that's probably a reasonable solution
[2013-10-03 15:04:57 -0400] adnichols: chris613 you can tell the resource not to fail the run if it fails
[2013-10-03 15:05:22 -0400] adamjk-dev: hey all.... so do cookbook from the Opscode community site
[2013-10-03 15:05:23 -0400] adnichols: chris613 look at ignore_failure
[2013-10-03 15:05:25 -0400] chris613: adnichols: I can?
[2013-10-03 15:05:25 -0400] adamjk-dev: not include the Gemfile?
[2013-10-03 15:05:41 -0400] chris613: adnichols: That sounds exactly like what I need. Is this new in Chef 11?
[2013-10-03 15:05:52 -0400] adnichols: chris613 dunno: http://docs.opscode.com/chef/resources.html
[2013-10-03 15:07:34 -0400] adamjk-dev: anyone know if the Opscode community site is stripping out the Gemfile from cookbooks received from Github?
[2013-10-03 15:07:47 -0400] adamjk-dev: http://community.opscode.com/cookbooks/jenkins   at v1.1.0 does not include the Gemfile
[2013-10-03 15:07:53 -0400] adamjk-dev: which makes test-kitchen unhappy
[2013-10-03 15:09:11 -0400] adamjk-dev: anyone at Opscode there?
[2013-10-03 15:09:15 -0400] chris613: adnichols: How have I done this much chef and never noticed that ignore_failure clause? Thanks!
[2013-10-03 15:12:31 -0400] glen: should 'knife search node' give all nodes i have in system?
[2013-10-03 15:12:56 -0400] bean__: glen: "knife status"
[2013-10-03 15:13:18 -0400] Toger: Will running knife index rebuild on a 10.x chef server cause nodes that run chef-client during the rebuild to get incomplete results from a search() ?
[2013-10-03 15:13:22 -0400] glen: i'm just checking if my chef is working proprely
[2013-10-03 15:13:33 -0400] glen: how do i search for nodes whi have recipe FOO included?
[2013-10-03 15:14:11 -0400] Toger: glen: http://pastebin.com/4dfcq7V7
[2013-10-03 15:14:54 -0400] glen: Toger: eh, i used 'recipe:' prefix!
[2013-10-03 15:15:23 -0400] glen: and of course i had no idea about quoting needed!
[2013-10-03 15:16:00 -0400] glen: but it's giving less nodes than i expect
[2013-10-03 15:17:35 -0400] glen: like it's not returning me nodes from other environments or nodes which haven't checked in recently?
[2013-10-03 15:17:53 -0400] scarolan: glen: try this?   knife search node 'recipes:apache'
[2013-10-03 15:18:46 -0400] glen: scarolan: what Toger gave works, but it's returning only two nodes
[2013-10-03 15:19:04 -0400] glen: i already noticed knife status and webui status returns only 20 nodes, but i do have 40 nodes or so
[2013-10-03 15:19:35 -0400] Toger: glen: if knife status is returning less nodes than expected, something significantly bad has happened
[2013-10-03 15:20:08 -0400] glen: does knife status exclude outdated nodes?
[2013-10-03 15:20:17 -0400] glen: i.e ones who haven't checked in in 24h or so
[2013-10-03 15:20:45 -0400] bean__: glen: no
[2013-10-03 15:22:04 -0400] Toger: no limit at all
[2013-10-03 15:23:59 -0400] geggam: laid back operations outage statement " something significantly bad has happened"
[2013-10-03 15:24:08 -0400] geggam: *grins*
[2013-10-03 15:25:56 -0400] adamjk-dev: any Opscoders around? Or anyone know why opscode community site strips files from the cookbook source on GitHub? For instance, the .kitchen.yml file is not carried over as well as others
[2013-10-03 15:26:18 -0400] mattupstate1: because they aren't necessary to use the cookbook?
[2013-10-03 15:26:29 -0400] gchristensen: adamjk-dev: is there a chefignore file?
[2013-10-03 15:27:23 -0400] fak3r: Issue with chef-client, centos hosts and yum repos - tons of running chef-client processes exhausting system memory. Details: https://gist.github.com/philcryer/6810475
[2013-10-03 15:28:36 -0400] jtimberman: adamjk-dev: what gchristensen said :)
[2013-10-03 15:28:46 -0400] jtimberman: er, not gchristensen, mattupstate :D
[2013-10-03 15:29:13 -0400] mattupstate: i'm guessing you're on the west coast ;)
[2013-10-03 15:29:31 -0400] jtimberman: just east of the rocky mountains!
[2013-10-03 15:30:16 -0400] gchristensen: jtimberman: aww false hopes!
[2013-10-03 15:30:35 -0400] mattupstate: ah
[2013-10-03 15:30:44 -0400] Toger: fak3r: what triggers chef? cron?
[2013-10-03 15:32:03 -0400] glen: well, then i have to go and bootstrap nodes to figure out what that "significally bad" was
[2013-10-03 15:32:14 -0400] adamjk-dev: gchristensen: https://github.com/opscode-cookbooks/jenkins
[2013-10-03 15:32:26 -0400] adamjk-dev: jtimberman: I don't see a chefignore file
[2013-10-03 15:32:59 -0400] jtimberman: adamjk-dev: the community site strips out files
[2013-10-03 15:33:04 -0400] jtimberman: when you upload
[2013-10-03 15:33:11 -0400] adamjk-dev: jtimberman: right, is that how it always should be though?
[2013-10-03 15:33:19 -0400] adamjk-dev: jtimberman: https://tickets.opscode.com/browse/CHEF-2776
[2013-10-03 15:33:30 -0400] jtimberman: "should be" vs "required to be" are different things.
[2013-10-03 15:33:31 -0400] adamjk-dev: jtimberman: what if you want to use a test-kitchen file, etc.
[2013-10-03 15:33:36 -0400] adamjk-dev: understood
[2013-10-03 15:33:39 -0400] jtimberman: adamjk-dev: then get the source repo
[2013-10-03 15:33:45 -0400] adamjk-dev: I guess what I am saying is I don't think that is the best way to do it
[2013-10-03 15:34:00 -0400] adamjk-dev: well.... what happens when it is uploaded to opscode community site?
[2013-10-03 15:34:00 -0400] jtimberman: this is not unlike say, rubygems, where the contents of the gem on rubygems.org might not have all the files that are in the repository.
[2013-10-03 15:34:07 -0400] adamjk-dev: i see
[2013-10-03 15:34:14 -0400] adamjk-dev: do you guys run a full test suite on upload?
[2013-10-03 15:34:31 -0400] adamjk-dev: meaning, is a public version on the community site guaranteed to pass all test-kitchen tests, for instance
[2013-10-03 15:34:42 -0400] jtimberman: that's the goal
[2013-10-03 15:34:49 -0400] adamjk-dev: jtimberman: so that's the issue
[2013-10-03 15:34:51 -0400] jtimberman: i'm not actively involved in the release process for cookbooks.
[2013-10-03 15:34:56 -0400] jtimberman: at this point
[2013-10-03 15:35:14 -0400] adamjk-dev: jtimberman: I would htink whatever was exactly tested (meaning it would have to include the kitchen.yml file) would be exactly what was available on the community site
[2013-10-03 15:35:16 -0400] jtimberman: so i cannot speak with authority about what happens during a release.
[2013-10-03 15:35:20 -0400] adamjk-dev: right
[2013-10-03 15:35:23 -0400] jtimberman: but that is the intention
[2013-10-03 15:35:26 -0400] fak3r: toger: I just have it running as chef client, so ps shows it as: root     28650     1  0 09:59 ?        00:00:00 /opt/chef/embedded/bin/ruby /usr/bin/chef-client -d -c /etc/chef/client.rb -L /var/log/chef/client.log -P /var/run/chef/client.pid -i 3600 -s 300
[2013-10-03 15:35:27 -0400] adamjk-dev: meh
[2013-10-03 15:35:32 -0400] jtimberman: if the test-kitchen tests aren't passing
[2013-10-03 15:35:34 -0400] jtimberman: it's a bug imo
[2013-10-03 15:35:36 -0400] adamjk-dev: so what is tested is not what is released
[2013-10-03 15:35:38 -0400] Toger: ok that shouldn't cause a pileup
[2013-10-03 15:35:38 -0400] adamjk-dev: right
[2013-10-03 15:35:46 -0400] fak3r: Toger: I used to have it running via runit, but it was having issues, now wondering if having it setup like this is right
[2013-10-03 15:35:59 -0400] adamjk-dev: jtimberman: but if I want to test the exact same tests against an internal box, that is impossible to do by taking the community cookbook
[2013-10-03 15:36:11 -0400] adamjk-dev: jtimberman: I don't think it is a good thing to release less than what was tested
[2013-10-03 15:37:11 -0400] jtimberman: I get that.
[2013-10-03 15:37:19 -0400] adamjk-dev: Not to mention, I think test-kitchen craps out wihtout a Gemfile
[2013-10-03 15:37:26 -0400] jtimberman: So, get the git repo.
[2013-10-03 15:37:34 -0400] jtimberman: if you want to run the tests.
[2013-10-03 15:37:42 -0400] adamjk-dev: jtimberman: so by releasing a cookbook with that stripped out, test-kitchen is broken for community cookbooks
[2013-10-03 15:37:49 -0400] jtimberman: I don't think that is true at all.
[2013-10-03 15:38:00 -0400] jtimberman: as in i don't agree that it's broken
[2013-10-03 15:38:10 -0400] adamjk-dev: hrm... cant say with certainty
[2013-10-03 15:38:17 -0400] jtimberman: when you install a package from apt, you don't necessarily have the test suite for the software you installed.
[2013-10-03 15:38:27 -0400] adamjk-dev: but test-kitchen 1.0.0beta3 junks out with the Gemfile missing
[2013-10-03 15:39:00 -0400] jtimberman: heh.
[2013-10-03 15:39:08 -0400] adamjk-dev: ?
[2013-10-03 15:39:13 -0400] jtimberman: well, in the specific case of the apache2 cookbook, it's not even updated for test-kitchen 1
[2013-10-03 15:39:21 -0400] gzill: can someone tell me how to set up chef 11 server to listen on port 4000 for knife?  I dont want to go through my network team and im trying to install a chef 11 box
[2013-10-03 15:39:23 -0400] adamjk-dev: I see
[2013-10-03 15:39:30 -0400] adamjk-dev: well... take the Jenkins cookbook, for example
[2013-10-03 15:39:35 -0400] adamjk-dev: there are tons of tests written
[2013-10-03 15:39:49 -0400] adamjk-dev: but the release process strips out the ability to run that community cookbook against test-kitchen
[2013-10-03 15:39:53 -0400] adamjk-dev: so all that work goes away
[2013-10-03 15:40:06 -0400] adamjk-dev: and only limited boxes/platforms are tested in house during the release process
[2013-10-03 15:40:10 -0400] adamjk-dev: we run everything on RHEL
[2013-10-03 15:40:26 -0400] adamjk-dev: so I overwrite the public .kitchen.yml platforms section with my own internal RHEL boxes and re-run all the tests
[2013-10-03 15:40:41 -0400] adamjk-dev: to make sure the public jenkins cookbook works against my own boxes/distros
[2013-10-03 15:43:06 -0400] jtimberman: right.
[2013-10-03 15:43:23 -0400] adamjk-dev: so... abandon using community cookbooks from Opscode?
[2013-10-03 15:43:28 -0400] jtimberman: I never said that.
[2013-10-03 15:43:33 -0400] adamjk-dev: and just pull straight from Git and hope they versioned it correctly?
[2013-10-03 15:43:43 -0400] jtimberman: You're using a jump to conclusions mat.
[2013-10-03 15:43:46 -0400] adamjk-dev: lol
[2013-10-03 15:43:51 -0400] adamjk-dev: okay, let's slow down then
[2013-10-03 15:44:14 -0400] adamjk-dev: don't use community cookbooks from opscode site if you need files that get stripped out
[2013-10-03 15:44:20 -0400] jtimberman: I didn't say that either.
[2013-10-03 15:44:23 -0400] adamjk-dev: arg
[2013-10-03 15:44:47 -0400] adamjk-dev: ^^ you said above to "get the git repo if you want to run tests"
[2013-10-03 15:45:52 -0400] siezer: adamjk-dev so you're saying you'd prefer if the testing bits were shipped along with the finished artifact
[2013-10-03 15:46:09 -0400] adamjk-dev: siezer: I presume I am saying that
[2013-10-03 15:46:23 -0400] adamjk-dev: siezer: so others can test (and add to the testing capabilities) that could have been skipped before
[2013-10-03 15:46:29 -0400] siezer: or better yet, you're saying you need a super easy way to get those bits
[2013-10-03 15:46:34 -0400] adamjk-dev: there are never any tests ran against platforms not public (meaning no licenses)
[2013-10-03 15:46:43 -0400] adamjk-dev: so how is RHEL ever tested
[2013-10-03 15:46:57 -0400] adamjk-dev: and if test-kitchen is the way of the future for testing on Chef
[2013-10-03 15:47:03 -0400] bean__: centos is likely tested ;)
[2013-10-03 15:47:05 -0400] adamjk-dev: then I believe that functionality should be exposed (and allowed to be extended) by others
[2013-10-03 15:47:31 -0400] adamjk-dev: bean__: indeed :).... but still not same exact thing
[2013-10-03 15:47:43 -0400] bean__: p dang similar though
[2013-10-03 15:47:56 -0400] bean__: (at least when I used cent...)_
[2013-10-03 15:47:57 -0400] adamjk-dev: agreed
[2013-10-03 15:48:07 -0400] adamjk-dev: but i dont go off similarity to run production hardware :)
[2013-10-03 15:48:22 -0400] adamjk-dev: siezer: not to mention, the test files are actually shipped.... just not the .kitchen.yml which drives them
[2013-10-03 15:48:38 -0400] adamjk-dev: siezer: so yes, all test files are shipped with community/public cookbooks, but the mechanism to test them is not
[2013-10-03 15:48:49 -0400] adamjk-dev: I am sorry.... this just all seems not the best to me
[2013-10-03 15:49:03 -0400] siezer: so the rationale for removing tests/ and .kitchen and other bits of cruft, is that Some People (tm) complain about all the "useless junk" being downloaded to their nodes ever time chef-client runs =)
[2013-10-03 15:49:27 -0400] adamjk-dev: chef-client downloads from the community site?
[2013-10-03 15:49:35 -0400] siezer: but I do see your point
[2013-10-03 15:49:36 -0400] adamjk-dev: chef-client downloads from the server.....
[2013-10-03 15:49:43 -0400] siezer: no chef-client download from a chef-server
[2013-10-03 15:49:45 -0400] adamjk-dev: wrip anything out from the community site you dont want
[2013-10-03 15:49:49 -0400] adamjk-dev: thats what im saying
[2013-10-03 15:49:55 -0400] adamjk-dev: so ppl complaining.... is weak
[2013-10-03 15:50:07 -0400] adamjk-dev: they should use their own .chefignore etc. files and push only what they want to a Chef server
[2013-10-03 15:50:08 -0400] adamjk-dev: in that case
[2013-10-03 15:50:17 -0400] adamjk-dev: instead of preventing the rest of the community from getting all files they want
[2013-10-03 15:50:26 -0400] jkess: Hi, is it possible to merge node attributes from another hash (i.e., node.normal.merge(nested_hash))?
[2013-10-03 15:50:31 -0400] adamjk-dev: when functionality is "prohibited" rather than avoided... you are asking for it
[2013-10-03 15:50:43 -0400] siezer: so seth vargo has been using this to do releases: https://github.com/sethvargo/stove
[2013-10-03 15:51:33 -0400] adamjk-dev: jtimberman: could you at least pass my thoughts along to Opscode/whomever does the releasing?
[2013-10-03 15:51:56 -0400] siezer: adamjk-dev I'll do that
[2013-10-03 15:52:05 -0400] siezer: adamjk-dev are you coming to the community summit?
[2013-10-03 15:52:09 -0400] siezer: in november?
[2013-10-03 15:52:13 -0400] adamjk-dev: siezer: thanks, I don't know all people's names completely
[2013-10-03 15:52:17 -0400] adamjk-dev: where at?
[2013-10-03 15:52:21 -0400] jtimberman: Seattle.
[2013-10-03 15:52:22 -0400] adamjk-dev: I was at Chefconf 2013
[2013-10-03 15:52:29 -0400] siezer: its where we come to commiserate about this kinda thing
[2013-10-03 15:52:35 -0400] adamjk-dev: hrm
[2013-10-03 15:52:41 -0400] adamjk-dev: I have some thoughts on the matter :)
[2013-10-03 15:52:43 -0400] adamjk-dev: clearly
[2013-10-03 15:52:59 -0400] siezer: http://www.opscode.com/blog/2013/08/06/opscode-community-summit/
[2013-10-03 15:53:02 -0400] adamjk-dev: https://wiki.opscode.com/display/chef/Community+Summit+3+-+2013
[2013-10-03 15:53:03 -0400] adamjk-dev: ?
[2013-10-03 15:53:03 -0400] jtimberman: Does RHEL make it easy to test on their platform? Is there a free way to do it? Can we build and distribute a vagrant base box to make it as easy as testing on CentOS?
[2013-10-03 15:53:05 -0400] adamjk-dev: that
[2013-10-03 15:53:08 -0400] siezer: yea I'm bringing my own axes to grind
[2013-10-03 15:53:15 -0400] jtimberman: siezer: it's a no axe zone.
[2013-10-03 15:53:20 -0400] adamjk-dev: jtimberman: that's a great question... but I don't know the answer
[2013-10-03 15:53:33 -0400] jtimberman: right, neither do i. :)
[2013-10-03 15:53:37 -0400] adamjk-dev: oh if I sound upset or anyhting, that is not true
[2013-10-03 15:53:40 -0400] adamjk-dev: I am just thinking
[2013-10-03 15:53:45 -0400] adamjk-dev: we should open all functionality to all people
[2013-10-03 15:53:50 -0400] jtimberman: so, testing on centos is "good enough" for most use cases of "EL family" distros.
[2013-10-03 15:53:52 -0400] adamjk-dev: I dislike restrictions
[2013-10-03 15:53:59 -0400] adamjk-dev: you are likely correct
[2013-10-03 15:54:36 -0400] adamjk-dev: I would have to see if the bossman is up for sending someone to the summit
[2013-10-03 15:55:02 -0400] siezer: its totally worth it... All The Good Things happen there
[2013-10-03 15:55:14 -0400] siezer: last year we talked about testing a lot
[2013-10-03 15:55:21 -0400] siezer: berksshelf and dependencies
[2013-10-03 15:55:36 -0400] siezer: test-kitchen, etc
[2013-10-03 15:55:42 -0400] adamjk-dev: hrm
[2013-10-03 15:55:46 -0400] siezer: the future of the community site, etc
[2013-10-03 15:55:49 -0400] adamjk-dev: it sounds fun and like I could contribute
[2013-10-03 15:55:55 -0400] siezer: its 2 days of "open spaces"
[2013-10-03 15:56:00 -0400] adamjk-dev: im just a ways away from Seatlle :)
[2013-10-03 15:56:06 -0400] adamjk-dev: but I am forming an email right now :)
[2013-10-03 15:56:18 -0400] siezer: so the agenda is set by whoever wants to write a topic and timeslow on a whiteboard
[2013-10-03 15:56:24 -0400] siezer: time slot even
[2013-10-03 15:56:37 -0400] siezer: where are you located? I'm in NYC =)
[2013-10-03 15:57:11 -0400] adamjk-dev: oh nice
[2013-10-03 15:57:15 -0400] adamjk-dev: I am in Ohio
[2013-10-03 15:57:17 -0400] adamjk-dev: nice.....
[2013-10-03 15:57:30 -0400] adamjk-dev: im seeing who this siezer guy is
[2013-10-03 15:57:33 -0400] adamjk-dev: lol
[2013-10-03 15:57:40 -0400] adamjk-dev: i know a bunch of names... but not all of them
[2013-10-03 15:57:57 -0400] siezer: sammich time. brb
[2013-10-03 15:58:37 -0400] adamjk-dev: yep im 2 mins from it
[2013-10-03 15:59:29 -0400] adamjk-dev: so..... sorry to blow up the IRC
[2013-10-03 15:59:52 -0400] adamjk-dev: I just don't like how the current release process works (not that I couldn't be wrong and there are way better reasons to not publish some of the source)
[2013-10-03 16:04:43 -0400] geggam: seattle in nov ? ... can you possibly find a gloomier place ?
[2013-10-03 16:05:02 -0400] geggam: i propose san diego with sabbaticals in tijuana
[2013-10-03 16:05:29 -0400] adamjk-dev: lol
[2013-10-03 16:19:23 -0400] MrBIOS: is there a way to see when the last time a given cookbook was uploaded to the Chef server?
[2013-10-03 16:19:38 -0400] MrBIOS: even just a logfile
[2013-10-03 16:22:41 -0400] sfalcon: MrBIOS: there isn't anything exposed in the API, but if you are running your own server you should be able to find it in request logs. If you are running OSC 11, updated_at field is in all pg tables so you could query the db directly.
[2013-10-03 16:23:09 -0400] MrBIOS: we are
[2013-10-03 16:23:33 -0400] MrBIOS: what about it someone were to manipulate attributes via the UI
[2013-10-03 16:23:39 -0400] MrBIOS: I'm trying to track down some (mis)behavior
[2013-10-03 16:23:56 -0400] MrBIOS: s/it/if/g
[2013-10-03 16:24:23 -0400] sfalcon: MrBIOS: any change to a cookbook version corresponds to a PUT /cookbooks/$COOKBOOK/$VERSION
[2013-10-03 16:24:42 -0400] killfill: hi
[2013-10-03 16:24:51 -0400] sfalcon: MrBIOS: what Chef Server version?
[2013-10-03 16:24:52 -0400] MrBIOS: yeah, but if the attribute isn't associated with a cookbook (but instead, a node/environment/role)
[2013-10-03 16:24:53 -0400] MrBIOS: 11
[2013-10-03 16:24:56 -0400] killfill: how do i get the available memory of a machine, in my cookbook?
[2013-10-03 16:25:08 -0400] killfill: so i can write config file based on that
[2013-10-03 16:25:55 -0400] sfalcon: killfill: I think you can do: node[:memory][:total]
[2013-10-03 16:26:01 -0400] MrBIOS: sfalcon: I believe we're on the latest released version
[2013-10-03 16:26:27 -0400] killfill: ooh was trying ohai[][].. :P
[2013-10-03 16:26:36 -0400] killfill: and pp node didnt print all the data..
[2013-10-03 16:26:50 -0400] killfill: sfalcon: thanks!
[2013-10-03 16:27:24 -0400] sfalcon: MrBIOS: nice. So I'm not sure I understand what you're asking. Anything done in webui that modifies data on the server will show up in some form in access logs to the server.
[2013-10-03 16:27:45 -0400] MrBIOS: does it log the user that is logged in to the webUI?
[2013-10-03 16:27:49 -0400] MrBIOS: otherwise, can I make it do so?
[2013-10-03 16:28:51 -0400] sfalcon: MrBIOS: I think you might get that from the erchef logs. Look at `chef-server-ctl tail erchef`
[2013-10-03 16:34:12 -0400] MrBIOS: sfalcon: this log is helpful, however it would be great to have an easy way to determine whether or not a get/put came from chef-client and/or the management UI
[2013-10-03 16:34:43 -0400] MrBIOS: no user agent or anything to discern
[2013-10-03 16:39:00 -0400] killfill: how could i call include_recipe "recipe", only if /etc/this_file does not exists?
[2013-10-03 16:44:46 -0400] spox: include_recipe 'awesomeness' unless File.exists?('/etc/this_file')
[2013-10-03 16:47:10 -0400] killfill: spox: thanks!
[2013-10-03 16:47:51 -0400] spox: killfill: ideally though, you would want the recipe to be constructed to provide properly idempotent resources
[2013-10-03 16:48:13 -0400] spox: so you don't have resources being conditionally defined, rather make them conditionally applied
[2013-10-03 16:48:29 -0400] killfill: spox: yes, its just im using someone else's recipe that not 100% idempotent.. dont want to modify it :)
[2013-10-03 16:48:44 -0400] spox: sure :)
[2013-10-03 17:06:56 -0400] zenloop: hey guys, I want to create a node attribute from the output of a shell command (or even boto).  What is the best way to do this?
[2013-10-03 17:08:22 -0400] daos: hey guys. i'm having an issue with my git checkout (git resource) timing out because the repository is fairly large and the download speed is very slow
[2013-10-03 17:09:02 -0400] daos: i tried the following but it didn't seem to work: https://gist.github.com/mikesmullin/5660466
[2013-10-03 17:09:09 -0400] daos: any suggestions would be very much appreciated
[2013-10-03 17:11:16 -0400] Bob_: is there any way to use chef's service command and specify a run-as user? (so that the service command is executed using a specified user)
[2013-10-03 17:16:07 -0400] Bob_: is there any way to use chef's service command and specify a run-as user? (so that the service command is executed using a specified user)
[2013-10-03 17:17:17 -0400] zenloop: next question is can I set an attribute from inside a provider?
[2013-10-03 17:17:19 -0400] bean__: Bob_: usually that is controlled inside your init script.
[2013-10-03 17:19:29 -0400] Bob_: bean__: True. And it is, but I'm running into a sudo error when using vagrant, and the only use of sudo is in the init script when it checks to see if the script has been run as the app user, and uses sudo to re-run it as that user.
[2013-10-03 17:20:02 -0400] Bob_: (I didn't write this init script, I'm trying to debug vagrant's behavior)
[2013-10-03 17:22:00 -0400] Bob_: So I thought it might be better to just tell chef to use the app user to interact with the service as the app user from the onset, to avoid the sudo.
[2013-10-03 17:26:14 -0400] bean__: Bob_: I don't see any way to do a "user" on a service
[2013-10-03 17:26:20 -0400] bean__: esp cuz one usually starts services as root
[2013-10-03 17:28:07 -0400] Bob_: bean__: Yeah... I was afraid of that. It makes sense... I just don't know why, when sudoers is already configured properly, I'm getting 'sudo: sorry, you must have a tty to run sudo' when chef tries to start the service. If I use vagrant ssh to do it manually, it works fine. It only fails like this when chef-client runs it.
[2013-10-03 17:28:56 -0400] bean__: Bob_: your sudoers file probably contains this line: "Default requiretty"
[2013-10-03 17:28:57 -0400] bean__: :)
[2013-10-03 17:28:59 -0400] bean__: and thats likely why
[2013-10-03 17:32:14 -0400] Bob_: that was the first thing I checked. ...Although now that I think about it, I'm only !requiretty'ing for the chef/vagrant user, and not for anyone else. So when the script tries to run as the app user, it fails. ...maybe?
[2013-10-03 17:34:50 -0400] sfalcon: MrBIOS: you can probably get user agent from the nginx log
[2013-10-03 17:35:02 -0400] MrBIOS: fair point
[2013-10-03 17:35:15 -0400] MrBIOS: that's one of my biggest gripes with Chef...auditability
[2013-10-03 17:35:29 -0400] MrBIOS: even some ad-hoc audit tools would be of use to lots of folks, I'd imagine
[2013-10-03 17:36:36 -0400] cpuguy83: MrBIOS: What kind of auditability?
[2013-10-03 17:37:27 -0400] MrBIOS: "X user changed attribute Y at YYYY:MM:DD"
[2013-10-03 17:37:28 -0400] MrBIOS: etc
[2013-10-03 17:37:43 -0400] cpuguy83: Like on chef-server?
[2013-10-03 17:37:46 -0400] MrBIOS: yes
[2013-10-03 17:37:48 -0400] MrBIOS: on the server
[2013-10-03 17:38:02 -0400] sfalcon: Totally.
[2013-10-03 17:38:11 -0400] cpuguy83: I believe it's just Rails, so one could load up the paper_trail gem or something
[2013-10-03 17:38:12 -0400] MrBIOS: user y uploaded cookbook x with knife at <TIME>
[2013-10-03 17:39:52 -0400] cpuguy83: MrBIOS: You should put in a feature request
[2013-10-03 17:40:10 -0400] adamjk-dev: MrBIOS: I asked the same question the other day
[2013-10-03 17:40:32 -0400] adamjk-dev: MrBIOS: we had an issue where "someone" was uploading a newer version of a cookbook onto the Chef server and it was breaking stuff
[2013-10-03 17:40:36 -0400] MrBIOS: yep
[2013-10-03 17:40:42 -0400] adamjk-dev: we didn't know who was doing it since the logs didn't fork that info over
[2013-10-03 17:40:44 -0400] adamjk-dev: :)
[2013-10-03 17:40:48 -0400] MrBIOS: seems like a bog-common problem to which there is no effective solution other than to lock EVERYTHING down
[2013-10-03 17:40:54 -0400] MrBIOS: which is a quick way to get people to revolt
[2013-10-03 17:41:09 -0400] adamjk-dev: yeah
[2013-10-03 17:41:13 -0400] adamjk-dev: i mean.... accountability is key
[2013-10-03 17:41:17 -0400] MrBIOS: exactly
[2013-10-03 17:41:21 -0400] adamjk-dev: if you force each user to have their own client.... and that shows up in logs
[2013-10-03 17:41:24 -0400] adamjk-dev: traceability
[2013-10-03 17:41:35 -0400] adamjk-dev: much needed :)
[2013-10-03 17:41:57 -0400] sous: Hi-  I have what I think is probably a simple question.  If I'm going to use an encrypted databag from multiple cookbooks, do I need to call EncryptedDataBagItem.load_secret in each of them, or can I create a cookbook/ recipe that calls it at the beginning of the run list, then they can both use it later?
[2013-10-03 17:42:30 -0400] cpuguy83: adamjk-dev: Or use Jenkins to upload if all tests pass.  Then if something breaks you can just look at the git commit logs
[2013-10-03 17:43:05 -0400] cpuguy83: Also, you should be locking down versions in your environment anyway
[2013-10-03 17:43:06 -0400] MrBIOS: yep, that's what we'll likely end up doing here
[2013-10-03 17:43:12 -0400] adamjk-dev: cpuguy83: yeah... I guess abstracting away the rights to upload from users to Jenkins and that gives an amount of traceability
[2013-10-03 17:43:19 -0400] bean__: sous: I'd do it in each CB to make it so each one can run without the others.
[2013-10-03 17:43:20 -0400] adamjk-dev: all good stuff
[2013-10-03 17:43:26 -0400] MrBIOS: we've grown to a point where this is a big PITA that wastes gobs of peoples' time
[2013-10-03 17:43:54 -0400] sous: bean__: ok, thanks.
[2013-10-03 18:03:28 -0400] pabst^: nagios cookbook keeps giving me a
[2013-10-03 18:03:36 -0400] pabst^: String can't be coerced into Float error
[2013-10-03 18:03:50 -0400] pabst^: for  47:   check_interval          <%= nagios_interval(nagios_attr(:default_host)[:check_interval]) %>
[2013-10-03 18:03:55 -0400] pabst^: anyond ever seen that
[2013-10-03 18:03:56 -0400] pabst^: ?
[2013-10-03 18:04:58 -0400] glen: so, i search by recipe name, and it doesn't return machines, which i do see manually with knife node edit do having the recipes
[2013-10-03 18:16:11 -0400] glen: also, i have two versions of chef-clients uploaded to server,  but somewhy clients pull the older version. why. i have not specified versions anywhere
[2013-10-03 18:31:16 -0400] glen: ou. new chef-client had no satisifed dependency of logrotate. how should things should come out really?
[2013-10-03 18:31:26 -0400] glen: i mean i just had good luck figuring this out!
[2013-10-03 18:31:40 -0400] glen: making things work just on a hunch kind of sucks and is not professional
[2013-10-03 18:31:58 -0400] bean__: glennpratt: does your chef server have the logrotate cookbook?
[2013-10-03 18:32:02 -0400] bean__: err
[2013-10-03 18:32:04 -0400] bean__: glen:
[2013-10-03 18:39:08 -0400] mattray: stoked, I finally got to use lazy attribute evaluation http://docs.opscode.com/chef/resources.html#lazy-attribute-evaluation
[2013-10-03 18:39:34 -0400] jmartin: mattray: i can pray its for knife openstack right?
[2013-10-03 18:39:36 -0400] jmartin: heh
[2013-10-03 18:40:08 -0400] mattray: dnsmasq
[2013-10-03 18:40:14 -0400] mattray: related to openstack
[2013-10-03 18:40:23 -0400] jmartin: excellent
[2013-10-03 18:41:27 -0400] fak3r: I want a file to be overwritten if it doesnt' match what chef has, I'm thinking it's in the cookbook_file block, but no examples on http://docs.opscode.com/resource_cookbook_file.html
[2013-10-03 18:42:00 -0400] fak3r: I'm thinking it'd be a line saying:   content true
[2013-10-03 18:42:36 -0400] scarolan: fak3r: This is the default behavior of cookbook_file; to overwrite whatever is there if it's different.
[2013-10-03 18:42:38 -0400] bean__: fak3r: by default it will overwrite if its different than what chef has.
[2013-10-03 18:42:40 -0400] bean__: yep
[2013-10-03 18:42:43 -0400] scarolan: jinx
[2013-10-03 18:42:45 -0400] scarolan: haha
[2013-10-03 18:43:50 -0400] fak3r: ok, cause it didnt' like content true "Option content must be a kind of String!  You passed true."
[2013-10-03 18:44:11 -0400] fak3r: k, that's what I thought
[2013-10-03 18:45:22 -0400] glen: bean__: i uploaded it finally, but that was not the point
[2013-10-03 18:45:43 -0400] bean__: glen: sory, i missed the other part of the conversation
[2013-10-03 18:45:45 -0400] glen: bean__: but NOTHING gave me indication problem is missing dependency
[2013-10-03 18:46:00 -0400] bean__: glen: the logs likely would.
[2013-10-03 18:46:26 -0400] glen: bean__: but why not chef-client
[2013-10-03 18:46:42 -0400] bean__: the chef client logs would
[2013-10-03 18:46:46 -0400] bean__: most certainly
[2013-10-03 18:46:58 -0400] glen: client has no log, it has just output
[2013-10-03 18:47:09 -0400] bean__: correct, the output is the same as what goes into the log
[2013-10-03 18:47:35 -0400] glen: but there was no such thing as ou, cookbook x.y.z has no dependency fallinbg back to a.b.c
[2013-10-03 18:47:44 -0400] glen: it just downloaded whatever cookbook it wished and that's it
[2013-10-03 18:48:17 -0400] glen: only such messages:
[2013-10-03 18:48:17 -0400] glen: [2013-10-03T21:18:07+03:00] DEBUG: Synchronizing cookbook chef-client
[2013-10-03 18:48:18 -0400] glen: [2013-10-03T21:18:07+03:00] DEBUG: Not storing cookbooks/chef-client/recipes/default.rb, as the cache is up to date.
[2013-10-03 18:48:26 -0400] glen: but these reveal nothing about what version is pulled or so on
[2013-10-03 18:48:54 -0400] bean__: glen, I can't tell you for sure unless you pastebinned the full output
[2013-10-03 18:49:04 -0400] bean__: If there was a missing cookbook it'd tell you in the logs.
[2013-10-03 18:49:16 -0400] bean__: either that or you're missing a key concept as to how this whole shebang works.
[2013-10-03 18:50:10 -0400] chriss_: does anyone have experience requireing external ruby libraries in an lwrp?
[2013-10-03 18:50:43 -0400] glen: bean__: fine. i'll paste, but what loglevel?
[2013-10-03 18:50:57 -0400] bean__: likely info is fine
[2013-10-03 18:53:08 -0400] glen: so, i dropped logrotate cookbook and ran chef-client -l info : http://sprunge.us/KJFR
[2013-10-03 18:53:49 -0400] glen: nothing about logrotate or what version it picks
[2013-10-03 18:54:18 -0400] bean__: glen: so you're saying its fixed if you re-add logrotate?
[2013-10-03 18:54:21 -0400] bean__: that doesn't make any sense
[2013-10-03 18:54:32 -0400] bean__: the problem you're seeing is that it can't find "groupid" for chef
[2013-10-03 18:55:09 -0400] glen: bean__: you are getting distracted! damn it
[2013-10-03 18:55:19 -0400] bean__: ?
[2013-10-03 18:55:33 -0400] bean__: I'm confused as to why you think you'd be seeing anything about logrotate
[2013-10-03 18:55:35 -0400] glen: that is not the problem i'm duscissuing
[2013-10-03 18:55:36 -0400] bean__: after removing it
[2013-10-03 18:55:40 -0400] glen: look
[2013-10-03 18:55:49 -0400] glen: this is the old version it pulls: # grep version /var/cache/chef/cookbooks/chef-client/metadata.rb
[2013-10-03 18:55:52 -0400] glen: version           "2.2.5"
[2013-10-03 18:56:00 -0400] glen: because new version of chef-cookbook depends on logrorate cookbook
[2013-10-03 18:56:12 -0400] fak3r: hey bean__ and scarolan: issue was I had the include_recipe "apache2" below my httpd.conf line - so it'd put my change in, then take it out when it ran the apache park
[2013-10-03 18:56:13 -0400] glen: and THAT FACT, is nowhere informed to me
[2013-10-03 18:56:19 -0400] fak3r: still getting used to the order in chef :)
[2013-10-03 18:56:35 -0400] bean__: glen: do you not have the new chef-client cookbook uploaded  to your server?
[2013-10-03 18:56:44 -0400] glen: bean__: so, if i upload logrotate cookbook, and rerun the same chef-client, it will "pick" 3.1 version of the chef-client kookbook
[2013-10-03 18:56:57 -0400] glen: bean__: YESSS. i have three versions there
[2013-10-03 18:57:04 -0400] bean__: okay, do you know about version pinning?
[2013-10-03 18:57:17 -0400] glen: bean__: and as i said earlier, i have nowhere pinned any version
[2013-10-03 18:57:29 -0400] glen: bean__: so it should pick the "latest"
[2013-10-03 18:57:56 -0400] glen: but it picked 2.2.5 out of 3.0.7 and 3.1.1
[2013-10-03 18:58:06 -0400] bean__: calm down man,
[2013-10-03 18:58:10 -0400] bean__: are you sure its not pinned?
[2013-10-03 18:58:31 -0400] glen: yes. because if i upload logrotate cookbook, it will use 3.1.1
[2013-10-03 19:00:36 -0400] sfalcon: cookbook dependencies can cause a non-latest cookbook version to be selected when resolving a node's run list.
[2013-10-03 19:00:45 -0400] bean__: thats what i thought
[2013-10-03 19:00:47 -0400] bean__: but was trying to find.
[2013-10-03 19:00:51 -0400] bean__: and it makes complete sense to me
[2013-10-03 19:00:54 -0400] bean__: glen: ^
[2013-10-03 19:01:49 -0400] glen: bit i would like to get informed such thing happens
[2013-10-03 19:01:56 -0400] sfalcon: The solver tries to find a working cookbook collection. So if latest of cbv-A is a no-go because it depends on something that isn't available, it tries downgrading (as a loose example)
[2013-10-03 19:01:58 -0400] bean__: thats why you use version pinning
[2013-10-03 19:02:30 -0400] glen: and why knife upload could not inform me that i've uploaded something that is not usable?
[2013-10-03 19:02:30 -0400] sfalcon: glen: that's understandable. I think we've learned a lot from the cookbook version dependency solution and have some plans to make big improvements in Chef 12.
[2013-10-03 19:02:54 -0400] glen: i also had to totally throw away one installation of chef server due the same failure
[2013-10-03 19:03:03 -0400] glen: because nothing worked and i had no ideas what to do
[2013-10-03 19:03:14 -0400] glen: but later it appeared that similarily one dependency was missing
[2013-10-03 19:03:15 -0400] sfalcon: glen: I haven't been following details, but the problem is harder than that. A given cookbook might be OK at latest, but not OK at latest if something else is coming along for the ride in the run list.
[2013-10-03 19:03:24 -0400] glen: chef-webui started to give 500 errors
[2013-10-03 19:03:36 -0400] bean__: glen: that sounds like an unrelated problem
[2013-10-03 19:03:46 -0400] bean__: if you had asked here, someone likely could have helped you
[2013-10-03 19:03:55 -0400] glen: i did ask
[2013-10-03 19:04:18 -0400] glen: but just giving trace and no other information did lead nowhere, because i did not know exactly what i did that it broke
[2013-10-03 19:04:36 -0400] bean__: *shrug* I wasn't here when you did, then/
[2013-10-03 19:04:37 -0400] gchristensen: is there away to dynamically add checks to nagios? like I have a check on one of my machines per database available (to make sure box A can get to db A B and C,) I'd rather not make a databag item for it, since that could so easily get out of date
[2013-10-03 19:04:54 -0400] gchristensen: the commands are being written, but theey are not yet being called via nrpe
[2013-10-03 19:05:30 -0400] jmickle: anyone have the ticket review links?
[2013-10-03 19:07:02 -0400] goshawk: hi all
[2013-10-03 19:07:14 -0400] goshawk: can i override a recipe of another cookbook ?
[2013-10-03 19:07:26 -0400] glen: bean__: i have some other problem too, that i've been lurking around here for few days and haven't got anywhere with it
[2013-10-03 19:07:39 -0400] jmickle: goshawk: what do you mean override a recipe?
[2013-10-03 19:07:40 -0400] bean__: glen, this is the first time i've seen you post
[2013-10-03 19:07:41 -0400] glen: bean__: it manifests itself as knife staths and webui status not showing all nodes
[2013-10-03 19:07:43 -0400] bean__: feel free to ask questions
[2013-10-03 19:07:50 -0400] bean__: oh, i saw you post on that earlier.
[2013-10-03 19:08:00 -0400] bean__: If they aren't in knife status then something is wrong.
[2013-10-03 19:08:03 -0400] glen: and knife seeach also giving incomplete results
[2013-10-03 19:08:07 -0400] bean__: knife status shows ALL nodes.
[2013-10-03 19:08:12 -0400] bean__: yes, they all use the same data.
[2013-10-03 19:08:18 -0400] glen: but i checked that knife node edit, sees the node
[2013-10-03 19:08:23 -0400] glen: chef-client runs fine on the node
[2013-10-03 19:08:24 -0400] bean__: interesting
[2013-10-03 19:08:28 -0400] goshawk: jmickle, mod_ssl recipe of apache2 adds port 443 to the listen_ports. i don't want it. I thought that if i can alter that recipe only i can achieve what i want
[2013-10-03 19:08:32 -0400] glen: but it's not appearing in search
[2013-10-03 19:08:38 -0400] bean__: glen: what version of chef server are you on
[2013-10-03 19:08:53 -0400] glen: chef-server-11.0.8+20130618223354.git.14.1853585-1.pld.3.0.x86_64
[2013-10-03 19:08:59 -0400] jmickle: goshawk you can modify the code locally and do what you want or you can just not run the recipe if you don't want that
[2013-10-03 19:09:13 -0400] jmickle: goshawk: you don't have to use the mod_ssl recipe
[2013-10-03 19:09:18 -0400] glen: bean__: it has solr
[2013-10-03 19:09:26 -0400] bean__: glen: have you tried restarting solr
[2013-10-03 19:09:32 -0400] goshawk: jmickle, i want ssl, i just don't want it to add me port 443 but another port
[2013-10-03 19:09:42 -0400] glen: bean__: no
[2013-10-03 19:09:50 -0400] bean__: glen: i'd give that a try
[2013-10-03 19:09:55 -0400] jmickle: goshawk: in the mod_ssl recipe i believe the 443 is an attribute that you can just override with a new value
[2013-10-03 19:10:01 -0400] glen: can you give command too?
[2013-10-03 19:10:01 -0400] goshawk: jmickle, if i modify the code localy every time i run librarian-chef update my changes are lost
[2013-10-03 19:10:13 -0400] goshawk: jmickle, wrong
[2013-10-03 19:10:19 -0400] goshawk: jmickle, it's hardcoded
[2013-10-03 19:10:34 -0400] glen: bean__: chef-server-ctl restart? or there's way to restart just one service? or just kill and let it be respawned?
[2013-10-03 19:10:38 -0400] goshawk: jmickle, https://github.com/opscode-cookbooks/apache2/blob/master/recipes/mod_ssl.rb
[2013-10-03 19:10:55 -0400] bean__: glen: I use chef 10, so I'm not sure.
[2013-10-03 19:11:02 -0400] bean__: YOu could give a full restart a try though
[2013-10-03 19:11:17 -0400] glen: ok. doing chef-server-ctl restart
[2013-10-03 19:11:21 -0400] glen: that does full restart afaik
[2013-10-03 19:11:36 -0400] jmickle: goshawk: got it not sure, i don't use things like librarian-chef/berkshelf they end up being more of a PITA for larger infrastructures then they are worth
[2013-10-03 19:11:48 -0400] bean__: glen: yeah
[2013-10-03 19:11:52 -0400] bean__: glen: or restart the server :)
[2013-10-03 19:11:56 -0400] glen: bean__: if that was supposed to magically fix things, then nothing happened
[2013-10-03 19:12:15 -0400] gchristensen: jmickle: they do?
[2013-10-03 19:12:18 -0400] bean__: glen: I'm just giving suggestions. I'm just a user like you.
[2013-10-03 19:12:28 -0400] goshawk: jmickle, wasn't site-cookbooks thought to override the mod_ssl recepy if i create a site-cookbooks/apache2/recipes/mod_ssl.rb ?
[2013-10-03 19:12:38 -0400] glen: bean__: is there any nicer web ui too than the default?
[2013-10-03 19:12:52 -0400] jmickle: gchristensen: yes they do, they work great when you have <200 servers but once you get to any large scale infrastructure or even an SOA architecture using chef to manage everything they end up in the way
[2013-10-03 19:13:06 -0400] jmickle: goshawk: possibly I'm not sure
[2013-10-03 19:13:23 -0400] goshawk: jmickle, well it doesn't work ghghghg
[2013-10-03 19:13:24 -0400] gchristensen: jmickle: can you give an example of how it got in your way? (I'm not expressing an opinion here, just curious about your experience with it.)
[2013-10-03 19:14:03 -0400] jmickle: gchristensen: absolutely, goshawks is actually a prime example. We had recipes that were community "created" that we needed to modify and handle we needed certain events to trigger while others didnt
[2013-10-03 19:14:04 -0400] glen: bean__: i reran chef-cliient that is supposed to be in the list, but nothing
[2013-10-03 19:14:14 -0400] gchristensen: okay
[2013-10-03 19:14:25 -0400] jmickle: gchristensen: also if you don't stick to the community example of a ruby on rails deployment you are pretty much SOL
[2013-10-03 19:14:43 -0400] gchristensen: so it sounds like not berkshelf, but the community cookbooks are your issue?
[2013-10-03 19:14:47 -0400] jmickle: gchristensen: for example i wrote scala applications that contained jetty within them and didn't run within a server container
[2013-10-03 19:14:49 -0400] bean__: glen: try this "knife index rebuild"
[2013-10-03 19:14:54 -0400] goshawk: jmickle, gchristensen  usage would be improved if there is a way to override community defined recepy for my own environment in a easy way
[2013-10-03 19:15:10 -0400] jmickle: gchristensen: so when we tried to constantly use like berkshelf for example, it would always overwrite the changes or update things we didn't necessarily want
[2013-10-03 19:15:35 -0400] jmickle: gchristensen: with berkshelf we found ourself constantly reverting cookbooks to a "good" state vs the community state
[2013-10-03 19:16:00 -0400] glen: bean__: heh, it's removed: ERROR: Rebuilding the index is not available via knife for Open Source Chef Servers version 11.0.0 and above.
[2013-10-03 19:16:03 -0400] glen: Instead, run the 'chef-server-ctl reindex' command on the server itself.
[2013-10-03 19:16:05 -0400] jmickle: bundling cookbooks is great, but bundling cookbook installs make an assumption that one's architecture is the best for everyone
[2013-10-03 19:16:19 -0400] bean__: glen: then run the suggested command on the server :)
[2013-10-03 19:16:44 -0400] glen: bean__: great, now even the two nodes that were given as search result are gone
[2013-10-03 19:16:57 -0400] bean__: glen: maybe the reindex isn't done
[2013-10-03 19:16:59 -0400] bean__: im unsure
[2013-10-03 19:17:01 -0400] glen: and knife status shows 0 rows
[2013-10-03 19:17:16 -0400] glen: but prompt was given back
[2013-10-03 19:18:16 -0400] glen: i did move nodes to different enviroment with some knife command. could that break stuff?
[2013-10-03 19:18:40 -0400] jmickle: goshawk: thats my personal feelings on it but thats just me
[2013-10-03 19:18:59 -0400] jmickle: goshawk: i like to highly customize our infrastructure to be as lean as possible and cut out fat / not waste system resources
[2013-10-03 19:19:27 -0400] goshawk: true
[2013-10-03 19:19:27 -0400] bean__: glen: doubtful. I'd check some of the chef logs and see if anything odd pops out at you.
[2013-10-03 19:19:44 -0400] goshawk: jmickle,  i think i'm going to copy the apache cookbook out of librarian
[2013-10-03 19:19:47 -0400] goshawk: and modify it there
[2013-10-03 19:20:10 -0400] jmickle: goshawk: have you checked librarian's docs to see if there is a case for it. I know its a really powerful and pretty awesome project
[2013-10-03 19:20:18 -0400] jmickle: it might have a solution for it that neither of us are aware of
[2013-10-03 19:20:28 -0400] glen: seems first chef-client run submit was neccessary, as nodes have appeared now:  knife status|wc -l
[2013-10-03 19:20:31 -0400] glen: 55
[2013-10-03 19:20:39 -0400] goshawk: jmickle, i'm googling for it
[2013-10-03 19:20:48 -0400] jmickle: goshawk: https://github.com/applicationsonline/librarian-chef
[2013-10-03 19:21:13 -0400] cpuguy83: jmickle: I don't see how Berkshelf gets in the way of that.  The purpose of it is to manage your cookbook dependancies.  If you want something to do exactly what you want, right your own cookbooks and use Berkshelf to manage them
[2013-10-03 19:21:45 -0400] jmickle: cpuguy83: but if I'm writing my own cookbooks why do i need an extra layer of complexity to manage my own cookbooks?
[2013-10-03 19:22:00 -0400] cpuguy83: jmickle: Because it's not complexity, it irons things out
[2013-10-03 19:22:01 -0400] jmickle: cpuguy83: i can just version/upload to github as necessary since I'm already writing my own
[2013-10-03 19:22:01 -0400] bean__: glen: it was probably still rebuilding the indexs in the background
[2013-10-03 19:22:37 -0400] jmickle: cpuguy83: how does it iron things out? it doesn't provide and actual redundancy that i don't already do
[2013-10-03 19:22:49 -0400] cpuguy83: jmickle: Where Berkshelf is handy is in dependency resolution.  From what your are saying, Apt gets in the way, Bundler, etc.
[2013-10-03 19:23:26 -0400] jmickle: cpuguy83: dependency resolution definitely is a plus for sure. But like i said, we don't use community cookbooks without knowing what goes into them fully we modify 90% of what goes into our chef runs
[2013-10-03 19:24:14 -0400] pabst^: lol... the opscode nagios cookbook is converting numbers to floats when inserting them into templates
[2013-10-03 19:24:16 -0400] cpuguy83: Just because you aren't using community stuff doesn't mean it wouldn't help... I don't want to fight here, just trying to point out how it can/should help you
[2013-10-03 19:24:18 -0400] pabst^: ive never seen that
[2013-10-03 19:24:24 -0400] jmickle: cpuguy83: dependency resolution is def cool, i like that but the 5 min achievement i get out of that doesn't offset the need to teach all my devs something new just to create a templated infrastructure
[2013-10-03 19:24:27 -0400] siezer: you can point berkshelf at your own chef-server to grab cookbooks form instead of going out to the community site
[2013-10-03 19:24:46 -0400] jmickle: cpuguy83: not trying to fight at all i value your input.
[2013-10-03 19:24:50 -0400] cpuguy83: siezer: Or git
[2013-10-03 19:24:58 -0400] siezer: don't use git
[2013-10-03 19:25:01 -0400] jmickle: haha
[2013-10-03 19:25:03 -0400] siezer: that defeats the whole purpose
[2013-10-03 19:25:06 -0400] jmickle: git is the devil
[2013-10-03 19:25:13 -0400] bean__: glen: so does this clear up your issues for today? :)
[2013-10-03 19:25:13 -0400] jmickle: but we use git for all our chef repo's
[2013-10-03 19:25:21 -0400] cpuguy83: Git is the opposite of the devil
[2013-10-03 19:25:31 -0400] jmickle: git is a necessary evil
[2013-10-03 19:25:43 -0400] cpuguy83: it's a necessary awesomeness
[2013-10-03 19:25:46 -0400] jmickle: hehehe
[2013-10-03 19:25:51 -0400] bean__: I'm a fan of git.
[2013-10-03 19:25:53 -0400] jmartin: if git is evil, use bazaar or whatever
[2013-10-03 19:25:53 -0400] siezer: well, definitely use git to track your cookbooks. but the whole point of berkshelf is to "artifact" you cookbook releases by installing them on the chef-server (as an artifact server)
[2013-10-03 19:26:04 -0400] jchauncey: Berkshelf is useful for testing cookbooks, dependency resolution when you run chef-client will never be handled by berkshelf
[2013-10-03 19:26:17 -0400] siezer: git is great. just don't try and use shas as version numbers
[2013-10-03 19:26:24 -0400] jchauncey: siezer: exactly
[2013-10-03 19:26:37 -0400] jmickle: siezer: yeah thats what i meant earlier about berkshelf is awesome for smaller infrastructures
[2013-10-03 19:26:38 -0400] cpuguy83: siezer: Well, you artifact them by splitting them up into separate repos.  Also really helpful during cookbook development.
[2013-10-03 19:26:46 -0400] siezer: yep
[2013-10-03 19:26:51 -0400] jmickle: siezer: in our case we have 4 chef servers and hundred of nodes
[2013-10-03 19:26:55 -0400] jchauncey: berkshelf is a cookbook development tool nothing more
[2013-10-03 19:27:12 -0400] siezer: and artifact manager
[2013-10-03 19:27:15 -0400] jchauncey: jmickle: why 4? because you need to segregate your network?
[2013-10-03 19:27:34 -0400] jmickle: jchauncey: different regions to provide HA across the board and quickest response times
[2013-10-03 19:27:35 -0400] siezer: jmickle berkshelf 3 will support multiple chef-server btw =)
[2013-10-03 19:28:16 -0400] jmickle: jchauncey: I've got 1 chef URL that routes chef requests/traffic based on where its coming from to its closest server and takes into account servers that go down
[2013-10-03 19:28:33 -0400] glen: bean__: some of them. thanks!
[2013-10-03 19:28:35 -0400] jmickle: jchauncey: and our repos are in sync across them all to ensure uniformity
[2013-10-03 19:28:51 -0400] jmartin: jmickle: that setup is in my future
[2013-10-03 19:29:06 -0400] glen: bean__: i have recipe called probe, that adds recipes to run list, i would like to restart runlist when probe has finished in same run. possible?
[2013-10-03 19:29:18 -0400] jmickle: jmartin: its difficult but done right can be very effective
[2013-10-03 19:29:51 -0400] jmickle: but with a setup like this the simple tools go out the window and new ways of thinking are required.. don't get me wrong berkshelf and those tools are wonderful but they aren't for my infrastructure
[2013-10-03 19:30:00 -0400] jmickle: I'm totally an advocate of it all ;-)
[2013-10-03 19:30:16 -0400] jmartin: jmickle: do you sync your various chef-servers from a single source of truth?
[2013-10-03 19:30:38 -0400] jmartin: i.e. you just have maybe a jenkins job that pushes the latest cookbooks after a merge?
[2013-10-03 19:30:38 -0400] jmickle: jmartin: we have a private git repo and the master branch is the single source of truth
[2013-10-03 19:30:49 -0400] jmickle: jmartin: all our devs work off branches then we code review and merge to master
[2013-10-03 19:30:50 -0400] bean__: glen: that is not a good idea in general. What are you attempting to accomplish with "probe"
[2013-10-03 19:31:01 -0400] jmickle: jmartin: then jenkins picks it up runs a bunch of tests and then commits to the servers
[2013-10-03 19:31:12 -0400] jmartin: jmickle: yep, thats what im lookin for hah
[2013-10-03 19:31:15 -0400] jmickle: jmartin: no devs can do knife uploads only a couple of us can do a knife upload for emergency
[2013-10-03 19:31:43 -0400] jmartin: jmickle: do you use test-kitchen to automate reviews etc?
[2013-10-03 19:31:55 -0400] jmickle: jmartin: and our jenkins job essentially takes care of posting the changes to each server
[2013-10-03 19:31:58 -0400] siezer: jmickle so if you use berks for dev, how do you seperate it out from prod? vendoring into a flat chef-repo/cookbooks?
[2013-10-03 19:32:06 -0400] jmickle: jmartin: yes we use test-kitchen and food critic a well as some home bread stuff
[2013-10-03 19:32:21 -0400] jmickle: siezer: thats why we don't use berks
[2013-10-03 19:32:37 -0400] siezer: im confused
[2013-10-03 19:32:52 -0400] jmickle: we don't use berkshelf
[2013-10-03 19:33:07 -0400] jmickle: we have 1 chef repo
[2013-10-03 19:33:09 -0400] jmickle: everyone forks it
[2013-10-03 19:33:16 -0400] siezer: yikes
[2013-10-03 19:33:21 -0400] jmickle: why so?
[2013-10-03 19:33:48 -0400] jmickle: data bags hold all critical information
[2013-10-03 19:33:53 -0400] jmickle: and those are not kept in the main master
[2013-10-03 19:33:55 -0400] bjorn248: Hey, does anyone know how to create a file at compile time and not execution time?
[2013-10-03 19:33:57 -0400] siezer: so all cookbooks are under the chef-repos git?
[2013-10-03 19:34:14 -0400] siezer: bjorn248 no no no no no no
[2013-10-03 19:34:26 -0400] siezer: why do you think you want to do that
[2013-10-03 19:34:27 -0400] jmickle: siezer: yes all our cookbooks are in 1 chef-repo and we version with git, but no one can commit to master without it going through testing
[2013-10-03 19:34:35 -0400] bjorn248: siezer: because I'm running into this issue
[2013-10-03 19:34:35 -0400] bjorn248: https://wiki.opscode.com/display/chef/Troubleshooting+and+Technical+FAQ#TroubleshootingandTechnicalFAQ-WhyismyChefruncrashingonarequirestatementforagemthatshouldhavebeeninstalledviaChef?
[2013-10-03 19:34:59 -0400] jmartin: jmickle: you could still do separate repos for cookbooks id imagine
[2013-10-03 19:35:00 -0400] bjorn248: basically, a template in the same recipe references a file that the selfsame recipe creates, but it never runs because it can't be compiled
[2013-10-03 19:35:28 -0400] siezer: bjorn248 can you url shorten that? my terminal client is preventing me from cleanly pasting that
[2013-10-03 19:35:31 -0400] jmickle: jmartin: we could and have in the past. we just like to keep it simple less complexity that devs have to worry about to get their code running the better
[2013-10-03 19:35:54 -0400] bjorn248: siezer: you should be able to click links in your terminal, depending on which OS you are using :P
[2013-10-03 19:35:58 -0400] glen: bean__: detect what kind of recipes i want to run there eventually
[2013-10-03 19:36:04 -0400] bjorn248: for example on osx it's cmd + click
[2013-10-03 19:36:07 -0400] jmartin: jmickle: happen to know how long it took you to get that setup rockin and rollin?
[2013-10-03 19:36:17 -0400] bjorn248: I'm also using irssi
[2013-10-03 19:36:18 -0400] bean__: glen: I guess I still dont understand what you mean by that.
[2013-10-03 19:36:18 -0400] siezer: jmickle so how do you test? when up a whole paralell infrastructure somewhere?
[2013-10-03 19:36:31 -0400] jmartin: jmickle: id like to ballpark myself to a reasonable timeline
[2013-10-03 19:37:09 -0400] bean__: glen: that's a poor way of doing that. Why not just throw "php" on there to begin with?
[2013-10-03 19:37:12 -0400] jmickle: jmartin: tooling took a couple of weeks we have a web interface for devs to modify essentially anything based on their permissions levels
[2013-10-03 19:37:41 -0400] jmickle: jmartin: devs can also spin up time boxed cloud instances on our web based tool with very little effort and selecting the recipes they want and attribute overrides they want
[2013-10-03 19:37:52 -0400] glen: bean__: that would need me to poke each machine and see what it needs, and then still do it manually
[2013-10-03 19:38:03 -0400] jmickle: jmartin: because we run VPC for everything, we have diff subnets for these things like a DEV subnet that gets no public access
[2013-10-03 19:38:38 -0400] bean__: glen, I guess I'm not sure why you need to poke around on the machine
[2013-10-03 19:38:38 -0400] glen: bean__: i use it when bootstrapping, the probe recipe removes itself from run list when it runs
[2013-10-03 19:38:52 -0400] glen: bean__: because you refuse to understand?
[2013-10-03 19:38:59 -0400] bean__: glen: i take offense to that.
[2013-10-03 19:39:04 -0400] bean__: I'm trying to understand
[2013-10-03 19:39:04 -0400] jmartin: jmickle: interesting, have you automated the build out of your tooling as well? i.e. did you use your current setup to try and deploy another copy?
[2013-10-03 19:39:15 -0400] bjorn248: siezer: here's the recipe http://pastie.org/8375739 ...basically this doesn't compile because the template can't load the file that the cookbook_file creates...if I remove then re-add the template block it works, but the recipe has to be run twice
[2013-10-03 19:39:17 -0400] bean__: glen: normally you launch a machine with the intent of it doing something
[2013-10-03 19:39:25 -0400] bean__: are these old machines that you're just adding chef to?
[2013-10-03 19:39:30 -0400] glen: bean__: yeah, but if you already have FULL system running
[2013-10-03 19:39:41 -0400] jmickle: jmartin: our tooling is just a python-django app we could easily deploy it and its not crucial to be templates but yes we can deploy it if needed
[2013-10-03 19:39:45 -0400] bean__: glen: that would have been nice to know rather than insulting me.
[2013-10-03 19:40:13 -0400] jmartin: jmickle: i mean the jenkins server with TK setup etc
[2013-10-03 19:40:24 -0400] bean__: glen: for existing machines I just have chef do very very minimal stuff. And then rebuild it with chef in mind.
[2013-10-03 19:40:28 -0400] jmickle: jmartin: oh yeah jenkins is all done through the jenkins cookbook
[2013-10-03 19:41:01 -0400] glen: bean__: but i took this approach, and the recipes i develop on the run, then need to go over all machines and "attach" new recipes
[2013-10-03 19:41:03 -0400] jtimberman: ....
[2013-10-03 19:41:03 -0400] bjorn248: siezer: here's the shortened link
[2013-10-03 19:41:04 -0400] bjorn248: http://bit.ly/19kRNgM
[2013-10-03 19:41:09 -0400] siezer: saw it
[2013-10-03 19:41:22 -0400] jmartin: jmickle: very nice, i think thats where i probably need to start
[2013-10-03 19:41:26 -0400] glen: bean__: php recipe was just sample, in real cases those recipes are applications or so
[2013-10-03 19:41:33 -0400] bjorn248: siezer: any workarounds?
[2013-10-03 19:41:39 -0400] bean__: glen: the best thing I can think of is for it to trigger chef-client to run again.
[2013-10-03 19:41:44 -0400] bean__: w/ a notification
[2013-10-03 19:41:45 -0400] glen: bean__: but my original question was, is there way to restart run list when recipe modifies it
[2013-10-03 19:41:51 -0400] siezer: okay so yea use the .run_action(:install)
[2013-10-03 19:41:56 -0400] siezer: for the chef_gem resource
[2013-10-03 19:42:06 -0400] siezer: it should be doing that automatically tho
[2013-10-03 19:42:10 -0400] glen: bean__: because i saw some cookbooks that modify low level chef stuff and restart things, like the handlers
[2013-10-03 19:42:15 -0400] bjorn248: I'm not installing a chef-gem
[2013-10-03 19:42:33 -0400] bjorn248: the issues are related because it's trying to find a resource at compile time that will not exist until execution time
[2013-10-03 19:42:54 -0400] siezer: right. this problem is the worst.
[2013-10-03 19:43:10 -0400] siezer: it creates an arms race of work into the compilation phase
[2013-10-03 19:43:15 -0400] siezer: and it needs to die
[2013-10-03 19:43:15 -0400] jmickle: jmartin: its just a matter of finding the easiest approach. our way isn't necessary the right way but it works
[2013-10-03 19:43:15 -0400] bean__: glen: I can't say I've done it. I have heard its not recommended though.
[2013-10-03 19:43:16 -0400] siezer: so
[2013-10-03 19:43:30 -0400] siezer: depending on your problem, one thing you may be able to do is:
[2013-10-03 19:43:35 -0400] jmickle: jmartin: just think about all the things you need to do and are deploying and chose your tools based on that.
[2013-10-03 19:43:40 -0400] bjorn248: my question is why the check exists in the first place...
[2013-10-03 19:43:49 -0400] bjorn248: should be a runtime error
[2013-10-03 19:43:53 -0400] jmickle: jmartin: most people in here deploy ruby/python/php style apps so the typical community way is the easiest
[2013-10-03 19:44:04 -0400] jmickle: jmartin: we deploy erlang/scala/nodejs so ours is tricky
[2013-10-03 19:44:20 -0400] bean__: glen: I'd probably just use a "notifies "service[chef-client] :restart" or w/e the syntax is
[2013-10-03 19:44:25 -0400] bean__: to tell it to restart the service
[2013-10-03 19:44:43 -0400] glen: bean__: i run from cron, does that work there too?
[2013-10-03 19:44:59 -0400] bean__: not sure.
[2013-10-03 19:45:05 -0400] bean__: I've never run chef in cron
[2013-10-03 19:45:34 -0400] siezer: bjorn248 the best way to solve this (for now) is to create an LWRP that installs your prerequisite state before the resource that needs it
[2013-10-03 19:45:39 -0400] siezer: and make it use_inline_resources
[2013-10-03 19:45:53 -0400] jmartin: jmickle:  id like to setup something that is quite flexible. the amount of code review/changes we need to make are minimal at the moment, but if in the future that becomes quite a bit more regular, id like to already have a system in place that can handle that situation
[2013-10-03 19:46:05 -0400] siezer: that'll cause a compile+converge (mini chef run) to happen when the lwrp is executed
[2013-10-03 19:46:14 -0400] jmartin: so if i can automate as much as possible after a merge
[2013-10-03 19:46:22 -0400] jmartin: or pre-merge i suppose
[2013-10-03 19:46:33 -0400] bjorn248: siezer: I see, I've never done something like that before, but it sounds like exactly what I need.
[2013-10-03 19:46:33 -0400] jmickle: jmartin: definitely and that was the case for us. We release code almost 20 times a day and our chef infrastructure does it all including spinning down instances from load balancers
[2013-10-03 19:46:34 -0400] jmartin: thatd be great
[2013-10-03 19:46:45 -0400] jmickle: jmartin: thats why we chose the "different" route
[2013-10-03 19:47:05 -0400] bjorn248: I'll read the chef docs on writing LWRPs, thanks
[2013-10-03 19:48:08 -0400] siezer: bjorn248 a "chef-run" compiles a resource_collection, which is a 1-dimentional array of compiled resources. If something in the compilation phase depends on state that needs to be set during the convergence phase, you're basically boned.
[2013-10-03 19:48:20 -0400] siezer: the best thing to do is isolate the compile+converge phases
[2013-10-03 19:48:29 -0400] jmartin: jmickle: welp, its time to start figuring out how to get jenkins to run my test-kitchen builds, and pray that floating IP support is added to TK soon :D
[2013-10-03 19:48:32 -0400] siezer: use_inline_resources lets you add extra dimentions to that array
[2013-10-03 19:48:42 -0400] jmartin: for openstack that is
[2013-10-03 19:48:46 -0400] siezer: but now you're playing the game of LWRP-ifing All The Things
[2013-10-03 19:49:10 -0400] bjorn248: siezer: yeah, it seems like that's the only way to get around this particular problem though
[2013-10-03 19:49:33 -0400] jmickle: jmartin: PM
[2013-10-03 19:49:36 -0400] siezer: or, use run_action to arms-race work during the compilation phase
[2013-10-03 19:49:42 -0400] siezer: but there be seriousl dragons there
[2013-10-03 19:50:38 -0400] bjorn248: siezer: I feel like it might be a simpler fix...I mean all I have to do is write this file (it's a cookbook file) to somewhere on the file system
[2013-10-03 19:51:01 -0400] siezer: a cookbook file?
[2013-10-03 19:51:13 -0400] siezer: chef-client should be laying that down before anything happens
[2013-10-03 19:51:24 -0400] bjorn248: did you see my recipe? it's really simple
[2013-10-03 19:51:50 -0400] siezer: you linked to an faq on the wiki unless I missed something
[2013-10-03 19:52:02 -0400] bjorn248: http://pastie.org/8375739
[2013-10-03 19:53:10 -0400] siezer: okay so whats the issue with ie
[2013-10-03 19:53:16 -0400] siezer: s/ie/it/
[2013-10-03 19:53:44 -0400] bjorn248: siezer: line 21 fails compilation because the file doesn't exist on the machine yet...it's supposed to be created at execution time in the cookbook_file block
[2013-10-03 19:53:55 -0400] siezer: aaaaahhhhh
[2013-10-03 19:54:22 -0400] bjorn248: is there a way for me to just get the cookbook file directly instead of saving it to the system?
[2013-10-03 19:54:38 -0400] siezer: you encrypted_data_bag secret needs to be managed out of band of chef-client anyway
[2013-10-03 19:54:38 -0400] bjorn248: that way I can just reference the cookbook file on the server and possibly get around this entirely
[2013-10-03 19:55:01 -0400] siezer: how are you bootstrapping that node? knife? something else?
[2013-10-03 19:55:07 -0400] bjorn248: knife yeah
[2013-10-03 19:55:11 -0400] siezer: sec
[2013-10-03 19:58:32 -0400] siezer: okay so
[2013-10-03 19:58:36 -0400] siezer: first thing's first
[2013-10-03 19:59:05 -0400] siezer: you cant store both encrypted blobs and the private key to decrypt them in the same place
[2013-10-03 19:59:11 -0400] siezer: like you're doing, on your chef-server
[2013-10-03 19:59:18 -0400] bjorn248: lol, yeah
[2013-10-03 19:59:39 -0400] bjorn248: but I just didn't want this in git
[2013-10-03 19:59:41 -0400] siezer: the whole point of encrypted data bags is to protect the information in them from an untrustworthy chef-server administrator
[2013-10-03 20:00:21 -0400] gchristensen: ^ that. it isn't to protect you from yourself
[2013-10-03 20:00:38 -0400] bjorn248: right, like I said I just wanted the information out of git, so I added the private key to the gitignore
[2013-10-03 20:00:50 -0400] siezer: so, you can do this:
[2013-10-03 20:00:59 -0400] siezer: knife bootstrap yournode --secret-file
[2013-10-03 20:01:15 -0400] bjorn248: oh my god
[2013-10-03 20:01:18 -0400] siezer: and it'll render /etc/chef/encrypted_data_bag_secret on your node before chef-client
[2013-10-03 20:01:19 -0400] bjorn248: really?
[2013-10-03 20:01:26 -0400] bjorn248: incredible
[2013-10-03 20:01:27 -0400] bjorn248: lol
[2013-10-03 20:01:33 -0400] siezer: =)
[2013-10-03 20:01:58 -0400] bjorn248: well, that solves my issue
[2013-10-03 20:02:03 -0400] siezer: taadaa!
[2013-10-03 20:02:15 -0400] bjorn248: man
[2013-10-03 20:02:25 -0400] bjorn248: and I was about to learn all about LWRPs
[2013-10-03 20:02:27 -0400] siezer: the answer before that was "custom bootstrap script"
[2013-10-03 20:02:36 -0400] bjorn248: right
[2013-10-03 20:05:31 -0400] jmartin: random interjection
[2013-10-03 20:05:38 -0400] jmartin: might chef-vault be a solution as well?
[2013-10-03 20:08:26 -0400] siezer: havent had a chance to check that out yet
[2013-10-03 20:12:27 -0400] jchauncey: chef-vault is pretty cool
[2013-10-03 20:17:30 -0400] anoldhacker: I have a cookbook that I have just updated to version 1.6.3.  I have another cookbook that needs the latest change.  If in the metadata I say ~> 1.6.3, then a manual change will be needed to go to 1.7.  Correct?
[2013-10-03 20:22:57 -0400] anoldhacker: I'm going with depends 'a', '~> 1.6' ; conflicts 'a', '< 1.6.3'
[2013-10-03 20:23:32 -0400] Bob_: in /etc/sudoers, is Default !requiretty truly required for the whole machine, or can it be limited only to chef/vagrant's user?
[2013-10-03 20:24:11 -0400] scarolan: Bob_: you can do it per user like this:  Student Workshop:Basic Scholarship Strategy
[2013-10-03 20:24:14 -0400] scarolan: Start Date: 10/16/2013 (the workshop will not be accessible until this date)
[2013-10-03 20:24:17 -0400] scarolan: oops
[2013-10-03 20:24:23 -0400] scarolan: Defaults:username !requiretty
[2013-10-03 20:24:27 -0400] scarolan: there you go
[2013-10-03 20:24:57 -0400] Bob_: huh. ok. So, I've tried that, but am still seeing "sudo: sorry, you must have a tty to run sudo" during chef-client runs.
[2013-10-03 20:25:21 -0400] scarolan: oh, that's different
[2013-10-03 20:25:24 -0400] scarolan: chef-client needs to run as root
[2013-10-03 20:26:05 -0400] Bob_: ahh. ok. so, I'd have to !requiretty for root? *sigh*?
[2013-10-03 20:26:10 -0400] scarolan: are you trying to do ssh user@host "sudo chef-client"?
[2013-10-03 20:26:25 -0400] Bob_: in essence, I believe that is what vagrant does, yes.
[2013-10-03 20:28:33 -0400] scarolan: and your sudoers line is like this?
[2013-10-03 20:28:44 -0400] scarolan: Defaults:vagrant !requiretty
[2013-10-03 20:28:53 -0400] Bob_: correct.
[2013-10-03 20:29:54 -0400] scarolan: Bob_: lemme check something
[2013-10-03 20:30:14 -0400] Bob_: scarolan: Thanks for your help.
[2013-10-03 20:33:33 -0400] scarolan: Bob_: CAn you try this:  ssh -p 2222 vagrant@localhost "sudo chef-client"
[2013-10-03 20:33:43 -0400] scarolan: and then use 'vagrant' as the password
[2013-10-03 20:38:00 -0400] Bob_: scarolan: unfortunately it's not quite that simple, since this chef is being run from a chef server. I can run chef-client manually via ssh fine, but when it runs like that, it's not being provided with the chef server connection info, and so it fails.
[2013-10-03 20:38:32 -0400] Bob_: I've found the vagrant-specific IRC channel, so perhaps they might be able to help as well.
[2013-10-03 20:38:49 -0400] scarolan: I'm just trying to help with the tty/sudo issue first.  You might ask the vagrant folks, since "vagrant ssh" is kind of a wrapper around ssh
[2013-10-03 20:38:56 -0400] scarolan: i'm not sure if you can pass it the -t flag or not
[2013-10-03 20:39:56 -0400] bmoritz: Odd, the hostname cookbook is in the community list but there is no component for it in Opscode Jira Cookbooks project
[2013-10-03 20:46:48 -0400] siezer: bmoritz only the cookbooks opscode publishes to the comm site have an issue tracker there
[2013-10-03 20:47:04 -0400] siezer: hostname was written by customink iirc
[2013-10-03 20:47:25 -0400] bmoritz: So I will file my issue on Github, thanks!
[2013-10-03 20:52:49 -0400] djstunami: So does anyone here have experience with chef & solaris?
[2013-10-03 20:53:51 -0400] dgarstang: ok, this ain't workin.... in my Vagrantfile... 'chef.node_name = 'dn01''
[2013-10-03 20:58:38 -0400] dgarstang: Nope, don't work... http://docs.vagrantup.com/v2/provisioning/chef_solo.html ... chef.node_name = "foo" being ignored
[2013-10-03 21:01:23 -0400] wilywonka: hi i'm a total chef noob but when i try an example similar to the one on https://github.com/opscode-cookbooks/application_python I get:
[2013-10-03 21:01:25 -0400] wilywonka: FATAL: NameError: No resource found for gunicorn. Tried application_gunicorn, application_nginx_gunicorn, application_python_gunicorn, gunicorn
[2013-10-03 21:02:01 -0400] wilywonka: I have the application_python cookbook setup and was able to get the application cookbook alone to work without the django clause
[2013-10-03 21:16:05 -0400] dgarstang: Anyone got any idea why the chef.node_name would not be working here? http://pastebin.com/LY0MHd8e
[2013-10-03 21:19:37 -0400] rava`: hello all, do notifications fire from a resource even if the resource fails? or only if they succeed and saw a state chagne?
[2013-10-03 21:21:54 -0400] gad0lin: is there a way to easily clone all deps cookbok to specific location from Berksfile?
[2013-10-03 21:23:16 -0400] cwj: berks install help
[2013-10-03 21:23:26 -0400] cwj: berks install -p ./some/place/for/cookbooks
[2013-10-03 21:23:56 -0400] gad0lin: my use case is that I have 30+ inhouse cookbook and want to have one foodcritic job against all of them,  berks install --path nearly does the thing but it pulls too much, i explicitly say dont pull community group, but it will still pull many external cookbooks as I belive it will find them through metadata.rb
[2013-10-03 21:24:27 -0400] gad0lin: yes, as above install will download too much, and i will have warnings about community cookbooks, which I would like to avoid
[2013-10-03 21:24:40 -0400] cwj: try #berkshelf
[2013-10-03 21:26:45 -0400] dgarstang: Anyone got any idea why the chef.node_name would not be working here? http://pastebin.com/LY0MHd8e
[2013-10-03 22:00:37 -0400] dgarstang: omg. So, apparently vagrant likes config.vm.hostname = "nn01" but not config.vm.hostname = "nn01.foo.com"
[2013-10-03 22:02:27 -0400] siezer: ?
[2013-10-03 22:02:34 -0400] siezer: I set mine to something.dev.lap all the time
[2013-10-03 22:04:45 -0400] dgarstang: siezer: Not for me. When I have that, I get this... http://pastebin.com/41deWe4v
[2013-10-03 22:05:01 -0400] dgarstang: 'No error message' ... seriously. That's really what I get
[2013-10-03 22:05:24 -0400] dgarstang: change it back to 'nn01' works fine... change it back to 'nn01.foo.com'.... 'No error message'
[2013-10-03 22:06:20 -0400] dgarstang: but who the hell knows. I have to keep upgrading vagrant once a week to fix issues. Every time I upgrade the behaviour changes. One day 'vagrant up' is all I need. Upgrade and I have to do 'vagrant up --provision'. With the next release, it's changed again
[2013-10-03 22:31:37 -0400] benjohnson77: I updated the client on all my servers to 11.6.0 but I still can't get the cloud metadata on google compute cloud ... im going crazy
[2013-10-03 22:32:11 -0400] benjohnson77: is there any what to check/force the ohai version
[2013-10-03 22:32:13 -0400] stormerider: benjohnson77: have they all done a new run since?
[2013-10-03 22:32:38 -0400] gsymons-di: Do you have the appropriate hint in /etc/chef/ohai/hints?
[2013-10-03 22:32:39 -0400] benjohnson77: oh yeah I bootstraped several times ... still no cloud data
[2013-10-03 22:32:50 -0400] dgarstang: If I have confirmed that node["hadoop"]["primary_namenode"] is set with a log... what's wrong with template ... variables ({ :primary_nanenode => node["hadoop"]["primary_namenode"] }) and then in the template <%= @primary_namenode %> ?
[2013-10-03 22:34:16 -0400] benjohnson77: gsymons-di: instead of /etc/chef/ohai I have ohai_plugins
[2013-10-03 22:34:46 -0400] gsymons-di: benjohnson77: I might have the wrong path... hold on...
[2013-10-03 22:36:01 -0400] mahmoudimus: anyone use opsworks on aws with chef to bootstrap a chef server?
[2013-10-03 22:36:04 -0400] gsymons-di: benjohnson77: Nope, that's the right path. So the fact that you don't have it is probably why you're not getting the metadata.
[2013-10-03 22:37:07 -0400] dgarstang: *sigh*
[2013-10-03 22:37:09 -0400] gsymons-di: You probably need to add a /etc/chef/ohai/hints/gce.json or something to tell Ohai that the node is a google node.
[2013-10-03 22:37:21 -0400] dgarstang: gsymons-di: definitely.
[2013-10-03 22:38:21 -0400] benjohnson77: any tip what should go int the gce.json file
[2013-10-03 22:38:38 -0400] dgarstang: benjohnson77: nada
[2013-10-03 22:38:41 -0400] benjohnson77: or just the file there is enough
[2013-10-03 22:38:44 -0400] benjohnson77: ok
[2013-10-03 22:38:45 -0400] dgarstang: yep
[2013-10-03 22:38:54 -0400] benjohnson77: trying
[2013-10-03 22:38:58 -0400] dgarstang: i had to go through this pain with ec2
[2013-10-03 22:39:22 -0400] benjohnson77: then I run this curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-10-03 22:40:46 -0400] benjohnson77: I guess I assumed that the chef client install , install ohai with it
[2013-10-03 22:42:14 -0400] benjohnson77: rackspace worked without issue
[2013-10-03 22:42:22 -0400] gsymons-di: The various knife cloud plugins take care of adding the hint file for you during bootstrap now.
[2013-10-03 22:43:23 -0400] benjohnson77: ok
[2013-10-03 22:43:25 -0400] gsymons-di: If you're not provisioning with the knife plugin, then you'll have to put the hint file there yourself.
[2013-10-03 22:43:38 -0400] benjohnson77: I am using knife
[2013-10-03 22:44:25 -0400] gsymons-di: Are you doing a 'knife bootstrap' or a 'knife google server create'?
[2013-10-03 22:44:25 -0400] benjohnson77: but gce support was just added recently I think
[2013-10-03 22:44:39 -0400] benjohnson77: I am using knife bootstrap
[2013-10-03 22:46:23 -0400] gsymons-di: Btw, the hints file should actually be /etc/chef/ohai/hints/google.json
[2013-10-03 22:46:49 -0400] gsymons-di: From looking at the source for the knife-google plugin:)
[2013-10-03 22:47:04 -0400] gsymons-di: So, yeah, it should be creating the hints file for you.
[2013-10-03 22:47:36 -0400] benjohnson77: so would having the ohai recipe in my run list cause the issue
[2013-10-03 22:48:02 -0400] gsymons-di: I can't think of a reason why...
[2013-10-03 22:48:07 -0400] benjohnson77: I added it there just for good mesure .. not because I have an ohai plugin or anything
[2013-10-03 22:48:14 -0400] benjohnson77: ok
[2013-10-03 22:48:33 -0400] benjohnson77: Im also using debian 7
[2013-10-03 22:48:57 -0400] gsymons-di: Yeah, I can't think of a reason for that to make a difference, either.
[2013-10-03 22:56:19 -0400] benjohnson77: no love
[2013-10-03 22:56:59 -0400] gsymons-di: Hmm...  that's all I've got... never used GCE.
[2013-10-03 22:58:18 -0400] benjohnson77: I tried updating knife-google
[2013-10-03 22:58:29 -0400] benjohnson77: but let me look into that some more
[2013-10-03 22:58:32 -0400] benjohnson77: so close
[2013-10-03 22:59:09 -0400] benjohnson77: search doesn't return IP's so I can't use it in deploys or in some recipes like nagios
[2013-10-03 22:59:28 -0400] benjohnson77: gotta get me some IP's in here.
[2013-10-03 23:34:01 -0400] wilywonka: does chef-solo have issues with lwrp's like application_python
