[2013-10-16 00:32:28 -0400] flaccid: i tried firefox and chromium, but i cannot select category when doing http://community.opscode.com/cookbooks/new
[2013-10-16 00:32:33 -0400] flaccid: is this a bug?
[2013-10-16 01:05:46 -0400] Rich_: maybe dumb question: How do I "register" the Windows Reboot Handler so that a windows_reboot resource will actually result in a reboot?
[2013-10-16 01:10:16 -0400] Rich_: or, for that matter, find documentation about registering ANY handler.
[2013-10-16 01:37:50 -0400] definitely_not_s: Chef Meetup: Rountable On Cookbook Best Practice, Design Patterns, and Challenging Problems: https://plus.google.com/hangouts/_/0e06ec64c6b17e8ad1d1d94d47ec0f8c71b8b5a2
[2013-10-16 02:05:55 -0400] njero: hi #chef, I am trying to get my users to load via knife-solo. I have a data_bag with my user and I have a role that has recipe[users] recipe[users::sysadmins]. I also have chef-solo-search in the runlist. Yet the user doesn't get created. Any ideas?
[2013-10-16 02:18:43 -0400] teukka: njero: and the user has "sysadmin" group listed in its databag item?
[2013-10-16 02:19:48 -0400] Glace: Hi everyone, I was wondering if its possible to generate version constraints in the metdata file with berkshelf? with the lock file
[2013-10-16 02:21:20 -0400] Glace: I see that it can apply the lock to the environment.. but thats not what I want since.. there can be more than 1 application cookbook in the environment
[2013-10-16 03:09:24 -0400] arussel: when using 'package "curl"' how is the curl version decided ? the java cookbook uses it but tries to install an old version not found in the repo.
[2013-10-16 03:09:48 -0400] flaccid: its decided by the system's package manager
[2013-10-16 03:10:06 -0400] flaccid: java needs curl?, weird..
[2013-10-16 03:12:47 -0400] arussel: flaccid: when I 'apt-get install curl', It get installed, but here chef is doing: "apt-get -q -y install curl=7.22.0-3ubuntu4.1"
[2013-10-16 03:13:04 -0400] flaccid: arussel: url to the chef code online please
[2013-10-16 03:13:05 -0400] arussel: and the current version is ...ubuntu4.3
[2013-10-16 03:14:06 -0400] arussel: line 67: https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb
[2013-10-16 03:15:41 -0400] arussel: stacktrace: http://pastebin.com/sh22aLbc
[2013-10-16 03:16:45 -0400] arussel: the one I can install is: Get:2 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main curl i386 7.22.0-3ubuntu4.3 [138 kB]
[2013-10-16 03:16:48 -0400] flaccid: right, which ubuntu are you using?
[2013-10-16 03:17:13 -0400] flaccid: try doing an apt-get update first and check the apt repos conf to make sure it is right
[2013-10-16 03:23:29 -0400] njero: teukka: I just saw your message and added the sysadmin group and that fixed everything! Again!
[2013-10-16 03:23:33 -0400] njero: You are my hero!
[2013-10-16 03:27:51 -0400] teukka: njero: haha, thanks :D
[2013-10-16 03:28:23 -0400] njero: teukka: you've been saving me all day :)
[2013-10-16 03:28:43 -0400] njero: teukka: If I could send you some of the ice-cream I just had...
[2013-10-16 03:30:25 -0400] teukka: njero: I live now in Argentina. the ice-cream here is fantastic! Italian but improved as the locals say ;)
[2013-10-16 03:31:33 -0400] teukka: but thanks for the kind words! it's nice that I could be of help
[2013-10-16 03:33:49 -0400] njero: :D
[2013-10-16 03:34:13 -0400] njero: If I am ever in Argentina I am looking you up and buying you a beer :)
[2013-10-16 03:38:31 -0400] arussel: flaccid: adding include_recipe "apt" before seems to have fixed it. But shouldn't apt either not ask for a specific version or run the update if it wants a specific version ?
[2013-10-16 03:41:20 -0400] jchauncey: running test kitchen tests on a laptop will quickly drain your battery
[2013-10-16 03:41:56 -0400] flaccid: arussel: apt::default will update the pkg cache via apt-get update if its old, which is why you should use it
[2013-10-16 03:42:20 -0400] flaccid: the provider will ask for a specific version per the apt pkg cache..
[2013-10-16 03:42:40 -0400] arussel: flaccid: got it, thanks for your help.
[2013-10-16 03:44:20 -0400] flaccid: arussel: np
[2013-10-16 06:41:17 -0400] Garo_: does anybody have a good opinion how to build chef recipes which deploy entire cluster of servers into ec2? We're currently using Rightscale and I'm getting fed up with its input system where I need to use it's web ui to define variables into the chef recipes. My goal is to build scripts which can deploy an entire ec2 region with multiple instances with just a handful of cmd commands. We're already using chef recipes, but ...
[2013-10-16 06:41:23 -0400] Garo_: ... they work within rightscale
[2013-10-16 06:50:12 -0400] superio: has anyone experience with chef+opsworks?
[2013-10-16 06:51:14 -0400] njero_: estahn, Garo_: I built a tool that uses chef-solo in an ad-hoc way and is backed by a github repo of cookbooks
[2013-10-16 06:52:23 -0400] njero: Garo_: it was a bit crufty but it managed a lot of servers for us: https://github.com/jeffrafter/annex
[2013-10-16 06:53:04 -0400] estahn: i like the testing chapter ;)
[2013-10-16 06:53:12 -0400] Garo_: :D
[2013-10-16 06:53:49 -0400] njero: estahn: honesty is the best policy :)
[2013-10-16 06:54:05 -0400] Garo_: njero: thanks, I'll take a look on it. Do you feel that it's good as-it-is, or do you see some features/problems which you'd like to do differentially?
[2013-10-16 06:55:38 -0400] estahn: i try to get chef installing solr_app but get the error NameError - uninitialized constant Chef::Resource::ApplicationBase
[2013-10-16 06:55:40 -0400] njero: Garo_: there were definitely some aspects to the spin up and bootstrap that was too slow for us. Rolling out a dozen servers would take just under an hour. Ideally you would do this with prebuilt AMIs (which the AWS Ruby kit allows for)
[2013-10-16 06:57:30 -0400] njero: Garo_: also, there were hacks to take our topology (from the config) and move it up to each server and hardwire everything together. That involves a lot of assumptions about naming, etc. Ultimately we were replacing it with an Ansible set of scripts which had command and control from an etcd server
[2013-10-16 06:58:18 -0400] Garo_: njero: this? http://coreos.com/blog/distributed-configuration-with-etcd/
[2013-10-16 06:58:37 -0400] njero: Garo_: yes
[2013-10-16 06:59:10 -0400] njero: Garo_: annex worked well in production but we were midsized. We were growing out of it
[2013-10-16 06:59:34 -0400] fitzdsl_: Hello. Is there any doc on how to sync the state of multiple chef-servers distributed arround the world ? Like when drbd is just not possible ?
[2013-10-16 07:00:25 -0400] Garo_: we're currently running around 70 instances. I don't want to bring in another rightscale-type system which we have already grew out of it
[2013-10-16 07:07:11 -0400] Garo_: anyway I feed that we need some kind of orchestrating server which knows what instances there are with what services. etcd might be suitable for its datastorage in case we want to build the orchestrating server on our own, but I'm not looking forward on that
[2013-10-16 07:08:16 -0400] Garo_: we could also look on amazon chef opscode stuff
[2013-10-16 08:13:07 -0400] estahn: has anyone used solr_app before?
[2013-10-16 08:23:26 -0400] daxroc: Morning all
[2013-10-16 08:25:01 -0400] daxroc: On a chef-client run should ohai be looking for os.rb and kernel.rb in the custom plugin_path. I've multiple errors in the debug output for standard ohai plugins. I am using the ohai cookbook for my own plugins
[2013-10-16 09:15:33 -0400] ikrima: hey guys, trying to install chef on windows and get a basic sample going but I keep running into this error: FATAL: Erb template templates/default/hello-world.txt.erb has a syntax error: FATAL: 'erubis' is not recognized as an internal or external command,
[2013-10-16 09:15:58 -0400] ikrima: any ideas? I have "Hello world" in my template file
[2013-10-16 09:18:39 -0400] s2r2: ikrima: https://tickets.opscode.com/browse/CHEF-2661  sounds suspiciously like this
[2013-10-16 09:18:49 -0400] s2r2: ikrima: what's your chef version?
[2013-10-16 09:19:39 -0400] ikrima: s2r2: 11.11.6.2-1
[2013-10-16 09:19:57 -0400] proffalken: Garo_: have you checked out Mcollective? It works with Chef and might solve some of your problems
[2013-10-16 09:20:01 -0400] s2r2: ikrima: ok nevermind, not this bug then.
[2013-10-16 09:20:15 -0400] Garo_: proffalken: no, I haven't, but I will. thanks
[2013-10-16 09:20:53 -0400] ikrima: I downloaded the latest version via installer and tried to get a test running
[2013-10-16 09:21:01 -0400] proffalken: Garo_: np
[2013-10-16 09:21:06 -0400] Garo_: proffalken: at first eye it looks like it's for puppet, but it seems that it also support chef, right? =)
[2013-10-16 09:21:09 -0400] ikrima: 3 hours later, still stuck in the same spot
[2013-10-16 09:21:20 -0400] proffalken: yes, it does
[2013-10-16 09:21:46 -0400] proffalken: Volcane (who wrote it) wrote it with puppet in mind, however there is a plugin for ohai that gives you all the chef goodness
[2013-10-16 09:22:01 -0400] proffalken: Volcane works a lot with Puppet Labs, so it's biased that way...
[2013-10-16 09:24:04 -0400] daxroc: Why would chef-client not run an ohai plugin in /etc/chef/ohai_plugin path? It's running another in the same path but in the ohai cookbook plugins path
[2013-10-16 09:28:31 -0400] proffalken: Garo_: as an example, http://www.devco.net/archives/2012/06/23/mcollective-2-0-complex-discovery-statements.php has some illustrations as to what you can do with MC
[2013-10-16 09:31:13 -0400] JeanMertz: Hey guys, if you have several resources that need to run in succession, but one might fail (f.e. connection timeout while mounting an EC2 ESB volume), do you then simply not use notifications and just define then after eachother? (I ask, because, when using notifications, and step 2 of 3 timesout, and step 2 is called from 1, and 3 from 2, then when 1 finished on run 1, it wont run again, and thus 2 and 3 are never completed)
[2013-10-16 09:31:30 -0400] JeanMertz: *EBS volume
[2013-10-16 09:33:55 -0400] ikrima: does anyone create chef recipes on windows?
[2013-10-16 10:16:50 -0400] Cope: yes, lots of people do
[2013-10-16 10:26:25 -0400] matti: Cope: I've read your book recently. Nicely done, +1 :)
[2013-10-16 10:26:39 -0400] Garo_: what book? =)
[2013-10-16 10:27:13 -0400] matti: Garo_: http://shop.oreilly.com/product/0636920020042.do
[2013-10-16 10:27:24 -0400] Cope: If you like it, give it stars! :)
[2013-10-16 10:27:42 -0400] dmdeklerk: Cope: Stephen Nelson Smith? Sorry to butt in.  What about the Definitive Guide, would really like to read that one too.
[2013-10-16 10:27:56 -0400] dmdeklerk: Cope: Is it out yet?
[2013-10-16 10:28:21 -0400] Cope: It will never be out.
[2013-10-16 10:28:30 -0400] Cope: I have tweeted about this several times :(
[2013-10-16 10:28:33 -0400] dmdeklerk: thats too bad.
[2013-10-16 10:28:37 -0400] Cope: The decision has been made that:
[2013-10-16 10:28:42 -0400] Cope: 1) Learnchef is good
[2013-10-16 10:28:48 -0400] Cope: 2) docs.opscode.com is great
[2013-10-16 10:28:54 -0400] Cope: 3) chef is changing still
[2013-10-16 10:29:07 -0400] drrk: docs.opscode.com is terrible!
[2013-10-16 10:29:12 -0400] Cope: so a "definitive guide" is premature and probably not needed
[2013-10-16 10:29:16 -0400] drrk: it's the wiki with all the usefule information taken away
[2013-10-16 10:29:18 -0400] matti: docs.opscode.com are ... .... ;s
[2013-10-16 10:29:35 -0400] Cope: instead the strategy is to write subject-specific books
[2013-10-16 10:29:44 -0400] arussel: Cope: I was waiting for that definitive guide .... it is really badly needed
[2013-10-16 10:29:48 -0400] matti: Cope: Sounds like a better idea, indeed ;]
[2013-10-16 10:29:59 -0400] dmdeklerk: I'm currently reading this.. http://www.packtpub.com/chef-infrastructure-automation-cookbook/book its pretty good too!
[2013-10-16 10:30:07 -0400] Cope: arussel: what is the need which is unmet?
[2013-10-16 10:30:17 -0400] Cope: dmdeklerk: is that mathaius book?
[2013-10-16 10:30:32 -0400] dmdeklerk: Cope: Btw, thank you for writing Test-Driven Infrastructure with Chef. It really helped me
[2013-10-16 10:30:36 -0400] dmdeklerk: Cope: yes
[2013-10-16 10:31:07 -0400] arussel: Cope: you can't get up and running just with chef doc and learnchef. It takes far too long and search on google.
[2013-10-16 10:31:13 -0400] Cope: arussel: I (we) are open to rethinking...
[2013-10-16 10:31:23 -0400] Cope: arussel: seth vargo is working on a chef beginners guide
[2013-10-16 10:32:23 -0400] arussel: learnchef is a step in the right direction, but doesn't answer what should be in the definitive guide:
[2013-10-16 10:32:26 -0400] dmdeklerk: arussel: yes you can, I did that, its a steap curve ;)
[2013-10-16 10:32:50 -0400] arussel: -b best pratice for recipe (iirc, learnchef is actually using something as bad practice)
[2013-10-16 10:32:55 -0400] arussel: - how to debug recipe
[2013-10-16 10:34:14 -0400] arussel: It is hard to tell exactly what is missing from chef doc, but you can read it and still not know what chef is about :-)
[2013-10-16 10:34:33 -0400] arussel: - chef server up and running with help on configuration
[2013-10-16 10:34:56 -0400] Cope: arussel: I am open to writing whatever book meets the community need
[2013-10-16 10:35:11 -0400] arussel: Cope: you're mad :-)
[2013-10-16 10:35:30 -0400] Cope: but it takes a long time to write books, and a REALLY long time to write big books, so it's best to try to keep it focussed on a specific domain or problem.
[2013-10-16 10:35:42 -0400] Cope: Anyway - my pair is looking at me fiercely
[2013-10-16 10:35:44 -0400] Cope: back to work
[2013-10-16 10:36:01 -0400] arussel: Cope: I completely agree with you
[2013-10-16 10:37:05 -0400] arussel: btw, add a chapter per usefull tool: berkshelf, vagrant ...
[2013-10-16 10:37:34 -0400] dmdeklerk: I myself learned ruby through http://ruby.railstutorial.org/ruby-on-rails-tutorial-book, which takes you by the hand while creating a complete setup, includes some ruby and testing. Something like that for chef would have really helped speed up my learning process.
[2013-10-16 10:37:54 -0400] dmdeklerk: make that rails, ruby I learned from the pickaxe
[2013-10-16 10:38:21 -0400] dmdeklerk: docs.opscode.org is actually pretty hard to get into
[2013-10-16 10:48:47 -0400] sgronblom: Should a cookbook depend on both apt and yum at the same time?
[2013-10-16 10:53:17 -0400] 44UAAC878: sgronblom: depends on what the cookbook does
[2013-10-16 10:54:05 -0400] sgronblom: I'm looking at this cassandra cookbook on github atm https://github.com/michaelklishin/cassandra-chef-cookbook/blob/master/metadata.rb
[2013-10-16 10:54:42 -0400] sgronblom: Ah but this is just a dependency
[2013-10-16 10:55:04 -0400] sgronblom: Doesn't necessarily mean that apt and yum will be installed at the same time
[2013-10-16 10:55:05 -0400] 44UAAC878: sgronblom: well yeah it supports those kind of platforms, https://github.com/michaelklishin/cassandra-chef-cookbook#supported-os-distributions
[2013-10-16 10:55:11 -0400] 44UAAC878: thats right
[2013-10-16 10:55:24 -0400] sgronblom: Makes sense
[2013-10-16 10:55:45 -0400] laurent\: i'd love to see conditionnal dependencies in cookbooks
[2013-10-16 10:55:50 -0400] flaccid__: me too
[2013-10-16 10:55:52 -0400] flaccid__: or optional
[2013-10-16 10:55:57 -0400] laurent\: yeah or optional
[2013-10-16 10:56:11 -0400] laurent\: a bit like apt's recommend
[2013-10-16 10:56:12 -0400] flaccid__: well and/or
[2013-10-16 10:57:02 -0400] flaccid__: conditional in context of chef would error you if a cookbook wasn't found when needed on a platform where the condition was true
[2013-10-16 11:11:30 -0400] [1]sam: Hello, I was wondering if there is anyone who can tell me if it is possible to make a recipe or cookbook or w/e for the deploying of a vm (in vsphere) I am aware that there is a knife vsphere and I can make a clone, but how do I create a recipe / cookbook for it?
[2013-10-16 11:11:58 -0400] [1]sam: I want to be able to deploy a new machine from the webui
[2013-10-16 12:18:40 -0400] GreatSUN: Hi all
[2013-10-16 12:19:22 -0400] GreatSUN: can someone offer some documentation how I can automate a couple of windows application installations which require a reboot between?
[2013-10-16 12:20:27 -0400] GreatSUN: I can see two possibilities wright now.... 1. have some handler that takes the reboot request and act like it would have been rebooted, to be able to install other application(s)
[2013-10-16 12:21:15 -0400] GreatSUN: 2. have some status held in node/file/system and run chef on all reboot until it has installed all software
[2013-10-16 12:21:52 -0400] GreatSUN: whilst I only know this possibilities in theory and have no real idea how to build up such a solution properly
[2013-10-16 12:22:14 -0400] GreatSUN: I mean build it up so that it is wokring
[2013-10-16 12:22:27 -0400] GreatSUN: does anyone of you guys have some information onto this?
[2013-10-16 12:22:29 -0400] s2r2: I don't know windows but can't you do something like: execute "reboot" do only_if { check_that_triggers_after_install_of_app } end -- and have your resources installing the applications in a way that they won't do the install again if it is installed alreadythen just chef-run in boot?
[2013-10-16 12:23:12 -0400] GreatSUN: s2r2: that would be solution 2 ;-)
[2013-10-16 12:23:21 -0400] flaccid__: congrats to opscode. there is 100 cookbooks!
[2013-10-16 12:23:30 -0400] GreatSUN: s2r2: but I just don't know how to properly restart chef after reboot
[2013-10-16 12:23:30 -0400] s2r2: GreatSUN: true :)
[2013-10-16 12:23:49 -0400] flaccid__: i remember there is something like chef-reboot
[2013-10-16 12:23:54 -0400] GreatSUN: might work, but could also not work, cause normally it is started as a user
[2013-10-16 12:23:55 -0400] s2r2: GreatSUN: yesterday I learned there's a cloud-init for windows (from cloudbase)...
[2013-10-16 12:24:03 -0400] GreatSUN: flaccid__: windows_reboot
[2013-10-16 12:24:49 -0400] GreatSUN: s2r2: some service to run chef?
[2013-10-16 12:25:05 -0400] flaccid__: GreatSUN: https://github.com/Afterglow/chef-reboot doesn't work on windows?
[2013-10-16 12:25:48 -0400] s2r2: among other things, yes: https://github.com/cloudbase/cloudbase-init/  It says openstack there, but if it's a proper port of cloud-init it will eat a variety of data sources
[2013-10-16 12:25:53 -0400] GreatSUN: dunno
[2013-10-16 12:25:56 -0400] GreatSUN: but https://github.com/opscode-cookbooks/windows/blob/master/README.md
[2013-10-16 12:26:01 -0400] GreatSUN: is doing the stuff
[2013-10-16 12:26:15 -0400] GreatSUN: besides I still depend another chef run after reboot
[2013-10-16 12:26:23 -0400] GreatSUN: and dunno how to implement this
[2013-10-16 12:26:29 -0400] flaccid__: there is a many fork and fragmentation of cloud-init
[2013-10-16 12:27:00 -0400] flaccid__: GreatSUN: is it in a cloud?
[2013-10-16 12:27:32 -0400] s2r2: yesterday, I also learned the you can run chef-client on windows (and even install chef) on boot using cloudbase's cloud-init and powershell.  so, it is possible.
[2013-10-16 12:27:34 -0400] s2r2: ;)
[2013-10-16 12:27:40 -0400] GreatSUN: flaccid__: yeah, but the cloud is setup and kind of self designed
[2013-10-16 12:27:45 -0400] wonko_be: hi, is there an easy way to pass a certain variable from the knife bootstrap command to the boostrap.erb file?
[2013-10-16 12:28:01 -0400] flaccid__: GreatSUN: what cloud is it ?
[2013-10-16 12:28:05 -0400] GreatSUN: I dunno if cloud-init could be used
[2013-10-16 12:28:26 -0400] wonko_be: something link knife bootstrap --data foo=bar ... so to have <%= foo %> in the erb?
[2013-10-16 12:28:41 -0400] GreatSUN: flaccid__: self built software (not mine and I have no possibility to influence it) that administrates vmware vcenter
[2013-10-16 12:29:02 -0400] GreatSUN: the cloud is based on vagrant and chef-solo
[2013-10-16 12:29:11 -0400] GreatSUN: to mention some tool stuff ;-)
[2013-10-16 12:29:20 -0400] flaccid__: thats not a cloud.
[2013-10-16 12:29:50 -0400] GreatSUN: ok, vagrant manages the building of the nodes and chef-solo manages installation
[2013-10-16 12:30:00 -0400] flaccid__: still not a cloud
[2013-10-16 12:30:07 -0400] GreatSUN: flaccid__: I know :-P
[2013-10-16 12:30:34 -0400] GreatSUN: flaccid__: it's not easy to describe a blackbox from outside, you know
[2013-10-16 12:30:42 -0400] flaccid__: if its vagrant, run vagrant provision and ensure what you wanna do is in Vagrantfile. solved.
[2013-10-16 12:31:07 -0400] flaccid__: eh cook up your own non standard thing, thats your problem y0
[2013-10-16 12:31:12 -0400] GreatSUN: flaccid__: I just know that there is a vcenter as backend and that the vms themselves are built up using vagrant and chef-solo
[2013-10-16 12:31:42 -0400] GreatSUN: flaccid__: it's not mine... I just have to find solution for my problem with it :/
[2013-10-16 12:32:24 -0400] flaccid__: GreatSUN: you are talking to the wrong people. talk to your people.
[2013-10-16 12:32:28 -0400] GreatSUN: flaccid__: I don't know in deep about vagrant stuff
[2013-10-16 12:32:46 -0400] flaccid__: ^
[2013-10-16 12:47:12 -0400] arussel: I don't get how I can have: http://pastebin.com/b1zWWXF0 considering:
[2013-10-16 12:47:19 -0400] arussel: https://github.com/opscode-cookbooks/maven/blob/v1.0.0/attributes/default.rb and
[2013-10-16 12:47:37 -0400] arussel: https://github.com/opscode-cookbooks/maven/blob/v1.0.0/recipes/default.rb
[2013-10-16 12:48:19 -0400] arussel: it shows that version  node['maven'][mvn_version]['version'] is 3.1.3, but then doesn't use it for the url ...
[2013-10-16 12:48:41 -0400] arussel: how could an attribute be different ?
[2013-10-16 12:52:15 -0400] s2r2: https://github.com/opscode-cookbooks/maven/blob/v1.0.0/attributes/default.rb#L31  is consistent with the paste bin, isn't it?
[2013-10-16 12:52:34 -0400] s2r2: at least wrt. the url
[2013-10-16 12:52:51 -0400] arussel: default['maven']['3']['url'] = "http://apache.mirrors.tds.net/maven/maven-3/#{node['maven']['3']['version']}/binaries/apache-maven-#{node['maven']['3']['version']}-bin.tar.gz"
[2013-10-16 12:53:22 -0400] arussel: it is supposed to use maven/3/version, and says I'm using 3.1.1 but uses 3.1.0
[2013-10-16 12:53:36 -0400] arussel:   version "3.1.1"
[2013-10-16 12:53:42 -0400] arussel:   url "http://apache.mirrors.tds.net/maven/maven-3/3.1.0/binaries/apache-maven-3.1.0-bin.tar.gz"
[2013-10-16 12:53:56 -0400] s2r2: ah. I see.
[2013-10-16 12:54:17 -0400] arussel: I've overwritten the attribute
[2013-10-16 12:55:26 -0400] arussel: would maven/3/url computed before maven/3/version and before my attribute is read ?
[2013-10-16 12:57:07 -0400] s2r2: it depends on what maven/3/version is set to when maven/3/url is computed, I suppose
[2013-10-16 12:59:03 -0400] [1]sam: Is it possible to deploy a VM from the WebUI of Chef?
[2013-10-16 13:00:05 -0400] arussel: s2r2: I've go attributes/default.rb with override['maven']['3']['version'] = '3.1.1'
[2013-10-16 13:00:29 -0400] arussel: and a recipe with: include_recipe "maven" , this is the proper way to do it, isn't it ,
[2013-10-16 13:00:32 -0400] arussel: s/,/?/
[2013-10-16 13:00:50 -0400] s2r2: arussel: the moment when your cookbook is read might be important. hmm sounds about right...
[2013-10-16 13:07:43 -0400] ichilton: Am I right in saying that if you put something in an attribute file, it will apply to every node, not just nodes which use that cookbook?
[2013-10-16 13:08:02 -0400] ichilton: (that's what I seem to be seeing anyway - moved attributes in question to the recipe and it's fine now)
[2013-10-16 13:08:45 -0400] s2r2: arussel: maybe something is interfering? there're so many ways to set an attribute
[2013-10-16 13:12:20 -0400] pabst^: ichilton: I don't think servers that don't use that cookbook would even know that attribute exists
[2013-10-16 13:12:34 -0400] arussel: s2r2: I've sent a PR to update the attribue (other version aren't there anymore), would solve my problem
[2013-10-16 13:13:11 -0400] ichilton: pabst^: it seems chef-client downloads all cookbooks from the chef server...
[2013-10-16 13:13:45 -0400] ichilton: pabst^: but I was setting default attributes in one cookbook and nodes not using that had those attributes, until I moved them into the recipe instead of attributes/default.rb
[2013-10-16 13:14:12 -0400] pabst^: ichilton: interesting
[2013-10-16 13:14:29 -0400] arussel: ichilton: are you sure you don't depends on it or include or require it somewhere
[2013-10-16 13:14:39 -0400] ichilton: nope
[2013-10-16 13:14:47 -0400] ichilton: oh wait
[2013-10-16 13:14:49 -0400] ichilton: maybe :)
[2013-10-16 13:14:51 -0400] pabst^: :)
[2013-10-16 13:15:06 -0400] ichilton: I might have just reaslised what I did :)
[2013-10-16 13:15:30 -0400] ichilton: move on, nothing to see here! :-)
[2013-10-16 13:16:07 -0400] pabst^: lol
[2013-10-16 13:17:15 -0400] Cope: ohai ichilton
[2013-10-16 13:17:25 -0400] ichilton: Cope: Hello! :)
[2013-10-16 13:17:34 -0400] ichilton: Cope: How's things?
[2013-10-16 13:17:55 -0400] Cope: Things are awesome FSVO Things && Awesome
[2013-10-16 13:18:06 -0400] ichilton: FSVO?
[2013-10-16 13:18:39 -0400] Cope: http://www.internetslang.com/FSVO-meaning-definition.asp
[2013-10-16 13:19:09 -0400] Cope: aha, my beloved pair has returned... back to work
[2013-10-16 13:19:13 -0400] ichilton: oh
[2013-10-16 13:19:31 -0400] ichilton: bye for now
[2013-10-16 13:19:36 -0400] pabst^: http://www.internetslang.com/FSVO-meaning-definition.asp
[2013-10-16 13:19:39 -0400] pabst^: bah
[2013-10-16 13:19:45 -0400] pabst^: bad paste
[2013-10-16 13:20:25 -0400] pabst^: i hate when chef failures don't make sense
[2013-10-16 13:27:42 -0400] mveitas: I am looking to store some SSL certificates in an encrypted data bag, but I keep getting an error:  Yajl::ParseError: lexical error: invalid character inside string.
[2013-10-16 13:30:54 -0400] tomduffield: mveitas: that could be possible. follow atomic-penguins instructions here (https://github.com/atomic-penguin/cookbook-certificate) on how to properly prepare your certificates to be stored in an encrypted data bag.
[2013-10-16 13:31:41 -0400] tomduffield: mveitas: if you have already done this there may other issues include the encoding of your certificates
[2013-10-16 13:31:53 -0400] mveitas: tomdiffield: thanks!
[2013-10-16 13:42:03 -0400] b-dean: for non test-kitchen tests, is there a preferred testing framework for cookbooks (rspec, minitest, etc)?
[2013-10-16 13:43:48 -0400] b-dean: this is to test a bit of semi-complicated logic in a library helper module that can't be easily tested with test-kitchen (because it's for windows :-\)
[2013-10-16 13:44:14 -0400] tomduffield: b-dean: that is somewhat of a personal question
[2013-10-16 13:44:27 -0400] tomduffield: each person has their own preferences
[2013-10-16 13:44:32 -0400] b-dean: sure
[2013-10-16 13:44:35 -0400] tomduffield: b-dean: I would check out chefspec though
[2013-10-16 13:44:47 -0400] tomduffield: b-dean: its based on rspec (which I personally like better)
[2013-10-16 13:45:17 -0400] b-dean: it's a change to an opscode cookbook that I was hoping to contribute back so I thought I'd ask so as to get the framework opscode folks prefer :)
[2013-10-16 13:45:35 -0400] tomduffield: b-dean: I think that the safest bet is to use chefspec
[2013-10-16 13:46:10 -0400] tomduffield: b-dean: that is about as close as "opscode preferred" as you will probably get
[2013-10-16 13:47:01 -0400] b-dean: even if there's no cookbooks involved? it's basically just a bunch of examples of calling a method with different params and making sure the results are what I expect. I thought about chefspec but though after, "man that's overkill for this"
[2013-10-16 13:47:03 -0400] b-dean: ya know?
[2013-10-16 13:47:48 -0400] b-dean: I had it using minitest/spec at first but I was wondering if rspec would be okay
[2013-10-16 13:48:31 -0400] b-dean: I'll look around a bit more at their cookbooks and see if they use anything else (or how they use chefspec)
[2013-10-16 13:49:56 -0400] tomduffield: b-dean: In that case I would use RSpec just because it would play nice with chefspec
[2013-10-16 13:50:27 -0400] tomduffield: b-dean: well, play "nicer" - minitest will work too but I've noticed a couple cases where they disagree on things
[2013-10-16 13:51:36 -0400] b-dean: cool, thanks
[2013-10-16 14:22:01 -0400] legal90: Did anybody Mac OS X provision?
[2013-10-16 14:23:15 -0400] jmartin: whats the best way to handle including a recipe only for certain platforms? include_recipe blah::blah unless node['platform_family'] != blah ?
[2013-10-16 14:27:55 -0400] s2r2: is there any well-known workaround for reading from a file from the local disk in the converge phase (after another resource has caused it to be created?)
[2013-10-16 14:29:20 -0400] ichilton: Remember friends - always remember to update metadata.rb with depenancies
[2013-10-16 14:55:01 -0400] trilitheus: quick berkshelf question if any one is using
[2013-10-16 14:55:22 -0400] trilitheus: anyway I can tell berkshelf to use my local filesystem for all cookbook resolution instead of having to specify each cookbook individually?
[2013-10-16 14:58:32 -0400] Yakko: ok, let's try to learn chef again, this is the 5th time I guess
[2013-10-16 14:59:05 -0400] Yakko: hey guys, is this still the prefered page to look for community recipes? http://community.opscode.com/cookbooks
[2013-10-16 14:59:39 -0400] jmartin: yes
[2013-10-16 14:59:42 -0400] d```: Yakko: I prefer searching github
[2013-10-16 14:59:43 -0400] d```: haha
[2013-10-16 14:59:58 -0400] Yakko: d```: that seems sad =D
[2013-10-16 15:00:42 -0400] azret: Yakko, having being in the middle of learning it myself, a good primer would be http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/ this was the easiest way for me to understand the basics and have some soft of accepted practice of doing things
[2013-10-16 15:03:46 -0400] fak3r: went thru opscode docs, but still can't get perms to set recursively gist:: https://gist.github.com/philcryer/7009145
[2013-10-16 15:04:44 -0400] azret: fak3r, for mode try "2755"
[2013-10-16 15:05:00 -0400] azret: you should have a sticky bit , in addition to having your modes quoted
[2013-10-16 15:05:28 -0400] Yakko: I'm really used to capistrano, all the times I tried chef thought, all I could get was a lot of recipes that didn't work on Debian =/
[2013-10-16 15:05:30 -0400] fak3r: Azrael: ok, thanks, but will that pass the ownership down the line too?
[2013-10-16 15:13:06 -0400] ssd7: Ohai Chefs
[2013-10-16 15:17:22 -0400] fak3r: Azrael: hey, that worked, it's recursive, only thing is, the top level dir shows: "d-ws----wt.  5 apache apache" seems odd?
[2013-10-16 15:17:54 -0400] Azrael: fak3r: sorry?
[2013-10-16 15:18:49 -0400] fak3r: Azrael: you said, "for mode try "2755" and that set perms recursively, which I wanted :) but it gave the top dir perms that weren't 755 so ls -ls shows "d-ws-wt." which I hadn't seen before
[2013-10-16 15:20:23 -0400] gchristensen: holy balls, DevOpsDays costs 10k to attend
[2013-10-16 15:20:43 -0400] fak3r: that doesn't sound right, FUD?
[2013-10-16 15:21:20 -0400] tmichael: http://devopsdays.org/events/2013-portland/registration/
[2013-10-16 15:21:25 -0400] tmichael: sponsor is 10k
[2013-10-16 15:21:32 -0400] tmichael: GA is $100
[2013-10-16 15:22:06 -0400] fak3r: whoa when I went to devopsdays in boston, and later austin, I thought it was free
[2013-10-16 15:22:54 -0400] gchristensen: tmichael: check out newyork
[2013-10-16 15:23:03 -0400] fak3r: Azrael: hey, I set it to 0755 and it worked, thanks for your help!
[2013-10-16 15:23:07 -0400] gchristensen: maybe they are out of GA tickets
[2013-10-16 15:24:09 -0400] Azrael: fak3r: oh i think you have the wrong person.  wasn't me :-)
[2013-10-16 15:24:34 -0400] Yakko: fuck, it's November 4th, Idk if I can get back to the US that soon =/
[2013-10-16 15:25:23 -0400] fak3r: Azrael: you are correct, I am not :)
[2013-10-16 15:25:41 -0400] fak3r: azret: hey, I set it to 0755 and it worked, thanks for your help!
[2013-10-16 15:25:50 -0400] fak3r: Azrael: thanks for being here!
[2013-10-16 15:26:13 -0400] Yakko: I can never remember the default chmod is 0644 ?
[2013-10-16 15:26:29 -0400] azret: fak3r, you might want to try with the 2 for sticky bit purposes if you want all future files in that directory to be written by apache
[2013-10-16 15:27:11 -0400] fak3r: azret: ah, is that was that does, cause it made the main dir have these perms (which I thought were weird) "d-ws----wt. 5 apache apache iaas"
[2013-10-16 15:27:43 -0400] fak3r: azret: so with the '2' any files written in that dir will automatically be apache:apache?
[2013-10-16 15:28:37 -0400] azret: correct
[2013-10-16 15:33:48 -0400] Azrael: fak3r: hehe np
[2013-10-16 15:34:30 -0400] chris613: ichilton: I beleive that attributes are read when a cookbook is downloaded due to a 'depends' line in metadata.rb, so will appear even if no recipes are ever included. I am not 100% certain, but your comments increase my certainty. :)
[2013-10-16 15:34:45 -0400] ssd7: chris613: Yes, that is correct.
[2013-10-16 15:34:53 -0400] chris613: whoops, my scrollback was at the top - I think that question was a Looooooong time ago
[2013-10-16 15:34:56 -0400] chris613: ssd7: Thanks :)
[2013-10-16 15:35:14 -0400] ichilton: Yep, thanks.
[2013-10-16 15:36:25 -0400] chris613: Oh, it was only 2.5hrs ago
[2013-10-16 15:36:28 -0400] fak3r: azret: thanks, that was news to me
[2013-10-16 15:37:31 -0400] fak3r: so I have chef-client running, checking in every 3600 seconds with chef-server
[2013-10-16 15:37:38 -0400] fak3r: but that's not in client.rb? where is it set?
[2013-10-16 15:38:26 -0400] tomduffield: fak3r: 3600 is the default setting. you can change it in client.rb
[2013-10-16 15:39:41 -0400] ssd7: fak3r: How are you running chef as a service?  That can also be configured via a command line flag.
[2013-10-16 15:39:42 -0400] tomduffield: fak3r: http://docs.opscode.com/config_rb_client.html -- the 'interval' value
[2013-10-16 15:46:12 -0400] fak3r: tomduffield: ah, ok, was wondering how it got that setting and grep -r /  couldn't find it! Thanks
[2013-10-16 15:46:26 -0400] fak3r: ssd7: just letting it run via /etc/init.d/chef-client start
[2013-10-16 15:47:24 -0400] jmartin: is it possible to conditionally include recipes in an if block? ex: https://gist.github.com/hugespoon/09a7961058cbf3044f9e
[2013-10-16 15:49:02 -0400] ssd7: fak3r: Might also want to check in /etc/default/chef-client or /etc/sysconfig/chef-client (depending on your platform).  I believe the default init script places the splay in there.
[2013-10-16 15:49:47 -0400] fak3r: ssd7: hey you're right! /etc/sysconfig/chef-client
[2013-10-16 15:57:45 -0400] eherot: I'm looking for a good solution for rolling out config file changes (using chef) to an elasticsearch cluster *without* having Chef bounce a whole bunch of servers in the cluster all at once.
[2013-10-16 15:57:58 -0400] eherot: Particular changes such as adding new nodes to the cluster (which is using unicast)
[2013-10-16 16:00:52 -0400] tomduffield: jmartin: yes it should be
[2013-10-16 16:01:22 -0400] jmartin: tomduffield: during my test runs, it just skips those recipes
[2013-10-16 16:01:31 -0400] jmartin: the test instance is centos
[2013-10-16 16:02:19 -0400] tomduffield: jmartin: alternatively you can also use the not_if or only_if metaparameters within a do-end block
[2013-10-16 16:03:27 -0400] tomduffield: jmartin: also, the platform_family for redhat/centos should be rhel
[2013-10-16 16:03:43 -0400] jmartin: tomduffield: doh, thats probably my problem :D
[2013-10-16 16:03:47 -0400] jmartin: didnt spot that for some reason
[2013-10-16 16:04:09 -0400] tomduffield: jmartin: don't feel bad, happens to everyone
[2013-10-16 16:04:23 -0400] tomduffield: still happens to me every so often
[2013-10-16 16:15:51 -0400] quatrix: hi, in an environment i have default_attributes "node" => { "a" => "b" }, how do i access "a" from a library inside a cookbook? @node["a"] doesn't seem to work (i'm a ruby/chef newbie)
[2013-10-16 16:17:47 -0400] granth: anyone have any luck with chef-vim find commands working inside standalone cookbooks
[2013-10-16 16:17:48 -0400] granth: ?
[2013-10-16 16:40:35 -0400] spstarr_work: can I use knife to configure a chef server without HTTP/HTTPS but via ssh ?
[2013-10-16 16:41:11 -0400] spstarr_work: if so, how can I get knife to respect my .ssh/config to do proxying from a ssh jumpbox to a server to the chef server directly?
[2013-10-16 16:41:32 -0400] spstarr_work: until I have a VPN which then renders it all moot, no VPN yet however
[2013-10-16 16:46:58 -0400] sfalcon: spstarr_work: Not sure I'm following. You can only talk to the Chef Server API over HTTP(S)
[2013-10-16 16:47:14 -0400] sfalcon: You *can* use knife ssh to access a node in your infra via a jump box.
[2013-10-16 16:49:07 -0400] spstarr_work: oh, its only via API :/
[2013-10-16 16:49:36 -0400] spstarr_work: sfalcon: i was hoping we had a way to modify the server w/o the API
[2013-10-16 16:50:07 -0400] sfalcon: spstarr_work: "the server" being Chef Server or a node in your infra?
[2013-10-16 16:52:00 -0400] spstarr_work: Chef Server
[2013-10-16 16:52:07 -0400] spstarr_work: sfalcon: use case:
[2013-10-16 16:52:44 -0400] spstarr_work: 1) my box is on network A outside of AWS in corp network, chef Server is in AWS, jumpbox separates me and the chef server (no VPN yet)
[2013-10-16 16:52:53 -0400] spstarr_work: the chef server has no external access only backend
[2013-10-16 16:52:54 -0400] gkra: Is there a way to determine which version of a cookbook chef-client is using during a run?
[2013-10-16 16:53:21 -0400] spstarr_work: so I cannot get to it via HTTPS, hmmm one option is I put an ELB in front of it
[2013-10-16 16:53:33 -0400] gchristensen: jmartin: may I PM?
[2013-10-16 16:54:15 -0400] bean__: spstarr_work: considered hosted chef?
[2013-10-16 16:54:24 -0400] spstarr_work: sfalcon: I think i answered my own question, bean__ my DevOps team is managing chef
[2013-10-16 16:54:34 -0400] bean__: ah ok
[2013-10-16 16:54:35 -0400] spstarr_work: im doing some custom cookbooks for the infra eng side of things
[2013-10-16 16:54:36 -0400] spstarr_work: :)
[2013-10-16 16:54:54 -0400] jmartin: gchristensen: sure
[2013-10-16 16:57:27 -0400] spstarr_work: haha
[2013-10-16 16:57:29 -0400] spstarr_work: oh dev...
[2013-10-16 16:57:30 -0400] spstarr_work: 'staging-chef'
[2013-10-16 16:57:34 -0400] spstarr_work: they created an ELB too
[2013-10-16 16:58:20 -0400] sfalcon: \o/
[2013-10-16 16:58:23 -0400] spstarr_work: heh
[2013-10-16 16:59:22 -0400] spstarr_work: success
[2013-10-16 16:59:23 -0400] spstarr_work: ant                      1.0.2
[2013-10-16 17:13:39 -0400] geekiest: so does anyone actually /use/ tags?
[2013-10-16 17:14:16 -0400] bean__: yes
[2013-10-16 17:14:22 -0400] geekiest: what do you put in them?
[2013-10-16 17:14:29 -0400] bean__: oh, chef tags, no
[2013-10-16 17:14:39 -0400] bean__: thought we were talking about tags on a repo for a cookbook
[2013-10-16 17:15:10 -0400] geekiest: ah no, no no, RCS tags  are great
[2013-10-16 17:15:24 -0400] Toger: I use tags to identify hosts in AWS that are 'autoscale' hosts
[2013-10-16 17:15:40 -0400] geekiest: but with things like node searching in chef, tags are a first-level citizen and it surprises me, since people don't seem to recommend / use them
[2013-10-16 17:20:51 -0400] Mackowrth: Anyone willing/have time to help me figure out an issue installing ruby on OS X via homebrew via chef solo via vagrant?  ==> Installing ruby dependency: libyaml ==> Downloading http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz STDERR: Error: Permission denied - /var/root/Library/Logs ---- End output of brew install  ruby ---- Ran brew install  ruby returned 1
[2013-10-16 17:21:06 -0400] Mackowrth: I added node.default['homebrew']['owner'] = 'vagrant' to my recipe to make sure that it was running at the local user, and not root, so I am not sure why it's trying to access /var/root/Library/Logs
[2013-10-16 17:21:28 -0400] Mackowrth: it works if i install it directly on the VM via the commandline
[2013-10-16 17:27:11 -0400] joelmoss: hi all, has anyone used the knife-ec2 plugin?
[2013-10-16 17:27:45 -0400] joelmoss: i'm creating a new ec2 instance with a mongodb role, but it fails. however, it works when I simply bootstrap it normally. anyone know why?
[2013-10-16 17:29:22 -0400] joelmoss: ok, so thats not strictly true
[2013-10-16 17:29:34 -0400] bean__: joelmoss: define "fails"
[2013-10-16 17:29:35 -0400] bean__: :)
[2013-10-16 17:29:39 -0400] joelmoss: it fails on first run, but if I run bootstrap again, it works
[2013-10-16 17:29:57 -0400] joelmoss: package[mongodb-10gen] action install
[2013-10-16 17:30:07 -0400] joelmoss: failing on apt-get install
[2013-10-16 17:30:20 -0400] bean__: yep, you likely want the "apt" cookbook somewhere in there
[2013-10-16 17:30:30 -0400] joelmoss: error message is useless
[2013-10-16 17:30:31 -0400] bean__: to make it do an "apt-get update" after you add the 10gen repo
[2013-10-16 17:31:08 -0400] joelmoss: well wouldn't the mongodb cookbook include that as a dependency?
[2013-10-16 17:31:17 -0400] bean__: I'm not sure.
[2013-10-16 17:31:23 -0400] bean__: it probably /should/ but who knows
[2013-10-16 17:31:52 -0400] joelmoss: k, let me try
[2013-10-16 17:32:22 -0400] joelmoss: thx
[2013-10-16 17:37:07 -0400] EricL: How would I do a chef search for all nodes that have role:foo and are in ec2.placement_availability_zone:us-east-1a ?
[2013-10-16 17:37:34 -0400] gchristensen: EricL: roles:foo AND ec2_placement_availability_zone:us-east-1a
[2013-10-16 17:37:40 -0400] gchristensen: right..?
[2013-10-16 17:38:27 -0400] EricL: gchristensen: The _ after ec2 is what I couldn't seem to figure out.
[2013-10-16 17:38:46 -0400] gchristensen: ah yeah, for searhc it flattens all the hashes into strings
[2013-10-16 17:39:27 -0400] Toger: so . becomes _
[2013-10-16 17:39:31 -0400] gchristensen: ^ that
[2013-10-16 17:39:53 -0400] EricL: That's where I was lost.  If that is documented anywhere, it's very confusing.
[2013-10-16 17:45:32 -0400] stormerider: EricL: i believe it is on the knife search page but it's easy to miss
[2013-10-16 17:45:49 -0400] stormerider: i know i missed it at first
[2013-10-16 17:46:37 -0400] joelmoss: @bean__ seems adding apt didn't help.
[2013-10-16 17:46:50 -0400] joelmoss: anyone used the mongodb cookbook?
[2013-10-16 17:46:58 -0400] arussel: joelmoss: yep
[2013-10-16 17:47:11 -0400] joelmoss: bootstrapping always fails for me on the 10gen_repo recipe
[2013-10-16 17:47:19 -0400] joelmoss: but if I run it a second time, it works
[2013-10-16 17:47:33 -0400] arussel: :-) this cookbook taught me to hate chef
[2013-10-16 17:47:37 -0400] maraca: hey folks - any idea why when I run the 'knife ssh' command with a search of 'role:*',  a bunch of hosts are throwing a Failed to connect error?
[2013-10-16 17:47:39 -0400] maraca: https://gist.github.com/maraca/1b8e8065a3f6648b0868
[2013-10-16 17:47:41 -0400] EricL: joelmoss: You see my angry tweet about that this morning?
[2013-10-16 17:47:42 -0400] joelmoss: this is my run list "recipe[apt],recipe[mongodb::10gen_repo],recipe[mongodb]"
[2013-10-16 17:47:57 -0400] arussel: joelmoss: go get the most recent version from github
[2013-10-16 17:47:59 -0400] maraca: if i specify a role i don't get that problem
[2013-10-16 17:48:15 -0400] joelmoss: @arussel no i didnt
[2013-10-16 17:48:28 -0400] EricL: stormerider: I've missed it a few times.
[2013-10-16 17:48:31 -0400] arussel: joelmoss: it wasn't a question
[2013-10-16 17:48:49 -0400] joelmoss: lol, well it had a question mark at the end of it
[2013-10-16 17:49:04 -0400] EricL: joelmoss: No, my comment had a question mark at the end of it.
[2013-10-16 17:49:07 -0400] joelmoss: so you've been having problems with mongodb cookbook too?
[2013-10-16 17:49:17 -0400] joelmoss: ?? confoooozed
[2013-10-16 17:49:21 -0400] EricL: joelmoss: Yes.
[2013-10-16 17:49:28 -0400] EricL: joelmoss: It's a complete piece of shit.
[2013-10-16 17:49:38 -0400] joelmoss: oh apologies @arussel
[2013-10-16 17:49:40 -0400] arussel: joelmoss: yes, the version on the site is 11.0, you should use the latest one 13.3
[2013-10-16 17:49:45 -0400] joelmoss: yeah I am
[2013-10-16 17:49:50 -0400] joelmoss: using it from the git repo
[2013-10-16 17:50:09 -0400] EricL: joelmoss: Matt and I are trying to decide what to do about it now over gChat.
[2013-10-16 17:50:29 -0400] arussel: I've hated that recipe so much, make me loose so much time
[2013-10-16 17:50:31 -0400] EricL: joelmoss: Matt Reiferson.
[2013-10-16 17:50:46 -0400] joelmoss: Eric Lubow?
[2013-10-16 17:50:56 -0400] EricL: joelmoss: The same.
[2013-10-16 17:50:59 -0400] joelmoss: woah!
[2013-10-16 17:51:15 -0400] joelmoss: freaky!
[2013-10-16 17:51:15 -0400] joelmoss: how the hell are ya?
[2013-10-16 17:51:32 -0400] EricL: Better when I am not dealing with the 10gen cookbook.
[2013-10-16 17:51:45 -0400] joelmoss: hmm
[2013-10-16 17:51:55 -0400] joelmoss: i'm just starting to dig into chef
[2013-10-16 17:52:19 -0400] joelmoss: need a better setup for Codio.com
[2013-10-16 17:52:21 -0400] EricL: joelmoss: I've got a roughly 180 node infrastructure completely Chef'd now.
[2013-10-16 17:52:29 -0400] joelmoss: nice
[2013-10-16 17:52:47 -0400] jtimberman: EricL: Sweet!
[2013-10-16 17:52:49 -0400] joelmoss: this looks promising https://github.com/ParsePlatform/Ops/tree/master/chef/cookbooks/mongodb
[2013-10-16 17:53:22 -0400] phutchins: joelmoss: looking for a good mongo cookbook?
[2013-10-16 17:53:28 -0400] arussel: joelmoss: this work for me:
[2013-10-16 17:53:29 -0400] arussel: include_recipe "mongodb::10gen_repo"
[2013-10-16 17:53:29 -0400] arussel: include_recipe "mongodb::default"
[2013-10-16 17:53:36 -0400] EricL: jtimberman: Actually that's a lie.  The only thing not Chef'd is our Redis and Mongo clusters.
[2013-10-16 17:53:40 -0400] miah: at least they have definitions
[2013-10-16 17:53:46 -0400] joelmoss: @phutchins yeah
[2013-10-16 17:53:56 -0400] miah: when a cookbook doesn't have definitions, or resources, ignore it =)
[2013-10-16 17:54:00 -0400] joelmoss: EricL: why?
[2013-10-16 17:54:07 -0400] EricL: Mongo cookbooks are all shitty. Redis I am just diving into to do this week because our Redis setup is VERY complex.
[2013-10-16 17:54:18 -0400] EricL: joelmoss: Why what?
[2013-10-16 17:54:57 -0400] joelmoss: why you not got mongodb and redis all chef'd up?
[2013-10-16 17:55:08 -0400] EricL: joelmoss: Just haven't gotten to it yet.
[2013-10-16 17:55:22 -0400] threadwaste: i really should put up my mongo book, or at least pr my things to the one thats in opscode repo
[2013-10-16 17:55:24 -0400] EricL: Relaunched the entire architecture one by one over the last 2 months.
[2013-10-16 17:55:31 -0400] threadwaste: that thing is kind of gross :(
[2013-10-16 17:55:35 -0400] arussel: joelmoss: I'm actually using: b38a06039d159f5102e7e469d4218475acb5e0c1
[2013-10-16 17:55:41 -0400] miah: there are a few good redis books out there
[2013-10-16 17:56:36 -0400] miah: ah, charity wrote that mongo book
[2013-10-16 17:56:48 -0400] EricL: Every Redis machine we have has 7 instances of Redis on it and is either a master or a slave.  I have yet to find a cookbook that supports all of that.
[2013-10-16 17:56:59 -0400] miah: EricL: github.com/miah/chef-redis
[2013-10-16 17:57:16 -0400] EricL: And ** NOTE ** This cookbook does not currently configure or manage Redis replication.
[2013-10-16 17:57:21 -0400] miah: its a slight lie
[2013-10-16 17:57:34 -0400] miah: documentation is always out of date =) you know
[2013-10-16 17:57:52 -0400] jtimberman: EricL: thats fine (not managing redis/mongo) i'm surey ou'll get there :)
[2013-10-16 17:57:55 -0400] miah: https://github.com/miah/chef-redis/blob/master/resources/instance.rb
[2013-10-16 17:58:10 -0400] miah: we definitely have slave details =)
[2013-10-16 17:58:38 -0400] EricL: miah: Believe it or not, I actually already had that tab open and was reading the src to try to figure out if slaveof was actually being used.
[2013-10-16 17:59:02 -0400] EricL: jtimberman: I will definitely get there.  I am determined to have the entire infrastructure Chef'd properly so I don't have to think about it.
[2013-10-16 17:59:31 -0400] EricL: jtimberman: Relaunching 150 machines in 2 months has been pretty taxing and I have no plan on stopping this close to the finish line.
[2013-10-16 17:59:44 -0400] jtimberman: :D
[2013-10-16 17:59:48 -0400] miah: good job
[2013-10-16 18:00:01 -0400] jmartin: miah: i had a question about simple thats OT, mind if i pm?
[2013-10-16 18:00:07 -0400] EricL: Plus I want Data Dog on every mcahine and installing it by hand is a pain when Chef can do it for me.
[2013-10-16 18:00:27 -0400] miah: jmartin: sure
[2013-10-16 18:00:32 -0400] miah: or ##simple
[2013-10-16 18:00:47 -0400] jmartin: ah yes, forgot the chan
[2013-10-16 18:00:48 -0400] jmartin: ill just go there
[2013-10-16 18:01:11 -0400] jmartin: thanks
[2013-10-16 18:02:06 -0400] EricL: Plus I can't wait to open source all of our Cassandra cookbooks (after a little cleanup).
[2013-10-16 18:03:34 -0400] EricL: miah: Maybe I am missing something, but it doesn't seem like this cookbook makes it easy to isntall 7 instances on the same server.
[2013-10-16 18:03:54 -0400] miah: you can use the redis_instance resource and a wrapper cokbook to do wtf you want.
[2013-10-16 18:03:55 -0400] EricL: miah:  Not like this cookbook does anyway: https://github.com/brianbianco/redisio
[2013-10-16 18:04:01 -0400] miah: im aware of redisio
[2013-10-16 18:04:52 -0400] EricL: So basically I'd need to write a recipe instead of being able to do it with roles.
[2013-10-16 18:05:07 -0400] miah: thats the case always
[2013-10-16 18:05:35 -0400] miah: cookbooks that have a recipe that work 'out of the box' almost always will have some side effect that you dont want
[2013-10-16 18:05:39 -0400] miah: so always check those recipes out
[2013-10-16 18:05:53 -0400] miah: we have a few recipes included that pull things from node attributes and do things 'automagically'
[2013-10-16 18:06:00 -0400] miah: but it might not be what you want
[2013-10-16 18:06:12 -0400] miah: recipes are basically the batch script to 'use' the resources provided
[2013-10-16 18:06:22 -0400] stormerider: trust but verify? :)
[2013-10-16 18:06:49 -0400] miah: i tend to use recipes to only invoke resources, not to build abstract representations of them
[2013-10-16 18:06:53 -0400] EricL: We've got pretty much everything in a scenario where we just create roles from other roles to create machines and try to minimize the work in recipes.
[2013-10-16 18:06:59 -0400] miah: ya
[2013-10-16 18:07:47 -0400] EricL: I am trying to figure out how to apply that approach to your cookbook.  I think I may need a wrapper cookbook and then create a role/roles off the wrapper cookbook.
[2013-10-16 18:07:47 -0400] miah: so few people understand chef enough to use roles properly and thus we now have 'role cookbooks'
[2013-10-16 18:07:49 -0400] jmartin: miah cranks out LWRPs like a champ
[2013-10-16 18:08:21 -0400] jmartin: miah: you guys use role cookbooks, or you are saying its a side effect of people not knowing roles?
[2013-10-16 18:08:33 -0400] miah: lots of people use role cookbooks
[2013-10-16 18:08:50 -0400] miah: its a side effect of cookbook 'recipes' taking far too many inputs and abusing node attributes
[2013-10-16 18:09:01 -0400] miah: node attributes tend to be used in chef recipes as if they were global variables
[2013-10-16 18:09:26 -0400] miah: and there is all sorts of fun when people dont consider that recipes are two pass
[2013-10-16 18:10:33 -0400] jmartin: im guilty of such things myself id say
[2013-10-16 18:10:38 -0400] miah: we all art
[2013-10-16 18:10:43 -0400] miah: are, especially when we're new to chef
[2013-10-16 18:10:44 -0400] maniacal: does anyone have an example of using notifications within an lwrp?  I want to trigger a delayed notification if someone uses a resource defined in the lwrp
[2013-10-16 18:10:58 -0400] miah: maniacal: uh, dont.
[2013-10-16 18:11:31 -0400] miah: notofications + resources (and lwrps) are tricky
[2013-10-16 18:11:39 -0400] EricL: Ok, then I think I will need to write a redis wrapper cookbook to get what I'm after here.  But your cookbook is a good jumping off point now that I konw replication works.
[2013-10-16 18:11:43 -0400] EricL: miah: Thanks.
[2013-10-16 18:11:51 -0400] miah: because if you are using inline resources then the primary resource collection will not be aware of the inline resources
[2013-10-16 18:11:58 -0400] miah: and notifications get really fun
[2013-10-16 18:12:18 -0400] maniacal: ok.  then maybe I'm approaching the problem incorrectly
[2013-10-16 18:12:45 -0400] miah: notifications are ways to take action during a certain event. not ways to control program flow.
[2013-10-16 18:12:48 -0400] maniacal: I need multiple cookbooks to be able to provide values for a file.  and then have that file created via template resource at the end of the chef run.
[2013-10-16 18:12:54 -0400] tmichael: gchristensen - coincidentally noticed tweet re one avail ticket to devopsdays nyc.  https://twitter.com/devopsdays/status/390540495958863872
[2013-10-16 18:13:05 -0400] miah: ya
[2013-10-16 18:13:13 -0400] miah: im currently working on a configuration resource that will help with that
[2013-10-16 18:13:15 -0400] miah: its tricky though
[2013-10-16 18:13:38 -0400] miah: you basically want to build a data structure to hold all of your configuration then render it at the end
[2013-10-16 18:13:48 -0400] maniacal: so the resources provided by the lwrp will basically add the values to an array.   then the tempalte would write the file based on that array
[2013-10-16 18:13:50 -0400] maniacal: right
[2013-10-16 18:14:03 -0400] miah: ya
[2013-10-16 18:15:03 -0400] maniacal: actually, I have default values in the array.  so I always need the file written.  so notifications don't make sense now that I think of it.
[2013-10-16 18:15:27 -0400] miah: i would probably just have a dedicated 'render' action or something. and when the resource gets called with that action i'd write out the details.
[2013-10-16 18:15:31 -0400] miah: instead of having everything done via 'create' or whatever
[2013-10-16 18:15:55 -0400] miah: but resource objects, and providers can have more actions than are capable of being called by run_action
[2013-10-16 18:16:00 -0400] miah: it just gets into standard OOP fun
[2013-10-16 18:16:36 -0400] maniacal: but then I have to make sure that resource is called at the end.  so I'm back to the same problem.  so maybe my problem is this:  "If I include a cookbook, how do I ensure that a resource in that cookbook gets executed at the end of the chef run, every chef run"
[2013-10-16 18:18:27 -0400] maniacal: I don't want people to have to remember to include that at the end of each run_list.  Just want it to happen automagically if the cookbook is part of the runlist
[2013-10-16 18:19:06 -0400] justizin: maniacal: i've run into that a few times, never come up with a super great solution that I can recall
[2013-10-16 18:20:17 -0400] maniacal: JeanMertz: miah:  thanks.  If I come up with a solution I'll post here.  I've been stuck on the "notifications" track for the last hour so I need to retool my thinking
[2013-10-16 18:21:05 -0400] maniacal: JeanMertz: sorry, that was for justizin:
[2013-10-16 18:22:21 -0400] jfoy: Hey, all. We're looking at plugging in some handlers to EventDispatch, but it doesn't quite support the way we want them to work:
[2013-10-16 18:22:43 -0400] maniacal: can a resource self notify?  I could just have the default recipe write the conf file with a :delayed notification.  or do I have to have 2 resources.  One "template" resource with action :nothing and another that tells that notifies :delayed the template resource
[2013-10-16 18:23:02 -0400] jfoy: What we want is start-A; start-B; converge; finish-B; finish-A
[2013-10-16 18:23:14 -0400] jmartin: miah: are you planning on pushing forward with your logstash cookbook to deal with 1.2.x releases or is that back burner/relegated to lusis' book?
[2013-10-16 18:23:23 -0400] jfoy: but I don't think we can do that with events; I think it only supports start-A; start-B; converge; finish-A; finish-B
[2013-10-16 18:24:26 -0400] dgarstang2: i am suddenly getting an error in 'unless Ohai::Config[:plugin_path].include?(node['ohai']['plugin_path'])' on bringing up a new vagrant box. wtf?
[2013-10-16 18:24:35 -0400] jfoy: So I'm thinking of putting in a more generic plugin that will support something like a middleware stack, but I don't want to write this if there's a more standard way to do it. Anyone familiar with this problem?
[2013-10-16 18:25:06 -0400] gchristensen: dgarstang2: the error itself woulf be helpful :)
[2013-10-16 18:25:37 -0400] dgarstang2: gchristensen: undefined method `[]' for nil:NilClass
[2013-10-16 18:25:42 -0400] dgarstang2: gchristensen: at that line
[2013-10-16 18:25:50 -0400] gchristensen: its probably that node['ohai']['plugin_path'] isn't defined
[2013-10-16 18:26:07 -0400] dgarstang2: gchristensen: didn't need to define it the last few hundred vm's I brought up
[2013-10-16 18:26:28 -0400] dgarstang2: gchristensen: how would it be defined from a vagrant perspective?
[2013-10-16 18:26:36 -0400] justizin: maniacal: at a past employer, i feel like we had some code that used 'chef stages' and you could use that to force something like apt-get update to run before other things, regardless of where it came from in the run_list, it seems like that should be usable for end tasks as well, but i can't find any documentation of it.
[2013-10-16 18:27:10 -0400] dgarstang2: 'chef stages' seems a bit redundant, especially when you come from a puppet world
[2013-10-16 18:28:16 -0400] justizin: dgarstang2: how so?
[2013-10-16 18:28:33 -0400] dgarstang2: justizin: chef stuff happens in the order it's written
[2013-10-16 18:28:49 -0400] log1kal: sorta.
[2013-10-16 18:28:51 -0400] jfoy: justizin: (guessing you were responding to me) That's more or less what we have in mind, using the EventDispatch handlers to intercept the chef run
[2013-10-16 18:29:00 -0400] dgarstang2: log1kal: moreso than puppet
[2013-10-16 18:29:06 -0400] log1kal: true
[2013-10-16 18:29:10 -0400] maniacal: seems like I should be able to "self notify"   I'll test it out.  something like:  template "foo" do; action :nothing; notifies :run, 'template[foo]', :delayed; end
[2013-10-16 18:29:25 -0400] justizin: dgarstang2: puppet claims to be roughly-in-order-excepted-by-dependencies
[2013-10-16 18:29:54 -0400] maniacal: hmm.  actually that doesn't make sense
[2013-10-16 18:30:22 -0400] maniacal: if the action is :nothing then the notifies won't happen
[2013-10-16 18:30:24 -0400] gchristensen: justizin: I read puppet actually randomizes the steps unless defined as dependencies?
[2013-10-16 18:30:29 -0400] justizin: anyway, the thing is, if you want something to be done absolute last every time, it's a PITA to keep it on the end of the run_list always
[2013-10-16 18:30:41 -0400] justizin: gchristensen: people from the puppet community have continually told me otherwise, they could have been wrong or lying. ;)
[2013-10-16 18:30:41 -0400] jfoy: But it looks like event handlers are always processed in the order to which they were subscribed to events
[2013-10-16 18:30:47 -0400] gchristensen: pfffft I have never written any line of puppet code justizin, that is just what I read
[2013-10-16 18:30:47 -0400] jfoy: Subscribed to the dispatcher, I mean
[2013-10-16 18:30:58 -0400] justizin: :)
[2013-10-16 18:31:10 -0400] justizin: jfoy: that sounds likely
[2013-10-16 18:32:21 -0400] jfoy: justizin: heh :-)
[2013-10-16 18:33:24 -0400] jfoy: What we have in mind is two features, both of which want to be "around" chef convergence instead of a particular resource
[2013-10-16 18:33:53 -0400] justizin: the current problem i could solve with this sort of thing is running AIDE IDS
[2013-10-16 18:34:01 -0400] justizin: it's kind of worthless if your IDS snapshots in the middle of a chef run ;d
[2013-10-16 18:34:06 -0400] b-dean: so I'm trying to figure out how chef-client decides what to write to the log file and am having some trouble. if I have my client.rb set log_location and then run "sudo chef-client", some stuff goes to STDOUT and warnings and errors go to the log. if I run "sudo chef-client | tee some_other.log" then everything goes to log_location and the formatting is somewhat different. how is it deciding that?
[2013-10-16 18:34:23 -0400] jfoy: justizin: that's more or less the problem we're tackling
[2013-10-16 18:34:35 -0400] justizin: b-dean: that's a fine damned question and i feel like it's changed from chef 10 to 11
[2013-10-16 18:35:05 -0400] justizin: jfoy: for IDS, it shouldn't matter if another handler runs after, as long as it doesn't write anything to the disk.
[2013-10-16 18:35:28 -0400] jfoy: justizin: no, not for an IDS -- but for avoiding collisions between distributed operations
[2013-10-16 18:35:35 -0400] justizin: ah..
[2013-10-16 18:35:48 -0400] justizin: ZK! ;)
[2013-10-16 18:35:51 -0400] jfoy: Yes!
[2013-10-16 18:35:53 -0400] dgarstang2: gchristensen: Looks like the version of ohai was bumped. The version that works is 0.1.9. The version that fails is 1.1.12.
[2013-10-16 18:36:23 -0400] jfoy: We have a distributed queue that lets Chef runs decide what order they go in through ZK, and only take down a certain number of nodes at a time
[2013-10-16 18:36:45 -0400] justizin: neato.
[2013-10-16 18:36:59 -0400] jfoy: and I really want to open-source it as soon as we roll it out here :-)
[2013-10-16 18:37:01 -0400] b-dean: the reason I ask is because I'm trying to get the same thing to happen with our scheduled task on our windows server and I have it doing chef-client > NUL 2>&1 and it only gets the warnings and errors. but if I run the same thing from a Local System command prompt, everything goes to the log. I thought it might be something in mixlib-cli or mixlib-log but I didn't see any magic :\
[2013-10-16 18:37:21 -0400] dgarstang2: Ok, so is anyone using the latest version of the ohai cookbook? Seems to be broken
[2013-10-16 18:38:36 -0400] jfoy: justizin: so that's what we want to be in the outer layer of this wrapper around converge
[2013-10-16 18:38:48 -0400] jfoy: and with only one layer, it works just fine with the converge_start and converge_complete events
[2013-10-16 18:39:37 -0400] jfoy: but as soon as I have two layers, one of which I want to start after and complete before this throttle code, converge_complete isn't enough
[2013-10-16 18:39:58 -0400] jfoy: so I find myself wanting something like Rack middleware
[2013-10-16 18:40:22 -0400] jfoy: where the converge_start and converge_complete events are the entry points into and out of the middleware stack
[2013-10-16 18:40:32 -0400] jfoy: but my concern is that this is overengineering
[2013-10-16 18:40:44 -0400] mattjalexander: does anyone have a good mediawiki cookbook? i can't seem to find one
[2013-10-16 18:40:59 -0400] jfoy: and if there's a better way to solve this problem without building that, I'd rather try that first
[2013-10-16 18:41:05 -0400] justizin: hm
[2013-10-16 18:41:26 -0400] justizin: i'm going to be completely honest and say that your problem is making my hangover worse. ;d
[2013-10-16 18:41:43 -0400] jfoy: justizin: yeah.
[2013-10-16 18:42:06 -0400] dgarstang2: Good grief. https://github.com/opscode-cookbooks/ohai ... it says the default of node['ohai']['plugin_path'] is set, but it's not. Seriously?
[2013-10-16 18:42:57 -0400] jmartin: dgarstang2: i believe im using the latest, and it sets it for me?
[2013-10-16 18:43:11 -0400] dgarstang2: jmartin: where?
[2013-10-16 18:44:00 -0400] dgarstang2: jmartin: oh i see it at https://github.com/opscode-cookbooks/ohai/blob/master/attributes/default.rb Wonder why that fails for me
[2013-10-16 18:44:25 -0400] dgarstang2: I think MacOS falls under the NOT Windows category
[2013-10-16 18:45:48 -0400] dgarstang2: I'd add some debug, except that berkshelf doesn't cache the file, cuz it fail.
[2013-10-16 18:46:52 -0400] dgarstang2: wait, wait
[2013-10-16 18:47:31 -0400] Skeletor1: Hi all, does anyone have/or know a comparison between using aws opsworks and chef to manage ec2 instances?
[2013-10-16 18:47:58 -0400] mattjalexander: well, opswork (can) use chef
[2013-10-16 18:48:44 -0400] gchristensen: and if it does use chef, its a pretty out of date one I think
[2013-10-16 18:49:54 -0400] justizin: Skeletor1: I found opsworks to be limiting, but it didn't exist until I was relatively experienced with chef, it can get you started.
[2013-10-16 18:49:59 -0400] justizin: gchristensen: i think it's 10
[2013-10-16 18:50:38 -0400] Skeletor1: mattjalexander: I just saw that they are at version 11, still outdated from whats available from opscode. Im trying to justify not using opsworks and going with our own or hosted chef server.
[2013-10-16 18:50:58 -0400] dgarstang2: This is really anoying. I'm editing the berkshelf cache copy of the cookbook with some log statements and I guess when chef sees a variable empty, it doesn't even start the run, which means you can't debug it?
[2013-10-16 18:51:22 -0400] btm: No @opscode chef/ohai code review today, monthly company meeting time!
[2013-10-16 18:51:31 -0400] justizin: Skeletor1: do you already use chef for things?
[2013-10-16 18:52:09 -0400] gchristensen: yay meetings
[2013-10-16 18:52:48 -0400] Skeletor1: justizin: No we havent deployed it but I have used chef for the lat 3 years, new job and well its open to use anything but manager saw that opsworks was out there and wanted to have a discussion on it
[2013-10-16 18:53:42 -0400] mattjalexander: one cool thing opsworks gets you is auto scaling on time/load
[2013-10-16 18:54:00 -0400] mattjalexander: but yeah, it might be hard to use databags or other stuff chef solo doesn't have
[2013-10-16 18:54:37 -0400] justizin: Skeletor1: right on, i was in a similar position recently.  take a look at it for yourself and form an opinion.
[2013-10-16 18:54:46 -0400] justizin: if you're experienced with chef i don't think you'll find it very impressive.
[2013-10-16 18:55:33 -0400] josephholsten: Skeletor1: it's solo with some pre-baked cookbooks. at least you can get chef 11 now.
[2013-10-16 18:55:55 -0400] maniacal: This is what I came up with to have it delayed till the end.  seems dumb but should work.  will test after lunch:  http://sprunge.us/iFGa
[2013-10-16 18:55:55 -0400] Skeletor1: I mean if its just chef-solo its good for bootstraping but thats all I found so far.
[2013-10-16 18:56:08 -0400] josephholsten: not very exciting. you'll still have to deal with integrating your services out of band
[2013-10-16 18:56:26 -0400] josephholsten: but if everything you build uses zookeeper or something, that's probably fine
[2013-10-16 18:56:47 -0400] josephholsten: btm: aww
[2013-10-16 18:58:13 -0400] Skeletor1: josephholsten:  That was the only feature that i did like was autoscaling, need to read more on scaling applications with chef on ec2.
[2013-10-16 18:58:21 -0400] Skeletor1: Thanks all for you help
[2013-10-16 18:58:25 -0400] glen: hi. i'm running recipe which has bash user vagrant, and it's getting error that bash can't read /root/tmp/afasdfjfskd wtf
[2013-10-16 18:58:28 -0400] justizin: Skeletor1: you can have autoscaling without opsworks
[2013-10-16 18:59:03 -0400] glen: recipe is this: https://github.com/siphoc/chef-phabricator/blob/master/recipes/default.rb
[2013-10-16 19:00:22 -0400] glen: error is like this: http://sprunge.us/LbgU
[2013-10-16 19:01:30 -0400] josephholsten: Skeletor1: if you add a bootstrap script to your cloudinit metadata, regular autoscale can do that for you
[2013-10-16 19:02:58 -0400] Skeletor1: josephholsten:  thanks for the tip, i havent worked with ec2 and chef in the last 2 years so abit rusty on ec2 features and what works with chef now days
[2013-10-16 19:05:45 -0400] maniacal: glen: seems like you system is using the wrong "tmp" directory.  don't know for sure, and don't know how to correct the problem but chef is creating it's tmp files in /root/tmp which your vagrant user doesn't have rights to.  On my builds chef always uses "/tmp".  not "/root/tmp"
[2013-10-16 19:06:00 -0400] maniacal: can't help more then that, but maybe that'll get you on the right path to fixing it
[2013-10-16 19:08:08 -0400] glen: maniacal: profile.d sets TMPDIR to ~/tmp
[2013-10-16 19:08:33 -0400] glen: maniacal: and definition of "wrong" is quite arguable, that tmpdir is very "correct" for root user
[2013-10-16 19:08:40 -0400] dgarstang2: ah lovely. This again '[kk01] Running provisioner: chef_solo...' 'No error message'
[2013-10-16 19:09:04 -0400] maniacal: then make sure root's tmp directory allows other users to execute out of it
[2013-10-16 19:09:21 -0400] maniacal: sounds goofy to me but if that's what you guys do then that's what you do
[2013-10-16 19:09:25 -0400] glen: maniacal: that's quiote opposite point of having "private" tmp!
[2013-10-16 19:09:41 -0400] maniacal: maybe there's a config optoin for chef to set the tmp
[2013-10-16 19:09:47 -0400] maniacal: so you can set it to the cache directory
[2013-10-16 19:10:32 -0400] glen: good point. maybe it is
[2013-10-16 19:11:03 -0400] glen: for now i just removed /root/tmp so TMPDIR is not set to that
[2013-10-16 19:11:35 -0400] glen: maniacal: should i open ticket for this? or there's no point, i.e no chance it gets fixed? a'la rejected as my own fault breaking  things or something?
[2013-10-16 19:13:16 -0400] maniacal: glen: yeah, I think you're going to get resistance.  setting a private "tmp" directory for each user is something I've never encountered and I've been a linux admin for many years.  so I'm guessing it'll be rejected as "why whould you want to do that"
[2013-10-16 19:14:27 -0400] glen: maniacal: inheriting env from previous user has always caused troubles (that is what happens internally root env is passed to vagrant user, which has paths not valid for vagrant)
[2013-10-16 19:15:33 -0400] maniacal: but that's not your issue here.  not that I can see.  in this case it's a permissions issue
[2013-10-16 19:15:53 -0400] maniacal: you want vagrant user to be able to execute something out of root's tmp dir.
[2013-10-16 19:16:06 -0400] glen: maniacal: yes it is exactly so, env var for root: TMPDIR=/root/tmp, is not valid for vagrant user
[2013-10-16 19:16:44 -0400] glen: if chef would had checked that the tmp file it created for bash-resource is not world readable
[2013-10-16 19:17:54 -0400] maniacal: right.  but chef just creates the file in "tmp" doesn't care about user.  since chef-client is running as root then that's the tmp dir.  for anything.
[2013-10-16 19:18:08 -0400] maniacal: maybe you should create a script instead of using a bash resource
[2013-10-16 19:18:59 -0400] glen: yes, i'm porting that bash there to use git resource, but that doesn't solve the problem, just moves the problem elsewhere
[2013-10-16 19:19:20 -0400] maniacal: and then do:    file "/tmp/myscrip.sh" do; owner 'vagrant'; group 'vagrant'; mode 0755; action :create; end
[2013-10-16 19:19:35 -0400] maniacal: and then have your bash resource just execute that script
[2013-10-16 19:19:35 -0400] glen: aside. how do i cast node attribute that could be sting or array into something that i could .each iterate over?
[2013-10-16 19:20:00 -0400] maniacal: cookbook_file, not file
[2013-10-16 19:20:27 -0400] maniacal: though file would work if you provide the contents in the resource def
[2013-10-16 19:20:58 -0400] arussel: when using include_recipe in a cookbook and overriding some attribute of that recipe, what is the difference between setting override['foo']['bar'] in the recipe itself or in the attribute file ?
[2013-10-16 19:21:14 -0400] glen: maniacal: yeah. i got your idea about template
[2013-10-16 19:23:05 -0400] dgarstang2: if I was gonna install a gpg key for an apt repo with execute, anyone know how I'd check to see if it needs to be rerun?
[2013-10-16 19:23:31 -0400] itisit: Hi guys, I deployed rabbitmq using chef's cookbook, but found rabbitmq node restarted about every 10 minutes.
[2013-10-16 19:23:33 -0400] glen: also, how do i check that some deep attribute is defined, something node['some']['deep']['attribute']['should']['exist']
[2013-10-16 19:23:41 -0400] itisit: Does anyone know what's the problem?
[2013-10-16 19:24:17 -0400] glen: itisit: is that 10 minute matching chef-run interval?
[2013-10-16 19:24:47 -0400] Zeelot: hey guys, I can't seem to install rubygems with a chef cookbook anyone have this issue?
[2013-10-16 19:24:56 -0400] itisit: I don't know where to check chef-run interval, but it's around 10min, sometimes 10min 30sec, sometimes less
[2013-10-16 19:25:19 -0400] Zeelot: I am using an lxc container that doesn't seem to have rubygems installed but adding 'package "rubygems"' to my recipe doesn't do anything
[2013-10-16 19:25:28 -0400] glen: itisit: so apparently your cookbook always restarts service. try stopping chef-run and see if it dissapears?
[2013-10-16 19:25:57 -0400] Zeelot: and if I try adding "provider Chef::Provider::Package::Apt" do the package section it throws an exception: NoMethodError: package[rubygems] (kixeye::rubygems line 1) had an error: NoMethodError: undefined method `default_release' for Chef::Resource::Package
[2013-10-16 19:26:29 -0400] jmickle: whats the command to show all attr on a node again in knife?
[2013-10-16 19:26:35 -0400] jmickle: can't believe this is blanking in my mind
[2013-10-16 19:26:45 -0400] jbz: knife node show?
[2013-10-16 19:28:13 -0400] pabst^: Does chef spawn multipl chef-client workers for 1 run?
[2013-10-16 19:28:27 -0400] pabst^: ps aux | grep chef-client | grep worker | wc -l shows 129
[2013-10-16 19:28:59 -0400] itisit: glen: try it now
[2013-10-16 19:29:10 -0400] itisit: thanks
[2013-10-16 19:30:22 -0400] a13x212: when chef edits a file, so it save a copy as .old?
[2013-10-16 19:32:00 -0400] jmickle: jbz: full attributes
[2013-10-16 19:32:18 -0400] tmichael: pabst^ - you can control chef-client forkage with --[no-]fork option
[2013-10-16 19:32:33 -0400] tmichael:     -f, --[no-]fork                  Fork client
[2013-10-16 19:32:36 -0400] jmickle: -l
[2013-10-16 19:32:37 -0400] jmickle: thats what it was
[2013-10-16 19:32:38 -0400] jmickle: ha
[2013-10-16 19:34:33 -0400] jbz: ahhh
[2013-10-16 19:36:40 -0400] pabst^: tmichael: will that stop chef from queuing up runs though?
[2013-10-16 19:36:48 -0400] arussel: I'm reading the doc on attribute, it seems it doesn't take into account cookbook precedence, doesn't it ? so this is not because I depends on a recipe that my default attribute will override that recipe attribute ?
[2013-10-16 19:37:47 -0400] tmichael: pabst^ i ran into issues running chef-client as a service.  would occasionally spawn out of control on me so i finally switched to cron and it solved my problems.  not sure if others had diff experience, but that worked for me
[2013-10-16 19:37:52 -0400] tmichael: https://github.com/opscode-cookbooks/chef-client#cron
[2013-10-16 19:39:09 -0400] maraca: hey folks - getting a lot of SSH::Disconnect when running knife ssh against all instances https://gist.github.com/maraca/1b8e8065a3f6648b0868
[2013-10-16 19:39:15 -0400] maraca: any idea what's causing it?
[2013-10-16 19:40:04 -0400] ssd7_: maraca, the knife-ssh command uses the fqdn attribute on the node to connect by deafult
[2013-10-16 19:40:36 -0400] ssd7_: if your fqdn isn't populated or isn't resolvable, you'll get that
[2013-10-16 19:40:38 -0400] mondo: does not_if not apply to directory resources?
[2013-10-16 19:40:38 -0400] ssd7_: perhaps try adding -a ipaddress
[2013-10-16 19:40:39 -0400] ssd7_: to your command
[2013-10-16 19:40:55 -0400] ssd7_: mondo: Should apply to directory resources just like other resources.
[2013-10-16 19:41:28 -0400] pabst^: tmichael, im considering the same move
[2013-10-16 19:41:40 -0400] pabst^: i keep turning my chef-runs up to every 4 hours, which seems unreasonable to me
[2013-10-16 19:41:49 -0400] mondo: I have this:
[2013-10-16 19:41:51 -0400] pabst^: tmichael: how often are you running chef in cron?
[2013-10-16 19:41:54 -0400] mondo: directory log_dir do
[2013-10-16 19:41:54 -0400] mondo:   owner node['zabbix']['agent']['user']
[2013-10-16 19:41:54 -0400] mondo:   group node['zabbix']['agent']['group']
[2013-10-16 19:41:55 -0400] mondo:   mode "755"
[2013-10-16 19:41:59 -0400] mondo: recursive true
[2013-10-16 19:41:59 -0400] mondo:   notifies :restart, "service[zabbix_agentd]"
[2013-10-16 19:42:00 -0400] mondo:   not_if true
[2013-10-16 19:42:00 -0400] mondo: end
[2013-10-16 19:42:12 -0400] mondo: shouldn't that not_if true cause this to never run?
[2013-10-16 19:42:16 -0400] ssd7: mondo: not_if { true }
[2013-10-16 19:42:23 -0400] ssd7: ^- try that
[2013-10-16 19:42:32 -0400] pabst^: mondo: gist is a little nicer for pasting too. :)
[2013-10-16 19:42:58 -0400] maraca: ssd7 but it works for most instances - i pass the -a ipaddress option in my knife.rb
[2013-10-16 19:42:59 -0400] mondo: cool thanks pabst
[2013-10-16 19:43:03 -0400] mondo: will try ssd7
[2013-10-16 19:43:34 -0400] maraca: https://gist.github.com/maraca/515c5a62a76ded032447 they all have an ip address
[2013-10-16 19:43:58 -0400] maraca: and if i run the same command with each role individually, this does not happen
[2013-10-16 19:44:16 -0400] j^2: maraca: i have that problem (kinda too)
[2013-10-16 19:44:17 -0400] tmichael: pabst^ every 15 mins which is the default for cron recipe
[2013-10-16 19:44:25 -0400] tmichael: 0 */4 * * * /bin/sleep 51;  /usr/bin/chef-client &> /dev/null
[2013-10-16 19:45:21 -0400] mondo: it still ran
[2013-10-16 19:45:21 -0400] mondo: https://gist.github.com/andrewfraley/f7ba35b7b71305b2b35a
[2013-10-16 19:45:31 -0400] maraca: j^2 it makes me wonder if it's related to the amount of instances that are registered with the chef-server
[2013-10-16 19:45:31 -0400] mondo: so what I'm trying to do is get it to not modify the directory permissions if a condition is met
[2013-10-16 19:45:43 -0400] j^2: maraca: it's possible
[2013-10-16 19:46:01 -0400] maraca: but i mean - i only have 40 of them. it seems pretty low :/
[2013-10-16 19:46:02 -0400] pabst^: tmichael: thanks
[2013-10-16 19:46:02 -0400] j^2: my opensource chef server is a...4 gig box
[2013-10-16 19:46:40 -0400] joelmoss: anyone know why this bootstrap command fails with incorrect password: knife bootstrap localhost -p 2200 --sudo -x vagrant -P vagrant -r "role[mongodb]"
[2013-10-16 19:46:54 -0400] joelmoss: then this works=: ssh vagrant@localhost -p 2200
[2013-10-16 19:46:59 -0400] j^2: with... 79 nodes checking in
[2013-10-16 19:47:13 -0400] j^2: i wonder what the ratio should be
[2013-10-16 19:47:17 -0400] joelmoss: same port, hostname, etc
[2013-10-16 19:48:29 -0400] maraca: j^2, i don't know. I run Chef 11, so probably more than 40 :D - also it seems like a client issue rather than a server issue, but it's hard to tell why it's not connecting.
[2013-10-16 19:48:39 -0400] j^2: yeah :-/
[2013-10-16 19:49:00 -0400] j^2: i get not the exact same error, but i think mines due to the solr search finding the different nodes
[2013-10-16 19:49:09 -0400] j^2: i need to spend some time with it
[2013-10-16 19:49:53 -0400] j^2: yeah, my error is this: WARNING: Failed to connect to  -- SocketError: getaddrinfo: nodename nor servname provided, or not known
[2013-10-16 19:50:23 -0400] j^2: running knife ssh "name:*" "uptime"
[2013-10-16 19:50:59 -0400] maraca: yeah slightly different- does any node manage to connect at all?
[2013-10-16 19:51:10 -0400] tmichael: @mondo looks like you need to define your condition in not_if
[2013-10-16 19:51:21 -0400] tmichael: checkout not_if examples on this page: http://docs.opscode.com/resource_common.html#conditionals
[2013-10-16 19:52:33 -0400] mondo: tmichael well I was just using true as a place holder, it doesn't seem to work if a I put a real condition there such as not_if "touch -f /tmp/test"
[2013-10-16 19:52:49 -0400] mondo: sorry "test -f /tmp/test"
[2013-10-16 19:53:44 -0400] Zeelot: anyone know the answer to my question above? :(
[2013-10-16 19:57:17 -0400] j^2: maraca: most, but not all which is the annoying part
[2013-10-16 19:57:45 -0400] rombob: ohai, somebody here knows how create IO optimized EBS volume while running knife ec2 server create
[2013-10-16 19:58:36 -0400] maraca: j^2,  yeah - so similar thing overall :/ some nodes are connecting but not all. It makes it harder to force chef-client to run on all nodes
[2013-10-16 20:00:06 -0400] a13x212: does Chef::Util::FileEdit save a copy of the file it edits?
[2013-10-16 20:02:26 -0400] glen: why is "bash" resource better than "script" resource?
[2013-10-16 20:07:36 -0400] maniacal: glen: it isn't better.  'bash' is just a short name that equals 'script' with "provider Chef::Provider::Script::Bash" as a parameter
[2013-10-16 20:07:51 -0400] maniacal: so maybe it's "better" because it's less typing :)
[2013-10-16 20:08:08 -0400] glen: maniacal: and (how) can i use posix shell /bin/sh ?
[2013-10-16 20:09:28 -0400] maniacal: well, there is an "interpreter" attribute you can pass to 'script' http://docs.opscode.com/chef/resources.html#script
[2013-10-16 20:10:25 -0400] maniacal: never used it but it's name implies it'll do what you want
[2013-10-16 20:10:38 -0400] glen: maniacal: so i do script + interpreter, or bash+interpreter?
[2013-10-16 20:11:06 -0400] maniacal: if you want sh and not bash I'd try with script + interpreter
[2013-10-16 20:11:22 -0400] maniacal: but I'm guessing.  you'll have to test it out
[2013-10-16 20:18:55 -0400] glen: i made some syntax error, but i can't find it, chef says error on line and line number is last line of recipe
[2013-10-16 20:19:08 -0400] glen: .. /var/cache/chef/cookbooks/phabricator/recipes/default.rb:110: syntax error, unexpected $end, expecting keyword_end
[2013-10-16 20:20:02 -0400] b-dean: for any that care I figured out why the output of chef-client is sometimes different depending on if you redirect output. it's this stuff: https://github.com/opscode/chef/blob/master/lib/chef/application.rb#L180-190 with STDOUT.tty?
[2013-10-16 20:20:53 -0400] mmzyk: glen You have a missing end somewhere.
[2013-10-16 20:21:25 -0400] mmzyk: Unfortunately, it's very hard for the compiler to tell you where that is in your recipe.
[2013-10-16 20:21:30 -0400] mondo: so my problem turned out to be my cookbook wasn't updating on the node
[2013-10-16 20:21:50 -0400] mondo: if I make a minor change to cookbook, without incrementing its version number, then upload it
[2013-10-16 20:21:59 -0400] mondo: is that not enough for the client to pull it down again?
[2013-10-16 20:22:42 -0400] mmzyk: glen or you have an extra one in your recipe somewhere. You''re going to need to go through your recipe and match do to ends and see what you find.
[2013-10-16 20:23:33 -0400] glen: arggg, i had some extra "do" at the end of some random line
[2013-10-16 20:24:13 -0400] mmzyk: that would do it. :)
[2013-10-16 20:24:20 -0400] glen: can i name templates by some action name, and use path for actual template?
[2013-10-16 20:24:42 -0400] glen: like instead of writing template "/tmp/something" i do: template "create something"\n path "/tmp/something"
[2013-10-16 20:25:06 -0400] glen: the thing is that i want to use notifies, and it's real annoyng if the template result path is from variables
[2013-10-16 20:25:39 -0400] glen: i tried: http://sprunge.us/bVBb, but that gives error: Cannot find a resource for action_create
[2013-10-16 20:26:06 -0400] glen: template default action is :create according to doc http://docs.opscode.com/resource_template.html
[2013-10-16 20:27:43 -0400] mmzyk: I'm not following what you're asking about glen, w/ template.
[2013-10-16 20:28:09 -0400] mmzyk: You can name it something else and use path option, if you don't want the name to be the path.
[2013-10-16 20:28:25 -0400] mmzyk: So that answers the first part you asked, but you seem to have a second question.
[2013-10-16 20:28:38 -0400] glen: i want to notify the template(second block) from the block above (first block)
[2013-10-16 20:28:48 -0400] mmzyk: mondo, I haven't purposefully ignored you, but I'm not 100% on the answer to your question.
[2013-10-16 20:28:49 -0400] glen: i.e what i pasted does not work
[2013-10-16 20:29:14 -0400] glen: gives NameError
[2013-10-16 20:29:38 -0400] mmzyk: can you gist or paste bin what you pasted so it looks nicer than in irc?
[2013-10-16 20:30:03 -0400] glen: http://sprunge.us/bVBb is not nice?
[2013-10-16 20:30:09 -0400] solvip: glen: that code looks correct, what does the full stacktrace look like?
[2013-10-16 20:30:34 -0400] mondo: no worries, it turns out I was uploading a lower version than the latest version stored on the server
[2013-10-16 20:31:10 -0400] mondo: I didn't understand the server stores multiple versions of cookbooks until just now :)
[2013-10-16 20:31:27 -0400] glen: full trace is not useful, as always http://sprunge.us/eTQd
[2013-10-16 20:31:28 -0400] mmzyk: sorry glen, didn't realize you had pasted that link in.
[2013-10-16 20:32:12 -0400] mmzyk: mondo Yeah, it stores multiple copies so that you can use environment to pin based on cookbook version.
[2013-10-16 20:32:45 -0400] solvip: glen: don't you want notifies :run from Configure Phabricator?
[2013-10-16 20:33:36 -0400] glen: oh. i was looking at wrong block. damn it
[2013-10-16 20:34:28 -0400] glen: why it printed me bash "Upgrade Phabricator storage" do if problem was elsewhere
[2013-10-16 20:35:37 -0400] glen: also, in bash resource, if i use "creates PATH" it should not run that block if PATH exists?
[2013-10-16 20:35:37 -0400] solvip: because that's the resource that fails
[2013-10-16 20:35:49 -0400] glen: or i should change actin from :create to :create_if_not_exists ?
[2013-10-16 20:36:31 -0400] solvip: i'd use not_if { ::File.exists? path }
[2013-10-16 20:37:09 -0400] glen: as by manual it says the resource won't be run http://docs.opscode.com/resource_script.html but it seems still be ran. hmm
[2013-10-16 20:37:24 -0400] solvip: have you tried whyrun?
[2013-10-16 20:37:28 -0400] solvip: it can be really helpful
[2013-10-16 20:37:38 -0400] solvip: chef-client -c /etc/chef/client.rb -w
[2013-10-16 20:37:52 -0400] glen: how do i do that via vagrant provision?
[2013-10-16 20:38:16 -0400] solvip: not sure.  Maybe vagrant ssh and then run that command?
[2013-10-16 21:04:37 -0400] EricL: Is there a way to make Chef show you the output of a template if it were run on a specific node?
[2013-10-16 21:04:57 -0400] ignatz: the version of the s3_file cookbook on opscode's community server fails on the latest chef build for me; can't set the mode of the local file. the version I got from the maintainer's github repo works just fine, bug fixed. how long does that migration to the opscode servers usually take?
[2013-10-16 21:20:25 -0400] glen: anyone can figure out why if i create ohai custom plugins, it makes some recipes to fail first time, but succeed on retry
[2013-10-16 21:20:43 -0400] glen: errors like http://sprunge.us/ZJLY
[2013-10-16 21:20:53 -0400] glen: i.e some objects are nil: undefined method `version' for nil:NilClass
[2013-10-16 21:30:37 -0400] ssd7: glen: Yes, I have a hunch.
[2013-10-16 21:32:43 -0400] ssd7: glen: I'd have to look closely at your recipes to see, but my guess is that when you first install the custom plugin, you aren't reloading ohai until converge time but are trying to use the attribute at compile time.
[2013-10-16 21:33:00 -0400] estahn: is berkshelf preferred over librarian-chef?
[2013-10-16 21:34:05 -0400] ssd7: estahn: Berkshelf is definitely the more widely used tool in the community now.  Librarian-chef is still a good tool though.
[2013-10-16 21:34:35 -0400] glen: ssd7: usually something irrelevant breaks, like "package" resource
[2013-10-16 21:35:03 -0400] Zeelot: hey guys, anyone know why trying to install the rubygems package with apt gives me this? NoMethodError: package[rubygems] (kixeye::rubygems line 1) had an error: NoMethodError: undefined method `default_release' for Chef::Resource::Package
[2013-10-16 21:37:41 -0400] estahn: @ssd7 i remember when i looked at berkshelf that it stored the cookbooks in dot-something directory. is there a way to export the dependencies into a directory? we have to upload all cookbooks to github or S3
[2013-10-16 21:39:16 -0400] gchristensen: estahn: `berks vendor`
[2013-10-16 21:39:27 -0400] estahn: just found it thanks
[2013-10-16 21:39:42 -0400] estahn: "VENDORING COOKBOOKS"
[2013-10-16 21:40:01 -0400] estahn: i
[2013-10-16 21:40:11 -0400] estahn: ill give berkshelf a try again
[2013-10-16 21:52:14 -0400] pwnguin: community participation question, if I want to submit an improvement to a cookbook, say https://github.com/opscode-cookbooks/munin
[2013-10-16 21:52:33 -0400] pwnguin: do I make a new issue? submit a pull request?
[2013-10-16 21:58:43 -0400] ssd7: glen: Odd.  If you can, you might want to post a full debug log to gist.opscode.com
[2013-10-16 21:58:46 -0400] ssd7: err
[2013-10-16 21:58:48 -0400] ssd7: gist.github.com
[2013-10-16 22:01:04 -0400] estahn: is it possible to override attributes only per recipe, e.g. recipe1 which is executed on node1 is using java = 6 and recipe2 executed on node 2 is using java = 7  would i place this in attributes directory of the recipe1/2 directory?
[2013-10-16 22:11:08 -0400] jbz: estahn:  You would want to use namespaced attributes, i.e. have node['recipe1']['java_version']='6' and node['recipe2']['java_version']='7'
[2013-10-16 22:11:10 -0400] glen: ssd7: full debug i get how? -l debug? and is  that secure to post that publicly?
[2013-10-16 22:12:03 -0400] estahn: @jbz are those automatically considered then when including the recipe?
[2013-10-16 22:12:46 -0400] estahn: e.g. default['recipe1']['java_version']='6'  include_recipe 'java"
[2013-10-16 22:45:57 -0400] joelmoss: Need a little please guys...
[2013-10-16 22:46:07 -0400] joelmoss: I have two roles: base and mongodb https://gist.github.com/joelmoss/7016278
[2013-10-16 22:46:28 -0400] joelmoss: created a node with a run list of "role[mongodb]"
[2013-10-16 22:46:58 -0400] joelmoss: but when bootstrapping none of the base recipes are actually run
[2013-10-16 22:47:13 -0400] joelmoss: although chef says this...
[2013-10-16 22:47:14 -0400] joelmoss: resolving cookbooks for run list: ["apt", "build-essential", "chef-client::delete_validation", "chef-client", "mongodb::10gen_repo", "mongodb::replicaset"]
[2013-10-16 22:47:41 -0400] joelmoss: but doesn't actually run any of the first 4 in that list
[2013-10-16 22:47:53 -0400] joelmoss: what am I missing here?
[2013-10-16 22:49:29 -0400] joelmoss: added the result of the run https://gist.github.com/joelmoss/7016278
[2013-10-16 22:50:37 -0400] joelmoss: would really appreciate any help, as my experience with chef has so far been extremely frustrating
[2013-10-16 22:50:40 -0400] Zeelot: anyone know why trying to install the rubygems package with chef doesn't seem to work?
[2013-10-16 22:55:28 -0400] dgarstang2: Okiday... is there any way I could obtain the full size of an lvm volume on a single chef run? I might be able to inspect the full capcacity of a lvm vg from ohai, but that data won't be saved until the chef run is complete.
[2013-10-16 22:56:37 -0400] manfred: Zeelot: how are you trying to install them? i have pretty good success with using this to run my knife bootstrap for centos 6 http://sprunge.us/OYXV
[2013-10-16 22:57:44 -0400] dgarstang2: kind of a disavantage of chef as compared to puppet. you can't get o/s facts until AFTER the chef run is complete, which all but makes them useless
[2013-10-16 22:59:07 -0400] troyready: Ah, wouldn't be a normal workday without dgarstang complaining about Chef compared to Puppet in here.
[2013-10-16 22:59:48 -0400] dgarstang2: troyready: seemed I phrased it rather an objective fashion. I therefore think your assertion that it's a complaint is rather unfair
[2013-10-16 23:00:20 -0400] Zeelot: manfred: I mean installing the package called rubygems
[2013-10-16 23:01:19 -0400] Zeelot: so if I just do 'package "rubygems"' in a recipe, it ignores it, if I try specifying the apt package, it fails with this exception: NoMethodError: package[rubygems] (kixeye::rubygems line 1) had an error: NoMethodError: undefined method `default_release' for Chef::Resource::Package
[2013-10-16 23:01:21 -0400] troyready: dgarstang2, I would normally agree with you, but to not be open to changing your workflow at this point in your chef usage (you didn't just start using it yesterday) leaves me considerably more skeptical
[2013-10-16 23:01:41 -0400] troyready: dgarstang2, fwiw, I'd shell out to gather data for those kinds of things that I'm integrating during a chef run
[2013-10-16 23:02:05 -0400] troyready: That may not be the "right" way to do it, but `cat /prod/mdstat` does work
[2013-10-16 23:02:08 -0400] troyready: etc
[2013-10-16 23:03:33 -0400] manfred: Zeelot: ahh no idea
[2013-10-16 23:04:06 -0400] Zeelot: :(
[2013-10-16 23:10:56 -0400] dgarstang2: troyready: is the shelling out via a native lwrp (execute?) or would I have to use ruby copy that ran something and scraped its output? oh wait... there's a shell lwrp or ... something?
[2013-10-16 23:13:40 -0400] troyready: dgarstang2, for the sort of thing we're discussing, I don't think the Chef resources can do it. Here's an example of what I have done though, for my notebook:
[2013-10-16 23:14:02 -0400] troyready: lspciOutput = `lspci` / if lspciOutput.to_s.include?('Quadro NVS 4200M') / etc
[2013-10-16 23:14:40 -0400] dgarstang2: well, i could use this couldn't I from a script resource? "lvdisplay  | grep "LV Size" | awk '{print $3}'" .... but thats gonna run every time and has to kick of a bunch of resources.
[2013-10-16 23:15:30 -0400] troyready: Yeah, same idea, but I don't think you can capture the data back from the script resource
[2013-10-16 23:15:31 -0400] dgarstang2: troyready: as opposed to getting the data from ohai, which would be less expensive
[2013-10-16 23:15:33 -0400] troyready: (could be wrong on that)
[2013-10-16 23:15:33 -0400] N00bChef: Hey all, I am trying to update a chef recipe that depends on a few gems and uses chef_gem to install them. This works fine if I have the development tools installed (i.e. ruby-devel, gcc, gcc-c++) but we don't want compilers on production machines. Is there a clean way for me to achieve this? right now I am down a nasty rat hole of taking the right gems and their dependencies, including them as resources in my cookbook and chef_gem ins
[2013-10-16 23:15:45 -0400] dgarstang2: but it's expensive
[2013-10-16 23:16:25 -0400] troyready: Doesn't seem dramatically more so than constant ohai/chef-client runs, but you might be right
[2013-10-16 23:17:19 -0400] dgarstang2: troyready: I already have the instance type and the pvdisks from the data. Could just add the capacity as a new key I suppose
[2013-10-16 23:17:27 -0400] dgarstang2: s/data/data bag/
[2013-10-16 23:19:52 -0400] troyready: Indeed. I generally operate on the assumption that system gathering stuff like isn't that big of a deal to do with chef-client runs (a drop in the bucket compared to the overall operation), but (yet again) I could be looking at that incorrectly
[2013-10-16 23:19:59 -0400] Skeletor1: N00bChef: Ive tried that once doing no compilers on production, didnt work so well and spent alot of effort building RPMs for the gems I needed
[2013-10-16 23:23:15 -0400] N00bChef: @Skeletor1: thanks, I guess I will install them during the run and uninstall at the end.
[2013-10-16 23:25:05 -0400] 17SADFNJW: what are people using these days for datacenter asset inventory like rack tables and the like?
[2013-10-16 23:25:12 -0400] 17SADFNJW: with intergration with chef
[2013-10-16 23:26:11 -0400] Skeletor1: N00bChef:  you may run into issues though were the gems are compiled using shared libraries and those shared libs arent there when the gem is called and get errors
[2013-10-16 23:26:45 -0400] maniacal: I have an attirbute that changes during a chef run.  I have a template that uses that attribute but it seems to be using the attribute as it is at the beginning of the run.
[2013-10-16 23:27:03 -0400] maniacal: so how do I tell chef to use the attribute in memory, or to resource the attribute
[2013-10-16 23:28:06 -0400] 17SADFNJW: anyone have any recommendations?
[2013-10-16 23:29:23 -0400] N00bChef: @Skeletor1: yes, that's exactly what happened when I started installing the packaged gems. Given that & your experience, I am going to go with the alternative approach (i.e. install dev tools, do recipe work, uninstall dev tools)
[2013-10-16 23:33:31 -0400] Skeletor1: N00bChef:  I ended up statically linking my own rpm/dpkg packages when I built them for all the gems that were required, it was a pain to track all the dependencies. May the force be with you
[2013-10-16 23:37:12 -0400] maniacal: so here's a gist of my issue if anyone has time to look:  https://gist.github.com/Maniacal/7016848
[2013-10-16 23:39:11 -0400] maniacal: maybe I'll simplify the testing and send it in an email.  it's an attibute precedence thing I guess.  really annoying.  attribute is set properly BEFORE the template resource is called but for some reason template resource is using attribute as it was an converge time.  not as it is in realtime
[2013-10-16 23:47:24 -0400] estahn: i run chef-solo in a vagrant box and after an exception i fix something and re-run the provisioning but some of the recipes seem to be jumped
[2013-10-16 23:47:42 -0400] estahn: is there an explanation why  its seems chef behaves much more unpredictable then puppet
[2013-10-16 23:48:02 -0400] estahn: which is strange since its ordered vs graph
[2013-10-16 23:48:58 -0400] xnm: Hey. I recently tried hosted chef, but then switched back to chef solo, but now every time I try to provision my vagrant, i get the following error in my log: ERROR: Chef::Exceptions::PrivateKeyMissing: I cannot read /etc/chef/validation.pem, which you told me to use to sign requests!
[2013-10-16 23:49:10 -0400] xnm: whats going on?
[2013-10-16 23:49:29 -0400] estahn: i
[2013-10-16 23:50:46 -0400] estahn: i'm a bit worried about chef-solo not being able to manage configuration changes properly  has someone insights? is chef-solo able to workout in as long-term configuration management system?
[2013-10-16 23:54:56 -0400] jameson__: question about metadata.rb and depends
[2013-10-16 23:55:06 -0400] jameson__: the docs says that chef-client blah blah chef-server
[2013-10-16 23:55:12 -0400] jameson__: what happens for chef-solo?
[2013-10-16 23:55:51 -0400] jameson__: i guess what happens, if I don't satisfy the version constraint
