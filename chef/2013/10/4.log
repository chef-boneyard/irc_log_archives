[2013-10-04 00:18:46 -0400] broconne: is it possible to less than or greater than in a knife search?  I see the [ TO ] syntax, but don't see examples off less than or greater then.
[2013-10-04 00:24:24 -0400] cwj: broconne: https://wiki.apache.org/solr/SolrQuerySyntax shows how to use [ TO ] syntax for less than or equal to and greater than or equal to
[2013-10-04 00:24:46 -0400] cwj: maybe that helps
[2013-10-04 00:27:36 -0400] broconne: thanks cwj
[2013-10-04 00:29:52 -0400] broconne: this is odd...
[2013-10-04 00:30:07 -0400] broconne: knife (or lucene is ignoring some of my search query)...
[2013-10-04 00:30:22 -0400] broconne: [vagrant@eidevchef ~]$ knife ssh -P vagrant "platform:redhat and LCS_version:3.1.0-0 and counters_network_interfaces_eth0_tx_packets:463" "uptime"
[2013-10-04 00:30:22 -0400] broconne: LCS-berkshelf  20:29:20 up  7:17,  1 user,  load average: 0.00, 0.00, 0.00
[2013-10-04 00:30:22 -0400] broconne: [vagrant@eidevchef ~]$ knife ssh -P vagrant "platform:redhat and LCS_version:3.1.0-0 and counters_network_interfaces_eth0_tx_packets:43" "uptime"
[2013-10-04 00:30:23 -0400] broconne: LCS-berkshelf  20:29:27 up  7:17,  1 user,  load average: 0.00, 0.00, 0.00
[2013-10-04 00:30:27 -0400] broconne: only that first one is true..
[2013-10-04 00:31:03 -0400] cwj: and should be AND
[2013-10-04 00:31:48 -0400] broconne: thanks!
[2013-10-04 00:33:17 -0400] cwj: you bet :)
[2013-10-04 00:34:17 -0400] broconne: can you do the "[ TO ] syntax when the rest of the value is chars?   knife ssh -P vagrant "platform:redhat AND LCS_version:3.1.0-0 AND memory_active:[0 TO 85564]kB" "uptime"
[2013-10-04 00:34:17 -0400] broconne: FATAL: No nodes returned from search!
[2013-10-04 00:34:20 -0400] broconne: that didn't seem tow ork
[2013-10-04 00:34:43 -0400] cwj: hrm i dunno
[2013-10-04 00:36:06 -0400] broconne: well, at least I stumped you :-)
[2013-10-04 00:38:09 -0400] cwj: yeah not as hard as one might think
[2013-10-04 02:18:35 -0400] alunduil: Is it possible to stop berkshelf from locking cookbook versions?
[2013-10-04 03:41:17 -0400] sgronblom: So I tried to do knife cookbook site download nodejs, and I got a targz file into my chef-repo. Shouldn't knife also have unpacked it to cookbooks or?
[2013-10-04 03:53:27 -0400] juliancdunn: sgronblom: nope, it only downloads the tarball
[2013-10-04 03:53:46 -0400] sgronblom: Yeah I just noticed there is a knife cookbook site install as well
[2013-10-04 04:21:32 -0400] sgronblom: Ok so I managed to knife download nodejs, then knife upload ., put all the .pem files in .chef in my Vagrantfile repo, run vagrant up followed by vagrant provision and it now seems to be installing. However it's a centos box and still it seems to be installing the apt recipe. Why is that?
[2013-10-04 04:27:48 -0400] Glacee: I was wondering if there is a way to change the behavior in the chef server 11 web ui. When you edit a node.. it puts the environment back to _default instead of keeping it in the same environment that it is currently is.
[2013-10-04 04:27:55 -0400] Glacee: IS there a way to configure this behavior
[2013-10-04 07:58:20 -0400] sgronblom: What is the intended workflow for adding a node to a chef-server?
[2013-10-04 08:19:43 -0400] sgronblom: Is the validation key used the first time to access a chef-server and then a different key pair is used?
[2013-10-04 08:27:10 -0400] fishGoM00: sgronblom: not sure what you mean here, why would you use a different key pair?
[2013-10-04 08:35:51 -0400] sgronblom: fishGoM00: Well what if you wanted to revoke the right to provision a server or something?
[2013-10-04 08:36:15 -0400] sgronblom: If all nodes are using the same keypair you would have to replace the key on all nodes?
[2013-10-04 09:11:44 -0400] sacoetzee: hey guys, trying to build a knife plugin. How do I call `knife node [subcommand]` from within a custom plugin?
[2013-10-04 09:12:42 -0400] sacoetzee: complete new guy to ruby and building knife plugins
[2013-10-04 09:25:06 -0400] dmdeklerk: Question.. about chef-solo-search: Does chef-solo-search create `data_bags/node/[instance-name].json` or should I do that.
[2013-10-04 09:25:17 -0400] dmdeklerk: Question (related).. Does chef-solo-search populate the contents of `data_bags/node/[instance-name].json` (specificly the `automatic > ipaddress`) or should I do that?
[2013-10-04 09:30:10 -0400] dmdeklerk: damn need to reboot..
[2013-10-04 09:39:49 -0400] Guest77498: sleeeeeeeeeeeeeeeeep
[2013-10-04 09:54:40 -0400] UukGoblin: can I create a data bag item but only if one by the same name doesn't already exist?
[2013-10-04 09:54:48 -0400] UukGoblin: and get an error if it does exist?
[2013-10-04 09:59:16 -0400] dmdeklerk: Question.. about chef-solo-search: Does chef-solo-search create `data_bags/node/[instance-name].json` or should I do that.
[2013-10-04 09:59:22 -0400] dmdeklerk: Question (related).. Does chef-solo-search populate the contents of `data_bags/node/[instance-name].json` (specificly the `automatic > ipaddress`) or should I do that?
[2013-10-04 10:19:43 -0400] lewiz: I think I'm seeing stuff being executed out of order.  Has anybody seen this before?
[2013-10-04 10:23:52 -0400] UukGoblin: lewiz, order of things happening in chef is... weird
[2013-10-04 10:24:04 -0400] david118: am i write in thinking 'kitchen verify' doesn't reapply the cookbooks, so if I want to use test-kitchen as part of a dev workflow i need to use 'kitchen converge && kitchen verify' ?
[2013-10-04 10:25:34 -0400] lewiz: UukGoblin: Yes - I think I just found my answer though at http://nuknad.com/2011/08/31/chef-recipe-order/.  I was using a "::Dir.delete" to work around a known Windows bug with the directory recipe.  Looks like I need to do that inside a ruby_block!
[2013-10-04 10:25:46 -0400] UukGoblin: yeah
[2013-10-04 10:25:56 -0400] UukGoblin: lewiz, sounds right
[2013-10-04 10:26:07 -0400] workmad3: UukGoblin: the chef order isn't 'weird', it's just got a 2-phase run
[2013-10-04 10:26:25 -0400] UukGoblin: direct ruby statements will be run during a compile phase, whereas resources will be run during "runtime" phase
[2013-10-04 10:26:39 -0400] UukGoblin: workmad3, precisely
[2013-10-04 10:26:48 -0400] lewiz: UukGoblin: That's what I've just discovered :-)
[2013-10-04 10:27:13 -0400] workmad3: UukGoblin: describing it as 'weird' makes people think it's hard to understand though ;) whereas it's pretty easy, you just need to be aware of the 2 phases :)
[2013-10-04 10:27:34 -0400] UukGoblin: workmad3, it tends to make things complicated and tricky, yeah
[2013-10-04 10:27:41 -0400] UukGoblin: for instance
[2013-10-04 10:27:43 -0400] UukGoblin: if you do
[2013-10-04 10:27:56 -0400] UukGoblin: foo = search(:databagname, "some:search")
[2013-10-04 10:28:01 -0400] UukGoblin: it's different to
[2013-10-04 10:28:14 -0400] UukGoblin: node.default["fooattr"] = search(:databagname, "some:search")
[2013-10-04 10:28:23 -0400] UukGoblin: i.e. in the former case, the search will be run during compile time
[2013-10-04 10:28:30 -0400] UukGoblin: in the latter, during the "runtime" phase
[2013-10-04 10:28:40 -0400] UukGoblin: and I can't quite figure out why
[2013-10-04 10:28:49 -0400] workmad3: UukGoblin: the search will be run during the compile in both of them
[2013-10-04 10:29:00 -0400] UukGoblin: (or perhaps searchef just does something weird between the two phases)
[2013-10-04 10:29:21 -0400] UukGoblin: workmad3, yeah, but the former doesn't work with searchef, whereas the latter does
[2013-10-04 10:29:30 -0400] UukGoblin: (if you have a search stub above all that)
[2013-10-04 10:29:34 -0400] workmad3: UukGoblin: what will confuse things there is the behaviour of node.default
[2013-10-04 10:30:33 -0400] UukGoblin: also, consider something like this:
[2013-10-04 10:30:35 -0400] workmad3: UukGoblin: which will be applying attribute ordering (the behaviour of which changed recently and I'm still not sure of all the ramifications)
[2013-10-04 10:30:40 -0400] UukGoblin: var = "string"
[2013-10-04 10:30:58 -0400] UukGoblin: directory "/foo/bar" do owner var; end
[2013-10-04 10:31:04 -0400] UukGoblin: var = "different string"
[2013-10-04 10:31:10 -0400] UukGoblin: what will the owner end up as?
[2013-10-04 10:31:16 -0400] workmad3: "string"
[2013-10-04 10:31:18 -0400] UukGoblin: right
[2013-10-04 10:31:23 -0400] workmad3: UukGoblin: that's just basic ruby
[2013-10-04 10:31:28 -0400] UukGoblin: but then
[2013-10-04 10:31:35 -0400] UukGoblin: var = { "owner": "string" }
[2013-10-04 10:31:56 -0400] UukGoblin: directory "/foo/bar" do owner var["owner"]; end
[2013-10-04 10:32:04 -0400] UukGoblin: var["owner"] = "different string"
[2013-10-04 10:32:09 -0400] workmad3: still "string" ;)
[2013-10-04 10:32:26 -0400] workmad3: or rather, syntax error
[2013-10-04 10:32:40 -0400] workmad3: because 'var = {"owner": "string"}' isn't valid syntax :P
[2013-10-04 10:33:01 -0400] UukGoblin: yeah
[2013-10-04 10:34:12 -0400] dmdeklerk: haha. Its like watching IRB having a conversation
[2013-10-04 10:34:20 -0400] workmad3: now, if you did 'var = {foo: "bar"}; template "/foo"; variables var; end; var[:foo] = "buzz"' then I can forsee confusion
[2013-10-04 10:34:21 -0400] UukGoblin: workmad3, and that's mega-confusing. compare with: http://pastebin.com/nKLXUGbs
[2013-10-04 10:34:25 -0400] UukGoblin: standard ruby will behave differently
[2013-10-04 10:34:27 -0400] workmad3: because it would depend on when the rendered template is done
[2013-10-04 10:35:00 -0400] workmad3: UukGoblin: chef behaves exactly like standard ruby
[2013-10-04 10:35:12 -0400] workmad3: UukGoblin: you're just confused as to when the block passed to resources is evaluated ;)
[2013-10-04 10:35:37 -0400] UukGoblin: workmad3, yeah
[2013-10-04 10:35:43 -0400] UukGoblin: workmad3, hence "weird" :-]
[2013-10-04 10:35:45 -0400] workmad3: UukGoblin: the block is evaluated straight away
[2013-10-04 10:35:48 -0400] workmad3: UukGoblin: not 'weird'
[2013-10-04 10:36:05 -0400] workmad3: UukGoblin: if you did 'a.call' before changing the hash (which would be a correct comparison)
[2013-10-04 10:36:28 -0400] UukGoblin: yeah
[2013-10-04 10:36:50 -0400] UukGoblin: so the blocks get executed at compile time?
[2013-10-04 10:36:56 -0400] workmad3: yes
[2013-10-04 10:37:12 -0400] UukGoblin: ok, didn't know that
[2013-10-04 10:37:22 -0400] UukGoblin: I thought they were saved "for later" in the resource objects
[2013-10-04 10:38:57 -0400] workmad3: chef needs to know about things like what action to run straight away in order to compile it's plan fully
[2013-10-04 10:39:38 -0400] workmad3: I'll admit I'm not sure when a template is rendered... but again, I think it's in the compile phase, because that has a bearing on whether a template resource needs to be run or not
[2013-10-04 10:40:01 -0400] UukGoblin: workmad3, and then there are definitions
[2013-10-04 10:40:08 -0400] UukGoblin: when you start getting definitions inside definitions...
[2013-10-04 10:40:14 -0400] UukGoblin: you suddenly have to do things like
[2013-10-04 10:40:18 -0400] UukGoblin: param_foo = params[:foo]
[2013-10-04 10:40:33 -0400] UukGoblin: because if you use params[:foo] the nested definition will see it as nil
[2013-10-04 10:40:42 -0400] UukGoblin: also not sure exactly why
[2013-10-04 10:40:55 -0400] UukGoblin: ok, anyway, I digress
[2013-10-04 10:40:58 -0400] workmad3: because the blocks are executed with instance_eval(&blk)
[2013-10-04 10:41:01 -0400] workmad3: so the context changes
[2013-10-04 10:41:39 -0400] workmad3: it's why you get resource attributes as method calls on an implicit 'self'
[2013-10-04 10:42:25 -0400] workmad3: (and if you did 'puts self' inside and outside a resource or definition block, you would see the change :) )
[2013-10-04 10:44:49 -0400] workmad3: UukGoblin: chef is still just plain ruby though... it doesn't behave in ways that standard ruby doesn't... it just may act in ways that someone may not realise that ruby can act :)
[2013-10-04 10:45:44 -0400] david118: why does 'kitchen test --destroy=never' seem to always destroy and recreate VMs?
[2013-10-04 10:46:54 -0400] workmad3: UukGoblin: btw, there's a nicer way of getting your log statements to appear at the right time than wrapping it up in a ruby_block resource
[2013-10-04 10:47:07 -0400] workmad3: UukGoblin: there's a 'log' resource provider ;) 'log "Apache2 installed" '
[2013-10-04 10:47:50 -0400] workmad3: UukGoblin: worth noting, as logging is one of the places where compile/run time is most easily messed up :)
[2013-10-04 10:48:21 -0400] UukGoblin: workmad3, yeah, I know about the 'log' resource, it's handy
[2013-10-04 12:51:39 -0400] jag: jphine: artf159565
[2013-10-04 12:52:01 -0400] jag: wrong window sorry !
[2013-10-04 12:59:14 -0400] mveitas: Good morning. I am trying to use the command  'knife upload /roles' but nothing is being uploaded to the server
[2013-10-04 13:17:53 -0400] workmad3: hmm, looking at chef tags... is there a way to add a tag inside a resource provider?
[2013-10-04 13:23:23 -0400] workmad3: mveitas: have you really created a directory 'roles' in /?
[2013-10-04 13:34:04 -0400] mveitas: yes, turns out the Jenkins server had an incorrect path to the chef_repo directory
[2013-10-04 13:40:04 -0400] michael_mbp: hi all, I'm rather new chef-etc.
[2013-10-04 13:40:14 -0400] michael_mbp: is it a good idea to start off with knife-solo?
[2013-10-04 13:42:38 -0400] a_ro: I would recommend it
[2013-10-04 13:43:22 -0400] a_ro: I use chef now for round about half a year and I do not see any benefits of a chef-server (unless you have to manage a whole bunch of servers/nodes)
[2013-10-04 13:44:18 -0400] a_ro: since chef 11.6.0 you can use all features within knife-solo (encrypted databags, environments)so there's no feature block
[2013-10-04 13:44:30 -0400] ezotrank: with chef-solo you every time you load all cookbooks to server and it's not good (
[2013-10-04 13:45:06 -0400] a_ro: noit can be cached on your nodeand since it uses rsync only the difference is transferred
[2013-10-04 13:46:15 -0400] a_ro: btw I would also recommend to learn chef within vagrantso you dan't have to transfer it over the net
[2013-10-04 13:46:18 -0400] ezotrank: it's default behaviour?
[2013-10-04 13:46:36 -0400] michael_mbp: thanks a_ro  yeah I'll have a play with vagrant
[2013-10-04 13:46:40 -0400] a_ro: unless you do not cleanup after your chef run it is default behaviour imho
[2013-10-04 13:47:15 -0400] michael_mbp: so the thing that I'm wondering about is the generated kitchen
[2013-10-04 13:47:28 -0400] michael_mbp: I take it we make this a git repository and keep it private right?
[2013-10-04 13:47:29 -0400] workmad3: a_ro: the main benefit is search for a chef-server... but not everyone needs that :)
[2013-10-04 13:47:39 -0400] michael_mbp: hey workmad3 o/
[2013-10-04 13:47:45 -0400] a_ro: knife-solo also supports search
[2013-10-04 13:47:50 -0400] a_ro: ;-)
[2013-10-04 13:48:05 -0400] a_ro: michael_mbp: right - keep it in a private repo
[2013-10-04 13:48:08 -0400] workmad3: a_ro: oh, does it? cool :) how does it do that? or does it just stub things?
[2013-10-04 13:48:37 -0400] michael_mbp: say you want to create your own nginx cookbook, where would you store it's configs? under resources? (I know typically it's inside the rails app itself)
[2013-10-04 13:48:51 -0400] michael_mbp: *oops, I mean for unicorn, it's in the rails app.
[2013-10-04 13:49:16 -0400] michael_mbp: and do you 'script' the cookbooks to copy/paste these scripts into place?
[2013-10-04 13:49:30 -0400] n1ko: umm... you mean templates?
[2013-10-04 13:49:30 -0400] workmad3: michael_mbp: take a look at the application_ruby cookbook ;)
[2013-10-04 13:49:45 -0400] michael_mbp: thanks
[2013-10-04 13:50:20 -0400] a_ro: I dont use search but I read something about data_bag search
[2013-10-04 13:50:38 -0400] dmdeklerk: Question.. about chef-solo-search: Does chef-solo-search create `data_bags/node/[instance-name].json` or should I do that?
[2013-10-04 13:50:48 -0400] michael_mbp: ah there are templates!
[2013-10-04 13:50:53 -0400] a_ro: of course it might work different to the chef-server search...
[2013-10-04 13:50:53 -0400] dmdeklerk: Question (related).. Does chef-solo-search populate the contents of `data_bags/node/[instance-name].json` (specifically the `automatic > ipaddress`) or should I do that?
[2013-10-04 13:51:46 -0400] a_ro: michael_mbp: I usually use wrapper cookbooksbut am moving to roles/environments now..
[2013-10-04 13:52:44 -0400] a_ro: dmdeklerk: imho you have to create the databags on your own
[2013-10-04 13:53:04 -0400] dmdeklerk: a_ro: do I have to give it an ipadress?
[2013-10-04 13:53:23 -0400] dmdeklerk: cant ohai do that and use data_bag write?
[2013-10-04 13:53:34 -0400] michael_mbp: looks like the 'application' cookbook is the main one
[2013-10-04 13:53:41 -0400] a_ro: noautomatic attributes are not inside databags...
[2013-10-04 13:54:05 -0400] renchap: is it a way to list available templates from a recipe ?
[2013-10-04 13:54:07 -0400] a_ro: why would you do that?!
[2013-10-04 13:55:08 -0400] dmdeklerk: a_ro: In order to use application_ruby I need search. And chef-solo needs chef-solo-search for that,. and it's kinda confusing
[2013-10-04 13:55:28 -0400] dmdeklerk: so thats why :)
[2013-10-04 13:56:42 -0400] a_ro: https://github.com/opscode-cookbooks/application_ruby needs search?!
[2013-10-04 13:56:53 -0400] michael_mbp: workmad3: do you test with vagrant or virtualbox instances?
[2013-10-04 13:57:15 -0400] dmdeklerk: Yes for multiple machines it does (database master)
[2013-10-04 13:57:27 -0400] workmad3: michael_mbp: currently I'm TDDing with chefspec
[2013-10-04 13:57:47 -0400] danny: Hi All, a bit of a question.  Can I configure chef in such a way so that certain users only have access to certain environments?  All I see is the ability to label them an admin or not.
[2013-10-04 13:57:48 -0400] michael_mbp: heh!
[2013-10-04 13:58:01 -0400] workmad3: michael_mbp: I've done some vagrant testing before too, and I'm planning on putting some minitest-chef-handler stuff into these resources too eventually
[2013-10-04 13:59:23 -0400] a_ro: dmdeklerk: well..you probably have to rewrite this to fit your needs as said - I haven't used search anywhere
[2013-10-04 14:00:01 -0400] dmdeklerk: its used here: https://github.com/opscode-cookbooks/application_ruby/blob/49969b30e278c61d4b1ad0e49253aca8f064762a/providers/rails.rb
[2013-10-04 14:00:05 -0400] workmad3: dmdeklerk: you can provide the database host explicitly and not specify the database_master role
[2013-10-04 14:00:16 -0400] workmad3: dmdeklerk: at which point, search isn't invoked
[2013-10-04 14:00:33 -0400] mattupstate: danny: i know that you can from the hosted chef web UI
[2013-10-04 14:00:59 -0400] dmdeklerk: whould host just be an ipadress? Or do I have to specify a port in my database.yml to?
[2013-10-04 14:01:51 -0400] mattupstate: danny: there's a permissions tab
[2013-10-04 14:04:53 -0400] heathsnow_: anyone have a link to that blog post about setting up a .net website?
[2013-10-04 14:06:21 -0400] workmad3: dmdeklerk: I suspect you can set a port if you're not using the standard one for your db
[2013-10-04 14:06:39 -0400] dmdeklerk: ok thank you..
[2013-10-04 14:08:00 -0400] heathsnow_: ah, found it:  http://www.slideshare.net/opscode/opscode-webinar-cooking-with-chef-on-microsoft-windows
[2013-10-04 14:08:00 -0400] lewiz: A powershell_script command is failing.  Is there any way to prevent the generated .ps1 file from being removed so I can debug further?
[2013-10-04 14:08:17 -0400] michael_mbp: gah getting confused here
[2013-10-04 14:08:30 -0400] michael_mbp: I'm seeing articles on using knife-solo and then they are also configuring vagrant it self
[2013-10-04 14:11:08 -0400] michael_mbp: ohh they are 'locally' configuring the vagrant box
[2013-10-04 14:12:29 -0400] michael_mbp: a_ro: do you guys test your 'config' locally in a virtual instance and only if it all sets up right that you later bootstrap new servers?
[2013-10-04 14:12:33 -0400] michael_mbp: that makes sense right?
[2013-10-04 14:13:17 -0400] a_ro: yepI usually do a lot of work locally in vagrant until all sits right and I provision remote servers with knife-solo
[2013-10-04 14:13:26 -0400] dmdeklerk: I have this in my Vagrantfile: config.vm.define 'database-master' do |db|; ... db.vm.network :private_network, ip: "33.33.33.17"; ... end
[2013-10-04 14:13:32 -0400] dmdeklerk: Now what will be the value for "host" be in my application_ruby based recipe: application do; rails do; database do; host = ????;
[2013-10-04 14:13:38 -0400] dmdeklerk: Would that be just host = '33.33.33.17'
[2013-10-04 14:14:21 -0400] a_ro: dmdeklerk: yesor localhostassumed the db is in the same machine
[2013-10-04 14:14:31 -0400] dmdeklerk: no different machines !!!
[2013-10-04 14:14:40 -0400] dmdeklerk: a ok
[2013-10-04 14:15:24 -0400] a_ro: -> http://docs.vagrantup.com/v2/multi-machine/index.html
[2013-10-04 14:16:02 -0400] a_ro: "Multiple machines within the same private network (also usually with the restriction that they're backed by the same provider) can communicate with each other on private networks."
[2013-10-04 14:16:17 -0400] a_ro: so use the IP as host
[2013-10-04 14:16:35 -0400] a_ro: but make sure mysql is configured to allow access from "outside"
[2013-10-04 14:16:51 -0400] dmdeklerk: that might be it
[2013-10-04 14:17:13 -0400] dmdeklerk: I would assume application_ruby would do that out of the box
[2013-10-04 14:17:36 -0400] dmdeklerk: it would be the (lazy) rails/ruby way
[2013-10-04 14:18:13 -0400] a_ro: I don't think sohaving multiple machines is not that sort of "standard setup"..
[2013-10-04 14:18:33 -0400] dmdeklerk: very helpfull
[2013-10-04 14:18:36 -0400] dmdeklerk: ty
[2013-10-04 14:19:16 -0400] dmdeklerk: any idea where the output for db:migrate is stored. had some trouble locating it last time
[2013-10-04 14:19:51 -0400] a_ro: thats too rails specific for me ;-)
[2013-10-04 14:48:15 -0400] danny: mattupstate, hrm, I don't see that in the opensource version.  where is the perms tab?
[2013-10-04 14:50:07 -0400] mattupstate: danny: as i said, in hosted-chefnot sure about anywhere else
[2013-10-04 15:13:35 -0400] jstallard: is there a "correct" way to require a chef_gem that's needed by the provider in a lwrp?
[2013-10-04 15:18:07 -0400] michael_mbp: where can I get a list of all the cookbooks I can use in a berksfile
[2013-10-04 15:18:24 -0400] michael_mbp: or at least typical ones for a rails stack such as unicorn, rbenv etc.
[2013-10-04 15:18:35 -0400] bean: its unlikely that such a list exists
[2013-10-04 15:18:49 -0400] michael_mbp: hmm
[2013-10-04 15:18:57 -0400] michael_mbp:  so do you just 'guess' and add cookbook 'rbenv' or?
[2013-10-04 15:19:09 -0400] bean: no, i google for cookbooks.
[2013-10-04 15:19:12 -0400] michael_mbp: check opscode on github I guess
[2013-10-04 15:19:16 -0400] bean: yep
[2013-10-04 15:19:32 -0400] bean: http://community.opscode.com/ has a search
[2013-10-04 15:19:33 -0400] michael_mbp: http://community.opscode.com/cookbooks ha
[2013-10-04 15:20:54 -0400] michael_mbp: ok so how can I tell this what version of ruby to install? that goes in the node info I guess?
[2013-10-04 15:21:05 -0400] workmad3: michael_mbp: read the README for the cookbook
[2013-10-04 15:21:42 -0400] michael_mbp: of course, heh workmad3 :p
[2013-10-04 15:22:45 -0400] workmad3: I quite like that fnichol's rvm cookbook gives you rvm resources to install rubies and gems :)
[2013-10-04 15:23:02 -0400] workmad3: I wish it gave you a resource to install RVM itself on top of that
[2013-10-04 15:23:17 -0400] fooJBar: package "rvm"?
[2013-10-04 15:24:24 -0400] workmad3: fooJBar: unfortunately not :( https://github.com/fnichol/chef-rvm/blob/master/recipes/system_install.rb
[2013-10-04 15:24:52 -0400] workmad3: hmm, it does have an install_rvm resource method there
[2013-10-04 15:30:40 -0400] michael_mbp: workmad3: I did a knife init
[2013-10-04 15:30:45 -0400] michael_mbp: but there's no node.json ?
[2013-10-04 15:30:56 -0400] michael_mbp: or any metadata file?
[2013-10-04 15:39:15 -0400] brian_asdf: Hi, can someone point me to an example of a chef spec which mocks a third party cookbook's resource (runit_service in my case)?
[2013-10-04 15:42:02 -0400] jchauncey: brian_asdf: are you wanting to test the third party cookbook? or just test what it produces?
[2013-10-04 15:43:23 -0400] brian_asdf: I want to test my own lwrp. I want to test that my lwrp is interacting correctly with the third party lwrp.
[2013-10-04 15:44:06 -0400] jchauncey: you are probably better off testing that through test-kitchen with something like serverspec
[2013-10-04 15:44:38 -0400] jchauncey: although i wonder if you just tell chefspec to step into the runit lwrp it that would cause it to execute it
[2013-10-04 15:47:11 -0400] brian_asdf: no, the problem is that the runit cookbook cannot be loaded. I have not included it in the cookbook_path. It is not in my interest here to load it.
[2013-10-04 15:47:20 -0400] brian_asdf: perhaps I am approaching this in the wrong way
[2013-10-04 15:47:49 -0400] jchauncey: then how are you going to use it?
[2013-10-04 15:48:44 -0400] brian_asdf: You have just got to the root of my question..
[2013-10-04 15:48:50 -0400] brian_asdf: How do I test an lwrp?
[2013-10-04 15:49:26 -0400] jchauncey: typically we write integration tests for lwrps which means you have a test recipe that calls your lwrp
[2013-10-04 15:49:36 -0400] cwj: same here
[2013-10-04 15:50:07 -0400] cwj: test-kitchen runs test cookbooks which exert the lwrp code
[2013-10-04 15:50:37 -0400] brian_asdf: so you are not unit testing them as such?
[2013-10-04 15:51:04 -0400] jchauncey: right
[2013-10-04 15:51:58 -0400] brian_asdf: hmmm, does this seem like a gap?
[2013-10-04 15:52:54 -0400] jchauncey: lwrps are just hard to test
[2013-10-04 15:53:00 -0400] jchauncey: and unit testing is just weird in cehf
[2013-10-04 15:53:29 -0400] brian_asdf: I am finding that all right
[2013-10-04 15:53:34 -0400] brian_asdf: thanks for your help
[2013-10-04 15:53:35 -0400] jtimberman: jchauncey: which is why, when i rewrote the "runit_service" definition as a resource, i made it a "non-LWRP" resource. I also wanted to subclass Chef::Resource::Service.
[2013-10-04 15:53:35 -0400] brian_asdf: !
[2013-10-04 15:53:51 -0400] jtimberman: it was super duper easy to test when it looked like a "normal Ruby class" :)
[2013-10-04 15:54:23 -0400] michael_mbp: er sorry guys
[2013-10-04 15:54:32 -0400] michael_mbp: where do I 'configure' my cookbook usage?
[2013-10-04 15:55:29 -0400] bean: michael_mbp: do you mean like cookbook path, etc?
[2013-10-04 15:55:41 -0400] michael_mbp: I did berks install but I don't have any cookbooks hm
[2013-10-04 15:55:43 -0400] michael_mbp: hmm
[2013-10-04 15:55:49 -0400] jchauncey: do you have a berksfile
[2013-10-04 15:56:10 -0400] michael_mbp: ohh all the config stuff goes in the node?
[2013-10-04 15:56:16 -0400] jchauncey: and does that berksfile reference any cookbooks directly? if not does it call out to metadata and are there any cookbooks there?
[2013-10-04 15:56:27 -0400] bean: michael_mbp: have you watched "the berkshelf way"
[2013-10-04 15:56:33 -0400] michael_mbp: uh one sec
[2013-10-04 15:56:46 -0400] michael_mbp: yes I've got a Berksfile
[2013-10-04 15:56:49 -0400] michael_mbp: and a Berksfile.lock
[2013-10-04 15:58:26 -0400] michael_mbp: what confuses me is that if you look at this https://github.com/opscode-cookbooks/database the README shows a Ruby DSL for configuring usage, but I think that's done via whatever node file (JSON)
[2013-10-04 15:59:31 -0400] michael_mbp: bean thanks I'll look for it
[2013-10-04 16:00:46 -0400] bean: michael_mbp: that "mysql_database" bit, is that what you're talking about?
[2013-10-04 16:00:54 -0400] bean: it doesn't get configured in the json.
[2013-10-04 16:01:01 -0400] bean: you could use that in your own wrapper cookbook
[2013-10-04 16:01:08 -0400] michael_mbp: ahh!!
[2013-10-04 16:01:15 -0400] michael_mbp: right got my wire's crossed there
[2013-10-04 16:01:30 -0400] michael_mbp: ok so I guess I'm on about 'configuring' a cookbook for use in the nodeJSON
[2013-10-04 16:01:33 -0400] workmad3: michael_mbp: yeah, basically a cookbook can have two things in it
[2013-10-04 16:01:44 -0400] workmad3: michael_mbp: recipes, which are essentially scripts that do some things
[2013-10-04 16:01:55 -0400] michael_mbp: right so ruby/ruby DSLs there.
[2013-10-04 16:02:04 -0400] workmad3: michael_mbp: and resources, which you can then use in your own recipes to do higher-level things
[2013-10-04 16:02:47 -0400] daos: does the directory resource create dirs recursively? mimicking mkdir -p?
[2013-10-04 16:03:13 -0400] workmad3: daos: it does if you do 'recursive true' in it
[2013-10-04 16:03:39 -0400] daos: aha
[2013-10-04 16:03:43 -0400] daos: many thanks workmad3
[2013-10-04 16:04:07 -0400] michael_mbp: workmad3: and the run_list (JSON) is where we configure the 'settings' for the cookbooks yeah?
[2013-10-04 16:04:26 -0400] workmad3: michael_mbp: no, the run list is what recipes are going to be run on a node
[2013-10-04 16:05:28 -0400] workmad3: michael_mbp: so a run list of 'recipe[nginx::install],recipe[my_app]' would run the recipes 'nginx::install' and 'my_app::default'
[2013-10-04 16:05:46 -0400] michael_mbp: but you can specify recipes from cookbooks
[2013-10-04 16:05:58 -0400] michael_mbp: like I've got the nginx cookbook in my berksfile
[2013-10-04 16:06:26 -0400] michael_mbp: I can pass options to it from the node config?
[2013-10-04 16:07:02 -0400] bean: michael_mbp: https://learnchef.opscode.com might be a good resource for you to check out
[2013-10-04 16:07:13 -0400] michael_mbp: i.e. my point being, even if you have 100 cookbooks listed, only those in the run_list are 'run' I guess?
[2013-10-04 16:07:16 -0400] michael_mbp: thanks
[2013-10-04 16:07:24 -0400] jchauncey: michael_mbp: you should probably start from scratch and not worry about berkshelf etc.. just learn the basics of cookbook development
[2013-10-04 16:07:44 -0400] michael_mbp: uh so my assumption there is incorrect. ok
[2013-10-04 16:07:50 -0400] bean: right.
[2013-10-04 16:08:32 -0400] pabst^: what would be a good opscode cookbook to use to demonstrate the settings of attributes from within a recipe?
[2013-10-04 16:08:53 -0400] jchauncey: pabst^: do you want to set an attribute on a node dynamically?
[2013-10-04 16:09:00 -0400] pabst^: jchauncey: yep
[2013-10-04 16:09:41 -0400] jchauncey: node.set should do what you want then
[2013-10-04 16:10:08 -0400] pabst^: jchauncey: well...so maybe the full story would help
[2013-10-04 16:10:28 -0400] jchauncey: node.set[:foo][:bar] = baz
[2013-10-04 16:10:32 -0400] jtimberman: use node.default
[2013-10-04 16:10:42 -0400] jtimberman: unless your attributes file has a higher-than-default precedence.
[2013-10-04 16:10:47 -0400] jchauncey: yeah
[2013-10-04 16:11:01 -0400] pabst^: jchauncey: there is a perl script they currently use to determine how many drives are mounted and they create directories based off of that
[2013-10-04 16:11:10 -0400] michael_mbp: workmad3: looks like to get any custom things done, one has to write their own cookbooks
[2013-10-04 16:11:11 -0400] jtimberman: node.set will create a normal attribute, and those are persisted on the node object despite e.g. using/not using a role that modifies the same.
[2013-10-04 16:11:19 -0400] jtimberman: kallistec knows all the right words to explain it better
[2013-10-04 16:11:39 -0400] workmad3: michael_mbp: pretty much, yes
[2013-10-04 16:12:08 -0400] pabst^: michael_mbp: or wrapper cookbooks
[2013-10-04 16:12:18 -0400] jchauncey: pabst^: im pretty sure you could do that with ohai and some ruby foo
[2013-10-04 16:12:22 -0400] michael_mbp: ah.
[2013-10-04 16:12:38 -0400] pabst^: jchauncey: ohhhh.... good call! I always forget to ohai things for some reason
[2013-10-04 16:12:57 -0400] jchauncey: the amount of data in ohai is omfgwtfawesome
[2013-10-04 16:13:12 -0400] pabst^: jchauncey: it is, and i ALWAYS forget to utilize it
[2013-10-04 16:22:58 -0400] michael_mbp: hmm
[2013-10-04 16:23:10 -0400] michael_mbp: Recipe Compile Error in /tmp/vagrant-chef-1/chef-solo-1/cookbooks/rbenv/libraries/provider_rbenv_rubygems.rb
[2013-10-04 16:23:20 -0400] michael_mbp: does it matter if the OS has no ruby :)
[2013-10-04 16:26:30 -0400] michael_mbp: well it does have ruby
[2013-10-04 16:26:39 -0400] michael_mbp: something wrong with that rbenv cookbook I guess
[2013-10-04 16:27:59 -0400] bean: michael_mbp: what is the actual error, just saying it doesn't compile is less than useful
[2013-10-04 16:28:27 -0400] michael_mbp: Recipe Compile Error in /tmp/vagrant-chef-1/chef-solo-1/cookbooks/unicorn-ng/resources/config.rb
[2013-10-04 16:28:30 -0400] michael_mbp: I'll gist it
[2013-10-04 16:29:07 -0400] michael_mbp: https://gist.github.com/bsodmike/d8f1f279e6e6655fadc9
[2013-10-04 16:31:17 -0400] gazarsgo: what's the easiest way to test variable interpolation ? shef ?
[2013-10-04 16:31:43 -0400] gazarsgo: hoping to get a binding.pry type console so i can check my node variables
[2013-10-04 16:38:29 -0400] cwj: gazarsgo: yeah shef/chef-shell, recipe_mode
[2013-10-04 16:39:10 -0400] cwj: you can require pry inside shef and use binding.pry
[2013-10-04 16:39:44 -0400] techminer: On a Solaris 5.10 SPARC box I can't get the omnibus installer to work.see below...
[2013-10-04 16:40:01 -0400] techminer: # curl -k -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-10-04 16:40:01 -0400] techminer:   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
[2013-10-04 16:40:01 -0400] techminer:                                  Dload  Upload   Total   Spent    Left  Speed
[2013-10-04 16:40:02 -0400] techminer: 100  6790  100  6790    0     0  12122      0 --:--:-- --:--:-- --:--:--     0
[2013-10-04 16:40:02 -0400] techminer: Downloading Chef  for solaris2...
[2013-10-04 16:40:02 -0400] techminer: Unable to retrieve a valid package!
[2013-10-04 16:40:02 -0400] techminer: Please file a bug report at http://tickets.opscode.com
[2013-10-04 16:40:02 -0400] techminer: Project: Chef
[2013-10-04 16:40:03 -0400] techminer: Component: Packages
[2013-10-04 16:40:03 -0400] techminer: Label: Omnibus
[2013-10-04 16:40:04 -0400] techminer: Version:
[2013-10-04 16:40:06 -0400] techminer: Please detail your operating system type, version and any other relevant details
[2013-10-04 16:40:06 -0400] techminer: URL: https://www.opscode.com/chef/download?v=&prerelease=false&p=solaris2&pv=5.10&m=sparc
[2013-10-04 16:41:09 -0400] techminer: It's not specifying the version.  I've looked at the install.sh script and I can't tell where that is coming from.
[2013-10-04 16:41:47 -0400] teukka: techminer: the latest release is used if you don't specify it explicitely
[2013-10-04 16:42:10 -0400] techminer: OKso I could pass '-v 11.4.4-2' if I wanted there?
[2013-10-04 16:43:21 -0400] techminer: oh.except I can't pass that in the curl line...hmmm
[2013-10-04 16:43:53 -0400] scarolan: exit
[2013-10-04 16:43:54 -0400] scarolan: quit
[2013-10-04 16:44:02 -0400] teukka: techminer: curl ... | sudo bash -s -- -v <version>
[2013-10-04 16:44:47 -0400] teukka: techminer: but I'm wondering if that "p=solaris2" is correct
[2013-10-04 16:45:13 -0400] techminer: That command worked.but the download still failed.  Can't find the right version.
[2013-10-04 16:45:26 -0400] techminer: Unable to retrieve a valid package!
[2013-10-04 16:45:26 -0400] techminer: Please file a bug report at http://tickets.opscode.com
[2013-10-04 16:45:26 -0400] techminer: Project: Chef
[2013-10-04 16:45:26 -0400] techminer: Component: Packages
[2013-10-04 16:45:26 -0400] techminer: Label: Omnibus
[2013-10-04 16:45:27 -0400] techminer: Version: 11.4.4
[2013-10-04 16:45:27 -0400] techminer: Please detail your operating system type, version and any other relevant details
[2013-10-04 16:45:27 -0400] techminer: URL: https://www.opscode.com/chef/download?v=11.4.4&prerelease=false&p=solaris2&pv=5.10&m=sparc
[2013-10-04 16:47:41 -0400] teukka: techminer: please prefer gist/pastebin instead of multiline pastes in irc
[2013-10-04 16:47:55 -0400] techminer: teukka.ok sorry bout that
[2013-10-04 16:48:04 -0400] teukka: techminer: but sorry, I don't know much of the solaris support. juliancdunn?
[2013-10-04 16:49:23 -0400] michael_mbp: guys any ideas https://gist.github.com/bsodmike/d8f1f279e6e6655fadc9 ?
[2013-10-04 16:49:30 -0400] techminer: it's getting "solaris2" out of the install.sh script...
[2013-10-04 16:51:45 -0400] bean: michael_mbp: looks like you're not setting a required parameter in your config.
[2013-10-04 16:51:54 -0400] gchristensen: michael_mbp: based on the error, https://github.com/flinc-chef/unicorn-ng/blob/master/resources/config.rb#L25 is where the problem is - suggesting that you haven't fully specified those options on your node
[2013-10-04 16:51:57 -0400] bean: you really really should work through #learnchef before you try to do anything cancy.
[2013-10-04 16:51:59 -0400] bean: fancy*
[2013-10-04 16:52:14 -0400] gchristensen: +1
[2013-10-04 16:52:34 -0400] michael_mbp: bean yes but earlier when I talked about the node beaing a way of 'configuring' cookbooks I got shot down?
[2013-10-04 16:53:12 -0400] michael_mbp: gchristensen: will do that, but at the moment I'm simulating this via vagrant; so no 'node' file just yet
[2013-10-04 16:53:23 -0400] techminer: teukka:  this command works to do the download...
[2013-10-04 16:53:28 -0400] techminer: curl -k -L -O 'https://www.opscode.com/chef/download?p=solaris2&pv=5.10&m=sparc&-v=11.4.4-2'
[2013-10-04 16:53:55 -0400] gchristensen: no node ... file ...
[2013-10-04 16:54:04 -0400] michael_mbp: http://leopard.in.ua/2013/01/04/chef-solo-getting-started-part-1/ has an example on how you can add stuff to the run_list by 'faking' a JSON payload to Vagrant
[2013-10-04 16:54:09 -0400] techminer: I guess the omnibus script isn't building the URL correctly?
[2013-10-04 16:54:23 -0400] michael_mbp: gchristensen: the node file will get made when I do knife prepare.
[2013-10-04 16:54:36 -0400] gchristensen: sounds like you need to do it now, b/c that is your problem.
[2013-10-04 16:54:45 -0400] michael_mbp: hmm good idea
[2013-10-04 16:55:39 -0400] michael_mbp: can't I make the node file by hand?
[2013-10-04 16:56:20 -0400] jhujhiti: New nodes are intermittantly not being indexed. I can see them with a 'knife node edit', but 'knife search node *' doesn't return them. Where do I even start?
[2013-10-04 16:56:28 -0400] michael_mbp: one sec got an idea
[2013-10-04 16:56:49 -0400] gchristensen: jhujhiti: your search server is not able to index the data quickly enough, give it more CPU and that should take care of things. otherwise, just give it a few minutes and it'll catch up.
[2013-10-04 16:57:05 -0400] jhujhiti: gchristensen: nope, CPU is idle and it's been hours
[2013-10-04 16:57:17 -0400] jhujhiti: i can reindex the whole database in seconds and it will show up
[2013-10-04 16:57:40 -0400] gchristensen: :( I've never admin'd a chef server myself before, so I'm regurgitating solutions to problems I've seen other people have / solve, and I can't help :( sorry.
[2013-10-04 16:58:29 -0400] michael_mbp: gchristensen: how do you generate the node file?
[2013-10-04 16:59:10 -0400] log1kal: Anyone know of a chef exception handler that generates github issues?
[2013-10-04 16:59:30 -0400] gchristensen: log1kal: you could use Airbrake and that will create github issues
[2013-10-04 16:59:43 -0400] log1kal: how did I not know this?
[2013-10-04 17:00:38 -0400] gchristensen: log1kal: http://airbrake.io/blog/integrations/create-github-issues-from-airbrake/
[2013-10-04 17:00:49 -0400] log1kal: This is fantastic.
[2013-10-04 17:00:52 -0400] log1kal: thanks, gchristensen
[2013-10-04 17:01:00 -0400] gchristensen: you're welcom
[2013-10-04 17:01:06 -0400] michael_mbp: AHA! https://github.com/opscode-cookbooks/resolver
[2013-10-04 17:01:13 -0400] michael_mbp: there is talks about setting the role!
[2013-10-04 17:01:18 -0400] gchristensen: log1kal: also check out release tracking, it might be helpful, though I'm not sure how it might be useful in the chef context ... but I want it to be ;)
[2013-10-04 17:12:20 -0400] michael_mbp: hmm
[2013-10-04 17:12:26 -0400] michael_mbp: now it's a different error on installing git
[2013-10-04 17:12:26 -0400] michael_mbp: https://gist.github.com/bsodmike/d8f1f279e6e6655fadc9
[2013-10-04 17:12:47 -0400] toioiz: so, having an issue where chef client runs, processes a template file, but outputs a 0 byte file. Re-running it then seems to fix itself after 2-3 more chef-client runs.
[2013-10-04 17:13:04 -0400] toioiz: Anyone know if this is by chance a known bug with chef 10? :)
[2013-10-04 17:13:54 -0400] caryp: michael_mbp: maybe try running the command by itself at the command-line to get more info?
[2013-10-04 17:13:57 -0400] caryp: apt-get -q -y install libcurl4-gnutls-dev=7.22.0-3ubuntu4
[2013-10-04 17:14:15 -0400] michael_mbp: gchristensen: the cookbook for git doesn't say if I should set the recipe[git::source] or recipe[git] ?
[2013-10-04 17:14:33 -0400] gchristensen: michael_mbp: then go read the source of those recipes and see what they do
[2013-10-04 17:14:51 -0400] michael_mbp: ahh I need 'default'
[2013-10-04 17:15:13 -0400] gchristensen: michael_mbp: always read the source of the recipes you're including... it takes only a minute usually and provides real benefit to you
[2013-10-04 17:15:22 -0400] log1kal: recipe[git] = recipe[git::default]
[2013-10-04 17:15:37 -0400] michael_mbp: thanks!
[2013-10-04 17:16:13 -0400] michael_mbp: log1kal: where in the cookbook does it do that alias?
[2013-10-04 17:16:38 -0400] log1kal: it
[2013-10-04 17:16:41 -0400] toioiz: it isn't in the cookbook, it's just an assumed part of chef :)
[2013-10-04 17:16:44 -0400] log1kal: it's a chef thing
[2013-10-04 17:16:44 -0400] heathsnow: anyone know how to set a Windows IIS AppPool Identity?  Doesn't seem to be included in the iis_pool resource looking when looking at http://docs.opscode.com/opscode_cookbooks_iis.html
[2013-10-04 17:16:51 -0400] michael_mbp: toioiz: ha :)
[2013-10-04 17:16:53 -0400] michael_mbp: thanks
[2013-10-04 17:17:00 -0400] michael_mbp: gchristensen: that helps a lot!
[2013-10-04 17:17:08 -0400] michael_mbp: https://github.com/opscode-cookbooks/git/tree/master/recipes
[2013-10-04 17:17:11 -0400] michael_mbp: that's making sense now :D
[2013-10-04 17:17:55 -0400] gchristensen: good:)
[2013-10-04 17:19:28 -0400] michael_mbp: hmm
[2013-10-04 17:19:33 -0400] michael_mbp: I'm getting an error on https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/client.rb
[2013-10-04 17:19:42 -0400] michael_mbp: L36 at the bottom on package pg_pack
[2013-10-04 17:22:04 -0400] michael_mbp: I've got https://github.com/opscode-cookbooks/postgresql#chef-solo-note set
[2013-10-04 17:22:13 -0400] michael_mbp: and postgesql::server in the run_list
[2013-10-04 17:27:28 -0400] michael_mbp: it's erroring on L30 https://github.com/opscode-cookbooks/vim/blob/master/recipes/default.rb
[2013-10-04 17:27:35 -0400] michael_mbp: guess I'll try the command and see
[2013-10-04 17:29:11 -0400] michael_mbp: looks like I need to setup a custom cookbook
[2013-10-04 17:29:18 -0400] michael_mbp: to first do apt-get update
[2013-10-04 17:29:19 -0400] michael_mbp: thoughts?
[2013-10-04 17:29:34 -0400] gchristensen: try the apt cookbook
[2013-10-04 17:30:14 -0400] michael_mbp: thanks!
[2013-10-04 17:31:45 -0400] michael_mbp: had it in the berksfile, not in the run_list!
[2013-10-04 17:32:03 -0400] michael_mbp: now I've got apt -> build_essential -> openssl, vim, git etc.
[2013-10-04 17:32:07 -0400] michael_mbp: and it's working :D
[2013-10-04 17:33:17 -0400] stphung: When defining an LWRP provider I want to use classes but inside the classes I am not able to use any Chef resources for some reason.  When using a resource such as 'directory" i receive  message saying "undefiend local variable or method resource" which seems to imply its not in scope.  Is using classes possible in LWRP providers?
[2013-10-04 17:36:49 -0400] gchristensen: stphung: it is, but you can't directly call the LWRPs from within a class.
[2013-10-04 17:37:15 -0400] gchristensen: I have a feeling it would muck things up
[2013-10-04 17:38:02 -0400] stphung: I see, it seems that I can't even define a function and call it from within a class, there is something weird going on with the scoping rules.  I can come up with an example that works in irb but not in the provider rb.
[2013-10-04 17:41:30 -0400] kendrickm: heathsnow: It looks like that document is outdated. As of iis 1.5.0 there is the option to set pool_username and pool_password
[2013-10-04 17:42:27 -0400] stphung: gchristensen: the example is located at https://gist.github.com/stphung/954734a6abe7e39bffe1 if you are curious, thanks for the help by the way.  for the time being I'll go down the route of just using helper functions.
[2013-10-04 17:44:25 -0400] michael_mbp: gchristensen: is there a way to cause a rollback apart from starting with a fresh OS image?
[2013-10-04 17:44:39 -0400] miah: stphung: Chef::Resource::Directory != directory[]
[2013-10-04 17:44:41 -0400] heathsnow: kendrickm: I was just going down the iis_config route to set it.  However, if pool_username and pool_password work I'll give that a shot first.  Thanks!
[2013-10-04 17:44:45 -0400] miah: though, directory should work in lwrp
[2013-10-04 17:45:00 -0400] miah: but if you are writing a class based resource provider that subclasses Resource or Provider
[2013-10-04 17:45:03 -0400] gchristensen: michael_mbp: lol, no - Chef cannot undo what it has done
[2013-10-04 17:45:09 -0400] gchristensen: unless you make recipes to do htat
[2013-10-04 17:45:23 -0400] miah: dir = Chef::Resource::Directory('my dir', @run_context)
[2013-10-04 17:45:23 -0400] kendrickm: heathsnow: Yeah I haven't used it in a long time but checking our cookbooks it looks like that's how we're rolling
[2013-10-04 17:45:29 -0400] miah: i have tons of examples in chef_logstash
[2013-10-04 17:45:38 -0400] miah: https://github.com/miah/chef_logstash/tree/master/libraries
[2013-10-04 17:45:40 -0400] stphung: miah: do you have a link?
[2013-10-04 17:45:41 -0400] kendrickm: Guess we should get the readme fixed
[2013-10-04 17:45:43 -0400] stphung: miah: thanks
[2013-10-04 17:45:55 -0400] miah: recipes don't 'undo'
[2013-10-04 17:45:59 -0400] miah: recipes are declarative
[2013-10-04 17:46:04 -0400] miah: they make assertions
[2013-10-04 17:46:28 -0400] miah: so, if you assert that a package should be uninstalled, it will be uninstalled
[2013-10-04 17:46:50 -0400] miah: comparatively, if you write a resource provider, you can specify a run_action that will 'undo'
[2013-10-04 17:46:55 -0400] stphung: miah: the problem i linked above in a gist still concerns me with the behavior of classes in provider/default.rb.  not sure whats going on there, maybe I'm tired.
[2013-10-04 17:46:56 -0400] miah: i have some examples of that in chef_logstash =)
[2013-10-04 17:47:04 -0400] geggam: about chef not undoing ... .http://docs.opscode.com/resource_deploy.html
[2013-10-04 17:47:16 -0400] geggam: id say rollback is akin to undo
[2013-10-04 17:47:24 -0400] miah: stphung: use the libraries directory
[2013-10-04 17:47:32 -0400] miah: and ditch the DSL for writing LWRP's
[2013-10-04 17:47:47 -0400] stphung: miah: will try that, thanks for the tip. :)
[2013-10-04 17:47:55 -0400] gchristensen: geggam: point being, chef doesn't inherently know how to undo something it has done.
[2013-10-04 17:48:17 -0400] miah: the dsl always makes things more hairy unless you know exactly what its doing
[2013-10-04 17:48:25 -0400] dlaube: hey hey
[2013-10-04 17:48:30 -0400] miah: i try to keep all of my classes in their own .rb
[2013-10-04 17:48:42 -0400] miah: and then just 'require_relative' from the class i want to use them with
[2013-10-04 17:48:50 -0400] miah: standard rubies
[2013-10-04 17:49:40 -0400] geggam: thought that was assumed gchristensen ... :) just showing a tool to make undoing easier
[2013-10-04 17:54:24 -0400] miah: gchristensen, geggam this is chef recipes: https://en.wikipedia.org/wiki/Declarative_programming
[2013-10-04 17:54:42 -0400] miah: when you use a resource in a recipe, that is how it works
[2013-10-04 17:55:27 -0400] geggam: wow... ive never seen a chef recipe before
[2013-10-04 17:55:29 -0400] geggam: thanks
[2013-10-04 17:55:41 -0400] geggam: dont be a douche
[2013-10-04 17:56:02 -0400] miah: if you want undo, its easy to do. just write a resource provider, and make your provider capable of unwinding your composites
[2013-10-04 17:56:14 -0400] miah: geggam: ?
[2013-10-04 17:56:21 -0400] gchristensen: miah: it came off a bit condescending
[2013-10-04 17:56:44 -0400] gchristensen: no hard feelings though
[2013-10-04 17:56:56 -0400] miah: ya, i honestly dont care if i come off as condescending
[2013-10-04 17:57:05 -0400] geggam: so you are a douche
[2013-10-04 17:57:11 -0400] geggam: :) thanks for clearing that up
[2013-10-04 17:57:15 -0400] michael_mbp: gchristensen: https://github.com/bsodmike/deployment_kitchen
[2013-10-04 17:57:15 -0400] gchristensen: this is getting pretty hostile
[2013-10-04 17:57:27 -0400] miah: really?
[2013-10-04 17:57:36 -0400] michael_mbp: not making all of it public, once I start adding my on LWPRs and custom templates.
[2013-10-04 17:57:51 -0400] gchristensen: michael_mbp: right on
[2013-10-04 17:57:52 -0400] miah: i just see people constantly struggle with problems because of cookbook development using recipes
[2013-10-04 17:57:53 -0400] gchristensen: michael_mbp: *shrug*
[2013-10-04 17:57:56 -0400] michael_mbp: but for the initial stages, where anyone can fork off and build off it, I'll be sharing it.
[2013-10-04 17:58:08 -0400] miah: and i try to point people in the right direction, only to be ignored and then called a douche
[2013-10-04 17:58:11 -0400] josephholsten: don't feed the trolls
[2013-10-04 17:58:29 -0400] josephholsten: <3
[2013-10-04 17:58:29 -0400] michael_mbp: thanks a lot to everyone here today for putting up with my cluelessness :D
[2013-10-04 17:58:34 -0400] miah: josephholsten: ya, i just put them on /ignore when they get anoying
[2013-10-04 17:58:40 -0400] d```: I'm not part of this conversation, but I use miah's cookbooks a bunch, and try to emulate her methods
[2013-10-04 17:58:54 -0400] gchristensen: miah: *shrug* I thought it was fine... I hope you didn't find me that annoying.
[2013-10-04 17:58:56 -0400] d```: miah++
[2013-10-04 17:59:02 -0400] miah: gchristensen: nope <3
[2013-10-04 17:59:06 -0400] michael_mbp: this has made things far clearer and I'm off to start on my first cookbook tomorrow; thanks to workmad3 I'll do it with chefspec as well.
[2013-10-04 17:59:12 -0400] gchristensen: *phew*
[2013-10-04 17:59:39 -0400] josephholsten: anyone need any help?
[2013-10-04 18:00:12 -0400] geggam: not my intention to insult... i misread the intent of the information
[2013-10-04 18:00:18 -0400] geggam: :) all is good
[2013-10-04 18:01:15 -0400] geggam: im an old sysadmin who has little tolerance for things and generally bites first
[2013-10-04 18:01:27 -0400] miah: same
[2013-10-04 18:04:12 -0400] joe_k: #learnchef seems dead
[2013-10-04 18:06:32 -0400] heathsnow: kendrickm:  Hmmm......those must have been added Post-11.4.4 as they're unrecognized parameters for me (pool_username)
[2013-10-04 18:06:47 -0400] kendrickm: we're on 10.24
[2013-10-04 18:06:52 -0400] kendrickm: what version of iis are you using?
[2013-10-04 18:07:19 -0400] heathsnow: 7.5.7600
[2013-10-04 18:07:25 -0400] kendrickm: sorry, iis cookbook
[2013-10-04 18:11:02 -0400] heathsnow: looks like 1.1.0
[2013-10-04 18:12:53 -0400] heathsnow: I'll get the latest and give it a shot
[2013-10-04 18:13:06 -0400] kendrickm: ah yeah that functionality looks like it was added in 1.5.0
[2013-10-04 18:13:17 -0400] kendrickm: according to the README anyhow.
[2013-10-04 18:14:03 -0400] kendrickm: Thought it doesn't call it out specifically I think it was added with [COOK-2370]
[2013-10-04 18:17:59 -0400] pabst^: is it possible to set knife ssh to work from a windows workstation?
[2013-10-04 18:23:16 -0400] gmr_: Has the pattern for libraries changed? I'm having an issue following the pattern called out here: https://wiki.opscode.com/display/Chef/Libraries -- Here's my code: https://gist.github.com/gmr/6830328
[2013-10-04 18:26:33 -0400] gmr_: nevermind -- figured it out :facepalm
[2013-10-04 18:42:42 -0400] bmoritz: Why would a recipe not pick up changes to node['fqdn'] after doing an ohai reload?  I see in the dung output that Ohai sees the change.
[2013-10-04 18:42:54 -0400] bmoritz: *debug output
[2013-10-04 18:43:54 -0400] bmoritz: DEBUG: ---- Begin hostname --fqdn STDOUT ----
[2013-10-04 18:43:57 -0400] bmoritz: DEBUG: ip-10-31-169-184.ec2.internal
[2013-10-04 18:44:16 -0400] bmoritz: DEBUG: ---- Begin hostname --fqdn STDOUT ----
[2013-10-04 18:44:28 -0400] bmoritz: DEBUG: test.mydomain.com
[2013-10-04 18:46:31 -0400] troyready: pabst^, to reply to your old question, I imagine it very well might work with a cygwin install (I plan on trying it at somepoint). Doubt it would be 'supported', but cygwin + openssh + chef gem sounds like the right combination
[2013-10-04 18:53:50 -0400] ryker: anyone know of an easy way I can test run a partial search query using chef-apply or chef-shell?
[2013-10-04 18:58:23 -0400] ryker: nvm.  Just found this: http://blog.vicecity.co.uk/post/58905064410/chef-11-libraries-and-lwrp-testing-in-chef-shell
[2013-10-04 18:58:37 -0400] ryker: didn't notice it on my first few google searches.
[2013-10-04 20:14:50 -0400] broconne: any knife tricks to handle ssh into multiple security realms (same user id, different password)?
[2013-10-04 20:17:10 -0400] d```: broconne: that's more of an ssh issue
[2013-10-04 20:17:23 -0400] d```: 1. I'd suggest using a key instead of password
[2013-10-04 20:17:52 -0400] d```: 2. .ssh/config in your home folder and profit?
[2013-10-04 20:20:56 -0400] broconne: haha
[2013-10-04 20:21:06 -0400] broconne: its an organization thing.. so its not just me
[2013-10-04 20:21:41 -0400] broconne: we have internal tooling that detects when doing a distributed SSH that you are accessing multiple realms and then prompts for multiple passwords.. Didn't know if we had some chef like options there as well.
[2013-10-04 20:22:57 -0400] gchristensen: broconne: I have asimilar issue, where I have to be on a different VPN or use a different jump-host to get to the nodes.
[2013-10-04 20:26:01 -0400] broconne: did you solve your problem gchristensen?
[2013-10-04 20:27:40 -0400] gchristensen: broconne: something like his (not pretty): for datacenter in `echo "ibm.dal\nrax.ord"`; do connect_to_vpn $datacenter; knife node ssh "(foo:bar AND baz:quux) AND datacenter:$datacenter"; done
[2013-10-04 20:28:07 -0400] broconne: ah ok
[2013-10-04 20:28:08 -0400] broconne: thanks
[2013-10-04 20:41:19 -0400] bmoritz: Does the ohai action reload overwrite all node attributes?
[2013-10-04 20:41:52 -0400] gchristensen: bmoritz: it overwrites all node attributes which are reported by ohai
[2013-10-04 20:42:48 -0400] bmoritz: gchristensen: Is there a reason it wouldn't overwrite hostname, fqdn and domain?
[2013-10-04 20:43:01 -0400] bmoritz: if I changed them during the run
[2013-10-04 20:43:46 -0400] bmoritz: In debug logs the reload gets the correct answer
[2013-10-04 20:51:11 -0400] bmoritz: Found it https://tickets.opscode.com/browse/OHAI-389
[2013-10-04 20:58:03 -0400] awgross: Is there a post somewhere with a good technical explanation of how chef parses recipe files and fits them into the run_context etc?
[2013-10-04 20:59:06 -0400] miah: awgross: the source code =)
[2013-10-04 20:59:35 -0400] miah: go read runner.rb
[2013-10-04 20:59:49 -0400] bmoritz: awgross: "anatomy of a chef run"
[2013-10-04 21:00:13 -0400] miah: https://github.com/opscode/chef/blob/master/lib/chef/runner.rb
[2013-10-04 21:00:27 -0400] miah: specifically #converge
[2013-10-04 21:00:54 -0400] awgross: thanks
[2013-10-04 21:01:47 -0400] miah: https://github.com/opscode/chef/blob/master/lib/chef/client.rb
[2013-10-04 21:01:52 -0400] miah: has the rest of the answers =)
[2013-10-04 21:12:39 -0400] masterkorp: Guys can i tell chef-client to ignore a certain recipe after a run ?
[2013-10-04 21:14:03 -0400] jbz: masterkorp: you can have the node remove the recipe from its runlist
[2013-10-04 21:19:07 -0400] awgross: thanks miah
[2013-10-04 21:40:58 -0400] heathsnow: kendrickm: I'm not seeing pool_username and pool_password as options in the iis.1.5.4 cookbook
[2013-10-04 21:41:39 -0400] kendrickm: youre not seeing these ? https://github.com/opscode-cookbooks/iis/blob/master/resources/pool.rb
[2013-10-04 21:42:00 -0400] kendrickm: line 33/34?
[2013-10-04 21:43:48 -0400] kendrickm: ah it looks like that gets used on the :config action
[2013-10-04 21:43:50 -0400] kendrickm: not the :create
[2013-10-04 21:44:05 -0400] heathsnow: :o
[2013-10-04 21:44:12 -0400] heathsnow: that must be it
[2013-10-04 21:44:32 -0400] heathsnow: I'm doing :add
[2013-10-04 21:44:41 -0400] kendrickm: yeah you'll have to call action [:add, :config] I guess
[2013-10-04 21:44:51 -0400] kendrickm: That could probably be cleaned up
[2013-10-04 21:46:43 -0400] heathsnow: kendrickm:  that did it!  thanks so much for your help
[2013-10-04 21:47:05 -0400] masterkorp: jbz: i know that, just cabe its a role
[2013-10-04 21:47:09 -0400] masterkorp: i edited oiut
[2013-10-04 21:47:16 -0400] surge_: Can anyone explain this? http://pastebin.com/Tn3mAV61  This is driving me mad. I see the file in my chef server, the directory is correct. I have no idea why cookbook_file is failing
[2013-10-04 21:47:21 -0400] masterkorp: just asking for a simpler method
[2013-10-04 21:47:22 -0400] kendrickm: healthsnow: sure thing. That cookbook is mostly my fault anyhow
[2013-10-04 21:47:29 -0400] kendrickm: And now I don't even use it anymore
[2013-10-04 21:47:32 -0400] heathsnow: :P
[2013-10-04 21:48:52 -0400] siezer: surge_ mv files/path/file.ext files/default/path/file.ext
[2013-10-04 21:49:36 -0400] siezer: http://docs.opscode.com/essentials_cookbook_files.html#file-specificity
[2013-10-04 21:49:39 -0400] surge_: That's the thing I know better than to put files directly under files. from my git status >> cookbooks/COOKBOOKNAME/files/default/PATH/FILE.ext
[2013-10-04 21:50:00 -0400] surge_: every directory is under files/default
[2013-10-04 21:50:27 -0400] surge_: i don't use the OS / OSversion heirarchy
[2013-10-04 21:51:59 -0400] siezer: hrm
[2013-10-04 21:52:15 -0400] siezer: can you gist the resouce from the recipe?
[2013-10-04 22:04:50 -0400] surge_: siezer: http://pastebin.com/55xrdfB7
[2013-10-04 22:09:49 -0400] siezer: surge_ really weird... maybe you found a bug?
[2013-10-04 22:09:59 -0400] siezer: try a template resource instead just for kicks
[2013-10-04 22:10:00 -0400] surge_: yeah lol
[2013-10-04 22:19:36 -0400] dgarstang: Err... I got this... <% @pvdisks.each_with_index do |page, index| %>/data/disk<%= index+1 %>/mapred/local<% end %> ... how can I use join() with that?
[2013-10-04 22:23:11 -0400] jtimberman: dgarstang: #join is a method for array
[2013-10-04 22:23:26 -0400] dgarstang: jtimberman: pvdisks is an array
[2013-10-04 22:25:34 -0400] dgarstang: alternatively phrased, above output with a ',' in between each element but not at the end
[2013-10-04 22:26:34 -0400] dgarstang: alternatively alternatively phrased, above output with a ',' in between each element but the ',' stripped from the end
[2013-10-04 22:27:12 -0400] jtimberman: [1,2,3].join(',') #=> "1,2,3"
[2013-10-04 22:27:28 -0400] dgarstang: jtimberman: well yeah, I know.
[2013-10-04 22:27:31 -0400] jtimberman: :)
[2013-10-04 22:27:48 -0400] jtimberman: where do you want to join?
[2013-10-04 22:28:50 -0400] dgarstang: jtimberman: Iterating over a list of physical disks... just need the count of how many physical disks. For each, output /data/disk$index/mapred/local separated by a comma
[2013-10-04 22:29:11 -0400] dgarstang: i suppose a for loop might work better
[2013-10-04 22:29:36 -0400] dgarstang: for i in range(1,pvdisk_count): output something
[2013-10-04 22:29:40 -0400] jtimberman: @pvdisks is an array?
[2013-10-04 22:29:44 -0400] dgarstang: Yes
[2013-10-04 22:29:55 -0400] dgarstang: but I don't need what's in the array, only it's size
[2013-10-04 22:30:07 -0400] jtimberman: its index, 0 1 2 3 etc
[2013-10-04 22:30:18 -0400] dgarstang: jtimberman: ok, well that too...
[2013-10-04 22:33:54 -0400] paulczar: dgarstang: array.length  ?
[2013-10-04 22:35:37 -0400] dgarstang: ugh, i dunno... i guess I need a new array.... do I need to put each ruby command into a separate erb block? *sigh*
[2013-10-04 22:36:14 -0400] dgarstang: ie can I do <% n = [] @pvdisks.each_with_index ..... %>
[2013-10-04 22:36:29 -0400] dgarstang: or do I need <% n = [] %> <% @pvdisks.each_with_index ..... %>
[2013-10-04 22:36:40 -0400] dgarstang: is n in scope when it gets to the next block?
[2013-10-04 22:36:46 -0400] workmad3: dgarstang: @pvdisks.map.with_index{|d, i| "/data/disk#{i + 1}/mapred/local"}.join(", ")
[2013-10-04 22:37:20 -0400] dgarstang: workmad3: trying...
[2013-10-04 22:40:13 -0400] jtimberman: pvdisks.map.with_index{|d, i| "/data/disk#{i + 1}/mapred/local"}.join(", ") #=> "/data/disk1/mapred/local, /data/disk2/mapred/local, /data/disk3/mapred/local"
[2013-10-04 22:40:34 -0400] workmad3: dgarstang: you could also do <%= (1..@pvdisks.size).map{|i| "/data/disk#{i + 1}/mapred/local"}.join(",")
[2013-10-04 22:40:50 -0400] workmad3: err, drop the + 1 there
[2013-10-04 22:41:14 -0400] dgarstang: workmad3: so, for the first one, with ... <% @pvdisks.map.with_index{|d, i| "/data/disk#{i + 1}/mapred/local"}.join(", ") %> ... no output
[2013-10-04 22:41:23 -0400] workmad3: dgarstang: you need <%=
[2013-10-04 22:41:33 -0400] dgarstang: thanks
[2013-10-04 22:41:36 -0400] surge_: siezer: my only theory is, before i set up another chef server elsewhere, I just used strings for all the cookbook_file stanzas. Now i have a string with an interpolated variable inside. Chef handles those fine normally, but i really have run out of ideas
[2013-10-04 22:41:50 -0400] dgarstang: why don't I need <%= with what I had earlier?
[2013-10-04 22:42:24 -0400] workmad3: dgarstang: because you didn't care about the return value of the statements there, you had text as your output outside the <% %> erb statements
[2013-10-04 22:43:04 -0400] dgarstang: workmad3: Oh. got some reading to do i guess
[2013-10-04 22:43:50 -0400] workmad3: dgarstang: erb can be a bit weird at times
[2013-10-04 22:43:58 -0400] dgarstang: workmad3: like ruby
[2013-10-04 22:44:19 -0400] workmad3: it's weird in its own way, on top of ruby ;)
[2013-10-04 22:44:34 -0400] dgarstang: egads
[2013-10-04 22:45:09 -0400] workmad3: spent plenty of time immersed in ruby and erb
[2013-10-04 22:49:22 -0400] workmad3: dgarstang: I'm guessing it isn't the syntax that gets you with ruby?
[2013-10-04 22:49:33 -0400] workmad3: dgarstang: more the way things end up working together?
[2013-10-04 22:52:25 -0400] siezer: dgarstang I have that problem too... I read the first 1/4 of this and it helped: http://www.amazon.com/Metaprogramming-Ruby-Program-Like-Pros/dp/1934356476
[2013-10-04 22:52:43 -0400] workmad3: siezer: exactly the book I was going to suggest ;)
[2013-10-04 22:52:58 -0400] siezer: it skips the "here's a string!" bullshit and jumps straight into all the weird rubyisms
[2013-10-04 22:53:05 -0400] surge_: siezer: i moved the files up a directory and now it works.. lol wow
[2013-10-04 22:53:26 -0400] workmad3: I've still to come across a book that manages to put across how the ruby object model fits together as succinctly and clearly as that one
[2013-10-04 22:56:37 -0400] zenloop: hey really basic question.  how do I run a shell command and save it to a variable in a chef recipe.  it is ok that it is set at compile time as it is just grabbing a device name from /proc/partitions.
[2013-10-04 22:57:03 -0400] zenloop: I think Mixlib::ShellOut::ShellCommand is what I should use but not sure how to use it.
[2013-10-04 22:59:29 -0400] zenloop: will try: variable = Mixlib::ShellOut.new(cmd)
[2013-10-04 23:01:06 -0400] surge_: var = `command` ?
[2013-10-04 23:08:54 -0400] zenloop: @surge: thanks. I will test that.  testing the mixlib thing right now.
[2013-10-04 23:28:15 -0400] surge_: zenloop: i don't know your use case, but keep it simple if you can :)
[2013-10-04 23:35:43 -0400] barn: fine fine fine, I give up, how do I sanely make foodcritic run from vim...
