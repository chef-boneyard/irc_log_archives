[2013-10-10 00:00:29 -0400] troyready: Google results say (seeing it here: http://www.slideshare.net/opscode/windows-cookingwithoutwindowscookbookadamedwards) that the resource was added in chef 11
[2013-10-10 00:00:30 -0400] dgarstang2: lets say I wanted to populate a config file on one node with a list of a set of chef nodes. Can I do that with chef search somehow?
[2013-10-10 00:00:31 -0400] joe_____: is registry_key only on version 11 onwards?
[2013-10-10 00:01:26 -0400] troyready: joe_____, looks like it to me
[2013-10-10 00:01:36 -0400] joe_____: ouch, im using 10.16.2
[2013-10-10 00:02:14 -0400] stormerider: the current 10.x is something like 10.28, so you're a bit behind no matter how you slice it
[2013-10-10 00:05:09 -0400] dgarstang2: lets say I wanted to populate a config file on one node with a list of a set of chef nodes. Can I do that with chef search somehow?
[2013-10-10 00:05:18 -0400] Fehlersturm: hello. i have a question. where is the recipe located which gets run when i do a chef-server-ctl reconfigure?
[2013-10-10 00:06:48 -0400] stormerider: Fehlersturm: i dont know exactly off the top of my head, but it's under /opt/chef-server it's chef-solo configuring chef-server
[2013-10-10 00:07:09 -0400] Fehlersturm: k
[2013-10-10 00:09:22 -0400] troyready: dgarstang2, Yeah, that should be a pretty simple combination of search in the recipe, assigning the results to a variable, and then using the template resource
[2013-10-10 00:12:29 -0400] dgarstang2: troyready: kk... reading.... just not sure about the search syntax.
[2013-10-10 00:14:23 -0400] dgarstang2: ie, this gets nothing... search(:node, "name:*") do |n|
[2013-10-10 00:14:42 -0400] dgarstang2: ugh, prolly cuz I'm on vagrant.
[2013-10-10 00:15:37 -0400] Fehlersturm: i cannot find where chef-solo is called. can someone maybe look at their /opt/chef-server/embedded/bin/omnibus-ctl and tell me where the recipe is pulled from. (it gets called like so: omnibus-ctl chef-server /opt/chef-server/embedded/service/omnibus-ctl reconfigure)
[2013-10-10 00:18:56 -0400] Fehlersturm: k
[2013-10-10 00:19:00 -0400] Fehlersturm: nevermind
[2013-10-10 00:19:06 -0400] Fehlersturm: found it. thankyou
[2013-10-10 00:37:33 -0400] kisoku: anyone having issue withtk and chef-zero ?
[2013-10-10 00:43:15 -0400] gchristensen: timsmith1: that functionality IS really handy :)
[2013-10-10 00:53:15 -0400] timsmith1: I needed that at a past job for filtering out various dev/staging environments
[2013-10-10 01:03:58 -0400] dougireton: I'm troubleshooting a server which is running Chef-Client every 15-25 min and I think individual chef runs are taking longer than 15 min. How can I get chef-client elapsed run time for that server?
[2013-10-10 01:20:14 -0400] dysinger: I probably asked this before but where's a good place to get started with whole lifcycle cookbok work?
[2013-10-10 01:20:26 -0400] dysinger: I want each cookbook to be a unit of work
[2013-10-10 01:20:36 -0400] dysinger: Berkshelf + chef-zero + chef-spec + test-kitchen
[2013-10-10 01:20:45 -0400] dysinger: or something productive like that
[2013-10-10 01:34:26 -0400] joonas: dysinger: doesn't seth vargo have some good content on that
[2013-10-10 01:34:39 -0400] joonas: he has done a talk or two on the subject I think
[2013-10-10 01:34:58 -0400] dysinger: I think I asked before but then got distracted
[2013-10-10 01:35:01 -0400] dysinger: 50 lashes for me
[2013-10-10 01:35:36 -0400] joonas: dysinger: I'm interested in such a thing myself, need to get our chef workflow organized with testing goodness
[2013-10-10 02:30:11 -0400] tshauck_: Hi, what's the best way to go about starting an app via chef after everything is installed... this is on OpsWorks if that makes changes things
[2013-10-10 04:06:44 -0400] brucelee1: hey i was thinking of creating a server and running chef-client on it daily so incase anyone screws up any settings, they will be defaulted back to the way they were when set up
[2013-10-10 04:06:47 -0400] brucelee1: is this one of the use cases for chef?
[2013-10-10 04:07:43 -0400] brucelee1: from what i know it seems like a configuration utility past the OS provisioning, so how does chef deal with reconfiguring the server back if the user  messes things up like the fstab, or other OS files
[2013-10-10 04:08:50 -0400] mahmoudimus: how can I handle if a package isn't found? is there a pattern to rescue this since we can't catch the exception or do I have to use a ruby_block?
[2013-10-10 04:57:20 -0400] mahmoudimus: whats the return code for chef package?
[2013-10-10 04:57:27 -0400] mahmoudimus: and can I check it before executing a block?
[2013-10-10 06:20:51 -0400] legal90: data_bag_obj = Chef::Cookbook.get_ssl_certificate_data_bag
[2013-10-10 06:20:52 -0400] legal90: data_bag_obj = data_bag('ssl_certificate')
[2013-10-10 06:21:04 -0400] legal90: Do these command means the same?
[2013-10-10 06:54:24 -0400] sgronblom: I tried to create a new ci_server cookbook where the basic recipe is just include_recipe "jenkins"
[2013-10-10 06:54:51 -0400] sgronblom: However when using chef_solo to provision a vagrant box jenkins doesnt seem to be installed
[2013-10-10 06:57:30 -0400] sgronblom: It's bascially the same as my web_server cookbook which just include_recipes "nodejs"
[2013-10-10 06:57:38 -0400] sgronblom: This one does work though...
[2013-10-10 07:05:08 -0400] garrypol_: anyone continually getting errors using the application and application_python cookbook?
[2013-10-10 07:05:28 -0400] garrypol_: No resource found for django. Tried application_django, application_python_django, django
[2013-10-10 07:05:47 -0400] garrypol_: I get that everytime I use the current versions of the cookbooks with chef-solo 11.6.0
[2013-10-10 07:07:38 -0400] garrypol_: https://github.com/opscode-cookbooks/application/blob/master/resources/default.rb#L115  <-- that's the line that fails to find the resource in the application cookbook.
[2013-10-10 07:08:34 -0400] sgronblom: Ah, how do I refer to a recipe inside of a cookbook? Is there any namespace concept or something? It seems that the jenkins cookbook defines a server recipe
[2013-10-10 07:11:41 -0400] garrypol_: sgronblom: usually it's "include_recipe cookbook::recipe"
[2013-10-10 07:14:06 -0400] sgronblom: garrypol_: yeah thanks
[2013-10-10 07:29:15 -0400] jverdeyen: Hi all!
[2013-10-10 07:29:44 -0400] jverdeyen: How can I make sure a specific action is done before installing a package (adding a repo) when running a recipe
[2013-10-10 07:32:06 -0400] s2r2: jverdeyen: just put the "apt_repository" resource before the "package" resource
[2013-10-10 07:32:37 -0400] jverdeyen: I think it's already before the "package", I'll try to pastebin my problem
[2013-10-10 07:36:20 -0400] jverdeyen: http://pastebin.com/pMey7NM0
[2013-10-10 07:39:24 -0400] s2r2: jverdeyen: what's the problem, i.e. what do you expect and what does happen?
[2013-10-10 07:39:39 -0400] s2r2: (is the mariadb repo providing a "mysql-server" package?)
[2013-10-10 07:39:43 -0400] jverdeyen: the mysql::server calls mysql::client
[2013-10-10 07:39:53 -0400] jverdeyen: Error executing action `install` on resource 'package[mariadb-client]'
[2013-10-10 07:40:02 -0400] jverdeyen:     * No version specified, and no candidate version available for mariadb-client
[2013-10-10 07:40:03 -0400] jverdeyen: I get this
[2013-10-10 07:40:25 -0400] jverdeyen: But adding the mariadb repo is up front of all other actions
[2013-10-10 07:41:15 -0400] s2r2: ah I see.  Uhm, I think the mysql::client recipe does some "let's install everything at compile-time"-magic so the converge phase has mysql-stuff accessible
[2013-10-10 07:41:49 -0400] s2r2: (sorry gtg)
[2013-10-10 07:42:46 -0400] jverdeyen: okey
[2013-10-10 07:43:06 -0400] s2r2: https://github.com/opscode-cookbooks/mysql/blob/master/recipes/client.rb#L45 << I was wrong
[2013-10-10 07:43:34 -0400] s2r2: you could try to run chef-client with -l debug and have a closer look at the resource order
[2013-10-10 07:44:23 -0400] jverdeyen: When i create a recipe with includes and underneath some custom actions does chef first run the includes before everything underneath?
[2013-10-10 07:47:26 -0400] s2r2: jverdeyen: I always think of include_recipe as "copy & paste UNLESS 'I've seen recipe before, will do nothing'"
[2013-10-10 07:47:39 -0400] jverdeyen: oki
[2013-10-10 07:47:50 -0400] jverdeyen: I have a full debug output, do you have the time to check it?
[2013-10-10 07:47:59 -0400] s2r2: sorry got to run ;) bbiab
[2013-10-10 07:48:22 -0400] s2r2: someone here will help you (and there's #learnchef)
[2013-10-10 07:48:29 -0400] s2r2: :) bye
[2013-10-10 07:48:31 -0400] jverdeyen: oki, thanks!
[2013-10-10 09:04:11 -0400] s2r2: hmm is there any way to do "chef-server-ctl reconfigure" on ubuntu without talking to upstart?
[2013-10-10 09:04:49 -0400] s2r2: as in "only use the embedded runit"
[2013-10-10 10:47:02 -0400] TCMSLP: ok, I'm struggling with the basics here
[2013-10-10 10:47:20 -0400] TCMSLP: Trying to 'knife bootstrap' an AWS ubuntu instance
[2013-10-10 10:47:53 -0400] TCMSLP: It connects but fails as it doesn't seem to be using sudo (dpkg: error: requested operation requires superuser privilege)
[2013-10-10 10:48:16 -0400] TCMSLP: I've found other references to this online but no solutions
[2013-10-10 10:49:25 -0400] TCMSLP: And after posting the question I find the --sudo option to knife
[2013-10-10 11:19:15 -0400] SwedenHerman: anyone up for explaining to me a bit about chef on windows?
[2013-10-10 11:20:01 -0400] SwedenHerman: the question is: so I'm going to migrat from VMware to HyperV managed with orchestrator. Is there anything I would need to use chef for?
[2013-10-10 11:34:20 -0400] ocholetras: SwedenHerman: cant tell you more than google search chef +windows
[2013-10-10 11:34:22 -0400] ocholetras: ^^
[2013-10-10 11:34:40 -0400] ocholetras: Anyone knows how to avoid "resource" clonning warnings on users opscode cookbook
[2013-10-10 11:34:41 -0400] ocholetras: ?
[2013-10-10 11:45:04 -0400] SwedenHerman: If I go to a hosting company and have them build me a hyperv machine config-managed with their windows orchestrator, will I be able to rewrite the runbooks? Does windows give me config-management access as the owner of the VM?
[2013-10-10 11:53:12 -0400] ocholetras: seems nobody is using the users cookbook...
[2013-10-10 11:53:15 -0400] ocholetras: omg
[2013-10-10 12:25:53 -0400] ocholetras: talking about roles and attributes
[2013-10-10 12:26:02 -0400] ocholetras: if i ave a role called 3rdParty
[2013-10-10 12:26:27 -0400] ocholetras: where i run a users::3rdparty recipe to create those 3rd party users who is going to manage the node
[2013-10-10 12:26:36 -0400] ocholetras: and add some attributes to ssh server and sudo
[2013-10-10 12:26:43 -0400] ocholetras: is it the right way to do it?
[2013-10-10 12:27:14 -0400] ocholetras: specially for the attributes on the role. As they are arrays and default attr will be merged with de ones on my wrapped cookbooks
[2013-10-10 12:27:36 -0400] ocholetras: other way is to always allow ssh and sudo on  3rdParty group
[2013-10-10 12:28:11 -0400] ocholetras: and only create 3rdparty users when using the role, within the users::3rdparty recipe
[2013-10-10 12:28:19 -0400] ocholetras: what do you guys think about it?
[2013-10-10 12:34:06 -0400] Rusty_uk: Hey kids.  Any chance of getting a little assistance on installing the windows cookbook
[2013-10-10 12:34:28 -0400] ocholetras: hi Rusty_uk this is like talking to air for now...
[2013-10-10 12:34:34 -0400] ocholetras: it seems to be that way
[2013-10-10 12:34:37 -0400] ocholetras: hehe
[2013-10-10 12:34:45 -0400] ocholetras: im only using chef to deploy linux nodes
[2013-10-10 12:34:50 -0400] ocholetras: cant help you so much
[2013-10-10 12:34:54 -0400] ocholetras: ^^
[2013-10-10 12:35:29 -0400] Rusty_uk: mehh...can i try you?  Could be a server issue rather than windows specific
[2013-10-10 12:46:36 -0400] sschueller: Hi, Can someone tell me which ports chef uses to communicate with nodes? Is it via HTTPS on port 443?
[2013-10-10 12:51:00 -0400] storme_out: sschueller: that's backwards nodes communicate with chef, not the other way around. and it depends on how you configure it, chef 11 defaults to 443, yes
[2013-10-10 12:51:42 -0400] storme_out: chef is client-pull based, not server-push
[2013-10-10 12:54:19 -0400] storme_out: ocholetras: ideally, you dont modify the users cookbook, you write your own cookbook, call "depends users" and then use the user resources it provides to manage your 3rd party users
[2013-10-10 12:54:46 -0400] ocholetras: yea
[2013-10-10 12:55:00 -0400] ocholetras: stormerider: i have a wrapped cookbook
[2013-10-10 12:55:06 -0400] ocholetras: but
[2013-10-10 12:55:22 -0400] ocholetras: there is an issue when you want to manage users with multiple groups
[2013-10-10 12:55:23 -0400] sschueller: yes, but I need to allow those ports on the chef-server for the nodes to pull
[2013-10-10 12:56:18 -0400] sschueller: so i can lock down all ports except 443 on the chef-server ?
[2013-10-10 12:56:26 -0400] stormerider: sschueller: *nod* it's configurable, but like i said, chef 11 defaults to 443, yes
[2013-10-10 12:56:40 -0400] sschueller: stormerider: ok, thanks
[2013-10-10 12:57:21 -0400] ocholetras: the last users_manage resource for the group X is the one that stay
[2013-10-10 12:57:25 -0400] ocholetras: i mean
[2013-10-10 12:57:35 -0400] ocholetras: i have my admin user on sysadmin group and sudoers group
[2013-10-10 12:57:42 -0400] ocholetras: then i put node on role 3rdparty
[2013-10-10 12:57:55 -0400] ocholetras: i add recipe: users::3rdparty
[2013-10-10 12:58:20 -0400] ocholetras: and declare 2 "users_manage" resources for add that user to sysadmin and sudoers groups...
[2013-10-10 12:58:38 -0400] ocholetras: this overwrite  the members of each of those groups
[2013-10-10 12:59:07 -0400] stormerider: are you using databags or hardcoding these users?
[2013-10-10 12:59:08 -0400] ocholetras: leaving only my 3rdparty users alone on the groups and my regular admin outside of the groups
[2013-10-10 12:59:13 -0400] ocholetras: nop
[2013-10-10 12:59:14 -0400] ocholetras: data bags
[2013-10-10 12:59:25 -0400] ocholetras: by group searching
[2013-10-10 12:59:40 -0400] stormerider: you should be able to do each user in one call to users_manage
[2013-10-10 12:59:41 -0400] ocholetras: using the users cookbook LWRP
[2013-10-10 12:59:49 -0400] stormerider: let me dig up my code
[2013-10-10 12:59:52 -0400] ocholetras: yea i can
[2013-10-10 12:59:56 -0400] ocholetras: but
[2013-10-10 12:59:59 -0400] ocholetras: this scenario:
[2013-10-10 13:00:56 -0400] ocholetras: users with "sysadmin" on group field on the databag --> goes to: sysadmin group on system.
[2013-10-10 13:00:56 -0400] ocholetras: users with "sudoers" on group field on the databag --> goes to: sudoers group...
[2013-10-10 13:01:11 -0400] ocholetras: that is ok
[2013-10-10 13:01:22 -0400] ocholetras: but when i add my "3rdparty" users
[2013-10-10 13:01:51 -0400] ocholetras: group members will be overwritten.
[2013-10-10 13:02:15 -0400] stormerider: ah, my code uses user and group resources, not user_manage
[2013-10-10 13:02:22 -0400] ocholetras: jeje
[2013-10-10 13:02:32 -0400] ocholetras: -_-'
[2013-10-10 13:03:18 -0400] ocholetras: Yea
[2013-10-10 13:03:22 -0400] stormerider: i think your use case is probably too complex for the LWRP
[2013-10-10 13:03:23 -0400] ocholetras: doing that you can "modify" a group
[2013-10-10 13:03:58 -0400] ocholetras: Easy solution was to create a system group called 3rdparty
[2013-10-10 13:04:06 -0400] ocholetras: and allowing sudoers / ssh access
[2013-10-10 13:04:08 -0400] ocholetras: by attributes
[2013-10-10 13:04:14 -0400] ocholetras: on 3rdparty role
[2013-10-10 13:05:05 -0400] stormerider: that makes sense, too.
[2013-10-10 13:05:17 -0400] ocholetras: so my role have 2 default array atributes that will be merged with the defaults on my wrapped coobook
[2013-10-10 13:06:04 -0400] ocholetras: on allow_groups openssh attr and sudo groups attr
[2013-10-10 13:06:54 -0400] ocholetras: but had read so much about trying to put attributes on roles only when it is absolutely unavoidable..
[2013-10-10 13:07:12 -0400] ocholetras: just starting with chef, so asking myself if this way is de right solution..
[2013-10-10 13:08:07 -0400] ocholetras: It Sounds logical to me, that users cookbook should merge all group stuff declared on users_manage resources and apply together
[2013-10-10 13:08:55 -0400] ocholetras: ill try this way with attr on role, will see on future... but the Resource Clonning warning is annoying -_-'
[2013-10-10 13:09:34 -0400] ocholetras: Because each users_manage block, declarse a user[username] resource
[2013-10-10 13:15:08 -0400] beantown1015: Has anyone used the on-demand command execution, docs suggest it is a enterprise chef thing, but it also says its a server plugin? Can it be used with open chef server?
[2013-10-10 13:15:30 -0400] beantown1015: Is it pushy?
[2013-10-10 13:15:50 -0400] ocholetras: you mean interactive chef-client?
[2013-10-10 13:16:09 -0400] beantown1015: A non-ssh way to push jobs out
[2013-10-10 13:30:00 -0400] geggam: that would be pushy... uses zerom1
[2013-10-10 13:30:05 -0400] geggam: er zeromq
[2013-10-10 13:31:02 -0400] geggam: here is an old doc hacking mcollective into chef http://www.cryptocracy.com/blog/2011/08/21/using-mcollective-with-chef
[2013-10-10 13:31:16 -0400] geggam: same thing .... different tools
[2013-10-10 13:37:51 -0400] pabst^: would node.override['Environment'] = environment name not work from a cookbook?
[2013-10-10 14:22:08 -0400] broconne: any good guidelines out there for naming site cookbooks?
[2013-10-10 14:22:18 -0400] broconne: Wondering if we should be putting org-<name>
[2013-10-10 14:22:19 -0400] broconne: or.. not
[2013-10-10 14:24:10 -0400] jbz: we do that to differentiate wrapper cookbooks from community cookbooks.
[2013-10-10 14:24:20 -0400] jbz: broconne ^
[2013-10-10 14:24:40 -0400] jbz: (when the wrappers aren't full roles)
[2013-10-10 14:27:18 -0400] broconne: thanks jbz
[2013-10-10 14:27:33 -0400] jbz: yw
[2013-10-10 14:34:43 -0400] broconne: jbz - what about for application cookbooks?
[2013-10-10 14:44:12 -0400] jmartin: should custom ohai plugins be active on the same chef run after installation through the ohai cookbook?
[2013-10-10 14:45:09 -0400] pabst^: we use _
[2013-10-10 14:45:13 -0400] pabst^: org_cookbook
[2013-10-10 14:53:05 -0400] pabst^: Can I apply a role from a cookbook?
[2013-10-10 14:55:53 -0400] broconne: thanks pabst
[2013-10-10 15:03:20 -0400] pabst^: no broconne
[2013-10-10 15:03:32 -0400] pabst^: er np. fingers are doing their own thing today
[2013-10-10 15:07:19 -0400] jmartin: pabst^: id guess you can do so
[2013-10-10 15:09:12 -0400] jmartin: pabst^: although im not sure that pattern is the greatest
[2013-10-10 15:12:08 -0400] daos: hey are any of you guys familiar with the following error: JSON::ParserError: Unsupported `json_class` type 'Chef::WebUIUser'
[2013-10-10 15:12:45 -0400] broconne: I don't see this documented, but it seems odd that when doing File Specificity chef doesn't do platform_family before default.
[2013-10-10 15:19:58 -0400] jtran: in one of my recipes i do a:     node['roles'].include? 'myrole'    .    Anyone know how I stub this in my tests?    I tried    chef_run.node.set['roles'] = ['myrole'] but that didn't work
[2013-10-10 15:21:32 -0400] bigbigbang: Ohai Chef ! How can I do to perform a search on all nodes having the attribute "security.unix.passwd.nb_empty_password= 1" I have trying this but i retrun me all node knife search node 'platform:scientific' -a security.unix.passwd.nb_user_with_empty_password' and I don't know how to bypass the "first search ( platfomr=scientific..")
[2013-10-10 15:22:17 -0400] laurent\: search(:node, "security_unix_passwd_nb_empty_password:1")
[2013-10-10 15:23:13 -0400] pwelch: how is everyone else customizing their Open-Source Chef Server? Setting up resources like chef_server SSL configs, nagios nrpe checks? Making it a node of itself and running a cookbook?
[2013-10-10 15:29:33 -0400] gyre007: guys...I have a tricky question
[2013-10-10 15:29:35 -0400] gyre007: I'm trying to "compose" value of an attribute in multiple recipes
[2013-10-10 15:29:37 -0400] gyre007: basicaly...
[2013-10-10 15:30:12 -0400] gyre007: I need different recipe for different logging tail-er
[2013-10-10 15:31:02 -0400] gyre007: so I'd have APP recipe and Nginx recipe....and they both will have tail attribute set to different log files - obviously....at the end of the chef run I'd like to have one attribute which would contain all hashes set in different recipes on the same attribute
[2013-10-10 15:31:20 -0400] gyre007: is that even possible ?
[2013-10-10 15:32:44 -0400] gyre007: like this https://gist.github.com/milosgajdos83/6920369
[2013-10-10 15:32:48 -0400] gyre007: we have 2 different recipes
[2013-10-10 15:32:59 -0400] gyre007: which are setting same attribute
[2013-10-10 15:33:11 -0400] gyre007: I reckon this is not going to merge them right ?
[2013-10-10 15:33:13 -0400] gyre007: or ?
[2013-10-10 15:33:34 -0400] gyre007: they're both in the same runlist btw
[2013-10-10 15:34:12 -0400] pabst^: jmartin: ive been trying different ways of doing so, doing something like node.override['run_list'] = "role['rolename']' shows up as an override but never actually executes and goes away on the next iteration. Haven't found a good way to do it
[2013-10-10 15:36:28 -0400] gyre007: is it possible to merge one attribute across mutliple recipes in the runlist
[2013-10-10 15:39:44 -0400] CPS: I'm running chef on windows trying to call an exe from a recipe. I'm getting an error, "The directory name is invalid", but the path exists. it's an uninstaller in program files. has anyone seen this before?
[2013-10-10 15:41:04 -0400] jtran: in one of my recipes i do a:    node['roles'].include? 'myrole'    .    Anyone know how I stub this in my tests?    I tried    chef_run.node.set['roles'] = ['myrole'] but that didn't work
[2013-10-10 16:03:35 -0400] jmartin: pabst^: to do what you want, you might have to do some node.set/node.save magic?
[2013-10-10 16:20:53 -0400] pabst^: jmartin: Thanks. I thought about that  but never followed that path, I decided doing some python/bash magic in the kickstart was honestly a less hacky solution
[2013-10-10 16:21:35 -0400] pabst^: would anyone see ANY value at all in adding an svn plugin to spork? If so, ill try and take my hand at writing one
[2013-10-10 16:21:45 -0400] pabst^: otherwise, I may force my team to do git+svn
[2013-10-10 16:26:41 -0400] eherot1: anyone here have a zookeeper deployment?  And if so, which cookbook are you using?
[2013-10-10 16:27:01 -0400] jmartin: eherot1: i believe that miah does
[2013-10-10 16:27:15 -0400] eherot1: miah probably has her own cookbook :-P
[2013-10-10 16:52:05 -0400] ralph_maccio: Hi, I'm trying to deploy a rails application using the application_ruby cookbook. I get an error that there is "No resource found for rails. Tried application_rails, application_ruby_rails, rails". I have both application and application_ruby in my metadata file. Has anyone seen something like this?
[2013-10-10 17:02:08 -0400] MrBIOS: good morning, anyone around who could give me a quick pointer on data bag items?
[2013-10-10 17:05:00 -0400] CPS: what's the question MrBIOS
[2013-10-10 17:05:34 -0400] MrBIOS: is it possible to store multiple key/value pairs inside a single data bag?
[2013-10-10 17:05:49 -0400] eherot1: MrBIOS: you can store gigabytes of them
[2013-10-10 17:05:51 -0400] CPS: i believe so
[2013-10-10 17:06:01 -0400] MrBIOS: something like id data_bag_item("auth-tokens", "aws-user", "key")
[2013-10-10 17:06:01 -0400] MrBIOS: data_bag_item("auth-tokens", "aws-user", "secret")
[2013-10-10 17:06:04 -0400] MrBIOS: (but that doesn't work)
[2013-10-10 17:06:14 -0400] eherot1: you would do it like this:
[2013-10-10 17:06:49 -0400] eherot1: tokens = data_bag_item("auth-tokens","aws")
[2013-10-10 17:07:02 -0400] eherot1: and then tokens["secrets"] and tokens["aws-user"]
[2013-10-10 17:07:33 -0400] MrBIOS: perfect, thanks
[2013-10-10 17:07:34 -0400] jmartin: ralph_maccio: post a gist of your recipe?
[2013-10-10 17:08:42 -0400] eherot1: MrBIOS: or better yet, tokens["aws-user"]["secret"] and tokens["aws-user"]["key"]
[2013-10-10 17:11:00 -0400] ralph_maccio: jmartin: https://gist.github.com/PaulOstazeski/6922007
[2013-10-10 17:11:50 -0400] ralph_maccio: jmartin: The project is cloned into the expected folder if I remove the rails block.
[2013-10-10 17:14:41 -0400] ralph_maccio: jmartin: Updated gist to include metadata.rb as well
[2013-10-10 17:17:05 -0400] fifthecho: Anyone else having windows-pr issues with Knife?
[2013-10-10 17:22:04 -0400] juliancdunn: fifthecho: what do you mean?
[2013-10-10 17:22:28 -0400] fifthecho: Knife isn't working because it looks like there's a circular dependency with the "windows-pr" gem.
[2013-10-10 17:23:49 -0400] fifthecho: It looks like the chef gem requires windows-pr (= 1.2.1) but mixlib-shellout-1.2.0 depends on windows-pr (~> 1.2.2) and chef depends on mixlib-shellout-1.2.0
[2013-10-10 17:30:55 -0400] CPS: i'm writing a recipe that copies an installer from a network share then runs it
[2013-10-10 17:31:09 -0400] CPS: i have the copy and execute steps in separate execute blocks
[2013-10-10 17:31:28 -0400] CPS: and one execute block that just notifies the copy block and the run block
[2013-10-10 17:31:56 -0400] CPS: but i'm getting ArgumentError: invalid timing
[2013-10-10 17:32:06 -0400] CPS: notifies 'copy_installer','install',:run
[2013-10-10 17:32:44 -0400] CPS: is that not correct?
[2013-10-10 17:35:13 -0400] chip-: Syntax is off. http://docs.opscode.com/chef/resources.html#notifies-syntax
[2013-10-10 17:37:14 -0400] CPS: can i call 2 execute blocks like that?
[2013-10-10 17:39:25 -0400] juliancdunn: fifthecho: I'm not aware that Chef depends on windows-pr
[2013-10-10 17:40:07 -0400] juliancdunn: oh wait, on Windows it does... duh
[2013-10-10 17:40:43 -0400] fifthecho: It looks like it does on Windows and is a hard version requirement. "You have requested to uninstall the gem: windows-pr-1.2.1 chef-11.6.2 depends on windows-pr (= 1.2.1)"
[2013-10-10 17:43:36 -0400] CPS: chip-: how do i invoke 2 execute blocks like that?
[2013-10-10 17:44:17 -0400] CPS: ah nm, i see it
[2013-10-10 17:45:59 -0400] broconne: Is there a ruby way of turning something into a list if it isn't already a list?  I am sure I could make something up w/ an if or and unless.. but wasn't sure if there was a more ruby way.
[2013-10-10 17:47:13 -0400] eherot1: broconne: you mean like if it's a comma-separated string?
[2013-10-10 17:47:57 -0400] broconne: nope..  I just have a method that accepts a variable.. I don't want to blow up if someone passes in a single object..  I simply want to treat that as a list of size 1, in which the object i sin that list.
[2013-10-10 17:48:31 -0400] CPS: create a list and add the object?
[2013-10-10 17:48:34 -0400] broconne: so was looking for a quick "turns this into a list, if it isn't already"
[2013-10-10 17:48:35 -0400] broconne: yes
[2013-10-10 17:48:36 -0400] broconne: I can
[2013-10-10 17:48:50 -0400] broconne: I was looking for the ruby way to do that which I imagine isn't an if/else tree
[2013-10-10 17:49:04 -0400] broconne: if I get a list, I don't want ot create a list and add it to that.
[2013-10-10 17:49:28 -0400] eherot1: a = Array
[2013-10-10 17:49:30 -0400] eherot1: err
[2013-10-10 17:49:56 -0400] eherot1: a = Array.new
[2013-10-10 17:49:56 -0400] eherot1: a << new_object
[2013-10-10 17:49:56 -0400] eherot1: a.flatten!
[2013-10-10 17:50:07 -0400] eherot1: there's probably a better way
[2013-10-10 17:50:10 -0400] eherot1: oh or
[2013-10-10 17:50:16 -0400] eherot1: [new_object].flatten
[2013-10-10 17:50:37 -0400] eherot1: you'll end up with a single-tiered array regardless of what was passed in
[2013-10-10 17:50:51 -0400] broconne: hmm.. it sort of looks like Array.new(array) - doesn't create an array of arrays.. but instead just pulls in those objects.
[2013-10-10 17:51:17 -0400] broconne: just not sure what Array.new(non_array_object) does. I would hope just add that item to the array
[2013-10-10 17:51:19 -0400] eherot1: This will: [[array]]
[2013-10-10 17:51:30 -0400] eherot1: broconne: this is what irb is good for
[2013-10-10 17:52:21 -0400] eherot1: Array.new() expects size as the argument
[2013-10-10 17:52:42 -0400] broconne: yeah, if its not an array it does it seems.
[2013-10-10 17:52:43 -0400] eherot1: or an array
[2013-10-10 17:52:46 -0400] eherot1: won't take strings
[2013-10-10 17:53:08 -0400] eherot1: but you can jsut say: [non_array_object]
[2013-10-10 17:53:14 -0400] eherot1: that will make an array
[2013-10-10 17:53:54 -0400] eherot1: case in point:
[2013-10-10 17:53:54 -0400] eherot1: irb(main):007:0> a = "foo"
[2013-10-10 17:53:54 -0400] eherot1: => "foo"
[2013-10-10 17:53:54 -0400] eherot1: irb(main):008:0> [[a]].flatten
[2013-10-10 17:53:54 -0400] eherot1: => ["foo"]
[2013-10-10 17:56:00 -0400] broconne: hmm.  I must not being very clear.  In Java (using Guava).. I would do a Lists.newArrayList(<something>).     It doesn't matter if something is an object, a list of objects, etc.  when it is done.. I get back a single list of objects.. And then I can iterate over it.. and I don't need distinct logic for when I receive one of something or a list (array) of something.. so was looking for the ruby way of doing that.
[2013-10-10 17:56:07 -0400] failshell: im using the following provider: https://gist.github.com/failshell/d72b438d6cc70bebf455 thing is, it's always triggering the notification. even if the file is not changed. not sure why.
[2013-10-10 17:56:38 -0400] eherot1: broconne: how is that not covered by what I suggested?  That's what I'm not clear on.
[2013-10-10 17:56:53 -0400] broconne: so in your case
[2013-10-10 17:56:54 -0400] CPS: i think he wants a single statement for it
[2013-10-10 17:57:02 -0400] broconne: if someone passes in a
[2013-10-10 17:57:09 -0400] broconne: and I do [[a]].flatten
[2013-10-10 17:57:13 -0400] broconne: it doens't matter if a is an array or an object
[2013-10-10 17:57:22 -0400] broconne: I will receive a single array back with one or more elments in it?
[2013-10-10 17:57:26 -0400] eherot1: right
[2013-10-10 17:57:48 -0400] broconne: then it sounds like it does it :-)
[2013-10-10 17:57:49 -0400] broconne: thanks
[2013-10-10 17:57:58 -0400] eherot1: like so:
[2013-10-10 17:57:58 -0400] eherot1: irb(main):001:0> b = ["one","two"]
[2013-10-10 17:57:58 -0400] eherot1: => ["one", "two"]
[2013-10-10 17:57:59 -0400] eherot1: irb(main):002:0> [[b]].flatten
[2013-10-10 17:57:59 -0400] eherot1: => ["one", "two"]
[2013-10-10 17:58:19 -0400] broconne: awesome
[2013-10-10 17:58:19 -0400] broconne: thanks
[2013-10-10 17:58:28 -0400] eherot1: np :-)
[2013-10-10 17:59:10 -0400] eherot1: flatten is kind of iffy to use though because if someone passes in an array of arrays, you'll lose that
[2013-10-10 17:59:24 -0400] eherot1: but if you know you won't need that then it shouldn't be an issue
[2013-10-10 18:00:09 -0400] eherot1: it also weirdly converts hashes to arrays
[2013-10-10 18:01:12 -0400] broconne: well, I will blow up if i can an array of arrays anyway :-)
[2013-10-10 18:01:35 -0400] eherot1: haha well there ya go
[2013-10-10 18:01:50 -0400] mondo: hi, is anyone using a single chef server for their private and dmz networks?  How are you allowing your DMZ nodes to connect to the server?
[2013-10-10 18:03:14 -0400] drrk: Simple, but the chef server in the DMZ :)
[2013-10-10 18:03:25 -0400] mondo: yeah that was my plan
[2013-10-10 18:04:29 -0400] juliancdunn: fifthecho: gonna try to repro
[2013-10-10 18:05:54 -0400] ralph_maccio: broconne: You're looking for the splat operator. `def do_something(*args); args.each { |elt| p elt }; end`
[2013-10-10 18:09:22 -0400] toontje_: Anybody here? Workstaton install problem. Mac. Probably a well known issue. Newbe here.
[2013-10-10 18:09:49 -0400] eherot1: toontje_: what's the problem?
[2013-10-10 18:10:27 -0400] toontje_: I'm running knife configure --initial and get the following message back: ERROR: Your private key could not be loaded from /etc/chef-server/admin.pem Check your configuration file and ensure that your private key is readable
[2013-10-10 18:10:46 -0400] toontje_: Workstation is Mac. Server is Linux in a VM.
[2013-10-10 18:10:52 -0400] toontje_: Ubuntu
[2013-10-10 18:11:31 -0400] juliancdunn: fifthecho: I asked internally -- workaround is to uninstall mixlib-shellout 1.2.0 and downgrade to 1.1.0
[2013-10-10 18:11:45 -0400] juliancdunn: I assume you're not using Omnibus, because Omnibus 11.6.2 for Windows ships w/ 1.1.0
[2013-10-10 18:12:19 -0400] eherot: toontje_: that isn't a workstation command
[2013-10-10 18:12:25 -0400] eherot: http://docs.opscode.com/knife_configure.html#options
[2013-10-10 18:12:49 -0400] toontje_: I'm following this doc: http://docs.opscode.com/install_workstation.html
[2013-10-10 18:12:49 -0400] fifthecho: juliancdunn: Nope. Installing using gem.
[2013-10-10 18:13:30 -0400] toontje_: Open Source Chef Server  For a workstation that will interact with the open source server, do the following:  Create a knife.rb file. This configuration file must be created by running the knife configure --initial command on the machine that will be run as a workstation.
[2013-10-10 18:13:47 -0400] eherot: hmmm
[2013-10-10 18:14:54 -0400] eherot: toontje_: you have to download that file from your chef server
[2013-10-10 18:15:16 -0400] eherot: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/ under "set up an admin user"
[2013-10-10 18:16:12 -0400] toontje_: Ok, let me try that one.
[2013-10-10 18:16:31 -0400] eherot: admittedly that would seem to be contradicted by the docs you're reading (which are the right ones afaik)
[2013-10-10 18:18:35 -0400] eherot: are you *just* running knife configure inital (no other flags?)
[2013-10-10 18:19:14 -0400] eherot: *and* you're not in a directory that already has a knife.rb file
[2013-10-10 18:20:58 -0400] failshell: how do you call a service restart from within a ruby_block? i tried resources(:service => 'smb').run_action(:restart) but that's not working
[2013-10-10 18:22:45 -0400] toontje_: eherot: The issue was that i accepted the defaults of /etc/chef-server/admin.pem expecting knife to somehow access the .pem files on the server. I pointed to the local admin.pem and validator.pem files and now it seems to work.
[2013-10-10 18:22:53 -0400] gchristensen: failshell: why not just notify
[2013-10-10 18:23:16 -0400] failshell: gchristensen: its notifying on everyrun, even if the file hasn't changed
[2013-10-10 18:23:42 -0400] eherot: toontje_: glad it worked :-)
[2013-10-10 18:23:46 -0400] gchristensen: oh, are you able to use not_if/only_if to only sometimes execute the ruby block to fix that?
[2013-10-10 18:23:58 -0400] failshell: gchristensen: https://gist.github.com/failshell/d72b438d6cc70bebf455
[2013-10-10 18:24:01 -0400] failshell: that's the code. so no
[2013-10-10 18:24:02 -0400] toontje_: eherot: Thanks for the help. I should have found that myself.
[2013-10-10 18:24:28 -0400] gchristensen: failshell: got it
[2013-10-10 18:24:32 -0400] eherot: toontje_: yeah yeah everyone says that
[2013-10-10 18:24:38 -0400] eherot: (including me)
[2013-10-10 18:25:24 -0400] toontje_: eherot: ;)
[2013-10-10 18:27:40 -0400] failshell: worst thing is, i know ive done this before
[2013-10-10 18:27:45 -0400] failshell: just cant recall in which cookbook
[2013-10-10 18:28:58 -0400] failshell: ah here we go
[2013-10-10 18:29:15 -0400] failshell: Chef::Resource::Notification.new("service[smb]", :restart, :delayed)
[2013-10-10 18:36:57 -0400] pabst^: if i commit these cookbook changes, its going to over write the cookbook my co worker just uploaded to the server
[2013-10-10 18:37:09 -0400] miah: do you version your changes
[2013-10-10 18:37:53 -0400] pabst^: were using spork, so it won't be overwritten.
[2013-10-10 18:38:03 -0400] pabst^: we're
[2013-10-10 18:38:20 -0400] pabst^: but not git... just svn... and its something i am especially frustrated with today
[2013-10-10 18:40:16 -0400] mconigliaro: hey guys, what can a chef server admin do that other users can't?
[2013-10-10 18:40:22 -0400] mconigliaro: is there documentation on that somewhere?
[2013-10-10 18:40:43 -0400] miah: mconigliaro: add nodes, add clients, add users, modify data bags, modify nodes, modify clients
[2013-10-10 18:40:56 -0400] mconigliaro: miah: i don't think that's accurate
[2013-10-10 18:41:00 -0400] miah: thats fine
[2013-10-10 18:41:06 -0400] pabst^: lol
[2013-10-10 18:41:39 -0400] mconigliaro: for example, new nodes can use the validation key to create new clients in the chef server
[2013-10-10 18:41:40 -0400] jtran: in one of my recipes i do a:    node['roles'].include? 'myrole'    .    Anyone know how I stub this in my tests?    I tried    chef_run.node.set['roles'] = ['myrole'] but that didn't work.  anyone know a better way?
[2013-10-10 18:41:42 -0400] mconigliaro: right?
[2013-10-10 18:41:50 -0400] cwj: mconigliaro: http://docs.opscode.com/auth_authorization.html
[2013-10-10 18:41:52 -0400] miah: yes. validation key is a special case
[2013-10-10 18:41:52 -0400] mconigliaro: and the validation user isn't an admin
[2013-10-10 18:42:06 -0400] mconigliaro: i see
[2013-10-10 18:42:12 -0400] mconigliaro: cwj: thanks
[2013-10-10 18:42:13 -0400] eherot: mconigliaro: technically the admin creates a node and the node registers itself
[2013-10-10 18:42:25 -0400] eherot: so when first convergence doesn't complete you have an empty node object.
[2013-10-10 18:42:53 -0400] miah: you can generate node objects prior to first convergence as well
[2013-10-10 18:43:24 -0400] eherot: miah: or just for fun ;-)
[2013-10-10 18:43:37 -0400] mconigliaro: ok, thanks guys
[2013-10-10 18:44:07 -0400] miah: objects all the way down
[2013-10-10 18:44:12 -0400] jmartin: miah: you are a wizard of the internets, i havent found much information regarding custom ohai plugins, should attributes be available during the same chef run from that custom plugin?
[2013-10-10 18:45:08 -0400] jmartin: miah: using the ohai cookbook btw and it claims to be re-loading ohai/merging attrs
[2013-10-10 18:45:10 -0400] eherot: miah: Do you use the SimpleFinance chef-zookeeper cookbook and if so, would you recommend it?
[2013-10-10 18:45:33 -0400] jmartin: eherot: i think miah works there so probably ;D
[2013-10-10 18:46:14 -0400] eherot: jmartin: It never even occurred to me to ask that :-P
[2013-10-10 18:46:35 -0400] jmartin: eherot: i only have an inkling based off a recent blog post highlighting her contribs
[2013-10-10 18:46:38 -0400] miah: i do work at Simple. The zookeeper book is good.
[2013-10-10 18:47:42 -0400] whilp: fwiw, we have a channel for simple-specific stuff; feel free to hop in ##simple
[2013-10-10 18:47:49 -0400] miah: =)
[2013-10-10 18:47:53 -0400] whilp: miah's pretty good about covering here, tho ;)
[2013-10-10 18:47:55 -0400] eherot: such as "does miah work there?"
[2013-10-10 18:48:10 -0400] miah: well, 'work' is a fairly vague topic ;)
[2013-10-10 18:48:31 -0400] eherot: haha
[2013-10-10 18:48:32 -0400] jmartin: i think im the only person that fails this hard at custom ohai stuff :-/
[2013-10-10 18:48:45 -0400] eherot: miah: you guys aren't a bank, right?
[2013-10-10 18:50:00 -0400] miah: we are a bank
[2013-10-10 18:51:35 -0400] whilp: some good docs here: https://www.simple.com/faq/#the-fundamentals
[2013-10-10 18:51:51 -0400] whilp: (prolly OT for #chef, i guess)
[2013-10-10 18:52:06 -0400] thehar: miah: I thought you worked at HT?
[2013-10-10 18:52:17 -0400] whilp: but we'll all be at chef summit if you want to chat in person ;)
[2013-10-10 18:52:20 -0400] eherot: yeah I'd kind of thought the Bancorp partnership took care of the "bank" part
[2013-10-10 18:52:24 -0400] chris613: Can someone help me understand which version of Chef Client is required to have this code in it? (https://github.com/opscode/chef/pull/498) I'm using the jenkins cookbook from opscode and it's failing on "render" in a template. I'm assuming that's because my chef client is too old and the documented requirements are wrong.
[2013-10-10 18:52:55 -0400] eherot: whilp: was thinking about going to that but I thought it might be a waste if I'm also going to the OpsCode conference...
[2013-10-10 18:53:06 -0400] chris613: need to know what version to upgraed to at minimum. Running 10.20.0 currently
[2013-10-10 18:53:20 -0400] whilp: eherot: miah's been to both; i've only been to the summit and have found it super useful
[2013-10-10 18:53:43 -0400] juliancdunn: chris613: I believe partials are only in Chef >= 11
[2013-10-10 18:54:05 -0400] eherot: aye I met miah there last year (though I'm not sure she knows it)
[2013-10-10 18:54:25 -0400] fifthecho: juliancdunn: Okay. After changing out mixlib-shellout gems, I'm getting "`require': cannot load such file -- yajl/2.0/yajl (LoadError)" when trying to run "knife status"
[2013-10-10 18:54:32 -0400] chris613: juliancdunn: I was afrai of that answer. Therefor the Requirements section of the jenkins cookbook README.md that says "Chef 0.10.10+" is a lie?
[2013-10-10 18:55:22 -0400] juliancdunn: chris613: I don't know the Jenkins cookbook, but if it's using partials, then yes
[2013-10-10 18:55:34 -0400] CPS: i'm writing a recipe and I want an element to execute two other elements in order
[2013-10-10 18:55:38 -0400] chris613: Alright. I'll come up with something
[2013-10-10 18:55:55 -0400] CPS: what word would i use to label that? execute and template don't work
[2013-10-10 18:55:55 -0400] jmartin: juliancdunn: you happen to know if i can expect custom ohai plugin attrs to be avail during the same chef run as deploy or if a second run is needed normally?
[2013-10-10 18:56:33 -0400] juliancdunn: jmartin: you can reload Ohai during the run. I don't remember the exact syntax
[2013-10-10 18:56:59 -0400] jmartin: juliancdunn: yeah, im doing that based on the nginx cookbook example, but it seems to require a second run before it actually shows up
[2013-10-10 18:57:14 -0400] jmartin: it could just be a quirk with the plugin perhaps?
[2013-10-10 18:58:00 -0400] juliancdunn: jmartin: could be -- I personally haven't used many custom ohai plugins
[2013-10-10 18:58:38 -0400] jmartin: juliancdunn: ok thanks, the few days jtimberman isnt floating around this chan is when i need to bug him about this plugin :D
[2013-10-10 18:58:48 -0400] jmartin: ill just wait until he makes an appearance
[2013-10-10 18:59:18 -0400] spicy: arg, running into issues with using the xml cookbook at runtime  I need to install nokogiri to chef ruby (which this cookbook supports provided it runs at compile) but apt is failing because apt-get update hasn't run and trying to force the apt cookbook to run at compile seems like it isn't helping
[2013-10-10 18:59:28 -0400] spox: jmartin: have a gist of your current implemenation?
[2013-10-10 18:59:45 -0400] spicy: hm, note to self, don't use em-dash
[2013-10-10 19:00:17 -0400] jmartin: spox: ja, i pretty much just took the example of the nginx cookbook -> https://gist.github.com/hugespoon/fe2a6e28c4823e5cb92c
[2013-10-10 19:02:05 -0400] spox: does the ohai plugin need to be a template?
[2013-10-10 19:02:27 -0400] jmartin: spox: not really
[2013-10-10 19:03:03 -0400] jmartin: spox: im just trying out jtimberman's network_addr.rb plugin thats floating out there
[2013-10-10 19:03:23 -0400] jmartin: it 'works' but just not when expected
[2013-10-10 19:03:24 -0400] spox: so, if you take your plugin and throw it in files
[2013-10-10 19:03:36 -0400] spox: files/default/plugins/YOURFILE.rb
[2013-10-10 19:03:55 -0400] spox: node.set[:ohai][:plugins][:jmartin] = 'plugins'
[2013-10-10 19:03:59 -0400] spox: include_recipe 'ohai'
[2013-10-10 19:04:03 -0400] spicy: oh, nevermind - it works if you add xml::ruby only and not default and ruby
[2013-10-10 19:04:50 -0400] spox: your bits would probably work as is but you'll need to force compile time actions so you can get the ohai data updated
[2013-10-10 19:05:35 -0400] jmartin: spox: does the ohai resource not do exactly that?
[2013-10-10 19:05:42 -0400] eliklein: so how do people handle cookbooks that need to be applied to all of your hosts, but with different attributes based on various criteria.. ie. based on location
[2013-10-10 19:05:53 -0400] jmartin: spox: it claims to be reloading/merging attrs during the run
[2013-10-10 19:06:12 -0400] miah: thehar: i left them. they basically changed my job description from 'build new infrastructure' to 'maintain shit on engineyard'
[2013-10-10 19:06:23 -0400] eliklein: seems that setting these attributes in roles or databags could cause problems when you need to change things.. in that it doesn't allow you to test things incrementally
[2013-10-10 19:06:27 -0400] miah: engineyard made me want to kill myself
[2013-10-10 19:06:38 -0400] thehar: well i'm glad you got the job instead of me :D
[2013-10-10 19:06:41 -0400] CPS: what resource type would you use to simply execute other resources in a particular order?
[2013-10-10 19:06:45 -0400] miah: =)
[2013-10-10 19:07:26 -0400] eliklein: but then having logic in your wrapper cookbook makes me want to vomit too, so i'm a bit stuck
[2013-10-10 19:07:26 -0400] thehar: miah: is that why russell left? haha
[2013-10-10 19:07:36 -0400] thehar: besides coin
[2013-10-10 19:07:36 -0400] miah: thehar: partly
[2013-10-10 19:07:42 -0400] thehar: interesting
[2013-10-10 19:07:52 -0400] miah: there were other things that i dont feel should be repeated
[2013-10-10 19:08:00 -0400] thehar: of course
[2013-10-10 19:08:07 -0400] thehar: well things happen for a reason.
[2013-10-10 19:09:00 -0400] miah: mostly, they were not a technology company. they were all about their product.
[2013-10-10 19:09:06 -0400] thehar: yes indeed.
[2013-10-10 19:09:12 -0400] thehar: i noticed that during the process.
[2013-10-10 19:09:40 -0400] thehar: i hope you vested something. something good will happen to them
[2013-10-10 19:11:03 -0400] miah: maybe
[2013-10-10 19:23:08 -0400] miah: CARRY ON PEOPLE </friar brady>
[2013-10-10 19:23:32 -0400] thehar: lol
[2013-10-10 19:30:47 -0400] gsymons-di: So, I'm seeing something weird... I can't authenticate to Hosted Chef with Berkshelf anymore...
[2013-10-10 19:30:57 -0400] gsymons-di: Anybody else having this problem?
[2013-10-10 19:31:07 -0400] gsymons-di: \join #berkshelf
[2013-10-10 19:31:18 -0400] gsymons-di: damn... wrong slash:)
[2013-10-10 19:33:28 -0400] kshep: hm. doesn't seem like there's an easy way to change the nginx log format in the community cookbook....
[2013-10-10 19:40:18 -0400] Drewzar: Anyone ever see an issue where the 'content-type: application/json' header data gets dropped from the reporting data POST?
[2013-10-10 19:44:37 -0400] CPS: in a recipe, what would be a good way to check if an env var exists and set it to something if it does not?
[2013-10-10 19:44:49 -0400] CPS: i can use a ruby_block but i thought there might be a better way
[2013-10-10 19:55:44 -0400] gchristensen: huh... suddenly my chef-hipchat notifier isn't working aymore (Unable to activate httparty-0.12.0, because json-1.5.4 conflicts with json (~> 1.8))
[2013-10-10 19:57:19 -0400] gchristensen: jmartin: I just realized that my nodes are not getting the updated ohai attributes
[2013-10-10 20:07:51 -0400] failshell: i use Chef::Resource::Notification.new('service[smb]', :restart) inside a ruby_block in cookbook A and it works. I use the same in cookbook B, doesnt work. i dont get it
[2013-10-10 20:07:58 -0400] failshell: same version of chef
[2013-10-10 20:23:15 -0400] mmzyk: failshell That's not very much to go on to help you out there. Perhaps a gist of the ruby blocks to see more what's going on?
[2013-10-10 20:29:05 -0400] failshell: mmzyk: its cool. i used notifies :restart, resources(:service => 'smb'), :delayed instead
[2013-10-10 20:29:24 -0400] mmzyk: excellent.
[2013-10-10 20:33:32 -0400] dgarstang2: Anyone know how I can simulate chef search on vagrant? Trying to set up zookeeper.
[2013-10-10 20:35:21 -0400] j^2: dgarstang2: do you have a chef-sever attached to the vagrant box?
[2013-10-10 20:35:49 -0400] chip-: dgarstang2: Haven't tried it, but https://github.com/andrewgross/vagrant-chef-zero might help.
[2013-10-10 20:35:52 -0400] dgarstang2: j^2: on that vagrant box, no
[2013-10-10 20:36:20 -0400] dgarstang2: chip-: had some issues with that last time. guess I could try again
[2013-10-10 20:36:20 -0400] j^2: i guess i dont know what you mean by a "chef search" Then
[2013-10-10 20:37:11 -0400] chip-: I think what you're saying is that you're looking to mock chef search results in solo?
[2013-10-10 20:37:23 -0400] dgarstang2: j^2: this  http://serverfault.com/questions/412127/chef-recipe-read-attributes-from-another-node
[2013-10-10 20:37:38 -0400] dgarstang2: chip-: if vagrant uses chef solo, then yes
[2013-10-10 20:37:59 -0400] chip-: Vagrant will use either chef-client or chef-solo, depending on what you tell it to do.
[2013-10-10 20:38:14 -0400] dgarstang2: zookeeper's config file needs to know about every node in it's cluster. obviously the chef server knows about this, so doing a chef search to populate that seems feasible
[2013-10-10 20:38:34 -0400] dgarstang2: chip-: don't know which I am using
[2013-10-10 20:38:48 -0400] chip-: It'll be in your Vagrantfile.
[2013-10-10 20:39:06 -0400] kshep: dgarstang2 You might get *part* way there with https://github.com/edelight/chef-solo-search
[2013-10-10 20:39:12 -0400] kshep: but that's just databags, I think
[2013-10-10 20:39:15 -0400] dgarstang2: i guess it's chef solo... "config.vm.provision :chef_solo do |chef|"
[2013-10-10 20:39:39 -0400] dgarstang2: eh. maybe I need to just upload to aws and test there where I have a real server
[2013-10-10 20:39:49 -0400] kshep: don't hink you can do a chef-server search if you're provisioning the vagran box with chef-solo...
[2013-10-10 20:39:55 -0400] dgarstang2: poo
[2013-10-10 20:40:07 -0400] chip-: OK. Solo doesn't use search, so your options are: Do without search, or use chef-client provisioner, and have Vagrant talk to a Chef server. Or try the chef-zero provisioner, which will generate an in-memory chef-client for the duration of your vagrant provision, but that plugin is pretty beta.
[2013-10-10 20:40:38 -0400] kshep: ...or use chef-server as the provisioner (I might have missed something in the beginning of the thread... sorry :-)
[2013-10-10 20:40:41 -0400] chip-: http://docs.vagrantup.com/v2/provisioning/chef_client.html
[2013-10-10 20:40:46 -0400] dgarstang2: chip-: might explain why i had issues with it. I suppose, I can populate an array in the recipe to test, and remove that later
[2013-10-10 20:41:10 -0400] kshep: http://docs.vagrantup.com/v2/provisioning/chef_client.html
[2013-10-10 20:41:18 -0400] chip-: <-- WINNAH
[2013-10-10 20:41:21 -0400] mmzyk: Yeah, I chef-zero is likely the best way to go if you want to use vagrant. Chip - chef-zero is an in-memory chef-server, I believe, not an in memory chef-client.
[2013-10-10 20:41:23 -0400] mmzyk: https://github.com/jkeiser/chef-zero
[2013-10-10 20:41:24 -0400] kshep: heh
[2013-10-10 20:41:27 -0400] chip-: If you do that, you'll probably also want the vagrant-butcher plugin, FYI.
[2013-10-10 20:41:33 -0400] dgarstang2: kshep: How's that link help?
[2013-10-10 20:41:33 -0400] mmzyk: https://github.com/andrewgross/vagrant-chef-zero
[2013-10-10 20:41:50 -0400] kshep: dunno. ask chip. he won ;-)
[2013-10-10 20:41:52 -0400] chip-: mmzyk: Sorry, my bad. I mis-spoke. Meant to say server.
[2013-10-10 20:41:59 -0400] dgarstang2: I honestly don;t know what I have or need. There's so much magic fu going on here
[2013-10-10 20:42:12 -0400] mmzyk: no worries, chip, just setting the record straight.
[2013-10-10 20:42:30 -0400] chip-: dgarstang2: Vagrant wraps virtualbox, starts a VM image, then runs Chef inside of it to apply recipes etc, right? Not magic, just automatic.
[2013-10-10 20:42:51 -0400] chip-: dgarstang2: So you can tell Vagrant to run chef-client instead of chef-solo inside the guest. The link we've shared shows you how to configure that inside the VM.
[2013-10-10 20:42:58 -0400] chip-: by modifying the vagrantfile.
[2013-10-10 20:43:06 -0400] dgarstang2: chip-: I got vagrant plugins, gems, virtual box, all working together, oh and berkshelf. Whats going on under the covers is a mystery
[2013-10-10 20:43:25 -0400] chip-: dgarstang2: I sympathize. It's a huge toolchain without much insight if you're new to it.
[2013-10-10 20:43:38 -0400] dgarstang2: it's starting to sound like java with all the similar names too
[2013-10-10 20:43:40 -0400] chip-: and no clear "holy hell this rocks" moment unless you're used to doing without it.
[2013-10-10 20:43:50 -0400] ggayan: hey guys, what do you use for centralized multi-platform remote access for user support?
[2013-10-10 20:43:50 -0400] dgarstang2: vagrant-berkshelf vs berkshelf-vagrant and so on
[2013-10-10 20:44:04 -0400] ggayan: Logmein central looks ok, but doesn't work for linux :(
[2013-10-10 20:44:26 -0400] ggayan: and teamviewer's license is too restrictive in terms of simultaneous sessions
[2013-10-10 20:44:28 -0400] chip-: dgarstang2: Those are the same thing, they just had to switch names because it was backward at first.
[2013-10-10 20:44:59 -0400] dgarstang2: chip-: roight...
[2013-10-10 20:45:13 -0400] chip-: dgarstang2: So when you vagrant up: Vagrant uses the Vagrantfile, which contains information on how to configure the VM, and what to do with it after it's started.
[2013-10-10 20:45:35 -0400] dgarstang2: chip-: sure
[2013-10-10 20:45:42 -0400] chip-: Then the vagrant-berkshelf plugin kicks in, and berkshelf copies in all the cookbooks you've specified in your Berksfile or in metadata.rb of your cookbook, and makes them available to the guest's filesystem.
[2013-10-10 20:45:45 -0400] stormerider: ggayan: i think our IT folks use bomgar
[2013-10-10 20:46:18 -0400] chip-: Once the machine is up, the Vagrantfile has the provision section. This block tells Vagrant to run Chef (Chef-solo in your case) with a particular run_list inside the guest.
[2013-10-10 20:46:41 -0400] chip-: When Chef run is complete, the VM is up and configured. That's the workflow.
[2013-10-10 20:46:41 -0400] dgarstang2: chip-: no issues with the concepts. it's the magic fu under the covers that freaks me out
[2013-10-10 20:46:42 -0400] ggayan: bomgar, I'll check it out
[2013-10-10 20:46:46 -0400] ggayan: stormerider: thanks!
[2013-10-10 20:46:56 -0400] chip-: dgarstang2: OK, just walking the workflow to make sure we're on the same page. Don't mean to patronize. :)
[2013-10-10 20:46:57 -0400] stormerider: np
[2013-10-10 20:47:28 -0400] chip-: dgarstang2: So you can replace the config.vm.provision "chef-solo" section with something similar to the one in the vagrant docs that we linked, and it will run chef-client instead.
[2013-10-10 20:47:51 -0400] chip-: dgarstang2: You can give it the address of your chef server, the node & client names it's supposed to use, where to find validation keys, etc. and it'll work against the chef server instead.
[2013-10-10 20:47:57 -0400] dgarstang2: chip-: and then i'll have a dozen other issues. Nah, I'll work around it for now
[2013-10-10 20:48:03 -0400] chip-: Fair enough. :)
[2013-10-10 20:52:52 -0400] broconne: within the same cookbook
[2013-10-10 20:52:57 -0400] broconne: if you want to call a receipe
[2013-10-10 20:53:01 -0400] broconne: do you have to fully qualify it?
[2013-10-10 20:55:37 -0400] broconne: I am asking because I fully qualified it.. but then foodcritic gets upset about deps.
[2013-10-10 20:59:12 -0400] mmzyk: I did include_recipe with a fully qualified recipe in the same cookbook and food critic didn't complain for me, broconne.
[2013-10-10 21:00:41 -0400] fak3r: so I have apache installed in centos, so to run it 'service httpd start' - so in my recipe I have notifies :restart, "service[httpd]"
[2013-10-10 21:00:49 -0400] fak3r: but it fails with "service[httpd] cannot be found in the resource collection."
[2013-10-10 21:01:11 -0400] mmzyk: I'm using foodcritic 2.2.0, broconne.
[2013-10-10 21:01:33 -0400] broconne: mmzyk:  what was your syntax on the include receipe?
[2013-10-10 21:02:05 -0400] mmzyk: include_recipe "cookbookname::recipe"
[2013-10-10 21:03:46 -0400] broconne: hmm I am on 3.0.0
[2013-10-10 21:04:57 -0400] broconne: heh, if the captilization is the same in your metadata.rb it will complain :-)
[2013-10-10 21:05:34 -0400] mmzyk: I didn't even realize there was a new version of foodcritic out. I guess experiment with it and see what happens broconne.
[2013-10-10 21:12:07 -0400] dgarstang2: y ruby templates so hard. *sigh*
[2013-10-10 21:13:15 -0400] dgarstang2: What's wrong with this? http://pastebin.com/pQdDHhbS
[2013-10-10 21:14:01 -0400] dgarstang2: apart from a typo...
[2013-10-10 21:15:09 -0400] dgarstang2: or two...
[2013-10-10 21:17:47 -0400] nicgrayson: dgarstang2: why do you need to do that scan?
[2013-10-10 21:18:38 -0400] nicgrayson: dgarstang2: this is how i do that with zk
[2013-10-10 21:18:39 -0400] nicgrayson: https://gist.github.com/nicgrayson/6925811
[2013-10-10 21:46:06 -0400] dgarstang2: nicgrayson: because I'm getting the server id from the hostname. ie zk01 has an id of 1.
[2013-10-10 21:48:42 -0400] dgarstang2: nicgrayson: how does 'n' spring into existence?
[2013-10-10 21:50:43 -0400] nicgrayson: dgarstang2: n is from the do end block
[2013-10-10 21:51:07 -0400] nicgrayson: that "servers" var is a hash
[2013-10-10 21:51:24 -0400] dgarstang2: nicgrayson: so it's totally not clear with ruby ... in your case, is  node[:zookeeper][:servers] an array of strings or an array of something else?
[2013-10-10 21:52:08 -0400] dgarstang2: i reall just need a counterer that starts at 1
[2013-10-10 21:52:32 -0400] nicgrayson: dgarstang2: what should that line look like when it's complete?
[2013-10-10 21:53:04 -0400] dgarstang2: server.2=zk02:2888:3888
[2013-10-10 21:54:11 -0400] nicgrayson: dgarstang2: ah so your error is the variable name
[2013-10-10 21:54:58 -0400] nicgrayson: the         zookeeper_servers => zookeeper_servers line is the problem.
[2013-10-10 21:54:58 -0400] dgarstang2: for reasons that escape me, every time I google search for good clear concise docs on ruby template syntax, I never get much of anything.
[2013-10-10 21:55:05 -0400] dgarstang2: nicgrayson: Fixed that
[2013-10-10 21:55:22 -0400] nicgrayson: are you getting a new error?
[2013-10-10 21:55:44 -0400] dgarstang2: nicgrayson: oh, it's working now... I got past those errors. the issue now is just how to assign a numeric id to each
[2013-10-10 21:56:05 -0400] dgarstang2: oh wait...
[2013-10-10 21:56:47 -0400] nicgrayson: you should do it as a hash like mine imo
[2013-10-10 21:57:10 -0400] dgarstang2: nicgrayson: this is a hack until I get chef search to work. just creating an array for now
[2013-10-10 21:57:32 -0400] nicgrayson: so zookeeper_servers = {'1' => 'zk01', '2' => 'zk02' }
[2013-10-10 21:57:38 -0400] dgarstang2: ok, this did it... server.<%= zk.scan( /\d+$/ ).last.to_i %>=<%= zk %>:2888:3888 .... not node['fqdn']. Duh
[2013-10-10 21:57:50 -0400] nicgrayson: ah there you go
[2013-10-10 21:58:31 -0400] dgarstang2: nicgrayson: Well the plan here is to pull the nodes from chef search, which means I won't be able to pull the id from any source of truth like that... which means the id has to come from the hostname, which is pretty much what I get with what I got
[2013-10-10 21:59:51 -0400] nicgrayson: we just set the zk server in our env file
[2013-10-10 22:06:57 -0400] ignatz: I was just uploading a lot of cookbooks and my client suddenly decided my signature was invalid. Did I get throttled somehow?
[2013-10-10 22:23:28 -0400] cwj: ignatz: might have to email support@opscode.com, im not sure ive encountered that behavior myself
[2013-10-10 22:34:36 -0400] Drewzar: Anyone from opscode around?
[2013-10-10 22:40:17 -0400] ignatz: yeah I opened a ticket.
[2013-10-10 22:41:50 -0400] ignatz: they said my key is invalid. how does a key get invalid in the middle of an operatin?
[2013-10-10 22:52:21 -0400] coderanger: ignatz: What was the precise error?
[2013-10-10 22:53:01 -0400] ignatz: Failed to authenticate to URL as USER with KEY
[2013-10-10 22:53:08 -0400] coderanger: ignatz: Long cookbook ops might have been an S3 key timeout since the upload URLs are time-limited
[2013-10-10 22:53:10 -0400] ignatz: invalid signature for user or client
[2013-10-10 22:53:11 -0400] coderanger: Hmm, dunno then
[2013-10-10 22:53:20 -0400] ignatz: yeah that would have made sense.
[2013-10-10 22:53:37 -0400] ignatz: I'm cool with regenerating my key but nervous about why this happened
[2013-10-10 23:12:47 -0400] dgarstang2: ARRGH! knife-hub download /cookbooks/java --chef-repo-path /tmp/foo == great big ruby back trace
[2013-10-10 23:14:09 -0400] gsymons-di: ignatz: I'm not sure the server is always telling the whole story when you get that error. For example, earlier today, I missed a comma between a cookbook name and its version constraint in a metadata file, and when Berkshelf tried to download that dependency, it generated an invalid url (/cookbooks/cookbook version), and I got that error.
[2013-10-10 23:15:03 -0400] gsymons-di: ignatz: Though I suppose it's possible Ridley didn't run the signature algorithm on the URI-encoded version of the url, so the authentication failure really was what happened.
[2013-10-10 23:15:07 -0400] ignatz: I wonder why that would perpetuate to all future requests though
[2013-10-10 23:15:19 -0400] ignatz: this is just "now your key sucks"
[2013-10-10 23:15:51 -0400] gsymons-di: ignatz: Oh... yeah... once I fixed my metadata issue, the key was ok, and the key was ok for other requests too. Your thing is weird.
[2013-10-10 23:16:14 -0400] ignatz: I thought it might be timestamp so I updated my clock
[2013-10-10 23:36:12 -0400] ughani: hey guys ..quick questionif I want to subscribe to multiple resources, would i need to put multple subscribes for each resource or can i put all those resources on one line with a single subscribe?
[2013-10-10 23:38:04 -0400] cwj: not sure what the actual answer is, but i am in the habit of doing that with a line for each subscription or notification
[2013-10-10 23:42:36 -0400] ughani: i know if i put a separate subscribe for each resource it worksi just want to be lazy and put that on one line :)
