[2013-12-24 01:51:45 -0500] jstump: Anyone in here see Berkshelf poop itself on a stat?
[2013-12-24 01:52:05 -0500] jstump: Trying to figure out why https://travis-ci.org/sprintly/rstudio-chef/jobs/15910932 barfs but running it locally is fine.
[2013-12-24 01:56:35 -0500] josephholsten: jstump: no idea. just switched to using chefspec/berkshelf for my last cookbook and everything's working fine
[2013-12-24 01:57:12 -0500] jstump: josephholsten: Yeah, I switched to it last week and things are fine *except* for this cookbook that I'm trying to run tests on.
[2013-12-24 01:57:42 -0500] josephholsten: you might enjoy this rake task for foodcritic tho: https://github.com/josephholsten/chef-descartes/blob/master/Rakefile
[2013-12-24 01:58:29 -0500] jstump: josephholsten: Ah, nice. I just run `bundle exec foodcritic -f any .`.
[2013-12-24 01:58:37 -0500] josephholsten: not that it's relevant to your current problem
[2013-12-24 01:59:05 -0500] jstump: Haha, I'll take all the help I can get!
[2013-12-24 02:00:24 -0500] josephholsten: ngg. doesn't make any sense, and the stacktrace doesn't help at all
[2013-12-24 02:01:39 -0500] josephholsten: well @reset (and everyone else) is pissed at berks 2.0 for not really respecting the lockfile, and I hear 3.0 is near release
[2013-12-24 02:01:40 -0500] jstump: josephholsten: I think where I'm netting out at is that Linux doesn't have some devel package that it's expecting.
[2013-12-24 02:02:14 -0500] jstump: josephholsten: Berkshelf 3 had issues with another Berksfile that @reset is aware of. Might try it with this one though and see.
[2013-12-24 02:02:16 -0500] josephholsten: might be worth playing with master
[2013-12-24 02:02:48 -0500] josephholsten: ugh. I need to start keeping on top of that again.
[2013-12-24 02:02:52 -0500] jstump: josephholsten: Yeah, I'll give that a shot. The warning in the README came from my fight with v2. ;)
[2013-12-24 02:03:07 -0500] jstump: josephholsten: Unless you have an insane dependency tree you're likely fine.
[2013-12-24 02:03:09 -0500] josephholsten: but I've got to get out of here for today
[2013-12-24 02:03:11 -0500] jstump: josephholsten: And I found a workaround.
[2013-12-24 02:03:30 -0500] jstump: josephholsten: Word. Hope the new year and holiday season is a good one.
[2013-12-24 02:03:53 -0500] josephholsten: pagerduty willing
[2013-12-24 02:04:53 -0500] jstump: haha, yeah.
[2013-12-24 02:05:52 -0500] jstump: josephholsten: converting to v3 might have fixed my issue.
[2013-12-24 02:20:12 -0500] gswallow: What is this?
[2013-12-24 02:20:13 -0500] gswallow: 10.120.18.166 [2013-12-23T21:19:04-05:00] INFO: Sending resource update report (run-id: 1ee856f6-b6bd-4cf5-bdaa-aabdda875af7)
[2013-12-24 02:24:57 -0500] jstump: gswallow: Chef reports back to the server after each run, so that might be that.
[2013-12-24 02:26:36 -0500] gswallow: that's new.
[2013-12-24 02:26:44 -0500] gswallow: earlier today it was failing
[2013-12-24 02:27:41 -0500] jstump: gswallow: I've seen older nodes 400 on attempting to report back to home.
[2013-12-24 02:27:50 -0500] gswallow: Yep
[2013-12-24 02:28:18 -0500] jstump: gswallow: If you have a fix for that, let me know. I've tried fixing it a few times but don't care enough (we don't use those reports) to fix it given we're sunsetting those old nodes soon.
[2013-12-24 02:28:47 -0500] gswallow: I suppose I may figure out what it is.  I think this is only happening on windows nodes?
[2013-12-24 02:29:14 -0500] gswallow: I've cared more about what chef is doing *before* it reports, than the end of it.  I know that i have my own two Chef handlers.
[2013-12-24 02:31:45 -0500] jstump: gswallow: Ah word, I've seen it on Ubuntu prior to 12.04 running < 0.11 Chef.
[2013-12-24 02:32:17 -0500] gswallow: are you a managed chef customer?
[2013-12-24 02:42:44 -0500] gswallow: @jstump apparently you can view these reports on preview.opscode.com.
[2013-12-24 02:43:42 -0500] jstump: gswallow: Huh. News to me. I basically never go to opscode's site. The UI makes me a very sad panda.
[2013-12-24 02:43:54 -0500] jstump: gswallow: Yeah, we use managed chef.
[2013-12-24 02:44:15 -0500] gswallow: I don't use the web interface, either, but this is pretty cool.
[2013-12-24 02:44:49 -0500] jstump: gswallow: I'll take a look. Is it Travis-CI log file viewer cool? Love their tty output during build.
[2013-12-24 02:46:37 -0500] gswallow: I wouldn't know; never used Travis.
[2013-12-24 02:47:23 -0500] jstump: gswallow: It is quite swanky. I'm using it for chef spec right now and plan on adding Kitchen CI support next.
[2013-12-24 02:47:38 -0500] jstump: gswallow: And it makes building in multiple environments fairly trivial (at least for Ruby).
[2013-12-24 02:47:55 -0500] jstump: gswallow: Here's a build output for my rstudio-chef cookbook https://travis-ci.org/sprintly/rstudio-chef/jobs/15914990
[2013-12-24 02:49:03 -0500] gswallow: that's pretty sweet
[2013-12-24 02:50:07 -0500] jstump: gswallow: Yeah, I'm a fan. Now if someone could port this to Chef and have those collapses work around their color coded diffs, you and I can die happy. ;)
[2013-12-24 02:51:14 -0500] gswallow: heh.
[2013-12-24 03:31:11 -0500] jstump: Anyone have any thoughts on how to get around these resource cloning warnings? https://travis-ci.org/tvdinner/redis/jobs/15915796
[2013-12-24 03:57:25 -0500] EnriqueCadalso: Hi, I am using knife-backup. Installs gem knife-backup no problem but using "knife backup anythig" gives the error sub command cannot be found (http://pastie.org/8572620). How to make knife to use knife-backup?
[2013-12-24 04:17:59 -0500] abc: Any suggestions on the best RVM recipe to use for EL? I keep hitting problems.
[2013-12-24 04:31:40 -0500] jstump: abc: I gave up and moved to chruby.
[2013-12-24 04:31:58 -0500] jstump: abc: I know @LordCope did as well. Another friend of mine moved to rbenv.
[2013-12-24 04:50:01 -0500] abc_again: Thanks for the advice about chruby. I've been trying to find a working recipe for gitlab for about a week now. It's insanely frustrating. I'm starting to think that the public recipes just generally don't work well. It's really blowing me away that the Opscode recommended recipes for basic things like yum and postgres and rvm have such problems. I went to Chefbecause I thought the community would be better than Puppetforge, but I'm n
[2013-12-24 04:50:45 -0500] abc_again: using Bash scripts. Adding ruby just gets in the way. I still haven't given up on Chef yet, but I'm getting close.
[2013-12-24 05:43:35 -0500] coderanger: cheeseplus: This is super long, but I bet it would interest you http://repository.tudelft.nl/view/ir/uuid:cbc4a07f-bd32-4304-889e-3b8006ce90bc/
[2013-12-24 05:57:53 -0500] quattro_: I'm trying to bootstrap a node and it gets stuck right away at "Bootstrapping Chef on 162.243.213.x"
[2013-12-24 06:37:06 -0500] Guest62364: can i have same node in differant hosted chef
[2013-12-24 06:37:32 -0500] coderanger: Guest62364: Not directly, though a same server can run two copies of chef-client using different config files easily enough
[2013-12-24 06:37:44 -0500] coderanger: Guest62364: There is a roughly 100% chance of this being a bad idea though :-D
[2013-12-24 06:38:36 -0500] Guest62364: Ok Thanks
[2013-12-24 06:49:46 -0500] quattro_: is there someway i can debug knife bootstrap [IP]? after creating the new bootstrapped server it just hangs at Bootstrapping Chef on IP...
[2013-12-24 06:59:15 -0500] mr4k: quattro_: you could use -VV option for knife bootstrap obviously
[2013-12-24 07:00:07 -0500] quattro_: yeah i tried that but got nothing, ill post the response
[2013-12-24 07:01:43 -0500] quattro_: mr4k: http://pastebin.com/FSpwzfcN
[2013-12-24 07:16:35 -0500] mr4k: quattro_: you could try to define ssh user and ssh key explicitly in the command line. it seems knife can't log in to your node.
[2013-12-24 08:35:41 -0500] Sc0rp1us: HI all. i have a problem with chef
[2013-12-24 08:35:49 -0500] Sc0rp1us: when i run chef-client i get an error Net::HTTPServerException: 413 "Request Entity Too Large" http://pastebin.com/4DnUBcxf  somebody can help me?
[2013-12-24 08:49:47 -0500] lazypower: Sc0rp1us: looking now 1 sec
[2013-12-24 08:50:33 -0500] lazypower: Sc0rp1us: you need to increase the size limit in NGINX.conf
[2013-12-24 08:52:33 -0500] Sc0rp1us: i i already increased client_max_body_size but it not work :(
[2013-12-24 08:52:44 -0500] lazypower: did you reload?
[2013-12-24 08:52:50 -0500] Sc0rp1us: yes
[2013-12-24 08:54:18 -0500] coderanger: Sc0rp1us: Please pastebin the full traceback
[2013-12-24 08:54:58 -0500] lazypower: coderanger: sorry to step on toes here, but do you work for opscode? you're always in here and always being helpful
[2013-12-24 08:55:07 -0500] coderanger: lazypower: Not anymore
[2013-12-24 08:55:11 -0500] coderanger: But thanks :)
[2013-12-24 08:55:26 -0500] lazypower: :) Anytime my friend
[2013-12-24 08:56:18 -0500] lazypower: I have a question you may be able to point me in the right direction... Are you well versed in scaling rails apps? if so, how did you share the Secret-Token between those scale-out apps in an idempotent manner?
[2013-12-24 08:57:28 -0500] coderanger: lazypower: Depends on how scaled you are talking, I mean at the highest of high ends you would use ZooKeeper or similar Paxos based systems
[2013-12-24 08:57:53 -0500] lazypower: I'm already routed through zookeeper with Juju
[2013-12-24 08:58:45 -0500] Sc0rp1us: i found some solution. if i write Ohai::Config[:disabled_plugins] = ["passwd"] into /etc/chef/client.rb then it solve problem
[2013-12-24 08:58:46 -0500] coderanger: Well then there you go, have your Rails app read from ZK and setup a watch to update the config on node change
[2013-12-24 08:58:56 -0500] Sc0rp1us: but if i try write     "ohai": {       "disabled_plugins": [         "passwd"       ]     },  into node, it don't work
[2013-12-24 09:00:54 -0500] lazypower: but for this example lets say its just handing off between 2 servers, would you still recommend zoo keeper?
[2013-12-24 09:00:55 -0500] coderanger: Sc0rp1us: Do you have the ohai cookbook setup?
[2013-12-24 09:01:21 -0500] coderanger: lazypower: Nah, I would just throw it in Chef (via chef-vault or citadel) and write it into a file on disk
[2013-12-24 09:02:18 -0500] Sc0rp1us: coderanger: no
[2013-12-24 09:03:31 -0500] coderanger: Sc0rp1us: You need to use a cookbook to write that into your chef config, chef-client is the common one
[2013-12-24 09:04:31 -0500] Sc0rp1us: coderanger: thx, i will try =)
[2013-12-24 14:20:58 -0500] itchyouch: Morning
[2013-12-24 14:23:58 -0500] itchyouch: I was curious if anyone had a similar problem as myself where hundreds/thousands of configuration files needed to be built/generated.
[2013-12-24 14:25:20 -0500] itchyouch: And semi-constantly updated.
[2013-12-24 14:26:39 -0500] mattupstate: itchyouch: go on...
[2013-12-24 14:33:18 -0500] itchyouch: In my environment, we run clusters of pxebooted hosts similar to coreOS
[2013-12-24 14:33:41 -0500] itchyouch: Sorry for the slow typing & typos. Im on my phone.
[2013-12-24 14:34:19 -0500] itchyouch: The clusters are configured with a set of config files per host on a central host.
[2013-12-24 14:35:30 -0500] itchyouch: Think almost like a 10-15 line markup-like file defining things like: ip, routes, app, some app properties to load when instantiating the application.
[2013-12-24 14:36:13 -0500] itchyouch: So its a relatively simple thing to edit by hand.
[2013-12-24 14:38:01 -0500] itchyouch: But then the challenge comes into play when there's 40-50 different apps , and the apps are distinctly differently.
[2013-12-24 15:51:43 -0500] marcusmorris: can someone help me understand chef dev workflow? Basically someone I work with says we should push chef-repo changes to git and then ssh to the chef server, pull the repo and run knife command from there. He mentions something about local dev workstations being an extra variable that could make one run different from another.
[2013-12-24 15:51:52 -0500] marcusmorris: is the the way to do it?
[2013-12-24 15:52:08 -0500] marcusmorris: what I have done in the past was just run knife from my local workstation
[2013-12-24 15:52:32 -0500] marcusmorris: changes that are in git, are in git, regardless of where you run knife from
[2013-12-24 15:52:35 -0500] jbz: marcusmorris: I've never run knife commands from the chef server, I don't like doing ops on that machine
[2013-12-24 15:52:44 -0500] marcusmorris: yea that what I thought
[2013-12-24 15:52:48 -0500] jbz: the point of running knife is to use a consistent api for the transaction
[2013-12-24 15:52:49 -0500] senilegenius: marcusmorris:  that's what i used to do, too. then i had 2 sources of truth one in git and one on chef server
[2013-12-24 15:53:12 -0500] jbz: so as long as you use a consistent chef/knife version you should be OK, and it's better (IMO) to leave the server 'clean'
[2013-12-24 15:53:14 -0500] marcusmorris: i think his sysadmin mindset makes him afraid of developers making mistakes
[2013-12-24 15:53:23 -0500] jbz: well
[2013-12-24 15:53:29 -0500] senilegenius: marcusmorris: if you are working with lots of people on many different cookbooks did someone forget to push ? etc.
[2013-12-24 15:53:31 -0500] jbz: I wouldn't want those devs touching the actual server :-P
[2013-12-24 15:53:43 -0500] marcusmorris: jbz: i agree
[2013-12-24 15:54:05 -0500] marcusmorris: senilegenius: someone forgetting to push is a developer mistake, not a workflow mistake
[2013-12-24 15:54:31 -0500] senilegenius: we just have a cron job running on the chef server that pulls down changes from git for the different environments.
[2013-12-24 15:54:41 -0500] senilegenius: marcusmorris:  a mistake nonetheless ;)
[2013-12-24 15:55:06 -0500] marcusmorris: but that mistake would have the same effect whether commands are run from local workstations or a chef server, right?
[2013-12-24 15:55:23 -0500] marcusmorris: if it's not in git, it's not in git
[2013-12-24 15:55:33 -0500] marcusmorris: whether you pull to the server, or push
[2013-12-24 15:56:16 -0500] marcusmorris: in my last role, we had a script that pulled git, ran lint, and then upload all cookbooks
[2013-12-24 15:56:25 -0500] senilegenius: all our env's pull from git. so i have to do a pull request from my fork  to upstreamthen that change makes its way through dev, staging, etc.
[2013-12-24 15:57:27 -0500] marcusmorris: senilegenius: I guess back to my original question, is there a benefit to running everything from the chef server?
[2013-12-24 15:57:36 -0500] marcusmorris: any downside?
[2013-12-24 15:57:42 -0500] marcusmorris: other than dev access to the server
[2013-12-24 15:58:04 -0500] marcusmorris: I guess having to upload to git and tun using knife would add another layer where something could go wrong
[2013-12-24 15:58:12 -0500] marcusmorris: then*
[2013-12-24 15:59:00 -0500] senilegenius: marcusmorris: i get where you're coming from. i think workflows are highly opinionated in any case.
[2013-12-24 15:59:47 -0500] marcusmorris: yea. He's a sysadmin so I can understand his concern, but I think a distrust of developers is a whole other issue
[2013-12-24 16:03:01 -0500] senilegenius: marcusmorris:  no one logs into the chef servers in our env's.  the cron job does a git pull and then a knife upload *blah*. sounds like what he's talking about? so long as no is doing both, making pull requests *and* doing knife uploads from their workstation.
[2013-12-24 16:18:01 -0500] shlant: senilegenius: what's the difference between someone manually pulling and then knife uploading on a chef server vs a workstation?
[2013-12-24 16:18:21 -0500] shlant: because i know we don't have a cron job to do it
[2013-12-24 16:18:38 -0500] shlant: so isn't there just as much place for error?
[2013-12-24 16:19:03 -0500] shlant: also, just os you know, I just cam into this role and they don't use environments, so I'm not sure if this is a result of that
[2013-12-24 16:19:26 -0500] shlant: because if I upload a newer version of a cookbook, prod will use that
[2013-12-24 16:19:30 -0500] shlant: which is baaaaad
[2013-12-24 16:19:33 -0500] jbz: There isn't a difference as far as the contents of the chef server go, other than that it's more likely the server will have the most up to date versions of the cookbooks.
[2013-12-24 16:19:41 -0500] shlant: so maybe they are afraid of that happening?
[2013-12-24 16:19:51 -0500] jbz: well
[2013-12-24 16:19:56 -0500] jbz: one reason to have humans do it
[2013-12-24 16:20:19 -0500] itchyouch: Marcusmorris: Would have to agree.  As always keep is simple stupid.  I'd also add the tenants of reliability/high availability which are isolation, concurrency, failure detection, repeatability, idempotency.
[2013-12-24 16:20:37 -0500] jbz: is that you can put in place a workflow that tries to ensure version metadata gets bumped when you upload a new one - you can freeze cookbooks on the server, requiring a specific override to upload a cookbook with a same version.
[2013-12-24 16:21:22 -0500] shlant: jbz: but without envs specifying cookbook versions, freezing won't mitigate the problem of new cookbook version uploads being used, right?
[2013-12-24 16:21:38 -0500] jbz: shlant: Indeed, yes, if they're all in _default.
[2013-12-24 16:21:53 -0500] shlant: it will mitigate the problem of current versions being changed, but not new versions being used
[2013-12-24 16:22:09 -0500] itchyouch: jbz: You should look into freezing all cookbooks as policy.  Any changes can be made to bumped up version of the cookbook
[2013-12-24 16:22:46 -0500] senilegenius: shlant:  like jbz said. did that answer your question about removing any workstations from doing knife uploads?
[2013-12-24 16:23:03 -0500] jbz: itchyouch: we do.  I was saying that one reason not to have a script autoupload everything is so that frozen versions are effective and ensure a human sees the conflict.
[2013-12-24 16:23:06 -0500] shlant: itchyouch: the workflow I used to do was: pull git, new branch, make changes (increment version), test, upload, +1, merge, knife upload --freeze
[2013-12-24 16:23:24 -0500] itchyouch: jbz: Is it non trivial to migrate the nodes to their own environments?
[2013-12-24 16:24:03 -0500] itchyouch: shlant: That sounds very sane to me
[2013-12-24 16:24:55 -0500] shlant: itchyouch: I agree, but in terms of the current situation, where that workflow doesn't happen, should I be arguing that knife uploads from a local workstation are just as good as from the chef server?
[2013-12-24 16:25:20 -0500] shlant: or just do as they like
[2013-12-24 16:25:28 -0500] shlant: and try and implement better workflow practices?
[2013-12-24 16:25:29 -0500] itchyouch: jbz: Yea, i wouldn't auto upload cookbooks unless there was a very good reason to do so.  Even then, good reasons to auto upload are rare.  Some things don't belong in chef.
[2013-12-24 16:25:44 -0500] jbz: itchyouch:  It's not hard to migrate them, no.  Moving from _default to environments shouldn't be that dangerous if done carefully.
[2013-12-24 16:26:06 -0500] jbz: basically, you should just be able to clone the current _default for each environment, and then migrate the nodes, and nothing should change.
[2013-12-24 16:27:01 -0500] shlant: senilegenius: are you referring to the freeing of cookbooks?
[2013-12-24 16:27:10 -0500] shlant: freezing*
[2013-12-24 16:27:39 -0500] itchyouch: shlant: Sounds more of a social/training/habits issue than a technical one.  I'd say there the autoupload may be slightly more desirable
[2013-12-24 16:28:08 -0500] shlant: itchyouch: but I thought you said auto upload isn't advisable?
[2013-12-24 16:28:09 -0500] senilegenius: shlant: no. i think we just have a  different workflow. we do have env's and freeze our cookbook versions. and we do auto uploads out of git for each env.
[2013-12-24 16:28:11 -0500] jbz: I'd be fine with autoupload to _default, if environments were in use.
[2013-12-24 16:28:37 -0500] itchyouch: shlant: Control over the chef client version, git version, firewall and network between the git server and the autoupload host
[2013-12-24 16:29:19 -0500] senilegenius: shlant:  we're also using berkshelf so that may be allowing for a different workflow also.
[2013-12-24 16:30:18 -0500] shlant: senilegenius: basically I've some into an environment that is still very new to chef so a lot of the best practices and tools (such as berkshelf) aren't being used. Basically I want to try and understand what I should recommend implementing first
[2013-12-24 16:30:38 -0500] shlant: envs? better dev workflow?
[2013-12-24 16:30:51 -0500] senilegenius: shlant: ah
[2013-12-24 16:30:51 -0500] itchyouch: shlant: Depends on the environment and the contributors.  There's failure scenarios in both.  If you have the beat practices, the workstation method is fine.  If the team doesn't have that kind of discipline/training/knowledge/practice then autoupload would be preferable
[2013-12-24 16:31:54 -0500] itchyouch: Because a team thats uploads cookbooks willy nilly, with potentially unstaged changes....
[2013-12-24 16:31:58 -0500] shlant: itchyouch: basically with them bringing me on board, I would be doing most of the chef development, so I would like the change the workflow to best suite my needs, but I don't know if how I do it is the best way
[2013-12-24 16:32:31 -0500] senilegenius: shlant: i agree with itchyouch for the most part. i would recommend implementing env's first but that might touch on the workflow question before you want it to
[2013-12-24 16:32:42 -0500] shlant: tchyouch: but i am fine with doing it how they do until I can influence how it's done
[2013-12-24 16:33:27 -0500] shlant: senilegenius: that's what I was thinking because at least having env would lessen the fear of uploading cookbooks breaking prod
[2013-12-24 16:33:45 -0500] senilegenius: shlant: agreed.
[2013-12-24 16:34:05 -0500] itchyouch: shlant: I'd say I'm new to this as well in a sense.  The problem with workflow is that it's a social problem rather than a technical one.  For most it makes sense to make the changes deliberate and gradually to get people to follow them in an easier manner
[2013-12-24 16:34:35 -0500] itchyouch: Small bites to get to the best practices
[2013-12-24 16:34:58 -0500] shlant: itchyouch: definitely. So after implementing envs, what should I start with in terms of workflow changes?
[2013-12-24 16:35:22 -0500] shlant: auto upload? version freezing?
[2013-12-24 16:35:44 -0500] jbz: I would first make sure you freeze versions
[2013-12-24 16:35:44 -0500] itchyouch: The biggest hurdles will be getting everything synchronized into git if not already.  I'd say freeze b4 env
[2013-12-24 16:35:57 -0500] jbz: that ensures nobody uploads a cookbook change that sneaks into your environments.
[2013-12-24 16:36:10 -0500] shlant: makes sense
[2013-12-24 16:36:37 -0500] shlant: then I could implement the practices of incrementing versions and CHANGELOGs
[2013-12-24 16:36:55 -0500] itchyouch: If u freeze first, then it doesnt change the expectation of the latest cookbook being  deployed
[2013-12-24 16:37:18 -0500] itchyouch: Freezing also doesnt change social behavior that much.  So its an easy change to accept and grasp
[2013-12-24 16:37:27 -0500] shlant: itchyouch: are you referring to the problem of having no envs?
[2013-12-24 16:37:42 -0500] shlant: because freezing doesn't mitigate that, right?
[2013-12-24 16:37:42 -0500] itchyouch: Yep totally. Shlant.
[2013-12-24 16:38:11 -0500] itchyouch: Sorry im on a phone so i dont see a lot of context while typing
[2013-12-24 16:38:12 -0500] shlant: if there is no version specified through envs, then freezing a current version still means prod can be broken by a NEW version
[2013-12-24 16:38:47 -0500] itchyouch: But,  freeze , then version bumps with change log, then environments
[2013-12-24 16:39:20 -0500] itchyouch: shlant: Totally can be broken with a new version.  Depends on the urgency.
[2013-12-24 16:39:27 -0500] shlant: so, push new versions to git, but not to chef server
[2013-12-24 16:39:42 -0500] shlant: unless you want them on prod
[2013-12-24 16:40:04 -0500] itchyouch: shlant: If its urgent to get stable first or urgent to get acceptance to new praxctices
[2013-12-24 16:41:01 -0500] shlant: I'm thinking stability is more desirable to the parties in question
[2013-12-24 16:42:09 -0500] itchyouch: Depends on how much acceptance,respect you wield over the incumbent team.
[2013-12-24 16:42:31 -0500] itchyouch: If youre being brought in, freeze + env isnt a bad combo to bring together
[2013-12-24 16:42:34 -0500] itchyouch: You can freeze everything in a day
[2013-12-24 16:43:20 -0500] itchyouch: Env depends on how many nodes you have to touch
[2013-12-24 16:43:32 -0500] shlant: itchyouch: i think that's the best option. But in between freezing and envs, is there something I can do to prevent the possibility of newer cookbook version uploads breaking prod?
[2013-12-24 16:43:49 -0500] shlant: keep them in branches?
[2013-12-24 16:43:57 -0500] shlant: until envs implements?
[2013-12-24 16:44:26 -0500] itchyouch: shlant: Not sure if this is possible but you could freeze everything in _default
[2013-12-24 16:44:55 -0500] itchyouch: shlant: How good is the team with git
[2013-12-24 16:45:45 -0500] shlant: itchyouch: well the devs in the company use git, but basically the guy I work with directly is a sysadmin and he uses windows. So not sure how familiar he is with it
[2013-12-24 16:46:05 -0500] shlant: I think he's done some developing
[2013-12-24 16:46:53 -0500] shlant: itchyouch: I want to share something with you I just realized. Adding version to _default would definitely be the best way in the interim.. but. there isn't even a _default env
[2013-12-24 16:47:08 -0500] shlant: the env dir is empty less a README haha
[2013-12-24 16:47:35 -0500] itchyouch: Every install has a default
[2013-12-24 16:47:39 -0500] itchyouch: Its just not in gig
[2013-12-24 16:47:45 -0500] jbz: shlant:  _default covers all nodes not in a specific environment, and contains all the latest versions of the cookbooks.
[2013-12-24 16:47:48 -0500] itchyouch: Beb
[2013-12-24 16:47:58 -0500] shlant: git*
[2013-12-24 16:48:01 -0500] shlant: haha
[2013-12-24 16:48:04 -0500] itchyouch: Brb
[2013-12-24 16:48:08 -0500] shlant: so how do I find out wants' _default?
[2013-12-24 16:48:16 -0500] shlant: what's
[2013-12-24 16:48:23 -0500] jbz: shlant: if you don't have environments now
[2013-12-24 16:48:38 -0500] jbz: _default is a dynamic environment that contains the most recent version of all cookbooks.
[2013-12-24 16:49:48 -0500] shlant: so I need to find all the most recent and add them to a _default env?
[2013-12-24 16:49:50 -0500] shlant: in git?
[2013-12-24 16:49:56 -0500] shlant: and then upload to chef
[2013-12-24 16:50:23 -0500] jbz: shlant: no
[2013-12-24 16:50:57 -0500] jbz: _default is just a name for the current set of 'most recent cookbook versions on the server'
[2013-12-24 16:51:10 -0500] jbz: basically, if you're not using environments
[2013-12-24 16:51:15 -0500] itchyouch: I wasnt sure if default was configgurable
[2013-12-24 16:51:15 -0500] jbz: then all your nodes are already in_default.
[2013-12-24 16:51:22 -0500] jbz: no
[2013-12-24 16:51:50 -0500] jbz: shlant: basically, to implement environments, you would implement a *different* environment and move nodes selectively into it
[2013-12-24 16:52:16 -0500] shlant: so I should implement env and then freeze?
[2013-12-24 16:52:23 -0500] shlant: sorry if I'm a little confused
[2013-12-24 16:52:24 -0500] jbz: no, I'd freeze first
[2013-12-24 16:52:41 -0500] jbz: that way, nobody can push changes without overriding or unfreezing, which is the behavior you want
[2013-12-24 16:52:48 -0500] jbz: note however
[2013-12-24 16:53:13 -0500] jbz: that if someone bumps the version and uploads, it will still change the behavior of nodes on the server, since they'll always use the most recent version
[2013-12-24 16:53:30 -0500] jbz: and if they bump the version, freeze won't prevent them uploading.
[2013-12-24 16:54:30 -0500] shlant: so I just need to stop people from uploading newer versions between freezing and implementing envs? there's nothing to reduce that risk?
[2013-12-24 16:54:30 -0500] itchyouch: I agree with jbz.
[2013-12-24 16:54:39 -0500] jbz: shlant: yes.
[2013-12-24 16:54:42 -0500] shlant: ok
[2013-12-24 16:54:44 -0500] shlant: awesome
[2013-12-24 16:54:46 -0500] shlant: makes sense
[2013-12-24 16:54:52 -0500] jbz: although
[2013-12-24 16:54:55 -0500] shlant: thanks so much! I love this channel :)
[2013-12-24 16:54:58 -0500] jbz: it sounds like it won't change your current workflow
[2013-12-24 16:55:02 -0500] jbz: if they *do* upload
[2013-12-24 16:55:22 -0500] jbz: it just means they'll change the production behavior if they do.  Which they would, right now, if they uploaded new versions.
[2013-12-24 16:55:31 -0500] itchyouch: Consider the current practices.  People currently do just upload stuff, so you dont know if a cookbook is in a consistent state with whats in the repo
[2013-12-24 16:55:35 -0500] shlant: yea I think they are aware of the current issue
[2013-12-24 16:55:38 -0500] jbz: most welcome, hope it helps.
[2013-12-24 16:55:47 -0500] itchyouch: Yep.  Jbz and i just said the same thing
[2013-12-24 16:55:50 -0500] shlant: so helpful, thanks all
[2013-12-24 16:56:06 -0500] jbz: Yeah.  The potential disconnect between repo and server states is pretty much what drives 95% of Chef workflow discussions.
[2013-12-24 16:56:45 -0500] shlant: jbz: yea, back to that, should I even bother trying to argue the uploading from her server and uploading from local workstation are essentially the same?
[2013-12-24 16:56:52 -0500] shlant: chef*
[2013-12-24 16:56:57 -0500] itchyouch: I was asking earlier if there was anyone that had a similar problem to mind where they have to build hundreds/thousands of configurations
[2013-12-24 16:57:08 -0500] jbz: They are the same.  But letting people log onto the chef server, IMO, means increased risk.
[2013-12-24 16:57:21 -0500] jbz: they're the same from the POV of the nodes, once the upload is done.
[2013-12-24 16:57:29 -0500] shlant: itchyouch: you said you've done both ways?
[2013-12-24 16:58:07 -0500] jbz: shlant: One reason I prefer using workstations is that it is easier to maintain per-user credentials if you have them manage their keys etc. locally on their workstations - you don't have to manage the various keys etc. on the server itself.
[2013-12-24 16:58:25 -0500] jbz: (the various private keys, at the shell level, that is).
[2013-12-24 16:59:04 -0500] shlant: is there any logic behind thinking pulling and uploading from the chef server is BETTER?
[2013-12-24 16:59:14 -0500] shlant: or is it mostly opinion?
[2013-12-24 16:59:33 -0500] itchyouch: Im not following workstations.  I guess thats a controlled env with chef client and knife installed per user
[2013-12-24 17:00:13 -0500] itchyouch: I rarely ever pull from the chef server and i really only pull to confirm that what i have is in sync with whats on the server
[2013-12-24 17:00:41 -0500] jbz: itchyouch:  Basically, if you make people log into the chef server to do their knife work, you either have to a) manage their individual user accounts and their private chef keys on the server itself, or b) you give up audit knowledge/control of having separate users.
[2013-12-24 17:00:42 -0500] itchyouch: Do you mean for pulling from 1 server to another server?
[2013-12-24 17:01:11 -0500] shlant: I mean pulling from git, then uploading to chef server
[2013-12-24 17:01:42 -0500] shlant: like, you are developing on your workstation anyways, so why not upload to chef server from there
[2013-12-24 17:01:51 -0500] itchyouch: Jbz: yea im considering implementing something to that extent.  Getting a homogenous desktop environment with spork and various plugins installed can make the environments very differeent from each other
[2013-12-24 17:01:53 -0500] shlant: it's the same git repo
[2013-12-24 17:02:49 -0500] itchyouch: Shlant: the trick comes in where there's multiple chef client versions, and different knife plugins and what not installed per user's desktop
[2013-12-24 17:03:10 -0500] jbz: well
[2013-12-24 17:03:37 -0500] jbz: The point of knife is that it doesn't necessarily matter which client version they use as far as uploading goes.
[2013-12-24 17:03:51 -0500] shlant: jbz: that's what I was about to say
[2013-12-24 17:03:56 -0500] jbz: If you can't trust your chef devs to understand how to handle knife and plugins and etc, you have a bigger problem...
[2013-12-24 17:04:00 -0500] itchyouch: Also, different workstations have different network access.  Theoretically, its all the same, but in practice it can be different depending on how the place using chef operates
[2013-12-24 17:04:11 -0500] shlant: the workstations can have all these differences, but it won't effect the way the chef server pushed changes to nodes
[2013-12-24 17:04:29 -0500] itchyouch: For me, we have firewalls to authenticate to with rsa keys to get access to different environments
[2013-12-24 17:04:39 -0500] jbz: True.  But again, if they can't talk to the chef server via http, then you're going to have all kinds of issues no matter what.
[2013-12-24 17:04:46 -0500] jbz: er, https.
[2013-12-24 17:05:12 -0500] shlant: jbz: but that's a workstation setup problem, not a dev workflow problem
[2013-12-24 17:05:16 -0500] jbz: I would hate to try to do chef work in an environment where I couldn't get to the server.  I'm OK with not being able to get to the nodes it manages directly, but the server I pretty much need.
[2013-12-24 17:05:17 -0500] jbz: Yes.
[2013-12-24 17:06:24 -0500] shlant: I think his main fear is uploading chef code to the server that's not committed to git
[2013-12-24 17:06:29 -0500] shlant: which I get
[2013-12-24 17:06:32 -0500] jbz: sure
[2013-12-24 17:06:33 -0500] shlant: but that's a dev problem
[2013-12-24 17:06:33 -0500] jbz: well
[2013-12-24 17:06:42 -0500] itchyouch: Jbz: yea its a tricky balance.  Im in an env where there are non-technical level2 people that need to be able to make changes.  Obviously, i could make all the changes myself, but its easier to let rote/operational tasks be available to mortals
[2013-12-24 17:06:53 -0500] jbz: itchyouch:  If you have non-technical people
[2013-12-24 17:06:54 -0500] shlant: haha mortals
[2013-12-24 17:07:02 -0500] jbz: who need to make changes to, say, config data
[2013-12-24 17:07:09 -0500] jbz: I'd recommend you let them only make changes via git
[2013-12-24 17:07:12 -0500] jbz: not give them server keys
[2013-12-24 17:07:22 -0500] jbz: and then set up an autoupdate to upload their changes.
[2013-12-24 17:08:23 -0500] itchyouch: Jbz: yea there's other workflows in place that we have in place to allow for operational flows to keep on flowing.
[2013-12-24 17:08:59 -0500] itchyouch: If people are curious about my env, i can go more into it
[2013-12-24 17:11:35 -0500] jbz: itchyouch I presume your non-techs don't change cookbook code, they change roles/data bags/environments?
[2013-12-24 17:12:40 -0500] itchyouch: Jbz: they modify files within cookbooks that get deployed.  Its a rare occurrence, so 90% of the time its myself or another technical giy doing them
[2013-12-24 17:13:11 -0500] jbz: Ah.  Yeah, I tend to get really cranky when my job tries to impose workflows where non-techs touch cookbook code.
[2013-12-24 17:13:52 -0500] jbz: If things are done relatively properly, it should be *harder* to break environments by updating data bags and role attributes etc. Changing cookbooks always makes me nervous.
[2013-12-24 17:14:25 -0500] itchyouch: Yea, there's a variety of pros/cons
[2013-12-24 17:14:28 -0500] jbz: I find it worth it to invest time in setting up a system which insulated their changes from the actual chef server.  Usually by using some form of automated testing on their submissions.
[2013-12-24 17:14:42 -0500] jbz: But yeah, I also know the 'not enough tech cycles' well.
[2013-12-24 17:17:36 -0500] itchyouch: Yea, definitely so. We've got an ops center with a mixed bag of abilities and other people to field the calls at midnight and functional teams dedicated to monitoring, day-to-day and operational architectural stuff
[2013-12-24 17:18:12 -0500] jbz: heh jealous.  We have 4 ops including me, and I'm mostly lost to admin crap.
[2013-12-24 17:18:19 -0500] jbz: At current gig, natch.
[2013-12-24 17:18:42 -0500] itchyouch: So while i may field a call here and there from the day-to-day guys here and there, its usually within sane hours and a simple, oh yea run that X process.
[2013-12-24 17:20:18 -0500] itchyouch: jbz: but ive got stupid crap like change control boards, change windows, change freezes, so basic handcuffs for simple tasks
[2013-12-24 17:20:26 -0500] jbz: nice
[2013-12-24 17:21:30 -0500] itchyouch: U mean nice with a sarcasm, right? Hehe.  I have to submit to the powers that be.  "We are updating this cookbook to blah blah blah"
[2013-12-24 17:22:43 -0500] jbz: no
[2013-12-24 17:22:44 -0500] jbz: actually
[2013-12-24 17:22:51 -0500] jbz: I'm jealous of having actual controls lol
[2013-12-24 17:23:04 -0500] jbz: it's a hard balance, just enough control on the process
[2013-12-24 17:23:19 -0500] jbz: but I've spent too much time with Chef setups which were set up without controls
[2013-12-24 17:23:30 -0500] jbz: and then become serious bears to manage
[2013-12-24 17:23:35 -0500] itchyouch: And no one knows wtf we are talking about since we're a large org change control is a rubber stamping factory.
[2013-12-24 17:24:33 -0500] jbz: ahhh
[2013-12-24 17:24:40 -0500] jbz: yep, know that one too. :-)
[2013-12-24 17:25:13 -0500] itchyouch: Network updates a router, but thats 1 of 1500 routers.  Have no insight as to whether that router affects the apps my team is responsible for.
[2013-12-24 17:25:58 -0500] itchyouch: Yep.  It's a balance.  We just err on the side of too much
[2013-12-24 17:57:56 -0500] d4c7: transfer encoding, anyone dealt with this moving from flat file storage to s3?  http://www.getchef.com/blog/2012/09/10/the-debug-files-bookshelf-and-the-broken-transfer-encoding/
[2013-12-24 17:59:51 -0500] yuri1: hey everyone, I'm having trouble trying to use the php cookbook, I get errors from the windows cookbook. Is there any way to run the php cookbook to install php without depending on windows cookbook?
[2013-12-24 18:01:53 -0500] yuri1: for reference, the error I get is: 10.250.170.26 [2013-12-24T00:04:07-05:00] ERROR: uninitialized constant Opscode
[2013-12-24 18:02:46 -0500] Glace: Hi, I have an application cookbook that has windows and linux recipes.. and I need to depends on the IIS cookbook.. When I try to run a linux recipe on a linux machine, when the run starts it tries to compile the IIS cookbook and fail requiring ffi and a windows gem
[2013-12-24 18:02:49 -0500] Glace: Any way around that?
[2013-12-24 18:06:11 -0500] someara: are you on the latest version of iis?
[2013-12-24 18:06:20 -0500] someara: er, the iis cookbook
[2013-12-24 18:06:43 -0500] Glace: I think so.. I just used berkshelf
[2013-12-24 18:07:01 -0500] Glace: I can double check
[2013-12-24 18:07:56 -0500] yuri1: looks like updating to iis 1.6.6 fixed it for me
[2013-12-24 18:07:56 -0500] Glace: I got 1.6.2
[2013-12-24 18:08:11 -0500] Glace: yuri: amazing.. thank you :)
[2013-12-24 18:08:13 -0500] spicy: window move 6
[2013-12-24 18:08:16 -0500] Glace: made my day
[2013-12-24 18:08:19 -0500] spicy: whoops, soory!
[2013-12-24 18:08:32 -0500] spicy: sorry even
[2013-12-24 20:01:53 -0500] justizin: twas my own fault, was setting default[:chef_client][:init_style] = :upstart after some overoptimization ;d
[2013-12-24 20:02:05 -0500] justizin: the first two are fine but the :upstart is not == 'upstart'
[2013-12-24 20:02:15 -0500] justizin: though it's still a cookbook bug, i totally forgot i even had to set that
[2013-12-24 20:02:27 -0500] justizin: working on a PR :)
[2013-12-24 20:17:16 -0500] AntelopeSalad: am i going to be in a world of hurt if i try to use virtualbox directly instead of vagrant for testing my deploys?
[2013-12-24 21:31:11 -0500] coderanger: fnichol: First real build is now in progress https://travis-ci.org/poise/poise/builds/15942192 :)
[2013-12-24 21:38:35 -0500] ignatz: people who don't put changelogs in their cookbooks
