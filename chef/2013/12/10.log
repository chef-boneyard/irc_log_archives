[2013-12-10 00:00:27 -0500] michael_mbp: guys how can I add a user to multiple groups
[2013-12-10 00:01:11 -0500] zillabyte: nekos: Ah.  At my last company I created our own SQL Server cookbook, I found the one Opscode provides inadequate for our use case.  But I don't think we used winrm so I didn't have to deal with this issue :)
[2013-12-10 00:03:42 -0500] michael_mbp: zillabyte: any ideas mate?
[2013-12-10 00:03:47 -0500] zillabyte: nekos: Actually, as a hack, you could try hard linking a directory at the location SQL Server expects :)  SQL Server does respect hard links in my experience.
[2013-12-10 00:03:53 -0500] michael_mbp: seems user do { gid ... }
[2013-12-10 00:03:59 -0500] michael_mbp: so add to one group at a time?
[2013-12-10 00:04:03 -0500] coderanger: michael_mbp: use the group resource
[2013-12-10 00:04:11 -0500] zillabyte: michael_mbp: Yeah, group resource.
[2013-12-10 00:04:14 -0500] coderanger: A unix user can only have one primary GID
[2013-12-10 00:04:19 -0500] michael_mbp: ah
[2013-12-10 00:04:32 -0500] coderanger: beyond that group membership is handled via an orthogonal system in /etc/groups
[2013-12-10 00:04:32 -0500] michael_mbp: coderanger: what's manage_home about?
[2013-12-10 00:04:47 -0500] michael_mbp: -dm delete/modify?
[2013-12-10 00:04:51 -0500] coderanger: michael_mbp: Same as the related option to adduser, it creates the home dir based on /etc/skel
[2013-12-10 00:05:58 -0500] zillabyte: In case the problem comes up again in the future: my permissions issue was related to my having created a user with the same name as my organization.
[2013-12-10 00:06:02 -0500] coderanger: (or is it useradd, I can never remember which is which)
[2013-12-10 00:06:03 -0500] michael_mbp: coderanger: got it thanks
[2013-12-10 00:06:09 -0500] michael_mbp: usermod
[2013-12-10 00:06:28 -0500] michael_mbp: no idea why my migrations aren't running
[2013-12-10 00:06:31 -0500] michael_mbp: no failures either
[2013-12-10 00:06:32 -0500] coderanger: michael_mbp: useradd vs. adduser, one is a wrapper for the other
[2013-12-10 00:06:39 -0500] michael_mbp: ah heh
[2013-12-10 00:07:10 -0500] michael_mbp: I've already got migrate true inside my application {..} block
[2013-12-10 00:07:52 -0500] michael_mbp: it doesn't seem to be picking up on a revision though!
[2013-12-10 00:08:42 -0500] michael_mbp: ok so i've got my deployer all working
[2013-12-10 00:09:01 -0500] michael_mbp: how can I signal chef-client to check for app updates and do a new deploy?
[2013-12-10 00:12:06 -0500] tomduffield: michael_mbp: by default chef-client will only run when manually executed. you can use the chef-client cookbook to have chef-client run as a service or cron (executing every 30 minutes by default).
[2013-12-10 00:26:53 -0500] michael_mbp: tomduffield: ah
[2013-12-10 00:29:47 -0500] michael_mbp: runing via runit would be better no?
[2013-12-10 00:29:59 -0500] michael_mbp: but can I do runit and have it run every 30 mins?
[2013-12-10 00:30:54 -0500] saida: hai all
[2013-12-10 00:31:00 -0500] tomduffield: chef-client cookbook has the option to run it using runit
[2013-12-10 00:31:12 -0500] saida: can someone help me with chef-client run time logging
[2013-12-10 00:32:05 -0500] tomduffield: saida: sure - what would you like help with?
[2013-12-10 00:32:11 -0500] saida: we came across a situation,where when we run the chef package resource,we did not see the proper reasonwhy it failed
[2013-12-10 00:32:37 -0500] saida: but when I have tried to install the RPM manually
[2013-12-10 00:32:43 -0500] saida: I saw an exact error
[2013-12-10 00:32:51 -0500] michael_mbp: tomduffield: I see the init style for unit in the readme
[2013-12-10 00:33:06 -0500] michael_mbp: but there is no mention if the interval setting will be used or not?
[2013-12-10 00:33:22 -0500] tomduffield: michael_mbp: default is 30 minutes. alternative can be set in your /etc/chef/client.rbn
[2013-12-10 00:34:01 -0500] saida: jusrtomduffield: can you help me?
[2013-12-10 00:34:13 -0500] tomduffield: saida: chef-client does its best to grab the relevant info but in certain cases depending on the return code and where the log is being written to (STDOUT/etc) it can't grab it
[2013-12-10 00:34:43 -0500] tomduffield: saida: in those situations you may need to debug outside of Chef (i.e. manually like you were doing)
[2013-12-10 00:35:02 -0500] tomduffield: saida: if this is a long term concern you may want to create a ticket in Chef's JIRA
[2013-12-10 00:35:51 -0500] saida: its a problem as , we have to take additional manual steps to undertsand the issue
[2013-12-10 00:35:58 -0500] saida: thanks tomduffield:
[2013-12-10 00:36:51 -0500] saida: tomduffield: so, we dont have any existing solution for this?
[2013-12-10 00:38:55 -0500] saida: tomduffield: for creating a Jira do we have need to have some access?
[2013-12-10 00:39:08 -0500] tomduffield: saida: you should just need to create an account
[2013-12-10 00:39:27 -0500] tomduffield: saida: http://tickets.opscode.com
[2013-12-10 00:42:52 -0500] saida: tomduffield:Thank you
[2013-12-10 00:44:02 -0500] michael_mbp: tomduffield:
[2013-12-10 00:44:13 -0500] michael_mbp: ok so my chef-client is now running via runit
[2013-12-10 00:44:25 -0500] michael_mbp: if I do 'killall -USR1 chef-client && tail -f -n1000 /var/log/chef/client.log'
[2013-12-10 00:44:30 -0500] michael_mbp: will that trigger a new deploy?
[2013-12-10 00:45:15 -0500] tomduffield: if you are on the server you can just run 'sudo chef-client'
[2013-12-10 00:46:24 -0500] michael_mbp: ok thanks
[2013-12-10 00:48:49 -0500] segv: fastest way to export a bunch of pre-existing roles into ruby dsl?
[2013-12-10 00:54:33 -0500] Skeletor_: So there is node.chef_environment is the one for a file?
[2013-12-10 00:54:43 -0500] Skeletor_: for a role, sorry not file.
[2013-12-10 01:35:09 -0500] Visit0r: hello
[2013-12-10 01:47:18 -0500] Visit0r: someone around?
[2013-12-10 01:58:18 -0500] jidar: is there no init.d scripts for CentOS/rhel/etc
[2013-12-10 03:28:45 -0500] michael_mbp: gah...
[2013-12-10 03:32:11 -0500] jtimberman: jidar: our chef-client cookbook can be used to set up chef to run as a service.
[2013-12-10 03:36:26 -0500] michael_mbp: hey jtimberman
[2013-12-10 03:36:38 -0500] michael_mbp: I've been working on this since we last spoke...no sleep!
[2013-12-10 03:37:07 -0500] michael_mbp: I'm now getting [error] 29859#0: *1 connect() to unix:/opt/apps/demo/deploy/tmp/sockets/demo.sock failed (111: Connection refused) from nginx
[2013-12-10 03:37:10 -0500] michael_mbp: hmm!
[2013-12-10 03:41:53 -0500] coderanger: jtimberman: Real talk time, are we going to end up with github.com/chef-cookbooks? because that seems like all kinds of bad
[2013-12-10 03:42:10 -0500] michael_mbp: coderanger: any ideas?
[2013-12-10 03:43:16 -0500] jtimberman: coderanger: dunno, not my wheelhouse :)
[2013-12-10 03:45:55 -0500] Blizzik: Hi, I am getting http://pastebin.com/MmsqLgDK  an error while build but it don't say why, is it somehow possible to check the error? Thank you
[2013-12-10 03:46:29 -0500] jidar: jtimberman: yep, thanks I am already looking into that
[2013-12-10 03:50:49 -0500] Blizzik: Nah, I will run the code manually and hopefully I will see what happened
[2013-12-10 03:55:45 -0500] michael_mbp: just saved the messed up version and reverted to an older commit
[2013-12-10 03:55:51 -0500] michael_mbp: still rather strange though....
[2013-12-10 04:06:04 -0500] Blizzik: Hmm, I made the command manually as a root and it works! Why it doesn't work through chef? :/
[2013-12-10 04:16:16 -0500] Blizzik: Ok nobody is responding here.. anyway, Somebody know which user makes the commands when I run chef?
[2013-12-10 04:31:24 -0500] michael_mbp: phew
[2013-12-10 04:31:31 -0500] michael_mbp: finally figured it out
[2013-12-10 04:37:19 -0500] michael_mbp: jtimberman: how can I trigger deploys on chef-solo?
[2013-12-10 04:37:39 -0500] michael_mbp: I've got my chef-client set to run via runit as well, and that's working nicely... but of course, there's no chef-server (yet)
[2013-12-10 04:44:47 -0500] michael_mbp: Blizzik: it fair bit of digging to answer that
[2013-12-10 04:45:11 -0500] michael_mbp: I just got my rack stack running after a good 20 hrs of working at it straight!
[2013-12-10 04:45:53 -0500] Blizzik: michael_mbp: a second ago I found it's a root (I made "touch /tmp/chef-je-$(whoami)") as a chef command :D
[2013-12-10 04:48:49 -0500] Blizzik: It's weird.. when I made a build command using chef as root it returns code 1 but when I do it manually (same command) as root I get code 0
[2013-12-10 04:49:04 -0500] Blizzik: *when I run a  build command
[2013-12-10 04:59:26 -0500] Blizzik: michael_mbp: About the chef-solo trigger deploy, isn't something like knife solo cook?
[2013-12-10 04:59:31 -0500] Blizzik: michael_mbp: http://matschaffer.github.io/knife-solo/
[2013-12-10 05:00:16 -0500] Blizzik: michael_mbp: I am using server and only vagrant as my host (I am still in develop phase) so I use vagrant provision to do that :/
[2013-12-10 05:00:31 -0500] Blizzik: *I am using a chef server
[2013-12-10 05:12:52 -0500] toddm: has anyone used the redisio cookbook before? I'm pretty new to chef and I cant work something out but I'm sure it cant be a bug and is probably just my stupidity
[2013-12-10 05:13:45 -0500] n1ko: i cant work out what your issue is, maybe share that with us :)
[2013-12-10 05:14:11 -0500] toddm: well, I've got it all setup, I have a role as per the github page
[2013-12-10 05:14:22 -0500] toddm: it has a run list
[2013-12-10 05:14:24 -0500] toddm: run_list(
[2013-12-10 05:14:25 -0500] toddm: "recipe[redisio]",
[2013-12-10 05:14:25 -0500] toddm: "recipe[redisio::enable]",
[2013-12-10 05:14:26 -0500] toddm: )
[2013-12-10 05:14:48 -0500] toddm: and some attributes
[2013-12-10 05:14:51 -0500] toddm: default_attributes(
[2013-12-10 05:14:51 -0500] toddm: :redisio => {
[2013-12-10 05:14:52 -0500] toddm:   :servers => [
[2013-12-10 05:14:52 -0500] toddm:     {'port' => '6379'}
[2013-12-10 05:14:54 -0500] toddm: ]
[2013-12-10 05:14:56 -0500] toddm: })
[2013-12-10 05:15:07 -0500] toddm: but every time I try to run it it says
[2013-12-10 05:15:21 -0500] toddm: Recipe Compile Error in /tmp/vagrant-chef-1/chef-solo-2/cookbooks/redisio/recipes/enable.rb
[2013-12-10 05:15:33 -0500] toddm: Cannot find a resource matching service[redis6379] (did you define it first?)
[2013-12-10 05:16:01 -0500] toddm: its probably something really simple
[2013-12-10 05:24:01 -0500] toddm: I think I worked it out, I wasn't setting up a resource first.
[2013-12-10 05:24:09 -0500] toddm: Clearly new to this :)
[2013-12-10 08:10:18 -0500] ___stefan: http://docs.opscode.com/essentials_handlers.html, does anyone know how I can find out exactly which cookbooks executed and which failed? I can figure it out from the exception but I would also like to know which cookbooks executes successfully before the failure.
[2013-12-10 08:11:28 -0500] ___stefan: The run_context has a list of all cookbook but not status. The resource_collection has elapsed time but also no status
[2013-12-10 08:16:14 -0500] slicknick: logs
[2013-12-10 08:49:51 -0500] ___stefan: I want to submit the data to a webservice, I would rather not have to parse logs in the chef handler.
[2013-12-10 09:01:28 -0500] slicknick: pardon my lack of experience and allow me to ask a few things, will you?
[2013-12-10 09:01:58 -0500] slicknick: you can figure it out from the exception -- is the exception at the end, after everything has been run through (pass fail whatever) ?
[2013-12-10 09:03:08 -0500] ___stefan: As far as I know the chef run will stop as soon as there is an exception, chef hanlders are however finished so you can collect the info
[2013-12-10 09:03:12 -0500] slicknick: not sure this is relevant but -- is your desire to stop further execution should one fail ?
[2013-12-10 09:03:26 -0500] slicknick: oh
[2013-12-10 09:03:29 -0500] slicknick: :P
[2013-12-10 09:03:40 -0500] ___stefan: no, I want to log exactly what occured on a node. so I want to know which cookbooks rans and what the status was of each one
[2013-12-10 09:03:59 -0500] ___stefan: right now I just get the status of the entire run which is ok but not ideal.
[2013-12-10 09:04:59 -0500] ___stefan: I guess I have to live with what I have for now :)
[2013-12-10 09:05:04 -0500] slicknick: youve heard my suggestion but thats all i got due to my limited knoweldge
[2013-12-10 09:05:18 -0500] slicknick: i still dont get why you cant parse the log.
[2013-12-10 09:05:25 -0500] laurent\: slicknick: exception should tell you what/where the error is, chef logs should tell what's been updated, handler could summarize all those info :)
[2013-12-10 09:05:26 -0500] ___stefan: yes, thanks. I guess if I really need it I can go that route :)
[2013-12-10 09:05:31 -0500] slicknick: you want the data, deal with the source or rewrite your own logging in the recipe
[2013-12-10 09:05:49 -0500] slicknick: ok so tail -f handler
[2013-12-10 09:07:52 -0500] ___stefan: Another question. Does anyone run a large chef setup? How do you deal with access permissions and preventing accidents like assigning the wrong recipe to a run_list on production etc.?
[2013-12-10 09:12:06 -0500] slicknick: access permissions to ... specifically .. what within chef?
[2013-12-10 09:12:14 -0500] slicknick: add recipes to cookbook only?
[2013-12-10 09:36:22 -0500] ___stefan: slicknick: I mean general access to nodes
[2013-12-10 09:36:45 -0500] ___stefan: slicknick: I need to restrict access to the production nodes
[2013-12-10 09:36:54 -0500] slicknick: access is quite broad
[2013-12-10 09:36:55 -0500] slicknick: ssh?
[2013-12-10 09:37:03 -0500] michael_mbp: ufw?
[2013-12-10 09:37:14 -0500] slicknick: ftp?
[2013-12-10 09:37:24 -0500] michael_mbp: or ssh?
[2013-12-10 09:37:31 -0500] ___stefan: anyone with knife authorized on the chef server can change the run list on anynode.
[2013-12-10 09:37:44 -0500] michael_mbp: yup
[2013-12-10 09:38:10 -0500] ___stefan: but more importantly I want to prevent accidents.
[2013-12-10 09:38:41 -0500] slicknick: indeed, but is no key required of the user executing command?
[2013-12-10 09:39:02 -0500] michael_mbp: slicknick: they have keys for using knife yes
[2013-12-10 09:39:12 -0500] slicknick: thats one way, ya?
[2013-12-10 09:39:14 -0500] michael_mbp: you can control those via chef-server
[2013-12-10 09:39:18 -0500] slicknick: not everyone should have root is the first and foremost
[2013-12-10 09:39:19 -0500] ___stefan: the open source version of chef only has two access levels
[2013-12-10 09:39:34 -0500] michael_mbp: yeah it's on or off
[2013-12-10 09:39:36 -0500] slicknick: limit access via sudoers
[2013-12-10 09:39:41 -0500] slicknick: sorry im assuming your linux bases
[2013-12-10 09:39:42 -0500] slicknick: based
[2013-12-10 09:39:53 -0500] michael_mbp: :)
[2013-12-10 09:40:03 -0500] ___stefan: the team developing recipes and testing on the testing env is not he same that is permitted to deploy them on production.
[2013-12-10 09:40:26 -0500] slicknick: great, as it should be
[2013-12-10 09:40:28 -0500] ___stefan: Im just wonder what others are doing with large setups.
[2013-12-10 09:40:59 -0500] slicknick: youre on the right road id say from what youve shared with us
[2013-12-10 09:41:18 -0500] slicknick: dev, test, let them break all the want testing their knives
[2013-12-10 09:41:31 -0500] ___stefan: with the open source chef i have no way to prevent the testing team from accidentaly deploying to a production node
[2013-12-10 09:41:43 -0500] slicknick: stage demo maybe select few or different group
[2013-12-10 09:41:56 -0500] slicknick: prod - ehh ehh
[2013-12-10 09:42:09 -0500] slicknick: why not
[2013-12-10 09:42:21 -0500] slicknick: doesnt make sense to me
[2013-12-10 09:42:46 -0500] ___stefan: open source chef has no access control other than read or admin.
[2013-12-10 09:43:02 -0500] michael_mbp: cant you pass some data for production deploys?
[2013-12-10 09:43:10 -0500] slicknick: i guess 1) i dont know the open source vs other -- sounds like no master in open source?
[2013-12-10 09:43:11 -0500] ___stefan: so I was wondering if there are any big open source deployments out there and what they did to solve this issue
[2013-12-10 09:43:16 -0500] michael_mbp: like empty databag string
[2013-12-10 09:43:25 -0500] michael_mbp: that only the proper team knows to pass?
[2013-12-10 09:43:33 -0500] slicknick: im confused here
[2013-12-10 09:43:47 -0500] slicknick: dont let me slow you two tho
[2013-12-10 09:43:54 -0500] slicknick: ill bbiab after some no so fresh air
[2013-12-10 09:44:46 -0500] ___stefan: michael_mbp: how would I setup chef to only accept a new run_list for a specific node in an env if that where the case?
[2013-12-10 09:50:35 -0500] michael_mbp: I was spitballing for a bit but I think that should work
[2013-12-10 09:50:51 -0500] michael_mbp: you'd want a per node databag for one
[2013-12-10 09:50:59 -0500] michael_mbp: at least on the "ACL" side of things
[2013-12-10 09:51:38 -0500] michael_mbp: and you'd want some hooks in your deployer that checks for a known SHA... which you'd have to store in an encrypted databag
[2013-12-10 09:51:49 -0500] michael_mbp: if that's not there, halt the chef-run?
[2013-12-10 09:52:01 -0500] michael_mbp: or only allow to everything BUT production
[2013-12-10 09:53:05 -0500] ___stefan: michael_mbp: ok, I will look into it, thanks
[2013-12-10 09:55:01 -0500] henk76: guys, i've put a file in the files/default directory and used it in a recipe with: source "file:///truecrypt_7.1a_amd64.tar.gz"
[2013-12-10 09:55:18 -0500] henk76: but it says no suc file or directory upon running
[2013-12-10 10:13:24 -0500] henk76: guys, when i use the remote_file option in a recipe, it makes a file on the node with the correct name, but the file is empty. any ideas?
[2013-12-10 10:14:40 -0500] zaargy: henk76: you want cookbook_file
[2013-12-10 10:15:11 -0500] henk76: i want to upload a tar.gz file from the chef-server and then extract the content.
[2013-12-10 10:15:17 -0500] henk76: but the file is empty
[2013-12-10 10:15:18 -0500] matti: Ohai zaargy
[2013-12-10 10:16:22 -0500] zaargy: oh i see
[2013-12-10 10:16:25 -0500] zaargy: matti: hey
[2013-12-10 10:18:27 -0500] slicknick: your gz is empty? double check its creation
[2013-12-10 10:22:50 -0500] henk76: i've place the original file in files/default/<filename>  and used remote_file "#{Chef::Config[:file_cache_path]}/truecrypt_7.1a_amd64.tar.gz" do
[2013-12-10 10:22:50 -0500] henk76:         source "file:///truecrypt_7.1a_amd64.tar.gz" action :create  end  in the recipe
[2013-12-10 10:23:07 -0500] henk76: where <filename is the samen name and in the recipe
[2013-12-10 10:23:27 -0500] matti: I had not idea that Chef supports file:/// ;p
[2013-12-10 10:23:58 -0500] henk76: well it's in the documentation for remote_file.
[2013-12-10 10:24:33 -0500] henk76: What is the normal way for uploading files from your chef server to a node then?
[2013-12-10 10:25:17 -0500] slicknick: drop one of the /'s
[2013-12-10 10:25:45 -0500] slicknick: sourceRequired. The location (URI) of the source file. This value may also specify HTTP (http://), FTP (ftp://), or local (file://) source file locations. Default value: nil.
[2013-12-10 10:26:15 -0500] henk76: ERROR: "file://truecrypt_7.1a_amd64.tar.gz" is not a valid `source` parameter for remote_file. `source` must be an absolute URI or an array of URIs.
[2013-12-10 10:26:27 -0500] henk76: that's one thing i also did
[2013-12-10 10:29:25 -0500] slicknick: that file doesnt exist man
[2013-12-10 10:31:53 -0500] slicknick: looks like a linux youre using? do a 'locate FILE' and make sure
[2013-12-10 10:33:29 -0500] zaargy: i have never seen/used remote file that way so no idea.
[2013-12-10 10:33:32 -0500] henk76: the file does exist.
[2013-12-10 10:33:41 -0500] zaargy: for distributing files in cookbooks i always use cookbook_file
[2013-12-10 10:33:45 -0500] henk76: when i changed the remote_file to cookbook_file it works
[2013-12-10 10:33:52 -0500] henk76: thanks zaargy ;)
[2013-12-10 10:33:53 -0500] zaargy: althoguh distributing a .tar.gz in a cookbook isn't ideal either really
[2013-12-10 10:33:55 -0500] gregkare: file://truecrypt_7.1a_amd64.tar.gz would mean that file is at the root of your hard drive
[2013-12-10 10:34:23 -0500] henk76: why isn't it? zaargy?
[2013-12-10 10:34:34 -0500] slicknick: err nah
[2013-12-10 10:35:03 -0500] zaargy: henk76: well i prefer to serve artifacts like that from a proper aritfacts repository
[2013-12-10 10:35:26 -0500] slicknick: not sure when i dropped ..
[2013-12-10 10:35:27 -0500] zaargy: which is optmisied for sending big files etc but yeah i guess it's okay if it's just a small thing
[2013-12-10 10:35:47 -0500] henk76: i've just started with chef. so it's all a bit new. ;)
[2013-12-10 10:35:52 -0500] slicknick: last i saw was "that's one thing i also did" then redondos PING time out
[2013-12-10 10:36:02 -0500] zaargy: henk76: what's in the .tar.gz?
[2013-12-10 10:36:11 -0500] gregkare: TrueCrypt isn't a small thing
[2013-12-10 10:36:32 -0500] slicknick: zaargy: missed your suggestion .. mind repeating
[2013-12-10 10:37:14 -0500] henk76: it's the tar.gz of truecrypt which i need to have on the client to encrypt/decrypt a drive attached to the node
[2013-12-10 10:38:11 -0500] maxmanders: Can anyone suggest the most appropriate way to create an SSH key for an existing user, and add the public key to the node's Ohai data?
[2013-12-10 10:39:21 -0500] maxmanders: A lot of what I've found is focussed on creating new users and applying a known public key to authorised_keys for a new user; I need to be able to dynamically create a new key, and use Ohai to add that new public key to other node's to allow node_x to SSH to node_{a,b,c}
[2013-12-10 10:45:10 -0500] henk76: but thanks for your input guys... it really helpe
[2013-12-10 10:45:11 -0500] henk76: d
[2013-12-10 11:27:58 -0500] simon___1: Hello.
[2013-12-10 11:28:26 -0500] simon___1: I need to get content from a file..
[2013-12-10 11:28:36 -0500] simon___1: include_recipe[bind::default]
[2013-12-10 11:28:49 -0500] simon___1: include_recipe[my_recipe::hehe]
[2013-12-10 11:28:57 -0500] simon___1: bind creates a file lets say /tmp/test
[2013-12-10 11:29:05 -0500] simon___1: and in the hehe recipe I need to read the content from it.
[2013-12-10 11:29:23 -0500] simon___1: So I do this in hehe
[2013-12-10 11:29:25 -0500] simon___1: template "/etc/named/named.rndc" do
[2013-12-10 11:29:25 -0500] simon___1:   source "named.rndc.erb"
[2013-12-10 11:29:26 -0500] simon___1:   mode 0644
[2013-12-10 11:29:26 -0500] simon___1:   owner "root"
[2013-12-10 11:29:27 -0500] simon___1:   group "root"
[2013-12-10 11:29:30 -0500] simon___1:   variables ({
[2013-12-10 11:29:32 -0500] simon___1:     :secret_key => (File.open('/etc/rndc.key').read().scan(/"(.*)";/)[0][0] if File.exists? '/etc/rndc.key')
[2013-12-10 11:29:35 -0500] simon___1:   })
[2013-12-10 11:29:38 -0500] simon___1:   notifies :restart, "service[named]", :delayed
[2013-12-10 11:29:40 -0500] simon___1: end
[2013-12-10 11:29:49 -0500] simon___1: On the first chef run the template gets populated with empty data, but if I rerun I get the data I expect in the template.
[2013-12-10 11:29:59 -0500] simon___1: I guess this is because Chef does a dry run before convering,
[2013-12-10 11:30:14 -0500] simon___1: How can I make sure that this works with only one chef run, on a fresh node?
[2013-12-10 11:33:22 -0500] laurent\: it does that it because the ruby code is executed before convergence
[2013-12-10 11:33:31 -0500] simon___1: Ah, thats sneaky.
[2013-12-10 11:35:31 -0500] simon___1: Found this, I guess this will help me
[2013-12-10 11:35:31 -0500] simon___1: https://wiki.opscode.com/display/chef/Configuration+Based+on+Partial+Convergence
[2013-12-10 11:35:38 -0500] simon___1: Thanks for pointing me in the right direction.
[2013-12-10 11:36:18 -0500] laurent\: :) you were quicker than me, I was looking for this url to give it to you :)
[2013-12-10 11:48:57 -0500] workmad3: simon___1: btw, File.read("/etc/rdnc.key")... would be better
[2013-12-10 11:49:02 -0500] workmad3: simon___1: doesn't leave an open file handle
[2013-12-10 11:49:38 -0500] simon___1: Cheers workmad3 :)
[2013-12-10 12:11:41 -0500] simon___1: Hmm, using lambda doesnt seem to work for JIT population of the tamplate..
[2013-12-10 12:11:49 -0500] simon___1:   variables ({
[2013-12-10 12:11:49 -0500] simon___1:     :secret_key => (lambda do File.read('/etc/rndc.key').scan(/"(.*)";/)[0][0] if File.exists? '/etc/rndc.key' end)
[2013-12-10 12:11:52 -0500] simon___1:   })
[2013-12-10 12:12:01 -0500] simon___1: Yields in the file
[2013-12-10 12:12:02 -0500] simon___1: secret "#<Proc:0x00000001a8cb08@/tmp/vagrant-chef-1/chef-solo-1/cookbooks/sl_bind/recipes/rndc.rb:7 (lambda)>";
[2013-12-10 12:12:15 -0500] simon___1: So it looks like .call on the lambda is not called.
[2013-12-10 12:12:17 -0500] simon___1: Any ideas?
[2013-12-10 12:12:39 -0500] simon___1: Putting .call at the end of the lambda doesnt work the first run as it seems to have been evaluated before convergence.
[2013-12-10 12:14:13 -0500] simon___1: Hmm, im on dhef 11.4 I wonder if I need to go up to 11.6..
[2013-12-10 12:14:25 -0500] simon___1: https://github.com/opscode/chef/commit/26e73a83cb5d80103d9d3efc9f403d2f4ca2b3a9
[2013-12-10 12:14:55 -0500] simon___1: Nope, that didnt help
[2013-12-10 12:22:32 -0500] workmad3: simon___1: you'd need to .call the lambda inside the template
[2013-12-10 12:22:44 -0500] simon___1: Aaah, ok.
[2013-12-10 12:22:46 -0500] simon___1: Stupid of me.
[2013-12-10 12:22:47 -0500] simon___1: :)
[2013-12-10 12:23:00 -0500] workmad3: I'm reasonably sure there's a better way nowadays though...
[2013-12-10 12:23:10 -0500] workmad3: with lazy chef attributes
[2013-12-10 13:59:10 -0500] hairyhenderson: morning folks. is anyone around here familiar with the HTTP API?
[2013-12-10 14:00:01 -0500] hairyhenderson: I'm trying to interact with it using the bash script on http://docs.opscode.com/auth.html, and I'm getting weird failures
[2013-12-10 14:01:34 -0500] hairyhenderson: I can run that command as './chef_api_request GET "/search/node"' and it returns me a JSON response as expected with all of the nodes
[2013-12-10 14:02:49 -0500] hairyhenderson: however, when I run the command as './chef_api_request GET "/search/node?q=platform%3Awindows"', I get {"error":["Invalid signature for user or client 'myclientname'"]}
[2013-12-10 14:06:04 -0500] clocKwize: Hi, I'm playing with chef-solo for the first time, I want to use a cookbook thats online ( http://community.opscode.com/cookbooks/sysctl ) but I'm not sure how to do that? do I just download it in to my folder or is there some way to require it in to my project?
[2013-12-10 14:07:05 -0500] workmad3: clocKwize: how are you playing with chef-solo? vagrant?
[2013-12-10 14:07:25 -0500] clocKwize: just an ubuntu instance in aws
[2013-12-10 14:07:38 -0500] clocKwize: roughly following this: http://www.opinionatedprogrammer.com/2011/06/chef-solo-tutorial-managing-a-single-server-with-chef/
[2013-12-10 14:07:45 -0500] workmad3: clocKwize: that doesn't preclude using vagrant ;)
[2013-12-10 14:08:15 -0500] workmad3: clocKwize: but still... in the simplest case, yes download the cookbook into your cookbooks_path
[2013-12-10 14:08:26 -0500] workmad3: clocKwize: and then include it in the run list when running chef-solo
[2013-12-10 14:08:28 -0500] clocKwize: ok, no vagrant
[2013-12-10 14:09:08 -0500] clocKwize: what is cookbooks_path? just my project cookbooks folder?
[2013-12-10 14:09:48 -0500] workmad3: clocKwize: most likely, yes
[2013-12-10 14:10:00 -0500] clocKwize: ta
[2013-12-10 14:10:03 -0500] workmad3: clocKwize: it's one of the config options you can pass to chef-solo
[2013-12-10 14:10:49 -0500] workmad3: clocKwize: personally, I'd recommend using berkshelf + vagrant btw ;) berkshelf is like bundler, but for cookbooks
[2013-12-10 14:11:01 -0500] clocKwize: ok, thats what I'm after I guess
[2013-12-10 14:11:11 -0500] workmad3: clocKwize: and the vagrant-aws plugin makes things really easy
[2013-12-10 14:11:43 -0500] workmad3: clocKwize: there's also a vagrant-berkshelf plugin that integrates with berkshelf
[2013-12-10 14:12:20 -0500] clocKwize: cool
[2013-12-10 14:12:22 -0500] clocKwize: will take a look
[2013-12-10 14:12:29 -0500] workmad3: clocKwize: oh, and the vagrant-omnibus plugin for installing chef :)
[2013-12-10 14:12:36 -0500] hairyhenderson: it's been years since I've idled regularly on IRC... man, I sure don't miss the netsplits :P
[2013-12-10 14:13:25 -0500] clocKwize: workmad3: do you have like a link to a tutorial to wire all these things together? :P
[2013-12-10 14:13:49 -0500] workmad3: clocKwize: no... I was just thinking 'hmm, I should probably write a blog post about putting this lot together' :)
[2013-12-10 14:13:55 -0500] clocKwize: -_-
[2013-12-10 14:14:03 -0500] clocKwize: can you do so in the next 5 mins while I get a coffee?
[2013-12-10 14:14:04 -0500] clocKwize: :D
[2013-12-10 14:14:06 -0500] workmad3: :P
[2013-12-10 14:14:50 -0500] clocKwize: I take that as a yes, brb! :)
[2013-12-10 14:15:22 -0500] workmad3: clocKwize: it's not exactly difficult... install the omnibus, aws and berkshelf plugins for vagrant
[2013-12-10 14:15:36 -0500] clocKwize: getting vagrant now, will do those 3
[2013-12-10 14:15:38 -0500] workmad3: clocKwize: install the berkshelf gem... add cookbooks to your Berksfile
[2013-12-10 14:15:50 -0500] workmad3: and create a Vagrantfile along the lines of the AWS example one
[2013-12-10 14:16:16 -0500] workmad3: annoyingly, I don't have my hands on the Vagrantfile I did this in now either... so I'd need to create one from scratch :(
[2013-12-10 14:16:36 -0500] clocKwize: can I just create an empty folder, gemfile with berkshelf and bundle it, install those plugins in vagrant and go?
[2013-12-10 14:17:01 -0500] workmad3: berks init the folder too
[2013-12-10 14:17:27 -0500] workmad3: hell, I think that creates a Vagrantfile for you :)
[2013-12-10 14:17:42 -0500] clocKwize: ok =]
[2013-12-10 14:18:20 -0500] workmad3: you'll need to add a bit to the vagrantfile to prep it for AWS (such as your AWS keys)... the README for the plugin has details, iirc :)
[2013-12-10 14:18:27 -0500] clocKwize: sure
[2013-12-10 14:19:56 -0500] clocKwize: damn, keep forgetting I'm connected to a vpn, downloads are slow as hell
[2013-12-10 14:21:31 -0500] workmad3: :(
[2013-12-10 14:21:53 -0500] clocKwize: when I say keep forgetting, I remember, but am half way through a slow download, so can't disconnect, then I forget again
[2013-12-10 14:21:58 -0500] clocKwize: until another slow download
[2013-12-10 14:22:23 -0500] workmad3: yeah, sounds familiar
[2013-12-10 14:22:34 -0500] clocKwize: :)
[2013-12-10 14:22:35 -0500] clocKwize: done
[2013-12-10 14:23:08 -0500] hairyhenderson: ok, just in case nobody saw my question due to netsplit earlier:
[2013-12-10 14:23:10 -0500] hairyhenderson: I'm trying to interact with OSS chef-server's HTTP API, using the bash script on http://docs.opscode.com/auth.html, and I'm getting weird failures.
[2013-12-10 14:23:17 -0500] hairyhenderson: I can run that script as './chef_api_request GET "/search/node"' and it returns
[2013-12-10 14:23:17 -0500] hairyhenderson: a JSON response as expected with all the nodes. However, when I change the URL t
[2013-12-10 14:23:17 -0500] hairyhenderson: o "/search/node?q=platform%253Awindows", I get {"error":["INvalid signature for user or client 'myclientname'"]}
[2013-12-10 14:23:34 -0500] hairyhenderson: wow, that didn't paste as expected... oh well
[2013-12-10 14:25:48 -0500] workmad3: hairyhenderson: try './chef_api_request GET "/search/node" "q=platform%253Awindows"
[2013-12-10 14:26:06 -0500] hairyhenderson: workmad3: ok
[2013-12-10 14:26:37 -0500] hairyhenderson: workmad3: no dice
[2013-12-10 14:26:42 -0500] hairyhenderson: workmad3: same error
[2013-12-10 14:28:35 -0500] workmad3: hairyhenderson: hmm, wasn't sure that would work after reading the script
[2013-12-10 14:28:55 -0500] workmad3: hairyhenderson: my suspicion is that the query string shouldn't be included in the hashed path... but that script does so...
[2013-12-10 14:29:14 -0500] workmad3: hairyhenderson: which most likely means that the script can't do what you want :(
[2013-12-10 14:29:22 -0500] hairyhenderson: workmad3: ah
[2013-12-10 14:30:04 -0500] hairyhenderson: workmad3: well, to be honest I don't want to use the script at all... I want to use the Node.js module (chef-node - https://github.com/sgentle/chef-node)... it's having the same issues though
[2013-12-10 14:30:19 -0500] hairyhenderson: workmad3: and it seems to be hashing the query string too. I'll try to modify it to get it not to hash the query
[2013-12-10 14:31:01 -0500] dark_dr4g0n: hi. i get this error with chef: Timeout connecting to https://chef-server/environments/shopotam-stage/cookbook_versions, retry 1/5
[2013-12-10 14:31:17 -0500] hairyhenderson: workmad3: the docs are really ambiguous about the header - I wouldn't have had the foggiest idea how to implement it if it weren't for the looking at code :|
[2013-12-10 14:31:24 -0500] dark_dr4g0n: if i delete from run_list cookbook with many depends, all seems ok
[2013-12-10 14:31:41 -0500] dark_dr4g0n: what can i do with that?
[2013-12-10 14:33:14 -0500] hairyhenderson: workmad3: ok, hashing just the path (without the query string) yields the same error
[2013-12-10 14:33:41 -0500] hairyhenderson: workmad3: do you have any idea where the relevant code from knife is? I've been looking on github to no avail...
[2013-12-10 14:40:09 -0500] workmad3: hairyhenderson: https://github.com/opscode/mixlib-authentication/blob/master/lib/mixlib/authentication/signedheaderauth.rb that's what does the signing inside knife
[2013-12-10 14:40:20 -0500] hairyhenderson: ah ok
[2013-12-10 14:41:47 -0500] hairyhenderson: I had also tried doing a POST instead with the query in the body - the docs seem to imply that this is possible, but that yields some other error
[2013-12-10 14:43:35 -0500] clocKwize: workmad3: what am I meant to specify for the box? I just want the default aws image right?
[2013-12-10 14:43:40 -0500] clocKwize: like the ami
[2013-12-10 14:44:23 -0500] hairyhenderson: oh hrm
[2013-12-10 14:44:33 -0500] hairyhenderson: I see this: Mixlib::Authentication::Log.debug "String to sign: '#{string_to_sign}'\nHeader hash: #{header_hash.inspect}"
[2013-12-10 14:44:44 -0500] hairyhenderson: how do I turn on debug logging?
[2013-12-10 14:45:10 -0500] workmad3: clocKwize: look @ the example vagrantfile in the README
[2013-12-10 14:45:15 -0500] hairyhenderson: oh nm... I may have asked too soon :P
[2013-12-10 14:45:32 -0500] workmad3: clocKwize: you just need a dummy box with the AWS plugin... the AMI image to use is specified in a provider-specific setting
[2013-12-10 14:45:48 -0500] clocKwize: yeah, they specify dummy, but then it fails can't find it :p
[2013-12-10 14:45:52 -0500] workmad3: clocKwize: that said, if you specify a valid box, then your vagrantfile can be used to boot up locally with virtualbox
[2013-12-10 14:46:25 -0500] hairyhenderson: maybe not
[2013-12-10 14:46:42 -0500] hairyhenderson: workmad3: any idea how to enable debug logging for Mixlib::Authentication?
[2013-12-10 14:46:44 -0500] workmad3: clocKwize: vagrant box add dummy https://github.com/mitchellh/vagrant-aws/raw/master/dummy.box
[2013-12-10 14:46:50 -0500] workmad3: clocKwize: from the readme ;)
[2013-12-10 14:46:58 -0500] clocKwize: are we looking at the same readme
[2013-12-10 14:46:59 -0500] clocKwize: :p
[2013-12-10 14:47:05 -0500] clocKwize: oh
[2013-12-10 14:47:08 -0500] clocKwize: yes, we are
[2013-12-10 14:47:10 -0500] workmad3: :)
[2013-12-10 14:47:14 -0500] clocKwize: lol :)
[2013-12-10 14:47:22 -0500] clocKwize: I'm just reading with my ear
[2013-12-10 14:47:53 -0500] workmad3: hairyhenderson: afraid not, sorry
[2013-12-10 14:48:20 -0500] hairyhenderson: workmad3: ok, no worries... I'll try to track it down
[2013-12-10 14:49:47 -0500] clocKwize: wtf
[2013-12-10 14:49:58 -0500] clocKwize: everything in my directory just got deleted some how
[2013-12-10 14:50:03 -0500] clocKwize: all it contains is a Berksfile.lock
[2013-12-10 14:50:09 -0500] workmad3: ? :/
[2013-12-10 14:51:51 -0500] workmad3: clocKwize: so even your Vagrantfile and the like vanished?
[2013-12-10 14:51:52 -0500] workmad3: that's odd
[2013-12-10 14:52:06 -0500] clocKwize: yep
[2013-12-10 14:55:22 -0500] clayb: I'm having a strange issue with render in a template. It completely replaces the template contents it's in. Is there some way to compose templates (e.g. have one template rendered inside another)?
[2013-12-10 14:55:32 -0500] clayb: I'm running Chef 11.6.2
[2013-12-10 14:56:20 -0500] clayb: I've got a fragment like:
[2013-12-10 14:56:37 -0500] clayb: <value>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider</value>
[2013-12-10 14:56:37 -0500] clayb:   </property>
[2013-12-10 14:56:37 -0500] clayb:   <%= render "hdp_hdfs-site_HA.xml.erb" :variables => {:zk_hosts => zk_hosts, :mounts => mounts} %>
[2013-12-10 14:56:37 -0500] clayb:   <property>
[2013-12-10 14:56:38 -0500] clayb:     <name>dfs.webhdfs.enabled</name>
[2013-12-10 14:56:58 -0500] workmad3: clayb: not with the default template resource, no
[2013-12-10 14:57:59 -0500] clayb: Workmad3 Ah darn! Thanks for confirming I'm not going crazy at least.
[2013-12-10 14:58:52 -0500] clocKwize: workmad3: it didn't delete everything this time, which is good
[2013-12-10 14:59:00 -0500] workmad3: woo!
[2013-12-10 14:59:49 -0500] clocKwize: stuck on waiting for ssh to come up i tihnk
[2013-12-10 14:59:55 -0500] clocKwize: I see the instance
[2013-12-10 15:00:19 -0500] workmad3: yeah, that can take a short time
[2013-12-10 15:00:41 -0500] clocKwize: ok ;p
[2013-12-10 15:00:58 -0500] clocKwize: instance is running for a few mins now
[2013-12-10 15:01:27 -0500] workmad3: you specified the keypair to use?
[2013-12-10 15:01:50 -0500] workmad3: and pointed vagrant at it as the SSH key?
[2013-12-10 15:05:04 -0500] maxmanders: All the docs I can find talk about adding custom Ohai plugins to the Ohai cookbook; that feels kinda nasty, can I add plugins to a cookbook path and have them loaded?
[2013-12-10 15:06:53 -0500] clocKwize: workmad3: maybe not
[2013-12-10 15:07:55 -0500] clocKwize: what is the name of the keypair? I have they access key and secret, didn't know it had a name?
[2013-12-10 15:08:24 -0500] rracterr: Someone mentioned that chef-client 11.8.0+ has a semaphore that can be used to cause a run to trigger, anyone know how to do that?
[2013-12-10 15:08:36 -0500] workmad3: clocKwize: didn't you create a keypair for SSHing in with when you created your first instance?
[2013-12-10 15:09:04 -0500] clocKwize: yes, I've specified the .pem file in private_key_path
[2013-12-10 15:09:07 -0500] maxmanders: I can see that some code on Github stores then in plugins/ in the same path as cookbooks/ but it's not clear how you get those plugins to the Chef Server.
[2013-12-10 15:09:19 -0500] workmad3: clocKwize: ok, and what did you call that when you created it in AWS?
[2013-12-10 15:09:25 -0500] clocKwize: no idea, not my server
[2013-12-10 15:09:28 -0500] clocKwize: not my aws
[2013-12-10 15:09:43 -0500] workmad3: ah... hmm
[2013-12-10 15:10:15 -0500] workmad3: someone else gave you their keypair.pem?
[2013-12-10 15:10:34 -0500] clocKwize: Think I've got it now
[2013-12-10 15:10:38 -0500] clocKwize: just found it in AWS
[2013-12-10 15:10:52 -0500] workmad3: ok :)
[2013-12-10 15:11:02 -0500] rracterr: I need a way to trigger a chef-client service on windows to do a run
[2013-12-10 15:12:47 -0500] clocKwize: now I'm getting: MissingParameter => The request must contain the parameter InstanceId
[2013-12-10 15:13:09 -0500] clocKwize: :(
[2013-12-10 15:16:54 -0500] clocKwize: think I've got it, deleted .vagrant and got the right ami id for eu-west-1
[2013-12-10 15:20:38 -0500] rracterr: You guys still in a company meeting today?
[2013-12-10 15:21:48 -0500] clocKwize: workmad3: Its got the right key now, I can see it in EC2 but its not letting me connect :/
[2013-12-10 15:22:06 -0500] clocKwize: connection just times out, but the SG is default which is fully open
[2013-12-10 15:22:30 -0500] workmad3: so you can SSH into the instance manually?
[2013-12-10 15:22:36 -0500] knuckolls: clocKwize: can you telnet <ip> 22 to the instance?
[2013-12-10 15:22:42 -0500] knuckolls: just to see if the tcp port is actually open
[2013-12-10 15:22:46 -0500] clocKwize: nope neither
[2013-12-10 15:23:00 -0500] workmad3: right, so your assumption that the default security group is open seems flawed ;)
[2013-12-10 15:23:05 -0500] knuckolls: i concur
[2013-12-10 15:23:19 -0500] workmad3: either that, or your assumption that your instance is being added to that security group is...
[2013-12-10 15:23:42 -0500] clocKwize: oh, its open, but only to a certain source ;p
[2013-12-10 15:23:58 -0500] workmad3: ah :)
[2013-12-10 15:28:08 -0500] clocKwize: next... Error: Warning: Identity file ["/Users/clockwize/.ssh/staging.pem"] not accessible: No such file or directory.
[2013-12-10 15:28:22 -0500] clocKwize: but its clearly there
[2013-12-10 15:28:44 -0500] knuckolls: chmod 0600 staging.pem perhaps
[2013-12-10 15:29:01 -0500] knuckolls: sometimes it gets all mad if the permissions aren't just right
[2013-12-10 15:29:03 -0500] clocKwize: its already got the correct perms, I use the key for other instances
[2013-12-10 15:29:10 -0500] knuckolls: oh well
[2013-12-10 15:29:45 -0500] workmad3: clocKwize: hmm... how did you assign the keypair name?
[2013-12-10 15:30:01 -0500] workmad3: clocKwize: because it looks like you've assigned an array where the plugin expects a string...
[2013-12-10 15:30:26 -0500] clocKwize: override.ssh.private_key_path = "~/.ssh/staging.pem"
[2013-12-10 15:30:32 -0500] clocKwize: inside :aws provider
[2013-12-10 15:30:49 -0500] workmad3: hmm, ok
[2013-12-10 15:31:01 -0500] clocKwize: =[
[2013-12-10 15:36:09 -0500] workmad3: clocKwize: sorry :(
[2013-12-10 15:36:14 -0500] clocKwize: not your fault haha
[2013-12-10 15:36:33 -0500] clocKwize: your right it does appear to be getting an array when it expects a string
[2013-12-10 15:37:55 -0500] workmad3: I suggested the tools
[2013-12-10 15:38:09 -0500] clocKwize: I installed vagrant from the website downloaded the osx installer - that correct?
[2013-12-10 15:38:20 -0500] clocKwize: I've got 1.4.0
[2013-12-10 15:39:00 -0500] workmad3: yeah, that's the only way to install nowadays
[2013-12-10 15:39:13 -0500] clocKwize: ok, is that the version you run?
[2013-12-10 15:39:35 -0500] workmad3: not used 1.4, no... I've not used past 1.2
[2013-12-10 15:39:43 -0500] clocKwize: ok
[2013-12-10 15:41:28 -0500] knuckolls: clocKwize: 1.4.0 literally came out yesterday
[2013-12-10 15:41:30 -0500] knuckolls: or the day before
[2013-12-10 15:41:34 -0500] clocKwize: oh
[2013-12-10 15:41:35 -0500] knuckolls: there might be some rough edges
[2013-12-10 15:42:01 -0500] knuckolls: i'd look into using whatever the berkshelf-vagrant plugin suggests
[2013-12-10 15:42:12 -0500] knuckolls: or whatever version of vagrant was around during the last tagged release of that plugin
[2013-12-10 15:45:47 -0500] clocKwize: ok, well, I'm dropping that for now -_- will try again another day
[2013-12-10 15:46:56 -0500] clocKwize: I've added a cookbook called sysctl, http://community.opscode.com/cookbooks/sysctl - how can I include it in my recipe so it finds the sysctl_param method?
[2013-12-10 15:48:37 -0500] gleam: just put depends "sysctl" in metadata.rb
[2013-12-10 15:49:08 -0500] gleam: and probablya lso include_recipe "sysctl"
[2013-12-10 15:51:50 -0500] clocKwize: yay
[2013-12-10 15:51:51 -0500] clocKwize: thanks
[2013-12-10 15:54:36 -0500] hairyhenderson: workmad3: hey, just FYI I got this API stuff working - the big issue is the hashed path must not have the query string in it... the bash script has a bug in it
[2013-12-10 15:55:08 -0500] workmad3: hairyhenderson: ah, it was that, cool :)
[2013-12-10 15:55:28 -0500] hairyhenderson: workmad3: the line endpoint=${$2%%\?*} needs to read endpoint=${2%%\?*} instead
[2013-12-10 15:55:49 -0500] hairyhenderson: workmad3: I guess the script was only tested with hosted chef :)
[2013-12-10 15:56:03 -0500] hairyhenderson: I'll send an e-mail to docs@opscode.com to get them to fix it
[2013-12-10 15:56:06 -0500] workmad3: hairyhenderson: or not tested with query string filters :)
[2013-12-10 15:57:07 -0500] allaire: Hi, I keep hitting  `raise_if_conflicts': can't activate json-1.8.0, already activated json-1.7.7 (Gem::LoadError) when installing chef under Mac in rbenv, I try to install it system wide. It works when it's installed under Bundler
[2013-12-10 15:57:09 -0500] allaire: any ideas?
[2013-12-10 15:57:23 -0500] hairyhenderson: workmad3: that too :)
[2013-12-10 15:57:40 -0500] hairyhenderson: workmad3: well, actually no - bash blows up on me regardless
[2013-12-10 15:57:56 -0500] hairyhenderson: workmad3: I didn't understand the line so I just replaced with endpoint=$2 - that should've been my first clue :P
[2013-12-10 15:59:02 -0500] workmad3: hairyhenderson: ah :)
[2013-12-10 15:59:03 -0500] gregkare: allaire: Bundler was made to avoid this kind of dependency hell, and the json gem is especially problematic because it doesn't conform to SemVer at all...
[2013-12-10 15:59:22 -0500] allaire: gregkare: gotcha, so it's kinda impossible ot install it system wide :)
[2013-12-10 15:59:23 -0500] gregkare: You can try uninstall all the json gems you have installed globally
[2013-12-10 15:59:36 -0500] gregkare: You'll probably break something else though :)
[2013-12-10 15:59:53 -0500] gregkare: It's better to use the omnibus installer if you don't want to use Bundler
[2013-12-10 16:00:07 -0500] gregkare: It ships its own Ruby to avoid dependency problems
[2013-12-10 16:00:13 -0500] allaire: if you use bundler, you always use knife a a chef-repo I suppose?
[2013-12-10 16:00:20 -0500] allaire: in a*
[2013-12-10 16:00:47 -0500] gregkare: Yup, I use bundler with binstubs
[2013-12-10 16:01:00 -0500] gregkare: So I'm always in the right repo and I use ./bin/knife
[2013-12-10 16:02:13 -0500] knuckolls: allaire: i just do this alias knife="BUNDLE_GEMFILE=~/path/to/Gemfile bundle exec knife"
[2013-12-10 16:02:19 -0500] knuckolls: so knife just works everywhere
[2013-12-10 16:03:38 -0500] allaire: thx guys
[2013-12-10 16:06:07 -0500] allaire: knuckolls: thx for that, it works super well!
[2013-12-10 16:06:21 -0500] allaire: I simply added my Gemfile to ~/.chef/Gemfile
[2013-12-10 16:11:19 -0500] legoklods: I have these two lines in a recipe: "backends = search(:node, "<condition>")" and "backends.sort!{|x, y| x[:fqdn] <=> y[:fqdn]}", but I get "comparison of Chef::Node with Chef::Node failed" with an indication that it was the sort line that caused the error, but I thought that would sort by fqdn's - what is wrong?
[2013-12-10 16:13:31 -0500] knuckolls: legoklods: i'd run those two lines in chef-shell to play around with munging the data into the format that works
[2013-12-10 16:13:37 -0500] knuckolls: chef-shell -z actually
[2013-12-10 16:14:28 -0500] knuckolls: i'd expect that x[:fqdn] to return a string or something sortable, but you can prove it in the chef-shell repl
[2013-12-10 16:34:42 -0500] sonne: greetings!
[2013-12-10 16:35:12 -0500] legoklods: knuckolls: When I run those lines in `chef-shell -z` I get the result I expect, i.e. a list of nodes in random order from search and a sorted list of the same nodes from sort
[2013-12-10 16:35:14 -0500] sonne: is there a reason why a @variable that i declared on top of a recipe is evaluated as nil when i try to access it in a resource?
[2013-12-10 16:35:52 -0500] knuckolls: legoklods: wild. are the versions of chef the same on the server and via chef-shell?
[2013-12-10 16:35:54 -0500] knuckolls: that's all i've got.
[2013-12-10 16:38:45 -0500] legoklods: knuckolls: 11.4.4 on both
[2013-12-10 16:38:51 -0500] knuckolls: :(
[2013-12-10 16:39:34 -0500] tomduffield: sonne: @variable is an instance variable and is only available to the object self.
[2013-12-10 16:39:49 -0500] sonne: tomduffield, so i'm better off using globals?
[2013-12-10 16:39:58 -0500] sonne: or is there a better alternative?
[2013-12-10 16:40:31 -0500] tomduffield: sonne: just leave off the @ and you'll be fine
[2013-12-10 16:40:55 -0500] sonne: ah ok
[2013-12-10 16:40:57 -0500] sonne: cheers :)
[2013-12-10 16:43:53 -0500] tomduffield: legokloads: try backends.sort_by { |n| n[:fqdn] }?
[2013-12-10 16:44:05 -0500] tomduffield: except leave off that ?
[2013-12-10 16:45:47 -0500] chefuser111: good morning. at this site: https://github.com/nickola/chef-ssh-keys the readme.MD file says "Node configuration example to create authorized_keys for user root from data bag user user1:" but does not explain where to put this info at.
[2013-12-10 16:46:08 -0500] chefuser111: where do i apply such things as this "node configuration"?
[2013-12-10 16:47:19 -0500] tomduffield: chefuser111: based on the context iI would assume that you want to create a node attribute node['ssh_keys']['root'] = 'user1'
[2013-12-10 16:47:32 -0500] tomduffield: i.e. node configuration ~~ node attributes
[2013-12-10 16:47:56 -0500] tomduffield: so you can set them in your cookbook attributes file, a role, an environment or against the node object directly
[2013-12-10 16:49:23 -0500] chefuser111: tomduffield: so i would go to 'nodes', 'web1', 'edit', and i see 'attributes' with a little '+json' item listed in it. From there, where do i go to 'add' this 'node attribute'?
[2013-12-10 16:50:06 -0500] chefuser111: tomduffield: this is something NOT listed in the mountains of documentation or getting started that i have read.
[2013-12-10 16:51:42 -0500] tomduffield: chefuser111: essentially the documentation is asking you to modify the node object, which you can find documentation about here: http://docs.opscode.com/essentials_node_object.html
[2013-12-10 16:54:09 -0500] chefuser111: tomduffield: ive read that. you know whats missing from the documentation? How to use the GUI included with chef to do this. As I said, I have the node opened, there is a little editor here that has tabs called 'search', 'editor', 'source.' How do I add this "node['ssh_keys']['root'] = 'user1'" to this area and apply it to the node?
[2013-12-10 16:55:44 -0500] gregkare: It's much more convenient to keep your code under version control instead of using the web interface
[2013-12-10 16:55:54 -0500] gregkare: If you don't like code you shouldn't be using Chef anyway
[2013-12-10 16:56:03 -0500] workmad3: bleh, that attribute editor in the web UI is awful :(
[2013-12-10 16:56:19 -0500] tomduffield: chefuser111: http://docs.opscode.com/chef/manage_server_open_source.html#id16
[2013-12-10 16:56:43 -0500] tomduffield: chefuser111: that will show you how to edit node objects on the Open Source Chef server.
[2013-12-10 16:57:39 -0500] tomduffield: chefuser111: but gergkare is right, I would manage your node attributes using source controlled methods like roles, environments or cookbooks
[2013-12-10 16:58:03 -0500] basic`: is there a recipe that keeps all chef-client installations up to date?
[2013-12-10 16:58:33 -0500] basic`: i could write one... but it seems like that must exist in a cookbook somewhere
[2013-12-10 16:58:34 -0500] basic`: especially without the yum/apt repo
[2013-12-10 16:58:36 -0500] chefuser111: tomduffield: this is very good information. thank you.
[2013-12-10 16:59:09 -0500] tomduffield: basic`: https://github.com/hw-cookbooks/omnibus_updater
[2013-12-10 16:59:34 -0500] basic`: tomduffield: thanks!
[2013-12-10 16:59:47 -0500] tomduffield: you're welcome chefuser111 and basic`
[2013-12-10 17:01:28 -0500] chefuser111: tomduffield: I just want to see this work. Thats why i am applying to a test node. So, if i take that sample usage from "https://github.com/nickola/chef-ssh-keys" and put it into the 'source' tab of the node, and press 'save' it should work?
[2013-12-10 17:02:56 -0500] tomduffield: chefuser111: under the source tab, you want to put the ssh_keys level only, so {"ssh_keys": {"root": ["user1","user2"]}}
[2013-12-10 17:03:24 -0500] tomduffield: chefuser111: doing something like that _should_ theoretically work
[2013-12-10 17:06:09 -0500] chefuser111: tomduffield: if i put together a screenshot list of what i have and what im doing, would you be kind enough to point out where i am going wrong?
[2013-12-10 17:06:24 -0500] tomduffield: chefuser11: I will certainly try :)
[2013-12-10 17:06:47 -0500] chefuser111: tomduffield: thanks so much. im at my wits end!
[2013-12-10 17:07:20 -0500] legoklods: tomduffield: That gives me "comparison of String with nil failed" instead
[2013-12-10 17:10:01 -0500] tomduffield: legoklods: To me that sounds like you have one node with a nil FQDN
[2013-12-10 17:10:14 -0500] tomduffield: but without your data set I can't confirm
[2013-12-10 17:13:54 -0500] allaire: anyone use rails? Do you manage database.yml and nginx config in capistrano or in chef?
[2013-12-10 17:14:16 -0500] allaire: I currently manage it in cap, and only use chef to create the database and user, wondering what others are doing
[2013-12-10 17:15:08 -0500] geggam: is there a way to make the initial bootstrap not go to chef to download the script ?
[2013-12-10 17:16:12 -0500] tomduffield: geggam: modify the bootstrap template - http://docs.opscode.com/knife_bootstrap.html#custom-templates
[2013-12-10 17:16:29 -0500] geggam: ty tomduffield
[2013-12-10 17:20:14 -0500] gchristensen: using test-kitchen's digitalocean driver, is there a way to not useSSH keys, and instead use the root password which is generated by DO?
[2013-12-10 17:20:29 -0500] chefuser111: tomduffield: please see here http://imgur.com/a/PYQfj
[2013-12-10 17:20:36 -0500] chefuser111: tomduffield: please see here http://imgur.com/a/PYQfj
[2013-12-10 17:20:41 -0500] chefuser111: woops. sorry.
[2013-12-10 17:23:51 -0500] tomduffield: chefuser111: you need to create a data bag item inside the databag users that you want to associate with your root user. i.e. user1
[2013-12-10 17:24:08 -0500] chefuser111: already there.
[2013-12-10 17:24:19 -0500] tomduffield: chefuser111: then in your source > json box you would have root: <name of dbitem>
[2013-12-10 17:24:49 -0500] geggam: good recipes bad order
[2013-12-10 17:26:33 -0500] chefuser111: tomduffield: i already have a databag called users, with an item called root.
[2013-12-10 17:27:06 -0500] tomduffield: then your json should be {"ssh_keys":{"root":"root"}}
[2013-12-10 17:27:16 -0500] tomduffield: also, any particular reason you're not using https://github.com/opscode-cookbooks/users?
[2013-12-10 17:28:40 -0500] chefuser111: tomduffield: seemed even more convoluted than this one.
[2013-12-10 17:29:38 -0500] tomduffield: chefuser111: fair enough. Its a bit more powerful in terms of what it can do (i.e. removing users). I just wanted to make sure you were aware of it.
[2013-12-10 17:30:20 -0500] chefuser111: tomduffield: thanks for that. unfortunately, when i put your JSON into the source and press save, it just disappears.
[2013-12-10 17:30:46 -0500] chefuser111: tomduffield: same as in the imgur example i gave.
[2013-12-10 17:31:44 -0500] tomduffield: try this: {"normal": {"ssh_keys": {"root":"root"}}}
[2013-12-10 17:32:30 -0500] chefuser111: tomduffield: should i be leaving the default {tag} stuff that is there?
[2013-12-10 17:32:42 -0500] tomduffield: chefuser111: not necessary in this case
[2013-12-10 17:33:19 -0500] chefuser111: tomduffield
[2013-12-10 17:33:24 -0500] chefuser111: tomduffield: disappears
[2013-12-10 17:34:09 -0500] tomduffield: chefuser111: does it show up under editor at all?
[2013-12-10 17:34:31 -0500] chefuser111: tomduffield: not at all. it disappears and then the 'tags' json is all that is left ever.
[2013-12-10 17:34:32 -0500] tomduffield: chefuser111: or under json?
[2013-12-10 17:34:44 -0500] chefuser111: tomduffield: no
[2013-12-10 17:35:35 -0500] tomduffield: chefuser111: did you click "Load JSON from source" button before clicking save?
[2013-12-10 17:35:52 -0500] chefuser111: tomduffield: i am unaware of this button. let me try that.
[2013-12-10 17:36:09 -0500] chefuser111: tomduffield: is that sort of an 'apply' button before saving?
[2013-12-10 17:36:09 -0500] tomduffield: chefuser111: its one of the buttons directly above the box I believe
[2013-12-10 17:36:22 -0500] tomduffield: chefuser111: i believe so, yes
[2013-12-10 17:38:59 -0500] chefuser111: tomduffield: very nice. that worked very well.
[2013-12-10 17:39:15 -0500] tomduffield: chefuser111: good
[2013-12-10 17:39:25 -0500] chefuser111: tomduffield: i cant explain properly, how grateful i am to you. thank you for your effort and good will.
[2013-12-10 17:40:04 -0500] tomduffield: chefuser111: it was my pleasure. My only advice would be to reconsider the users cookbook I sent you but best of luck going forward :)
[2013-12-10 17:59:17 -0500] adnichols: does chef-vault seriously decrypt into hash syntax but expect you to input using json?
[2013-12-10 18:09:19 -0500] nate`: does anyone use knife-backup ?
[2013-12-10 18:10:22 -0500] nate`: or is there a better way to do a chef back up?
[2013-12-10 18:12:00 -0500] newchefuser: good morning all. i am using chef community. i have a directory called /etc/vhosts that has thousands of vhosts required for our web servers. I would like to use chef to push that out and keep it up to date on my web servers. I have seen LOTS of ways to do this. What is the EASIEST and BEST way to accomplish this from the chef GUI?
[2013-12-10 18:12:51 -0500] nate`: create a template and then write something that parses out the information from that directory to create attributes?
[2013-12-10 18:12:58 -0500] jpoole: can't do that from the gui
[2013-12-10 18:13:41 -0500] jpoole: you'll need to create a cookbook, knife cookbook create vhosts ; modify the cookbook/vhosts/recipes/default
[2013-12-10 18:13:43 -0500] jpoole: then do a template
[2013-12-10 18:13:53 -0500] jpoole: ensure it is present on all nodes
[2013-12-10 18:13:55 -0500] nate`: assuming they're apache vhosts, should be able to consume the file and parse it and then write a script to send a PUT request to the API for various things.  Then just write out your templates based upon what's stored within chef.
[2013-12-10 18:13:56 -0500] jpoole: and presto.
[2013-12-10 18:14:39 -0500] nate`: then again my "vhosts" are generated automatically based upon meta-data.
[2013-12-10 18:15:35 -0500] newchefuser: Those are a couple of good ideas. What i find odd is that there isn't a pre-packaged cookbook or HowTo to do this. It seems like a very common request. Will I really have to make a cookbook, and templates, just to rsync a directory from chef to a web server?
[2013-12-10 18:16:43 -0500] justizin: newchefuser: what does "from chef" mean?
[2013-12-10 18:16:55 -0500] justizin: a more chef-y way of solving your problem would be to generate the vhosts from a data bag
[2013-12-10 18:17:20 -0500] justizin: i understand you have existing data and that may be difficult to backport, there are a number of ways to manage this.
[2013-12-10 18:17:51 -0500] nate`: Like I said, create a template, then write a script to consume the initial data from flat files and there you go.
[2013-12-10 18:18:06 -0500] jblancett: newchefuser: look at the remote_directory resource
[2013-12-10 18:18:08 -0500] nate`: knife backup seems to suck quite a bit.
[2013-12-10 18:18:28 -0500] newchefuser: justizin: if i make a databag, and i have to change some text in 500 vhosts,.. that would seemingly take a long time. why shouldnt i just keep a vhost directory on the chef server and crontab an rsync? what advantage will this complicated setup in chef give me?
[2013-12-10 18:18:30 -0500] jblancett: http://docs.opscode.com/resource_remote_directory.html
[2013-12-10 18:19:17 -0500] justizin: newchefuser: the answer is frankly that if you want to do configuration management by rsyncing files around, which has some major drawbacks, you just don't need chef.
[2013-12-10 18:19:20 -0500] jpoole: newchefuser you can template that vhost
[2013-12-10 18:19:26 -0500] justizin: you can put a shell script in crontab with chef
[2013-12-10 18:19:26 -0500] jpoole: that's the benefit
[2013-12-10 18:19:49 -0500] justizin: yeah i'd say that managing data in a data bag, which could be fed from a web UI or somesuch, keeps you from having to manage those files by hand
[2013-12-10 18:19:52 -0500] justizin: it will prevent you from making typos
[2013-12-10 18:20:10 -0500] justizin: but if you want to manage thousands of vhosts by editing the config files, be my guest.
[2013-12-10 18:20:20 -0500] justizin: chef is not the first tool to try and convince you that's insane in the past 30 years. ;)
[2013-12-10 18:20:41 -0500] jpoole: 30 years ago it was called job security.
[2013-12-10 18:20:50 -0500] jpoole: :)
[2013-12-10 18:20:51 -0500] geggam: not really...
[2013-12-10 18:21:03 -0500] geggam: 30 years ago vhosts didnt exist :P
[2013-12-10 18:21:05 -0500] newchefuser: jblancett: this looks like a very good start.
[2013-12-10 18:21:09 -0500] jpoole: this is true.
[2013-12-10 18:21:13 -0500] justizin: 25 maybe.. pretty damned close..
[2013-12-10 18:21:21 -0500] justizin: 20, whatever
[2013-12-10 18:21:33 -0500] jpoole: 30 years ago, there wasn't much of anything...
[2013-12-10 18:21:35 -0500] justizin: point being it's never been a good idea to manage vhosts that way, for a number of reasons
[2013-12-10 18:21:45 -0500] geggam: you know you are old when 5 years is a a whatever :)
[2013-12-10 18:21:51 -0500] justizin: jpoole: orly? ;)
[2013-12-10 18:22:19 -0500] justizin: point being that since the dawn of vhosts people have built software to manage them, there are thousands of such pieces of software, many of which are open-source.
[2013-12-10 18:22:39 -0500] jpoole: we didn't need vhosts 30 years ago, we just routed a whole c block to host.
[2013-12-10 18:22:47 -0500] jpoole: cause why? we'd never run out
[2013-12-10 18:22:53 -0500] newchefuser: justizin: name some of these softwares.
[2013-12-10 18:22:57 -0500] geggam: i would argue sed /awk was likely the first vhost manager
[2013-12-10 18:23:01 -0500] jtimberman: geggam: virtual machines or http virtual hosts?
[2013-12-10 18:23:02 -0500] geggam: and we didnt need anything better
[2013-12-10 18:23:21 -0500] geggam: http vhosts 30 years ago.. that would be close
[2013-12-10 18:23:24 -0500] geggam: very close
[2013-12-10 18:23:32 -0500] justizin: usually those thousands of vhosts correspond to external or internal customers who'd like the ability to change their config without talking to some neckbeard ;)
[2013-12-10 18:23:42 -0500] jpoole: echo, cat, grep >> | << FOO!
[2013-12-10 18:24:04 -0500] jpoole: aye, the unix longbeards.
[2013-12-10 18:24:49 -0500] justizin: newchefuser: http://lmgtfy.com/?q=virtual+hosting+control+panel+open+source#
[2013-12-10 18:28:50 -0500] newchefuser: justizin: http://lmgtfy.com/?q=did+you+read+through+those+results%3F+because+most+are+not+specifically+for+vhosts+and+are+bloated%2C+the+others+are+harmful+to+your+computer%2C+and+a+large+portion+are+not+updated+anymore.+But+LMGTFY+is+very+funny.
[2013-12-10 18:30:18 -0500] geggam: that link is less funny with javascript disabled
[2013-12-10 18:30:19 -0500] newchefuser: justizin: lemonparty.org is a much better example of software done right.
[2013-12-10 18:30:40 -0500] jpoole: Oh Sap
[2013-12-10 18:30:41 -0500] jpoole: snap
[2013-12-10 18:31:00 -0500] jpoole: this newchefuser got jokes.
[2013-12-10 18:31:29 -0500] geggam: poor sense of humor tho jpoole
[2013-12-10 18:31:44 -0500] jpoole: yeah and i was being saracastic too.
[2013-12-10 18:31:50 -0500] geggam: and lemonparty ? ... might as well toss out tubgirl
[2013-12-10 18:32:00 -0500] geggam: or that 2 gurls and cup thing
[2013-12-10 18:32:03 -0500] jpoole: or the classic goatse
[2013-12-10 18:32:40 -0500] geggam: k... now i have to go rinse out my minds eye
[2013-12-10 18:32:44 -0500] jpoole: lol
[2013-12-10 18:33:03 -0500] justizin: newchefuser: sometimes you have to go past the first page of results.
[2013-12-10 18:33:11 -0500] justizin: eh, good riddance
[2013-12-10 18:33:25 -0500] jpoole: yup.
[2013-12-10 18:33:39 -0500] jpoole: gotta love the "I Need help", then "You suck" ./quit
[2013-12-10 18:33:50 -0500] justizin: yeah
[2013-12-10 18:33:53 -0500] geggam: classic irc... its what created the asshole irc reputation
[2013-12-10 18:34:05 -0500] jpoole: i thought that was #freebsd.
[2013-12-10 18:34:09 -0500] jpoole: *poke*
[2013-12-10 18:34:10 -0500] geggam: get asked a question... answer it... get told you are wrong
[2013-12-10 18:34:17 -0500] geggam: i hate that
[2013-12-10 18:34:37 -0500] jpoole: yup
[2013-12-10 18:34:41 -0500] geggam: #1 im never wrong
[2013-12-10 18:34:45 -0500] geggam: >:]
[2013-12-10 18:34:49 -0500] jpoole: #2 goto 1
[2013-12-10 18:34:50 -0500] nate`: So, what do people here use to back up their chef servers?  Or is everyone here running with hosted chef? :P
[2013-12-10 18:34:51 -0500] jpoole: # run
[2013-12-10 18:35:00 -0500] jpoole: nate, git.
[2013-12-10 18:35:13 -0500] nate`: You store the data store in git?
[2013-12-10 18:35:18 -0500] jpoole: ohhhh
[2013-12-10 18:35:21 -0500] jpoole: the datastore.
[2013-12-10 18:35:23 -0500] jpoole: hrmm.
[2013-12-10 18:35:36 -0500] nate`: I don't want to create users every time, or anything else stored in there.
[2013-12-10 18:35:46 -0500] geggam: snapshot the ec2 instance im running chef on
[2013-12-10 18:35:54 -0500] geggam: tho i must say i was going to revist that
[2013-12-10 18:35:56 -0500] nate`: That's a terrible way to do back ups geggam
[2013-12-10 18:35:58 -0500] jpoole: i use s3 for 'stuff' like htat
[2013-12-10 18:36:14 -0500] nate`: How do I dump the data into something that I can import is what I'm after.
[2013-12-10 18:36:32 -0500] geggam: its terrible but its fast and i need fast... ill fix it later... if the project doesnt change before then
[2013-12-10 18:36:36 -0500] jpoole: forgive my ignorance, but the chef datastore is just a directory right?
[2013-12-10 18:36:36 -0500] nate`: ssl certs ain't that big of a deal for me to pop onto a machine, that's taken care of since I have to use my own ones.
[2013-12-10 18:36:43 -0500] Runkle: well hello.
[2013-12-10 18:36:44 -0500] justizin: nate`: you can backup the couch/solr/postgres/whatever, you can also dump all of the nodes, roles, environments, etc.. to json
[2013-12-10 18:36:57 -0500] Runkle: i've got a noob questions as i muddle thru this tutorial : http://gettingstartedwithchef.com/first-steps-with-chef.html
[2013-12-10 18:36:59 -0500] justizin: there is a lot to be gained by periodically killing your entire chef server and loading the relevant data fresh
[2013-12-10 18:37:03 -0500] chrisballinger: hey all, is the only way to chmod/chown via the execute resource?
[2013-12-10 18:37:06 -0500] justizin: also don't forget to backup all of the client certs
[2013-12-10 18:37:22 -0500] Runkle: recipes/default.rb is essentially what jobs to perform. attributes/default.rb is what configuration defaults to use... and web.json is a collection of per instance variables and its sort of forms and inheritcance hiearchy or sorts?
[2013-12-10 18:37:23 -0500] justizin: that said i haven't run my own chef for 18mo or so, i have fallen into hosted chef laziness
[2013-12-10 18:37:23 -0500] jpoole: yeah that's one thing i havne't gotten around to yet, is managing my chef server, with chef.
[2013-12-10 18:37:26 -0500] nate`: The question is with doing chef-server-ctl reconfigure all of the passwords are more than likely autoggenerated.
[2013-12-10 18:37:29 -0500] chrisballinger: i realize its not idempotent but the permissions are wrong
[2013-12-10 18:38:16 -0500] geggam: my plan is to have a master chef with minion chefs... but first i have to finish putting all this boto crap into chef
[2013-12-10 18:38:18 -0500] nate`: my client certs get stored based upon needs in an s3 bucket already.
[2013-12-10 18:38:39 -0500] jpoole: chris execute "change_perms" do  command "chmod 0644 foo" action :run end
[2013-12-10 18:38:53 -0500] chrisballinger: jpoole: thanks!
[2013-12-10 18:38:57 -0500] jpoole: it's not ideal though
[2013-12-10 18:39:05 -0500] jpoole: you could just use the file, or directory resource
[2013-12-10 18:39:12 -0500] jpoole: that way it will be idempotent
[2013-12-10 18:39:12 -0500] chrisballinger: yeah, i figured but i need recursive
[2013-12-10 18:39:34 -0500] geggam: i should show you my really really long 1 liner sed chef execute statement :) it redefines what you shouldnt do
[2013-12-10 18:39:48 -0500] jpoole: chris
[2013-12-10 18:39:48 -0500] nate`: command 'executestupidamountsofchmod' do ; command 'chmod -R whatever directory'; end would also work :P
[2013-12-10 18:39:50 -0500] jpoole: http://docs.opscode.com/resource_directory.html
[2013-12-10 18:40:02 -0500] jpoole: there is recursive
[2013-12-10 18:40:07 -0500] nate`: initial command should be execute, not command
[2013-12-10 18:40:36 -0500] chrisballinger: jpoole doesnt that mean it will create the directory recursively, but not recurse through an existing directory's contents and change the mode
[2013-12-10 18:40:56 -0500] chrisballinger: "Indicates whether parent directories are created or deleted recursively. For the owner, group, and mode attributes, the value of this attribute applies only to the leaf directory."
[2013-12-10 18:40:57 -0500] aspiers: if ruby-shadow gem is required for setting user passwords via the user resource, can I flag within the recipe the needed to restart the chef-client process after installing that gem?
[2013-12-10 18:41:00 -0500] jpoole: :applies_to_children
[2013-12-10 18:41:07 -0500] nate`: justizin: how do I dump all of that information into JSON and then import it though?
[2013-12-10 18:41:09 -0500] jpoole: option_type :applies_to_children
[2013-12-10 18:41:12 -0500] chrisballinger: oooooooo
[2013-12-10 18:41:23 -0500] aspiers: otherwise the chef-client process can't find the newly installed gem until the next time it runs
[2013-12-10 18:41:32 -0500] jpoole: there is also :one_level_deep
[2013-12-10 18:41:40 -0500] aspiers: just wondering if there was something in the DSL to say "stop execution and restart the client run"
[2013-12-10 18:41:45 -0500] jpoole: so i guess there should be a :balls_deep too.
[2013-12-10 18:41:49 -0500] chrisballinger: hahaha
[2013-12-10 18:41:56 -0500] jpoole: :just_the_tip
[2013-12-10 18:42:01 -0500] gchristensen: wow.
[2013-12-10 18:42:29 -0500] nate`: If you're going there jpoole
[2013-12-10 18:42:31 -0500] nate`: Unix SEX :{ look; gawk; find; sed; talk; grep; touch; finger; find; flex; unzip; head; tail; mount; workbone; fsck; yes; gasp; fsck; more; yes; yes; eject; umount; makeclean; zip; split; done; exit:xargs!!;)}
[2013-12-10 18:42:44 -0500] jpoole: lol
[2013-12-10 18:42:46 -0500] jpoole: nice
[2013-12-10 18:43:00 -0500] gchristensen: never heard of workbone
[2013-12-10 18:43:10 -0500] jpoole: your doing it wrong then
[2013-12-10 18:43:13 -0500] jpoole: ;)
[2013-12-10 18:43:17 -0500] aspiers: haha
[2013-12-10 18:43:38 -0500] gchristensen: or gasp for that matter
[2013-12-10 18:44:50 -0500] geggam: fergot the children
[2013-12-10 18:46:23 -0500] broconne: does anyone know the circumstances under which knife configure would not generate the client key?  The pem file necessary?
[2013-12-10 18:46:34 -0500] broconne: doesn't throw an error, its just not there.
[2013-12-10 18:47:00 -0500] jpoole: no openssl client ?
[2013-12-10 18:47:46 -0500] broconne: openssl is there
[2013-12-10 18:48:22 -0500] nate`: opscode's documentation on backing up blows.  Come on it's not even using couch from what I can tell anymore.
[2013-12-10 18:49:03 -0500] chrisballinger: jpoole the "rights" option for directory resource is windows only
[2013-12-10 18:49:08 -0500] jpoole: nate` i hate to say it, but gregg's snapshoting maybe the only way
[2013-12-10 18:49:13 -0500] chrisballinger: so looks like i gotta use execute chmod
[2013-12-10 18:49:14 -0500] gleam: it does blow, use this instead: https://rubygems.org/gems/knife-backup
[2013-12-10 18:49:17 -0500] jpoole: chris yuck.
[2013-12-10 18:49:21 -0500] gleam: or something similar
[2013-12-10 18:49:23 -0500] gleam: works for me
[2013-12-10 18:49:29 -0500] nate`: I'm not going to snap shot.
[2013-12-10 18:49:35 -0500] broconne: had to do a -i.
[2013-12-10 18:49:37 -0500] nate`: That's the worst possible way to back up ever
[2013-12-10 18:49:42 -0500] gleam: i do knife backup export cookbooks clients nodes roles data_bags environments -D outputdir
[2013-12-10 18:49:44 -0500] jpoole: chris how many levels deep?
[2013-12-10 18:49:51 -0500] nate`: gleam: knife-backup ain't working for me
[2013-12-10 18:49:54 -0500] gleam: knife download --purge --chef-repo-path outputdir  --repo-mode everything /users
[2013-12-10 18:50:00 -0500] gleam: those two combined work great for me
[2013-12-10 18:50:53 -0500] nate`: http://pastebin.com/2D1SXzvm
[2013-12-10 18:50:55 -0500] jpoole: well i'd argue any backup is better than no backup so it maybe a step up from no backup.
[2013-12-10 18:51:18 -0500] jpoole: need the plugin
[2013-12-10 18:51:29 -0500] jpoole: https://github.com/mdxp/knife-backup
[2013-12-10 18:51:35 -0500] nate`: I did what it says on git hub, "gem install knife-backup"
[2013-12-10 18:51:36 -0500] jpoole: gem install knife-backup
[2013-12-10 18:51:36 -0500] gleam: nate, you need to install it with /opt/chef/embedded/bin/gem
[2013-12-10 18:51:45 -0500] gleam: knife uses that ruby
[2013-12-10 18:52:03 -0500] jpoole: ./opt/chef/embedded/bin/gem install knife-backup
[2013-12-10 18:52:06 -0500] gleam: right
[2013-12-10 18:52:15 -0500] gleam: or with chef_gem
[2013-12-10 18:52:42 -0500] nate`: Between RHEL and chef I have far too many damn versions of ruby.
[2013-12-10 18:53:22 -0500] jpoole: throw in some RVM, brew, and rbv, just to make it more fun
[2013-12-10 18:53:37 -0500] nate`: I'm using rbenv :P
[2013-12-10 18:54:01 -0500] nate`: while it still sucks, it's better than rvm.  Also why RHEL has to use things so ancient I don't know.  I should go back to start up land.
[2013-12-10 18:55:17 -0500] geggam: meh... just spin up an rpmbuild machine and put chef to work there
[2013-12-10 18:55:25 -0500] geggam: well.. jenkins / chef
[2013-12-10 18:56:04 -0500] geggam: *developer* but ubuntu has that ... why do I have to use centos/rhel... *whine voice8
[2013-12-10 18:56:24 -0500] nate`: Last start up I worked for was 100% gentoo :P  It was awesome.
[2013-12-10 18:56:38 -0500] geggam: ew... that just sounds like a lot of wasted time
[2013-12-10 18:57:03 -0500] nate`: Not at all.  I loved it.  Then again I did turn an s3 bucket into a package repository.
[2013-12-10 18:57:18 -0500] geggam: heh... we have multiple repos mirrored in s3
[2013-12-10 18:57:21 -0500] jpoole: nate yeah that's the pro/con argument these days
[2013-12-10 18:57:24 -0500] jpoole: stability, or ability.
[2013-12-10 18:57:28 -0500] jpoole: RHEL, Ubuntu
[2013-12-10 18:57:40 -0500] geggam: done right centos can do anything ubuntu does
[2013-12-10 18:57:46 -0500] nate`: jpoole: the true issue is contractual obligations to clients.
[2013-12-10 18:57:48 -0500] jpoole: i dont argue that
[2013-12-10 18:57:49 -0500] geggam: requires spec files
[2013-12-10 18:57:57 -0500] geggam: and rpmbuild foo
[2013-12-10 18:58:05 -0500] geggam: or... fpm :)
[2013-12-10 18:58:08 -0500] jpoole: love fpm
[2013-12-10 18:58:14 -0500] jpoole: fpm > *
[2013-12-10 18:58:15 -0500] nate`: Client offers stupid amounts of money, says you need support from somebody for something, stupid amounts of money always triumphs.
[2013-12-10 18:58:27 -0500] jpoole: nate` ask for more money then.
[2013-12-10 18:58:28 -0500] jpoole: :)
[2013-12-10 18:58:41 -0500] jpoole: problems IMHO go away the more money you throw at the
[2013-12-10 18:58:43 -0500] jpoole: them
[2013-12-10 18:58:47 -0500] geggam: ubuntu doing the whole unity spyware thing pretty much killed any chance at a solid corporate buy in
[2013-12-10 18:59:33 -0500] nate`: jpoole: I'm sure you know, in any IT based portion of any company there are a lot more issues than money can solve.
[2013-12-10 18:59:41 -0500] jpoole: then again, richard stallman....
[2013-12-10 18:59:58 -0500] c_t: I'm crotchety and use debian on all our servers
[2013-12-10 19:00:01 -0500] nate`: You can constantly toss cash at something, but band aids on gushing jugular wounds will eventually waste more than it's worth.
[2013-12-10 19:00:25 -0500] nate`: Isn't that why we here all try to automate everything? :P
[2013-12-10 19:00:41 -0500] nate`: Get rid of the human factor of accidently fucking up due to lack of knowledge or experience?
[2013-12-10 19:00:56 -0500] geggam: meh... tossing money at things is how we get paid... the more companies i am in the more i am secure in knowing there is so much crap jacked up it will never be fixed in my life time
[2013-12-10 19:01:11 -0500] geggam: and instead of automation curing it all its doing is making bigger messes :)
[2013-12-10 19:01:22 -0500] geggam: faster
[2013-12-10 19:02:05 -0500] geggam: ride the wave of new and cool... do ec2 /chef .. its the in thing
[2013-12-10 19:02:14 -0500] nate`: Well I could always run my "sucide.rb" which basically terminates everything in an AWS account, that'd muck things up quite a bit.
[2013-12-10 19:02:16 -0500] geggam: next year maybe saltstack ?
[2013-12-10 19:03:37 -0500] nate`: Great, a python automation tool that's not cross platform.
[2013-12-10 19:04:37 -0500] justizin: anyone have chef recipes for slony or bucardo postgres replication? we're preparing to move from 9.0 into the age of enlightenment and i'm learning how effing impossible that is with streaming repl for a 200GB db
[2013-12-10 19:05:09 -0500] geggam: um sharding /
[2013-12-10 19:05:11 -0500] geggam: ?
[2013-12-10 19:06:42 -0500] benwtr_: hi, I have a tiny fix for opscode-cookbooks/memcached, my PR has been sitting around for a few days, do I need to create a ticket?
[2013-12-10 19:15:10 -0500] speakingcode-wor: i'm rying to run a rack app via an execute resource, calling rackup. problem is doing that causes knife on my workstation to hang, waiting for the rackup command to exit. i've tried appending with & but that seems to just kill the process immediately. any ideas?
[2013-12-10 19:25:21 -0500] maniacal: anyone know how to get the name of the cookbook that called the a resource provided by an lwrp?
[2013-12-10 19:26:19 -0500] maniacal: based on this http://stackoverflow.com/questions/13689811/get-deployed-cookbook-version
[2013-12-10 19:26:40 -0500] maniacal: it seems I should be able to get it from run_context.cookbook_collection[cookbook_name].  just having trouble implementing it
[2013-12-10 19:29:35 -0500] Runkle: arg. I'm trying to set the docroot to /var/www on centos with the apache2 community cookbook, but no matter what it seems to go to /var/www/html
[2013-12-10 19:31:26 -0500] EJC_: is there an easy to run a recipe from within a lwrp?  I want my lrwp I'm writing to run python_pip and install/upgrade several packages, but can't seem to get that to work
[2013-12-10 19:34:50 -0500] Runkle: i.. think igot it.
[2013-12-10 19:37:17 -0500] jperry: With default attributes set in attribute files is it first one wins or last one wins?
[2013-12-10 19:37:37 -0500] jperry: say I have two cookbooks with an attribute file that sets the same attribute
[2013-12-10 19:37:45 -0500] jperry: which one wins
[2013-12-10 19:40:54 -0500] chip-: jperry: In that case you'd wind up with an array.
[2013-12-10 19:41:15 -0500] chip-: jperry: http://docs.opscode.com/chef_overview_attributes.html
[2013-12-10 19:42:08 -0500] jperry: chip-: where on that doc do you see that mentioend
[2013-12-10 19:42:49 -0500] jperry: so if I have an attribute file that says default[:mongodb][:config] = '/etc/mongdb.conf'
[2013-12-10 19:43:11 -0500] jperry: and another attribute file in another cookbook setting it to '/etc/mongodb.back.conf'
[2013-12-10 19:43:22 -0500] jperry: there would be an array of values?
[2013-12-10 19:46:44 -0500] chip-: Yes.
[2013-12-10 19:46:58 -0500] chip-: Well, let me qualify that answer:
[2013-12-10 19:47:18 -0500] chip-: There's a table at http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2013-12-10 19:47:30 -0500] chip-: If two values are provided at the same precedence, they are merged into an array.
[2013-12-10 19:47:34 -0500] chip-: But it's pretty avoidable.
[2013-12-10 19:47:50 -0500] chip-: Rule of thumb: Always use the lowest precedence level that will work for you.
[2013-12-10 19:48:34 -0500] scalp42: also reminds me of coderanger post: https://coderanger.net/2013/06/arrays-and-chef/
[2013-12-10 19:48:45 -0500] chip-: Yes, thanks. I was just googling that up. :)
[2013-12-10 19:52:02 -0500] nate`: Have to love code review meetings.  Bletch, now onto writing more.
[2013-12-10 19:55:19 -0500] phutchins: nate`: heh sounds like so much fun...
[2013-12-10 19:58:42 -0500] jperry: chip-: thanks for the info.  With that said though when I access the node attribute which one do I get?  Do the array of values?
[2013-12-10 19:59:15 -0500] nate`: phutchins: tell me you don't have to suffer through agile :P
[2013-12-10 20:00:02 -0500] chip-: jperry: I don't remember if you get item 0 from the array, or the array itself. I think you get the array itself.
[2013-12-10 20:00:05 -0500] phutchins: nate`: its not a suffer where I am :)
[2013-12-10 20:00:20 -0500] nate`: I come from operations, so agile is suffering.
[2013-12-10 20:00:32 -0500] nate`: I'm more of a "get shit done no matter what" sort of asshole.
[2013-12-10 20:00:38 -0500] phutchins: nate`: i do as well... agile done right can be nice...
[2013-12-10 20:00:48 -0500] phutchins: heh
[2013-12-10 20:00:51 -0500] phutchins: theres a time and place for that
[2013-12-10 20:00:59 -0500] jperry: chip-: hmm, we did this and we only got one of the values which makes me believe we got array[0] or it popped
[2013-12-10 20:01:06 -0500] jperry: this is with chef 10.28.2
[2013-12-10 20:02:18 -0500] chip-: If you do a knife node show nodename -a my.attribute.here you should be able to inspect the attribute
[2013-12-10 20:02:50 -0500] nate`: Well there, chef server backed up automatically to s3, chef server restoring from s3.  Now to write a few lines based upon requirements to migrate things from s3 to glacier and delete as needed.
[2013-12-10 20:04:37 -0500] nate`: Then I can finally use this damn chef server
[2013-12-10 20:04:56 -0500] jperry: chip-: it's set to a string
[2013-12-10 20:11:33 -0500] doomviking: Opscode changes name to Chef. Making google search that much more difficult.
[2013-12-10 20:11:46 -0500] phutchins: doomviking: yeah i was wondering about that
[2013-12-10 20:12:15 -0500] doomviking: now you prepend all searches with chef chef, instead of opscode chef.
[2013-12-10 20:13:58 -0500] iverson0881: yeah its a bit annoying since you had a term in there that wasn't food related
[2013-12-10 20:14:06 -0500] iverson0881: but i've tons of recipes now!
[2013-12-10 20:18:23 -0500] jtimberman: doomviking: you can still add 'opscode' to searches and it will work, likely for a long time.
[2013-12-10 20:18:30 -0500] jtimberman: because data on the internet has a half life of forever :)
[2013-12-10 20:19:49 -0500] coderanger: jtimberman: The company is going to be called "opscode" for a long long time
[2013-12-10 20:19:51 -0500] coderanger: :P
[2013-12-10 20:20:36 -0500] jtimberman: heh
[2013-12-10 20:20:40 -0500] jtimberman: sure :)
[2013-12-10 20:21:09 -0500] coderanger: jtimberman: See also: github repos haven't been renamed, etc etc ;-)
[2013-12-10 20:21:15 -0500] gchristensen: daaamn, and the logo changed again
[2013-12-10 20:21:16 -0500] jtimberman: sure
[2013-12-10 20:21:28 -0500] jtimberman: gchristensen: but it means something now!
[2013-12-10 20:21:32 -0500] jtimberman: its morse code for CHEF :)
[2013-12-10 20:21:41 -0500] jtimberman: (international morse code as i understand)
[2013-12-10 20:21:46 -0500] gchristensen: coderanger: I have a selenium script that individuall transfers repos to a different account if you want ... if you rename an org it doesn't do redirects. If you move them, it does.
[2013-12-10 20:22:21 -0500] gchristensen: jtimberman: nice!
[2013-12-10 20:23:15 -0500] gchristensen: I forgot to add a not_if clause to a remote_file and accidentally downloaded a file 400,000 times over the last month.
[2013-12-10 20:23:18 -0500] gchristensen: oops.
[2013-12-10 20:41:32 -0500] sethvargo: Ohai everyone, I just released chef-sugar v1.1.0 with added support for cloudstack and encrypted data bag helpers: https://github.com/sethvargo/chef-sugar/releases/tag/v1.1.0
[2013-12-10 20:43:02 -0500] mattupstate: hooray!
[2013-12-10 20:43:07 -0500] mattupstate: nice, sethvargo
[2013-12-10 20:43:20 -0500] sn0wb1rd: http://community.getchef.com/ doesn't seem to work yet
[2013-12-10 20:44:01 -0500] mattupstate: i know i'm doing something right when someone has done it an opensourced it
[2013-12-10 20:45:08 -0500] mondo: Is https://github.com/hw-cookbooks/omnibus_updater the best way to update chef-client on my nodes?  I'm running chef-client as a service, installed via the standard boostrap method.
[2013-12-10 20:46:47 -0500] chris613: mondo: Yes, but I've found that it isn't suitable for inclusion in my run_lists, I run it via -o
[2013-12-10 20:47:17 -0500] chris613: The reason is that if an upgrade actually occurs is deliberately fails the run, leaving things in an unconverged state which is not trivial to recover from in some cases
[2013-12-10 20:47:25 -0500] chris613: *it deliberately fails
[2013-12-10 20:47:45 -0500] chris613: There is an option to disable that behavior, but I've found that it causes a different set of problems, though the details elude me at the moment
[2013-12-10 20:48:37 -0500] gchristensen: ^ the version of libraries have changed beneath the run, so the safest thing to do for thesaftey of chef is to end it immediately
[2013-12-10 20:48:56 -0500] chris613: yeah, it just sucks when that happens in the context of other cookbooks, so it's best to run it alone
[2013-12-10 20:49:08 -0500] gchristensen: agreed. running it with -o is a clever idea
[2013-12-10 20:49:10 -0500] mondo: chris613: I've read about this as well.  I thought about modifying the omnibus_updater cookbook to restart the chef-client service before it kills itself.
[2013-12-10 20:49:32 -0500] poseid: what is the fastest way to get chef-solo running on a fresh VM?
[2013-12-10 20:50:13 -0500] poseid: I am looking into shell provisioners on vagrant, and something like "sudo apt-get install -y ruby-dev"
[2013-12-10 20:50:16 -0500] mondo: by -o do you mean you're just logging into each of your nodes and manually running chef-client -o recipe[omnibus_updater] ?
[2013-12-10 20:50:32 -0500] mondo: what if I have 200 nodes :)
[2013-12-10 20:50:33 -0500] poseid: but it gets the wrong ruby version
[2013-12-10 20:52:17 -0500] gchristensen: poseid: I do ... sudo apt-get install curl; curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-12-10 20:52:42 -0500] allaire: Hi, I currently wrap many cookbooks in my own corp cookbook. Each recipe in that cookbook wraps another cookbook, i.e we have a nginx recipe in our corp cookbook that wraps the nginx-cookbook. Is there any disadvantage of doing so (wrap cookbooks using recipes in one corp cookbook) instead of many wrapper cookbooks?
[2013-12-10 20:53:39 -0500] poseid: gchristensen: cool, that's what I was looking for thank!
[2013-12-10 20:54:24 -0500] freeformz: any good resource for upgrading chef recipes from early 0.10.X to something more current ?
[2013-12-10 20:55:47 -0500] poseid: gchristensen: makes a good tweet too: https://twitter.com/mulpat/status/410513065575477248 :)
[2013-12-10 20:56:30 -0500] gchristensen: poseid: its a macro on my Kinesis Advantage Pro
[2013-12-10 20:56:59 -0500] poseid: haha.. nice :)
[2013-12-10 20:58:02 -0500] clayb: freeformz Are you hitting a lot of issues? I found my Chef 10 recipes moved with mostly little effort
[2013-12-10 20:58:33 -0500] freeformz: clayb: yes ... but we're probably also over abusing node
[2013-12-10 20:58:52 -0500] jtimberman: freeformz: perhaps this is helpful? http://docs.opscode.com/breaking_changes_chef_11.html
[2013-12-10 20:58:56 -0500] jtimberman: wrt node attributes
[2013-12-10 20:59:18 -0500] clayb: freeformz Ah yeah, we aren't overly abusive of that: https://github.com/cbaenziger/chef-bcpc/commit/725bef69b3ccc13fd592c202b8d4ff009719cc27
[2013-12-10 21:00:11 -0500] freeformz: jtimberman: I played with using the precidence levels and something I node.normal.attributed in one cookbook wasn't available in another (surfaced as a Nil error)
[2013-12-10 21:00:37 -0500] freeformz: jtimberman: also tried other precedence levels too ... fwiw ... we're using chef solo
[2013-12-10 21:06:34 -0500] prometheanfire: [2013-12-10T12:07:59-08:00] ERROR: undefined method `state_attrs' for Fog::Rackspace::Monitoring::Check:Class
[2013-12-10 21:06:44 -0500] poseid: ok, once the node is provisioned with the dbs, nodejs, etc. - what's is the best way to bring repos from github into the node
[2013-12-10 21:06:47 -0500] prometheanfire: this happens after a run succeeds, feels odd
[2013-12-10 21:06:51 -0500] jchauncey_: sethvargo: you around?
[2013-12-10 21:07:18 -0500] sethvargo: @jchauncey_ working on other stuff, whats up?
[2013-12-10 21:07:33 -0500] jchauncey_: ill just put it in #chefspec
[2013-12-10 21:08:20 -0500] prometheanfire: tcate: hi
[2013-12-10 21:09:34 -0500] poseid: ok, i get this: http://stackoverflow.com/questions/11769219/check-out-a-git-repository-with-chef
[2013-12-10 21:09:49 -0500] poseid: with berkshelf, can I derive a cookbook for this in /cookbooks ?
[2013-12-10 21:10:06 -0500] poseid: or, would it get lost/overwritten by berks ?
[2013-12-10 21:10:31 -0500] freeformz: jtimberman: now that I think about it ... there may be an ordering issue.
[2013-12-10 21:11:09 -0500] freeformz: I'll have to play with my branch more when I have some time. side projects and all
[2013-12-10 21:12:32 -0500] jtimberman: freeformz: possibly. you can always play around with things in chef-shell, using 'solo' mode (-s)
[2013-12-10 21:13:15 -0500] freeformz: jtimberman: heh. Okay. That will be interesting since these errors are down somewhere in a deep hole.
[2013-12-10 21:15:52 -0500] allaire: @jtimberman: Would love to have your thought about my question above :)
[2013-12-10 21:16:31 -0500] jtimberman: freeformz: require 'pry' for good time fun in chef-shell
[2013-12-10 21:16:31 -0500] prometheanfire: so, why does chef succeed and fail at the same time?
[2013-12-10 21:16:57 -0500] coderanger: prometheanfire: require 'quantum_mechanics'
[2013-12-10 21:16:59 -0500] freeformz: prometheanfire: it's a quantum leap in config management
[2013-12-10 21:17:31 -0500] jtimberman: allaire: generally we're doing a 1:1 internal wrapper cookbook to community cookbook
[2013-12-10 21:17:32 -0500] prometheanfire: sounds about right
[2013-12-10 21:18:09 -0500] allaire: jtimberman: Anything wrong about having a 1:n wrapper cookbook and using recipes to wrap?
[2013-12-10 21:18:13 -0500] prometheanfire: this ERROR: undefined method `state_attrs' thing is causing chef to not run correctly and it's bugging me
[2013-12-10 21:18:16 -0500] allaire: versioning a bit more global I guess?
[2013-12-10 21:19:27 -0500] gchristensen: allaire: imagine the case: webserver needs shared:nginx, shared requires nfsd, jenkins, mysql, hadoop, realplayer, X, apt, yum, bind ....
[2013-12-10 21:19:38 -0500] jtimberman: allaire: if it doesn't cause you pain, rock out.
[2013-12-10 21:20:28 -0500] allaire: gchristensen: i only include the recipes I need from my cookbook
[2013-12-10 21:20:53 -0500] gchristensen: allaire: right, but if you depend on that cookbook or add that cookbook to the run list, it will download every depended upon cookbook to your node
[2013-12-10 21:21:07 -0500] allaire: gchristensen: Good point :)
[2013-12-10 21:21:15 -0500] allaire: No deal-breaker, but to be considered
[2013-12-10 21:21:29 -0500] allaire: most of my wrapper-cookbooks does little to nothing
[2013-12-10 21:21:31 -0500] gchristensen: alo berks upload (if you use berks) would take forever
[2013-12-10 21:21:33 -0500] allaire: but I guess this is "normal"
[2013-12-10 21:21:39 -0500] gchristensen: because it would aso want to upload all the dependent cookbooks
[2013-12-10 21:29:17 -0500] EJC_: can someone help super quick - how can i have templates and files packaged as part of my lwrp used when the lwrp is called from a recipe?
[2013-12-10 21:29:42 -0500] EJC_: chef is complaining that it can't find the file and template during the execution of the recipe
[2013-12-10 21:30:30 -0500] EJC_: or is this not even possible?
[2013-12-10 21:31:02 -0500] EJC_: I'm wondering if there's a way to tell the lwrp to use its own template and file resources vs. trying to find the same things in the cookbook that leverages it
[2013-12-10 21:35:54 -0500] someara: @ejc specify the "cookbook" parameter in the template
[2013-12-10 21:35:58 -0500] ccapndave: Hey everyone - I have been using chef with Vagrant and am now trying to use it against a real server, only to realise that vagrant takes care of lots of bits and I don't really know how to set things up :)
[2013-12-10 21:36:43 -0500] ccapndave: I have a local machine where I do my development and set off my deploypments - that's the machine that runs knife I guess, but I can't figure out where the chef server goes, or if I even need one
[2013-12-10 21:37:01 -0500] ccapndave: I'm only going to be deploying to one or two machines
[2013-12-10 21:37:36 -0500] ccapndave: Any advice much appreciated
[2013-12-10 21:37:58 -0500] Xeron: Are whole legal@opscode on vacation? No CLA approval and no email answer for 8 days.
[2013-12-10 21:38:44 -0500] robinpc: q: given a ruby structure that was loaded from json, is there a generic way to set the entire structure on a node (without knowing in advance what the structure is)? No problem getting each item from the structure by knowing its format and setting them individually, but it seems efficient to set the whole thing under a known key
[2013-12-10 21:39:07 -0500] EJC_: someara - I'm not sure what you mean?
[2013-12-10 21:39:28 -0500] EJC_: the lwrp has the template and the file and the cookbook where the lwrp is used does not
[2013-12-10 21:41:32 -0500] poseid: so, again fighting with the rvm cookbook...
[2013-12-10 21:41:42 -0500] EJC_: someara ?
[2013-12-10 21:42:14 -0500] Xeron: EJC_ use cookbook attribute inside resource and pass lwrp's cookbook name to it
[2013-12-10 21:42:28 -0500] pedahzur: Trying to construct a script to use in a chef recipe.  Using directions here: http://docs.opscode.com/resource_script.html  But getting this error: "undefined method `default' for Chef::Resource::Script"  In what version of chef was "script" added?
[2013-12-10 21:42:29 -0500] poseid: i get: [2013-12-10T21:42:16+00:00] DEBUG: chef_gem[rvm] detected omnibus installation in /opt/chef/embedded/bin
[2013-12-10 21:42:42 -0500] poseid: but vagrant ssh still says rvm not found, ruby not found
[2013-12-10 21:43:03 -0500] someara: ejc like this
[2013-12-10 21:43:04 -0500] someara: https://github.com/opscode-cookbooks/yum/blob/tableflip/providers/repository.rb#L27
[2013-12-10 21:43:22 -0500] poseid: and [2013-12-10T21:42:16+00:00] DEBUG: chef_gem[rvm] is already installed - nothing to do
[2013-12-10 21:44:40 -0500] EJC_: someara so that tells the lwrp that the template is to come from a cookbook named "yum" in your example?
[2013-12-10 21:44:50 -0500] EJC_: someara  and the cookbook happens to be the same LWRP?
[2013-12-10 21:45:52 -0500] someara: yep
[2013-12-10 21:46:21 -0500] EJC_: neato
[2013-12-10 21:46:24 -0500] someara: then other cookbooks that consume the lwrp will pull from that cookbook instead of looking locally
[2013-12-10 21:46:30 -0500] EJC_: that is so hot
[2013-12-10 21:47:00 -0500] EJC_: is it possible to include other cookbooks/recipes within a lwrp?
[2013-12-10 21:47:04 -0500] EJC_: seems to not be so
[2013-12-10 21:47:28 -0500] someara: nope
[2013-12-10 21:48:54 -0500] robinpc: rpc to futures: Yep, sure can
[2013-12-10 21:48:55 -0500] robinpc: parsed = JSON.parse(structures)
[2013-12-10 21:48:57 -0500] robinpc: node.set['toplevelkeyinthestructure'] = parsed['toplevelkeyinthestructure']
[2013-12-10 21:51:39 -0500] Idealien: Could someone help me troubleshoot getting multiple hosts running on a lamp vagrant with chef? I'm basing off https://github.com/r8/vagrant-lamp but during vagrant up get error messages "Failed to list data bag items in data bag: "sites"
[2013-12-10 21:51:41 -0500] Idealien: Sites data bag is empty". Have documented vagrant commands and some files at https://gist.github.com/Idealien/0c09b38c1b5984fa69d6
[2013-12-10 22:00:06 -0500] EJC_: someara is there a trick to reference attributes within the lwrp's template?
[2013-12-10 22:00:28 -0500] someara: hrm? what do you mean
[2013-12-10 22:00:37 -0500] EJC_: saying "<%= node['foo'] %> ends up being blank
[2013-12-10 22:01:09 -0500] matti: EJC_: Should work.
[2013-12-10 22:01:15 -0500] someara: that should totally work... are you sure you have the right attribute?
[2013-12-10 22:01:24 -0500] EJC_: someara in the lwrp, I make a reference to #{new_resource.foo}
[2013-12-10 22:01:40 -0500] EJC_: so I can't just reference <%= node['foo'] %>
[2013-12-10 22:01:41 -0500] matti: EJC_: Unless you are re-using code in different cookbook, which is not pulling attributes.
[2013-12-10 22:02:00 -0500] matti: EJC_: You can totally set node[:foo] as you please.
[2013-12-10 22:02:04 -0500] someara: gist me an example?
[2013-12-10 22:02:13 -0500] holms: :DD
[2013-12-10 22:03:15 -0500] EJC_: someara https://gist.github.com/eciramella/ae5ad1a44a4999bd9e85
[2013-12-10 22:03:35 -0500] EJC_: ALL of this is happening within the lwrp
[2013-12-10 22:05:03 -0500] pedahzur: I am trying to execute shell commands in a chef script (version 0.9.14).  Using script, bash, or execute blocks, I am getting "/usr/lib/ruby/gems/1.8/gems/chef-0.9.14/bin/../lib/chef/resource.rb:144:in `method_missing': undefined method `default' for Chef::Resource::Execute (NoMethodError)" (replace Chef::Resource::Execute with appropriate class). How can I shell out in chef 0.9.14?
[2013-12-10 22:05:52 -0500] someara: ah. doesn't look like you're ever actually setting a node attribute
[2013-12-10 22:05:54 -0500] someara: so
[2013-12-10 22:06:13 -0500] EJC_: can i reference the new_resource in the template or should I be setting the attribute?
[2013-12-10 22:06:14 -0500] someara: "attributes" in the LWRP DSL should really be renamed to "parameters" imho to avoid this confusion
[2013-12-10 22:06:35 -0500] someara: there is a dual meaning... the "Chef" definition of attribtue, which is a key in the node object
[2013-12-10 22:06:47 -0500] someara: then the OO meaning "attribute"
[2013-12-10 22:06:52 -0500] someara: you're conflating them
[2013-12-10 22:06:55 -0500] someara: you want this:
[2013-12-10 22:07:04 -0500] someara: https://github.com/opscode-cookbooks/yum/blob/tableflip/providers/repository.rb#L29
[2013-12-10 22:07:05 -0500] someara: then
[2013-12-10 22:07:27 -0500] someara: https://github.com/opscode-cookbooks/yum/blob/tableflip/templates/default/repo.erb#L6
[2013-12-10 22:07:50 -0500] someara: or you can pass them into the template like this
[2013-12-10 22:08:12 -0500] someara: variables(:somekey => new_resource.whatever)
[2013-12-10 22:08:31 -0500] someara: then access it as @somekey from the template
[2013-12-10 22:08:38 -0500] EJC_: interesting
[2013-12-10 22:08:41 -0500] EJC_: that's pretty neat
[2013-12-10 22:08:48 -0500] EJC_: one sec...
[2013-12-10 22:10:37 -0500] someara: Feel free to document your confusion here: https://tickets.opscode.com/browse/CHEF-1071
[2013-12-10 22:12:53 -0500] EJC_: lol
[2013-12-10 22:13:01 -0500] EJC_: someara I owe you some booze or beer
[2013-12-10 22:13:40 -0500] someara: no sweat
[2013-12-10 22:19:34 -0500] pedahzur: According to http://rubydoc.info/gems/chef/0.9.14/Chef/Resource/Script  The script resource should be in chef 0.9.14. However, when I try to run this: https://gist.github.com/anonymous/7901334  I get this error: /usr/lib/ruby/gems/1.8/gems/chef-0.9.14/bin/../lib/chef/resource.rb:144:in `method_missing': undefined method `default' for Chef::Resource::Script (NoMethodError)  Any ideas?
[2013-12-10 22:24:05 -0500] jidar: I'm trying to setup a workstation when I do a knife configure --initial,
[2013-12-10 22:24:11 -0500] jidar: ERROR: Chef::Exceptions::ValidationFailed: Option name's value Nbox1 does not match regular expression /^[a-z0-9\-_]+$/
[2013-12-10 22:24:21 -0500] jidar: Nbox1 is the Please enter a name for the new user: [Nathan] Nbox1
[2013-12-10 22:24:32 -0500] someara: pedahzur why not just manage /etc/sysconfig/network with a template resource
[2013-12-10 22:25:00 -0500] someara: also, why 0.9.14 on ruby 1.8.7?
[2013-12-10 22:25:28 -0500] pedahzur: someara: Because there are other settings in there that we need to preserve. We are not in complete control of that file.
[2013-12-10 22:25:44 -0500] pedahzur: someara: Because that's what I'm stuck with, and because this is Redhat 5.
[2013-12-10 22:26:20 -0500] pedahzur: So, I found this: http://rubydoc.info/gems/chef/0.9.14/Chef/Resource/Bash  and the files are there on disk.  But I'm getting the method_missing error.  I'm really confused.
[2013-12-10 22:26:35 -0500] henk76: guys, whenever i want to run a mysql recipe i get the error: LoadError: cannot load such file -- mysql/mysql_api
[2013-12-10 22:26:40 -0500] henk76: any ideas?
[2013-12-10 22:27:05 -0500] chris613: henk76: Can you pastebin a more complete error message?
[2013-12-10 22:27:46 -0500] someara: pedahzur okey so two things
[2013-12-10 22:27:50 -0500] someara: https://opscode-omnibus-packages.s3.amazonaws.com/el/5/x86_64/chef-11.8.2-1.el5.x86_64.rpm
[2013-12-10 22:28:07 -0500] someara: and second: https://github.com/someara/line-cookbook
[2013-12-10 22:28:10 -0500] someara: =)
[2013-12-10 22:29:00 -0500] jtimberman: pedahzur: chef 0.9 has been EOL and unsupported for quite awhile now :-|
[2013-12-10 22:29:53 -0500] pedahzur: someara, jtimberman: I know 0.9 is old. But I don't set priorities, and upgrading chef is apparently not one of them.  I would love to upgrade. Really, I would.  But at this point, I can't just strike out on my own and do it.
[2013-12-10 22:30:28 -0500] someara: gotcha. well. will the line cookbook work on 0.9?
[2013-12-10 22:30:30 -0500] pedahzur: someara: I like that cookbook. :)
[2013-12-10 22:30:52 -0500] henk76: chris613 http://pastebin.com/Bf6N3X9c
[2013-12-10 22:33:56 -0500] ccapndave: Is there a way to make the apache2 recipe use Apache 2.2 instead of Apache 2.4?
[2013-12-10 22:34:13 -0500] chris613: henk76: Geez, not sure, sorry
[2013-12-10 22:35:14 -0500] henk76: no worries chris613
[2013-12-10 22:37:00 -0500] geggam: does package "/path/tofile /2nd/path/tofile" do  work /
[2013-12-10 22:37:06 -0500] geggam: ?
[2013-12-10 22:37:23 -0500] geggam: if no one answers in 45 or so seconds ill tell you
[2013-12-10 22:38:43 -0500] geggam: looks like it does... no breakage so far
[2013-12-10 22:38:57 -0500] geggam: n/m ... it breaked
[2013-12-10 22:42:48 -0500] geggam: workaround to force rpm upversion without pushing rpms into yum repo like sane people
[2013-12-10 22:42:49 -0500] geggam: execute "install_collectd" do
[2013-12-10 22:42:49 -0500] geggam:         command "yum -y install /tmp/perl-Collectd-5.1.0-1.el6.x86_64.rpm /tmp/collectd-5.1.0-1.el6.x86_64.rpm"
[2013-12-10 22:42:49 -0500] geggam:         action :run
[2013-12-10 22:42:49 -0500] geggam: end
[2013-12-10 22:44:22 -0500] Blizzik: Hi
[2013-12-10 22:46:17 -0500] Blizzik: I am having a problem with a recipe. I am trying to execute a command as different user. the command is git config --global init.templatedir '~/.git_template'. I specified user as execute attribute but it looks it's trying to make this setting for root instead of the user I specified.
[2013-12-10 22:46:55 -0500] Blizzik: http://pastebin.com/GbKhJLQz Here is the recipe. Could someone PLEASE help me?
[2013-12-10 22:48:16 -0500] pedahzur: someara: NoMethodError - undefined method `default' for Chef::Resource::ReplaceOrAdd  Whuh?
[2013-12-10 22:49:09 -0500] henk76: Blizzik , are you running the chef client as root?
[2013-12-10 22:50:19 -0500] Blizzik: henk76: the loged in user in my Vagrant installation when the chef recipes are running is root
[2013-12-10 22:51:06 -0500] Blizzik: henk76: here is the error: http://pastebin.com/f9nVXUL4
[2013-12-10 22:53:33 -0500] henk76: Blizzik , does this help? http://lists.opscode.com/sympa/arc/chef/2012-01/msg00348.html
[2013-12-10 22:54:09 -0500] Cameron: hi, I'm using the java cookbook (cookbook "java") and am getting this error : NameError - Cannot find a resource for java_ark on ubuntu version 12.04
[2013-12-10 22:54:34 -0500] Cameron: am I doing something wrong ?
[2013-12-10 22:56:30 -0500] gregkare: Cameron: You need to add "depends 'java'" to your cookbook's metadata.rb
[2013-12-10 22:56:42 -0500] Cameron: gregkare, aah, thanks
[2013-12-10 22:57:07 -0500] Cameron: gregkare, that works !  Thanks heaps
[2013-12-10 22:57:20 -0500] gregkare: It's probably the most frequently asked question, so there's probably something missing in the docs somewhere, you're welcome :)
[2013-12-10 22:57:33 -0500] henk76: guys, whenever i want to run a mysql recipe i get the error: LoadError: cannot load such file -- mysql/mysql_api  anyone? http://pastebin.com/Bf6N3X9c
[2013-12-10 22:58:39 -0500] Cameron: hopefully now that I have pasted that error here, and it gets shown on the archive page, someone else will find the answer if it crops up again.
[2013-12-10 23:00:59 -0500] geggam: er my gerd... m1.small is butt slow
[2013-12-10 23:02:46 -0500] gchristensen: t1.micro baby is where the real performance is at
[2013-12-10 23:03:18 -0500] Sauraus_: I have a private Chef 11.8 server running and for some reason it keeps telling me that I have no nodes in any of my environments when I clearly do have these and also have provisioned the nodes using knife/chef-client
[2013-12-10 23:03:25 -0500] Sauraus_: any idea what would cause this?
[2013-12-10 23:04:27 -0500] henk76: does your chef client connect to the chef server Sauraus_ ?
[2013-12-10 23:04:29 -0500] geggam: +1 gchristensen .. i had to upgrade to smalls to do my test runs... micros i spend more time watching than hacking
[2013-12-10 23:04:53 -0500] geggam: might have to go to medium... that rpm i built for collectd seems to want to pull in a few mb of crap
[2013-12-10 23:06:01 -0500] jmickle: how do large groups develop and test their code without uploading to a production chef server?
[2013-12-10 23:06:09 -0500] Sauraus_: @henk76 yes it does, as it downloads the cookbooks and attributes and installs all the software correctly
[2013-12-10 23:06:12 -0500] jmickle: are you guys spinning up dev chef servers?
[2013-12-10 23:07:10 -0500] henk76: Sauraus_ so if you click on clients in the chef server you don't see anything? or do you use commandline?
[2013-12-10 23:07:24 -0500] geggam: the whole concept of large groups automating makes me shudder jmickle
[2013-12-10 23:07:29 -0500] gregkare: jmickle: You can set specific version of cookbooks for different environments (and even roles)
[2013-12-10 23:07:44 -0500] gregkare: Same problem and solution for small groups too
[2013-12-10 23:07:48 -0500] jmickle: gregkare thats a lot of overhead and a bad solution though
[2013-12-10 23:07:50 -0500] geggam: myside | yourside
[2013-12-10 23:07:55 -0500] gregkare: Work for me
[2013-12-10 23:07:58 -0500] geggam: stay off my cloud
[2013-12-10 23:08:29 -0500] jmickle: i mean like lets say I'm developing a cookbook
[2013-12-10 23:08:29 -0500] gregkare: There's no overhead with knife plugins like knife-spork, it gives me exactly the workflow I wanted
[2013-12-10 23:08:32 -0500] jmickle: and want to test shit out
[2013-12-10 23:08:53 -0500] geggam: install a community server or have them create their own opscode account
[2013-12-10 23:09:03 -0500] geggam: mixing recipes causes messes
[2013-12-10 23:09:06 -0500] geggam: and tempers
[2013-12-10 23:09:12 -0500] jmickle: yeah
[2013-12-10 23:09:15 -0500] jmickle: people get angry
[2013-12-10 23:09:28 -0500] jmickle: thats the one design flaw if chef it seems
[2013-12-10 23:09:36 -0500] jmickle: not really great for large teams
[2013-12-10 23:09:42 -0500] jmickle: or maybe just us?
[2013-12-10 23:09:44 -0500] geggam: for a in `knife node list` ; do knife node delete ; done
[2013-12-10 23:09:50 -0500] geggam: pisses everyone off
[2013-12-10 23:09:53 -0500] geggam: :D
[2013-12-10 23:09:53 -0500] jmickle: haha
[2013-12-10 23:09:56 -0500] jmickle: awesome
[2013-12-10 23:10:11 -0500] Sauraus_: @henk76 I see the public key for the node, I can also see the node in the Nodes tab, but when I select Status it says no nodes for any of my environments
[2013-12-10 23:10:55 -0500] jmickle: hehe
[2013-12-10 23:11:38 -0500] henk76: did you select the right environment Sauraus_?
[2013-12-10 23:11:44 -0500] henk76: at the top?
[2013-12-10 23:12:22 -0500] Sauraus_: @henk76 I can select any environment from the top, and when I click the Status-tab it says no nodes, but clicking the nodes-tab lists the nodes
[2013-12-10 23:13:04 -0500] henk76: no clue Sauraus_. sorry.
[2013-12-10 23:13:34 -0500] jmickle: Sauraus_: from your workstation with knife setup
[2013-12-10 23:13:41 -0500] jmickle: Sauraus_: can you run knife node show nodename
[2013-12-10 23:13:48 -0500] jmickle: replace node name with a node
[2013-12-10 23:13:49 -0500] geggam: knife ec2 server create -E 'OPS_BETA'
[2013-12-10 23:14:08 -0500] jmickle: and paste bin it for me please
[2013-12-10 23:14:22 -0500] Sauraus_: @henk76 yes works just fine, I get all the details
[2013-12-10 23:15:34 -0500] henk76: i'm off to bed guys. need to be in the office in 7 hours again :(
[2013-12-10 23:15:45 -0500] Sauraus_: :D good luck sleeping ;)
[2013-12-10 23:15:56 -0500] jmickle: Sauraus_: any luck?
[2013-12-10 23:15:58 -0500] henk76: see yah
[2013-12-10 23:16:05 -0500] Sauraus_: @jmickle nope :(
[2013-12-10 23:16:15 -0500] jmickle: Sauraus_: can you please do a knife node show for me?
[2013-12-10 23:16:51 -0500] Sauraus_: then only weird thing with the data from knife node show nodename, is that the IP address returned is my public facing address and not the one on which the chef-server resides. All my nodes have 2-IP address
[2013-12-10 23:17:19 -0500] jmickle: pastebin please?
[2013-12-10 23:17:35 -0500] jmickle: feel free to remove confidential stuff
[2013-12-10 23:19:58 -0500] Sauraus_: http://pastebin.com/sP092Hjm
[2013-12-10 23:20:21 -0500] Blizzik: henk76: Helped! Thanks
[2013-12-10 23:20:22 -0500] geggam: people use chef on windows ?
[2013-12-10 23:20:27 -0500] jmickle: ok good
[2013-12-10 23:20:34 -0500] jmickle: so if you run chef-client on that box
[2013-12-10 23:20:37 -0500] jmickle: what happens?
[2013-12-10 23:20:40 -0500] justizin: geggam: PowerShell!
[2013-12-10 23:21:10 -0500] Sauraus_: all works, because chef.XXXX.LOCAL resolves on the private network just fine, and the cookbooks are downloaded and run on the client
[2013-12-10 23:21:36 -0500] jmickle: so what does your chef.rb file point to for chef url?
[2013-12-10 23:21:57 -0500] Sauraus_: https://chef.XXXXX.LOCAL which is a 10.11.xx.xx address
[2013-12-10 23:22:00 -0500] pedahzur: someara: So the nomethoderror was my fault.  Now am getting this with the line-cookbook: NoMethodError - undefined method `lines' for #<File:/etc/sysconfig/network>    Does Ruby 1.8.7 have a lines method on a file object?
[2013-12-10 23:22:02 -0500] jmickle: got it
[2013-12-10 23:22:13 -0500] jmickle: so you can run a chef-client successfully and it still does not report status?
[2013-12-10 23:22:51 -0500] jmickle: what happens if you run knife status?
[2013-12-10 23:23:50 -0500] Sauraus_: Nothing no data
[2013-12-10 23:24:01 -0500] jmickle: so most of that data is fed through ohai i believe
[2013-12-10 23:24:08 -0500] jmickle: what version of chef you running?
[2013-12-10 23:24:11 -0500] jmickle: and chef-client
[2013-12-10 23:24:28 -0500] Sauraus_: 11.8
[2013-12-10 23:24:50 -0500] jmickle: can you run chef-shell
[2013-12-10 23:24:51 -0500] EJC_: someara it all worked awesomely - thanks again man!
[2013-12-10 23:24:52 -0500] jmickle: on the box?
[2013-12-10 23:25:07 -0500] Sauraus_: what does the default_interface attribute do on the node?
[2013-12-10 23:25:20 -0500] Sauraus_: It's set to the public network NIC and not the private
[2013-12-10 23:26:01 -0500] jmickle: not sure
[2013-12-10 23:26:06 -0500] Sauraus_: chef-shell running now what?
[2013-12-10 23:26:30 -0500] jmickle: 1 sec trying to find the variable
[2013-12-10 23:26:30 -0500] jmickle: hehe
[2013-12-10 23:27:08 -0500] jmickle: oops sorry chef-shell -z
[2013-12-10 23:28:16 -0500] Sauraus_: uhm... validation.pem is empty on the node...
[2013-12-10 23:28:46 -0500] jmickle: uh it shouldn't be?
[2013-12-10 23:29:00 -0500] Sauraus_: right
[2013-12-10 23:29:12 -0500] jmickle: yeah so your bootstrap
[2013-12-10 23:29:16 -0500] jmickle: isn't setting up your nodes properly
[2013-12-10 23:29:25 -0500] Sauraus_: ah sorry wrong node :D
[2013-12-10 23:29:32 -0500] Sauraus_: that node wasn't setup yet :D
[2013-12-10 23:29:39 -0500] Sauraus_: I am now on a properly configured node
[2013-12-10 23:29:42 -0500] Sauraus_: and a shell
[2013-12-10 23:29:49 -0500] Sauraus_: and have a -z shell
[2013-12-10 23:29:50 -0500] jmickle: ha
[2013-12-10 23:29:52 -0500] jmickle: nodes.list
[2013-12-10 23:29:55 -0500] jmickle: does that return?
[2013-12-10 23:30:03 -0500] Sauraus_: empty
[2013-12-10 23:30:20 -0500] jmickle: cookbooks.list
[2013-12-10 23:30:20 -0500] jmickle: ?
[2013-12-10 23:30:36 -0500] Sauraus_: nil,nil,nil etc.
[2013-12-10 23:30:41 -0500] jmickle: so
[2013-12-10 23:30:48 -0500] jmickle: sounds like you are not communicated with chef-server
[2013-12-10 23:31:03 -0500] Sauraus_: I am because roles.all returns my roles
[2013-12-10 23:31:11 -0500] jmickle: but no cookbooks?
[2013-12-10 23:31:26 -0500] Sauraus_: environments.all => _default only... WTF??
[2013-12-10 23:31:47 -0500] jmickle: yeah something funky
[2013-12-10 23:31:48 -0500] Sauraus_: Chef::Node:0x135356c @name="lapp18"
[2013-12-10 23:31:57 -0500] Sauraus_: node returns data as well
[2013-12-10 23:32:17 -0500] jmickle: im not sure
[2013-12-10 23:32:24 -0500] jmickle: i think you might want to try support@opscode
[2013-12-10 23:32:26 -0500] jmickle: directly on this one
[2013-12-10 23:32:43 -0500] Sauraus_: thanks
[2013-12-10 23:32:57 -0500] jmickle: np
[2013-12-10 23:33:00 -0500] jmickle: interesting problem
[2013-12-10 23:33:18 -0500] jmickle: email them this may be some sort of bug or something
[2013-12-10 23:34:45 -0500] Sauraus_: ok this is weird, the passwords changed again on the server... WTF? This is the second time that rabbitmq & postgresql passwords changed on me!
[2013-12-10 23:40:13 -0500] Sauraus_: :D
[2013-12-10 23:51:44 -0500] someara: pedahzur sorry I wandered off... can you gist me an example?
[2013-12-10 23:54:09 -0500] pedahzur: someara: Sorry, moved on. It was the error I pasted. The lines recipe tried to use <file_object>.lines and got that error.  I wondered if it was due to using ruby 1.8.7, or an uncaught file open failure.
[2013-12-10 23:55:19 -0500] pedahzur: someara: It's OK...once I figured out the cause of my NoMethod error, I was able to use the script resource.  Not elegant, but it works.
[2013-12-10 23:55:21 -0500] someara: which resource are you using
[2013-12-10 23:55:26 -0500] someara: k
[2013-12-10 23:56:17 -0500] pedahzur: someara: I was using replace_or_add  The error was on line 47 of the replace_or_add provider, if I recall correctly.
[2013-12-10 23:59:02 -0500] someara: hrm... yea, no idea. I never learned ruby187
[2013-12-10 23:59:14 -0500] someara: I do owe that cookbook some spec though
