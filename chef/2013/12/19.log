[2013-12-19 00:16:58 -0500] GreatSUN: re
[2013-12-19 00:17:50 -0500] GreatSUN: can someone of you guys tell me if it is possible to setup attributes for an LWRP by just sending a hash?
[2013-12-19 00:19:17 -0500] miah: if your attribute is defined to be a hash
[2013-12-19 00:19:44 -0500] GreatSUN: miah: no, couple of attributes, just instead of transmitting one by one, sending the hash
[2013-12-19 00:19:48 -0500] GreatSUN: that was ment
[2013-12-19 00:19:50 -0500] miah: no.
[2013-12-19 00:20:01 -0500] miah: the resource's constructor isn't set to iterate over a block
[2013-12-19 00:20:25 -0500] miah: the attributes attached to the resource are actually getter/setter methods
[2013-12-19 00:21:16 -0500] miah: so, you could set the attributes based on hash contents. but you'll still need to write code to iterate over those and send the value to the attribute
[2013-12-19 01:18:56 -0500] josephholsten: coderanger: I'm trying to fix this cookbook: https://github.com/jssjr/chef-descartes/blob/master/recipes/default.rb
[2013-12-19 01:19:36 -0500] josephholsten: how do you feel about user, ruby, sinatra, thin sub-resources in application land?
[2013-12-19 01:20:20 -0500] josephholsten: I'm especially skeptical about user (note the gid, ssh_keys_path) and ruby resources
[2013-12-19 01:23:02 -0500] josephholsten: I'm guessing this author's forked version of application has a user resource that also creates a user and does something fancy with ssh keys
[2013-12-19 02:20:11 -0500] kewubenduben: hi. is it possible to do test-kitchen and disable these "[0m[36m" outputs?
[2013-12-19 03:09:32 -0500] coderanger: kewubenduben: What are you trying to do?
[2013-12-19 03:12:11 -0500] coderanger: kewubenduben: If you just pipe it though |cat it should not display color escapes
[2013-12-19 03:12:19 -0500] coderanger: thor just checks if it is displaying to TTY
[2013-12-19 03:41:18 -0500] lazypower: what is the proper way to skip an operation in a chef recipe if a file exists? https://gist.github.com/chuckbutler/8034085
[2013-12-19 03:43:53 -0500] lazypower: sorry i missed this attribute and asked too soon: not_if Use to prevent a resource from executing when the condition returns true.
[2013-12-19 03:44:08 -0500] jstump: lazypower: not_if with a File.exists?()
[2013-12-19 03:44:19 -0500] jstump: lazypower: Insanely handy as well. I use it frequently. :)
[2013-12-19 04:02:21 -0500] lazypower: I'm assuming that the not_if sentinel doesn't work with the template resource?
[2013-12-19 04:02:48 -0500] lazypower: oh wait nevermind it was bundler complaining.
[2013-12-19 04:53:10 -0500] josephholsten: coderanger: you're going to have to start doing subclassing in application_ruby soon
[2013-12-19 05:16:10 -0500] jstump: Has anyone seen this before? Or know of a fix? Chef finishes running successfully and then says "[2013-12-19T05:08:24+00:00] ERROR: Failed to post reporting data to server (HTTP 400), saving to /var/chef/cache/failed-reporting-data.json"
[2013-12-19 06:02:10 -0500] xapak: Hello there. Anybody knows how and where to report a bug in the Web interface?
[2013-12-19 06:12:04 -0500] xapak: If anything, please someone report that if you use the pessimistic (~) symbol in a cookbook_versions definition, like: "couchdb": "~> 2.0.0"
[2013-12-19 06:12:20 -0500] xapak: The Web UI wont let edit the environment attributes. :(
[2013-12-19 06:26:46 -0500] coderanger: xapak: You can report the bug on the opscode Jira
[2013-12-19 06:26:55 -0500] coderanger: xapak: But unless you include a patch it isn't likely to get fixed
[2013-12-19 06:27:09 -0500] coderanger: Opscode is, AFAIK, no longer maintaining the open source webui and you should disable it
[2013-12-19 06:32:57 -0500] xapak: coderanger, oh, I didnt know that. I guess I will have to do with knife environment edit. Thanks!
[2013-12-19 06:33:06 -0500] xapak: Yeah, thatll have to make do.
[2013-12-19 06:33:27 -0500] coderanger: If you would like a nice UI, the enterprise version now ships with a better one
[2013-12-19 06:34:08 -0500] xapak: Oh, does it? I think the company where I work is thinking about acquiring it. :D
[2013-12-19 06:34:51 -0500] coderanger: I'm probably biased, but I like it :-)
[2013-12-19 06:34:58 -0500] coderanger: (I should given that I worked on it for like a year)
[2013-12-19 06:36:24 -0500] xapak: Alright, thanks for the heads up. Ill check it out. ;)
[2013-12-19 06:36:26 -0500] xapak: Good night.
[2013-12-19 07:33:23 -0500] henk76: guys, If i make an environment Development with a cookbook version constraint named "appx" and version number x.y.z, How do i get the version number back in a recipe of a node that's in the development environment. I'm trying to lock down each environment with certain versions of custom software.
[2013-12-19 08:05:18 -0500] josephholsten: xapak: still there?
[2013-12-19 08:06:04 -0500] josephholsten: anyway, file tickets in https://tickets.opscode.com/secure/Dashboard.jspa
[2013-12-19 08:33:29 -0500] henk76: if you use environments, do you need to specifically say which cookbook goes to what environment with knife?
[2013-12-19 09:04:45 -0500] barbasa: morning yainnis
[2013-12-19 09:04:54 -0500] barbasa: ops...yannis
[2013-12-19 09:23:41 -0500] henk76: guys, If i want to run a block of code only when a service on windows is stopped, what is the proper "if" statement?
[2013-12-19 10:34:02 -0500] srini: Hi all
[2013-12-19 10:35:03 -0500] srini: If I were to use some attribute of the recipe defined in the attribtue/default.rb ins a "bash" block [:cookbook][:attribute] does'nt work.... How should I use it?
[2013-12-19 10:57:58 -0500] henk76: if i want to run a block of resources in a recipe based upon an only_if statement, what is the best way to do it?
[2013-12-19 11:00:05 -0500] GreatSUN: good morning
[2013-12-19 11:01:28 -0500] henk76: morning GreatSUN
[2013-12-19 11:04:27 -0500] GreatSUN: hi henk76
[2013-12-19 11:10:20 -0500] Cope: morning
[2013-12-19 11:28:37 -0500] tolbrino: hi there, I'm trying to get user passwords working using the 'users' cookbook on freebsd. SSH key-based authentication and sudo work fine, only the passwords don't seem to be set properly. I can't figure out how chef actually creates the users on freebsd. I have ruby-shadow installed but don't know yet where that comes into play.
[2013-12-19 11:35:25 -0500] lewiz: Hey guys.  I'd like to randomise the day on which a cron job runs.  I can generate a suitable random number between 1 and 7 but what's the best way to persist this across runs?  e.g. I don't want Chef to pick a new random day every 30 minutes.  Beyond setting this as a node attribute, does anybody have any helpful suggestions?
[2013-12-19 11:36:13 -0500] Cope: lewiz: I'll throw in my usual helpful suggestion!
[2013-12-19 11:36:45 -0500] Cope: lewiz: I suggest you tell us why you want to do that? it feels like an abuse of cron.. what is it you're actually trying to achieve?
[2013-12-19 11:37:25 -0500] lewiz: Cope: I'd like to reduce point load on a backup systems due to backups
[2013-12-19 11:38:41 -0500] Cope: aha - you have a scaling issue with backups, and rather than fix the backup system, you want to botch it with job splay?
[2013-12-19 11:38:58 -0500] Cope: ok - that's fair enough! :)
[2013-12-19 11:39:04 -0500] lewiz: Cope: Yes, exactly
[2013-12-19 11:39:23 -0500] Cope: so over what duration do you need to splay?
[2013-12-19 11:39:35 -0500] Cope: because you could just insert a random delay into the job
[2013-12-19 11:39:39 -0500] Cope: with eg a sleep
[2013-12-19 11:39:56 -0500] Cope: so have the job run at the same time, but with a delay of random duration
[2013-12-19 11:40:01 -0500] Cope: hardcoded in the cron job
[2013-12-19 11:40:11 -0500] Cope: that's how I used to splay puppet runs
[2013-12-19 11:40:21 -0500] gregkare: That would be much simpler indeed
[2013-12-19 11:40:22 -0500] lewiz: Cope: I'm familiar with that solution but the jobs will run at the same time just on different days.  It seems neater to have the specific day specified in the cron job.
[2013-12-19 11:40:50 -0500] gregkare: Good luck restoring something when your backups run on random days
[2013-12-19 11:41:27 -0500] lewiz: gregkare: This is a full mysql backup, incrementals are also running
[2013-12-19 11:42:51 -0500] Cope: why not specify precisely when machines will run - spread the out evenly; you could have the number/day in eg a databag, so when chef runs, the cron task gets allocated based on the value in the databag
[2013-12-19 11:43:54 -0500] gregkare: It's easy enough to generate a number, set it to an attribute on the node (and not generate another one if that attribute already exists), but it sounds wrong to me in that case
[2013-12-19 11:43:55 -0500] Cope: if you really wanted to randomise it you could write a simple rest api that returns a shuffled set of slots
[2013-12-19 11:44:10 -0500] Cope: and have chef call that - then you get some control
[2013-12-19 11:44:18 -0500] Cope: but really it sounds like a horrible hack
[2013-12-19 11:44:48 -0500] lewiz: Cope: Unfortunately time is the issue here, as well as reducing work.  A day picked at random is sufficient.  There's no need for more control
[2013-12-19 11:45:10 -0500] lewiz: gregkare: That's what I was planning but wanted to see whether people had other suggestions first
[2013-12-19 11:45:36 -0500] Cope: s/pick the node/pick the slot/
[2013-12-19 11:46:25 -0500] Cope: ie slot = node['backup_botch']['random_slot'] || get_random_slot
[2013-12-19 11:47:18 -0500] Cope: I feel your pain - it's annoying when you know you're working around broken shit but there's no time or money to do it properly
[2013-12-19 11:47:55 -0500] Cope: sysadmins - keeping fucktards in a job since 1969
[2013-12-19 11:48:26 -0500] drrk: Here, here
[2013-12-19 11:48:34 -0500] lewiz: ;)
[2013-12-19 12:02:07 -0500] Jamin: For some reason knife has stopped bootstrapping servers, I can issues other knife commands without problem
[2013-12-19 12:02:20 -0500] Jamin: are there any logs or ways I can get a better output on why it is failing
[2013-12-19 12:02:21 -0500] Jamin: eg.
[2013-12-19 12:02:25 -0500] Jamin: [chefadmin@workstation chef-repo]$ knife bootstrap x.x.x.x -x root -P xxxxx -V
[2013-12-19 12:02:25 -0500] Jamin: Bootstrapping Chef on x.x.x.x
[2013-12-19 12:02:25 -0500] Jamin: [chefadmin@workstation chef-repo]$
[2013-12-19 12:21:09 -0500] Jamin: anyway to get some better output from knife bootstrap?
[2013-12-19 12:29:47 -0500] bjoern_: How do you skip the converge of a recipe / cookbook when the platform family doesn't match, ideally with a meaningful warning message?
[2013-12-19 12:33:21 -0500] workmad3: bjoern_: I'd probably do it by using a wrapper cookbook that did a 'case node['platform_family'] ', including the recipe when a suitable family is in use and using Chef::Log.info("Skipping <recipe> on unsupported platform #{node[:platform_family]}") in an 'else' clause
[2013-12-19 12:36:18 -0500] bjoern_: workmad3: thanks. my idea is to call `exit` or `abort` when the platform family doesn't match. I wonder if thats the idiomatic "chef" way?
[2013-12-19 12:38:05 -0500] workmad3: bjoern_: no
[2013-12-19 12:38:18 -0500] bjoern_: ok :-)
[2013-12-19 12:38:41 -0500] workmad3: bjoern_: that would exit from the entire chef run... I'd be doubtful if even things like report handlers got properly processed
[2013-12-19 12:39:05 -0500] workmad3: bjoern_: but more importantly... it would mean that any other recipes in the run list wouldn't get processed
[2013-12-19 12:39:37 -0500] bjoern_: workmad3: makes sense. I'll go with your approach
[2013-12-19 12:45:46 -0500] jintux: undefined method `message' for Chef::Resource::Log
[2013-12-19 12:46:06 -0500] jintux: i get this error with wordpress cookbook
[2013-12-19 12:54:53 -0500] paresh: can i auto discover a node and bootstrap it using chef
[2013-12-19 12:57:49 -0500] paresh: anybody der
[2013-12-19 12:59:03 -0500] s2r2: paresh: could you explain what you're looking for?  autodiscovery is not self-explanatory
[2013-12-19 12:59:50 -0500] paresh: s2r2: i want a node to be added in chef server once the node is up in some subnet (aws autoscaling)
[2013-12-19 13:01:18 -0500] s2r2: paresh: afaik cloudformation allows you to insert files and run stuff.  so insert your chef-validator, a first-boot.json and run chef-client :)
[2013-12-19 13:02:58 -0500] paresh: but i would have to run a command manually on chef server to perform bootstrap or it will do it on its own ? sorry but m new to chef :)
[2013-12-19 13:03:04 -0500] paresh: s2r2:
[2013-12-19 13:03:16 -0500] paresh: s2r2: but i would have to run a command manually on chef server to perform bootstrap or it will do it on its own ? sorry but m new to chef :)
[2013-12-19 13:03:41 -0500] s2r2: paresh: you don't need to interact. the chef-client will do whatever the json files tells it it do, i.e. you include a run_list there. oh an I forgot, you need to inject a client.rb pointing to chef server, of course.
[2013-12-19 13:04:59 -0500] s2r2: paresh: you don't touch the server except to put cookbooks and roles there, adjust environments or (dont do that) fiddle with node attributes.  from then on, chef-client's pull there stuff and register themselves.  (given a chef-validator.pem)
[2013-12-19 13:10:23 -0500] paresh: s2r2: so my first-boot.json will do everything from adding the node to downloading stuff from chef and exexcuting cookbooks or recipies
[2013-12-19 13:12:27 -0500] s2r2: paresh: no magic will happen, so all the needed information has to be given to the machine.  the chef server url will be in the client.rb, the auth cert is chef-validator.pem (its path is in client.rb), the stuff to do (run_list, attributes) will be in a json file.  You need to create these files using cloudformation AND call chef-client with the proper arguments, either relying on the defaults (ie. config is in
[2013-12-19 13:12:27 -0500] s2r2: /etc/chef/client.rb) or by "chef-client -c /path/to/client.rb -j /path/to/first-boot.json".  there's no default for the json file.
[2013-12-19 13:13:07 -0500] s2r2: you need to call the client manually unless you've set up some other way to execute it (as part of the image you use, maybe.)
[2013-12-19 13:13:38 -0500] s2r2: paresh: cloud-init can be helpful, since it wraps up that stuff into a yaml snippet; however, I am not sure how that will interact with cloudformation
[2013-12-19 13:13:49 -0500] paresh: okay
[2013-12-19 13:14:03 -0500] paresh: s2r2: thanks a lot for the info
[2013-12-19 13:14:14 -0500] s2r2: paresh:  :)
[2013-12-19 13:57:54 -0500] henk76: if there a way that chef runs a command on all the files in a certain directory?
[2013-12-19 13:58:52 -0500] henk76: like for i in `ls` ; do mysql -uroot -p<password> < $i ; done
[2013-12-19 14:10:49 -0500] allaire: do you keep your encrypted databags in your chef repo?
[2013-12-19 14:30:58 -0500] StefanS: Is it possible to read attributes from a file on a node? Or some other way to set an attribute on a node from within the node?
[2013-12-19 14:31:22 -0500] marcusmorris: does anybody know if this bug has been fixed?
[2013-12-19 14:31:23 -0500] marcusmorris: https://tickets.opscode.com/browse/CHEF-3999
[2013-12-19 14:31:34 -0500] marcusmorris: or how I can resolve the ssl warning
[2013-12-19 14:31:56 -0500] marcusmorris: does knife not work if ssl is broken?
[2013-12-19 14:35:29 -0500] StefanS: I guess I have to make an ohai plugin.
[2013-12-19 14:42:43 -0500] henk76: what is the best way to avoid recipes failing on the space in the path c:\program files\blablabla
[2013-12-19 14:45:16 -0500] laurent\: StefanS: depending on what you want to achieve, it might be a better idea to use an ohai plugin
[2013-12-19 14:47:02 -0500] laurent\: otherwise from chef, read file, parse it, node.set['un']['deux'] = something
[2013-12-19 14:47:16 -0500] StefanS: ok, thanks
[2013-12-19 15:30:00 -0500] GreatSUN: bye --> home
[2013-12-19 15:53:31 -0500] ptrf: so, I'm include_recipe'ing monitor::default from the monitor cookbook, which in turn includes sensu::client_service
[2013-12-19 15:54:06 -0500] ptrf: and in sensu::client_service, there's a resource: sensu_service "sensu-client" do ...
[2013-12-19 15:54:29 -0500] ptrf: so I try to rewind that resource
[2013-12-19 15:55:10 -0500] ptrf: and I get [2013-12-19T15:47:41+00:00] ERROR: Cannot find a resource matching sensu_service[sensu-client] (did you define it first?)
[2013-12-19 16:02:48 -0500] ptrf: oh, nevermind
[2013-12-19 16:02:51 -0500] trilitheus: Hi - want to do a quick chef environment check in a cookbook to set an attribute one way or another
[2013-12-19 16:02:55 -0500] ptrf: sensu_service is not an actual resource...
[2013-12-19 16:03:31 -0500] trilitheus: Shiould I be able to do an if node[:chef_environment] == "development" statement? Will that work?
[2013-12-19 16:03:43 -0500] micgo: trilitheus: yep
[2013-12-19 16:04:27 -0500] micgo: as long as the node you are running on is in an environment called "development" of course
[2013-12-19 16:05:53 -0500] trilitheus: micgo, thanks I thought so - but doesn;t seem to work - I've tried checking the attributes set at which precedence level by doing the "include pp" thing found in "Debugging Attributes" section of this page  http://www.getchef.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/
[2013-12-19 16:06:10 -0500] trilitheus: micgo, of course :)
[2013-12-19 16:07:24 -0500] micgo: trilitheus: it shouldn't matter, but try using -- if node['chef_environment'] == "development"
[2013-12-19 16:08:23 -0500] micgo: also, do you have gist or something with the output of your node object you are trying to run on?
[2013-12-19 16:08:49 -0500] micgo: knife node show [nodename] -Fj -l > node.txt
[2013-12-19 16:14:58 -0500] trilitheus: micgo, chef["environment"] didn;t work - but it gave me a clue and I used node.chef_environment and that DOES work!  Thanks for the hint - got my brain working :)
[2013-12-19 16:15:29 -0500] trilitheus: remember jtimberman saying something along the lines of is because chef_environment is a method and not an attribute or something like that
[2013-12-19 16:15:50 -0500] micgo: ahhh..right
[2013-12-19 16:16:10 -0500] chris613: Hi. I have a freshly build server using chef-server 2.0.0 cookbook and bookshelf is failing to start, spamming the logs with "Usage: bookshelf {start|stop|restart|reboot|ping|console|console_clean|attach}" as if the runing script is doing the wrong thing.
[2013-12-19 16:16:33 -0500] chris613: I couldn't find a bug report about this, but thought I'd ask here first. All the other components are running fine AFAICT
[2013-12-19 16:19:24 -0500] micgo: chris613: are you manually starting the chef server using 'chef-server-ctl start'?
[2013-12-19 16:20:46 -0500] chris613: micgo: No, it starts on boot. But I did try doing `chef-server-ctl stop` and `chef-server-ctl start` and the results were the same
[2013-12-19 16:21:09 -0500] chris613: Centos 6.4
[2013-12-19 16:22:12 -0500] chris613: The runit script looks like this: "exec chpst -P -u chef_server -U chef_server env HOME=/var/opt/chef-server/bookshelf /opt/chef-server/embedded/service/bookshelf/bin/bookshelf runit"   as you can see it doesn't say "bookshelf start" as the error message describes.
[2013-12-19 16:22:20 -0500] chris613: I feel like I wouldn't be the first person to notice this, though....
[2013-12-19 16:32:21 -0500] trilitheus: does anyone know if nagios 5 cookbookhandles cases where no nodes in a servergroup (role)
[2013-12-19 16:32:35 -0500] marcusmorris: anyone know why I get `initialize': getaddrinfo: nodename nor servname provided, or not known (SocketError) when uploading cookbooks?
[2013-12-19 16:33:21 -0500] micgo: chris613: hmmm.. and you are running the command with sudo/root privileges, right?
[2013-12-19 16:34:00 -0500] micgo: that should work fine. I just did a fresh install on CentOS 6.4 yesterday morning. That cookbook is just running the commands you would do manually, so I can't see anything odd there
[2013-12-19 16:35:01 -0500] chris613: micgo: Yes. I think I might have found my problem. Yesterday while I was exploring the upstart/runit config I probably ran something as root that is supposed to be run as chef_server and there is actually a permissions problem somewhere. Noticed this because rabbitmq is complaining of such.
[2013-12-19 16:35:10 -0500] chris613: I'll try it again on an even fresher install ;)
[2013-12-19 16:35:27 -0500] micgo: good luck!
[2013-12-19 16:35:39 -0500] trilitheus: marcusmorris, what version chef?
[2013-12-19 16:35:50 -0500] trilitheus: and have you got chef server configured in knife.rb?
[2013-12-19 16:36:02 -0500] marcusmorris: 11.8.2
[2013-12-19 16:36:11 -0500] marcusmorris: I have knife.rb configured using the IP
[2013-12-19 16:36:19 -0500] tolbrino1: Anybody using FreeBSD clients hanging around?
[2013-12-19 16:36:22 -0500] marcusmorris: because the hostname isn't working
[2013-12-19 16:36:59 -0500] marcusmorris: I can upload roles
[2013-12-19 16:37:04 -0500] marcusmorris: and check nodes and clients
[2013-12-19 16:37:08 -0500] marcusmorris: but can't upload cookbook
[2013-12-19 16:37:25 -0500] micgo: marcusmorris: Is your .chef directory in your user home?
[2013-12-19 16:37:35 -0500] marcusmorris: yes
[2013-12-19 16:37:47 -0500] micgo: so things like knife client list work?
[2013-12-19 16:37:50 -0500] marcusmorris: yea
[2013-12-19 16:38:02 -0500] marcusmorris: I was able to bootstrap a node
[2013-12-19 16:38:07 -0500] marcusmorris: but can't upload cookbook
[2013-12-19 16:38:33 -0500] micgo: do you have multiple .chef directories lying around?
[2013-12-19 16:38:52 -0500] marcusmorris: no
[2013-12-19 16:39:05 -0500] marcusmorris: i have multiple knife.rb's handled bu knife-block
[2013-12-19 16:39:09 -0500] marcusmorris: but that works fine
[2013-12-19 16:39:28 -0500] micgo: try running it with -VV and look at the URL its posting to
[2013-12-19 16:39:50 -0500] sassamo: error: invalid byte sequence US-ASII in a template of an xml formated UTF-8. How do I fix this behavior
[2013-12-19 16:40:11 -0500] marcusmorris: micgo: here is the output
[2013-12-19 16:40:12 -0500] marcusmorris: https://gist.github.com/MrMMorris/045104be21b1fb5f0364
[2013-12-19 16:40:44 -0500] micgo: marcusmorris: I assume that IP is resolvable from your machine?
[2013-12-19 16:41:12 -0500] micgo: also.... it looks like it switches IPs midstream for some reason
[2013-12-19 16:42:02 -0500] marcusmorris: I can ping between the node and server as well as between the workstation and server
[2013-12-19 16:42:39 -0500] micgo: right, but I think this may be something about your chef server config. Are you running on AWS perchance?
[2013-12-19 16:43:19 -0500] marcusmorris: openstack
[2013-12-19 16:43:30 -0500] micgo: I only ask because the initial sandbox call looks like it's going to a 10.x.x.x address, but when you try to put the cookbooks it's going to the public address space
[2013-12-19 16:43:34 -0500] gregkare: I'm pretty sure your Chef server needs to have a proper FQDN for things to work properly
[2013-12-19 16:44:02 -0500] marcusmorris: the only thin changes on the chef-server is I set non-use to true
[2013-12-19 16:44:10 -0500] marcusmorris: non-ssl
[2013-12-19 16:44:24 -0500] marcusmorris: if i run hostname -f
[2013-12-19 16:44:31 -0500] marcusmorris: it gives me the fqdn
[2013-12-19 16:45:04 -0500] marcusmorris:  /etc/hosts and /etc/hostname are set
[2013-12-19 16:45:21 -0500] marcusmorris: do I need to have a static IP set up?
[2013-12-19 16:45:30 -0500] micgo: marcusmorris: it shouldn't
[2013-12-19 16:46:06 -0500] micgo: are you using the FQDN in your knife.rb?
[2013-12-19 16:46:13 -0500] marcusmorris: no
[2013-12-19 16:46:53 -0500] micgo: try switching to the FQDN and using that instead. I know I've had problems with the whole internal/external IP space on AWS before
[2013-12-19 16:47:10 -0500] marcusmorris: if i change it in knife.rb, then nothing works
[2013-12-19 16:47:32 -0500] marcusmorris: knife client list gives me the same getaddinfo error
[2013-12-19 16:47:39 -0500] gregkare: Your Chef server is probably set to 199.128.24.10, also why are you setting ssl to false?
[2013-12-19 16:48:22 -0500] marcusmorris: because if I don;t then when I try to use knife, nginx gives me a 502 Bad gateway
[2013-12-19 16:48:29 -0500] marcusmorris: because ssl isn't set up
[2013-12-19 16:49:19 -0500] gregkare: I think you should fix your server, I don't think fiddling with your knife.rb will change anything
[2013-12-19 16:49:55 -0500] marcusmorris: can I use a sel-signed ssl vert for the server?
[2013-12-19 16:49:59 -0500] marcusmorris: self*
[2013-12-19 16:50:11 -0500] marcusmorris: or how do I get rid of the ssl error
[2013-12-19 17:02:08 -0500] ggolin: good time of day
[2013-12-19 17:02:21 -0500] Jamin: it's better on fridays :P
[2013-12-19 17:04:28 -0500] ggolin: question regarding the ruby_block resourse.  are the variables set inside the block available outside of the block?
[2013-12-19 17:08:27 -0500] earsplit: hey anyone around?
[2013-12-19 17:09:16 -0500] ggolin: uhhuh
[2013-12-19 17:10:33 -0500] geggam: getting rounder and rounder everyday christmas baking happens
[2013-12-19 17:14:03 -0500] earsplit: *insert joke about chef and eating*
[2013-12-19 17:14:05 -0500] earsplit: i have a weird issue
[2013-12-19 17:14:13 -0500] earsplit: i'm trying to call a bash script from a recipe
[2013-12-19 17:14:28 -0500] earsplit: and run the script as a different user
[2013-12-19 17:14:37 -0500] earsplit: i'll send you an example
[2013-12-19 17:15:05 -0500] geggam: earsplit,  man su ... su -c "script"
[2013-12-19 17:15:17 -0500] earsplit: is that the only way to go?
[2013-12-19 17:15:27 -0500] earsplit: the user / group thing doesn't seem to work as i thought it would
[2013-12-19 17:15:32 -0500] geggam: dunno if its the only.. but its simple
[2013-12-19 17:15:37 -0500] geggam: i like simple
[2013-12-19 17:15:47 -0500] juliancdunn: earsplit: wdym "doesn't seem to work as I thought it would"
[2013-12-19 17:15:52 -0500] earsplit: https://gist.github.com/windelicato/b7b8dee3357e4f7fe4c9
[2013-12-19 17:16:20 -0500] earsplit: those echos return 'root' and /root/
[2013-12-19 17:16:27 -0500] earsplit: as opposed to
[2013-12-19 17:16:32 -0500] earsplit: deploy and /home/deploy
[2013-12-19 17:16:41 -0500] geggam: you are building on production systems ?
[2013-12-19 17:16:49 -0500] earsplit: yeah
[2013-12-19 17:17:01 -0500] geggam: ever hear of jenkins ? fpm and Continous integration ?
[2013-12-19 17:17:23 -0500] earsplit: yeah we use jenkins for testing
[2013-12-19 17:17:31 -0500] juliancdunn: earsplit: probably because seteuid doesn't reset 'em
[2013-12-19 17:17:45 -0500] geggam: how about using jenkins to build 1 package... FPM is a ruby gem making packaging simple
[2013-12-19 17:18:00 -0500] geggam: then install the package from yum with the package  thingy ?
[2013-12-19 17:18:16 -0500] geggam: think of the processors... they will thank you
[2013-12-19 17:18:40 -0500] earsplit: hmmm interesting
[2013-12-19 17:18:55 -0500] geggam: its a "new" old thing
[2013-12-19 17:19:13 -0500] earsplit: i'll look into it
[2013-12-19 17:19:18 -0500] geggam: also allows you to deploy faster
[2013-12-19 17:19:19 -0500] earsplit: either way, this should work, no?
[2013-12-19 17:20:56 -0500] geggam: $USER would be chef-client no ?
[2013-12-19 17:21:30 -0500] earsplit: defaults to root for me
[2013-12-19 17:21:36 -0500] earsplit: i'm using opsworks
[2013-12-19 17:21:39 -0500] earsplit: because deadlines
[2013-12-19 17:21:53 -0500] earsplit: i would be using chef solo if i had an extra month
[2013-12-19 17:21:55 -0500] geggam: maybe change the case to match ?
[2013-12-19 17:22:06 -0500] earsplit: which case?
[2013-12-19 17:22:14 -0500] geggam: you set user but use USER
[2013-12-19 17:23:06 -0500] geggam: [danielbe@domU-12-31-39-13-D9-68 ~]$ export user="foo" ; echo $USER
[2013-12-19 17:23:06 -0500] geggam: danielbe
[2013-12-19 17:23:29 -0500] geggam: [danielbe@domU-12-31-39-13-D9-68 ~]$ echo $user
[2013-12-19 17:23:29 -0500] geggam: foo
[2013-12-19 17:23:33 -0500] geggam: see ?
[2013-12-19 17:24:01 -0500] earsplit: where do i set $user?
[2013-12-19 17:24:30 -0500] geggam:  bash "running build script" do
[2013-12-19 17:24:30 -0500] geggam: user "deploy" ?
[2013-12-19 17:24:57 -0500] geggam: not sure if that sets the variable or what you are doing but you use a $USER variable i dont see set
[2013-12-19 17:25:12 -0500] earsplit: i'll dig into the resource
[2013-12-19 17:25:25 -0500] earsplit: but the documentation says
[2013-12-19 17:25:30 -0500] earsplit: The user name or user ID that should be changed before running a command.
[2013-12-19 17:25:31 -0500] geggam: simplify ... not complexify
[2013-12-19 17:25:55 -0500] earsplit: i'm just trying to figure out why its not changing users
[2013-12-19 17:25:57 -0500] earsplit: thats all
[2013-12-19 17:28:09 -0500] geggam:   source deploy/build.sh >> deploy/build.log 2> deploy/build.error.log what are you trying to do there
[2013-12-19 17:28:27 -0500] geggam: sourcing a bash script just reads it
[2013-12-19 17:28:38 -0500] earsplit: that was a bad version of that file
[2013-12-19 17:28:46 -0500] earsplit: even without the source
[2013-12-19 17:28:47 -0500] geggam: bash deploy/build.sh >> deploy/build.log 2> deploy/build.error.log
[2013-12-19 17:29:20 -0500] earsplit: i'll try that
[2013-12-19 17:29:21 -0500] geggam: as far as the $USER.. i dont know if the chef resource switches the env variable or not
[2013-12-19 17:29:31 -0500] earsplit: i'm looking into packaging too
[2013-12-19 17:29:35 -0500] earsplit: that seems like an awesome solution
[2013-12-19 17:29:40 -0500] geggam: packaging is the only way to go
[2013-12-19 17:29:57 -0500] geggam: well... that is an argument that is easy to start .. its one of the ways to go
[2013-12-19 17:30:14 -0500] earsplit: the servers are running ubuntu but it looks like there are plugins for debs as well
[2013-12-19 17:30:23 -0500] geggam: gem install fpm
[2013-12-19 17:30:26 -0500] geggam: run fpm
[2013-12-19 17:30:29 -0500] earsplit: i'll look that up
[2013-12-19 17:30:34 -0500] earsplit: thanks for your help
[2013-12-19 17:30:41 -0500] earsplit: i've only been doing this stuff for a month or so
[2013-12-19 17:30:45 -0500] geggam: avoiding work is all
[2013-12-19 17:31:07 -0500] geggam: some nimrod upgraded the ami to centos 6.5 so i have to rebuild everything
[2013-12-19 17:31:14 -0500] dadleyy: is there a way to use one action of a provider as the value of the conditional for another action through the "only_if"
[2013-12-19 17:31:15 -0500] mveitas: I am trying to write some Chefspec for a cookbook... anybody know how I could mock a value in Chef::Config? It is failing on the following line: https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/delete_validation.rb#L28
[2013-12-19 17:31:57 -0500] mveitas: can't convert nil into String -- /var/folders/09/gn7j2wx96sgclgjy48y90t780000gn/T/d20131219-41012-180jpbf/chef-client/recipes/delete_validation.rb:28:in `exists?'
[2013-12-19 17:35:26 -0500] dadleyy: is this possible/what is the best way of handling a situation like this: http://codepad.org/6e1LxFkB
[2013-12-19 17:36:04 -0500] dadleyy: does that responsibility lie with the provider?
[2013-12-19 17:36:35 -0500] dadleyy: or is it the recipe's responsibility to check pre-existing instances of things
[2013-12-19 17:37:05 -0500] JayF: generally the resource should be handling idempotency
[2013-12-19 17:41:27 -0500] dadleyy: JayF: so you're suggesting the bottom option: http://codepad.org/WeZgm4cW
[2013-12-19 17:42:37 -0500] JayF: dadleyy: on a very high level, yes; but that being said, I've used third-party cookbooks that didn't handle idempotency well so I walled them off separately
[2013-12-19 17:43:54 -0500] dadleyy: gotcha.
[2013-12-19 17:47:17 -0500] chinonami: Question for anyone familiar with the postgresql recipe. I'm trying to override the pg_hba attribute in a recipe to automatically add lines for nodes based on a chef search but it's not working for me.
[2013-12-19 17:47:25 -0500] chinonami: s/recipe/cookbook
[2013-12-19 18:41:11 -0500] kavi: someone please advise, how to Install Chef Manager on open source chef server?
[2013-12-19 18:42:04 -0500] geggam: chef server ?
[2013-12-19 18:42:12 -0500] geggam: what is chef manager ?
[2013-12-19 18:59:43 -0500] Mai__: hi, not sure if this is the right place to ask.  I'm trying out enterprise chef and failed to run the private-chef reconfigure on the front-end nodes.  It failed at generate-keys section even though i already copied the whole /etc/opscode folder from the bootstrap backend machine.  any pointers ?
[2013-12-19 19:00:55 -0500] Mai__: hello ? :)
[2013-12-19 19:01:06 -0500] Mai__: guess it's a quiet channel
[2013-12-19 19:20:08 -0500] marcusmorris: what's the current best practice for setting attributes?
[2013-12-19 19:20:17 -0500] marcusmorris: is the attributes file still used?
[2013-12-19 19:20:22 -0500] marcusmorris: should they be put in recipes?
[2013-12-19 19:26:25 -0500] alop: anyone know how to use knife to show an attribute with a dot in the name?
[2013-12-19 19:31:17 -0500] kavi: how to install cehf manger plugin on open source chef servres
[2013-12-19 19:38:11 -0500] b-dean: I'm having a crazy encoding problem with mixlib-shellout and bundler and I'm not sure who to ask about it. I asked in the bundler room but they think mixlib-shellout may be to blame. is there a better room to ask about other opscode stuff?
[2013-12-19 19:48:29 -0500] jtimberman: b-dean: chef-hacking, or the mailing lists
[2013-12-19 19:48:33 -0500] jtimberman: that is, #chef-hacking
[2013-12-19 19:48:55 -0500] b-dean: thx
[2013-12-19 19:50:31 -0500] ush: if a nested attribute contains a period how can it be escaped for "knife node show -a $nodename $attributename.$nested.attributename" please?
[2013-12-19 19:50:59 -0500] ush: have already tried backslashing the period and putting various types of quotes around it
[2013-12-19 19:52:33 -0500] jtimberman: ush: i don't think it can, which is an unfortunate thing. since attribute keys are strings, they can contain any character, which makes it awkward trying to find a universal delimiter that works in all shells.
[2013-12-19 19:53:07 -0500] ush: jtimberman: thank you, saves me time beating on that door :)
[2013-12-19 19:54:47 -0500] DandyPandy: Can you do something like a 'run_list add' on all nodes matching a search?
[2013-12-19 19:56:28 -0500] DandyPandy: nevermind. found what I was looking for
[2013-12-19 20:20:15 -0500] jidar: anybody doing windows server renames via bootstrap?
[2013-12-19 20:50:55 -0500] werdnativ: I'm reading "Test Driven Infrastructure with Chef, 2nd Edition", it covers the full toolchain for authoring one cookbook really well, but I'm still confused: is everything for an organization done within the context of ONE cookbook?
[2013-12-19 20:52:03 -0500] werdnativ: Is it that Berkshelf lets you have dependencies on other cookbooks from within one master cookbook?
[2013-12-19 20:52:31 -0500] werdnativ: Or do you have a "wrapper" project with a cookbooks directory in it?
[2013-12-19 20:53:18 -0500] werdnativ: I'm thinking back to the "chef-repo" pattern which had everything in it...
[2013-12-19 20:55:03 -0500] werdnativ: after reading countless blog posts and this book, I'm still not sure how to best organize my infrastructure's chef stuff to keep it maintainable.
[2013-12-19 20:55:57 -0500] gchristensen: werdnativ: erm, yes. many small cookbooks, not one monster cookbook. berkshelf is good. wrapper cookbooks is good. editing public cookbooks is bad
[2013-12-19 20:57:17 -0500] werdnativ: gchristensen: so you recommend the "wrapper" cookbook would still, at the outer layer, still be a cookbook? not a git repo with /cookbooks?
[2013-12-19 20:57:27 -0500] gchristensen: werdnativ: correct
[2013-12-19 20:57:35 -0500] werdnativ: cool, that helps.
[2013-12-19 20:57:49 -0500] gchristensen: it gives more granularity into what a version bump means
[2013-12-19 20:58:06 -0500] gchristensen: so you want a version bump to not impact different things, they should be isolated
[2013-12-19 20:59:04 -0500] werdnativ: so that implies myapp-web and myapp-db are two separate cookbooks, and not myapp::web for example.
[2013-12-19 20:59:14 -0500] werdnativ: that makes sense.
[2013-12-19 21:04:40 -0500] bitgangsta: Hey all- I have a resource writing a file. It runs every time chef does (which I intended) but the file is rather large and it generates verbose log output in the Chef log. Is there any way to tell a resource not to log what it's doing? I don't see any way to control logging in chef...
[2013-12-19 21:05:14 -0500] ranjib: bitgangsta, theres no way you can control per resource log level in chef
[2013-12-19 21:05:32 -0500] bitgangsta: ranjib, can I control the entire log-leveL?
[2013-12-19 21:05:35 -0500] ranjib: iirc there a recent patch which allows masking sensitive stuff from logging
[2013-12-19 21:05:51 -0500] bitgangsta: ranjib, I could wrap the call to the resource w/ a function that takes a block and changes it globally
[2013-12-19 21:05:51 -0500] ranjib: hell yeah.. --force-logger -L warn
[2013-12-19 21:05:59 -0500] bitgangsta: ranjib, how about in code?
[2013-12-19 21:06:27 -0500] bitgangsta: ranjib, guess I could look at the --force-logger flag and see how it does it
[2013-12-19 21:07:38 -0500] ranjib: when you invoke chef-client from  a tty it automatically uses the doc formatter instead of the logger. without tty it falls back to logger.
[2013-12-19 21:07:59 -0500] ranjib: --force-logger and --force-formatter lets you control that behavior explicitly
[2013-12-19 21:09:07 -0500] bitgangsta: ranjib, ah I see  if (STDOUT.tty? && !Chef::Config[:force_logger]) || Chef::Config[:force_formatter]
[2013-12-19 21:09:55 -0500] ranjib: yup.. i dont use the formatter unless im using why_run or debugging something..
[2013-12-19 21:10:48 -0500] bitgangsta: ranjib, I'm using solo so I guess I'm always using the formatter
[2013-12-19 21:11:30 -0500] bitgangsta: Also I'm sure you guys know but the whole attributes system was overhauled in chef 11, and the docs are wrong in a few areas now heh
[2013-12-19 21:11:37 -0500] bitgangsta: I had to read through the specs to understand it
[2013-12-19 21:11:49 -0500] ranjib: yeah... all Chef::Application derivatives uses that logic iirc (i.e. client, solo, apply)
[2013-12-19 21:14:14 -0500] bitgangsta: ranjib, do you think there'd be anything stopping me from setting Chef::Log.level before and after my resource?
[2013-12-19 21:14:48 -0500] gchristensen: bitgangsta: how is the file that is so large being generated?
[2013-12-19 21:15:15 -0500] ranjib: bitgangsta, i am not sure if that will work
[2013-12-19 21:15:21 -0500] bitgangsta: gchristensen, it's not so large it's screwing anything up, I just don't want to see it in stdout in runs. It is at least 1k
[2013-12-19 21:15:31 -0500] gchristensen: bitgangsta: alternatively is you could use a bash resource and then it would be less verbose, also if thediff its outputting is so long, it might be worth changing the max lines of a diff
[2013-12-19 21:15:48 -0500] ranjib: because when the provider will be kicked in .. you are actually using the log level thats specified last..
[2013-12-19 21:15:50 -0500] bitgangsta: gchristensen, OH! How can you set the diff marlines?
[2013-12-19 21:15:56 -0500] bitgangsta: gchristensen, maxlines*
[2013-12-19 21:15:56 -0500] gchristensen: bitgangsta: diff_output_threshold 100000 <- number of characters in the diff, more than this limit and it'll supress it
[2013-12-19 21:16:04 -0500] gchristensen: its actually the # of characters which is a bit weird
[2013-12-19 21:16:05 -0500] bitgangsta: gchristensen, ah fantastic
[2013-12-19 21:16:06 -0500] ranjib: since you are tweaking the log level inside recipe, not inside provider
[2013-12-19 21:16:06 -0500] werdnativ: How do you manage your .chef/knife.rb within a Berkshelf project? Or do you just keep it in your HOME and run "knife cookbook create" commands from anywhere?
[2013-12-19 21:16:41 -0500] gchristensen: werdnativ: I do 'berks cookbook <cookbook>' to do it
[2013-12-19 21:16:52 -0500] werdnativ: ah!
[2013-12-19 21:17:14 -0500] gchristensen: bitgangsta: I set diff_output_threshold to 100000 to supress the cpanm download :)
[2013-12-19 21:18:16 -0500] gchristensen: jtimberman: this might be completely pointless, but it might be useful to document diff_output_threshold 100000 in the client.rb for the perl cookbook, since the cpanm output is so monstrous
[2013-12-19 21:20:31 -0500] bitgangsta: So I understand knife.rb correctly- Chef will merge the per-project knife.rb with my ~/.chef/knife.rb at runtime? So we can have private / per user stuff in my ~/.chef and per-project settings committed into the repo?
[2013-12-19 21:26:45 -0500] jakubzalas: hi. is there anything that needs to be configured on a box for chef to work with vagrant? I'm not sure if my box is ready to run chef...
[2013-12-19 21:26:54 -0500] jakubzalas: "Running chef-solo..." takes forever
[2013-12-19 21:27:06 -0500] jakubzalas: if i run vagrant in debug mode I keep getting "DEBUG ssh: Sending SSH keep-alive..."
[2013-12-19 21:28:16 -0500] chef_newbie: hey guys Im seeing chef client forking over and over again..can anyone help me why would that be happening?
[2013-12-19 21:29:14 -0500] chef_newbie: ps auwx | grep -i chef | wc -l
[2013-12-19 21:29:14 -0500] chef_newbie: 1175
[2013-12-19 21:29:34 -0500] chef_newbie: the client runs with -i 1800 and -s 300
[2013-12-19 21:29:53 -0500] fak3r: ouch, I had that on Centos, was timing out on something like ntp - I added a retry so it wouldn't respawn on itself like that
[2013-12-19 21:30:02 -0500] fak3r: had an post on the ML about it...
[2013-12-19 21:30:36 -0500] chef_newbie: its a Centos5.8 box
[2013-12-19 21:31:48 -0500] chef_newbie: when i look at the logs..chef run finishes successfully but then another one would spawn up
[2013-12-19 21:33:41 -0500] chef_newbie: look at the time stamps
[2013-12-19 21:33:41 -0500] chef_newbie: [2013-12-19T12:03:49-06:00] INFO: Chef Run complete in 14.613516 seconds
[2013-12-19 21:33:42 -0500] chef_newbie: [2013-12-19T12:03:49-06:00] INFO: Running report handlers
[2013-12-19 21:33:42 -0500] chef_newbie: [2013-12-19T12:03:49-06:00] INFO: Report handlers complete
[2013-12-19 21:33:42 -0500] chef_newbie: [2013-12-19T12:04:18-06:00] INFO: Forking chef instance to converge...
[2013-12-19 21:33:42 -0500] chef_newbie: [2013-12-19T12:04:18-06:00] INFO: *** Chef 11.6.0 ***
[2013-12-19 21:36:08 -0500] fak3r: how are you running chef-client? daemon, cron, ?
[2013-12-19 21:36:45 -0500] chef_newbie: daemon
[2013-12-19 21:39:12 -0500] chef_newbie: /opt/chef/embedded/bin/ruby /usr/bin/chef-client -d -c /etc/chef/client.rb -L /var/log/chef/client.log -P /var/run/chef/client.pid -i 1800 -s 300
[2013-12-19 21:39:22 -0500] chef_newbie: thats how its running
[2013-12-19 22:05:19 -0500] fak3r: chef_newbie: but if you run it manually, it always works? (this is what would happen to me)
[2013-12-19 22:06:35 -0500] chef_newbie: yes
[2013-12-19 22:06:43 -0500] chef_newbie: successfully
[2013-12-19 22:10:06 -0500] coderanger: kallistec: Getting conflict issues with mime-types 2.0 :(
[2013-12-19 22:10:18 -0500] coderanger: Unable to activate chef-11.8.2, because mime-types-2.0 conflicts with mime-types (~> 1.16) (Gem::LoadError)
[2013-12-19 22:11:11 -0500] coderanger: even though chef.gemspec specifically states twice to not use 2.0
[2013-12-19 22:11:39 -0500] kallistec: coderanger: what's bringing in the newer mime-types?
[2013-12-19 22:11:48 -0500] kallistec: try nuking it for now?
[2013-12-19 22:11:52 -0500] coderanger: Not sure
[2013-12-19 22:12:03 -0500] coderanger: the error just shows whats bringing in the old one
[2013-12-19 22:12:09 -0500] coderanger: which is everything :(
[2013-12-19 22:12:59 -0500] kallistec: coderanger: are you on an ancient version of rubygems or something?
[2013-12-19 22:13:22 -0500] kallistec: it's supposed to do some big dance to make that kind of error less likely now
[2013-12-19 22:13:40 -0500] coderanger: Let me try just uninstalling 2.0
[2013-12-19 22:13:40 -0500] coderanger: There we go
[2013-12-19 22:14:02 -0500] coderanger: Wat
[2013-12-19 22:14:17 -0500] coderanger: So just removing mime-types 2.0 dropped my normal chef run time from 55s to 13s
[2013-12-19 22:14:41 -0500] coderanger: and running from your branch with no plugin config file is 4s
[2013-12-19 22:15:31 -0500] coderanger: kallistec: With a manifest drops it from 4s to 2s :)
[2013-12-19 22:15:49 -0500] kallistec: coderanger: what test are you running?
[2013-12-19 22:15:56 -0500] coderanger: kallistec: knife client list
[2013-12-19 22:16:02 -0500] kallistec: also, you have spinning rust?
[2013-12-19 22:16:10 -0500] coderanger: No, SSD
[2013-12-19 22:17:17 -0500] kallistec: wow, weird. In my testing I'm hardly able to see differences with these optimizations, maybe I need to install a billiion random gems. probably 2 versions of rails would be enough
[2013-12-19 22:17:34 -0500] coderanger: kallistec: I have 300-ish gems installed, most with several versions
[2013-12-19 22:18:18 -0500] kallistec: yeah, I have 82
[2013-12-19 22:19:07 -0500] coderanger: $ ls /usr/local/opt/rbenv/versions/1.9.3-p392/lib/ruby/gems/1.9.1/gems | wc -l
[2013-12-19 22:19:08 -0500] coderanger:      538
[2013-12-19 22:19:13 -0500] coderanger: :-)
[2013-12-19 22:19:20 -0500] theCzar: is there a convention for chef attributes to be symbols or strings?
[2013-12-19 22:19:29 -0500] coderanger: theCzar: Convention is strings
[2013-12-19 22:19:33 -0500] theCzar: coderanger: thanks
[2013-12-19 22:19:48 -0500] coderanger: because it is clearer to non-ruby-devs as the syntax is basically the same in every lang ever
[2013-12-19 22:20:17 -0500] theCzar: coderanger: cool, that makes sense
[2013-12-19 22:20:30 -0500] coderanger: kallistec: Happy to run any other tests that will help
[2013-12-19 22:21:10 -0500] kallistec: coderanger: well, that's enough to confirm that there's some win there
[2013-12-19 22:21:30 -0500] tlr00: Hi folks, I tried printing @nodes on my template file and it seems to not produce any content. However, @roles does...Has anyone ran into this issue with chef 11?
[2013-12-19 22:21:47 -0500] coderanger: kallistec: Roger, also good note to people that if things are stupidly slow, try uninstalling mime-types 2.0 since I guess it trips out the rubegems version solver
[2013-12-19 22:21:50 -0500] kallistec: coderanger: the mime-types thing is interesting, but I'm not clear how you'd solve it
[2013-12-19 22:22:13 -0500] coderanger: Probably throws the whole thing into a backtracking mode to find a solution
[2013-12-19 22:22:20 -0500] kallistec: yeah, that's my guess
[2013-12-19 22:22:38 -0500] coderanger: lolsoftware
[2013-12-19 22:23:20 -0500] gchristensen: hrm. is hosted chef under strain? my databags are takin gquite some time to update in search
[2013-12-19 22:23:27 -0500] kallistec: coderanger: it sucks, too because it's only pulled in by rest-client, which we stopped using, and mime-types 2.0 is only bad b/c it doesn't support ruby 1.8 :(
[2013-12-19 22:24:09 -0500] kallistec: coderanger: but I'm reluctant to drop rest-client in case someone was using it in their cookbooks w/o installing it
[2013-12-19 22:25:00 -0500] kallistec: tlr00: what variables are you passing in via your template resource?
[2013-12-19 22:25:01 -0500] coderanger: kallistec: Hah, I'm actually one of those people
[2013-12-19 22:25:17 -0500] coderanger: kallistec: :P
[2013-12-19 22:25:27 -0500] thun_: Does ohai give instance id on ec2?
[2013-12-19 22:25:36 -0500] coderanger: thun_: Yes
[2013-12-19 22:25:44 -0500] coderanger: thun_: node['ec2']['instance-id']
[2013-12-19 22:25:45 -0500] tlr00: kallistec: hostname only.
[2013-12-19 22:25:49 -0500] thun_: ty
[2013-12-19 22:26:13 -0500] tlr00: @kallistec Hostname only...just testing to find the hostname...
[2013-12-19 22:26:28 -0500] kallistec: tlr00: hrm, afaik chef never created any instance variables in templates aside from those you passed in, except @node
[2013-12-19 22:26:41 -0500] tlr00: Ok
[2013-12-19 22:27:02 -0500] kallistec: thun_: protip, you can run `ohai THING` on the command line to see what ohai detects, e.g., `ohai ec2`
[2013-12-19 22:27:03 -0500] tlr00: I am going to try altering it a little...see what happens. Thanks...
[2013-12-19 22:28:42 -0500] tlr00: kallistec: Thanks man...I had a typo /me punches self in face.
[2013-12-19 22:28:50 -0500] thun_: kallistec: wow perfect
[2013-12-19 22:28:52 -0500] tlr00: Self realization in chef.
[2013-12-19 22:30:00 -0500] kallistec: coderanger: one more thing, my branch you just ran from the git checkout?
[2013-12-19 22:30:26 -0500] coderanger: kallistec: Yes
[2013-12-19 22:30:36 -0500] coderanger: kallistec: /usr/bin/time ~/src/chef/bin/knife client list
[2013-12-19 22:31:05 -0500] kallistec: coderanger: can you try building a gem and installing that, comparing time w/ and w/o manifest?
[2013-12-19 22:32:24 -0500] coderanger: kallistec: One sec
[2013-12-19 22:32:34 -0500] kallistec: np, thanks
[2013-12-19 22:34:27 -0500] coderanger: kallistec: Hmm, much less benefit. 12s without a manifest, 11s with
[2013-12-19 22:36:22 -0500] coderanger: kallistec: Times vary close enough that there might not be any diff, hard to tell
[2013-12-19 22:36:29 -0500] kallistec: coderanger: yep. I think the real problem is rubygems w/ some combinations of gems. You can try this if you like evil hacks https://github.com/danielsdeleo/loadpath-compiler
[2013-12-19 22:39:12 -0500] coderanger: kallistec: Yep, with that its back to ~4s without manifest, 1-2 with
[2013-12-19 22:44:50 -0500] kallistec: coderanger: ok, thanks for testing. probably good enough to go ahead with the patch since it helps us on the road to some other optimizations in the future
[2013-12-19 22:45:18 -0500] coderanger: kallistec: Yeah, and a `knife plugin install` would be good anyway since people get tripped up all the time install plugins on omnibus-d chef
[2013-12-19 22:45:33 -0500] kallistec: yep
[2013-12-19 23:24:45 -0500] bitgangsta: Is there any way to use the chef-shell on a Mac w/ solo to inspect things like nodes and attributes? When I try to switch to a node, it just crashes. Even nodes.all doesn't work.
[2013-12-19 23:24:52 -0500] dc105297: Hey is anyone avaialble for help?
[2013-12-19 23:25:56 -0500] bitgangsta: I guess nodes.all makes sense since it uses the search API. But there are cookbooks to reimplement that in solo. Any chance the shell could be configured to work with chef-solo-search or some such?
[2013-12-19 23:27:25 -0500] bitgangsta: I'm surprised become_node breaks though... `node_load_failed' for nil:NilClass
[2013-12-19 23:27:41 -0500] bitgangsta: Guess this stuff really need a server... :(
[2013-12-19 23:28:08 -0500] dc105297: ERROR: Network Error: Error connecting to https://ec2-54-201-46-218.us-west-2.compute.amazonaws.com/users - Operation timed out - connect(2)
[2013-12-19 23:31:33 -0500] bitgangsta: dc105297, you know you need to ask a real question not just print some random error
[2013-12-19 23:38:46 -0500] WPsites: I've got chef setup to configure my servers and I'm just working on some web app deployment/backup functionality. I could create a recipe/cookbook to do this and then just do a chef run when ever I need to deploy/backup or I could just script an SSH connection to move some databases and files around. Do I really need the overhead of a chef run here??
[2013-12-19 23:55:36 -0500] coderanger: fnichol: You around? Seems like TK 1.0 lost the ability to merge the run_list between the different config sections
[2013-12-19 23:56:14 -0500] coderanger: Not sure of that was intentional
[2013-12-19 23:57:16 -0500] mconigliaro: hey guys, how do you check what version of chef you're running in a recipe?
[2013-12-19 23:57:28 -0500] mconigliaro: i know I've seen examples of this before, but i can't find one
