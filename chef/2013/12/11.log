[2013-12-11 00:00:32 -0500] pedahzur: someara: I do like that cookbook though...looks very spiffy.
[2013-12-11 00:01:02 -0500] someara: works in a jam
[2013-12-11 00:01:28 -0500] someara: In a perfect world you could template everything, but many Old Unix things have a stake in the same configuration file
[2013-12-11 00:01:51 -0500] someara: so its either a: create an API around the file that various cookbooks can participate in, or b: edit lines
[2013-12-11 00:02:31 -0500] someara: editing lines is suboptimal though, because if you want to remove them you have to be explicit about it =\
[2013-12-11 00:03:48 -0500] pedahzur: someara: A lot of things would benefit from a <thing_to_config>.d structure, but alas....
[2013-12-11 00:07:02 -0500] juliancdunn: unfortunately we'll be stuck with some of those things until 2017 (hello, RHEL 5) :-(
[2013-12-11 00:27:22 -0500] jbz: Anyone got a sec for a Stupid Knife Question()?  When I use 'knife role edit", it presents the json all as one long line, no spacing/indents.  Is this normal?  If no, what's the most likely cause?
[2013-12-11 00:29:23 -0500] bluepojo: jbz: is your editor notepad?
[2013-12-11 00:29:29 -0500] jbz: heh no vim
[2013-12-11 00:29:38 -0500] bluepojo: heh, k
[2013-12-11 00:29:40 -0500] bluepojo: idk then
[2013-12-11 00:29:45 -0500] bluepojo: notepad doesn't respect unix line endings
[2013-12-11 00:29:47 -0500] bluepojo: so it was a thought
[2013-12-11 00:30:30 -0500] jbz: thx :-)
[2013-12-11 00:30:40 -0500] jbz: This is only happening on this one mac, too. :-P
[2013-12-11 00:30:46 -0500] jbz: I just must have some config hosed.
[2013-12-11 00:41:03 -0500] buysse: Does anyone have any idea how to remove the new management console from an enterprise chef install?  Docs on it are minimal, and it's broken with LDAP users.
[2013-12-11 00:41:42 -0500] buysse: After removing the RPM, I'm left with a broken login page (new page from the opscode-manage package with no CSS, not functional after login).
[2013-12-11 00:42:12 -0500] buysse: I've tried a private-chef-ctl reconfigure, reinstalling the private-chef RPM, restarting services, etc.
[2013-12-11 00:51:58 -0500] kallistec: jbz: you have some knife plugin that somehow is modifying the pretty_print function that chef uses
[2013-12-11 00:52:44 -0500] kallistec: jbz: last time I heard of this, it was some dependency of knife-spork that was the culprit
[2013-12-11 00:57:21 -0500] jbz: kallistec:  Ahhhh.  Thanks!  Will go look.
[2013-12-11 01:00:25 -0500] buysse: In case anyone else needs to back out the new manager, here's what worked:
[2013-12-11 01:00:26 -0500] buysse: # opscode-manage-ctl uninstall
[2013-12-11 01:00:26 -0500] buysse: # vi /etc/opscode/private-chef.rb  ## re-enable the traditional webui
[2013-12-11 01:00:27 -0500] buysse: # private-chef-ctl reconfigure
[2013-12-11 01:00:28 -0500] buysse: # private-chef-ctl restart
[2013-12-11 01:17:06 -0500] thun_: What is the best way to set attirbutes at run time?
[2013-12-11 01:18:35 -0500] jbz: thun_ You mean when starting the chef-client?
[2013-12-11 01:19:29 -0500] jbz: thun_ If that's what you mean, you can pass in the location of an attributes file, in json format:  chef-client -j /path/to/file
[2013-12-11 01:20:22 -0500] jbz: oh hm that can also be a URL, apparently, according to new chef help info. :-0
[2013-12-11 01:24:02 -0500] thun_: jbz: I tried that does this look correct?  http://pastebin.com/aih6sJaY
[2013-12-11 01:24:13 -0500] thun_: I can not access any of those values from the recipe
[2013-12-11 01:24:36 -0500] thun_: the second is a true override, but log in the recipe shows the old value
[2013-12-11 01:24:54 -0500] thun_: When I call log node[:test] its null
[2013-12-11 04:16:10 -0500] daos: is there a way to get my chef nodes to email me if the chef-client runs ends in error?
[2013-12-11 04:16:21 -0500] daos: without having some other service tail the log and watch for it
[2013-12-11 04:16:23 -0500] daos: something built in
[2013-12-11 04:16:28 -0500] dyer: http://docs.opscode.com/essentials_handlers.html
[2013-12-11 04:16:37 -0500] knuckolls: ^^ report handlers
[2013-12-11 05:00:20 -0500] daos: cool! thanks guys :)
[2013-12-11 05:00:31 -0500] daos: (sorry for the delayed reaction there :)
[2013-12-11 07:25:07 -0500] clocKwize: anyone help
[2013-12-11 07:25:28 -0500] clocKwize: chef-solo has done loads of stuff successfully, now its just sitting there printing .'s over and over
[2013-12-11 07:41:36 -0500] henk76: clocKwize, when does this occur?
[2013-12-11 07:46:38 -0500] enbergj: so how do I reset chef bootstrap? I tried to bootstrap a node, and it failed almost immediately to a sadly-common apt-get update issue, and now if I try to bootstrap it again it thinks it's already connected to the chef server but fails authentication because well, it isn't
[2013-12-11 07:47:07 -0500] enbergj: now I want to make chef understand/think/whatever that it has never been run and to try again from scratch
[2013-12-11 07:47:22 -0500] henk76: try deleting the node/client enbergj
[2013-12-11 07:47:31 -0500] enbergj: on the server?
[2013-12-11 07:47:40 -0500] henk76: yeah
[2013-12-11 07:47:50 -0500] henk76: you can use knife or the webtool for it
[2013-12-11 07:51:22 -0500] enbergj: well .. I deleted the stuff it created on the server, it's still trying to authenticate against the server and failing
[2013-12-11 07:51:33 -0500] enbergj: because now there at least isn't anything there
[2013-12-11 07:51:41 -0500] henk76: what is the error enbergj?
[2013-12-11 07:51:52 -0500] henk76: anyone familiar with this error: Cannot find a resource matching package[MySQL Connector C 6.0.2] (did you define it first?)
[2013-12-11 07:52:01 -0500] enbergj: failed to authenticate as 'fqdn'. Ensure that your node_name and client key are correct.
[2013-12-11 07:53:37 -0500] henk76: did you delete the client.pem file?
[2013-12-11 07:53:54 -0500] enbergj: no
[2013-12-11 07:54:37 -0500] henk76: when you bootstrap a client, after installing you only need the client.rb file and the validator.pem
[2013-12-11 07:55:22 -0500] enbergj: I don't need anything that I don't already have on the workstation I'm bootstrapping it on, I want the node to be reset so it will start bootstrap from scratch without worrying about trying to authenticate against the chef server with existing credentials that don't exist
[2013-12-11 07:56:13 -0500] henk76: how did you install the client enbergj? by using knife create ? or manually?
[2013-12-11 07:56:44 -0500] enbergj: bootstrap, knife bootstrap
[2013-12-11 07:57:39 -0500] henk76: yeah. but you bootstrap against a machine. is the OS manually installed ? or did you do it with chef?
[2013-12-11 07:59:34 -0500] enbergj: it's an amazon instance, this is completely beside the point .. I ran knife bootstrap, it failed, I want to now reset it back so knife bootstrap will retry from scratch instead of thinking it's already registered with the server
[2013-12-11 08:02:02 -0500] henk76: my best guess would be to use a new instance for it. Now there is already software being installed by chef, so you never know what is messing up the run script. just make a instance
[2013-12-11 08:03:18 -0500] enbergj: the point IS that I don't want to keep making new instances every time chef fails, which happens often, probably due to the poor default AMI or something .. also it's quite weird that like 90% of the time if I knife bootstrap a newly booted node, it fails to connect to the repositories during apt-get update and fails, but if I first SSH in and manually run apt-get update, it always works
[2013-12-11 08:04:39 -0500] henk76: strange behaviour enbergj. Here it always runs smoothly. and if you run the command chef-client on a node that failed. do you get the same result?
[2013-12-11 08:05:02 -0500] enbergj: yes
[2013-12-11 08:06:26 -0500] henk76: why does the apt-get fail? perhaps network issues/bad repository?
[2013-12-11 08:08:02 -0500] enbergj: I don't know, it works perfectly fine if I run it on the machine manually .. it says 404 not found for chef during a failing bootstrap
[2013-12-11 08:08:30 -0500] enbergj: and this is on the exact same machine, if I run it before knife bootstrap, it works fine, if I run it after a failed knife bootstrap, it works fine
[2013-12-11 08:09:51 -0500] henk76: very strange.
[2013-12-11 08:13:10 -0500] enbergj: ok, so the answer to my question was "delete /etc/chef/client.pem on the node being bootstrapped, and the node & client on the server"
[2013-12-11 08:49:36 -0500] Garo_: Any idea why my chef-client command doesn't do anything? I run it with -l debug and it doesn't print anything out. Running it with strace shows that it first goes thru some ruby gems and then it's stuck in a clock_gettime(), select(), wait() -loop for ever
[2013-12-11 09:35:56 -0500] henk76: guys, anyone have a clue? Cannot find a resource matching package[MySQL Connector C 6.0.2] (did you define it first?)
[2013-12-11 09:52:56 -0500] slicknick: cant find package
[2013-12-11 09:53:05 -0500] slicknick: typo in the resource request?
[2013-12-11 09:53:21 -0500] slicknick: did you call for the resource correctly ?
[2013-12-11 09:53:27 -0500] slicknick: or at all ?
[2013-12-11 09:54:38 -0500] henk76: what should be the call then? i'm not sure where i'm going wrong
[2013-12-11 09:56:06 -0500] slicknick: me either
[2013-12-11 09:56:17 -0500] slicknick: what have you done ?
[2013-12-11 09:56:58 -0500] henk76: i've downloaded the mysql and database cookbooks
[2013-12-11 09:57:43 -0500] henk76: made a recipe (which i'll paste in pastebin)
[2013-12-11 09:58:52 -0500] henk76: http://pastebin.com/Da20Hgcr
[2013-12-11 09:59:48 -0500] henk76: all i want to do is import a sql file on a existing windows mysql server. the server was working perfectly. i installed chef client. that worked
[2013-12-11 10:00:00 -0500] henk76: only running the sql import doesn't work
[2013-12-11 10:14:12 -0500] clocKwize: is there any cookbook to partition an EBS volume?
[2013-12-11 10:17:25 -0500] shay-: hey guys, I have to put the same template in several cookbooks. I don't want to duplicate the source file, is this possible?
[2013-12-11 10:34:31 -0500] prognostikos: Anyone have any ideas regarding https://github.com/berkshelf/berkshelf/issues/910 - basically using Berkshelf to pull in cookbooks from github works on install but then `berks list` and any other commands fail
[2013-12-11 10:46:59 -0500] clocKwize: might switch to hosted chef
[2013-12-11 10:47:05 -0500] clocKwize: sounds far bloody easier than all this faffing about
[2013-12-11 10:53:44 -0500] holms: clocKwize: try this github.com/holms/chef-starter
[2013-12-11 10:54:04 -0500] holms: i've thought also about it, but then i've just automated the installing process.. because.. yeah it's just too much crap to do
[2013-12-11 10:55:55 -0500] gregkare: shay-: Yes, you can use the cookbook attribute: http://docs.opscode.com/resource_template.html
[2013-12-11 11:02:42 -0500] clocKwize: the tutorial of hosted chef teaching me how to use knife
[2013-12-11 11:02:53 -0500] clocKwize: was manually downloading cookbooks and stuff before
[2013-12-11 11:14:38 -0500] gregkare: With the "Opscode" brand being gone I'll finally learn how to use an actual knife, I'm excited!
[2013-12-11 11:16:29 -0500] dark_dr4g0n: hello
[2013-12-11 11:16:38 -0500] dark_dr4g0n: how can i get work version of this? include_recipe "ntp" not_if node.virtualization.system?("openvz")
[2013-12-11 11:20:07 -0500] laurent\: use unless instead of not_if
[2013-12-11 11:24:09 -0500] gregkare: What he said, not_if is not normal Ruby, it's a method defined in resource blocks
[2013-12-11 11:28:53 -0500] dark_dr4g0n: thanks! it works
[2013-12-11 11:49:45 -0500] holms: if anybody using
[2013-12-11 11:49:59 -0500] holms: logstash.. here's a roles examples.. feel free to add yours :P https://github.com/lusis/chef-logstash/wiki/Example-Roles
[2013-12-11 11:53:42 -0500] clocKwize: wth is not_if
[2013-12-11 12:09:25 -0500] daos: it's negative conditional
[2013-12-11 12:09:57 -0500] daos: like: if ($omg !~ /omg/) { ... }
[2013-12-11 12:10:51 -0500] clocKwize: why not use unless like everywhere else though? :P
[2013-12-11 12:11:06 -0500] gregkare: It's the opposite of only_if in a resource
[2013-12-11 12:11:22 -0500] gregkare: Because if and unless are part of Ruby, you couldn't use them to do this
[2013-12-11 12:12:17 -0500] gregkare: It gives you conditional execution of a resource, using a Ruby block or bash in a string
[2013-12-11 12:13:00 -0500] gregkare: http://docs.opscode.com/resource_common.html#guards
[2013-12-11 13:33:33 -0500] shay-: gregkare: thank you =)
[2013-12-11 13:58:12 -0500] clocKwize: I've started using aws cookbook, my server is just sitting there on - install version 3.0.5 of package right_aws
[2013-12-11 13:58:18 -0500] clocKwize: forever
[2013-12-11 14:12:57 -0500] mattsmith: afternoon all
[2013-12-11 14:13:08 -0500] mattsmith: How do I use a gem inside of a recipe?
[2013-12-11 14:14:27 -0500] mattsmith: I've followed "http://www.getchef.com/blog/2009/06/01/cool-chef-tricks-install-and-use-rubygems-in-a-chef-run/"
[2013-12-11 14:14:59 -0500] mattsmith: but I get the error "cannot load such file -- inifile"
[2013-12-11 14:15:08 -0500] mattsmith: where inifile is the gem
[2013-12-11 14:17:19 -0500] gregkare: mattsmith: In 2009 Chef didn't have chef_gem
[2013-12-11 14:18:03 -0500] clocKwize: guys, why would I get stuck at:- install version 3.0.5 of package right_aws
[2013-12-11 14:18:10 -0500] clocKwize: how can I debug this
[2013-12-11 14:18:14 -0500] clocKwize: it just sitting there forever
[2013-12-11 14:19:02 -0500] gregkare: clocKwize: You can manually run "gem install right_aws --version 3.0.5 -V" to get verbose output
[2013-12-11 14:20:00 -0500] clocKwize: ok, sudo'd? :P
[2013-12-11 14:20:49 -0500] henk76: yeah
[2013-12-11 14:22:01 -0500] clocKwize: it installed fine.
[2013-12-11 14:22:02 -0500] mattsmith: gregkare, Ahh Ha... Didn't even see chef_gem just went straight to gem_package
[2013-12-11 14:23:34 -0500] cpuguy83: Upgrading Chef on Windows installed via MSI.  What's the standard practice here?  Just run the MSI?
[2013-12-11 14:24:13 -0500] clocKwize: what next :/
[2013-12-11 14:27:51 -0500] clocKwize: I swear I'm going to cry soon. why is this so hard :(
[2013-12-11 14:28:32 -0500] clocKwize: it gets to here: https://gist.github.com/brightbits/dcd938c0eff31e14809b and just stops
[2013-12-11 14:28:54 -0500] clocKwize: I can see on the server chef-client is running but is there any logs I can look at ?
[2013-12-11 14:36:56 -0500] Garo_: I'm missing some node[] variables after my bootstrap chef run. the chef-server shows those attributes, but if I look in reports/chef-rim-report-xxx.json then those variables aren't there. They're also missing on my next chef run. Any ideas why they could be missing?
[2013-12-11 15:37:21 -0500] clocKwize: https://github.com/opscode-cookbooks/aws/blob/master/providers/ebs_raid.rb#L435
[2013-12-11 15:37:25 -0500] clocKwize: can anyone help me set these variables?
[2013-12-11 15:37:35 -0500] clocKwize: documentation says just set data bag aws main
[2013-12-11 15:37:40 -0500] clocKwize: but its not picking them up
[2013-12-11 15:37:53 -0500] clocKwize: and I'm not familiar enough with chef to really know how its working
[2013-12-11 15:39:18 -0500] Garo_: clocKwize: so you have set the aws_access_key and aws_secret_access_key properties in your recipe? can you paste the recipe into pastebin or similar service?
[2013-12-11 15:39:46 -0500] clocKwize: I want them to come from a databag right? I don't want my keys checked in?
[2013-12-11 15:39:56 -0500] Garo_: correct
[2013-12-11 15:40:26 -0500] clocKwize: I found the defaults for databag_name/entry are both nil
[2013-12-11 15:40:32 -0500] clocKwize: so I've done: override['aws']['databag_name'] = "aws"
[2013-12-11 15:40:34 -0500] clocKwize: etc..
[2013-12-11 15:40:36 -0500] clocKwize: just trying this
[2013-12-11 15:42:23 -0500] Garo_: clocKwize: so in your recipe first load up the data bag where you have stored the credentials: credentials = data_bag_item "credentials", "aws"
[2013-12-11 15:43:24 -0500] Garo_: clocKwize: then when you invoke the provider in your recipe, you define both aws_access_key and aws_secret_access_key properties from the credentials object
[2013-12-11 15:43:42 -0500] jpoole: anyone have an elegant (if it exists) way of installing a backport within chef?
[2013-12-11 15:45:15 -0500] Garo_: clocKwize: https://gist.github.com/garo/7912708
[2013-12-11 15:45:19 -0500] Garo_: clocKwize: something like that
[2013-12-11 15:45:37 -0500] Safdar: Hi guys .. We are new to Chef and trying to evaluate if we should use root file or create separate file system of application  to use. Is there any best practices link I could use or does anyone have any recommendation?
[2013-12-11 15:48:15 -0500] clocKwize: thanks Garo_
[2013-12-11 15:48:18 -0500] clocKwize: much appreciated
[2013-12-11 15:49:40 -0500] jbz: Safdar: Your question is a bit confusing.  Are you talking about user accounts, or filesystems? And if filesystems, do you mean on the Chef server?
[2013-12-11 15:49:59 -0500] Safdar: Filesystems
[2013-12-11 15:51:22 -0500] Safdar: Filesystems .. no not chef server .. we are trying to spin up new instances (I think its called target) for application to run on.
[2013-12-11 15:55:27 -0500] jbz: Safdar:  Um, ok.  chef-client doesn't need a filesystem, and it sounds like you have it backwards - you don't spin up new instances for chef, chef is run on your instances to configure them the way you want them.
[2013-12-11 15:56:53 -0500] jbz: Safdar: In other words, chef-client runs as the root user, and doesn't need additional filesystems.  It will allocate cache directories and the like in the appropriate locations for the OS it's running on  (in linux, e.g., it'll use /var/chef/cache if possible).
[2013-12-11 15:57:38 -0500] jbz: So if you're spinning up machines to run your applications on, you'd need to install the chef-client software on them somehow, but all other config changes would be made by your chef run, as required.
[2013-12-11 15:58:12 -0500] Safdar: oh ok ... Thanks jbz
[2013-12-11 15:58:17 -0500] jbz: yw
[2013-12-11 15:58:33 -0500] williamherry: can I use knife without a chef server? I am using chef-solr, want to to knife to create a cookbook structure
[2013-12-11 15:59:02 -0500] williamherry: it show this errors: WARNING: No knife configuration file found
[2013-12-11 15:59:03 -0500] williamherry: ERROR: TypeError: no implicit conversion of nil into String
[2013-12-11 16:04:00 -0500] anoldhacker: Anyone here from The Company Formerly Known as Opscode?
[2013-12-11 16:04:17 -0500] anoldhacker: TCFKOlet's make that a thing.. :)
[2013-12-11 16:04:18 -0500] jpoole: williamherry you can just create the structure by hand
[2013-12-11 16:17:22 -0500] leifmadsen: heh, Digium went through the same thing a while ago and decided not to change their company name to their flagship product. I agreed with that :)
[2013-12-11 16:17:31 -0500] leifmadsen: RIM == BlackBerry, OpsCode == Chef
[2013-12-11 16:17:39 -0500] leifmadsen: seems to be a theme
[2013-12-11 16:18:03 -0500] anoldhacker: At least with BlackBerry, you might still be able to google it.
[2013-12-11 16:18:20 -0500] anoldhacker: But I do have a serious issue for them...
[2013-12-11 16:18:59 -0500] jpoole: the rim/blackberry thing was mostly an internal fiasco
[2013-12-11 16:19:49 -0500] jpoole: there was retardedness with  "Oh i'm on the blackberry side of things sooo" and "We're corporate (rim), we don't do that"
[2013-12-11 16:19:52 -0500] jpoole: it's all the same company.
[2013-12-11 16:20:23 -0500] anoldhacker: I'm pretty sure I would fire someone on the spot for that sort of attitude.
[2013-12-11 16:20:48 -0500] jpoole: that's why i left :)
[2013-12-11 16:21:02 -0500] anoldhacker: Where are you now?
[2013-12-11 16:21:14 -0500] jpoole: not there :)
[2013-12-11 16:21:24 -0500] anoldhacker: :P
[2013-12-11 16:21:25 -0500] jpoole: it was of course, 13 years ago i was there.
[2013-12-11 16:21:44 -0500] jpoole: but i noticed that crap when it was smaller than it is now, back then
[2013-12-11 16:21:48 -0500] anoldhacker: Ahh  Close to their heyday.
[2013-12-11 16:22:16 -0500] jpoole: it was when they first released the blackberry that had GSM (phone) on board.
[2013-12-11 16:22:52 -0500] jpoole: codename: tachion (tachyon sp?)
[2013-12-11 16:23:06 -0500] jpoole: tackyon, ffs, i can't remember.
[2013-12-11 16:36:27 -0500] skarufue: hello. i am using chef-solo. i have a repository with multiple cookbooks i clone it into a LXC container. then i use some shellscript to generate this solo.json: http://ay.vc/3Q .then i run chef-solo -j solo.json strangely this installs the default cookbook from what seems to be a random recipe. if i delete all the cookbooks except the one i want all seems to be fine.
[2013-12-11 16:37:33 -0500] jpoole: skarufue you using chef-server ?
[2013-12-11 16:37:33 -0500] skarufue: i swapt cookbook and recipe in my last-1 sentence
[2013-12-11 16:37:41 -0500] skarufue: not using chef server
[2013-12-11 16:38:09 -0500] skarufue: used chef server a while back
[2013-12-11 16:38:12 -0500] jpoole: any roles/environments?
[2013-12-11 16:38:34 -0500] skarufue: where would they be defined?
[2013-12-11 16:38:49 -0500] jpoole: check your chef-repo/roles/
[2013-12-11 16:38:55 -0500] jpoole: maybe a _default
[2013-12-11 16:39:01 -0500] jpoole: should be a _default rather
[2013-12-11 16:39:10 -0500] jpoole: possibly some recipies defined in there, or runlists.
[2013-12-11 16:39:32 -0500] jpoole: (I don't use chef-solo, but i'll try and help)
[2013-12-11 16:41:00 -0500] skarufue: locate _default
[2013-12-11 16:41:00 -0500] skarufue: ...
[2013-12-11 16:41:33 -0500] skarufue: ok i neither have anything called roles or _ default in my sytem
[2013-12-11 16:41:44 -0500] skarufue: _default
[2013-12-11 16:41:59 -0500] jpoole: what is this random default cookbook you speak of?
[2013-12-11 16:42:58 -0500] jonathanq: Is there a way to set node attributes on a node (like in json, client config etc) that have an override level (i.e.: are not persisted to the server).  Thinking of a local password that I need to bootstrap other parts of the run.  I don't want it indexed by chef-server, nor do I want it in my environment/role json in source control.
[2013-12-11 16:43:23 -0500] jpoole: does the output show the recipes being run?
[2013-12-11 16:43:44 -0500] jpoole: jonathanq, databags :)
[2013-12-11 16:44:10 -0500] jpoole: or even better, encrypted data bags
[2013-12-11 16:44:22 -0500] jonathanq: ah yes but data bags are also in source control (and visible on the server).  Although I suppose I could use an encrypted data bag for this.
[2013-12-11 16:44:37 -0500] jpoole: yes
[2013-12-11 16:44:41 -0500] jpoole: that's the best approach
[2013-12-11 16:44:51 -0500] leifmadsen: jpoole: ya, we've (thinking phones) been hiring a lot of former blackberry people actually; there are so many to choose from! :)
[2013-12-11 16:44:58 -0500] skarufue: well. when i run the aforementioned chef-solo command. starts work. and then installs one of the cookbooks from the cookbook directory. just not the one i want. in my specific case i have these cookbooks:http://ay.vc/3R
[2013-12-11 16:45:02 -0500] jpoole: however, i have a gitignore to not upload my databags into source control
[2013-12-11 16:45:16 -0500] jpoole: leifmadsen you in the sw ontario region?
[2013-12-11 16:45:23 -0500] skarufue: jpoole: and regardless of what i put in json it runs admintool
[2013-12-11 16:45:26 -0500] leifmadsen: jpoole: yeppers
[2013-12-11 16:45:53 -0500] pwelch: Has anyone seen an issue running Open Source Chef server where the beam.smp process stays high cpu? restarting chef-server seems to fix it but curious if this an issue
[2013-12-11 16:46:24 -0500] jonathanq: ok - thanks jpooleI think I can make that approach work.  For any other node-specific attributes (not sensitive). Can they be done in a chef-client config file? or in the bootstrap .json file that sets the initial role?
[2013-12-11 16:46:50 -0500] skarufue: jpoole: if i delete admintool it will run template-renderer
[2013-12-11 16:47:09 -0500] jpoole: skarufue ugh, i don tknow enough about chef-solo to really point out anything else i can think of
[2013-12-11 16:47:17 -0500] skarufue: ok. ty
[2013-12-11 16:47:20 -0500] workmad3: jpoole: I've figured out how to do encrypted node attributes ;)
[2013-12-11 16:47:31 -0500] workmad3: really should write a blog post on that...
[2013-12-11 16:48:47 -0500] jpoole: workmad3 yes you should :)
[2013-12-11 16:49:35 -0500] jpoole: jonathanq really the node attributes are great, but don't know what data you're placing htere to really say, that's the right way, or wrong way
[2013-12-11 16:51:06 -0500] jonathanq: as long as I can toss some into the bootstrap json or chef-client config on each node as i bootstrap it that would work. I just have a few attributes that need to be different per server, they aren't sensitive.  the passwords I can use an encrypted data bag for
[2013-12-11 16:51:18 -0500] workmad3: jpoole: yeah, I hit the situation where I wanted to auto-generate things like a postgres-user password that stayed stable, but didn't want it stored plain-text on the chef-server... so I dug into the encrypted databag code to see how that was done, and managed to re-use its encryptor/decryptor classes to do the same on node values on-the-fly :)
[2013-12-11 16:51:24 -0500] anoldhacker: If you need your databags for your site to function properly, you MUST have a backup.  I don't know what the strategy is here...
[2013-12-11 16:51:40 -0500] cpuguy83: Upgrading Chef on Windows installed via MSI.  What's the standard practice here?  Just run the updated MSI?
[2013-12-11 16:51:57 -0500] jpoole: anoldhacker knife back-up
[2013-12-11 16:51:58 -0500] jonathanq: workmad3 - write up a blog post on that..sounds really useful!
[2013-12-11 16:53:03 -0500] skarufue: workmad3: i would be intrestedi n that too. since i couldnt think of a way to distribute secrets inband of chef. so that only specific nodes can decrypt.
[2013-12-11 16:53:49 -0500] jpoole: bbl
[2013-12-11 16:54:04 -0500] skarufue: workmad3: well so how did you distribute your en/decryption secrets?
[2013-12-11 16:54:58 -0500] workmad3: skarufue: not got that decently figured out yet... I currently distribute a bundle of 'environment' secrets in my bootstrap
[2013-12-11 16:55:41 -0500] workmad3: I quite like the way chef-vault works, with it encrypting using the public keys of nodes that should be able to decrypt
[2013-12-11 16:55:42 -0500] skarufue: workmad3: ah ok. so you still have to distribute some secrets out of band of chef-server
[2013-12-11 16:56:41 -0500] workmad3: skarufue: yeah... it's just generating sensitive stuff on the node as part of the run... not the secret management
[2013-12-11 16:57:08 -0500] skarufue: workmad3: still nice enough
[2013-12-11 17:47:16 -0500] skarufue: hokay. this probably also applies to chef server. so i am using chef-solo and i have this problem of wrong cookbooks beein applied. so i dug deeper. all my cookbooks are just atrributes. everything else is just simlinked to a template. so. is it problematich to have attributes like: default[:git][:repository] = "https://github.com/mycompany/fs.git" / will chef always parse all attributes in any cookbook bevore running?
[2013-12-11 17:53:24 -0500] jpoole: skarufue a cookbook will need to access those attributes if you want to do anything with them
[2013-12-11 17:55:19 -0500] jpoole: but yes if you have cookbook/attributes/default.rb and stuff in there, you can access them via cookbook/recipe/default/default.rb
[2013-12-11 17:56:59 -0500] skarufue: jpoole: thats to be expected. but i wasnt aware that i could accesss cookbookA/attributes/default.rb from cookbookB/recipes/default
[2013-12-11 17:57:25 -0500] jpoole: i beleive you can
[2013-12-11 17:57:37 -0500] skarufue: jpoole: not only can i do that but chef-solo seems to parse all attributes from all cookbooks. even those not in runlist. bevore running
[2013-12-11 17:57:58 -0500] skarufue: (which seems hella backward)
[2013-12-11 17:58:37 -0500] jpoole: most likley the ohai collector
[2013-12-11 17:59:27 -0500] jpoole:  grep -R "provides" -h lib/ohai/plugins|sed 's/^\s*//g'|sed "s/\\\"/\'/g"|sort|uniq|grep ^provides
[2013-12-11 17:59:45 -0500] jpoole: that will who you the automatic attributes that are collected by Ohai
[2013-12-11 18:00:00 -0500] skarufue: jpoole i dont even have ohai. i just have the chef-client on these containers
[2013-12-11 18:01:03 -0500] skarufue: grep -R "provides" -h lib/ohai/plugins|sed 's/^\s*//g'|sed "s/\\\"/\'/g"|sort|uniq|grep ^provides
[2013-12-11 18:01:04 -0500] skarufue: grep: lib/ohai/plugins: No such file or directory
[2013-12-11 18:01:04 -0500] jpoole: ahh so you're just trying to run chef-solo on a host which has a bunch of lxc containers?
[2013-12-11 18:01:52 -0500] skarufue: jpoole: jup. inside a container
[2013-12-11 18:02:41 -0500] jpoole: ok...
[2013-12-11 18:02:43 -0500] jpoole: hrmm
[2013-12-11 18:02:52 -0500] jpoole: well those containers will be considered nodes.
[2013-12-11 18:03:07 -0500] jpoole: so..i'm wondering if that approach will work as intended
[2013-12-11 18:05:01 -0500] jpoole: are you cloning these containers?
[2013-12-11 18:05:05 -0500] jpoole: ie create one, clone to many.
[2013-12-11 18:05:07 -0500] skarufue: jpoole: well no worries. i ll just fix it in bash :-(
[2013-12-11 18:07:13 -0500] skarufue: jpoole: no i have old scripting magic which sets up the host + containers. the i  decided to use chef to deploy software inside the containers. the cookbooks for the individual containers work fine if they are the only ones in /var/chef/cookbooks . but if there are multiple in  there all cokkbook*/atributes/* get parsed
[2013-12-11 18:07:31 -0500] skarufue: jpoole since the cookbooks have the same attribute names they overwrite them
[2013-12-11 18:07:40 -0500] jpoole: ahh
[2013-12-11 18:07:41 -0500] jpoole: ok
[2013-12-11 18:07:56 -0500] jpoole: so what I would do, is create a role for those containers
[2013-12-11 18:08:03 -0500] jpoole: and attach that single recipe to the role
[2013-12-11 18:08:12 -0500] jpoole: and when you run chef-solo, specify the role in the runlist
[2013-12-11 18:08:21 -0500] skarufue: hokay. ill try
[2013-12-11 18:08:40 -0500] jpoole: suppose you are using git to deploy the software?
[2013-12-11 18:09:12 -0500] skarufue: jpoole: yes
[2013-12-11 18:09:23 -0500] jpoole: is it a rails app? python? java?
[2013-12-11 18:09:30 -0500] jpoole: or just some other homegrown stuff
[2013-12-11 18:09:47 -0500] skarufue: jpoole: well backen is jave frontends are node / dart
[2013-12-11 18:10:17 -0500] jpoole: are you using the deploy "foo" do syntax?
[2013-12-11 18:10:25 -0500] jpoole: aka the deploy resource
[2013-12-11 18:10:36 -0500] skarufue: jpoole: no.
[2013-12-11 18:10:48 -0500] jpoole: cookbook/application/recipe/default/default.rb
[2013-12-11 18:11:01 -0500] jpoole: you could do a deploy "ourapp" do
[2013-12-11 18:11:10 -0500] jpoole: http://docs.opscode.com/resource_deploy.html
[2013-12-11 18:11:10 -0500] jpoole: have a look at that
[2013-12-11 18:11:23 -0500] jpoole: might just blow your mind on how easy it should be to do
[2013-12-11 18:16:42 -0500] skarufue: jpoole: ok. just skimmed the spec. seems to be some nice functionality in there. wouldnt solve the core of my current problem though. since i would just have ```repo node[:git][:repo]``` as the repo line of deploy. causing the same problems. but will definately switch to deploy in future versions of recipe
[2013-12-11 18:19:50 -0500] rracterr: I always forget which one of you is john keiser
[2013-12-11 18:19:54 -0500] rracterr: john, msg me
[2013-12-11 18:25:04 -0500] glen: hey, i want to write definition which has optional :notifies
[2013-12-11 18:25:23 -0500] glen: but :notifies is N arguments, how do i do it ruby way?
[2013-12-11 18:25:34 -0500] glen: i tried to write: notifies params[:notifies] if params[:notifies]
[2013-12-11 18:25:43 -0500] glen: but that gave invalid argument count erro
[2013-12-11 18:26:07 -0500] glen: and writing as this, sounds like hack: notifies params[:notifies][0], params[:notifies][1] if params[:notifies]
[2013-12-11 18:27:35 -0500] rracterr: anyone here know enough about Chef to discuss a possible race condition between knife and Chef-client?
[2013-12-11 18:28:12 -0500] glen: it's especially stupid as notifies has optionally three arguments
[2013-12-11 18:36:23 -0500] jpoole: skarufue oh, you need to override the attributes then
[2013-12-11 18:36:25 -0500] jpoole: within a recipe
[2013-12-11 18:37:45 -0500] anoldhacker: glen: I believe that you can specify notifies multiple times...
[2013-12-11 18:40:33 -0500] glen: anoldhacker: you probably didn't get my question
[2013-12-11 18:40:51 -0500] glen: or how using notifies multiple times helps?
[2013-12-11 18:41:15 -0500] anoldhacker: You wish to notify multiple resources?
[2013-12-11 18:41:23 -0500] glen: no!
[2013-12-11 18:41:33 -0500] glen: as i said i'm writing 'definition'
[2013-12-11 18:41:37 -0500] glen: http://docs.opscode.com/essentials_cookbook_definitions.html
[2013-12-11 18:42:03 -0500] glen: and i have no idea what would the params be from caller, i want to proxy it properly to resource used inside definition
[2013-12-11 18:43:50 -0500] anoldhacker: Well, my first advice is: don't use definitions.  There are a number of problems with them.  To my understanding, the community is moving away from them.
[2013-12-11 18:44:36 -0500] glen: but i was hoping ruby syntax allows to call variable parameters
[2013-12-11 18:44:46 -0500] glen: in php there's call_user_func_array or similar
[2013-12-11 18:44:52 -0500] anoldhacker: sethvargo:  Could I _please_ get someone to respond to https://tickets.opscode.com/browse/CHEF-4826?  I understand that people are looking at it.
[2013-12-11 18:44:56 -0500] skarufue: jpoole: how?
[2013-12-11 18:45:31 -0500] sethvargo: @anoldhacker I'm probably not the person to ping about that
[2013-12-11 18:45:32 -0500] anoldhacker: glen:  def a(arg1, arg2, *more_args)
[2013-12-11 18:46:10 -0500] anoldhacker: sethvargo:  hint?
[2013-12-11 18:46:31 -0500] glen: anoldhacker: so, i need to create function to support such thing?
[2013-12-11 18:46:35 -0500] glen: nothing inline possible?
[2013-12-11 18:47:01 -0500] glen: as otherwise i might take your suggestion to create multiple notifies, one for 2 args, other for 3 args
[2013-12-11 18:47:21 -0500] anoldhacker: I would need to understand your usecase, but start by implementing as a resource & provider.  Don't be afraid to use heavyweight for one or the other.
[2013-12-11 18:47:49 -0500] anoldhacker: For that particular thing, there is a trick I've used
[2013-12-11 18:47:58 -0500] glen: anoldhacker: it's pretty simple definituion, some rather irrelevant resource inside
[2013-12-11 18:48:03 -0500] anoldhacker: Build the args array, then splat it in the call.
[2013-12-11 18:48:31 -0500] ponyofdeath: hi, i have an chef handler i would like to distribute and enalbe https://github.com/anthroprose/chef-handler-zenoss, I also have the chef_handler cookbook. I have put the .rb hanlder in /var/chef/handlers/ on the chef server but am unsure how to configure chef_handler cookbook to actually distribute and run it on all the nodes. any ideas?
[2013-12-11 18:48:42 -0500] anoldhacker: glen: a(a1, a2, *as) works
[2013-12-11 18:49:06 -0500] glen: something like this: http://sprunge.us/HCQh
[2013-12-11 18:50:08 -0500] anoldhacker: notifies *params[:notifies] if params[:notifies]
[2013-12-11 18:50:18 -0500] glen: ahaa, thanks
[2013-12-11 18:50:29 -0500] anoldhacker: But really, don't use a definition.
[2013-12-11 18:50:32 -0500] glen: pythonish thing :)
[2013-12-11 18:50:56 -0500] anoldhacker: Same thing works with blocks.
[2013-12-11 18:51:11 -0500] anoldhacker: def a(a1, &b) takes a block.
[2013-12-11 18:51:20 -0500] glen: anoldhacker: why? it's for me simple to use definition with arbitary name  than create lrwps
[2013-12-11 18:51:24 -0500] anoldhacker: a(1, &blk) sends one.
[2013-12-11 18:51:35 -0500] glen: i mean why not definitions, and what i should use instead?
[2013-12-11 18:51:53 -0500] anoldhacker: Use proper resources and providers.
[2013-12-11 18:52:29 -0500] anoldhacker: The way definitions are integrated causes problems.  I don't have the details in my head.
[2013-12-11 18:52:45 -0500] glen: vela.delfi.lt           notifies *params[:notifies] params[:notifies]
[2013-12-11 18:52:51 -0500] glen: this gives syntax erros
[2013-12-11 18:53:04 -0500] glen: definitions/php_ext.rb:60: syntax error, unexpected tIDENTIFIER, expecting keyword_end
[2013-12-11 18:53:06 -0500] anoldhacker: You missed the "if"
[2013-12-11 18:53:12 -0500] glen: sure :) thanks
[2013-12-11 18:53:20 -0500] anoldhacker: ;)
[2013-12-11 19:06:12 -0500] j^2: does 'creates' support globs?
[2013-12-11 19:06:13 -0500] j^2: example:
[2013-12-11 19:06:26 -0500] j^2: creates "/root/rackconnecthybridnetworkconfig*.log"
[2013-12-11 19:06:42 -0500] j^2: tcate: ^^^ ;)
[2013-12-11 19:12:31 -0500] anoldhacker: Any of the Opscode folks around?
[2013-12-11 19:13:29 -0500] glen: j^2: unlikely, but you can write that part with only_if instead
[2013-12-11 19:13:44 -0500] j^2: glen: grrr
[2013-12-11 19:13:50 -0500] j^2: i havent tested it yet
[2013-12-11 19:14:02 -0500] j^2: and i dont wantto have to hit the api to see if it's rackconnected
[2013-12-11 19:14:07 -0500] j^2: man this is lame
[2013-12-11 19:14:27 -0500] Garo_: I'm having problems with my node[] attributes. My bootstrap recipes finds them very well and I can see them after bootstrap on the Chef web ui, but the next recipe, which I run with "chef-client -o myrecipe" can't find all those attributes any more. My bootstrap recipe does add some new variables with node.set[] and later does node.save. Any ideas what I'm doing wrong?
[2013-12-11 19:15:06 -0500] glen: Garo_: does bootstrap exit successfully? afaik no save is made if bootstrap initial run fails
[2013-12-11 19:15:59 -0500] Garo_: glen: yes, I don't think it fails. Also the recipe does call node.save just after node.set[], if that might force the saving even if the bootstrap later fails?
[2013-12-11 19:16:21 -0500] glen: Garo_: dunno, afaik that node.save has no point
[2013-12-11 19:16:37 -0500] anoldhacker: Does knife see the attribute right now?
[2013-12-11 19:16:56 -0500] Garo_: ok, I have to check that. I just copied the node.save from some other recipe.
[2013-12-11 19:17:09 -0500] spheromak: Garo_: -o shouldn't save back to server.
[2013-12-11 19:17:11 -0500] spheromak: iirc
[2013-12-11 19:17:13 -0500] anoldhacker: You might have mistyped the name of the attribute.
[2013-12-11 19:17:43 -0500] glen: he's complaining attrs from bootstrap not visible, not from -o missing
[2013-12-11 19:17:45 -0500] Garo_: spheromak: the recipe which I later run doesn't need to save
[2013-12-11 19:17:51 -0500] Garo_: yeah, jsut as glen said
[2013-12-11 19:19:58 -0500] Garo_: I don't have the system on my hands now. I live in europe timezone and I'm asking help from my home. but I've done the cycle many times: provisioned new ec2 instance and let it bootstrap. Then I check with Chef web ui that the attributes are there. Then I run the second recipe with chef-client -o and in the beginning I do Chef::Log.debug("attributes: #{node[:myvars].inspect}") and it doesn't show all those variables which ...
[2013-12-11 19:20:04 -0500] Garo_: ... I previously saved into node[:myvars]. After the recipe has ran then the Chef web ui shows the same state as the recipe run, ie: it's missing some of those attributes
[2013-12-11 19:20:41 -0500] gchristensen: `dogeshelf such-book|very-deploy|so-local`
[2013-12-11 19:20:54 -0500] Garo_: wow!
[2013-12-11 19:21:08 -0500] juliancdunn: )#$^#$ doge meme
[2013-12-11 19:21:52 -0500] gchristensen: http://www.windoge.com/ is pretty good, dogecoin is pretty ridiculous
[2013-12-11 19:26:45 -0500] Runkle: well frig. i'm trying to do a tutorial. i'm able to validate my install against hosted chef using "knife client list" but when i do "knife cookbook upload --all" i get "Error: the data in your request was invalid. Response bad checksums!"
[2013-12-11 19:27:10 -0500] phutchins: anyone using opsworks on AWS?
[2013-12-11 19:27:25 -0500] Runkle: running Chef: 11.8.2
[2013-12-11 19:27:34 -0500] phutchins: Trying to find a way to kick off some chef configuration before the opsworks chef recipes on the deploy lifecycle get run
[2013-12-11 19:28:13 -0500] Runkle: apparently this fixes is https://github.com/opscode/chef/pull/510
[2013-12-11 19:28:16 -0500] Garo_: btw anybody here awake using Ironchef?
[2013-12-11 19:29:17 -0500] phutchins: Garo_: is that like IronFan?
[2013-12-11 19:29:33 -0500] Garo_: err. yeah. ironfan I meant
[2013-12-11 19:31:11 -0500] phutchins: Garo_: Ah, i've started to set it up and play with it but got pulled into other things... I still want to give it a shot. Seems like a pretty good solution for spinning up cluseters automagically
[2013-12-11 19:32:39 -0500] Garo_: phutchins: yeah, that's what I've also been playing with. It seems that it lacks a bit EC2 VPC related features (they are there, but not 100% polished yet). also the docs are bit poor and I'm not sure if I should be using that without making sure that I know traditional chef well enough, but the cluster features seems to be very good
[2013-12-11 19:33:15 -0500] phutchins: yeah... seemed to be the most open for different types of solutions
[2013-12-11 19:34:25 -0500] Garo_: my problem manifested in my ironfan tests and it also might be that I'm not understanting some part how the attributes travel from knife cluster launch to chef server to instance and back to chef server and that's why I'm having problems...
[2013-12-11 19:40:03 -0500] phutchins: Garo_: yeah i haven't gotten that far so not sure i'd be much help...
[2013-12-11 19:40:26 -0500] Garo_: phutchins: no problem. feel free to join #ironfan. I've been idling there on my own for the past week :D
[2013-12-11 19:40:28 -0500] phutchins: I'm stuck on finding a way to get AWS OpsWorks to run a chef recipe BEFORE its deploy lifecycle lol...
[2013-12-11 19:40:42 -0500] phutchins: Garo_: yeah I think i might do that... just to catch some info before I give it a shot again
[2013-12-11 19:40:51 -0500] redondos: if a node is already created on the chef server, why does running `knife bootstrap' clear its runlist?
[2013-12-11 19:41:47 -0500] jidar: I assume because you're re-bootstraping it
[2013-12-11 19:41:58 -0500] jidar: you likely just want to run the chef-client on it
[2013-12-11 19:42:01 -0500] spheromak: redondos: knife bootstrap build a jsonfile that is used with chef-client -j. this json file sets the run_list as you specified with -r in knife bootstrap
[2013-12-11 19:42:42 -0500] redondos: i am testing that right now: i ran knife bootstrap with -r, and i want to see if the node keeps this recipe in its run_list after it's done
[2013-12-11 19:44:36 -0500] juliancdunn: redondos: wdym "clear"?
[2013-12-11 19:44:50 -0500] juliancdunn: generally you don't create the node and then bootstrap. bootstrapping does the node creation.
[2013-12-11 19:45:36 -0500] redondos: i usually configure the node's json and use `knife from file', then use bootstrap to install chef on the node
[2013-12-11 19:45:41 -0500] redondos: obviously i am doing something wrong
[2013-12-11 19:46:03 -0500] juliancdunn: yeah, don't do that
[2013-12-11 19:46:10 -0500] juliancdunn: what are you configuring in the node's json?
[2013-12-11 19:46:17 -0500] redondos: attributes mostly
[2013-12-11 19:46:57 -0500] juliancdunn: attributes should be derived from the recipes/roles/environment that you run the node in
[2013-12-11 19:47:00 -0500] juliancdunn: (in most cases)
[2013-12-11 19:47:24 -0500] juliancdunn: so the workflow is generally, starting from not having a node object on the Chef server, "knife bootstrap ... -r 'role[foo],role[bar]'"
[2013-12-11 19:48:29 -0500] redondos: for some recipes/roles the default attributes don't cut it, so i need to change them in the node's json
[2013-12-11 19:49:22 -0500] redondos: so i would run bootstrap, then knife from file, then chef client.
[2013-12-11 19:49:43 -0500] sfiggins: Arght!  I have a template in which I need a literal '<%'.   Can't figure out how to escape that.
[2013-12-11 19:50:00 -0500] juliancdunn: redondos: yeah, you should think of your node object as completely temporal and derived data
[2013-12-11 19:50:16 -0500] redondos: sfiggins: <%%
[2013-12-11 19:50:25 -0500] juliancdunn: if the attributes "don't cut it" then you can put overrides in roles, wrapper cookbooks, or environments
[2013-12-11 19:50:50 -0500] sfiggins: redondos: that's what I thought but that's not working for me.
[2013-12-11 19:50:54 -0500] redondos: juliancdunn:  so i shouldn't be setting attributes in the node's json, ever?
[2013-12-11 19:51:27 -0500] juliancdunn: redondos: correct, never do that
[2013-12-11 19:51:36 -0500] juliancdunn: instead, use one of the existing data structures in Chef to model what you want
[2013-12-11 19:51:37 -0500] jidar: anybody useing windows have an issue with knife cookbook download foo, and it ignores the knife.rb cookbooks_path?
[2013-12-11 19:52:05 -0500] juliancdunn: example: I don't like these NTP servers in prod. so put the correct NTP servers in the prod.json environment, and the nodes in the prod environment get those timeservers
[2013-12-11 19:52:27 -0500] redondos: juliancdunn: for instance, if i want to tell a node to point to a particular database host, where do I set that?
[2013-12-11 19:52:48 -0500] juliancdunn: redondos: well, you have to think of "why does it need to point to XYZ database host"
[2013-12-11 19:52:55 -0500] juliancdunn: probably because it's running application ABC, right?
[2013-12-11 19:53:09 -0500] redondos: yeah. should ABC be a role then?
[2013-12-11 19:53:11 -0500] juliancdunn: so... maybe you have a role for application ABC that says what the DB server is
[2013-12-11 19:53:20 -0500] juliancdunn: yes -- or nodes can also dynamically discover each other by using search
[2013-12-11 19:53:24 -0500] redondos: so it's ok to set attributes in roles, but not in nodes?
[2013-12-11 19:53:36 -0500] redondos: interesting
[2013-12-11 19:53:44 -0500] juliancdunn: redondos: yes. set attributes in roles, environments, recipes, attribute files in cookbooks, etc... but never hack the node object manually
[2013-12-11 19:54:53 -0500] redondos: because nodes are volatile and should just be part of a collection of objects of a certain type?
[2013-12-11 19:55:10 -0500] juliancdunn: exactly, nodes are disposable
[2013-12-11 19:55:31 -0500] juliancdunn: if you lose a node, you can bring up another one just by specifying the same environment and run_list for the new one
[2013-12-11 19:56:27 -0500] gverri: What is the best way to deploy a rails app to Dev/Production using chef?
[2013-12-11 19:56:32 -0500] redondos: what concepts do environments signify, other than prod/qa?
[2013-12-11 19:56:57 -0500] gverri: Capistrano? Cloning the repo? Chef deploy?
[2013-12-11 19:57:00 -0500] redondos: sfiggins: http://archive.railsforum.com/viewtopic.php?id=11130 maybe?
[2013-12-11 19:57:08 -0500] juliancdunn: redondos: an environment is basically a "policy group"
[2013-12-11 19:57:22 -0500] juliancdunn: you can set cookbook version constraints in environments
[2013-12-11 19:58:19 -0500] sfiggins: redondos: trying that now.
[2013-12-11 19:58:23 -0500] daw13: Hello everyone,
[2013-12-11 19:58:31 -0500] redondos: juliancdunn: for example?
[2013-12-11 19:58:58 -0500] juliancdunn: redondos: you can say that 'prod' runs version 1.0.0 of the 'apache' cookbook, but 'qa' runs version 1.1.0
[2013-12-11 19:59:04 -0500] daw13: Is there a way to get chef to signal a reboot in the middle of a chef run?  I have a windows_feature the requires a reboot.
[2013-12-11 19:59:20 -0500] juliancdunn: thereby allowing you to stage system changes through your pipeline
[2013-12-11 19:59:45 -0500] juliancdunn: daw13: there's a windows_reboot LWRP in the windows cookbook
[2013-12-11 20:01:00 -0500] btm: @getchefdotcom chef/ohai code review: join: https://plus.google.com/hangouts/_/72cpigci4k4n6csttgr78vg22o, watch: http://youtu.be/IOlJAj2Z5Ow
[2013-12-11 20:01:13 -0500] daw13: Juliancdunn: I'm aware of that and use it but the problem I'm running into is that is signaled at the end of a chef run.  A need a reboot say after recipe A and before recipe B.  Is that possible?
[2013-12-11 20:02:12 -0500] sfiggins: redondos: that's kind of ugly, but it works.
[2013-12-11 20:02:39 -0500] sfiggins: redondos: thanks.
[2013-12-11 20:02:57 -0500] juliancdunn: daw13: sort of. you'll need to node.save, and then execute a reboot yourself
[2013-12-11 20:03:07 -0500] juliancdunn: because you're breaking the chef run in the middle
[2013-12-11 20:03:23 -0500] juliancdunn: node.save will post the state of the node object before the reboot back to the Chef server
[2013-12-11 20:04:01 -0500] jpoole: julian neato i was not aware of node.save
[2013-12-11 20:04:48 -0500] daw13: juliancdunn: thanks. Is this the recommended way?  The only other way I know of is to start with base runlist and than add the other recipes.
[2013-12-11 20:04:55 -0500] juliancdunn: don't abuse it, because doing that will ignore all accrued exceptions and post the data back irrespective of any
[2013-12-11 20:05:09 -0500] jpoole: daw13 it's windows, so probably the only way.
[2013-12-11 20:05:22 -0500] juliancdunn: daw13: that's the cleanest way. if you're not comfortable with that (given the caveat in my previous statement), then yeah, do it the way you described
[2013-12-11 20:05:57 -0500] daw13: juliancdunn: thank you!
[2013-12-11 20:07:02 -0500] daw13: juliancdunn: I guess for chef to pick up where it left off it needs to be run on start up?
[2013-12-11 20:07:14 -0500] daw13: using your approach
[2013-12-11 20:07:22 -0500] juliancdunn: yeah, or as a service
[2013-12-11 20:07:34 -0500] juliancdunn: which the chef-client cookbook will do for you
[2013-12-11 20:08:46 -0500] jpoole: could you do the reboot with a flag? ie node.run_state[:reboot] = true
[2013-12-11 20:08:48 -0500] redondos: when running knife bootstrap, the node that ends up in the server doesn't have the run_list specified with -r. am I supposed to add it after bootstrapping even though i've already told chef what kind of node this is?
[2013-12-11 20:09:17 -0500] jpoole: rendondos _default environment?
[2013-12-11 20:09:49 -0500] juliancdunn: redondos: it should
[2013-12-11 20:10:05 -0500] redondos: perhaps because the node was already created. i'll try again, thanks.
[2013-12-11 20:10:05 -0500] juliancdunn: the GUI will lag the current state a bit. if you want up-to-date results, use "knife node show XYZ" from your CLI
[2013-12-11 20:10:24 -0500] redondos: yes i used knife, i try to stay away from the gui
[2013-12-11 20:12:56 -0500] redondos: you're right, the node came up as expected
[2013-12-11 20:12:59 -0500] redondos: thanks for your insight, juliancdunn
[2013-12-11 20:13:14 -0500] juliancdunn: redondos: np
[2013-12-11 20:13:15 -0500] redondos: it'll change the way i've been doing things
[2013-12-11 20:14:12 -0500] werdnativ: I'm trying to run `knife node from file files/my.ip.json --verbose` but getting the error "ERROR: Method Not Allowed" and no response details. Any troubleshooting ideas?
[2013-12-11 20:18:21 -0500] werdnativ: ok. I was able to work around with knife node edit and paste my stuff in there.
[2013-12-11 20:18:40 -0500] juliancdunn: werdnativ: read scrollback about not doing "knife node from file" that I just had with redondos :)
[2013-12-11 20:19:02 -0500] werdnativ: ah, I just joined the room missed that.
[2013-12-11 20:20:57 -0500] allaire: The part about roles cookbooks: http://www.prashantrajan.com/posts/2013/06/leveling-up-chef-best-practices/ Is this something still recommended?
[2013-12-11 20:23:02 -0500] gchristensen: allaire: yes
[2013-12-11 20:23:14 -0500] gverri: Can anyone help me with a noob question?
[2013-12-11 20:23:28 -0500] gchristensen: allaire: at least, superficially it seems to be.
[2013-12-11 20:23:33 -0500] wdilly: Does anyone have any nice code that identifies a newly presented and unmounted partition?
[2013-12-11 20:24:08 -0500] gverri: https://gist.github.com/gverri/7917786 what is the equivalent of this json on hosted chef?
[2013-12-11 20:24:21 -0500] gverri: Is it a node json?
[2013-12-11 20:24:40 -0500] sfiggins: allaire: I jumped that direction getting rid of roles and now I'm relaxing on that some.  I'm very cautious about what I put into roles, but I do use them some.
[2013-12-11 20:25:05 -0500] allaire: sfiggins: I like the way he does it. still use role, but call a "role" cookbook
[2013-12-11 20:28:03 -0500] jidar: how do edit default_attributes for a specific role? I don't have the role defined anywhere except for the chef-server
[2013-12-11 20:28:22 -0500] jidar: ie: I don't have the workstation chef-repo/roles directory full of stuff
[2013-12-11 20:31:14 -0500] tcate: ?
[2013-12-11 20:31:19 -0500] tcate: mt
[2013-12-11 20:34:30 -0500] Runkle: i'm wondering how to debug knife bootstrap. cause mine is just saying "Bootstrapping Chef on 10.0.1.212" but does not appear to be running my runlist at all.
[2013-12-11 20:41:20 -0500] Blkdragon: Is there any one here who uses Instance Profiles and the S3_file cookbook? I am having an issue where the s3_file isn't finding the credentials in the meta-data service.
[2013-12-11 20:42:19 -0500] Blkdragon: But when you navigate manually via a browser to the meta-data service the instance profile is there and when you navigate to the single instance profile it does show the access_key and secret key.
[2013-12-11 20:54:28 -0500] jidar: this is balls retarded
[2013-12-11 20:56:22 -0500] gchristensen: "balls retarded"
[2013-12-11 20:56:29 -0500] gchristensen: remarkable.
[2013-12-11 20:58:48 -0500] anoldhacker: Well, I had an issue come up & couldn't make the code review. :(
[2013-12-11 21:00:43 -0500] anoldhacker: btm: you around?
[2013-12-11 21:03:39 -0500] surge_: Will something like this work in an attribute file? node.override['foo']['bar'] = `dnsdomainname`.strip  ?
[2013-12-11 21:03:49 -0500] btm: anoldhacker: aroundish
[2013-12-11 21:04:33 -0500] surge_: Apart from ruby conditions, I've never tried evaluating anything else in an attributes file before
[2013-12-11 21:05:11 -0500] anoldhacker: btm:  I'm hoping for some love on https://tickets.opscode.com/browse/CHEF-4826.  I hear that folks are aware of it, but I have no response to the ticket.
[2013-12-11 21:06:53 -0500] btm: @getchefdotcom cookbook code review: join: https://plus.google.com/hangouts/_/76cpioefkn474vok4iobnub8ec, watch: http://youtu.be/hYbxOknKYTg
[2013-12-11 21:07:12 -0500] aneel: hiya. complete beginner question: i'm going through the learn chef webinar, and trying to get set up with an enterprise chef account
[2013-12-11 21:07:32 -0500] aneel: something went wrong when i tried to set up my initial Organization
[2013-12-11 21:07:34 -0500] anoldhacker: surge_: We're seeing lots of bad things come from logic in the attributes files.  Try hard to avoid that...
[2013-12-11 21:07:34 -0500] CPS: btm: what time does this start?
[2013-12-11 21:07:56 -0500] aneel: but i've set up an organization through the normal interface
[2013-12-11 21:08:04 -0500] btm: CPS: on the hour usually, but december vacations are causing havoc and I'm bribing someone else from Chef to join now.
[2013-12-11 21:08:30 -0500] CPS: ok. youtube link just says to stand by
[2013-12-11 21:08:41 -0500] ranjib: yeah
[2013-12-11 21:08:44 -0500] aneel: however, the webinar directs me to download a "startup kit", which i can't see a link for in the org setup
[2013-12-11 21:08:46 -0500] btm: anoldhacker: by love, you mean you're hoping someone from Chef will fix it?
[2013-12-11 21:08:47 -0500] ranjib: same here
[2013-12-11 21:08:47 -0500] surge_: anoldhacker: Like what? It usually works well for me. Like "if node_in_some_ec2_region do  node['foo'] = bar"
[2013-12-11 21:08:48 -0500] anoldhacker: btm:  I can join you & talk about my ticket :P
[2013-12-11 21:09:48 -0500] aneel: is there a place to download the starter kit (which the webinar says contains the "chef-repo") separately?
[2013-12-11 21:09:52 -0500] anoldhacker: surge_:  I'm talking about maintenance & code sharing.
[2013-12-11 21:10:09 -0500] surge_: anoldhacker: pfft, this is most definitely not getting open sourced
[2013-12-11 21:10:09 -0500] surge_: lol
[2013-12-11 21:10:16 -0500] surge_: purely internal stuff
[2013-12-11 21:10:27 -0500] anoldhacker: Habit, man, it's all about good habits.
[2013-12-11 21:11:02 -0500] anoldhacker: Think of attributes as data, and the rest of your recipes as code.
[2013-12-11 21:11:16 -0500] surge_: True. I have noticed that I get better results when I define attributes in the default recipe instead.
[2013-12-11 21:11:39 -0500] surge_: Or rather, more in line with what I thought was going to happen
[2013-12-11 21:11:42 -0500] aneel: ah, perhaps it is http://github.com/opscode/chef-repo/ ?
[2013-12-11 21:12:04 -0500] anoldhacker: If another recipe needs to see the result of a computation, put it in a library.
[2013-12-11 21:13:07 -0500] anoldhacker: But if you put it in a recipe, you probably don't want default.
[2013-12-11 21:13:40 -0500] anoldhacker: Put the attribute computation in its own recipe & include it by whatever actually needs the data.
[2013-12-11 21:13:59 -0500] anoldhacker: But even then, this looks a lot like global data, while a library is not.
[2013-12-11 21:14:25 -0500] CPS: god that keyboard
[2013-12-11 21:14:40 -0500] CPS: is that what clicky mechanicals sound like on a webcam?
[2013-12-11 21:17:05 -0500] btm: anoldhacker: send me an email about it? btm@getchef.com. I can't look now, I've got this code review and then dinner with the in-laws.
[2013-12-11 21:18:58 -0500] Xeron: btm what happened with CLA and approved contributor list maintainers? legal@ or whom.
[2013-12-11 21:19:19 -0500] surge_: anoldhacker: It's just recipes within the same cookbook. Unfortunately, there are 3 cookbook that are using attributes from another. It's kinda messy, I'm the only Chef in the company at the moment so everything has been adhoc. I've been slowly refactoring stuff when i have time so i'll keep your comments in mind.
[2013-12-11 21:19:48 -0500] surge_: At least I'm not editing community cookbooks... made that mistake way back when I was learning this stuff a year ago
[2013-12-11 21:20:27 -0500] thehar:  /win 17
[2013-12-11 21:20:28 -0500] thehar: ugh
[2013-12-11 21:21:44 -0500] poseid: Hi, I am having problems installing a redis server and redis client, on a simple node, the logs are here: http://serverfault.com/questions/560778/how-to-install-redis-with-chef
[2013-12-11 21:21:57 -0500] poseid: anyone with an idea what might be wrong?
[2013-12-11 21:23:54 -0500] poseid: ok, i try to add a runit recipe, not sure
[2013-12-11 21:26:04 -0500] anoldhacker: btm:  k thkx
[2013-12-11 21:33:31 -0500] sfiggins: I'm bummed.   Foodcritic only ever complains.  It never offers praise.  :-(
[2013-12-11 21:34:23 -0500] sfiggins: I'm going to get a complex.
[2013-12-11 21:37:17 -0500] allaire: who use chef + capistrano here?
[2013-12-11 21:39:17 -0500] werdnativ: Berkshelf question: If I have "metadata" in my berksfile, why do I get " is not installed by your Berksfile" when I try to query any dependencies in my metadata.rb?
[2013-12-11 21:39:41 -0500] werdnativ: shouldn't it manage those too?
[2013-12-11 21:43:02 -0500] aneel: the answer to my question appears to be that in my chef organization, i can go to Administration, select my organization, and choose Starter Kit
[2013-12-11 21:46:44 -0500] a13x212: how do i clear the cache on node?
[2013-12-11 21:47:58 -0500] anoldhacker: werdnativ:  What do you mean "query any dependencies in my metadata.rb"?
[2013-12-11 21:48:21 -0500] werdnativ: anoldhacker: do anything like berks update mysql or berks show mysql
[2013-12-11 21:48:47 -0500] werdnativ: I thought it should manage my dependencies?
[2013-12-11 21:51:31 -0500] anoldhacker: We've had a lot of trouble with berks update.  We recommend blowing away the Berksfile.lock & regenerating.  Be sure to update the version of berkshelf.
[2013-12-11 21:54:00 -0500] werdnativ: I just tried that.
[2013-12-11 21:54:04 -0500] werdnativ: I can do a simple "berks update" but it doesn't get the latest versions. It's Using database (1.3.12); Using mysql (3.0.12).
[2013-12-11 21:54:22 -0500] werdnativ: If I do knife cookbook site show mysql it shows much more recent versions.
[2013-12-11 21:55:30 -0500] werdnativ: So I was trying to use "berks show" to see if I can spot any version locks in my dependencies.
[2013-12-11 21:58:25 -0500] gregkare: werdnativ: Do you have versions set for the cookbooks in your Berksfile?
[2013-12-11 21:58:59 -0500] werdnativ: no, but I think it's this: https://github.com/phlipper/chef-percona/blob/master/metadata.rb#L23
[2013-12-11 21:59:58 -0500] werdnativ: I was just wondering why berks couldn't show me that if I have that dependency in my metadata.rb instead of in Berksfile
[2013-12-11 22:00:49 -0500] gregkare: I don't use Berkshelf, sorry
[2013-12-11 22:04:28 -0500] gregkare: To me Berkshelf tries to do too much in one tool and ends up being extremely confusing, I like librarian-chef's simplicity
[2013-12-11 22:04:29 -0500] werdnativ: ok. The root problem I'm trying to solve is with the chef-percona cookbook and "RuntimeError: Incorrect MySQL client library version! This gem was compiled for 5.5.34 but the client library is 5.6.14."
[2013-12-11 22:07:27 -0500] werdnativ: the mysql I have on the server is percona mysql-5.5.34. I'm not sure where the mysql gem from the mysql cookbook got 5.6.14.
[2013-12-11 22:09:42 -0500] gregkare: This percona cookbook is using chef-rewind to redefine resources, so everything is hard to understand
[2013-12-11 22:10:03 -0500] gregkare: You have to look at both the mysql cookbook and the percona cookbook and see what's redefined, good luck
[2013-12-11 22:10:06 -0500] werdnativ: I'm seeing "percona" mentioned in https://github.com/opscode-cookbooks/mysql so maybe I don't need that chef-percona cookbook anymore.
[2013-12-11 23:02:49 -0500] miah: sup nerds.
[2013-12-11 23:09:03 -0500] sfiggins: miah: speaking of Chef and nerds have you ever watched Bitchin' Kitchin'?  It's a hoot.
[2013-12-11 23:09:56 -0500] sfiggins: That would be my foodfight pick for today I think.  If I were asked such a thing.
[2013-12-11 23:10:30 -0500] miah: url?
[2013-12-11 23:11:27 -0500] sfiggins: http://www.cookingchanneltv.com/shows/nadia-gs-bitchin-kitchen.html
[2013-12-11 23:11:46 -0500] sfiggins: got carried away on that kitchin' should have just been kitchen.
[2013-12-11 23:13:23 -0500] sfiggins: http://www.youtube.com/watch?v=iELyAABb_U4
[2013-12-11 23:18:47 -0500] force: Can I override a default attribute value that is a String with a null in JSON and achieve that as a nil in the attribute value? My tests with test-kitchen and setting the attribute to null or ~ result in the default String being used. I'd like to specify that the value be overridden to be nil.
[2013-12-11 23:21:25 -0500] jidar: is there no way to have windows_feature test for availability first before attempting to install? Also, this whole process just seems so cpu intensive, I assume chef is very different then puppet in that puppet was meant to be run over and over again, while chef is more in it for the single bootstrap and to be done. right?
[2013-12-11 23:23:11 -0500] miah: sfiggins: i prefer cooking with dog; https://www.youtube.com/watch?v=7PrwJxZfBH8
[2013-12-11 23:23:49 -0500] force: illustration: https://gist.github.com/justinforce/7920390
[2013-12-11 23:24:54 -0500] sfiggins: Tanoshi!
[2013-12-11 23:26:46 -0500] anoldhacker: jidar:  normal practice seems to be to run periodically.   Not all agree with this practice.
[2013-12-11 23:28:18 -0500] jidar: anoldhacker: I'd agree with periodically if I could write out my first request, where it checks if the service is installed without trying to install it first
[2013-12-11 23:28:32 -0500] jidar: because right now, I can't hit my box with 100% cpu for 50 seconds
[2013-12-11 23:28:49 -0500] anoldhacker: No.  That's what whyrun is about.
[2013-12-11 23:32:54 -0500] coderanger: Hmm?
[2013-12-11 23:38:01 -0500] gzc: re: whyrun, anyone ever see whyruns fail with odd messages when normal runs succeed? this hit awhile back, I don't believe I still have any logs to reference (hooray lack of centralized logging)
[2013-12-11 23:41:34 -0500] anoldhacker: It's all just code.  If someone is doing something interesting inside a whyrun definition, that would do it.  I would certainly start by checking those definitions.
[2013-12-11 23:43:09 -0500] allaire: Anybody here use a mix of chef + capistrano?
[2013-12-11 23:43:37 -0500] anoldhacker: Sounds like a bad idea...
[2013-12-11 23:44:10 -0500] allaire: well you need something to deploy your app right?
[2013-12-11 23:44:28 -0500] anoldhacker: Chef.
[2013-12-11 23:45:00 -0500] allaire: And how you do that easily?
[2013-12-11 23:45:05 -0500] anoldhacker: Cap is trying to do the same thing chef is, albeit in a more limited scope.
[2013-12-11 23:45:23 -0500] allaire: capistrano 3 is now much more slimmed down
[2013-12-11 23:45:56 -0500] allaire: but I'm all ears for an interesting chef-only solution
[2013-12-11 23:46:33 -0500] allaire: anoldhacker: even opscode recommend capistrano for app deployment: https://learnchef.opscode.com/starter-use-cases/multi-node-ec2/
[2013-12-11 23:46:46 -0500] anoldhacker: ??
[2013-12-11 23:46:58 -0500] allaire: ?? ?
[2013-12-11 23:47:16 -0500] anoldhacker: I'm on a backend team.  We supply the tools to our apps guys.
[2013-12-11 23:47:58 -0500] allaire: yes.. ?
[2013-12-11 23:48:30 -0500] anoldhacker: But on general principles, it seems to me that you are asking for trouble to have two different system managing the same resources on a box.
[2013-12-11 23:49:06 -0500] anoldhacker: But if it works for you, ignore my worries. :)
[2013-12-11 23:49:17 -0500] allaire: :P Alrighty
