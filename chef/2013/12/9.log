[2013-12-09 00:18:06 -0500] supercom32: When I create a fairly long run_list with recipes in sequence,  eventually I get a "HTTPServerException: 403 "Forbidden" error during folder creation. This does not seem to happen when running singley. Any ideas?
[2013-12-09 03:10:28 -0500] EnriqueCadalso: Hi, I have a cookbook with a [:my_cookbook][:version] attribute. The attribute is defined in the node definition, I can see the attribute at chef server web interface with the right value in the node properties. However when running chef-client on the server (or using knife ssh  from a workstation) the value of the attribute is not passed to the recipe, it is as if it were empty, so provision fails (it is used to create a directory filen
[2013-12-09 04:49:38 -0500] holms_: stupid bugs on centos with chef-server
[2013-12-09 04:49:39 -0500] holms_: =/
[2013-12-09 04:49:55 -0500] holms_: if you gonna run install twice, chef-server-ctl binary is moved to hell..
[2013-12-09 04:50:07 -0500] holms_: and i dunno wtf has happened, everytime i've tried like 200 times for the past month
[2013-12-09 04:50:15 -0500] holms_: only on centos \o/
[2013-12-09 05:22:54 -0500] sethvargo: @holms_ I don't think the Chef Server is fully supported on CentOS - just Ubuntu and RedHat. Even though CentOS is a derivative of RedHat, there are subtle differences which could explain why you're having issues. What version are you using?
[2013-12-09 05:23:37 -0500] coderanger: sethvargo: There are no differences
[2013-12-09 05:23:49 -0500] coderanger: sethvargo: centos is the same sans branding
[2013-12-09 05:24:21 -0500] n1ko: We have been quite happy with CentOS and Chef Server, or atleast the issues we have encountered don't have anything to do with the distribution
[2013-12-09 05:25:02 -0500] n1ko: i havent seen any "moving to hell issues", neither on manual installation or knife server
[2013-12-09 07:19:41 -0500] ohlol: guys
[2013-12-09 07:19:44 -0500] ohlol: install.sh is broken
[2013-12-09 07:19:45 -0500] ohlol: https://gist.github.com/ohlol/e79b086e4a01510c7033
[2013-12-09 07:36:05 -0500] iverson0881: hmmm this redirect from www.opscode.com to www.getchef.com might have broken a few things
[2013-12-09 07:40:55 -0500] iverson0881: ohlol: i can confirm the same issue.
[2013-12-09 07:41:14 -0500] iverson0881: it also appears it doesn't happen every time, so maybe a few bad servers or mirror in rotation?
[2013-12-09 07:41:15 -0500] ohlol: kind of annoying eh?
[2013-12-09 07:41:28 -0500] ohlol: wait u mean they arent using chef to manage the server config?
[2013-12-09 07:42:00 -0500] iverson0881: that would be assuming too much
[2013-12-09 07:42:08 -0500] ohlol: heh
[2013-12-09 07:42:12 -0500] ohlol: maybe theyre using salt
[2013-12-09 07:42:19 -0500] ohlol: or cfengine
[2013-12-09 07:44:28 -0500] iverson0881: ohlol: i just bootstrapped 20 servers and they all were able to get to a version of install.sh correctly, so could be fixed now?
[2013-12-09 07:44:40 -0500] ohlol: awesome, thx
[2013-12-09 07:44:42 -0500] ohlol: i'll try again
[2013-12-09 07:45:04 -0500] ohlol: i've got about the same number of vagrant boxes im trying to spin up :)
[2013-12-09 07:45:15 -0500] ohlol: been trying to use one to create a base box
[2013-12-09 07:45:19 -0500] slicknick: any recommendations for open source or cloud/web app alternatives to visio for creating visual diagrams - architectural docs, storage/net/sys diagrams, process flow, etc etc ..
[2013-12-09 07:46:03 -0500] ohlol: xfig
[2013-12-09 07:46:17 -0500] ohlol: omnigraffle is the best i think but it's $$
[2013-12-09 07:47:31 -0500] iverson0881: slicknick: i use omnigraffle with stencils available on the great google
[2013-12-09 07:47:53 -0500] slicknick: very well
[2013-12-09 07:48:11 -0500] slicknick: anyone tool with draw.io at all?
[2013-12-09 07:48:13 -0500] shimo: iverson0881: you use google too? i thought i was the only one
[2013-12-09 07:48:28 -0500] ohlol: iverson0881: yay! works
[2013-12-09 07:48:56 -0500] iverson0881: shimo: haha
[2013-12-09 07:49:04 -0500] slicknick: shimo: very aware and capable of using an
[2013-12-09 07:49:07 -0500] slicknick: google
[2013-12-09 07:49:07 -0500] iverson0881: ohlol: ok cool, hopefully really fixed on opscode's end
[2013-12-09 07:49:12 -0500] ohlol: ya
[2013-12-09 07:55:54 -0500] slicknick: care not to sift through the ever worsening results.  seeking not a sponsored blog post or some ad filled forum, instead, a dialogue amongst frequent users of such tools
[2013-12-09 08:39:10 -0500] jtimberman: sorry about the broken install.sh a bit ago. should be all set now.
[2013-12-09 08:57:03 -0500] michael_mbp: hi all!
[2013-12-09 09:01:05 -0500] slicknick: what it do
[2013-12-09 09:05:55 -0500] michael_mbp: bah, I just got a really sweet chef stack setup, but runit's dying on starting nginx hmm...
[2013-12-09 09:06:42 -0500] slicknick: just got? meaning a bunch of cookbooks n recipes n schtuff ?
[2013-12-09 09:06:46 -0500] slicknick: not sure what runit is
[2013-12-09 09:06:57 -0500] slicknick: have you looked at logs?
[2013-12-09 09:29:41 -0500] michael_mbp: it's like init.d
[2013-12-09 09:31:36 -0500] workmad3: closer to upstart than init.d :)
[2013-12-09 09:32:43 -0500] workmad3: michael_mbp: what do your nginx logs say? and do you have a runit log service set up?
[2013-12-09 09:40:31 -0500] michael_mbp: hey workmad3
[2013-12-09 09:40:35 -0500] michael_mbp: yeah
[2013-12-09 09:40:40 -0500] michael_mbp: down: runsvdir-rails: 1s, normally up, want up; run: log: (pid 12831) 36258s
[2013-12-09 09:40:48 -0500] michael_mbp: down: nginx: 0s, normally up, want up; run: log: (pid 9189) 36767s
[2013-12-09 09:40:57 -0500] henk76: guys, i've set an attribute with a certain value (attribute: release, value: 1.2.3) If i want to use that in a not_if statement, what would it be? I've now got: not_if { node['release'] == '1.2.3' }   but that doesn't work.
[2013-12-09 09:41:01 -0500] michael_mbp: nginx is being logged to exec svlogd -tt ./main
[2013-12-09 09:41:06 -0500] michael_mbp: where is that ?
[2013-12-09 09:41:15 -0500] jtimberman: michael_mbp: the default log is /etc/service/nginx/log/main/current
[2013-12-09 09:41:17 -0500] jtimberman: for nginx
[2013-12-09 09:41:21 -0500] jtimberman: with that config
[2013-12-09 09:41:31 -0500] michael_mbp: ha cheers jtimberman
[2013-12-09 09:42:14 -0500] jtimberman: and fwiw, :) http://jtimberman.housepub.org/blog/2012/12/29/process-supervision-solved-problem/
[2013-12-09 09:42:40 -0500] jtimberman: and this post is superb http://rubyists.github.io/2011/05/02/runit-for-ruby-and-everything-else.html
[2013-12-09 09:43:29 -0500] michael_mbp: thanks, yeah I'm on that second link
[2013-12-09 09:44:24 -0500] scottmuc: runit reminds me of daemontools, are they comparable?
[2013-12-09 09:44:45 -0500] jtimberman: scottmuc: runit is essentially a rewrite of daemontools.
[2013-12-09 09:45:07 -0500] jtimberman: daemontools was licensed in such a way as to not be binary-distributable (e.g., by linux distros)
[2013-12-09 09:45:19 -0500] jtimberman: gerrit pape rewrote it as runit and packaged it up :)
[2013-12-09 09:45:25 -0500] michael_mbp: basically I've got an app based deploy setup
[2013-12-09 09:45:47 -0500] scottmuc: jtimberman: ahh. yeah, I remember having to build daemontools everywhere I used it
[2013-12-09 09:45:51 -0500] michael_mbp: so I've got a deploy cookbook, that grabs all apps defined via databag entries, that's working nicely (so far)... but
[2013-12-09 09:45:59 -0500] michael_mbp: my nginx confix is based on https://github.com/cfitz/catalog-kitchen/blob/master/site-cookbooks/catalog/recipes/rails_application.rb
[2013-12-09 09:46:35 -0500] scottmuc: jtimberman: I wonder what djb thinks. Thanks for the through writeup
[2013-12-09 09:47:01 -0500] jtimberman: scottmuc: he likely doesn't care, he put all his software public domain several years ago
[2013-12-09 09:47:20 -0500] jtimberman: anyway, tonights work complete, so now i sleep :)
[2013-12-09 09:47:30 -0500] michael_mbp: thanks jtimberman nn
[2013-12-09 09:47:40 -0500] henk76: sleep tight timberman ;)
[2013-12-09 09:48:21 -0500] scottmuc: l8rz
[2013-12-09 09:49:26 -0500] workmad3: michael_mbp: btw, I have a tendency to change that './main' in logging to '/var/log/<service_name>' so that I get logs like '/var/log/nginx/current'
[2013-12-09 09:49:53 -0500] henk76: guys, i've set an attribute with a certain value (attribute: release, value: 1.2.3) If i want to use that in a not_if statement, what would it be? I've now got: not_if { node['release'] == '1.2.3' }   but that doesn't work.
[2013-12-09 09:50:41 -0500] workmad3: henk76: 'doesn't work' how?
[2013-12-09 09:50:50 -0500] gregkare: henk76: Use a normal ruby if around the resource
[2013-12-09 09:52:25 -0500] henk76: well what i want to do is make a recipe for all our releases. and use the chef client interval. So if i attach a new recipe to a client, that it would update itself. But now, without the check on the release it would keep on running everytime the interval runs on the client
[2013-12-09 09:52:59 -0500] henk76: and it includes restarting services. can't have that happening ;)
[2013-12-09 09:53:51 -0500] workmad3: have you checked out the deploy resource or the application cookbook? :)
[2013-12-09 09:54:26 -0500] workmad3: the deploy_revision resource is pretty powerful, with hooks to allow you to run resources only on new deployments, etc
[2013-12-09 09:55:52 -0500] henk76: it's a custom application. Let me explain what the workflow is. If we get a new release of our software we stop certain service (iis/application pools) and then upgrade the software and run the services again. The software can't be upgraded due to blocked .exe files.
[2013-12-09 09:58:56 -0500] henk76: i'll look into the revision resource. looks promising
[2013-12-09 09:59:49 -0500] henk76: a bit overkill at the moment ;)
[2013-12-09 10:01:00 -0500] michael_mbp: workmad3: got nginx up, I had (intentionally) deployed empty SSL keys :D
[2013-12-09 10:07:20 -0500] workmad3: michael_mbp: ah, that ain't gonna work :D
[2013-12-09 10:07:52 -0500] michael_mbp: I was just getting all the cookbook stuff sorted, yeah I'll generated some self signed keys for now
[2013-12-09 10:08:00 -0500] workmad3: michael_mbp: btw https://www.ssllabs.com/ssltest/analyze.html is useful for checking out your server config
[2013-12-09 10:08:10 -0500] workmad3: (I use startssl certs myself)
[2013-12-09 10:08:10 -0500] michael_mbp: ohh thanks
[2013-12-09 10:08:19 -0500] michael_mbp: cool
[2013-12-09 10:08:26 -0500] michael_mbp: run: ../nginx: (pid 27616) 900s; run: log: (pid 9189) 38439s
[2013-12-09 10:08:34 -0500] michael_mbp: yay
[2013-12-09 10:10:14 -0500] michael_mbp: not sure why I get chpst: fatal: unknown user/group: appuser
[2013-12-09 10:10:21 -0500] michael_mbp: if I use that user (it exists)
[2013-12-09 10:11:37 -0500] michael_mbp: workmad3: can I pass variables in the runit_service block?
[2013-12-09 10:11:50 -0500] michael_mbp: it's because of options( deploy_to: app_path )
[2013-12-09 10:12:02 -0500] michael_mbp: as my app_path is under it's own app user (not appuser!)
[2013-12-09 10:12:05 -0500] rajdeep_: guys just has an issue uploading a cookbook could not understand what the issue was
[2013-12-09 10:12:12 -0500] rajdeep_: this was the error which I got
[2013-12-09 10:12:20 -0500] rajdeep_: ^[[BERROR: Failed to upload  : 401 Unauthorized
[2013-12-09 10:12:22 -0500] rajdeep_: {"error":["Failed to authenticate. Please synchronize the clock on your client"]}
[2013-12-09 10:12:23 -0500] rajdeep_: /usr/lib/ruby/vendor_ruby/restclient/abstract_response.rb:48:in `return!': 401 Unauthorized (RestClient::Unauthorized)
[2013-12-09 10:12:25 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:230:in `process_result'
[2013-12-09 10:12:26 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:178:in `transmit'
[2013-12-09 10:12:28 -0500] rajdeep_: from /usr/lib/ruby/1.8/net/http.rb:543:in `start'
[2013-12-09 10:12:29 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:172:in `transmit'
[2013-12-09 10:12:31 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:64:in `execute'
[2013-12-09 10:12:32 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:33:in `execute'
[2013-12-09 10:12:34 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/resource.rb:80:in `put'
[2013-12-09 10:12:35 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:142:in `uploader_function_for'
[2013-12-09 10:12:37 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:25:in `call'
[2013-12-09 10:12:38 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:25:in `setup_worker_threads'
[2013-12-09 10:12:40 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:24:in `loop'
[2013-12-09 10:12:41 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:24:in `setup_worker_threads'
[2013-12-09 10:12:43 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:23:in `initialize'
[2013-12-09 10:12:45 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:23:in `new'
[2013-12-09 10:12:46 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:23:in `setup_worker_threads'
[2013-12-09 10:12:47 -0500] michael_mbp: rajdeep_: flooding the chan is well...
[2013-12-09 10:12:48 -0500] rajdeep_: from /usr/lib/ruby/1.8/net/protocol.rb:135:in `map'^[[BERROR: Failed to upload  : 401 Unauthorized
[2013-12-09 10:12:49 -0500] rajdeep_: {"error":["Failed to authenticate. Please synchronize the clock on your client"]}
[2013-12-09 10:12:51 -0500] rajdeep_: /usr/lib/ruby/vendor_ruby/restclient/abstract_response.rb:48:in `return!': 401 Unauthorized (RestClient::Unauthorized)
[2013-12-09 10:12:51 -0500] michael_mbp: bad news for you.
[2013-12-09 10:12:52 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:230:in `process_result'
[2013-12-09 10:12:54 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:178:in `transmit'
[2013-12-09 10:12:55 -0500] michael_mbp: gist use it.
[2013-12-09 10:12:55 -0500] rajdeep_: from /usr/lib/ruby/1.8/net/http.rb:543:in `start'
[2013-12-09 10:12:57 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:172:in `transmit'
[2013-12-09 10:12:58 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:64:in `execute'
[2013-12-09 10:13:00 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/request.rb:33:in `execute'
[2013-12-09 10:13:01 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/restclient/resource.rb:80:in `put'
[2013-12-09 10:13:03 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:142:in `uploader_function_for'
[2013-12-09 10:13:04 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:25:in `call'
[2013-12-09 10:13:06 -0500] michael_mbp: stacktrace flood LOL
[2013-12-09 10:13:06 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:25:in `setup_worker_threads'
[2013-12-09 10:13:07 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:24:in `loop'
[2013-12-09 10:13:09 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:24:in `setup_worker_threads'
[2013-12-09 10:13:09 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:23:in `initialize'
[2013-12-09 10:13:10 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:23:in `new'
[2013-12-09 10:13:12 -0500] rajdeep_: from /usr/lib/ruby/vendor_ruby/chef/cookbook_uploader.rb:23:in `setup_worker_threads'
[2013-12-09 10:13:13 -0500] rajdeep_: from /usr/lib/ruby/1.8/net/protocol.rb:135:in `map'
[2013-12-09 10:13:41 -0500] rajdeep_: sorry micheal i think i cud have cut it short
[2013-12-09 10:14:17 -0500] michael_mbp: no
[2013-12-09 10:14:24 -0500] michael_mbp: pasting in the chan is not how you do it
[2013-12-09 10:14:44 -0500] michael_mbp: use gist.github.com
[2013-12-09 10:14:46 -0500] gregkare: Haaaaave you tried synchronizing the clock on your client? That's the error message, after all
[2013-12-09 10:15:54 -0500] rajdeep_: @gregkare: this is were it beats me
[2013-12-09 10:16:09 -0500] rajdeep_: i tried synchronizing the clock but that does not work
[2013-12-09 10:16:32 -0500] rajdeep_: i was pushing a file 22mb it is where it failed
[2013-12-09 10:17:09 -0500] rajdeep_: there was file which was 19mb and that worked for me but somehow it failed for me this time
[2013-12-09 10:20:47 -0500] henk76: rajdeep_ how far are your clock apart
[2013-12-09 10:35:21 -0500] rajdeep_: @henk76 : the clock is now in sync but i am still facing the same issue
[2013-12-09 10:36:25 -0500] rajdeep_: this is a ubuntu vm where i am facing the issue when i push the same file via my physical machine its a clean cookbook upload
[2013-12-09 10:45:39 -0500] enbergj: on a chef node, can I easily list the roles active for it?
[2013-12-09 10:52:42 -0500] s2r2: enbergj: "chef-shell -z", "node.roles"  might help
[2013-12-09 10:54:17 -0500] enbergj: well, I was hoping to do this programmatically, I think I should've mentioned that
[2013-12-09 10:57:19 -0500] ptrf: enbergj: node.roles?
[2013-12-09 10:57:49 -0500] ptrf: oh it was mentionen
[2013-12-09 10:57:50 -0500] ptrf: d
[2013-12-09 11:33:20 -0500] TakumoKatekari: so I've got a git deploy key, and I want to store it in a data bag
[2013-12-09 11:33:29 -0500] TakumoKatekari: how do I put it in my databag? :(
[2013-12-09 11:34:42 -0500] gregkare: http://docs.opscode.com/essentials_data_bags.html
[2013-12-09 11:37:45 -0500] TakumoKatekari: gregkare: That's what I'm reading, doesn't say how to make that transformation
[2013-12-09 11:39:39 -0500] TakumoKatekari: tr doesn't seem to like changing one character out for two
[2013-12-09 11:40:58 -0500] gregkare: I don't understand, changing one character out for two?
[2013-12-09 11:42:25 -0500] TakumoKatekari: to change out '\n' for a literal '\n' (\\n)
[2013-12-09 11:42:30 -0500] TakumoKatekari: it can't do that
[2013-12-09 11:44:54 -0500] TakumoKatekari: also trying to work out how to specify the git ssh key
[2013-12-09 12:14:27 -0500] mattsmit_: How long before an attribute is search able via a recipe after a succesfull chef-client run? i.e chef-client -o 'role[myrole]'
[2013-12-09 12:15:36 -0500] workmad3: mattsmith_: pretty much instantaneously, IME
[2013-12-09 12:16:46 -0500] mattsmith_: workmad3, Ok thanks. May be able to rule that out then  :-)
[2013-12-09 12:35:39 -0500] ptrf: mattsmith_: if you need updated attributes, consider using the ohai resource
[2013-12-09 12:55:17 -0500] holms:  http://pastie.org/8539456
[2013-12-09 12:55:20 -0500] holms: any ideas? :/
[2013-12-09 12:56:46 -0500] TakumoKatekari: holms: Not enough info, how did you get this error? Were you using Berkshelf? Knife?
[2013-12-09 12:56:56 -0500] holms: okey i'll update one sec
[2013-12-09 12:57:30 -0500] holms: http://pastie.org/pastes/8539482/text
[2013-12-09 12:58:29 -0500] TakumoKatekari: ok that's weird
[2013-12-09 12:58:43 -0500] holms: and i've tried so many stuff
[2013-12-09 12:58:45 -0500] holms: git clone works
[2013-12-09 12:58:55 -0500] holms: tried to put that cookbook manualy to ./cookbook
[2013-12-09 12:58:58 -0500] holms: tried to put that cookbook manualy to ./cookbooks*
[2013-12-09 12:59:09 -0500] TakumoKatekari: have you tried locking the cookbook version?
[2013-12-09 12:59:10 -0500] holms: what else can I try ))
[2013-12-09 12:59:17 -0500] holms: i haven't
[2013-12-09 12:59:20 -0500] holms: let's see
[2013-12-09 12:59:59 -0500] holms: as you can see in pastie, i had problem with elasticsearch at friday, now it problem with next one :DDDd
[2013-12-09 13:00:27 -0500] holms: TakumoKatekari: actually another branch is newer than master and not stable, + there's no tags =/
[2013-12-09 13:00:46 -0500] TakumoKatekari: oh well that might have something to do with it... the cookbook 'kibana' pointed to a totally different git repo
[2013-12-09 13:01:09 -0500] TakumoKatekari: which uses apache instead of nginx :|
[2013-12-09 13:01:33 -0500] holms: le me delete that cookbook from berksfile
[2013-12-09 13:01:52 -0500] holms: hmz
[2013-12-09 13:02:01 -0500] holms: so it's cookbook problems
[2013-12-09 13:02:07 -0500] holms: this is bad
[2013-12-09 13:02:10 -0500] TakumoKatekari: ugh, why is it so hard to clone a private git repo :|
[2013-12-09 13:13:46 -0500] holms: TakumoKatekari: checkouted to site-cookbooks - works :DD wtf
[2013-12-09 13:15:30 -0500] TakumoKatekari: gah, why is cloning a private git repo so difficult? how do I supply the confounded ssh key!?
[2013-12-09 13:15:44 -0500] holms: TakumoKatekari: not sure what do you mean
[2013-12-09 13:15:59 -0500] holms: should work even without ssh key if you use https
[2013-12-09 13:16:16 -0500] holms: unless github has something really different from bitbucket, never used github for private repo (is it free?)
[2013-12-09 13:20:24 -0500] robwatkin: Sorry if I'm repeating ... I'm using application_ruby cookbook. Does anyone know how to make rails use it's own ruby version/installation?
[2013-12-09 13:21:16 -0500] holms: robwatkin: no chance to setup rvm/rbenv first and then install app_ruby in there..?
[2013-12-09 13:21:59 -0500] TakumoKatekari: holms: not free for private, also with https I'd have to input the username and password which is a big nono
[2013-12-09 13:22:21 -0500] holms: TakumoKatekari: so to use git:// you need ssh keys
[2013-12-09 13:22:30 -0500] holms: you have that added? never had problems :D
[2013-12-09 13:22:38 -0500] TakumoKatekari: yes, I've got it, but how do I supply it to chef?
[2013-12-09 13:22:44 -0500] robwatkin: Thanks
[2013-12-09 13:23:17 -0500] TakumoKatekari: like I don't see an option on the `git` resource, nor do I see how to put the data in a databag
[2013-12-09 13:23:46 -0500] gregkare: TakumoKatekari: Are you using the deploy resource? Look up git_ssh_wrapper
[2013-12-09 13:24:59 -0500] TakumoKatekari: I'm just using a git resource right now, but that still has the git_ssh_wrapper option iirc
[2013-12-09 13:25:15 -0500] TakumoKatekari: there's not much detail on it :/
[2013-12-09 13:25:49 -0500] TakumoKatekari: aah this is interesting
[2013-12-09 13:26:52 -0500] gregkare: Yeah you can just look information about standalone git's ssh wrapper
[2013-12-09 13:27:13 -0500] cassianoleal: I'm trying to lazy evaluate an attribute, but when I converge the node I get: No resource found for lazy. Tried application_lazy, application_php_lazy, application_ruby_lazy, lazy
[2013-12-09 13:27:43 -0500] cassianoleal: the attribute is set like this (inside an application resource): deploy_key lazy { ::File.read("#{parameters[:path]}/keys/#{parameters[:name]}") }
[2013-12-09 13:27:50 -0500] cassianoleal: any ideas what could be wrong?
[2013-12-09 13:33:45 -0500] holms: kill me with a spoon... STDERR: error: The requested URL returned error: 403 while accessing https://github.com/elasticsearch/kibana/info/refs
[2013-12-09 13:43:21 -0500] dark_dr4g0n: hello. why chef can't get valid lsb_release name of distrib in first run? after 2 and 3 runs apt cookbook set valid repository and everything ok.
[2013-12-09 13:58:22 -0500] nacer: hello guy,
[2013-12-09 13:58:41 -0500] nacer: i'm opscode shirt is getting old, where can i get a new one ? :)
[2013-12-09 14:03:30 -0500] teukka: nacer: opscode is no more =) http://www.getchef.com/blog/2013/12/09/big-day-for-chef/
[2013-12-09 14:03:56 -0500] nacer: teukka: yep i know, good reason to update my shirt :)
[2013-12-09 14:04:52 -0500] teukka: I guess they are sold only on museums now ;)
[2013-12-09 14:06:40 -0500] michael_mbp: hey guys, hi teukka
[2013-12-09 14:06:53 -0500] michael_mbp: I've got two users in my databag, but only the first one is being created?
[2013-12-09 14:07:06 -0500] michael_mbp: the second one gets a home directory, but isn't being added to its group etc.
[2013-12-09 14:08:37 -0500] michael_mbp: ahhh the recipe!
[2013-12-09 14:08:51 -0500] teukka: michael_mbp: hi! users cookbook I guess? have run chef with debug output? it should show all the commands it makes
[2013-12-09 14:09:21 -0500] michael_mbp: no wonder, it was only createing sysadmins :)
[2013-12-09 14:09:26 -0500] michael_mbp: so my appuser wasn't properly made
[2013-12-09 14:09:45 -0500] michael_mbp: chef run with debug, how? I'm running under vagrant at the moment
[2013-12-09 14:11:50 -0500] john014: hell
[2013-12-09 14:11:53 -0500] john014: hello
[2013-12-09 14:12:25 -0500] john014: im looking for someone averse in Knife Azure to look at an issue, anyone here willing to help?
[2013-12-09 14:15:11 -0500] john014_: hello sorry, but the issue ID is KNIFE-292
[2013-12-09 14:15:19 -0500] john014_: anyone
[2013-12-09 14:15:42 -0500] teukka: michael_mbp: chef.log_level = :debug
[2013-12-09 14:15:57 -0500] drrk: john014_: it's still only 6am in seattle
[2013-12-09 14:16:16 -0500] john014_: ah ok, sorry guys. im GMT, what time would be best
[2013-12-09 14:16:49 -0500] drrk: I think they start to roll in from about 8am PST, so 16:00 GMT
[2013-12-09 14:17:11 -0500] teukka: michael_mbp: and chef-client and chef-solo have `-l debug` option if you're running them manually. and knife-solo inherits knife's `-VV`
[2013-12-09 14:17:12 -0500] michael_mbp: oh wait...
[2013-12-09 14:17:22 -0500] michael_mbp: teukka: ahh thanks
[2013-12-09 14:17:39 -0500] michael_mbp: I'm just doing vagrant provision at the moment
[2013-12-09 14:17:54 -0500] michael_mbp: the users cookbook only sets up sysadmins
[2013-12-09 14:17:59 -0500] michael_mbp: no worries, I'll set mine up by hand
[2013-12-09 14:18:05 -0500] john014_: thanks drrk, do you think someone might be able to help
[2013-12-09 14:18:13 -0500] john014_: im struggling :(
[2013-12-09 14:22:15 -0500] lewiz: Anybody know why a template running at compiletime might not generate a file?
[2013-12-09 14:22:43 -0500] CPS: does chef-client spit out the resulting template?
[2013-12-09 14:22:49 -0500] CPS: to the console
[2013-12-09 14:22:54 -0500] lewiz: CPS: no, I don't see it
[2013-12-09 14:23:07 -0500] CPS: what does it say when it executes that resource?
[2013-12-09 14:23:15 -0500] drrk: john014_: I know nothing about azure myself, try asking on the mailing list
[2013-12-09 14:23:54 -0500] lewiz: CPS: not much.  I'm using a yum_repository which generates a template.  it says "up to date".  no more useful info running chef-client in debug mode either
[2013-12-09 14:24:43 -0500] CPS: oh are you not using the template resource?
[2013-12-09 14:25:10 -0500] lewiz: CPS: I am using a percona_repo provider which uses template
[2013-12-09 14:25:24 -0500] lewiz: CPS: perhaps I should debug with a simple template first
[2013-12-09 14:25:54 -0500] CPS: yeah i'm not sure what's going on, but "up to date" makes me think chef thinks nothing has changed so it doesn't need to run that resource
[2013-12-09 14:28:31 -0500] lewiz: CPS: yep, interestingly if I add a template in the same codepath I do see the full generated file.  will keep digging
[2013-12-09 14:29:21 -0500] lewiz: CPS: ah, the yum cookbook has no templates subdir cached!
[2013-12-09 14:29:37 -0500] CPS: strange
[2013-12-09 14:30:40 -0500] teukka: michael_mbp: you can set up other groups with `users_manage` resource
[2013-12-09 14:31:03 -0500] lewiz: CPS: chef tries to be pretty smart though.  I wonder if it's because it doesn't see the templates being used due to the way we're invoking it
[2013-12-09 14:31:13 -0500] lewiz: CPS: I'll try and trick it into fetching them
[2013-12-09 14:35:58 -0500] skanev: is there a way to use a data bag value in a role (chef solo?
[2013-12-09 14:36:05 -0500] skanev: calling data_bag_item does not work :)
[2013-12-09 14:36:41 -0500] daxroc: Hi all
[2013-12-09 14:37:37 -0500] daxroc: I'm getting a 500 error when trying to use knife from windows 7 ( Works fine from OSX )? Error shown is INFO: HTTP Request Returned 500 Internal Server Error:
[2013-12-09 14:37:38 -0500] daxroc: ERROR: JSON::ParserError:
[2013-12-09 14:40:09 -0500] daxroc: Using knife 11.8.0
[2013-12-09 14:48:33 -0500] lewiz: CPS: https://tickets.opscode.com/browse/CHEF-4865
[2013-12-09 14:49:42 -0500] CPS: that's a little past my sphere of knowledge
[2013-12-09 14:50:12 -0500] lewiz: CPS: sure - mine too.  just thought you might have been interested to see :-)
[2013-12-09 14:50:36 -0500] CPS: it is an odd bug
[2013-12-09 14:53:48 -0500] hahaha: hi there
[2013-12-09 14:53:56 -0500] hahaha: totally new in chef
[2013-12-09 14:54:15 -0500] hahaha: how could I run role on new node?
[2013-12-09 14:57:06 -0500] michael_mbp: ufw::databag I'm getting an error re nil run_list
[2013-12-09 14:57:16 -0500] michael_mbp: whaaaaa
[2013-12-09 14:59:40 -0500] gverri: hahaha you have to create a new role, than add that role to the node
[2013-12-09 15:00:04 -0500] hahaha: gverri, thx cap
[2013-12-09 15:00:08 -0500] gverri: *then
[2013-12-09 15:00:14 -0500] hahaha: )
[2013-12-09 15:00:20 -0500] hahaha: role already created
[2013-12-09 15:00:30 -0500] gverri: are you using chef-solo or hosted chef?
[2013-12-09 15:00:47 -0500] joebz: I created encrypted data bags and pushed to my private chef server, but when I create an ec2 instance using knife, the data bags aren't on the server
[2013-12-09 15:01:15 -0500] joebz: /var/chef/data_bags does not exist on my instance
[2013-12-09 15:01:24 -0500] knuckolls: joebz: databags are queried from the chef server in the context of a recipe
[2013-12-09 15:01:24 -0500] hahaha: gverri, in company we use hosted chef, now I create my own branch and want to test it
[2013-12-09 15:01:26 -0500] joebz: Anyone know why?
[2013-12-09 15:01:37 -0500] hahaha: I guess its better to go with chef solo
[2013-12-09 15:01:48 -0500] hahaha: if no recepy editing needed
[2013-12-09 15:01:59 -0500] gverri: hahaha I use both. I'm using solo to write the cookbooks.
[2013-12-09 15:02:13 -0500] gverri: And hosted to deploy to my machines.
[2013-12-09 15:02:48 -0500] joebz: knuckolls: What if the recipe complains that the data bag doesn't exist?
[2013-12-09 15:03:08 -0500] robwatkin: Ah Chef! You're making me feel like I never learned to code!
[2013-12-09 15:03:40 -0500] knuckolls: joebz: a myriad of things could be wrong. if you could gist anything I might be able to diagnose it
[2013-12-09 15:04:20 -0500] TakumoKatekari: So I've got a problem, I've got some stuff running via runit
[2013-12-09 15:04:31 -0500] TakumoKatekari: and now I can't usermod because of runit
[2013-12-09 15:05:54 -0500] joebz: knuckolls: I'm creating data bags for the nexus cookbook according to their README https://github.com/RiotGames/nexus-cookbook
[2013-12-09 15:07:07 -0500] ___stefan: What do I need to include in my ruby class in order to use the chef http_request? I tried 'require 'chef/provider'' but it doesn't work. This is in a class that extends the chef handler
[2013-12-09 15:07:42 -0500] michael_mbp: btw anyone got an runit unicorn script?
[2013-12-09 15:08:07 -0500] michael_mbp: ha https://gist.github.com/justsee/5026661
[2013-12-09 15:08:13 -0500] knuckolls: joebz: unsure what could be wrong but all of the databag logic is right here https://github.com/RiotGames/nexus-cookbook/blob/master/libraries/chef_nexus.rb
[2013-12-09 15:08:29 -0500] knuckolls: it seems to make assumptions about your databag structure, so i'd start there. :)
[2013-12-09 15:09:22 -0500] joebz: knuckolls: thanks, i'll dig around
[2013-12-09 15:10:06 -0500] allaire: is the free tier with chef enterprise up to 5 nodes per account or per organization ?
[2013-12-09 15:20:52 -0500] TakumoKatekari: What's the EASIEST way to define my application's daemon command?
[2013-12-09 15:21:11 -0500] TakumoKatekari: i.e. "cd /path/to/app && coffee applciation.coffee"
[2013-12-09 15:28:54 -0500] hahaha: ok, just run `chef-solo --override-runlist "role[booter_production]"`
[2013-12-09 15:29:06 -0500] hahaha: [2013-12-09T19:28:28+04:00] ERROR: Role booter_production (included by 'top level') is in the runlist but does not exist. Skipping expand.
[2013-12-09 15:29:21 -0500] hahaha: cwd is chef repo root
[2013-12-09 15:56:25 -0500] hahaha: https://gist.github.com/anonymous/7874427
[2013-12-09 15:56:40 -0500] hahaha: why chef didnt recognized roles?
[2013-12-09 16:01:13 -0500] TakumoKatekari: why can't I get my chef role to NOT have the nginx default site?
[2013-12-09 16:01:39 -0500] TakumoKatekari: I've set node[:nginx][:default_site_enabled] = false
[2013-12-09 16:04:08 -0500] TakumoKatekari: oh silly me
[2013-12-09 16:11:21 -0500] MartinCleaver: Is there a known problem on Chef Server whereby Gem::Version behaves differently in Chef Server than in Chef Solo?
[2013-12-09 16:12:25 -0500] michael_mbp: guys shouldn't this should some info sudo tail -f /var/log/chef/client.log ?
[2013-12-09 16:12:35 -0500] hahaha: could chef-solo use roles defined as yml files?
[2013-12-09 16:12:49 -0500] michael_mbp: haha ruby and json afaik
[2013-12-09 16:13:20 -0500] michael_mbp: haha you could process yml via ruby if you like :)
[2013-12-09 16:14:06 -0500] srini: Hi all!
[2013-12-09 16:14:17 -0500] hahaha: michael_mbp, how could I do this?
[2013-12-09 16:15:03 -0500] michael_mbp: https://github.com/tenderlove/psych
[2013-12-09 16:15:09 -0500] michael_mbp: there are other wrappers
[2013-12-09 16:51:04 -0500] Srinivasa: when we add a role to a node using knife command... it does only add it to the runlist? does it not update the "Roles" on the node?
[2013-12-09 16:51:21 -0500] gchristensen: Srinivasa: roles gets updated when the chef-client runs successfully
[2013-12-09 16:51:48 -0500] gverri: Should I use opscode Nginx cookbook or write my own?
[2013-12-09 16:52:06 -0500] Srinivasa: gchristensen : can we force update it?
[2013-12-09 16:52:11 -0500] gchristensen: gverri: are you going to use nginx or write your own? or use the linux kernel or write your own?
[2013-12-09 16:52:32 -0500] knuckolls: gverri: my opinion on such questions are to use the upstream cookbook but use a wrapper cookbook and chef-rewind to set it up to your liking
[2013-12-09 16:52:45 -0500] gverri: gchristensen I'm finding the cookbook very hard to use
[2013-12-09 16:52:48 -0500] knuckolls: that way you have a cookbook specific to your organization's best practices that also leans on what the community has already written
[2013-12-09 16:52:56 -0500] gverri: was guessing maybe writing me own could be simpler
[2013-12-09 16:53:15 -0500] knuckolls: so you get it working once, rewind out what you don't like, patch what's broken, and then you have a solid standard for use internally
[2013-12-09 16:54:27 -0500] Srinivasa: gchristensen, got it :)
[2013-12-09 16:59:14 -0500] spiffytech: I'm concerned the git provider is ignoring my user's git config. I have a git config instruction to rewrite all git:// URIs as https://, because of corporate firewall. Works from the user's shell, doesn't work from my Chef recipe. How should I verify/resolve this?
[2013-12-09 17:01:10 -0500] michael_mbp: guys I've got nginx hitting unicorn, but I'm seeing the app error ...
[2013-12-09 17:01:11 -0500] michael_mbp: Ahh
[2013-12-09 17:01:27 -0500] michael_mbp: hmm but nothing it being logged to production.log, i.e. even that file isn't there
[2013-12-09 17:03:07 -0500] michael_mbp: ok so the error is 502 Bad Gateway
[2013-12-09 17:03:46 -0500] hahaha: does node[] hash available in chef-solo?
[2013-12-09 17:04:59 -0500] Thesolonius: hahaha: I think it is if you use chef-zero
[2013-12-09 17:05:18 -0500] hahaha: i dont)
[2013-12-09 17:05:25 -0500] hahaha: trying to get it
[2013-12-09 17:05:27 -0500] jkeiser: The node hash is available in both, I believe.
[2013-12-09 17:05:39 -0500] jkeiser: Easiest way to use zero is to download Chef 11.8 and run chef-client -z
[2013-12-09 17:05:52 -0500] jkeiser: Rough equivalent to chef-solo (but more powerful)
[2013-12-09 17:06:14 -0500] hahaha: jkeiser, ok, but I also need to point my chef-zero to cookbooks and roles
[2013-12-09 17:06:33 -0500] jkeiser: hahaha: put them in your directory same as chef-solo :)
[2013-12-09 17:06:35 -0500] hahaha: and attach some attributes and run_list to my node
[2013-12-09 17:06:50 -0500] jkeiser: hahaha: mkdir cookbooks, mkdir roles, put stuff in them, then run chef-client -z in that dir
[2013-12-09 17:07:04 -0500] hahaha: ok what is next?
[2013-12-09 17:07:28 -0500] jkeiser: hahaha: chef-client -z -o recipe[blah],role[foo] is an easy way to specify a run_list
[2013-12-09 17:07:55 -0500] jkeiser: hahaha: to get attributes, do knife node edit <nodename> -z and just edit the attributes in
[2013-12-09 17:08:18 -0500] jkeiser: The node will be placed in the nodes/ directory and can be inspected like any other Chef object
[2013-12-09 17:09:03 -0500] jkeiser: hahaha: it's very worth just trying it out.  Run chef-client -z -o <my run list> once, and then look in the nodes directory or do knife node edit -z to edit the node's attributes
[2013-12-09 17:09:15 -0500] jkeiser: I believe there is a -j parameter to chef-client for input attributes, but I have never used it
[2013-12-09 17:09:32 -0500] jkeiser: It's really one of those features that Just Works (or is supposed to, anyway)
[2013-12-09 17:10:59 -0500] hahaha: [2013-12-09T17:10:49+00:00] WARN: No config file found or specified on command line, using command line options.
[2013-12-09 17:10:59 -0500] hahaha: [2013-12-09T17:10:49+00:00] FATAL: Chef::Formatters::UnknownFormatter: No output formatter found for silent (available: null, doc, minimal, min)
[2013-12-09 17:11:41 -0500] jkeiser: What did you pass?  I'm confused why anything would say anything about "silent"
[2013-12-09 17:11:56 -0500] jkeiser: That's certainly not the default formatter
[2013-12-09 17:12:19 -0500] hahaha: chef-client -z -j roles/nloud/booter_production.json
[2013-12-09 17:12:39 -0500] jkeiser: And, do you have an /etc/chef/client.rb, .chef/knife.rb or ~/.chef/knife.rb file?
[2013-12-09 17:13:03 -0500] jkeiser: oh right, it's not picking one up.
[2013-12-09 17:13:30 -0500] jkeiser: What is chef-client -v?
[2013-12-09 17:13:51 -0500] hahaha: Chef: 11.8.0
[2013-12-09 17:13:53 -0500] jkeiser: And for giggles, can you just run chef-client -z without the -j option?
[2013-12-09 17:14:05 -0500] jkeiser: I'm wondering if something about the json file is bringing in the "silent" thing
[2013-12-09 17:14:06 -0500] hahaha: no, i havent any of this files
[2013-12-09 17:14:13 -0500] jkeiser: Like I said, I have never tried the -j option
[2013-12-09 17:14:18 -0500] hahaha: jkeiser, same error
[2013-12-09 17:14:46 -0500] jkeiser: Well, that's downright confusing.  Let me dig a bit
[2013-12-09 17:17:24 -0500] hahaha: jkeiser, looks like its related to our homebrew chef build
[2013-12-09 17:18:13 -0500] jkeiser: hahaha: oh? I'd love to hear more. I can't find the word "silent" in the chef codebase at all
[2013-12-09 17:26:17 -0500] michael_mbp: hmm found another template
[2013-12-09 17:26:24 -0500] michael_mbp: fingers crossed!
[2013-12-09 17:29:32 -0500] Tabbed: Hello All,
[2013-12-09 17:29:42 -0500] Tabbed: I'm running into an issue with a recipe/template
[2013-12-09 17:29:43 -0500] Tabbed: NameError: Cannot find a resource for template_file on ubuntu version 12.04
[2013-12-09 17:29:48 -0500] Tabbed: however
[2013-12-09 17:29:55 -0500] Tabbed: i have a default template
[2013-12-09 17:30:23 -0500] robwatkin: Any ideas why #cookbook 'rvm', github: 'fnichol/chef-rvm' installs ~/.berkshelf/cookbooks/rvm-0.0.4
[2013-12-09 17:31:03 -0500] holms: specify branch
[2013-12-09 17:31:23 -0500] Tabbed: ./default/: sv-uwsgi-log-run.erbsv-uwsgi-run.erbto_site.xml.erbto_site_xml.erbuwsgi_upstart.erb
[2013-12-09 17:31:35 -0500] robwatkin: holms: thanks
[2013-12-09 17:32:14 -0500] michael_mbp: guys any ideas on this
[2013-12-09 17:32:15 -0500] michael_mbp: udo chpst -udeployer runsvdir /home/deployer/service
[2013-12-09 17:32:16 -0500] michael_mbp: runsv demo: fatal: unable to lock supervise/lock: temporary failure
[2013-12-09 17:32:22 -0500] michael_mbp: I'm running it as sudo just to test
[2013-12-09 17:34:15 -0500] tabbed_: so why would a recipe not use the default folder under template?
[2013-12-09 17:35:25 -0500] robwatkin: cookbook 'rvm', :git => "https://github.com/fnichol/chef-rvm", :ref => "master"
[2013-12-09 17:35:30 -0500] robwatkin: but still
[2013-12-09 17:35:39 -0500] robwatkin: Installing rvm (0.0.4) from site: 'http://cookbooks.opscode.com/api/v1/cookbooks'
[2013-12-09 17:36:26 -0500] stormerider: robwatkin: because you commented out that line?
[2013-12-09 17:37:04 -0500] stormerider: back at 0930 you showed it with a # before cookbook
[2013-12-09 17:38:36 -0500] robwatkin: stormerider: :-) # just got accidentally pasted
[2013-12-09 17:38:40 -0500] robwatkin: #cookbook 'rvm', github: 'fnichol/chef-rvm'
[2013-12-09 17:38:40 -0500] robwatkin: cookbook 'rvm', :git => "https://github.com/fnichol/chef-rvm", :ref => "master"
[2013-12-09 17:38:41 -0500] robwatkin: # Uncomment to download a specific version of the nginx cookbook from
[2013-12-09 17:38:42 -0500] michael_mbp: hmm
[2013-12-09 17:38:45 -0500] michael_mbp: workmad3: you about mate?
[2013-12-09 17:38:54 -0500] workmad3: sort of...
[2013-12-09 17:38:58 -0500] michael_mbp: ah
[2013-12-09 17:39:05 -0500] michael_mbp: so if I start unicorn by hand it works!
[2013-12-09 17:39:10 -0500] michael_mbp: I can see the app
[2013-12-09 17:39:15 -0500] michael_mbp: BUT I'm getting
[2013-12-09 17:39:24 -0500] michael_mbp: runsv demo: fatal: unable to lock supervise/lock: temporary failure
[2013-12-09 17:39:39 -0500] workmad3: that's a runit error
[2013-12-09 17:39:51 -0500] michael_mbp: yup
[2013-12-09 17:39:52 -0500] michael_mbp: but
[2013-12-09 17:39:59 -0500] michael_mbp: run: /etc/service/runsvdir-deployer: (pid 21154) 2164s; run: log: (pid 13103) 4239s
[2013-12-09 17:40:14 -0500] michael_mbp: 2013-12-09_17:08:11.50433 /usr/bin/env: ruby: No such file or directory
[2013-12-09 17:40:18 -0500] michael_mbp: ^^ that is repeated in the log
[2013-12-09 17:40:33 -0500] workmad3: oh, have you set up your ruby environment with the chpst setup?
[2013-12-09 17:41:52 -0500] michael_mbp: ?
[2013-12-09 17:42:02 -0500] michael_mbp: nope... doh
[2013-12-09 17:42:11 -0500] workmad3: that'll be the issue then ;)
[2013-12-09 17:43:29 -0500] workmad3: michael_mbp: https://gist.github.com/7876582 is my unicorn sv template
[2013-12-09 17:43:57 -0500] workmad3: it still has some hard-coded bits (like the /etc/sv/name/env directory) that I want to get rid of
[2013-12-09 17:46:00 -0500] michael_mbp: workmad3: this is mine https://gist.github.com/bsodmike/4a235dbfe570ee1f85c9
[2013-12-09 17:46:09 -0500] michael_mbp: I'm not sure how yours is setting anything about ruby though
[2013-12-09 17:46:40 -0500] michael_mbp: export PATH="/usr/local/rbenv/shims:/usr/local/rbenv/bin:$PATH" isn't really true on my image though.
[2013-12-09 17:46:46 -0500] hahaha: ERROR: Your private key could not be loaded from /etc/chef/client.pem
[2013-12-09 17:46:54 -0500] hahaha: how could I generate this file?
[2013-12-09 17:47:00 -0500] hahaha: or avoid it)
[2013-12-09 17:47:07 -0500] workmad3: michael_mbp: oh, sorry... that's handled with the -e parameter to chpst
[2013-12-09 17:47:36 -0500] workmad3: michael_mbp: the directory /etc/sv/service_name/env contains files like GEM_HOME that contain the value for that envvar
[2013-12-09 17:47:56 -0500] michael_mbp: can I have a peek at env?
[2013-12-09 17:47:58 -0500] workmad3: michael_mbp: the runit_service resource from the runit cookbook can create that for you
[2013-12-09 17:48:12 -0500] michael_mbp: ah.
[2013-12-09 17:48:15 -0500] workmad3: michael_mbp: I just passed a hash to that resource :)
[2013-12-09 17:48:25 -0500] michael_mbp: gotcha
[2013-12-09 17:48:30 -0500] TabJunky: so like, why would a recipe not load a template from default
[2013-12-09 17:48:37 -0500] TabJunky: metadata issues?
[2013-12-09 17:48:43 -0500] workmad3: I'm not sure why you're messing around with functions to check if unicorn is alive btw
[2013-12-09 17:49:01 -0500] michael_mbp: workmad3: can you see https://gist.github.com/bsodmike/4a235dbfe570ee1f85c9
[2013-12-09 17:49:06 -0500] michael_mbp: I added my block
[2013-12-09 17:49:39 -0500] workmad3: ok...
[2013-12-09 17:49:40 -0500] michael_mbp: workmad3: I found this http://matteodepalo.github.io/blog/2013/04/08/minimum-viable-stack/
[2013-12-09 17:50:49 -0500] workmad3: yeah, I still need to set up logging in my stuff :)
[2013-12-09 17:50:58 -0500] workmad3: but that doesn't explain the complexity of your unicorn runit script...
[2013-12-09 17:51:16 -0500] michael_mbp: the script isn't the problem though
[2013-12-09 17:51:23 -0500] michael_mbp: it's dying at the chpst command
[2013-12-09 17:51:35 -0500] michael_mbp: yeah I like yours which is much simpler lol
[2013-12-09 17:51:38 -0500] workmad3: yeah, the problem's gonna be the lack of any ruby environment ;)
[2013-12-09 17:51:53 -0500] workmad3: it looks like you're trying to daemonize your unicorn inside your sv- script?
[2013-12-09 17:52:04 -0500] michael_mbp: it's doing that yeah
[2013-12-09 17:52:09 -0500] michael_mbp: and storing the PID
[2013-12-09 17:52:11 -0500] workmad3: yeah... you don't do that with runit :P
[2013-12-09 17:52:22 -0500] michael_mbp: wow... strange article!
[2013-12-09 17:52:35 -0500] michael_mbp: ok wait I'll switch to yours
[2013-12-09 17:52:45 -0500] michael_mbp: which option are you using in runit_service to pass -e ?
[2013-12-09 17:52:54 -0500] michael_mbp: or what's in your hash?
[2013-12-09 17:53:06 -0500] workmad3: env
[2013-12-09 17:53:09 -0500] michael_mbp: * 2.0.0-p353 (set by /opt/rbenv/version)
[2013-12-09 17:53:13 -0500] michael_mbp: that's all on the system
[2013-12-09 17:53:37 -0500] michael_mbp: I mean what's in env?
[2013-12-09 17:53:52 -0500] michael_mbp: are you passing rbenv ruby path?
[2013-12-09 17:54:10 -0500] workmad3: oh... PATH, RAILS_ENV, GEM_PATH, GEM_HOME, RUBY_VERSION, etc...
[2013-12-09 17:54:27 -0500] workmad3: all of mine are grabbed from my own ruby resource though
[2013-12-09 17:54:34 -0500] michael_mbp: ah right
[2013-12-09 17:54:49 -0500] michael_mbp: so GEM_HOME is what I want I guess
[2013-12-09 17:54:55 -0500] workmad3: PATH too
[2013-12-09 17:55:03 -0500] michael_mbp: env vars yeah?
[2013-12-09 17:55:08 -0500] workmad3: you need to make sure that ruby is on the PATH for your process ;)
[2013-12-09 17:55:30 -0500] michael_mbp: hmm
[2013-12-09 17:55:37 -0500] michael_mbp: right.
[2013-12-09 17:55:46 -0500] workmad3: runit_resource("foo") do; env "PATH" => "foo:bar:buzz", "GEM_HOME" => "whatever"; end
[2013-12-09 17:56:17 -0500] workmad3: that'll create the stuff in /etc/sv/foo/env
[2013-12-09 17:56:26 -0500] workmad3: and then you pass that directory in with -e to chpst
[2013-12-09 17:56:34 -0500] michael_mbp: gotcha
[2013-12-09 17:56:42 -0500] michael_mbp: ha " A hash of environment variables with their values as content used in the service's env directory. Default is an empty hash."
[2013-12-09 17:56:45 -0500] michael_mbp: right
[2013-12-09 17:58:48 -0500] michael_mbp: /opt/rbenv/shims/ruby
[2013-12-09 17:58:51 -0500] michael_mbp: that's my ruby
[2013-12-09 18:00:42 -0500] workmad3: oh yeah... rbenv... bleh
[2013-12-09 18:01:35 -0500] michael_mbp: you're on rvm?
[2013-12-09 18:01:51 -0500] workmad3: nope
[2013-12-09 18:02:02 -0500] michael_mbp: I can try "GEM_HOME" => "/opt/rbenv/shims/ruby"
[2013-12-09 18:02:08 -0500] michael_mbp: hmm.
[2013-12-09 18:02:16 -0500] workmad3: on my dev machine, I'm using chruby... with my chef stuff, I'm not using any ruby manager now... just ruby-install to compile
[2013-12-09 18:02:20 -0500] michael_mbp: oh I'll make that shims
[2013-12-09 18:02:26 -0500] michael_mbp: ah
[2013-12-09 18:02:29 -0500] workmad3: that's not gonna be right
[2013-12-09 18:03:30 -0500] workmad3: add that shims directory to your PATH though
[2013-12-09 18:03:45 -0500] workmad3: as long as it has a shim for ruby and for bundler, that should, I believe, be ok
[2013-12-09 18:04:43 -0500] workmad3: iirc, the shim script handles setting all the envvars for ruby for a specific version
[2013-12-09 18:05:05 -0500] jidar: anybody editing the /etc/sysconfig/network file and replacing the hostname entry with a bootstrap?
[2013-12-09 18:05:15 -0500] jidar: PTR records are already in place
[2013-12-09 18:06:22 -0500] michael_mbp: workmad3: ok
[2013-12-09 18:06:35 -0500] michael_mbp: I'll simply pass PATH
[2013-12-09 18:10:58 -0500] GreatSUN: hi all
[2013-12-09 18:11:38 -0500] michael_mbp: thanks workmad3 this might work...
[2013-12-09 18:11:52 -0500] GreatSUN: I got a problem with librarian/chefserver
[2013-12-09 18:12:06 -0500] GreatSUN: ok, not I myself
[2013-12-09 18:12:15 -0500] GreatSUN: but a colleague of mine
[2013-12-09 18:12:36 -0500] GreatSUN: he is trying to update to new version of a cookbook, but always gets old version
[2013-12-09 18:12:44 -0500] GreatSUN: somehow the sync is not working properly
[2013-12-09 18:12:51 -0500] GreatSUN: any idea how to fix that?
[2013-12-09 18:14:03 -0500] teukka: GreatSUN: `librarian-chef install` pulls the version which is specified in Cheffile.lock. `librarian-chef update` should update it
[2013-12-09 18:14:23 -0500] GreatSUN: there is no cheffile.lock
[2013-12-09 18:14:48 -0500] teukka: well, there should be after the first run =)
[2013-12-09 18:15:22 -0500] teukka: but with this information it is hard to guess what is the problem
[2013-12-09 18:15:39 -0500] michael_mbp: workmad3: /etc/sv/runsvdir-deployer/env: No such file or directory
[2013-12-09 18:15:44 -0500] GreatSUN: mhm
[2013-12-09 18:15:48 -0500] michael_mbp: I'm not seeing a file there though
[2013-12-09 18:15:50 -0500] GreatSUN: thats the same for me
[2013-12-09 18:15:57 -0500] michael_mbp: or in /home/deployer/service or sv.
[2013-12-09 18:16:07 -0500] teukka: GreatSUN: i.e what does the Cheffile look like. what is the output of `install, etc.
[2013-12-09 18:16:09 -0500] michael_mbp: (But those symlink back to the /etc/sv iirc
[2013-12-09 18:16:19 -0500] workmad3: michael_mbp: you passed a hash to the 'env' attribute in runit_service?
[2013-12-09 18:16:29 -0500] michael_mbp: yes
[2013-12-09 18:17:10 -0500] teukka: GreatSUN: you can also try to run librarian with `--verbose` to get more idea what it is doing
[2013-12-09 18:17:21 -0500] michael_mbp: workmad3: https://gist.github.com/bsodmike/4a235dbfe570ee1f85c9
[2013-12-09 18:17:31 -0500] michael_mbp: I've changed the run file (not updated yet
[2013-12-09 18:18:39 -0500] workmad3: michael_mbp: ok... so you've passed an env hash to runit_service "#{app_name}", not to runit_service "runsvdir-#{node[:user][:name]}"
[2013-12-09 18:19:21 -0500] michael_mbp: the other one is the long script
[2013-12-09 18:19:41 -0500] michael_mbp: ohhh doh SORRY!
[2013-12-09 18:20:03 -0500] michael_mbp: silly me!
[2013-12-09 18:20:21 -0500] michael_mbp: I'm gonna clean this up again for sure...
[2013-12-09 18:20:30 -0500] workmad3: heh :)
[2013-12-09 18:22:32 -0500] michael_mbp: hmm still runsv demo: fatal: unable to lock supervise/lock: temporary failure
[2013-12-09 18:22:40 -0500] michael_mbp: ok I'm going to ditch the silly script
[2013-12-09 18:22:43 -0500] michael_mbp: and go with your approach
[2013-12-09 18:23:27 -0500] michael_mbp: workmad3: user:unicorn so you're specifying the group as well?
[2013-12-09 18:24:20 -0500] workmad3: michael_mbp: yeah, I created a unicorn group that's got permission to write to /var/run/unicorn for its pids, etc :)
[2013-12-09 18:24:40 -0500] workmad3: michael_mbp: you don't need to bother with that though
[2013-12-09 18:25:02 -0500] michael_mbp: ah env/ has a file for each variable I passed
[2013-12-09 18:25:05 -0500] michael_mbp: so there's a PATH file now
[2013-12-09 18:25:10 -0500] workmad3: there we go :)
[2013-12-09 18:25:26 -0500] michael_mbp: ah the reason this script is more complicated is cause this setup would spawn another script for each new app that's deployed
[2013-12-09 18:26:40 -0500] geggam: anyone know of a nagios recipe / cookbook that sets up ncsa and not nrpe ?
[2013-12-09 18:26:42 -0500] michael_mbp: well 38 /usr/bin/env: ruby: No such file or directory that error has gone?
[2013-12-09 18:27:22 -0500] workmad3: michael_mbp: surely you want a separate runit service for each app you deploy? :P
[2013-12-09 18:27:30 -0500] michael_mbp: indeed
[2013-12-09 18:27:35 -0500] michael_mbp: does yours do that?
[2013-12-09 18:27:59 -0500] workmad3: michael_mbp: my rails_app resource creates a runit service for itself, yes
[2013-12-09 18:28:10 -0500] michael_mbp: for each app?
[2013-12-09 18:28:16 -0500] workmad3: yes
[2013-12-09 18:28:51 -0500] workmad3: no need to complicate the runit script for that purpose though... that's part of your chef deployment
[2013-12-09 18:28:54 -0500] michael_mbp: hmm so the runsvdir simply says, run all of these..
[2013-12-09 18:29:04 -0500] michael_mbp: hmm true
[2013-12-09 18:30:19 -0500] michael_mbp: so service_name in your runit script makes it app-uniqe?
[2013-12-09 18:30:41 -0500] michael_mbp: or what you pass runit_service?
[2013-12-09 18:31:52 -0500] workmad3: pretty much, yeah
[2013-12-09 18:32:08 -0500] workmad3: each separate runit_service resource creates a new entry under /etc/sv
[2013-12-09 18:33:55 -0500] michael_mbp: right but the template can be the same name
[2013-12-09 18:34:05 -0500] michael_mbp: obviously...
[2013-12-09 18:34:20 -0500] michael_mbp: besides, it's specified on each app cookbook
[2013-12-09 18:34:25 -0500] michael_mbp: (in my case).
[2013-12-09 18:36:10 -0500] michael_mbp: gonna try exec chpst -e /etc/sv/runsvdir-deployer/env -u <%= @options[:app_user] %> bundle exec -E <%= @options[:environment] %> -c <%= @options[:config] %>
[2013-12-09 18:40:04 -0500] michael_mbp: what did you do for passing bundle workmad3 ?
[2013-12-09 18:40:07 -0500] michael_mbp: binstubs?
[2013-12-09 18:41:23 -0500] michael_mbp: ha Sorry, Bundler can only be run via Rubygems.
[2013-12-09 18:44:28 -0500] michael_mbp: workmad3: much better!
[2013-12-09 18:44:35 -0500] michael_mbp: /opt/apps/demo/deploy/releases/9e269b35504cacca5d4b74b101ba4e176b70f3a1/vendor/bundle/ruby/2.0.0/gems/unicorn-4.7.0/lib/unicorn/http_server.rb:760:in `initialize': Permission denied - /opt/apps/demo/deploy/shared/log/unicorn.log (Errno::EACCES)
[2013-12-09 18:48:42 -0500] GreatSUN: ok, guys are going to work on this together tomorrow
[2013-12-09 18:48:55 -0500] GreatSUN: I wish all of you a good day/night
[2013-12-09 18:49:00 -0500] GreatSUN: <-- finished for today
[2013-12-09 18:51:15 -0500] michael_mbp: cheers
[2013-12-09 18:58:22 -0500] michael_mbp: huh
[2013-12-09 18:58:31 -0500] michael_mbp: 644 on shared/log I get not writable as an error
[2013-12-09 18:58:32 -0500] michael_mbp: but 666 is fine
[2013-12-09 18:58:51 -0500] michael_mbp: so.. it's working on the group level rather than user level.
[2013-12-09 19:01:21 -0500] michael_mbp: oh crap
[2013-12-09 19:01:21 -0500] michael_mbp: it's working on the 'other' perm.
[2013-12-09 19:28:02 -0500] devinacosta: is there a way in Chef to do like a recursive push of all files in your cookbook to a directoy on the node?
[2013-12-09 19:28:27 -0500] Idealien: Hello. I'm trying to work through using vagrant + chef to build a local VM dev environment. All the ones I try tend to encounter the same issue in different flavours of getting multiple hosts to be setup in simple fashion - either through vagrantfile or in the case of https://github.com/r8/vagrant-lamp which seems solid using a chef data_bag recipe.
[2013-12-09 19:30:39 -0500] Idealien: Wondering if someone could help troubleshoot? The vagrant up command works and provision gives following when starting - https://gist.github.com/Idealien/0c09b38c1b5984fa69d6
[2013-12-09 19:34:58 -0500] thehar: congrats on rebrand, gents
[2013-12-09 19:35:05 -0500] thehar: and ladies
[2013-12-09 19:35:41 -0500] Idealien: Currently have vagrant 1.3.5 on Win7 with Virtualbox 4.2
[2013-12-09 19:36:06 -0500] Idealien: And it seems Chef 10.14.2 from the log of the vagrantfile
[2013-12-09 19:38:04 -0500] gregkare: Idealien: What's in your data_bags folder?
[2013-12-09 19:39:08 -0500] Idealien: Subfolder sites with two files local.json that came from the repo and another that mirrors it as second example site.
[2013-12-09 19:39:40 -0500] Idealien: https://github.com/r8/vagrant-lamp/blob/master/data_bags/sites/local.json
[2013-12-09 19:42:55 -0500] eherot: thinking that topic should probably say http://www.getchef.com
[2013-12-09 19:51:10 -0500] Idealien: If I update the data_bag .json file - what vagrant commands would I have to run to ensure they are picked up. provision? up --provision? halt and up?
[2013-12-09 20:00:22 -0500] ranjib: with the getchef move, wont it be difficult to google about chef?
[2013-12-09 20:04:36 -0500] jchauncey: ranjib: probably
[2013-12-09 20:07:11 -0500] gregkare: Good point, we'll probably have to still search for "opscode chef" forever to avoid cooking results...
[2013-12-09 20:07:42 -0500] supercom32: Hey Everyone. I noted that when I run several chef recipes in sequence, I'll sometimes get this error on creation of a file or directory: "Net::HTTPServerException: 403 "Forbidden". It doesn't happen when I run the recipes by themselves, but in a large run_list, usually items at the end of the list seem to generate this error randomly. Any ideas?
[2013-12-09 20:08:38 -0500] supercom32: Maybe the server thinks, because so much is being executed and requested that it's a DoS or something and connections are being rejected?
[2013-12-09 20:08:52 -0500] supercom32: It's a far feched idea, but I'm running out of leads.
[2013-12-09 20:13:20 -0500] chris613: supercom32: I had a problem like that the other week. It turned out that the node name was changing part way through the run due to the actions of one of the cookbooks, then it was failing REST calls to the server
[2013-12-09 20:13:44 -0500] chris613: supercom32: Once I fixed that the problem came back again, this time it turned out to be related to NTP skewing the clock mid-run - again borking the REST calls
[2013-12-09 20:14:23 -0500] supercom32: chris613: How was one of your recipes changing the node name? I'm unfamiliar with how that could happen.
[2013-12-09 20:15:13 -0500] chris613: supercom32: The chef-client recipe was doing it due to a subtlety involving hosts files and fqdn resolution
[2013-12-09 20:15:24 -0500] chris613: Most cookbooks should not be changing the node name in flight
[2013-12-09 20:16:46 -0500] jidar: that's something that is killing me
[2013-12-09 20:16:50 -0500] supercom32: chris613: Ok, I would assume since I don't understand much about what you mentioned, my recipes are not doing any of that ^_^;
[2013-12-09 20:16:53 -0500] jidar: I have to fix the hostname on all of my installs
[2013-12-09 20:17:11 -0500] jidar: I want to use the bootstrap fqdn I pass in via my knife bootstrap
[2013-12-09 20:17:13 -0500] supercom32: chris613: All my node names are fully qualified. Ie. Computer name + Domain
[2013-12-09 20:20:21 -0500] chris613: supercom32: YEah, it's unlikely that you're doing that if you don't know about it. But those are the two reasons I've seen those 403's - node name changing or clock changing
[2013-12-09 20:20:34 -0500] supercom32: chris613: Ok, so assume I have a problem with issue #1, what changes exactly did you make to your scripts to avoid it? How about clock changes?
[2013-12-09 20:21:00 -0500] supercom32: chris613: I have no idea how clock changes would effect things ether, but these are running from virtual machines which may not be synchronized in clock time.
[2013-12-09 20:23:22 -0500] justizin: what happens in JSON when an attribute is defaulted to nil in ruby?
[2013-12-09 20:23:53 -0500] justizin: trying to determine how to represent pg_hba entries in json based on the ruby instructions at https://github.com/hw-cookbooks/postgresql
[2013-12-09 20:31:58 -0500] sethvargo: @jchauncey null
[2013-12-09 20:33:32 -0500] rocket: Does anyone have a dockerfile for running chefserver inside docker?
[2013-12-09 20:33:52 -0500] jchauncey: sethvargo: you dont think so? i mean i almost always have to preface a search with opscode to get the right results
[2013-12-09 20:34:30 -0500] sethvargo: @jchauncey sorry. I tagged the wrong person. I meant to tag @justizin
[2013-12-09 20:34:36 -0500] jchauncey: ah =P
[2013-12-09 20:34:53 -0500] jchauncey: been one of those days =)
[2013-12-09 20:39:25 -0500] michael_mbp: hmm
[2013-12-09 20:40:14 -0500] kallistec: supercom32: looks like https://tickets.opscode.com/browse/CHEF-3045
[2013-12-09 20:41:49 -0500] btm: No @opscode @getchefdotcom #opschef code reviews today, check out today's announcements instead: http://www.getchef.com/blog/
[2013-12-09 20:45:57 -0500] michael_mbp: damn 2am...
[2013-12-09 20:46:07 -0500] michael_mbp: thanks again workmad3 I've got it working nicely for now
[2013-12-09 20:55:11 -0500] spiffytech: Is there a ballpark ETA for the next bugfix release of Chef? Commit ad5bbfea to opscode/chef/master fixes a problem I have. Alternatively, are the directions for building a new .deb from a github checkout?
[2013-12-09 20:56:08 -0500] supercom32: kallistec: ineed! Looks like that ticket!
[2013-12-09 20:57:50 -0500] kallistec: supercom32: there was a mistake with a merge conflict that removed it, but the no_lazy_load patch is in the latest 10.x and 11.x so you can try that
[2013-12-09 20:59:07 -0500] jblancett: supercom32: checkout the chef repo, cd to it, and run `gem build chef.gemspec`
[2013-12-09 20:59:28 -0500] jblancett: supercom32: it will produce a .gem file, then you can `gem install [filename]`
[2013-12-09 21:00:39 -0500] jblancett: supercom32: I'm not sure how to make .deb packages out of a gem but you shouldn't really need to
[2013-12-09 21:05:33 -0500] aspiers: how can I find out why chef-client is running a particular cookbook? it's running one which does not appear anywhere in the node's run-list so I'm totally baffled
[2013-12-09 21:05:45 -0500] aspiers: chef-client -l DEBUG doesn't give anything useful
[2013-12-09 21:06:07 -0500] aspiers: except the INFO: Loading cookbooks [...] line doesn't bear any resemblance to the run_list
[2013-12-09 21:12:55 -0500] geggam: congrats on the 32 mil
[2013-12-09 21:14:01 -0500] geggam: someone beat the suits who changed the name to getchef tho...
[2013-12-09 21:14:17 -0500] c_t: they just want to make it harder to google is all
[2013-12-09 21:14:36 -0500] kallistec: jblancett && supercom32 -- sorry I was a bit unclear. What I meant is that the feature is in the latest 10.x and 11.x release versions. Way in the past the patch got merged and then the merge got stomped in a bad rebase, then we re-merged and have released since then so you don't need to build from master
[2013-12-09 21:14:54 -0500] geggam: we should change all recipes to ch3f :)
[2013-12-09 21:15:25 -0500] geggam: or cerkberks
[2013-12-09 21:15:34 -0500] spiffytech: aspiers: You could run "grep -rP 'include_recipe.*recipe_name' cookbooks/" and backtrack where the include is coming from.
[2013-12-09 21:15:52 -0500] c_t: i lurve cerkberks
[2013-12-09 21:16:07 -0500] aspiers: spiffytech: in which directory? the client cache, or the server?
[2013-12-09 21:16:19 -0500] geggam: try reseraching apache indian heritage on the interwebs sometime
[2013-12-09 21:17:41 -0500] spiffytech: aspiers: Either should work, since they should be in sync if the client's done a recent pull. But might as well pick the safe bet and look in the client cache.
[2013-12-09 21:18:04 -0500] aspiers: spiffytech: ok yeah, that makes sense
[2013-12-09 21:18:32 -0500] aspiers: spiffytech: when the client says "INFO: Loading cookbooks [...]", should I expect to see only the cookbooks it needs, or all the ones from the server?
[2013-12-09 21:20:10 -0500] aspiers: spiffytech: ah, just traced it to #sync_cookbooks in chef/client.rb
[2013-12-09 21:21:35 -0500] aspiers: (this is with 10.24.4 BTW)
[2013-12-09 21:21:40 -0500] spiffytech: aspiers: OK, cool. I'm guessing the INFO statement should show all cookbooks on the server.
[2013-12-09 21:22:02 -0500] aspiers: cookbook_hash = rest.post_rest("environments/#{@node.chef_environment}/cookbook_versions", {:run_list => @expanded_run_list_with_versions})
[2013-12-09 21:22:39 -0500] aspiers: http://docs.opscode.com/api_chef_server.html#environments-n-cookbook-versions
[2013-12-09 21:27:39 -0500] Blizzik: Hi, Iam having problem setting up nginx. http://hastebin.com/sujepeyife.coffee could someone check the repice and say me what's wrong in there/
[2013-12-09 21:29:24 -0500] rracterr: Question: if I have chef-client daemonized (service) under windows, how do I trigger a run like I would if it was not daemonized?
[2013-12-09 21:30:55 -0500] rracterr: under unix it would be sighup I imagine, but on windows I'm unclear.   does it do a run the instance its restarted? can I just restart the service and acheive what I want?
[2013-12-09 21:33:58 -0500] aspiers: bizarre, @expanded_run_list_with_versions is correct but something goes wrong later on
[2013-12-09 21:37:02 -0500] rracterr: opscode guys?  anything?
[2013-12-09 21:37:28 -0500] holoway: rracterr: sorry, we're all in a company meeting :)
[2013-12-09 21:38:01 -0500] holoway: @btm can probably dig up an answer for you, when he gets back
[2013-12-09 21:38:36 -0500] heathsnow: Does anyone have an elegant solution to running the template resouce wrapped in a .each but only running a notification once (rather than for every template, run once after all templates are finished writing)?
[2013-12-09 21:45:53 -0500] ranjib: heathsnow, if it notifies only one.. which resource should it belong to?
[2013-12-09 21:46:44 -0500] cwj: heathsnow: isnt that the use-case for delayed notification timing?
[2013-12-09 21:47:24 -0500] cwj: notifies :action, resource[foo], :delayed
[2013-12-09 21:47:28 -0500] heathsnow: cwj: yeah, i'm looking into that now
[2013-12-09 21:56:06 -0500] heathsnow: delayed was the answer :)
[2013-12-09 21:57:37 -0500] kallistec: rracterr: on UNIX, it's SIGUSR1, or just launch another instance of chef-client, there is a lock to prevent 2 from configuring the system at the same time
[2013-12-09 21:58:34 -0500] kallistec: rracterr: I know that we did some work to make windows use a windows mutex for the lock so you can launch a second chef-client without it stomping on the first
[2013-12-09 21:59:00 -0500] kallistec: rracterr: but that was pretty recent so I'll have to see what version it's released in (if released yet)
[2013-12-09 22:00:01 -0500] kallistec: rracterr: looks like it's in 11.8.0
[2013-12-09 22:00:20 -0500] ranjib: heathsnow, delayed will run even if the chef run fail
[2013-12-09 22:16:35 -0500] wdpro_kevin: ohai
[2013-12-09 22:16:59 -0500] wdpro_kevin: anyone know the knife-plugin that compares local repo with chef server repo?
[2013-12-09 22:17:15 -0500] gregkare: wdpro_kevin: knife-inspect
[2013-12-09 22:17:51 -0500] gregkare: The last release of the gem doesn't support Chef 11, you might want to use the latest revision from master instead
[2013-12-09 22:18:09 -0500] gregkare: I asked the maintainer to take over the gem but I'm still waiting for a reply
[2013-12-09 22:18:33 -0500] wdpro_kevin: awesome I'm still rocking chef10 anyway
[2013-12-09 22:19:31 -0500] gregkare: I'll gladly help you if you have an issue with it
[2013-12-09 22:20:52 -0500] wdpro_kevin: I think the only help I will need is getting everything synced up what a cluster f I have
[2013-12-09 22:22:19 -0500] gregkare: By the way, one of the features I added it proper exit status, it's really useful. We use Travis CI to run it after every push, the build fails if knife-inspect doesn't return 0
[2013-12-09 22:22:29 -0500] gregkare: s/it/is/
[2013-12-09 22:22:35 -0500] gregkare: It's not in 0.6.2 though
[2013-12-09 22:23:20 -0500] wdpro_kevin: that is a great feature/workflow
[2013-12-09 22:23:57 -0500] gregkare: It's funny, I was writing a blog article about this when I realized I hadn't tested a failed build
[2013-12-09 22:24:11 -0500] gregkare: So of course I fixed it and didn't finish writing the article
[2013-12-09 22:27:33 -0500] josephholsten: when did setting node attributes stop auto creating things?
[2013-12-09 22:27:33 -0500] josephholsten: https://gist.github.com/josephholsten/7882125
[2013-12-09 22:28:03 -0500] josephholsten: that totally should not be a nil
[2013-12-09 22:29:48 -0500] josephholsten: which is to say, node.default['foo']['bar']['baz']['quux'] = 'snorf' aught to work, right?
[2013-12-09 22:33:04 -0500] josephholsten: is there some magical place where attribute autovivication doesn't happen?
[2013-12-09 22:34:36 -0500] gregkare: Did you switch from Chef 10 to 11? A lot of things about attributes have changed
[2013-12-09 22:37:19 -0500] josephholsten: I'm in 11 now
[2013-12-09 22:37:51 -0500] josephholsten: I mostly haven't had to worry about the attr changes
[2013-12-09 22:38:39 -0500] gregkare: I don't think you could write to this attribute even if it did exist, node.default would return an immutable structure in Chef 11 as far as I remember
[2013-12-09 22:38:43 -0500] josephholsten: `default['jenkins']['node']['env'] = {}; default['jenkins']['node']['env']['LANG'] = 'en_US.UTF-8'` works fine
[2013-12-09 22:38:57 -0500] josephholsten: but I really don't understand why I need that first line
[2013-12-09 22:39:24 -0500] gregkare: Interesting, so I'm even more confused about attributes than I thought
[2013-12-09 22:39:38 -0500] workmad3: josephholsten: is node['jenkins']['node']['env'] explicitly set to nil in the default attributes file?
[2013-12-09 22:39:54 -0500] josephholsten: hmm, that's a thought
[2013-12-09 22:40:19 -0500] josephholsten: THE JERK FACES https://github.com/opscode-cookbooks/jenkins/blob/master/attributes/node.rb#L54
[2013-12-09 22:40:35 -0500] workmad3: there ya go, mystery solved ;)
[2013-12-09 22:40:49 -0500] josephholsten: @schisamo it's all your fault!
[2013-12-09 22:40:52 -0500] josephholsten: ;-)
[2013-12-09 22:41:10 -0500] gregkare: env would make more sense as an empty hash, agreed
[2013-12-09 22:41:52 -0500] josephholsten: oh, it's just almost never the right thing to set an attribute to nil
[2013-12-09 22:42:03 -0500] josephholsten: just leave it undefined
[2013-12-09 22:42:14 -0500] gregkare: Especially when its type is checked on the way: https://github.com/opscode-cookbooks/jenkins/blob/65cefad7259fe6dd75bd89643a2ebf6211b56cc3/libraries/manage_node.rb#L32
[2013-12-09 22:42:52 -0500] josephholsten: wow, this goes back forever: https://github.com/opscode-cookbooks/jenkins/commit/c7e1785a2e99108e258e916c18ab73ddff3b153e
[2013-12-09 22:42:54 -0500] gregkare: Turn something into a hash if it's not nil, else watch everything explode
[2013-12-09 22:43:03 -0500] josephholsten: https://github.com/opscode-cookbooks/jenkins/commit/c7e1785a2e99108e258e916c18ab73ddff3b153e#diff-25e5d4a4446ae12a0d6f1162b6160375R102
[2013-12-09 22:43:13 -0500] workmad3: not all opscode cookbooks are great examples
[2013-12-09 22:43:37 -0500] josephholsten: I'd go spelunking into the the hudson cookbook, but I'm happy to know this is 3 years old
[2013-12-09 22:43:54 -0500] josephholsten: workmad3: that's why I'm so very comfortable submitting patches for them
[2013-12-09 22:44:20 -0500] josephholsten: but I'll run away if you try to give me a commit bit. keep it away btm.
[2013-12-09 22:44:29 -0500] workmad3: :)
[2013-12-09 22:44:30 -0500] gregkare: haha
[2013-12-09 22:44:58 -0500] workmad3: afraid you'll force-push month-old changes to all the opscode cookbook repos?
[2013-12-09 22:46:39 -0500] workmad3: like happened with jenkins
[2013-12-09 22:46:40 -0500] workmad3: https://groups.google.com/d/msg/jenkinsci-dev/-myjRIPcVwU/t4nkXONp8qgJ
[2013-12-09 22:48:18 -0500] gregkare: Hhahah shit
[2013-12-09 22:49:12 -0500] gregkare: How can you even do a force push by accident?
[2013-12-09 22:49:25 -0500] workmad3: I have no idea
[2013-12-09 22:49:34 -0500] workmad3: I'm guessing a rogue script or something
[2013-12-09 22:49:34 -0500] gregkare: especially on that many repositories, this is madness
[2013-12-09 22:50:09 -0500] gregkare: Yeah I guess it's a new variant of rm -rf / home/OHSHIT WHAT I HAVE DONE
[2013-12-09 22:50:38 -0500] workmad3: gregkare: I have zsh syntax highlighting put the entire line into red background the moment I write 'rm -rf' :)
[2013-12-09 22:51:10 -0500] workmad3: so that when I destroy /, it'll look like a big red danger sign
[2013-12-09 22:51:24 -0500] gregkare: :)
[2013-12-09 22:51:43 -0500] workmad3: (I should probably change it so that it goes flashing red if I do rm -rf /)
[2013-12-09 22:52:47 -0500] gregkare: Some people just use aliases that set confirmation switches
[2013-12-09 22:56:05 -0500] josephholsten: I've edited ietf specs and shepherded open source projects. I've had enough cat herding for at least half a decade off.
[2013-12-09 23:13:04 -0500] coderanger: josephho_: Can I get a half a decade off too?
[2013-12-09 23:13:40 -0500] josephho_: um, you just volunteered for a decade's worth at the summit
[2013-12-09 23:14:09 -0500] nektos: any advice on the problems with using winrm to bootstrap a windows node to install sql server?
[2013-12-09 23:14:23 -0500] nektos: seems to work fine when running chef client manually, but not via winrm
[2013-12-09 23:19:14 -0500] thun_: When running chef-client run -orecipe[blah]   can I specify attributes via the command line?
[2013-12-09 23:26:05 -0500] ckwalsh: Question for you: inside of a chef recipe after installing a package, it is possible to get the version of the installed package. I don't require a specific version, but I would like to know which version is installed.
[2013-12-09 23:26:49 -0500] xrl: I'm working on some remote raspberries, we install them on the customers premise
[2013-12-09 23:26:55 -0500] xrl: I'd like to use chef to manage all those boxes
[2013-12-09 23:27:17 -0500] xrl: but how do I manage the identity of the boxes? like, how should I say "installed at such and such premise"?
[2013-12-09 23:28:06 -0500] xrl: the raspberry pis are easy enough to bring up by using "dd" to burn new SD cards
[2013-12-09 23:28:30 -0500] xrl: and I'd like to have them bootstrapped to run chef on first boot and then periodically afterwards
[2013-12-09 23:40:21 -0500] zillabyte: Hey all... I just created a new account and it's giving me the following error: "Permission denied. You do not have permission to list the clients in this organization. (Error 22001)"
[2013-12-09 23:40:39 -0500] zillabyte: Is this a common issue?
[2013-12-09 23:44:03 -0500] michael_mbp: hmm application foo do migrate doesn't seem to be working
[2013-12-09 23:44:07 -0500] coderanger: zillabyte: You might want to contact support
[2013-12-09 23:44:12 -0500] michael_mbp: I have to go in manually and run it...?
[2013-12-09 23:44:27 -0500] zillabyte: coderanger: Cool.  Should I file a ticket, or just email?
[2013-12-09 23:44:39 -0500] zillabyte: Or are the two equivalent?
[2013-12-09 23:44:46 -0500] coderanger: zillabyte: Same thing
[2013-12-09 23:44:50 -0500] zillabyte: Great, thanks!
[2013-12-09 23:44:57 -0500] coderanger: zillabyte: It was support@opscode.com, I guess its support@getchef.com now
[2013-12-09 23:45:16 -0500] zillabyte: I imagine the redirect is still around :)
[2013-12-09 23:47:46 -0500] zillabyte: Just submitted a ticket, thanks again!
[2013-12-09 23:50:35 -0500] pabst^: service "service" do action :start end <--- does that try and start the service on EVERY chef run?
[2013-12-09 23:54:39 -0500] zillabyte: pabst^: I think it's smart enough to check whether the service is already running.
[2013-12-09 23:55:24 -0500] zillabyte: If you want state to persist across Chef runs you probably want to use normal node attributes.
[2013-12-09 23:56:16 -0500] nektos: I'm getting "access denied" errors when bootstrapping a windows node and running the sql_server recipe...but works fine when I run chef-client directly on the box....anyone have a workaround for this?
[2013-12-09 23:56:29 -0500] pabst^: hmmmm... I am hoping it is smart enough.
[2013-12-09 23:56:35 -0500] nektos: is this an issue with using winrm?
[2013-12-09 23:56:45 -0500] zillabyte: nektos: Based on my experience with Windows, it's probably that it doesn't have administrative privileges.
[2013-12-09 23:57:04 -0500] nektos: I'm running winrm as the local administrator account
[2013-12-09 23:57:11 -0500] jtimberman: coderanger: @opscode.com will work too :)
[2013-12-09 23:57:29 -0500] pabst^: I have been seeing hadoop errors related to dns, the theory has been that each time chef runs it tries to start named with the service block...
[2013-12-09 23:58:11 -0500] zillabyte: I suppose it's possible that Chef just relies on the service to know that it's already started, but if that were the case I'd expect to see a lot of failures, since any time it ran and reported a nonzero exit status it would kill the Chef run.
[2013-12-09 23:58:47 -0500] zillabyte: And yeah, I'd bet on winrm, I've had issues with UAC in the past.
[2013-12-09 23:59:36 -0500] pabst^: thanks zillabyte
[2013-12-09 23:59:45 -0500] nektos: zillabyte: we have UAC turned off, but I did come across this...http://lists.opscode.com/sympa/arc/chef/2012-05/msg00185.html
