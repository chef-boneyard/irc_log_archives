[2013-12-06 00:10:07 -0500] ponyofdeath: hi, i am unclear about chef handler's I want to send an alert through zenoss when a chef run fails on production nodes. Do i need to put the chef handler on each production node then include it from within an default policy on all the nodes?
[2013-12-06 00:13:11 -0500] TrinitronX: (Knife encrypted_data_bag_secret Deprecation Warning Message: https://gist.github.com/7816493 )
[2013-12-06 00:22:38 -0500] parshap: TrinitronX: thanks! using ruby_block always feels weird
[2013-12-06 00:23:54 -0500] trappiste: what's the best way to transfer a file from a cookbooks files/default directory, and have it removed from the node at the end of the chef run? I'm thinking it's some combination of cookbook_file and a :delayed notification but can't quite fit it together
[2013-12-06 00:24:09 -0500] webframp: ponyofdeath yes, the chef handler will need to be shipped to each node
[2013-12-06 00:25:00 -0500] ponyofdeath: web i see so i need a policy first that ships it to each node then call it early in the chef-client run
[2013-12-06 00:25:01 -0500] webframp: ponyofdeath check out the chef_handler cookbook https://github.com/opscode-cookbooks/chef_handler
[2013-12-06 00:25:23 -0500] ponyofdeath: webframp: thanks
[2013-12-06 00:25:55 -0500] webframp: we usually ship handlers as gems, then a given recipe does gem install and uses chef_handler cookbook to setup on
[2013-12-06 00:26:03 -0500] webframp: the node*
[2013-12-06 00:30:03 -0500] ponyofdeath: https://github.com/anthroprose/chef-handler-zenoss
[2013-12-06 00:30:08 -0500] ponyofdeath: is what I am trying to push
[2013-12-06 00:30:19 -0500] ponyofdeath: dont think its in gem format
[2013-12-06 00:32:04 -0500] ponyofdeath: webframp: not sure where the def initialize goes tho
[2013-12-06 00:32:44 -0500] ponyofdeath: i guess that i need to edit in the actual rb file with my zenoss info
[2013-12-06 01:26:53 -0500] webframp: ponyofdeath you shouldn't need to put the def initialize anywhere, that's just poorly documented, unless you plan to just wrap that handler in your own provider or something
[2013-12-06 01:26:56 -0500] webframp: yuck
[2013-12-06 01:27:23 -0500] webframp: ponyofdeath here's a really simple handler example: https://github.com/heavywater/chef-handler-users
[2013-12-06 01:28:05 -0500] webframp: ponyofdeath and corresponding usage in a recipe https://github.com/hw-cookbooks/chef_handler_users/blob/master/recipes/default.rb
[2013-12-06 01:29:11 -0500] webframp: you'll probably need to pass in the variables for the initialize as arguments
[2013-12-06 01:31:17 -0500] strictlyb: guys
[2013-12-06 01:31:26 -0500] strictlyb: what does it take to upgrade chef-server from 11.8.0 to 11.8.2
[2013-12-06 01:31:31 -0500] strictlyb: just install tjhe rpm?
[2013-12-06 01:31:38 -0500] strictlyb: is it a safe thing to do ? anyone advise against?
[2013-12-06 01:31:53 -0500] anoldhacker: Surely there is documentation.
[2013-12-06 01:32:07 -0500] strictlyb: looking for it
[2013-12-06 01:33:26 -0500] webframp: strictlyb chef-server or chef-client?
[2013-12-06 01:33:40 -0500] strictlyb: server
[2013-12-06 01:33:43 -0500] webframp: chef-server is 11.0.8
[2013-12-06 01:33:59 -0500] webframp: per the topic
[2013-12-06 01:34:24 -0500] strictlyb: i thought 11.8.2 was latest
[2013-12-06 01:34:50 -0500] strictlyb: https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chef-11.8.2-1.el6.x86_64.rpm
[2013-12-06 01:34:58 -0500] webframp: strictlyb yea, for chef-client you're correct
[2013-12-06 01:35:07 -0500] strictlyb: i am using
[2013-12-06 01:35:09 -0500] strictlyb: AH
[2013-12-06 01:35:09 -0500] strictlyb: i see
[2013-12-06 01:35:10 -0500] strictlyb: your right
[2013-12-06 01:35:12 -0500] strictlyb: my aplogies.
[2013-12-06 01:35:19 -0500] strictlyb: i have one other question
[2013-12-06 01:35:21 -0500] webframp: no need :)
[2013-12-06 01:35:26 -0500] strictlyb: if you dont min
[2013-12-06 01:35:27 -0500] webframp: just a different upgrade path
[2013-12-06 01:35:29 -0500] strictlyb: yes
[2013-12-06 01:35:34 -0500] strictlyb: ur right my brain fart
[2013-12-06 01:36:07 -0500] strictlyb: i am running chef-server right
[2013-12-06 01:36:10 -0500] strictlyb: that version chef-server-11.0.8-1.el6.x86_64.rpm
[2013-12-06 01:36:19 -0500] strictlyb: and i guess it has its own version of ohai
[2013-12-06 01:36:27 -0500] strictlyb: so i want to strap my chef-server node with my base role
[2013-12-06 01:36:39 -0500] strictlyb: and chef-client uses a different version of ohai
[2013-12-06 01:36:40 -0500] webframp: well, if you need to upgrade that perhaps this will help: https://github.com/hw-cookbooks/chef-server-populator
[2013-12-06 01:37:00 -0500] strictlyb: and for some reason that ver of ohain cant read certain variables,
[2013-12-06 01:37:16 -0500] strictlyb: i was wondering if you can tell it what version of ohai to use for chef-client runs
[2013-12-06 01:37:17 -0500] strictlyb: i.e
[2013-12-06 01:37:36 -0500] strictlyb: this works
[2013-12-06 01:37:51 -0500] strictlyb: "/opt/chef/bin/ohai -d /var/chef/cache/cookbooks/ohai/files/default/plugins/ datacenter my_variable"
[2013-12-06 01:37:52 -0500] strictlyb: but
[2013-12-06 01:37:57 -0500] strictlyb: "/opt/chef-server/bin/ohai -d /var/chef/cache/cookbooks/ohai/files/default/plugins/ datacenter my_variable"
[2013-12-06 01:38:00 -0500] strictlyb: doesnt
[2013-12-06 01:39:07 -0500] webframp: well, that's not something I've encountered, but I would assume chef-client uses the ohai in /opt/chef
[2013-12-06 01:39:32 -0500] webframp: sorry I can't help much more than that
[2013-12-06 01:40:28 -0500] strictlyb: yea
[2013-12-06 01:40:42 -0500] strictlyb: i tried even copying ohai-vwersions back and forth to no avail
[2013-12-06 01:40:43 -0500] strictlyb: anyway
[2013-12-06 01:40:44 -0500] strictlyb: thanks
[2013-12-06 02:11:07 -0500] juliancdunn: it probably calls whatever's in your path -- just a guess
[2013-12-06 04:06:03 -0500] devinacosta: I upgraded today to the latest Private Chef and noticed even after upgrading the client to 11.8.2 that now my client no longer logs to /var/log/chef/client.log,  was working before the upgrade.
[2013-12-06 04:17:40 -0500] judd7: the template resource, can it force the parent path to be created?  Or do I have to use a directory resource?
[2013-12-06 04:54:48 -0500] juliancdunn: judd7: use a directory resource first
[2013-12-06 05:25:54 -0500] mannyt: juliancdunn: Thanks for your help earlier.  After going through the server, it seems that someone installed chef-server to two different locations which cause all kinds of strange issues.
[2013-12-06 05:26:17 -0500] mannyt: Stood up a new server and re uploaded everything
[2013-12-06 05:27:06 -0500] mannyt: Also because its late i really want opscode and the JSON gem guys to get along
[2013-12-06 05:27:59 -0500] mannyt:  # The JSON gem reliably releases breaking changes as a patch release
[2013-12-06 05:28:00 -0500] mannyt:   s.add_dependency "json", ">= 1.4.4", "<=  1.7.7"
[2013-12-06 05:28:28 -0500] mannyt: this kind of stuff has to stop so that I can use other gems that rely on later versions of json to play nice with chef
[2013-12-06 05:30:04 -0500] juliancdunn: mannyt: I know. I'm sorry
[2013-12-06 05:30:35 -0500] mannyt: I understand it happens
[2013-12-06 05:31:13 -0500] mannyt: There is a lot of amazing stuff going on that I do love, but there are some moments lol
[2013-12-06 05:31:31 -0500] juliancdunn: trust me, I've fought a lot about the JSON gem internally
[2013-12-06 05:32:23 -0500] mannyt: I'm glad people are passionate about it there
[2013-12-06 05:33:23 -0500] jameson__: the real question is why the hell does a json gem break so often :\
[2013-12-06 05:33:46 -0500] mannyt: haha that is a valid point
[2013-12-06 05:34:47 -0500] juliancdunn: it's a full-time job keeping up with whether the JSON gem breaks shit
[2013-12-06 05:35:01 -0500] juliancdunn: I didn't realize parsing JSON was rocket science, but evidently it is
[2013-12-06 05:35:48 -0500] mannyt: I actually never really saw all the drama until I started working with chef more
[2013-12-06 05:36:25 -0500] mannyt: Started seeing a lot of discussion from the json guys
[2013-12-06 05:36:44 -0500] juliancdunn: we started switching to yajl a while ago because of the nonsense, but never finished the job
[2013-12-06 05:36:50 -0500] juliancdunn: which is why there are (sadly) *two* JSON parsers in Chef
[2013-12-06 05:36:59 -0500] mannyt: womp womp
[2013-12-06 05:37:03 -0500] juliancdunn: and now yajl-ruby is basically abandonware
[2013-12-06 05:37:45 -0500] juliancdunn: so the ideal scenario would be to have an FFI wrapper to YAJL-C, and rip out json
[2013-12-06 05:38:10 -0500] juliancdunn: unfortunately, it's a high-risk change (as you can imagine), and there are other fires to fight :-(
[2013-12-06 05:38:30 -0500] mannyt: and yet another project to maintain
[2013-12-06 05:39:22 -0500] juliancdunn: yep
[2013-12-06 05:39:38 -0500] juliancdunn: so, unfortunately the least expensive thing to do is to keep monkeying with gem pinnings when people complain
[2013-12-06 05:40:43 -0500] mannyt: Yea overall its totally understandable especially when all restful communications happen via json
[2013-12-06 05:41:11 -0500] juliancdunn: exactly
[2013-12-06 05:41:12 -0500] mannyt: so when it breaks, the consequences are terrible
[2013-12-06 05:41:26 -0500] juliancdunn: and kallistec makes a great point that YAJL makes it easier for you to find errors in your JSON
[2013-12-06 05:41:43 -0500] juliancdunn: by actually highlighting, with "^" characters, where you went wrong
[2013-12-06 05:43:06 -0500] mannyt: I'm going to have to do some more reading into YAJL but yes the more obvious you can make json errors the better life is overall
[2013-12-06 05:43:47 -0500] mannyt: JSON is readable but syntax errors happen all the time
[2013-12-06 05:44:25 -0500] mannyt: and frankly sometimes its not so readable when everything ends up on one line
[2013-12-06 05:44:46 -0500] juliancdunn: yeah, which started happening recently, and I'm not sure if that was a breaking change in the json gem as well
[2013-12-06 05:45:27 -0500] mannyt: Ah I thought that was just something that started in our office
[2013-12-06 05:45:51 -0500] mannyt: Makes me feel bette we didn't muck something up along the way
[2013-12-06 05:46:41 -0500] juliancdunn: nope -- I mean, I work at Opscode, and I still have NFI why it's happening :-(
[2013-12-06 05:48:25 -0500] mannyt: It is really amazing that json is this hard
[2013-12-06 05:49:13 -0500] jtimberman: juliancdunn: what's the underlying question?
[2013-12-06 05:49:21 -0500] jtimberman: backscroll seems tl;dr :)
[2013-12-06 05:50:21 -0500] webframp: jtimberman: Why is json so hard?
[2013-12-06 05:50:43 -0500] jtimberman: webframp: reasons
[2013-12-06 05:50:46 -0500] jtimberman: next!
[2013-12-06 05:50:54 -0500] webframp: Easy!
[2013-12-06 05:50:59 -0500] jtimberman: hehe
[2013-12-06 05:51:04 -0500] mannyt: jtimberman: problem solved, how are you so good?
[2013-12-06 05:51:06 -0500] jtimberman: yeah, so, the comment in the gemspec is why
[2013-12-06 05:51:11 -0500] jtimberman: it sucks
[2013-12-06 05:51:33 -0500] jtimberman: but we have literally had firedrill releases because json gem did a patch release which broke the way chef uses it.
[2013-12-06 05:51:49 -0500] webframp: Ug
[2013-12-06 05:52:00 -0500] jtimberman: releases are easier to handle now than the worst of them then, at least :)
[2013-12-06 05:52:01 -0500] mannyt: That's such a scary thing
[2013-12-06 05:52:08 -0500] juliancdunn: jtimberman: the "NFI why it's happening" is "why does my JSON show up in one line all of a sudden"
[2013-12-06 05:52:10 -0500] jtimberman: but it's happened earlier this year
[2013-12-06 05:52:14 -0500] juliancdunn: when it used to pretty-print
[2013-12-06 05:52:40 -0500] jtimberman: where is that
[2013-12-06 05:53:18 -0500] juliancdunn: right now, if I do "knife [role|node|environment] edit"
[2013-12-06 05:53:36 -0500] juliancdunn: started happening about 2 months ago, whole bunch of m/l chatter about it, but never got to the bottom of it
[2013-12-06 05:53:37 -0500] jtimberman: with 11.8.2?
[2013-12-06 05:53:41 -0500] jtimberman: oh huh
[2013-12-06 05:53:53 -0500] mannyt: I get the same results as juliancdunn
[2013-12-06 05:53:57 -0500] jtimberman: any particular chef server?
[2013-12-06 05:54:06 -0500] juliancdunn: jtimberman: Hosted
[2013-12-06 05:54:07 -0500] jtimberman: or particular chef version
[2013-12-06 05:54:21 -0500] juliancdunn: with 11.8.2. but I don't use Omnibus because, well, I'm a "developer"
[2013-12-06 05:54:26 -0500] juliancdunn: or I play one on TV, anyway
[2013-12-06 05:54:38 -0500] mannyt: also with 11.6.2 gem
[2013-12-06 05:55:22 -0500] juliancdunn: Omnibus is fine, actually - I just tried on a test box that has Omnibus 11.8.2
[2013-12-06 05:56:18 -0500] jtimberman: I'm not able to reproduce
[2013-12-06 05:56:56 -0500] mannyt: its happening on server version 11.0.10 installed from an RPM on centOS6.4
[2013-12-06 05:57:33 -0500] jtimberman: % chef-apply -e 'puts JSON::VERSION'
[2013-12-06 05:57:34 -0500] jtimberman: 1.7.7
[2013-12-06 05:58:16 -0500] jtimberman: chef 11.8.2, installed via rubygems
[2013-12-06 05:58:25 -0500] juliancdunn: it's the same here. must be some other gem monkeying with this
[2013-12-06 05:58:35 -0500] juliancdunn: the only JSON I have is 1.7.7
[2013-12-06 05:58:35 -0500] jtimberman: thats possible
[2013-12-06 05:59:00 -0500] jtimberman: i have activesupport 3.2.15 (well known for monkeypatching stdlib and core classes)
[2013-12-06 05:59:03 -0500] mannyt: I'm also running 1.7.7
[2013-12-06 06:00:13 -0500] jtimberman: i have yajl-ruby 1.1.0
[2013-12-06 06:00:19 -0500] jtimberman: i imagine yours is the same
[2013-12-06 06:00:35 -0500] juliancdunn: yep, I also have activesupport, 3.2.14
[2013-12-06 06:01:39 -0500] juliancdunn: anyway. enough fighting with JSON, time for sleep :-/
[2013-12-06 06:01:59 -0500] mannyt: Night guys
[2013-12-06 06:02:16 -0500] jtimberman: night!
[2013-12-06 06:15:39 -0500] shwash: g'evening, anyone about?
[2013-12-06 06:25:08 -0500] ptrstr: juliancdunn: the flat json is caused by one of the knife plugins...knife-essentials or knife-spork maybe. I don't recall
[2013-12-06 07:43:05 -0500] GreatSUN_: rehi
[2013-12-06 07:43:19 -0500] GreatSUN_: and a good morning to all of you
[2013-12-06 09:00:44 -0500] edwardc: hello, i met a problem while using knife solo init. have no clue even use -VV for verbose mode
[2013-12-06 09:00:47 -0500] edwardc: https://gist.github.com/edwardchuang/7820702
[2013-12-06 09:27:44 -0500] henk76: morning guys. Hope everyone survived the storm of last night in europe ;).
[2013-12-06 09:28:26 -0500] henk76: anyone ever figured out how to use the ubuntu encryption on a filesystem with chef while bootstrapping?
[2013-12-06 09:43:53 -0500] henk76: anyone ever figured out how to use the ubuntu encryption on a filesystem with chef while bootstrapping? i want to launch a ubuntu machine, encrypt a partition/drive and then run some things on the encrypted section and destroy the machine again
[2013-12-06 09:57:41 -0500] holms: anybody got an argument, why nobody writes uninstall recipe for their cookbooks?
[2013-12-06 09:58:11 -0500] holms: i'm actually tired to rebuild from snapshot everytime and sync ntp manually
[2013-12-06 09:59:07 -0500] kaerast: why would you have to sync ntp manually?
[2013-12-06 09:59:23 -0500] holms: cause after restoring snapshot in any hypervizor
[2013-12-06 09:59:26 -0500] holms: time is shifter
[2013-12-06 09:59:31 -0500] holms: shifted* especially in vmware
[2013-12-06 09:59:51 -0500] holms: those one who's in cloud, usually cloud-init handles this
[2013-12-06 10:00:10 -0500] holms: but it's just.. why not remove some crap, epsecially if there's like 20 cookbooks applied for one machine
[2013-12-06 10:00:21 -0500] holms: there's too much use-cases for this
[2013-12-06 10:00:45 -0500] holms: some installs stuff to /opt
[2013-12-06 10:01:02 -0500] holms: and puts lots of crap to /var .. hard to track it down sometimes
[2013-12-06 10:02:00 -0500] BNm: Hi all i installed tomcat using cookbook ran default recipe
[2013-12-06 10:02:16 -0500] BNm: it installed tomcat butnot able to access it
[2013-12-06 10:03:02 -0500] BNm: how to access tomcat in browser
[2013-12-06 10:03:22 -0500] holms: BNm: ask cookbooks author?
[2013-12-06 10:03:44 -0500] holms: or in tomcat channel of those who's using chef cookbooks to setup tomcat
[2013-12-06 10:04:47 -0500] BNm: thanks for responding where do i find cookbook authors
[2013-12-06 10:05:20 -0500] holms: well
[2013-12-06 10:05:30 -0500] holms: from where have you downloaded cookbook?
[2013-12-06 10:05:47 -0500] BNm: chef server
[2013-12-06 10:05:59 -0500] holms: so somebody had to put it in there lol
[2013-12-06 10:06:02 -0500] BNm: from github
[2013-12-06 10:06:09 -0500] holms: that's better
[2013-12-06 10:06:15 -0500] holms: so who's repo was that :)?
[2013-12-06 10:06:44 -0500] BNm: lemme check
[2013-12-06 10:07:43 -0500] holms: there's also official one https://github.com/opscode-cookbooks/tomcat
[2013-12-06 10:08:16 -0500] holms: and there's authors in that readme.. i'm usually just searching them in irc or by email, or raising issue in cookbook
[2013-12-06 10:08:23 -0500] BNm:  sfiggins he made last changes  i took it from here
[2013-12-06 10:09:14 -0500] holms: raising an issue in cookbook repo*
[2013-12-06 10:11:32 -0500] BNm: is there any changes do i need to make it work or there is issue in recipe??
[2013-12-06 10:11:35 -0500] ptrf: holms: wait, why do you suddenly want to uninstall whatever a recipe installed? if you're repurposing and it's a vm, why not just provision a new vm?
[2013-12-06 10:11:51 -0500] ptrf: am I misinterpreting the question?
[2013-12-06 10:13:00 -0500] henk76: anyone ever figured out how to use the ubuntu encryption on a filesystem with chef while bootstrapping? i want to launch a ubuntu machine, encrypt a partition/drive and then run some things on the encrypted section and destroy the machine again
[2013-12-06 10:14:11 -0500] BNm: ptrf:i think so
[2013-12-06 10:28:52 -0500] holms: ptrf: what if it's not a vm?
[2013-12-06 10:29:18 -0500] holms: it's dedicated server , which I have no access to kvm, to reinstall all os
[2013-12-06 10:29:55 -0500] holms: even reinstalling whole os is ridiculous
[2013-12-06 10:30:32 -0500] holms: or you have like 5 cookbooks on one vm
[2013-12-06 10:30:43 -0500] holms: and you decided to get rid one of them without ruing everything else?
[2013-12-06 10:30:51 -0500] kaerast: it's good to reinstall regularly, otherwise you're not confident that you can actually build from scratch
[2013-12-06 10:30:54 -0500] holms: say.. use percona mysql instead of oracle one
[2013-12-06 10:31:05 -0500] kaerast: that's even more true if you're wanting to change roles and recipes
[2013-12-06 10:31:42 -0500] holms: kaerast: good to reinstall OS lol?
[2013-12-06 10:31:54 -0500] holms: when you have some critical services running?
[2013-12-06 10:32:22 -0500] holms: if you talking about reruning roles, that's fine
[2013-12-06 10:32:28 -0500] holms: i'm taking about changing roles completely
[2013-12-06 10:33:49 -0500] kaerast: if it's changing roles completely then it should be a new VM
[2013-12-06 10:33:53 -0500] ptrf: holms: well, I guess that scenario have become rare enough for people not bothering to write uninstall cookbooks
[2013-12-06 10:34:10 -0500] kaerast: sure, that's not always possible, but where it is that's the prefered option
[2013-12-06 10:34:19 -0500] holms: ptrf: that's what i mean, they bias =/ everybody should use vm and it's finished..
[2013-12-06 10:34:23 -0500] ptrf: yeah
[2013-12-06 10:34:27 -0500] ptrf: not to be disdainful
[2013-12-06 10:34:58 -0500] holms: ofcourse the cookbooks which i'll use, i'll try to convince author that i need uninstall script, and i've wrote one, and here's pull request
[2013-12-06 10:35:11 -0500] holms: that's all i can do probably..
[2013-12-06 10:35:20 -0500] ptrf: yeah, that's good
[2013-12-06 11:38:16 -0500] henk76: guys, my recipe keeps on repeating on a windows client when run manually. anyone any ideas what i might have done wrong?
[2013-12-06 12:19:10 -0500] st_iron: hello
[2013-12-06 12:20:11 -0500] st_iron: I started to handle my Chef client with the chef-client cookbook, and use the cron recipe. I see that it created a file in my cron.d dir, and the sleep is 57sec on the first node... I assume it will be another number on the following nodes, right?
[2013-12-06 12:41:41 -0500] RJ2: anyone familiar with vagrant and berkshelf, could you look at my basic repo for vagrant that has one cookbook, and tell me where i'm supposed to put the various berksfile cookbook config lines? at the mo, vagrant provision pulls in the correct deps as per the berksfile, but the chef run fails to find them: https://github.com/RJ/vagrant-chef-basebox
[2013-12-06 12:46:54 -0500] s2r2: quick poll: when you have a command that's idempotent, "add-foo --may-exist blah", should you still include an only_if / not_if to execure the resource only when it does not exist?
[2013-12-06 12:48:32 -0500] s2r2: RJ2: tried without line 35? https://github.com/RJ/vagrant-chef-basebox/blob/master/Vagrantfile#L35
[2013-12-06 12:48:46 -0500] s2r2: RJ2: I suppose vagrant-berkshelf will handle that
[2013-12-06 12:48:57 -0500] RJ2: trying
[2013-12-06 12:49:00 -0500] s2r2: RJ2: the plugin only needs to know where the berksfile is
[2013-12-06 12:49:13 -0500] s2r2: I usually put it next to the vagrantfile and stuff works automagically
[2013-12-06 12:50:08 -0500] RJ2: s2r2: nope same error, can't find afw cookbook
[2013-12-06 12:50:33 -0500] RJ2: it's not an afw thing, if i comment out afw stuff it fails to fine the next one mentioned by "depends"
[2013-12-06 12:50:56 -0500] s2r2: RJ2: try "export VAGRANT_LOG=debug", maybe it helps gain insights
[2013-12-06 12:54:38 -0500] RJ2: no interesting crash, just ERROR: Cookbook afw not found. If you're loading afw from another cookbook, make sure you configure the dependency in your metadata. i'm suspicious that it's not adding the ~/.berkshelf/cookbooks dir to the path to search or something, but not sure how to check
[2013-12-06 12:55:53 -0500] s2r2: RJ2: you could also try without line 30, https://github.com/RJ/vagrant-chef-basebox/blob/master/Vagrantfile#L30
[2013-12-06 12:56:03 -0500] s2r2: maybe it's colliding somehow...
[2013-12-06 12:56:16 -0500] s2r2: usually, you need hardly any config when using this plugin
[2013-12-06 13:00:10 -0500] dan1775: a newbee question: I'd like to use the sudo cookbook, and there use the LWRP. So I wrote a "include_recipe 'sudo'" in my recipe followed by sudo 'my_user' {}. But it says it doesn't know this resource. What I do wrong?
[2013-12-06 13:00:30 -0500] RJ2: dan1775: depends "sudo" in your metadata.rb maybe?
[2013-12-06 13:00:30 -0500] dan1775: the client says 'Cannot find a resource for sudo on ubuntu version 12.04'
[2013-12-06 13:01:09 -0500] dan1775: no, it doesn't
[2013-12-06 13:01:24 -0500] dan1775: do I have to add it there?
[2013-12-06 13:01:41 -0500] RJ2: i believe so
[2013-12-06 13:01:48 -0500] dan1775: it looks like the provider isn't even parsed
[2013-12-06 13:02:01 -0500] dan1775: ok, I try this!
[2013-12-06 13:03:41 -0500] RJ2: s2r2: thanks! i just pushed the commit to github, vagarnt reload and now provision is working
[2013-12-06 13:04:03 -0500] s2r2: RJ2: cool :)
[2013-12-06 13:04:10 -0500] dan1775: wow, this helped! I seems to know the provider. I run into another error, but I think you gave me the hint! Thanks a lot!
[2013-12-06 13:04:24 -0500] RJ2: dan1775: great
[2013-12-06 13:05:05 -0500] henk76: guys, i've been working on a windows machine with chef which works great. now i install the chef client on another windows machine, copy the client.rb and validation.pem from the other windows machine, and during first chef-client run i get a "permission denied - connect" error. anyone got a hint?
[2013-12-06 13:22:31 -0500] TakumoKatekari: Hi All, I've installed nginx with chef using the nginx::source recipie.
[2013-12-06 13:24:45 -0500] TakumoKatekari: But for some reason the node[:nginx][:default_site_enbaled] = false isn't doing anything
[2013-12-06 13:25:13 -0500] TakumoKatekari: /etc/nginx/sites-enabled/000-default still exists.
[2013-12-06 13:51:19 -0500] TakumoKatekari: Hi, I'm kind of new to chef, I've got roles/recipes etc set up to install all the software my stack needs
[2013-12-06 13:51:39 -0500] TakumoKatekari: but there's nothing really documenting how I get chef to manage the downloading of my code, running scripts and starting it all up
[2013-12-06 13:54:01 -0500] ptrf: TakumoKatekari: chef-client can run as a service or as a cron script
[2013-12-06 13:54:13 -0500] ptrf: and you bootstrap nodes to setup chef on them
[2013-12-06 13:55:12 -0500] ptrf: see http://docs.opscode.com/chef/install_bootstrap.html and http://docs.opscode.com/chef/chef_client.html
[2013-12-06 13:55:30 -0500] teukka: edwardc: that knife-solo error looks like a bug. maybe triggered by some certain config, but still
[2013-12-06 13:56:06 -0500] teukka: edwardc: mind filing an issue to https://github.com/matschaffer/knife-solo/issues ?
[2013-12-06 13:56:33 -0500] ptrf: TakumoKatekari: also, regarding nginx cookbook:  node[:nginx][:default_site_enbaled] = false <- did you copy paste that
[2013-12-06 13:56:36 -0500] teukka: edwardc: I can't inspect it right now but will do it later today or tomorrow
[2013-12-06 13:56:56 -0500] TakumoKatekari: ptrf: Not quite what I was asking, it was more about the git and bash resources :P
[2013-12-06 13:56:57 -0500] ptrf: because then the reason it doesnt have effect is because you spelled enabled wrong
[2013-12-06 13:57:09 -0500] TakumoKatekari: also ptrf I set it in my default_attributes for the role
[2013-12-06 13:57:13 -0500] Chammmmm: Hi, is it possible to create an action in LWRP that returns a value.. and grab it in the recipe?
[2013-12-06 13:57:55 -0500] Chammmmm: Actually the reason is that I dont want to pollute my recipe with function and ruby code.. but the goal is to parse something and return a value
[2013-12-06 13:58:12 -0500] Chammmmm: Oh Maybe I should create a lib?
[2013-12-06 13:58:29 -0500] teukka: edwardc: ah, ruby 1.8. what does `ruby --version` say?
[2013-12-06 13:58:58 -0500] Chammmmm: Can I put node attributes directly in libs?
[2013-12-06 14:01:04 -0500] teukka: edwardc: oh, 1.8.7 doesn't have `select!`. we can fix that but there might be other issues still. and berkshelf requires at least 1.9 anyway
[2013-12-06 14:01:33 -0500] gregkare: Don't use Ruby 1.8.7 on a new project, it's EOL since June
[2013-12-06 14:02:54 -0500] teukka: agreed, especially on workstation there shouldn't be any reason to use 1.8 any more. on some servers I can still somehow accept it =)
[2013-12-06 14:03:24 -0500] teukka: rhen, debian, etc will still continue to support their own 1.8 rubies, so the EOL is not totally true
[2013-12-06 14:03:35 -0500] teukka: s/rhen/rhel/
[2013-12-06 14:08:03 -0500] lewiz: So the mysql cookbook has a default for default['mysql']['server']['packages'] = [ 'mysql-server' ] and in my environment I set mysql.server.packages = [ 'Percona-Server-server-56' ].  For some reason the package installation phase still tries to install mysql-server then Percona-Server-server-56.  I thought setting this in the environment would override, not append?  Am I missing something really obvious?
[2013-12-06 14:16:47 -0500] hairyhenderson: morning folks. I'm creating a new API Client for an app I'm writing, and I'm wondering how people tend to deal with storing the .pem
[2013-12-06 14:17:03 -0500] hairyhenderson: I don't think it woudl be smart to put the .pem in source control, for example...
[2013-12-06 14:17:23 -0500] hairyhenderson: but it's also not something easily shared or remembered like a password
[2013-12-06 14:20:35 -0500] TakumoKatekari: hairyhenderson: Put it in .chef (which is in .gitignore by default)
[2013-12-06 14:20:56 -0500] TakumoKatekari: then share the private keys over a more secure channel, I find QR codes work well for face-to-face teams
[2013-12-06 14:21:32 -0500] hairyhenderson: ok, I got the .gitignore part already, but the sharing part was what I was confused about...
[2013-12-06 14:21:40 -0500] hairyhenderson: a QR is a very interesting idea!
[2013-12-06 14:23:09 -0500] hairyhenderson: I guess I could also set up a separate "secure" SCM for stuff like that which is heavily locked down
[2013-12-06 14:25:32 -0500] TakumoKatekari: tbh I've not tried the QR approach, it was just an idea that came into my head
[2013-12-06 14:26:06 -0500] TakumoKatekari: That's how I'd share the files, or by copying them to a shared folder on a physically local server (like we have in our office)
[2013-12-06 14:27:02 -0500] henk76: if i have an attribute called "release" with a value of "1.3.5.7" on a node and i want to use a not_if statement, what is the proper way of using the not_if. i now have: not_if { [node'release"] == "1.3.5.7"
[2013-12-06 14:27:17 -0500] henk76: and this doesn't work.
[2013-12-06 14:37:25 -0500] henk76: if i have an attribute called "release" with a value of "1.3.5.7" on a node and i want to use a not_if statement, what is the proper way of using the not_if. i now have: not_if { [node'release"] == "1.3.5.7"
[2013-12-06 14:42:30 -0500] kaerast: not_if { node['release'] == '1.3.5.7'}
[2013-12-06 14:45:35 -0500] henk76: thanks kaerast, i'll go and try that.
[2013-12-06 14:50:01 -0500] nd__: I have some problems with the mysql cookbook: service[mysql-start] (mysql::_server_rhel line 38) had an error: Chef::Exceptions::Service: service[mysql-start]: unable to locate the init.d script! Any ideas?
[2013-12-06 14:52:26 -0500] hairyhenderson: TakumoKatekari: thanks for the advice - sharing on a local server which is access-controlled might actually be the simplest way, because we at least have backups...
[2013-12-06 14:54:57 -0500] TakumoKatekari: no problem hairyhenderson , I know what it's like to be stuck
[2013-12-06 14:56:40 -0500] hairyhenderson: TakumoKatekari: turns out the whole question of "how do I share secrets, while not sharing them with the whole world" is a really tough one ;)
[2013-12-06 14:57:10 -0500] TakumoKatekari: agreed, never easy to get it right.
[2013-12-06 15:02:54 -0500] holms: how to kill
[2013-12-06 15:02:56 -0500] holms: destroy chef-client?
[2013-12-06 15:03:08 -0500] holms: and since when it tracks /etc/hosts
[2013-12-06 15:03:19 -0500] holms: i doubt that any recipe even access it
[2013-12-06 15:09:12 -0500] holms: am I stupid or what
[2013-12-06 15:09:18 -0500] holms: googling for "chef-client stop"
[2013-12-06 15:09:22 -0500] holms: totally nothing
[2013-12-06 15:09:28 -0500] holms: how to destroy this beast
[2013-12-06 15:09:31 -0500] holms: ps -ax it's not in there
[2013-12-06 15:11:17 -0500] holms: it's not in init.d
[2013-12-06 15:11:20 -0500] holms: it'snot in  /etc/init
[2013-12-06 15:11:24 -0500] holms: how to stop chef client?
[2013-12-06 15:13:21 -0500] holms: dead channel =(
[2013-12-06 15:13:25 -0500] laurent\: is it ?
[2013-12-06 15:13:42 -0500] laurent\: let me backlog
[2013-12-06 15:13:56 -0500] bobbyz: Out of curiosity, can knife plugins attach to existing knife commands?  I would love to hook all of the data bag commands so that changes made on the server are then mirrored locally in the project root (we have our data bags checked-into git as json files)
[2013-12-06 15:14:34 -0500] gchristensen: holms: my bet is its in a crontab
[2013-12-06 15:14:38 -0500] laurent\: holms: how have you initially installed chef-client ?
[2013-12-06 15:14:48 -0500] gchristensen: holms: look in /etc/cron.d/ /etc/crontab and sudo crontab -e
[2013-12-06 15:14:58 -0500] laurent\: yeah, and how are you starting it
[2013-12-06 15:15:56 -0500] jonlives: bobbyz: they absolutely can, I do that very thing in knife spork - check out the method at the bottom of this file: https://github.com/jonlives/knife-spork/blob/master/lib/chef/knife/spork-node-edit.rb
[2013-12-06 15:16:13 -0500] bobbyz: jonlives: Thanks!  That's perfect!
[2013-12-06 15:16:18 -0500] jonlives: np :)
[2013-12-06 15:17:29 -0500] holms: laurent\: it's removed already
[2013-12-06 15:17:38 -0500] holms: k checkint cron
[2013-12-06 15:30:53 -0500] nd__: someara_: Around?
[2013-12-06 15:42:17 -0500] TakumoKatekari: How do I set the EXPECTED exit status of a bash resource?
[2013-12-06 15:42:32 -0500] TakumoKatekari: i.e. I actually expect the exit status to be 127 or 3 or something
[2013-12-06 15:53:05 -0500] TakumoKatekari: So yeah, if I /expect/ a bash resource to end with a non-zero exit status
[2013-12-06 15:53:12 -0500] TakumoKatekari: as its making my recipe fail
[2013-12-06 15:56:11 -0500] clayb: TakumoKatekari: http://docs.opscode.com/resource_bash.html look at the Attributes section
[2013-12-06 16:01:12 -0500] TakumoKatekari: thanks clayb
[2013-12-06 17:22:38 -0500] JoelThompson: Hi everyone. Hopefully quick question -- in a single cookbook with a complicated application stack, is it possible to have recipe-specific metadata?
[2013-12-06 17:23:06 -0500] JoelThompson: So, for example, part of an app stack would live on Windows and part on Linux, so we are putting them in a single cookbook
[2013-12-06 17:23:31 -0500] JoelThompson: but obviously there's no single "supports" command we could use.
[2013-12-06 17:24:03 -0500] JoelThompson: If we split them up into separate cookbooks, we'd have to duplicate some of the metadata
[2013-12-06 17:26:35 -0500] TakumoKatekari: there's no real need to have different metadata
[2013-12-06 17:27:07 -0500] TakumoKatekari: but you should consider using Berkshelf to manage your external Berks
[2013-12-06 17:28:06 -0500] CPS_: JoelThompson: look at the attrubutes of a node. you can access node['os'] and act based on it in a recipe
[2013-12-06 17:28:30 -0500] JoelThompson: Right, but can we act on it in the metadata.rb file?
[2013-12-06 17:28:52 -0500] TakumoKatekari: why would you need to act on it in the metadata.rb file?
[2013-12-06 17:29:12 -0500] JoelThompson: Well, for example, different recipes might have different dependencies
[2013-12-06 17:29:31 -0500] JoelThompson: The windows components could depend on the powershell cookbook for example, but the Linux components wouldn't
[2013-12-06 17:29:31 -0500] CPS_: JoelThompson: i believe so
[2013-12-06 17:29:44 -0500] JoelThompson: and that would lead to unnecessary cookbook loading on the different platform
[2013-12-06 17:30:03 -0500] CPS_: they're ruby files that get executed, so anything that works in ruby will work
[2013-12-06 17:30:34 -0500] CPS_: try if node[os] == windows \ require windows stuff
[2013-12-06 17:30:37 -0500] JoelThompson: Thanks CPS_. I'm still somewhat new, so I'm not sure at what time they get executed/parsed and what's available where
[2013-12-06 17:30:54 -0500] JoelThompson: I'll try it quickly and see
[2013-12-06 17:30:59 -0500] mannyt: JoelThompson technically you might be able to do that because the metadata files is ruby as CPS_ said but the node['os'] or 'platform_family' will not be available until the chef-client run and I'm not sure that will be picked up in metadata.rb
[2013-12-06 17:31:22 -0500] mannyt: but I would try what CPS_ suggests and see what the end result is
[2013-12-06 17:31:41 -0500] JoelThompson: mannyt: Is the actual recipe name available in the metadata.rb file? That could also solve the problem.
[2013-12-06 17:32:53 -0500] mannyt: That would be available
[2013-12-06 17:33:09 -0500] mannyt: So yes JoelThompson if you can check for something else then that would work
[2013-12-06 17:34:36 -0500] JoelThompson: mannyt -- forgive the n00b question, how do I access the actual recipe name in the metadata.rb file?
[2013-12-06 17:37:02 -0500] JoelThompson: Also, CPS_ and mannyt, just tried both node['os'] and platform_family? and both return errors when trying to berks upload the cookbook.
[2013-12-06 17:38:15 -0500] CPS_: i'm not very familiar with the metadata file, could be that gets loaded before the chef node stuff. it should work in the recipe
[2013-12-06 17:38:48 -0500] mannyt: I'm trying to figure out how that would work.  The chef gem actually has a class that deals with the metadata.rb and you can use that to parse out metadata.rb files and do some checking.  Tho now I'm not sure how that would actually help you in choosing between OSes
[2013-12-06 17:39:42 -0500] mannyt: Also there is the suggests setting in a metadata.rb file.  I don't know what its behavior is but it might help you to lazy load cookbooks http://docs.opscode.com/essentials_cookbook_metadata.html
[2013-12-06 17:39:59 -0500] mannyt: as in it might only load them if they are included in the cookbook
[2013-12-06 17:40:14 -0500] mannyt: I have no idea how that will impact the speed of the chef-client run
[2013-12-06 17:46:49 -0500] JoelThompson: ok, thanks mannyt and CPS_ for your suggestions. It's not a big deal for us, I just wanted to know if there's something easy I was missing.
[2013-12-06 17:54:01 -0500] iamchrisf: hey all how do I force libmysqlclient-dev to install before a call to "chef_gem mysql"?
[2013-12-06 17:54:45 -0500] iamchrisf: I'm using the percona cookbook and it doesn't install the mysql ruby gem.
[2013-12-06 17:55:14 -0500] speromak_: iamchrisf: have to do it in compile time  p = package "libmysqlclient-dev"; p.run_action :install
[2013-12-06 17:56:10 -0500] iamchrisf: speromak_: Got it.  Thx
[2013-12-06 18:08:53 -0500] gabrtv: i'm trying to stop a bunch of resources that each take 5s or so.. any way to parallelize that in a chef run?
[2013-12-06 18:32:27 -0500] knuckolls: gabrtv: i'm not aware of any such work making resources run in parallel, especially since oftentimes ordering is quite important in a recipe
[2013-12-06 18:32:43 -0500] knuckolls: that said, you have the full power of shelling out via the bash resource or going wild with a ruby_block
[2013-12-06 18:33:41 -0500] gabrtv: knuckolls: i'm experimenting w/ threads that have `abort_on_exception` for the main thread.. i'm clearly going off the rails w/ this, but should be interesting!
[2013-12-06 18:34:50 -0500] knuckolls: gabrtv: https://www.youtube.com/watch?v=gjVmeKWOsEU
[2013-12-06 18:51:00 -0500] holms_: how can I override attribute of role, in config of the node?
[2013-12-06 18:51:04 -0500] holms_: it's os specific attribute
[2013-12-06 18:51:08 -0500] holms_: oS*
[2013-12-06 18:56:25 -0500] holms_: hello..? =/
[2013-12-06 18:58:58 -0500] feutete: I have a template where I want to check if a node has a certain recipe applied
[2013-12-06 18:59:24 -0500] feutete: i'm trying something like this, with no luck: if @node.recipes.include?('myRecipe')
[2013-12-06 18:59:52 -0500] feutete: would you all expect that to work?
[2013-12-06 19:02:58 -0500] holms_: guys and ladies
[2013-12-06 19:03:00 -0500] holms_: anybody alive?
[2013-12-06 19:03:38 -0500] iamchrisf: Can someone assist with this snippet.  I can't seem to get chef_gem mysql to install with percona cookbook.  http://pastie.org/pastes/8533947/text
[2013-12-06 19:04:21 -0500] iamchrisf: Currently thus seems like a lot of effort to get it installed.  Surprised there's not a Percona::ruby recipe.
[2013-12-06 19:06:54 -0500] psykidellic: is there  a canonical way to add a script to my chef run/repo (the script is not present in the host) and run it during bootstrap process?
[2013-12-06 19:19:58 -0500] holms: anybody in here lol?
[2013-12-06 19:20:01 -0500] holms: people asking nobody care :D
[2013-12-06 19:30:58 -0500] chip-: speakingcode: The best way to do that would be to check your "starter kit" code into a repo (excluding the .chef directory), and then check it out again on another machine.
[2013-12-06 19:31:09 -0500] chip-: then copy over the keys etc. out-of-band.
[2013-12-06 19:31:49 -0500] speakingcode: chip-: ah, figured, just my luck i never did push it up :-\ ah well i'll see if i can ssh into the machine
[2013-12-06 19:32:11 -0500] chip-: speakingcode: If you're the only one using it, then resetting the validation key is no big deal.
[2013-12-06 19:32:37 -0500] speakingcode: k
[2013-12-06 19:32:49 -0500] chip-: It just makes knife bootstrap not work on the old machine
[2013-12-06 19:32:53 -0500] chip-: everything else should be the same.
[2013-12-06 19:33:22 -0500] speakingcode: i suppose i can retroactively fix the other machine when i get back to it pretty easily if i do that?
[2013-12-06 19:36:39 -0500] chip-: Yeah, just copy the .pem files out of chef-repo/.chef over to the other machine
[2013-12-06 19:36:44 -0500] chip-: and again, those are private keys, so don't commit them anywhere.
[2013-12-06 19:36:59 -0500] gswallow: Hi, all!
[2013-12-06 19:37:53 -0500] gswallow: I have this really weird problem with Chef on Windows that I usually dance around.
[2013-12-06 19:37:54 -0500] gswallow: https://gist.github.com/gswallow/7830877
[2013-12-06 19:38:14 -0500] speakingcode: thanks chip-
[2013-12-06 19:38:44 -0500] gswallow: oh this is bug 4145?
[2013-12-06 19:40:41 -0500] gverri:  How can I auto-delete a vagrant node when I destroy the machine?
[2013-12-06 19:42:27 -0500] gabrtv: knuckolls: we have a winner.. https://gist.github.com/gabrtv/7830923
[2013-12-06 19:43:58 -0500] knuckolls: gabrtv: awesome
[2013-12-06 19:44:27 -0500] gabrtv: love the fact that chef is "just ruby" and therefore this kind of thing is possible
[2013-12-06 19:45:22 -0500] geggam: interested to understand why that is needed...
[2013-12-06 19:46:03 -0500] gabrtv: trying to stop many docker containers at once, each container stop/remove takes 5s or so
[2013-12-06 19:46:14 -0500] geggam: just a time thing then ?
[2013-12-06 19:46:28 -0500] gabrtv: yeah, time to converge is important in the case of http://deis.io/overview/
[2013-12-06 19:46:38 -0500] speakingcode: knuckolls: ohai
[2013-12-06 19:50:15 -0500] geggam: thanks gabrtv ... i was just remembering when we got new processors and the child returned the answer before the parent was listening.. love races
[2013-12-06 19:57:38 -0500] gverri: What is the best way to share chef validation/client keys with a vagrant box?
[2013-12-06 19:58:25 -0500] llonchj: hello! i am upgrading chef-server from 11.0.4 to 11.0.10 and the chef-server-ctl reconfigure fails on execute[/opt/chef-server/embedded/bin/createdb -T template0 -E UTF-8 opscode_chef] action run with createdb: could not connect to database template1: could not connect to server: No such file or directory
[2013-12-06 19:58:29 -0500] llonchj: what can I do?
[2013-12-06 20:27:47 -0500] jmickle: how do you tell a node to use a specific version of a cookbook again?
[2013-12-06 20:33:01 -0500] coderanger: jmickle: The normal way is via environments
[2013-12-06 20:33:18 -0500] jmickle: do you bind to a variable?
[2013-12-06 20:33:26 -0500] coderanger: jmickle: Not sure what you mean
[2013-12-06 20:33:41 -0500] holms: oh my favorite supporter is online
[2013-12-06 20:33:43 -0500] coderanger: envs specify a policy about what versions of each cookbook are allowed
[2013-12-06 20:33:44 -0500] holms: coderanger: good evening :)
[2013-12-06 20:33:56 -0500] coderanger: holms: good $timeofday :-)
[2013-12-06 20:34:02 -0500] holms: :DD
[2013-12-06 20:34:29 -0500] CPS_: getting a weird compile error when specifying log resource log level https://gist.github.com/clanpotshake/7831660
[2013-12-06 20:34:38 -0500] CPS_: doesn't like level :error
[2013-12-06 20:34:50 -0500] holms: coderanger: I can't find how can I, override attribute in node config (json), for the role, for specific cookbook :D
[2013-12-06 20:35:33 -0500] holms: CPS_: well... "expecting keyword_end"
[2013-12-06 20:35:40 -0500] CPS_: yeah
[2013-12-06 20:35:42 -0500] holms: you forgot to "end" something
[2013-12-06 20:35:43 -0500] holms: :D
[2013-12-06 20:35:44 -0500] CPS_: that doesn't make sense
[2013-12-06 20:35:53 -0500] holms: or just stupid syntax error
[2013-12-06 20:36:00 -0500] holms: happens to me all the time
[2013-12-06 20:36:02 -0500] CPS_: the recipe snippet is at the bottom
[2013-12-06 20:36:42 -0500] coderanger: CPS_: Hmm, doesn't look obviously wrong
[2013-12-06 20:37:01 -0500] CPS_: commenting out the level line makes it run fine
[2013-12-06 20:37:41 -0500] coderanger: CPS_: Check for unicode whitespace?
[2013-12-06 20:37:59 -0500] coderanger: Or just remove the line and retype it
[2013-12-06 20:38:16 -0500] CPS_: i have whitespace characters visible
[2013-12-06 20:38:20 -0500] CPS_: nothing weird
[2013-12-06 20:38:43 -0500] holms: CPS_: put level :error right after
[2013-12-06 20:38:44 -0500] holms: do
[2013-12-06 20:38:47 -0500] holms: remove comment
[2013-12-06 20:38:53 -0500] holms:  put eerything in one line
[2013-12-06 20:38:53 -0500] CPS_: lines are \n instead of \r\n though
[2013-12-06 20:38:56 -0500] holms: this kind of things helps usually
[2013-12-06 20:39:02 -0500] CPS_: i'll give that a go
[2013-12-06 20:39:34 -0500] holms: at least in python i find some tab errors like this D:
[2013-12-06 20:39:44 -0500] holms: coderanger: any clue about my question? :)
[2013-12-06 20:39:54 -0500] coderanger: holms: Which question?
[2013-12-06 20:40:06 -0500] holms: -_-
[2013-12-06 20:40:12 -0500] holms: 22:34 < holms> coderanger: I can't find how can I, override attribute in node config (json), for the role, for specific cookbook :D
[2013-12-06 20:40:21 -0500] holms: http://pastie.org/pastes/8534150/text
[2013-12-06 20:40:49 -0500] holms: that override thing doesn't work
[2013-12-06 20:40:53 -0500] coderanger: holms: Hmm, not sure what you mean, node attrs are a shared global namespace so there isn't "for specific cookbook"
[2013-12-06 20:41:04 -0500] holms: okey..
[2013-12-06 20:41:13 -0500] holms: how can I override role's attribute in node config?
[2013-12-06 20:41:16 -0500] coderanger: And yes, you can't set default/override stuff in the node
[2013-12-06 20:41:21 -0500] coderanger: only normal-level
[2013-12-06 20:41:21 -0500] CPS_: log "No MSI packages found in #{db_nas["web_install"]}" do level :error end
[2013-12-06 20:41:21 -0500] holms: i have ubuntu os in one node
[2013-12-06 20:41:24 -0500] holms: and centos on another
[2013-12-06 20:41:28 -0500] holms: this requires different group
[2013-12-06 20:41:29 -0500] CPS_: error on :error
[2013-12-06 20:41:31 -0500] CPS_: same thing
[2013-12-06 20:42:24 -0500] holms: coderanger: what do you mean "normal level"'
[2013-12-06 20:42:35 -0500] holms: what about os specific stuff
[2013-12-06 20:42:45 -0500] coderanger: holms: There are four levels of attrs, default, normal, override, automatic
[2013-12-06 20:42:54 -0500] holms: your suggest tu support 30 distro with cookbook?
[2013-12-06 20:43:05 -0500] holms: to*
[2013-12-06 20:43:40 -0500] holms: ok...
[2013-12-06 20:43:43 -0500] coderanger: holms: Not sure what you are asking still
[2013-12-06 20:43:58 -0500] holms: you see this attr?    "supervisor_gid" : "adm"
[2013-12-06 20:44:00 -0500] coderanger: holms: If you want to set overrides, you need to do in a role, environment, or cookbook
[2013-12-06 20:44:03 -0500] holms: it will be different per n ode
[2013-12-06 20:44:05 -0500] holms: node*
[2013-12-06 20:44:16 -0500] coderanger: No, it will be different per role :)
[2013-12-06 20:44:22 -0500] coderanger: Or do it in a wrapper cookbook
[2013-12-06 20:44:24 -0500] holms: why.. X_X
[2013-12-06 20:44:33 -0500] holms: if you have some client which runs
[2013-12-06 20:44:35 -0500] holms: on all oses
[2013-12-06 20:44:38 -0500] coderanger: Because setting _anything_ in the node invites special snowflakes
[2013-12-06 20:44:41 -0500] holms: why i have to have 20 roles in there
[2013-12-06 20:44:52 -0500] holms: coderanger: im ok with that
[2013-12-06 20:44:53 -0500] coderanger: Then do it in a wrapper cookbook
[2013-12-06 20:45:16 -0500] holms: any change to have tempaltes for roles?
[2013-12-06 20:45:25 -0500] holms: this is just huge limitation
[2013-12-06 20:45:38 -0500] holms: that var has a default.. why role has to be os depdedant?
[2013-12-06 20:45:41 -0500] holms: it's job of node
[2013-12-06 20:45:47 -0500] holms: one role for 20 different os node's
[2013-12-06 20:45:57 -0500] coderanger: holms: http://hastebin.com/popojahuxu.rb
[2013-12-06 20:46:04 -0500] coderanger: Put that in a wrapper cookbook
[2013-12-06 20:46:04 -0500] jmickle: code ranger how are you
[2013-12-06 20:46:09 -0500] jmickle: how was your thanksgiving
[2013-12-06 20:46:22 -0500] coderanger: jmickle: Eh, dealing with my family is a full time job
[2013-12-06 20:46:28 -0500] jmickle: hehe i know the feeling
[2013-12-06 20:46:31 -0500] coderanger: There is a reason I live thousands of miles from them
[2013-12-06 20:47:29 -0500] jmickle: hehe
[2013-12-06 20:48:12 -0500] holms: things starting to loose sense for me in this engine =/
[2013-12-06 20:49:11 -0500] holms: this whole structure should follow inheritance
[2013-12-06 20:49:59 -0500] holms: coderanger: can I atleast extend a role?//
[2013-12-06 20:50:13 -0500] holms: make tample of role and reuse it, like that fb guy was saying inv ideo
[2013-12-06 20:50:15 -0500] coderanger: Yes, a role can include another role
[2013-12-06 20:50:28 -0500] coderanger: Extension via composition
[2013-12-06 20:50:33 -0500] holms: i feel more calm
[2013-12-06 20:51:54 -0500] holms: ok maybe this makes sense
[2013-12-06 20:52:03 -0500] holms: when having like 20 nodes with ubuntu annnother 20 with centos
[2013-12-06 20:52:11 -0500] holms: ..
[2013-12-06 20:52:24 -0500] holms: coderanger: skanaus (in lithuanian)
[2013-12-06 20:52:54 -0500] gchristensen: coderanger: you should merge and release depot-0.0.3, speaking of forks :)
[2013-12-06 21:01:32 -0500] CPS_: is there a way to route all of the output from chef-client to a file? the log_location setting in client.rb only seems to route output of chef directives
[2013-12-06 21:48:22 -0500] jtran: if a have cookbook "foo" with recipes a,b,c ..     in recipe "c", I have  at the top "include_recipe 'a' " and then after that "Chef::Log.info("RECIPE C").   When chef-client executes recipe  "C", it appears that the "RECIPE C" output is occuring BEFORE recipe "a" is being executed.   Is that intended behavior?
[2013-12-06 21:50:24 -0500] xUltra: I believe the yum cookbook's repository provider update functionality doesn't actually work.
[2013-12-06 22:22:46 -0500] someara: @jtran that Chef::Log.info being printed in the compilation phase of the chef run
[2013-12-06 22:22:51 -0500] someara: you want log('hi')
[2013-12-06 22:43:41 -0500] misentropic: hi. i am trying to do a package resource install of a local rpm file and chef fails with ENOMEM (system does not run out of memory although utilization goes up). However, if I rpm -i or yum localinstall the cached rpm it works just fine.
[2013-12-06 22:43:58 -0500] misentropic: I have tried this on multiple rpms (my custom ones as well as oracle jdk rpm)
[2013-12-06 22:44:01 -0500] misentropic: Any thoughts?
[2013-12-06 22:45:31 -0500] misentropic: I can provide the chef stacktrace if that will help, here is the final error line:
[2013-12-06 22:45:38 -0500] misentropic: [2013-12-06T17:36:25-05:00] FATAL: Errno::ENOMEM: package[jdk-7u45-linux-x64.rpm] (lightspeed::delorean-server line 21) had an error: Errno::ENOMEM: Cannot allocate memory - fork(2)
[2013-12-06 22:46:30 -0500] c_t: ulimit problem maybe?
[2013-12-06 22:47:03 -0500] c_t: doesn't seem real likely, but perhaps worth looking at
[2013-12-06 22:48:53 -0500] misentropic: @c_t fair enough, let me take a look
[2013-12-06 22:50:01 -0500] misentropic: @c_t nope, ulimit returns unlimited
[2013-12-06 22:50:11 -0500] misentropic: would expect as much for root :-P
[2013-12-06 22:50:34 -0500] misentropic: any other thoughts
[2013-12-06 22:58:17 -0500] geggam: misentropic, how are you installing it ?
[2013-12-06 22:58:33 -0500] misentropic: via chef?
[2013-12-06 22:58:52 -0500] geggam: um.... what command is chef running
[2013-12-06 22:58:58 -0500] misentropic: package
[2013-12-06 22:59:04 -0500] TrinitronX: is there an easy way to debug where a node attribute is coming from other than grepping through my chef repo?
[2013-12-06 22:59:07 -0500] misentropic: package("jdk-7u45-linux-x64.rpm") do   action :install   retries 0   retry_delay 2   package_name "jdk-7u45-linux-x64.rpm"   source "/var/chef/cache/jdk-7u45-linux-x64.rpm"   cookbook_name "lightspeed"   recipe_name "delorean-server" end
[2013-12-06 23:00:42 -0500] geggam: Can you try  package "jdk-7u45-linux-x64.rpm" do
[2013-12-06 23:00:42 -0500] geggam: action :install
[2013-12-06 23:00:42 -0500] geggam: end
[2013-12-06 23:02:31 -0500] misentropic: I have to provide the source because the oracle jdk downloads aren't available easily (they force you to accept the agreement)
[2013-12-06 23:02:42 -0500] misentropic: I am doing this as a workaround to that
[2013-12-06 23:03:21 -0500] someara: use the "source" attribute
[2013-12-06 23:03:28 -0500] misentropic: That is what I am already doing
[2013-12-06 23:03:32 -0500] someara: otherwise its going to try and find it in a yum channel
[2013-12-06 23:03:48 -0500] misentropic: @geggam, my response above was to your suggestion
[2013-12-06 23:04:08 -0500] geggam: i see that misentropic ... you dont have a private repo / bucket ?
[2013-12-06 23:04:40 -0500] misentropic: @geggam, setting up as we speak, hence the local file workaround right now
[2013-12-06 23:05:00 -0500] someara: rpm_package with source attribute?
[2013-12-06 23:05:21 -0500] misentropic: yes, rpm package, with source attribute, here is a gist https://gist.github.com/misentropic/7833633
[2013-12-06 23:05:22 -0500] someara: source "/path/to/archive"
[2013-12-06 23:05:42 -0500] geggam: im not a chef expert but it seems like its trying to load the rpm into memory before installing it
[2013-12-06 23:05:43 -0500] someara: try 'rpm_package' instead of 'package'
[2013-12-06 23:06:15 -0500] misentropic: @someara, yum_package ok? I'd rather do that since we're using yum extensively
[2013-12-06 23:07:03 -0500] someara: I'm not %100 on the behavior right off the bat, but I seem to remember needing to use rpm_package for local files
[2013-12-06 23:07:27 -0500] misentropic: ok, trying with yum_package right now
[2013-12-06 23:07:29 -0500] misentropic: will try rpm_package next
[2013-12-06 23:07:39 -0500] misentropic: but do you agree that is really sad? ...
[2013-12-06 23:08:12 -0500] misentropic: since even the docs say always try package only specific providers if you really must
[2013-12-06 23:08:25 -0500] someara: well yum is going to try and use "yum -y install jdk-7u45-linux-x64.rpm"
[2013-12-06 23:08:45 -0500] someara: instead of rpm -i /path/to/rpm
[2013-12-06 23:08:56 -0500] misentropic: ughh,, it doesn't do yum localinstall?
[2013-12-06 23:08:57 -0500] misentropic: ok
[2013-12-06 23:09:05 -0500] misentropic: Switching to rpm_package
[2013-12-06 23:09:14 -0500] geggam: package "tar" do
[2013-12-06 23:09:14 -0500] geggam:   action :install
[2013-12-06 23:09:15 -0500] geggam:   source "/tmp/tar-1.16.1-1.rpm"
[2013-12-06 23:09:15 -0500] geggam:   provider Chef::Provider::Package::Rpm
[2013-12-06 23:09:15 -0500] geggam: end
[2013-12-06 23:09:20 -0500] geggam: is what i see for doc
[2013-12-06 23:10:12 -0500] misentropic: ok @geggam, let me try that and if that doesn't do it I will try rpm_package per someara
[2013-12-06 23:10:14 -0500] someara: might be a docs bug link me to the exact page?
[2013-12-06 23:10:47 -0500] someara: I'll experiment with it
[2013-12-06 23:11:43 -0500] misentropic: http://docs.opscode.com/resource_package.html
[2013-12-06 23:12:03 -0500] misentropic: "This resource is the base resource for several other resources used for package management on specific platforms. While it is possible to use each of these specific resources, it is recommended to use the package resource as often as possible. "
[2013-12-06 23:12:44 -0500] someara: yep. best practice is to host internal yum repositories instead of installing archives off a local filesystem
[2013-12-06 23:13:01 -0500] misentropic: agreed and will be doing that shortly
[2013-12-06 23:13:12 -0500] someara: hence "package" being an abstraction around the native package manager, which is "yum"
[2013-12-06 23:13:46 -0500] misentropic: was just trying a workaround and a bit surprised that it is having this problem. I guess it is painful for you to look at the source attribute and figure out if the path is local and do localinstall instead etc etc
[2013-12-06 23:13:48 -0500] misentropic: I can see that
[2013-12-06 23:13:52 -0500] someara: but yea its not exactly intuitive
[2013-12-06 23:14:01 -0500] misentropic: rpm_package worked like a charm
[2013-12-06 23:14:34 -0500] misentropic: Do you recommend that or package with a rpm provider? effecitively the same but is there a best practice around that
[2013-12-06 23:16:08 -0500] geggam: so... chef developers... i want you to get me hooks into this thing http://www.businessinsider.com/burger-robot-could-revolutionize-fast-food-industry-2012-11
[2013-12-06 23:16:16 -0500] geggam: i can run all of mcdonalds
[2013-12-06 23:16:21 -0500] geggam: alone :)
[2013-12-06 23:16:22 -0500] misentropic: @someara, thank you, cheers!
[2013-12-06 23:16:59 -0500] someara: no prob
[2013-12-06 23:22:48 -0500] supercom32: When you want to reference attributes from another cookbook, you need to include them. But does that mean you must actually have them in your run list, or do you just need to ensure they are present on your chef server?
[2013-12-06 23:28:57 -0500] jameson__: if you don't have them in the runlist your modification would be wasted :D
[2013-12-06 23:29:13 -0500] log1kal: you need to depend on them, and probably use 'include_attribute' to make sure they're available to your cookbook
[2013-12-06 23:29:29 -0500] jameson__: so you shouldn't only modify the attribute for other cookbooks if you intend to use them in same run_list
[2013-12-06 23:33:12 -0500] josephholsten: guess who's debugging PHP code talking to a chef server?
[2013-12-06 23:33:31 -0500] timsmith1: sounds like fun
[2013-12-06 23:33:37 -0500] josephholsten: is there any way to validate that a chef-validator client key is correct?
[2013-12-06 23:34:34 -0500] josephholsten: looking at the latest chef-pedant, almost every request is supposed to return 403 forbidden
[2013-12-06 23:36:29 -0500] josephholsten: cuz this does not work: https://github.com/Scalr/scalr/blob/master/app/src/Scalr/UI/Controller/Services/Chef/Servers.php#L77
[2013-12-06 23:42:12 -0500] josephholsten: aww yeah, chef-validator can access GET /clients/chef-validator
[2013-12-06 23:55:14 -0500] kcb_: can i query the yum cache directly in a recipe? (like to see if a version is installed without shelling out)
[2013-12-06 23:58:10 -0500] force: Libraries that I mix in with `class Chef::Recipe; include MyLib; end` are available to "all recipes, attributes, file definitions, providers, and definitions" <http://docs.opscode.com/essentials_cookbook_libraries.html>, but does that persist between cookbooks? If I add some convenience methods to my Foo cookbook, do those methods persist and pollute the recipes of my Bar cookbook?
