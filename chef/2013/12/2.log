[2013-12-02 18:08:24 -0500] daw13: Hello All,  I have 2 recipes.  Recipe B uses an app installed by recipe A for if and unless statements.  When both recipes are in a run list, the if or unless statements in recipe B before recipe A.  Is that expected?  How can I get around this?
[2013-12-02 18:09:01 -0500] daw13: Sorry, the if or unless statements in recipe B are ran before recipe A
[2013-12-02 18:12:35 -0500] mattupstate1: daw13: if recipe B uses an app in recipe A, then shouldn't recipe A always be run first?
[2013-12-02 18:13:20 -0500] CPS: daw13: depending on how you write your recipes, you might be running up on chef's 2 pass compilation thing
[2013-12-02 18:13:53 -0500] daw13: mattupstate1: Recipe A is 1st in the runlist so I would expect so
[2013-12-02 18:14:20 -0500] mattupstate: CPS: good point
[2013-12-02 18:14:31 -0500] mattupstate: compile vs run
[2013-12-02 18:14:52 -0500] CPS: might try putting your if/else code inside a ruby_block
[2013-12-02 18:14:54 -0500] daw13: CPS: I'm using chef 11.8 and in this case I'm using ruby code to build an array
[2013-12-02 18:15:13 -0500] daw13: CPS: I was just wondering about that
[2013-12-02 18:15:16 -0500] CPS: i'm guessing you just have that outside of chef resources
[2013-12-02 18:15:25 -0500] daw13: CPS: yes
[2013-12-02 18:15:57 -0500] CPS: my money's on that being the issue
[2013-12-02 18:16:01 -0500] daw13: I'll give ruby_block a try.  Thanks
[2013-12-02 18:16:49 -0500] Guest328: as a general cookbook practice for packages that use apt should one include the apt cookbook or provide a way for the recipe to automatically run "apt-get update"?
[2013-12-02 18:17:11 -0500] Guest328: it seems to me that one should be able to take a community cookbook and simply add it to a run list and it should just work
[2013-12-02 18:18:54 -0500] doomviking: JFW is nice
[2013-12-02 18:20:40 -0500] stormerider: Guest328: you usually need to do a bit more than that... cookbooks are building blocks, they're like ingredients. what you make of it can vary widely.
[2013-12-02 18:21:23 -0500] stormerider: if it was configured to work in only one configuration, that wouldnt really be useful to a lot of people.
[2013-12-02 18:21:55 -0500] Guest328: <stormerider> I agree but for instance the opscode mysql cookbook does everything else. why can't it simply run apt-get update as well?
[2013-12-02 18:22:18 -0500] Guest328: like who woudln't want it to run apt-get update if it needs too?
[2013-12-02 18:23:12 -0500] stormerider: people who already have apt caching configured separately?
[2013-12-02 18:23:25 -0500] surge__: Any reason why ohai would be missing node['ec2']['placement_availability_zone'] ? I'm migrating some instances to a vpc, but can't continue until i can get this fixed.
[2013-12-02 18:23:59 -0500] stormerider: surge__: VPC nodes often need the Ohai hint to tell Ohai they're EC2 nodes.
[2013-12-02 18:24:55 -0500] stormerider: surge__: "{}" in /etc/chef/ohai/hints/ec2.json should do the trick.
[2013-12-02 18:26:48 -0500] ssd7: Ohai chefs
[2013-12-02 18:27:51 -0500] surge__: stormerider: Oh ok. I'm reading the blogpost about it now. So I just need to have an execute block run at the top of the run list and all should be good, right?
[2013-12-02 18:29:01 -0500] stormerider: surge__: huh?
[2013-12-02 18:29:24 -0500] stormerider: not following that
[2013-12-02 18:31:49 -0500] surge__: I meant to add an execute block that will make that directory and create that file
[2013-12-02 18:32:11 -0500] stormerider: surge__: you'll need to reload ohai if you're doing it directly in chef
[2013-12-02 18:32:28 -0500] stormerider: creating the hint in the context of a run wont get the attributes to show up in the same run
[2013-12-02 18:41:27 -0500] CPS: how do i specify which server the chef_gem resource connects to? my node is isolated from the internet and I'd like to have my chef server double as a gem server
[2013-12-02 18:44:49 -0500] surge__: stormerider: Okay, I'll give it a shot. Thanks
[2013-12-02 18:45:26 -0500] spheromak: ssd7: morning
[2013-12-02 18:46:04 -0500] spheromak: ssd7: chef omni installer doesn't detect xenserver correctly. Suppose thats a ticket.opscode thing
[2013-12-02 18:46:48 -0500] spheromak: ssd7: actually must be bootstrap template.
[2013-12-02 19:29:36 -0500] Lolindir: Howdy Chefs, does anyone know how to call a method in a providers from another provider?
[2013-12-02 19:34:00 -0500] fnichol: Lolindir: you can do this by calling the Provider's constructor. Each attribute is a method and you can finally call #run_action on it. For example, here's a Template resource being constructed in the runit cookbook: https://github.com/hw-cookbooks/runit/blob/master/libraries/provider_runit_service.rb#L313-L322
[2013-12-02 19:35:55 -0500] Lolindir: Thanks
[2013-12-02 19:38:05 -0500] fveillette: Using registry_key resource how i should format the data value for a type :expand_string key?
[2013-12-02 19:40:49 -0500] Garo__: I'm trying to build a Chef recipe which first calls aws_ebs_volume :create and :attach resources. Then I need to tag the volume. I was planning to use aws_resource_tag, but I need the volume id which aws_ebs_volume sets into node[:aws][...] structure. What's the correct way to build this kind of recipe in which resources need to be chained as they depend on input from another resources output?
[2013-12-02 19:41:34 -0500] CPS: Garo__: look  at the notifies directive
[2013-12-02 19:41:50 -0500] CPS: you can have one resource trigger another
[2013-12-02 19:41:56 -0500] lazypower: I'm having an issue bootstrapping a windows node with knife, the following log output shows that apparently the bootstrap process has a script error? http://pastebin.com/EHjGq2Lk
[2013-12-02 19:43:42 -0500] Garo__: CPS: ok. what about transfering the required attribute? the first resources sets some data in node[:aws][...] which I need as an input in the next one
[2013-12-02 19:44:12 -0500] CPS: you should be able to use node[:aws] to access it as well as set it
[2013-12-02 19:44:25 -0500] fveillette: Using registry_key resource how i should format the data value for a type :expand_string key?
[2013-12-02 19:45:03 -0500] Garo__: CPS: ok. I'll try. thanks!
[2013-12-02 19:49:36 -0500] CPS: i can't find anything helpful for the chef_gem resource
[2013-12-02 19:49:41 -0500] CPS: how do i tell it to use a private gem server?
[2013-12-02 19:50:32 -0500] Garo__: I still haven't got my head fully around the way how the chef recipes first build some kind of runlist from all the resources and then execute them later in order. so far have been learning it the hard way :/
[2013-12-02 19:51:34 -0500] coderanger: CPS: The gem_options param probably
[2013-12-02 19:51:42 -0500] coderanger: CPS: Its not easy to make it work though
[2013-12-02 19:51:56 -0500] coderanger: or rather, not obvious
[2013-12-02 19:52:00 -0500] stormerider: CPS, i think chef_gem supports passing a gemrc same as gem_package, but im not 100% sure
[2013-12-02 19:52:10 -0500] coderanger: chef_gem is a subclass of gem_package
[2013-12-02 19:52:16 -0500] coderanger: anything one supports, the other should as well
[2013-12-02 19:52:23 -0500] coderanger: It just changes the default gem binary
[2013-12-02 19:52:43 -0500] stormerider: ah, cool. i wasnt sure about that since chef_gem is run at compile time, iirc?
[2013-12-02 19:52:58 -0500] coderanger: Yeah, but thats a minor thing
[2013-12-02 19:53:10 -0500] coderanger: the actual gem install code is the same
[2013-12-02 19:53:13 -0500] CPS: very little of that made sense to me
[2013-12-02 19:53:18 -0500] lazypower: And for anyone that runs into my above statement via google - the temporary fix is to set your chef-workstation runtime to 1.9.3-x pending a fix for the 2.0.0 series bug displayed above.
[2013-12-02 19:54:34 -0500] CPS: what's the option for gem install to look at a specific server?
[2013-12-02 19:54:42 -0500] CPS: the man page isn't very clear on that
[2013-12-02 19:55:25 -0500] coderanger: CPS: Isn't it --source?
[2013-12-02 19:55:32 -0500] coderanger: --source URL                 Add URL as a remote source for gems
[2013-12-02 19:55:41 -0500] CPS: is that what the source chef option does?
[2013-12-02 19:56:16 -0500] machadogj: hi, on a fresh ubuntu from ec2, when I run "knife bootstrap IP -i my.pem --ssh-user ubuntu"  it throws "dpkg: error: requested operation requires superuser privilege", any idea why?
[2013-12-02 19:58:07 -0500] stormerider: machadogj, you need to use --sudo, iirc
[2013-12-02 19:59:11 -0500] machadogj: @stormerider, worked, thanks!
[2013-12-02 19:59:23 -0500] CPS: invalid argument --source ip:port
[2013-12-02 19:59:40 -0500] stormerider: machadogj, np, happy to help
[2013-12-02 20:00:06 -0500] surge__: stormerider: I created the file notified ohai to reload, but the reload isn't taking place immediately so the chef run still fails.
[2013-12-02 20:00:07 -0500] coderanger: CPS: It needs to be a URL
[2013-12-02 20:00:18 -0500] CPS: ah
[2013-12-02 20:01:37 -0500] stormerider: surge__, istr the ohai cookbook has some stuff to handle that in the context of the run. i havent gotten that far myself yet, though. on my todo, but got blocked by BF/CM
[2013-12-02 20:01:48 -0500] CPS: oh good, at least now i'm just getting timeouts
[2013-12-02 20:02:12 -0500] btm: @opscode chef/ohai code review, join; https://plus.google.com/hangouts/_/72cpick6qkd9irf1sam44mlg60, watch: http://youtu.be/DsEPS48YCNg
[2013-12-02 20:02:27 -0500] fveillette: Using registry_key resource how i should format the data value for a type :expand_string key?
[2013-12-02 20:07:23 -0500] supercom32: Hey Everyone. When your using an encrypted data bag, where do most of you guys choose to store it? Locally on the filesystem of the node someplace?
[2013-12-02 20:07:37 -0500] supercom32: And if so, how do you normally deploy that shared key to the node?
[2013-12-02 20:09:24 -0500] coderanger: supercom32: Are you using Hosted Chef?
[2013-12-02 20:09:27 -0500] gregkare: I can't remember which version started this, (some 10.x) but can set a path in your knife.rb (encrypted_data_bag_secret), bootstrap will then automatically set up the file
[2013-12-02 20:09:43 -0500] supercom32: gregkare: that sounds neat.
[2013-12-02 20:09:44 -0500] gregkare: You still need to deploy the file to your development machines
[2013-12-02 20:09:52 -0500] supercom32: coderanger: Nope. We host chef ourselves.
[2013-12-02 20:10:10 -0500] coderanger: supercom32: Don't use encrypted data bags
[2013-12-02 20:10:41 -0500] supercom32: coderanger: So running our own chef server means we don't use encrypted data bags? or shouldn't?
[2013-12-02 20:10:47 -0500] gregkare: I'm working in small teams that don't grow so we haven't had to automate that so far, I was thinking about encrypting the data bag secret with GPG, but it assumes everyone uses GPG :)
[2013-12-02 20:11:07 -0500] coderanger: supercom32: It means it probably isn't what you want, what problem are you trying to solve
[2013-12-02 20:11:43 -0500] gregkare: His problem is probably not having stuff like credentials in cleartext in a git repo
[2013-12-02 20:12:24 -0500] coderanger: Yeah, encrypted data bags don't really help there since it just moves the problem to "how do I distribute keys"
[2013-12-02 20:13:16 -0500] spheromak: knife vault has a decent aproach to solving that
[2013-12-02 20:13:48 -0500] gregkare: You also end up forking cookbooks once in a while just to add support for encrypted data bags :/
[2013-12-02 20:16:45 -0500] supercom32: gregkare: right - we definitely don't want passwords to appear in SCM... but we also don't want passwords to be viewable by anyone who can access the chef server web ui
[2013-12-02 20:16:55 -0500] supercom32: spheromak: what's knife vault?
[2013-12-02 20:17:26 -0500] spheromak: https://github.com/Nordstrom/chef-vault
[2013-12-02 20:17:43 -0500] coderanger: supercom32: it is probably what encrypted bags should have been, still has issues but its better at least
[2013-12-02 20:18:54 -0500] coderanger: also you should be aware that even with encrypted data bags or chef-vault, a lot of community cookbooks leak passwords back into the node data so be careful
[2013-12-02 20:19:10 -0500] spheromak: yea
[2013-12-02 20:19:18 -0500] jason123_: Hi!  I am executing "knife role spaghetti" from Git Bash, and it returns "ERROR: TypeError: can't convert nil into String".  Can someone please help?
[2013-12-02 20:19:28 -0500] supercom32: ah
[2013-12-02 20:19:50 -0500] coderanger: supercom32: It turns out safely distributing sensitive data is Very Hard
[2013-12-02 20:20:13 -0500] coderanger: supercom32: We had a session on it at the summit, if you use AWS there is a nice trick with S3 you can use, beyond that its kind of a wreck right now
[2013-12-02 20:20:32 -0500] supercom32: so should I just store my credentials in data bags in plain text and make sure I trust everyone with accounts on the server?
[2013-12-02 20:20:41 -0500] spheromak: coderanger: whats the trick ? just using SG's to controll what nodes can get at some url ?
[2013-12-02 20:20:52 -0500] gregkare: jason123_: Do you have a valid .chef/knife.rb file that sets up the cookbook_path, etc
[2013-12-02 20:20:55 -0500] surge__: stormerider: Had to use the "run_action" method twice, but I got it to work.
[2013-12-02 20:20:59 -0500] coderanger: spheromak: IAM rules based on EC2 SGs
[2013-12-02 20:21:03 -0500] spheromak: supercom32: its worse, because any node could get at
[2013-12-02 20:21:25 -0500] spheromak: coderanger: yea what i meant. IAM  to restrict a SG to a bucket
[2013-12-02 20:21:26 -0500] coderanger: supercom32: So lets rewind a bit, anyone that has access to the webui has root on all your servers
[2013-12-02 20:21:37 -0500] spheromak: thus disable webui
[2013-12-02 20:21:37 -0500] coderanger: supercom32: With Private Chef you can restrict that a bit, but its hard
[2013-12-02 20:21:39 -0500] spheromak: ;)
[2013-12-02 20:22:01 -0500] spheromak: any node can access yer bag, so any client.pem on a node could get at that bag
[2013-12-02 20:22:06 -0500] jason123_: I do.  It works fine for all the other knife command except this one.
[2013-12-02 20:22:10 -0500] supercom32: yeah ok... hmm
[2013-12-02 20:22:13 -0500] spheromak: so the client.pem becomes important to secure.
[2013-12-02 20:22:38 -0500] supercom32: coderanger: I'm using the open source chef - is that different than private chef?
[2013-12-02 20:22:41 -0500] spheromak: as its a private key.  knife vault uses that keys pub info to do encrypted bags, and limits exposure. in that reguard its a bit better.
[2013-12-02 20:22:45 -0500] coderanger: supercom32: Yes, very
[2013-12-02 20:22:46 -0500] spheromak: supercom32: yes
[2013-12-02 20:22:55 -0500] supercom32: hm
[2013-12-02 20:22:59 -0500] coderanger: supercom32: With FOSS chef, all chef admins have root on all your servers and you can't change that
[2013-12-02 20:23:06 -0500] coderanger: supercom32: So you _must_ trust them
[2013-12-02 20:23:21 -0500] jason123_: I read a doc that suggests to add a role_path to the knife.rb, but I don't what path to add.
[2013-12-02 20:23:40 -0500] spheromak: jason123_: the path to the roles
[2013-12-02 20:23:53 -0500] spheromak: jason123_: in yer chef_repo
[2013-12-02 20:24:06 -0500] gregkare: If you don't have roles you probably don't need knife-role-spaghetti
[2013-12-02 20:24:20 -0500] spheromak: :)
[2013-12-02 20:24:25 -0500] supercom32: coderanger: so what do other FOSS users do when they need a password in a recipe?
[2013-12-02 20:24:28 -0500] gregkare: Unless you want to generate an empty image, but there's other options ;)
[2013-12-02 20:25:00 -0500] coderanger: supercom32: Right now I put it in a data bag and wince a little bit, I'll be writing (and releasing) a replacement for that based around S3 and IAM rules soon though
[2013-12-02 20:25:02 -0500] jtimberman: supercom32: use encrypted data bags. we use chef-vault for them.
[2013-12-02 20:25:09 -0500] coderanger: supercom32: That only helps you if you are based on EC2 though
[2013-12-02 20:25:16 -0500] jason123_: I see.  Thanks all!
[2013-12-02 20:25:19 -0500] gregkare: It's pretty hard to do automation without trusting the humans who do the automation...
[2013-12-02 20:25:24 -0500] coderanger: Other than that, chef-vault is your best bet, as long as you don't spin up new servers often
[2013-12-02 20:25:37 -0500] supercom32: yeah we have a private VM infrastructure and EC2 isn't an option
[2013-12-02 20:26:05 -0500] spheromak: supercom32: generally use encrypted bags, we use vault as well.  if you have a big group of people and need rbac consider doing private/enterrise/hosted chef.
[2013-12-02 20:26:13 -0500] coderanger: supercom32: Do you do any kind of autoscaling or rapid provisioning of new hosts?
[2013-12-02 20:26:18 -0500] supercom32: ok, looks like I'll read up on chef-vault some more
[2013-12-02 20:26:36 -0500] supercom32: coderanger: not right now, but we're working on it
[2013-12-02 20:26:59 -0500] coderanger: supercom32: Then be careful, chef-vault is more or less incompatible with autoscaling by design :-/
[2013-12-02 20:27:13 -0500] supercom32: :(
[2013-12-02 20:27:17 -0500] coderanger: supercom32: since it has to know ahead of time what servers need access to the data
[2013-12-02 20:27:20 -0500] macros: coderanger: You said something in passing at the summit about encrypted data bags and not being on hosted was problematic in some way, didn't have a chance to follow up with you on it
[2013-12-02 20:27:40 -0500] coderanger: macros: ^^ :)
[2013-12-02 20:27:48 -0500] coderanger: macros: Basically it solves no problems, just moves them
[2013-12-02 20:28:18 -0500] supercom32: coderanger: oh, I see...
[2013-12-02 20:28:25 -0500] macros: I haven't ssen an approach that doesn't make me weep in some way yet
[2013-12-02 20:29:28 -0500] juliancdunn: at least it moves them into a class of problems that has always existed
[2013-12-02 20:30:12 -0500] coderanger: macros: Basically, this EC2/S3 thing works for me but its just super hand-wavey using Amazon as a trusted third party (with appropriate legal protections if they screw up)
[2013-12-02 20:30:38 -0500] rdobbs: quick question .. i'm trying to uyse a cookbook that uses some sub-optimal defaults, and is generated by a method inside of an LWRP. that method fails and causes my chef run to fail, so I'm trying to figure out a way to prevent that, like inserting a code-block into the method call within the lwrp?
[2013-12-02 20:30:39 -0500] coderanger: macros: There is an openstack proposal for doing TTP stuffs, but I forget the name
[2013-12-02 20:31:25 -0500] rdobbs: (essentially it stupidly looks for roles to specify servers in a configuration file)
[2013-12-02 20:31:58 -0500] rdobbs: I can overwrite that configuration file with a template, but only after the lwrp runs, causing it to fail.
[2013-12-02 20:33:17 -0500] rdobbs: so I guess my queston is is there a hack to fix this in a reecipe, or do I need to fork and improve the cookbook?
[2013-12-02 20:34:24 -0500] coderanger: macros: My hope is to move this from a problem of secrets mgmt to one of identity mgmt, issue each server an identity (probably SSL pair) and use that to auth all stuff it has to access
[2013-12-02 20:35:39 -0500] mattray: coderanger: barbican?
[2013-12-02 20:35:44 -0500] macros: coderanger: We've been moving towards per server ssl certs as well, just haven't come up with a way to make the work flow not suck
[2013-12-02 20:35:48 -0500] coderanger: mattray: thats the one
[2013-12-02 20:35:56 -0500] coderanger: macros: Pretty much
[2013-12-02 20:36:00 -0500] mattray: or ztrustee for commercial
[2013-12-02 20:36:32 -0500] macros: coderanger: Even more pain when you toss in TPM hardware and stupid key formats
[2013-12-02 20:36:59 -0500] coderanger: macros: Also some stuff I still have no idea how to secure, like zookeeper/etcd
[2013-12-02 20:37:07 -0500] daw13: Has anyone run the iis_config resource from within a ruby_block resource?
[2013-12-02 20:37:13 -0500] coderanger: macros: I think those will require TTP negotiations no matter what
[2013-12-02 20:37:32 -0500] coderanger: daw13: You can't (normally) run resources inside a ruby_block
[2013-12-02 20:38:00 -0500] daw13: Is it possible to pass variables to and from the ruby_block resource
[2013-12-02 20:38:12 -0500] coderanger: daw13: Again, "not really"
[2013-12-02 20:38:27 -0500] coderanger: Thats not how Chef generally works, you probably want to make an LWRP, not a ruby_block
[2013-12-02 20:38:37 -0500] coderanger: resources are nouns, not verbs
[2013-12-02 20:43:23 -0500] daw13: I'm installing an app with one recipe which the 2nd recipe uses but since it was straight ruby code outside of a resource, it was running before the 1st recipe.  This led me to the ruby_block
[2013-12-02 20:43:49 -0500] daw13: but this won't work either if I can't run a resource of pass variables
[2013-12-02 20:43:59 -0500] coderanger: Just run them in the right order?
[2013-12-02 20:53:20 -0500] jchauncey: daw13: you could try using notifies
[2013-12-02 20:58:04 -0500] CPS: daw13: you can have ruby statements inside resources
[2013-12-02 20:58:34 -0500] CPS: if you need to set a string or something
[2013-12-02 21:04:24 -0500] daw13: CPS: Ah, that may work
[2013-12-02 21:04:58 -0500] programmerq: so, it appears that application_php has support for composer: https://github.com/poise/application_php/blob/master/libraries/php_framework.rb#L22-40
[2013-12-02 21:05:05 -0500] programmerq: I'm just not quite sure how to get it to work.
[2013-12-02 21:06:02 -0500] programmerq: https://github.com/poise/application_php/#usage basically, I added "composer true" to the spot in this first example that's right after local_settings_file
[2013-12-02 21:06:16 -0500] programmerq: I never get any of the info log messages that appear in libraries/php_framework.
[2013-12-02 21:06:28 -0500] daw13: CPS: Basically I'm using a the appcmd iis command to build an array to pass to the iis_config resource.
[2013-12-02 21:07:05 -0500] programmerq: unfortunately, application_php doesn't appear to have any unit tests, so I don't know what examples I could work off.
[2013-12-02 21:13:17 -0500] miah: most of the chef cookbooks lack unit tests
[2013-12-02 21:28:20 -0500] coderanger: programmerq: Sorry, the php and java ones were built by someone else so I don't know them as well
[2013-12-02 21:28:29 -0500] programmerq: coderanger: hmmm, ok
[2013-12-02 21:28:43 -0500] benjohnson77_: was wondering is I can ask a couple question about going from vagrant testing to "bootstrapping"
[2013-12-02 21:28:50 -0500] programmerq: is it anyone that frequents here? or would I be better off doing a better write-up of my problem, and hitting up the mailing list?
[2013-12-02 21:28:51 -0500] coderanger: benjohnson77_: Always
[2013-12-02 21:28:54 -0500] coderanger: miah: hiiiiiiii
[2013-12-02 21:30:41 -0500] benjohnson77_: I want to user a private chef server also but wrote my recipe with berkshelf ... love it ... I installed knife-ec2 ... is this the best way
[2013-12-02 21:33:11 -0500] benjohnson77_: coderanger: bascially im asking if going from vagrant provision with berkshelf to knife bootstrap is the right move or if its not really the berkshelf way
[2013-12-02 21:33:22 -0500] coderanger: benjohnson77_: Seems fine to me
[2013-12-02 21:33:33 -0500] coderanger: benjohnson77_: vagrant+berks+solo locally for dev
[2013-12-02 21:33:39 -0500] coderanger: and then release to the chef server for prod
[2013-12-02 21:34:07 -0500] benjohnson77_: coderanger: will i need every get the chef-repo
[2013-12-02 21:34:14 -0500] benjohnson77_: ever*
[2013-12-02 21:34:22 -0500] coderanger: In The Berkshelf Way there is no single chef-repo
[2013-12-02 21:34:35 -0500] coderanger: each cookbook lives in its own repo and is its own project
[2013-12-02 21:35:15 -0500] benjohnson77_: right, im loving it ... after doing the "chef-repo" approach I will never go back
[2013-12-02 21:35:40 -0500] benjohnson77_: just learning how the server interacts with the berkshelf project that I have working with vagrant
[2013-12-02 21:35:43 -0500] coderanger: Sometimes you'll still have a little vestigial chef repo for a few shared things, like knife configs
[2013-12-02 21:35:49 -0500] coderanger: and maybe some data bags
[2013-12-02 21:38:32 -0500] benjohnson77_: yes .. databags is exactly the question, do you just through the data_bags dir into the root berkshelf recipe project
[2013-12-02 21:40:43 -0500] programmerq: benjohnson77_: I wouldn't put data bags in a cookbook, if that's what you're asking.
[2013-12-02 21:40:59 -0500] programmerq: the idea behind data bags is that it's a way to get input into a cookbook, so they are generally stored separately.
[2013-12-02 21:41:14 -0500] programmerq: I'm still using a chef_repo with separate git repos per cookbook, and I definitely use berkshelf.
[2013-12-02 21:41:47 -0500] programmerq: I do have some data bags checked in to my cookbook, but they are minimalist data bags that are used only during my test-kitchen runs
[2013-12-02 21:44:07 -0500] benjohnson77_: ok ... thats what I'm wondering ... since I want to use chef server ... should I have a chef-repo to work with the sever, but use berkself to work with cookbooks ... or can I have a single berkshelf project and for go the chef-repo all together.
[2013-12-02 21:53:46 -0500] cannonball: Is it permitted to do LWRP inside of a cookbooks/my_cookbook/libraries/my_libs.rb file?  It seems like not, but am not 100% sure either way.
[2013-12-02 21:54:31 -0500] flaccid__: where can i read more about what is happening with opscode cookbooks in terms of ownership and maintainence?
[2013-12-02 21:55:00 -0500] juliancdunn: flaccid__: it's on the blog
[2013-12-02 21:55:10 -0500] flaccid__: juliancdunn: cheers
[2013-12-02 21:55:58 -0500] flaccid__: oh i have read that already. i was just wondering what is going to happen with particular cookbooks, for example openvpn
[2013-12-02 21:56:49 -0500] juliancdunn: are you interested in taking it? :)
[2013-12-02 21:57:15 -0500] flaccid__: juliancdunn: sure
[2013-12-02 21:57:37 -0500] juliancdunn: ok - get in touch with Sean -- someara@opscode.com
[2013-12-02 21:58:00 -0500] flaccid__: juliancdunn: is this the standard process?
[2013-12-02 21:58:37 -0500] juliancdunn: it is for now -- we should probably mention that somewhere
[2013-12-02 21:58:53 -0500] flaccid__: yep there is currently 100 cookbooks in flux :)
[2013-12-02 22:00:02 -0500] juliancdunn: indeed
[2013-12-02 22:00:08 -0500] juliancdunn: there's also a Wiki page where some of this work is happening - https://wiki.opscode.com/display/chef/Community+Cookbook+Diversification
[2013-12-02 22:00:29 -0500] juliancdunn: you can also get in touch with btm who can advise you more on the process
[2013-12-02 22:00:58 -0500] cheflevelramen: anyone from opscode able to shine light on the status of this bug: https://tickets.opscode.com/browse/COOK-4004
[2013-12-02 22:01:21 -0500] flaccid__: i see
[2013-12-02 22:01:36 -0500] flaccid__: btm: can you please show me the process :)
[2013-12-02 22:01:42 -0500] cheflevelramen: it's a breaking bug in the application cookbook. That cookbook seems to nolonger work.
[2013-12-02 22:02:06 -0500] cwj: cheflevelramen: are you using opsworks by chance?
[2013-12-02 22:02:33 -0500] cheflevelramen: cwj: nope, just aws ec2 and chef
[2013-12-02 22:02:40 -0500] cwj: ok, just curious
[2013-12-02 22:03:09 -0500] juliancdunn: cheflevelramen: iirc the application cookbook was divested to coderanger, perhaps he can shed light
[2013-12-02 22:03:11 -0500] flaccid__: cheflevelramen: no in poise with coderanger
[2013-12-02 22:03:22 -0500] flaccid__: *now
[2013-12-02 22:04:36 -0500] cheflevelramen: flaccid: ah, okay. Happen to know if he's in irc today?
[2013-12-02 22:05:36 -0500] flaccid__: cheflevelramen: he is here, but i don't know if he is available
[2013-12-02 22:05:37 -0500] cheflevelramen: by the way, what's this new poise organization? Is it where opscode employees will publish cookbooks from? I know opscode said they are transitioning to cookbooks being support by the community instead of by opscode
[2013-12-02 22:06:01 -0500] flaccid__: cheflevelramen: http://www.opscode.com/blog/2013/11/26/community-cookbooks/  https://wiki.opscode.com/display/chef/Community+Cookbook+Diversification
[2013-12-02 22:06:03 -0500] juliancdunn: cheflevelramen: "poise" is coderanger's org
[2013-12-02 22:06:13 -0500] juliancdunn: people who take on the cookbooks are free to put them under any namespace
[2013-12-02 22:06:16 -0500] juliancdunn: (in GitHub)
[2013-12-02 22:06:45 -0500] cheflevelramen: juliancdunn: oh cool. Noticed a number of cookbooks were moving to poise. That makes sense
[2013-12-02 22:06:55 -0500] flaccid__: i recommend that chef should use a system like arch linux' AUR
[2013-12-02 22:09:40 -0500] coderanger: cheflevelramen: Back, whats up
[2013-12-02 22:10:33 -0500] cheflevelramen: coderanger: Hey, just sent you an email actually
[2013-12-02 22:11:00 -0500] cheflevelramen: coderanger: the application cookbook seems to have been broken for a week or two now due to COOK-4004
[2013-12-02 22:11:04 -0500] cheflevelramen: coderanger: https://tickets.opscode.com/browse/COOK-4004
[2013-12-02 22:11:47 -0500] cheflevelramen: coderanger: I was hoping you could shed some light on when it might be fixed.
[2013-12-02 22:12:05 -0500] coderanger: Looking
[2013-12-02 22:12:29 -0500] cheflevelramen: coderanger: awesome thanks. They've been bugging me at work about it :)
[2013-12-02 22:12:34 -0500] coderanger: cheflevelramen: Can you please provide a full stack trace?
[2013-12-02 22:12:42 -0500] cheflevelramen: coderanger: sure
[2013-12-02 22:13:48 -0500] cheflevelramen: coderanger: http://pastebin.com/bLgqqYAu
[2013-12-02 22:14:29 -0500] coderanger: cheflevelramen: Thats still just the pretty trace, the full one is in /var/chef/cache/chef-stacktrace.out
[2013-12-02 22:14:55 -0500] coderanger: Chef tries to trim the stack trace to only "cookbook code" but my stuff tends to break those filters :)
[2013-12-02 22:15:06 -0500] cheflevelramen: coderanger: oh okay. Let me grab that
[2013-12-02 22:15:46 -0500] cwj: mfaulise: perhaps you should show coderanger the stacktrace you sent me
[2013-12-02 22:15:54 -0500] cwj: i think it is the same issue
[2013-12-02 22:16:13 -0500] cheflevelramen: cwj: yep, its in the ticket I posted
[2013-12-02 22:16:15 -0500] cheflevelramen: coderanger: http://pastebin.com/0Hq86TZE
[2013-12-02 22:16:36 -0500] cheflevelramen: coderanger: that looks to be a search issue due to running in vagrant. Let me run it again on a server and get you the output
[2013-12-02 22:16:44 -0500] fveillette: Using registry_key resource how i should format the data value for a type :expand_string key?
[2013-12-02 22:16:51 -0500] coderanger: cheflevelramen: That doesn't look like a traceback related to me
[2013-12-02 22:18:19 -0500] cheflevelramen: coderanger: yep, sorry. Here you go: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.6.0/lib/chef/application.rb
[2013-12-02 22:18:25 -0500] cheflevelramen: http://pastebin.com/yTrEVcY5
[2013-12-02 22:18:55 -0500] coderanger: cheflevelramen: Whats your recipe code look like?
[2013-12-02 22:19:06 -0500] cheflevelramen: coderanger:
[2013-12-02 22:19:06 -0500] cheflevelramen: http://pastebin.com/tLuva4K1
[2013-12-02 22:19:23 -0500] cheflevelramen: coderanger: pretty vanilla. Just used an example from the readme
[2013-12-02 22:20:12 -0500] cheflevelramen: coderanger: Other info: CentOS 6.4, Chef 11.8, Ruby 2.0.0
[2013-12-02 22:20:40 -0500] coderanger: cheflevelramen: Looks like a bug in the passenger_apache2 provider, I can probably fix it in a jif
[2013-12-02 22:20:53 -0500] cheflevelramen: coderanger: awesome, thanks so much
[2013-12-02 22:20:55 -0500] coderanger: method scoping: an thing
[2013-12-02 22:21:00 -0500] cwj: coderanger: https://gist.github.com/mfaulise/7756192 is a stacktrace trying to deploy https://github.com/needle-cookbooks/chef-localshop
[2013-12-02 22:21:45 -0500] coderanger: Yeah, it looks like the execution scopes on deploy resource callbacks changed at some point
[2013-12-02 22:21:59 -0500] coderanger: damn is the code crufty
[2013-12-02 22:22:32 -0500] mfaulise: cwj: thanks, i was away for a bit, coderanger, let me know if you have any questions
[2013-12-02 22:24:36 -0500] coderanger: cheflevelramen: https://github.com/poise/application_ruby/commit/298118b6a40159586548f577d7bfa25846bba328
[2013-12-02 22:24:43 -0500] coderanger: cheflevelramen: Can you try the new "scopefix" branch?
[2013-12-02 22:25:31 -0500] cheflevelramen: coderanger: sure give me a min to test it
[2013-12-02 22:25:31 -0500] coderanger: Will probably need a similar change to the gunicorn provider for mfaulise
[2013-12-02 22:26:13 -0500] coderanger: cheflevelramen: https://github.com/poise/application_ruby/pull/42 created to track it
[2013-12-02 22:27:25 -0500] wdilly: you can apply multiple roles to a node correct?
[2013-12-02 22:27:33 -0500] coderanger: wdilly: Sure, any number
[2013-12-02 22:28:19 -0500] wdilly: bootstrap -r [role1,role2]      or     bootstrap -r[role1] -r [role2] ?
[2013-12-02 22:28:57 -0500] coderanger: -r 'role[role1],role[role2]'
[2013-12-02 22:30:49 -0500] wdilly: jiggy, thanks
[2013-12-02 22:36:41 -0500] robinpc: quick question (newbie) -- need some features from a newer knife ec2 gem.  How to just update the gem on a workstation/server combo?
[2013-12-02 22:44:55 -0500] coderanger: robinpc: gem install --upgrade knife-ec2?
[2013-12-02 22:49:29 -0500] robinpc: Thanks coderanger ... some concerns about upgrading unknown dependencies, but makes sense
[2013-12-02 22:49:52 -0500] coderanger: robinpc: The server doesn't use Ruby and is unrelated to your client install
[2013-12-02 22:50:22 -0500] robinpc: So knife may be at risk, but not the server!
[2013-12-02 22:58:21 -0500] miah: coderanger: hi
[2013-12-02 23:00:37 -0500] cheflevelramen: coderanger: It looks like I'm getting the same error: http://pastebin.com/ChhhMeXh
[2013-12-02 23:01:25 -0500] coderanger: cheflevelramen: Your line numbers didn't change, it isn't using the new code
[2013-12-02 23:01:35 -0500] cheflevelramen: coderanger: This may be silly, but maybe I'm doing it wrong. I've updated my berks file to specify the ref to the github cookbook commit, uninstalled application_ruby from berkshelf and then destroyed my vm. Then I ran vagrant up
[2013-12-02 23:01:37 -0500] coderanger: (if it was the same error, it would be on line 39 now)
[2013-12-02 23:01:54 -0500] coderanger: You need to berks install still to update the lockfile
[2013-12-02 23:02:11 -0500] cheflevelramen: coderanger: hmm, did that too
[2013-12-02 23:02:31 -0500] coderanger: What does the line in the berksfile look like now?
[2013-12-02 23:02:40 -0500] cheflevelramen: coderanger: cookbook 'application_ruby', git: 'https://github.com/poise/application_ruby.git',       ref: '298118b6a40159586548f577d7bfa25846bba328'
[2013-12-02 23:04:12 -0500] coderanger: seems sane, though I would use the branch name
[2013-12-02 23:04:38 -0500] cheflevelramen: coderanger: I'll try that
[2013-12-02 23:05:00 -0500] coderanger: Make sure the lockfile looks correct too
[2013-12-02 23:11:00 -0500] cheflevelramen: coderanger: looks like it worked. http://pastebin.com/frVCFBSn
[2013-12-02 23:12:43 -0500] cheflevelramen: coderanger: thanks for all the help. Really appreciate it.
[2013-12-02 23:13:02 -0500] coderanger: cheflevelramen: Woot, will push buttan in a second
[2013-12-02 23:13:06 -0500] coderanger: yelling at jenkins
[2013-12-02 23:13:24 -0500] coderanger: I need to get a few intro to security books and send them to the whole jenkins team
[2013-12-02 23:13:41 -0500] robawt: coderanger: uh oh
[2013-12-02 23:13:59 -0500] robawt: no I did not just join for the fireworks show
[2013-12-02 23:15:40 -0500] coderanger: robawt: I think no one uses JNLP slaves with authentication-required jenkins
[2013-12-02 23:53:38 -0500] joelteon: this is happening on chef runs: "NoMethodError: user[ssanders] (/var/chef/cache/cookbooks/users/providers/manage.rb line 85) had an error: NoMethodError: undefined method `sp_pwdp' for nil:NilClass"
[2013-12-02 23:53:43 -0500] joelteon: what would cause that? the backtrace is useless
[2013-12-02 23:54:26 -0500] flaccid__: whats the code?
[2013-12-02 23:56:03 -0500] joelteon: i don't know
[2013-12-02 23:56:13 -0500] flaccid__: you may like to get it :)
