[2013-08-02 00:00:45 -0400] coderanger: Some people prefer them in node attributes because it is one less character
[2013-08-02 00:01:01 -0400] coderanger: we still recommend the string format just because it is clearer to non-Ruby-devs
[2013-08-02 00:01:41 -0400] yfeldblum: dgarstang, ruby -e 'puts :dgarstang.object_id'
[2013-08-02 00:02:11 -0400] yfeldblum: dgarstang, that's the actual number that is the index into the symbol table
[2013-08-02 00:03:04 -0400] dgarstang: yfeldblum: sorry, no idea. I'll get to reading about that when I get past 5.times in the book.
[2013-08-02 00:03:28 -0400] coderanger: Anyways
[2013-08-02 00:03:41 -0400] coderanger: You can consider node[:foo] the same as node['foo']
[2013-08-02 00:03:52 -0400] dgarstang: coderanger: good with that
[2013-08-02 00:04:08 -0400] miah: and node[:foo][:bar] the same as node[foo_bar] in some circumstances =)
[2013-08-02 00:05:05 -0400] miah: guh. i wish vagrant-omnibus would cache the omnibus download
[2013-08-02 00:05:06 -0400] coderanger: miah: Only in search queries
[2013-08-02 00:05:13 -0400] miah: coderanger: ya :/
[2013-08-02 00:05:51 -0400] coderanger: miah: Plz can haz something better than solr for searching nested trees :-(
[2013-08-02 00:05:53 -0400] yfeldblum: lucene query syntax for data as indexed by chef-server's indexer =/= ruby syntax for drilling down a hash tree
[2013-08-02 00:06:11 -0400] coderanger: Yeah, impedance gap at work
[2013-08-02 00:06:34 -0400] coderanger: We really need to either find or build a better search engine, but thats a huuuuuge project
[2013-08-02 00:06:54 -0400] coderanger: elasticsearch might help at least go back to not using a single facet
[2013-08-02 00:07:11 -0400] coderanger: but it still doesn't grok nested hashes itself
[2013-08-02 00:08:36 -0400] yfeldblum: or figure out a better method for flattening the keys in an index, and also at the same time figure out a good domain-specific query language which can easily be converted to the lucene query that would work over the data as-indexed?
[2013-08-02 00:09:50 -0400] Shankar: thanks .. that worked
[2013-08-02 00:11:05 -0400] GreatSUN: coderanger: when it comes to node[:foo][:bar] I know it is working with 'foo' and 'bar'
[2013-08-02 00:11:17 -0400] GreatSUN: is this the same for action :create?
[2013-08-02 00:11:25 -0400] GreatSUN: (as an example)
[2013-08-02 00:11:27 -0400] coderanger: Not sure what you mean
[2013-08-02 00:11:40 -0400] GreatSUN: would action 'create' work, too?
[2013-08-02 00:12:14 -0400] troyready: btw, appreciate the symbols overview earlier. I didn't really have any idea why there where two syntaxes before :)
[2013-08-02 00:12:47 -0400] coderanger: GreatSUN: Yes, https://github.com/opscode/chef/blob/master/lib/chef/resource.rb#L341
[2013-08-02 00:12:54 -0400] GreatSUN: kk
[2013-08-02 00:12:55 -0400] coderanger: GreatSUN: We just convert it to a sym for you
[2013-08-02 00:13:15 -0400] GreatSUN: but it should be :create
[2013-08-02 00:13:19 -0400] GreatSUN: though
[2013-08-02 00:13:26 -0400] coderanger: similarly node['foo'] is actually the native format
[2013-08-02 00:13:32 -0400] coderanger: https://github.com/opscode/chef/blob/master/lib/chef/mash.rb#L206
[2013-08-02 00:13:39 -0400] coderanger: It just calls #to_s for you
[2013-08-02 00:13:51 -0400] GreatSUN: yeah
[2013-08-02 00:14:17 -0400] GreatSUN: so for mashes 'key' and for resources :action
[2013-08-02 00:14:56 -0400] GreatSUN: thanks for this update
[2013-08-02 00:18:50 -0400] GreatSUN: coderanger: btw. I dont remember if you answered my question upon this helper stuff yesterday
[2013-08-02 00:19:35 -0400] GreatSUN: coderanger: would there be an interest to have this kind of "libraryset" at opscode git?
[2013-08-02 00:21:08 -0400] coderanger: Not sure which question you mean
[2013-08-02 00:22:20 -0400] GreatSUN: coderanger: I have build up some libraries for different functionalities like move a logfile before executing a command and then checking for a string to come up in logfile before continuing
[2013-08-02 00:22:40 -0400] coderanger: That sounds very not idempotent
[2013-08-02 00:22:43 -0400] GreatSUN: coderanger: or this interactive execution all OS independent
[2013-08-02 00:23:50 -0400] coderanger: You would need to make a case that a huge proportion of users need this functionality before we would be interested in moving it upstream
[2013-08-02 00:23:52 -0400] GreatSUN: coderanger: surely no basis stuff
[2013-08-02 00:24:09 -0400] GreatSUN: coderanger: all java service users
[2013-08-02 00:24:10 -0400] coderanger: Not saying thats impossible, but it certainly sounds like this belongs in your own cookbook
[2013-08-02 00:24:35 -0400] GreatSUN: coderanger: cause java services always need some time to come up before they react on something
[2013-08-02 00:24:38 -0400] coderanger: But put it up on github and get people using it :-)
[2013-08-02 00:24:44 -0400] GreatSUN: and if you need to have some communication
[2013-08-02 00:24:45 -0400] coderanger: If people use it, that means it is good
[2013-08-02 00:25:28 -0400] GreatSUN: coderanger: I will have to ask, if that is ok, if I do, just wanted to know, if there is some interest to have it shared on your side
[2013-08-02 00:26:11 -0400] coderanger: "No"
[2013-08-02 00:26:16 -0400] coderanger: because thats just the default answer
[2013-08-02 00:26:23 -0400] GreatSUN: coderanger: lol
[2013-08-02 00:26:33 -0400] coderanger: :)
[2013-08-02 00:26:58 -0400] coderanger: There is nothing special about our cookbooks, if yours is awesome just publish it yourself, no need to involve us
[2013-08-02 00:27:22 -0400] GreatSUN: coderanger: I know
[2013-08-02 00:27:31 -0400] GreatSUN: the base of everything is share
[2013-08-02 00:27:43 -0400] GreatSUN: then documentation
[2013-08-02 00:27:45 -0400] GreatSUN: then google
[2013-08-02 00:27:46 -0400] GreatSUN: :D
[2013-08-02 00:28:55 -0400] GreatSUN: ah coderanger btw
[2013-08-02 00:29:28 -0400] GreatSUN: do you have any recommendation onto some monitoring software?
[2013-08-02 00:29:45 -0400] coderanger: My current stack is collectd -> reimann -> graphite
[2013-08-02 00:29:54 -0400] coderanger: hoping to add Data Dog in there too
[2013-08-02 00:36:38 -0400] GreatSUN: coderanger: hmm yes, sounds nice, but for me I would prefer some solution more of kind out of the box
[2013-08-02 00:36:55 -0400] GreatSUN: like agent/server with autodiscovery of services
[2013-08-02 00:37:06 -0400] coderanger: Sensu is probably the best I know of thats single package
[2013-08-02 00:37:10 -0400] GreatSUN: and automated alerting or such
[2013-08-02 00:37:46 -0400] GreatSUN: is there already some cookbook for sensu?
[2013-08-02 00:38:03 -0400] coderanger: Yep, they ship one
[2013-08-02 00:38:27 -0400] GreatSUN: ah ok :-)
[2013-08-02 00:38:32 -0400] GreatSUN: sounds good
[2013-08-02 00:38:47 -0400] GreatSUN: for the moment we have hyperic running
[2013-08-02 00:39:46 -0400] a13x212: is it possible to run a cookbook with chef-client?
[2013-08-02 00:39:49 -0400] GreatSUN: but since the guys implemented a cookbook which is nearly not dynamic, it is kind of a pain in the ass
[2013-08-02 00:39:59 -0400] coderanger: a13x212: yes?
[2013-08-02 00:40:13 -0400] coderanger: GreatSUN: Sensu was built from the ground up to be chef/puppet friendly
[2013-08-02 00:40:20 -0400] a13x212: i'm trying this: chef-client -o yum['epel']
[2013-08-02 00:40:38 -0400] coderanger: a13x212: yum::epel
[2013-08-02 00:40:43 -0400] GreatSUN: coderanger: :-)
[2013-08-02 00:40:56 -0400] GreatSUN: thanks for sharing that information
[2013-08-02 00:41:21 -0400] a13x212: and multiple repos like: yum::epel yum::remi ?
[2013-08-02 00:41:22 -0400] coderanger: GreatSUN: Definitely check out reimann though, if you can survive the clojure it is crazy pwoerful
[2013-08-02 00:41:23 -0400] GreatSUN: I will finish for the day and take some rest
[2013-08-02 00:41:35 -0400] coderanger: a13x212: If thats what the recipes are called, sure
[2013-08-02 00:41:48 -0400] a13x212: great thanks
[2013-08-02 00:41:53 -0400] GreatSUN: coderanger: if I was free and it was my own solution, I would surely use it
[2013-08-02 00:42:06 -0400] GreatSUN: but it's not the laste day for me
[2013-08-02 00:42:14 -0400] coderanger: a13x212: And in a run list that needs to be recipe[yum::epel]]
[2013-08-02 00:42:21 -0400] coderanger: GreatSUN: It is free :)
[2013-08-02 00:42:24 -0400] GreatSUN: so I might come up with some devel for the implementation
[2013-08-02 00:42:29 -0400] coderanger: I don't even think about non-free software anymore
[2013-08-02 00:42:42 -0400] GreatSUN: coderanger: for me this is a pleasure
[2013-08-02 00:42:50 -0400] GreatSUN: but not all managers thing that way
[2013-08-02 00:43:21 -0400] GreatSUN: there are a lot that ask about "support" and dont trust opensource solutions
[2013-08-02 00:43:38 -0400] coderanger: Support is less of a worry when you just know the authors of everything
[2013-08-02 00:43:50 -0400] GreatSUN: its sometimes easier to get money for microsoft than for a support-contract for open source
[2013-08-02 00:44:05 -0400] GreatSUN: coderanger: no discussion for me
[2013-08-02 00:44:12 -0400] GreatSUN: coderanger: I am totally with you
[2013-08-02 00:44:51 -0400] GreatSUN: coderanger: I love slacky for example
[2013-08-02 00:45:33 -0400] GreatSUN: for my private stuff, I am using nothing else, building up everything from source is kinda the best thing for me
[2013-08-02 00:46:01 -0400] GreatSUN: cause it is MY CHOICE what to support, what should be installed and how and all this
[2013-08-02 00:46:45 -0400] GreatSUN: anyways
[2013-08-02 00:46:51 -0400] GreatSUN: I have to get some sleep
[2013-08-02 00:47:04 -0400] GreatSUN: coderanger: talk to ya laters
[2013-08-02 00:47:10 -0400] coderanger: lat0rz
[2013-08-02 00:47:17 -0400] GreatSUN: l33t!
[2013-08-02 01:07:20 -0400] j^2: any rails devs have a few mins to pair on what i'm assuming is a dumb but probably easy issue to try to debug?
[2013-08-02 01:07:51 -0400] j^2: i can spin up a tmate session; and i just need to figure out why i cant connect to a db
[2013-08-02 01:07:57 -0400] j^2: (not chef directly related)
[2013-08-02 01:09:17 -0400] Chammmmm: Hi... My template file as an actual <%@ .. that should be printed it.. but its considered code by erb.. I tried escaping and it does not seem to work
[2013-08-02 01:09:20 -0400] Chammmmm: any idea
[2013-08-02 01:10:59 -0400] coderanger: Chammmmm: <%%
[2013-08-02 01:14:21 -0400] Shankar: Need some help on the following - I need to figure out the region my aws instance is running on & give that as a parameter to a subsequent command in my chef recipe
[2013-08-02 01:14:39 -0400] Shankar: any pointers on how to get it done ?
[2013-08-02 01:14:53 -0400] Shankar: I know how to figure out hte region
[2013-08-02 01:15:40 -0400] Shankar: wget  -q http://169.254.169.254/latest/dynamic/instance-identity/document/ |  grep region | cut -d":" -f2 | sed 's/"//g' | sed 's/,//g
[2013-08-02 01:15:52 -0400] Shankar: I can execute that as a command
[2013-08-02 01:16:04 -0400] Shankar: but how do I get the result ?
[2013-08-02 01:16:41 -0400] coderanger: Shankar: execute "whatever #{node['ec2']['placement_availability_zone']"
[2013-08-02 01:17:31 -0400] coderanger: I guess thats the AZ not the region
[2013-08-02 01:17:35 -0400] coderanger: So just remove the last char
[2013-08-02 01:17:36 -0400] Shankar: coderanger: does #{node['ec2']['placement_availability_zone'] get populated with the region automatically ?
[2013-08-02 01:17:47 -0400] coderanger: Shankar: Yes, its coming from ohai
[2013-08-02 01:17:47 -0400] Chammmmm: Can I scape <% in erb file?
[2013-08-02 01:17:53 -0400] Chammmmm: escape*
[2013-08-02 01:17:54 -0400] coderanger: Chammmmm: Yes, <%%
[2013-08-02 01:18:05 -0400] Chammmmm: coderanger: Thanks much!!
[2013-08-02 01:19:35 -0400] coderanger: Shankar: node['ec2']['placement_availability_zone'].chop would give you the region
[2013-08-02 01:19:52 -0400] mveitas: Are there any good tools/projects out there to assist with uploading things like roles, environments, etc to a Chef server? Example, developer pushed a change to an environment to Git and wants it uploaded to Chef Server automatically (maybe after some tests are run)
[2013-08-02 01:20:14 -0400] Shankar: thanks coderanger ! I will try that out
[2013-08-02 01:21:02 -0400] coderanger: mveitas: https://github.com/coderanger/chef-jenkins-example/blob/master/cookbooks/jenkins-example/templates/default/job.xml.erb#L58
[2013-08-02 01:22:03 -0400] mveitas: well sh%t. I might just have to peruse through your GitHub stuff a bit!!
[2013-08-02 01:22:32 -0400] coderanger: mveitas: That example isn't 100% finished, but it should point you in the right direction
[2013-08-02 01:24:39 -0400] mveitas: Another question, any word on when "push" changes down to a node is coming?
[2013-08-02 01:26:07 -0400] coderanger: mveitas: Pushy is still under heavy flux internally, so no ETA
[2013-08-02 01:26:46 -0400] coderanger: mveitas: You can ask your OPC Sales person if you want to get notified when we have alpha/beta code ready
[2013-08-02 01:27:49 -0400] mveitas: coderanger: Sorry to be "pushy" haha.   I had heard about it from Mandi when I took an intro class in Boston last fall that it was being thought about
[2013-08-02 01:29:21 -0400] coderanger: Its being tested out internally, plan is to use it in house for a while before we release a beta to OPC users
[2013-08-02 01:29:31 -0400] coderanger: mveitas: And open source release is a while down the line
[2013-08-02 01:31:40 -0400] mveitas: Can a node have more than one chef-client run? Meaning I might want one run to execute every 15 minutes while another might only be every 12 hrs
[2013-08-02 01:31:57 -0400] EricL: This seems like the wrong behavior for Chef search: http://pastebin.com/ygZCnsfD
[2013-08-02 01:32:30 -0400] EricL: Shouldn't it be searching all roles assigned to the machine and not just the highest level role?
[2013-08-02 01:32:35 -0400] coderanger: mveitas: Maybe, it would be hard to hook up though
[2013-08-02 01:32:48 -0400] coderanger: mveitas: and you would have to be super careful about race conditions
[2013-08-02 01:33:15 -0400] coderanger: mveitas: Probably better to wrap your every-12-hours recipes in some code to just make them only activate when needed/wanted
[2013-08-02 01:33:29 -0400] mveitas: Cron inside the code :)
[2013-08-02 01:33:35 -0400] coderanger: EricL: Use roles:foo
[2013-08-02 01:33:40 -0400] coderanger: EricL: instead of role:foo
[2013-08-02 01:33:56 -0400] coderanger: mveitas: Basically, check out the apt recipe for an example
[2013-08-02 01:34:17 -0400] EricL: coderanger: Arg, should have been able to figure that out on my own.  What's the difference to Solr?
[2013-08-02 01:34:18 -0400] coderanger: mveitas: Uses the mtime on a file to only run once a day I think
[2013-08-02 01:34:35 -0400] coderanger: EricL: Long story, but role: and recipe: only check the top level of the run list
[2013-08-02 01:34:44 -0400] mveitas: I remember just seeing that thanks!
[2013-08-02 01:34:47 -0400] coderanger: whereas roles and recipes checks recursively
[2013-08-02 01:35:10 -0400] EricL: coderanger: Ok. Fair enough.  I have a heavy solr infrastructure.  So I know how easy it is to dig yourself into holes with it.
[2013-08-02 01:35:28 -0400] coderanger: EricL: node['roles'] and node['recipes'] are real node attrs created during the chef run, role: and recipe: are just synthesized when the node is being dumped into Solr
[2013-08-02 01:35:45 -0400] coderanger: So they look similar but come from very different places
[2013-08-02 01:36:09 -0400] EricL: That makes sense.  Search searches everything I take it?
[2013-08-02 01:37:24 -0400] coderanger: Yeah, they are all just facets (well sort of, we actually use a single facet and some weird transforms, but ignore that)
[2013-08-02 01:37:58 -0400] EricL: Gotchya.  I have a very love/hate relationship with Solr as I think is the common feeling.
[2013-08-02 01:38:04 -0400] coderanger: See, the further you go down the rabbit hole, the weirder it gets ;-)
[2013-08-02 01:38:11 -0400] coderanger: So one important side effect
[2013-08-02 01:38:29 -0400] coderanger: roles/recipes are updated in solr as soon as you edit the run list on the node, because they are expanded server side
[2013-08-02 01:38:30 -0400] EricL: Call me Alice.
[2013-08-02 01:38:39 -0400] coderanger: er crap, got that backwards
[2013-08-02 01:38:45 -0400] coderanger: role/recipe, the shallow ones
[2013-08-02 01:38:48 -0400] coderanger: those are updated immediately
[2013-08-02 01:39:21 -0400] coderanger: roles/recipes (the deep ones) are created within chef client, so they only show up in search results after the first successful chef-client run after you change the run list
[2013-08-02 01:39:36 -0400] coderanger: or if you call node.save within a recipe or handler
[2013-08-02 01:39:39 -0400] coderanger: but you shouldn't do that
[2013-08-02 01:40:09 -0400] coderanger: I should probably write up a blog post on all this
[2013-08-02 01:40:52 -0400] coderanger: if you use role:foo, all you know is that it is in the run list
[2013-08-02 01:41:02 -0400] coderanger: roles:foo is therefore usually what you want
[2013-08-02 01:41:13 -0400] coderanger: even if you don't need the recursive expansion
[2013-08-02 01:41:26 -0400] EricL: Ok. Roles is definitely want I want though.  The expansion is important for this use/case.
[2013-08-02 01:41:52 -0400] coderanger: since unless you do silly things with node.save, roles:foo will only return things that have successfully completed a chef-client run that includes role foo
[2013-08-02 01:42:11 -0400] EricL: Yep.  I try not to do silly things like that.
[2013-08-02 01:44:13 -0400] Chammmmm: I have a weird error that the template resource does not find the parent directory and fail.. but it actually exist.. the directory contains ##... might it be the issue? Any ideas?
[2013-08-02 01:45:16 -0400] EricL: Chammmmm: Is this running not as root and are the permissions such that the directory can be "seen" by that user?
[2013-08-02 01:45:25 -0400] coderanger: Chammmmm: Can you pastebin the recipe code?
[2013-08-02 01:45:58 -0400] Chammmmm: EricL: Maybe.... I will double check.. coderange: sure
[2013-08-02 01:47:15 -0400] Chammmmm: http://pastebin.com/5egRTT73
[2013-08-02 01:47:57 -0400] Chammmmm: oops
[2013-08-02 01:47:58 -0400] Chammmmm: one sec
[2013-08-02 01:48:00 -0400] Chammmmm: will repaste
[2013-08-02 01:50:11 -0400] Chammmmm: http://pastebin.com/nTTKx8E5
[2013-08-02 01:50:48 -0400] coderanger: Chammmmm: Ahh, skip the \s
[2013-08-02 01:50:55 -0400] coderanger: # itself isn't a metacharacter
[2013-08-02 01:51:22 -0400] coderanger: Though actually Ruby should fix that for you
[2013-08-02 01:51:24 -0400] coderanger: so thats not it
[2013-08-02 01:51:36 -0400] coderanger: But still worth knowing :)
[2013-08-02 01:52:03 -0400] Chammmmm: actually it fixed it
[2013-08-02 01:52:09 -0400] Chammmmm: and thanks.. I learned something today :0
[2013-08-02 01:52:20 -0400] Chammmmm: ah nm
[2013-08-02 01:52:26 -0400] coderanger: # is only meta if the next char is {
[2013-08-02 01:52:26 -0400] Chammmmm: didnt fix it.. talked too fast lol
[2013-08-02 01:52:28 -0400] coderanger: but hmm
[2013-08-02 01:52:35 -0400] coderanger: Whats the output of "stat /var/blabla/ROOT##010"
[2013-08-02 01:54:18 -0400] Chammmmm: http://pastebin.com/pZFsau0y
[2013-08-02 01:54:56 -0400] coderanger: hmm looks sane
[2013-08-02 01:55:22 -0400] rayrod2030: is there any way to get all cookbook names running in a particular chef run from the node attributes?  I'm looking for all cookbooks running not just the runlist.
[2013-08-02 01:56:06 -0400] coderanger: Chammmmm: I don't see anything obviously wrong there
[2013-08-02 01:56:30 -0400] Chammmmm: coderanger: hmm you think it might be a chef bug with directories containing #?
[2013-08-02 01:56:51 -0400] Chammmmm: I will continue investigating
[2013-08-02 01:58:21 -0400] coderanger: Chammmmm: I just tried File.exists? and it worked
[2013-08-02 01:58:34 -0400] Chammmmm: ok... hmmm
[2013-08-02 01:58:38 -0400] Chammmmm: 11.6.0?
[2013-08-02 01:58:57 -0400] coderanger: rayrod2030: node['recipes'].map{|s| s.split('::').first}
[2013-08-02 02:00:36 -0400] coderanger: Chammmmm: Thats the latest version if thats what you are asking
[2013-08-02 02:00:43 -0400] rayrod2030: coderanger: thank you
[2013-08-02 02:00:44 -0400] Chammmmm: ok
[2013-08-02 02:01:29 -0400] Chammmmm: Ok found it
[2013-08-02 02:01:41 -0400] Chammmmm: put a 5 seconds sleep before and it worked
[2013-08-02 02:03:41 -0400] Chammmmm: ahhhh
[2013-08-02 02:03:44 -0400] Chammmmm: im stupid..
[2013-08-02 02:03:59 -0400] Chammmmm: the war file takes a few second to tomcat to deploy and create the subfolder
[2013-08-02 02:10:38 -0400] Chammmmm: will fix that.. thanks again for you help coderanger
[2013-08-02 02:31:20 -0400] supershabam: Could anybody code review my very first chef cookbook? Hoping to learn to be a good chef. http://github.com/supershabam/nodejs-cookbook
[2013-08-02 02:32:29 -0400] coderanger: supershabam: So first thing, Ruby generally uses two space indents
[2013-08-02 02:32:57 -0400] coderanger: Second you need some kind of guard so it doesn't execute every time
[2013-08-02 02:34:00 -0400] supershabam: would checking that node is installed and at the desired version a proper guard
[2013-08-02 02:34:01 -0400] supershabam: ?
[2013-08-02 02:34:17 -0400] coderanger: supershabam: Yep, just need to figure out the best way to do that
[2013-08-02 02:35:09 -0400] coderanger: Check out https://github.com/mdxp/nodejs-cookbook for ideas
[2013-08-02 02:37:28 -0400] supershabam: coderanger: thanks for the feedback! Helps me learn what to look for when using other's cookbooks too.
[2013-08-02 02:50:21 -0400] mveitas: @coderanger. should you Jenkins job example have /opt/chef/bin/knife upload . --freeze --no-force
[2013-08-02 02:50:28 -0400] mveitas: your . is at the end
[2013-08-02 02:54:48 -0400] coderanger: mveitas: I don't think it matters
[2013-08-02 03:03:18 -0400] mveitas: If I have changes in my local chef_repo in the roles or enviorment, doing a knife diff should show that, correct?
[2013-08-02 03:05:08 -0400] coderanger: mveitas: If you use the json format, yes
[2013-08-02 03:05:22 -0400] coderanger: knife-essentials doesn't grok the .rb DSLs for either yet
[2013-08-02 03:05:26 -0400] Chammmmm: Any reason why a while loop in a lwrp would be executed first even if its at the end?
[2013-08-02 03:05:41 -0400] coderanger: Chammmmm: The end of what?
[2013-08-02 03:06:00 -0400] coderanger: Chammmmm: Oh, you probably are hitting a compile vs execute confusion
[2013-08-02 03:06:07 -0400] coderanger: Chammmmm: Remember that even LWRPs are two-pass
[2013-08-02 03:06:09 -0400] Chammmmm: end of the code.. after all the executes.. just before the end of the "action"
[2013-08-02 03:06:12 -0400] mveitas: that would explain why I am not getting any output!!!
[2013-08-02 03:06:29 -0400] Chammmmm: Oh ok coderanger
[2013-08-02 03:07:21 -0400] Chammmmm: oh ok cool
[2013-08-02 03:07:27 -0400] Chammmmm: so just put into rublock_block ?
[2013-08-02 03:07:33 -0400] coderanger: Probably, yes
[2013-08-02 03:07:40 -0400] Chammmmm: ok thanks
[2013-08-02 03:07:47 -0400] coderanger: Or rewrite the other resources to execute in-line :)
[2013-08-02 03:07:50 -0400] mveitas: is a ticket the appropriate place to put in a request to fix the docs to clearly state that it is only for json? I guess i will move my environments and roles to use json for now
[2013-08-02 03:09:09 -0400] coderanger: mveitas: Probably, knife-essentials is kind of a weird limbo thing, it was started externally but we're trying to use it to rethink the knife UX
[2013-08-02 03:09:17 -0400] coderanger: mveitas: So we're kind of in a transitional time
[2013-08-02 03:09:36 -0400] coderanger: mveitas: It is still a gem, but we also include some bits of it in chef
[2013-08-02 03:11:55 -0400] mveitas: good to know, so it sounds like I should just switch to json format and things will work for the time being
[2013-08-02 03:14:19 -0400] coderanger: Yeah
[2013-08-02 03:14:40 -0400] coderanger: I know john wants to add rb dsl support, just hasn't happened yet
[2013-08-02 03:15:07 -0400] coderanger: probably because for reasons as yet unknown to me, there is a lot of dislike of that format within opscode (knife-essentials was written for internal use originally)
[2013-08-02 03:16:45 -0400] mveitas: json is kind of a more universal format
[2013-08-02 03:20:49 -0400] coderanger: If you didn't have to include the rubbish chef_type and json_class keys, I would be much more conciliatory
[2013-08-02 03:20:58 -0400] coderanger: though I think knife-essentials might have actually fixe that
[2013-08-02 06:21:27 -0400] teukka: fyi: knife-solo v0.3.0 released: https://github.com/matschaffer/knife-solo/blob/master/CHANGELOG.md
[2013-08-02 07:28:15 -0400] arussel: I'm using chef 11.4.2 trying the mongodb cookbook on ubuntu 12.4. I've got this error back: Chef::Exceptions::CookbookNotFound: Cookbook yum not found.
[2013-08-02 07:32:03 -0400] m4rcu5: afaik the new way of installing chef client is with the omnibus package, but has anyone got it to work on freebsd yet?
[2013-08-02 07:58:47 -0400] arussel: I'm having this error installing mongod on ubuntu: STDERR: /etc/init.d/mongodb: 48: ulimit: Illegal option -u
[2013-08-02 08:04:04 -0400] kav_: can anyone please advise for tripwire cookbooks
[2013-08-02 08:20:31 -0400] fishGoM00: m4rcu5 : other distros can be updated using curl and running install.sh
[2013-08-02 08:20:35 -0400] fishGoM00: m4rcu5 : http://www.opscode.com/chef/install/
[2013-08-02 08:20:44 -0400] fishGoM00: m4rcu5 : nothing appears when selecting freebsd however :/
[2013-08-02 08:23:13 -0400] m4rcu5: fishGoM00: yes, thats why im asking ;)
[2013-08-02 08:23:33 -0400] m4rcu5: the install.sh isnt running either on FreeBSD 9.1
[2013-08-02 08:45:17 -0400] aspiers: how do we get to the ticketing system or wiki now? http://www.opscode.com/blog/2013/08/01/security-breach-user-information-for-tickets-opscode-com-and-wiki-opscode-com-compromised/#comment-984973591
[2013-08-02 08:45:52 -0400] aspiers: this has already affected at least 15 people ...
[2013-08-02 08:50:41 -0400] teukka: m4rcu5: I remember seeing some mails on the mailing lists about adding freebsd support to the omnibus installer. I think it is coming at some point
[2013-08-02 08:51:13 -0400] teukka: m4rcu5: yeah, here: http://lists.opscode.com/sympa/arc/chef-dev/2013-03/msg00027.html
[2013-08-02 09:04:46 -0400] m4rcu5: teukka: thanks, i hope its coming soon!
[2013-08-02 09:06:22 -0400] bigbigbang: Ohai there ! Just questionning my self about the hack that happened ... Is the security breach present in Chef Open source too ?
[2013-08-02 09:06:47 -0400] perryofpeek: no, just the wiki and ticket system
[2013-08-02 09:06:58 -0400] perryofpeek: 3rd party tools
[2013-08-02 09:09:13 -0400] bigbigbang: ok thanks
[2013-08-02 09:29:34 -0400] arussel: how do you copy a directory from one place to the other ?
[2013-08-02 09:30:04 -0400] arussel: both being local
[2013-08-02 09:32:37 -0400] bcave: good morning all
[2013-08-02 09:33:26 -0400] bcave: has anyone here ever configured knife using chef?
[2013-08-02 09:40:46 -0400] m4rcu5: what is the current correct way of installing chef on freebsd or is there a wat to get a new omnibus installer running there?
[2013-08-02 09:49:32 -0400] lewiz: I'm creating a list of packages to install on my Ubuntu machines.  I have some 10.04 and 12.04 machines and the packages do not exactly match (e.g. git-core on 10.04 and git on 12.04).  What's the best way to handle this?
[2013-08-02 09:49:53 -0400] lewiz: (I have already fixed it... but it's not so tidy so I'm looking for a concise, clean implementation)
[2013-08-02 10:54:40 -0400] bcave: i have a question about permissions & chef clients....
[2013-08-02 10:55:12 -0400] bcave: i have a validator client, and then a user.
[2013-08-02 10:57:59 -0400] bcave: with my user, i have permissions to access resources on the chef server (via knife). assuming authorization is controlled through users and groups for that
[2013-08-02 11:00:31 -0400] bcave: if I register a chef client with the chef server, it only has limited access
[2013-08-02 11:01:00 -0400] bcave: where / how is the access to create / delete etc controlled ?
[2013-08-02 11:20:16 -0400] arussel: I'm running into: " Chef::Exceptions::Exec: apt-get -q -y install openjdk-6-jdk=6b24-1.11.4-1ubuntu0.12.04.1 returned 100, expected 0"
[2013-08-02 11:20:27 -0400] arussel: when trying to use the java cookbook
[2013-08-02 11:27:23 -0400] zts: arussel: that probably means you need to run 'apt-get update'.  If you put the apt cookbook on your run list (recipe[apt]), that'll take care of it for you
[2013-08-02 11:30:16 -0400] bcave: that doesnt always resolve it in the correct order though. i had to use include_recipe "apt"
[2013-08-02 11:36:39 -0400] zts: bcave: well, it'll deal with it it in the order that you declare it - but yes, good point.  Using include_recipe to ensure it runs before your package resource is one way of doing it, otherwise you will need to ensure it appears in the expanded run_list before your recipe
[2013-08-02 11:37:02 -0400] arussel: zts: that did it, thanks
[2013-08-02 11:40:07 -0400] bcave: zts, maybe you could assist with a problem of order of execution (i know theres an issue in the bug tracker around it)
[2013-08-02 11:41:06 -0400] arussel: btw, if someone has a mongodb cookbook that works on ubuntu, I'd love to have it.
[2013-08-02 11:41:51 -0400] bcave: arussel - theres some on the 10gen site
[2013-08-02 11:42:17 -0400] bcave: what environment are you wanting to set up on
[2013-08-02 11:43:21 -0400] bcave: wait sorry, I was thinking of their cloudformation template, not the cookbook. Theres a community cookbook. it can do sharded & replica set setups, but gets a bit tricky with identifying nodes
[2013-08-02 11:43:54 -0400] arussel: bcave: it also doesn't install a plain mongodb out of the box.
[2013-08-02 11:44:48 -0400] bcave: if you add recipe mongodb::10gen_repo it will set up the repo
[2013-08-02 11:45:18 -0400] arussel: if you patch it, yes
[2013-08-02 11:46:00 -0400] bcave: patch it with ?
[2013-08-02 11:46:02 -0400] arussel: and even patch, I still haven't figure out why it tries to restart and fail because it is already started
[2013-08-02 11:46:29 -0400] arussel: I needed to add this: https://github.com/jamesonjlee/chef-mongodb/commit/99d8307d4abb50841f14ca12f2e776f7209892dc
[2013-08-02 11:47:49 -0400] arussel: and I think I'm running into this: https://github.com/edelight/chef-mongodb/issues/86
[2013-08-02 11:48:39 -0400] bcave: ah, ok
[2013-08-02 11:48:43 -0400] bcave: what platform ?
[2013-08-02 11:49:09 -0400] arussel: it makes it so painfull to work with chef, it reminds me of maven beta 2. Where maven itself was pretty ok, but none of the plugin worked.
[2013-08-02 11:49:20 -0400] arussel: ubuntu 12.04
[2013-08-02 11:50:35 -0400] bcave: hahaha. true. it does. strange, ive used the mongodb cookbook to install and start a standalone instance without patching
[2013-08-02 11:50:43 -0400] bcave: on ubuntu 12
[2013-08-02 12:44:36 -0400] l33_: hrllo
[2013-08-02 12:44:38 -0400] l33_: Hello.
[2013-08-02 12:45:43 -0400] l33_: I am trying to move attribute to a environment not sure how o write it
[2013-08-02 12:45:59 -0400] l33_: default['logstash']['agent']['server_ipaddress'] = ''" here is the attribute
[2013-08-02 13:13:28 -0400] adamjk-dev: l33_: http://docs.opscode.com/essentials_environments.html
[2013-08-02 13:51:06 -0400] l33_: That helpped I think...
[2013-08-02 13:51:22 -0400] l33_: override_attributes(logstash' => {'agent' => { 'server_ipaddress' => '0.0.0.0' }})
[2013-08-02 13:51:43 -0400] l33_: But it is not overrideing still. is my syntax wrong?
[2013-08-02 14:01:27 -0400] eherot: is there a variable I can refer to inside a recipe that refers to "this_cookbook?"
[2013-08-02 14:09:47 -0400] zts: eherot1: cookbook_name
[2013-08-02 14:10:23 -0400] eherot1: just cookbook_name?  no node.cookbook_name or anything?
[2013-08-02 14:10:31 -0400] eherot1: ^ zts
[2013-08-02 14:11:11 -0400] zts: eherot1: yeah, just cookbook_name
[2013-08-02 14:11:37 -0400] zts: eherot1: http://docs.opscode.com/chef/dsl_recipe.html#cookbook-name
[2013-08-02 14:13:30 -0400] eherot1: < lose one point for not checking the dsl ;-)
[2013-08-02 14:14:31 -0400] l33_: : I am trying to move attribute to a environment not sure how o write it
[2013-08-02 14:14:55 -0400] l33_: default_attributes(:logstash => {:agent => { :server_ipaddress => 'localhost' }})
[2013-08-02 14:15:04 -0400] l33_: That is right...right?
[2013-08-02 14:15:28 -0400] yfeldblum: why would a node have a cookbook_name ?
[2013-08-02 14:15:50 -0400] eherot1: yfeldblum: it wouldn'tI was just giving an example.  local variable seemed weird for some reason
[2013-08-02 14:16:21 -0400] yfeldblum: eherot1, it's a method
[2013-08-02 14:16:23 -0400] eherot1: though i suppose it could be a method name.
[2013-08-02 14:16:27 -0400] yfeldblum: eherot1, on Chef::Recipe
[2013-08-02 14:16:32 -0400] eherot1: yeah I always forget that's also possible in Ruby
[2013-08-02 14:17:00 -0400] yfeldblum: eherot1, each recipe is instance_eval'd in the context of an instance of Chef::Recipe
[2013-08-02 14:18:07 -0400] eherot1: yfeldblum: yeah, makes sense once I think about it.  It's just that not many things I do in recipes are referenced by straight method names (with no object.method business going on), except for the standard code blocks of course
[2013-08-02 14:18:16 -0400] eherot1: (meaning resources that is)
[2013-08-02 14:18:36 -0400] yfeldblum: eherot1, value_for_platform
[2013-08-02 14:18:43 -0400] yfeldblum: eherot1, node
[2013-08-02 14:18:51 -0400] yfeldblum: eherot1, search
[2013-08-02 14:19:03 -0400] yfeldblum: eherot1, data_bag_item
[2013-08-02 14:19:09 -0400] yfeldblum: eherot1, there are plenty of these methods
[2013-08-02 14:19:19 -0400] eherot1: yfeldblum: yeah I know.  But usually I don't use those in notation as if they are just variables (i.e. "your #{name} here")
[2013-08-02 14:19:27 -0400] eherot1: I'm still getting used to this ruby thing :-P
[2013-08-02 14:20:30 -0400] eherot1: I fully admit that this was due to my own failure to mentally abstract things correctly
[2013-08-02 14:22:09 -0400] d4m: G'day, I am receiving a error decrypting a data bag that isn't encrypted from the knife command line client, 'wrong final block length', any idea as to why knife is attempting to decrypt when I am not specifying a -s or --secret-file?
[2013-08-02 14:24:29 -0400] eherot1: d4m: that may be a connection stream error on the connection to the chef server, rather than a data bag decryption error...
[2013-08-02 14:24:47 -0400] eherot1: admittedly i'm speculating
[2013-08-02 14:24:54 -0400] eherot1: someone else here may know better
[2013-08-02 14:25:05 -0400] freerobby: Hi, I have a best practices question.
[2013-08-02 14:25:10 -0400] freerobby: I am writing a cookbook that depends on MySQL
[2013-08-02 14:25:23 -0400] freerobby: There are certain node['mysql'][] attirubtes I need to set defaults for
[2013-08-02 14:25:30 -0400] freerobby: Should I do that ain the attributes.rb of my cookbook, or in my recipe?
[2013-08-02 14:25:44 -0400] freerobby: I know I would use attributes for my cookbooks' attributes, but I haven't seen people use that for setting third party attributes
[2013-08-02 14:25:46 -0400] yfeldblum: eherot1, tcp has checksums and tls has cryptochecksums
[2013-08-02 14:26:02 -0400] d4m: eherot1: interesting...
[2013-08-02 14:26:25 -0400] yfeldblum: d4m, you may have a secret_file specified in your knife.rb
[2013-08-02 14:27:13 -0400] d4m: yfeldblum: yes, that was it, ty.  weird, i don't remember that causing a problem previously.
[2013-08-02 14:27:15 -0400] perryofpeek: freerobby: I like to use attributes.rb , because it makes it easier to override and to see what's going on , but that is just a personal pref
[2013-08-02 14:28:45 -0400] yfeldblum: freerobby, you should do that in your recipe, not in your attributes file
[2013-08-02 14:29:18 -0400] yfeldblum: freeformz, your attributes file is designed for settings defaults for your cookbook, not for other cookbooks
[2013-08-02 14:29:22 -0400] perryofpeek: yfeldblum: why do you suggest that approach?
[2013-08-02 14:30:53 -0400] yfeldblum: perryofpeek, attributes files are limited in the programmatic control over attributes that they offer
[2013-08-02 14:32:03 -0400] freerobby: yfeldblum: Thank you very much.
[2013-08-02 14:32:45 -0400] freerobby: perryofpeek: Thanks for the feedback as well, though I'll be yielding to yfeldblum's advice
[2013-08-02 14:32:50 -0400] perryofpeek: yfeldblum:  from the docs (One approach is to set attributes at the same precedence level by setting attributes in a cookbooks attribute files, and then also setting the same default attributes (but with different values) using a role)
[2013-08-02 14:33:16 -0400] perryofpeek: fi you use a cookbook as a role , then does this still apply in your opinion?
[2013-08-02 14:33:48 -0400] yfeldblum: perryofpeek, the *recipe* would serve the function of a role there, not the cookbook as a whole which is more like a collection of roles
[2013-08-02 14:34:58 -0400] l33_: Okay I defined a override_attributes in my environment and it is not overriding...any ideas?
[2013-08-02 14:35:16 -0400] perryofpeek: yfeldblum: humm, gota have a think about that, interesting input.
[2013-08-02 14:38:52 -0400] m4rcu5: hhmm, just installed a FreeBSD 9.1 one box with the rubygem-chef from the ports, is this the recommended way to go for freebsd boxes?
[2013-08-02 14:41:48 -0400] m4rcu5: yfeldblum: do me a personal opinion then ;)
[2013-08-02 14:44:29 -0400] yfeldblum: m4rcu5, heh that would require some knowledge of the BSDs
[2013-08-02 14:46:28 -0400] techminer: How do I tell chefs "apt-package" to upgrade a package that is marked as "kept back"?
[2013-08-02 14:50:20 -0400] shennyg: I'm trying to install apache2 mod_acitons and cannot find a recipe that includes it. The ultimate goal is getting apache & php-fpm working. any suggestions?
[2013-08-02 14:50:59 -0400] d```: m4rcu5: in general, the Chef dudes recommend installing using the "omnibus" installer
[2013-08-02 14:51:07 -0400] d```: but I don't think one exists for FreeBSD
[2013-08-02 14:51:35 -0400] d```: installing using gem install is probably going to get you the most up to date client
[2013-08-02 14:51:49 -0400] d```: the port seems to fall behind revisions pretty quickly
[2013-08-02 14:52:29 -0400] eliklein: hi, just trying to validate that encrypted_data_bag_item is just another way of saying Chef::EncryptedDataBagItem.load? I'd look at the tickets or wiki, but...
[2013-08-02 14:53:47 -0400] shennyg: here is the error and cookbook partial: https://gist.github.com/shennyg/b4023576392a49907390
[2013-08-02 14:56:02 -0400] yfeldblum: eliklein, i'm not sure i see the method encrypted_data_bag_item anywhere
[2013-08-02 14:56:31 -0400] EricL: Is the only way to search for all nodes with a specific attribute to do a "partial search"?
[2013-08-02 14:58:16 -0400] tubbo: hey guys, i'm trying to debug this issue i've been getting when running `gem install rubygems-update -v=1.3.6` with chef
[2013-08-02 14:58:36 -0400] tubbo: my problem is i'm on a 1.8.7 box and it's trying to hit http://gems.rubyforge.org as a source, which does not seem to be accessible
[2013-08-02 14:59:04 -0400] tubbo: so i tried the following two solutions but both of them threw the same error: "ERROR: http://gems.rubyforge.org is not a valid source"
[2013-08-02 14:59:09 -0400] tubbo: https://gist.github.com/tubbo/f29702c94773ab5d44b5
[2013-08-02 14:59:16 -0400] eliklein: yfeldblum: it works in a chefspec run, but i haven't converged yet via test kitchen or standard methods.  i'll give it a shot :)
[2013-08-02 15:06:14 -0400] eliklein: yfeldblum: CHEF-2522 hints at it's creation, but it's not resolved and I'm only able to look at google cache :)
[2013-08-02 15:15:09 -0400] prometheanfire: so, I still can't reset my tickets.opscode.com account...
[2013-08-02 15:33:49 -0400] jgood: Hey all, say I have a new attribute, with a collection of sub-attributes {"addresses": {"this_address":"/opt/folder", "that_address":"/var/folder", ..... } } is there a way that I can do a for loop going through the addresses underneath the main "addresses"?
[2013-08-02 15:34:53 -0400] jgood: like a node[:addresses][key] do |key|
[2013-08-02 15:35:05 -0400] jgood: or something similar, i'm sure I have the syntax wrong
[2013-08-02 15:41:57 -0400] runfromnowhere: jgood: Hold on one sec and I can help
[2013-08-02 15:42:38 -0400] runfromnowhere: So if you have a hash where the target of the keys are more hashes you can un-nest things pretty easily in Ruby
[2013-08-02 15:43:24 -0400] runfromnowhere: You can use "hash.each_key { |key| print key }" to print all the keys of the outer hash
[2013-08-02 15:44:02 -0400] runfromnowhere: The equivalent of what you were writing would be "node[:addresses].each_key do |key| print key end"
[2013-08-02 15:44:15 -0400] jgood: runfromnowhere: awesome, i knew there was something like that, but I didn't know what to search for. thank you very much
[2013-08-02 15:44:38 -0400] runfromnowhere: jgood: There are also other iterators that can be useful like "each_value" which passes the values into the function, and "each pair" which lets you get at both with |key, value|
[2013-08-02 15:44:49 -0400] runfromnowhere: Oops that's each_pair
[2013-08-02 15:44:51 -0400] runfromnowhere: No spaces :)
[2013-08-02 15:45:45 -0400] yfeldblum: for a hash, `each` is the same as `each_pair`
[2013-08-02 15:46:10 -0400] yfeldblum: there's also each_key, but you can also use `the_hash.keys.each`
[2013-08-02 15:46:57 -0400] jgood: runfromnowhere, yfeldblum: thanks for the help
[2013-08-02 15:47:11 -0400] runfromnowhere: No problem.  Heh Ruby's pretty cool, there's lots of useful ways to do things :)
[2013-08-02 15:48:31 -0400] jgood: yeah, i keep finding out more quick useful tricks. pretty soon i'm heading back to school where i have a class in it. i'm pretty psyched
[2013-08-02 15:48:37 -0400] freerobby: yfeldblum: Do you have any idea why, when I deploy this recipe, the "tickr" service never receives a restart? https://github.com/wistia/chef-tickr/blob/master/recipes/default.rb
[2013-08-02 15:48:51 -0400] freerobby: I have it subscribed to the application and I have the application notifying it.
[2013-08-02 15:50:03 -0400] yfeldblum: freerobby, don't know
[2013-08-02 15:53:06 -0400] freerobby: yfeldblum: thanks anyway
[2013-08-02 15:53:28 -0400] jperry: ohai folks
[2013-08-02 15:53:53 -0400] jperry: does anyone know where I can find documentation on the compatibility between chef10 clients and a chef11 server?
[2013-08-02 15:54:07 -0400] jperry: we are on chef10 and were looking to upgrade and want to know all the issues we may run into
[2013-08-02 15:54:18 -0400] juliancdunn: freerobby: you only need the notifies
[2013-08-02 15:54:22 -0400] jperry: and what needs to happen, ie. what clients nee to be upgraded
[2013-08-02 15:54:31 -0400] juliancdunn: freerobby: also, check if the application resource is changing state. if it doesn't, it'll never notify
[2013-08-02 15:54:49 -0400] d```: jperry: I think that opscode upgraded their servers to Erchef before the chef11 client was out, so I'd guess it's safe
[2013-08-02 15:55:18 -0400] juliancdunn: jperry: we just talked about that yesterday in here, I believe coderanger had a few pointers
[2013-08-02 15:55:27 -0400] juliancdunn: search the IRC logs from the community site
[2013-08-02 15:55:37 -0400] juliancdunn: (and yes, we need to improve our docs on this :) )
[2013-08-02 15:55:53 -0400] jperry: thx julian, I'll take a look
[2013-08-02 15:58:01 -0400] yfeldblum: jperry, it's generally safe, so far as i can tell
[2013-08-02 15:59:06 -0400] jperry: thx yfeldblum, the only thing I have seen so far is relating to encrypted data bags where if you have a client older than 10.18 and it is using encrypted data bags it needs to be upgraded at least to >= 10.18
[2013-08-02 15:59:23 -0400] yfeldblum: jperry, that's not got anything to do with upgrading the server
[2013-08-02 15:59:45 -0400] yfeldblum: jperry, the server isn't the thing that encrypts or decrypts data-bag items; that's purely client-side and knife-side (knife is a kind of client)
[2013-08-02 16:01:31 -0400] jperry: oh actually I think I misread it.  If I encrypt a data bag on my machine with chef 11.x a client 10.16.x will not be able to read it
[2013-08-02 16:01:52 -0400] yfeldblum: jperry, that's right
[2013-08-02 16:02:07 -0400] yfeldblum: jperry, there may be a flag you can use, but maybe not
[2013-08-02 16:02:23 -0400] jperry: cool, at least we would have to be careful what folks are using and what we have out there
[2013-08-02 16:02:29 -0400] jperry: I'll check into the flag though
[2013-08-02 16:02:30 -0400] jperry: thx
[2013-08-02 16:09:58 -0400] zrankfappa: hi all
[2013-08-02 16:10:45 -0400] aramus_: Hello, is there a way to force recipes to run only after one is finished? For example, recipe1 outputs text to a file and recipe2 checks the file for a specific string. For some reason, recipe2 always returns false when I run recipe1 and recipe2 in a run-list.
[2013-08-02 16:11:09 -0400] aramus_: However, when I run recipe2 again in a different command from recipe1, it returns true.
[2013-08-02 16:11:24 -0400] zrankfappa: anyone about who is familiar with ec2 plugin for knife? the --bootstrap-proxy option isn't working for me
[2013-08-02 16:12:13 -0400] zrankfappa: I also have knife[:bootstrap_proxy] = 'http://10.0.1.20:3128' in my knife.rb but it didn't make any diff
[2013-08-02 16:14:58 -0400] yfeldblum: aramus_, http://docs.opscode.com/essentials_nodes_chef_run.html
[2013-08-02 16:15:15 -0400] zrankfappa: i guess everyone is down the pub
[2013-08-02 16:15:25 -0400] yfeldblum: aramus_, recipes declare resources, but resources are not immediately run
[2013-08-02 16:15:56 -0400] yfeldblum: aramus_, only after *all* of the recipes have finished running, chef looks at the list of all resources that have been declared in all the recipes, and finally runs each resource
[2013-08-02 16:16:37 -0400] aramus_: I see. So is there no way to force recipe2 to only run aftr recipe1 runs?
[2013-08-02 16:16:42 -0400] yfeldblum: aramus_, when your recipe1 "outputs text to a file", i assume it's actually declaring a resource which will be run later; and that when recipe2 "checks the file", it's reading the file immediately rather than declaring a resource
[2013-08-02 16:17:10 -0400] aramus_: Well, it
[2013-08-02 16:17:35 -0400] aramus_: they're both literally ruby_blocks. Recipe1 writes text to a file and Recipe2 is another ruby_block that checks it for a specific string.
[2013-08-02 16:18:01 -0400] yfeldblum: aramus_, gist?
[2013-08-02 16:18:46 -0400] d```: what is the chef log level that will log in line with your recipe
[2013-08-02 16:19:21 -0400] d```: I have a bunch of informational messages that I'm logging with Chef::Log.info() but that seems to log everything before the chef run is actually executing actions
[2013-08-02 16:19:21 -0400] aramus_: yfeldblum: Well, it's recipe1 is ruby_block that calls a bash script that outputs text to a file. And recipe2 is another ruby_block that uses regex to parse for a specific string.
[2013-08-02 16:19:25 -0400] yfeldblum: d```, what do you mean by "in line with"?
[2013-08-02 16:19:42 -0400] yfeldblum: d```, those lines are logged at the moment the ruby code is being executed
[2013-08-02 16:19:49 -0400] aramus_: d, try using log "log something"
[2013-08-02 16:19:56 -0400] yfeldblum: d```, which is generally how one might want logging to work
[2013-08-02 16:20:09 -0400] yfeldblum: aramus_, gist?
[2013-08-02 16:20:54 -0400] d```: yfeldblum: I have an execute block that installs python requirements in a virtualenv, and the first line is "Chef::Log.info("Installing using requirements file:)
[2013-08-02 16:21:18 -0400] d```: but I see the log entry WAAAAAY at the top of the log, and then the actual execution waaaay at the bottom
[2013-08-02 16:21:20 -0400] aramus_: yfeldblum, are you asking for the gist of the situation or does that mean something else in this situation?
[2013-08-02 16:21:35 -0400] aramus_: yfeldblum, because I feel like I just gave you a pretty good gist of that situation.
[2013-08-02 16:21:38 -0400] yfeldblum: d```, you may *declare a log resource* which will be added to the resources collection, and then during the convergence, chef will execute that log resource in its place in the resources collection
[2013-08-02 16:21:49 -0400] yfeldblum: aramus_, https://gist.github.com/
[2013-08-02 16:22:26 -0400] yfeldblum: aramus_, i am asking for a concrete example of the code that you're having an issue with
[2013-08-02 16:22:41 -0400] yfeldblum: aramus_, gist is a popular vehicle for these kinds of examples
[2013-08-02 16:22:44 -0400] d```: yfeldblum: so I should stop using Chef::Log and start just using the log resource?
[2013-08-02 16:23:11 -0400] yfeldblum: d```, you may try that and see if it works for you
[2013-08-02 16:25:11 -0400] aramus_: yfeldblum: https://gist.github.com/joshualan/9c2aac059ea6254d6e18
[2013-08-02 16:28:58 -0400] yfeldblum: aramus_, ah
[2013-08-02 16:30:59 -0400] aramus_: yfeldblum: Am I doing something wrong?
[2013-08-02 16:32:56 -0400] yfeldblum: aramus_, the use of `and` :D ... but that's not related
[2013-08-02 16:35:06 -0400] aramus_: yfeldblum, it seems this is just the way chef is implemented thats causing this turmoil.
[2013-08-02 16:36:05 -0400] aramus_: yfeldblum: since they're in different recipes, i can't use the notifies attribute so aside from knife-ing each recipe individually I don't see a fix to this.
[2013-08-02 16:40:39 -0400] suffix_: is it possible to pass a variable into a chef recipe?
[2013-08-02 16:41:38 -0400] randomautomator: has anyone else here tried using the new etag feature for remote_file?
[2013-08-02 16:41:47 -0400] randomautomator: i can't get it to behave
[2013-08-02 16:42:05 -0400] randomautomator: etag on the webserver is changing but chef doesn't recognize the change and won't pull the new file
[2013-08-02 16:43:18 -0400] suffix_: coderanger et al. is it possible to pass a variable into a chef recipe?
[2013-08-02 16:49:54 -0400] randomautomator: nevermind about the etag stuff it seems to work... but kind of confusing since it doesn't seem to pull if the etag changes but the content doesn't
[2013-08-02 16:50:06 -0400] yfeldblum: suffix_, the input to a chef recipe is the node object
[2013-08-02 16:50:33 -0400] yfeldblum: suffix_, you may also abuse global variables, but that's not recommended
[2013-08-02 16:56:05 -0400] Sauraus: What is the syntax for a local variable in a cookbook? Say I want to set a value in my default attributes like this: apache_solr_ver = "apache-solr-#{node['solr']['version']"
[2013-08-02 16:56:59 -0400] yfeldblum: Sauraus, there is no such syntax
[2013-08-02 16:57:05 -0400] dgarstang: Oh nice. On a fresh system, a "hef-server-ctl reconfigure" just failed in "/opt/chef-server/embedded/cookbooks/chef-server/recipes/postgresql.rb"
[2013-08-02 16:57:17 -0400] yfeldblum: Sauraus, local variables only work with*in* a scope
[2013-08-02 16:57:58 -0400] bean: dgarstang: sounds like an error with the cookbook, you could pastebin the whole error
[2013-08-02 16:58:49 -0400] Sauraus: yfeldblum so I have to copy the "apache-solr-#{node['solr']['version']" code around? :(
[2013-08-02 16:58:58 -0400] dgarstang: bean: looks like procps is failing to start
[2013-08-02 16:59:23 -0400] bean: hmm
[2013-08-02 16:59:33 -0400] bean: i dont know if thats related to postgres but it could be
[2013-08-02 16:59:39 -0400] yfeldblum: Sauraus, you may if you like
[2013-08-02 16:59:47 -0400] bean: all that does is compile the stuff into sysctl
[2013-08-02 17:00:04 -0400] dgarstang: bean.... "start: Job failed to start" ... for "start procps"
[2013-08-02 17:00:24 -0400] dgarstang: err, rather "service procps start"
[2013-08-02 17:00:24 -0400] bean: dgarstang: and thats getting invoked in your cookbook?
[2013-08-02 17:00:28 -0400] Sauraus: yfeldblum I don't like ;) but what is the alternative?
[2013-08-02 17:00:30 -0400] dgarstang: bean: correct
[2013-08-02 17:01:08 -0400] bean: dgarstang: is this the community cookbook or one you wrote yourself
[2013-08-02 17:01:22 -0400] yfeldblum: Sauraus, you may stick that value in a different attribute
[2013-08-02 17:01:30 -0400] yfeldblum: Sauraus, or you may recompute it at the top of a recipe
[2013-08-02 17:01:49 -0400] Sauraus: yfeldblum thx
[2013-08-02 17:01:51 -0400] dgarstang: bean: http://pastebin.com/1K06AFwW
[2013-08-02 17:01:59 -0400] dgarstang: bean: this is the latest chef server setup
[2013-08-02 17:04:44 -0400] dgarstang: bean: "error: "Operation not permitted" setting key "vm.mmap_min_addr""
[2013-08-02 17:05:13 -0400] bean: dgarstang: yeah, i see that, does invoking "/etc/init.d/procps start" actually work for you?
[2013-08-02 17:05:27 -0400] dgarstang: bean: nope. That fails to strt
[2013-08-02 17:05:41 -0400] dgarstang: bean: upstart log has that error
[2013-08-02 17:05:45 -0400] bean: yep,
[2013-08-02 17:05:50 -0400] dgarstang: Darn
[2013-08-02 17:05:55 -0400] dgarstang: latest Ubuntu, latest chef server
[2013-08-02 17:06:06 -0400] dgarstang: rather, latest Ubuntu 12.04
[2013-08-02 17:07:17 -0400] bean: Supported Platforms
[2013-08-02 17:07:17 -0400] bean: Private Chef is supported on the following operating systems:
[2013-08-02 17:07:17 -0400] bean: Red Hat Enterprise Linux 6.2 or newer
[2013-08-02 17:07:17 -0400] bean: CentOS 6.2 or newer
[2013-08-02 17:07:18 -0400] bean: Ubuntu 10.04
[2013-08-02 17:07:54 -0400] bean: dgarstang: ^
[2013-08-02 17:08:03 -0400] bean: i'd try it on 10.04 or 12.04 and see if you get the same problem
[2013-08-02 17:08:14 -0400] dgarstang: bean: it IS 12.04
[2013-08-02 17:08:21 -0400] bean: ah
[2013-08-02 17:08:25 -0400] bean: well, it does say 10.04
[2013-08-02 17:08:27 -0400] bean: so i dont know
[2013-08-02 17:08:46 -0400] dgarstang: bean: where? and what's the dif between private server, and open source?
[2013-08-02 17:09:05 -0400] dgarstang: bean: given how often they update their docs, i take anything on the opscode web site with a grain of salt.
[2013-08-02 17:09:06 -0400] d```: dgarstang bean: there's a huge difference between 10.04 and 12.04
[2013-08-02 17:09:18 -0400] dgarstang: d```: your point?
[2013-08-02 17:09:30 -0400] bean: http://docs.opscode.com/server/private_chef_1x_install.html
[2013-08-02 17:09:32 -0400] bean: says 10.04
[2013-08-02 17:10:10 -0400] dgarstang: firstly.... what's the difference between 'prvate chef server' and 'open source chef server'?
[2013-08-02 17:10:20 -0400] bean: you pay for private chef, i believe?
[2013-08-02 17:10:29 -0400] dgarstang: bean: ok, we're on open source then
[2013-08-02 17:10:45 -0400] dgarstang: This, http://docs.opscode.com/chef_system_requirements.html says 12.04 is supported
[2013-08-02 17:11:23 -0400] bean: ah, private chef is free up to 5 nodes
[2013-08-02 17:11:34 -0400] bean: but maybe you're on a trial of private?
[2013-08-02 17:11:56 -0400] dgarstang: also worth noting.... this worked yesterday on a fresh system. This is a new fresh system. Only dif is that I did an 'apt-get upgrade' .... to an upstream package may have changed betwen today and yesterday that caused this
[2013-08-02 17:12:04 -0400] dgarstang: bean: no... open source.
[2013-08-02 17:12:09 -0400] bean: mk
[2013-08-02 17:12:28 -0400] dgarstang: i will respin, and try again I guess
[2013-08-02 17:12:59 -0400] bean: yeah, that sounds like an OS problem, not a chef problem
[2013-08-02 17:13:08 -0400] bean: well, maybe not
[2013-08-02 17:13:23 -0400] dgarstang: bean: chef should handle it. :)
[2013-08-02 17:13:29 -0400] bean: haha,
[2013-08-02 17:14:48 -0400] dgarstang: bean: I'll check it before I run chef configure again
[2013-08-02 17:14:54 -0400] bean: sounds like a plan
[2013-08-02 17:15:14 -0400] bean: i see a few references to that error in google, but not anything that seems related or a fix
[2013-08-02 17:21:52 -0400] dgarstang: bean: yep, looks like it's like that before chef. How bizarre. don't know why this popped up now
[2013-08-02 17:22:24 -0400] bean: and that server is fully updated?
[2013-08-02 17:22:35 -0400] bean: "apt-get update && apt-get upgrade && apt-get dist-upgrade"
[2013-08-02 17:22:37 -0400] bean: and reboot?
[2013-08-02 17:25:59 -0400] dgarstang: bean: not dist-upgrade.
[2013-08-02 17:26:07 -0400] bean: could give dist-upgrade a try.
[2013-08-02 17:26:23 -0400] bean: see if plopping a new kernel on there fixes it
[2013-08-02 17:26:54 -0400] dgarstang: bean: yeah, it's running inside google, so... not so sure about that....
[2013-08-02 17:26:58 -0400] bean: ah
[2013-08-02 17:27:02 -0400] bean: that could be it
[2013-08-02 17:27:04 -0400] bean: hmm
[2013-08-02 17:27:47 -0400] bean: i dont know what they use as a hypervisor but it wouldn't surprise me if their custom kernel somehow had that disabled.
[2013-08-02 17:28:28 -0400] bean: it protects against a kernel NULL pointer derefence, so they probably don't want it to be messed with
[2013-08-02 17:28:32 -0400] dgarstang: bean: it's a possibility. It's also actually their deprecated GCEL linux, hacked into thinking it's really Ubuntu. :)
[2013-08-02 17:28:45 -0400] bean: lol, gross.
[2013-08-02 17:29:07 -0400] josephholsten: what's the plan for the code review for today?
[2013-08-02 17:29:21 -0400] dgarstang: bean: no other choice. well, an upgraede and a reboot didn't fix it. I'll remove that setting from sysctl.d
[2013-08-02 17:29:31 -0400] bean: that sounds like the best option
[2013-08-02 17:29:32 -0400] josephholsten: given tickets.opscode.com is still down
[2013-08-02 17:29:58 -0400] troyready: dgarstang, I feel for you there. Gotta do what you gotta do, but that doesn't sound fun to deal with
[2013-08-02 17:30:36 -0400] troyready: I looked into GCE linux after you mentioned the plugin problems this week, and couldn't see a compelling reason to use it
[2013-08-02 17:30:49 -0400] troyready: Seems to offer functionality like aws but at a higher cost?
[2013-08-02 17:30:59 -0400] troyready: And now no real ubuntu support??
[2013-08-02 17:32:37 -0400] bean: yeah, GCE would not be my cloud provider of choice
[2013-08-02 17:32:39 -0400] bean: thats for sure
[2013-08-02 17:34:10 -0400] suffix_: https://soundcloud.com/abdecaf/neverknow
[2013-08-02 17:35:17 -0400] dgarstang: troyready: it's really just Ubuntu precise 12.04. If you change the lsb info, it thinks it's Ubuntu and an apt-get upgrade and everything else works. It was either that, or use Debian, which would have caused other issues for us.
[2013-08-02 17:35:37 -0400] dgarstang: bean: it's all about the $ unfortunately.
[2013-08-02 17:36:10 -0400] dgarstang: 'sides, it's nice to have Google kissing our ass. :)
[2013-08-02 17:37:09 -0400] troyready: Your org buys enough instances to make it cheaper than aws?]
[2013-08-02 17:37:24 -0400] dgarstang: troyready: we're all about the storage... :)
[2013-08-02 17:37:38 -0400] dgarstang: troyready: that's where most of our cost is
[2013-08-02 17:38:01 -0400] troyready: Ah. And it's cheaper or better than aws (I'm not super familar with either)?
[2013-08-02 17:38:06 -0400] dgarstang: troyready: google is offering significantly cheaper storage costs than Amazon
[2013-08-02 17:38:20 -0400] troyready: Cool. Good to know!
[2013-08-02 17:39:18 -0400] dgarstang: troyready: t'was a deal. .... prolly not standard, and I should stop talking now...
[2013-08-02 17:41:33 -0400] troyready: Well, I figured there was a good reason. I wanted to check it out before and see if I could help with the plugin, but the first impression I got was not super positive
[2013-08-02 17:45:04 -0400] dgarstang: troyready: the knife plugin? Oh that doesn't work. :) it's still using the old API. Google said they'd do a pull request.
[2013-08-02 17:45:36 -0400] troyready: Ah, that's nice of them :)
[2013-08-02 17:45:51 -0400] dgarstang: troyready: i think we're their only customer or something. :-\
[2013-08-02 17:51:26 -0400] troyready: Anyone else experimented/deployed any way of tracking hardware requirements for nodes in chef? i.e. how much RAM the VM will need, mountpoints, etc?
[2013-08-02 17:52:21 -0400] troyready: We have things like sysctl requirements set in our roles, so all that gets handled in beautiful chef fashion, but i want to programatically set baselines for the 'hardware' side of the vm's as well
[2013-08-02 17:53:49 -0400] troyready: My current thought is something like  attributes like  '"hardware_requirements": { "memory": "10GB", "disk": { "swap": "11GB", "/u01": "50GB" } }' in then nodes' role, and having deployment scripts read it and interact with the hypervisor. I'm pretty sure I've got a working plan, but just curious if there's any existing convention for it?
[2013-08-02 17:55:05 -0400] coderanger: suffix_: you mean from another recipe?
[2013-08-02 17:55:44 -0400] suffix_: no, I mean I want to pass a variable in from a script that initiates a chef run
[2013-08-02 17:56:55 -0400] tabolario: suffix_ you can't use a node/environment/role/cookbook attribute for that?
[2013-08-02 17:56:57 -0400] dgarstang: How do I create an admin account on a new chef server?
[2013-08-02 17:57:15 -0400] suffix_: tabolario I'd prefer not if at all possible
[2013-08-02 17:57:34 -0400] tabolario: dgarstang: a brand new chef server automatically creates an admin account, which it shows the credentials for on the webui (if a webui admin account is what you're referring to)
[2013-08-02 17:57:55 -0400] tabolario: suffix_ what is it that you're trying to pass in for the chef run?
[2013-08-02 17:58:16 -0400] suffix_: a cluster name
[2013-08-02 17:58:20 -0400] suffix_: basically, a label
[2013-08-02 17:58:21 -0400] dgarstang: tabolario: not sure. I stumbled through setting it up with knife configure before. But... I also thought I could create a different user with admin access.
[2013-08-02 17:58:56 -0400] tabolario: dgarstang: as long as you have the admin client key that the chef server install generated you can create new admin clients with that via knife
[2013-08-02 17:59:00 -0400] gkra: Is there a way to do better error handling in an execute or remote-file block?
[2013-08-02 17:59:16 -0400] tabolario: otherwise just browse to the webui, look on the righthand side i believe and there should be the generated credentials for the initial admin account
[2013-08-02 17:59:49 -0400] gkra: Doing a provisioning test last night, I had 4 of 120 nodes fail to bootstrab because a remote-file apparently didn't download the whole thing, causing a subsequent execute block (tar zxf) to error out, killing the bootstrap.
[2013-08-02 18:00:10 -0400] dgarstang: tabolario: what port for the UI?
[2013-08-02 18:00:43 -0400] tabolario: if you installed it via the omnibus debian package then it should just be 443
[2013-08-02 18:00:47 -0400] gkra: setting aside the obvious quetion of why I got a short read on the remote file (I have a bone to pick with the infrastructure guys), is there a way to catch this? I thought that was the point of the remote-file checksum...
[2013-08-02 18:01:14 -0400] tabolario: suffix_ and what are you trying to do with the label inside of your recipe?
[2013-08-02 18:01:29 -0400] suffix_: I use it to access a specific data bag
[2013-08-02 18:01:37 -0400] dgarstang: tabolario: I thought 443 was for the knife API access
[2013-08-02 18:01:40 -0400] suffix_: that depends on the clister in question
[2013-08-02 18:02:04 -0400] tabolario: dgarstang: it's both, there's some rewrite magic that happens with a header that nginx uses to determine with to send requests to
[2013-08-02 18:02:14 -0400] dgarstang: tabolario: kk
[2013-08-02 18:02:30 -0400] tabolario: suffix_ that sounds to me like something environments might be appropriate for
[2013-08-02 18:02:49 -0400] suffix_: tabolario sort of
[2013-08-02 18:03:00 -0400] suffix_: environments would work
[2013-08-02 18:03:40 -0400] suffix_: but they're just unnecessarily large in this instance
[2013-08-02 18:04:09 -0400] suffix_: anyway, how about chef callbacks?
[2013-08-02 18:04:24 -0400] suffix_: does such a thing exist?
[2013-08-02 18:04:50 -0400] tabolario: eh.. someone else correct me i'm wrong please but the only thing i'm aware of are reporting handlers
[2013-08-02 18:04:55 -0400] tabolario: if i'm*
[2013-08-02 18:05:17 -0400] suffix_: what is a "reporting" handler
[2013-08-02 18:05:23 -0400] awayne: yeah, when i was looking for something similar the closest i could find was using reporting handlers
[2013-08-02 18:05:50 -0400] awayne: http://docs.opscode.com/essentials_handlers.html
[2013-08-02 18:06:48 -0400] Sauraus: When defining paths in a cookbook what is the correct way of doing this? writing the whole path out '/usr/local/src' or to use ::File.join 'usr','local','src'?
[2013-08-02 18:07:39 -0400] suffix_: is it possible to use the report handler to "hold" a block from running until a function has completed?
[2013-08-02 18:07:53 -0400] awayne: suffix_: hold a block from running?
[2013-08-02 18:08:26 -0400] suffix_: I've begun to run into ituations where a resource will run before the resource before it actually completes
[2013-08-02 18:08:31 -0400] suffix_: *situations
[2013-08-02 18:08:46 -0400] tabolario: suffix_ could you elaborate on that?
[2013-08-02 18:08:49 -0400] awayne: suffix_: you can handle that using the 'notifications' in chef
[2013-08-02 18:09:00 -0400] awayne: suffix_: sorry.... notifies
[2013-08-02 18:09:03 -0400] suffix_: ok
[2013-08-02 18:09:13 -0400] awayne: suffix_: http://docs.opscode.com/resource_common.html#notifications
[2013-08-02 18:09:24 -0400] suffix_: is it possible to use notifications between recipes?
[2013-08-02 18:09:35 -0400] suffix_: for instance, I am using a driver recipe to run other recipes
[2013-08-02 18:09:53 -0400] suffix_: I need to ensure that one recipe completes before another one begins
[2013-08-02 18:09:55 -0400] miah: so long as the resource is created before the one sending the notification, yes.
[2013-08-02 18:09:57 -0400] awayne: suffix_: i think any resource can notify any other resource, regardless of cookbook/recipe
[2013-08-02 18:10:04 -0400] suffix_: ok
[2013-08-02 18:10:46 -0400] awayne: suffix_: the important part will be to define the dependee resource with an action :nothing
[2013-08-02 18:11:03 -0400] suffix_: ok
[2013-08-02 18:11:16 -0400] awayne: so it will define the resource but not invoke any action. then the dependent resource will drive the action(s) once it has run
[2013-08-02 18:11:24 -0400] awayne: or before it has run
[2013-08-02 18:11:55 -0400] awayne: wait, i may have the dependee/depender backwards there :)
[2013-08-02 18:12:39 -0400] awayne: how does everyone manage scm on their custom cookbooks? do you check them in along with your chef-repo? submodules?
[2013-08-02 18:13:07 -0400] juliancdunn: awayne: I recommend individual Git repositories
[2013-08-02 18:13:17 -0400] juliancdunn: that way you can tag them the same as the version in metadata
[2013-08-02 18:13:33 -0400] tabolario: suffix_ do keep in mind that the default for notifies is to queue up the notified action for the resource (gets run at the end of the chef run)
[2013-08-02 18:14:05 -0400] tabolario: you can do 'notifies :action, 'resource', :immediate' to have that action run on the notified resource immediately when the notification occurs
[2013-08-02 18:14:15 -0400] awayne: i'm currently checking all mine in with the chef-repo and it's getting to feel odd.
[2013-08-02 18:14:43 -0400] juliancdunn: awayne: yeah, I tell people that's an anti-pattern :)
[2013-08-02 18:14:48 -0400] tabolario: i'm currently doing that just because we don't have enough private repos on our GH account
[2013-08-02 18:15:03 -0400] awayne: i was considering switching to using separate repos for each cookbook, though.
[2013-08-02 18:15:05 -0400] tabolario: i was considering getting a bitbucket account for us just to put our cookbooks in
[2013-08-02 18:15:08 -0400] aramus_: Hello, is it possible to for a resource to notify a diffrent resource in another recipe?
[2013-08-02 18:15:15 -0400] awayne: aramus_: yes
[2013-08-02 18:15:27 -0400] dgarstang: new chef server... knife upload... gets part way through and then "/opt/chef/embedded/lib/ruby/1.9.1/net/http.rb:762:in `initialize': getaddrinfo: Name or service not known (SocketError)"
[2013-08-02 18:15:43 -0400] awayne: juliancdunn: how do you manage your chef-repo? submodules?
[2013-08-02 18:15:54 -0400] juliancdunn: awayne: no, I never use submodules
[2013-08-02 18:16:10 -0400] juliancdunn: I have one Git module called "chef-data" that contains roles, environments, data_bags
[2013-08-02 18:16:19 -0400] juliancdunn: and individual Git modules for each cookbook
[2013-08-02 18:16:32 -0400] juliancdunn: Git repos, I mean
[2013-08-02 18:16:55 -0400] awayne: how do you reassemble all your cookbooks for your chef-repo? for example, tomorrow a new developer comes on. i'd hate to have to sit down and map 6 repositories just to get his chef-repo setup.
[2013-08-02 18:17:03 -0400] juliancdunn: problem with submodules is they're tied to a particular Git hash. then you're stuck doing the whole commit hash update dance
[2013-08-02 18:17:12 -0400] awayne: (or hers....and I don't actually have 6)
[2013-08-02 18:17:30 -0400] aramus_: awayne: Thanks. When does a resource notify another resource? Is it when the resource finishes or when it starts?
[2013-08-02 18:17:45 -0400] juliancdunn: awayne: "for i in a b c d ; do git clone git://github.com/yourco/$i.git ; done" ?
[2013-08-02 18:18:01 -0400] awayne: juliancdunn: when you put it like that, it seems so simple =)
[2013-08-02 18:18:31 -0400] juliancdunn: I dunno... developers have many Git repos for their software code, I don't think it's an issue
[2013-08-02 18:18:44 -0400] juliancdunn: unless they have monolithic.git, which speaks to bad s/w design IMO :-P
[2013-08-02 18:18:56 -0400] tubbo: does anyone here use Dash.app for OS X? just wondering if there's a Chef 10.x docset anywhere around :)
[2013-08-02 18:19:17 -0400] cwj: tubbo: i use it, but i havent gone looking for a docset
[2013-08-02 18:19:26 -0400] awayne: yeah, this is probably more a git question than chef specific. this is our first git rodeo so trying to figure it out a bit
[2013-08-02 18:19:29 -0400] tubbo: cwj: never thought of it until today
[2013-08-02 18:19:38 -0400] cwj: tubbo: i hadnt thought of that either :)
[2013-08-02 18:19:41 -0400] cwj: now its on
[2013-08-02 18:19:46 -0400] tubbo: awayne: ever consider using chef-librarian?
[2013-08-02 18:20:00 -0400] awayne: aramus_: you can have it notify afterwards, either immediately afterwards or at the end of the chef run.
[2013-08-02 18:20:19 -0400] dgarstang: duh knife. if you give it an IP, it still picks up the fqdn of the server through the API and then tries to connect to that, which isn't in our DNS yet
[2013-08-02 18:21:13 -0400] awayne: i don't know if you can have the notify run before the current resources action(s), maybe by placing the 'notifies' statement before the 'actions' statement?
[2013-08-02 18:21:23 -0400] awayne: tubbo: looking it up now
[2013-08-02 18:22:02 -0400] troyready: dgarstang, this in the context of knife ssh or knife bootstrap?
[2013-08-02 18:22:09 -0400] tubbo: awayne: librarian-chef is nice but Berkshelf is probably more famous. essentially it advocates using the tool to d/l cookbooks and not keeping cookbooks in your repo
[2013-08-02 18:22:13 -0400] tubbo: just modifications i guess
[2013-08-02 18:22:17 -0400] dgarstang: troyready: knife upload.
[2013-08-02 18:22:35 -0400] awayne: juliancdunn: what happens when you pull down a cookbook through knife (knife cookbook site ...)?
[2013-08-02 18:23:26 -0400] awayne: do you source control those locally? fork them if needed?
[2013-08-02 18:24:23 -0400] juliancdunn: awayne: I don't source control those locally
[2013-08-02 18:24:25 -0400] troyready: dgarstang, I think we ran into a similar issue to that when we were swinging over to a new chef server (due to our proxied chef server url). Needed to modify the chef server config file to return the right url
[2013-08-02 18:24:43 -0400] juliancdunn: awayne: I just use Berkshelf
[2013-08-02 18:24:56 -0400] juliancdunn: also encourages people to not fork community cookbooks and instead feed changes back upstream
[2013-08-02 18:25:15 -0400] juliancdunn: and you can override most things in [good] community cookbooks to make them suitable for your use-case
[2013-08-02 18:25:21 -0400] awayne: how do you configure where berkshelf retrieves its cookbooks from?
[2013-08-02 18:25:49 -0400] juliancdunn: awayne: you can tune the Berksfile
[2013-08-02 18:26:11 -0400] juliancdunn: see berkshelf.com for more info
[2013-08-02 18:27:04 -0400] awayne: juliancdunn: yeah, i'm struggling with that right now. trying to build a mysql55/drbd/heartbeat cluster on centos and the mysql cookbook just isn't working (it always tries to start mysql on the secondary node). i'm not sure if this should be managed as a custom cookbook or fed back into the upstream cookbook since it seems one-off'ish.
[2013-08-02 18:27:26 -0400] aramus_: If a resource with a notifies is skipped because of a not_if/only_if, will it still notify the resource or not?
[2013-08-02 18:27:42 -0400] awayne: aramus_: i think it will also skip the notify
[2013-08-02 18:28:00 -0400] dgarstang: Where does chef server put individual's keys, and how does it create them? I think we wanted to share a users keys between chef servers.
[2013-08-02 18:28:27 -0400] awayne: for example, say you were to install a package and then after install notify a service to start. if the install is skipped, the start would be skipped.
[2013-08-02 18:28:52 -0400] tabolario: awayne: have a wrapper cookbook for mysql with different recipes for primary/secondary and have a resource in the recipe for the secondary that sends a stop action to the mysql service
[2013-08-02 18:29:08 -0400] tabolario: don't you want the secondary mysql running though?
[2013-08-02 18:29:09 -0400] aramus_: awayne: darn it
[2013-08-02 18:30:12 -0400] awayne: tabolario: no, because the data volume isnt present on the secondary node
[2013-08-02 18:30:23 -0400] awayne: active/passive
[2013-08-02 18:30:30 -0400] tabolario: oh gotcha
[2013-08-02 18:30:42 -0400] tabolario: but yeah, i think you could do what i said above then
[2013-08-02 18:30:53 -0400] awayne: that's what i started down was a wrapper cookbook, but for various reasons my turned into *the* cookbook
[2013-08-02 18:31:07 -0400] suffix_: let's say I need to do some database contents verification during a chef run, and I need the recipe to fail if the database's contents aren't correct. What would I use to cause a failure?
[2013-08-02 18:32:15 -0400] awayne: i can add 20 attributes to the mysql cookbook to make it flexible enough to work in this case, but is it worth pushing back upstream? and, what do i do in the interim in my local chef-repo? pull the cookbook from the fork?
[2013-08-02 18:33:55 -0400] tabolario: suffix: you could use Chef::Application.fatal!
[2013-08-02 18:35:03 -0400] suffix_: sounds good to me
[2013-08-02 18:36:05 -0400] tabolario: don't quote me on that being the recommended way to do it though ;)
[2013-08-02 18:46:57 -0400] awgross: anyone know of issues in 11.4.4 where notifications sent from inside a provider will not execute unless they are sent with :immediately?
[2013-08-02 18:47:23 -0400] awgross: *notifications sent from inside a provider to a different custom provider
[2013-08-02 18:47:28 -0400] awgross: LWRP style
[2013-08-02 18:47:48 -0400] awgross: could it be something around use_inline_resources by default?
[2013-08-02 18:48:19 -0400] awgross: its not complaining that it cant find the resource, it claims to send the action, just it never gets executed
[2013-08-02 18:49:21 -0400] cwj: awgross: i feel like i have seen other people mention that behavior lately
[2013-08-02 18:49:39 -0400] cwj: not aware if theres a bug open about it
[2013-08-02 18:49:48 -0400] awgross: i would check the jira,  but
[2013-08-02 18:49:54 -0400] cwj: yerp
[2013-08-02 18:51:05 -0400] aslan: has anyone used airbrake_handler gem to catch chef errors?
[2013-08-02 18:51:24 -0400] awgross: coldboot|laptop: do a `which knife`
[2013-08-02 18:51:41 -0400] awgross: it will probably have  a path ending in /bin
[2013-08-02 18:51:51 -0400] volker-: is there an easy way to delete all links/files in a directory? there is 'link "name" do action :delete end', but I don't see an option to delete all at once
[2013-08-02 18:52:09 -0400] awgross: coldboot|laptop:  see if you go there, and you can go up one level, start looking for a gems dir
[2013-08-02 18:52:22 -0400] awgross: you will prob find the `gem` command you want to run to install into the embedded chef there
[2013-08-02 18:53:46 -0400] cwj: is homebrew really installing its own ruby environment for stuff like chef? yeech
[2013-08-02 18:55:15 -0400] coldboot|laptop: Thanks, `sudo gem install -n /usr/local/bin/ chef` made it work.
[2013-08-02 18:55:52 -0400] Kyle11: Trying to upgrade to chef 11.6 ran some tests on vagrant/solo and it seems the cookbook users fails after the first run.  I downgraded to 11.4 and it works as expected.  Has anyone else experienced this?      Getting error messages "You must have ruby-shadow installed for password support!"
[2013-08-02 18:56:50 -0400] cobby: let me upgrade my vagrant system to 11.6 real quick and see if I can help.
[2013-08-02 18:57:50 -0400] Kyle11: I've tried installing the gem and it doesn't seem to fix it.  I find it odd it works the first run (vagrant up)
[2013-08-02 18:59:04 -0400] cobby: about 30 more seconds :)
[2013-08-02 18:59:24 -0400] joelteon: in this cookbook, I install ree and bluepill
[2013-08-02 18:59:37 -0400] joelteon: but when I try to restart the bluepill service, chef wants to use its embedded bluepill binary, which doesn't exist
[2013-08-02 19:00:41 -0400] joelteon: when I googled the error, the only thing I found was this gist: https://gist.github.com/ranjib/5200708#file-kitech-test-faild-run-txt-L381
[2013-08-02 19:00:50 -0400] joelteon: which is a very similar error to the one I'm getting
[2013-08-02 19:02:31 -0400] crossleyp_: anyone using the sql_cookbook for non express versions of MS sql?
[2013-08-02 19:04:00 -0400] cobby: @joelteon what distro are you using?
[2013-08-02 19:04:15 -0400] joelteon: cobby: centos 6
[2013-08-02 19:05:47 -0400] tubbo: getting a strange error here: "Chef::Exceptions::FileNotFound: template[gemrc] (webapp::gems line 9) had an error: cookbook webapp does not contain file templates/gemrc.erb
[2013-08-02 19:05:50 -0400] tubbo: "
[2013-08-02 19:06:08 -0400] tubbo: yet templates/gemrc.erb does in fact exist.
[2013-08-02 19:06:10 -0400] cobby: @joelteon I have found this issue with ruby and the embedded ruby in vagrant vs the Linux OS and their install paths are wrong for gems .  You may want to check to see where bluepill is actually installing
[2013-08-02 19:06:15 -0400] joelteon: ok
[2013-08-02 19:06:19 -0400] tubbo: inside chef-repo/site-cookbooks/webapp/templates/gemrc.erb
[2013-08-02 19:06:35 -0400] joelteon: yeah, it's installing to /usr/bin/bluepill
[2013-08-02 19:06:53 -0400] joelteon: it's just that for some reason chef thinks it needs to use an embedded version, and no such thing exists
[2013-08-02 19:07:45 -0400] cobby: are you using the "service" resource to call the init?
[2013-08-02 19:11:12 -0400] joelteon: I'm using bluepill_service "myapp" { action [:enable, :load, :start] }
[2013-08-02 19:11:17 -0400] ranjib: joelteon, try printing GEM_HOME and GEM_PATH, vagrant might be messing with it
[2013-08-02 19:11:26 -0400] joelteon: yeah, I know it does
[2013-08-02 19:11:35 -0400] joelteon: maybe I can override GEM_PATH in bluepill_service, or something
[2013-08-02 19:11:57 -0400] cobby: To set the path you can pivot on vagrant vs non-vagrant
[2013-08-02 19:12:03 -0400] joelteon: pivot?
[2013-08-02 19:12:05 -0400] cobby: I did that to setup scout
[2013-08-02 19:12:21 -0400] cobby: a case statement based on platform
[2013-08-02 19:12:25 -0400] ranjib: theres a bug in chef, else i would have recommended running env -i /opt/chef/bin/chef-client
[2013-08-02 19:12:52 -0400] joelteon: oh, case
[2013-08-02 19:12:58 -0400] josephholsten_: i assume code review is off today?
[2013-08-02 19:26:05 -0400] EricL: coderanger: I know I got a whole lesson last night on search, but my brain seems to be failing me.  If I specify a recipe in a role and only in a role, then should that recipe be able to be found by a 'recipes:*name*'
[2013-08-02 19:26:36 -0400] coderanger: Not sure about the *s, but yes
[2013-08-02 19:27:49 -0400] EricL: Ok, how about a recipe specified by another recipe?
[2013-08-02 19:28:10 -0400] EricL: iow. Does all that stuff get unrolled on the server?
[2013-08-02 19:29:29 -0400] coderanger: You mean via include_recipe?
[2013-08-02 19:29:44 -0400] EricL: I have rec2 included in rec1.  rec 1 is included via the role.  Can I search for rec2?
[2013-08-02 19:29:48 -0400] EricL: Yes.
[2013-08-02 19:29:53 -0400] coderanger: No, unfortunately
[2013-08-02 19:30:14 -0400] coderanger: Its on the list to fix, but include_recipe currently doesn't update node['recipes'] so it is invisible
[2013-08-02 19:30:17 -0400] EricL: Ok.  I probably should have asked like 30 min ago rather than trying all sorts of crazy configurations.
[2013-08-02 19:30:41 -0400] EricL: Is it high on the priority list to fix?
[2013-08-02 19:30:44 -0400] EricL: (since Jira is down)
[2013-08-02 19:31:00 -0400] miah: wouldnt that end up in the expanded run list ?
[2013-08-02 19:31:13 -0400] coderanger: If you desperately need it, you can probably hack it in via magic :)
[2013-08-02 19:31:13 -0400] coderanger: miah: No :(
[2013-08-02 19:31:22 -0400] miah: doh
[2013-08-02 19:31:35 -0400] coderanger: EricL: Not sure, I just make pretty websites, my work on actual Chef is just as a normal FOSS contributor
[2013-08-02 19:31:53 -0400] EricL: I don't desperately need it, but it would make my Nagios configs significantly easier.
[2013-08-02 19:32:20 -0400] coderanger: Its probably going to ratchet up the list pretty quickly as the riot-style roleish cookbook become more prevalent
[2013-08-02 19:32:22 -0400] EricL: I guess I can double include the recipe to make it searchable.
[2013-08-02 19:32:48 -0400] EricL: Once earlier and then once at the proper time.
[2013-08-02 19:33:11 -0400] miah: i still facepalm over that. but cargoculting is the way =)
[2013-08-02 19:33:45 -0400] coderanger: miah: Wheee, might have found a place in Lafayette!
[2013-08-02 19:33:49 -0400] miah: yay
[2013-08-02 19:35:04 -0400] miah: i think roles  would make more sense if people wrote cookbooks in the resource provider style, then wrapped those with business logic and data from roles/environments
[2013-08-02 19:35:20 -0400] miah: instead of hardcoding a bunch of attributes into recipes and then having to deal with the insanity
[2013-08-02 19:35:25 -0400] ranjib: it should be searchable in some cases https://github.com/opscode/chef/blob/master/lib/chef/run_list/run_list_expansion.rb#L142
[2013-08-02 19:36:20 -0400] ranjib: but since lots of stuff are evaled on the fly, its difficult to guarantee that behavior...
[2013-08-02 19:36:41 -0400] coderanger: miah: The argument for riot-style roles is just that you can change whats in them in a version-managed way
[2013-08-02 19:36:59 -0400] coderanger: ranjib: No, under no circumstance does that include things from include_recipe
[2013-08-02 19:37:02 -0400] miah: ya, but you can in json/rb roles as well
[2013-08-02 19:37:23 -0400] coderanger: miah: No, if you add something to a normal role, it takes effect in all environments immediately
[2013-08-02 19:37:25 -0400] miah: you just have to change your workflow a little bit
[2013-08-02 19:37:31 -0400] coderanger: Now, you can then restrict it via envs
[2013-08-02 19:37:39 -0400] miah: yes of course
[2013-08-02 19:37:53 -0400] coderanger: I think we should probably all have a convention, possibly enforced by the server, that version 0.0.0 of a cookbook is _always_ a no-op
[2013-08-02 19:37:56 -0400] coderanger: like it is just empty
[2013-08-02 19:37:59 -0400] miah: its trickier to 'experiment' with attributes sure
[2013-08-02 19:38:07 -0400] miah: but experimenting with attributes is a antipattern anyways
[2013-08-02 19:38:25 -0400] miah: you can already do environment based run lists, and environment overrides are higher precedent than roles. so..
[2013-08-02 19:38:27 -0400] coderanger: So if you want to add stuff to a role, just lock the version to 0 in production env
[2013-08-02 19:39:02 -0400] coderanger: miah: Yeah, env-specific run lists can get really cranky to work with though, since its duplicate data
[2013-08-02 19:39:14 -0400] miah: its _possibly_ duplicate data =)
[2013-08-02 19:39:26 -0400] miah: it would be great if _default applied to all, then env_run_lists could expand on that
[2013-08-02 19:39:35 -0400] coderanger: Well there is some duplication, since the env-specific one isn't expressed as a delta
[2013-08-02 19:40:09 -0400] coderanger: Just easy for people to end up in a "I change the role, why isn't it working?" situation
[2013-08-02 19:40:15 -0400] miah: ya
[2013-08-02 19:40:26 -0400] miah: but i still dont think thats the fault of the role
[2013-08-02 19:40:40 -0400] miah: i think its more that people dont understand attribute precedence
[2013-08-02 19:40:50 -0400] miah: or the concept of 'flatten'
[2013-08-02 19:41:04 -0400] coderanger: Also quite possible, I also think people need to stop using attributes so damn much
[2013-08-02 19:41:10 -0400] miah: yes, for sures.
[2013-08-02 19:42:39 -0400] ranjib: coderanger miah run_status.run_context.loaded_recipes.uniq
[2013-08-02 19:43:00 -0400] jgood: i'm working on an ohai plugin that will display the software that my company uses. I need the structure to be {"OurSoftware": {"FirstProgram":{"Version":"v02.67.04", "Created":"05/12/13"}, "SecondProgram":{"Version":"v01.09.01", "Created":"03/02/12"}}}
[2013-08-02 19:43:03 -0400] jgood: I've done the background work and am able to turn the to be attributes into strings ("FirstProgram", "v02.67.04" and "05/12/13"), but for some reason when I try to create the new Mash for FirstProgram it does not seem to actually be created
[2013-08-02 19:43:08 -0400] coderanger: ranjib: Yes, that doesn't get put back in node['recipes'] though
[2013-08-02 19:43:08 -0400] jgood: I have "provides 'OurSoftware'" and "OurSoftware Mash.new" at the beginning of the file and then "OurSoftware[d] = Mash.new" later on, where d = "FirstProgram"
[2013-08-02 19:43:14 -0400] jgood: Sorry for the super long question, but can anyone help me with the syntax of the nested Mash? Thanks
[2013-08-02 19:43:17 -0400] coderanger: ranjib: Also loaded_recipes should always be unique :)
[2013-08-02 19:43:40 -0400] ranjib: yeah.. :-) that was redundant
[2013-08-02 19:43:51 -0400] ranjib: wondering why i've put that
[2013-08-02 19:44:56 -0400] ranjib: oh... its not recipe.. its cookbooks, we use that to find out unused recipes
[2013-08-02 19:51:47 -0400] msch: is everyone currently migrating to berkshelf or is librarian-chef still "acceptable"?
[2013-08-02 19:53:52 -0400] miah: lots of people use both
[2013-08-02 19:53:59 -0400] miah: but berkshelf is in fashion this season
[2013-08-02 19:57:31 -0400] dgarstang: I'm a bit confused here. I created a new node, and added it with knife node add chefs01.us4.foo.com. Well, chef now thinks that's the node name, but the hostname cookbook from opscode is setting it to chefs01.us4.foo.com.foo.com
[2013-08-02 20:03:18 -0400] dgarstang: Actually, it's calling "fqdn = fqdn.sub('*', node.name)".... that's taking the set_fqdn attribute, which is '*.foo.com', and replacing '*' with the nodename, which is chefs01.us4.foo.com. We get chefs01.us4.foo.com.foo.com. That will never work.
[2013-08-02 20:04:22 -0400] dgarstang: Either the node name needs to be just 'chefs01', OR the set_fqdn is left empty.
[2013-08-02 20:06:50 -0400] btm: Due to the public ticketing site being offline still, we're canceling code review today (and possibly Monday)
[2013-08-02 20:08:26 -0400] dgarstang: Is the chef node.name supposed to be just the host name or the FQDN?
[2013-08-02 20:10:02 -0400] tabolario: node.name can be whatever you want
[2013-08-02 20:10:17 -0400] tabolario: there's node['fqdn'] for the fqdn
[2013-08-02 20:10:46 -0400] denken_: chef-client 11.4.4 used to return the eth0 ip for node.cloud.local_ipv4... but now it returns eth1
[2013-08-02 20:10:55 -0400] denken_: anyone else seen that? im not even sure the rigth way to work around it
[2013-08-02 20:11:09 -0400] denken_: (the mysql cookbook uses node.cloud.local_ipv4 for the mysql bind address)
[2013-08-02 20:11:12 -0400] dgarstang: tabolario: Well, I named my host with the fqdn....
[2013-08-02 20:11:23 -0400] tabolario: That's fine
[2013-08-02 20:11:37 -0400] dgarstang: tabolario: Because.... otherwise... if you have multiple data centres, domains etc, you need to qualify them somehow. Seemed obvious.
[2013-08-02 20:11:43 -0400] denken_: er, "now" meaning version 11.6.0
[2013-08-02 20:12:01 -0400] tabolario: I'm still in progress on my hostname scheme
[2013-08-02 20:12:07 -0400] dgarstang: tabolario: Well the hostname cookbook from opscode takes the 'set_fqdn' attribute (*.foo.com) and replaces it with the node.name ....
[2013-08-02 20:12:39 -0400] dgarstang: tabolario: sorry, replaces '*' with the set_fqdn attribute value
[2013-08-02 20:12:49 -0400] dgarstang: tabolario: So... you end up with host.foo.com.foo.com. Wt?
[2013-08-02 20:13:29 -0400] tabolario: are you referring to this cookbook? http://community.opscode.com/cookbooks/hostname
[2013-08-02 20:13:53 -0400] dgarstang: tabolario: Yep, that's the one.
[2013-08-02 20:14:17 -0400] dgarstang: tabolario: 'The asterisk character will be replaced with node.name.'....
[2013-08-02 20:14:21 -0400] tabolario: that cookbook looks like it's intended specifically for the scenario where you DO want your fqdn set from your node.name
[2013-08-02 20:14:23 -0400] dgarstang: tabolario: node.name == fqdn
[2013-08-02 20:14:44 -0400] tabolario: that's also not an opscode cookbook ;)
[2013-08-02 20:14:45 -0400] dgarstang: tabolario: it's not gonna work then. :)
[2013-08-02 20:14:49 -0400] dgarstang: oh
[2013-08-02 20:15:02 -0400] dgarstang: *squinty eye*
[2013-08-02 20:15:18 -0400] dgarstang: explains why 5 minutes or less of thought went into it
[2013-08-02 20:15:35 -0400] tabolario: All of the opscode cookbooks have opscode as the maintainer on their cookbooks site
[2013-08-02 20:15:49 -0400] dgarstang: tabolario: funny there isn't an opscode one for the hostname
[2013-08-02 20:40:42 -0400] dath1974: quit
[2013-08-02 21:00:29 -0400] amccloud: Are attributes for a node only computed once? I have new override_attributes in my environment that don't seem to be make their way to the node.
[2013-08-02 21:04:39 -0400] zrankfappa: hi all, can anyone advise the best way to get my bootstrap target to use a http_proxy, it seems the --bootstrap-proxy 'http://10.0.1.50:3128' is not a valid option when using 'knife ec2 server create'
[2013-08-02 21:08:51 -0400] dgarstang: knife bootstrap lets me pass extra attributes with -j... how can I do that later for a node if I didn't use bootstrap?
[2013-08-02 21:14:33 -0400] dgarstang: Node editing. Why isn't there a nodes/ directory?
[2013-08-02 21:14:41 -0400] FoRMaTC: trying to add winrm support in knife-vsphere and I copied some lines from knife-vcloud. After cloning a vm it is doing the bootstrap which ends up with an error: Exception: NameError: uninitialized constant Chef::Knife::Core::WindowsBootstrapContext
[2013-08-02 21:18:28 -0400] FoRMaTC: http://pastebin.com/5A05y344
[2013-08-02 21:20:40 -0400] yfeldblum: amccloud, they are applied from the environment to the node only at the end of the next successful (non-failure) chef-client run
[2013-08-02 21:22:26 -0400] gazarsgo: do i just knife node create ot manually add servers ?
[2013-08-02 21:24:51 -0400] msch: can I influence the run list from within a cookbook? e.g. if my runlist depends on something this something also depends on something_else
[2013-08-02 21:25:15 -0400] d```: msch: you can include other recipes
[2013-08-02 21:25:44 -0400] msch: d``` I tried include_receipt but I think that messed with the attributes. Right now I override the other cookbook's attributes in my cookbook and that broke
[2013-08-02 21:27:18 -0400] d```: are you trying to do something like this: https://github.com/bryanwb/chef-rewind
[2013-08-02 21:28:19 -0400] amccloud: yfeldblum: Odd, i'm not seeing that behavior
[2013-08-02 21:28:20 -0400] yfeldblum: msch, no
[2013-08-02 21:28:27 -0400] msch: d``` kinda, I actually am trying to do create a msch-common-stuff recipe that depends on the openssh cookbook/recipe and sets default attributes: default.openssh.server.password_authentication = 'no'
[2013-08-02 21:28:36 -0400] amccloud: successful chef run but node attributes aren't being updated
[2013-08-02 21:28:45 -0400] yfeldblum: msch, you may call `include_recipe` though
[2013-08-02 21:29:07 -0400] msch: yfeldblum tried that, it lead to the attributes of the other recipe not being available
[2013-08-02 21:29:22 -0400] yfeldblum: amccloud, are there different values for the same override_attributes in a role?
[2013-08-02 21:29:41 -0400] yfeldblum: msch, recipes don't have attributes
[2013-08-02 21:29:58 -0400] amccloud: Nope. I don't set any attributes in roles
[2013-08-02 21:30:09 -0400] msch: yfeldblum but if I add recipe[openssh] to the runlist then the cookbook's attributes are available to the recipe
[2013-08-02 21:30:20 -0400] yfeldblum: msch, indeed
[2013-08-02 21:30:25 -0400] amccloud: Just override_attributes in the env and default in cookbooks
[2013-08-02 21:30:42 -0400] msch: yfeldblum but include_recipe doesn't do that?
[2013-08-02 21:30:54 -0400] amccloud: oh i think I know why
[2013-08-02 21:31:30 -0400] yfeldblum: msch, include_recipe doesn't do that; but in order to use include_recipe, the one cookbook must depend on the other cookbook in the metadata and so that wil do that
[2013-08-02 21:31:55 -0400] msch: yfeldblum thanks! I'll give that a try
[2013-08-02 21:32:32 -0400] FoRMaTC: trying to add winrm support in knife-vsphere and I copied some lines from knife-vcloud. After cloning a vm it is doing the bootstrap which ends up with an error: Exception: NameError: uninitialized constant Chef::Knife::Core::WindowsBootstrapContext
[2013-08-02 21:32:52 -0400] FoRMaTC: http://pastebin.com/5A05y344 <-- complete output
[2013-08-02 21:34:01 -0400] msch: yfeldblum worked! thanks!
[2013-08-02 21:36:54 -0400] yfeldblum: msch, cheers
[2013-08-02 21:38:50 -0400] EricL: Can someone point me to an example of how to search for nested attributes (like something on the node that can be added by a cookbook)?
[2013-08-02 21:39:44 -0400] EricL: I've been trying to search for something but keep coming up with examples that don't seem to work.
[2013-08-02 21:46:55 -0400] EricL: Bueller?
[2013-08-02 21:47:06 -0400] EricL: Is it really not possible to search node attributes?
[2013-08-02 21:48:14 -0400] troyready: You should be able to just craft your search like 'knife search node "yournestedattribute:value"'
[2013-08-02 21:48:37 -0400] troyready: and use the -a flag to set the context of the parent attribute
[2013-08-02 21:48:42 -0400] EricL: I can do that with knife, but I wanted to run a search query in the Nagios cookbook.
[2013-08-02 21:49:21 -0400] troyready: Ah
[2013-08-02 21:49:43 -0400] EricL: iow. Get me a list of nodes that have this attribute.
[2013-08-02 21:50:01 -0400] troyready: I believe the same basic parameters apply, but it's been awhile since I've done anything like that
[2013-08-02 21:50:53 -0400] EricL: Same properties apply for the search, but I can't narrow down the results by which ones have those attributes.
[2013-08-02 21:54:33 -0400] troyready: So search(:node, "nested attribute:value for which youre looking") doesn't work?
[2013-08-02 21:57:08 -0400] EricL: troyready: I'm not sure.  I couldn't find any documentation even giving me an idea where to start.
[2013-08-02 21:58:03 -0400] troyready: I've definitely been through the same thing. IIRC, the conclusion I reached was that it's because it's assumed that the nested nature of the attribute doesn't matter for the search or something
[2013-08-02 22:01:39 -0400] EricL: Another question, if I add a default_attribute in a role and then I run "shef" and put it into recipe_mode, how do I access those attributes from that node?
[2013-08-02 22:01:55 -0400] EricL: node.attributes['foo']   always yields nil
[2013-08-02 22:05:10 -0400] FoRMaTC: anyone knows how I can solve/debug this error: Exception: NameError: uninitialized constant Chef::Knife::Core::WindowsBootstrapContext ?
[2013-08-02 22:15:25 -0400] msch: anyone got any ideas why I get "uninitialized constant Chef::EncryptedDataBagItem::DEFAULT_SECRET_FILE"
[2013-08-02 23:00:23 -0400] zrankfappa: hi all, can anyone advise the best way to get my bootstrap target to use a http_proxy, it seems the --bootstrap-proxy 'http://10.0.1.50:3128' is not a valid option when using 'knife ec2 server create'
[2013-08-02 23:00:32 -0400] dgarstang: Anyone here in google cloud?
[2013-08-02 23:00:37 -0400] zrankfappa: sorry for repeated post, didn't get any love the last time i posted it
[2013-08-02 23:21:52 -0400] jalateras: had a question around the opscode jenkins plugin. I have enabled the nginx component but want to configure it to use '/jenkins' rasther than '/' in the generated jenkins.conf. How would i go about doing that?
[2013-08-02 23:22:58 -0400] jalateras: The second question i had on the sanme jenkins plugin is around enabling the SSL component. Do i just need to include the recipe "nginx::http_ssl_module". I am using chef+berkself
[2013-08-02 23:27:31 -0400] MrBIOS: how am I supposed to go about determining when a node/client was created in Chef?
[2013-08-02 23:27:37 -0400] MrBIOS: are there logfiles or anything I can try to reference?
[2013-08-02 23:28:26 -0400] gchristensen: MrBIOS: roughly, you could look at the creation time of the client.pem
[2013-08-02 23:28:34 -0400] jalateras: you should see files in /vsr/chef
[2013-08-02 23:28:42 -0400] MrBIOS: in this case, I don't think the client exists anymore
[2013-08-02 23:28:58 -0400] gchristensen: I'm having a template error out, included?('.') on aNilClass with this code: ip = n['cloud']['public_ipv4'].include?('.') ? n['cloud']['public_ipv4'] : n['ipaddress'] .. how can I determine which node is causing this error?
[2013-08-02 23:29:57 -0400] MrBIOS: @jalateras on the server?
[2013-08-02 23:30:46 -0400] jalateras: MrBIOS: yes in the server /var/chef
[2013-08-02 23:32:31 -0400] bluepojo: Anyone ever use basic auth with remote_file?
[2013-08-02 23:32:36 -0400] bluepojo: how do you do it?
[2013-08-02 23:33:30 -0400] gchristensen: bluepojo: https://user:password@hostname/path/to/file
[2013-08-02 23:33:36 -0400] bluepojo: hmm ok
[2013-08-02 23:34:08 -0400] gchristensen: that is how basic auth is specified in the HTTP spec
[2013-08-02 23:38:35 -0400] jalateras: @bluepojo +1 for @gchristensen
[2013-08-02 23:46:03 -0400] bluepojo: ty both
