[2013-08-27 00:04:49 -0400] dgarstang: This is so f*cked up. Knife ec2 server create is failing to log in, because we change the ubuntu user to the bcadmin user in cloud-init, and by the time chef tries to ssh in, cloud-init, which does this change hasn't run yet. I COULD have chef change the user name, except chef would have to log in as ubuntu and you can't change account details when your logged in as that user.
[2013-08-27 00:12:43 -0400] abe: How can I pass node attribtues into chef-apply?
[2013-08-27 01:41:05 -0400] awc737: anyone familiar with the apache2 web_app thing
[2013-08-27 01:41:21 -0400] awc737: how do I specify a different template?
[2013-08-27 02:03:27 -0400] abe: anyone know how to pass node attributes into chef-apply?
[2013-08-27 02:04:20 -0400] siezer: you can't set them in the recipe.
[2013-08-27 02:04:39 -0400] siezer: er. you cant, comma
[2013-08-27 02:07:42 -0400] abe: ok
[2013-08-27 02:07:43 -0400] abe: thank you
[2013-08-27 02:09:40 -0400] abe: is there any way to detect whether the current run is through chef apply and set attributes conditionally in that case only?
[2013-08-27 02:11:41 -0400] siezer: not that I'm aware of. chef-apply is really for learning and quickly testing small bits of code as an alternative to chef-shell.
[2013-08-27 02:23:17 -0400] hasues: I note that in open source chef, one checks out a Git repository.  Does this occur again during updates or upgrades of chef?  Trying to understand the relationship of Git in all this.
[2013-08-27 02:25:40 -0400] bradgignac: hasues: you only need to check it out if you want to contribute to chef
[2013-08-27 02:25:47 -0400] bradgignac: otherwise, you'll use binaries
[2013-08-27 02:26:37 -0400] hasues: So in an open source chef solution, there is no backend of sorts for Chef with its own Git?
[2013-08-27 02:27:17 -0400] hasues: bradgignac: I'm looking at this: http://blog.afistfulofservers.net/post/2011/03/16/a-brief-chef-tutorial-from-concentrate/  and I'm looking at the "Chef git repo checked out"
[2013-08-27 02:27:56 -0400] bradgignac: you'll need to store your cookbooks in a repository
[2013-08-27 02:28:22 -0400] hasues: bradgignac: But that is what bookshelf is for, correct?
[2013-08-27 02:28:29 -0400] bradgignac: berkshelf?
[2013-08-27 02:28:39 -0400] hasues: bradgignac: http://docs.opscode.com/chef_overview_server.html
[2013-08-27 02:28:42 -0400] hasues: Maybe? :P
[2013-08-27 02:29:07 -0400] bradgignac: oh
[2013-08-27 02:29:13 -0400] hasues: I've heard of berkshelf, but I haven't looked at it, I am trying to grasp the architecture still.
[2013-08-27 02:29:28 -0400] bradgignac: you'll definitely want your own git repository with cookbooks
[2013-08-27 02:29:46 -0400] hasues: Okay.  And so berkshelf sits on top of it I guess?
[2013-08-27 02:29:56 -0400] bradgignac: berkshelf manages external cookbooks
[2013-08-27 02:30:18 -0400] hasues: bradgignac: not ones I write?
[2013-08-27 02:30:22 -0400] bradgignac: correct
[2013-08-27 02:30:54 -0400] hasues: bradgignac: Thanks, I'll post more after more reading.
[2013-08-27 02:33:28 -0400] Glace: Hi, I was wondering how would that work if lets say I use berkshelf.. and 2 cookbooks have a common cookbook depencies but with 2 different hard versions.. like for example depend on "DatCookbook version = 1.0.0" and the other cookbook depends on "DatCookbook version 2.0.0"... all that using a chef server
[2013-08-27 02:41:04 -0400] siezer: hasues berkshe also manages the ones you write
[2013-08-27 02:42:50 -0400] siezer: Glace both 1.0.0 and 2.0.0 would be installed on the chef-server when you berks upload to the chef-server, and then it would work as normal during the chef-client run. 2.0.0 would be used if there was no specification of the DatCookbook in your Environment
[2013-08-27 02:49:18 -0400] a13x212: i added a recipe to a cookbook and upload it to my chef server but the chef-client doesn't seem to pick up the changes
[2013-08-27 02:58:05 -0400] jbz: a13x212: Are you using environments?
[2013-08-27 02:58:45 -0400] Glace: siezer: perfect.. thank you
[2013-08-27 02:58:48 -0400] a13x212: nope
[2013-08-27 02:59:13 -0400] Glace: is there a plan to support multiple cookbooks version of the same cookbook during a chef run?
[2013-08-27 02:59:54 -0400] jbz: a13x212: Did you bump the version in the metadata?
[2013-08-27 03:00:39 -0400] jbz: (I'm presuming you looked on the server and saw what you expected)
[2013-08-27 03:02:14 -0400] a13x212: jbz, i just tried bumping the version, no luck
[2013-08-27 03:02:27 -0400] a13x212: i see the new recipe on the server
[2013-08-27 03:02:45 -0400] jbz: look in the cache - do you see the version you expect, or the older one?
[2013-08-27 03:03:34 -0400] a13x212: its a new recipe so it would be version 1
[2013-08-27 03:04:00 -0400] jbz: er, when I said version, I meant of the cookbook
[2013-08-27 03:04:03 -0400] jbz: in metadata.rb
[2013-08-27 03:04:08 -0400] jbz: is that what you changed?
[2013-08-27 03:04:09 -0400] a13x212: yea, i bumped that
[2013-08-27 03:04:27 -0400] jbz: ok and in the client's cache, is the expected version present?
[2013-08-27 03:04:53 -0400] a13x212: how can i check that?
[2013-08-27 03:04:59 -0400] jbz: Are you on linux?
[2013-08-27 03:05:04 -0400] a13x212: yea
[2013-08-27 03:05:18 -0400] jbz: OK, it's usually in /var/cache/chef or /var/chef/cache, I can't remember which, in .../cookbooks
[2013-08-27 03:05:43 -0400] jbz: if you look at your client.rb, there may be a setting describing the cache location
[2013-08-27 03:05:54 -0400] jbz: anyway, it will store all the cookbooks it downloads in there
[2013-08-27 03:06:17 -0400] jbz: so when I have this problem, the first thing I do is check to see if it's downloading the new version at all
[2013-08-27 03:06:23 -0400] jbz: I don't always trust logs :-/
[2013-08-27 03:07:20 -0400] a13x212: yea, i see the recipe in the cache
[2013-08-27 03:08:39 -0400] jbz: And it's the version that it should be
[2013-08-27 03:08:40 -0400] jbz: ?
[2013-08-27 03:08:46 -0400] a13x212: yep
[2013-08-27 03:09:05 -0400] jbz: hm ok.  Are you *positive* it's not running it?
[2013-08-27 03:09:21 -0400] jbz: If it's downloading it, it's almost definitely running it; it might just not be doing what you expect
[2013-08-27 03:09:36 -0400] jbz: You might try putting a logging statement in to see if it's the one you think
[2013-08-27 03:09:52 -0400] jbz: oh also.  Did you include the recipe anywhere, if it's not the default?
[2013-08-27 03:10:08 -0400] jbz: Or put it in the runlist with the specific recipe called?
[2013-08-27 03:10:11 -0400] a13x212: the client has a runlist
[2013-08-27 03:10:25 -0400] jbz: And the runlist includes the specific recipe?
[2013-08-27 03:10:29 -0400] jbz: hm.
[2013-08-27 03:10:40 -0400] a13x212: it includes the cookbook
[2013-08-27 03:10:40 -0400] jbz: What's the recipe's name?
[2013-08-27 03:10:42 -0400] jbz: oh
[2013-08-27 03:10:43 -0400] jbz: well
[2013-08-27 03:10:46 -0400] jbz: that won't run the recipe. :-)
[2013-08-27 03:10:54 -0400] jbz: The only recipe that is run automatically is default.rb
[2013-08-27 03:10:58 -0400] jbz: (by calling the cookbook)
[2013-08-27 03:11:06 -0400] a13x212: hmm
[2013-08-27 03:11:20 -0400] jbz: If you want to run other recipes, you need to either have default.rb call them with include_recipe, or specify them in the runlist
[2013-08-27 03:11:25 -0400] jbz: like cookbook::recipe
[2013-08-27 03:14:21 -0400] a13x212: awesome thanks jbz
[2013-08-27 03:14:26 -0400] jbz: Most welcome!
[2013-08-27 03:17:03 -0400] awc737: does anyone know how I can override php.ini directives?
[2013-08-27 03:17:06 -0400] awc737: I tried this: http://paste.laravel.com/M6V
[2013-08-27 03:17:50 -0400] flaccid: awc737: does the php cookbook actually support those attributes?
[2013-08-27 03:21:47 -0400] awc737: flaccid, according to the docs, but I'm not sure my syntax is correct
[2013-08-27 03:22:20 -0400] awc737: flaccid, i'm not a ruby guy: https://github.com/opscode-cookbooks/php#usage
[2013-08-27 03:23:19 -0400] flaccid: awc737: it doesn't advise that
[2013-08-27 03:23:34 -0400] awc737: lol
[2013-08-27 03:24:08 -0400] awc737: here though, https://github.com/opscode-cookbooks/php#attributes
[2013-08-27 03:24:21 -0400] awc737: it's vague, but I feel like it's telling me I can override the php.ini default {}
[2013-08-27 03:24:26 -0400] awc737: with node['php']['directives']
[2013-08-27 03:24:50 -0400] flaccid: right so a shortcut override https://github.com/opscode-cookbooks/php/blob/master/templates/default/php.ini.erb#L1898
[2013-08-27 03:25:49 -0400] flaccid: awc737: take out the extra encapsulation, :override_attributes => {
[2013-08-27 03:26:36 -0400] awc737: hmm, i did try without the :override_attributes first
[2013-08-27 03:27:02 -0400] awc737: i'll try again, i wonder if a vagrant reload will be enough to update that
[2013-08-27 03:27:10 -0400] awc737: or if I need to destroy / up
[2013-08-27 03:28:52 -0400] awc737: hmm, http://paste.laravel.com/M76
[2013-08-27 03:28:54 -0400] awc737: still didn't override
[2013-08-27 03:29:53 -0400] a13x212: awc737, are you installing php from packges with that cookbook?
[2013-08-27 03:30:41 -0400] awc737: i believe that's what this does chef.add_recipe "php"
[2013-08-27 03:31:30 -0400] awc737: although, come to think of it, the /etc/php5/apache2/ directory is probably generated by chef.add_recipe "apache2::mod_php5"
[2013-08-27 03:31:43 -0400] awc737: and /etc/php5/apache2/php.ini is the one I need edited
[2013-08-27 03:32:38 -0400] a13x212: awc737, i was just curious because i'll be working on that next
[2013-08-27 03:33:04 -0400] awc737: indeed, i remembered doing vagrant up before I had chef.add_recipe "apache2::mod_php5"j
[2013-08-27 03:33:50 -0400] awc737: it installed php, but I had no /etc/php5/, but not the apache2 subdir
[2013-08-27 03:34:22 -0400] awc737: it still wasn't editing the php5/cli/php.ini either though...
[2013-08-27 03:35:36 -0400] awc737: maybe it's in here? https://github.com/opscode-cookbooks/apache2
[2013-08-27 03:43:11 -0400] awc737: puppet has an easy way to do this, might switch https://puphpet.com/#php
[2013-08-27 03:47:30 -0400] flaccid: awc737: what i advised should work.
[2013-08-27 03:48:18 -0400] awc737: flaccid, what was it?
[2013-08-27 03:48:31 -0400] awc737: flaccid, i did what you said: http://paste.laravel.com/M76
[2013-08-27 03:48:55 -0400] awc737: it didn't update /etc/php5/cli/php.ini which is what is installed with that package
[2013-08-27 03:49:12 -0400] awc737: but even still, I need to edit the /etc/php5/apache2/php.ini which I believe is installed with apache2::mod_php5
[2013-08-27 03:49:29 -0400] flaccid: https://github.com/opscode-cookbooks/php/blob/master/templates/default/php.ini.erb#L1898 will do it, but i don't believe it does the cli, i can check that
[2013-08-27 03:50:11 -0400] flaccid: https://github.com/opscode-cookbooks/php/blob/master/recipes/package.rb#L27 cookbook manages "#{node['php']['conf_dir']}/php.ini"
[2013-08-27 03:50:34 -0400] flaccid: conf_dir is calculated by logic https://github.com/opscode-cookbooks/php/blob/master/attributes/default.rb#L25
[2013-08-27 03:51:36 -0400] awc737: so my paste.laravel snip looks accurate to you?
[2013-08-27 03:52:48 -0400] flaccid: sure
[2013-08-27 03:52:51 -0400] awc737: well in your last past #25
[2013-08-27 03:53:02 -0400] awc737: i'm not seeing /etc/php5/apache2/php.ini
[2013-08-27 03:53:33 -0400] flaccid: the cookbook does not manage that file.
[2013-08-27 03:53:57 -0400] awc737: so it won't do what I need, i'm looking in the wrong place
[2013-08-27 03:54:06 -0400] awc737: and I don't think the apache2::mod_php5 recipe has anything in place
[2013-08-27 03:54:11 -0400] jtimberman: awc737: so write a recipe that does what you need
[2013-08-27 03:54:25 -0400] flaccid: awc737: what os/distro are you running?
[2013-08-27 03:54:27 -0400] jtimberman: it'll be what, a template resource and a template source right? :)
[2013-08-27 03:54:42 -0400] awc737: odd that it's not updating the cli/ version either though
[2013-08-27 03:54:54 -0400] awc737: ubuntu12.04
[2013-08-27 03:55:00 -0400] flaccid: the code is right, looks like pebkac to me
[2013-08-27 03:55:06 -0400] awc737: pebkac?
[2013-08-27 03:55:28 -0400] flaccid: yes
[2013-08-27 03:55:35 -0400] flaccid: that file isn't in a package either http://packages.ubuntu.com/search?searchon=contents&keywords=%2Fetc%2Fphp5%2Fapache2%2Fphp.ini&mode=exactfilename&suite=raring&arch=any
[2013-08-27 03:55:42 -0400] awc737: oh
[2013-08-27 03:55:47 -0400] awc737: but you said the code is right
[2013-08-27 03:56:05 -0400] awc737: what else would you need to see to know?
[2013-08-27 03:57:41 -0400] flaccid: awc737: run it in debug mode and pastebin the output
[2013-08-27 03:58:00 -0400] flaccid: awc737: personally i don't set node attributes in vagrantfile, i do it in a node.json
[2013-08-27 03:58:10 -0400] awc737: it looks like their coming from here /usr/share/php5/
[2013-08-27 03:58:12 -0400] awc737: generated
[2013-08-27 03:58:19 -0400] flaccid: huh
[2013-08-27 03:58:44 -0400] flaccid: this is how i set attributes in vagrant, https://github.com/rightscale-blueprints/linux_server/blob/master/Vagrantfile#L10
[2013-08-27 03:59:50 -0400] awc737: that shouldn't change anything the json is accurate, the mysql bit works
[2013-08-27 04:00:07 -0400] awc737: can I add a line like this to my recipe
[2013-08-27 04:00:21 -0400] awc737: sudo echo "upload_max_filesize=128M" >> /etc/php5/apache2/php.ini
[2013-08-27 04:00:35 -0400] flaccid: awc737: either listen to jtimberman or work out the problem
[2013-08-27 04:01:39 -0400] awc737: working out the problem = moving the json to an external file?
[2013-08-27 04:02:22 -0400] flaccid: [13:56] <awc737> what else would you need to see to know?
[2013-08-27 04:02:24 -0400] flaccid: [13:57] <flaccid> awc737: run it in debug mode and pastebin the output
[2013-08-27 04:02:36 -0400] awc737: there are no errors though
[2013-08-27 04:04:19 -0400] flaccid: it means you can check what actual template was done
[2013-08-27 04:04:28 -0400] awc737: l
[2013-08-27 04:04:29 -0400] awc737: k
[2013-08-27 04:09:21 -0400] javalover: are people in here?
[2013-08-27 04:09:56 -0400] awc737: yeah, people are here
[2013-08-27 04:10:04 -0400] javalover: what is chef?
[2013-08-27 04:10:07 -0400] flaccid: javalover: check your irc client, there is 545 nicks
[2013-08-27 04:10:10 -0400] javalover: i was looking for an irc channel for cooks lol
[2013-08-27 04:10:13 -0400] flaccid: javalover: read topic
[2013-08-27 04:10:29 -0400] javalover: i see that are youguys like open source something?
[2013-08-27 04:11:06 -0400] flaccid: yep
[2013-08-27 04:11:34 -0400] javalover: it's interesting i've looked into the open source movement, and although i was looking for a grilled salmon recipe for gordon ramsay
[2013-08-27 04:11:39 -0400] javalover: i'm intrigued about this...
[2013-08-27 04:11:49 -0400] javalover: is it possible to make money & still be open sourced?
[2013-08-27 04:12:26 -0400] javalover: because if it is possible i'd really like to contribute, i just don't understand the capitolism of open source
[2013-08-27 04:12:28 -0400] awc737: I tried: http://paste.laravel.com/M7w
[2013-08-27 04:12:43 -0400] awc737: lol...
[2013-08-27 04:13:16 -0400] javalover: that makes my eyes hurt
[2013-08-27 04:13:19 -0400] javalover: to read that lol
[2013-08-27 04:13:32 -0400] awc737: javalover, the code is available. any service you create or idea you patent and sell is yours
[2013-08-27 04:13:41 -0400] awc737: what difference would open source make
[2013-08-27 04:14:11 -0400] javalover: i don't know but i know big businesses don't use open source
[2013-08-27 04:14:21 -0400] javalover: and i was wondering why...
[2013-08-27 04:14:52 -0400] awc737: facebook, google, twitter? i'm guessing
[2013-08-27 04:15:09 -0400] javalover: umm i'm not sure if facebook isn't open source but
[2013-08-27 04:15:32 -0400] javalover: i was referring to like microsoft & apple
[2013-08-27 04:15:37 -0400] awc737: flaccid, jtimberman I used debug I don't think it works
[2013-08-27 04:15:45 -0400] jtimberman: Apple's OS X is an Open Source operating system :)
[2013-08-27 04:15:54 -0400] javalover: really
[2013-08-27 04:15:58 -0400] javalover: so I could be successful then
[2013-08-27 04:15:59 -0400] jtimberman: The kernel, specifically, and many of the tools they package with it.
[2013-08-27 04:16:24 -0400] javalover: now say I host my project...is github the best resource?
[2013-08-27 04:16:30 -0400] javalover: or like where does one start for open source?
[2013-08-27 04:17:01 -0400] awc737: http://www.zdnet.com/apple-microsoft-vmware-everyones-building-open-source-software-7000003441/
[2013-08-27 04:17:30 -0400] flaccid: awc737: chef debug mode in vagrant is configured like this https://github.com/rightscale-blueprints/forklift_worker/blob/master/Vagrantfile#L18
[2013-08-27 04:17:32 -0400] jtimberman: javalover: github is a pretty good place to share your code.
[2013-08-27 04:17:50 -0400] awc737: javalover, there is a lot to think about if your going to manage some development project
[2013-08-27 04:18:05 -0400] javalover: what I was thinking about doing for open source
[2013-08-27 04:18:07 -0400] awc737: whether or not you release your code to the public is probably not a huge obstacle
[2013-08-27 04:18:10 -0400] javalover: was say i'm building a video game
[2013-08-27 04:18:25 -0400] javalover: i'd like to have a resource somewhere where the entire project is hosted
[2013-08-27 04:18:30 -0400] javalover: and then coders can join in & help if they want
[2013-08-27 04:19:01 -0400] javalover: i like the idea behind minecraft
[2013-08-27 04:19:13 -0400] javalover: and i'd want to produce a game that has the same results of everyone can create and add to it
[2013-08-27 04:19:33 -0400] awc737: yeah, but you still need funding , project management, and talent
[2013-08-27 04:19:46 -0400] javalover: well of course i'm just considering it because
[2013-08-27 04:19:52 -0400] javalover: i'm only 26 and my career is taking off
[2013-08-27 04:20:03 -0400] javalover: so I know in the future I will have the opportunity to do so, so it's been on my mind
[2013-08-27 04:20:25 -0400] javalover: I look at models like wikipedia & wonder, is it really best to inhouse or should i Just open source it
[2013-08-27 04:20:43 -0400] awc737: you can do in house open source
[2013-08-27 04:21:01 -0400] javalover: does that mean only people with a password can see it?
[2013-08-27 04:21:03 -0400] javalover: or wha'ts that mean?
[2013-08-27 04:21:31 -0400] awc737: in house? like not outsourced... your companies internal members are taking on the project?
[2013-08-27 04:21:34 -0400] awc737: i imagine
[2013-08-27 04:21:47 -0400] javalover: oh well I like the idea say
[2013-08-27 04:21:51 -0400] javalover: anyone out tehre who is just like me
[2013-08-27 04:21:59 -0400] javalover: if they want to, they can download my code
[2013-08-27 04:22:40 -0400] awc737: i like it
[2013-08-27 04:22:47 -0400] awc737: flaccid, I added that line chef.log_level = :debug
[2013-08-27 04:22:47 -0400] javalover: I wouldn't be able to code today if it weren't for the open source movement
[2013-08-27 04:23:04 -0400] javalover: and so somehow i'd like to create a project that anyone can contribute to, but still makes money
[2013-08-27 04:23:29 -0400] awc737: http://paste.laravel.com/M7C
[2013-08-27 04:23:33 -0400] awc737: I couldn't grab the whole file
[2013-08-27 04:23:34 -0400] javalover: perhaps it could work like notepad++ in that
[2013-08-27 04:23:39 -0400] javalover: anyone can code an addon
[2013-08-27 04:24:03 -0400] javalover: so you could play my game the way I designed it, or get the addon & play left 4 dead lol
[2013-08-27 04:24:29 -0400] javalover: that would be pretty cool, to play my game & then have something I didn't code which makes my game amazing
[2013-08-27 04:24:34 -0400] javalover: that's the dream right there
[2013-08-27 04:24:51 -0400] awc737: yeah javalover check out #unity3d
[2013-08-27 04:25:01 -0400] javalover: thx awc
[2013-08-27 04:25:04 -0400] javalover: so it is possible then
[2013-08-27 04:25:07 -0400] awc737: yea
[2013-08-27 04:27:00 -0400] awc737: flaccid, maybe I need to destroy / up
[2013-08-27 04:27:14 -0400] awc737: well know, the debug is telling me it's generating the file from php:package...
[2013-08-27 04:27:32 -0400] flaccid: awc737: try a destroy, [2013-08-27T04:22:28+00:00] INFO: Processing template[/etc/php5/cli/php.ini] action create (php::package line 27)
[2013-08-27 04:27:42 -0400] flaccid: [2013-08-27T04:22:28+00:00] DEBUG: template[/etc/php5/cli/php.ini] content has not changed.
[2013-08-27 04:27:49 -0400] awc737: https://github.com/opscode-cookbooks/php/blob/master/recipes/package.rb#L27
[2013-08-27 04:28:13 -0400] awc737: yeah... i would think that means its at least checking my directives for changed content htough
[2013-08-27 04:28:14 -0400] awc737: though
[2013-08-27 04:28:17 -0400] flaccid: thats right and if you set the node attribute correctly its going to write those directives at the end of the file
[2013-08-27 04:28:39 -0400] flaccid: i've seen template resource fail to update a file when content has changed
[2013-08-27 04:29:49 -0400] awc737: maybe I need to try this syntax
[2013-08-27 04:29:50 -0400] awc737:  directives(:shm_size => 128, :enable_cli => 1)
[2013-08-27 04:30:11 -0400] awc737: that's from here: https://github.com/opscode-cookbooks/php#example-1
[2013-08-27 04:31:01 -0400] awc737: or at least instead of "128M" , => 128
[2013-08-27 04:33:14 -0400] awc737: HUZZAH!
[2013-08-27 04:33:55 -0400] awc737: at least now I can not be confused about why that isn't working
[2013-08-27 04:34:10 -0400] awc737: but it doesn't solve my /etc/php5/apache2/php.ini problem :/
[2013-08-27 04:35:03 -0400] flaccid: its under node['php']['directives'], but you also never showed the rendered file..
[2013-08-27 04:35:21 -0400] awc737: rendered file?
[2013-08-27 04:35:27 -0400] flaccid: yes from the template resource
[2013-08-27 04:35:31 -0400] flaccid: you never showed what it rendered
[2013-08-27 04:36:07 -0400] awc737: not sure what you mean
[2013-08-27 04:36:10 -0400] awc737: i used this syntax http://paste.laravel.com/M7G
[2013-08-27 04:36:17 -0400] flaccid: yes it should be 128M not 128 per what php wants. it was probably always rendering what you set after i told you to remove the extra encapsulation
[2013-08-27 04:36:30 -0400] awc737: and checked /etc/php5/cli/php.ini, and it did add the directive at the bottom
[2013-08-27 04:37:08 -0400] flaccid: thats what it would of always done after you removed [13:25] <flaccid> awc737: take out the extra encapsulation, :override_attributes => {
[2013-08-27 04:37:52 -0400] awc737: it didn't when I had => "128M"
[2013-08-27 04:37:55 -0400] awc737: => 128 worked
[2013-08-27 04:38:10 -0400] flaccid: it would of
[2013-08-27 04:38:20 -0400] flaccid: the code doesn't care what the value is
[2013-08-27 04:39:18 -0400] flaccid: what is the difference between /etc/php5/apache2/php.ini and /etc/php5/php.ini
[2013-08-27 04:39:29 -0400] flaccid: if its the same thing, you probably just want to symlink it
[2013-08-27 04:41:20 -0400] awc737: flaccid, you were right => "128M" is at the bottom now
[2013-08-27 04:41:32 -0400] awc737: i think wrong syntax + me not checking the bottom
[2013-08-27 04:41:34 -0400] awc737: sorry about that
[2013-08-27 04:42:22 -0400] flaccid: its ok, hopefully that helped you learn some stuff about chef0r
[2013-08-27 04:42:34 -0400] awc737: it definitely did
[2013-08-27 04:42:43 -0400] awc737: quick Q, is the :key vs "key" a ruby thing
[2013-08-27 04:42:47 -0400] awc737: never used :key with json
[2013-08-27 04:43:16 -0400] awc737: also your github repo links have helped
[2013-08-27 04:44:22 -0400] awc737: but about the difference between cli/ apache/
[2013-08-27 04:44:45 -0400] awc737: /etc/php5/apache2/ is not created by the php package in linux at all
[2013-08-27 04:45:16 -0400] awc737: apache2's mod_php5 adds that in
[2013-08-27 04:45:48 -0400] awc737: https://github.com/opscode-cookbooks/apache2/blob/master/recipes/mod_php5.rb
[2013-08-27 04:45:52 -0400] awc737: so package "libapache2-mod-php5"
[2013-08-27 04:46:15 -0400] awc737: it looks like that's as much as it does... installs that package
[2013-08-27 04:47:42 -0400] flaccid: that file is not in the package, http://packages.ubuntu.com/lucid/amd64/libapache2-mod-php5/filelist
[2013-08-27 04:47:55 -0400] flaccid: i'm not the best help here, i loathe php
[2013-08-27 04:48:52 -0400] awc737: lol
[2013-08-27 04:48:59 -0400] awc737: you've helped a lot
[2013-08-27 04:53:01 -0400] awc737: flaccid, it's actually been a bug for a very long time :/ http://tickets.opscode.com/browse/COOK-545
[2013-08-27 04:53:24 -0400] awc737: "Just to make sure I'm clear, you're saying that /etc/php5/apache2/php.ini is handled by the apapche2::mod_php5 recipe and /etc/php5/cli/php.ini is handled by php cookbook?"
[2013-08-27 04:53:30 -0400] awc737: "...we're just missing a php.ini template in apache2::mod_php5."
[2013-08-27 04:54:13 -0400] awc737: I like this workaround though: http://tickets.opscode.com/browse/COOK-545?focusedCommentId=37254&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-37254
[2013-08-27 04:55:25 -0400] awc737: so can that just go right into a recipes/default.rb I create?
[2013-08-27 04:57:27 -0400] flaccid: awc737: that doesn't look like the same thing. i didn't not check the apache2 cookbook at all.
[2013-08-27 04:57:57 -0400] awc737: so you did check it?
[2013-08-27 04:58:29 -0400] flaccid: no
[2013-08-27 04:58:34 -0400] flaccid: too busy
[2013-08-27 04:58:50 -0400] awc737: but, that's the issue i'm describing. cli/php.ini is handled by php cookbook
[2013-08-27 04:59:12 -0400] awc737: apache2/php.ini is handled by apache2::mod_php5, but that recipe has no template or method of overriding values
[2013-08-27 04:59:55 -0400] flaccid: it is similar yes but because of the overlap what should manage what is questionable
[2013-08-27 05:00:26 -0400] awc737: yes your right
[2013-08-27 05:00:53 -0400] awc737: it probably must be apache2::mod_php though, because the file does not exist until that point. and that package generates it
[2013-08-27 05:00:55 -0400] flaccid: so you can persue the bugs, consider contribution etc.
[2013-08-27 05:01:14 -0400] awc737: and, i know there are people that use a different cli config from their apache config
[2013-08-27 05:01:14 -0400] flaccid: a maint script in the package may generate it yes
[2013-08-27 05:01:47 -0400] awc737: sure, I'll try to copy what the php package did into apache2::mod_php if I can, and open an issue
[2013-08-27 05:03:10 -0400] flaccid: looks like a an issue is already open. it would be better to append and help with the solution
[2013-08-27 05:06:37 -0400] awc737: yeah that's what I mean
[2013-08-27 05:06:47 -0400] awc737: can I append to a file? with file 'x' do
[2013-08-27 05:07:17 -0400] flaccid: there is a way to edit in chef, but its not good for a newbie. use the execute resource instead
[2013-08-27 05:07:51 -0400] awc737: I was looking at this http://docs.opscode.com/resource_file.html
[2013-08-27 05:13:23 -0400] flaccid: awc737: that would be the whole file
[2013-08-27 05:14:06 -0400] awc737: something like this?
[2013-08-27 05:14:06 -0400] awc737: http://paste.laravel.com/M89
[2013-08-27 05:14:18 -0400] hapxD: Hi , is it possible override default cookbook parameters in the solo.rb using chef-solo?
[2013-08-27 05:14:30 -0400] hapxD: instead of using the json
[2013-08-27 05:14:49 -0400] awc737: sorry "export /etc/php5/apache2/php.ini" on the first content
[2013-08-27 05:15:13 -0400] awc737: no i have no idea what i'm doing
[2013-08-27 05:16:37 -0400] flaccid: awc737: do you want it to be the same as the normal php.in
[2013-08-27 05:17:05 -0400] awc737: the normal php.ini? the cli one? probably not just in case
[2013-08-27 05:17:11 -0400] awc737: we run php commands from cli also
[2013-08-27 05:17:37 -0400] flaccid: awc737: content option is a string not a file path
[2013-08-27 05:18:08 -0400] flaccid: you could probably use IO and open it to use that option
[2013-08-27 05:18:28 -0400] awc737: I see this chef apach2 php.ini
[2013-08-27 05:19:30 -0400] awc737: https://github.com/juanje/chef/blob/c86e53d48d637cdf056588587972a7477d27f985/chef/spec/unit/util/file_edit_spec.rb#L120
[2013-08-27 05:19:32 -0400] awc737: not sure how to use it
[2013-08-27 05:21:03 -0400] flaccid: awc737: content { IO.read("foo") }
[2013-08-27 05:21:12 -0400] flaccid: and you could append to that in the one line with more foobar
[2013-08-27 05:23:18 -0400] awc737: hmm ok
[2013-08-27 05:23:23 -0400] awc737: i suck at bash and ruby
[2013-08-27 05:23:39 -0400] awc737: lol but I just thought, this looks easier would it work?
[2013-08-27 05:23:41 -0400] flaccid: good time to learn :)
[2013-08-27 05:23:50 -0400] awc737: in my recipe: http://paste.laravel.com/M8g
[2013-08-27 05:24:07 -0400] awc737: i think you suggested this forever ago
[2013-08-27 05:24:25 -0400] awc737: so long as I have cookbooks/mine/templates/default/php.ini.erb ?
[2013-08-27 05:24:35 -0400] flaccid: sure, but it would require fork of the cookbook and be teh same as the normal php.ini which you didn't want
[2013-08-27 05:24:46 -0400] flaccid: doing symlink resource is easiest
[2013-08-27 05:25:04 -0400] awc737: it's my own cookbook
[2013-08-27 05:25:10 -0400] awc737: and my own template
[2013-08-27 05:25:31 -0400] flaccid: this is jtimberman's original suggestion he advised early with 2 lines ..
[2013-08-27 05:26:02 -0400] awc737: yeah :)
[2013-08-27 05:26:12 -0400] awc737: lol I didn't feel "ready" to make a recipe
[2013-08-27 05:26:20 -0400] awc737: but after looking at the alternatives
[2013-08-27 05:26:34 -0400] flaccid: its ok, you went through stuff to learn and understand which is good
[2013-08-27 05:28:32 -0400] awc737: yeah very true and i owe you
[2013-08-27 05:28:37 -0400] awc737: this though: template "/ect/php5/apache2/php.ini" do
[2013-08-27 05:28:48 -0400] awc737: FATAL: Chef::Exceptions::EnclosingDirectoryDoesNotExist: template[/ect/php5/apache2/php.ini]
[2013-08-27 05:29:13 -0400] flaccid: awc737: use directory resource to ensure the dir is created/exists
[2013-08-27 05:29:42 -0400] awc737: directory resource?
[2013-08-27 05:30:37 -0400] flaccid: yes
[2013-08-27 05:31:38 -0400] awc737: directory "/ect/php5/apache2/php.ini" do ?
[2013-08-27 05:32:05 -0400] flaccid: thats not a directory
[2013-08-27 05:32:17 -0400] flaccid: directory "/etc/php5/apache2"
[2013-08-27 05:33:29 -0400] awc737: i've read both these: http://docs.opscode.com/resource.html and http://docs.opscode.com/essentials_cookbook_templates.html
[2013-08-27 05:34:03 -0400] awc737: would I encapsulate the template within the directory block?
[2013-08-27 05:35:47 -0400] flaccid: no resources are never nested
[2013-08-27 06:18:41 -0400] awc737: flaccid, still around?
[2013-08-27 06:20:10 -0400] flaccid: awc737: yeah coz i'm in australia heh
[2013-08-27 06:21:45 -0400] awc737: lol i wish i was i might actually wake up on time
[2013-08-27 06:22:06 -0400] awc737: i had a phone call went afk
[2013-08-27 06:22:22 -0400] awc737: but I'm just trying this above my template block
[2013-08-27 06:22:22 -0400] awc737: node.set['php5']['apache2_dir'] = "/ect/php5/apache2/php.ini"
[2013-08-27 06:22:50 -0400] awc737: oops without the php.ini
[2013-08-27 06:24:13 -0400] CurlChef: hi there, anyone ever tried to get the list of organizations from hosted chef?
[2013-08-27 06:24:53 -0400] CurlChef: the root starts at <org_name>/nodes etc.
[2013-08-27 06:25:19 -0400] awc737: node.set['php5']['apache2_dir'] = "/ect/php5/apache2/php.ini"
[2013-08-27 06:25:21 -0400] awc737: ooops
[2013-08-27 06:38:44 -0400] awc737: flaccid, this didn't work
[2013-08-27 06:38:45 -0400] awc737: http://paste.laravel.com/M8I
[2013-08-27 06:41:47 -0400] awc737: FATAL: Chef::Exceptions::EnclosingDirectoryDoesNotExist: template[/ect/php5/apache2/php.ini]
[2013-08-27 06:46:53 -0400] flaccid: awc737: no need to make an attribute
[2013-08-27 06:47:08 -0400] flaccid: you also don't set attributes in recipes like that
[2013-08-27 06:47:23 -0400] flaccid: [15:32] <flaccid> directory "/etc/php5/apache2" in recipe before template resource
[2013-08-27 06:48:05 -0400] awc737: after node set?
[2013-08-27 06:50:21 -0400] flaccid: you don't need to set any node attributes
[2013-08-27 06:50:29 -0400] awc737: flaccid, put the template inside the directory block?
[2013-08-27 06:50:42 -0400] flaccid: arggh no
[2013-08-27 06:50:52 -0400] flaccid: directory block first, then template block
[2013-08-27 06:50:59 -0400] flaccid: within recipe
[2013-08-27 06:54:25 -0400] awc737: what does the directory block even acomplish
[2013-08-27 06:55:18 -0400] flaccid: creating a directory.
[2013-08-27 06:55:53 -0400] awc737: http://paste.laravel.com/M8Z
[2013-08-27 06:56:32 -0400] flaccid: awc737: looks ok but the modes are wack
[2013-08-27 06:56:51 -0400] flaccid: for the 3rd time, [15:32] <flaccid> directory "/etc/php5/apache2"
[2013-08-27 06:56:54 -0400] flaccid: one line.
[2013-08-27 06:59:13 -0400] awc737: and then template "/etc/php5/apache2/php.ini" do
[2013-08-27 06:59:16 -0400] awc737: or does it put me in that dir
[2013-08-27 07:00:12 -0400] awc737: so template "php.ini" do
[2013-08-27 07:03:19 -0400] flaccid: awc737: please refer to the docs. you provide absolute path for these. the idea is to create the directory before the template
[2013-08-27 07:04:58 -0400] awc737: lol the docs http://docs.opscode.com/resource_directory.html
[2013-08-27 07:05:50 -0400] flaccid: awc737: nothing much funny about it. you referred to the directory resource doc when you question is about template resource.
[2013-08-27 07:06:05 -0400] flaccid: awc737: http://docs.opscode.com/resource_template.html
[2013-08-27 07:06:28 -0400] awc737: they don't show one liners
[2013-08-27 07:06:44 -0400] awc737: i was asking about directory "/etc/php5/apache2"
[2013-08-27 07:07:19 -0400] flaccid: they don't need to show one liners. if you don't specify options, the resource is run with the default options specificed in the doc.
[2013-08-27 07:08:27 -0400] awc737: k and I don't know ruby so that's probably a thing
[2013-08-27 07:09:05 -0400] awc737: I did need to add the 0755 bit back though, i didn't have permission into the dir
[2013-08-27 07:09:40 -0400] awc737: and my directive is updated
[2013-08-27 07:09:57 -0400] awc737: and I can sleep now, flaccid you saved my arse boss wanted to see this in the morning
[2013-08-27 07:12:54 -0400] flaccid: awc737: chef runs as root so it can create a dir whatever the default mode is
[2013-08-27 07:16:40 -0400] abrkn: I'm trying to install a chef server and so far everything's gone well. The only issue is that knife configure --initial did not create a Cheffile nor a Cheffile.lock. Which part of the process is supposed to create these?
[2013-08-27 07:21:53 -0400] hapxD: Hi , RE chef-solo, is it possible to override default attributes without the json such as using just the -c solo.rb ?
[2013-08-27 07:31:54 -0400] flaccid: hapxD: i have not seen such a directive for that file
[2013-08-27 07:33:29 -0400] hapxD: ok thanks
[2013-08-27 08:03:39 -0400] abrkn: Where can I set the hostname for knife?
[2013-08-27 08:04:19 -0400] flaccid: hmm, knife has a hostname?
[2013-08-27 08:05:14 -0400] abrkn: librarian, i mean
[2013-08-27 08:05:18 -0400] abrkn: NFO: Uploading c:/Users/Andreas/.librarian/tmp/chef/integration/knife/install/428ac82433f629324f8440ff1ab4e9bf/aws/resources/ebs_volume.rb checksum hex = 03b627e2b57831333ed8a99f90b89c8) to https://ip-10-0-1-101.eu-west-1.compute.internal:443/bookshelf/organization-00000000000000000000000000000000/checksum-03b6527e2
[2013-08-27 08:05:25 -0400] abrkn: i'd like to change the hostname being used
[2013-08-27 08:05:37 -0400] abrkn: ip-10-0-1-101... is not the one i specified in knife.rb
[2013-08-27 08:05:42 -0400] abrkn: so i assume it's pulled from the server
[2013-08-27 08:09:35 -0400] abrkn: i've checked that /etc/hostname is correct
[2013-08-27 08:10:57 -0400] abrkn: http://tickets.opscode.com/browse/CHEF-4049 <-
[2013-08-27 08:12:41 -0400] flaccid: abrkn: there is more to changing a hostname than modifying that fail
[2013-08-27 08:12:44 -0400] flaccid: *file
[2013-08-27 08:14:44 -0400] abrkn: i both changed that file and ran sudo hostname fqdn
[2013-08-27 08:15:17 -0400] flaccid: abrkn: can you show your knife.rb
[2013-08-27 08:16:56 -0400] abrkn: flaccid: i'm currently trying these tips: http://serverfault.com/questions/483957/chef-connection-refused-for-cookbook-upload
[2013-08-27 08:17:23 -0400] abrkn: chef_server_url          'https://chef.justcoin.internal'
[2013-08-27 08:17:23 -0400] flaccid: abrkn: doesn't look like the problem you reported
[2013-08-27 08:18:07 -0400] abrkn: actually, it was! nice
[2013-08-27 08:18:33 -0400] flaccid: huh
[2013-08-27 08:18:38 -0400] flaccid: well i use this to change hostname properly https://github.com/flaccid/cookbooks/blob/master/cookbooks/system/recipes/hostname.rb
[2013-08-27 08:46:56 -0400] abrkn: anyone know how to solve this? https://gist.github.com/abrkn/771e57a0c3771e11ebe8
[2013-08-27 09:01:12 -0400] flaccid: abrkn: see if the same thing happens with -I instead of --image
[2013-08-27 09:26:41 -0400] abrkn: didnt help, but i found the bug. if you omit "region", then you receive an error that you omitted "image". sigh
[2013-08-27 09:27:19 -0400] flaccid: abrkn: default region with ec2 is us-east-1 but yeah usability bug
[2013-08-27 12:21:48 -0400] erthad_: hiall
[2013-08-27 12:22:07 -0400] erthad_: what is the recommended way to specify file mode? is it "0755" or 00755?
[2013-08-27 12:25:37 -0400] yfeldblum: erthad_, it's up to your taste, but strings can be parsed the way you would expect, while numeric literals may be more confusing to work with
[2013-08-27 12:27:12 -0400] erthad_: yfeldblum: I've been always using strings but noticed that chef code completion for sublime uses numbers instead so I wondered if it is recommended to stick to that approach
[2013-08-27 12:28:10 -0400] zaargy: see foodcritic rule fc006
[2013-08-27 12:28:18 -0400] zaargy: 'FC006: Mode should be quoted or fully specified when setting file permissions
[2013-08-27 12:31:42 -0400] flaccid: what do you mean by 'way' to specify?
[2013-08-27 12:37:44 -0400] tugce: Hello, is it possible to get information from ldap server when using open source chef-server? I googled it but couldn't find any document about it.
[2013-08-27 12:46:46 -0400] abrkn: im modifying a template in a cookbook for testing but the changes are not showing up after chef-client even after i re-upload the cookbook. is there some caching i can get rid of?
[2013-08-27 12:47:01 -0400] nimbius: hi chef, the webui at 9462 is returning "request entity too large" when i try to use knife to bootstrap a node.
[2013-08-27 12:47:07 -0400] nimbius: how do i increase the upload size?
[2013-08-27 13:03:35 -0400] erthad_: zaargy: I see, so it looks like both approaches are fine
[2013-08-27 13:03:38 -0400] erthad_: thanks
[2013-08-27 13:07:29 -0400] pabst^: Does anyone have any decent links to workflow examples with multiple admins? I have to give a presentation this week and feel like I have some holes in our processes.
[2013-08-27 13:11:18 -0400] jonlives: pabst^: http://www.slideshare.net/mcdonnps/lessons-from-etsy-avoiding-kitchen-nightmares-chefconf-2012 and http://www.slideshare.net/jonlives/michelin-starred-cooking-with-chef are how we manage that at Etsy
[2013-08-27 13:11:32 -0400] jonlives: video for the former: http://www.youtube.com/watch?v=nSnJCJiZDDU
[2013-08-27 13:13:07 -0400] jwitrick: question. More about ruby. Since I started using berkshelf and other gems, the json formatting of knife has been horrible. Does anyone know of a flag i can put some where to use the json pretty_formatting ?
[2013-08-27 13:18:01 -0400] flaccid: jwitrick: http://stackoverflow.com/questions/86653/how-can-i-pretty-format-my-json-output-in-ruby-on-rails
[2013-08-27 13:18:13 -0400] flaccid: JSON.pretty_generate(my_json)
[2013-08-27 13:18:28 -0400] jwitrick: correct. but i want it to happen when using knife
[2013-08-27 13:18:51 -0400] flaccid: jwitrick: if it doesn't do it already, then it doesn't do it already
[2013-08-27 13:18:54 -0400] jwitrick: since i installed updated gems the json output from knife is now one big blob and not json_pretty
[2013-08-27 13:19:45 -0400] flaccid:  could be a bug if it changed or you might need to contrib
[2013-08-27 13:20:23 -0400] jwitrick: ya. thats what i am working on now. i was just hoping someone else had already solved it and had a nice easy flag
[2013-08-27 13:20:24 -0400] jwitrick: :)
[2013-08-27 13:20:39 -0400] zts: jwitrick: this doesn't help, but I'm using berkshelf (2.0.9) with chef 11.6.0, and the output is pretty
[2013-08-27 13:21:32 -0400] jwitrick: ya i think its has to due with some of the gems I am using. json (1.8.0, 1.7.7)
[2013-08-27 13:21:33 -0400] jwitrick: multi_json (1.7.9, 1.7.8, 1.7.7, 1.7.6, 1.7.3, 1.7.2)
[2013-08-27 13:22:49 -0400] subdigital: when using `knife solo cook <host>` where do I specify where the cookbooks are located?  Do they get copied up automatically from the local machine?
[2013-08-27 13:23:19 -0400] pabst^: jonlives: Thank you!
[2013-08-27 13:23:25 -0400] subdigital: I'm getting an error that my cookbook can't be found, wondering if I'm missing some configuration, or perhaps a manual step somewhere
[2013-08-27 13:23:54 -0400] jonlives: pabst^: np  :)
[2013-08-27 13:24:23 -0400] gchristensen: pabst^: ohai :)
[2013-08-27 13:24:29 -0400] teukka: subdigital: `cookbook_path` option in .chef/knife.rb. but it should also work automatically if you use berkshelf of librarian
[2013-08-27 13:24:35 -0400] JuriadoBalzac: Heyo! Total noob here. I have a file on one of our servers that is updated through chef. Is there a knife command where I can see where that file is defined?
[2013-08-27 13:24:53 -0400] flaccid: JuriadoBalzac: not afaik
[2013-08-27 13:24:53 -0400] teukka: subdigital: assuming you are using v0.3.0
[2013-08-27 13:25:04 -0400] subdigital: teukka: that's the remote path?   (I just installed this yesterday, so yes latest)
[2013-08-27 13:25:12 -0400] JuriadoBalzac: flaccid: Hm, crap. Thanks though!
[2013-08-27 13:25:33 -0400] subdigital: I am not yet using Berkshelf, just created a simple nginx cookbook using `knife cookbook create nginx`
[2013-08-27 13:25:44 -0400] teukka: subdigital: no, that's the local path. relative or absolute. or even an array of paths
[2013-08-27 13:25:57 -0400] pabst^: gchristensen: are you stalking me? :D
[2013-08-27 13:26:06 -0400] teukka: subdigital: knife-solo uploads the cookbooks to the node and configures chef solo there
[2013-08-27 13:26:21 -0400] gchristensen: pabst^: I think *you* are stalking me :) I've been idling #chef for like a year :)
[2013-08-27 13:26:32 -0400] subdigital: ok it seems to have the correct paths in here ["cookbooks", "site-cookbooks"]
[2013-08-27 13:26:41 -0400] subdigital: these get copied to the remote server?
[2013-08-27 13:27:02 -0400] pabst^: gchristensen: you win. I stalk you better on Facebook though :)
[2013-08-27 13:27:07 -0400] teukka: subdigital: yeah, seems right. run with `-VV` option to get a lots of debug output. there you see what is happening
[2013-08-27 13:27:11 -0400] flaccid: see the option, -o with knife
[2013-08-27 13:27:16 -0400] gchristensen: pabst^: guaranteed!
[2013-08-27 13:28:43 -0400] pabst^: My challenge: Teach my entire team to use chef. From 0-chef in 6 hours.
[2013-08-27 13:29:07 -0400] flaccid: thats a long time
[2013-08-27 13:30:00 -0400] pabst^: flaccid: I have a fairly knowledgable team as well, none have ever seen chef, but I have faith in them. They understand the idea. They have been managing the infrastructure with Makefiles and perl scripts fairly well, it just isn't scalable long term.
[2013-08-27 13:31:25 -0400] pabst^: gchristensen: solve your data pushing problem yet?
[2013-08-27 13:31:45 -0400] gchristensen: pabst^: lol, my ElasticSearch cluster corrupts itself in minutes
[2013-08-27 13:33:46 -0400] pabst^: gchristensen: Our daily ETL is ~ 1.5TB, but not to ElasticSearch. Everything ends up in Vertica, Oracle, and HDFS/Hive
[2013-08-27 13:34:13 -0400] subdigital: teukka: ok I see that rsync is running and trying to copy up the cookbooks.  After each run it's removing my local nginx cookbook I just created.  0_o
[2013-08-27 13:34:37 -0400] flaccid: good luck
[2013-08-27 13:35:54 -0400] teukka: subdigital: ouch. that's probably the librarian integration. remove the Cheffile
[2013-08-27 13:36:08 -0400] gchristensen: pabst^: gotcha, our is looking like it'd probably be closer to 45GB a day, but we only need a few hours rapidly available at a time
[2013-08-27 13:36:27 -0400] teukka: subdigital: or use site-cookbooks directory for your own cookbooks. that's a common usage pattern
[2013-08-27 13:36:45 -0400] flaccid: librarian or berkshelf is not a service though
[2013-08-27 13:37:31 -0400] subdigital: there's no Cheffile in this folder
[2013-08-27 13:38:01 -0400] teukka: subdigital: Berksfile? but it should not default to installing to cookbooks/
[2013-08-27 13:38:14 -0400] subdigital: there is a Berksfile
[2013-08-27 13:38:27 -0400] subdigital: knife cookbook create puts the cookbook in cookbooks/
[2013-08-27 13:39:05 -0400] subdigital: unless I specify -o
[2013-08-27 13:39:12 -0400] flaccid: yua
[2013-08-27 13:39:50 -0400] teukka: subdigital: oh, the berkshelf defaults to ./cookbooks/ with the default config. I forgot. you can change it in knife.rb
[2013-08-27 13:40:13 -0400] subdigital: ok if I move my cookbook in to site-cookbooks it works
[2013-08-27 13:40:26 -0400] subdigital: I'm trying hard to learn chef 1 concept at a time
[2013-08-27 13:40:39 -0400] subdigital: first rejecting server, knife, berkshelf, etc
[2013-08-27 13:40:42 -0400] teukka: subdigital: knife cookbook create happens to use the first entry of `cookbook_path`. the command is much older thatn librarian or berkshelf
[2013-08-27 13:40:43 -0400] subdigital: and just doing chef-solo manually
[2013-08-27 13:40:46 -0400] flaccid: its not actually chef, its whatever tool you are using
[2013-08-27 13:40:54 -0400] hasues: So where does one usually install berkshelf, on the Chef server, a seperate server, workstation?
[2013-08-27 13:41:11 -0400] bean: i use berkshelf on my workstation
[2013-08-27 13:41:19 -0400] subdigital: teukka: that makes sense, thanks so much for your assistance
[2013-08-27 13:41:43 -0400] hasues: bean: where do you store your repository of recipes?  in git?
[2013-08-27 13:41:45 -0400] teukka: subdigital: happy to help =)
[2013-08-27 13:41:54 -0400] bean: each cb in its own repo, on an internal git server.
[2013-08-27 13:42:28 -0400] flaccid: thats the way to go heh
[2013-08-27 13:42:41 -0400] flaccid: minus -internal
[2013-08-27 13:42:43 -0400] hasues: bean: hm, okay.  I'm trying to see the big picture of how the pieces relate so I can build a chef environment.
[2013-08-27 13:43:09 -0400] ipmb: hi btm! could you add a link to the new logs to the topic? https://botbot.me/freenode/chef/
[2013-08-27 13:43:12 -0400] hasues: I stood up a Chef server, and a git server.  I'm trying to see where they plugin, if it is from the server level or the workstation level.  Sounds like it is the workstation level.
[2013-08-27 13:44:22 -0400] gchristensen: hasues: chef-server has nothing to do with git, its the workstation / operator that does
[2013-08-27 13:44:35 -0400] hasues: gchristensen: thanks.
[2013-08-27 13:44:38 -0400] ipmb: btm: https://botbot.me/freenode/chef-hacking/ is setup as well
[2013-08-27 13:45:34 -0400] flaccid: ipmb: what is this crap?
[2013-08-27 13:45:50 -0400] flaccid: ipmb: this is #chef dude
[2013-08-27 13:46:12 -0400] ipmb: flaccid: btm asked me to add it
[2013-08-27 13:46:28 -0400] flaccid: ipmb: not sure what the means y0
[2013-08-27 13:46:43 -0400] bean: its just logging the chats, flaccid
[2013-08-27 13:46:44 -0400] gchristensen: ipmb: its neat that its real-time.
[2013-08-27 13:46:49 -0400] bean: agree.
[2013-08-27 13:46:56 -0400] bean: cool yo jets, flaccid
[2013-08-27 13:46:57 -0400] gchristensen: though I wish my nick wasn't yellow ;)
[2013-08-27 13:47:06 -0400] flaccid: big deal
[2013-08-27 13:47:11 -0400] hasues: gchristensen: does one usually use git or berkshelf or do they use both?
[2013-08-27 13:47:16 -0400] bean: both.
[2013-08-27 13:47:19 -0400] gchristensen: hasues: generally both
[2013-08-27 13:47:31 -0400] gchristensen: and I'd strongly recommend someone only using one or neither to use both
[2013-08-27 13:47:53 -0400] flaccid: wt
[2013-08-27 13:48:24 -0400] flaccid: i strongly recommend people learning how to use both
[2013-08-27 13:48:25 -0400] gchristensen: ipmb: woah, the nick [o__o] makes it perfect.
[2013-08-27 13:49:07 -0400] ipmb: :) thx
[2013-08-27 13:49:52 -0400] hasues: gchristensen: using one or neither to use both?
[2013-08-27 13:50:49 -0400] gchristensen: hasues: I strongly recommend the use of both git and berkshelf ( or git and librarian, if that's your thing )
[2013-08-27 13:51:09 -0400] hasues: gchristensen: okay.
[2013-08-27 14:05:34 -0400] siezer: hasues develop your cookbooks, tracking them in git. when you want to do a "release", bump the version number in your metadata.rb (use the semver scheme), then publish an "artifact" to chef-server with berkshelf (berks upload)
[2013-08-27 14:06:09 -0400] hasues: siezer: thanks.  I'm a bit overwhelmed at where to begin.  I have a bit of reading to do.
[2013-08-27 14:06:15 -0400] siezer: the current commit in git master isn't necessarily whats on chef-server
[2013-08-27 14:06:43 -0400] hasues: siezer: makes sense.
[2013-08-27 14:06:51 -0400] siezer: equate a cookbook to a programming language module (perl module, ruby gem, java module)
[2013-08-27 14:07:05 -0400] siezer: a dev may be working on it, and have a branch and even a new git master
[2013-08-27 14:07:19 -0400] siezer: but until they publish it to cpan, its still in "source" form
[2013-08-27 14:08:16 -0400] siezer: I almost want to start "packaging" cookbooks in some sort of archive format to drive home this artifact idea
[2013-08-27 14:10:13 -0400] pabst^: god I hate windows
[2013-08-27 14:10:57 -0400] abrkn: i'm using a recipe that restarts a service as a notify, and i'd like it not to. is there a way?
[2013-08-27 14:11:42 -0400] fishGoM00: don't notify it?
[2013-08-27 14:12:13 -0400] abrkn: hmm, was hoping not to fork the cookbook
[2013-08-27 14:13:44 -0400] zaargy: write a wrapper cookbook and use chef rewind
[2013-08-27 14:13:48 -0400] bean: eh, probably as easy as forking and using chef rewind
[2013-08-27 14:13:49 -0400] bean: yep
[2013-08-27 14:18:23 -0400] mtpereira: I didn't know rewind, it seems to be very useful! thank you
[2013-08-27 14:20:17 -0400] flaccid: ruby is all about hacks hehe
[2013-08-27 14:20:40 -0400] jtimberman: more accurately it's about whipupitude and manipulexity :)
[2013-08-27 14:26:41 -0400] mattjalexander: @jtimberman, in your vagrant-cookbook, why do you not provide defaults for url & checksum?
[2013-08-27 14:27:02 -0400] mattjalexander: is that just so you don't have to keep it updated whenever hashicorp changes links?
[2013-08-27 14:31:06 -0400] techminer: Is there a cookbook resource to recursively copy a directory from the cookbook to a node, like cookbook_file?
[2013-08-27 14:32:51 -0400] mattjalexander: http://docs.opscode.com/chef/resources.html#remote-directory ?
[2013-08-27 14:34:25 -0400] zaargy: if it's lots of files it's going to be really slow though
[2013-08-27 14:34:32 -0400] techminer: mattjalexander:  thanks that's what I was looking for
[2013-08-27 14:34:33 -0400] zaargy: just zip them up and unzip on the other end
[2013-08-27 14:34:46 -0400] techminer: less than ten files
[2013-08-27 14:34:57 -0400] zaargy: depends on size of files too
[2013-08-27 14:35:03 -0400] zaargy: if they are big files i wouldn't be serving them from chef
[2013-08-27 14:35:07 -0400] shay: hi, i am using chef v 11 and have a problem with some attributes. in the attributes file i set them to false and in the role i overwrite them to true. but this does not work. any idea?
[2013-08-27 14:35:10 -0400] shay: [["set_unless_enabled?", false],  ["default", :not_present],  ["env_default", :not_present],  ["role_default", :not_present],  ["force_default", :not_present],  ["normal", false],  ["override", :not_present],  ["role_override", true],  ["env_override", :not_present],  ["force_override", :not_present],  ["automatic", :not_present]]
[2013-08-27 14:35:32 -0400] shay: but it is still set to false ...
[2013-08-27 14:38:53 -0400] jtimberman: mattjalexander: because i don't want to maintain and have to release new versions every time vagrant has a new release.
[2013-08-27 14:39:26 -0400] jtimberman: and you don't *have* to download from vagrant's site. e.g., i put the files on a share on my network so it's faster when i'm testing.
[2013-08-27 14:41:44 -0400] mattjalexander: fair enough
[2013-08-27 14:41:55 -0400] mattjalexander: just didn't want to waste time writing up a pull request that would never get pulled :p
[2013-08-27 14:42:18 -0400] eugenmayer: hello. Trying a bit complicated setup to connect to my chef server from the client
[2013-08-27 14:42:37 -0400] btm: I see we're hitting to topic length maximum now :)
[2013-08-27 14:42:48 -0400] gchristensen: btm: you need a URL shortener :)
[2013-08-27 14:42:57 -0400] eugenmayer: i use a remote port forward to be able to connect. Somehow, i get a ERROR: Connection refused connecting by the client - how would i debug this on the server?
[2013-08-27 14:43:28 -0400] thelonecabbage: i'm going to loose my mind
[2013-08-27 14:43:39 -0400] thelonecabbage: has anyone here used application_python cookbook?
[2013-08-27 14:44:03 -0400] btm: gchristensen: I need this to make obvious sense to everyone [ 'docs', 'tickets', 'wiki', 'lists', 'cookbooks', 'status' ].opscode.com ;)
[2013-08-27 14:44:15 -0400] eugenmayer: thelonecabbage: after banging my head with puppet "apps" using boxen for OSX i did not even try to use ti on chef yet :)
[2013-08-27 14:44:44 -0400] thelonecabbage: eugenmayer: argh....
[2013-08-27 14:44:55 -0400] jtimberman: mattjalexander: Indeed :).
[2013-08-27 14:45:18 -0400] thelonecabbage: i'm ONLY trying to run the example given in the cookbook
[2013-08-27 14:45:23 -0400] thelonecabbage: README.md
[2013-08-27 14:45:31 -0400] thelonecabbage: and it keeps complaining about /etc/chef
[2013-08-27 14:45:31 -0400] gchristensen: btm: cooki.ng/docs cooki.ng/tickets cooki.ng/wiki? *shrugs* that is tough :)
[2013-08-27 14:45:51 -0400] eugenmayer: thelonecabbage: well heads up - what i def. learned after using puppet for 1,5 months to setup boxen is - chef is so freaking much better.
[2013-08-27 14:46:13 -0400] gchristensen: cooki.ng is not available :(
[2013-08-27 14:46:23 -0400] thelonecabbage: eugenmayer: I'm not using puppet
[2013-08-27 14:46:26 -0400] thelonecabbage: this is chef
[2013-08-27 14:46:27 -0400] btm: gchristensen: actually I have http://ckbk.it personally redirect to cookbooks.opscode.com already (and ckbk.it/a_cookbook will redirect to a specific cookbook there)
[2013-08-27 14:46:32 -0400] gchristensen: nice
[2013-08-27 14:46:36 -0400] eugenmayer: thelonecabbage: never do :)
[2013-08-27 14:46:50 -0400] btm: gchristensen: I could do something like ckbk.it/c/chef to go to cookbooks.opscode.com/chat/chef
[2013-08-27 14:47:13 -0400] thelonecabbage: I don't understand.  I should use puppet or chef?
[2013-08-27 14:47:14 -0400] gchristensen: I've set up my own URL shortener that resets every day at midnight from 0, so when I open mybrowser I just enter the URL # to save on mousing and typing
[2013-08-27 14:47:26 -0400] EnriqueCadalso: Hi, I want to update dynamically cookbook files before provisioning. How can I run code in the provisioning process, in the provisioning side, to modify a file/template before deploying it to the provisioned server?
[2013-08-27 14:47:29 -0400] btm: even http://ckbk.it/chat/chef is a lot shorter.
[2013-08-27 14:48:06 -0400] jtimberman: btm: drop the http:// ;)
[2013-08-27 14:49:50 -0400] thelonecabbage: eygebnater:  I don't understand.  I should use puppet or chef?
[2013-08-27 14:51:34 -0400] shay: hi, i am using chef v 11 and have a problem with some attributes. in the attributes file i set them to false and in the role i overwrite them to true. but this does not work. any idea?
[2013-08-27 14:51:36 -0400] shay: [["set_unless_enabled?", false],  ["default", :not_present],  ["env_default", :not_present],  ["role_default", :not_present],  ["force_default", :not_present],  ["normal", false],  ["override", :not_present],  ["role_override", true],  ["env_override", :not_present],  ["force_override", :not_present],  ["automatic", :not_present]]
[2013-08-27 14:51:39 -0400] EnriqueCadalso: Ok, again. I want to update dynamically cookbook files before provisioning. Is there any way to run code in the provisioning process, in the provisioning side, to modify a file/template before deploying it to the provisioned server? I just need a name of a resource or some pointers so I can research the exact answer. Is ruby_block supposed to run on the provisioning side?
[2013-08-27 14:53:06 -0400] adnichols: EnriqueCadalso I'm not sure I understand what you are asking for. Can you give a specific example of what you mean by dynamically updating cookbook files?
[2013-08-27 14:53:54 -0400] EnriqueCadalso: adnichols: I have a template that I want to update including content from a downloaded file just before provisioning.
[2013-08-27 14:53:57 -0400] adnichols: templates are erb, so you don't modify them - they contain code that allows them to be dynamically rendered before they are written to the node
[2013-08-27 14:54:10 -0400] mattjalexander: well, you could run chef on your chef server before you run chef :p
[2013-08-27 14:54:23 -0400] adnichols: Ah ok, so you want to download a file and then include the contents of that file inside a template?
[2013-08-27 14:55:10 -0400] EnriqueCadalso: yes, basically, I need to make some processing of the file, it is xml format and I need to convert it to json before deploying to the server
[2013-08-27 14:55:53 -0400] eugenmayer: which log to check if a client get connection refused?
[2013-08-27 14:56:07 -0400] eugenmayer: var log chef client.log seems to log nothing
[2013-08-27 14:56:51 -0400] adnichols: EnriqueCadalso could you pull the file down inside a ruby_block, perform the conversion & then store for use inside the template? Others probably have a more elegant solution
[2013-08-27 14:57:39 -0400] EnriqueCadalso: adnichols: so ruby_block runs on the provisioning side? not in the provisioned server?
[2013-08-27 14:58:01 -0400] adnichols: EnriqueCadalso a ruby_block will run on the server you are provisioning
[2013-08-27 14:59:46 -0400] EnriqueCadalso: adnichols: humm, then I don't get how can I store to use inside the template that is on the provisioning side, on the cookbook, if ruby_block runs on the provisioned server. How the change can get back to the cookbook?
[2013-08-27 15:00:41 -0400] flaccid: EnriqueCadalso: not sure what you mean. chef runs do not modify the code of a cookbook, they are for the runtime config of teh node they are run on
[2013-08-27 15:00:44 -0400] bean: I'd stop worrying about the cookbook and start thinking of it as creating a file with a ruby block.
[2013-08-27 15:02:55 -0400] gchristensen: the change doesn't get made to hte cookbook
[2013-08-27 15:03:11 -0400] adnichols: EnriqueCadalso yeah, you have to write your template and recipe in a way where the code will produce the desired output based on the input you give it - you can't dynamically modify the code, but you can put code in the template to modify what the output is
[2013-08-27 15:03:13 -0400] EnriqueCadalso: I get it, download the file in the provisioned server and modify it there to produce the final result using the ruby_block. I would have wanted to do it on the provisioning side so to modify the node definition instead, so my chef node definition would reflect what I have on the server.
[2013-08-27 15:03:52 -0400] adnichols: EnriqueCadalso What exactly would you modify about the node? Because you can certainly write attributes during a recipe run
[2013-08-27 15:04:54 -0400] adnichols: EnriqueCadalso it would help too if we used common terminology here - you have the chef-client (the server you are provisioning) and chef-server (what I think you are referring to as the provisioning side)
[2013-08-27 15:05:15 -0400] EnriqueCadalso: adnichols: So I could download the file during the recipe run and write attributes to the node? How?
[2013-08-27 15:05:37 -0400] EnriqueCadalso: adnichols: Well, I am using chef solo now with knife solo, no chef server.
[2013-08-27 15:05:52 -0400] EnriqueCadalso: although we plan to migrate.
[2013-08-27 15:05:54 -0400] adnichols: EnriqueCadalso ah - that' pretty important
[2013-08-27 15:06:13 -0400] adnichols: EnriqueCadalso chef-solo doesn't store node state between runs afaik - there's nothing to modify
[2013-08-27 15:07:11 -0400] adnichols: EnriqueCadalso you can still have it download some data (file) manipulate it and use that in a template, but you can't persist any information outside that run unless you write to the filesystem or use some other data store
[2013-08-27 15:07:17 -0400] thelonecabbage: I am trying to build the example at https://github.com/opscode-cookbooks/application_python  but I keep getting to the same error no matter what I do.  It keeps building until it get's to "Failed to read the private key /etc/chef/client.pem" stops and fails.  I'm out of ideas, anyone help?
[2013-08-27 15:08:52 -0400] EnriqueCadalso: the point is I need to produce a configuration file from a downloaded xml file. I could do it manually but I would like to do it on provisioning time. My idea was to modify the node definition somehow when provisioning, that will produce the template to generate the right final configuration file in the provisioned server.
[2013-08-27 15:10:06 -0400] EnriqueCadalso: I don't like provisioning code to change the configuration, I would like my node definition an exact mirror of what I have on the provisioned server.
[2013-08-27 15:10:49 -0400] EnriqueCadalso: so I want something to run before files are deployed to the server.
[2013-08-27 15:12:31 -0400] adnichols: EnriqueCadalso yeah, I guess I'm not sure why you need to modify the node - How about just get the xml data & modify it in a ruby_block, then write it to the filesystem or a var in chef and then use that data inside the template - either reading off the FS or reading from an attribute in chef?
[2013-08-27 15:13:00 -0400] adnichols: EnriqueCadalso the order of operation is defined by your recipe - so if you download and process the data before you create the template you shouold be fine.
[2013-08-27 15:13:45 -0400] mattjalexander: @jtimberman does your vagrant-cookbook support installing vagrant plugins for specific users?
[2013-08-27 15:13:45 -0400] adnichols: EnriqueCadalso the part I've always had trouble with is passing data from a ruby_block to another resource - hence my suggestion of using the filesystem but that's poor form, I know there's a better way
[2013-08-27 15:13:55 -0400] mattjalexander: it seems to only install them for root
[2013-08-27 15:14:09 -0400] EnriqueCadalso: adnichols: thanks a lot for your help, main thing I wanted to know was about using ruby_block. I have now a general idea how to follow up from here. Thanks.
[2013-08-27 15:19:24 -0400] teukka: mattjalexander: yeah, it always installs to the root user. I almost started to implement user specific installs but only almost ;) /cc jtimberman
[2013-08-27 15:20:53 -0400] teukka: mattjalexander: I eneded up adding a custom execute resource or something
[2013-08-27 15:21:00 -0400] jtimberman: mattjalexander: teukka is correct, it doesn't support per-user installs. i do this in my jenkins recipe: https://gist.github.com/jtimberman/6354989
[2013-08-27 15:21:29 -0400] teukka: yeah, just like that
[2013-08-27 15:30:33 -0400] ichilton: Got a cookbook which has another cookbook as a dependancy in metadata.rb and Berksfile using a github source - i've updated that other cookbook on github and bumped the version, but berks install and berkshelf-vagrant are not seeing those changes - how can I get it to recognise the version update?
[2013-08-27 15:30:51 -0400] bean: I'd nuke your berkshelf cache :>
[2013-08-27 15:30:54 -0400] ichilton: I surely don't have to manually increase a version constraint each time?
[2013-08-27 15:31:24 -0400] ichilton: I thought that was the point of vagrant-berkshelf though, fast iteration
[2013-08-27 15:31:43 -0400] ichilton: surely if you specify a github source, it should check that each time for new commits?
[2013-08-27 15:31:49 -0400] gchristensen: +1 clear the berkshelf cache, there are some bugs in that are.a
[2013-08-27 15:32:28 -0400] damien: good morning :) (afternoon, evening, depending on your locale, please substitute accordingly ;))
[2013-08-27 15:33:24 -0400] damien: Hey can anyone help me understand why my recently registered node is not showing up in the node list? I see it in clients tab, I can do a knife show node <host> and see that server knows about it, but webui is not reflecting... I just restarted and reindexed chef-server (using v11.4.4)
[2013-08-27 15:34:15 -0400] mattjalexander: great, thanks jtimberman!
[2013-08-27 15:34:23 -0400] ichilton: gchristensen: what's the best way to do that?
[2013-08-27 15:34:28 -0400] mattjalexander: much cleaner than just a raw bash oneliner
[2013-08-27 15:34:36 -0400] ichilton: gchristensen: just rm ~/.berkshelf/cookbooks?
[2013-08-27 15:34:49 -0400] damien: haha nvm just solved my own problem! man it's amazing just writing out your question can resolve a lot... anyways, if anyone ever does this early morning boo boo, make sure you environment drop down is set to none or you know your node is in the env you have selected :)
[2013-08-27 15:35:44 -0400] gchristensen: ichilton: that should do it
[2013-08-27 15:36:32 -0400] daos: damien: i believe they call that "talking to the duck"
[2013-08-27 15:36:54 -0400] afirth: http://en.wikipedia.org/wiki/Rubber_duck_debugging surprisingly effective
[2013-08-27 15:37:06 -0400] gchristensen: +1[
[2013-08-27 15:37:26 -0400] damien: daos: haha nice I will borrow that phrase in future :) duck is special
[2013-08-27 15:37:52 -0400] damien: afirth, nice link :)
[2013-08-27 15:37:53 -0400] daos: indeed :) https://duckduckgo.com/?q=rubber+duck+debugging
[2013-08-27 15:38:29 -0400] damien: hah! man amazing what kind of memes are out there growing all the while
[2013-08-27 15:39:09 -0400] damien: so good
[2013-08-27 15:45:24 -0400] scarolan_: Anyone have experience setting knife[:editor] on a Windows workstation?  I'm having trouble with spaces; can't quite figure out how to escape them.
[2013-08-27 15:45:31 -0400] scarolan_: In the knife.rb file I mean
[2013-08-27 15:45:37 -0400] scarolan_: not via an environment variable
[2013-08-27 15:46:02 -0400] ichilton: bean: gchristensen: Removed both ~/.berkshelf/cookbooks and ~/.berkshelf/tmp and it still then pulled the old version down
[2013-08-27 15:46:10 -0400] bean: odd.
[2013-08-27 15:46:53 -0400] ichilton: aha
[2013-08-27 15:46:58 -0400] ichilton: need to run berks update
[2013-08-27 15:47:03 -0400] teukka: ichilton: Berkshelf.lock might still have the old reference. try nuking it too or call `berks update`
[2013-08-27 15:47:22 -0400] ichilton: for some reason creating a cookbook with berks cookbook adds a .gitignore with Berksfile.lock in so I wasn't seeing changes
[2013-08-27 15:47:40 -0400] ichilton: teukka: yep, that's it - just worked that out :)
[2013-08-27 15:51:56 -0400] ichilton: Why would you want Berksfile.lock in the .gitignore? - surely it should be checked into version control?
[2013-08-27 15:52:29 -0400] scarolan_: ichilton: because the next person to clone the repo would get that file, creating an invalid lock?
[2013-08-27 15:57:45 -0400] ichilton: yeah, the difference between distribution and sharing with a team I guess
[2013-08-27 15:57:52 -0400] ichilton: bean: why?
[2013-08-27 16:00:32 -0400] bean: ichilton: i get an error if I don't :)
[2013-08-27 16:01:49 -0400] ichilton: bean: ah..
[2013-08-27 16:03:11 -0400] chris613: Running chef-client 10.20. It's not running the versoin of the cookbook that I find in the cache. I delete /var/cache/chef, it repopulates it with the right cookbook, and then runs different code. Where do I find the code it's running? What could I check?
[2013-08-27 16:04:06 -0400] chris613: --why-run shows it will run the right cookbook and do the right thing. Running without --why-run does the wrong thing
[2013-08-27 16:06:29 -0400] jbz: chris613: I hate to ask this, but are you *sure* it's running different code?  Did you put a log flag or something in to verify?  I ask b/c I've had chef do things (or fail to do things) that I completely did not expect when given a cookbook.
[2013-08-27 16:09:14 -0400] mattupstate: can i compare a search result to the current node?
[2013-08-27 16:09:40 -0400] mattupstate: anyone happen to know if that works? for example, result = search(:node, '') if result.include?(node) ...
[2013-08-27 16:10:12 -0400] chris613: jbz: Actually, when I do it without --why-run it appears to skip the cookbook I'm interested in entirely... Oh! I think I found it. Thanks for asking the "dumb" question
[2013-08-27 16:11:01 -0400] jbz: :-)
[2013-08-27 16:16:27 -0400] hapxD: Hi , with chef-solo could  i put something in the solo.rb for settings which are conditioned ?
[2013-08-27 16:23:47 -0400] maniacal: Is it possible to grab cookbook files based on a pattern:   cookbook_file "/opt/*" do; source "file_*.txt"; action :create; done
[2013-08-27 16:23:51 -0400] maniacal: soemthing like that
[2013-08-27 16:24:07 -0400] maniacal: well, that doesn't seem to work, but looking for somethign that would accomplish that
[2013-08-27 16:36:27 -0400] yruss972: Hi- I'm trying to setup an all in one dev machine by putting all the relevant roles on one node. Some of the roles use the same recipes and those are only getting run once.
[2013-08-27 16:36:48 -0400] yruss972: Is there anyway to make this work without splitting those recipes out?
[2013-08-27 16:40:52 -0400] a13x212: i'm using the php cookcook, there are some default attributes that i would like to add too, what is the correct way to do this? should i just edit the attributes file or should add overrides in a recipe file
[2013-08-27 16:41:43 -0400] miah: you oculd use roles or environments to specify attributes that override the defaults in the cookbook
[2013-08-27 16:55:34 -0400] dgarstang: Anyone here use packer? Not chef I know, but knife's brain deadedness when ssh-ing into a system it just bootstrapped has forced me to change the way I build my amazon AMI
[2013-08-27 17:01:17 -0400] dgarstang: Anyone here use packer? Not chef I know, but knife's brain deadedness when ssh-ing into a system it just bootstrapped has forced me to change the way I build my amazon AMI
[2013-08-27 17:05:09 -0400] zts: dgarstang: by the way, what's the ticket number so that I can add my upvote?
[2013-08-27 17:05:56 -0400] bean: dgarstang: are you referring to the bootstrap template?
[2013-08-27 17:07:58 -0400] dgarstang: bean: no... when you run a 'knife ec2 server create', and after knife has seen that the instance is up, it immediately tries to ssh in. That's failing because cloud-init hasn't changed the ubuntu user to the bcadmin user and knife doesn't pause, or retry.
[2013-08-27 17:08:20 -0400] bean: ah
[2013-08-27 17:08:56 -0400] dgarstang: The original AMI is built with packer.io, which lets you pass user-data. I figured I'd do it there and bake it into the image, but... packer seems to friggin ignore the user_data_file option. Argh!
[2013-08-27 17:09:09 -0400] dgarstang: bean: *sigh*
[2013-08-27 17:09:18 -0400] bean: lame
[2013-08-27 17:09:25 -0400] gchristensen: dgarstang: you can't override the user it attempt?
[2013-08-27 17:09:39 -0400] dgarstang: gchristensen: have it log in as ubuntu instead of bcadmin?
[2013-08-27 17:10:00 -0400] gchristensen: ohh, you just need a pause / retry then?
[2013-08-27 17:10:56 -0400] dgarstang: gchristensen: Yes, although in hindsight, packer is the better place to do it. I can't log in as the ubuntu user with knife, because eventhough knife runs chef-client as root, it still logs in as ubuntu first, and then su's to root. Well, when your logged in as a user, you cant change that users details
[2013-08-27 17:11:09 -0400] gchristensen: right
[2013-08-27 17:11:12 -0400] gchristensen: exactly :)
[2013-08-27 17:11:18 -0400] dgarstang: gchristensen: GRRRRR
[2013-08-27 17:11:46 -0400] dgarstang: so back to packer, and it's ignoring user_data_file.
[2013-08-27 17:11:51 -0400] gchristensen: :(
[2013-08-27 17:12:22 -0400] dgarstang: gchristensen: packer can run scripts... but it runs them as... ubuntu!
[2013-08-27 17:13:38 -0400] gchristensen: could you tell it to log in as a different user? or create a compiled program which does setuid / setgid and then runs usermod :)
[2013-08-27 17:14:18 -0400] dgarstang: gchristensen: The only user that can log into the initial AMI is ubuntu... I suppose I could _add_ the bcadmin user.
[2013-08-27 17:15:09 -0400] dgarstang: gchristensen: tried this earlier... doable, but then I gotta manually create .ssh/, set the right perms and stuff and copy over the auth key file from the ubuntu user to the bcadmin user
[2013-08-27 17:17:37 -0400] gchristensen: I think my strategy before was to log in as the ubuntu user, and user "ubuntu" do action :remove not_if 'test `whoami` = "ubuntu"' or something
[2013-08-27 17:17:53 -0400] gchristensen: so it would skip changing the ubuntu user until the next run
[2013-08-27 17:18:11 -0400] dgarstang: gchristensen: yah, this is kind of before chef runs. I'm only bitching here because it's knife's fault. :-\
[2013-08-27 17:18:19 -0400] gchristensen: ah
[2013-08-27 17:40:37 -0400] dysinger: hola
[2013-08-27 17:41:04 -0400] dysinger: I've written this utility a couple times & others have too: query ec2 & delete nodes from chef-server that are gone.
[2013-08-27 17:41:29 -0400] dysinger: do we have this any place central that we can rally around ?
[2013-08-27 17:43:54 -0400] bscott: est
[2013-08-27 17:46:20 -0400] miah: write it, put it on github and let people know =)
[2013-08-27 17:46:40 -0400] miah: it might also already be a knife plugin
[2013-08-27 17:47:00 -0400] adnichols: or add something to knife-ec2?
[2013-08-27 17:50:37 -0400] cwj: knife-ec2 might be a good fit, right now i have implemented that idea as a rake task in our chef repo
[2013-08-27 17:51:25 -0400] cwj: i think anyone who uses knife-ec2 would have some use for such a command
[2013-08-27 17:55:11 -0400] aabes: ahoi..- when I look at a node's last-check-in time - what time is that ? epoch on the node? or is that another time?
[2013-08-27 18:16:06 -0400] cwj: aabes: i believe its the node epoch time collected when chef runs ohai
[2013-08-27 18:16:08 -0400] pabst^: I swear jtimberman... Everything I have read today your name pops up in... :)
[2013-08-27 18:22:23 -0400] aabes: thanks
[2013-08-27 18:24:11 -0400] mattupstate: is it possible, or advisable to put multiple definitions in one file?
[2013-08-27 18:51:59 -0400] abrkn: whats a good tactic to deploy a private repo? the online examples do not explain how to put the ssh private key on the node
[2013-08-27 18:52:38 -0400] bean: abrkn: I guess I don't get your question, "deploy a private repo"
[2013-08-27 18:52:46 -0400] bean: we keep our repos on a private git server
[2013-08-27 18:52:54 -0400] bean: and use berkshelf to do all the uploading
[2013-08-27 18:53:01 -0400] gleam: he means using the deploy resource
[2013-08-27 18:53:08 -0400] bean: oh
[2013-08-27 18:53:20 -0400] abrkn: i am. is the deploy resource not a good idea?
[2013-08-27 18:53:29 -0400] gleam: i use the deploy_wrapper cookbook to drop private ssh keys
[2013-08-27 18:53:40 -0400] abrkn: ok, checking that
[2013-08-27 19:04:54 -0400] sparr: I have a cookbook_file that is resulting in an HTTP 403 Forbidden error the first time Chef runs, but succeeds on a later run without my changing anything about the node or server. What might be wrong?
[2013-08-27 19:09:21 -0400] ponyofdeath: hi, <%= "proxy_cache_path #{store} levels=1:2 keys_zone=my-cache:8m max_size=#{max_size} inactive=#{inactive};" %> any ideas why this does not work and says unknown variable store
[2013-08-27 19:15:35 -0400] ggayan: hey guys, do anyone know if can I notify a service to restart with the deploy_revision resource only if a new deploy was done?
[2013-08-27 19:15:47 -0400] ggayan: I mean, if the git HEAD hasn't changed, don't trigger a restart
[2013-08-27 19:16:15 -0400] cwj: ponyofdeath: i think youd be better off doing the interpolation like so: proxy_cache_path <%= store %> levels=1:2 keys_zone=my-cache:8m max_size=<%= max_size %> inactive=<%= inactive %>
[2013-08-27 19:16:41 -0400] bean: ggayan: well, your deploy_revision isn't deploying if theres nothing new to deploy, right?
[2013-08-27 19:16:56 -0400] cwj: and you probably need to use @ when accessing the variables you pass to the template (e.g. <%= @store %>)
[2013-08-27 19:17:14 -0400] dgarstang: I think... I dunno. This is so fucked up. So, I'm still seeing the situation where knife bootstraps an instance and immediately tries to ssh in once it's up. Since ssh hasn't started yet, knife gets an error and then IMMEDIATELY gives up.
[2013-08-27 19:17:30 -0400] siezer: ggayan it should behave like that anyway
[2013-08-27 19:17:47 -0400] ponyofdeath: cwj: ok would #{@store} work then?
[2013-08-27 19:18:01 -0400] cwj: ponyofdeath: yes i think it may
[2013-08-27 19:18:05 -0400] ggayan: siezer: yeah that's what I thought
[2013-08-27 19:18:20 -0400] ggayan: I have a bash script with action :nothing that restarts my service with runit
[2013-08-27 19:18:44 -0400] ggayan: and in the deploy resource I have notifies :run, 'bash[restart_my_service]', :delayed
[2013-08-27 19:19:07 -0400] siezer: is it deploying every time?
[2013-08-27 19:19:22 -0400] siezer: sounds like a bug in deploy_resource
[2013-08-27 19:19:57 -0400] bean: also you should be using a service resource
[2013-08-27 19:20:02 -0400] bean: not a bash resource
[2013-08-27 19:20:04 -0400] bean: to restart it
[2013-08-27 19:20:11 -0400] cwj: theres a difference between deploy and deploy_resource, in some cases deploy will run every time
[2013-08-27 19:20:36 -0400] ggayan: yup, I'm using the runit_service resource from opscode's runit cookbook
[2013-08-27 19:20:51 -0400] ggayan: but I need to send a term signal to my service
[2013-08-27 19:21:17 -0400] abrkn: gleam: any trick to adding github to known hosts first or should i find a separate cookbook?
[2013-08-27 19:21:26 -0400] ggayan: but first of all, the bash script shouldn't be triggered
[2013-08-27 19:21:42 -0400] cwj: notifies :term, service[my_runit_service] :delayed
[2013-08-27 19:21:52 -0400] ggayan: the deploy_revision resource isn't creating new files though
[2013-08-27 19:21:57 -0400] ggayan: sorry, new folders
[2013-08-27 19:22:05 -0400] bean: but you're sure its running?
[2013-08-27 19:22:06 -0400] ggayan: it stays at the same revision, as expected
[2013-08-27 19:24:07 -0400] cwj: ggayan: does running chef with --why-run provide any helpful detail as to why your deploy_resource is executing?
[2013-08-27 19:24:18 -0400] ggayan: I'll check that
[2013-08-27 19:24:27 -0400] dgarstang: is there a way to run a knife ec2 server create, but not have knife ssh in?
[2013-08-27 19:25:13 -0400] cwj: abrkn: if you set 'sloppy true when using deploy_wrapper, it will not try to validate the remote ssh host key
[2013-08-27 19:25:34 -0400] cwj: abrkn: otherwise you need to drop off the remote ssh host key in advance
[2013-08-27 19:26:16 -0400] ponyofdeath: cwj: sure did thanks!
[2013-08-27 19:26:31 -0400] cwj: ponyofdeath: no problem
[2013-08-27 19:28:21 -0400] dgarstang: is there a way to run a knife ec2 server create, but not have knife ssh in?
[2013-08-27 19:29:00 -0400] sparr: when chef-client is run in daemon mode, it appears to only use the -j option for the first operation. is this true? changeable?
[2013-08-27 19:29:34 -0400] jbz: sparr: That's true; after that, it wants to get node data from the server.
[2013-08-27 19:30:07 -0400] jbz: sparr: However, anything you put into the attributes.json file (that is an attribute) will get uploaded to the server and then should be available?
[2013-08-27 19:30:28 -0400] sparr: jbz: I'm running into a problem. There is an error in my first run, which seems to result in the node data not getting updated on the server (that is, the ohai data and the run list from my -j json file)
[2013-08-27 19:30:35 -0400] jbz: ah yes.
[2013-08-27 19:30:49 -0400] jbz: This is an annoying thing - if the first run fails, the node ends up with an empty node state and run list
[2013-08-27 19:30:50 -0400] jbz: but
[2013-08-27 19:31:01 -0400] jbz: if you restart the daemon, it will again reread the attribs file for that first run.
[2013-08-27 19:31:03 -0400] sparr: a second run would (magically, and I need to fix that) fix the problem, but the second run doesn't work :(
[2013-08-27 19:31:23 -0400] sparr: yeah, but I don't want to be around to restart the daemon, generally. I might get rid of the daemon and replace it with a cron job...
[2013-08-27 19:31:24 -0400] jbz: Yeah, the first run *must* converge if you want the daemon to function :-/
[2013-08-27 19:31:34 -0400] jbz: Is the error a one-time error?
[2013-08-27 19:31:36 -0400] sparr: yes
[2013-08-27 19:31:37 -0400] jbz: like, a known problem?
[2013-08-27 19:31:42 -0400] jbz: ok
[2013-08-27 19:31:45 -0400] sparr: I don't know the cause of it, but yes it's a one-time error
[2013-08-27 19:31:49 -0400] jbz: you can, in fact, have the client restart itself during the run
[2013-08-27 19:31:49 -0400] afirth: @sparr, use distributed cron, we already have a recipe for it :P
[2013-08-27 19:31:50 -0400] jbz: that's not clean
[2013-08-27 19:31:55 -0400] sparr: re-asking from before...
[2013-08-27 19:31:56 -0400] sparr: I have a cookbook_file that is resulting in an HTTP 403 Forbidden error the first time Chef runs, but succeeds on a later run without my changing anything about the node or server. What might be wrong?
[2013-08-27 19:32:07 -0400] jbz: but we did that while installing the client service.
[2013-08-27 19:32:29 -0400] jbz: hm
[2013-08-27 19:32:41 -0400] jbz: is the first run trying to register a node that already exists?
[2013-08-27 19:32:56 -0400] jbz: Or does it have a bad validator key?
[2013-08-27 19:33:18 -0400] sparr: nope
[2013-08-27 19:33:22 -0400] sparr: it successfully registers
[2013-08-27 19:33:28 -0400] sparr: and OTHER cookbook_file directives work fine
[2013-08-27 19:34:50 -0400] Liquid--: has anyone read "Test Driven Infrastructure with Chef" ? If so, did you find it useful ?
[2013-08-27 19:36:46 -0400] dgarstang: Does anyone actually use knife-ec2? I mean, it's totally broken. Doesn't someone test this stuff?
[2013-08-27 19:37:02 -0400] afirth: sparr: like so: https://github.com/ScholasticInc/sch-hosting-chef/blob/master/roles/centos-base.rb#L68 (and line 10)
[2013-08-27 19:37:24 -0400] gchristensen: dgarstang: back when I used AWS, I think I just provisioned the servers with their webUI and pointed knife at it.
[2013-08-27 19:37:35 -0400] afirth: sparr: or just add the centos-base (or bos-dev-centos-base)
[2013-08-27 19:37:48 -0400] dgarstang: gchristensen: well of course that works :)
[2013-08-27 19:37:58 -0400] gchristensen: dgarstang: exactly my point
[2013-08-27 19:39:29 -0400] mattupstate: i use it nearly every day and it "works for me"
[2013-08-27 19:39:33 -0400] gchristensen: Liquid--: these reviews are NOT promising: http://www.amazon.com/Test-Driven-Infrastructure-Chef-Stephen-Nelson-Smith/product-reviews/1449304818/ref=dp_top_cm_cr_acr_txt?showViewpoints=1
[2013-08-27 19:40:06 -0400] jtimberman: gchristensen: there was a fundamental misunderstanding about the purpose of the first revision of that book.
[2013-08-27 19:40:18 -0400] gchristensen: jtimberman: oh?
[2013-08-27 19:40:45 -0400] jtimberman: at least w/ the initial release, it was meant to be a short (50 page) ebook exploring a concept, not a "here's how to use chef"
[2013-08-27 19:40:55 -0400] gchristensen: ah
[2013-08-27 19:40:57 -0400] jtimberman: (i haven't read the reviews since)
[2013-08-27 19:41:01 -0400] philsturgeon: having a rough time with chef deployments. this repo was deploying, but i've moved some things around. one thing I know is that this repo was deploying through chef perfectly, but now im getting this: http://d.pr/i/1lY8
[2013-08-27 19:41:07 -0400] miah: i read the book
[2013-08-27 19:41:07 -0400] ggayan: cwj: funny thing, I removed the bash with action :nothing, replaced it with notifies :term, 'runit_service[my_service]', :delayed and it doesn't trigger the restart; as expected
[2013-08-27 19:41:11 -0400] dgarstang: mattupstate: in a simplistic case I assume
[2013-08-27 19:41:12 -0400] jtimberman: the next version is a bit more comprehensive
[2013-08-27 19:41:18 -0400] philsturgeon: I have different deploy keys for v3 and v4 (two different repos, deploying with very similar code)
[2013-08-27 19:41:21 -0400] miah: its not about how to use chef at all, its how to do tdd with cookbooks
[2013-08-27 19:41:25 -0400] philsturgeon: those dpeloy keys are in a data bag.
[2013-08-27 19:41:37 -0400] gchristensen: jtimberman: has the next version been released? (heh, i first typed deployed)
[2013-08-27 19:41:58 -0400] miah: i might have to review it, its been a bit since i looked at it (~2 years)
[2013-08-27 19:42:09 -0400] mattupstate: dgarstang: perhaps?
[2013-08-27 19:42:11 -0400] ggayan: cwj: it seems it ends up notifying every run if it's a bash script
[2013-08-27 19:42:13 -0400] dgarstang: I've said it several times, and I'll say it again. Knife ec2 polls and waits for the instance to be up. When it's up, it tries to ssh in. Ssh isn't quite ready yet and returns a 'connection refused'. knife immediately gives up.
[2013-08-27 19:42:15 -0400] gchristensen: miah: that is interesting to me for sure, was it best documented there? or would a collection of manual pages and blog postts be just as (if not more) effective?
[2013-08-27 19:42:15 -0400] miah: but i dont cucumber, and stuff has changed drastically since the book was written
[2013-08-27 19:42:16 -0400] jtimberman: gchristensen: i don't know
[2013-08-27 19:42:22 -0400] gchristensen: jtimberman: okay
[2013-08-27 19:42:26 -0400] cwj: ggayan: thats bizarre
[2013-08-27 19:42:28 -0400] adnichols: philsturgeon looks like a classic key mismatch - you've confirmed the key being used matches what is on github?
[2013-08-27 19:42:34 -0400] jtimberman: there was a galley copy at OSCON last month, i think it's in "editing"
[2013-08-27 19:42:38 -0400] jtimberman: check oreilly.com :)
[2013-08-27 19:42:54 -0400] miah: i think the chef source, with all its examples of resource providers and their tests is good enough =)
[2013-08-27 19:43:16 -0400] gchristensen: that seems to be the general kase :)
[2013-08-27 19:43:17 -0400] dgarstang: perhaps knife-ec2 works in a single region, but not across multiple regions
[2013-08-27 19:43:20 -0400] gchristensen: case :) good gravy
[2013-08-27 19:43:21 -0400] miah: everytime i write recipes i'm in pain because there aren't enough proper resource provider primitives
[2013-08-27 19:43:26 -0400] philsturgeon: adnichols: the strange thing is it didnt change. I was deploying with this key before
[2013-08-27 19:43:41 -0400] adnichols: adnichols sure, but something did :)
[2013-08-27 19:43:42 -0400] gchristensen: miah: that is a lot of p's and r's there.
[2013-08-27 19:43:43 -0400] philsturgeon: i'll just make a brand new one and shove it over the top, just in case some copy/paste bullshit happened
[2013-08-27 19:43:47 -0400] adnichols: err philsturgeon  ^^
[2013-08-27 19:43:57 -0400] miah: gchristensen: yes, but they make sense =)
[2013-08-27 19:44:04 -0400] gchristensen: it took me a few tries :)
[2013-08-27 19:44:18 -0400] martin_work: are there any videos up from 2013 chef conf?
[2013-08-27 19:44:19 -0400] abrkn: gleam: sigh, the maintainer of the deploy wrapper has written the bash file in windows (CRLF)
[2013-08-27 19:44:21 -0400] adnichols: philsturgeon yeah, I have been bitten occassionally by multiple folks working in the same area & overwriting my work - esp w/ databags
[2013-08-27 19:44:24 -0400] gleam: haha
[2013-08-27 19:44:25 -0400] dgarstang: *sigh* the only alternative to broken knife ec2 is to use cloud-init and put the validator in user-data, which is bad
[2013-08-27 19:44:42 -0400] philsturgeon: adnichols: i dont let my minions anywhere near chef
[2013-08-27 19:44:44 -0400] gchristensen: miah: what kind of primitives are you looking for?
[2013-08-27 19:44:47 -0400] miah: you can't really send actions to a recipe, so recipe based cookbooks are essentially worthless
[2013-08-27 19:44:47 -0400] abrkn: gleam: i mean.. lol
[2013-08-27 19:45:07 -0400] adnichols: philsturgeon aww but it's all about sharing :)
[2013-08-27 19:45:08 -0400] abrkn: gleam: atleast i have a chance to install dos2unix...
[2013-08-27 19:45:19 -0400] jtimberman: miah: what resources do you find lacking/missing?
[2013-08-27 19:45:40 -0400] miah: well, i'm writing the ones i'm missing :P
[2013-08-27 19:45:45 -0400] jtimberman: touche
[2013-08-27 19:46:11 -0400] adnichols: philsturgeon sometimes also just manually poking at what is on the server helps spot problems (vs assuming it matches your repo)
[2013-08-27 19:46:18 -0400] miah: but i find myself having to reach down to system() to do things like 'tar' or 'unzip', which gets really tricky
[2013-08-27 19:46:25 -0400] miah: because tar, varies on distribution of unix
[2013-08-27 19:46:31 -0400] philsturgeon: adnichols: thats where i was getting confused. the git ssh wrapper makes it hard for me to manually run this
[2013-08-27 19:46:34 -0400] miah: and even the tar spec itself varies
[2013-08-27 19:46:37 -0400] jkeiser: martin_work: all of them are up, I believe
[2013-08-27 19:46:41 -0400] philsturgeon: i mean, that exact command is definitely going to fail
[2013-08-27 19:46:47 -0400] miah: i'd <3 a proper chef resource provider for tar
[2013-08-27 19:46:49 -0400] martin_work: yea i found em
[2013-08-27 19:46:50 -0400] martin_work: thanks
[2013-08-27 19:46:52 -0400] philsturgeon: git ls-remote "git@github.com:kapture/api-v3.git" maste
[2013-08-27 19:46:55 -0400] miah: or other such tools
[2013-08-27 19:47:03 -0400] adnichols: philsturgeon you could just manually simulate it and though manual - it may spot a "stupid" problem
[2013-08-27 19:47:07 -0400] philsturgeon: adnichols: thats never gonna work, by itself, but I assume chef is git wrapping it?
[2013-08-27 19:47:07 -0400] miah: i dont know that the ruby gems for archives are really super awesome
[2013-08-27 19:47:20 -0400] miah: but its something i'll investigate eventually
[2013-08-27 19:47:27 -0400] philsturgeon: adnichols: right, id love to manually run it through the git ssh wrapper but i dunno how
[2013-08-27 19:47:46 -0400] miah: right now i'm working on building a primitive for the instance pattern, and sketching out my ideas how a configuration primitive
[2013-08-27 19:47:52 -0400] miah: s/how/for
[2013-08-27 19:48:08 -0400] adnichols: philsturgeon what about just putting the key in place that you have in your databag and trying w/ straight git?
[2013-08-27 19:48:29 -0400] miah: because_working[:with][:endless][:hash][:key][:depth][:is][:making][:me][:cry]
[2013-08-27 19:48:58 -0400] adnichols: heh
[2013-08-27 19:49:13 -0400] adnichols: sorry - not to laugh at your tears
[2013-08-27 19:49:50 -0400] sparr: so, the only thing I can see that differentiates this cookbook_file is where it appears in my recipe
[2013-08-27 19:50:01 -0400] abrkn: my experience with chef so far: people only make books so they work for -them-. i am no better :(
[2013-08-27 19:50:57 -0400] adnichols: abrkn there are exceptions - but they are the minority and a pleasant surprise
[2013-08-27 19:51:10 -0400] abrkn: adnichols: certainly
[2013-08-27 19:52:16 -0400] sparr: I've got a file going into /foo/bar/baz/blah.jar and another going into /foo/meh/some.xml later in the recipe. ownership and permissions on bar and meh are identical, as are on blah.jar and some.xml in the cookbook's files/default/ folder.
[2013-08-27 19:52:47 -0400] sparr: blah.jar is retrieved successfully, while some.xml results in an http 403 forbidden error
[2013-08-27 19:54:42 -0400] philsturgeon: adnichols: gah, new keys didnt help
[2013-08-27 19:54:43 -0400] adnichols: sparr and presumably browsing for that file in the cookbook on the server shows it there ?
[2013-08-27 19:55:30 -0400] iverson0881: hi so i have a chef search that gives me the private interface ip. however it gives me the private interface ip of the interface of where the chef search is used
[2013-08-27 19:55:49 -0400] sparr: adnichols: yes, it shows there. and it only gives the 403 error the very first run of chef-client. if i re-run it immediately then it works
[2013-08-27 19:56:07 -0400] adnichols: sparr is this after a long initial run?
[2013-08-27 19:56:13 -0400] iverson0881: but i would really want it to figure out what the appropriate private interface is, and get the ip of it vs use the variable of the node its searching for
[2013-08-27 19:56:14 -0400] sparr: oh, damit
[2013-08-27 19:56:15 -0400] sparr: yes, it is
[2013-08-27 19:56:15 -0400] iverson0881: and not itsel
[2013-08-27 19:56:16 -0400] iverson0881: f
[2013-08-27 19:56:17 -0400] adnichols: :)
[2013-08-27 19:56:21 -0400] sparr: I already know about that bug
[2013-08-27 19:56:30 -0400] sparr: and I already moved my other cookbook_file directives to account for it
[2013-08-27 19:56:31 -0400] sparr: now I feel dumb
[2013-08-27 19:57:02 -0400] adnichols: philsturgeon if it were me I'd take this out of chef and make sure my assumptions about the keys working is accurate
[2013-08-27 19:57:18 -0400] adnichols: philsturgeon maybe you've already tested that?
[2013-08-27 19:57:37 -0400] sparr: # Do not put any cookbook_file or template directives below media_download, it runs so long that the session expires and HTTP 403 errors are encountered
[2013-08-27 19:57:52 -0400] sparr: ok, hopefully the next dev to try this (which will be me, again) will see that :)
[2013-08-27 19:58:05 -0400] gchristensen: anyone have a favorite way to create graphs of how an infrastructure is layed out?
[2013-08-27 19:58:11 -0400] adnichols: heh - assuming nobody inserts someting and it fails in a new spot :)
[2013-08-27 19:58:26 -0400] sparr: I've got one step in the recipe that runs for 40+ minutes
[2013-08-27 19:58:31 -0400] sparr: everything else runs in seconds
[2013-08-27 19:58:42 -0400] adnichols: ic
[2013-08-27 19:59:43 -0400] Kzim: hi
[2013-08-27 19:59:57 -0400] philsturgeon: adnichols: i made brand new keys so i knew it was all good. as i said i wasnt sure how to test it not chef, because the deploy logic is incredibly chef. i was about to putting the key under my "phil" account and see if that works, but it looks like my new keys were not deploying. forced the key into id_deploy and now its deploying
[2013-08-27 20:00:04 -0400] philsturgeon: so magic. i think.
[2013-08-27 20:00:08 -0400] Kzim: is there any way to make a knife search to find which environment has a certain version constraint of a cookbook please
[2013-08-27 20:01:12 -0400] adnichols: philsturgeon huh, ok - I haven't used the git wrapper
[2013-08-27 20:01:33 -0400] adnichols: Kzim have you looked at knife spork?
[2013-08-27 20:01:55 -0400] philsturgeon: adnichols: fair enough. im gonna kill it for capistrano asap.
[2013-08-27 20:02:07 -0400] philsturgeon: adnichols: but yeah your suggestion was about right. whenever a command fails, I run the command myself
[2013-08-27 20:02:28 -0400] adnichols: philsturgeon aww.. as someone who just moved stuff from cap to chef that makes me sad :)
[2013-08-27 20:02:46 -0400] adnichols: but it has its place
[2013-08-27 20:03:33 -0400] Kzim: adnichols, no only knife search
[2013-08-27 20:04:48 -0400] cwj: Kzim: you can search environments (knife search environment query), but im not having much luck constructing a query for a particular cookbook constraint
[2013-08-27 20:05:08 -0400] cwj: Kzim: you could do knife search environment 'cookbook_versions:* -Fj and pipe the output through jq for additional filtering
[2013-08-27 20:05:32 -0400] philsturgeon: addisonj: I dont like that if i want to deploy a hotfix of my code, it might upgrade ubuntu 12.10 to 13.04 for example
[2013-08-27 20:05:32 -0400] cwj: jq is (http://stedolan.github.io/jq/) awesome
[2013-08-27 20:05:47 -0400] philsturgeon: addisonj: keeping deployment and provisioning separate seems to me to make a lot of sense.
[2013-08-27 20:06:10 -0400] addisonj: philsturgeon: ?? am I the target of a bad tab?
[2013-08-27 20:06:17 -0400] philsturgeon: addisonj: yes
[2013-08-27 20:06:24 -0400] philsturgeon: adnichols: ^^
[2013-08-27 20:07:05 -0400] addisonj: philsturgeon: np :) but yes, thats a bad thing, imho (and since you asked me) use a different tool for deploys than for config management :)
[2013-08-27 20:07:17 -0400] adnichols: philsturgeon I do keep them separate - but I like having a single tool to contain the configs
[2013-08-27 20:07:28 -0400] adnichols: philsturgeon "separate" doesn't have to mean different tools
[2013-08-27 20:08:24 -0400] adnichols: Our deploys are triggered in a completely different way than config mgmt changes - but the execution of both is done by chef
[2013-08-27 20:08:43 -0400] philsturgeon: adnichols: ahh, well I want jenkins to become my deploy trigger not chef
[2013-08-27 20:08:56 -0400] adnichols: philsturgeon exactly - that's how we do it
[2013-08-27 20:09:00 -0400] philsturgeon: so i can provision server with chef, then click a deploy button next to a green build on jenkins
[2013-08-27 20:09:11 -0400] adnichols: philsturgeon jenkins triggers a chef run on each node to deploy
[2013-08-27 20:09:29 -0400] adnichols: philsturgeon that chef run has a targeted list of recipes that get run
[2013-08-27 20:09:39 -0400] philsturgeon: adnichols: how do you make it only deploy code and not provision the whole thing?
[2013-08-27 20:09:49 -0400] adnichols: philsturgeon chef-client -o
[2013-08-27 20:09:55 -0400] bean: philsturgeon:  "I dont like that if i want to deploy a hotfix of my code, it might upgrade ubuntu 12.10 to 13.04 for example"  what are you talking about...
[2013-08-27 20:10:49 -0400] adnichols: philsturgeon we use knife exec to update the nodes w/ the version they should be running & then execute the recipe on each host
[2013-08-27 20:10:56 -0400] philsturgeon: bean: if im working on upgrading my local dev box, then we have to deploy a hotfix, the latest shit is going to be deployed. that can be a minor code hotfix and a major software update.
[2013-08-27 20:11:51 -0400] bean: oh, I thought you were trying to say that things would just magically switch ubuntu versions
[2013-08-27 20:11:54 -0400] bean: and I was like "... what"
[2013-08-27 20:11:57 -0400] philsturgeon: bean: ofc not :)
[2013-08-27 20:12:09 -0400] philsturgeon: adnichols: right, i user knife exec to provision a box, it grabs the latest code from github and also runs the recipes meaning software upgrades.
[2013-08-27 20:12:22 -0400] philsturgeon: adnichols: thats what i want to seperate. code OR provision
[2013-08-27 20:12:56 -0400] adnichols: philsturgeon yep - just separate recipes - my deploy recipes aren't in the normal run_list
[2013-08-27 20:14:05 -0400] adnichols: philsturgeon I personally don't have chef run OS updates - but that's neither here nor there as far as deployments go
[2013-08-27 20:14:30 -0400] Kzim: cwj: yeah i don't know why this variable isn't like the other thanks you for the tip
[2013-08-27 20:40:38 -0400] ichilton: How come I don't see package installs in the chef solo output?
[2013-08-27 20:40:50 -0400] ichilton: (vagrant provision)
[2013-08-27 20:53:59 -0400] ichilton: Anyone run dist-upgrade as part of a chef run?
[2013-08-27 20:54:38 -0400] ichilton: I was thinking it would be great to run a dist-upgrade on first provision but then not again unless triggered. Thinking of touching a file somewhere and using not_if, but is there a less hacky way?
[2013-08-27 20:54:39 -0400] sparr: I want a chef recipe to create symlinks named 1 2 3 4 5 6 7 9 10 11 all pointing to file 8
[2013-08-27 20:54:45 -0400] sparr: is there a shorthand way to do that?
[2013-08-27 20:55:17 -0400] ichilton: sparr: it's ruby, so something like:
[2013-08-27 20:55:59 -0400] ichilton: (1..7).each { |i| bla } would work
[2013-08-27 20:56:04 -0400] ichilton: where bla creates the symlink
[2013-08-27 20:56:21 -0400] ichilton: and then you'd need the same for 9..11 obviously
[2013-08-27 20:56:21 -0400] justizin: ichilton: why would you dist-upgrade on a first provision? why not provision the distro you want?
[2013-08-27 20:56:47 -0400] justizin: i've had some mixed experience and discussion here around normal apt-get upgrade as part of the chef run, esp if we're going to freeze an image for reuse.
[2013-08-27 20:56:53 -0400] ichilton: justizin: with a cloud provider you have no choice - their ubuntu image is what it is (and probably out of date)
[2013-08-27 20:57:11 -0400] justizin: right, but dist-upgrade gives you the next version.  you're using a provider that doesn't have the version you want?
[2013-08-27 20:57:32 -0400] justizin: also i don't think dist-upgrade is the thing anymore.  now you use some python tool..
[2013-08-27 20:57:50 -0400] ichilton: justizin: no, sorry - not to upgrade distros
[2013-08-27 20:57:55 -0400] ichilton: justizin: just to upgrade the packages
[2013-08-27 20:58:02 -0400] justizin: right, that's what i'm saying.. you can do an upgrade.  i wouldn't do a dist-upgrade. ;)
[2013-08-27 20:58:07 -0400] ichilton: justizin: I always use apt-get update && apt-get dist-upgrade && apt-get clean
[2013-08-27 20:58:15 -0400] ichilton: what's the difference with upgrade?
[2013-08-27 20:58:37 -0400] justizin: upgrade upgrades within the same distro, dist-upgrade was an old-school way of upgrading to a new distro version, though like i said, pretty sure it's deprecated..
[2013-08-27 20:58:43 -0400] justizin: (at least in ubuntu, maybe not debian)
[2013-08-27 20:58:56 -0400] jtimberman: dist-upgrade is still valid.
[2013-08-27 20:59:08 -0400] justizin: jtimberman: does it work? ;d
[2013-08-27 20:59:28 -0400] jtimberman: justizin: worked for my 10.04 -> 12.04 upgrade last year :)
[2013-08-27 20:59:30 -0400] justizin: anyhow, ichilton, if you upgrade as part of initial provision, and you launch instances at diff times, then you have instances that are out of sync..
[2013-08-27 20:59:32 -0400] ssd7: do-release-upgrade
[2013-08-27 20:59:40 -0400] jtimberman: ssd7: seems prone to error
[2013-08-27 20:59:51 -0400] justizin: right, that's what i've been using for some time..
[2013-08-27 20:59:51 -0400] justizin: both do jtimberman :-P
[2013-08-27 20:59:56 -0400] ichilton: yeah, I don't want to upgrade the release
[2013-08-27 21:00:07 -0400] ichilton: just update packages within the current release
[2013-08-27 21:00:32 -0400] ichilton: apt-get update && apt-get dist-upgrade && apt-get clean  <-- works, i've been doing it regularly for like 10 years! ;)
[2013-08-27 21:00:49 -0400] justizin: i'm looking into turning on auto security updates, but otherwise i'd say, if you're gonna use an image, use it.  slightly out of date but consistent can be better than slightly out of date at random intervals. ;)
[2013-08-27 21:02:39 -0400] justizin: otherwise, if you want always-up-to-date, always run the update, or run it once a day/week/whatever.. i just don't like that.
[2013-08-27 21:04:03 -0400] cwj: is it possible to explicitly specify the name of a LWRP resource? e.g. override the automatically generated resource name?
[2013-08-27 21:08:16 -0400] zenloop: Anyone tried installing npm recently?  I am using chef11 and am trying to install npm via the cookbook on ubuntu 11.10.  When I run the install from the command line it works no problem but with the recipe it fails.    going crazy trying to figure out what is going on because I have made no changes to the cookbook.
[2013-08-27 21:13:01 -0400] gsymons-di: cwj: I think you can only do it if you do a HWRP.
[2013-08-27 21:13:16 -0400] cwj: ok thats what i was afraid of
[2013-08-27 21:17:17 -0400] awc737: chef is telling me it can't find the "dmg" package
[2013-08-27 21:17:21 -0400] awc737: cookbook
[2013-08-27 21:17:25 -0400] awc737: but I don't have a Mac, and neither is my VM
[2013-08-27 21:17:46 -0400] adnichols: awc737 probably a dependency of another cookbook - that happens regardless of your platform often
[2013-08-27 21:17:49 -0400] gchristensen: awc737: cookbooks will depend on other cookbooks, even if they don't strictly need them for that deployment.
[2013-08-27 21:18:22 -0400] awc737: hmm ok
[2013-08-27 21:18:30 -0400] awc737: wierd though, it was git cookbook I noticed "dmg" in
[2013-08-27 21:18:38 -0400] awc737: and all the lines seemed to have an if "mac os" conditional
[2013-08-27 21:18:41 -0400] gchristensen: its because it requires the dmg cookbook for instaling, on, say, mac
[2013-08-27 21:18:58 -0400] gchristensen: and it can't say it only depends on dmg IF the platform is a mac
[2013-08-27 21:19:14 -0400] awc737: kinda wierd cause I have another app with git and not that error
[2013-08-27 21:24:11 -0400] awc737: ugh
[2013-08-27 21:24:17 -0400] awc737: now it's requiring yum
[2013-08-27 21:24:19 -0400] jmickle: anyone familiar with how the etag attr works on the remote_file provider?
[2013-08-27 21:24:31 -0400] gchristensen: awc737: you should check out berkshelf :)
[2013-08-27 21:24:34 -0400] awc737: i know something is wrong. i've ran vagrant on debian before, never required yum cookbook
[2013-08-27 21:24:40 -0400] gchristensen: jmickle: I'm familiar with etags, what's up?
[2013-08-27 21:25:00 -0400] jmickle: gchristensen: how does it work? I have a remote file i want to download but i don't want it to do anything if the file hasn't changed
[2013-08-27 21:25:16 -0400] jmickle: so is etag the best route?
[2013-08-27 21:25:29 -0400] jmickle: does etag work in that manner off of the etag header?
[2013-08-27 21:25:31 -0400] gchristensen: jmickle: a webserver can generate an etag associated with a URL, that etag can be provided and the webserver if fully-featured enough, will say it has not been modified
[2013-08-27 21:26:37 -0400] jmickle: gchristensen: so if the etag is the same in the remote file provider it won't download?
[2013-08-27 21:27:14 -0400] gchristensen: jmickle: let me do some code spelunking
[2013-08-27 21:27:27 -0400] jmickle: gchristensen hehe ty
[2013-08-27 21:27:30 -0400] Kzim: anyone knows a good doc to optimize large JSON for parsing ?
[2013-08-27 21:27:52 -0400] gchristensen: jmickle: it looks like it will take the etag from the first download and use that for comparison later
[2013-08-27 21:28:08 -0400] afirth: anyone here developing for the apache2 cookbook?
[2013-08-27 21:28:19 -0400] jmickle: gchristensen: got it thanks
[2013-08-27 21:28:27 -0400] gchristensen: jmickle: so, use_etag true -- if your webserver provides etag functionality
[2013-08-27 21:28:54 -0400] jmickle: gchristensen: any idea where it stores the etag? do i store that in a attr?
[2013-08-27 21:29:29 -0400] gchristensen: jmickle: https://github.com/opscode/chef/blob/master/lib/chef/provider/remote_file/cache_control_data.rb#L111 :)
[2013-08-27 21:29:33 -0400] gchristensen: on the filesystem
[2013-08-27 21:29:51 -0400] jmickle: perfect thank you!
[2013-08-27 21:30:01 -0400] gchristensen: surely
[2013-08-27 21:30:03 -0400] gchristensen: good luck
[2013-08-27 21:31:46 -0400] gchristensen: is there a way to convert a.b.c to node['a']['b']['c']?
[2013-08-27 21:37:47 -0400] awc737: gchristensen, I don't want berkshelf to just add the yum dependancy
[2013-08-27 21:37:53 -0400] awc737: there's something wrong, it shouldn't be requiring yum
[2013-08-27 21:38:16 -0400] awc737: with this box http://puppet-vagrant-boxes.puppetlabs.com/debian-70rc1-x64-vbox4210.box
[2013-08-27 21:39:22 -0400] justizin: awc737: when cookbooks depend on yum, they depend on yum whether you have yum or not.. berkshelf really makes that painless..
[2013-08-27 21:39:24 -0400] gchristensen: awc737: yes it should be: https://github.com/opscode-cookbooks/git/blob/master/metadata.rb#L18 here are all the dependencies just on the `git` cookbook.
[2013-08-27 21:39:38 -0400] gchristensen: its the same as the dependency on `dmg`
[2013-08-27 21:40:05 -0400] awc737: that's really wierd I have another vagrant VM with git and it no yum cookbook
[2013-08-27 21:40:16 -0400] gchristensen: I would say that is even weirder
[2013-08-27 21:42:26 -0400] awc737: I have never seen a debian flavor vagrant include yum
[2013-08-27 21:42:30 -0400] awc737: https://github.com/r8/vagrant-lamp/tree/master/cookbooks
[2013-08-27 21:42:33 -0400] awc737: https://github.com/mattandersen/vagrant-lamp/tree/master/chef/cookbooks
[2013-08-27 21:42:56 -0400] gchristensen: justizin: do you know if chef-solo enforces dependencies?
[2013-08-27 21:43:05 -0400] justizin: that's a fine question..
[2013-08-27 21:43:11 -0400] justizin: i don't know much about chef-solo
[2013-08-27 21:43:12 -0400] jtimberman: gchristensen: it doesn't
[2013-08-27 21:43:16 -0400] justizin: makes sense..
[2013-08-27 21:43:24 -0400] abrkn: is there a trick to initctl to start if not started else restart?
[2013-08-27 21:43:28 -0400] jtimberman: gchristensen: but things will break if you try to use a cookbook that has a dependency on another, and you didn't put it on the node for chef-solo to use.
[2013-08-27 21:43:37 -0400] jtimberman: chef-solo requires that you ship everything to the node in question
[2013-08-27 21:43:39 -0400] gchristensen: awc737: there you are. chef-server enforces dependencies, whereas chef-solo does not necessarily. that is why yum and dmg have not previously been used.
[2013-08-27 21:44:20 -0400] awc737: both of those examples use chef solo
[2013-08-27 21:44:25 -0400] gchristensen: yes
[2013-08-27 21:44:28 -0400] awc737: as does my working debian instance without yum
[2013-08-27 21:44:30 -0400] jtimberman: in the case of the git cookbook, the reason for the dependencies is because it supports a multitude of platforms, and if the proper cookbooks aren't present, it will break.
[2013-08-27 21:44:32 -0400] gchristensen: yes
[2013-08-27 21:44:43 -0400] gchristensen: awc737: exactly
[2013-08-27 21:44:44 -0400] jtimberman: then users of those platforms will get angry and open tickets and yell on twitter that it's not working :)
[2013-08-27 21:45:10 -0400] awc737: gchristensen, but my debian VM throwing an error about yum right now, is also chef solo
[2013-08-27 21:45:15 -0400] jtimberman: thing is, they're harmless if you're not using them. that is, "yum" isn't going to be used on debian :)
[2013-08-27 21:45:40 -0400] jtimberman: if there's an error about the yum cookbook on debian, *that* is a bug.
[2013-08-27 21:46:07 -0400] jtimberman: (unless it's a "i don't have the yum cookbook and the git cookbook depends on it)
[2013-08-27 21:46:26 -0400] awc737: yeah but were all using chef solo here
[2013-08-27 21:46:27 -0400] gchristensen: that's what it is
[2013-08-27 21:46:42 -0400] awc737: and so far 3 out of 4 examples don't through the warning, and don't require yum
[2013-08-27 21:47:24 -0400] gchristensen: awc737: is this through vagrant?
[2013-08-27 21:47:27 -0400] awc737: yeah
[2013-08-27 21:47:59 -0400] gchristensen: can you pastebin your vagrantfile?
[2013-08-27 21:48:08 -0400] slillibri: Isn't there a client_fork = true option for the client.rb? The docs don't indicate one - http://docs.opscode.com/config_rb_client.html
[2013-08-27 21:48:27 -0400] jtimberman: slillibri: its default to true in 11.6.0+
[2013-08-27 21:48:29 -0400] awc737: yeah gchristensen
[2013-08-27 21:49:17 -0400] slillibri: @jtimberman: I have 11.4.0 clients
[2013-08-27 21:49:54 -0400] abrkn: im getting timeouts to github. are there more ports than tcp 443, 80, 22 to clone anything?
[2013-08-27 21:50:15 -0400] gleam: git:// on 9418 should work
[2013-08-27 21:50:20 -0400] gleam: if it's public
[2013-08-27 21:50:40 -0400] abrkn: ok, adding that
[2013-08-27 21:51:11 -0400] abrkn: getting errors as part of npm install (node.js)
[2013-08-27 21:52:33 -0400] abrkn: thanks again gleam
[2013-08-27 21:52:50 -0400] irdan: can someone tell me if there is a preferred way of replicating the functionality of the platform_family method for those stuck in < 0.10.10?
[2013-08-27 21:55:10 -0400] dgarstang: How do I get knife-ec2 to spin up and instance, but not ssh into it?
[2013-08-27 21:56:54 -0400] synodone: comment out your ssh key in knife
[2013-08-27 21:57:10 -0400] synodone: it will spin up but fail on the bootstrap
[2013-08-27 21:57:33 -0400] synodone: the ec2 key specifically
[2013-08-27 21:57:50 -0400] dgarstang: synodone: Uhm, how about now attempt the bootstrap at all?
[2013-08-27 21:57:55 -0400] dgarstang: s/now/not/
[2013-08-27 21:58:12 -0400] dgarstang: synodone: it's broken anyway, so I'd rather not even have it try
[2013-08-27 21:58:33 -0400] synodone: k
[2013-08-27 22:00:05 -0400] thatothermitch: should node.recipe? work in chef-client 11.4+ ?
[2013-08-27 22:00:24 -0400] dgarstang: How do I get knife-ec2 to spin up and instance, but not ssh into it?
[2013-08-27 22:01:34 -0400] jtimberman: slillibri: the syntax for client.rb is: client_fork true
[2013-08-27 22:01:35 -0400] jtimberman: no =
[2013-08-27 22:02:10 -0400] chance: jtimberman: you worked a lot on the application* cookbooks, right?
[2013-08-27 22:02:17 -0400] slillibri: @jtimberman Cool, thanks
[2013-08-27 22:02:19 -0400] jtimberman: chance: not really. :)
[2013-08-27 22:02:23 -0400] chance: :\
[2013-08-27 22:02:50 -0400] jtimberman: i'm familiar with them and have used the resources for a few things, but nothing recently and i don't know the underlying code very well.
[2013-08-27 22:02:51 -0400] thatothermitch: hrm, nevermind, i guess chef 10.x just supported my typo, "recipes?"
[2013-08-27 22:02:55 -0400] chance: im trying to figure out how to use the callback attributes, but im thinking those are mostly for sub-resources (IE: application_python/ruby)
[2013-08-27 22:04:22 -0400] chance: atm im realizing the application LWRPs are absolutely inflexible to the extent of them being more bad than good.
[2013-08-27 22:05:25 -0400] cwj: they are very opinionated, as is chef in general
[2013-08-27 22:05:41 -0400] cwj: er chef cookbooks in general i mean
[2013-08-27 22:06:25 -0400] gchristensen: chance: the application LWRP causes me more pain than ease, so I stopped using them in new stuff
[2013-08-27 22:06:34 -0400] thatothermitch: chef opinionated?
[2013-08-27 22:06:34 -0400] thatothermitch: wtf?
[2013-08-27 22:06:45 -0400] thatothermitch: i heartily disagree
[2013-08-27 22:07:07 -0400] bscott: I need to know the Chef ORG in one of my recipes
[2013-08-27 22:07:10 -0400] bscott: any Ideas?
[2013-08-27 22:07:25 -0400] bscott: of te current node
[2013-08-27 22:07:54 -0400] cwj: thatothermitch: i misspoke, i meant to say that chef cookbooks in general are very opinionated
[2013-08-27 22:08:01 -0400] thatothermitch: sure
[2013-08-27 22:08:03 -0400] thatothermitch: i'll buy that
[2013-08-27 22:08:34 -0400] jtimberman: chef: unopinionated. chef cookbooks: highly opinionated.
[2013-08-27 22:08:53 -0400] thatothermitch: : P
[2013-08-27 22:09:09 -0400] chance: it isnt opinionated thats the problem at all
[2013-08-27 22:09:12 -0400] chance: im totally fine with that
[2013-08-27 22:09:17 -0400] jtimberman: or, primitives: unopinionated. implementation: opinionated.
[2013-08-27 22:09:44 -0400] jtimberman: like ruby vs rails :)
[2013-08-27 22:09:44 -0400] a13x212: if i just want to copy a file, should i use cookbook_file?
[2013-08-27 22:09:52 -0400] tabolario: i've been looking at using the application cookbooks for things that are not my applications, but don't have a native package
[2013-08-27 22:10:22 -0400] tabolario: my own stuff is quite a bit more specific than the application cookbook LWRPs provide for
[2013-08-27 22:10:45 -0400] dgarstang: How do I get knife-ec2 to spin up and instance, but not ssh into it?
[2013-08-27 22:11:11 -0400] chance: the big thing im running into is that you cant even add to requirements, or use the existing callbacks to add some stuff to do before deploy/migrate steps
[2013-08-27 22:11:31 -0400] chance: ie: i cant python_pip install mysql-python before migrate :|
[2013-08-27 22:13:16 -0400] cwj: chance: what happens when you try? i dont have any before_migrate callbacks in my stuff, but i do manage resources inside of other callbacks (e.g. before_restart, before_symlink)
[2013-08-27 22:13:33 -0400] chance: it doesnt run
[2013-08-27 22:13:35 -0400] chance: the callback code
[2013-08-27 22:13:56 -0400] cwj: show me your work?
[2013-08-27 22:14:02 -0400] chance: on it :)
[2013-08-27 22:14:43 -0400] chance: http://pastebin.osuosl.org/3145/
[2013-08-27 22:14:59 -0400] awc737: gchristensen, I did gem install berkshelf
[2013-08-27 22:15:01 -0400] chance: it never logs that log statement or includes the recipe
[2013-08-27 22:15:03 -0400] awc737: I get berks: command not ofund
[2013-08-27 22:15:33 -0400] gchristensen: awc737: I'm not able to debug your ruby install
[2013-08-27 22:15:33 -0400] chance: also, block is wrong
[2013-08-27 22:15:36 -0400] chance: it used to be action
[2013-08-27 22:15:46 -0400] awc737: all my other gems work, compass etc
[2013-08-27 22:16:27 -0400] chance: awc737: try running the install again, i ran into an issue where it couldnt compile the RDOcs
[2013-08-27 22:16:29 -0400] chance: RDocs
[2013-08-27 22:16:41 -0400] chance: so it would fail after that, and trying again it would pickup after the spot it failed at.
[2013-08-27 22:17:26 -0400] chance: cwj: https://gist.github.com/ecnahc515/6359877 better paste
[2013-08-27 22:17:42 -0400] cwj: chance: try changing block :before_migrate to before_migrate and then hoist the entire block up into the application resource itself
[2013-08-27 22:18:03 -0400] chance: i need it to happen after the django :deploy block though
[2013-08-27 22:18:09 -0400] chance: before_deploy*
[2013-08-27 22:18:15 -0400] bscott: Is there a way to detect the chef org of a node in a recipe besides a regex against the CHEF::Config object
[2013-08-27 22:18:23 -0400] awc737: strange I needed /bin/bash --login
[2013-08-27 22:18:36 -0400] dgarstang: Omg, knife-ec2 is unusable.
[2013-08-27 22:18:44 -0400] cwj: chance: hrm i see
[2013-08-27 22:18:45 -0400] siezer: bscott what exactly are you trying to do
[2013-08-27 22:19:02 -0400] cwj: chance: i have not tried accessing the callbacks of subresources like django so i am not sure
[2013-08-27 22:19:15 -0400] bscott: siezer: I need to know the chef org of a node during a chef run for a report handler
[2013-08-27 22:19:21 -0400] chance: cwj: yeah, basically im trying to make my django app allow for multiple db types, so the user can just use the right recipe for their particular db.
[2013-08-27 22:19:30 -0400] cwj: chance: have you tried before_migrate do foo end inside that django subresource?
[2013-08-27 22:19:34 -0400] siezer: bscott use the config object
[2013-08-27 22:19:52 -0400] chance: cwj: yeah i think so
[2013-08-27 22:20:08 -0400] dgarstang: https://github.com/opscode/knife-ec2/pull/3 .... 2 years old... Seriously!?
[2013-08-27 22:21:03 -0400] volker-: does someone know where the chefcuts page moved to? Couldn't find it with google.
[2013-08-27 22:21:20 -0400] siezer: dgarstang I dont get it
[2013-08-27 22:21:27 -0400] dgarstang: siezer: get what?
[2013-08-27 22:22:10 -0400] siezer: why you referenced the url, its age, then typed the string 'Seriously!?'
[2013-08-27 22:22:26 -0400] siezer: looks like it was merged to me
[2013-08-27 22:22:36 -0400] dgarstang: siezer: well.. I'm not a git expert, but that pull request was done 2 years ago.. and it sure doesn't work
[2013-08-27 22:23:50 -0400] chance: then maybe that issue isnt the one your experiencing
[2013-08-27 22:23:59 -0400] dgarstang: chance: symptoms are identical
[2013-08-27 22:24:03 -0400] chance: or maybe that pull request didnt get all the edge cases right
[2013-08-27 22:24:10 -0400] dgarstang: chance: seems more likely
[2013-08-27 22:24:12 -0400] jtimberman: dgarstang: sometimes a little sleep isn't enough, and you need more sleep. but adding sleep is often a smell :-|
[2013-08-27 22:24:17 -0400] chance: i mean if its a PR, it means someone in the community probably 'fixed it'
[2013-08-27 22:24:23 -0400] jtimberman: so it's a sleepery slope. (haw ;))
[2013-08-27 22:24:32 -0400] kallistec: dgarstang: is it failing for you with `Errno::EHOSTUNREACH` ?
[2013-08-27 22:24:34 -0400] dgarstang: jtimberman: (notsureif)
[2013-08-27 22:25:01 -0400] siezer: obviously you're not =)
[2013-08-27 22:25:13 -0400] siezer: anyway knife-ec2 is its own gem now
[2013-08-27 22:25:14 -0400] bscott: siezer: any ideas?
[2013-08-27 22:25:26 -0400] bscott: jtimberman: Hey Dude
[2013-08-27 22:25:27 -0400] siezer: but it was merged in a timely manner two years ago
[2013-08-27 22:25:29 -0400] dgarstang: kallistec: 'ERROR: Net::SSH::Disconnect'... but I have a second window open, and it's already reporting that, and I still can't ssh in yet. 'Connection refused'. Ssh isn't even up yet and knife has failed
[2013-08-27 22:25:35 -0400] siezer: bscott yea you're gonna have to use that config object
[2013-08-27 22:25:44 -0400] bscott: k
[2013-08-27 22:26:22 -0400] kallistec: dgarstang: well, that's a totally different thing then
[2013-08-27 22:26:39 -0400] siezer: I thought the IaaS plugins spun around and pulled for ssh to comeup
[2013-08-27 22:26:46 -0400] dgarstang: kallistec: git thing is the same
[2013-08-27 22:26:50 -0400] siezer: s/pulled/polled/
[2013-08-27 22:26:58 -0400] siezer: s/comeup/come up/
[2013-08-27 22:27:07 -0400] kallistec: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb#L254-284
[2013-08-27 22:27:13 -0400] bscott: siezer:  thanks
[2013-08-27 22:27:16 -0400] siezer: np
[2013-08-27 22:27:32 -0400] kallistec: dgarstang: so something is listening on the tcp port and presenting a banner
[2013-08-27 22:27:48 -0400] dgarstang: kallistec: but what calls that? how long does it wait? Does it retry on failure?
[2013-08-27 22:29:02 -0400] chance: cwj: so i moved the block above the django block, and the debug print works, and then it errors saying "Cannot find a resource for include_recipe on ubuntu version 12.04"
[2013-08-27 22:29:02 -0400] dgarstang: kallistec: if it's not that, it's an ssh proxy issue. I can follow the same logic though, so I dunno.
[2013-08-27 22:29:05 -0400] kallistec: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb#L412
[2013-08-27 22:29:52 -0400] dgarstang: what are the perms/owner on /etc/chef supposed to be? I only have a server here, and /etc/chef is owned by chef-server which I suspect wouldn't make sense on the client
[2013-08-27 22:31:33 -0400] dgarstang: actually I'm really confused, because my server only has the chef_server user, yet I have both the server and client installed on this machine.
[2013-08-27 22:31:56 -0400] siezer: chef-client runs as root
[2013-08-27 22:32:03 -0400] siezer: so it doesn't have a user
[2013-08-27 22:32:10 -0400] dgarstang: siezer: k
[2013-08-27 22:36:01 -0400] surge_: Anyone succesfully use the campfire chef-handler gem ?
[2013-08-27 22:36:41 -0400] surge_: Even though I ran gem_package "broach" before using the gem, I still get an exception during my chef run. cannot load such file -- broach
[2013-08-27 22:38:52 -0400] cwj: surge_: if your cookbook needs the gem, try chef_gem instead of gem_package
[2013-08-27 22:39:06 -0400] cwj: chef_gem ensures the gem is installed in the ruby environment chef is running in
[2013-08-27 22:40:19 -0400] surge_: cwj: Thanks. I'll try that. I had just tried "require 'broach'" in irb to confirm it was installed. Guess it was an environment issue
[2013-08-27 22:41:24 -0400] chance: does anyone know if vagrant does its synced_folder stuff before it runs your provisioner?
[2013-08-27 22:41:37 -0400] surge_: I believe it does.
[2013-08-27 22:42:01 -0400] chance: mk, so in my cookbook if the environment is vagrant, i could just make sure it exists there, and use that instead of cloning. good good.
[2013-08-27 22:42:13 -0400] thatothermitch: node.recipe? is giving me a serious case of the face-palms
[2013-08-27 22:42:26 -0400] surge_: It forwards ports, creates a share folder w/ the directory that the Vagrantfile resides in and a bunch of other things
[2013-08-27 22:43:15 -0400] surge_: chance: Yeah, no need to clone. Just put everything under the parent directory and you'll save some time that way
[2013-08-27 22:43:19 -0400] thatothermitch: does the recipe need to be literally specified in the runlist for it to match?
[2013-08-27 22:43:37 -0400] thatothermitch: it's in the expanded run list, but chef seems to not care
[2013-08-27 22:44:42 -0400] cwj: thatothermitch: for expanded run list try node.recipes.include?(foo::bar)
[2013-08-27 22:44:57 -0400] thatothermitch: would i need to specify foo::default?
[2013-08-27 22:45:14 -0400] cwj: i think that depends on how its written in the run list
[2013-08-27 22:45:45 -0400] thatothermitch: expanded runlist reporst the coobook name w/o the "::default"
[2013-08-27 22:46:16 -0400] thatothermitch: does it only match recipes that have already run?
[2013-08-27 22:46:19 -0400] surge_: thatothermitch: similarly, if you do searches w/ knife or have a search in a recipe, plural => expanded role/run list, singular => the opposite
[2013-08-27 22:46:55 -0400] thatothermitch: that convention seems less than intuitive
[2013-08-27 22:46:58 -0400] thatothermitch: but hey, if it's consistent
[2013-08-27 22:47:04 -0400] surge_: yeah it's jus the way it is
[2013-08-27 22:47:13 -0400] thatothermitch: i'll give that a short, thanks folks
[2013-08-27 22:53:45 -0400] thatothermitch: is there any documentation about the node.xyz methods?
[2013-08-27 22:53:54 -0400] thatothermitch: i didn't see an obvious section in the recipe dsl
[2013-08-27 22:56:51 -0400] surge_: thatothermitch: run "chef-shell" and type "node.methods"
[2013-08-27 23:03:46 -0400] spicy: chef_gem installs gems at compile time vs run time, right
[2013-08-27 23:04:13 -0400] spicy: i'm running into an error with one of my cookbooks that has a library that depends on a gem
[2013-08-27 23:05:46 -0400] pcn: ohai chefs
[2013-08-27 23:06:01 -0400] pcn: any way to install omnibus 11.6.0 on ubuntu 13.04?
[2013-08-27 23:06:13 -0400] mannyt: When using "knife bootstrap" to bootstrap a bunch of CentOS 6.4 servers, on some runs Chef client 11.6 is installed and on other 11.4.4 gets installed.  We really aren't sure how to explain this.  Does anyone have any ideas?
[2013-08-27 23:06:33 -0400] pcn: mannyt are you specifying     --bootstrap-version 11.6.0 ?
[2013-08-27 23:06:56 -0400] mannyt: no we weren't during that run
[2013-08-27 23:07:30 -0400] mannyt: I guess its good to specify
[2013-08-27 23:07:43 -0400] pcn: I guess it sounds like opscode is returning different answers.  specifying that could help determine if that's the case
[2013-08-27 23:07:44 -0400] mannyt: Would the boot strap pull from different mirrors
[2013-08-27 23:09:58 -0400] pcn: I think you'd have to ask someone who works for opscode about the specifics of the omnibus installer and the rest apis behind it
[2013-08-27 23:10:14 -0400] pcn: That's what I'm doing here
[2013-08-27 23:10:24 -0400] mannyt: Well thanks pcn, that flag will have to do for now
[2013-08-27 23:13:15 -0400] pcn: re: installing 11.6.0 on ubuntu 13.04, I see http://tickets.opscode.com/browse/CHEF-4067 is marked as resolved, but I can't seem to install on an x86_64 ec2 instance
[2013-08-27 23:16:14 -0400] mannyt: pcn what errors are you getting?
[2013-08-27 23:23:39 -0400] juliancdunn: mannyt: the version that gets installed on your target is the same one you're running on your workstation
[2013-08-27 23:25:53 -0400] mannyt: thanks juiliancdunn, time to double check my workstations
[2013-08-27 23:26:41 -0400] mannyt: and potentially upgrade them
[2013-08-27 23:26:53 -0400] zenloop: has anyone had any trouble with the npm cookbook?
[2013-08-27 23:48:21 -0400] alexkarp: I'm getting an ArgumentError when trying to create a mysql database
[2013-08-27 23:48:21 -0400] alexkarp: http://dpaste.com/1358451/
[2013-08-27 23:48:41 -0400] alexkarp: the recipe used to work fine, but then the operations team upgraded my server's version of Ubuntu
[2013-08-27 23:48:48 -0400] alexkarp: and now I get that error
[2013-08-27 23:48:51 -0400] alexkarp: any clues?
[2013-08-27 23:49:04 -0400] dgarstang: Anyone adding users with cloud-init ?
[2013-08-27 23:55:01 -0400] douglaswth: alexkarp: big clue: [2013-08-27T19:45:55-04:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out
[2013-08-27 23:59:35 -0400] alexkarp: douglaswth: I'll be honest, I don't even see anywhere that's getting 5 arguments referenced in that stacktrace
[2013-08-27 23:59:49 -0400] alexkarp: http://dpaste.com/1358457/
