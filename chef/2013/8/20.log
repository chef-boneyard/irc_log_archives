[2013-08-20 00:11:52 -0400] jmickle: whose around
[2013-08-20 00:11:59 -0400] jmickle: is node.set_unless still valid
[2013-08-20 00:12:02 -0400] jmickle: in chef 11?
[2013-08-20 00:15:53 -0400] dgarstang: ah I love the (chompy) hipchat emoticon. :)
[2013-08-20 02:29:10 -0400] jameson__: dgarstang: what you really got to love are the custom ones.
[2013-08-20 02:29:24 -0400] jameson__: we've made one for every developer and every meme
[2013-08-20 02:30:10 -0400] jameson__: who knows why rabbitmq cookbook does unless/if instead of doing only_if { ruby condition } and not_if { ruby condition }
[2013-08-20 02:30:28 -0400] jameson__: making my foodcritic not like it
[2013-08-20 08:42:47 -0400] visof: how can i make dependency cookbooks?
[2013-08-20 08:54:13 -0400] isbaran: visof: you write them in metadata.rb if i get your question right
[2013-08-20 08:54:45 -0400] bigbigbang: Ohai ! I got probleme on Solr on Open source 11.0.8 , it shows me nothing when performing a search ... I don't find anything that can help me in log files (solr) . The only "thing" that i found weird is this (error?) : http://imgur.com/KuUY5uM on rabbitMQ . Can someone told me if it's normal ? The picture come from the rabbitmq management web page .. Thanks for helping
[2013-08-20 08:54:48 -0400] visof: isbaran, depends 'Cat'
[2013-08-20 08:54:53 -0400] visof: thanks man
[2013-08-20 08:55:16 -0400] isbaran: yep
[2013-08-20 08:56:00 -0400] bigbigbang: And yeah.. I'm playing on chef open source architecture..
[2013-08-20 09:16:38 -0400] bigbigbang: Ok problem solved, thx anyway . The disk free limit on rabbitmq blocked all my messages, so the search was not working .. Now I think it's work because the "chef-server-ctl test (all)" doesn't give me error ..
[2013-08-20 09:17:04 -0400] bigbigbang: that's all, the search result on webpage doesn't work yet ..
[2013-08-20 09:17:23 -0400] bigbigbang: just have to wait a bit .. ^
[2013-08-20 09:30:20 -0400] tralamazza: miah: for now I've the include_recipe in a begin/rescue
[2013-08-20 11:04:34 -0400] anu: Hi All ..I am looking for how to use ruby_block resource to utilize a certain username//password instead when pulling files from artifactory..
[2013-08-20 11:04:44 -0400] anu: can anyone guide/help me?
[2013-08-20 11:09:07 -0400] anu: remote_file file doesn't works with https..any other option?
[2013-08-20 11:21:18 -0400] isbaran: anu: i believe it works, but you can put a wrapper around it if not
[2013-08-20 11:21:34 -0400] isbaran: anu: see s3 file for example, which fetches from s3
[2013-08-20 11:23:23 -0400] anu: Tried using remote_file with  https://username:password@serveripaddress/artifactory. but authentication doen't works..getting connection timeout erro
[2013-08-20 11:25:40 -0400] isbaran: anu: you can also use a one liner wget command
[2013-08-20 11:27:03 -0400] anu: tried wget also with same error connection timeout..looks like there might be some firewall restriction
[2013-08-20 11:27:30 -0400] isbaran: i see ftp has user/password methods http://chefdoc.info/docs/chef/11.6.0/Chef/Provider/RemoteFile/FTP
[2013-08-20 11:31:54 -0400] Sri_: hello all
[2013-08-20 11:37:22 -0400] perryofpeek: @anu is artifactory running on port 80 or 8080 (which is the default?)
[2013-08-20 11:58:48 -0400] tommyblue: Hello, I'm using knife-esx to create new ESX vms and bootstrap the new node. The vm is created from a template, so during bootstrap I edit the hostname. Do you know a way to restart the machine after first chef-client run? More in general: is it possible to detect the first chef-client run?
[2013-08-20 12:09:52 -0400] perryofpeek: @tommyblue, not sure if there is a better way than this, but you can always write a "firstrun.touch" file
[2013-08-20 12:10:18 -0400] perryofpeek: then if file is there , you know it's not the first run
[2013-08-20 12:12:53 -0400] bigbigbang: Does anyone know if it's possbile to integrate LDAP with chef Open source 11.0.8 ?
[2013-08-20 12:13:04 -0400] bigbigbang: i found documentations on private chef only ^
[2013-08-20 12:13:22 -0400] gchristensen: how would you want it "integrated"?
[2013-08-20 12:13:57 -0400] bigbigbang: gchristensen: so that i can login on web-ui with ldap credentials
[2013-08-20 12:14:10 -0400] tommyblue: perryofpeek, ok, thanks. So there isn't a built-in function to detect it from a recipe
[2013-08-20 12:15:09 -0400] bigbigbang: gchristensen: I don"t want to integrate it just wondering if it is already integrated and if yes, where configure this
[2013-08-20 12:16:21 -0400] gchristensen: bigbigbang: gotcha. I didn't think 11 shipped with a web-ui anymore
[2013-08-20 12:16:47 -0400] zts: bigbigbang: I believe that's private chef only
[2013-08-20 12:17:10 -0400] zts: gchristensen: it is, though it was disabled by default for a while (not sure if that's still true in 11.0.8)
[2013-08-20 12:17:24 -0400] gchristensen: was the outcry too much?
[2013-08-20 12:17:26 -0400] bigbigbang: gchristensen: no my web-ui isn't disabled by default
[2013-08-20 12:17:27 -0400] zts: gchristensen: there were mumblings about it probably being removed in Chef 12 though
[2013-08-20 12:17:42 -0400] gchristensen: got it
[2013-08-20 12:18:00 -0400] bigbigbang: gchristensen: arf the web-ui is quite sympathic
[2013-08-20 12:18:25 -0400] gchristensen: arf?
[2013-08-20 12:18:46 -0400] gchristensen: sympathic? I have no idea what you just said :D
[2013-08-20 12:19:16 -0400] bigbigbang: gchristensen: french expression ( like d'oh for h.simpsons .. ;-) )
[2013-08-20 12:19:23 -0400] gchristensen: ah!
[2013-08-20 12:26:50 -0400] ichilton: I want to setup a 2nd workstation - should I just copy my ~/.chef from my existing one rather than run knife configure -i again which would create a new/separate user?
[2013-08-20 12:27:38 -0400] perryofpeek: @tommyblue - not to my knowledge
[2013-08-20 12:29:27 -0400] zts: ichilton: up to you - some people would prefer to have each key on a single machine, others don't mind it if a user with two devices shares the same key on each
[2013-08-20 12:29:55 -0400] gchristensen: ichilton: consider if you lose one workstation, you'd have to clear out your credentials and have to re-provision them. if you use different keys, you only have to cancel the one account.
[2013-08-20 12:32:31 -0400] ichilton: ah, ok
[2013-08-20 12:32:39 -0400] ichilton: Is it 1 key per user?
[2013-08-20 12:32:55 -0400] ichilton: i,e could you use the same user but have a key per device?
[2013-08-20 12:33:04 -0400] ichilton: or do people just use different users per device then?
[2013-08-20 12:36:20 -0400] zts: oh, good question!  It used to be one key per user (as users were just clients).  I don't think that changes with OSC 11, but I haven't checked
[2013-08-20 12:37:08 -0400] zts: so I've used different clients (with obvious names) in the past
[2013-08-20 12:38:19 -0400] ichilton: ok, thanks
[2013-08-20 12:38:31 -0400] ichilton: So rather than zts you use something like zts-macbook?
[2013-08-20 12:39:24 -0400] zts: ichilton: exactly
[2013-08-20 12:39:45 -0400] ichilton: can you rename a user? :)
[2013-08-20 12:42:55 -0400] zts: I'm not aware of any safe and easy way to do that :)
[2013-08-20 12:43:02 -0400] ichilton: k
[2013-08-20 12:43:03 -0400] ichilton: thanks
[2013-08-20 12:47:31 -0400] lewiz: When creating a directory with the directory provider is the setting of owner/group delayed in any way?
[2013-08-20 12:48:06 -0400] gchristensen: it might do it in two separate commands, but that is as delayed as it would get
[2013-08-20 12:49:45 -0400] lewiz: gchristensen: That's what I expected.  I'm seeing some strange behaviour where the permissions aren't getting set correctly (or, perhaps, something is resetting them).  I'm not seeing "changing owner..." etc. when creating a directory, as I do with some templates
[2013-08-20 12:49:49 -0400] nimbius: hi chef, nginx keeps spitting out Net::HTTPServerException: 413 "Request Entity Too Large"
[2013-08-20 12:50:20 -0400] gchristensen: lewiz: you can do -l debug for debug loglevel (highly noisy)
[2013-08-20 12:51:01 -0400] lewiz: gchristensen: thanks, I will try that and see what it shows
[2013-08-20 12:54:10 -0400] nimbius: once again, trying to bootstrap a node with the chef server results in 413 entity too large being logged to /var/chef/cache/chef-stacktrace.out on the node
[2013-08-20 12:54:46 -0400] nimbius: http://stackoverflow.com/questions/11454765/opscode-chef-request-entity-too-large-registering-a-node
[2013-08-20 12:55:05 -0400] nimbius: this has been encountered before, however the max body parameter for nginx does not resolve the issue.
[2013-08-20 12:56:45 -0400] nimbius: it appears to happen when we try to fetch node attributes.
[2013-08-20 13:00:24 -0400] zahna: is there a way to assemble a more dynamic run_list for chef-solo rather than a static one listed in the json file?
[2013-08-20 13:05:57 -0400] ichilton: Chef managed firewalls - iptables or ufw?
[2013-08-20 13:09:21 -0400] phessler: hi, is there a way I can force the affected nodes to update when a specific cookbook is uploaded?
[2013-08-20 13:09:56 -0400] phessler: e.g. I edit the firewall rules, and the chef-server pushes the changes out to the firewalls
[2013-08-20 13:11:33 -0400] phessler: I can find the specific nodes with 'search(:node, "recipes:firewall_rules")'
[2013-08-20 13:12:12 -0400] isbaran: phessler: this is normally done in other way around, clients check for updates
[2013-08-20 13:12:38 -0400] phessler: isbaran: yea, for most things that is fine.  this is a special case in my env.
[2013-08-20 13:12:56 -0400] phessler: if the firewalls have different rulesets for some amount of time, Bad Things can happen
[2013-08-20 13:13:41 -0400] isbaran: for sth. similar, i'm using cronjobs outside of chef infrastructure
[2013-08-20 13:13:55 -0400] phessler: ok
[2013-08-20 13:14:06 -0400] phessler: I can just do a dance with knife ssh
[2013-08-20 13:14:21 -0400] isbaran: you can put a trigger which searches and runs chef-client on commits
[2013-08-20 13:14:29 -0400] phessler: git trigger?
[2013-08-20 13:14:53 -0400] isbaran: yes, if you can configure git server as a workstation
[2013-08-20 13:15:03 -0400] isbaran: don't know if this would work ok
[2013-08-20 13:15:14 -0400] phessler: hmm
[2013-08-20 13:15:49 -0400] isbaran: post receive would upload cookbook and trigger chef-client
[2013-08-20 13:15:52 -0400] jalateras: i was wondering what is the chef way for overriding a template in a cookbook i am using
[2013-08-20 13:16:09 -0400] isbaran: jalateras: i'm using chef-rewind, works fine for most situations
[2013-08-20 13:17:28 -0400] jalateras: so i am using chef with berkshelf and i am using the jenkins cookbook
[2013-08-20 13:18:03 -0400] jalateras: i want to ensure that the jenkins recipe picks up my version of a template file rather than the one supplied in the jenkins cookbook
[2013-08-20 13:18:19 -0400] isbaran: if its a regular template definition, it works fine
[2013-08-20 13:18:29 -0400] isbaran: for example not dynamically created
[2013-08-20 13:19:34 -0400] jalateras: oksy, that looks like it may work for me
[2013-08-20 13:19:45 -0400] lewiz: gchristensen: Interestingly I get "[2013-08-20T14:13:49+01:00] DEBUG: found target_uid == nil, so no owner was specified on resource, not managing owner" and ditto for gid, despite user and group being set
[2013-08-20 13:19:58 -0400] lewiz: gchristensen: Ahhh... just realised what's wrong.  The specified user does not exist!
[2013-08-20 13:20:05 -0400] chris613: jalateras: Another vote for chef-rewind
[2013-08-20 13:20:21 -0400] phessler: knife ssh "recipes:firewall_rules" "chef-client --once"
[2013-08-20 13:20:24 -0400] jalateras: cool, i'll give it a go
[2013-08-20 13:20:37 -0400] phessler: that does pretty much what I want it to do (once I fix the chef-client problem....)
[2013-08-20 13:20:40 -0400] phessler: thanks!
[2013-08-20 13:21:06 -0400] isbaran: chris613: are you using it with dynamically created templates ? like nagios for example
[2013-08-20 13:23:43 -0400] chris613: isbaran: Dynamically created? You mean like from an LWRP instead of in the templates dir?
[2013-08-20 13:24:32 -0400] isbaran: chris613: for example when template name is generated in code, ( for ex. you're looping on template1, template2 .. )
[2013-08-20 13:25:10 -0400] isbaran: original cookbook loops on attributes and creates template definitions for 5-6 files, i want to rewind one of them in my cookbook
[2013-08-20 13:25:47 -0400] isbaran: in this situation rewind can't find a template named template2 for ex.
[2013-08-20 13:26:01 -0400] gchristensen: lewiz: aye!
[2013-08-20 13:26:48 -0400] chris613: isbaran: Oh sure, that's fine, as long as the rewind specifies the same name, I've done that.
[2013-08-20 13:27:09 -0400] chris613: The syntax is a bit surprising, let me dig up an example maybe
[2013-08-20 13:27:22 -0400] isbaran: chris613: that'd be cool thanks
[2013-08-20 13:27:35 -0400] isbaran: i copied the template for no reason
[2013-08-20 13:29:13 -0400] jalateras: in the rewind syntax do i need to specify the cookbook_name or can i just get it to retrieve the template from the current cookbook in the templates/default directory
[2013-08-20 13:29:28 -0400] isbaran: jalateras: you should specify
[2013-08-20 13:29:43 -0400] chris613: jalateras: If you want it to take from the current cookbook you DO need to specify that
[2013-08-20 13:31:38 -0400] isbaran: chris613: here it is: https://github.com/opscode-cookbooks/nagios/blob/master/definitions/nagios_conf.rb
[2013-08-20 13:33:46 -0400] chris613: isbaran: rewind "template[#{node[:apache][:dir]}/sites-available/site#{count}]" do
[2013-08-20 13:35:52 -0400] isbaran: chris613: what is the trick here ?
[2013-08-20 13:35:52 -0400] isbaran: i tried: rewind :template => "#{node['nagios']['conf_dir']}/nagios.cfg" do
[2013-08-20 13:35:52 -0400] isbaran: hmm
[2013-08-20 13:36:26 -0400] isbaran: let me try it
[2013-08-20 13:37:35 -0400] chris613: isbaran: The trick is that it's not looking for a hash there, it's expecting a string that matches the resource name
[2013-08-20 13:37:44 -0400] nimbius: trying to bootstrap a node with the chef server results in 413 entity too large being logged to /var/chef/cache/chef-stacktrace.out on the node
[2013-08-20 13:44:01 -0400] isbaran: chris613: working great, thank you ;)
[2013-08-20 13:49:22 -0400] jalateras: i have tried to use rewind but i am coming across a file not found exception
[2013-08-20 13:49:26 -0400] jalateras: Chef::Exceptions::FileNotFound
[2013-08-20 13:49:26 -0400] jalateras: ------------------------------
[2013-08-20 13:49:26 -0400] jalateras: Cookbook 'jenkins' (0.6.3) does not contain a file at any of these locations:
[2013-08-20 13:49:28 -0400] jalateras:   templates/ubuntu-12.04/ciserver.nginx_jenkins.conf.erb
[2013-08-20 13:49:30 -0400] jalateras:   templates/ubuntu/ciserver.nginx_jenkins.conf.erb
[2013-08-20 13:49:31 -0400] jalateras:   templates/default/ciserver.nginx_jenkins.conf.erb
[2013-08-20 13:50:08 -0400] isbaran: jalateras: did you copy your version of file to your cookbooks templates folder ?
[2013-08-20 13:50:26 -0400] jalateras: yes it is in templates/default/ciserver.nginx_jenkins.conf.erb
[2013-08-20 13:51:58 -0400] isbaran: i don't see templates/ubuntu/ciserver.nginx_jenkins.conf.erb in jenkins cookbook
[2013-08-20 13:53:12 -0400] isbaran: does it exist in jenkins 0.6.3 cook
[2013-08-20 14:00:19 -0400] bigbigbang: noob question : which version should I "checkout" in order to have the 11.6 chef client.. Are rc1, rc2 rc3 and rc4 more recent ?
[2013-08-20 14:02:34 -0400] jalateras: in the jenkins cookbook it is called templates/default/nginx_jenkins.conf.erb
[2013-08-20 14:03:36 -0400] isbaran: jalateras: that should be the problem, rewind "template[nginx_jenkins.conf.erb]" do
[2013-08-20 14:03:51 -0400] isbaran: source => your preferred name
[2013-08-20 14:04:07 -0400] isbaran: bigbigbang: gem install chef gives you 11.6
[2013-08-20 14:04:17 -0400] jalateras: i'll give that a fo
[2013-08-20 14:18:53 -0400] ichilton: Do people tend to have a common role with stuff like apt, timezone, ntpd etc in, and then roles like web, db etc?
[2013-08-20 14:19:31 -0400] bean: ichilton: yeah, I have a role called "essentials"
[2013-08-20 14:19:44 -0400] ichilton: cool
[2013-08-20 14:19:44 -0400] bean: and then either recipes or roles for other stuff
[2013-08-20 14:20:54 -0400] ichilton: Do you use solo or chef server? At what point is the cut over between the two do you think? - a few nodes?
[2013-08-20 14:21:09 -0400] bean: server.
[2013-08-20 14:21:26 -0400] bean: i mean, i wouldn't really recommend solo at all, especially since hosted gives you some nodes for free.
[2013-08-20 14:21:40 -0400] ichilton: nod
[2013-08-20 14:22:02 -0400] ichilton: How do you install chef client? gem or the omnibus?
[2013-08-20 14:22:14 -0400] bradgignac: ichilton: checkout littlechef if you're interested in chef solo
[2013-08-20 14:23:00 -0400] ichilton: bradgignac: ha, another unfortunate search engine name!!
[2013-08-20 14:23:16 -0400] bradgignac: yeah
[2013-08-20 14:23:16 -0400] ichilton: bradgignac: (that's a cafe chain in the uk)
[2013-08-20 14:23:38 -0400] ichilton: bradgignac: but thanks - not heard of that - mostly see knife-solo mentioned - is littlechef similar?
[2013-08-20 14:23:57 -0400] bradgignac: similar
[2013-08-20 14:24:01 -0400] ichilton: k, ta
[2013-08-20 14:24:07 -0400] bradgignac: i've never actually used knife-solo. been using littlechef for a while
[2013-08-20 14:24:16 -0400] ichilton: I'm going the server result - was just interested
[2013-08-20 14:24:16 -0400] bradgignac: we have a number of large deployments using littlechef
[2013-08-20 14:24:24 -0400] ichilton: Why that over chef-server?
[2013-08-20 14:24:24 -0400] bradgignac: got tired of maintaining a chef server
[2013-08-20 14:24:28 -0400] ichilton: why?
[2013-08-20 14:24:42 -0400] zaargy: when would you use a tag over a attribute?
[2013-08-20 14:24:52 -0400] zaargy: it semes to me if you use tags then you just end up having to do the 'parsing' yourself
[2013-08-20 14:25:06 -0400] bradgignac: ichilton: everything in littlechef is in source control by default
[2013-08-20 14:25:08 -0400] zaargy: whereas with attributes since you have key value pairs you can get chef to do it for you?
[2013-08-20 14:25:22 -0400] bradgignac: ichilton: and general maintenance of the chef server
[2013-08-20 14:25:37 -0400] bradgignac: we got almost nothing from chef server over littlechef
[2013-08-20 14:25:48 -0400] bradgignac: for our use case
[2013-08-20 14:26:04 -0400] bradgignac: obviously chef server offers features that littlechef/solo do not
[2013-08-20 14:26:47 -0400] jalateras: thanks guys, finally got it going.
[2013-08-20 14:26:52 -0400] jalateras: works niceely for sure
[2013-08-20 14:27:12 -0400] ichilton: bradgignac: interesting...
[2013-08-20 14:27:32 -0400] ichilton: How do you install chef? - omnibus or gem?
[2013-08-20 14:27:33 -0400] bradgignac: we use a push-based approach for chef runs
[2013-08-20 14:27:45 -0400] bradgignac: littlechef installs it from api
[2013-08-20 14:27:47 -0400] bradgignac: apt
[2013-08-20 14:28:04 -0400] bradgignac: ignore the "push-based approach" comment. it's unrealted to your question
[2013-08-20 14:29:52 -0400] zts: ichilton: as another data point, I use both chef-solo and chef-client (in different places), and always use the omnibus installer these days
[2013-08-20 14:31:05 -0400] ichilton: zts: what's your rational for chef-solo vs chef-client?
[2013-08-20 14:31:09 -0400] ichilton: zts: i.e when do you use each?
[2013-08-20 14:31:22 -0400] ichilton: zts: omnibus just for convenience?
[2013-08-20 14:31:38 -0400] ichilton: zts: it seems to install the gem, so I assume there is no real difference at the end of the day?
[2013-08-20 14:31:51 -0400] ichilton: bradgignac: interesting, thanks
[2013-08-20 14:32:32 -0400] zts: ichilton: omnibus is a huge win in a heterogenous environment - you're guaranteed to have the same (modern) version of ruby on every machine, and it'll all work
[2013-08-20 14:32:51 -0400] zts: ichilton: if you're only deploying to platforms that have a modern ruby out of the box, I guess it matters less
[2013-08-20 14:33:01 -0400] ichilton: right
[2013-08-20 14:34:37 -0400] ichilton: zts: Do you install chef-client on your chef-server to manage stuff like users on it?
[2013-08-20 14:34:51 -0400] zts: ichilton: as for solo vs client, key considerations are usually cost and performance
[2013-08-20 14:35:09 -0400] artcurmudgeon: having an issue with ssl failure when chef-client updates. downloaded cacert.pem. where is the best place to put it and should I put the ENV statement in client.rb or environment.rb
[2013-08-20 14:35:24 -0400] ichilton: zts: solo being slower but for times it's not worth paying for hosted chef or an instance/server to run chef-server ?
[2013-08-20 14:35:48 -0400] fishGoM00: ehlo all, does anyone know of an updated version of this page: http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server
[2013-08-20 14:35:53 -0400] zts: ichilton: nah, Hosted Chef has been painfully slow for me from some parts of the world.  If you're hosted in the USA, I guess it's fine.  UK is tolerable.  Elsewhere, not so great
[2013-08-20 14:36:18 -0400] zts: ichilton: the down side with solo is that you end up inventing solutions to a bunch of problems that are otherwise solved by client/server (cookbook distribution, versionining, etc)
[2013-08-20 14:36:30 -0400] ichilton: Yeah, it's expensive too for small setups
[2013-08-20 14:36:42 -0400] ichilton: i've just setup a $10/month 1GB instance on DigitalOcean with a chef server...
[2013-08-20 14:37:00 -0400] bradgignac: zts: littlechef solves a bunch of those problems
[2013-08-20 14:37:08 -0400] suffix: could someone explain why the following code is incorrect?           hatravdb02 = search(:node, "name:#{hostnames['hatravdb02']}")           hatravdb02ip = "#{hatravdb02[0][:IP]}"
[2013-08-20 14:37:09 -0400] zts: ichilton: I prefer client/server.  Solo is for where I am trying to reduce the number of moving parts, and don't want to rely on availability of something outside of my core infra
[2013-08-20 14:37:10 -0400] ichilton: and knife-solo I guess
[2013-08-20 14:37:20 -0400] cpuguy83: zts: Actually, I believe knife-solo does cookbook distribution.
[2013-08-20 14:37:24 -0400] ichilton: but you didn't mean performance as in run speed then, but more practicalities
[2013-08-20 14:37:31 -0400] suffix: hatravdb02 returns useful results
[2013-08-20 14:37:43 -0400] zts: sure, knife-solo and little-chef solve those problems
[2013-08-20 14:37:46 -0400] suffix: however, hatravdb02 ip doesn't print anything
[2013-08-20 14:37:46 -0400] ichilton: zts: Yep, or a one off kind of thing...
[2013-08-20 14:37:47 -0400] zts: after a fashion
[2013-08-20 14:37:56 -0400] zts: so if those work for you, then that's cool - use the solution that someone else has invented :)
[2013-08-20 14:38:03 -0400] ichilton: zts: but for a platform you're better off with server
[2013-08-20 14:38:10 -0400] zts: in one case, I'm using chef-solo on AWS, with auto-scaling
[2013-08-20 14:38:28 -0400] cpuguy83: Also, setting up chef-server is pretty wicked easy
[2013-08-20 14:38:46 -0400] cpuguy83: Either via the chef-server cookbook, or knife-server gem
[2013-08-20 14:39:10 -0400] ichilton: cpuguy83: I just followed this - great post by jtimberman: http://www.opscode.com/blog/2013/03/11/chef-11-server-up-and-running/
[2013-08-20 14:39:12 -0400] jmartin: there is omnibus chef-server as well isnt there?
[2013-08-20 14:39:36 -0400] ichilton: jmartin: don't think so
[2013-08-20 14:39:41 -0400] ichilton: or not in the same way
[2013-08-20 14:39:49 -0400] jmartin: https://github.com/opscode/omnibus-chef-server
[2013-08-20 14:39:51 -0400] cpuguy83: jmartin: Yeah, which is what the chef-server cookbook uses... and I'm sure probably (I have not looked at it) knife-server is using that.
[2013-08-20 14:39:55 -0400] ichilton: the above link gets you to download a .dpkg, install it and run: chef-server-ctl reconfigure
[2013-08-20 14:40:06 -0400] ichilton: same as http://www.opscode.com/chef/install/ says
[2013-08-20 14:41:35 -0400] fishGoM00: How do people backup their chef-server installations?
[2013-08-20 14:41:57 -0400] ichilton: Do people run chef-client on their chef-servers to manage other stuff? (or indeed manage chef-server from chef-client?)
[2013-08-20 14:45:40 -0400] captkirk: I'm working creating a resource provider which makes HTTP calls out to the API for my Zabbix monitoring server to define hosts to monitor. I would like to set it up so that the resource provider is able to be aware of the ZabbixHost resource  but also aware of any ZabbixItem resources defined on the node. Is it possible to do this witch Chef resource providers?
[2013-08-20 14:52:12 -0400] ichilton: Anyone got any examples of chef repos to build rails platforms?
[2013-08-20 14:52:28 -0400] ichilton: Nice to see how others architect their stuff...
[2013-08-20 14:54:23 -0400] adnichols: ichilton ours are all private - those that manage our apps - anything in particular you are curious about?
[2013-08-20 14:55:34 -0400] adnichols: fishGoM00 http://fnichol.github.io/knife-server/
[2013-08-20 14:56:17 -0400] awgross: anyone have any thoughts / experience with using Chef Environments per service in an SoA environment?
[2013-08-20 14:56:55 -0400] ichilton: adnichols: Just really how people structure stuff in the real world...
[2013-08-20 14:57:25 -0400] ichilton: adnichols: actually there is something specific - cookbooks vs roles in the runlist...
[2013-08-20 14:57:53 -0400] adnichols: ichilton I assume by cookbooks you mean recipes?
[2013-08-20 14:58:06 -0400] ichilton: sorry, yes
[2013-08-20 14:58:16 -0400] ichilton: a wrapper cookbook I guess I meant
[2013-08-20 14:58:25 -0400] adnichols: ichilton we use roles a lot but have recently been running into reasons why I think we are going to move toward recipes
[2013-08-20 14:58:47 -0400] ichilton: I did that for our dev environment setup - bundled it all into a wrapper cookbook/recipe and put that in the runlist.
[2013-08-20 14:58:48 -0400] adnichols: ichilton primarily that we cannot put conditional logic in roles - so we end up w/ a lot of roles
[2013-08-20 14:59:00 -0400] ichilton: ah, right
[2013-08-20 14:59:08 -0400] ichilton: you are either all in a role or not.
[2013-08-20 14:59:29 -0400] ichilton: so better to have more generic roles, which call recipes which then have the conditional stuff in...?
[2013-08-20 14:59:49 -0400] adnichols: ichilton yeah, I originally thought I could deal with that inside the various cookbooks but that only goes so far and esp when you get into having different distributions in your env it gets kinda messy
[2013-08-20 15:00:33 -0400] adnichols: I think roles are nice & actually present the configuration really cleanly  - we've just found limits
[2013-08-20 15:00:56 -0400] adnichols: some folks don't use them at all - you kinda have to decide what works for you
[2013-08-20 15:01:07 -0400] ichilton: nod
[2013-08-20 15:01:54 -0400] ichilton: What about storing things like ip's of other nodes, trusted ip's etc for using in firewall config? - databags?
[2013-08-20 15:02:51 -0400] gkellogg: http://www.w3.org/TR/turtle/
[2013-08-20 15:03:04 -0400] adnichols: We presently have recipes for configuring the firewall - there are cookbooks out there that use databags too - also some that use search
[2013-08-20 15:03:20 -0400] gkellogg: https://github.com/ruby-rdf/rdf-turtle
[2013-08-20 15:03:23 -0400] ichilton: adnichols: so you hard code trusted ip's etc in that cookbook?
[2013-08-20 15:03:34 -0400] fishGoM00: adnichols: Thanks Fella
[2013-08-20 15:03:39 -0400] ichilton: s/that/those/ s/cookbook/cookbooks/
[2013-08-20 15:03:40 -0400] adnichols: We have ec2 & rackspace nodes and correctly discovering where you should use the public IP and where to use private is hard
[2013-08-20 15:03:53 -0400] adnichols: so we do define the IP's in recipes
[2013-08-20 15:03:59 -0400] ichilton: right
[2013-08-20 15:04:27 -0400] adnichols: "hard" as in I haven't really tried that hard :)
[2013-08-20 15:04:37 -0400] ichilton: haha
[2013-08-20 15:04:39 -0400] ichilton: more tricky
[2013-08-20 15:04:59 -0400] awgross: adnichols: we have the same problem with ec2 to vpc nodes etc.  Have some code to find a reachable interface (or fail if there is none)
[2013-08-20 15:05:05 -0400] ichilton: adnichols: Do you manage your chef servers with chef-client?
[2013-08-20 15:05:40 -0400] adnichols: awgross interesting - anything you can share?
[2013-08-20 15:06:13 -0400] awgross: sure, let me see , I can prob fork the helper lib cookbook and share it
[2013-08-20 15:06:24 -0400] awgross: i dont think anything private in it
[2013-08-20 15:06:35 -0400] adnichols: awesome - if not no biggie but it sounds interesting
[2013-08-20 15:07:39 -0400] adnichols: ichilton not sure what you mean - we run chef-client on our nodes, is that what you are asking?
[2013-08-20 15:07:53 -0400] ichilton: adnichols: I was meaning on the chef server itself
[2013-08-20 15:08:05 -0400] ichilton: adnichols: Do you manage the chef server like other nodes using chef?
[2013-08-20 15:08:08 -0400] adnichols: ichilton ah, yeah it's a chef node like everyone else and we run chef-client on it
[2013-08-20 15:08:13 -0400] ichilton: ah, cool
[2013-08-20 15:08:24 -0400] ichilton: Just use the omnibus installer or knife boostrap as normal>
[2013-08-20 15:08:28 -0400] ichilton: s/>/?/
[2013-08-20 15:08:30 -0400] adnichols: yes
[2013-08-20 15:08:33 -0400] ichilton: cool, ta
[2013-08-20 15:08:44 -0400] ichilton: Can anyone explain Clients in Chef 11?
[2013-08-20 15:08:51 -0400] ichilton: Users are obviously, well, users....
[2013-08-20 15:08:54 -0400] ichilton: but what are clients
[2013-08-20 15:09:03 -0400] ichilton: by default I have chef-validator and chef-webui
[2013-08-20 15:09:03 -0400] adnichols: clients are authorized to interact w/ the API
[2013-08-20 15:09:21 -0400] ichilton: so a bit like tools rather than physical users (people)?
[2013-08-20 15:09:44 -0400] adnichols: well, a client is really an association w/ a key pair
[2013-08-20 15:09:45 -0400] ichilton: so the web ui talks direct to the api itself rather than just using the user you are logged in as?
[2013-08-20 15:10:11 -0400] ichilton: and the chef-validator is how it adds new nodes?
[2013-08-20 15:10:12 -0400] adnichols: I think that's correct - not 100% sure
[2013-08-20 15:10:33 -0400] adnichols: yeah, chef-validator is used by new nodes to get their own key from the server
[2013-08-20 15:10:43 -0400] ichilton: right
[2013-08-20 15:10:59 -0400] ichilton: It it safe to expose the chef server port 443 to the world?
[2013-08-20 15:11:14 -0400] adnichols: so you have nodes and clients - a node should have an associated client entry but a client entry may not have a node entry
[2013-08-20 15:11:18 -0400] ichilton: as presumably you need chef-validator.pem and/or admin.pem to do anything?
[2013-08-20 15:11:37 -0400] adnichols: ichilton "safe" is relative - mine is public
[2013-08-20 15:11:56 -0400] fishGoM00: adnichols: in the end I used https://github.com/mdxp/knife-backup to backup chef-server; seems to do what it says on the tin
[2013-08-20 15:11:56 -0400] bean: I'd say its safe
[2013-08-20 15:11:57 -0400] bean: i mean
[2013-08-20 15:11:59 -0400] adnichols: That said I did go in and tweak the login page to try to make it as non-identifying as possible
[2013-08-20 15:12:07 -0400] adnichols: fishGoM00 that one works too
[2013-08-20 15:12:14 -0400] ichilton: Yeah, usual risk of exposing anything - if there are exploits in chef server then we are screwed, but otherwise generally ok...?
[2013-08-20 15:12:29 -0400] adnichols: afaik
[2013-08-20 15:12:38 -0400] ichilton: adnichols: login page? non identifying?
[2013-08-20 15:12:50 -0400] ichilton: is it good practise to remove the admin user once you've added your own?
[2013-08-20 15:12:50 -0400] pwelch: knife-server is always a good tool for backing up. http://fnichol.github.io/knife-server/
[2013-08-20 15:12:56 -0400] adnichols: ichilton the login page by default is pretty easy to fingerprint as a chef server
[2013-08-20 15:12:58 -0400] pwelch: *also
[2013-08-20 15:13:08 -0400] ichilton: I logged into the webui using the default password and changed the password, but should I remove admin?
[2013-08-20 15:13:23 -0400] adnichols: ichilton add your own user & then yeah you can remove admin
[2013-08-20 15:13:40 -0400] adnichols: or just change the pass to something really long & random
[2013-08-20 15:13:43 -0400] adnichols: track it somewhere
[2013-08-20 15:13:45 -0400] ichilton: adnichols: ah right - so change the templates so it doesn't look like a chef server?
[2013-08-20 15:13:50 -0400] adnichols: ichilton yes
[2013-08-20 15:13:53 -0400] ichilton: yeah, I did that - 32 char random
[2013-08-20 15:14:06 -0400] ichilton: might be worth keeping around in case of resetting other users I guess
[2013-08-20 15:14:12 -0400] ichilton: except if someone got hold of admin.pem
[2013-08-20 15:14:24 -0400] adnichols: ichilton I'm always nervous about removing default admin users - never know what assumptions have been made
[2013-08-20 15:14:27 -0400] ichilton: but I guess that's the same as getting hold of myuser.pem so no biggie
[2013-08-20 15:14:35 -0400] ichilton: yeah. me too.
[2013-08-20 15:14:59 -0400] ichilton: might just leave it with the long password and remove admin.pem from my workstation.
[2013-08-20 15:15:27 -0400] adnichols: I think you can also leave it and remove admin rights from it
[2013-08-20 15:15:34 -0400] adnichols: not sure if that has any point :) but...
[2013-08-20 15:15:41 -0400] ichilton: adnichols: you mentioned your firewall cookbooks, do you use iptables?
[2013-08-20 15:16:02 -0400] adnichols: adnichols I use the ufw cookbook & then wrapper cookbooks
[2013-08-20 15:16:09 -0400] adnichols: nice to myself
[2013-08-20 15:16:25 -0400] ichilton: not used ufw before - why that over straight iptables?
[2013-08-20 15:16:29 -0400] ichilton: just easier to manage/read?
[2013-08-20 15:16:52 -0400] adnichols: ichilton mostly because it was the most reasonable cookbook :) I don't really care either way
[2013-08-20 15:16:58 -0400] ichilton: nod
[2013-08-20 15:17:05 -0400] awgross: adnichols: I open sourced most of the code here https://github.com/andrewgross/yipit_helper_libraries
[2013-08-20 15:17:05 -0400] cpuguy83: Yeah, same here, the other firewall cookbooks were terrible
[2013-08-20 15:17:07 -0400] ichilton: is ufw limiting at all?
[2013-08-20 15:17:12 -0400] adnichols: many of my arch decisions these days are weighted by the availability of chef cookbooks
[2013-08-20 15:17:21 -0400] awgross: adnichols: I had to remove all of the tests since the fixtures were from real nodes, but you should be able to get the gist
[2013-08-20 15:17:24 -0400] ichilton: or can you always fall back to runnning some iptables anyway? (I assume ufw runs iptables behind the scenes?)
[2013-08-20 15:17:37 -0400] fishGoM00: ufw is just a wrapper to iptables
[2013-08-20 15:17:38 -0400] adnichols: ufw is just a wrapper for iptables - ya
[2013-08-20 15:17:50 -0400] ichilton: ah, cool.
[2013-08-20 15:17:51 -0400] fishGoM00: I purge it myself :)
[2013-08-20 15:18:04 -0400] ichilton: so you can always fall back and run iptables bits ;)
[2013-08-20 15:18:05 -0400] awgross: adnichols: This is the relevant code for finding accessible IPs https://github.com/andrewgross/yipit_helper_libraries/blob/master/libraries/lib_util.rb#L35
[2013-08-20 15:18:15 -0400] adnichols: awgross awesome - thanks a lot
[2013-08-20 15:18:57 -0400] awgross: yep, the way you call them is a bit different from how most people do it, so check out the readme for examples
[2013-08-20 15:19:24 -0400] cpuguy83: Anyone know a good cookbook for managing network interfaces?  the network_interfaces cookbook is severely lacking in documentation, and I don't see how to actually set an address on my interface
[2013-08-20 15:19:51 -0400] ichilton: adnichols: What stack do you use for rails btw?
[2013-08-20 15:20:05 -0400] ichilton: adnichols: curently architecting a move away from heroku on a budget
[2013-08-20 15:20:30 -0400] cpuguy83: rbx 2.0 + puma + sidekiq
[2013-08-20 15:20:31 -0400] adnichols: we were using MRI but have moved to Jruby
[2013-08-20 15:20:47 -0400] ichilton: adnichols: thinking of getting up and running with a few nginx instances for static+caching, a few app instances running unicorn and a few db instances with mongo+redis plus a worker instance
[2013-08-20 15:21:11 -0400] awgross: ichilton: mongo and redis on the same machine?
[2013-08-20 15:21:26 -0400] ichilton: adnichols: uhming and ahing whether to put some haproxy instances before nginx to l/b incoming traffic and/or after nginx to l/b app server traffic...
[2013-08-20 15:21:43 -0400] adnichols: ichilton we are using haproxy in front of nginx
[2013-08-20 15:21:58 -0400] ichilton: awgross: yeah, until they get too busy and then i'll move them off - we are not doing mega concurrency at the moment....
[2013-08-20 15:22:11 -0400] adnichols: ichilton for rolling deploys haproxy is just super fast and reliable at dealing w/ up/down services
[2013-08-20 15:22:18 -0400] ichilton: adnichols: cool
[2013-08-20 15:22:24 -0400] ichilton: adnichols: but then just going straight from nginx to unicorn?
[2013-08-20 15:22:32 -0400] cpuguy83: adnichols: Ever mess with Torquebox?
[2013-08-20 15:22:48 -0400] adnichols: ichilton well, we run tomcat w/ jruby
[2013-08-20 15:23:13 -0400] adnichols: cpuguy83 we looked at torquebox but that just seems like a bad idea - too many constraints in one box
[2013-08-20 15:23:28 -0400] awgross: ichilton: fair enough, they are both pretty memory hungry, so I would normally keep them separate to stop them from fighting with eachother
[2013-08-20 15:24:27 -0400] ichilton: awgross: yeah, will have to see wha the memory usage is like - might have to split them.
[2013-08-20 15:25:51 -0400] ichilton: Problem is, with no loadbalancers or floating ip's on DigitalOcean, i'm going to have to have some monitoring which interacts with the dnsimple api for failover
[2013-08-20 15:26:10 -0400] ichilton: Oh, speaking of monitoring - what do you guys use - in the context of making decisions based on good cookbooks :)
[2013-08-20 15:26:38 -0400] ichilton: I'll need graphing, service monitoring/restarting and something nagios-like
[2013-08-20 15:26:45 -0400] adnichols: ichilton I have no answers there - none of my monitoring is in chef :( but the nagios cookbook is reasonable
[2013-08-20 15:26:52 -0400] bean: I just use nagios :) it doesn't restart services for me.
[2013-08-20 15:27:05 -0400] bean: We're going to be switching to Riemann at some point
[2013-08-20 15:27:12 -0400] adnichols: I have ganglia deployed but the cookbooks are homegrown & not terribly portable
[2013-08-20 15:27:50 -0400] bean: Riemann can hook to ganglia
[2013-08-20 15:28:23 -0400] cpuguy83: ichilton: Define nagios-like?  Because to me that means you want an archaic POS :)
[2013-08-20 15:28:30 -0400] adnichols: bean I was headed toward sensu - looked at riemann but couldn't get my head around it
[2013-08-20 15:28:49 -0400] bean: It just requires knowing a bit of Clojure ;)
[2013-08-20 15:28:59 -0400] adnichols: bean yeah, I think that's where it ended for me
[2013-08-20 15:29:18 -0400] adnichols: bean not opposed to learning - but the timing wasn't right
[2013-08-20 15:29:28 -0400] pwelch: does anyone know why the json from my `knife edit` commands would be compacted instead of nicely formatted like it used to be. Im on Hosted Chef
[2013-08-20 15:29:45 -0400] bean: pwelch: we ran into that with a certain version of knife I think
[2013-08-20 15:29:48 -0400] bean: not sure though
[2013-08-20 15:29:52 -0400] ichilton: cpuguy83: haha!
[2013-08-20 15:30:08 -0400] adnichols: pwelch I've run into that too - never tracked down precisely what it was, assumed some gem version issue
[2013-08-20 15:30:15 -0400] ichilton: nagios does always feel very old and ...big
[2013-08-20 15:30:26 -0400] pwelch: bean, adnichols: did it resolve itself or still happening?
[2013-08-20 15:30:35 -0400] bean: I just updated my gem and it went away
[2013-08-20 15:30:37 -0400] captkirk: If you're going to use nagios you might as use one of the better maintained forks of it
[2013-08-20 15:30:39 -0400] ichilton: there must be a simple pinging, port checking and ideally distributed alternative nowadays
[2013-08-20 15:30:43 -0400] bean: (i'm not on chef 11 for most of my stuff.. yet)
[2013-08-20 15:30:52 -0400] ichilton: need something like a self-hosted Pingdom
[2013-08-20 15:30:56 -0400] pwelch: bean, the knife gem? I am still on chef 10
[2013-08-20 15:30:57 -0400] adnichols: pwelch no, I blew away my gemset and re-installed things and I think it stopped
[2013-08-20 15:31:05 -0400] pwelch: ok, I'll look into that
[2013-08-20 15:31:33 -0400] bean: pwelch: what version of the chef gem are you using
[2013-08-20 15:31:33 -0400] bean: ?
[2013-08-20 15:31:35 -0400] ichilton: No one run graphite or munin? - have used munin before but keep seeing graphite around
[2013-08-20 15:31:47 -0400] bean: we use graphite, but not for monitoring graphs
[2013-08-20 15:31:54 -0400] ichilton: bean: what for?
[2013-08-20 15:31:56 -0400] bean: mostly for application data.
[2013-08-20 15:31:57 -0400] pwelch: bean chef 10.26
[2013-08-20 15:32:00 -0400] ichilton: bean: ahh, ok
[2013-08-20 15:32:08 -0400] captkirk: Graphite is handy, but it's not really monitoring tool, it's metric collection
[2013-08-20 15:32:14 -0400] ichilton: ah right
[2013-08-20 15:32:37 -0400] ichilton: So would munin be a sane choice for server load/cpu/memory/disk usage?
[2013-08-20 15:32:46 -0400] ichilton: or are there better things?
[2013-08-20 15:33:32 -0400] captkirk: What you looking for? Just something to show graphs of metrics or are you looking to get alerts?
[2013-08-20 15:35:43 -0400] adnichols: ichilton I'm partial to ganglia for base OS monitoring but it's probably a bit more of an investment than munin if you aren't familiar w/ it
[2013-08-20 15:36:41 -0400] tabolario: ichilton, i'm setting up sensu right now where i work
[2013-08-20 15:37:36 -0400] siezer: munin doesn't scale very well because its a poll vs collect system.. but for smaller infras (<50) its awesome. It gives you a LOT of info out of the box and plugins are stupid simple to write
[2013-08-20 15:37:55 -0400] gleam: what's the memory footprint of the sensu client?
[2013-08-20 15:41:07 -0400] ichilton: captkirk: manly graphs, as I can get alerts from nagios
[2013-08-20 15:41:32 -0400] captkirk: If you just want graphs something like using statsd to vomit numbers into graphite is pretty handy
[2013-08-20 15:41:46 -0400] ichilton: ok, thanks guys - will check those out
[2013-08-20 15:41:51 -0400] ichilton: adnichols: thanks for your help!
[2013-08-20 15:42:41 -0400] captkirk: I'm a fan of graphite since it's backed by whisper and can handle doing graphs on the fly (a good example is if you are collecting a counter, like the number of visitors who have hit a page, graphite will let you apply a 'derivative' to it and give you a rate rather than just the counter on the fly)
[2013-08-20 15:45:35 -0400] captkirk: Would it be possible to have various recipes append values to an array so like node['monitoring']['templates']? Does that get resolved and built up during the compilation phase so that by the convergence phase a resource provider could just consume that array and have the complete set of templates?
[2013-08-20 15:50:23 -0400] ssd7: Ohai Chefs
[2013-08-20 15:50:35 -0400] cpuguy83: captkirk: I don't see why not.
[2013-08-20 15:54:59 -0400] pwf: has anything changed recently-ish to cause node_name to be missing from client.rb?
[2013-08-20 15:55:08 -0400] pwf: or are my silly clients leaving off -n
[2013-08-20 15:55:22 -0400] pwf: bootstrap should require -n imo
[2013-08-20 15:55:30 -0400] daemon23: yow, big channel
[2013-08-20 15:56:24 -0400] lewiz: Where does Chef store its state?
[2013-08-20 15:56:38 -0400] ichilton: Under chef-repo, is the convention to keep downloaded cookbooks in cookbooks/ and your own in site-cookbooks/ ?
[2013-08-20 15:56:44 -0400] ichilton: Or did I read that wrong somewhere?
[2013-08-20 15:56:49 -0400] ichilton: or do people have other conventions?
[2013-08-20 15:56:58 -0400] daemon23: I'm still learning about chef and was hoping for some insight, specifically around drift
[2013-08-20 15:57:18 -0400] adnichols: ichilton yes, that's typically the convention
[2013-08-20 15:57:39 -0400] ichilton: cool, ta
[2013-08-20 15:57:44 -0400] daemon23: Does chef offer any functionality around monitoring drift without correcting it?
[2013-08-20 15:57:47 -0400] ichilton: why doesn't chef-repo come with a site-cookbooks dir then? :)
[2013-08-20 15:58:25 -0400] awgross: ichilton: not everyone uses it that way
[2013-08-20 15:58:32 -0400] awgross: its just one convention
[2013-08-20 15:58:41 -0400] daemon23: From what I'm reading, this seems to go against the basic philosophy of chef and similar tools
[2013-08-20 15:58:57 -0400] zts: daemon23: there's --why-run mode, which will tell you what Chef would (probably) do, without making any changes
[2013-08-20 15:58:58 -0400] awgross: daemon23: drift in which sense?
[2013-08-20 15:59:00 -0400] adnichols: daemon23  you can run in whyrun mode, but it's not the best for that because there are all kinds of reasons whyrun will fail
[2013-08-20 15:59:01 -0400] ichilton: awgross: what are the other conventions?
[2013-08-20 15:59:08 -0400] ichilton: awgross: Do some people just intermingle them?
[2013-08-20 15:59:22 -0400] ichilton: awgross: or intermingle and use a mycompany- prefix I guess?
[2013-08-20 15:59:45 -0400] awgross: ichilton: check out a tool called Berkshelf, its philosophy is that your company cookbooks go in cookbooks/, it takes care of downloading specified dependencies and keeps them in its own location, so you never see them
[2013-08-20 16:00:02 -0400] ichilton: ah right
[2013-08-20 16:00:05 -0400] awgross: ichilton: the site-cookbooks style is used by "librarian-chef" another similar tool to do cookbook management
[2013-08-20 16:00:10 -0400] daemon23: So I'm looking at ways to automate our deployment systems and manage configuration, and one of the features that is highly desired is the ability to manually modify systems and be able to get a report on what was modified
[2013-08-20 16:00:14 -0400] ichilton: ahhhh
[2013-08-20 16:00:24 -0400] ichilton: awgross: I was going to check out Berkshelf and librarian-chef
[2013-08-20 16:00:53 -0400] ichilton: awgross: what's the Berkshelf vs librarian-chef comparision in a nutshell?
[2013-08-20 16:01:33 -0400] daemon23: These are java-based services being deployed, primarily, so we'd need to be able to deploy archives, class files and other resources by hand
[2013-08-20 16:01:49 -0400] awgross: librarian-chef manages your cookbooks and others cookbooks via cookbooks/ and site-cookbooks, Berkshelf believes cookbooks should be more like code libraries, just artifacts to be managed
[2013-08-20 16:02:25 -0400] daemon23: If we were to integrate via chef or something similar, we'd deploy our applications as rpms
[2013-08-20 16:02:38 -0400] ichilton: awgross: which do you prefer / is more popular?
[2013-08-20 16:02:40 -0400] awgross: ichilton: I havent used librarian-chef as much, so I could be wrong, but I believe their approach is that all of your cookbooks should be in the same repo, berks usually just has your companies ones in there, and external ones are more hidden
[2013-08-20 16:02:55 -0400] awgross: ichilton: I prefer berkshelf, but I havnet done a head to head, just kinda fell into one.
[2013-08-20 16:03:06 -0400] ichilton: awgross: Berkshelf sounds sane like
[2013-08-20 16:03:22 -0400] ichilton: awgross: although where does each stand if you take a community one and start modifying/customising it?
[2013-08-20 16:03:30 -0400] miah: awgross: librarian is pretty similar to berkshelf, the cheffile allows you to point at gitrepo's
[2013-08-20 16:03:32 -0400] ichilton: awgross: does that just become like one of your own?
[2013-08-20 16:03:47 -0400] miah: the big difference between the two is how each does dependency resolution, and that librarian tries to solve a single problem
[2013-08-20 16:03:49 -0400] daemon23: and really, everything I've read in the config management/devops world says NEVER EVER DO THIS
[2013-08-20 16:03:50 -0400] awgross: ichilton: thats how I do it, I fork, and manage it with Berkshelf
[2013-08-20 16:04:07 -0400] ichilton: k
[2013-08-20 16:04:12 -0400] miah: berkshelf, like a bookshelf, has features that cover many topics.
[2013-08-20 16:04:27 -0400] awgross: daemon23: for the most part, chef believes it should be doing all of the changes, it is possible to have it just ignore some areas, but it doesnt like to
[2013-08-20 16:04:39 -0400] ichilton: I guess the other thing that's different is librarian-chef repos are then all available if you put them on another machine where berkshelf would have to download dependancies again
[2013-08-20 16:04:42 -0400] captkirk: daemon23: manually managing assets that are controlled by your config management system is a recipe for pain and espair
[2013-08-20 16:04:45 -0400] ichilton: i.e they are separate for each user/system
[2013-08-20 16:04:56 -0400] ichilton: so Berkshelf is very like Bundler in that sense?
[2013-08-20 16:05:11 -0400] awgross: ichilton: it is very similar to bundler in that sense
[2013-08-20 16:05:11 -0400] captkirk: *despair
[2013-08-20 16:05:36 -0400] daemon23: awgross: Right, the desire is that it not ignore them, but that it should actively monitor and report on the drift
[2013-08-20 16:05:43 -0400] awgross: ichilton: berkshelf keeps ~/.berkshelf/cookbooks/{name}-{version}, so it caches locally
[2013-08-20 16:06:07 -0400] ichilton: right
[2013-08-20 16:06:18 -0400] miah: berkshelf and librarian are both quite like bundler
[2013-08-20 16:06:18 -0400] ichilton: might check that out and can always look at librarian-chef later as a comparision
[2013-08-20 16:06:23 -0400] ichilton: miah: what's bookshelf?
[2013-08-20 16:06:25 -0400] daemon23: Unfortunately, we've already found a tool that allows it (RHQ), so it may be hard to argue them out of using it
[2013-08-20 16:06:27 -0400] awgross: daemon23: It could be made to do that using why-run (why-run == dry-run) but I am not sure how much stuff is out there around it
[2013-08-20 16:06:34 -0400] miah: bookshelf is something you put books on
[2013-08-20 16:06:44 -0400] ichilton: miah: oh, you meant a real physical one?
[2013-08-20 16:06:47 -0400] miah: yes
[2013-08-20 16:06:58 -0400] ichilton: miah: I thought you were referring to anohter piece of software that was hard to google! :)
[2013-08-20 16:07:10 -0400] miah: hence 'like a'
[2013-08-20 16:07:18 -0400] daemon23: Okay, this all lines up with what I've read and suspected
[2013-08-20 16:07:21 -0400] miah: i was defining berkshelfs relationship to a object
[2013-08-20 16:07:25 -0400] ichilton: at least berkshelf isn't another one of those! +1!
[2013-08-20 16:07:32 -0400] ichilton: miah: nod
[2013-08-20 16:07:35 -0400] ichilton: thanks guys
[2013-08-20 16:08:00 -0400] miah: i will say, by personal experience. berkshelf has a bit better error output. debugging the ast in librarian can be fun times
[2013-08-20 16:08:16 -0400] ichilton: cool
[2013-08-20 16:08:19 -0400] awgross: "fun"
[2013-08-20 16:08:20 -0400] miah: but i use both
[2013-08-20 16:08:28 -0400] ichilton: sounds like berkshelf is the one to check out right now in lou of doing a comparision of both.
[2013-08-20 16:08:36 -0400] ichilton: s/lou/leu/
[2013-08-20 16:08:56 -0400] ichilton: Oh, one more Q
[2013-08-20 16:09:15 -0400] ichilton: I assume Berkshelf does dependency resolution too then?
[2013-08-20 16:09:46 -0400] ichilton: so if you add a cookbook to your Berksfile, it will also install any dependancies of that without you having to do so?
[2013-08-20 16:09:52 -0400] awgross: correct
[2013-08-20 16:09:56 -0400] ichilton: s/do so/add them too/
[2013-08-20 16:10:00 -0400] ichilton: k
[2013-08-20 16:10:27 -0400] ichilton: How's it do that? - does it look at the metadata or does it only work with cookbooks on the opscode community site?
[2013-08-20 16:10:27 -0400] awgross: there is a video from ChefConf2013 by the creator that explains most of it, if you are interested
[2013-08-20 16:10:41 -0400] ichilton: I think I watched that one a while back
[2013-08-20 16:10:46 -0400] awgross: ichilton: metadata, and it is pointed to a chef server (or git url, or local etc)
[2013-08-20 16:10:51 -0400] ichilton: funny guy, right!? :)
[2013-08-20 16:11:10 -0400] ichilton: k, thanks
[2013-08-20 16:11:33 -0400] ichilton: Will check out the docs, and maybe watch that video again to refresh my memory now i'm actually going to use it!
[2013-08-20 16:13:46 -0400] daemon23: Okay, so maybe my next question should be: is anyone familiar with config drift monitoring tools of any sort?
[2013-08-20 16:14:04 -0400] captkirk: aide can be used to watch for file modifications
[2013-08-20 16:14:05 -0400] daemon23: especially ones that play nicely with chef
[2013-08-20 16:16:25 -0400] ichilton: Is there a preference/convention on roles - rb or json?
[2013-08-20 16:18:14 -0400] daemon23: Hm. Okay, aide looks like a good tool for being able to build up a drift profile. Thanks.
[2013-08-20 16:20:00 -0400] fishGoM00: ichilton: choose ONE of them and stick to it is the rule of thumb :)
[2013-08-20 16:33:30 -0400] nd__: There's no provider to copy/move files, is there? I have to shellout for that?
[2013-08-20 16:35:28 -0400] bean: nd__: I'd just have them put in the correct place by default.
[2013-08-20 16:35:36 -0400] bean: by including them in your cookbook
[2013-08-20 16:37:43 -0400] nd__: bean: It's meant to be configurable and the zip containing the files is >80m in size (java stuff).
[2013-08-20 16:38:02 -0400] bean: ah, ok
[2013-08-20 16:38:34 -0400] nd__: I just wanted to check that I'm not missing something and the File provider or similar
[2013-08-20 16:39:01 -0400] nd__: I read somewhere that I can use remote_file to copy locally by using file:// url
[2013-08-20 16:42:53 -0400] cpuguy83: nd__: The chef client is running locally on the box.  So the file would need to be there already.  remote_file is for pulling a file from an external resource (like a webserver, git, etc).
[2013-08-20 16:43:18 -0400] cpuguy83: nd__: So, either put the file into the cookbook itself, copy it over manually and just use the "file" resource to move it, or use remote_file to pull it
[2013-08-20 16:44:55 -0400] dgarstang: can I do string1 + string2 in chef/ruby?
[2013-08-20 16:45:20 -0400] tabolario: dgarstang, yup
[2013-08-20 16:45:24 -0400] cpuguy83: dgarstang: Yes, but that's not generally a good idea. Best to do "#{string1} #{string2}"
[2013-08-20 16:45:31 -0400] tabolario: ^^
[2013-08-20 16:45:36 -0400] dgarstang: cpuguy83: oh, much more readable. :P
[2013-08-20 16:45:39 -0400] nd__: cpuguy83: I download the file using ark, extract it to someplace, then need to copy individual files and directories from the into the system (or link) How do I copy/move with the file resource?
[2013-08-20 16:46:02 -0400] dgarstang: cpuguy83: how about printf equiv?
[2013-08-20 16:46:03 -0400] cpuguy83: The reason it's not a good idea is because string1 or string2 might be nil, or something else you don't expect and it will raise an exception.
[2013-08-20 16:46:22 -0400] cpuguy83: dgarstang: There is printf... puts if you want a new line at the end
[2013-08-20 16:46:25 -0400] tabolario: http://apidock.com/ruby/Kernel/sprintf
[2013-08-20 16:46:54 -0400] tabolario: scroll down on there to see the shorthand with %
[2013-08-20 16:47:17 -0400] cpuguy83: dgarstang: Or "p" for more of displaying an object but not converting it to a string, "pp" for displaying it all pretty like
[2013-08-20 16:47:51 -0400] dgarstang: tabolario: so, in a recipe, x = sprintf("%s/%s", node['foo'], node['foo2']) would work?
[2013-08-20 16:49:00 -0400] tabolario: sure, but for that specific case i would definitely recommend just doing "#{node['foo']}/#{node['foo2']}"
[2013-08-20 16:49:12 -0400] dgarstang: tabolario: that's a whole heck of a lot harder to read
[2013-08-20 16:49:30 -0400] tabolario: *shrug*
[2013-08-20 16:49:51 -0400] dgarstang: *squinty eye*
[2013-08-20 16:49:56 -0400] cpuguy83: You could also use the push operating "<<"
[2013-08-20 16:50:08 -0400] cpuguy83: But again, that has similar pitfalls to using "+"
[2013-08-20 16:50:21 -0400] dgarstang: cpuguy83: why stop with <<.... they should have made it <#&
[2013-08-20 16:50:33 -0400] miah: << is more idiomatic than + though
[2013-08-20 16:50:44 -0400] miah: because ruby is all about collections
[2013-08-20 16:50:55 -0400] dgarstang: I'll pass on <<. Still haven't learned squiggle yet. :)
[2013-08-20 16:52:09 -0400] pontiki: "%s/%s" % [node['foo1'],node['foo2']] for more obfuscation
[2013-08-20 16:52:20 -0400] dgarstang: pontiki: more readable.
[2013-08-20 16:53:21 -0400] tabolario: "#{sprintf('%s', node['foo1'])}" + '/' << ("%s" % node['foo2'])
[2013-08-20 16:53:30 -0400] pontiki: interpolation is so much more common
[2013-08-20 16:53:39 -0400] zts: pontiki: oh wow, I didn't know ruby did that
[2013-08-20 16:53:59 -0400] zts: that's my learning for the day
[2013-08-20 16:54:00 -0400] dgarstang: tabolario: Grrrr.
[2013-08-20 16:54:11 -0400] pontiki: tabolario: WIN
[2013-08-20 17:02:55 -0400] yfeldblum: << and + are very different and do not do the same things
[2013-08-20 17:03:31 -0400] yfeldblum: interpolation like "#{string1} #{string2}" will fail only if either string1 or string2 is not a string and sending :to_s to it fails
[2013-08-20 17:04:14 -0400] yfeldblum: if string1 or string2 is nil, sending :to_s to it will succeed (nil.to_s evaluates to "")
[2013-08-20 17:04:53 -0400] cpuguy83: yfeldblum: TypeError: no implicit conversion of nil into String
[2013-08-20 17:06:22 -0400] cpuguy83: yfeldblum: Pretty much the point we were trying to make :)
[2013-08-20 17:06:37 -0400] cpuguy83: + bad.... "#{}" good
[2013-08-20 17:07:18 -0400] yfeldblum: "#{nil}" #=> ""
[2013-08-20 17:08:17 -0400] yfeldblum: you get that exception when you try to do something like: "string1" + nil
[2013-08-20 17:08:24 -0400] yfeldblum: or like: s = "string1" ; s << nil
[2013-08-20 17:09:15 -0400] yfeldblum: so interpolation does extra work to try to convert what you give it into strings, rather than making you pre-convert them into strings
[2013-08-20 17:09:26 -0400] yfeldblum: which is often cool
[2013-08-20 17:16:39 -0400] cpuguy83: When pulling a databag ( data_bag('foo') ), does this get pulled in as a hash with all the items as keys?
[2013-08-20 17:17:12 -0400] cpuguy83: Or rather... how does that look once it's in Ruby?
[2013-08-20 17:18:13 -0400] LanceStacenko: When I run "chef-client" on one of my nodes, it hangs as soon as it lists the target recipe.
[2013-08-20 17:18:16 -0400] LanceStacenko: What's up with that?
[2013-08-20 17:22:45 -0400] yfeldblum: cpuguy83, `data_bag("asdf")` will return an array with the names of all the data-bag items
[2013-08-20 17:23:10 -0400] cpuguy83: yfeldblum: Thanks, makes sense.
[2013-08-20 17:23:21 -0400] yfeldblum: cpuguy83, it's like `select id from some_table` gives you all the ids of all the rows in the table
[2013-08-20 17:24:08 -0400] yfeldblum: cpuguy83, and then `data_bag_item("foo", "bar")` gets the whole data-bag item for foo/bar like `select * from some_table where id = 1234` selects one full row
[2013-08-20 17:26:59 -0400] miah: its a databag object
[2013-08-20 17:28:23 -0400] cpuguy83: Yeah, trying decide if I want to store everything in one databag now... that can be a major performance hit.
[2013-08-20 17:28:32 -0400] cpuguy83: * everything for this operation, that is.
[2013-08-20 17:29:39 -0400] cpuguy83: storing ipsec connection params for 135 locations, each location in a diff databag may not be great during the chef run
[2013-08-20 17:33:31 -0400] pwelch: cpuguy83: I know the nagios cookbook uses a helper that only requests all of the databags at once instead of each time it hits a data bag block
[2013-08-20 17:33:39 -0400] pwelch: might be helpful
[2013-08-20 17:36:31 -0400] yfeldblum: cpuguy83, why do you specifically wan to store this in a data-bag?
[2013-08-20 17:36:41 -0400] yfeldblum: cpuguy83, is this already in a database?
[2013-08-20 17:44:34 -0400] dgarstang: has chef-client got a dry-run/noop mode?
[2013-08-20 17:44:43 -0400] awgross: dgarstang: look up why-run
[2013-08-20 17:45:01 -0400] dgarstang: awgross: k, see it. Wasn't obvious that's what it was.
[2013-08-20 17:46:43 -0400] cpuguy83: yfeldblum: because its stuff that gets added and removed often enough it seems wothwhile
[2013-08-20 17:48:32 -0400] cpuguy83: and no, its not loaded up yet, just testing dev possibilities
[2013-08-20 17:48:51 -0400] yfeldblum: cpuguy83, is it stuff that you've got in a postgres database on your network already? or is it just stuff that you've got in a google-docs spreadsheet?
[2013-08-20 17:49:45 -0400] yfeldblum: cpuguy83, k
[2013-08-20 17:50:17 -0400] yfeldblum: cpuguy83, you can use the search feature to have the chef-server give you all the data-bag items in a data-bag at once
[2013-08-20 17:51:05 -0400] yfeldblum: cpuguy83, `items = search("ipsec-params", "*:*")` for a data-bag named "ipsec-params" should get you an array of all the data-bag items in that data-bag
[2013-08-20 17:51:31 -0400] yfeldblum: cpuguy83, with a single fetch operation against the chef-server, not 135 + 1operations
[2013-08-20 18:15:27 -0400] klarakarl: Hi Any one alive ? I am interested to create a "default" cookbook, so I do not need to mention chef-client each time I bootstrap a node. How do I do this ?
[2013-08-20 18:16:06 -0400] klarakarl: I am talking about chef-client cookbook
[2013-08-20 18:16:54 -0400] goleldar: I found a base vagrant,node,mongo setup that uses chef but I cannot figure out how to have it also install a particular npm package
[2013-08-20 18:17:00 -0400] goleldar: https://github.com/justinleveck/vagrant-node-mongo/tree/master/cookbooks/nodejs
[2013-08-20 18:17:51 -0400] cpuguy83: yfeldblum: brilliant.
[2013-08-20 18:18:57 -0400] goleldar: this seems straightforward.. but I am not sure what I would add to also install the lineman package http://goo.gl/hX2JTD
[2013-08-20 18:20:28 -0400] adnichols: goleldar you may want to look at this: http://community.opscode.com/cookbooks/npm
[2013-08-20 18:20:51 -0400] adnichols: the project you are looking at installs npm but doesn't actually give you a provider to install node packages
[2013-08-20 18:21:06 -0400] goleldar: ahh ok
[2013-08-20 18:40:42 -0400] LanceStacenko: I'm trying to execute the node.js cookbook on one of my nodes. It's exiting with "Error executing action 'run' on resource 'bash[compile nodes (on 0 cpu)]"
[2013-08-20 18:40:47 -0400] LanceStacenko: What could be the issue?
[2013-08-20 18:41:34 -0400] LanceStacenko: *typo 'bash[compile node.js (on 0 cpu)]'
[2013-08-20 18:49:52 -0400] kl4m: klarakarl, you have to add the cookbook to the run list -- knife bootstrap [...] -r "recipe[abcd]"
[2013-08-20 18:50:20 -0400] kl4m: *add the recipe
[2013-08-20 18:55:57 -0400] kl4m: Is there a syntax to declare some constant hash right in the middle of a recipe? I want to avoid repeating some values amongst the resources so I do myhash = { :a => "b" , ... } .. I can't do that?
[2013-08-20 18:56:25 -0400] d```: kl4m: yes
[2013-08-20 18:56:55 -0400] d```: Chef's recipe DSL is ruby, and you can use any ruby function anywhere
[2013-08-20 18:57:12 -0400] d```: I'd be careful about what version of ruby you have in your environment
[2013-08-20 18:57:44 -0400] kl4m: I have a strange "Cannot find a resource for <nothing here> on ubuntu version 12.04" on that line
[2013-08-20 18:57:47 -0400] d```: I'm sure there's best practices around declaring stuff mid-recipe, but from a technical stand point. it's fine
[2013-08-20 18:58:19 -0400] d```: you may have a syntax error
[2013-08-20 19:04:33 -0400] dgarstang: hm, there's no cookbook for knife on opscode
[2013-08-20 19:06:38 -0400] kl4m: d```: I cleared the whitespace and it worked, must have been a strange character, sorry about that
[2013-08-20 19:07:51 -0400] kl4m: dgarstang: You are looking to install knife with a cookbook in what context?
[2013-08-20 19:08:31 -0400] dgarstang: kl4m: command and control server. Everyone is telling me that should be provisioned with chef too. Well, the tools that go on that box require knife-whisk.
[2013-08-20 19:11:06 -0400] kl4m: You could use gem or chef_gem resources in a recipe
[2013-08-20 19:11:20 -0400] dgarstang: kl4m: yeah I know. :(
[2013-08-20 19:12:26 -0400] dgarstang: kl4m: strangely, I just used chef_gem, it logged "chef_gem[knife-whisk] action install (bc-knife::whisk line 1)" but a gem list on my vagrant box doesn't show it
[2013-08-20 19:13:28 -0400] kl4m: if it's chef_gem, it's installed in the context of the chef client only (the embedded ruby in the omnibus install)
[2013-08-20 19:13:40 -0400] dgarstang: kl4m: crap. you mean locally?
[2013-08-20 19:14:11 -0400] dgarstang: kl4m: obviously that doesn't work so well with vagrant then
[2013-08-20 19:15:07 -0400] kl4m: chef_gem is for installing a gem that only the local chef-client needs, yes
[2013-08-20 19:15:21 -0400] kl4m: "gem" is for installing gems in general
[2013-08-20 19:15:44 -0400] gchristensen: miah: ping
[2013-08-20 19:15:50 -0400] dgarstang: kl4m: i might be SOL then, cuz I want it to go to the omnibus loc on the real box, Howeve, on my vagrant box, I don't
[2013-08-20 19:16:06 -0400] dgarstang: or do I? Dammit, I dunno.
[2013-08-20 19:16:13 -0400] gchristensen: why wouldn't you?
[2013-08-20 19:16:32 -0400] dgarstang: gchristensen: because gems are evil and I want to put them where I can watch them
[2013-08-20 19:16:49 -0400] gchristensen: right, so omnibus everywhere
[2013-08-20 19:17:18 -0400] d```: kl4m: haha, np.
[2013-08-20 19:17:21 -0400] dgarstang: gchristensen: breaks the vagrant model, but I guess
[2013-08-20 19:17:34 -0400] gchristensen: no it doesn't
[2013-08-20 19:17:54 -0400] dgarstang: gchristensen: it's not installed inside the vagrant box
[2013-08-20 19:18:40 -0400] kl4m: It's installed wherever chef-client is running, if it's running using the vagrant chef provisioner, it's inside the box
[2013-08-20 19:18:52 -0400] gchristensen: dgarstang: m.vm.provision :shell, :inline => "apt-get update; apt-get install -y curl; curl -L https://www.opscode.com/chef/install.sh | sudo bash"
[2013-08-20 19:19:02 -0400] dgarstang: kl4m: not according to gem list it isn't
[2013-08-20 19:19:07 -0400] gchristensen: dgarstang: if you put that ahead of your chef provisioner, it'll install the latest omnibus installer.
[2013-08-20 19:19:26 -0400] dgarstang: gchristensen: totally don't know why that's required...
[2013-08-20 19:19:40 -0400] gchristensen: it switches you from using the gem version to the omnibus version
[2013-08-20 19:19:49 -0400] gchristensen: but it isn't required.
[2013-08-20 19:20:02 -0400] dgarstang: gchristensen: now I'm totall lost, thanks
[2013-08-20 19:20:09 -0400] gchristensen: you're welcome. cheers!
[2013-08-20 19:26:23 -0400] surge_: If I was able to bootstrap one node without issue and then another immediately after, but that one times out, what might be the underlying cause? -VV isn't really helping in this case
[2013-08-20 19:26:46 -0400] surge_: Says there's a network error connecting to the chef server
[2013-08-20 19:27:23 -0400] fly9: anyone know of a tool/site that evaluates chef version compatibility for cookbooks?
[2013-08-20 19:31:22 -0400] adnichols: surge_ is it chef-client timing out or knife?
[2013-08-20 19:31:43 -0400] surge_: Appears to be the client
[2013-08-20 19:31:51 -0400] adnichols: surge_ so run chef-client -l debug
[2013-08-20 19:32:04 -0400] adnichols: you'll get a ton of output - but I'm guessing it'll tell you where it's failing
[2013-08-20 19:33:20 -0400] surge_: Oh yeah, forgot about that. Didn't occur to me since the node/client don't exist on the chef server yet
[2013-08-20 19:34:53 -0400] adnichols: surge_ this is during bootstrap?
[2013-08-20 19:35:00 -0400] surge_: yeah
[2013-08-20 19:35:24 -0400] adnichols: surge_ do you have any firewall restrictions on the chef server or do you require a hosts file entry to resolve the name?
[2013-08-20 19:36:08 -0400] surge_: It's on EC2, and I checked the security groups and it should be good to go. The 1st node is in the same SG as the 2nd.
[2013-08-20 19:36:52 -0400] surge_: The only diff is an elastic IP on the 2nd node
[2013-08-20 19:44:17 -0400] gchristensen: so I'm getting to a point where I have a lot of roles - is this common? or are sub-sections of infrastructurse broken out into different chef orgs? like I have four dedicated to my logging infrastructure alone
[2013-08-20 19:45:05 -0400] chris613: gchristensen: Seems reasonable? You'll probably eventually find that once you've identified all the roles in your org, some of them could be combined
[2013-08-20 19:45:26 -0400] chris613: To give an idea though, we have 400 nodes and roughly 30 roles
[2013-08-20 19:45:30 -0400] gchristensen: I have 31 roles
[2013-08-20 19:45:33 -0400] gchristensen: aye
[2013-08-20 19:45:45 -0400] gchristensen: cool. good to know
[2013-08-20 19:48:41 -0400] surge_: adnichols: Seems to be a firewall issue after all.
[2013-08-20 19:48:58 -0400] adnichols: surge_ did you have to allow the sg to talk to itself?
[2013-08-20 19:53:30 -0400] DandyPandy: How do I tell chef it's okay if an action fails? I've seen it done, but can't remember where. I have a runit service that times out, and I don't want it to bomb out when that happens.
[2013-08-20 19:55:01 -0400] surge_: adnichols: Yeah, it's already set up like that. Gonna look into what's going on w/ curl exactly. Thanks
[2013-08-20 19:56:14 -0400] adnichols: DandyPandy look up the ignore_failure attribute for all resources
[2013-08-20 19:56:28 -0400] LanceStacenko: Should the Node.js community cookbook support ARM architecture such as the Raspberry Pi? Would there be any special steps that I should take?
[2013-08-20 19:56:41 -0400] DandyPandy: adnichols: that's it. Thanks
[2013-08-20 20:09:26 -0400] josephholsten: http://community.opscode.com/users/josephholsten/edit is returning an error
[2013-08-20 20:10:14 -0400] josephholsten: :^{
[2013-08-20 20:12:00 -0400] chance: btm: are you in charge of updating cookbooks, was wondering if you guys might take a look at some of the PRs on application_python. Was thinking of contributing some of my changes
[2013-08-20 20:13:03 -0400] jtimberman: josephholsten: :(
[2013-08-20 20:13:34 -0400] josephholsten: ah, it was supposed to be https://www.opscode.com/account/profile
[2013-08-20 20:14:37 -0400] josephholsten: looks like someone needs to update the "Adjust your notification settings." link in the new version available for the * cookbook emails
[2013-08-20 20:15:08 -0400] josephholsten: chance: are there tickets for your PRs?
[2013-08-20 20:15:38 -0400] chance: they're not mine, but a ton of people are reporting issues on the github page
[2013-08-20 20:15:41 -0400] d```: is there a way to change the default copyright notice on cookbooks?
[2013-08-20 20:16:04 -0400] chance: josephholsten: my issues i could open up, however there are existing PRs on the github that I would like to see merged in as well
[2013-08-20 20:16:14 -0400] chance: existing other peoples PRS*
[2013-08-20 20:16:56 -0400] josephholsten: ah, I see. I'll go through and try to attach them to their tickets. The code review meetings only look at tickets.
[2013-08-20 20:17:38 -0400] josephholsten: have you signed the CLA? http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-08-20 20:17:48 -0400] chance: i see.
[2013-08-20 20:17:51 -0400] chance: i will.
[2013-08-20 20:22:32 -0400] dgarstang: universe, y u no put startups in Seattle or Portland.
[2013-08-20 20:23:07 -0400] BryanWB_: i don't live in a big american city and i work for an awesome startup :)
[2013-08-20 20:23:23 -0400] chance: dgarstang++
[2013-08-20 20:23:23 -0400] dgarstang: BryanWB_: sounds like bliss.
[2013-08-20 20:23:37 -0400] chance: dgarstang: not a start up but Mozilla is expanding their office in Portland
[2013-08-20 20:23:41 -0400] dgarstang: Getting a bit fed up with the bay area.
[2013-08-20 20:23:56 -0400] BryanWB_: dgarstang: it's fucking hard, but it's good, super smart ppl http://cyclecomputing.com,  everyone is remote
[2013-08-20 20:24:57 -0400] dgarstang: BryanWB_: Idaho?
[2013-08-20 20:25:06 -0400] BryanWB_: dgarstang: anywhere, i live in Italy
[2013-08-20 20:25:16 -0400] BryanWB_: but rest of team is all over US
[2013-08-20 20:25:18 -0400] dgarstang: BryanWB_: ah.
[2013-08-20 20:25:34 -0400] dgarstang: BryanWB_: noticed the phone number was 208 area code, which is Idaho
[2013-08-20 20:25:47 -0400] dgarstang: chance: Mozilla never got back to me. :)
[2013-08-20 20:25:50 -0400] BryanWB_: head office in connecticut, 2 ppl work there
[2013-08-20 20:26:14 -0400] chance: dgarstang: :\
[2013-08-20 20:26:56 -0400] dgarstang: i tell ya though, if I see one more social networking-photo-sharing-big-data-marketing startup, I'll lose my lunch.
[2013-08-20 20:27:06 -0400] spheromak: glad I got out of the bay. It's a nice place to visit, but I like where I live.
[2013-08-20 20:27:33 -0400] dgarstang: spheromak: workin' on it too.
[2013-08-20 20:28:46 -0400] dgarstang: all the startups in Seattle, read-read-read job description... oh, not too bad... more reaing... Windows.... fail.
[2013-08-20 20:28:57 -0400] spheromak: :P
[2013-08-20 20:29:01 -0400] spheromak: Portland is nice
[2013-08-20 20:29:58 -0400] dgarstang: spheromak: yah
[2013-08-20 20:30:26 -0400] BryanWB_: idaho ftw!
[2013-08-20 20:30:32 -0400] BryanWB_: or slovenia!
[2013-08-20 20:30:44 -0400] dgarstang: BryanWB_: I lived in Montana for a while. Had it's ups, and downs. Mostly downs.
[2013-08-20 20:31:00 -0400] adnichols: just don't come to Boulder - horrible here
[2013-08-20 20:31:06 -0400] dgarstang: adnichols: no?
[2013-08-20 20:31:21 -0400] adnichols: awful, like living on a glacier
[2013-08-20 20:31:45 -0400] spheromak: lol I liked boulder, but was only there for a month many years ago
[2013-08-20 20:32:43 -0400] dgarstang: it's kind of unmotivating when you work for a startup, and, while the work is technically interesting, you wonder what it's all for, and who besides you will ever use your tools, or why your boss, who's super technical, can't do a little forward thinking.... provide priorities based on business needs etc. Anyway, vent over.
[2013-08-20 20:32:49 -0400] adnichols: we're having trouble keeping the hordes out - apparently not enough folks like me spreading lies
[2013-08-20 20:34:02 -0400] juliancdunn: dgarstang: you could also come to work for Opscode :-)
[2013-08-20 20:35:22 -0400] dgarstang: juliancdunn: I'll keep an eye open. :)
[2013-08-20 20:35:27 -0400] CaptainQuirk: Hi there
[2013-08-20 20:36:19 -0400] CaptainQuirk: I'm looking for a way to let chef try to read the content of a file until it contains a certain value
[2013-08-20 20:37:36 -0400] LanceStacenko: Once I've bootstrapped a node, how do I deal with ssh keys?
[2013-08-20 20:37:49 -0400] LanceStacenko: Do any need to be brought over to auth?
[2013-08-20 20:38:11 -0400] dgarstang: juliancdunn: ah opscode is right next to speakeasy. interviewed with them many years ago
[2013-08-20 20:38:25 -0400] bean: you'd probably have to learn ruby to do opscode, dgarstang ;)
[2013-08-20 20:38:58 -0400] dgarstang: bean: i'll have to have my style gland removed
[2013-08-20 20:39:36 -0400] renchap: :win 43
[2013-08-20 20:40:11 -0400] justizin: anyone know if it's possible with the runit cookbook to spit out services which are not immediately enabled?  setting enabled false doesn't seem to work.
[2013-08-20 20:42:40 -0400] juliancdunn: bean: or Erlang :-)
[2013-08-20 20:42:44 -0400] bean: ^
[2013-08-20 20:43:45 -0400] juliancdunn: CaptainQuirk: what do you mean?
[2013-08-20 20:43:59 -0400] juliancdunn: LanceStacenko: not for Chef itself
[2013-08-20 20:45:11 -0400] CaptainQuirk: juliancdunn, I would like the chef run to be say, interrupted until a certain value is written into a certain file
[2013-08-20 20:46:17 -0400] spheromak: CaptainQuirk, you wnat the run to stop  or you want the run to block
[2013-08-20 20:46:33 -0400] CaptainQuirk: to block, with retries and retry_delay
[2013-08-20 20:46:37 -0400] spheromak: easy to File.read.match "something"
[2013-08-20 20:46:47 -0400] spheromak: you could jsut build the block and do a timer
[2013-08-20 20:46:52 -0400] spheromak: can use file-tail
[2013-08-20 20:47:11 -0400] spheromak: but there isn't anything in chef that does this. you would have to write a library or  lwrp/hwrp
[2013-08-20 20:47:22 -0400] spheromak: file-tail gem if you want to block
[2013-08-20 20:47:36 -0400] spheromak: then I would set that in a timer as to not block forever
[2013-08-20 20:49:01 -0400] CaptainQuirk: spheromak, doesn't the retries value with an infinite number suffice
[2013-08-20 20:49:02 -0400] CaptainQuirk: ?
[2013-08-20 20:50:08 -0400] spheromak: retries in what context ? l
[2013-08-20 20:51:25 -0400] spheromak: like execute a grep in an execute  with a very large retry and a wait ?
[2013-08-20 20:51:32 -0400] spheromak: grep -q
[2013-08-20 20:51:53 -0400] spheromak: you could achieve your desired behavior this way, but Im not a personal fan of that approach
[2013-08-20 20:51:57 -0400] CaptainQuirk: retries to File.read.match  something 
[2013-08-20 20:52:01 -0400] spheromak: uea
[2013-08-20 20:52:11 -0400] spheromak: you would need a proper chef resource
[2013-08-20 20:52:19 -0400] CaptainQuirk: why ?
[2013-08-20 20:52:20 -0400] spheromak: so an eexecute or a block  ressource with a retry
[2013-08-20 20:52:42 -0400] spheromak: dunno just smells to me :D tho it should work
[2013-08-20 20:52:44 -0400] CaptainQuirk: spheromak, oh, yeah, sorry
[2013-08-20 20:52:45 -0400] spheromak: block do
[2013-08-20 20:52:54 -0400] CaptainQuirk: I get it
[2013-08-20 20:53:16 -0400] spheromak: you probably want to put in a ssleep too otherwise it will eat cpu.. and all of these things smell :D
[2013-08-20 20:53:23 -0400] CaptainQuirk: but since I would like to delete the file once it contains a certain value
[2013-08-20 20:53:37 -0400] spheromak: file-tail within a timer is the more elegant "programmer way"  I suppose
[2013-08-20 20:53:37 -0400] CaptainQuirk: I could use the file resource with delete :action
[2013-08-20 20:53:55 -0400] CaptainQuirk: spheromak, I'll keep it in mind
[2013-08-20 20:55:48 -0400] spheromak: CaptainQuirk, heres an example in the jenkins of blocking till something is available
[2013-08-20 20:55:50 -0400] spheromak: https://github.com/opscode-cookbooks/jenkins/blob/master/recipes/server.rb#L94-L110
[2013-08-20 20:56:08 -0400] LanceStacenko: I tried to run the community node.js cookbook and it threw an error at me. "Error executing action 'run' on resource 'bash[compile node.js (on 0 cpu)]"  I'm running on a raspberry pi, ARM processor.
[2013-08-20 20:56:34 -0400] spheromak: LanceStacenko, run with -l debug
[2013-08-20 20:56:43 -0400] chris613: Hi guys. Running Chef Server 10.18 (working on our 11 upgrade soon!). Currently I'm having a problem where (at least) one specific node isn't showing up when I search for it by name, yet if I do a search for '*;*' with '-a name' it shows up with the expected name. WTF could cause this? And what could fix it?
[2013-08-20 20:56:44 -0400] spheromak: should spit out the command it was running
[2013-08-20 20:56:57 -0400] LanceStacenko: spheromak: Doing that right now.
[2013-08-20 20:56:58 -0400] spheromak: and you can try it by hand to see what might be up.
[2013-08-20 20:57:01 -0400] chris613: I already tried doing a trivial edit of the node object; that didn't seem to bring it to life
[2013-08-20 20:57:06 -0400] spheromak: shoudl dump the stdout/sterer
[2013-08-20 20:57:09 -0400] spheromak: *err
[2013-08-20 20:57:21 -0400] LanceStacenko: Woah that's verbose.
[2013-08-20 20:57:47 -0400] LanceStacenko: The output from that command is incredible.
[2013-08-20 20:57:50 -0400] spheromak: chris613,  could be many things.
[2013-08-20 20:57:51 -0400] CaptainQuirk: spheromak, no file-tail though, just a ruby_block
[2013-08-20 20:57:58 -0400] CaptainQuirk: it's standard ruby I guess
[2013-08-20 20:58:01 -0400] spheromak: CaptainQuirk, thatts a block thats calling a library method
[2013-08-20 20:58:14 -0400] chris613: spheromak: Other nodes are working just fine, so the whole shebang isn't broken
[2013-08-20 20:58:35 -0400] spheromak: chris613, usually in that sorta scenario in chef10 that was the MaxFieldLength problem
[2013-08-20 20:58:38 -0400] chris613: restarting chef-solr didn't help (colleaugue suggested it)
[2013-08-20 20:58:56 -0400] spheromak: google chef MaxFieldLength, tho thats a gut reaction to what you describe. Could be way off
[2013-08-20 20:59:54 -0400] LanceStacenko: spheromak: My output is way too verbose to make anything from it. Would you mind taking a quick look via a paste bin?
[2013-08-20 21:00:27 -0400] spheromak: LanceStacenko,  look for your error at thee bottom trace back. you will see the output from the failure
[2013-08-20 21:00:36 -0400] droy: Hi all.  I had played with Chef a while ago but never really took it too far.  I'm starting again and would like a clean environment.  what is the best way to clear out any already-configured chef details from my mac?  Delete the ~/.chef folder?
[2013-08-20 21:00:40 -0400] spheromak: if its way to much for you. how is it gonna be better for me ? :D
[2013-08-20 21:01:30 -0400] spheromak: droy,  ~/.chef;  /etc/chef ; /opt/chef (if you used an omni install); gem uninstall chef
[2013-08-20 21:01:35 -0400] LanceStacenko: DEBUG: Server doesn't support resource history, skipping resource report. FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
[2013-08-20 21:01:36 -0400] spheromak: droy, off the top of my head
[2013-08-20 21:02:02 -0400] droy: thanks spheromak
[2013-08-20 21:02:02 -0400] spheromak: LanceStacenko, so whats the stuff around that.. probly up further
[2013-08-20 21:02:06 -0400] droy: will try it
[2013-08-20 21:02:23 -0400] droy: i also found this, which is a good reference  http://stackoverflow.com/questions/17115245/how-to-uninstall-chef-client-and-the-whole-chef-package
[2013-08-20 21:02:29 -0400] spheromak: droy,  /var/lib/chef /var/cache/chef  if you did gem install
[2013-08-20 21:02:39 -0400] LanceStacenko: spheromak: What exactly should i be looking for?
[2013-08-20 21:02:52 -0400] spheromak: LanceStacenko, your failed resource
[2013-08-20 21:03:09 -0400] spheromak: debug will show what it was running what it returned
[2013-08-20 21:03:14 -0400] spheromak: any output
[2013-08-20 21:03:24 -0400] droy: Also, can i use subversion to store my cookbooks, recipes, etc?  Or is git a requirement?
[2013-08-20 21:03:30 -0400] LanceStacenko: "This program built for arm-unknown-linux-gnuaebihf
[2013-08-20 21:03:34 -0400] spheromak: droy, git is not required
[2013-08-20 21:03:45 -0400] droy: perfect, thanks again @spheromak
[2013-08-20 21:04:14 -0400] LanceStacenko: Hm. Would it be in a resource declaration?
[2013-08-20 21:09:29 -0400] LanceStacenko: spheromak: "Ran "bash" "/tmp/chef-script20130820-7344-1izpc3u"
[2013-08-20 21:09:39 -0400] LanceStacenko: Would that be it?
[2013-08-20 21:10:03 -0400] spheromak: LanceStacenko, is this not a cookbook you made ? its the node cookbook from community right ?
[2013-08-20 21:10:33 -0400] LanceStacenko: Yes it's the node.js community cookbook. The node is a raspberry pi with an ARM processor, fully bootstrapped and listed as a node with a run_list.
[2013-08-20 21:10:42 -0400] spheromak: so the original erro IIRC you reported said bash resource failed.  It tried to do some shell and it didn't exit clean. lookging for that to know what was run and why it failed.
[2013-08-20 21:11:17 -0400] LanceStacenko: spheromak: Well the output is incredibly verbose. There's multiple paragraphs on different failed resources. I'm not sure exactly what is going on.
[2013-08-20 21:11:25 -0400] nebrera2: helllo
[2013-08-20 21:11:30 -0400] nebrera2: someone know how to log to sysog chef-client activity for new version 11.6.0 ??
[2013-08-20 21:11:32 -0400] spheromak: should be same failure from the run then the trace
[2013-08-20 21:11:54 -0400] spheromak: you can paste it, and I can look if i have time.  gotta do some work myself  :D
[2013-08-20 21:15:36 -0400] LanceStacenko: Hm. Well the only thing in red is "Error executing action 'run' on resource 'bash[compile node.js (on 0 cpu)]"
[2013-08-20 21:15:54 -0400] LanceStacenko: before that is "creating ./config.mk" but I doubt that's it.
[2013-08-20 21:19:46 -0400] juliancdunn: nebrera2: read this thread: http://lists.opscode.com/sympa/arc/chef/2012-12/msg00329.html
[2013-08-20 21:21:05 -0400] josephholsten: there's a circular set of requires from chef/mixin/shell_out -> chef/config -> chef/util/selinux -> ...
[2013-08-20 21:21:27 -0400] nebrera2: juliancdunn, thanks
[2013-08-20 21:21:41 -0400] nebrera2: I was using this
[2013-08-20 21:22:24 -0400] nebrera2: http://pastebin.com/C0eBwNru
[2013-08-20 21:22:31 -0400] nebrera2: and it worked on chef-1.4.4
[2013-08-20 21:22:42 -0400] nebrera2: I have just updated to chef-1.6.0
[2013-08-20 21:37:08 -0400] nebrera2: juliancdunn, do you save logs oat syslog ?
[2013-08-20 21:37:19 -0400] nebrera2: or do you rotate them ?
[2013-08-20 21:55:24 -0400] quattro_: anyone here had any lucking getting the mongodb cookbook to deploy replica set or replica sharded?
[2013-08-20 21:56:25 -0400] bean: quattro_: i ended up writing in the ability to use them into my cb
[2013-08-20 21:56:25 -0400] bean: but
[2013-08-20 21:56:29 -0400] bean: i "hand configured" them
[2013-08-20 21:56:39 -0400] bean: because its hard for chef to know when the other servers will be "ready"
[2013-08-20 21:56:47 -0400] bean: thats my philosophy on it at least
[2013-08-20 21:57:48 -0400] quattro_: yeah the default cookbooks don't really seem to work with more complicated setups
[2013-08-20 21:57:53 -0400] bean: yep :)
[2013-08-20 22:03:42 -0400] quattro_: bean: did you end up getting chef to configure the setup for you or are you doing it manually?
[2013-08-20 22:03:49 -0400] bean: manually
[2013-08-20 22:03:52 -0400] bean: i dont have many clusters
[2013-08-20 22:07:34 -0400] LanceStacenko: Has anyone had any luck installing the node.js cookbook?
[2013-08-20 22:39:22 -0400] xmltok: I get a 403 error while my chef client tries to download a template from the chef server. any ideas what would cause that?
[2013-08-20 22:44:45 -0400] xmltok: it is not hosted chef
[2013-08-20 23:01:12 -0400] jkeiser: xmltok: what chef server is it?
[2013-08-20 23:02:19 -0400] jkeiser: xmltok: and what url are you hitting when you get a 403?  You can pass -l debug as an arg to chef-client to see extra detail like that
[2013-08-20 23:09:58 -0400] xmltok: 11.0.8-1.ubuntu.12.04, url is https://chefprod/bookshelf/organization-00000000000000000000000000000000/checksum-b89414403bae07e5207a3d05ca061c6b?AWSAccessKeyId=b2401ee8c5f5d311ef9a1950404f7493f5ab435f&Expires=1377037802&Signature=GBkhIlWugqIWxeFZwg52p63D4Y8%3D
[2013-08-20 23:16:08 -0400] ssd7__: xmltok: My guess is that the link expired
[2013-08-20 23:16:25 -0400] ssd7__: the links are signed for a time window and if you try to access it outside that window, it will 403
[2013-08-20 23:16:51 -0400] xmltok: ah maybe my clock is messed up somewhere
[2013-08-20 23:17:21 -0400] bear: how do I get knife solo to honor the ssh gateway parameters like knife ec2 will?
[2013-08-20 23:17:31 -0400] ssd7__: xmltok: A clock being off would also do it
[2013-08-20 23:17:43 -0400] ssd7__: xmltok: Sometimes you can see that in a *very* long chef client run
[2013-08-20 23:17:49 -0400] xmltok: well, the date is fine on both nodes. i removed that single template (there are other templates in the cookbook) and the build succeeded
[2013-08-20 23:18:10 -0400] ssd7__: xmltok: Is your run taking longer than 15 minutes to reach that template?
[2013-08-20 23:18:40 -0400] xmltok: no, its about 9 minutes
[2013-08-20 23:18:56 -0400] ssd7__: Hrm, default timeout should be 900 seconds, so that might not be it
[2013-08-20 23:19:00 -0400] xmltok: sorry wait, its longer than 15
[2013-08-20 23:19:09 -0400] xmltok: its 17 minutes
[2013-08-20 23:19:21 -0400] xmltok: so that is my problem
[2013-08-20 23:19:31 -0400] ssd7__: yeah, so you can change erchef['s3_url_ttl'] in your configuration file on the server to up the timeout if you would like
[2013-08-20 23:19:32 -0400] xmltok: it is a pretty beefy cookbook, ill bump up that timeout
[2013-08-20 23:20:13 -0400] xmltok: thanks ssd7, this has been a real annoying problem
[2013-08-20 23:20:51 -0400] ssd7__: no problem, glad to help
[2013-08-20 23:26:07 -0400] bear: you don't - need to setup .ssh/config proxy command
[2013-08-20 23:28:39 -0400] xmltok: what is the replacement for /etc/chef-server/chef-server.rb with erchef?
[2013-08-20 23:31:40 -0400] lrr: in my cookbook, i have a few recipes (default, do_something_a, do_something_b). in do_something_a, how would i include recipe default?
[2013-08-20 23:39:36 -0400] lrr: anyone?
[2013-08-20 23:41:25 -0400] ssd7: xmltok: Not sure I understand your question
[2013-08-20 23:42:47 -0400] xmltok: i guess the erchef still uses the ruby configuration file, ive tried running reconfigure after making that file, it dumped some stuff that looks like it interpreted new value
[2013-08-20 23:57:12 -0400] ssd7: xmltok: Yeah, that controls all of the components still
