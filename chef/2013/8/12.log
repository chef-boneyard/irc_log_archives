[2013-08-12 00:10:25 -0400] gchristensen: grr... the way pagerduty support was hacked in is very irritating
[2013-08-12 00:12:01 -0400] gchristensen: stormerider: ping
[2013-08-12 00:13:20 -0400] stormerider: gchristensen: pong
[2013-08-12 00:13:34 -0400] gchristensen: stormerider: I don't remember what happened last - is that ticket regarding the search criteria merged in yet?
[2013-08-12 00:14:00 -0400] stormerider: i dont believe so, i dont think i had a chance to resubmit it before the crash
[2013-08-12 00:14:10 -0400] stormerider: $work's been keeping me pretty busy
[2013-08-12 00:15:42 -0400] gchristensen: understood, just trying to keep tabs :)
[2013-08-12 00:18:07 -0400] stormerider: i probably wont have time to do anything on it this month. major migrations going on since we got bought out by Rosetta.
[2013-08-12 00:18:40 -0400] gchristensen: oh hey, congratulations :) I don't mind maintaining my own fork for a while, I just don't want to do it if its been merged
[2013-08-12 00:19:47 -0400] stormerider: *nod* thanks. a bit interesting going from a <50 person company to gods know how many, but >2k
[2013-08-12 00:20:21 -0400] stormerider: but me and another guy are leading a Chef initiative in house :)
[2013-08-12 00:20:56 -0400] gchristensen: hah, excellent, trying to take over Rosetta's non-chef setup?
[2013-08-12 00:21:32 -0400] stormerider: yep
[2013-08-12 00:22:29 -0400] stormerider: i dunno how they manage things the way they are right now just my mind kind of broke when they explained it to me.
[2013-08-12 00:22:37 -0400] stormerider: anyways :)
[2013-08-12 00:22:50 -0400] stormerider: arguing with atlassian products this month.
[2013-08-12 00:23:21 -0400] stormerider: been keeping their support employees busy :)
[2013-08-12 02:07:38 -0400] gchristensen: jtimberman: you're not working this evening by chance, are you?
[2013-08-12 02:26:36 -0400] clkao: w/in 41
[2013-08-12 03:02:24 -0400] MoonMan_: Hi, I'm having an issue trying to bootstrap a raspberry pi. I'm bootstrapping using root as a user, and it's telling me "Unable to retrieve a valid package!". I'm running an armv6l architecture. Is there any way to force it to download chef for that particular system?
[2013-08-12 08:18:19 -0400] prognostikos: is anyone using test-kitchen/bats to test their iptables configuration? if so are you grepping the list output or testing in a more clever way?
[2013-08-12 09:23:03 -0400] Hildgrim: Did someone forget to renew a certificate or is this just me? ERROR: cannot verify www.opscode.com's certificate, issued by `/C=US/O=DigiCert Inc/CN=DigiCert Secure Server CA':
[2013-08-12 09:28:53 -0400] alexbst: Hildgrim - works in firefox for me
[2013-08-12 09:34:30 -0400] Hildgrim: openssl s_client -connect www.opscode.com:443 gives me Verify return code: 20 (unable to get local issuer certificate) though
[2013-08-12 09:35:26 -0400] Hildgrim: hm :/
[2013-08-12 09:36:11 -0400] alexbst: looks fine to me
[2013-08-12 09:36:17 -0400] Hildgrim: o well
[2013-08-12 10:02:22 -0400] prognostikos: Hildgrim: it's not just you, but it's inconsistent. from my workstation I don't have any problems, from a vps on digital ocean I do
[2013-08-12 10:04:50 -0400] helllen: helllo
[2013-08-12 10:06:00 -0400] helllen: I am having a problem with my recipie
[2013-08-12 10:06:23 -0400] helllen: the first time the node joins to erchef, the node is like it wasn't complete
[2013-08-12 10:08:16 -0400] helllen: for example I do exec node.hostname and says it has no method called hostname
[2013-08-12 10:08:46 -0400] helllen: after the first run it pass and and second time it gives me a correct value of node.hostname
[2013-08-12 10:08:54 -0400] helllen: why ?
[2013-08-12 10:11:56 -0400] zts: helllen: can you gist/pastebin the recipe?
[2013-08-12 10:12:06 -0400] zts: (at least, the part that is failing)
[2013-08-12 10:14:19 -0400] helllen: it just the begining
[2013-08-12 10:14:24 -0400] helllen: I do node.hostname
[2013-08-12 10:14:27 -0400] helllen: and fails
[2013-08-12 10:15:03 -0400] helllen: even with the console
[2013-08-12 10:15:28 -0400] helllen: I do:     node = Chef::Node.load "rb-manager"
[2013-08-12 10:15:34 -0400] helllen: and then node.hostname
[2013-08-12 10:15:40 -0400] zts: helllen: so you have a recipe containing nothing by "node.hostname", and when you run chef-client that fails?  Can you pastebin the whole log from the run?
[2013-08-12 10:15:47 -0400] helllen: and it says it has no method called node.hostname
[2013-08-12 10:16:09 -0400] helllen: just a second I am reinstalling it the lab
[2013-08-12 10:16:12 -0400] helllen: give me 10 minutes
[2013-08-12 10:16:15 -0400] helllen: and I paste it
[2013-08-12 10:16:32 -0400] zts: when a node is first created, it has almost no details on it at all
[2013-08-12 10:17:02 -0400] zts: the node needs to run chef successfully so that the information ohai collects can be saved to the server
[2013-08-12 10:17:13 -0400] zts: but ohai runs before your recipes, so this is not a problem for recipes running on the node
[2013-08-12 10:17:35 -0400] helllen: it has ohai recipie
[2013-08-12 10:17:49 -0400] helllen: is ohai run before the other recipies ?
[2013-08-12 10:18:44 -0400] zts: ohai will run before any recipes.  If you also use the ohai cookbook (or ohai resource), ohai might run a second time during your chef run as well
[2013-08-12 10:18:46 -0400] helllen: the problem is default attributes are not shown neither
[2013-08-12 10:19:16 -0400] zts: indeed, until the chef-client run saves its data to the server, almost nothing will be there
[2013-08-12 10:19:48 -0400] zts: just the node name, the run_list you set (not the expanded one, and not "roles" or "recipes"), very basic things like that
[2013-08-12 10:21:01 -0400] Hildgrim: prognostikos: yeah, i just got it working again. strange
[2013-08-12 10:25:14 -0400] helllen: zts, I have solved with node.name
[2013-08-12 10:25:20 -0400] helllen: it always exist
[2013-08-12 10:25:22 -0400] helllen: :-D
[2013-08-12 10:25:55 -0400] zts: helllen: yeah, you can always rely on the node.name being there :)
[2013-08-12 12:01:19 -0400] bcave: hi all
[2013-08-12 12:02:35 -0400] linuxboy: hi
[2013-08-12 12:02:45 -0400] linuxboy: I have chef 11.0.8 installed and I want to upgrade to chef 11.6
[2013-08-12 12:02:47 -0400] linuxboy: any tips?
[2013-08-12 12:02:50 -0400] linuxboy: will everything explode?
[2013-08-12 12:03:27 -0400] bcave: in one of my recipes, I had a service defined, with `action [:enable, :start]`. The service would be started when the recipe ran on chef client. I then added `supports :status=>true, :restart=>true,:reload=>false`. Now when the recipe executes on first startup, the service isn't started.
[2013-08-12 12:04:15 -0400] bcave: linuxboy: don't think so, can you not set up a test environment? I know that when 11.6 was released, my clients were all upgraded without issue. not sure about chef-server though
[2013-08-12 12:04:22 -0400] bcave: it was from 11.4 though, not 11.0.8
[2013-08-12 12:04:35 -0400] linuxboy: I just want to upgrade the server
[2013-08-12 12:06:44 -0400] zts: linuxboy: 11.0.8 is the latest version of the open source server
[2013-08-12 12:07:02 -0400] zts: linuxboy: 11.6 is just the client
[2013-08-12 12:07:09 -0400] OG_chef: Guy's i see some weird stuff when starting vagrant machine
[2013-08-12 12:07:21 -0400] linuxboy: oh
[2013-08-12 12:07:22 -0400] bcave: when chef-client runs, i get the following: service[my-service] action enable....  -enable service service[my-service]
[2013-08-12 12:07:50 -0400] bcave: service[my-service] action start (up to date)
[2013-08-12 12:07:54 -0400] linuxboy: zts: you're right!
[2013-08-12 12:08:02 -0400] bcave: but it's not started
[2013-08-12 12:08:13 -0400] linuxboy: zts: can you explain this to me then? http://tickets.opscode.com/browse/CHEF-3045
[2013-08-12 12:08:20 -0400] linuxboy: zts: I thought I'd need to upgrade the server
[2013-08-12 12:08:37 -0400] OG_chef: {"error":["Invalid signature for user or client 'gilbar11'"]} (Ridley::Errors::HTTPUnauthorized)
[2013-08-12 12:09:24 -0400] zts: linuxboy: that's a monster ticket!  Just reading now to see what the change in 11.6 was
[2013-08-12 12:09:41 -0400] linuxboy: zts: there is a pull request
[2013-08-12 12:10:54 -0400] OG_chef: can anyone assist? {"error":["Invalid signature for user or client 'gilbar11'"]} (Ridley::Errors::HTTPUnauthorized)
[2013-08-12 12:11:00 -0400] OG_chef: happens when starting with vagrant
[2013-08-12 12:11:19 -0400] OG_chef: with other vagrant machines issue not reappearing
[2013-08-12 12:12:09 -0400] linuxboy: zts: so I have server 11.0.8 and client 11.6.0
[2013-08-12 12:12:27 -0400] linuxboy: zts: and I seem to be having that issue
[2013-08-12 12:12:53 -0400] OG_chef: linuxboy, same issue as i do?
[2013-08-12 12:13:00 -0400] linuxboy: OG_chef: no
[2013-08-12 12:13:24 -0400] zts: linuxboy: I suspect that with client 11.6.0, if you put 'no_lazy_load true' into /etc/chef/client.rb, things might work
[2013-08-12 12:13:35 -0400] linuxboy: zts: aaah
[2013-08-12 12:13:38 -0400] linuxboy: zts: was that on the ticket?
[2013-08-12 12:13:55 -0400] zts: linuxboy: it's a struggle reading through the history of that ticket, but I found this PR which talks about restoring that functionality (which was inadvertently broken) https://github.com/opscode/chef/pull/607
[2013-08-12 12:14:06 -0400] zts: linuxboy: there's a comment in the ticket that mentions it, and I think that's what it's referring to
[2013-08-12 12:14:22 -0400] linuxboy: zts: thanks, I'll look into it
[2013-08-12 12:14:25 -0400] zts: linuxboy: the other option is to make a configuration change on your server, per this comment: http://tickets.opscode.com/browse/CHEF-3045?focusedCommentId=35529&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-35529
[2013-08-12 12:14:42 -0400] linuxboy: zts: ja, I saw that
[2013-08-12 12:15:01 -0400] zts: linuxboy: the way I understand it, the "no_lazy_load true" on the client means that it will download all the files immediately (ie, before the timeouts expire), while the server one increases the timeout
[2013-08-12 12:15:33 -0400] linuxboy: yeah
[2013-08-12 12:16:37 -0400] zts: OG_chef: I don't think Vagrant uses Ridley, so I guess you're using the berkshelf plugin, and have that vagrant machine configured to work with a chef server?
[2013-08-12 12:16:45 -0400] mmack: Hey all.. can someone please explain me the how chef cookbooks depend on environments? I uploaded all my cookbooks without the -E switch, so they are all availible in all env's, right? Can i upload cookbooks that are only availible in , for example production?
[2013-08-12 12:17:21 -0400] zts: OG_chef: I don't know exactly what that error means, but it sounds like it doesn't like the client key you're using.
[2013-08-12 12:17:32 -0400] bcave: ah, ok. i found the problem. my init script exited with a 0 return for service status, when the service was stopped.
[2013-08-12 12:17:33 -0400] mmack: and how comes versioning in here... thought versions of cookbooks are there for updating stage servers without rolling it out to production servers..
[2013-08-12 12:18:01 -0400] prognostikos: mmack: you can lock environments to specific versions of cookbooks
[2013-08-12 12:18:12 -0400] zts: mmack: environments may contain "cookbook version constraints", which say which version(s) of a cookbook may be used in that environment
[2013-08-12 12:18:52 -0400] zts: mmack: so you'd roll changes out by having a staging environment that always used the latest versions of a cookbook (or whatever), and update the constraint in your production environment when you want the new cookbook to be used there
[2013-08-12 12:19:29 -0400] mmack: ok, in production i locked a cb to version 1.0.0. And i think i missed to look it at production, so i get a "412, precondition failed" because it is "missing" in this env?
[2013-08-12 12:19:31 -0400] zts: mmack: also, in general, the -E option to knife is made of lies.  It's a common option (so it seems valid for every command), but it doesn't do anything for most of them
[2013-08-12 12:20:51 -0400] mmack: or lets explain it the other way round: In the opscode manager i see a cookbook in every env BUT production... i'm wondering how i'd managed to do this :)
[2013-08-12 12:20:58 -0400] zts: mmack: if you do "knife cookbook list -a", do you see version 1.0.0 of that cookbook in the list?
[2013-08-12 12:22:05 -0400] mmack: oh shit... it was a typo... i wrote down the wrong version constraint for a cookbook
[2013-08-12 12:23:03 -0400] zts: easy mistake to make!  If you're building a workflow around cookbook versions and environments, take a look at knife-spork (if you haven't already)
[2013-08-12 12:23:24 -0400] mmack: okay i will do... thanks guys!!!
[2013-08-12 12:48:17 -0400] bigbigbang: Ohai chefs ! Does someone knows if nginx has been compiled with "HttpStubStatusModule" option on Chef open-source ? Or does someone knows if I can reach the nginx status page .. ?? I would like to supervise chef components with nagios  thx
[2013-08-12 13:02:35 -0400] bigbigbang: please experts ... [14:48] <bigbigbang> Ohai chefs ! Does someone knows if nginx has been compiled with "HttpStubStatusModule" option on Chef open-source ? Or does someone knows if I can reach the nginx status page .. ?? I would like to supervise chef components with nagios  thx
[2013-08-12 13:04:56 -0400] gchristensen: bigbigbang: twhis is on the chef server?
[2013-08-12 13:05:08 -0400] bigbigbang: gchristensen: yes
[2013-08-12 13:05:37 -0400] gchristensen: bigbigbang: this is where nginx is compiled for chef-server: https://github.com/opscode/omnibus-software/blob/master/config/software/nginx.rb#L28
[2013-08-12 13:05:53 -0400] gchristensen: bigbigbang: check lines 31, 32, and 33
[2013-08-12 13:07:52 -0400] bigbigbang: gchristensen: all right thanks, i got my answer : yes it's compiled with my option .. so now i have to find why my nginx configuration doesn't found this : stub_status
[2013-08-12 13:09:19 -0400] gchristensen: bigbigbang: have you looked at other examples on how to set up stub_status?
[2013-08-12 13:09:23 -0400] gchristensen: http://wiki.nginx.org/HttpStubStatusModule
[2013-08-12 13:09:26 -0400] ztugcesirin: Hello everyone. I'm trying to install Chef Server on Debian Squeeze. But after installation (sudo apt-get install chef chef-server) I can't configure or use chef. It would be really nice if you can help me out!
[2013-08-12 13:10:23 -0400] gchristensen: ztugcesirin: unfortunately, apt-get install is not the recommended method anymore
[2013-08-12 13:11:02 -0400] ztugcesirin: But checked a lot of tutorials almost all of them were apt-get
[2013-08-12 13:11:14 -0400] gchristensen: oh... hrm, it seems only ubuntu is supported through omnibus.
[2013-08-12 13:11:14 -0400] ztugcesirin: So you recommend to build it from the source?
[2013-08-12 13:11:37 -0400] gchristensen: ztugcesirin: I'd recommend going to the official documentation :)
[2013-08-12 13:12:27 -0400] gchristensen: ztugcesirin: http://docs.opscode.com/install_server.html
[2013-08-12 13:12:32 -0400] bigbigbang: gchristensen: not at all, just beginning to supervise chef components with nagios (postgre,rabbitmq,solr,ping, and nginx..) why other exampleS ? I only find one way to achieve that or ? Perhaps you could answer me : why compiling nginx with stuboption but not specifying it in configuration file ?
[2013-08-12 13:12:54 -0400] ztugcesirin: You mean this http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages and this http://docs.opscode.com/install_server.html? Because I was read both of them.
[2013-08-12 13:13:09 -0400] cpuguy83: ztugcesirin: I'd reccomend just installing using knife-solo and a the chef-server cookbook.
[2013-08-12 13:13:14 -0400] cpuguy83: Or http://fnichol.github.io/knife-server/
[2013-08-12 13:13:23 -0400] cpuguy83: Let's you bootstrap a chef-server with knife
[2013-08-12 13:13:30 -0400] gchristensen: cpuguy83: thank you - I've not actually configured chef-server before :(
[2013-08-12 13:13:45 -0400] gchristensen: bigbigbang: I'm not certain, but perhaps they intend for you to modiy the configuration? I honestly don't know
[2013-08-12 13:13:55 -0400] ztugcesirin: Did I just write "I was read? " Gosh. Thanks for advice. I'll try it!
[2013-08-12 13:14:03 -0400] bigbigbang: gchristensen: all right ... open source ... i think
[2013-08-12 13:14:11 -0400] bigbigbang: gchristensen: thks anyway
[2013-08-12 13:15:23 -0400] gchristensen: bigbigbang: well it is still individual server components, I don't think they ever say you shouldn't tune them to your needs.
[2013-08-12 13:25:46 -0400] telefoonboek: Hello guys
[2013-08-12 13:26:16 -0400] telefoonboek: What would be the best way to run a system command, but only after some other things have run, and raise an error if the command failes?
[2013-08-12 13:26:28 -0400] telefoonboek: fails*
[2013-08-12 13:29:50 -0400] bigbigbang: gchristensen: thanks, the 'end of configuration' was only commented in chef_http_lb.conf
[2013-08-12 13:30:37 -0400] gchristensen: telefoonboek: set a execute or bash block, set its action to nothing, and then notify that block from the other thing
[2013-08-12 14:10:22 -0400] aruntomar: can anyone help me with chefspec + berkshelf
[2013-08-12 14:11:43 -0400] halfamind: Quick question: A "template" resource end up notifying a "service" resource to reload. What user runs that reload command?
[2013-08-12 14:11:48 -0400] halfamind: (I'm getting errors that a root-owned file "must be owned by you," but I expected root to be running it.)
[2013-08-12 14:15:08 -0400] atomic-penguin: halfamind, the user chef-client runs as, should be 'root'
[2013-08-12 14:16:24 -0400] halfamind: atomic-penguin: Thanks. That's what I would have thought, but the error implies otherwise. Any chance it ends up being the user that owns the template?
[2013-08-12 14:17:10 -0400] atomic-penguin: halfamind, is it possible you are not running chef-client as root?
[2013-08-12 14:18:08 -0400] halfamind: atomic-penguin: Researching that now these recipes are executed by AWS OpsWorks, so I'm not 100% sure.
[2013-08-12 14:21:01 -0400] aruntomar: i keep getting this issue: https://github.com/acrmp/chefspec/issues/38 , i'm using chefspec+berkshelf. i've tried passing array for cookbook path. still some test fails.
[2013-08-12 14:21:56 -0400] aramus_: Hello, is there a way to set the run-list of a server without using knife node edit?
[2013-08-12 14:24:29 -0400] aramus_: knife node run_list add node 'recipe[COOKBOOK::RECIPE_NAME]', nvm, got it.
[2013-08-12 14:36:30 -0400] MoonMan: I'm trying to run "knife node list" to list my node to confirm it is bootstrapped. It is telling me "WARNING: No knife configuration file found". I'm running the command from my /etc/chef directory, which contains client.rb. Any reason why it wouldn't be working?
[2013-08-12 14:36:45 -0400] MoonMan: This is all on the target, node machine, mind you.
[2013-08-12 14:37:12 -0400] nicgrayson: MoonMan: so you are sshed to the node and trying to run knife commands?
[2013-08-12 14:37:46 -0400] MoonMan: No, I am running it from the target machine from the terminal. Should I ssh into it as root first?
[2013-08-12 14:38:26 -0400] nicgrayson: i'm not sure what you mean by 'from the target machine'
[2013-08-12 14:38:49 -0400] nicgrayson: just run knife node list or knife status from your workstation
[2013-08-12 14:38:59 -0400] MoonMan: Sorry. The machine that runs the client installation. The node machine.
[2013-08-12 14:39:18 -0400] MoonMan: nicgrayson: Okay, I'll try it from my workstation.
[2013-08-12 14:39:36 -0400] nicgrayson: yeah knife is for command run on your workstation not on the node
[2013-08-12 14:39:43 -0400] nicgrayson: command*
[2013-08-12 14:40:27 -0400] MoonMan: nicgrayson; So to clarify, do you mean to run it on the workstation, or run it on the node from the workstation via ssh? Would root be necessary?
[2013-08-12 14:42:06 -0400] nicgrayson: MoonMan:  knife is a way to communicate from your workstation to the chef-server, it doesn't involve the node
[2013-08-12 14:42:46 -0400] MoonMan: nicgrayson: Good thinking. I ran it from my workstation and it successfully listed the node that I just bootstrapped.
[2013-08-12 14:42:56 -0400] nicgrayson: MoonMan: yay new nodes!
[2013-08-12 14:43:00 -0400] MoonMan: Thanks for the help man.
[2013-08-12 14:43:07 -0400] nicgrayson: np happy cooking
[2013-08-12 14:44:36 -0400] MoonMan: Another quick question; I'm trying to download full config files from version control and put them into their correct place on the system. Would the file or remote_file resource be better for my use?
[2013-08-12 14:44:56 -0400] tek0: any suggestions about where to put bootstrap templates?
[2013-08-12 14:45:59 -0400] nicgrayson: MoonMan: i'm not sure what you mean. you might want to use knife download
[2013-08-12 14:46:39 -0400] nicgrayson: MoonMan: that downloads things like data bags and environments for you to store in VCS
[2013-08-12 14:47:04 -0400] MoonMan: Well for my application I'm using chef solely to pull .conf files from version control and move them to their respective locations on the server. I'm thinking of using remote_file, since it seems like it's tailored to the task, but people have been suggesting file, so I'm not quite sure which one would be more appropriate.
[2013-08-12 14:48:57 -0400] nicgrayson: if you want to download it from a public source not in or cookbook you will need to use remote file
[2013-08-12 14:49:15 -0400] nicgrayson: file is for stuff in cookbook-name/files/<filename>
[2013-08-12 14:49:26 -0400] MoonMan: It's from a git repository running on beanstalk. Would that be considered public or private?
[2013-08-12 14:49:58 -0400] MoonMan: I can get a public URL to the repo, but I'm not entirely sure how to specify individual files.
[2013-08-12 14:50:01 -0400] cpuguy83: MoonMan: by "public" he means behind a web/ftp server
[2013-08-12 14:50:25 -0400] MoonMan: cpuguy83: I see. So by repository would be considered private?
[2013-08-12 14:50:29 -0400] cpuguy83: So the file resource is for files you are keeping inside your cookbook.  Remote file is for grabbing a file from another server
[2013-08-12 14:51:19 -0400] MoonMan: cpuguy83: That makes sense. Remote_file is is.
[2013-08-12 14:53:26 -0400] zts: cpuguy83: actually, cookbook_file is for files you are keeping inside your cookbook - file's mostly good for asserting ownership/permissions, but you can pass in the content as a string
[2013-08-12 14:53:39 -0400] cpuguy83: zts: I stand corrected
[2013-08-12 14:53:56 -0400] zts: cpuguy83: it's a bit of a mess (in my opinion)
[2013-08-12 14:54:03 -0400] cpuguy83: Definitely right, file is for managing files on your server, cookbook_file is for handling files in your cookbook that you want on the server
[2013-08-12 14:54:29 -0400] cpuguy83: Would be nice if the file resource could specify a source, :cookbook, :ftp, etc.
[2013-08-12 14:54:41 -0400] nicgrayson: i tend to just use templates for everything
[2013-08-12 14:55:46 -0400] cpuguy83: nicgrayson: templates are good for config files.  I'm working on a strongswan package which has a custom built deb installer, so that's in my file
[2013-08-12 14:56:31 -0400] nicgrayson: cpuguy83: i just think that setting up files to be modified in the future is a good idea
[2013-08-12 14:56:45 -0400] nicgrayson: less refactor work
[2013-08-12 14:59:29 -0400] halfamind: If my deploy resource specifies a non-root user, can I have the "restart_command" executed by root? (I need it to perform a `monit restart `.)
[2013-08-12 15:00:20 -0400] willejs: is anyone using pychef with hosted chef?
[2013-08-12 15:00:51 -0400] willejs: i want to delete a node and the client too, but I'm getting strange errors when calling .delete() on the client or node
[2013-08-12 15:02:32 -0400] jmartin: willejs: can you gist the errors? also coderanger may be able to help if around
[2013-08-12 15:03:02 -0400] willejs: jmartin: http://pastebin.com/tJy5eaER
[2013-08-12 15:03:14 -0400] willejs: i pm'd code ranger, think he's afk
[2013-08-12 15:06:28 -0400] adamjk-dev: do people just grab cookbooks via a Berksfile off of opscode's site? or do you point to the github location and the reference?
[2013-08-12 15:06:34 -0400] adamjk-dev: I noticed that v 1.6.0 of apache2 cookbook grabbed from opscode site does not have a test/ folder, whereas if you get from the github site you ge tit
[2013-08-12 15:07:06 -0400] adamjk-dev: anyone have thoughts on the cookbooks available from opscode's site vs. grabbing from github directly?
[2013-08-12 15:07:37 -0400] cpuguy83: adamjk-dev: It's whatever you need
[2013-08-12 15:08:00 -0400] volker-: adamjk-dev: not grapping them blindly from anywhere. If things change, you might run into issues. Always use tested versions for production.
[2013-08-12 15:08:07 -0400] cpuguy83: adamjk-dev: The gihub version may have commits that have not been updated on the cookbook site.  Generally, the GH version may be unstable.
[2013-08-12 15:08:51 -0400] cpuguy83: If you link it to a Github version, make sure to specify a commit hash
[2013-08-12 15:09:33 -0400] djstunami: Is there a setting I can use for the chef-client first run that will allow it to delete/overwrite an existing node with the same name from the OO chef server?
[2013-08-12 15:09:36 -0400] djstunami: I have a situation where a node may be rebuilt multiple times in a row and deleting both the node & the client from the chef-server is labor intensive.
[2013-08-12 15:09:56 -0400] adamjk-dev: thanks guys
[2013-08-12 15:09:59 -0400] adamjk-dev: i get those poitns
[2013-08-12 15:10:04 -0400] adamjk-dev: im just saying there was a difference
[2013-08-12 15:10:08 -0400] volker-: djstunami: copying the keys from the node from /etc/chef
[2013-08-12 15:10:11 -0400] adamjk-dev: for 1.6.0 apache2 from opscode's site
[2013-08-12 15:10:20 -0400] adamjk-dev: vs. grabbing that commit point (1.6.0) from the github location
[2013-08-12 15:10:28 -0400] adamjk-dev: almost as if opscode stripped out the test/ folder
[2013-08-12 15:11:11 -0400] djstunami: volker- You're saying from the previous build?  We're using Cobbler so that isn't really an option (I don't think)
[2013-08-12 15:11:27 -0400] adamjk-dev: cookbook "apache2", "= 1.6.0", :git => "https://github.com/opscode-cookbooks/apache2.git", :ref => "38317698785632a6053daffdb23f3bc938a892c3" cookbook "apache2", "= 1.6.0"
[2013-08-12 15:11:28 -0400] volker-: djstunami: dunno then.
[2013-08-12 15:11:36 -0400] adamjk-dev: those 2 cookbooks differ
[2013-08-12 15:11:41 -0400] adamjk-dev: and I would expect them to be the same
[2013-08-12 15:11:56 -0400] adamjk-dev: as I would think opscode would mark apache2 1.6.0 based off of the commit point on the github repo for 1.6.0
[2013-08-12 15:16:22 -0400] jbz: Yeah there's no way to overwrite a node record with the same name but different keys
[2013-08-12 15:16:24 -0400] jbz: security
[2013-08-12 15:16:36 -0400] jbz: (without first removing it on the server with appropriate privs)
[2013-08-12 15:17:07 -0400] jbz: hm maybe we should append firstboot time/date string to nodenames
[2013-08-12 15:25:59 -0400] volker-: is there a way to make chef-solo runs more quiet. Seems like vagrant is filtering it and on normal nodes it is noisy
[2013-08-12 15:27:03 -0400] jtimberman: adamjk-dev: Cookbooks we publish on the community site are the "tested and released" versions. The GitHub repository has: test artifacts that aren't required for end-users to *use* the cookbook, and possibly has changes that haven't been tested, just merged.
[2013-08-12 15:27:51 -0400] jtimberman: adamjk-dev: unfortunately when uploading to the community site it strips out the directories that aren't components that the chef client cookbook loader uses :-|
[2013-08-12 15:30:30 -0400] jtimberman: ticket for adding the ability to share other directories on the community site: http://tickets.opscode.com/browse/CHEF-2776
[2013-08-12 15:31:02 -0400] gchristensen: jtimberman: speaking of which, I made some modifications to the nagios cookbook, is this something worth core, or do you think its unlikely it would get included? https://github.com/zippykid/nagios/compare/opscode-cookbooks:master...additional-contact-members
[2013-08-12 15:32:16 -0400] adamjk-dev: jtimberman: Ah, I see
[2013-08-12 15:32:30 -0400] adamjk-dev: jtimberman: thanks for the clarification.... I just worry that test code doesn't make it there
[2013-08-12 15:32:42 -0400] mattray: anyone using 'synced_folders' with test-kitchen?
[2013-08-12 15:32:59 -0400] adamjk-dev: jtimberman: Are there any thoughts on changing that perhaps? just seems like the Opscode site could lose some information that is useful for the end user
[2013-08-12 15:33:07 -0400] mattray: I'm having trouble getting it to work and just looking for an example (Vagrant plugin)
[2013-08-12 15:36:48 -0400] adamjk-dev: jtimberman: oh, I am sorry I did not see your next comment... so there is a ticket on the issue
[2013-08-12 15:40:51 -0400] adamjk-dev: mattray: hehe, still at it huh? fun with the kitchen
[2013-08-12 15:41:23 -0400] mattray: adamjk-dev: I took a break to update the pxe_dust cookbook yesterday and do a big professional services write-up
[2013-08-12 15:41:39 -0400] mattray: but apt is working, now adding tests for pxe_dust and looking for speedups
[2013-08-12 15:42:25 -0400] adamjk-dev: mattray: nice work sir, yeah I got some good stuff added to the Jenkins cookbook..... contemplating adding it to the opscode cookbook
[2013-08-12 15:42:30 -0400] adamjk-dev: mattray: but easier said than done
[2013-08-12 15:43:03 -0400] mattray: I figure if I can get synced_folders working, I won't have re-downloads of the chef-client and all the apt packages over and over again
[2013-08-12 15:43:18 -0400] mattray: it works with my Vagrantfile, just trying to convert that to .kitchen.yml
[2013-08-12 15:43:44 -0400] adamjk-dev: mattray: oh right right.... yeah good point
[2013-08-12 15:44:01 -0400] adamjk-dev: mattray: yeah it is tough to find some matches for things in Vagrantfile in kitchen.yml
[2013-08-12 15:44:13 -0400] adamjk-dev: mattray: I still haven't found a complete set of available options for a kitchen.yml
[2013-08-12 15:44:36 -0400] mattray: I promise to send a docs PR to kitchen-vagrant because it has nothing useful and may be wrong
[2013-08-12 15:46:50 -0400] adamjk-dev: mattray: you are a better man than I :).... I will get on contributing soon... just new to it all
[2013-08-12 15:47:05 -0400] mwhooker: hello all. I've got two different cookbooks. basically one is an app and the other is a DB. I want to build a vagrantfile which will run both cookbooks. The trick is I want the app cookbook to compile only after the db has fully started (because the app gets config out of the DB). Any advice?
[2013-08-12 15:47:37 -0400] mwhooker: Also I don't want to couple the two too tightly together, because in production they will be on separate machines
[2013-08-12 15:47:47 -0400] mwhooker: so a little shim used only for vagrant would be ideal
[2013-08-12 15:49:06 -0400] digitaladept: use knife to edit the node, launch it with the first cookbook in role, and then do node edit and add the second role to it once its up, that way can be reproduced in live also
[2013-08-12 15:49:06 -0400] adamjk-dev: jtimberman: thanks, I added a comment to the opscode ticket
[2013-08-12 15:49:24 -0400] adnichols: mwhooker is relying on order of operation in Vagrant not sufficient?
[2013-08-12 15:49:55 -0400] mwhooker: adnichols not totally familiar with that order of operation guarantees vagrant provides
[2013-08-12 15:50:49 -0400] adnichols: mwhooker not really a guarantee - but it'll run one recipe before the other under most circumstances.
[2013-08-12 15:51:07 -0400] mwhooker: basically the problem is that the second cookbook requires that the service from the first be fully up and running before compile time
[2013-08-12 15:52:09 -0400] adnichols: mwhooker ah, I am not sure how to resovle that then as compile should happen for all cookbooks before any of them complete
[2013-08-12 15:52:29 -0400] mwhooker: maybe I can take some inspiration from https://github.com/opscode-cookbooks/build-essential/blob/master/recipes/debian.rb#L30
[2013-08-12 15:53:15 -0400] adnichols: mwhooker maybe, that assures that dependencies are installed and available to other cookbooks but I'm not sure if it'll solve your problem
[2013-08-12 15:53:20 -0400] mwhooker: really what I want is for this bit of code that calls out to the database not be run at compile time
[2013-08-12 15:53:22 -0400] jtimberman: gchristensen: dunno :). open a ticket and PR, maybe post on the mailing list about it?
[2013-08-12 15:53:40 -0400] gchristensen: jtimberman: if I submitted that code in a PR, is there anything horrendous about it?
[2013-08-12 15:53:55 -0400] mattray: adamjk-dev: oh looky here: https://github.com/fgrehm/vagrant-cachier
[2013-08-12 15:54:05 -0400] mwhooker: I could use a ruby_block but I don't know how to communicate the result
[2013-08-12 15:55:18 -0400] adamjk-dev: mattray: interesting......
[2013-08-12 15:55:48 -0400] mattray: hmm maybe I'll wait for post 1.0 like the kitchen-vagrant PR comment says
[2013-08-12 15:55:55 -0400] mattray: https://github.com/opscode/kitchen-vagrant/issues/26
[2013-08-12 15:56:53 -0400] adamjk-dev: mattray: ah nice, not a bad idea
[2013-08-12 15:59:47 -0400] adnichols: mwhooker not sure, if you find a solution I'm interested in what it is. I've struggled with communicating/changing configurations based on the results of a run (to be used during the same run) and have used some dirty workarounds like writing to the filesystem - there must be a better way
[2013-08-12 16:00:58 -0400] mwhooker: adnichols I think I got it. just moved the configuration into a ruby_block and set some inane node attribute
[2013-08-12 16:01:28 -0400] mwhooker: the whole compile time/run time system is sort of confusing
[2013-08-12 16:01:57 -0400] adnichols: it clarifies for me when I read a bunch about it and then I don't have to worry about it for a month and forget the details
[2013-08-12 16:02:02 -0400] mwhooker: lol
[2013-08-12 16:03:46 -0400] mwhooker: would be awesome if resource parameters optionally took a block
[2013-08-12 16:04:38 -0400] adnichols: I suspect that block would then have to run at compile time - same as just putting ruby in the recipe (I think)
[2013-08-12 16:04:59 -0400] mwhooker: if my fix works I'll show you the diff
[2013-08-12 16:05:03 -0400] adnichols: k
[2013-08-12 16:12:22 -0400] joefitzgerald: what's the best way to check some condition (e.g. is package 'xyz' installed?) and then conditionally execute some other series of commands (e.g. extract iso, process file template) only if the condition is false?
[2013-08-12 16:12:43 -0400] joefitzgerald: should i use only_if on each element, or is there a way to wrap a set of commands in a guard ?
[2013-08-12 16:13:49 -0400] yfeldblum: joefitzgerald, you should use only_if in each resource, so that each resource, as declared by itself, may be idempotent
[2013-08-12 16:14:43 -0400] joefitzgerald: yfeldblum: so what can i run to check the package such that the only_if will work?
[2013-08-12 16:14:57 -0400] yfeldblum: joefitzgerald, there may be a way to wrap a set of resources in a common only_if guard using some fun ruby magic, but i wouldn't necessarily suggest trying to do it
[2013-08-12 16:15:03 -0400] jtimberman: gchristensen: the 'pagerduty' attribute should just go into the 'server.rb' attribute file.
[2013-08-12 16:15:27 -0400] jtimberman: there's very little reason to have attributes sprawl across several files since they're all going to get loaded by CookbookLoader when chef client runs.
[2013-08-12 16:16:01 -0400] yfeldblum: joefitzgerald, http://www.cyberciti.biz/faq/find-out-if-package-is-installed-in-linux/
[2013-08-12 16:16:05 -0400] jtimberman: the main reason to have separate files is when there are distinctive purposes for doing so such as "all the things that are client only" or "all the things that are server only" :)
[2013-08-12 16:16:33 -0400] joefitzgerald: hmm i'm unfortunately working in windows so i'm guessing i'll need to search the registry
[2013-08-12 16:16:58 -0400] mwhooker: adnichols https://gist.github.com/mwhooker/798bcdb9d14026f2b36b
[2013-08-12 16:17:17 -0400] mwhooker: I hate it though
[2013-08-12 16:17:20 -0400] yfeldblum: joefitzgerald, in that case, i would write a ruby method in a library in your cookbook that takes a package name and checks whether it is installed, and call that method from the block passed to your guard
[2013-08-12 16:17:33 -0400] joefitzgerald: yfeldblum: thanks, makes sense
[2013-08-12 16:17:46 -0400] jtimberman: joefitzgerald: what is the purpose of looking for a particular package? did it get there from a recipe you put on the node, or is it from a base image? I'd use information about the node to make decisions in recipes about the state the node should be in, rather than inspecting the state to make decisions, since the state may be lying to you.
[2013-08-12 16:17:48 -0400] yfeldblum: joefitzgerald, `only_if { MyCookbook::PackageChecker.package_installed?("xyz") }`
[2013-08-12 16:18:08 -0400] adnichols: mwhooker in this scenario is zk the "database"?
[2013-08-12 16:18:12 -0400] jtimberman: e.g., if someone installs the package manually on the node (for some reason, doesn't matter), then you're getting other things configured based on a false positive.
[2013-08-12 16:18:14 -0400] mwhooker: adnichols yes
[2013-08-12 16:18:28 -0400] joefitzgerald: jtimberman: the stuff *is* being installed by me
[2013-08-12 16:18:30 -0400] adnichols: mwhooker so this works if zk isn't up and running when you start the run (eg when the compile occurs)?
[2013-08-12 16:18:30 -0400] mwhooker: cf https://github.com/SimpleFinance/chef-zookeeper
[2013-08-12 16:18:34 -0400] joefitzgerald: (visual studio 2012 + vs2012 update 3)
[2013-08-12 16:18:38 -0400] jtimberman: joefitzgerald: in a recipe?
[2013-08-12 16:18:45 -0400] joefitzgerald: i want to guard against extracting the ISO unnecessarily
[2013-08-12 16:18:45 -0400] joefitzgerald: yep
[2013-08-12 16:18:52 -0400] mwhooker: adnichols yeah. the recipe I linked blocks until it's ready to accept connections
[2013-08-12 16:19:09 -0400] joefitzgerald: https://github.com/joefitzgerald/visualstudio/blob/master/recipes/install.rb#L50
[2013-08-12 16:19:18 -0400] jtimberman: i'd look for a file that only comes from that installation to exist. :)
[2013-08-12 16:19:25 -0400] joefitzgerald: now checking the windows registry is a perfect way to ensure idempotence
[2013-08-12 16:20:45 -0400] asharp: cookbook-a depends on cookbook-b, and it has this listed in its metadata.rb, as well as its Berksfile. cookbook-b is located on github, and cookbook-a's Berksfile notes this. however, cookbook-b's location could change, so i'd rather only define it in one place: cookbook-a's Berksfile. that means that if i write cookbook-c, knowing i need cookbook-a, and i put cookbook-a in cookbook-c's Berksfile, berks install on cookbook-c's Berksfile will not know where to ge
[2013-08-12 16:20:55 -0400] joefitzgerald: there is always a key created in HKLM\System\CurrentControlSet\Services (http://support.microsoft.com/kb/103000)
[2013-08-12 16:21:02 -0400] joefitzgerald: and it's always unique to the MSI
[2013-08-12 16:21:08 -0400] joefitzgerald: its existence means the MSI is installed
[2013-08-12 16:21:15 -0400] joefitzgerald: it's lack of existence means the MSI is not installed
[2013-08-12 16:21:53 -0400] adnichols: asharp elementary school word problem nightmares successfully triggered
[2013-08-12 16:22:00 -0400] asharp: adnichols: sorry
[2013-08-12 16:22:03 -0400] adnichols: :)
[2013-08-12 16:22:06 -0400] fedgoat: how do i add recipes to a roles run_list
[2013-08-12 16:22:23 -0400] asharp: basically i want berks install to recursively grab dependencies
[2013-08-12 16:22:41 -0400] asharp: otherwise i have to define cookbook locations in multiple berksfiles
[2013-08-12 16:23:22 -0400] jtimberman: joefitzgerald: there ya go :)
[2013-08-12 16:23:24 -0400] joefitzgerald: jtimberman: sorry wrong key quoted but the point still stands
[2013-08-12 16:23:38 -0400] joefitzgerald: could i just use Registry.key_exists?('HKLM\<pathtomykey') ?
[2013-08-12 16:24:15 -0400] jtimberman: joefitzgerald: the thing to be careful about here is that you're only doing this kind of thing to prevent execution of some kind of expensive or unnecessary operation, not to inform decisions about e.g. other resoruces to configure :)
[2013-08-12 16:24:35 -0400] jtimberman: like, "oh this package is installed, i need to drop off this configuration file and start this service/process/daemon/task"
[2013-08-12 16:24:38 -0400] joefitzgerald: jtimberman: yep, extracting a 3gb ISO qualifies i think
[2013-08-12 16:24:43 -0400] jtimberman: definitely ;)
[2013-08-12 16:24:54 -0400] adnichols: asharp I think as long as all dependencies are in metadata.rb then it should get them recursively
[2013-08-12 16:24:58 -0400] joefitzgerald: ok, thanks!
[2013-08-12 16:25:16 -0400] asharp: adnichols: does metadata.rb support github locations?
[2013-08-12 16:25:21 -0400] asharp: i dont remember seeing that in documentation
[2013-08-12 16:25:37 -0400] cpuguy83: asharp: It does not, use Berkshelf for that
[2013-08-12 16:25:42 -0400] adnichols: asharp it doesn't care - it expects the cookbook to be there, berkshelf takes care of that
[2013-08-12 16:26:18 -0400] asharp: this is definitely a problem with berkshelf then
[2013-08-12 16:26:26 -0400] adnichols: but berkshelf relies on metadata.rb to know what to pull down
[2013-08-12 16:26:30 -0400] asharp: cuz if i have a berksfile that points to one cookbook, it can grab that cookbook
[2013-08-12 16:26:41 -0400] asharp: but if that cookbook has a berksfile, berkshelf totally ignores its berksfile
[2013-08-12 16:26:58 -0400] asharp: berkshelf will look at its metadata.rb but it wont look at berksfiles i swear
[2013-08-12 16:27:02 -0400] jtimberman: fwiw, metadata.rb is translated to JSON.
[2013-08-12 16:27:16 -0400] zts: asharp: indeed, see https://github.com/RiotGames/berkshelf/pull/304
[2013-08-12 16:27:48 -0400] asharp: zts: thanks
[2013-08-12 16:27:55 -0400] asharp: i guess i'll have to work around that
[2013-08-12 16:27:57 -0400] zts: asharp: long PR, but the discussion is worthwhile
[2013-08-12 16:28:23 -0400] cpuguy83: To be honest, metadata.rb should have the feature to specify a cookbook location.
[2013-08-12 16:28:23 -0400] asharp: from my point of view it seems pretty obvious. metadata.rb doesn't provide the required functionality
[2013-08-12 16:28:28 -0400] asharp: that would fix it
[2013-08-12 16:28:51 -0400] cpuguy83: Or just integrate Berkshelf into chef and use Berkshelf to manage dependancies.
[2013-08-12 16:29:23 -0400] cpuguy83: Should be no different than using Bundler to manage gem depends
[2013-08-12 16:29:33 -0400] asharp: maybe one day
[2013-08-12 16:29:49 -0400] ZacharyBlank: I continually get a file not found on my node for a data bag.
[2013-08-12 16:29:57 -0400] ZacharyBlank: Can someone help me?
[2013-08-12 16:30:35 -0400] ZacharyBlank: I have the encrypted data bag created etc. then am referencing it from a recipe
[2013-08-12 16:30:54 -0400] ZacharyBlank: node is looking for it here: /etc/chef/encrypted_data_bag_secret
[2013-08-12 16:30:56 -0400] adnichols: ZacharyBlank is your file not found error complaining about not finding the secret key file?
[2013-08-12 16:31:07 -0400] ZacharyBlank: on the node it is not there
[2013-08-12 16:31:09 -0400] adnichols: ZacharyBlank you have to place that file on your node w/ your secret key in it
[2013-08-12 16:31:19 -0400] ZacharyBlank: the error is: No such file or directory - file not found '/etc/chef/encrypted_data_bag_secret'
[2013-08-12 16:31:34 -0400] yfeldblum: metadata.rb should *not* specify cookbook location
[2013-08-12 16:31:34 -0400] ZacharyBlank: Is there a separate recipe for that?
[2013-08-12 16:31:52 -0400] adnichols: ZacharyBlank no, you typically do not have your key checked into your chef repository
[2013-08-12 16:32:03 -0400] yfeldblum: the whole point is that needs to be controllable by the chef-repo
[2013-08-12 16:32:26 -0400] ZacharyBlank: adnichols: What are you suggesting I do?
[2013-08-12 16:33:02 -0400] adnichols: ZacharyBlank some folks put that file in place during a host bootstrap phase (knife bootstrap can do it) or you put it on there manually - there are probably other approaches
[2013-08-12 16:33:37 -0400] adnichols: the idea is you want to do it over a secure channel & not have it in some public place, nor stored alongside the encrypted data you are trying to protect
[2013-08-12 16:56:39 -0400] MoonMan: Hi. I'm writing a quick chef recipe to move a file from a remote database to a local directory on one of my nodes. Could I get someone to look it over and let me know if there are any oversights that I made or any syntax problems. Much thanks. http://pastebin.com/78QmNiZk
[2013-08-12 16:57:22 -0400] MoonMan: Also, is it possible to run a recipe by it's self or does it have to be contained in a cookbook?
[2013-08-12 16:57:41 -0400] alexbst: you can include a recipe directly
[2013-08-12 16:57:44 -0400] jtimberman: MoonMan: you can use 'chef-apply' in chef 11 to run a single recipe file.
[2013-08-12 16:57:57 -0400] jtimberman: MoonMan: but you lose a lot of functionality
[2013-08-12 16:57:59 -0400] MoonMan: jtimberman: That would be run from the workstation?
[2013-08-12 16:58:22 -0400] MoonMan: Do you anticipate any functionality loss for my recipe? I'm just testing it out for the first time.
[2013-08-12 16:58:28 -0400] atomic-penguin: MoonMan, ~/interfaces may not expand to what you expect, and probably /root/interfaces
[2013-08-12 16:58:37 -0400] jtimberman: MoonMan: chef-apply is useful as a testing/experimentation thing for a simple use case or proof of concept. if you want to actually manage a node w/ chef, put the recipe in a cookbook
[2013-08-12 16:58:40 -0400] MoonMan: atomic-penguin: Thank you, good tip. I'll change that.
[2013-08-12 16:58:42 -0400] jtimberman: and use chef-solo or chef-client
[2013-08-12 16:58:53 -0400] MoonMan: So everything else looks okay in my recipe?
[2013-08-12 16:59:01 -0400] MoonMan: It's all hand coded, might be an error or two.
[2013-08-12 17:02:20 -0400] MoonMan: So can someone tell me how to run a recipe using 'chef-apply'?
[2013-08-12 17:02:29 -0400] MoonMan: Do I have to specify the node?
[2013-08-12 17:09:17 -0400] aramus__: Hello, would anyone know if you can use 'and' in a resource conditional?
[2013-08-12 17:16:51 -0400] troyready: MoonMan, I haven't done it, but I believe you would run it on the node in question, like 'sudo chef-apply /var/myrecipe.rb'
[2013-08-12 17:17:16 -0400] MoonMan: troyready:  Yep, I figured it out. That is how it's applied.
[2013-08-12 17:20:02 -0400] mattray: adamjk-dev: fwiw, I solved my problem earlier. docs said a hash, code said an array
[2013-08-12 17:21:24 -0400] MoonMan: How should I specify the file path of a file in a version controlled Git repository?
[2013-08-12 17:21:48 -0400] adamjk-dev: mattray: oh haha.... it happens.... good stuff. thanks
[2013-08-12 17:21:55 -0400] MoonMan: I've been doing ~/<branch>/file, it's not working.
[2013-08-12 17:22:49 -0400] MoonMan: I tried /root/branch/<file> as well. Didn't work.
[2013-08-12 17:27:35 -0400] mattray: adamjk-dev: https://github.com/opscode/kitchen-vagrant/pull/36
[2013-08-12 17:28:42 -0400] adamjk-dev: mattray: nice
[2013-08-12 17:29:19 -0400] adamjk-dev: mattray: something i was struggling with for test-kitchen was.... having machines depend on others.... much like a master slave combo
[2013-08-12 17:29:34 -0400] mattray: I imagine I'll get to that yak soon
[2013-08-12 17:29:42 -0400] adamjk-dev: mattray: like having a jenkins master (jenkins::server) and a jenkins slave (jenkins::node_jnlp)
[2013-08-12 17:29:43 -0400] mattray: I just started using vagrant last week
[2013-08-12 17:29:55 -0400] adamjk-dev: mattray: yeah I have been using vagrant a lot, but new to test-kitchen
[2013-08-12 17:30:08 -0400] mattray: I avoided it forever out of laziness
[2013-08-12 17:30:11 -0400] adamjk-dev: i had to do some weirdness to get kitchen to perform how I wanted with master slave scenarios
[2013-08-12 17:30:13 -0400] mattray: so last week was vagrant + tk
[2013-08-12 17:30:14 -0400] adamjk-dev: hehe
[2013-08-12 17:30:21 -0400] adamjk-dev: yah
[2013-08-12 17:30:32 -0400] adamjk-dev: im trying to enforce our internal cookbook testing stuff here
[2013-08-12 17:30:35 -0400] adamjk-dev: so need to learn it all
[2013-08-12 17:30:46 -0400] adamjk-dev: and test-kitchen just was weird with suites and platforms
[2013-08-12 17:30:58 -0400] adamjk-dev: and like i said, having a master and slave who depends on the master being up while testing
[2013-08-12 17:31:12 -0400] adamjk-dev: test-kitchen only seems to have the notion of single machine testing at the moment
[2013-08-12 17:31:28 -0400] adamjk-dev: so i told it to bring up two instances and not destroy until I was done testing the second machine
[2013-08-12 17:32:11 -0400] gchristensen: jtimberman: Got it, I'll fix my PR. is this ticket in the correct statuses? I'm never entirely sure: http://tickets.opscode.com/browse/COOK-3440
[2013-08-12 17:32:13 -0400] adamjk-dev: and it was weird with suites.... I had two platforms. 1 - jenkins server (jenkins::server), 2- jenkins-slave (jenkins::node_jnlp) and a suite, 1- minitest-handler
[2013-08-12 17:32:26 -0400] adamjk-dev: and when I tried to use that suite across both platforms it acted weird
[2013-08-12 17:32:28 -0400] adamjk-dev: i dunno
[2013-08-12 17:32:34 -0400] adamjk-dev: still in development I guess
[2013-08-12 17:33:52 -0400] adamjk-dev: sorry for channel spam...
[2013-08-12 17:35:18 -0400] jtimberman: gchristensen: yup, "Fix PRovided" is correct when theres a PR ready for review.
[2013-08-12 17:36:36 -0400] gchristensen: jtimberman: the part that loses me is the "Reopen" button
[2013-08-12 17:47:36 -0400] Sauraus: I am trying to merge some node attributes with default values in a cookbook that I need to pass to a definition, but for some reason the merged hash never is quiet what I need, anyone have experience with this?
[2013-08-12 17:52:22 -0400] mechanicalduck: hi
[2013-08-12 17:52:27 -0400] mechanicalduck: So what is chef berkshelf?
[2013-08-12 17:52:37 -0400] mechanicalduck: Chef omnibus is for creating a chef runtime, right?
[2013-08-12 17:54:19 -0400] Sauraus: Here is my code for the attribute merge problem: https://gist.github.com/Sauraus/6213282
[2013-08-12 17:55:00 -0400] MoonMan: What's the best way to authenticate into a git repository within a chef directory? I've tried many things, none are working as of yet.
[2013-08-12 17:56:21 -0400] gchristensen: MoonMan: within a chef recipe?
[2013-08-12 17:56:53 -0400] gchristensen: MoonMan: and is it a git repository, or a github repository?
[2013-08-12 17:57:21 -0400] MoonMan: Yes, I'm using the remote_file attribute to pull configuration files from my beanstalk git repository. I have the URL working but I need to set up some sort of username/password authentication within my recipe in order to see and pull the required files.
[2013-08-12 17:57:30 -0400] MoonMan: It's a beanstalk git repository. Not github.
[2013-08-12 17:57:53 -0400] gchristensen: wow... your question is absolutely not what you were asking. you want to authenticate against an HTTP server?
[2013-08-12 17:58:11 -0400] MoonMan: I'm sorry, I'm really new to chef. Yes, that's what I'm looking for.
[2013-08-12 17:58:18 -0400] jds_: Hi
[2013-08-12 17:58:36 -0400] gchristensen: MoonMan: you can do https://username:password@beastalk.com/path/to/file.txt
[2013-08-12 17:58:54 -0400] MoonMan: gchristensen: Thanks, I'll try that and report back.
[2013-08-12 17:58:56 -0400] mechanicalduck: anyone?
[2013-08-12 17:59:12 -0400] gchristensen: mechanicalduck: have you checked out berkshelf.com?
[2013-08-12 17:59:32 -0400] mechanicalduck: yes
[2013-08-12 17:59:33 -0400] atomic-penguin: mechanicalduck, berkshelf is a bundler application to manage cookbook dependencies.  Omnibus is a build system for full-stack Chef binaries/libraries.  Omnibus also sometimes refers to the chef-full package.
[2013-08-12 17:59:34 -0400] mechanicalduck: it doesn't really help me
[2013-08-12 18:00:00 -0400] mechanicalduck: ok, so omnibus will create runtime-like chef installers and berkshelf is something like librarian-puppet then?
[2013-08-12 18:00:07 -0400] gchristensen: ezzactly
[2013-08-12 18:00:23 -0400] chip-: There's also librarian-chef.
[2013-08-12 18:00:28 -0400] chip-: (Which came first!)
[2013-08-12 18:00:45 -0400] gchristensen: it did, but I think berkshelf has outpaced it a bit... IMO
[2013-08-12 18:01:03 -0400] jds_: I'm using the database cookbook, but running into an error on trying to create my database - a LoadError on mysql - https://gist.github.com/jdelStrother/797df70390f9583e5780
[2013-08-12 18:01:17 -0400] jds_: I'm using vagrant + omnibus
[2013-08-12 18:01:19 -0400] mechanicalduck: alright thank you
[2013-08-12 18:01:26 -0400] mechanicalduck: What do you think about puppet?
[2013-08-12 18:01:28 -0400] mechanicalduck: :)
[2013-08-12 18:02:16 -0400] atomic-penguin: mechanicalduck, I used it once upon a time, but couldn't give you a fair opinion on how its progressed since I adopted chef though.
[2013-08-12 18:02:25 -0400] gchristensen: mechanicalduck: use the tools that fit you best, I suppose.
[2013-08-12 18:02:30 -0400] jds_: "/opt/vagrant_ruby/bin/gem list" seems to suggest I have mysql installed, but maybe the ruby/gem used by the database package is different somehow?
[2013-08-12 18:02:42 -0400] atomic-penguin: mechanicalduck, what he said, try 'em both
[2013-08-12 18:03:33 -0400] mechanicalduck: I already got hard times using puppet. Oh, so I will try chef, too.
[2013-08-12 18:03:47 -0400] jds_: Actually...  hmph.  I've used the omnibus install, so I do have Ruby 1.9.3, but the vagrant ruby install that's getting used by gem_package is 1.8.7
[2013-08-12 18:06:15 -0400] atomic-penguin: jds_, it would probably best suit you to have Chef install and manage a separate Ruby stack for applications which require 1.9.3, rather than using the chef-full Ruby environment for Ruby apps.  That way when you upgrade Chef, you don't inadvertently blow away your Ruby application.
[2013-08-12 18:07:58 -0400] jds_: atomic-penguin: That's what omnibus-ruby is for though, right?
[2013-08-12 18:09:39 -0400] atomic-penguin: jds_, if Chef requires a certain gem, there is a chef-gem resource to pull gems into that chef-full jail.  If you want to manage an unrelated Ruby app with Chef, it is probably best to have Chef deploy that application stack separately
[2013-08-12 18:10:17 -0400] jds_: ah, I'll try chef_gem instead of gem_package
[2013-08-12 18:10:40 -0400] jds_: (though I'm surprised the 'database' package doesn't just do that on its own...)
[2013-08-12 18:13:09 -0400] MoonMan: gchristensen: I get this error after I specified the credentials in the ruby file as you recommended.  "ERROR: Server returned error for https://<username>:<pass>@<org_name>.git.beanstalkapp.com/<projectname>-chef.git, retrying 2/5 in 5s"
[2013-08-12 18:13:36 -0400] MoonMan: Credentials are 100% correct.
[2013-08-12 18:13:46 -0400] MoonMan: And the URL is c&p.
[2013-08-12 18:38:20 -0400] mattray: anyone using apache2 with solo/vagrant? I get the weirdest error with the default recipe: https://gist.github.com/mattray/823d6cc921f51be387ef
[2013-08-12 18:39:38 -0400] mattray: that's in the attributes/default
[2013-08-12 18:42:45 -0400] dgarstang: Can anyone recommend a wrapper tool for knife create?
[2013-08-12 18:42:52 -0400] mattray: srlsy wtf. nothing in node['apache'] even when I'm in the recipe with pry
[2013-08-12 18:43:38 -0400] mattray: dgarstang: I'm partial to http://bit.ly/spcwsl
[2013-08-12 18:43:42 -0400] jmartin: mattray: weird, i can give it a whirl real quick though i spose
[2013-08-12 18:43:44 -0400] mattray: spiceweasel
[2013-08-12 18:44:16 -0400] mattray: jmartin: thanks. 11.6, ubuntu 12.04
[2013-08-12 18:45:32 -0400] jmartin: mattray: ill have to put 11.6 into place first :D so might be a second
[2013-08-12 18:45:38 -0400] vigith: in chef client version 'Chef: 11.4.0' .. pkg.class == Mash is not working.. it used to work in 10.x
[2013-08-12 18:46:01 -0400] mattray: vigith: what is pkg?
[2013-08-12 18:46:27 -0400] mattray: vigith: docs.opscode.com/breaking_changes_chef_11.html
[2013-08-12 18:46:44 -0400] vigith: pkg is { "package" : "bar" , "version" : "1.x" }
[2013-08-12 18:47:11 -0400] vigith: ok.. thank you
[2013-08-12 18:48:31 -0400] vigith: mattray: i don't see the Mash stuff in the breaking_changes
[2013-08-12 18:49:06 -0400] mattray: was pkg supposed to be a node?
[2013-08-12 18:49:13 -0400] mattray: node's aren't mashes anymore I think
[2013-08-12 18:50:45 -0400] vigith: ok
[2013-08-12 18:50:58 -0400] btm: @opscode Due to conflicting meetings and vacation schedules; no chef/ohai code review this week. All the others are still on though.
[2013-08-12 18:51:44 -0400] dgarstang: mattray: not clear from docs is spiceweasel is what I need. Lets me spin up instances based on config file rather than really long knife command line?
[2013-08-12 18:51:54 -0400] mattray: dgarstang: yup
[2013-08-12 18:52:03 -0400] mattray: and track and validate everything else
[2013-08-12 18:52:15 -0400] gchristensen: btm: will cookbook reviews be done this week? or no?
[2013-08-12 18:52:28 -0400] dgarstang: mattray: kk, thanks
[2013-08-12 18:53:30 -0400] mattray: dgarstang: not sure if that helps, feel free to ask more questions
[2013-08-12 18:53:30 -0400] joefitzgerald: jtimberman: any idea why a reboot would not occur in this recipe? https://github.com/joefitzgerald/sqlce/blob/master/recipes/default.rb#L31
[2013-08-12 18:53:43 -0400] jmartin: mattray: vagrant is booting now, lets seeeeeee what happens
[2013-08-12 18:54:03 -0400] mattray: jmartin: thanks. I'll go test with vagrant next, using test-kitchen with vagrant
[2013-08-12 18:54:11 -0400] mattray: I'll just keep unrolling layers
[2013-08-12 18:54:39 -0400] mattray: but node['apache'] is pretty dang fundamental
[2013-08-12 18:54:43 -0400] dgarstang: mattray: oh noes. No google cloud support according to docs. :(
[2013-08-12 18:54:56 -0400] jmartin: doh, forgot myself that this bento box is unprovisioned, gotta grab another!
[2013-08-12 18:55:02 -0400] mattray: dgarstang: PRs welcome, really simple to add
[2013-08-12 18:55:05 -0400] jmartin: chef-solo is kind of required
[2013-08-12 18:55:06 -0400] jmartin: heh
[2013-08-12 18:55:20 -0400] dgarstang: mattray: just as soon as I learn ruby.
[2013-08-12 18:55:20 -0400] mattray: yeah, chef-solo + apache2 cookbook seems basic
[2013-08-12 18:56:07 -0400] mattray: dgarstang: open an issue, I'll fix that one since it's an opscode plugin
[2013-08-12 18:56:08 -0400] btm: gchristensen: Yes, all other code reviews are still on.
[2013-08-12 18:56:15 -0400] dgarstang: ... which of course woudln't be an issue if ruby wasn't the ugliest thing since perl. :)
[2013-08-12 18:56:20 -0400] dgarstang: mattray: kk.
[2013-08-12 18:57:44 -0400] dgarstang: Dammit, also looks like knife-whisk doesn't support google.
[2013-08-12 19:00:00 -0400] ohlol: anyone know why my tests are failing? they work manually but not via jenkins for some reason: https://gist.github.com/ohlol/d6a40c3c9d8471d34e61/raw/d0b389cb2e951ca652ae003bef938355e442d663/gistfile1.txt
[2013-08-12 19:00:41 -0400] ohlol: all 3 compare against node["fqdn"] but for some reason it seems to still be the old value
[2013-08-12 19:08:15 -0400] jmartin: mattray: seems to be wonky for me too
[2013-08-12 19:08:27 -0400] mattray: jmartin: thanks!
[2013-08-12 19:08:49 -0400] jmartin: mattray: however, it dies in a different spot for me...
[2013-08-12 19:12:31 -0400] mattray: jmartin: ok if I pull everything out and just call apache2::server in my run list from test-kitchen it works
[2013-08-12 19:12:47 -0400] jmartin: weird
[2013-08-12 19:12:56 -0400] mattray: so now I can start adding layers to find the breakage
[2013-08-12 19:13:01 -0400] jmartin: gotcha
[2013-08-12 19:13:13 -0400] mattray: and this is where yak-shaving happens
[2013-08-12 19:13:17 -0400] jmartin: i think my basebox was old :D it tried to install apache2 and it said DIAF
[2013-08-12 19:14:40 -0400] mattray: jmartin: I'm working here: https://github.com/mattray/pxe_dust-cookbook/tree/COOK-2174
[2013-08-12 19:14:46 -0400] mattray: using opscode baseboxes
[2013-08-12 19:15:27 -0400] jmartin: yeah, i was using the opscode basebox i had in place
[2013-08-12 19:15:34 -0400] jmartin: but apt took a dive immediately
[2013-08-12 19:15:43 -0400] jmartin: with 404s
[2013-08-12 19:17:12 -0400] dgarstang: Trying to use knife-whisk... keep getting "FATAL: security-groups not defined for this config in whisk.yml"
[2013-08-12 19:19:38 -0400] jperry: ohai folks!
[2013-08-12 19:20:00 -0400] jperry: anyone experienced with the opscode vagrant boxes linked on the bento repo readme?
[2013-08-12 19:21:00 -0400] mattray: jperry: I use 'em
[2013-08-12 19:21:34 -0400] jperry: mattray: I am trying to use this one https://opscode-vm-bento.s3.amazonaws.com/vagrant/opscode_centos-5.9_provisionerless.box
[2013-08-12 19:21:54 -0400] jperry: and before I used to use the private network with a cents 5.8 box
[2013-08-12 19:22:09 -0400] jperry: with the opscode vagrant box it is unable to communicate with the outside
[2013-08-12 19:22:27 -0400] jperry: so vagrant-omnibus is unable to install chef
[2013-08-12 19:22:38 -0400] jmartin: jperry: whats your vagrantfile look like?
[2013-08-12 19:22:47 -0400] Sauraus: How do I pass credentials to a cookbook stored in a private repo on GitHub?
[2013-08-12 19:23:24 -0400] gchristensen: Sauraus: like to librarian or berkshelf?
[2013-08-12 19:23:28 -0400] Sauraus: berkshelf
[2013-08-12 19:23:33 -0400] siezer: berks
[2013-08-12 19:23:44 -0400] gchristensen: well the best method is to use SSH keys, and its done automatically
[2013-08-12 19:23:49 -0400] jperry: http://hastebin.com/jilufupose.rb
[2013-08-12 19:24:01 -0400] jperry: mattray: this is some of my vagrant file
[2013-08-12 19:24:28 -0400] jperry: jmartin: see my link above
[2013-08-12 19:24:37 -0400] mattray: jperry: sorry, I'm currently only using debian & ubuntu
[2013-08-12 19:24:46 -0400] mattray: since I'm working on the apt cookbook :/
[2013-08-12 19:25:55 -0400] jmartin: jperry: and the only thing you've changed is the baseboxes?
[2013-08-12 19:25:59 -0400] jmartin: and now it doesnt work?
[2013-08-12 19:26:03 -0400] jperry: correct
[2013-08-12 19:26:23 -0400] jperry: and added the omnibus plugin line
[2013-08-12 19:26:30 -0400] surge_: Has anyone managed to use "chef-rewind" with creating a cookbook file during the compilation phase with run_action ? Specifically, I want to rewind a cookbook_file and then use my own. See here: bryanwb/chef-rewind
[2013-08-12 19:26:44 -0400] surge_: meant to paste this https://github.com/needle-cookbooks/chef-sensu-handler/blob/master/recipes/default.rb#L24 *
[2013-08-12 19:27:10 -0400] jperry: jmartin: if I just spin up that opscode vagrant box without provisioning it, then log into it I am unable to hit the outside
[2013-08-12 19:27:31 -0400] surge_: I can't seem to assign the cookbook_file stanza to a variable and then call run_action because that returns "undefined method `run_action' for [:nothing]:Array"
[2013-08-12 19:27:50 -0400] dgarstang: Trying to use knife-whisk... keep getting "FATAL: security-groups not defined for this config in whisk.yml"
[2013-08-12 19:28:54 -0400] jperry: jmartin: this is the output I get http://hastebin.com/migudisovu.vhdl
[2013-08-12 19:30:10 -0400] jmartin: jperry: weird, from what i can tell your config is fine, i use a simpler version, but it works like a charm for me....is there any IP space conflict between your VM network and the physical network its on?
[2013-08-12 19:30:32 -0400] jperry: I am using a private network for my vms
[2013-08-12 19:30:47 -0400] jperry: so it creates it's own
[2013-08-12 19:31:15 -0400] jperry: hmm, so I just tried the ubuntu on and that worked
[2013-08-12 19:31:22 -0400] jmartin: strange
[2013-08-12 19:32:45 -0400] jmartin: no idea
[2013-08-12 19:33:11 -0400] jmartin: ive never had an issue of that nature with the bento boxes (cent 5.9 or 6.4)
[2013-08-12 19:33:44 -0400] jperry: jmartin: so you are using a private network also?
[2013-08-12 19:35:57 -0400] jmartin: jperry: yes, but not in the sort of setup you have
[2013-08-12 19:36:22 -0400] jperry: I am trying the 32bit cents to see if that one has the same problem
[2013-08-12 19:38:49 -0400] jperry: jmartin: yeah the 32bit cents 5.9 fails with the same message as well
[2013-08-12 19:39:51 -0400] dgarstang: any whiskers?
[2013-08-12 19:40:10 -0400] wookiehangover: how do I create /etc/chef/client.pem when setting up a chef workstation?
[2013-08-12 19:40:21 -0400] wookiehangover: (and I don't want to use the omnibus installer)
[2013-08-12 19:40:48 -0400] nicgrayson: dgarstang: can you file an issue on github for that i'll fix it
[2013-08-12 19:41:26 -0400] nicgrayson: dgarstang: i wrote knife-whisk, we use it for aws so that is always defined for us
[2013-08-12 19:43:57 -0400] dgarstang: nicgrayson: sorry, file ticket for ?
[2013-08-12 19:44:04 -0400] dgarstang: nicgrayson: could be user error...
[2013-08-12 19:44:30 -0400] dgarstang: nicgrayson: or... do you mean google? did I mention that? Whisk doesn't care does it?
[2013-08-12 19:45:02 -0400] nicgrayson: dgarstang:  for the security groups issue
[2013-08-12 19:45:33 -0400] nicgrayson: dgarstang: the google one you opened is not needed, just use provider_config and define your cli_command
[2013-08-12 19:45:59 -0400] dgarstang: nicgrayson: see anything obviously wrong with? http://pastebin.com/Y02dh8Wn
[2013-08-12 19:46:09 -0400] dgarstang: nicgrayson: kk, i'll close that one
[2013-08-12 19:47:30 -0400] nicgrayson: oh there is a typo in the readme
[2013-08-12 19:47:48 -0400] nicgrayson: dgarstang: indent security groups in the aws provider sections
[2013-08-12 19:47:50 -0400] dgarstang: nicgrayson: :-O
[2013-08-12 19:48:33 -0400] bean: indent the defined security groups under "security_groups:"
[2013-08-12 19:48:36 -0400] bean: i believe
[2013-08-12 19:48:40 -0400] dgarstang: nicgrayson: thanks. have progressed to a new error. :)
[2013-08-12 19:48:52 -0400] dgarstang: 'FATAL: infra security group does not exist in whisk.yml'
[2013-08-12 19:49:29 -0400] bean: well, do you have a security group called "infra" defined in your whisk.yml?
[2013-08-12 19:49:49 -0400] jperry: jmartin: thanks for trying to help, not sure what is up
[2013-08-12 19:50:00 -0400] dgarstang: bean: under what section should it be?
[2013-08-12 19:50:28 -0400] bean: i believe in your provider config.
[2013-08-12 19:50:51 -0400] dgarstang: bean: oh i see. the name under servers is a reference to what's in the provider_config
[2013-08-12 19:50:57 -0400] nicgrayson: dgarstang: i would recommend deleting that stuff from the whisk
[2013-08-12 19:51:00 -0400] dgarstang: actually, no.
[2013-08-12 19:51:03 -0400] jperry: julliancdunn: do you have any ideas about what might be going on with the centos-5.9 base box using private network
[2013-08-12 19:51:08 -0400] dgarstang: nicgrayson: which stuff?
[2013-08-12 19:51:40 -0400] jperry: see the conversation jmartin and I were having
[2013-08-12 19:52:59 -0400] dgarstang: bean: can't see where security groups are 'defined', even in examples
[2013-08-12 19:53:28 -0400] dgarstang: wait, wait
[2013-08-12 19:53:42 -0400] suffix_: how can a chef node scp into a chef server?
[2013-08-12 19:53:47 -0400] dgarstang: Woo. got output
[2013-08-12 19:53:53 -0400] bean: suffix_, why would you want to do that
[2013-08-12 19:54:06 -0400] suffix_: bear custom bootstrap
[2013-08-12 19:54:15 -0400] suffix_: is it possible?
[2013-08-12 19:54:19 -0400] suffix_: *bean
[2013-08-12 19:54:42 -0400] bean: what are you meaning by custom bootstrap
[2013-08-12 19:54:46 -0400] bean: as in your own bootstrap template?
[2013-08-12 19:54:51 -0400] rshade98: is there a way to tell when one of the opscode cookbooks change to 11.0 syntax
[2013-08-12 19:55:21 -0400] dgarstang: nicgrayson: Are arbitrary keywords supported in whisk.yml? for example, I can't see anything to set the Name.
[2013-08-12 19:57:07 -0400] dgarstang: *lol* knife whisk is giving me a 'knife ec2 sever create' output
[2013-08-12 19:57:16 -0400] suffix_: bean correct
[2013-08-12 19:57:35 -0400] bean: suffix_, i think you should likely make that available over http
[2013-08-12 19:57:36 -0400] dgarstang: someone is missing an 'r'
[2013-08-12 19:58:30 -0400] suffix_: bean: not possible
[2013-08-12 19:58:32 -0400] bean: suffix_, http://docs.opscode.com/knife_bootstrap.html#custom-templates this is the recommended way
[2013-08-12 19:59:19 -0400] suffix_: ok
[2013-08-12 19:59:57 -0400] bean: dgarstang, ah, yep, another typo in the readme
[2013-08-12 19:59:58 -0400] bean: sec
[2013-08-12 20:00:23 -0400] dgarstang: bean: i think that's a typo on the code, or else someone is a bad speler if that's a typo in the readme.
[2013-08-12 20:00:40 -0400] bean: its a typo in the sample whisk.yml
[2013-08-12 20:00:58 -0400] dgarstang: bean: oh crap.
[2013-08-12 20:03:49 -0400] ismell: ello
[2013-08-12 20:04:16 -0400] bean: dgarstang, the readme should be fixed now
[2013-08-12 20:04:26 -0400] ismell: is there a way to have ark create a virtualenv before it runs setup_py_install ?
[2013-08-12 20:04:36 -0400] dgarstang: bean: kk. any reason to think this will/won't work with google cloud?
[2013-08-12 20:04:59 -0400] bean: dgarstang, it should support arbitrary providers, if it doesn't feel free to open an issue or a pull request.
[2013-08-12 20:05:26 -0400] dgarstang: bean: just don't know how some of the cli options that differ will get set in whisk.yml.
[2013-08-12 20:05:41 -0400] dgarstang: :wq!
[2013-08-12 20:06:02 -0400] btm: --> Cookbook Code Review: https://plus.google.com/hangouts/_/651d34c120312631b3b1d253b78e415e24f171d8
[2013-08-12 20:08:00 -0400] dgarstang: bean: eg, knife google uses -m whereas google ec2 uses -f
[2013-08-12 20:08:13 -0400] zenloop: Hey guys, I want to update a chef users public_key with knife exec but am not sure how to go about it.
[2013-08-12 20:08:41 -0400] bean: dgarstang, pretty sure that it'll just take anything under the mixins: defaults: and turn it into "--image ami-9501283123" etc
[2013-08-12 20:09:07 -0400] dgarstang: bean: that's fine, except google knife requires -m, not -f.
[2013-08-12 20:09:41 -0400] dgarstang: bean: surprised by the statement " You don't have to be aware of all the ins and outs of AWS or whatever cloud " in the readme. Different knife plugins for different providers are going to have different cli options.
[2013-08-12 20:10:04 -0400] nicgrayson: dgarstang: sorry i was in a meeting
[2013-08-12 20:10:12 -0400] dgarstang: nicgrayson: no worries.
[2013-08-12 20:10:22 -0400] dgarstang: nicgrayson: see ^ comment. Am I missing something?
[2013-08-12 20:11:13 -0400] bean: dgarstang, what is the long form of -m
[2013-08-12 20:11:36 -0400] dgarstang: nicgrayson: it's --google-compute-machine
[2013-08-12 20:11:50 -0400] dgarstang: nicgrayson: use the long form as keywords ?
[2013-08-12 20:11:52 -0400] bean: dgarstang, think that was intended for me.
[2013-08-12 20:11:59 -0400] bean: but yeah, i'd use the long form as keywords
[2013-08-12 20:12:04 -0400] nicgrayson: yes use longs for everything
[2013-08-12 20:12:15 -0400] dgarstang: bean/nicgrayson: kk, lemme see.
[2013-08-12 20:12:45 -0400] nicgrayson: dgarstang: the idea behind taht is it's more descriptive and you only have to type it into the whisk file, not each time you make a node
[2013-08-12 20:13:28 -0400] dgarstang: nicgrayson: err... so I did that, and the output shows both google-compute-machine AND image. I don't have an image specified at the server level. I think it's picked up the default...
[2013-08-12 20:14:14 -0400] nicgrayson: can you pastebin or gist your current whisk.yml?
[2013-08-12 20:14:46 -0400] dgarstang: nicgrayson: http://pastebin.com/FZfAy0PG
[2013-08-12 20:15:22 -0400] mattray: jmartin: found it
[2013-08-12 20:15:49 -0400] bean: yep, see how you have mixins: - defaults on your servers?  that's pulling in the defaults
[2013-08-12 20:15:51 -0400] mattray: my pxe_dust_test didn't depend on pxe_dust, so it didn't pull in the pxe_dust dependency of the apache2 cookbook
[2013-08-12 20:16:20 -0400] bean: dgarstang, essentially, remove everything from defaults that you do not use.
[2013-08-12 20:16:53 -0400] dgarstang: bean: gotcha. less use of defaults.
[2013-08-12 20:17:04 -0400] ismell: would there be interest in adding virtualenv support to ark?
[2013-08-12 20:17:04 -0400] nicgrayson: dgarstang: try this https://gist.github.com/nicgrayson/6214719
[2013-08-12 20:17:43 -0400] dgarstang: nicgrayson: futz with the defaults your saying.
[2013-08-12 20:18:04 -0400] nicgrayson: dgarstang: you shouldn't use the example
[2013-08-12 20:18:14 -0400] dgarstang: nicgrayson: Hm.
[2013-08-12 20:18:22 -0400] bean: especially because the example has a lot of aws-specific stuff in it
[2013-08-12 20:18:29 -0400] bean: (if only cuz it was originally written for aws)
[2013-08-12 20:19:11 -0400] jmartin: mattray: aha! nice
[2013-08-12 20:22:12 -0400] dgarstang: nicgrayson: So... if I use the long form for google, and remove defaults, then it will use the google defaults. However, I'm pretty much SOL when it comes to defaults then, right?
[2013-08-12 20:22:35 -0400] dgarstang: nicgrayson: unless there's a way to have one default per provider?
[2013-08-12 20:22:58 -0400] nicgrayson: just make a new mixin for each provider
[2013-08-12 20:23:01 -0400] dgarstang: nicgrayson: Do servers fall back to provider_config before falling back to defaults?
[2013-08-12 20:24:24 -0400] nicgrayson: dgarstang: so it just does a huge merge in order, starting with defaults, then other mixins, then config on a node, then overrides from command line
[2013-08-12 20:26:01 -0400] dgarstang: nicgrayson: k, not really following where provider_config fits in
[2013-08-12 20:27:22 -0400] nicgrayson: dgarstang: only put cli_command in there, i'll make an expample quick
[2013-08-12 20:27:51 -0400] dgarstang: nicgrayson: oook
[2013-08-12 20:29:52 -0400] nicgrayson: dgarstang: https://gist.github.com/nicgrayson/6214719
[2013-08-12 20:30:12 -0400] nicgrayson: so just have any google defaults you want in the google mixin
[2013-08-12 20:30:20 -0400] nicgrayson: you can have a ton of mixins
[2013-08-12 20:30:22 -0400] dgarstang: nicgrayson: roight, thanks. :)
[2013-08-12 20:30:48 -0400] BriGuy: how can I use the subversion resource to compare a file before doing anything, so I can use notifies if different - can only see a way to pull a new copy down
[2013-08-12 20:31:00 -0400] MoonMan: How do I run a single recipe on one of my nodes?
[2013-08-12 20:31:51 -0400] nicgrayson: MoonMan: just make the run list just cookbookname::recipe_name
[2013-08-12 20:32:09 -0400] MoonMan: nicgrayson: Ah I see. So I have to put my recipe in a cookbook?
[2013-08-12 20:32:45 -0400] nicgrayson: MoonMan: yes, all recipes are part of cookbooks
[2013-08-12 20:33:20 -0400] nicgrayson: MoonMan: if you add a cookbook w/o a recipe like "recipe[cookbook-name]" it adds default.rb
[2013-08-12 20:33:45 -0400] MoonMan: Right, that makes sense. So do I need to preface cookbook name::recipe_name with anything? the node name?
[2013-08-12 20:34:17 -0400] jbz: MoonMan:  No, the cookbook is on the server.  The context of what node runs it is which node's runlist you're modifying.
[2013-08-12 20:34:44 -0400] jbz:  MoonMan: Remember, *everything* that happens to nodes in Chef is because a chef-client or other client program *pulled* something.
[2013-08-12 20:38:31 -0400] gansbrest: hi. Is there a way to set a flag in one recipe and check it later in another recipe in chef 11. Something like node.run_state ( but it was replace with run_context ). It would be useful to set a flag to recompile  and check it inside not_if.
[2013-08-12 20:38:50 -0400] jmartin: anyone have an example of adding a second disk in test-kitchen setups w/ vagrant?
[2013-08-12 20:39:03 -0400] gansbrest: I could create a simple file and check that, but I wonder what's right / recommended way of doing this?
[2013-08-12 20:40:43 -0400] joefitzgerald: jtimberman: are you aware of this issue preventing windows reboots from occurring after a notify from a windows_package install? http://tickets.opscode.com/browse/COOK-3060
[2013-08-12 20:40:50 -0400] joefitzgerald: i just reproduced it
[2013-08-12 20:40:55 -0400] joefitzgerald: works in 1.8.10
[2013-08-12 20:41:04 -0400] joefitzgerald: broken in 1.10.0
[2013-08-12 20:41:32 -0400] joefitzgerald: but 1.8.10 doesn't respect the timeout value and always takes 60 seconds
[2013-08-12 20:46:15 -0400] yfeldblum: gansbrest, you can use global variables, or you can try this pattern: http://pastie.org/pastes/8230676/text?key=pvgnt9nr6uubd7qgf1txnq
[2013-08-12 20:47:03 -0400] gansbrest: you mean through the global variable or through the class
[2013-08-12 20:47:05 -0400] basic`: can i upgrade the chef-server by just installing the latest omnibus rpm?
[2013-08-12 20:47:11 -0400] basic`: or will that wipe out everything on the server?
[2013-08-12 20:49:21 -0400] MoonMan: How do I trigger the run list from my workstation?
[2013-08-12 20:55:42 -0400] MoonMan: What's the best way to execute a run list?
[2013-08-12 20:56:00 -0400] joefitzgerald: @jtimberman: this seems to be the issue
[2013-08-12 20:56:01 -0400] joefitzgerald: https://github.com/opscode-cookbooks/windows/blob/4e87d83ae789db7e96de061b70a73173d7ab1f04/providers/reboot.rb
[2013-08-12 20:56:04 -0400] jbz: MoonMan:  The node should have a runlist attribute on the server.  When the client runs, it asks the server to send it the node state, including the run list.
[2013-08-12 20:56:19 -0400] jbz: MoonMan: Sorry, I'm assuming you're using a server or hosted
[2013-08-12 20:56:21 -0400] jbz: not solo
[2013-08-12 20:56:38 -0400] MoonMan: jbz: Yes, my node has a run list in opscode. But I'm wondering how I can trigger chef to go through the run list and run any recipes?
[2013-08-12 20:56:45 -0400] MoonMan: I have my recipe in the runlist
[2013-08-12 20:57:03 -0400] jbz: MoonMan:  Whenever you run the chef-client, it will download the runlist and run it.
[2013-08-12 20:57:11 -0400] jbz: assuming the chef-client can contact the server as normal.
[2013-08-12 20:57:18 -0400] MoonMan: Okay. That should run from the workstation, right?
[2013-08-12 20:57:23 -0400] jbz: MoonMan: No.
[2013-08-12 20:57:26 -0400] justizin: I just started getting 403 Forbidden on a particular node against hosted chef when it tries to save its' state, any ideas why that might happen?
[2013-08-12 20:57:31 -0400] jbz: MoonMan:  chef-client is run *on the node that is to be managed*.
[2013-08-12 20:57:49 -0400] jbz: MoonMan: as root.
[2013-08-12 20:57:55 -0400] MoonMan: Ah I see. I'll try that.
[2013-08-12 20:58:36 -0400] jbz: MoonMan:  Typically, chef-client is set up as a service (or just run in daemon mode) on the node, and contacts the chef server every specified interval+splay seconds to converge.
[2013-08-12 21:03:22 -0400] justizin: oh, i'm rebuilding a box and didn't delete the node, boosh
[2013-08-12 21:11:35 -0400] ohlol: anyone good with test-kitchen? having some weird issues using it with jenkins
[2013-08-12 21:18:50 -0400] cannonball: Hi, I'm trying to figure out why a chef recipe isn't doing what I expected.  It seems that I can't use the not_if statement inside of a case...when...end statement.  The exact error message is "Cannot find a resource for not_if on centos version 5.9".  Am I interpreting this correctly?  I can paste the recipe in a pastebin if necessary.
[2013-08-12 21:21:03 -0400] jbz: cannonball: Paste plz?
[2013-08-12 21:22:42 -0400] cannonball: I think I might have fixed it.  I'll paste what doesn't work and what does work.
[2013-08-12 21:25:03 -0400] cannonball: jbz: https://pastee.org/mw4um
[2013-08-12 21:26:00 -0400] jbz: Cannonball: Yeah, not_if is an attrib of a chef resource
[2013-08-12 21:26:04 -0400] cannonball: It looks like the not_if statement must be inside of some function which has a do..end section.  If I do it at the top of the case...when...end section, I get the error I stated above.
[2013-08-12 21:26:26 -0400] jbz: so it's gotta be declared inside the chef resource stanza (bash resource, in that case)
[2013-08-12 21:26:57 -0400] jbz: (did that make sense?  It's not a general ruby flow operator, it's an attribute for a check done inside the Chef resource object's execution)
[2013-08-12 21:27:01 -0400] cannonball: So bash is a resource, but case/when is not a resource.  This stuff is slowly starting to make sense.
[2013-08-12 21:27:09 -0400] jbz: case/when is a ruby statement
[2013-08-12 21:27:11 -0400] jbz: bash is a Chef resource
[2013-08-12 21:27:19 -0400] cannonball: Clear, thank you.
[2013-08-12 21:27:22 -0400] jbz: Chef cookbooks can contain unmitigated Ruby :-)
[2013-08-12 21:27:56 -0400] cannonball: Being a perl guy, that part is still kind of opaque to me (knowing whether what I am reading is ruby or chef :-) )
[2013-08-12 21:28:57 -0400] jbz: cannonball:  Best thing to do is skim through the resource list in the docs, there aren't *that* many of them
[2013-08-12 21:29:06 -0400] jbz: so you'll recognize them as they're declared with <resource> doend
[2013-08-12 21:29:41 -0400] jbz: cannonball: http://docs.opscode.com/resource.html#chefx-resources
[2013-08-12 21:30:35 -0400] jbz: cannonball:  Also, you'll want to be very clear on execution order - what happens at compile time vs. execution time
[2013-08-12 21:31:31 -0400] jbz: general rule is that ruby code *outside* resources gets evaluated/executed at compile time, i.e. *first*, and stuff *inside* resources (and including ruby_block resources, etc.) gets evaluated/executed at execution time, *later*.  At least, I'm fairly sure that's how it works, and I'm sure I'll be corrected by someone with the correct knowledge if I'm wrong.
[2013-08-12 21:32:37 -0400] cannonball: That sounds good, again thanks.
[2013-08-12 21:34:16 -0400] jbz: most welcome, glad I could help a bit.
[2013-08-12 21:44:57 -0400] cap10morgan: Do folks prefer putting an in-house app's cookbook into a sub directory of the app itself and putting a Berksfile at the root, or creating a separate repo for the app cookbook and put the Berksfile in there?
[2013-08-12 21:48:49 -0400] bean: cap10morgan, i'd never put it in the actual app repo
[2013-08-12 21:49:01 -0400] cap10morgan: bean: why not?
[2013-08-12 21:49:51 -0400] bean: not sure, i've just never even thought that that would be a good idea.
[2013-08-12 21:49:59 -0400] bean: all of our deployables get deployed from nexus.
[2013-08-12 21:51:10 -0400] cap10morgan: bean: I'm thinking it's nice to have everything in the same place. I can make changes, vagrant provision, then berks upload when I'm happy. Rather than jumping between an app repo and a cookbook repo.
[2013-08-12 21:51:48 -0400] bean: but im sure that works well for you :)
[2013-08-12 22:04:32 -0400] dgarstang: whisk got any way to pass node name?
[2013-08-12 22:10:54 -0400] jtimberman: cap10morgan: I think that's a fantastic idea.
[2013-08-12 22:11:20 -0400] dgarstang: weird that whisk doesn't let me set the node name.
[2013-08-12 22:11:34 -0400] bean: dgarstang, what flag is needed for node name?
[2013-08-12 22:11:36 -0400] cap10morgan: jtimberman: cool. we'll give it a try and let you know how it goes. :)
[2013-08-12 22:12:22 -0400] dgarstang: bean: I'm not sure. There's nothing on the help output for whisk...
[2013-08-12 22:12:36 -0400] jtimberman: cap10morgan: the way i see it, is that the application should have everything it needs to deploy, similar to the "deploy" directory that contains capistrano stuff for a rails app.
[2013-08-12 22:12:50 -0400] cap10morgan: jtimberman: yep, agreed.
[2013-08-12 22:12:51 -0400] bean: dgarstang, can't you just set a "node-name" key on the server
[2013-08-12 22:13:03 -0400] jtimberman: cap10morgan: plus it makes it abundantly obvious to someone else where all the things they need to deploy the app are.
[2013-08-12 22:13:13 -0400] dgarstang: bean: the node name really doesn't belong in the yml file... should be able to pass it on command line. if you don't, then knife complains because the syntax is 'knife google server create $NAME ....'
[2013-08-12 22:13:24 -0400] jtimberman: cap10morgan: i'd have a chef-repo in the app, which would have the cookbooks, data_bags, roles, directories :)
[2013-08-12 22:13:43 -0400] cap10morgan: jtimberman: ah, interesting. good idea.
[2013-08-12 22:14:12 -0400] dgarstang: bean: i imagine the same would apply to ec2.
[2013-08-12 22:14:20 -0400] bean: dgarstang, ah... nope.
[2013-08-12 22:14:28 -0400] bean: knife ec2 server create (options)
[2013-08-12 22:14:29 -0400] dgarstang: bean: no?
[2013-08-12 22:14:48 -0400] dgarstang: bean: oh, yes, no. That sucks.
[2013-08-12 22:14:52 -0400] bean: knife ec2 server create -r "role[webserver]" -I ami-2d4aa444 --flavor m1.small -G www,default -x ubuntu -N server01
[2013-08-12 22:15:19 -0400] bean: all ec2 instances are given an ID
[2013-08-12 22:15:23 -0400] bean: and thats all we really care about
[2013-08-12 22:15:39 -0400] jbz: jtimberman: got a sec? Curious to know what my best path to coping with this is: http://tickets.opscode.com/browse/CHEF-3975
[2013-08-12 22:15:50 -0400] dgarstang: bean: yah, google knife requires a name... 'ERROR: Please provide the name of the new server'. I'll have to just do some re.sub in the wrapper script.
[2013-08-12 22:16:04 -0400] jbz: jtimberman: Do I need to wait for 11.0.10?  Or should I be trying to use a daily?
[2013-08-12 22:16:19 -0400] bean: python, gross.
[2013-08-12 22:16:29 -0400] dgarstang: bean: ruby, gross.
[2013-08-12 22:16:39 -0400] jtimberman: jbz: I don't know
[2013-08-12 22:16:47 -0400] jbz: jtimberman: :-D
[2013-08-12 22:16:56 -0400] jbz: jtimberman: Roger. Thx.
[2013-08-12 22:19:07 -0400] bean: dgarstang, theres the possibility of some google specific stuff being written, but we dont use it.
[2013-08-12 22:22:56 -0400] gchristensen: in case someone wants a list of nodes in order of last time they had chef run: https://gist.github.com/grahamc/d9dbb43996b2462b9d27
[2013-08-12 22:23:28 -0400] gleam: doesn't knife status sort by last run time?
[2013-08-12 22:24:16 -0400] bean: pretty sure thats exactly what knife status does
[2013-08-12 22:24:46 -0400] gchristensen: gleam, bean - I think I leveled up today. thank you for the tip.
[2013-08-12 22:34:55 -0400] regork: gchristensen: How is this different from: http://jtimberman.housepub.org/blog/2013/02/16/last-check-in-time-for-nodes/:  /c2c/etc/c2c-dev-dev> /opt/chef/binknife exec -E 'nodes.all {|n| puts "#{n.name} #{Time.at(n[:ohai_time])}"}' | sort -k2,3
[2013-08-12 22:35:31 -0400] gchristensen: regork: looks pretty similar to that one os well
[2013-08-12 22:36:45 -0400] jtimberman: :)
[2013-08-12 22:36:50 -0400] regork: But what about nodes on which chef-client run failed? That would be useful too (i.e. something other than diffing list of those that ran vs. the entire list)
[2013-08-12 22:39:46 -0400] magoo: is there a mature haproxy recipe with lwrp?
[2013-08-12 22:39:53 -0400] magoo: *cookbook
[2013-08-12 22:41:05 -0400] dgarstang: Sew... seems like whisk wants me to put security groups into provider_config again/still.
[2013-08-12 22:41:14 -0400] regork: A question someone asked me for which I didn't have a particularly good answer: What's the advantage of tags over node attributes?
[2013-08-12 22:44:35 -0400] jtnz: Hi, can anyone recommend how I can get data from inside a LWRP outside of the provider? I was thinking something like node.run_state, but that's deprecated in Chef 11 and didn't seem to work anyway.
[2013-08-12 22:53:10 -0400] bean: dgarstang, i'd doubt many people know what whisk is :)  Defining your list of security groups appears to go in the provider_config according to what Nic has written up
[2013-08-12 23:04:26 -0400] dgarstang: Anyone know if knife bootstrap honors .ssh/config ?
[2013-08-12 23:04:29 -0400] dgarstang: bean: Yah.
[2013-08-12 23:04:37 -0400] joefitzgerald: jtimberman: https://github.com/opscode-cookbooks/windows/pull/44 fixes COOK-2098 and COOK-3060
[2013-08-12 23:12:42 -0400] Sauraus: What is the easiest way to append in a template file?
[2013-08-12 23:13:04 -0400] Sauraus: I am trying to get multiple cores in solr and need to update the solr.xml for each core added
[2013-08-12 23:25:18 -0400] dgarstang: be nice if -VV worked on knife ec2 server create.
[2013-08-12 23:27:13 -0400] dgarstang: I'm running knife ec2 server create with -x user -w gateway_ip and getting 'Net::SSH::AuthenticationFailed' ... works when I do a 'ssh $user@gateway_ip' though.
[2013-08-12 23:27:37 -0400] troyready: Sauraus, I'm not an expert on that, but in my experience something like that won't be a good fit for a template (unless you do some fancy recipe work ahead of time and then write out the template once)
[2013-08-12 23:28:03 -0400] Sauraus: Looks like 11.x partials are the way to go here
[2013-08-12 23:29:04 -0400] Sauraus: but I agree it's a PITA with the way how templates work
[2013-08-12 23:29:11 -0400] troyready: AH, perfect. As usual, my bad and out of date advice ends up informing me of something new
[2013-08-12 23:30:03 -0400] dgarstang: how do I make -VV work in knife ec2 server create ?
[2013-08-12 23:32:03 -0400] dgarstang: I'll take --verbose, but that doesn't work either
[2013-08-12 23:36:34 -0400] dgarstang: I'm trying to use --ssh-gateway with knife-ec2. It's failing because the private key isn't on the gateway box. Not gonna happen. Does knife-ec2 support agent forwarding? if not, it's a useless option as far as I can tell.
[2013-08-12 23:40:00 -0400] dgarstang: Ticket  https://github.com/opscode/chef/pull/595 ... why does it say 'merged into master' 3 months ago? My -A option is something totally different.
[2013-08-12 23:43:47 -0400] dgarstang: WAT? "Unable to resolve dependencies: knife-ec2 requires knife-windows (>= 0.5.12)"
[2013-08-12 23:48:33 -0400] dgarstang: grrrrrr
[2013-08-12 23:48:36 -0400] dgarstang: Unable to resolve dependencies: knife-ec2 requires knife-windows (>= 0.5.12)
[2013-08-12 23:48:38 -0400] dgarstang: Unable to resolve dependencies: knife-windows requires em-winrm (= 0.5.4)
[2013-08-12 23:48:40 -0400] dgarstang: Unable to resolve dependencies: em-winrm requires eventmachine (= 1.0.0.beta.3), winrm (~> 1.1.0)
[2013-08-12 23:53:11 -0400] dgarstang: oh ffs. "Unable to resolve dependencies: winrm requires gssapi (~> 1.0.0), httpclient (~> 2.2.0.2), rubyntlm (~> 0.1.1), savon (= 0.9.5), logging (~> 1.6.1)"
[2013-08-12 23:54:57 -0400] dgarstang: how do I get the latest knife-ec2?
[2013-08-12 23:58:29 -0400] ssd7: dgarstang: Reading backscroll now.
[2013-08-12 23:58:39 -0400] dgarstang: ssd7: I think I worked it out
[2013-08-12 23:58:54 -0400] ssd7: OK, good to hear.
[2013-08-12 23:59:48 -0400] dgarstang: ssd7: actually, no, I'm SOL. :(
