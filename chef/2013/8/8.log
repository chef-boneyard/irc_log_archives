[2013-08-08 00:10:13 -0400] mfick: ugh, hyphenation sucks since it doesn't reduce visibility
[2013-08-08 00:10:32 -0400] mfick: How is this not a scalibility problem for large enterprises?
[2013-08-08 00:10:52 -0400] spheromak: mfick, how many cooks do you have ? I  mange < 30  with alot of infra
[2013-08-08 00:11:08 -0400] spheromak: are you using berks or  librarian  ?
[2013-08-08 00:11:20 -0400] spheromak: or are you forking everything you need and managing a giant repo of cooks
[2013-08-08 00:11:32 -0400] mfick: I haven't done anything eyt
[2013-08-08 00:11:36 -0400] mfick: just trying to plan
[2013-08-08 00:11:46 -0400] spheromak: gerneally I got away from the giant repo to the repo-per a long time ago and using tools like librarian/berkshelf for organization
[2013-08-08 00:11:53 -0400] mfick: and any tool I have ever used with flat namespaces eventually fails
[2013-08-08 00:11:57 -0400] mfick: under growth
[2013-08-08 00:12:41 -0400] spheromak: 20knodes and not a problem here
[2013-08-08 00:13:07 -0400] spheromak: 140cooks on server ~30 cooks we manage  directly (i.e. own all the code on)
[2013-08-08 00:13:49 -0400] mfick: how many cookbooks?
[2013-08-08 00:14:06 -0400] mfick: 30?
[2013-08-08 00:14:11 -0400] mfick: Doesn't seem like much
[2013-08-08 00:15:02 -0400] mfick: # of nodes doesn't seem important, but rather # of conifgurations, # of tools to manage seems like it is what would influence cookbooks
[2013-08-08 00:15:09 -0400] spheromak: 309 we manage all of .. many more that we have contributed too, but this is using app/library aproach.
[2013-08-08 00:15:21 -0400] spheromak: we do have a couple cooks that are needing to be refactored into many cooks
[2013-08-08 00:15:30 -0400] spheromak: i.e. they aren't sinngle-concern right now
[2013-08-08 00:16:01 -0400] spheromak: mfick, indeed it is. we run alot of infra that looks very much alike :P
[2013-08-08 00:16:25 -0400] mfick: newb here, what do you mean by app/library approach?
[2013-08-08 00:16:45 -0400] spheromak: http://realityforge.org/code/2012/11/19/role-cookbooks-and-wrapper-cookbooks.html
[2013-08-08 00:18:20 -0400] spheromak: so ~100cooks are community cooks we don't directly manage.  Or if we do we wrap it and use chef-rewind until we have some upstream commit fixed.
[2013-08-08 00:20:13 -0400] mfick: I am having a hard time imagining that I won't have at least 10-30 cookbooks just for my servers that no one else will care about or want to see
[2013-08-08 00:20:33 -0400] mfick: so why will they not get pissed at me?
[2013-08-08 00:20:46 -0400] spheromak: alot of our small 1-off stuff is a recipe in base
[2013-08-08 00:21:01 -0400] spheromak: and we have a pretty big "application" cook that deploys custom app stuff
[2013-08-08 00:21:11 -0400] spheromak: which could be split into about 15 more cooks ;P
[2013-08-08 00:21:19 -0400] spheromak: but still not in collision
[2013-08-08 00:22:25 -0400] spheromak: theres a pretty wide namespace for cookbook names ;) and easy to specify your own sauce as  thing-mycompany or w/e
[2013-08-08 00:23:26 -0400] pontiki: about as wide as directory namespace can take you...
[2013-08-08 00:23:27 -0400] spheromak: I've not heard anyone have an issue with cookbook naming other than the fact that theres like 12 cooks for the same thing floating around on github.  (or complain about community site not having namespaces for users )
[2013-08-08 00:24:17 -0400] mfick: I am not understanding how it is wide, can you explain?
[2013-08-08 00:24:26 -0400] spheromak: uh
[2013-08-08 00:24:27 -0400] mfick: I generally don't like more then 5-10 in my dirs
[2013-08-08 00:24:35 -0400] spheromak: well thats a personal problem :D
[2013-08-08 00:24:41 -0400] spheromak: you don't have to have a dir
[2013-08-08 00:24:45 -0400] spheromak: you can use groups in a berksfile
[2013-08-08 00:24:48 -0400] spheromak: and a repo-per cookbook
[2013-08-08 00:24:50 -0400] pontiki: com.bigjob.appdomain.appname
[2013-08-08 00:24:51 -0400] spheromak: if you want.
[2013-08-08 00:25:09 -0400] mfick: ok, groups in berksfile?
[2013-08-08 00:25:30 -0400] spheromak: technically you could buidl a knife plugin to support however you like to layout a repo
[2013-08-08 00:25:48 -0400] spheromak: that wouldn't be too hard, but on the chef-server they will have to have a unique name
[2013-08-08 00:27:48 -0400] mfick: anyone know why flat was chosen for an entripse tool?
[2013-08-08 00:28:47 -0400] mfick: How do you manage 20K nodes in flat namespace?
[2013-08-08 00:29:02 -0400] mfick: they all do the same thing so you don't care?
[2013-08-08 00:29:11 -0400] spheromak: mfick, I think it was never needed. I have not heard anyone say they needed this (in the list or on IRC) and I was very early adopter of chef.
[2013-08-08 00:30:17 -0400] spheromak: mfick, ndoes are in a "flat" namespace  if you consider the fqdn a namespace, but no they are isolated.  in the same way your cookbook names could be managed this way.  as already been pointed out.
[2013-08-08 00:31:04 -0400] mfick: but how do you browse 20K nodes to understand their naming convention even?
[2013-08-08 00:31:26 -0400] spheromak: dont have a convention metadata is in chef. so you use search for most of those vs a convention
[2013-08-08 00:31:43 -0400] spheromak: knife ssh "role:someapprole"
[2013-08-08 00:32:17 -0400] mfick: then how do you know say what nodes are unused?
[2013-08-08 00:32:28 -0400] spheromak: unused ?
[2013-08-08 00:32:36 -0400] mfick: nothing deployed yet on them
[2013-08-08 00:32:42 -0400] spheromak: cause deploymeent is in chef
[2013-08-08 00:32:49 -0400] spheromak: and its again a search.
[2013-08-08 00:33:05 -0400] mfick: so browse basically doesn't exist
[2013-08-08 00:33:07 -0400] mfick: just search
[2013-08-08 00:33:12 -0400] spheromak: search is browse
[2013-08-08 00:33:24 -0400] mfick: search requires an objective
[2013-08-08 00:33:26 -0400] spheromak: think about tag clouds and metadata
[2013-08-08 00:33:33 -0400] mfick: browse faciliattes understanding
[2013-08-08 00:33:39 -0400] mfick: tag clouds suck
[2013-08-08 00:33:43 -0400] spheromak: you can write all sortsa tools to build the ontological view you want
[2013-08-08 00:33:58 -0400] mfick: they don't allow a structure to be inherently convey to new users
[2013-08-08 00:34:02 -0400] spheromak: you can't know that right from the bat.  Everytime you start down the road of naming shit  you will fail with it at scale
[2013-08-08 00:34:29 -0400] mfick: true for somethign like nodes
[2013-08-08 00:34:29 -0400] spheromak: taging and searching of metadata is the only way to satisfy the broad needs of the infra.
[2013-08-08 00:34:42 -0400] mfick: but I don't think that is true for something like code
[2013-08-08 00:34:48 -0400] spheromak: naming at this scale is more based on physical location of real assets than the function of the thing.
[2013-08-08 00:35:00 -0400] spheromak: you stalked hostnames and nodes.
[2013-08-08 00:35:01 -0400] mfick: sure
[2013-08-08 00:35:06 -0400] spheromak: and in cookbooks you wont have 20k of them
[2013-08-08 00:35:16 -0400] spheromak: and I doubt theres many people with more than a couple hundred at most
[2013-08-08 00:35:32 -0400] mfick: sure but the guy who only cares about 5 doesn't wnat ot even see 100
[2013-08-08 00:35:42 -0400] mfick: especially if they are for another team
[2013-08-08 00:35:50 -0400] mfick: or aread of expertise
[2013-08-08 00:36:20 -0400] spheromak: even if you have 100 cooks. you probably only have 10-30  "top level cooks"
[2013-08-08 00:36:42 -0400] mfick: OK, what do you mean by top level cooks (sorry, newbie)
[2013-08-08 00:36:48 -0400] spheromak: read that blog
[2013-08-08 00:36:54 -0400] spheromak: app cook or role cook
[2013-08-08 00:37:03 -0400] spheromak: thing that describes this machine's pourpose
[2013-08-08 00:37:16 -0400] spheromak: ytou can build that abstraction with a role or a role cookbook
[2013-08-08 00:37:37 -0400] mfick: role don't nest either though right?
[2013-08-08 00:37:40 -0400] spheromak: but be weary of getting into 100's of roles ;P
[2013-08-08 00:37:54 -0400] mfick: trying to read blog, not quite following it yet
[2013-08-08 00:37:57 -0400] spheromak: in terms of the namespace on chef-server no they are flat
[2013-08-08 00:37:58 -0400] mfick: but I will try harder
[2013-08-08 00:38:22 -0400] spheromak: Honeestly I would try to work past whatever the perception of deficiency is here.
[2013-08-08 00:38:40 -0400] spheromak: and get familliar first
[2013-08-08 00:38:55 -0400] mfick: yest, I am trying to figure out how to layout some basics
[2013-08-08 00:38:56 -0400] spheromak: remember that a cook has many recipes
[2013-08-08 00:39:04 -0400] mfick: and I just can't figure it out
[2013-08-08 00:39:06 -0400] spheromak: I wouldn't worry about it too much right now
[2013-08-08 00:39:15 -0400] spheromak: chances are you won't have enough things to really have a problem
[2013-08-08 00:39:24 -0400] spheromak: call it premature optimization :D
[2013-08-08 00:39:42 -0400] spheromak: best practice IMO is a git repo per cookbook
[2013-08-08 00:39:47 -0400] mfick: Not trying to opimize, but picture just a bunch of cron jobs
[2013-08-08 00:39:53 -0400] spheromak: and use librarian or berks. but if you are just getting started.
[2013-08-08 00:39:57 -0400] mfick: that do various houskeeping
[2013-08-08 00:40:03 -0400] mfick: how would you manage those?
[2013-08-08 00:40:08 -0400] mfick: separate cookbooks?
[2013-08-08 00:40:20 -0400] mfick: throw them all in a single cookbook as separate recipes?
[2013-08-08 00:40:20 -0400] spheromak: I wouldn't even worry about that. I would worry about getting up on how chef works.
[2013-08-08 00:40:31 -0400] spheromak: well you can organzie you're cron jobs in a couple ways
[2013-08-08 00:40:45 -0400] spheromak: #1  are they tieed to some other application that may already have a cookbook ?
[2013-08-08 00:40:51 -0400] spheromak: then maybe they are a recipe in that cookbook
[2013-08-08 00:41:24 -0400] mfick: tied only in the sense that the other app needs to be there?
[2013-08-08 00:41:27 -0400] spheromak: #2 are they grouped into broad catagories? then you could have a cron-FOO cookbook with  recipes for jobs or sets of jobs
[2013-08-08 00:41:54 -0400] spheromak: #3 sorta the same as 3. have  a cook named  mycompany-cronjobs, and a recipe for each catagory of cron jobs
[2013-08-08 00:42:23 -0400] spheromak: there are many ways to do it.  you could makee a cook per cron, but really cron is generally something that is supporting something else
[2013-08-08 00:42:36 -0400] mfick: but is that appropriate?  What would the default recipe in such a cookbook likely be?
[2013-08-08 00:42:45 -0400] spheromak: what cook ?
[2013-08-08 00:42:52 -0400] mfick: mycompany-cronjobs
[2013-08-08 00:42:57 -0400] spheromak: no default
[2013-08-08 00:43:00 -0400] spheromak: default can be empty
[2013-08-08 00:43:09 -0400] spheromak: you always call the qualified recipe in run-list
[2013-08-08 00:43:11 -0400] mfick: seems like throwing together unrealted cron jobs isn't very good
[2013-08-08 00:43:15 -0400] spheromak: (and heres a namespace)
[2013-08-08 00:43:23 -0400] spheromak:  mycrons::something
[2013-08-08 00:43:44 -0400] spheromak: I agree I much rather group the crons into a "cron" recipe in an applications cookbook
[2013-08-08 00:44:10 -0400] spheromak: i.e.  "authentication-service" cookbook  Is the cook that handles everything you need to setup an authentication service node.
[2013-08-08 00:44:23 -0400] mfick: what if that use ldap?
[2013-08-08 00:44:34 -0400] mfick: do you just then reference the ldap cook from there?
[2013-08-08 00:44:40 -0400] spheromak: yup
[2013-08-08 00:44:44 -0400] spheromak: thats the app cook's job
[2013-08-08 00:44:49 -0400] spheromak: include_recipe
[2013-08-08 00:44:57 -0400] mfick: and then "authentication-service" handles just the company custom stuff?
[2013-08-08 00:45:08 -0400] spheromak: and setup attributes for pulling in other things that assembles the application (to turn a node into that thing)
[2013-08-08 00:45:14 -0400] spheromak: yup
[2013-08-08 00:45:38 -0400] mfick: So what if you then have about 10 different type of authenticaiton-services
[2013-08-08 00:45:41 -0400] mfick: use roles?
[2013-08-08 00:45:52 -0400] spheromak: Try to avoid forking community cooks and making your own versions where you can. This leads to some serious tech debt that you will have a hard time recovering from.
[2013-08-08 00:46:00 -0400] spheromak: "type"
[2013-08-08 00:46:07 -0400] spheromak: why not have 10 reciepes for those types ?
[2013-08-08 00:46:11 -0400] spheromak: or an attribute
[2013-08-08 00:46:22 -0400] spheromak: and have the recipes in that cook do the right thing for each type
[2013-08-08 00:46:41 -0400] spheromak: many ways to slice that. fully up to you how to handle it.
[2013-08-08 00:47:13 -0400] spheromak: I can't recommend what will be exactly best for you. Only give you my thinking and experience.
[2013-08-08 00:47:20 -0400] mfick: I am having a hard time grapsing what belongs in a recipe, what in a cook and what in a role, what in env, what in bags
[2013-08-08 00:47:33 -0400] mfick: because it seems like there are too many ways to do things :(
[2013-08-08 00:47:48 -0400] spheromak: you could use bags, tags, attribs, search, custom ruby libraries   to  slice this stuff up however you want.  (this is what makes chef awesome, but also sorta difficult when you start)
[2013-08-08 00:47:56 -0400] spheromak: yep
[2013-08-08 00:48:05 -0400] spheromak: thats why I suggest the app cookbook aproach
[2013-08-08 00:48:42 -0400] spheromak: or whats layed out in that blog
[2013-08-08 00:52:41 -0400] spheromak: mfick, http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-08-08 00:52:46 -0400] spheromak: another good blog post
[2013-08-08 00:53:10 -0400] mfick: thanks, reading now
[2013-08-08 00:53:16 -0400] mfick: the other one wetn over my head
[2013-08-08 00:53:29 -0400] spheromak: and related: http://www.opscode.com/blog/chefconf-talks/the-berkshelf-way-jamie-winsor/  (tho you don't have to use berks)
[2013-08-08 01:01:39 -0400] mfick: So I think I get the library cookbook / app wrapper cookbook pattern (it was something I pretty much started with in my mind)
[2013-08-08 01:02:00 -0400] mfick: but I feel like my specific needs require a third middle layer :(
[2013-08-08 01:02:36 -0400] mfick: because there is a lot of custom stuff that I think I will want to share across very differnent instance of my main app
[2013-08-08 01:03:10 -0400] mfick: instance for different teams with less custom stuff, but they will likely want to share much of our base custom stuff but be simpler
[2013-08-08 01:51:33 -0400] spheromak: mfick, you can use different chef-servers if its that huge of a deal. If you're sharing stuff between departments deef use a repo-per cookbook and let the cookbooks be thee "unit of work"
[2013-08-08 02:27:41 -0400] xtristan: with the opscode users cookbook, is there a way to append users to a group with users_manage?
[2013-08-08 02:27:46 -0400] xtristan: or does it always just append
[2013-08-08 02:49:14 -0400] xtristan: nevermind! created new group + set env override
[2013-08-08 02:49:16 -0400] xtristan: close enough
[2013-08-08 02:55:35 -0400] clkao: w/i n41
[2013-08-08 02:55:53 -0400] xtristan: ?
[2013-08-08 03:03:17 -0400] CocoCola: Hello
[2013-08-08 03:03:33 -0400] pontiki: things go better with coke
[2013-08-08 03:03:34 -0400] CocoCola: I am using chef to do the deployment
[2013-08-08 03:04:06 -0400] CocoCola: BELC02K80NFFFT3:chef-repo dajia$ knife ssh fqdn:cheldxedxa002.karmalab.net "sudo -H chef-client" -x dajia -P <password> a ipaddress
[2013-08-08 03:04:20 -0400] CocoCola: Above is the command which i was running
[2013-08-08 03:04:36 -0400] CocoCola: but i already hit the error with FATAL: No nodes returned from search!
[2013-08-08 03:04:56 -0400] CocoCola: I run the command of chef note list
[2013-08-08 03:05:30 -0400] CocoCola: I can see the cheldxedxa002.karmalab.net as node returns
[2013-08-08 03:05:59 -0400] CocoCola: thus i don't why the command is not working
[2013-08-08 03:06:07 -0400] CocoCola: btw, it was working fine yesterday
[2013-08-08 03:06:33 -0400] CocoCola: Is there anyone who can help me on this?
[2013-08-08 03:07:01 -0400] paulmooring: CocoCola: How many nodes do you have?
[2013-08-08 03:07:18 -0400] paulmooring: `knife node list` will return node names not fqdns
[2013-08-08 03:07:47 -0400] paulmooring: so `knife search "name:cheldxedxa002.karmalab.net"` should show you the node if that's it's name
[2013-08-08 03:08:09 -0400] CocoCola: you are correct. but it did return cheldxedxa002.karmalab.net
[2013-08-08 03:08:22 -0400] CocoCola: when i try to do the chef note list
[2013-08-08 03:09:42 -0400] CocoCola: ???
[2013-08-08 03:17:17 -0400] CocoCola: hello?
[2013-08-08 03:17:35 -0400] CocoCola: Is there any body can help ?
[2013-08-08 03:23:02 -0400] jbz: CocoCola:  remember, the node name is not necessarily the fqdn for a node
[2013-08-08 03:23:09 -0400] jbz: so just because node list returned a node with that name
[2013-08-08 03:23:21 -0400] jbz: it doesn't mean that's the FQDN ohai/chef think it has
[2013-08-08 03:23:35 -0400] CocoCola: then what should i do?
[2013-08-08 03:24:41 -0400] CocoCola: BELC02K80NFFFT3:chef-repo dajia$ knife ssh fqdn:cheldxedxa002.karmalab.net "sudo -H chef-client" -x dajia -P z3Wowynt a ipaddress -VV DEBUG: Signing the request as dajia DEBUG: Sending HTTP Request via GET to chef.aws.sb.karmalab.net:4000/search/node DEBUG: ---- HTTP Status and Header Data: ---- DEBUG: HTTP 1.1 200 OK DEBUG: server: nginx/1.0.5 DEBUG: date: Thu, 08 Aug 2013 03:13:47 GMT DEBUG: content-type: application/json; charset
[2013-08-08 03:25:50 -0400] CocoCola: BELC02K80NFFFT3:chef-repo dajia$ knife ssh fqdn:cheldxedxa002.karmalab.net "sudo -H chef-client" -x dajia -P <passwor a ipaddress -VV DEBUG: Signing the request as dajia DEBUG: Sending HTTP Request via GET to chef.aws.sb.karmalab.net:4000/search/node DEBUG: ---- HTTP Status and Header Data: ---- DEBUG: HTTP 1.1 200 OK DEBUG: server: nginx/1.0.5 DEBUG: date: Thu, 08 Aug 2013 03:13:47 GMT DEBUG: content-type: application/json; charset
[2013-08-08 03:26:06 -0400] jbz: If it returns the name properly does using that work?
[2013-08-08 03:26:35 -0400] CocoCola: I don't understand what do you mean?
[2013-08-08 03:27:02 -0400] jbz: knife ssh "name:cheldxedxa002.karmalab.net" "<command>"
[2013-08-08 03:27:06 -0400] jbz: does that work?
[2013-08-08 03:28:02 -0400] jbz: also, if you're ssh-ing to a specific known IP, why are you using a search in the first place?
[2013-08-08 03:28:24 -0400] jbz: I'm not sure what happens if you give both an ipaddr (-a <ip>) and a search ("fqdn:*") in the same command line, to be honest
[2013-08-08 03:28:29 -0400] jbz: but I wouldn't be surprised if something gets confused
[2013-08-08 03:28:51 -0400] jbz: oh, unless you're just telling it to go there *via* ipaddress, sorry
[2013-08-08 03:29:10 -0400] jbz: so
[2013-08-08 03:29:13 -0400] jbz: for that to work
[2013-08-08 03:29:25 -0400] jbz: the node has to have an ipaddress attribute, and it must be correct and one that is reachable/routable from where you are
[2013-08-08 03:29:33 -0400] jbz: is it possible that the node's primary ipaddress is a private IP you can't reach?
[2013-08-08 03:30:54 -0400] CocoCola: knife ssh "name:cheldxedxa002.karmalab.net" doesn't work
[2013-08-08 03:31:15 -0400] CocoCola: BELC02K80NFFFT3:chef-repo dajia$ knife ssh "name:cheldxedxa002.karmalab.net" FATAL: No nodes returned from search!
[2013-08-08 03:35:48 -0400] jbz: ok so
[2013-08-08 03:35:55 -0400] jbz: are you on the Opscode platform or a private server?
[2013-08-08 03:38:31 -0400] jbz: If you're on a private server, it sounds like it is possible that the search index isn't working.  When you list nodes, it just lists all of them, it doesn't search via an index.  So it's possible to list nodes without being able to search them, if the index isn't working.  I'm not positive if this is still true in Chef 11, or if so what the response is, but I know it has been true int he past and there were server-side scripts to kick the
[2013-08-08 03:38:31 -0400] jbz:  index.
[2013-08-08 03:40:42 -0400] jbz: Ah, Chef 11 server moved reindexing to "chef-server-ctl reindex"
[2013-08-08 05:13:58 -0400] corehook: hi dudes, i use chef for deploying Ruby on Rails application, now i must set up auto deployment. Is there best practices about this ?
[2013-08-08 05:14:27 -0400] corehook: i think about adding in run_list by cron and run chef-client on nodes every minute
[2013-08-08 05:15:08 -0400] corehook: i mean adding with cron recipes to nodes run_list
[2013-08-08 05:15:18 -0400] corehook: but after i must clean run_list..
[2013-08-08 05:17:16 -0400] siezer: ptwobrussell if the workstations are macs, installing xcode + cli tools isn't unreasonable. If they're windows, I bet you're talking about nokogiri, which should ship its on precompiled ming32 bits
[2013-08-08 05:17:18 -0400] siezer: er
[2013-08-08 05:17:26 -0400] siezer: s/*//
[2013-08-08 07:33:37 -0400] NagaLakshmi: Hi..If I run a mysql cookbook which is having randomly generated server root password,debian password,How can I get those passwords so that I can use? I could not find anything regarding this in the logs too.
[2013-08-08 07:35:40 -0400] m4rcu5: NagaLakshmi: check the node attributes, they show up in there; knife node show <nodename> -m
[2013-08-08 07:37:11 -0400] NagaLakshmi: m4rcu5 : I'm using chef-solo..Solo doesn't support node data storage
[2013-08-08 07:41:02 -0400] m4rcu5: NagaLakshmi: then you had to set them as node variables in advance, i think it also shows that somewhere in the log, but im not sure
[2013-08-08 07:44:10 -0400] NagaLakshmi: Hi..While using chef-solo,I've given the password attributes in the runlist json.Is there any specific criteria to find the attributes that needs to be passed in json in case of chef-solo?
[2013-08-08 07:46:48 -0400] NagaLakshmi: m4rcu5 : Hi..While using chef-solo,I've given the password attributes in the runlist json.Is there any specific criteria to find the attributes that needs to be passed in json in case of chef-solo?
[2013-08-08 07:49:25 -0400] hagzag: I have a question about loops and dynamic attribute names in my attributes/default.rb file
[2013-08-08 07:49:54 -0400] m4rcu5: NagaLakshmi: you can pass it as a normal attribute in the node.json, like this: https://github.com/opscode-cookbooks/mysql#chef-solo-note
[2013-08-08 07:50:55 -0400] hagzag: is somthing of the followin possible ?https://gist.github.com/hagzag/e61fb6df387109144d52
[2013-08-08 07:51:54 -0400] hagzag: it's not working I am i doing it wrong / it isn't supported ... [ Gist url :: https://github.com/opscode-cookbooks/mysql#chef-solo-note ]
[2013-08-08 07:52:33 -0400] hagzag: sorry [ Gist url :: https://gist.github.com/hagzag/e61fb6df387109144d52 ]
[2013-08-08 07:55:25 -0400] NagaLakshmi: m4rcu5 : Thanks,Is it mandatory to give randomly generated attributes in node.json for all cookbooks?
[2013-08-08 07:58:27 -0400] m4rcu5: hagzag: well, it should work, im no ruby hero myself, but i guess your gist fails on the creation of the hash?
[2013-08-08 07:59:10 -0400] hagzag: yes when I use the attributes in my recipe I come up empty ...
[2013-08-08 07:59:13 -0400] hagzag: :(
[2013-08-08 07:59:21 -0400] m4rcu5: this should work however: default[:dvd] = { key => { :filename => filename, :url => url } }
[2013-08-08 08:00:03 -0400] guilhem_: Hi all,
[2013-08-08 08:00:06 -0400] m4rcu5: hagzag: your example fails with a NoMethodError: undefined method `[]' for nil:NilClas here ;)
[2013-08-08 08:00:44 -0400] hagzag: m4rcu5: hecking
[2013-08-08 08:01:08 -0400] m4rcu5: ow wait, you also try to use vars you set later on in a var :| thats probbably not gonna work
[2013-08-08 08:01:25 -0400] m4rcu5: if it was only about the hash that should have fixed it :P
[2013-08-08 08:02:30 -0400] hagzag: so what would be the best approach of generating ~30 attribues - hard coding them ?
[2013-08-08 08:04:35 -0400] m4rcu5: hagzag: your on the right way, but in the end you just need 2 vars per key? default[:dvd][key][:filename] = key.node[key][:serial].node[:file_ext]       and that url i guess
[2013-08-08 08:06:23 -0400] hagzag: thanks will check and report back :)
[2013-08-08 08:06:45 -0400] m4rcu5: hagzag: let me hack something up, one second
[2013-08-08 08:06:58 -0400] hagzag: sure :)
[2013-08-08 08:07:57 -0400] guilhem_: I have some questions about notifications, LWRP and use_inline_resources.
[2013-08-08 08:08:41 -0400] guilhem_: Somebody cna tell me why this code isn't working? : https://github.com/optiflows-cookbooks/prosody/blob/LWRP/providers/module.rb
[2013-08-08 08:09:26 -0400] guilhem_: (for example: notifies :restart, "service[prosody]" )
[2013-08-08 08:09:54 -0400] guilhem_: even if I do an include_recipe "prosody" before calling LWRP
[2013-08-08 08:10:38 -0400] guilhem_: (error: "Cannot find a resource for notifies on ubuntu version 12.04")
[2013-08-08 08:10:44 -0400] m4rcu5: hagzag: probbably that some rubyist is going to shoot me, but give it a go ;) http://nopaste.dk/p57580
[2013-08-08 08:13:20 -0400] hagzag: that was how it looked like originally and I was thinking the same thing some one is going to shoot me some day ...
[2013-08-08 08:13:57 -0400] m4rcu5: hagzag: more important, does it work :P
[2013-08-08 08:14:08 -0400] hagzag: checking ...
[2013-08-08 08:14:38 -0400] m4rcu5: im more of a perl guy myself, kinda reflects into the ruby
[2013-08-08 08:16:01 -0400] pontiki: m4rcu5: that's perfectly cromulent ruby
[2013-08-08 08:17:13 -0400] m4rcu5: pontiki: thanks ;)
[2013-08-08 08:37:52 -0400] m4rcu5: hagzag: did the code eat your cat of did it run? ;)
[2013-08-08 09:01:02 -0400] bcave:  if I have an ERB with <%= "SomeValue" if defined?(@someVal) %>, and the template has :someVal => (someVar && "X."+someVar)
[2013-08-08 09:01:26 -0400] bcave: if someVar is not defined, then would :someVal still be considered as defined in the template?
[2013-08-08 09:01:41 -0400] bcave: (defined as a null value)
[2013-08-08 09:04:22 -0400] bcave: i could try it and see, but hoping i could get a quicker response here
[2013-08-08 09:09:25 -0400] bcave: ok, it doesn't work. The ERB logic needs to be: <%= "someValue" if !@someVal.nil? %>
[2013-08-08 09:24:29 -0400] tommyblue: hi all, I'm learning chef. I've a question about roles assigned to nodes: I'm using git to manage the configurations but I'm assigning roles and run lists to nodes using knife. This creates this associations in the chef-server but in the git repo there's no sign of the properties of the nodes. Does exist a way to manage the roles of the nodes through files?
[2013-08-08 09:26:24 -0400] bjensen82: What is the easiest way to add my vagrant user to my sudoers file? (vagrant  ALL= (ALL:ALL) NOPASSWD: ALL)
[2013-08-08 09:29:43 -0400] tommyblue: bjensen82, I did it creating a file with the sudoer line, then used the cookbook_file resource:
[2013-08-08 09:30:40 -0400] tommyblue: cookbook_file "/etc/sudoers.d/vagrant-user" do \n source "sudoers-chef-client" \n mode 0440 \n owner "root" \n group "root" \n end
[2013-08-08 09:31:00 -0400] tommyblue: sorry for the \n, it's the new line :)
[2013-08-08 09:35:42 -0400] bjensen82: tommyblue:
[2013-08-08 09:35:46 -0400] bjensen82: tommyblue: cool. Thanks
[2013-08-08 09:35:58 -0400] johnldz: is anyone still getting 404 errors from the cookbook rest api? the status site says it's operating normally, but I'm getting 404s
[2013-08-08 09:44:57 -0400] hughsaunders: Whats the difference between action_enable and enable_service in chef::provider::service? http://rubydoc.info/gems/chef/Chef/Provider/Service
[2013-08-08 09:50:11 -0400] mrtazz: hughsaunders: enable_service seems to be a lower level method used by action_enable (at least judging from the source you linked)
[2013-08-08 09:53:21 -0400] hughsaunders: Thanks mrtazz
[2013-08-08 10:29:15 -0400] sobi3ch: hi all i have following problem. http://stackoverflow.com/questions/18066326/cant-run-vagrant-following-chef-instructions-from-ops-code-page
[2013-08-08 10:29:41 -0400] sobi3ch: I've try install more ruby libs to match this log4r but without results
[2013-08-08 10:29:43 -0400] sobi3ch: any help?
[2013-08-08 10:57:10 -0400] jacobat: I'm doing "knife search node "role:foo"" and getting back a node that doesn't have that role. Any ideas why? (On 0.10)
[2013-08-08 11:16:24 -0400] jacobat: Problem is that there's a nested attribute that's called "application_role" - how do I make search not find that node?
[2013-08-08 11:17:00 -0400] Mez_: Hi all, we have 2 different recipes in one cookbook.  Is it possible to somehow define that they'll conflict (they can theoretically run together, but one will override the other)
[2013-08-08 11:22:21 -0400] jacobat: So even after renaming the attribute on the node the node keeps popping up in search results. Do I need to do something special to fix the index?
[2013-08-08 11:24:09 -0400] Mez_: worked mine out, was editing metadata.rb~
[2013-08-08 11:24:15 -0400] Mez_: *removes that file*
[2013-08-08 11:35:48 -0400] novegin: hi
[2013-08-08 11:36:11 -0400] novegin: is there a sed equivalent onliner in ruby for search and replace
[2013-08-08 11:36:21 -0400] novegin: oneliner*
[2013-08-08 11:40:28 -0400] lewiz: Is there any way to remove all of the yum repos not defined by chef yum_repository commands?
[2013-08-08 11:45:52 -0400] hughsaunders: Anyone know why runit is used on debian and xinetd on rhel?
[2013-08-08 11:45:54 -0400] hughsaunders: https://github.com/opscode-cookbooks/git/blob/2.5.2/recipes/server.rb
[2013-08-08 11:46:06 -0400] hughsaunders: Why not use xinetd on both?
[2013-08-08 11:59:14 -0400] ahawkins: hey guys
[2013-08-08 11:59:42 -0400] hughsaunders: novegin: 'patern'.sub /t/, 'tt'
[2013-08-08 12:00:17 -0400] ahawkins: I have a system with moving parts. I have some things on AWS and some on heroku. I need to share ENV variables / configuration between all of them. Is Chef a good tool for that?
[2013-08-08 12:00:32 -0400] ahawkins: my apps need a shared connection to AMQP and I'd like to avoid having to set that everywhere.
[2013-08-08 12:01:52 -0400] hughsaunders: ahawkins: could be, as long as all your instances can connect to one chefserver
[2013-08-08 12:02:32 -0400] novegin: thanks @hughsaunders
[2013-08-08 12:04:37 -0400] ahawkins: hughsaunders: I don't see why not. We are currently using Chef to manage all the AWS stuff, but we wil have some problems in the future if split. I don't have experience with chef yet. I can just see a problem where I need to change a env variable across 10 different things in one go.
[2013-08-08 12:05:52 -0400] hughsaunders: jtimberman: I'm having difficulty understanding the runit cookbook. Why is runsvdir started by an execute block, rather than managed as a service? And why is that service only started for old versions of ubuntu? https://github.com/opscode-cookbooks/runit/blob/master/recipes/default.rb#L101-L109
[2013-08-08 12:08:03 -0400] ahawkins: hughsaunders: I guess the other question is chef good for managing systems composed of many services? I need something simple like: chef deploy production which updates all the services etc.
[2013-08-08 12:14:59 -0400] hughsaunders: ahawkins: Generally yes, but I would suggest having a go to see if it fits your exact needs.
[2013-08-08 12:20:07 -0400] joelnn: hughsaunders: runsvdir is a service manager, what would it mean to manage it as a service?
[2013-08-08 12:21:06 -0400] hughsaunders: joelnn: define it as a service in chef, so its started by the upstart service provider?
[2013-08-08 12:21:35 -0400] hughsaunders: rather than execute "start runsvdir"
[2013-08-08 12:21:46 -0400] hughsaunders: but thats a secondary question really
[2013-08-08 12:22:15 -0400] hughsaunders: I was more interested in why the notify to start runsvdir is only sent for old versions of ubuntu
[2013-08-08 12:22:59 -0400] joelnn: in my use, it does get a script installed to /etc/event.d/runsvdir
[2013-08-08 12:25:00 -0400] bcave: quick question - is it possible to use functions in an ERB? I'm trying to do an <% if @someVar.casecmp("someString") %> but it doesn't evaluate as expected
[2013-08-08 12:26:49 -0400] bcave:  should functions like that work in an ERB?
[2013-08-08 12:28:34 -0400] joelnn: hughsaunders: I'm on 10.04, but somehow runsvdir starts. don't know how, looking at the code you linked. perhaps in newer ubuntu, something is watching /etc/event.d
[2013-08-08 12:28:45 -0400] joelnn: bcave: yes
[2013-08-08 12:29:07 -0400] joelnn: bcave: ruby syntax needs a "then" after your condition, maybe thats the issue
[2013-08-08 12:30:02 -0400] hughsaunders: joelnn: after further testing it looks like runsvdir is started by package install scripts on 12.04.
[2013-08-08 12:30:34 -0400] bcave: <% if @someVar.casecmp("someString") %> \n PUT THIS IN THE FILE <% end %>
[2013-08-08 12:30:44 -0400] bcave: im using <%, not <%=
[2013-08-08 12:31:28 -0400] bcave: oh great! i see the issue. syntax error, missing a "do"
[2013-08-08 12:31:46 -0400] bcave: i picked up a template example on a puppet doc site :o
[2013-08-08 12:33:17 -0400] bcave: oh, never mind, that's not it.
[2013-08-08 12:33:37 -0400] joelnn: you are missing a "then" like I said.
[2013-08-08 12:34:14 -0400] bcave: ok
[2013-08-08 12:34:56 -0400] bcave: i don't quite understand...
[2013-08-08 12:35:54 -0400] bcave: i know I can do a <%=  @someVar if @someVar %>, using "<%=", but I thought I could also use <% %> (without the "=") to wrap with code
[2013-08-08 12:36:15 -0400] joelnn: bcave: http://stackoverflow.com/questions/631174/how-to-write-if-without-using-then-or-end-in-ruby
[2013-08-08 12:36:33 -0400] joelnn: unfortunately ruby supports different syntax for the single-line use
[2013-08-08 12:36:50 -0400] bcave: https://gist.github.com/brettcave/6184116
[2013-08-08 12:37:42 -0400] bcave: the "then" is outside of the ERB tags
[2013-08-08 12:37:57 -0400] bcave: but it's not processing the casecmp as expected
[2013-08-08 12:38:21 -0400] joelnn: I see
[2013-08-08 12:40:24 -0400] joelnn: bcave: humor me and change it to <% if @environment.casecmp("prod") then %>
[2013-08-08 12:41:00 -0400] bcave: ooh, i thought you meant a logical "then" block, not a literal "then" keyword....
[2013-08-08 12:41:03 -0400] bcave: triyng now
[2013-08-08 12:43:55 -0400] bcave: thank you joelnn, it works with "then"
[2013-08-08 12:44:49 -0400] joelnn: cool. that is a little weird, I would have expected some syntax error. the mysteries of erb
[2013-08-08 12:45:21 -0400] bcave: haha. pretty new to erb, so at least learning it from the start
[2013-08-08 12:59:07 -0400] bcave: no, wait
[2013-08-08 12:59:11 -0400] bcave: its still not working
[2013-08-08 13:05:32 -0400] bcave: this is bizarre!
[2013-08-08 13:05:55 -0400] gchristensen: bcave: what's up?
[2013-08-08 13:07:22 -0400] bcave: https://gist.github.com/brettcave/6184116
[2013-08-08 13:08:10 -0400] bcave: if I take the first 2 conditionals out, and just have the 3rd condition in, then I get "config{}"
[2013-08-08 13:09:50 -0400] bcave: i must have had a typo somewhere
[2013-08-08 13:10:02 -0400] bcave: or i was running chef-client before the knife cookbook upload was finished or something
[2013-08-08 13:10:04 -0400] gchristensen: that is remarkable :P
[2013-08-08 13:10:31 -0400] gchristensen: bcave: don't if statements need -%>?
[2013-08-08 13:19:21 -0400] bcave: thanks gchristensen. that would be it.
[2013-08-08 13:19:33 -0400] bcave: http://docs.opscode.com/resource_template.html A statement is delimited by <% and -%>.
[2013-08-08 13:21:50 -0400] bcave: however... the example on that page has the ERB delimiters removed :p
[2013-08-08 13:22:27 -0400] chris613: lol@example
[2013-08-08 13:24:25 -0400] bcave: if false # this won't happen....
[2013-08-08 13:24:27 -0400] bcave: haha
[2013-08-08 13:25:53 -0400] bcave: ok... finally some consistency. the "casecmp" function doesn't seem to work
[2013-08-08 13:26:46 -0400] bcave: works: <% if @environment == "PROD" -%> # yes, its prod <% end -%>
[2013-08-08 13:27:10 -0400] bcave: doesnt work: <% if @environment.casecmp("prod") -%> # yes, its prod <% end -%>
[2013-08-08 13:31:06 -0400] joelnn: gchristensen: no idea what -%> does, haven't found it in the erubis docs here http://www.kuwata-lab.com/erubis/
[2013-08-08 13:32:52 -0400] konopka: joelnn gchristensen -%> supresses trailing newline in output
[2013-08-08 13:32:56 -0400] joelnn: http://www.kuwata-lab.com/erubis/users-guide.06.html#topics-trimspaces I guess thats it
[2013-08-08 13:34:57 -0400] joelnn: konopka: I see, thanks
[2013-08-08 13:36:08 -0400] joelnn: bcave: if you've found a problem in the ruby core library (casecmp) I will be amazed :)
[2013-08-08 13:37:23 -0400] joelnn: bcave: casecmp returns 0 for case insensitive equality :)
[2013-08-08 13:38:36 -0400] joelnn: bcave: maybe @environment.downcase == "prod" would be clearer
[2013-08-08 13:43:07 -0400] jbz: Has anyone here run into a gem conflict between vagrant and test-kitchen, apparently over net-scp versions?  If so, anyone have a pointer to a fix?
[2013-08-08 13:45:38 -0400] prognostikos: jbz: if you use the stand-alone installer for vagrant there shouldn't be conflicts
[2013-08-08 13:46:18 -0400] jbz: prognostikos Ah, thank you.  Will give that a shot.
[2013-08-08 13:47:53 -0400] jbz: hm, test-kitchen is pulling it back in...?
[2013-08-08 13:47:54 -0400] jbz: lol
[2013-08-08 13:48:31 -0400] prognostikos: jbz, yes but it should be a compatible version?
[2013-08-08 13:48:44 -0400] jbz: no, same problem
[2013-08-08 13:49:48 -0400] prognostikos: jbz which version of test-kitchen?
[2013-08-08 13:50:15 -0400] jbz: AH whoop, forgot --pre
[2013-08-08 13:50:16 -0400] jbz: derp
[2013-08-08 13:57:06 -0400] bcave: joelnn... yeah, that's probably a better approach
[2013-08-08 13:57:44 -0400] cpuguy83: Before I go to far... does anyone know what chef-server will do with multiple clients that have the same hostnames/FQDN?
[2013-08-08 13:58:20 -0400] jbz: cpuguy83 Should be fine so long as they have different node names
[2013-08-08 13:59:01 -0400] cpuguy83: jbz: And nodename is generated from the clients hostname... unless I pre-create them in the server?
[2013-08-08 13:59:43 -0400] jbz: cpuguy83 It's generated on registration.  You can register the node with a different name; you can specify the nodename on registration.
[2013-08-08 13:59:54 -0400] cpuguy83: aah, fun.
[2013-08-08 14:00:59 -0400] bcave: .downcase method works well
[2013-08-08 14:01:12 -0400] cpuguy83: jbz: node_name in client.rb?
[2013-08-08 14:01:15 -0400] bcave: not sure why the casecmp wasn't working in the ERB
[2013-08-08 14:02:54 -0400] jbz: cpuguy83 That sounds right, but I'm not totally certain (or able to test right now) so trust but verify. :-)
[2013-08-08 14:07:53 -0400] RayS: tring to install aspell dictionaries but package "aspell-*" fails, any work arounds
[2013-08-08 14:09:37 -0400] cpuguy83: jbz: Yep, that's the option.
[2013-08-08 14:09:52 -0400] jbz: cpuguy83: sweet.
[2013-08-08 14:23:55 -0400] ribo: Good wife best household furniture. - Charlie Chan
[2013-08-08 14:25:21 -0400] ribo: Good wife best household furniture. - Charlie Chan
[2013-08-08 14:33:57 -0400] devinus: has anybody tried Salt but decided to stick with Chef?
[2013-08-08 14:37:48 -0400] bcave: damn, hosts file management in AWS is a bit of a mission
[2013-08-08 14:41:58 -0400] maruq: bcave: we got around a fair bit of that with Route 53
[2013-08-08 14:49:17 -0400] bcave: yeah, we're busy investigating that now
[2013-08-08 14:50:26 -0400] bcave: but got a cookbook
[2013-08-08 14:51:32 -0400] cpuguy83: Would be awesome if chef had an option to change default node_name to something else, such as the first MAC address or something.... coding this in the client.rb just doesn't feel nice.
[2013-08-08 14:52:02 -0400] sunil_: anyone have experience troubleshooting private chef server issues?  I am running into an issue where it hangs on resolving cookbooks for new clients..
[2013-08-08 14:53:58 -0400] bcave: it would cpuguy
[2013-08-08 14:54:15 -0400] doublerr: Im having a heck of a time trying to install a chef_gem inside of a minitest, can anyone help me out?
[2013-08-08 14:54:17 -0400] bcave: at the moment I'm setting the content of /etc/hostname to node.name
[2013-08-08 14:54:35 -0400] bcave: and then notifying a bash resource to write to /etc/hosts
[2013-08-08 14:55:14 -0400] bcave: doublerr: what issue are you having?
[2013-08-08 14:55:17 -0400] cpuguy83: bcave: Unfortunately I have to deal with a bunch of Windows nodes (oh, about 135).  These get swapped around frequently and setting hostnames is just not feasible
[2013-08-08 14:55:29 -0400] bcave: ah, ok
[2013-08-08 14:56:07 -0400] cpuguy83: i connect to them soley by IP address, so no FQDN's or hostname resolution or anything.
[2013-08-08 15:00:26 -0400] jtimberman: cpuguy83: bcave you can totally do that :)
[2013-08-08 15:00:38 -0400] cpuguy83: jtimberman: oh?
[2013-08-08 15:05:00 -0400] sunil_: does anyone know what does chef server uses on the backend when resolving cookbooks for clients?  is it erchef doing the heavy lifting here?
[2013-08-08 15:06:04 -0400] jtimberman: https://gist.github.com/jtimberman/e9885619508d2d9215ce
[2013-08-08 15:06:25 -0400] jtimberman: sunil_: there's a part of the server called depsolver that does the dependency resolution
[2013-08-08 15:08:10 -0400] sunil_: thanks jtimberman - does it log anywhere specifically?  I have a chef server thats running low/high on cpu load, initially bumped the limit to help but not can't get any cookbooks to resolve.this is 11.0.8
[2013-08-08 15:09:39 -0400] jtimberman: sunil_: i don't know off hand
[2013-08-08 15:10:44 -0400] jtimberman: i imagine it's in the erchef logs
[2013-08-08 15:11:26 -0400] cpuguy83: jtimberman: brilliant
[2013-08-08 15:11:47 -0400] cpuguy83: Much better than trying to sed/awk/grep the ipconfig output
[2013-08-08 15:11:57 -0400] cpuguy83: or even getmac
[2013-08-08 15:19:39 -0400] cpuguy83: So I've got a client on my chef-server that when I hit delete it throws a missing template error.  Client still shows up in the list.  If I try to click it I get a 404 "Object Not Found"
[2013-08-08 15:19:47 -0400] cpuguy83: So I've got this phantom object in my client list.
[2013-08-08 15:23:18 -0400] volker-: what is the best practise to transport private server certs? The certificate/README.md states to copy them to the cookbook, where you definitly do not want to check it in. Using an enrypted databag is not that pretty, because you have to deal with linebreaks etc.
[2013-08-08 15:24:37 -0400] stormerider: volker-: istr there was a discussion about that on the list recently, there's a cookbook for just that purpose
[2013-08-08 15:27:33 -0400] jtimberman: volker-: secret management is a really hard problem generally speaking. Chef has ways to help (like encrypted data bags), but like any other solution for the problem, there's a lot of pushing the peas aroudn the plate.
[2013-08-08 15:28:03 -0400] volker-: stormerider: do you know when or know the subject of the thread?
[2013-08-08 15:28:36 -0400] stormerider: volker-: recently and no. i remember certificate was one cb mentioned but there was also another.
[2013-08-08 15:28:57 -0400] volker-: jtimberman: secret in encrypted databags is fine so far, it is just a mess when it comes to entire files.
[2013-08-08 15:29:23 -0400] volker-: (puppet seems to be able to deal with it... I just saw it when rewriting the puppet stuff for chef)
[2013-08-08 15:30:17 -0400] volker-: stormerider: can you define "recently" a little bit more? like 2 weeks ago or more 4 weeks ago
[2013-08-08 15:30:35 -0400] cpuguy83: You could store your keys in a safe place, then in a cookbook it would tell the server "go get these keys from here"... being secure is difficult.
[2013-08-08 15:30:42 -0400] cpuguy83: Heck, not even SSL is secure anymore.
[2013-08-08 15:31:27 -0400] siezer: cpuguy83 how do you securely get the keys from 'there' ;)
[2013-08-08 15:31:28 -0400] bean: "not even SSL is secure any more"
[2013-08-08 15:31:29 -0400] bean: that depends.
[2013-08-08 15:31:36 -0400] cpuguy83: siezer: SSH
[2013-08-08 15:32:31 -0400] jtimberman: volker-: how does puppet deal/solve the issue?
[2013-08-08 15:32:53 -0400] volker-: jtimberman: nginx_server.pem:    source => 'puppet:///nginx/server.pem',
[2013-08-08 15:33:37 -0400] ggolin_: hello all.
[2013-08-08 15:34:50 -0400] volker-: jtimberman: don't ask me how that works. I am not a puppet guy.
[2013-08-08 15:35:19 -0400] cpuguy83: volker-: Looks like how Salt does it as well.
[2013-08-08 15:35:44 -0400] volker-: I would be fine with an in Chef included encrypted-file-databag
[2013-08-08 15:36:03 -0400] volker-: Or I write myself a script which deals with files to encrypted databag
[2013-08-08 15:37:15 -0400] volker-: I just havent seen much progress here without yet-another-hack-workaround-and-best-practise-guideline since I digged into it thee last time 2yrs ago
[2013-08-08 15:37:23 -0400] stormerider: volker-: [chef] RFC: ssl-key-management via chef-lwrp, i believe, points to the x509 cb
[2013-08-08 15:37:43 -0400] jtimberman: volker-: so that's just putting the file in a distributable location on the puppetmaster, and as far as i remember, that means it's in clear text on the master's filesystem. that's the moral equivalent to putting the file in a cookbook files directory.
[2013-08-08 15:38:02 -0400] stormerider: jtimberman is correct (ive used puppet)
[2013-08-08 15:38:40 -0400] jtimberman: My puppet use was 5 years ago, so I'm a bit rusty on details. :)
[2013-08-08 15:39:11 -0400] stormerider: i havent used puppet much in the last 2 or so years, but still maintain a setup on our legacy platform
[2013-08-08 15:39:27 -0400] cpuguy83: There would need to be a mechanism where when a file is uploaded to the server the server would need to know that it should be encrypted, then the server would have to store encrypted, then when it is requested decrypt it, or give the node the means to decrypt it.
[2013-08-08 15:39:30 -0400] jtimberman: sunil_: there may be an additional configuration setting to enable more logging from depsolver, and i think it might be only in a nightly build. i was pointed to this ticket: http://tickets.opscode.com/browse/CHEF-3921
[2013-08-08 15:40:07 -0400] sunil_: thanks jim, yeah I have been reading this ticket..
[2013-08-08 15:40:40 -0400] sunil_: can I export all the data from this server to a newly installed one with a newer version?
[2013-08-08 15:41:43 -0400] yruss972: Hi- anyone here can give some love to this ticket: http://tickets.opscode.com/browse/CHEF-4068 ?
[2013-08-08 15:42:10 -0400] volker-: btw., how do you guys store  your encrypted data(bags) without checking them in a repo
[2013-08-08 15:42:40 -0400] tabolario: volker- yeah i just use encrypted data bags and put the certs as one line right in there and then use that as the `source` in a file resource
[2013-08-08 15:42:54 -0400] tabolario: volker- i just put them on the chef server
[2013-08-08 15:43:13 -0400] volker-: tabolario: that's hackish and if the file is pure binary its becomming more a mess.
[2013-08-08 15:44:01 -0400] tabolario: yeah :/ it's the best i've been able to come up with so far
[2013-08-08 15:44:19 -0400] tabolario: i haven't had to deal with anything beyond certs and private keys though
[2013-08-08 15:44:35 -0400] tabolario: what kind of binary files are you working with?
[2013-08-08 15:49:58 -0400] volker-: certs, licenses. Some can be transformed, but that would be just yet-another-workaround
[2013-08-08 15:50:53 -0400] captainhaddock: newbie .. using chef-solo with run_list: [recipe[yum], recipe[nginx]] and it complains "Cookbook apt not found" .. running on Amazon Linux which from what I see should map to "rhel" for platform_family
[2013-08-08 15:51:17 -0400] captainhaddock: how do I force it to rhel
[2013-08-08 15:52:17 -0400] spox: captainhaddock: you need to include the apt cookbook
[2013-08-08 15:52:28 -0400] spox: it won't be used, but it's a dependency so it just needs to be present
[2013-08-08 15:52:46 -0400] captainhaddock: on a rhel based linux????
[2013-08-08 15:53:11 -0400] spox: captainhaddock: again, it's a dependency so it needs to be included. it won't actually be used
[2013-08-08 15:53:26 -0400] captainhaddock: ok .. will give a go .. thx
[2013-08-08 15:53:30 -0400] spox: just like if you were on a debian platform, the yum cookbook is still required because it's a dependency, but it's not used
[2013-08-08 15:54:26 -0400] tabolario: volker- haven't played with this yet but https://github.com/Nordstrom/chef-vault
[2013-08-08 15:54:55 -0400] ggolin_: i think im missing something here.. trying out chef-zero, specifically for the search capabilities.. i have serialized node data uploaded to chef-zero, i get the nodes returned as search results, but the node objects lack the fqdn attribute.
[2013-08-08 15:55:00 -0400] ggolin_: what am i doing wrong her
[2013-08-08 15:55:01 -0400] ggolin_: e
[2013-08-08 15:55:02 -0400] volker-: captainhaddock: there is often a long dependency chain of other (unused) cookbooks. Chef will complain if it is not there (because it is defined as dependency) but not used depending on the case
[2013-08-08 15:55:04 -0400] pontiki: the cookbook is the dependency, not the actual apt program, just to be clear?
[2013-08-08 15:55:28 -0400] tabolario: also https://github.com/3ofcoins/knife-briefcase
[2013-08-08 15:56:01 -0400] ggolin_: they have a .name method
[2013-08-08 15:56:47 -0400] volker-: tabolario: thanks.
[2013-08-08 15:57:09 -0400] tabolario: volker- i've been meaning to look at both of those tools more closely to see if they might be a better approach than just encrypted data bags
[2013-08-08 15:57:10 -0400] cpuguy83: pontiki: yep https://github.com/opscode-cookbooks/nginx/blob/master/metadata.rb#L15
[2013-08-08 15:57:25 -0400] pontiki: ta
[2013-08-08 15:57:34 -0400] tabolario: volker- did you watch that foodfight show episode on secret data?
[2013-08-08 15:57:42 -0400] tabolario: there was some good discussion there
[2013-08-08 15:58:12 -0400] volker-: tabolario: even with encrypted data bags you need to get the data bag key to the node. so technically you always need to copy something from somewhere.
[2013-08-08 15:58:30 -0400] volker-: tabolario: not yet, am far behind the foodfightshow
[2013-08-08 15:58:52 -0400] tabolario: yeah, right now i end up distributing that secret via knife bootstrap when i'm creating the node
[2013-08-08 16:00:14 -0400] mattupstate: i feel crazy, knife data bag from file isn't working at all for me
[2013-08-08 16:00:34 -0400] ggolin_: paste your command mattupstate
[2013-08-08 16:00:42 -0400] ggolin_: its a bit counterintuitive
[2013-08-08 16:01:07 -0400] mattupstate: knife data bag from file <app-name> settings data_bags/<app-name>/settings.json --secret-file ~/.chef/encrypted_data_bag_secret
[2013-08-08 16:01:21 -0400] mattupstate: ERROR: Could not find or open file 'settings' in current directory or in 'data_bags/<app-name>/settings'
[2013-08-08 16:01:30 -0400] mattupstate: i've tried various permutations of that as well
[2013-08-08 16:03:15 -0400] ggolin_: what is this app-name
[2013-08-08 16:03:30 -0400] ggolin_: mattupstate,
[2013-08-08 16:03:41 -0400] mattupstate: ggolin: i replaced it since its sort of sensitive
[2013-08-08 16:04:02 -0400] ggolin_: knife data bag bag_name from file path/to/file
[2013-08-08 16:04:16 -0400] ggolin_: try that
[2013-08-08 16:04:36 -0400] mattupstate: thats not what the docs say at all
[2013-08-08 16:05:01 -0400] ggolin_: sorry
[2013-08-08 16:05:05 -0400] ggolin_: here's mine knife data bag from file users ../users
[2013-08-08 16:05:19 -0400] G________: does anyone have experience with the current version of chef-zero?
[2013-08-08 16:05:33 -0400] ggolin_: G________, im using it right now. "experience".
[2013-08-08 16:05:49 -0400] ggolin_: im having and "experience" with it.
[2013-08-08 16:05:52 -0400] ggolin_: and/an
[2013-08-08 16:05:54 -0400] chalettu: haha
[2013-08-08 16:06:11 -0400] chalettu: yeah, I installed it the other day and have it working fine except nothing in search works
[2013-08-08 16:06:15 -0400] chalettu: at all
[2013-08-08 16:06:22 -0400] ggolin_: yeah thats my experience as well
[2013-08-08 16:06:32 -0400] ggolin_: there's one bug open against it, regarding search.
[2013-08-08 16:06:46 -0400] ggolin_: dashes are misinterpreted, from what i understands.
[2013-08-08 16:06:58 -0400] chalettu: ah
[2013-08-08 16:07:13 -0400] ggolin_: search sucks for me as well
[2013-08-08 16:07:22 -0400] ggolin_: although, let me check something...
[2013-08-08 16:08:14 -0400] mattupstate: ggolin: ERROR: Chef::Exceptions::InvalidDataBagItemID: Data Bag items must have an id matching /^[\-[:alnum:]_]+$/, you gave: nil
[2013-08-08 16:09:04 -0400] ggolin_: mattupstate, that looks like you have an id problem inside your databag?
[2013-08-08 16:09:37 -0400] ggolin_: chalettu, i remember from the docs something about client.pem
[2013-08-08 16:09:53 -0400] mattupstate: ggolin: thats it, thanks
[2013-08-08 16:09:57 -0400] chalettu: hmm
[2013-08-08 16:10:32 -0400] chalettu: the error from the chef zero server is #<TypeError: can't convert Fixnum into String>
[2013-08-08 16:11:50 -0400] ggolin_: chalettu, gist the code
[2013-08-08 16:13:11 -0400] ggolin_: i have things like roles << search(:role, *:*).each { |r| r.name }
[2013-08-08 16:13:32 -0400] alex88: hi guys, I'm using chef_gem to install the mysql gem, it doesn't give any error but then require 'mysql' says no such file to load 'mysql'..any idea?
[2013-08-08 16:13:49 -0400] ggolin_: alex88, i think you have to reload the context
[2013-08-08 16:13:56 -0400] ggolin_: there's a bit on opscode.com about this
[2013-08-08 16:14:06 -0400] alex88: Gem.clear_paths?
[2013-08-08 16:14:22 -0400] ggolin_: iirc
[2013-08-08 16:15:46 -0400] chalettu: ggolin_ https://gist.github.com/chale-tt/6186051
[2013-08-08 16:15:54 -0400] MoonMan_: Hey guys. I'm implementing chef for a linux project for work, and I'm having trouble with the steep learning curve and figuring out what the common practice for doing certain things is. Could anyone help me out a little?
[2013-08-08 16:16:29 -0400] ggolin_: chalettu, sorry man
[2013-08-08 16:16:31 -0400] ggolin_: no clue
[2013-08-08 16:16:46 -0400] ggolin_: MoonMan_, actual question please :)
[2013-08-08 16:16:51 -0400] chalettu: yeah, any search I try and do tanks with this error
[2013-08-08 16:17:17 -0400] ggolin_: chalettu, i can suggest trying a later ruby version.
[2013-08-08 16:17:33 -0400] chalettu: i was thinking yesterday about trying that
[2013-08-08 16:18:30 -0400] ggolin_: chalettu, i'd get off 1.8 if i could.
[2013-08-08 16:19:44 -0400] MoonMan_: ggolin_:  Well to start off, it's a raspberry pi running raspbian, which is a modified version of debian. I'm trying to configure a wifi network adapter as the first step, and that involves changing configuration files. I'm wondering if the best practice is to download complete config files from a central repository, or to write chef recipes that change and write config files line by line.
[2013-08-08 16:20:14 -0400] ggolin_: MoonMan_, id say the latter.
[2013-08-08 16:20:43 -0400] ggolin_: MoonMan_, consider having to write different config files for different pi's. this would get old, fast.
[2013-08-08 16:21:55 -0400] MoonMan_: Right, that would be very time consuming. So you're saying it might be a good idea to explore how to fetch configuration files from version control using a recipe custom built for the task, then put them into place?
[2013-08-08 16:22:08 -0400] MoonMan_: Do you know of any existing recipes that do anything similar?
[2013-08-08 16:23:52 -0400] ggolin_: im saying write templated config files
[2013-08-08 16:24:12 -0400] ggolin_: i suggest you take a look at opscode-cookbooks github repo and see what you can find
[2013-08-08 16:25:38 -0400] MoonMan_: ggolin_:  Thanks, I'll check that out. I'll look into how to write templates config files, but my knowledge of ruby isn't the strongest. Are there any prebuilt chef modules/recipes that would provide a good example for me?
[2013-08-08 16:26:06 -0400] ggolin_: that place have so many examples of how to do what
[2013-08-08 16:26:24 -0400] ggolin_: have/has
[2013-08-08 16:26:25 -0400] ggolin_: eesh
[2013-08-08 16:26:27 -0400] MoonMan_: ggolin_:  Great, I'll go check that out. Thanks man.
[2013-08-08 16:26:52 -0400] jbz: MoonMan_ also, if you haven't, start with http://docs.opscode.com/resource_template.html and look at 'Using Templates', there are short examples
[2013-08-08 16:27:18 -0400] jbz: The example there is a sudoers conf file.
[2013-08-08 16:27:26 -0400] MoonMan_: jbz: Haven't started with resource templates yet. I'll look into that too.
[2013-08-08 16:27:30 -0400] ggolin_: great advice
[2013-08-08 16:27:51 -0400] jbz: MoonMan_ The template resource is necessary to do templated files, that's how it's controlled
[2013-08-08 16:27:52 -0400] ggolin_: ok. so. chef-zero search does not work. it _seems_.
[2013-08-08 16:28:27 -0400] jbz: It's a confusing title; they don't mean a template of a resource, they mean the template resource type :-) :-)
[2013-08-08 16:29:11 -0400] MoonMan_: jbz: Yes, it's all very confusing and new to me. I've never worked with ruby so it's going to be a very steep learning curve for me.
[2013-08-08 16:29:24 -0400] MoonMan_: I'm more of a javascript/node kinda guy :P
[2013-08-08 16:30:10 -0400] alex88: ggolin_: same thing :( any other idea?
[2013-08-08 16:30:20 -0400] ggolin_: alex88, are you doing it in a ruby block and what not?
[2013-08-08 16:30:39 -0400] alex88: ggolin_: http://pastie.org/8219085
[2013-08-08 16:31:06 -0400] ggolin_: alex88, yeah that wont work
[2013-08-08 16:31:14 -0400] alex88: good
[2013-08-08 16:31:15 -0400] ggolin_: you need that to execute earlier
[2013-08-08 16:31:58 -0400] alex88: ggolin_: http://pastie.org/pastes/8219088/text
[2013-08-08 16:32:00 -0400] jbz: MoonMan_Yeah.  I was super, super frustrated when I was trying to learn Chef, b/c I was also unfamiliar with Ruby.  The two together make for a steep curve, but
[2013-08-08 16:32:09 -0400] alex88: which one? mysql client dev and chef gem already had installed
[2013-08-08 16:32:11 -0400] alex88: isn't it?
[2013-08-08 16:32:12 -0400] jbz: try to have faith that when you get over the hump, it'll be beautiful. :-)
[2013-08-08 16:32:31 -0400] MoonMan_: jbz: I'll stick with it until I see the beauty, thanks :)
[2013-08-08 16:33:39 -0400] jbz: First time I looked up and realized I'd pushed a config change which involved software install to > 200 nodes with 30 seconds of work I think I laughed for a couple minutes.
[2013-08-08 16:33:44 -0400] alex88: ggolin_: what should be executed earlier?
[2013-08-08 16:33:53 -0400] ggolin_: alex88, sorry that was misleading
[2013-08-08 16:33:56 -0400] ggolin_: er, wrong
[2013-08-08 16:33:58 -0400] ggolin_: :)
[2013-08-08 16:34:07 -0400] alex88: ggolin_: oook, then what's wrong with that?
[2013-08-08 16:34:16 -0400] ggolin_: i mean what i told you was wrong :)
[2013-08-08 16:34:23 -0400] ggolin_: the 'earlier' bit
[2013-08-08 16:34:29 -0400] alex88: oh ok, so that should be fine?
[2013-08-08 16:35:07 -0400] ggolin_: alex88, you looked at this here? http://www.opscode.com/blog/2009/06/01/cool-chef-tricks-install-and-use-rubygems-in-a-chef-run/
[2013-08-08 16:35:31 -0400] ggolin_: because that worked for me in the past
[2013-08-08 16:35:41 -0400] ggolin_: i dont know how else to do it :/
[2013-08-08 16:36:04 -0400] alex88: well seems the same
[2013-08-08 16:38:20 -0400] pontiki: that is a neat trick, ggolin_
[2013-08-08 16:39:03 -0400] ggolin_: it aint mine, pontiki :)
[2013-08-08 16:41:12 -0400] pontiki: yeah, but thanks for pointing that out
[2013-08-08 16:53:43 -0400] dgarstang: What's the best way to handle a simple cookbook dependancy? Application cookbook needs java cookbook. Put a depends in metadata? Use a "include_recipe"?
[2013-08-08 16:53:46 -0400] jbz: Does anyone know if there's a release date for 11.10-server?
[2013-08-08 16:54:08 -0400] jbz: dgarstang: you need to put the depends in the metadata and then use include to actually execute it.
[2013-08-08 16:54:52 -0400] dgarstang: jbz: could have sworn I'd done the include without the metadata bit ...
[2013-08-08 16:55:20 -0400] jbz: dgerstang:  It might work if the dependency cookbook is already loaded so no error happens, but I doubt it
[2013-08-08 16:55:34 -0400] jbz: everything normally pitches a fit if you try to include a cookbook that wasn't mentioned in the deps :-)
[2013-08-08 16:56:00 -0400] dgarstang: jbz: docs say "When the match exists, the Chef Server will include the dependency as part of the set of cookbooks that are sent to the node when the chef-client runs."... seems to imply to me that the include isn't required.
[2013-08-08 16:56:27 -0400] jbz: That will *send the cookbook to the node*.  If you want to be sure the cookbook gets *executed*, you have to have it in the runlist or do an include.
[2013-08-08 16:56:30 -0400] dgarstang: jbz: I've definitely done an include without the depends and didn't get errors.
[2013-08-08 16:56:42 -0400] alex88: ggolin_: gem_path = Gem.path.first \n $LOAD_PATH << "#{gem_path}/gems/mysql-2.9.1/lib"
[2013-08-08 16:56:43 -0400] alex88: and it worked
[2013-08-08 16:57:00 -0400] jbz: dgarstang: For a separate cookbook, not a recipe in the same cookbook?
[2013-08-08 16:57:08 -0400] dgarstang: I didn't even know about the depends until yesterday.
[2013-08-08 16:57:08 -0400] ggolin_: alex88, wow. gnarly.
[2013-08-08 16:57:10 -0400] dgarstang: jbz: Yes
[2013-08-08 16:57:18 -0400] dgarstang: jbz: ok, maybe no...
[2013-08-08 16:57:20 -0400] jbz: OK, well, unsure then.  I was taught (by experience and docs) to *always* maitnain my includes.
[2013-08-08 16:57:35 -0400] jbz: *maintain even.
[2013-08-08 16:58:18 -0400] jbz: Think of it this way - the metadata 'depends' is so that the server can handle dependency tracking when making up manifests of which cookbooks nodes should download.  That doesn't execute any code though.
[2013-08-08 16:58:29 -0400] dgarstang: jbz: jbz: k
[2013-08-08 16:58:33 -0400] jbz: The include statement triggers compilation and execution of the specified cookbook.
[2013-08-08 16:58:58 -0400] jbz: And compilation happens *after* cookbook download, so if it wasn't in depends, that will cause an error if it's not available.
[2013-08-08 16:59:01 -0400] alex88: ggolin_: tricky but it worked
[2013-08-08 16:59:32 -0400] ggolin_: alex88, this will break when the gem is updated to a newer version
[2013-08-08 16:59:51 -0400] alex88: ggolin_: I've added the version to chef_gem
[2013-08-08 17:00:13 -0400] ggolin_: i suggest you pull it up into the attributes
[2013-08-08 17:00:18 -0400] ggolin_: if you have not done that already
[2013-08-08 17:00:52 -0400] alex88: ggolin_: the version? not yet, thanks for the tip! ;)
[2013-08-08 17:01:01 -0400] dgarstang: Seems silly to me that I need to put a depend on an entire cookbook just to get a single recipe
[2013-08-08 17:01:19 -0400] ggolin_: alex88, and then use it both in the resource and the gem.clearpath path
[2013-08-08 17:01:23 -0400] ggolin_: yw :)
[2013-08-08 17:01:38 -0400] jve_: dgarstang, no way to know what the recipe depends on...templates, files, attributes, etc
[2013-08-08 17:01:40 -0400] alex88: ggolin_: yeah, btw not the clear_path since I've removed that
[2013-08-08 17:04:06 -0400] dgarstang: jve_: if I have a cookbook that has two recipies... one requiring java and one requiring python, that cookbook needs to depend on both the cookbooks providing java and python.
[2013-08-08 17:04:30 -0400] jve_: yup
[2013-08-08 17:04:56 -0400] dgarstang: jve_ :(
[2013-08-08 17:05:10 -0400] jbz: dgarstang: Assuming you're not assuming that those langs are avail on your base node, yes.
[2013-08-08 17:05:31 -0400] jve_: dgarstang: it also might suggest that your cookbook might be better factored as smaller cookbooks
[2013-08-08 17:05:43 -0400] dgarstang: jve_: Troo.
[2013-08-08 17:08:37 -0400] chalettu: ggolin_ . Looks like upgrading ruby seemed to fix my issue
[2013-08-08 17:08:50 -0400] ggolin_: chalettu, good times.
[2013-08-08 17:09:00 -0400] ggolin_: reading documentation fixed my issue :P
[2013-08-08 17:09:21 -0400] chalettu: its funny, i had the same thought you did about upgrading ruby yesterday.  I just didnt try it until today
[2013-08-08 17:17:12 -0400] MoonMan_: Quick question. When writing a cookbook template to add strings in a configuration file, is it best to delete the file first then create a new one with the required data in order to keep variations at a minimum, or is modifying a file the best practice? I don't see modify as any of the resource actions. Would it be touch?
[2013-08-08 17:17:52 -0400] jbz: MoonMan_:  Templates don't modify.  They overwrite.
[2013-08-08 17:18:12 -0400] jbz: To use a templated configuration fire, you need to make sure the template can fully write the complete config every time Chef runs.
[2013-08-08 17:18:49 -0400] MoonMan_: I see, thanks for the clarification.
[2013-08-08 17:19:04 -0400] jbz: If you have a config file which has an unknown-in-advance number of similar stanzas, you can use ruby in the erb template to loop and generate each stanza needed based on attribute inputs (arrays, hashes, etc.)
[2013-08-08 17:19:09 -0400] tabolario: wow, knife-server is great :D
[2013-08-08 17:19:32 -0400] MoonMan_: jbz: That's a great alternative to deleting and recreating each config file.
[2013-08-08 17:19:46 -0400] tabolario: encrypted tarball backups of our chef server to s3 or something are going to be a breeze now
[2013-08-08 17:20:13 -0400] jbz: MoonMan_:  You won't have to delete it :-)  If Chef is given a template resource and a file exists there, if the file that's there doesn't checksum the same as what Chef thinks it should look like, it'll just overwrite.
[2013-08-08 17:21:31 -0400] MoonMan_: jbz: Makes total sense. Thanks
[2013-08-08 17:21:36 -0400] jbz: yw!
[2013-08-08 17:29:07 -0400] jve: is it possible for a chef exception handler to get the stdout/stderr of the last command (in the case that the last command was an "execute" block)?
[2013-08-08 17:30:43 -0400] dgarstang: That sucks. I was gonna use the community python cookbook, but it be broke. I'm on Ubuntu and it REQUIRES yum. Fail.
[2013-08-08 17:31:12 -0400] alexbst: does it require apt too
[2013-08-08 17:31:15 -0400] alexbst: (?)
[2013-08-08 17:31:38 -0400] dgarstang: alexbst: I don't know. Never got that far. Fails cuz the yum cookbook isn;t there, which I am not going to use
[2013-08-08 17:32:34 -0400] jve: dgarstang: does it hurt to just have it there?
[2013-08-08 17:32:37 -0400] dgarstang: Ok, so how can you wrap a 'depends' in the metadata.rb in a conditional to check the OS?
[2013-08-08 17:32:41 -0400] dgarstang: jve: Yes.
[2013-08-08 17:32:46 -0400] alexbst: dgarstang - quite a few cookbooks that support both ubuntu/deb and rhel/centos/sles require both yum and apt to be present.
[2013-08-08 17:32:48 -0400] jbz: dgarstang: I don't think you can
[2013-08-08 17:32:55 -0400] jbz: dgarstang: That gets eval-ed on the serverside
[2013-08-08 17:32:59 -0400] dgarstang: jbz: Well that's rotten
[2013-08-08 17:33:12 -0400] alexbst: there is nothing wrong with providing the yum cookbook in a debian-style environment - it just doesn't get used.
[2013-08-08 17:33:13 -0400] tabolario: it doesn't actually install yum
[2013-08-08 17:33:13 -0400] dgarstang: jbz: Generally that's not good... if the depends have to be hardcoded.
[2013-08-08 17:33:35 -0400] jbz: tabolario is right, all that means is that you need the cookbook on the server and it will be downloaded.  It won't be executed unless needed.
[2013-08-08 17:34:04 -0400] dgarstang: alexbst: the docs say "When the match exists, the Chef Server will include the dependency as part of the set of cookbooks that are sent to the node" ...
[2013-08-08 17:34:11 -0400] jbz: yes, the cookbook will get downloaded
[2013-08-08 17:34:14 -0400] jbz: but it won't get *executed*.
[2013-08-08 17:34:18 -0400] jbz: And cookbooks are really small.
[2013-08-08 17:34:26 -0400] dgarstang: hm
[2013-08-08 17:34:39 -0400] dgarstang: well if that's a limitation, i guess I gotta live with it
[2013-08-08 17:34:56 -0400] jbz: Alternately, you could fork the cookbook and remove the yum dep, but then you have to actively maintain it.
[2013-08-08 17:35:45 -0400] dgarstang: jbz: lemme try just commenting out the depends.
[2013-08-08 17:35:47 -0400] alexbst: dgarstang - fwiw I vaguely freaked out the first time I saw it mentioning the yum cookbook in our ubuntu environments.
[2013-08-08 17:35:53 -0400] qhartman: Do :notifies get executed if a resource fails and has ignore_failure set to true?
[2013-08-08 17:36:35 -0400] dgarstang: alexbst: like me right now :)
[2013-08-08 17:36:43 -0400] zts: dgarstang: just wait til you use a cookbook that depends on the 'windows' cookbook :)
[2013-08-08 17:37:00 -0400] dgarstang: zts: eeek
[2013-08-08 17:37:04 -0400] zts: dgarstang: if you're happy to maintain local patches, removing the dependencies from metadata.rb should be fine
[2013-08-08 17:37:35 -0400] zts: (on the assumption that if you ran any recipes that dependend on yum being present, they would fail anyway)
[2013-08-08 17:37:40 -0400] dgarstang: zts: yah that seems to work. I don't see us really updating the cookbooks once we grab them. We'll tweak and use internally.
[2013-08-08 17:39:19 -0400] jbz: heh yeah we had a 'base' cookbook that worked on win and linux, and pulled in gobs of cookbooks of both types
[2013-08-08 18:08:24 -0400] castro1688: anyone know how to stop chef from creating chef-rendered-template20130808-947-1d0mynr-0 files in /tmp? or how to specify a different location like /dev/null??
[2013-08-08 18:08:44 -0400] kl4m: Did the search syntax change not long ago? I see search(:node, 'recipes:"collectd::server"') in every fork of the collectd cookbook, but it always raises a Net::HTTPServerException: 400 "Bad Request"
[2013-08-08 18:10:16 -0400] m10n:  /ignore -channels #chef * JOINS PARTS QUITS NICKS
[2013-08-08 18:10:56 -0400] jbz: castro1688: You can't /dev/null that.  It needs a temp location to render templates to.
[2013-08-08 18:11:24 -0400] castro1688: jbz: so i just have to clean them up manually then?
[2013-08-08 18:11:43 -0400] castro1688: manually in the sense write a script...
[2013-08-08 18:13:49 -0400] Boohbah: hi, what's the process for contributing to cookbooks in the https://github.com/cookbooks/ repo? is it similar to other github projects?
[2013-08-08 18:18:42 -0400] sn0wb1rd: Boohbah: It looks like a collection of cookbooks from various sources and most of them are from opscode-cookbooks. Also it doesn't look like it is recently updated.
[2013-08-08 18:19:47 -0400] benkay: dudes
[2013-08-08 18:19:53 -0400] benkay: where does the chef server store roles and things?
[2013-08-08 18:20:57 -0400] benkay: u guise
[2013-08-08 18:27:11 -0400] Sauraus: @Boohbah RTFM :) http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-08-08 18:30:04 -0400] brumschlag: I'm trying to write a custom provider for the file resource. Any thoughts on how to accomplish this? How can I write a provider for a resource that lives in another cookbook?
[2013-08-08 18:31:06 -0400] ahmed_: hi, I have installed chef-server and I dunno which port / url I can use to access the web ui, any help ?
[2013-08-08 18:32:48 -0400] mattp: ahmed_: chef-sever is for the clients to connect to, not for your browser.  you need a separate component for that - called chef-webserver-ui (see http://docs.opscode.com/chef_overview_server.html)
[2013-08-08 18:32:53 -0400] dgarstang: be nice if the general approach to installing packages from the community cookbooks was to let us specify the install location in an attribute, rather than grabbing the package from an arbitrary PPA
[2013-08-08 18:34:16 -0400] amccloud: When setting environment in execute resource is it possible to use existing environment variables? e.g. 'PATH' => '$HOME/bin:$PATH'
[2013-08-08 18:35:38 -0400] tabolario: amccloud: well you could use ruby's ENV facility, keep in mind that the environment there will be the one that the chef user is running in
[2013-08-08 18:38:16 -0400] amccloud: tabolario: Yea, that won't work for me.Would that be the case even if I pass the user? I see mixliv:shellout sets Process.euid and Process.uid
[2013-08-08 18:39:47 -0400] tabolario: yes i believe it still would, i don't think changing those will make a difference to ruby's ENV (i could be mistaken)
[2013-08-08 18:41:59 -0400] amccloud: meh, I'll just create a .env file and source that before the command
[2013-08-08 18:42:05 -0400] ahmed_: mattp : I have installed chef-server-webui-10.26.0 but still can't open the web ui
[2013-08-08 18:42:38 -0400] tabolario: i use chpst for those kinds of things
[2013-08-08 18:51:26 -0400] bean: ahmed_: does it give you any helpful errors?
[2013-08-08 18:53:25 -0400] amccloud: tabolario: hmm, i've never used chpst
[2013-08-08 18:55:25 -0400] tabolario: it comes with runit, allows you to change various things about a process you want to execute like the user; it lets you pass a directory that contains files representing environment variables
[2013-08-08 18:55:50 -0400] tabolario: so what i do with chef is get my environment variables from a data bag and use chef to create a directory with a file for each environment variable
[2013-08-08 19:12:01 -0400] dgarstang: Can someone tell me why this isn't starting the statsd service? http://pastebin.com/Je3uaAis
[2013-08-08 19:15:18 -0400] adnichols: dgarstang Can I assume that 'service statsd start' works manually?
[2013-08-08 19:15:25 -0400] dgarstang: adnichols: It does
[2013-08-08 19:15:52 -0400] dgarstang: adnichols: Hm, it thinks it's starting it... I see "service[statsd] action start (statsd::default line 35)"
[2013-08-08 19:16:14 -0400] dgarstang: adnichols: but no process, and no reference to it starting and then stopping in the logs
[2013-08-08 19:16:24 -0400] adnichols: well yeah, there are two bits - is it taking action to start it and is the process actually starting & staying running
[2013-08-08 19:16:50 -0400] adnichols: what platform is this?
[2013-08-08 19:17:06 -0400] dgarstang: adnichols: based on output above, it's taking action to start. However, when I run it manually, it does stay running
[2013-08-08 19:17:16 -0400] dgarstang: adnichols: Ubuntu 12.04
[2013-08-08 19:17:36 -0400] adnichols: is it an upstart script or init.d?
[2013-08-08 19:18:04 -0400] dgarstang: adnichols: upstart...
[2013-08-08 19:18:24 -0400] dgarstang: adnichols: with a symlink from /etc/init.d/statsd. Dunno where that came from. :)
[2013-08-08 19:18:24 -0400] adnichols: yeah, I've always had to define the provider in the service in order to use upstart on ubuntu
[2013-08-08 19:18:34 -0400] dgarstang: adnichols: kk, will try. Tanx
[2013-08-08 19:20:20 -0400] adnichols: The symlink is probably why it's not failing when  using init - normally it'd complain that it can't find the service if you don't have the provider defined
[2013-08-08 19:22:44 -0400] jmickle: dgarstang: where is your upstart config?
[2013-08-08 19:23:04 -0400] jmickle: init.d and upstart have no bearing on each other
[2013-08-08 19:23:20 -0400] adnichols: I assumed it was provided by the statsd package
[2013-08-08 19:24:05 -0400] jmickle: depends on the package
[2013-08-08 19:24:10 -0400] adnichols: of course :)
[2013-08-08 19:24:12 -0400] jmickle: and wether your package wants to use init.d
[2013-08-08 19:24:14 -0400] jmickle: or upstart
[2013-08-08 19:24:20 -0400] jmickle: but upstart and init.d are not related
[2013-08-08 19:24:30 -0400] adnichols: correct they are not
[2013-08-08 19:24:56 -0400] jmickle: sooooo that recipe is looking for an upstart script
[2013-08-08 19:24:57 -0400] jmickle: :-P
[2013-08-08 19:25:17 -0400] adnichols: well, service statsd start works
[2013-08-08 19:25:23 -0400] adnichols: so there's an init script somewhere that's working
[2013-08-08 19:25:40 -0400] jmickle: yeah service is upstart
[2013-08-08 19:25:48 -0400] jmickle: inside of /etc/init/statsd.conf
[2013-08-08 19:25:50 -0400] adnichols: it isn't exclusively
[2013-08-08 19:26:39 -0400] adnichols: hence my assumption that service was using an upstart script that was installed by the package - since it wasn't in the recipe
[2013-08-08 19:27:07 -0400] adnichols: assume the symlink in init.d is a red herring - tho maybe not
[2013-08-08 19:28:02 -0400] dgarstang: jmickle: adnichols suggestion fixed it
[2013-08-08 19:31:27 -0400] joelnn: I'm just starting to look into how LWRPs are written, but... is there an example of a resource that is shared/manipulated across cookbooks? I'm defining a service in one cookbook, and adding configurations for that service (sort of a conf.d) in other cookbooks.
[2013-08-08 19:31:47 -0400] joelnn: I feel like an example should spring to mind, but it doesn't...
[2013-08-08 19:32:00 -0400] dgarstang: omg, some of these cookbooks are bad. The statsd one requires graphite. Why? Statsd talks to graphite over a network socket. Why does graphite need to be installed?
[2013-08-08 19:33:06 -0400] joelnn: there is bad code on the internet, I'm shocked
[2013-08-08 19:33:16 -0400] joelnn: :)
[2013-08-08 19:33:28 -0400] bean: dgarstang: which statsd cb
[2013-08-08 19:33:33 -0400] bean: there are several
[2013-08-08 19:33:39 -0400] bean: none of them are opscode cookbooks though
[2013-08-08 19:34:06 -0400] dgarstang: bean: http://community.opscode.com/cookbooks/infochimps_statsd
[2013-08-08 19:34:43 -0400] bean: Last updated Jan 31, 2012
[2013-08-08 19:34:44 -0400] bean: wart
[2013-08-08 19:34:46 -0400] bean: wat
[2013-08-08 19:34:54 -0400] dgarstang: perdy old
[2013-08-08 19:34:58 -0400] bean: http://community.opscode.com/cookbooks/statsd recommends
[2013-08-08 19:35:05 -0400] bean: an older one
[2013-08-08 19:35:05 -0400] bean: lol
[2013-08-08 19:35:31 -0400] dgarstang: nodejs I can understand... graphite, metachef, runit not so much
[2013-08-08 19:35:42 -0400] jtimberman: dgarstang: runit is awesome though :)
[2013-08-08 19:35:46 -0400] bean: ^
[2013-08-08 19:36:01 -0400] bean: this might be a better one, not sure, dgarstang https://github.com/librato/statsd-cookbook
[2013-08-08 19:36:01 -0400] jtimberman: http://jtimberman.housepub.org/blog/2012/12/29/process-supervision-solved-problem/
[2013-08-08 19:36:23 -0400] nicgrayson: jtimberman: i love that post. it converted me completly
[2013-08-08 19:36:24 -0400] cpuguy83: Is there a way to disable the "Where do I get a Login?" pane in the chef-server web ui?
[2013-08-08 19:36:36 -0400] bean: https://github.com/hectcastro/chef-statsd appears to be updated even more recently, dgarstang
[2013-08-08 19:36:45 -0400] dgarstang: bean: depends on git? :-O
[2013-08-08 19:36:48 -0400] jtimberman: nicgrayson: Once I dig into omnios+smf more, I'm probably going to write a new one about how awesome SMF is :)
[2013-08-08 19:36:58 -0400] dgarstang: bean: omg, it checks out statsd from git.
[2013-08-08 19:37:20 -0400] siezer: dgarstang "requiring" a cookbook doesn't mean something is going to be installed, its more like linking to a library
[2013-08-08 19:37:26 -0400] bean: theres lots of different ways of doing things, dgarstang, chillax
[2013-08-08 19:37:29 -0400] nicgrayson: jtimberman: have you looked at nginx-omnibus at all? looked interesting
[2013-08-08 19:37:52 -0400] siezer: for example, you can ship custom types (lwrp), libraries, etc in a cookbook for use in others
[2013-08-08 19:37:53 -0400] dgarstang: bean: downloading from git, and compiling stuff on the box... not usually a best practices approach. :)
[2013-08-08 19:38:04 -0400] jtimberman: nicgrayson: we're using openresty instead of nginx, so, no
[2013-08-08 19:38:06 -0400] bean: dgarstang: then don't use that CB :)
[2013-08-08 19:38:11 -0400] siezer: all the windows types are implemented in the windows cookbook and not in core chef for example
[2013-08-08 19:38:22 -0400] jtimberman: siezer: some are tho! :D
[2013-08-08 19:38:30 -0400] bean: man, i've not even heard of openresty
[2013-08-08 19:38:36 -0400] dgarstang: bean: darn tootin. :)
[2013-08-08 19:38:38 -0400] siezer: for example, something might require
[2013-08-08 19:38:50 -0400] siezer: apt or yum, when a recipe is destined to run on solaris
[2013-08-08 19:39:46 -0400] adnichols: dgarstang There's a reason there are many cookbooks for the same thing - different approaches, some better maintained than others, cost is low to throw your "version" out there for folks to use/stumble over
[2013-08-08 19:40:03 -0400] bean: that'd require "writing ruby"
[2013-08-08 19:40:06 -0400] bean: which he doesn't want to do
[2013-08-08 19:40:39 -0400] jtimberman: generally speaking, cookbook authors attempt to solve their use case / problem domain first
[2013-08-08 19:40:47 -0400] jtimberman: and may or may not support others
[2013-08-08 19:40:50 -0400] joelnn: anyone manage nginx with chef? I'm wondering how to cleanly separate the cookbook that installs / starts nginx from the 'N' other cookbooks that will install new 'server' configs
[2013-08-08 19:40:56 -0400] adnichols: jtimberman yes, I'm not banging the approach - I do the same
[2013-08-08 19:40:58 -0400] jtimberman: hence lots of cookbooks that support a single platform, e.g.
[2013-08-08 19:41:46 -0400] bean: joelnn: You might consider an LWRP for adding a site. :)
[2013-08-08 19:41:50 -0400] adnichols: I do typically take the approach of keeping my version to myself if I can't improve an existing one and submit a PR
[2013-08-08 19:42:59 -0400] joelnn: bean: I definitely would consider that. will it be possible for that LWRP to notify the 'nginx server' resource which is defined in another cookbook's recipe to restart?
[2013-08-08 19:44:59 -0400] joelnn: alternative is to have the nginx server resource 'watch' the site conf dir, but I think there is a sequencing problem there -- the site will get added after the service resource looks for new sites
[2013-08-08 19:45:31 -0400] joelnn: guess I could have a 'delayed' notification which will check for new sites. hm
[2013-08-08 19:45:50 -0400] nicgrayson: joelnn: exactly, then it will just reload once
[2013-08-08 19:45:55 -0400] bean: ^
[2013-08-08 19:46:01 -0400] bean: i was going to suggest that nicgrayson chime in here.
[2013-08-08 19:46:04 -0400] bean: :P
[2013-08-08 19:47:12 -0400] joelnn: cool... not sure how to integrate this with the 'nginx' opscode cookbook
[2013-08-08 19:47:44 -0400] nicgrayson: joelnn: just wrap it then write lwrps that call templates
[2013-08-08 19:47:46 -0400] joelnn: can one refer to a resource across cookbooks? like 'service[nginx]' created by the nginx cookbook, if I include_recipe "nginx"?
[2013-08-08 19:47:55 -0400] nicgrayson: joelnn: yes
[2013-08-08 19:48:17 -0400] nicgrayson: joelnn: i would suggest writing something to run a configtest before you reload
[2013-08-08 19:48:38 -0400] jtimberman: joelnn: i believe this is an example of such a thing https://github.com/martinisoft/martinisoft-nginx
[2013-08-08 19:49:18 -0400] joelnn: jtimberman: thanks I will look closely at that
[2013-08-08 19:50:00 -0400] joelnn: is it "good practice" to refer to another cookbook's resource? seems kind of like breaking encapsulation
[2013-08-08 19:50:21 -0400] joelnn: but maybe it's common... just haven't come across it in my short experience
[2013-08-08 19:51:29 -0400] joelnn: I guess if the lwrp for defining a site were in the 'nginx' cookbook, then things would still be encapsulated
[2013-08-08 19:52:00 -0400] joelnn: nicgrayson: thanks!
[2013-08-08 19:52:02 -0400] jtimberman: joelnn: nginx cookbook has an "nginx_site" definition that will manage the vhost config
[2013-08-08 19:54:02 -0400] joelnn: jtimberman: I see... and it does notify the service to restart. nice, maybe thats all I need
[2013-08-08 19:54:15 -0400] nicgrayson: that just enables a site, you will want something to drop a template in site-enabled if on debian
[2013-08-08 19:56:48 -0400] jmickle: what up jtimberman
[2013-08-08 19:57:34 -0400] BrianJ: What would I need to do to call out to Hosted Chef to get a databag attribute from a normal ruby file?
[2013-08-08 19:57:42 -0400] BrianJ: DO i just need to import the chef gem?
[2013-08-08 19:57:44 -0400] BrianJ: do*
[2013-08-08 19:58:16 -0400] BrianJ: the environment im working on has chef installed and configured to talk to the hosted chef server
[2013-08-08 19:59:04 -0400] joelnn: nicgrayson: sites-available you mean?
[2013-08-08 20:01:52 -0400] nicgrayson: joelnn: yes, then use the def in the upstream to nxensite them
[2013-08-08 20:04:56 -0400] jbz: jtimberman: Do you have any inside scoops on server 11.10's availability date?  I'm looking to deal with the nested search bug
[2013-08-08 20:05:36 -0400] MoonMan_: Could anyone provide me a good example of using chef/ruby to write text directly to config files? I've been googling for quite some time and can't find anything that directly addresses this.
[2013-08-08 20:06:26 -0400] jbz: MoonMan_What's the use case?  It's very hard to stay idempotent doing that
[2013-08-08 20:06:51 -0400] bean: MoonMan_: typically you'd use a template.
[2013-08-08 20:07:09 -0400] jbz: MoonMan_Remember, templates can be nothing but a ruby statement to dump a huge string
[2013-08-08 20:08:07 -0400] Nick____: Hello, I am experiencing an issue trying to run /c/opscode/chef/bin/knife bootstrap windows winrm server_name.lab.local -x user_name -P password on windows server 2008 r2
[2013-08-08 20:08:16 -0400] Nick____: I get Bootstrapping Chef on server_name.lab.local ERROR: Network Error: No connection could be made because the target machine actively refused it. - connect(2) (http://server_name.lab.local:5985) Check your knife configuration and network settings
[2013-08-08 20:08:37 -0400] Nick____: I have installed the chef client on the server and installed knife
[2013-08-08 20:08:53 -0400] bean: Nick____: that would likely be caused by server_name.lab.local not having winrm running
[2013-08-08 20:09:09 -0400] scarolan_: Nick____: bean is right; check that winrm is up and running
[2013-08-08 20:09:11 -0400] Nick____: I also ran the winrm commands listed on http://docs.opscode.com/plugin_knife_windows.html
[2013-08-08 20:09:11 -0400] MoonMan_: jbz: I've been reading through the template document, can't really find any clear examples of ruby code that do exactly that. Maybe I'm missing something. Any chance you can link me?
[2013-08-08 20:09:32 -0400] jbz: MoonMan_: Sure, give me a sec to gist something.
[2013-08-08 20:09:52 -0400] MoonMan_: Sure, no problem.
[2013-08-08 20:10:48 -0400] jbz: MoonMan_ Do you have an example of the type of thing you're trying to write out, though?
[2013-08-08 20:11:23 -0400] MoonMan_: Yep. Lemme just throw a copy into a paste bin.
[2013-08-08 20:11:35 -0400] Nick____: Sasly winrm is running.
[2013-08-08 20:11:40 -0400] Nick____: *sadly
[2013-08-08 20:12:01 -0400] Illusioneer: So I am trying to bring a existing linux box under a chef server's control.  I installed the chef-client but the docs all sound like you are configuring a brand new machine which this is not
[2013-08-08 20:13:09 -0400] bean: Illusioneer: you can do that, and we've done it... I just recommend only managing the things that you want to manage with chef, with chef, on it
[2013-08-08 20:13:11 -0400] chris613: Illusioneer: Having been slogging through that scenario for the last year, I would recomment not using chef on existing machines
[2013-08-08 20:13:21 -0400] MoonMan_: jbz: A lot of what we need chef to do is write network config files similar to the following. http://pastebin.com/GHewFPgQ
[2013-08-08 20:13:21 -0400] bean: yeah, its not ideal
[2013-08-08 20:13:27 -0400] justizin: Illusioneer: knife bootstrap will cure all that ails you.. also, for the most part, there is no difference between a machine that's existed for a day and one that's existed for a year..
[2013-08-08 20:13:41 -0400] justizin: yes, also be careful.  what i usually do is manage only users and the chef-client itself on existing machines.  maybe monitoring agents.
[2013-08-08 20:13:48 -0400] joelnn: Illusioneer: unfortunately lots of things remain outside of chef's control, even starting from a brand new machine. that's what distros do :)
[2013-08-08 20:14:15 -0400] Illusioneer: ah well chef and I have a great deal in common :)
[2013-08-08 20:14:22 -0400] MoonMan_: jbz:  I just need to learn how to use ruby to write strings into configuration files. That's my current stumbling block.
[2013-08-08 20:14:35 -0400] justizin: anyone using chef to configure their systems to use bcrypt or PBKDF2 for shadow passwords?
[2013-08-08 20:14:38 -0400] chris613: We've managed to use chef to standardize a lot of logging, monitoring, user control, mail setup, etc on existing machines, but it's a very very difficult and breakage prone project compared to only cheffing pristine nodes.
[2013-08-08 20:14:45 -0400] joelnn: Illusioneer: an idea, though it's easy for me to say since I haven't had to deal with it. image one of your machines, so you have a sandbox that you can play with
[2013-08-08 20:15:15 -0400] Illusioneer: joelnn: I've already been playing with a ubuntu VM that I practice on then rollback the original image of
[2013-08-08 20:17:14 -0400] joelnn: Illusioneer: in reality what I am doing is planning to bring up new nodes to replace the existing ones. not sure if you will find that easier. easier to do in a virtualized environment
[2013-08-08 20:18:14 -0400] bean: joelnn: Illusioneer thats exactly what we're doing here, currently, migrating old centos stuff onto fresh ubuntu nodes controlled by chef
[2013-08-08 20:18:31 -0400] joelnn: though ironically, the existing nodes are already managed by chef. anything can get out of control if you take your eye off of it.
[2013-08-08 20:19:29 -0400] jbz_: Sorry, got dumped off
[2013-08-08 20:19:42 -0400] jbz_: MoonMan_:  So here's your file with a few of the values templated:  http://pastebin.com/h3fv4A0Q
[2013-08-08 20:19:43 -0400] joelnn: and I feel like going from state A -> B is easy with chef. going from A -> B -> C is much much harder, since you need to undo part of what was done in A -> B.
[2013-08-08 20:19:59 -0400] jbz_: MoonMan_:  That would be if you're using values directly from node attributes, rather than passing them into the template resource
[2013-08-08 20:20:02 -0400] Brad_K: So, I'm curious  the page at http://bit.ly/19QtXtg says that there are two ways to create data bags, one using "knife", and the other manually creating directories on the chef repo server.  But if "knife" can do it, that means it can be done from the REST API, right?  So, I wonder  how would you use Chef to create data bags using the REST API, but without using knife and without having that code running on the chef repo server?
[2013-08-08 20:20:48 -0400] MoonMan_: jbz_: Oh wow, thank you. That's exactly what I was looking for. The boilerplate in the template doc was messing me up a little.
[2013-08-08 20:20:57 -0400] MoonMan_: He gone.
[2013-08-08 20:20:58 -0400] jbz_: Ah yeah can be confusing.
[2013-08-08 20:21:00 -0400] jbz_: No I'm here
[2013-08-08 20:21:03 -0400] Illusioneer: Yeah this has gone from "interesting" to "oh damn we need this right away"
[2013-08-08 20:21:12 -0400] Nick____: hmm. when in doubt reboot.
[2013-08-08 20:21:12 -0400] Illusioneer: Moving all our servers from one data center to another
[2013-08-08 20:21:40 -0400] Illusioneer: Except we can't re-image, all 'fresh' installs
[2013-08-08 20:21:53 -0400] jbz_: MoonMan_: Note, this requires you to have loaded all those values into the attributes namespace first.  The other option is to pass them in when you call the template, if you want to do programmatic stuff in the recipe code.
[2013-08-08 20:22:21 -0400] MoonMan_: "network" being the data bag that holds the values?
[2013-08-08 20:22:33 -0400] Brad_K: Illusioneer: you really don't want heavy images, anyway.  better to make them minimal and then build the rest on top of that with chef.
[2013-08-08 20:22:53 -0400] jbz_: MoonMan_:  Nope nope, attributes, not data bag.
[2013-08-08 20:22:59 -0400] MoonMan_: Got it.
[2013-08-08 20:23:01 -0400] jbz_: Attributes are nested namespaces
[2013-08-08 20:23:08 -0400] Illusioneer: Brad_K: yeah that was their original idea when I started pitching Chef
[2013-08-08 20:23:26 -0400] jbz_: So you could, for example, set those in the attributes.rb file in the cookbook for default values
[2013-08-08 20:23:38 -0400] Brad_K: Illusioneer: that's what Opscode recommends in their training.
[2013-08-08 20:23:39 -0400] jbz_: and then override them in a role file, or directly on the node.
[2013-08-08 20:24:10 -0400] jbz_: You could also, if you wanted, have those values in a data bag, and then in the recipe which calls that template you'd pull them out of the data bag and either stuff them into the attributes on the node or just pass them directly to the template resource.
[2013-08-08 20:25:03 -0400] joelnn: Illusioneer: so far, I think it's important to chef-ize everything needed for an environment... down to DNS and other core services. if there is a piece of your environment that isn't automated, you will get stuck in an old environment that you are always patching. so those are the most valuable things to start with IMO
[2013-08-08 20:25:44 -0400] Illusioneer: joelnn: oh you are preaching to the converted, i'm still discovering machines that haven't had so much as a security patch update in over 4 years
[2013-08-08 20:25:46 -0400] Brad_K: MoonMan_: data bags can be a real pain.  if you can, i would try to avoid them whenever possible.  of course, you can't always avoid them  hence my question earlier.
[2013-08-08 20:25:48 -0400] jbz: Brad_K: Did you get an answer re: the API?
[2013-08-08 20:26:02 -0400] Brad_K: jbz: nope, not yet.
[2013-08-08 20:26:08 -0400] jbz: Have a look here: http://docs.opscode.com/api_chef_server.html
[2013-08-08 20:26:31 -0400] Brad_K: joelnn: yeah, Chef is a great place to start with automating all your lowest level infrastructure stuff, and then work up from there.
[2013-08-08 20:26:46 -0400] jbz: Brad_K: More specifically: http://docs.opscode.com/api_chef_server_data_bag.html
[2013-08-08 20:27:00 -0400] joelnn: Illusioneer: yeah me too. easy to get lulled into taking certain things for granted for several years, and then suddenly they need to change, and it becomes "wtf"
[2013-08-08 20:27:38 -0400] Brad_K: jbz: thanks!  looking at it now.
[2013-08-08 20:28:50 -0400] cpuguy83: Brad_K: You can use the ridley gem, which I believe is for talking to chef server
[2013-08-08 20:29:16 -0400] Brad_K: cpuguy83: cool.  that was going to be my next question.  ;-)
[2013-08-08 20:32:00 -0400] joelnn: this is the right way to refer to a previously defined resource? t = resources(:template => "/etc/aliases")
[2013-08-08 20:33:18 -0400] joelnn: refer meaning literally get a reference
[2013-08-08 20:33:52 -0400] Illusioneer: *sigh* the docs though could benefit from a quickie "setting up a client you do this", I've been digging through this for hours and it's getting more confusing not less
[2013-08-08 20:34:53 -0400] joelnn: Illusioneer: I feel like I shouldn't be evangelizing chef-solo since I'm a newbie, but... try chef-solo
[2013-08-08 20:35:04 -0400] scarolan_: Illusioneer: Try "knife bootstrap hostname --sudo -x <USERNAME> -P <PASSWORD>"
[2013-08-08 20:35:09 -0400] joelnn: install the chef omnibus and get cracking
[2013-08-08 20:35:16 -0400] scarolan_: Docs are here:  http://docs.opscode.com/knife_bootstrap.html
[2013-08-08 20:35:32 -0400] scarolan_: You don't even need a server, just sign up for a free hosted account and start playing with it
[2013-08-08 20:35:43 -0400] cpuguy83: Yes, start with chef-solo or the free hosted chef.
[2013-08-08 20:35:55 -0400] cpuguy83: If using chef-solo, install the knife-solo gem
[2013-08-08 20:36:12 -0400] Illusioneer: LOL
[2013-08-08 20:36:14 -0400] cpuguy83: then knife solo bootstrap your_host
[2013-08-08 20:36:27 -0400] Illusioneer: one question, 9 answers
[2013-08-08 20:36:48 -0400] cpuguy83: Illusioneer: It's all the same answer, though.
[2013-08-08 20:37:15 -0400] dgarstang: Illusioneer: I hear ya. I had the same issues with setting up a client.
[2013-08-08 20:37:32 -0400] cpuguy83: On a side note, msiexec as wasted my whole f-ing day
[2013-08-08 20:37:32 -0400] Illusioneer: Yeah the docs feel less like a coherant guide and more like a binder of notes
[2013-08-08 20:37:34 -0400] dgarstang: Illusioneer: oh, and still one question, 9 answers for me.
[2013-08-08 20:37:39 -0400] dgarstang: Illusioneer: agreed
[2013-08-08 20:37:42 -0400] cpuguy83: Illusioneer: Yep, that's exactly what they are
[2013-08-08 20:37:53 -0400] Illusioneer: which for people who know what they're doing is useful
[2013-08-08 20:38:09 -0400] Illusioneer: But hey I can get it installed and runing which is a helluva lot more than I could say about puppet
[2013-08-08 20:38:11 -0400] cpuguy83: Illusioneer: And things have changed so much howto sites are all slightly different, and generally aren't what you need to do today (at least not exactly)
[2013-08-08 20:38:11 -0400] MoonMan_: jbz: Can you tell me what you think of this code, providing I reference the values as attributes? http://pastebin.com/a69xvY84
[2013-08-08 20:38:31 -0400] dgarstang: Illusioneer: if you run knife setup...the default port isnt' 4000. it's 443. Can't believe they haven't fixed tat
[2013-08-08 20:38:36 -0400] MoonMan_: Just wondering if I'm on the right track or not.
[2013-08-08 20:38:40 -0400] scarolan_: Illusioneer: If you want a good walkthrough, visit learnchef.com
[2013-08-08 20:38:51 -0400] dgarstang: Illusioneer/cpuguy83: Tooootally....
[2013-08-08 20:39:01 -0400] scarolan_: You want the Quickstart Guide
[2013-08-08 20:39:09 -0400] jbz: MoonMan_ That'll work fine if you put the attributes in :-)
[2013-08-08 20:39:10 -0400] dgarstang: Opscode can't even remove old pages.
[2013-08-08 20:39:17 -0400] MoonMan_: jbz: Awesome!
[2013-08-08 20:39:22 -0400] jbz: that should be something like network-config.erb in <cookbook>/templates/default/
[2013-08-08 20:40:02 -0400] Illusioneer: well some of the guides can be frustrating, particularly when you discover there were things they did off screen that you don't know about, or they show "on this terminal do this" but they don't say which server they are on (client/host) or what user account, etc
[2013-08-08 20:40:24 -0400] Illusioneer: and yes, I know I'm nitpicking but it's sometimes simple details like that that make the difference :)
[2013-08-08 20:40:30 -0400] scarolan_: Illusioneer: learnchef.com was created by opscode to address this exact issue.  It's a simple walkthrough that explains each step
[2013-08-08 20:40:39 -0400] joelnn: try to keep in mind the free gift you are receiving :)
[2013-08-08 20:40:50 -0400] Illusioneer: hence my "yes I know I'm nitpicking"
[2013-08-08 20:40:58 -0400] scarolan_: Illusioneer: You're probably best off starting there instead of someone's blog or "howto" page out there on the 'net
[2013-08-08 20:41:15 -0400] Illusioneer: scarolan: those types of blog posts I find are the best
[2013-08-08 20:41:25 -0400] dgarstang: scarolan_: or the official opscode docs...
[2013-08-08 20:41:33 -0400] Illusioneer: somebody's "guy walked in off the street" tutorial
[2013-08-08 20:42:03 -0400] scarolan_: Illusioneer: You just said that "some of the guildes can be frustrating", then in the next statement "those types of blog posts I find are the best".  Make up your mind!  ;-)
[2013-08-08 20:42:08 -0400] Illusioneer: the problem is, when it's your creation, you totally get how it works and gloss over things that seem obvious to you
[2013-08-08 20:42:19 -0400] dgarstang: scarolan_: i think he was talking about the opscode docs
[2013-08-08 20:42:25 -0400] Illusioneer: LOL scarolan i said SOME!
[2013-08-08 20:42:37 -0400] dgarstang: : Illusioneer: your talking my language. :)
[2013-08-08 20:42:38 -0400] Illusioneer: a great many of them are godsends :)
[2013-08-08 20:43:10 -0400] scarolan_: Yep, so learnchef.com was stood up to address this very issue.  we are aware that the docs and wiki can be confusing for a newcomer
[2013-08-08 20:43:36 -0400] scarolan_: The learning curve may seem a little steep at first, but the view from the top is great.
[2013-08-08 20:43:53 -0400] joelnn: I actually found some old opscode wiki pages that I preferred over the new... lots of boilerplate text in the new wiki
[2013-08-08 20:44:10 -0400] cpuguy83: Lots of incorrect text in the new wiki
[2013-08-08 20:44:14 -0400] dgarstang: scarolan_: the web site is woefully inadequate.
[2013-08-08 20:44:37 -0400] chris613: I want to run something by you guys before heading to the mailing list to ask... Basically I think that "notifies ... , :delayed" is an enemy to idempotence
[2013-08-08 20:44:59 -0400] cpuguy83: chris613: Why?
[2013-08-08 20:45:16 -0400] dgarstang: the workstation guide at learnchef.com has nothing that I can see, on the workstation page about setting up client.rb for example
[2013-08-08 20:45:19 -0400] joelnn: you are notifying something which is itself idempotent, aren't you
[2013-08-08 20:45:30 -0400] chris613: cpuguy83: I keep running into this issue where a config is modified, the restart of the associated service is scheduled :delayed, and then the chef run bails for some unrelated reason.
[2013-08-08 20:45:49 -0400] joelnn: bails?
[2013-08-08 20:45:52 -0400] jbz: chris613:  If there's something wrong with convergence, you *don't want* it to make changes.
[2013-08-08 20:45:54 -0400] chris613: That leaves the saved config alredy changed, but the service not restarted. On the next run, the config is already correct, so no restart is trigerred
[2013-08-08 20:46:14 -0400] jbz: chris613:  Whoa, hold on, that shouldn't happen, if the run fails, it shouldn't modify the files unless it is failing in a weird way
[2013-08-08 20:46:28 -0400] joelnn: jbz: really?
[2013-08-08 20:46:33 -0400] chris613: jbz: Really?
[2013-08-08 20:46:34 -0400] jbz: Well, hm, actually
[2013-08-08 20:46:34 -0400] joelnn: how does that work?
[2013-08-08 20:46:41 -0400] jbz: depends when in the run it fails
[2013-08-08 20:46:46 -0400] joelnn: we don't have transactional filesystems :)
[2013-08-08 20:46:57 -0400] dgarstang: Why does https://learnchef.opscode.com/quickstart/workstation-setup/#linux have nothing about the config of client.rb on the workstation?
[2013-08-08 20:46:58 -0400] jbz: Anyway, why is the run failing?
[2013-08-08 20:47:05 -0400] chris613: The first time I ran into this is when omnibus_updater was modified to intentionally kill the chef run by throwing an exception
[2013-08-08 20:47:24 -0400] scarolan_: dgarstang: because the workstation uses knife.rb
[2013-08-08 20:47:35 -0400] jbz: My attitude is that chef runs should never fail.  If they fail, there is a bigger problem and I'm not concerned about idempotence loss b/c I assume the state is damaged and unreliable
[2013-08-08 20:47:53 -0400] dgarstang: scarolan_: ok... there's no mention of 'knife.rb' on that page either.
[2013-08-08 20:47:58 -0400] chris613: jbz: That's one example. My runs often fail for other reasons related to unexpected base states, essentially cheffing previously non-cheffed machines as we were warning Illusioneer not to do ;)
[2013-08-08 20:48:09 -0400] jbz: chris613:  Ah, well, heh.
[2013-08-08 20:48:19 -0400] chris613: jbz: I agree with that in principle, but in practice chef runs DO fail
[2013-08-08 20:48:19 -0400] jbz: You could always write an error handler which force-started that service
[2013-08-08 20:48:26 -0400] Brad_K: cpuguy83: thanks!  The page at http://bit.ly/10qq8FM is very helpful!
[2013-08-08 20:48:38 -0400] scarolan_: dgarstang: well looky there...i think you're right!
[2013-08-08 20:48:45 -0400] jbz: chris613: No, of course they do, but in my case I treat chef runs failing in production as a SRS PRBLEM that I caused that involves immediate fix
[2013-08-08 20:48:51 -0400] dgarstang: scarolan_: just the beggining... :)
[2013-08-08 20:48:53 -0400] joelnn: dgarstang: this guide seems to depend on using Hosted Chef, I don't think you met the prereqs
[2013-08-08 20:48:55 -0400] chris613: And if your environment is such that you can say "OMG node is in invalid state, let's recycle and re-bootstrap", then that's great. If you don't have that luxury then things are messy
[2013-08-08 20:49:02 -0400] Illusioneer: chris613: yeah I suspect that's gonna be a problem, thankfully all the old machines are gonna be decomissioned soon anyway
[2013-08-08 20:49:06 -0400] adnichols: dgarstang you download the starter kit - I'm guessing there's a knife.rb inside that
[2013-08-08 20:49:10 -0400] dgarstang: joelnn: not exactly impartial is it
[2013-08-08 20:49:17 -0400] jbz: chris613:  Right, understood.  Hence my error handler suggestion
[2013-08-08 20:49:27 -0400] joelnn: why should it be impartial? its a starter guide, it will be partial to the easiest path
[2013-08-08 20:49:36 -0400] joelnn: hosted chef
[2013-08-08 20:49:54 -0400] dgarstang: joelnn: partial to the path that involves receiving money.
[2013-08-08 20:49:59 -0400] chris613: jbz: Yeah the error handler is what I was thinking of doing, actually. Have an exception handler that would figure out what notifications were pending when the exception was thrown and then attempt to do what they intended
[2013-08-08 20:50:05 -0400] scarolan_: dgarstang: lemme walk through it step-by-step.  I think it might be in the "Extract the Starter Kit into your home directory. "
[2013-08-08 20:50:10 -0400] adnichols: dgarstang ? hosted chef is free in this scenario
[2013-08-08 20:50:15 -0400] dgarstang: oh
[2013-08-08 20:50:16 -0400] chris613: seems like a lot of work - just looking for others' solutions before I head down that road
[2013-08-08 20:50:26 -0400] jbz: dgarstang hosted chef is free for <=5 nodes
[2013-08-08 20:50:43 -0400] cpuguy83: And costs an arm and a leg for > 5 nodes :)
[2013-08-08 20:50:48 -0400] jbz: FIRST TASTE IS FREE KID GET IN THE ALLEY
[2013-08-08 20:50:55 -0400] joelnn: are we really complaining about free documentation for free software running against a free service
[2013-08-08 20:51:04 -0400] joelnn: jesus can you stop trolling at some point
[2013-08-08 20:51:05 -0400] dgarstang: scarolan_: On https://learnchef.opscode.com/quickstart/workstation-setup/#linux, under advanced, no mention of text 'extract'
[2013-08-08 20:51:37 -0400] adnichols: dgarstang I'm pretty sure there's a facility to report doc bugs - no?
[2013-08-08 20:51:39 -0400] jbz: dgarstang: Sorry, came in late, you can't use a gem install?
[2013-08-08 20:51:42 -0400] dgarstang: joelnn: free isn't an excuse for lack of quality.
[2013-08-08 20:52:04 -0400] joelnn: there is no excuse needed, there is no obligation towards you whatsoever
[2013-08-08 20:52:07 -0400] adnichols: also pretty sure it isn't irc
[2013-08-08 20:52:24 -0400] adnichols: no good will come of this
[2013-08-08 20:52:28 -0400] jbz: Missing docs is not a lack of quality of the software.  It may be considered a deficiency in the product offering.
[2013-08-08 20:52:37 -0400] dgarstang: jbz: no, i'm working. I had to work it out myself tho by reading lots of docs, piecing them together, and coming in here. I was backing up what Illusioneer was saying. he seems to have had exactly the same experience as I did
[2013-08-08 20:52:54 -0400] jbz: dgarstang: ah
[2013-08-08 20:52:57 -0400] scarolan_: dgarstang: Ok so I walked through it, and you *do* get a valid knife.rb when you click the big "Download Starter Kit" button
[2013-08-08 20:53:23 -0400] cpuguy83: Yes, the docs suck, someone could go write their own but we are all too busy making our stuff work.
[2013-08-08 20:53:25 -0400] joelnn: frustration with documentation is maybe the most universal experience in IT. it is just about the most boring topic of conversation
[2013-08-08 20:53:33 -0400] dgarstang: scarolan_: which means I never even find out about the existance of knife.rb. How's that helpful in the long run?
[2013-08-08 20:53:45 -0400] jbz: At least Chef has a good and heavily populated IRC channel.  I've always found helpful folks here.
[2013-08-08 20:53:51 -0400] dgarstang: joelnn: experience here hasn't been the norm.
[2013-08-08 20:54:11 -0400] Brad_K: I usually find this channel to be helpful.
[2013-08-08 20:54:17 -0400] jhulten: adnichols / dgarstang: https://github.com/opscode/chef-docs/issues for documentation issues.
[2013-08-08 20:54:47 -0400] dgarstang: jhulten: when I've learned enough to know whats going on (which will take some time given lack of docs), I'll think about opening doc bugs.
[2013-08-08 20:54:49 -0400] scarolan_: dgarstang: The idea behind learnchef.com is to help people who are brand new, and not confuse them with too many configuration files and setup options.
[2013-08-08 20:55:05 -0400] scarolan_: dgarstang: In other words, you are probably not the target market for that site  :-)
[2013-08-08 20:55:11 -0400] dgarstang: scarolan_: i guess I don't fit into the target audience
[2013-08-08 20:55:17 -0400] dgarstang: scarolan_: hehe
[2013-08-08 20:55:41 -0400] adnichols: Dunno, I've found the docs sufficient if I accept they aren't perfect & am willing to ask nicely here when I run into confusion
[2013-08-08 20:55:44 -0400] adnichols: I've gotten quite far that way
[2013-08-08 20:55:49 -0400] adnichols: I don't think I'm the exception
[2013-08-08 20:55:50 -0400] Brad_K: with any new resource, it takes time to come up to speed.
[2013-08-08 20:55:54 -0400] cpuguy83: One of the reasons the docs are difficult is Chef is not a small thing, there is a LOT to do, a LOT to learn, and a LOT to setup.
[2013-08-08 20:56:03 -0400] cpuguy83: But once you do, the pieces just fall into place.
[2013-08-08 20:56:11 -0400] scarolan_: And we are working to improve the docs, thank you for all your suggestions.  If you find glaring errors please submit them to the "issues" link on the chef-docs repo
[2013-08-08 20:56:21 -0400] Brad_K: it took me about three months to finally get to the point where i was feeling reasonably competent with Chef.
[2013-08-08 20:56:37 -0400] jbz: Brad_K: Yeah, it took me about that long to get over the hump
[2013-08-08 20:56:47 -0400] jbz: I was functional at that point, albeit not skilled.
[2013-08-08 20:56:50 -0400] jbz: Not that I'm skilled now lol
[2013-08-08 20:56:51 -0400] Brad_K: This channel and the mailing list were *invaluable* resources during that process.
[2013-08-08 20:56:52 -0400] dgarstang: cpuguy83: i wonder if opscode has ever thought about bringing in some noobs, and having them trying to install chef from the docs. That would be an excellent way to find out which means are missng.
[2013-08-08 20:57:31 -0400] MoonMan_: Brad_K: lol, my boss wants me to be reasonably competent by monday xD
[2013-08-08 20:57:32 -0400] cpuguy83: dgarstang: What consists of a noob?  Does a noob know their way around ruby?
[2013-08-08 20:58:01 -0400] joelnn: the chef omnibus installer is one of the best installation experiences of my life.
[2013-08-08 20:58:07 -0400] cpuguy83: jbz: I thought that was the wrong way to do it?
[2013-08-08 20:58:08 -0400] joelnn: jbz: ruby version conflicts
[2013-08-08 20:58:14 -0400] jbz: Yeah, true enough, betraying my age
[2013-08-08 20:58:15 -0400] Brad_K: omnibus FTW!
[2013-08-08 20:58:20 -0400] dgarstang: cpuguy83: the concept here is that someone new to chef doesn't automatically fill in the missing pieces of the docs. new to ruby? The docs say you don't have to know ruby to use chef. :-P
[2013-08-08 20:58:22 -0400] cpuguy83: joelnn: Use rvm/rbenv/chruby
[2013-08-08 20:58:33 -0400] jbz: I pretty much use gem install on my workstation, always with rvm.
[2013-08-08 20:58:36 -0400] joelnn: I could, but I'd rather use omnibus :)
[2013-08-08 20:58:40 -0400] dgarstang: jbz: gem, evil.
[2013-08-08 20:58:43 -0400] jbz: Heh
[2013-08-08 20:58:53 -0400] jbz: For actual nodes under management, indeed, omnibus.
[2013-08-08 20:59:12 -0400] joelnn: given the 'chef_gem' resource, why would you want anything other than omnibus? I honestly don't get it
[2013-08-08 20:59:18 -0400] Brad_K: even for a chef workstation, i would prefer to use omnibus.
[2013-08-08 20:59:44 -0400] Brad_K: and private chef for the server, if i have to run my own instead of just using Hosted Chef.
[2013-08-08 20:59:50 -0400] qhartman: I have a desire for one node (master) to be able to set an attribute on another node (slave). Short of setting the master node to be a full API admin, is there a way to do this?
[2013-08-08 21:00:00 -0400] jbz: joelnn:  I expressed myself poorly, I was talking about on my Macbook. :-)
[2013-08-08 21:00:20 -0400] jbz: qhartman:  That doesn't work.  You can have one node set an attribute on itself based on the state of another node's attribute though.
[2013-08-08 21:00:46 -0400] jbz: qhartman: Rephrase - there may be a way to make it work, but IMO that way lies madnessand *death* </khan>
[2013-08-08 21:01:08 -0400] cpuguy83: And then there's this little gem, http://fnichol.github.io/knife-server/
[2013-08-08 21:01:09 -0400] Brad_K: qhartman: or, it can set that attribute on itself based on the state of other things that are also available in the environment, role(s), etc that it has available to it.
[2013-08-08 21:01:15 -0400] joelnn: jbz: ok, why on your macbook do you not prefer to use the omnibus?
[2013-08-08 21:01:16 -0400] cpuguy83: For bootstraping a chef-server
[2013-08-08 21:01:49 -0400] jbz: joelnn:  Because I have a bunch of stuff already set up on my MBP using rvm and gemsets, and chef fits really easily into that model as far as the client stuff goes.
[2013-08-08 21:01:58 -0400] jbz: I don't manage my MBP using chef.
[2013-08-08 21:02:02 -0400] jbz: (although I should lol)
[2013-08-08 21:02:18 -0400] qhartman: jbz, Brad_K, yeah, I figured there wasn't a way around it. This would have been such an elegant to solution to my problem. Oh well, back to the drawing board....
[2013-08-08 21:02:40 -0400] Brad_K: jbz: i don't manage my MBP with Chef, either.  but I do install omnibus chef on my MBP so that I can set it up as a Chef Workstation, use chef-solo, etc.
[2013-08-08 21:02:50 -0400] jbz: qhartman:  In Chef context, not really elegant :-P
[2013-08-08 21:02:56 -0400] MoonMan_: jbz:  Can you tell me what the purpose of default in this example code snippet does? Would it be equivalent to "node" in my setup
[2013-08-08 21:02:56 -0400] cpuguy83: I'd prefer the gem install method on my workstation.  I do app dev work primarily, so just having it as a gem is fantastic.
[2013-08-08 21:03:03 -0400] MoonMan_: jbz: default["apache"]["dir"]          = "/etc/apache2"
[2013-08-08 21:03:14 -0400] alexbst: part of me would preffer it if opscode used puppet to manage their hosts.
[2013-08-08 21:03:20 -0400] jbz: MoonMan_:  No, that *sets* an attribute, and it sets it at 'default' precedence level
[2013-08-08 21:03:32 -0400] Brad_K: imo, rvm and rbenv (and the like) are evil.
[2013-08-08 21:03:33 -0400] dgarstang: alexbst: :-O
[2013-08-08 21:03:33 -0400] jbz: MoonMan_: Also, that's deprecated
[2013-08-08 21:03:49 -0400] cpuguy83: Brad_K: Not when you want to switch rubies :)
[2013-08-08 21:03:59 -0400] alexbst: dgarstang - you know it makes sense.
[2013-08-08 21:04:13 -0400] cpuguy83: Brad_K: Check out chruby, no shims or patches to "cd" or anything like that.
[2013-08-08 21:04:16 -0400] joelnn: why is useful to have it as a gem, sorry I don't get it. writing knife modules or something?
[2013-08-08 21:04:16 -0400] Brad_K: cpuguy83: that's why you have omnibus, so that you don't need to switch rubies for your chef code.  ;-)
[2013-08-08 21:04:20 -0400] MoonMan_: jbz: Hmm. What would the correct form be?
[2013-08-08 21:04:26 -0400] MoonMan_: if that's depreciated.
[2013-08-08 21:04:32 -0400] jbz: MoonMan_: It should be something like node.default['foo']['bar'] = "HAITHERE"
[2013-08-08 21:04:36 -0400] cpuguy83: Brad_K: But I already have to switch rubies for my other code
[2013-08-08 21:04:45 -0400] MoonMan_: jbz: Oh yes, I see now.
[2013-08-08 21:04:52 -0400] Brad_K: MoonMan_: you could use node.set["apache"]["dir"] =
[2013-08-08 21:05:26 -0400] Brad_K: imo, the need to switch rubies is the biggest part of the problem.  blech.
[2013-08-08 21:05:37 -0400] joelnn: btw 'gem' totally fails at installing native package deps as far as I know? thus why installing something like nokogiri always fails
[2013-08-08 21:05:39 -0400] MoonMan_: Brad_K: set taking precedence over default?
[2013-08-08 21:05:49 -0400] joelnn: so I don't see how gem chef doesn't fail as well
[2013-08-08 21:05:57 -0400] jbz: MoonMan_:  if you use node.set I think it sets the value at 'override' precedence.
[2013-08-08 21:06:13 -0400] jbz: MoonMan_:  Oh wait, maybe 'normal'
[2013-08-08 21:06:15 -0400] Brad_K: MoonMan_: well, using default will use default precedence, which is the lowest.  i believe that node.set will use normal precence, which is higher.
[2013-08-08 21:06:33 -0400] MoonMan_: Right, that makes sense.
[2013-08-08 21:06:45 -0400] jbz: MoonMan_:  see http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2013-08-08 21:06:53 -0400] Brad_K: you could probably do something like "node.set.normal['attribute']" if you wanted to be explicit.
[2013-08-08 21:07:44 -0400] cpuguy83: Brad_K: Well, I use Rubinius in production, develop in MRI, etc.  Then of course there are newer versions of Ruby to install that fix bugs, patch security holes.
[2013-08-08 21:08:09 -0400] Brad_K: note that you cannot override automatic attributes.  those are set by ohai on discovery, and you can't just double the amount of RAM in the box by overriding the automatic attribute for it.  ;-)
[2013-08-08 21:08:33 -0400] Brad_K: cpuguy83: imo, that's a perfect example of some of the worst symptoms of that problem.
[2013-08-08 21:08:49 -0400] MoonMan_: Much like this? interface=<%= node["network"]["interface_name"] %>
[2013-08-08 21:08:52 -0400] MoonMan_: node.set["network"][interface_name"] = "wlan0"
[2013-08-08 21:08:57 -0400] MoonMan_: then the second one as an attribute?
[2013-08-08 21:09:03 -0400] cpuguy83: Brad_K: Not a problem for me, I have a ruby manager :)
[2013-08-08 21:09:07 -0400] jbz: MoonMan_: Indeed.
[2013-08-08 21:09:19 -0400] MoonMan_: jbz: Great. I'm finally getting the hang of this stuff :)
[2013-08-08 21:09:27 -0400] Brad_K: MoonMan_: the first example would work inside of a template.
[2013-08-08 21:09:35 -0400] Brad_K: the second example would work inside of a recipe.
[2013-08-08 21:09:46 -0400] jbz: MoonMan_: If you're setting that from the attribs file in the cookbook, you want to use the default precedence.  If from a recipe file, that second line works.
[2013-08-08 21:10:06 -0400] MoonMan_: Hm, okay.
[2013-08-08 21:13:33 -0400] mannyt: jbz: so all my attribute files should now be a list of something that looks like this => node.default['foo']['bar'] = "baz"
[2013-08-08 21:14:15 -0400] mannyt: and I can override it in a recipe by doing node.set['foo'][bar'] = "otherbaz"
[2013-08-08 21:14:28 -0400] jbz: mannyt:  I'm not going to make a sweeping claim there.  My understanding, and practice, is to only make default precedence attrib settings in the attrib file
[2013-08-08 21:14:32 -0400] jbz: mannyt:  Yep.
[2013-08-08 21:14:40 -0400] Brad_K: mannyt: the "node.default" notation works in a recipe.  In an attribute file, I would strip off the leading "node." and just have "default['foo']['bar'] = "baz""
[2013-08-08 21:15:23 -0400] mannyt: brad_k: ok wasn't sure if it was better form to start including node everywhere
[2013-08-08 21:15:25 -0400] jbz: What Brad_K says.  I use node.default in attrib files and it seems to work, because of foolish consistency, but I will not claim to be expert or even very knowledgeable about coding standards.
[2013-08-08 21:15:32 -0400] Brad_K: i agree with jbz here on the default precedence in attribute files  don't use anything else unless you know exactly what you're trying to achieve and why.
[2013-08-08 21:16:08 -0400] mannyt: That's what I try for and keep the overriding to roles & environements
[2013-08-08 21:16:17 -0400] jbz: The only place I use non-defaults is when I'm writing very specific custom wrapper cookbooks that I don't expect anyone else to ever use, and there's no easy other way to do it. :-)
[2013-08-08 21:16:37 -0400] Brad_K: for example, if you want to use a wrapper cookbook to over-ride some default values that are set in a lower level cookbook, that might be one case where you might use a different precedence.
[2013-08-08 21:16:44 -0400] jbz: Like, if I need to override a default in the lower cookbookha, yes.
[2013-08-08 21:17:03 -0400] Brad_K: right, wrapping a lower-level "library" cookbook with a higher level "policy" cookbook.
[2013-08-08 21:17:07 -0400] mannyt: that makes sense
[2013-08-08 21:17:49 -0400] mannyt: so if I include a cookbook I can just change the attribute in my wrapper cookbook by setting node.set
[2013-08-08 21:17:55 -0400] mannyt: does node.normal work?
[2013-08-08 21:17:56 -0400] Brad_K: and generally speaking, i would probably try to use environments and/or roles to achieve that goal instead of using a wrapper cookbook.  i would only use a wrapper cookbook if that was my only choice.
[2013-08-08 21:19:19 -0400] Brad_K: mannyt: i'd have to look at some docs and/or code  i don't know for sure that node.normal would work.
[2013-08-08 21:19:19 -0400] mannyt: that makes the most sense
[2013-08-08 21:19:22 -0400] cpuguy83: I put my roles into a cookbook, then the role just contains one cookbook and nothing else.
[2013-08-08 21:20:17 -0400] Brad_K: for me, i want to keep things as reasonably simple as i can.  and my experience is that wrapper cookbooks are usually a level of complexity that is not needed and not desired.  but that's just my personal view.
[2013-08-08 21:20:35 -0400] cpuguy83: I find it the other way
[2013-08-08 21:20:47 -0400] jbz: Brad_K: I have the opposite experience.  I tried to get everything into roles
[2013-08-08 21:20:53 -0400] jbz: and it made things harder to maintain in many cases
[2013-08-08 21:21:00 -0400] joelnn: Brad_K: not knocking your approach, but for my taste, I like having less "things". roles and environments are more "things" :)
[2013-08-08 21:21:01 -0400] Brad_K: i don't know if foodcritic has any rules regarding wrapper cookbooks, but that would be a good place to check to see what the "best practice" is.
[2013-08-08 21:21:07 -0400] jbz: especially those cases where I wanted to specifically frob the setup of one particular community cookbook.
[2013-08-08 21:21:12 -0400] jbz: My fave example is hubot
[2013-08-08 21:21:26 -0400] jbz: Opscode themselves wrapper-cookbooks hubot
[2013-08-08 21:21:54 -0400] jbz: But yes, depends on situation, preference, etc.
[2013-08-08 21:22:21 -0400] Brad_K: i think that might be a case of "Do as I say, not as I do".  Because in their training, they recommend that people use roles and environments instead of wrapper cookbooks.  ;-)
[2013-08-08 21:22:37 -0400] jbz: heh yeah.  I tried to implement hubot using a role.  It just didn't work.
[2013-08-08 21:23:01 -0400] cpuguy83: Because roles are not versioned, it just, to me, makes more sense to use environemnts to lock down cookbook versions and put everything into a wrapper cookbook.
[2013-08-08 21:23:05 -0400] Brad_K: I know this because I recently worked side-by-side with Dan Robinson for about four months, and he has been one of their main trainers.
[2013-08-08 21:23:19 -0400] jbz: So I went the other route.  Note:  I'm firmly in favor of roles for aggregating functionality.  I prefer to use wrappers only when I need to modify the functionality of a community cookbook and don't want to reimplement it.
[2013-08-08 21:23:30 -0400] MoonMan_: Well, wrote my first full template/attribute. Haven't tested yet but the code looks fine to me.  http://pastebin.com/hMKGQxac
[2013-08-08 21:23:44 -0400] Brad_K: and yes, the subject of roles/environments versus wrapper cookbooks most definitely came up.  multiple times.  ;-)
[2013-08-08 21:24:27 -0400] jbz: MoonMan_:  Nice!  One piece of advice, fwiw - I try to always make sure that the only data that goes into an attribute file is a truly global default.
[2013-08-08 21:24:40 -0400] Brad_K: my understanding is that being able to version roles and environments is an improvement that might be included in versions of chef to be delivered in the near future, but i don't know where that falls on the priority list.
[2013-08-08 21:24:45 -0400] jbz: If I'm setting something for a *particular case*, that should always get done with roles, or nodes.
[2013-08-08 21:24:45 -0400] MoonMan_: jbz: Good idea.
[2013-08-08 21:24:49 -0400] jbz: Or environments.
[2013-08-08 21:25:15 -0400] cpuguy83: Brad_K: Makes sense that they would do that since using a cookbook role is a workaround.
[2013-08-08 21:25:28 -0400] jbz: I will go so far as to put 'FIXME' strings in the default attribs file if I need to ensure that nodes shouldn't converge without setting that information.  I'm probably a bad person.
[2013-08-08 21:25:43 -0400] MoonMan_: lol
[2013-08-08 21:26:14 -0400] jbz: Brad_K: I tend to only use a wrapper cookbook if I'm basically monkeypatching the community cookbook.  I won't use it just to set role vars.
[2013-08-08 21:26:37 -0400] cpuguy83: jbz: Even better, node[:foo][:bar] = "#{raise FIXME}"
[2013-08-08 21:26:40 -0400] jbz: If, e.g., I want it to install the software for me but I want to config it in a very different style/place/manner to do with my particular infrastructure.
[2013-08-08 21:26:48 -0400] jbz: cpuguy83++
[2013-08-08 21:26:56 -0400] Brad_K: jbz:  one of the coding standards we specified on that project was that all attributes in a cookbook should have reasonable defaults, but setting something like "FIXME" was a valid solution for those cases where some sort of attribute had to be set but for which there could be no reasonable default.
[2013-08-08 21:27:38 -0400] Brad_K: #{raise FIXME} ?
[2013-08-08 21:27:50 -0400] Brad_K: i'm a little confused by that syntax.  could you explain?
[2013-08-08 21:28:11 -0400] MoonMan_: Likewise, I'm a little confused. Not for my application but good to know.
[2013-08-08 21:28:14 -0400] jbz: I use the hubot example advisedly.  Hubot involves installing a bunch of prereq moving parts and I didn't want to reimplement that, so used the community.  But I wanted hubot itself to actually be installed somewhat differently, so I had the wrapper cookbook do that part of it.
[2013-08-08 21:28:28 -0400] cpuguy83: Brad_K: #{} is for string interpolation, so when the code was evaluated it would raise an exception called "FIXME"
[2013-08-08 21:28:45 -0400] MoonMan_: Ah I see. So almost echoing FIXME?
[2013-08-08 21:29:04 -0400] Brad_K: jbz: yeah, hubot is probably a good example of why you might want to use a wrapper cookbook.
[2013-08-08 21:29:07 -0400] cpuguy83: MoonMan_: It was a joke.  Don't do that :)
[2013-08-08 21:29:17 -0400] MoonMan_: Lmao.
[2013-08-08 21:29:30 -0400] Brad_K: MoonMan_: not just echoing "FIXME", but actually raising the error and calling it "FIXME", which would terminate the chef run.
[2013-08-08 21:29:40 -0400] cpuguy83: BTW, if you aren't all that familiar with ruby (and even if you are), you should definitely subscribe to http://www.rubytapas.com/
[2013-08-08 21:30:06 -0400] cpuguy83: 3xWeek 3-5min episodes, really good stuff
[2013-08-08 21:30:06 -0400] Brad_K: i'm familiar with string interpolation, i had just never seen it in the context of raising an error.
[2013-08-08 21:30:08 -0400] MoonMan_: cpuguy83: Thanks for the link, I'll check that out. Today was my first foray into ruby. I'm going to need any info I can get.
[2013-08-08 21:30:42 -0400] jbz: MoonMan_ WELCOME TO THE FAMILY.  Here are your thick black glasses and lumberjack shirt and MacBook.  ABANDON ALL HOPE.
[2013-08-08 21:31:06 -0400] Brad_K: MoonMan_: i never really learned a lot about Ruby.  that fact has slowed me down, but it hasn't stopped me.
[2013-08-08 21:31:07 -0400] MoonMan_: jbz: Got the macbook, I'll have to pick up a pair of black hipster glasses ;)
[2013-08-08 21:31:21 -0400] cpuguy83: Especially checkout the various episodes on Ruby hashes, will blow your mind as far as setting attribiutes and such goes.
[2013-08-08 21:31:44 -0400] MoonMan_: Sweet, will do.
[2013-08-08 21:31:51 -0400] Brad_K: MoonMan_: don't forget your mandatory subscription to all episodes of the "Red Green Show".  ;-)
[2013-08-08 21:32:30 -0400] MoonMan_: It seems there's a bit of dislike to ruby in the development community. Any reason why?
[2013-08-08 21:32:40 -0400] MoonMan_: Just from hearing my coworkers speak about it.
[2013-08-08 21:33:14 -0400] Brad_K: It's not Ruby itself that I dislike, it's some of the things that come along with Ruby  like needing to switch ruby versions for different things, and therefore needing tools like rvm, rbenv, etc.
[2013-08-08 21:33:25 -0400] cpuguy83: Tip on setting default values, if it's something you don't want to put into your attributes, you can simply call node[:mycookbook].fetch(:myvar) { 'default value' }
[2013-08-08 21:33:56 -0400] cpuguy83: if node[:mycookbook][:myvar] exists, it will use it, otherwise it will use whatever you provide in the block
[2013-08-08 21:35:50 -0400] Static: Hello having a bit of an issue with the chef server without a TLD
[2013-08-08 21:35:50 -0400] Brad_K: MoonMan_: for example, I don't need to switch different versions of C compiler around, and if there are rare cases when I might need multiple different versions of Python, it's up to me to make sure that they are installed in non-conflicting paths and that the right version gets used for the right code.
[2013-08-08 21:36:16 -0400] cpuguy83: Brad_K: You can do that yourself with Ruby as well.
[2013-08-08 21:36:23 -0400] Brad_K: Static: yeah, nodes really want proper FQDNs, ones that are resolvable in the DNS.
[2013-08-08 21:36:37 -0400] Static: I installed and did chef-server-ctl reconfigure but it fails to connect SSL when I try test
[2013-08-08 21:37:16 -0400] Static: and I have FQDN setup
[2013-08-08 21:37:21 -0400] jbz: Static:  I just had that issue using short-order-cook on VMs, I put 'chef-server' into /etc/hosts on the server VM and it fixed it
[2013-08-08 21:37:22 -0400] Static: Any Idea's
[2013-08-08 21:37:46 -0400] Brad_K: cpuguy83: yes, you CAN do that, but most everyone else uses tools like rvm or rbenv and therefore they assume that the entire community will be doing the same, and thus causes significant amounts of pain for people like me who really, really hate things like rvm or rbenv.
[2013-08-08 21:38:04 -0400] Static: jbz yea tried that
[2013-08-08 21:38:41 -0400] cpuguy83: Brad_K: Try just installing using ruby-install or ruby-build.  These tools litterally just install Ruby to the pre-determined locations
[2013-08-08 21:38:42 -0400] Static: Just started at a new gig asked me to install chef on this server with a TLD of internal
[2013-08-08 21:38:50 -0400] Brad_K: Static: yeah, SSL certs are also specific to given domain names, unless you get a wildcard cert.  And clients will usually validate the SSL cert name against the claimed FQDN of the server.  that's the way these things are supposed to work.
[2013-08-08 21:39:01 -0400] cpuguy83: Then you can use whatever Ruby you want (or just the one) without having to have a switcher
[2013-08-08 21:39:27 -0400] dgarstang: Anyone tried to get directories mounted by chef not owned by root?
[2013-08-08 21:39:32 -0400] Brad_K: Static: if that's the case, then set up your own CA with self-signed certs, and issue your own FQDN-based certs that end with ".internal".
[2013-08-08 21:39:38 -0400] Static: So b/c internal isn't a TLD it wont validate the cert
[2013-08-08 21:39:40 -0400] Static: ?
[2013-08-08 21:40:25 -0400] Brad_K: well, ".internal" is not a valid TLD.  So, if you want to do SSL on that, you're pretty much hosed  unless you set up your own CA and issue your own self-signed certs for that TLD.
[2013-08-08 21:40:43 -0400] cpuguy83: Brad_K: I know for a fact that ruby-install will let you install to /opt, or wherever, or default is in ~/.rubies
[2013-08-08 21:41:28 -0400] Brad_K: cpuguy83: that doesn't solve the overall problem that everyone in the community seems to expect that there will be multiple rubies installed on a machine, and that there SHOULD BE multiple rubies installed on a machine.
[2013-08-08 21:41:46 -0400] cpuguy83: Brad_K: I haven't come across that assumption...but I also work alone.
[2013-08-08 21:42:02 -0400] tubbo: depends on your company
[2013-08-08 21:42:19 -0400] tubbo: and honestly how old they are and how long they've been working with raisl
[2013-08-08 21:42:22 -0400] tubbo: rails*
[2013-08-08 21:42:48 -0400] Brad_K: cpuguy83: that's like everyone in the community assuming that everyone else is armed with multiple handguns at all times, and that there are actually valid reasons for doing so  and therefore, they help to create situations where people would actually be likely to need to be armed with multiple handguns.
[2013-08-08 21:43:23 -0400] tubbo: Brad_K: you got that backwards. the violent situation came before the need for multiple handguns.
[2013-08-08 21:43:34 -0400] tubbo: the 1.8 => 1.9 upgrade, realistically
[2013-08-08 21:43:38 -0400] dgarstang: I have a volume mounted with chef. I need to change the owner. I tried putting a file resource on it, but chef complains that the file already exists. What to do?
[2013-08-08 21:43:42 -0400] cpuguy83: In general ruby stuff works across all versions... with some exceptions (1.8 to 1.9 was a major change).  2.0 was a relatively small change  (at least in the Ruby API), but some things did break
[2013-08-08 21:43:51 -0400] Static: Thats ok I think I will just create a new domain with a normal TLD and call it a day :-) BRAD thanks for you help.
[2013-08-08 21:44:18 -0400] Brad_K: cpuguy83: in other words, it creates a nasty catch-22 type situation, and everyone is assumed to be able to deal with that situation, as opposed to avoiding creating the catch-22 situation in the first place.
[2013-08-08 21:44:27 -0400] Brad_K: Static: you're welcome!  glad we could help.
[2013-08-08 21:44:33 -0400] tubbo: i question why we need .ruby-version really
[2013-08-08 21:44:35 -0400] cpuguy83: And there are new syntaxes in 1.9 that don't work in 1.8 (namely hash syntax and stabby lambda)
[2013-08-08 21:44:39 -0400] tubbo: i don't even include it in most of my aps
[2013-08-08 21:44:40 -0400] tubbo: apps*
[2013-08-08 21:45:06 -0400] tubbo: default is always 1.9 or 2.0, and my rails apps at least work with it. if i didn't have to work with 1.8.7 i'd just `brew install ruby` and be done with it on my mac
[2013-08-08 21:45:08 -0400] cpuguy83: tubbo: insurance
[2013-08-08 21:45:24 -0400] tubbo: cpuguy83: for what? i control the server.
[2013-08-08 21:45:33 -0400] cpuguy83: tubbo: insurance :)
[2013-08-08 21:45:47 -0400] tubbo: eh, i got enough insurance.
[2013-08-08 21:46:11 -0400] tubbo: the one part that sucks is how rbenv pretty much needs to manage Ruby entirely or not at all
[2013-08-08 21:46:14 -0400] adnichols: dgarstang did you try action :touch ? not sure if that'll do it or not
[2013-08-08 21:46:44 -0400] dgarstang: adnichols: Will do
[2013-08-08 21:46:49 -0400] cpuguy83: Honestly if the package maintainers for the distros included updated versions of Ruby, it wouldn't likely be a problem at all
[2013-08-08 21:47:20 -0400] tubbo: yeah
[2013-08-08 21:47:31 -0400] dgarstang: adnichols: it did. tried create_if_missing earlier. Thanks
[2013-08-08 21:47:49 -0400] tubbo: i've heard that the problem with APT, at least, is that the maintainers want stable and battle-tested versions because that's like the "guarantee" with apt, that you're not gonna get something that breaks all over the place
[2013-08-08 21:47:57 -0400] adnichols: dgarstang cool, wasn't sure if that would work - seemed like the only option that wouldn't complain if something existed already
[2013-08-08 21:48:03 -0400] tubbo: and realistically, i've installed versions of ruby and encountered lang-level bugs.
[2013-08-08 21:48:07 -0400] cpuguy83: tubbo: for Ubuntu LTS, for sure.
[2013-08-08 21:48:11 -0400] tubbo: so it *can* happen
[2013-08-08 21:48:44 -0400] cpuguy83: Really nice that mavericks is including a recent Ruby.
[2013-08-08 21:48:45 -0400] tubbo: cpuguy83: seems to be what all the maintainers do, in many ways. that's the explanation i've been given for why it seems to be an unsolvable problem
[2013-08-08 21:48:51 -0400] tubbo: yeah no it's not
[2013-08-08 21:49:01 -0400] tubbo: it's a pain in the ass
[2013-08-08 21:49:13 -0400] tubbo: and it always will be until os x stops shipping with software that i'm going to reinstall anyway >:(
[2013-08-08 21:49:40 -0400] tubbo: is it really a coincidence that *every* time i go to install postgres i have to deal with some fucking BULLSHIT?
[2013-08-08 21:49:50 -0400] tubbo: OS agnostic
[2013-08-08 21:49:50 -0400] cpuguy83: tubbo: Postgres.app
[2013-08-08 21:49:58 -0400] tubbo: yeah, that's what i've resorted to
[2013-08-08 21:50:00 -0400] tubbo: and that's late,
[2013-08-08 21:50:01 -0400] tubbo: lame*
[2013-08-08 21:50:16 -0400] tubbo: it's a fuckin shell program, why does it need to be a mac app? is the shell really that broken?
[2013-08-08 21:51:29 -0400] cpuguy83: tubbo: It is when it's not Apple's focus
[2013-08-08 21:51:56 -0400] tubbo: sorry for venting but that's one thing about OS X that really bugs me. and i can't believe that they continue to suffer from this delusion that what they're doing is a "good thing" and isn't like, ruining my life every time i have to fucking install a DATABASE..
[2013-08-08 21:54:38 -0400] Brad_K: dgarstang: i think the volume might have to be unmounted before you can change the ownership of the mount point, which would then take effect when you re-mount the volume.
[2013-08-08 21:55:19 -0400] mikedisney: I'm trying access python version from ohai, but @node[:python][:version] is bombing. How do I access a ohai variable from inside a template?
[2013-08-08 21:56:14 -0400] Brad_K: tubbo: sorry, Apple is focusing on normal consumers, and installing a database is not something that any "normal consumer" would ever do.  at least, not knowingly.
[2013-08-08 21:56:51 -0400] Brad_K: mikedisney: that syntax would only work inside of a template, and then only if you passed that attribute into the template.  i don't think that's what you want.
[2013-08-08 21:57:30 -0400] mikedisney: Brad_K, I have to pass it in? It's not just *available* ? that's weird. I coulda sworn all ohai variables were available
[2013-08-08 21:58:08 -0400] Brad_K: mikedisney: automatic attributes (i.e., that are discovered by ohai) are available, but using "@" is not the way to access them  not unless you're inside of a template.
[2013-08-08 21:58:33 -0400] mikedisney: i'm inside a template. That's what i'm asking. "...from inside a template"
[2013-08-08 21:59:01 -0400] mikedisney: so the syntax is @node ?
[2013-08-08 21:59:03 -0400] Brad_K: The "@" syntax is only used on variables that are explicitly passed into a template by the calling code.
[2013-08-08 21:59:39 -0400] mikedisney: oh, I see. in ohai it looks like the path is languages.python -- so how do I access ohai variables? just type "languages[:python].." ?
[2013-08-08 22:00:06 -0400] Brad_K: Otherwise, normal "<%= node[:symbol][:symbol] %>" notation should be sufficient.
[2013-08-08 22:00:40 -0400] kl4m: mikedisney: <%= node[:languages][:python][:version] %>
[2013-08-08 22:00:41 -0400] Brad_K: automatic attributes would be accessed just like any other node attribute.
[2013-08-08 22:00:51 -0400] mikedisney: kl4m, thanks for understanding!
[2013-08-08 22:01:20 -0400] Brad_K: mikedisney: sorry, i wasn't getting what part it was that you weren't understanding.  ;-(
[2013-08-08 22:01:35 -0400] mikedisney: no worries
[2013-08-08 22:02:10 -0400] kl4m: mikedisney: @something is for variables( :something => "value" ) in a template definition
[2013-08-08 22:04:03 -0400] dgarstang: how can I see all node variables for a host?
[2013-08-08 22:04:23 -0400] Brad_K: dgarstang: "knife node show node hostname -l"
[2013-08-08 22:04:31 -0400] Brad_K: be prepared for a *boatload* of output.
[2013-08-08 22:04:31 -0400] dgarstang: Brad_K: That doesn't show all the vars
[2013-08-08 22:04:40 -0400] dgarstang: Brad_K: no boatload here
[2013-08-08 22:05:00 -0400] Brad_K: dgarstang: that will show everything that is defined for that node, as recorded by the chef server.
[2013-08-08 22:05:29 -0400] dgarstang: Brad_K: It's not. I have variables I am accessing that aren't shown. It doesn't even have a key on the left for variables.
[2013-08-08 22:09:11 -0400] tubbo: Brad_K: wanna know something even funnier?
[2013-08-08 22:09:22 -0400] tubbo: Brad_K: the db apparently is used by OS X itself.
[2013-08-08 22:09:24 -0400] Brad_K: if you've trimmed stuff off before the node.save operation happens at the end of the chef run, then you're throwing away information.
[2013-08-08 22:09:24 -0400] Brad_K: if there are other attributes that could be defined but do not have a default value, then they won't show up on the chef server.
[2013-08-08 22:09:25 -0400] Brad_K: dgarstang: so, what *are* you seeing when you do a "knife node show node hostname -l" ?
[2013-08-08 22:09:27 -0400] tubbo: in some way
[2013-08-08 22:10:28 -0400] dgarstang: Brad_K: http://pastebin.com/mHCYcwUg
[2013-08-08 22:10:58 -0400] Brad_K: dgarstang: you missed the "-l" argument at the end of the command line.  what you got is the short summary display.
[2013-08-08 22:11:10 -0400] dgarstang: Brad_K: *squinty eye* Thanks
[2013-08-08 22:11:34 -0400] dgarstang: Brad_K: it's a shame Ohai doesn't show the same stuff
[2013-08-08 22:12:01 -0400] dgarstang: Brad_K: and you know what... -l didn't show the data either
[2013-08-08 22:12:33 -0400] dgarstang: Brad_K: but, some of those values that don't appear are set correctly.
[2013-08-08 22:12:38 -0400] Brad_K: dgarstang: ohai isn't really meant to be used by humans.  it's meant to be used by programs to auto-discover everything about the node that it can find, and then pass that information back in a way that is easy to parse.
[2013-08-08 22:12:49 -0400] dgarstang: Brad_K: facter does it. :)
[2013-08-08 22:13:22 -0400] Brad_K: if you pipe the output of "knife node show node hostname -l" to "wc", how many lines of output are you getting?
[2013-08-08 22:13:56 -0400] Brad_K: dgarstang: if you want to use facter and puppet, you're welcome to do that.  i want to learn puppet myself, but i don't think this is the right support channel for puppet.  ;-)
[2013-08-08 22:14:00 -0400] dgarstang: Brad_K: 1016 .... not including the ones I was after. :)
[2013-08-08 22:14:24 -0400] dgarstang: and... what the heck do the @ symbols means on template variables?
[2013-08-08 22:14:29 -0400] Brad_K: a thousand lines of output sounds about right for a node that doesn't have a lot of information being stored.
[2013-08-08 22:15:07 -0400] Brad_K: The @ symbol just means that you're referring to the variable that was passed into the template by the code that called the template, as opposed to any of the node attributes, etc....
[2013-08-08 22:15:10 -0400] dgarstang: Brad_K: the missing ones are mysterrious. These values, which are mostly working (I wanted to debug one), are being passed to chef-solo via... I dunno... vagrant. it's all obfuscate
[2013-08-08 22:15:20 -0400] dgarstang: ...
[2013-08-08 22:15:23 -0400] dgarstang: ....d
[2013-08-08 22:15:47 -0400] Brad_K: dgarstang: see http://bit.ly/XQW3O4
[2013-08-08 22:16:28 -0400] dgarstang: Brad_K: uses '@' in examples but doesn't explain their meaning
[2013-08-08 22:16:30 -0400] Brad_K: dgarstang: oh.  chef-solo and vagrant.  yeah, well  chef-solo doesn't talk to chef-server, so none of that information would be saved and made persistent.
[2013-08-08 22:16:43 -0400] dgarstang: Brad_K: noice
[2013-08-08 22:17:49 -0400] Brad_K: dgarstang: take this example  ``<%= "my name is #{$ruby}" %>``
[2013-08-08 22:17:53 -0400] dgarstang: Seems like @ is required when variables => is used, but not when node[foo] is used, which I don't understand, because their both supposed to be just variables.
[2013-08-08 22:18:29 -0400] Brad_K: in this case, #{$ruby} is doing string interpolation (via #{}) on the $ruby variable.
[2013-08-08 22:18:38 -0400] Brad_K: notice that there is no @ sign used in that example.
[2013-08-08 22:18:47 -0400] Brad_K: Ruby variables != attributes.
[2013-08-08 22:18:57 -0400] dgarstang: ugh
[2013-08-08 22:19:07 -0400] Brad_K: attributes are accessed through methods like node[:symbol][:symbol]
[2013-08-08 22:19:30 -0400] dgarstang: Brad_K: or with @var if passed via variables => to template
[2013-08-08 22:19:37 -0400] Brad_K: Ruby variables could be named anything, and depending on their scope might be local or global, and named "fred", "$fred", or whatever.
[2013-08-08 22:20:26 -0400] Brad_K: dgarstang: if a node attribute is passed in that manner to a template, then what the template would be accessing would be the template variable by that name, and not the node attribute that it refers to.
[2013-08-08 22:20:34 -0400] Brad_K: yes, it's all confusing.
[2013-08-08 22:20:51 -0400] dgarstang: which requires @...
[2013-08-08 22:21:09 -0400] Brad_K: template variables are accessed with @ symbols, yes.
[2013-08-08 22:21:30 -0400] dgarstang: Brad_K: okidoki
[2013-08-08 22:21:49 -0400] Brad_K: but template variables are not the same thing as Ruby variables, and neither of those are the same as node attributes, even if they might happen to hold the same value.
[2013-08-08 22:22:36 -0400] Brad_K: The piece of paper I hold in my hand that says "#7" on it isn't the same piece of paper that you hold in your hand, even if yours also says "#7" on it.
[2013-08-08 22:23:32 -0400] dgarstang: does puppet have this 'feature'... wondering... no I don't think so.
[2013-08-08 22:24:18 -0400] Brad_K: i don't know much about puppet, so i'm not qualified to answer questions like that.
[2013-08-08 22:47:09 -0400] DrHappyAngry: hey guys, I'm having some trouble with chef-solo and the nagios cookbook
[2013-08-08 22:47:49 -0400] DrHappyAngry: I've had it working from a real chef server, but when trying to get it to apply using chef-solo, it's trying to do some things in the wrong order
[2013-08-08 22:48:18 -0400] DrHappyAngry: it keeps getting stuck trying to restart apache before nagios has been installed and before it generates an ssl cert
[2013-08-08 22:52:16 -0400] DrHappyAngry: i fed it an ssl cert to get it past there, and gave it the right attributes to get it past there, but it still failed because the root dir for apache to serve nagios out of doesn't exist
[2013-08-08 22:54:02 -0400] dgarstang: I have source 'file://etc/rc.local' on a remote_file ... chef is complaining 'No such file or directory - /rc.local'. Don't get it
[2013-08-08 22:57:05 -0400] dgarstang: I must be missing something, because not a single example at http://docs.opscode.com/resource_remote_file.html uses file://
[2013-08-08 22:57:40 -0400] siezer: you're missing a / in your file:// slash etc
[2013-08-08 22:57:56 -0400] dgarstang: siezer: apparently I need to use cookbook_file it seems
[2013-08-08 22:58:23 -0400] siezer: cookbook_file pulls files from cookbooks synced form chef-server, remote_file lets you speify network URIs
[2013-08-08 22:58:33 -0400] Brad_K: okay folks, gotta go.  thanks!
[2013-08-08 22:58:49 -0400] dgarstang: siezer: Yes. I think I already knew that, but forgot, because it's not particularly intuitive
[2013-08-08 22:59:58 -0400] DrHappyAngry: any ideas as to why chef-solo would run things out of order, when doing a why-run shows each step in the right order?
[2013-08-08 23:22:43 -0400] yoshie902a: Can someone point me to a resource that explains the cookbook structure?
[2013-08-08 23:26:26 -0400] adnichols: yoshie902a http://docs.opscode.com/essentials_cookbooks.html ?
[2013-08-08 23:29:19 -0400] yoshie902a: adnichols:  very helpful, thank you
[2013-08-08 23:49:27 -0400] Sauraus_: Quick question, what is the best way to deploy node/role specific configuration files for something like solr?
[2013-08-08 23:49:59 -0400] Sauraus_: I have a cookbook that does the basic solr install & config of jetty, but I now need to deploy the solr instance specific config files
