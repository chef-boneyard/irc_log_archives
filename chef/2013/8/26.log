[2013-08-26 00:03:25 -0400] mydog2: gchristensen, - thanks... the initial system, will be light years away from the final system!! but my initial system can be fairly complex, depending on which app i start with
[2013-08-26 02:15:38 -0400] lazyPower: Its moments like this that i'm happy i subscribe to newrelic.
[2013-08-26 02:15:46 -0400] lazyPower: All that out of the box without any setup.
[2013-08-26 02:23:23 -0400] lazyPower: </offtopic>
[2013-08-26 02:48:35 -0400] gchristensen: lazyPower: re all the stuff I was talking about?
[2013-08-26 03:00:28 -0400] meckadocious: hello all
[2013-08-26 03:00:36 -0400] meckadocious: i'm running into this issue :( http://tickets.opscode.com/browse/CHEF-3940
[2013-08-26 03:00:42 -0400] meckadocious: does anyone know of a workaround?
[2013-08-26 03:04:36 -0400] meckadocious: to summarize: the git resource seems mostly broken for me on Ubuntu 13.04 and git 1.8.1.2
[2013-08-26 03:11:09 -0400] meckadocious: eek, well this is ugly, but it fixed it: ENV['HOME'] = ''
[2013-08-26 03:11:51 -0400] meckadocious: (in my recipe)
[2013-08-26 04:35:33 -0400] pdffs: Hi all, my Chef installation has just stopped functioning - I'm stumped and Google has nothing apparently relevant
[2013-08-26 04:36:04 -0400] pdffs: It looks like erchef can't connect to postgres, per: http://pastebin.com/aRW8Pg89
[2013-08-26 04:36:42 -0400] pdffs: but I've connected via the cli, using the opscode_chef user with no problem
[2013-08-26 04:45:05 -0400] pdffs: nvm, some idiot edited the hosts file and deleted the localhost entry for 127.0.0.1, leaving only ::1 with a localhost entry
[2013-08-26 04:45:29 -0400] pdffs: and erchef specifies 127.0.0.1, so it won't connect over ipv6
[2013-08-26 04:45:57 -0400] pdffs: but postgres listens on whatever is set to 'localhost'
[2013-08-26 06:43:47 -0400] GreatSUN: Hi all
[2013-08-26 06:44:28 -0400] GreatSUN: does someone know how I can run a template lwrp within ruby code immediately instead of delayed upon the run of all lwrp's?
[2013-08-26 06:45:30 -0400] GreatSUN: hey muqsith
[2013-08-26 06:45:43 -0400] GreatSUN: oh sorry... wrong window :D
[2013-08-26 06:48:04 -0400] GreatSUN: btm, fujin ?
[2013-08-26 06:48:06 -0400] GreatSUN: you there?
[2013-08-26 09:50:26 -0400] linuxboy: hello
[2013-08-26 09:50:34 -0400] linuxboy: can anyone look at this pull request for the jenkins cookbook? https://github.com/opscode-cookbooks/jenkins/pull/60
[2013-08-26 09:50:48 -0400] linuxboy: also this one: https://github.com/opscode-cookbooks/jenkins/pull/59
[2013-08-26 10:02:10 -0400] PierreO: linuxboy, what do you mean "look at this pull request"? I looked at them :) (i use the jenkins cookbook alos)
[2013-08-26 10:03:59 -0400] linuxboy: PierreO: I'd like them merged ;)
[2013-08-26 10:04:08 -0400] linuxboy: PierreO: not sure who can do that
[2013-08-26 10:04:11 -0400] PierreO: I can't do that :)
[2013-08-26 10:05:26 -0400] PierreO: Ah, mine just get merged : https://github.com/opscode-cookbooks/nginx/pull/133 hehe, it is @sethvargo who did it!
[2013-08-26 10:08:21 -0400] gkarekinian: You need to create issues on tickets.opscode.com if you want them merged
[2013-08-26 10:08:28 -0400] linuxboy: I did
[2013-08-26 10:08:28 -0400] PierreO: You can use it ;) Fork the cookbook, apply the 2 patches, use berkshelf and point it to your github repo
[2013-08-26 10:08:48 -0400] gkarekinian: They do cookbook reviews once a week or something
[2013-08-26 10:09:03 -0400] linuxboy: PierreO: yeah, I totally can, I'd like to see them get into master too
[2013-08-26 10:09:03 -0400] PierreO: linuxboy, you need https://github.com/adrianmoisey to sign the contributer licence agreement also
[2013-08-26 10:09:19 -0400] linuxboy: gkarekinian: do you know when the reviews are?
[2013-08-26 10:09:34 -0400] linuxboy: gkarekinian: and if I can ping someone to ask to get it reviewed when then
[2013-08-26 10:09:40 -0400] gkarekinian: Nope sorry
[2013-08-26 10:10:51 -0400] linuxboy: PierreO: what is berkshelf?
[2013-08-26 10:10:56 -0400] linuxboy: PierreO: just took a quick look at it now
[2013-08-26 10:12:07 -0400] PierreO: I don't know if you know ruby, but if you do, it's like bundler
[2013-08-26 10:12:16 -0400] PierreO: it's a dependency manager
[2013-08-26 10:13:13 -0400] PierreO: you have a Berksfile on your project, and you write in which cookbook, which version, from which source do you want
[2013-08-26 10:13:50 -0400] PierreO: then "berks install" or "berks upload" if you have a chef server, and voila ;)
[2013-08-26 10:14:57 -0400] linuxboy: nice
[2013-08-26 10:15:00 -0400] linuxboy: I'll look into it
[2013-08-26 11:46:43 -0400] telefoonboek: I have a problem with the user resource: when the user is already correct it will be ran as "usermod <user>", this is incorrect syntax and thus will return an error
[2013-08-26 11:46:48 -0400] telefoonboek: How can I fix this?
[2013-08-26 12:13:30 -0400] jjmojojjmojo: telefoonboek: can you give a specific example? Also, what platform?
[2013-08-26 13:14:11 -0400] abrkn: what can cause my node to believe its run list is simply an array containing a single string, "roles"?
[2013-08-26 13:17:04 -0400] abrkn: heres the output: http://gyazo.com/b61c3b2e8fa89af2cfdf0c7c06fb7bad.png
[2013-08-26 13:17:38 -0400] gchristensen: abrkn: how did you bootstrap it?
[2013-08-26 13:18:19 -0400] abrkn: like this: http://gyazo.com/70eea92f704f7320eea19f2eb3e9bc32.png
[2013-08-26 13:18:59 -0400] abrkn: i dont understand how the run list becomes ["roles"]
[2013-08-26 13:19:41 -0400] gchristensen: might be a bug in knife-ec2
[2013-08-26 13:20:05 -0400] abrkn: the bootstrap is a copy-paste of another role, "pgm" (m is master, s is slave)
[2013-08-26 13:21:05 -0400] abrkn: it's like my run list is being ignored (-r role[pgs])
[2013-08-26 14:20:19 -0400] djstunami: So, why is that to upgrade a chef client from 11.4.4 to 11.6.0 I need to bootstrap, rather than just having a recipe do that?
[2013-08-26 14:22:01 -0400] gchristensen: djstunami: you don't have to
[2013-08-26 14:22:13 -0400] gchristensen: djstunami: http://community.opscode.com/cookbooks/omnibus_updater
[2013-08-26 14:22:31 -0400] djstunami: oh nice!
[2013-08-26 14:22:47 -0400] gchristensen: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2013-08-26 14:22:47 -0400] djstunami: gchristensen: thanks!
[2013-08-26 14:22:51 -0400] gchristensen: ^ you can also just run that
[2013-08-26 14:25:29 -0400] djstunami: gchristensen: I knew about "curl -L https://www.opscode.com/chef/install.sh | sudo bash" but I'm not going to do that on 200+ systems, and for whatever reason, I couldn't find the omnibus_updater when I looked into this a month ago.  This is very helpful, thanks again.
[2013-08-26 14:25:37 -0400] gchristensen: surely
[2013-08-26 14:26:39 -0400] gchristensen: djstunami: knife ssh "*:*" "curl -L https://www.opscode.com/chef/install.sh | sudo bash" ;)
[2013-08-26 14:26:53 -0400] gchristensen: sorry, I don't need to troll here3.
[2013-08-26 14:27:32 -0400] djstunami: haha, we have security rules that prevent that from being productive.
[2013-08-26 14:29:37 -0400] abrkn: im having the same problem as this guy: https://gist.github.com/kaldrenon/2578204
[2013-08-26 14:29:39 -0400] abrkn: ideas?
[2013-08-26 14:29:47 -0400] gchristensen: djstunami: good :)
[2013-08-26 14:31:24 -0400] djstunami: abrkn: what does your  /var/chef/cache/chef-stacktrace.out say?
[2013-08-26 14:31:47 -0400] djstunami: because it looks like you have a bad run list
[2013-08-26 14:35:35 -0400] abrkn: damn
[2013-08-26 14:35:39 -0400] abrkn: its some bash escaping
[2013-08-26 14:35:53 -0400] abrkn: "role[pgs]" expands to "roles"
[2013-08-26 14:46:08 -0400] abrkn: no idea why...
[2013-08-26 14:48:15 -0400] helllen_: helllo
[2013-08-26 14:49:00 -0400] helllen_: I do reload chef-client client in my template with Chef::Config.from_file("/opt/rb/etc/chef/client.rb")
[2013-08-26 14:49:14 -0400] helllen_: the problem it looks like not reload the interval
[2013-08-26 14:49:39 -0400] helllen_: how could I change the interval time in the chef-client template
[2013-08-26 14:50:20 -0400] bean: helllen_: you mean the time between runs?
[2013-08-26 14:50:44 -0400] helllen_: yes
[2013-08-26 14:51:03 -0400] helllen_: I have chef-client running and I want to reload it configuration using template https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/config.rb
[2013-08-26 14:51:04 -0400] bean: are you using the chef-client cookbook?
[2013-08-26 14:51:07 -0400] bean: ok
[2013-08-26 14:51:10 -0400] helllen_: yes
[2013-08-26 14:51:28 -0400] helllen_: with previous version 11.4 worked
[2013-08-26 14:51:37 -0400] helllen_: and with new version 11.6 looks like not working
[2013-08-26 14:51:40 -0400] bean: helllen_: look at the attributes.
[2013-08-26 14:51:52 -0400] bean: https://github.com/opscode-cookbooks/chef-client/blob/master/attributes/default.rb#L36
[2013-08-26 14:52:28 -0400] helllen_: this is the client.rb I use
[2013-08-26 14:52:29 -0400] helllen_: http://pastebin.com/TYrZ3MpR
[2013-08-26 14:52:55 -0400] bean: helllen_: why not just override the interval attribute?
[2013-08-26 14:53:09 -0400] helllen_: yes I do this
[2013-08-26 14:53:24 -0400] bdemers: Anyone ever created a remote file fetcher ?
[2013-08-26 14:53:46 -0400] bdemers: I assume i could just monkey patch the fetcher.rb [https://github.com/opscode/chef/blob/master/lib/chef/provider/remote_file/fetcher.rb]
[2013-08-26 14:53:48 -0400] bean: bdemers: http://docs.opscode.com/resource_remote_file.html ?
[2013-08-26 14:54:19 -0400] bean: bdemers: ah, you're wanting something other than http / https / ftp / file?
[2013-08-26 14:54:34 -0400] helllen_: bean, I have even changed action nothing for action :run
[2013-08-26 14:54:36 -0400] bdemers: bean:  exactly, my-protocol://some/uri
[2013-08-26 14:54:47 -0400] bean: helllen_: i'm not sure then
[2013-08-26 14:54:50 -0400] helllen_: to force read the file every time
[2013-08-26 14:55:01 -0400] bean: bdemers: yeah, i'd be that would work.
[2013-08-26 14:55:28 -0400] helllen_: but it doesn't care
[2013-08-26 14:55:36 -0400] bean: helllen_: i'm not sure then.
[2013-08-26 14:55:56 -0400] helllen_: is attribute interval called interval too with the new version
[2013-08-26 14:55:57 -0400] bdemers: and is doing this _maintainable_ ? seems kinda dirty, but i can't think of another way to do it ?
[2013-08-26 14:55:57 -0400] helllen_: ?
[2013-08-26 14:56:03 -0400] helllen_: or has it change ?
[2013-08-26 14:56:26 -0400] bean: helllen_: I'd assume that it's still called interval
[2013-08-26 14:56:26 -0400] railsraider: hi how can i disable by attribute or another way migration on the application_ruby cookbook?
[2013-08-26 14:56:35 -0400] bean: helllen_: where are you defining the interval
[2013-08-26 14:56:58 -0400] helllen_: as a node attribute
[2013-08-26 14:57:16 -0400] bean: ok
[2013-08-26 14:58:15 -0400] bean: helllen_: and you're doing that like
[2013-08-26 14:58:41 -0400] bean: sry, have to find example
[2013-08-26 14:59:25 -0400] bean: helllen_: {"chef_client
[2013-08-26 14:59:40 -0400] bean: helllen_: {"chef_client": {"interval": number here}}
[2013-08-26 14:59:42 -0400] bean: right?
[2013-08-26 15:00:45 -0400] railsraider: anyway to disable the migration on the application_ruby cookbook
[2013-08-26 15:01:11 -0400] helllen_: http://pastebin.com/TYrZ3MpR
[2013-08-26 15:01:20 -0400] helllen_: this is the rb, is that what you mean ?
[2013-08-26 15:01:35 -0400] bean: helllen_: no, i mean in the node attributes
[2013-08-26 15:01:51 -0400] helllen_: node["chef_client"]["interval"] = 300
[2013-08-26 15:02:19 -0400] helllen_: I change the attribute with chef api with: node.set["chef_client"]["interval"] = 300
[2013-08-26 15:02:34 -0400] bean: alright, I usually define this sort of stuff on the actual chef server / hosted chef
[2013-08-26 15:02:47 -0400] bean: I think if you set it like that, it won't pick it up til the next run
[2013-08-26 15:02:53 -0400] helllen_: I could do it like that too
[2013-08-26 15:03:44 -0400] helllen_: the problem is running chef-client doesn't reload the new configuration file
[2013-08-26 15:04:43 -0400] helllen_: before it worked
[2013-08-26 15:04:58 -0400] helllen_: I change: chef from 11.4 to 11.6
[2013-08-26 15:05:00 -0400] bean: helllen_: does the file update?
[2013-08-26 15:05:09 -0400] helllen_: and daemon script
[2013-08-26 15:05:16 -0400] helllen_: now I use runit
[2013-08-26 15:05:17 -0400] bean: helllen_: maybe it's looking for the wrong client.rb
[2013-08-26 15:05:54 -0400] helllen_: no because I have changed and I set:    Chef::Config.from_file("/opt/rb/etc/chef/client.rb")
[2013-08-26 15:05:58 -0400] helllen_: directly the file
[2013-08-26 15:06:15 -0400] helllen_: mmmmm
[2013-08-26 15:06:24 -0400] helllen_: I think I have seen the error
[2013-08-26 15:06:25 -0400] helllen_: !!!
[2013-08-26 15:06:28 -0400] helllen_: wrong file
[2013-08-26 15:06:32 -0400] helllen_: let me check
[2013-08-26 15:07:36 -0400] abrkn: When I bootstrap with knife ec2 server create -r 'role[myrole]' it fails because its expanded to [roles]. however, if i ssh in to the machine and run chef client, it currently runs role[myrole]. theres not much info in the stacktrace.out
[2013-08-26 15:07:37 -0400] helllen_: no it wasn't the error, it is the same file
[2013-08-26 15:08:03 -0400] helllen_: I have a symbolinc link:   /etc/chef -> /opt/rb/etc/chef
[2013-08-26 15:08:35 -0400] bean: helllen_: if you manually restart chef client does it pick up the change/
[2013-08-26 15:08:41 -0400] helllen_: yes
[2013-08-26 15:08:58 -0400] helllen_: but I would like to do it without restart the service
[2013-08-26 15:09:11 -0400] bean: yeah, for sure.
[2013-08-26 15:09:31 -0400] bean: I'm not sure how to fix this, sorry. :\ Maybe someone with more experience does
[2013-08-26 15:10:11 -0400] helllen_: np
[2013-08-26 15:10:13 -0400] helllen_: thanks
[2013-08-26 15:10:15 -0400] helllen_: it so strange
[2013-08-26 15:13:40 -0400] helllen_: bean, I have noticed one strange thing
[2013-08-26 15:13:44 -0400] helllen_: Chef::Config.from_file("/opt/rb/etc/chef/client.rb") return false
[2013-08-26 15:13:49 -0400] helllen_: is that normal ?
[2013-08-26 15:14:26 -0400] bean: no idea.
[2013-08-26 15:27:07 -0400] helllen_: bean, I have news
[2013-08-26 15:27:11 -0400] bean: do tell
[2013-08-26 15:27:26 -0400] helllen_: I have print into file the Chef::Config.interval used
[2013-08-26 15:27:37 -0400] helllen_: I have a template print variables in chef
[2013-08-26 15:27:56 -0400] helllen_: and the Chef::Config.interval doesn't correspond with the reader on file
[2013-08-26 15:28:00 -0400] bean: hmm ok
[2013-08-26 15:28:16 -0400] helllen_: is like Chef::Config.from_file doesn't update interval value
[2013-08-26 15:29:37 -0400] helllen_: I have notice another thing :-D
[2013-08-26 15:29:43 -0400] helllen_: the value is changed
[2013-08-26 15:29:48 -0400] helllen_: but is not saved
[2013-08-26 15:29:50 -0400] helllen_: I mean
[2013-08-26 15:30:17 -0400] helllen_: I check the variable before the  Chef::Config.from_file and after this
[2013-08-26 15:30:38 -0400] helllen_: and the value change from 5 (old value ) to 300 (new value reader from file)
[2013-08-26 15:31:01 -0400] helllen_: the problem is the cookbook finish and the next run keep old value
[2013-08-26 15:31:13 -0400] helllen_: it is like it doesn't update it
[2013-08-26 15:31:42 -0400] helllen_: there is like an  Chef::Config.save
[2013-08-26 15:31:44 -0400] helllen_: or  Chef::Config.apply
[2013-08-26 15:31:49 -0400] helllen_: or something like this ?
[2013-08-26 15:35:58 -0400] bean: No idea.
[2013-08-26 15:36:13 -0400] helllen_: hahah
[2013-08-26 15:36:15 -0400] helllen_: logical
[2013-08-26 15:36:19 -0400] helllen_: it is so strange
[2013-08-26 15:40:06 -0400] helllen_: bean, are you developer of chef ?
[2013-08-26 15:40:12 -0400] bean: no sir
[2013-08-26 15:40:14 -0400] bean: just a user
[2013-08-26 15:40:20 -0400] helllen_: oki
[2013-08-26 15:40:30 -0400] helllen_: I have checked with previous version
[2013-08-26 15:40:40 -0400] helllen_: 11.4.4 and it works perfectly
[2013-08-26 15:40:41 -0400] yfeldblum: helllen_, you can recognize the chef developers by their harps and cranial halos
[2013-08-26 15:40:58 -0400] helllen_: ok
[2013-08-26 15:41:06 -0400] helllen_: it is a bug of new version I think
[2013-08-26 15:44:37 -0400] helllen_: is there any chef developer could confirm if it is a bug ?
[2013-08-26 15:45:13 -0400] afirth: does it work in 11.4.4?
[2013-08-26 15:45:21 -0400] helllen_: yes
[2013-08-26 15:45:32 -0400] helllen_: I have just changed to 11.4.4 and works
[2013-08-26 15:45:52 -0400] helllen_: change the client properties into the cookbook with out restart
[2013-08-26 15:45:55 -0400] afirth: ok checked here? http://tickets.opscode.com/secure/Dashboard.jspa
[2013-08-26 15:47:37 -0400] helllen_: what do I check there ?
[2013-08-26 15:48:53 -0400] helllen_: I am going to create a bug
[2013-08-26 15:48:55 -0400] helllen_: thanks
[2013-08-26 15:53:19 -0400] helllen_: issue created
[2013-08-26 15:53:25 -0400] helllen_: I hope they answer
[2013-08-26 15:53:27 -0400] helllen_: thanks
[2013-08-26 15:54:29 -0400] afirth: helllen_: sry, in a meeting. suggest searching for an existing bug, and then ya, submitting one :)
[2013-08-26 15:54:31 -0400] afirth: good luck
[2013-08-26 15:54:45 -0400] helllen_: thanks
[2013-08-26 15:54:57 -0400] helllen_: anyway I have back ported again to 11.4.4
[2013-08-26 15:56:02 -0400] afirth: yeah, thank goodness for rvm
[2013-08-26 16:12:19 -0400] rayrod2030: any recommendation for a test framework to verify multi-node interaction and behavior?
[2013-08-26 16:12:43 -0400] rayrod2030: I was pretty sure there was a project called short order cook that did something like this but cannot find it on the googlez.
[2013-08-26 16:12:58 -0400] adamjk-dev: rayrod2030: let me know if you find an alternative to hacking up test-kitchen etc.
[2013-08-26 16:13:16 -0400] cpuguy83: anyone familiar with the windows_package resource?
[2013-08-26 16:13:54 -0400] rayrod2030: adamjk-dev: yeah it's looking like hacking up test kitchen and chef-zero.
[2013-08-26 16:14:03 -0400] cpuguy83: Found choclatey this morning (a pseudo windows package manager) and was considering using it, but the built-in chef windows_package seems pretty good
[2013-08-26 16:14:19 -0400] adamjk-dev: rayrod2030: I haven't tried chef-zero yet, but yeah I have done some stuff in TK and minitest
[2013-08-26 16:15:07 -0400] adamjk-dev: rayrod2030: I basically wanted to test a jenkins-server and slave, so I had to define two platforms with run lists and tell test-kitchen to "-destroy=never" and they were ordered that the server was built first, then the slave
[2013-08-26 16:15:25 -0400] runemadsen: I'm having an issue with the runit cookbook: Every time I deploy, my runit_service start next a simultaneous service instead of killing the old. This might be stupid, but there's no docs on whether I can reuse runit_service in my deploy script, or I can only call it once on setup
[2013-08-26 16:15:31 -0400] rayrod2030: oh that's interesting.  hadn't thought of that.
[2013-08-26 16:15:37 -0400] adamjk-dev: rayrod2030: http://community.opscode.com/chat/chef/2013-08-07
[2013-08-26 16:15:51 -0400] adamjk-dev: rayrod2030: you can see discussion of "short order cook" (and my name again ahah)
[2013-08-26 16:16:19 -0400] rayrod2030: adamjk-dev: I need something like chef-zero and chef-client though because we are doing orchestration (barrier) via databags.
[2013-08-26 16:16:22 -0400] adamjk-dev: rayrod2030: yeah, I think they need to integrate multi-node ideas (basically a mirror of the syntactic capabilities of Vagrant) into TK
[2013-08-26 16:17:01 -0400] aruntomar: can anyone help with a query with chefspec? i've a cookbook abc , and i want to use commit git cookbook in it and so i want to test that git cookbook is included in it. it fails to run. it either find abc or either git,but not both. i'm using berkshelf.
[2013-08-26 16:17:02 -0400] adamjk-dev: rayrod2030: right right, I can understand that. I just haven't had time to get to TK and chef-client ideas yet.... due to the problem in minitest-handler for not locating tests on a chef-client run
[2013-08-26 16:17:11 -0400] rayrod2030: adamjk-dev: looking at flock of chefs for that as well or etcd.  Basically we just need to do leader election for running an admin process among many nodes.
[2013-08-26 16:18:15 -0400] adamjk-dev: rayrod2030: interesting, yeah I am not knowledgeable on that stuff really. We use Rundeck for orchestration. I have heard mention of flock of chefs
[2013-08-26 16:18:47 -0400] runemadsen: I guess my question is: Shouldn't I be able to put runit_service in my deploy recipe and not see duplicated processes when I deploy? Any clues?
[2013-08-26 16:24:55 -0400] jkeiser: runemadsen: I imagine if you installed the service once, then renamed the service in the recipe, and ran it again, that there would be two services (under the old name and the new name)
[2013-08-26 16:25:42 -0400] runemadsen: Thanks jkeiser. Yeah, it's weird. My deploy recipe is basically: runit_service "myservice", and it's starting a new process on every deploy
[2013-08-26 16:26:51 -0400] jkeiser: That is weird.  I wonder if you're starting the process in the background so runit doesn't realize it's still running?  (Not 100% clear on how runit works, so just throwing that out there)
[2013-08-26 16:27:35 -0400] runemadsen: Thanks, I'll check. I'm pretty sure it's running foreground. Just wanted to double check my sanity.
[2013-08-26 16:27:36 -0400] runemadsen: Thanks
[2013-08-26 17:14:30 -0400] bdemers: does chefspec assume ../ for the cookbook path
[2013-08-26 17:14:31 -0400] bdemers: ?
[2013-08-26 17:16:09 -0400] bdemers: if so, is there anyway to tell it not to? doing so loads a whole bunch of unrelated projects
[2013-08-26 17:19:01 -0400] adamjk-dev: bdemers: https://github.com/acrmp/chefspec#varying-the-cookbook-path
[2013-08-26 17:20:08 -0400] bdemers: right, i'm following: https://github.com/acrmp/chefspec/wiki/Berkshelf-and-ChefSpec
[2013-08-26 17:20:29 -0400] adamjk-dev: bdemers: ah right, yeah I started doing that not long ago
[2013-08-26 17:20:36 -0400] bdemers: but chefspec still seems to add '..'
[2013-08-26 17:20:47 -0400] adamjk-dev: bdemers: I think I was having issues the other day where stuff was being included from my base cookbook path (from knife?)
[2013-08-26 17:21:17 -0400] adamjk-dev: bdemers: that may be true, I had a bunch of warnings and stuff added to my output the other day and just didn't have time to look at it (since I thought it was just a pathing problem)
[2013-08-26 17:22:45 -0400] bdemers: this seems to be a bug to me, a hold over from the uber chef repo days ?
[2013-08-26 17:23:24 -0400] adamjk-dev: bdemers: it seems so
[2013-08-26 17:23:51 -0400] adamjk-dev: bdemers: I wasn't happy when I saw it, and yeah, it was happening when in the old style directory structure (we are in the process of migrating to one repo per cookbook)
[2013-08-26 17:24:09 -0400] bdemers: if i set cookbooks_path to my berkshelf dir, then that works, just seems like a really bad default ( that will break often)
[2013-08-26 17:24:30 -0400] adamjk-dev: bdemers: you mean in your spec file you set the cookbook path?
[2013-08-26 17:24:54 -0400] bdemers: my spec_helper looks just like this: https://github.com/acrmp/chefspec/wiki/Berkshelf-and-ChefSpec#spec_helperrb
[2013-08-26 17:24:56 -0400] bdemers: adamjk-dev: ^
[2013-08-26 17:24:57 -0400] adamjk-dev: bdemers: perhaps open an issue?
[2013-08-26 17:25:12 -0400] adamjk-dev: bdemers: oh gotcha
[2013-08-26 17:25:18 -0400] bdemers: can do, just want to confirm i'm not a noob
[2013-08-26 17:25:30 -0400] adamjk-dev: bdemers: I don't think so, it sounds familiar to me... just didn't chase it down
[2013-08-26 17:25:47 -0400] adamjk-dev: bdemers: and I also put a check for a Berksfile in my spec_helper (in case a cookbook didn't have a Berksfile)
[2013-08-26 17:26:01 -0400] Liquid--: Hello, looking at getting into acceptance testing in Chef. What would you guys recommend to look into? Any resources on learning more?
[2013-08-26 17:26:11 -0400] bdemers: adamjk-dev:  good idea
[2013-08-26 17:26:29 -0400] adamjk-dev: bdemers: let me try some stuff for a second before you open an issue
[2013-08-26 17:26:42 -0400] adamjk-dev: bdemers: I have a few cookbooks that have the spec_helper set that way and some that do not
[2013-08-26 17:26:55 -0400] bdemers: ok
[2013-08-26 17:27:12 -0400] adamjk-dev: bdemers: rspec -c --format documentation
[2013-08-26 17:27:12 -0400] adamjk-dev: [2013-08-26T13:26:38-04:00] WARN: found a directory data_bags in the cookbook path, but it contains no cookbook files. skipping
[2013-08-26 17:27:29 -0400] adamjk-dev: I got that and one other warning
[2013-08-26 17:27:39 -0400] adamjk-dev: but that directory had the spec_helper as you pointed out
[2013-08-26 17:27:43 -0400] adamjk-dev: let me try the other
[2013-08-26 17:27:46 -0400] gchristensen: my boss is a snowblower, turning my infrastructure into beautiful snow-flake covered mountains.
[2013-08-26 17:31:27 -0400] adamjk-dev: bdemers: dah, I am not sure now... it looks like I changed most stuff
[2013-08-26 18:05:38 -0400] coredump: So, following the migrate to chef11 guide, I am having checksum errors when uploading the cookbooks, anyone got those and know how to fix?
[2013-08-26 18:25:12 -0400] Liquid--: Is there a standard tool used for acceptance tests in Chef?
[2013-08-26 18:29:40 -0400] afirth: http://lists.opscode.com/sympa/arc/chef/2013-06/msg00294.html
[2013-08-26 18:29:50 -0400] afirth: @Liquid--
[2013-08-26 18:30:35 -0400] runemadsen: Has anyone ever had problems with a runit_service also being started by init.d? That's at least what I think is happening for me
[2013-08-26 18:34:57 -0400] Liquid--: Thanks afirth: Is that the standard? Like, most people use this?
[2013-08-26 18:35:55 -0400] cburroughs: I always google for this and then can't find anything and feel dumb.  Is there an example somewhere of the json for overridding attributes for a specific node?
[2013-08-26 18:36:12 -0400] afirth: Liquid--:  no idea, sorry
[2013-08-26 18:36:35 -0400] Liquid--: afirth: Thank you! :)
[2013-08-26 18:36:36 -0400] miah: chef doesn't really care about specific nodes
[2013-08-26 18:36:40 -0400] miah: and neither shouyld you
[2013-08-26 18:36:48 -0400] miah: unique snowflakes are the reason your getting into automation =)
[2013-08-26 18:37:12 -0400] miah: you could write a recipe to look at the node name and then do an attribute override
[2013-08-26 18:37:31 -0400] miah: but again, thats something everyone should avoid =)
[2013-08-26 18:37:42 -0400] afirth: cburroughs: recommend using environment or role based overrides, then adding those to the node
[2013-08-26 18:38:55 -0400] cburroughs: I know that's the Right Thing to Do, but it's just for a temporary vagrant image :-/
[2013-08-26 18:39:14 -0400] miah: then just do node.override in your recipe
[2013-08-26 18:39:19 -0400] miah: or in your environment
[2013-08-26 18:39:24 -0400] miah: easy enough to do in vagrant
[2013-08-26 18:39:57 -0400] miah: http://docs.vagrantup.com/v2/provisioning/chef_solo.html
[2013-08-26 18:40:00 -0400] miah: documented there
[2013-08-26 18:40:24 -0400] afirth: anyway, the json is the same as everywhere else AFAIK: "override_attributes": {
[2013-08-26 18:40:24 -0400] afirth:     "syslog_and_roll": {
[2013-08-26 18:40:24 -0400] afirth:       "force_rsyslog": true,
[2013-08-26 18:56:26 -0400] josephholsten: has the hangout link been posted yet?
[2013-08-26 19:02:39 -0400] josephholsten: is code review on for today?
[2013-08-26 19:04:44 -0400] josephholsten: @btm, @kallistec: ^^
[2013-08-26 19:13:14 -0400] btm: @opscode chef/ohai code review, join: https://plus.google.com/hangouts/_/30e59bc7238cb6274985b96a109e7a59cb3391ae, watch: http://youtu.be/bQwV_0Rb1zE
[2013-08-26 19:13:34 -0400] btm: josephholsten: cookbook code review should happen this friday.
[2013-08-26 19:13:55 -0400] josephholsten: I'm dying to get OHAI-499 in, actually
[2013-08-26 19:20:58 -0400] awc737: is it ok to just put my own code in a cookbook submodule?
[2013-08-26 19:22:26 -0400] awc737: I just edited cookbooks/php/recipes/default.rb
[2013-08-26 19:22:27 -0400] awc737: http://paste.laravel.com/M2i
[2013-08-26 19:22:39 -0400] awc737: is this the correct way of doing php extensions?
[2013-08-26 19:24:40 -0400] afirth: if i understand correctly, no: https://github.com/opscode-cookbooks/php/tree/master/recipes
[2013-08-26 19:25:35 -0400] awc737: afirth, the doc said that is deprecated https://github.com/opscode-cookbooks/php#deprecated-recipes
[2013-08-26 19:27:21 -0400] afirth: ah ok. so you can do the package or lwrp call in your own cookbook
[2013-08-26 19:29:40 -0400] awc737: afirth, is that recommended instead of overriding that file?
[2013-08-26 19:34:18 -0400] afirth: awc737: http://2.bp.blogspot.com/-1NQTb3vxQnA/UJ6SrYEafHI/AAAAAAAAEy4/_dZjl8rEWtM/s1600/library_app.png from http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-08-26 19:34:58 -0400] afirth: downsides of modifying the vendor cookbook: 1) not reusable 2) merge conflicts
[2013-08-26 19:35:51 -0400] awc737: thanks afirth
[2013-08-26 19:35:56 -0400] afirth: tools exist to help with 2), but usually i wouldn't fork the upstream cookbook unless i was planning to submit a pull req
[2013-08-26 19:36:01 -0400] afirth: np
[2013-08-26 19:36:29 -0400] awc737: and so I can take the php recipe out of my vagrantfile then
[2013-08-26 19:36:45 -0400] awc737: if I'm adding my acme-php, and including the recipe there
[2013-08-26 19:37:39 -0400] afirth: sure, if you do include_recipe it will be added to the run_list anyway
[2013-08-26 19:38:04 -0400] awc737: ok thanks
[2013-08-26 19:38:55 -0400] afirth: when you get desperate, there's this too: https://github.com/bryanwb/chef-rewind
[2013-08-26 19:39:22 -0400] afirth: most (all) of this written up at http://dougireton.com/blog/2013/02/16/chef-cookbook-anti-patterns/
[2013-08-26 19:39:48 -0400] awc737: thanks, man this is a lot for a developer and a lot of time spent not developing lol
[2013-08-26 19:40:12 -0400] afirth: ops will thank you :)
[2013-08-26 19:40:45 -0400] awc737: im as ops as it gets lol but really my job is to develop
[2013-08-26 19:40:55 -0400] afirth: if you need motivation http://time.to.pullthepl.ug/blog/2013/3/17/small-shop-chef-best-practices/
[2013-08-26 19:41:02 -0400] awc737: thanks
[2013-08-26 19:47:12 -0400] coredump: so, no tips on the checksum problems when uploading chef 10 cookbooks into chef 11?
[2013-08-26 19:47:27 -0400] coredump: I got some duplicated key errors on the server postgresql log
[2013-08-26 19:50:03 -0400] bodna007: hi, i'm fairly new to chef and ec2, but if i get "You have not provided a valid image (AMI) value." error when i run `knife ec2 server create`, then are at least my ec2 credentials correct?
[2013-08-26 19:50:28 -0400] bodna007: as in the access, ssh and secret keys
[2013-08-26 19:52:59 -0400] Vitor: Hi , Im starting using chef encrypted databags and I have this error on tomcat cookbook " Error decrypting data bag value: 'bad decrypt'. Most likely the provided key is incorrect". When i create/show my databag using --secret-file its works fine .. but when i try to use this on my server using chef-client it not work. Any Ideia?
[2013-08-26 19:55:26 -0400] afirth: Vitor: knife ssh "chef_environment:prod AND name:nodename*.prod" "wget[or rsync] http://location:8080/chef/encrypted_data_bag_secret; chmod 0600 encrypted_data_bag_secret; mv encrypted_data_bag_secret /etc/chef" -xroot -P<ROOT PASSWD> -aipaddress --no-host-key-verify
[2013-08-26 19:55:52 -0400] afirth: aka, is the secret on the node, and is it set to 600
[2013-08-26 19:57:47 -0400] Vitor: afirth: "wget[or rsync] http://location:8080/chef/encrypted_data_bag_secret;" ... Is it means that before run this command i need put my encrypt file on the chef-server machine?
[2013-08-26 19:59:20 -0400] afirth: no, that command with your parameters filled in will execute a search (http://docs.opscode.com/knife_search.html), ssh to the nodes that match, tell them to fetch the key from wherever you put it (choose rsync, wget, whatever), set permissions to 600
[2013-08-26 19:59:40 -0400] afirth: but more simply, copy the key to the node and chmod 0600 on it
[2013-08-26 20:00:11 -0400] Vitor: ok, I will try it
[2013-08-26 20:00:15 -0400] Vitor: tnx
[2013-08-26 20:05:35 -0400] HAPPYFUNBALL: hola. is there a good way to use bash code in a recipe to determine whether if another recipe is included?
[2013-08-26 20:05:50 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/ad4d3c39a542c4c2f2dbd06a3da832cb67a72349, watch: http://youtu.be/_aDrxmjH080
[2013-08-26 20:06:43 -0400] gchristensen: btm: did I miss the OHAI review?
[2013-08-26 20:08:41 -0400] abrkn: im struggling with "knife ec2 create". with every new instance, i receive the error that the run list ["roles"] fails because "roles" is not a cookbook on the server. this is correct, i am using no such cookbook. my runlist does not mention "roles", nor does my role's runlist. i have tried to create new roles and still receive the same error. if i exlcude the -r (runlist) arg of "knife ec2 server
[2013-08-26 20:08:41 -0400] abrkn: create", then i am able to run chef-client from the instance afterwards. ive found some mentions of the same issue online, but none with a solution. any help? ive been stuck for some time.
[2013-08-26 20:09:01 -0400] abrkn: there is no helpful information in the chef stacktrace logfile
[2013-08-26 20:09:32 -0400] abrkn: also, the role's runlist is correctly shown on opscode
[2013-08-26 20:10:08 -0400] josephholsten: gchristensen: we didn't get to ohai today. it's first up on wed
[2013-08-26 20:10:15 -0400] abrkn: the issue -may- have arissen after i added my first environment, but i hesitate to remove it in the case that i introduce more unknown factors
[2013-08-26 20:10:20 -0400] gchristensen: josephholsten: seems its been a few weeks since the last ohai review?
[2013-08-26 20:10:41 -0400] josephholsten: but I'm dying for ohai-499 to get in
[2013-08-26 20:10:53 -0400] josephholsten: which looks to be your good work
[2013-08-26 20:11:18 -0400] gchristensen: me too, I've got some garly hacks in my ohai plugins directory to fix it...
[2013-08-26 20:11:38 -0400] HAPPYFUNBALL: Is it possible to use include_recipe within a bash resoucre?
[2013-08-26 20:12:40 -0400] josephholsten: gchristensen: the one thing that might hold it up is a lack of tests
[2013-08-26 20:13:42 -0400] gchristensen: blah, yeah
[2013-08-26 20:14:04 -0400] abrkn: anyone care to help me diagnose my issue? next step for me is pretty much to wipe the entire chef server tomorrow morning
[2013-08-26 20:14:31 -0400] HAPPYFUNBALL: abrkn DO IT!!!!
[2013-08-26 20:14:41 -0400] abrkn: HAPPYFUNBALL: i'll have no choice but to
[2013-08-26 20:15:01 -0400] HAPPYFUNBALL: well, I don't want to create a file on a server
[2013-08-26 20:15:09 -0400] HAPPYFUNBALL: but it looks like I might have to
[2013-08-26 20:15:11 -0400] gkarekinian: abrkn: Can you paste the command line you're using to pass the run list?
[2013-08-26 20:15:19 -0400] abrkn: gkarekinian: one sec
[2013-08-26 20:15:25 -0400] gchristensen: btm: could you take a look-see at http://tickets.opscode.com/browse/COOK-3224 as well? looks like it has had a fix provided (but not marked) for about a month now.
[2013-08-26 20:15:30 -0400] HAPPYFUNBALL: sounds like I've come up with the most dificult chef problem in the entire world
[2013-08-26 20:15:40 -0400] josephholsten: abrkn: can you build a node with `knife ec2 create`, then after it fails, ssh onto the machine and look at /etc/chef/first-run.json?
[2013-08-26 20:16:03 -0400] josephholsten: that should be the initial run list + node attributes
[2013-08-26 20:16:03 -0400] abrkn: josephholsten: i will. it takes some time to run so ill paste as soon as i have it
[2013-08-26 20:16:21 -0400] abrkn: im very new to knife, so my diagnostic skills are... well, according :|
[2013-08-26 20:17:13 -0400] josephholsten: if it first-run.json looks sane, then chef-client/server are nuts. if it looks off, then the ec2 plugin is generating junk to bootstrap.
[2013-08-26 20:17:44 -0400] Vitor: afirth: I put my encrypted_data_bag_secret on /etc/chef but I have the same error ... Do you know tomcat_cookbook?
[2013-08-26 20:18:17 -0400] Vitor: afirth: sorry for this noob question, i started with chef this month :D
[2013-08-26 20:18:47 -0400] Vitor: Chef::EncryptedDataBagItem::DecryptionFailure --------------------------------------------- Error decrypting data bag value: 'bad decrypt'. Most likely the provided key is incorrect
[2013-08-26 20:20:13 -0400] afirth: Vitor: sorry, nope. http://community.opscode.com/chat/chef/2013-02-21#id-296199
[2013-08-26 20:20:26 -0400] afirth: suggest you try the same as balgarath
[2013-08-26 20:20:41 -0400] abrkn: gkarekinian: knife ec2 server create -N jc-prod-pgs -f m1.small -r role[pgs] -g sg-3cce2753 -S justcoin -x ubuntu -s subnet-9bc6baf0 -y -I ami-89b1a3fd --region eu-west-1 --server-connect-attribute private_ip_address --availability-zone eu-west-1a -E production -i /P/Justcoin/Keys/AWS/jc.pem
[2013-08-26 20:21:13 -0400] dgarstang: Can someone tell me what the client.rb is used for?
[2013-08-26 20:22:22 -0400] balgarath: afirth: hah, thats a blast from the past
[2013-08-26 20:22:36 -0400] adnichols: dgarstang http://docs.opscode.com/config_rb_client.html ?
[2013-08-26 20:22:45 -0400] gkarekinian: abrkn: Got it, your shell is expanding roles[pgs] to roles, because there's a roles folder in your repo
[2013-08-26 20:22:45 -0400] abrkn: as afirth says, i have this: http://tickets.opscode.com/browse/KNIFE-1
[2013-08-26 20:23:03 -0400] gkarekinian: You need to put quotes around it, -r "role[pgs]"
[2013-08-26 20:23:10 -0400] abrkn: i do
[2013-08-26 20:23:18 -0400] balgarath: I think it turned out that I was actually using the wrong key in that instance.  I had 2 different keys in similar directories without realizing it
[2013-08-26 20:23:26 -0400] abrkn: but because it first runs in a .sh file i quote once
[2013-08-26 20:23:30 -0400] dgarstang: adnichols: sorry, I meant client.pem
[2013-08-26 20:23:41 -0400] abrkn: do i need to: -r 'roles\[pgs\]' ?
[2013-08-26 20:23:41 -0400] gkarekinian: role[pgs] is seen as a regexp by your shell
[2013-08-26 20:23:55 -0400] abrkn: i fear im having -double- escaping issues
[2013-08-26 20:24:06 -0400] abrkn: simply quoting is not helping
[2013-08-26 20:24:21 -0400] adnichols: dgarstang that's the client's key to interact w/ the chef server
[2013-08-26 20:24:38 -0400] juliancdunn: abrkn: single-quote it
[2013-08-26 20:24:43 -0400] juliancdunn: -r 'role[foo]'
[2013-08-26 20:24:47 -0400] dgarstang: adnichols: autogenerated I guess...
[2013-08-26 20:24:54 -0400] abrkn: juliancdunn: ok, running again
[2013-08-26 20:24:57 -0400] adnichols: dgarstang typically yes, as part of bootstrap
[2013-08-26 20:24:57 -0400] gkarekinian: I'm using double quotes and I don't have to escape the brackets
[2013-08-26 20:25:08 -0400] adnichols: dgarstang when you create a client & download the client key - it's that
[2013-08-26 20:25:21 -0400] dgarstang: adnichols: kk
[2013-08-26 20:25:47 -0400] abrkn: gkarekinian: to be entirely clear, i have a .sh file with the command in it
[2013-08-26 20:25:55 -0400] gchristensen: josephholsten: you could send a Pr to my branch which introduces tests :P
[2013-08-26 20:26:04 -0400] gchristensen: josephholsten: tragically I can't add tests until like the 18th of september, I'm going out of town
[2013-08-26 20:26:10 -0400] abrkn: gkarekinian: http://gyazo.com/679675231ed99d91d2aca12751381796.png
[2013-08-26 20:26:37 -0400] Vitor: afirth: Thanks my friend .. I created my encrypted file again and work! (Obrigado Amigo in portuguese)
[2013-08-26 20:26:51 -0400] afirth: glad to hear it
[2013-08-26 20:27:44 -0400] josephholsten: gchristensen: I'll try to get someone to set that up
[2013-08-26 20:28:49 -0400] gkarekinian: abrkn: I don't see how it could expand to "roles" with double or single quotes, are you sure you're modifying the script that's used and not a copy?
[2013-08-26 20:29:03 -0400] josephholsten: should be simple, just proving that it's not set on current, and is on your branch
[2013-08-26 20:29:16 -0400] gchristensen: surely
[2013-08-26 20:30:59 -0400] HAPPYFUNBALL: is there a way to insert an "include recipe" into a bash script?
[2013-08-26 20:31:09 -0400] abrkn: gkarekinian: im running again now (had to restart because of ERROR: Net::SSH::HostKeyMismatch: fingerprint 55:e9:85...33:33 does not match for "10.0.1.23" -- which happens occasionally)
[2013-08-26 20:31:15 -0400] gchristensen: HAPPYFUNBALL: no, that sounsd crazy
[2013-08-26 20:31:22 -0400] HAPPYFUNBALL: how about in a bash block?
[2013-08-26 20:31:28 -0400] HAPPYFUNBALL: I need to gate a recipe
[2013-08-26 20:31:36 -0400] HAPPYFUNBALL: and the only way to do it is with bash
[2013-08-26 20:31:43 -0400] HAPPYFUNBALL: (since I need to ssh into another host)
[2013-08-26 20:31:48 -0400] gchristensen: to gate it? you could chain the notifies and notify
[2013-08-26 20:31:51 -0400] abrkn: HAPPYFUNBALL: try to explain what youre trying to do instead of what youre doing
[2013-08-26 20:31:57 -0400] gkarekinian: You need to clean up your ~/.ssh/known_hosts, it's giving you the same IP once in the while
[2013-08-26 20:32:04 -0400] afirth: abrkn: Host 192.168.0.100
[2013-08-26 20:32:04 -0400] afirth:         UserKnownHostsFile /dev/null
[2013-08-26 20:32:04 -0400] afirth:         StrictHostKeyChecking no
[2013-08-26 20:32:08 -0400] abrkn: gkarekinian: ok, thanks
[2013-08-26 20:32:19 -0400] gkarekinian: You're welcome
[2013-08-26 20:32:22 -0400] afirth: in ~/.ssh/config
[2013-08-26 20:32:31 -0400] abrkn: i wish i was in this timezone, where were you guys at lunch time CET?
[2013-08-26 20:32:35 -0400] gkarekinian: It happens a lot even on EC2 when you're not lucky at the IP lottery
[2013-08-26 20:34:02 -0400] abrkn: but if i understand correctly. role[test] may resolve to roles if i have a roles directory. if i run that command from my shell, then my shell translates it
[2013-08-26 20:34:17 -0400] abrkn: however, if i send that command through my shell to a host, then it will be translated again?
[2013-08-26 20:34:26 -0400] abrkn: so ill need double escaping?
[2013-08-26 20:34:47 -0400] HAPPYFUNBALL: I need to run several recipes for a cluster of servers in a specific sequence. I am using a driver recipe to sequence these recipes. The sequence installs on specific recipe already having been run on several nodes in order to progress. I had planned on SSHing into the nodes which the recipe A should have run on in order to determine whether if recipe B should run. How else could this be done?
[2013-08-26 20:35:34 -0400] gkarekinian: It's just going to be a string if you put it inside quotes
[2013-08-26 20:35:48 -0400] gkarekinian: It won't get expanded
[2013-08-26 20:36:00 -0400] abrkn: it wont be expanded by my local shell
[2013-08-26 20:38:12 -0400] HAPPYFUNBALL: is it possible to set an attribute in a node block?
[2013-08-26 20:38:28 -0400] abrkn: HAPPYFUNBALL: node['hello'] = 'world'?
[2013-08-26 20:38:40 -0400] HAPPYFUNBALL: in a chef resource
[2013-08-26 20:38:46 -0400] HAPPYFUNBALL: abrkn / gchristensen I need to run several recipes for a cluster of servers in a specific sequence. I am using a driver recipe to sequence these recipes. The sequence installs on specific recipe already having been run on several nodes in order to progress. I had planned on SSHing into the nodes which the recipe A should have run on in order to determine whether if recipe B should run. How else could this be done?
[2013-08-26 20:38:54 -0400] HAPPYFUNBALL: rather, in a bash resource
[2013-08-26 20:39:33 -0400] abrkn: thats way beyond me, sorry
[2013-08-26 20:39:33 -0400] gchristensen: HAPPYFUNBALL: you could check if that node hase an attribute saying XYZ recipe was run
[2013-08-26 20:40:26 -0400] HAPPYFUNBALL: that would necessitate that I create a persistent attribute
[2013-08-26 20:40:33 -0400] gchristensen: is true
[2013-08-26 20:40:51 -0400] HAPPYFUNBALL: that won't work
[2013-08-26 20:40:52 -0400] gchristensen: but that's pretty easy... node.set['myrecipe']['didrun'] = true
[2013-08-26 20:40:54 -0400] gchristensen: why?
[2013-08-26 20:40:56 -0400] akahn: It seems like it's not allowed to use `lazy` in `only_if`. Is that true?
[2013-08-26 20:41:20 -0400] HAPPYFUNBALL: my project definition does not allow me to set persistent attributes
[2013-08-26 20:41:34 -0400] akahn: I'm getting this ArgumentError http://pastie.org/8272066
[2013-08-26 20:43:09 -0400] gchristensen: HAPPYFUNBALL: sounds like you've got a tricky lil' project definition then.
[2013-08-26 20:43:26 -0400] HAPPYFUNBALL: ok
[2013-08-26 20:43:30 -0400] HAPPYFUNBALL: I know what I will do
[2013-08-26 20:43:36 -0400] HAPPYFUNBALL: touch a file
[2013-08-26 20:44:43 -0400] gchristensen: this sounds scary
[2013-08-26 20:45:21 -0400] abrkn: gkarekinian: hmm, im still getting the same error with single quotes
[2013-08-26 20:45:42 -0400] abrkn: gkarekinian: http://gyazo.com/6fbddfa4cccff0166d99831d7667eef4.png
[2013-08-26 20:45:57 -0400] abrkn: gkarekinian: http://gyazo.com/8a99639c7b0b4f51c06d1512d81bf132.png
[2013-08-26 20:47:32 -0400] gkarekinian: Sorry, I don't have a Windows machine to try to help you more
[2013-08-26 20:48:05 -0400] abrkn: gkarekinian: ill try from a ubuntu install tomorrow to see if ive become an edge case
[2013-08-26 20:48:29 -0400] abrkn: gkarekinian: i just dont see why its happening -now-, ive deployed several roles successfully before this
[2013-08-26 20:48:37 -0400] gkarekinian: Weird
[2013-08-26 20:48:52 -0400] abrkn: heck, i even have two roles that i can deploy just fine
[2013-08-26 20:49:13 -0400] abrkn: even if i copy paste the roles and books i end up in this same situation
[2013-08-26 20:49:27 -0400] abrkn: roles and books look fine on opscode.com
[2013-08-26 20:50:29 -0400] abrkn: im considering just not bootstrapping and immmediately running chef client on the instance (which somehow works)
[2013-08-26 20:53:26 -0400] abrkn: gkarekinian: do not that i run cygwin, so all gnu tools should be more very compat (and tested)
[2013-08-26 20:55:31 -0400] abrkn: note*
[2013-08-26 20:59:35 -0400] dgarstang: if I stick some attributes in a role file, how do I access in a cookbook? it's not node[] is it?
[2013-08-26 20:59:53 -0400] jmickle: anyone have a working version of metachef?
[2013-08-26 20:59:59 -0400] jmickle: 3.0.4 has syntax errors :(
[2013-08-26 21:00:07 -0400] adnichols: dgarstang yes
[2013-08-26 21:00:26 -0400] dgarstang: adnichols: Hm.
[2013-08-26 21:01:33 -0400] dgarstang: adnichols: so... err, node['default_attributes']['foo']['bar'] ?
[2013-08-26 21:01:49 -0400] adnichols: node["foo"]["bar"]
[2013-08-26 21:02:03 -0400] dgarstang: adnichols: k
[2013-08-26 21:08:19 -0400] HAPPYFUNBALL: how do I use an include_recipe inside of a ruby block?
[2013-08-26 21:10:25 -0400] btm: HAPPYFUNBALL: Basically, you don't. If you're looking to include a recipe under certain circumstances you just want to put the ruby in the recipe, not in a ruby block. the ruby in the recipe is evaluated during compilation, whereas the ruby in a ruby_block isn't evaluated until convergence, well after the run_list has been created.
[2013-08-26 21:11:55 -0400] HAPPYFUNBALL: btm I need to run some bash code inside a recipe. afaik, the only way to run bash in a chef recipe is to use a bash resource
[2013-08-26 21:12:05 -0400] abrkn: gkarekinian: ok, as instructed i looked at first boot. it says run list "roles", with my single quotes. how else may i escape?
[2013-08-26 21:12:06 -0400] HAPPYFUNBALL: is this not the case?
[2013-08-26 21:13:33 -0400] HAPPYFUNBALL: btm ?
[2013-08-26 21:14:36 -0400] btm: HAPPYFUNBALL: a bash resource is the correct place to put bash code you want to run in a recipe.
[2013-08-26 21:19:37 -0400] HAPPYFUNBALL: btm ok, well, this bash code determines whether if a recipe should be included or not. how am I supposed to determine this otherwise?
[2013-08-26 21:22:02 -0400] gchristensen: HAPPYFUNBALL: it really sounds like something you're doing is backwards or crazy.
[2013-08-26 21:22:19 -0400] abrkn: sigh. knife ec2 server create -r 'role[myrole]' causes {"run_list":["roles"]} in first-boot.json. how can i escape this escaping nightmare?
[2013-08-26 21:22:20 -0400] HAPPYFUNBALL: gchristensen that's what they all say
[2013-08-26 21:22:31 -0400] HAPPYFUNBALL: I'm doing the impossible
[2013-08-26 21:22:43 -0400] gchristensen: HAPPYFUNBALL: I don't think you can say that until you do it
[2013-08-26 21:22:48 -0400] HAPPYFUNBALL: how else are you supposed to gate recipes
[2013-08-26 21:22:55 -0400] HAPPYFUNBALL: I just figured it out
[2013-08-26 21:23:00 -0400] HAPPYFUNBALL: you can run bash code in ruby
[2013-08-26 21:23:12 -0400] spox: ruby_block + shellout + node object to include the recipes. making the impossible possible in the most horrific ways possible
[2013-08-26 21:23:13 -0400] gchristensen: you can do anything you want, in fact
[2013-08-26 21:23:24 -0400] spox: ruby_block 'print me moneys'
[2013-08-26 21:23:24 -0400] gchristensen: I would just really hate to ever have to maintain what you're doing now
[2013-08-26 21:23:50 -0400] HAPPYFUNBALL: it's ok. I am writing amazing code
[2013-08-26 21:23:57 -0400] HAPPYFUNBALL: and I'm testing in production
[2013-08-26 21:24:05 -0400] abrkn: staging is for hollywood
[2013-08-26 21:24:11 -0400] HAPPYFUNBALL: I'm the most interesting HAPPYFUNBALL in the world
[2013-08-26 21:24:14 -0400] HAPPYFUNBALL: good night
[2013-08-26 21:25:29 -0400] abrkn: back to my escaping nightmare, if anyone minds looking
[2013-08-26 21:25:46 -0400] gchristensen: ^ that sounds horribly painful
[2013-08-26 21:26:04 -0400] abrkn: hah
[2013-08-26 21:26:12 -0400] abrkn: anyway, ive tried all the tricks you gave me
[2013-08-26 21:26:25 -0400] abrkn: still first boot claims im asking for a run list of ["roles"]
[2013-08-26 21:26:40 -0400] abrkn: absolutely stuck
[2013-08-26 21:26:59 -0400] abrkn: erlingwl: hoy
[2013-08-26 21:27:14 -0400] abrkn: knife ec2 server create -r 'role[myrole]' causes {"run_list":["roles"]} in first-boot.json. how can i escape this escaping nightmare?
[2013-08-26 21:27:19 -0400] erlingwl: abrkn: hey
[2013-08-26 21:35:26 -0400] abrkn: ideas?
[2013-08-26 21:42:50 -0400] idlemich1el: I'm using the java cookbook and I've noticed something interesting. If I do "node.override[:java][:jdk_version] = '7'" in a recipe, it will not install java 7. if i set this attribute as a 'default_attribute' in a role, it DOES work. I added some logging information, and noticed that the version does get set appropriately, but something in the attributes/default.rb of the java cookbook is being set in the attributes its
[2013-08-26 21:43:07 -0400] idlemich1el: and using the default['java']['jdk_version'] as part of it
[2013-08-26 21:43:41 -0400] idlemich1el: and it appears that this variable, default['java']['openjdk_packages'] doesn't respect the version i'm setting in my new recipe
[2013-08-26 21:44:15 -0400] idlemich1el: https://github.com/opscode-cookbooks/java/blob/master/attributes/default.rb#L46
[2013-08-26 21:44:23 -0400] idlemich1el: line 46 is what i'm talking about
[2013-08-26 21:48:52 -0400] jmickle: idlemich1el: it is going to be related to attribute loader
[2013-08-26 21:50:00 -0400] idlemich1el: jmickle: what's the attribute loader
[2013-08-26 21:50:35 -0400] jmickle: idlemich1el: sorry was finding the url http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-08-26 21:50:48 -0400] jmickle: idlemich1el: the way it loads in what precedence it might not be overriding in the way you expect it to be
[2013-08-26 21:51:05 -0400] jmickle: idlemich1el: on that page is a precedence list of how attributes get set/override
[2013-08-26 21:51:24 -0400] spox: re-defaulting composite attributes ftw
[2013-08-26 21:52:17 -0400] idlemich1el: so if i want to do this on the recipe level, wouldn't i just have to override the jdk_version BEFORE 'include_recipe 'java'' ?
[2013-08-26 21:53:47 -0400] jmickle: idlemich1el: i think that would work
[2013-08-26 21:54:00 -0400] idlemich1el: jmickle: it doesn't
[2013-08-26 21:54:01 -0400] jmickle: idlemich1el: i personally try to keep overrides like that out of recipes and in roles/environments
[2013-08-26 21:54:29 -0400] jmickle: idlemich1el: because I've experienced the funky works 50% of the time type of thing with that
[2013-08-26 21:57:21 -0400] idlemich1el: there's no way this is working as intended
[2013-08-26 21:57:23 -0400] idlemich1el: jmickle
[2013-08-26 22:01:45 -0400] idlemich1el: jmickle: https://gist.github.com/mylons/6347214
[2013-08-26 22:02:47 -0400] jdguzman: hello all
[2013-08-26 22:03:29 -0400] jdguzman: I have a question  how do you guys handle a scenario where you want chef to deploy nodes behind a load balancer but make sure they are done in an orderly fashion?
[2013-08-26 22:08:47 -0400] jbz: jdguzman: You mean for example a clean roll through? one at a time?
[2013-08-26 22:09:06 -0400] jdguzman: yes so as to ensure that there is no down time
[2013-08-26 22:09:15 -0400] jbz: heh.  orchestration. ugh.
[2013-08-26 22:09:38 -0400] jbz: If I wasn't going to use a separate thing for orchestration (pushy or whatever)
[2013-08-26 22:10:04 -0400] jbz: I'd probably try to either have them use node attributes as flags ("I'm done", etc.)
[2013-08-26 22:10:28 -0400] jbz: or use synchronous chef-client runs, triggered remotely.
[2013-08-26 22:10:37 -0400] jbz: But I haven't done this in a manner I"m happy with.
[2013-08-26 22:10:46 -0400] jdguzman: ok so we are on the same page
[2013-08-26 22:11:02 -0400] jbz: My first instinct would be to just make sure the maintenance page on the LB worked :-P
[2013-08-26 22:11:07 -0400] jdguzman: just wanted to make sure I wasn't missing something but that sounds like what we are already discussing as possible solutions
[2013-08-26 22:11:10 -0400] jbz: yeah
[2013-08-26 22:11:17 -0400] jbz: keep checking, though, I"m not a great source.
[2013-08-26 22:12:28 -0400] jbz: jdguzman: Really awful hack?  Have one node designate itself as the 'last man standing' and have it refuse to upgrade until it gets an indication that at least one other node is properly responding with the new deployment.
[2013-08-26 22:13:39 -0400] jdguzman: funny but we had just discussed that
[2013-08-26 22:14:09 -0400] jdguzman: but it sounds far too hacky
[2013-08-26 22:14:10 -0400] dgarstang: I'm trying to bootstrap a new ec2 host. I'm passing --ssh-user bcadmin -w bcadmin@proxy and i'm getting 'ERROR: Net::SSH::Disconnect: connection closed by remote host'. However, I can ssh into the proxy as bcadmin and then into the host as bcadmin too.
[2013-08-26 22:14:31 -0400] jdguzman: thanks for the help jbz  we'll continue to brainstorm
[2013-08-26 22:14:45 -0400] jbz: jdguzman: Good luck.  Blog your solution!
[2013-08-26 22:15:22 -0400] nicb_: dgarstang: Is everything squared away with your SSH keys?
[2013-08-26 22:16:00 -0400] dgarstang: nicb_: must be, cuz it works manually
[2013-08-26 22:16:22 -0400] nicb_: can you tail the ssh log on the remote host?
[2013-08-26 22:17:18 -0400] dgarstang: nicb_: bit hard... it's a bootstrap. I'll have to be quick.
[2013-08-26 22:17:36 -0400] nicb_: so it's not building the instance?
[2013-08-26 22:18:02 -0400] dgarstang: nicb_: Yes. it's failing on login. I'l=l have to run the tail _after_ the build but _before_ the failed login
[2013-08-26 22:19:10 -0400] nicb_: dgarstang: I had similar problems, and the solution I used was to allow chef to bootstrap as the root user with the pw that the API (in my case, rackspace) returned
[2013-08-26 22:21:54 -0400] abrkn: im sorry to repeat, but...
[2013-08-26 22:21:57 -0400] dgarstang: nicb_: who knows. this stuff aint documented. I don't know if it's using agent forwarding, if it's using the internal IP, the external IP or what
[2013-08-26 22:21:58 -0400] abrkn: knife ec2 server create -r 'role[myrole]' causes {"run_list":["roles"]} in first-boot.json. how can i escape this escaping nightmare?
[2013-08-26 22:22:01 -0400] nicb_: dgarstang: did you try manually pointing to the ssh key with -i <path>
[2013-08-26 22:22:11 -0400] dgarstang: nicb_: as i said, works manually.
[2013-08-26 22:26:16 -0400] dgarstang: nicb_: dammit it's using the internal IP
[2013-08-26 22:26:26 -0400] nicb_: doh
[2013-08-26 22:26:35 -0400] nicb_: now it works?
[2013-08-26 22:26:47 -0400] dgarstang: nicb_: No
[2013-08-26 22:27:48 -0400] dgarstang: Ok, so is there a way to make knife ec2 server create use the external amazon IP instead of the internal one?
[2013-08-26 22:28:04 -0400] nicb_: yeah, let me look it up
[2013-08-26 22:28:35 -0400] dgarstang: I'm sure the private IP makes sense when your in a simplistic setup with one region and all.
[2013-08-26 22:28:38 -0400] dgarstang: thanks nic
[2013-08-26 22:29:12 -0400] dgarstang: and I don't think there is a way to do that nicb_
[2013-08-26 22:30:04 -0400] nicb_: what is it trying to use the internal interface for, to connect to your chef server?
[2013-08-26 22:30:18 -0400] dgarstang: nicb_: to ssh into the server once it's up
[2013-08-26 22:31:35 -0400] nicb_: dgarstang: does the -s work? ' -s "http://x.x.x.x:4000" '
[2013-08-26 22:32:03 -0400] dgarstang: nicb_: -s is the subnet... '-s, --subnet SUBNET-ID' for VPC
[2013-08-26 22:32:36 -0400] dgarstang: nicb_: and it looks like your talking about the chef server... which isn't the issue
[2013-08-26 22:33:36 -0400] nicb_: dgarstang: hmm, that must be for knife [type] server create -s
[2013-08-26 22:34:08 -0400] dgarstang: nicb_: dunno, but 'knife ec2 server create -h' for s shows me VPC subnet option
[2013-08-26 22:34:57 -0400] nicb_: dgarstang: that's weird, for the rackspace plugin it says this: -s, --server-url URL             Chef Server URL
[2013-08-26 22:35:02 -0400] nicb_: try --server-url URL
[2013-08-26 22:36:17 -0400] dgarstang: nicb_: i'm sure the options are all different
[2013-08-26 22:36:31 -0400] nicb_: right, there's not a documented switch for server-url for ec2
[2013-08-26 22:39:43 -0400] dysinger: I'm wondering if there's a hack that makes it so I can have locally discoverable data via an ohai plugin but have it so that data is NOT published up to chef server  ?
[2013-08-26 22:40:10 -0400] dysinger: Is there a way to have a node-local 'private' ohai automatic attributes coming from a plugin ?
[2013-08-26 22:42:34 -0400] nicb_: dgarstang: it looks like chef defaults to use the public network for bootstrapping
[2013-08-26 22:42:39 -0400] nicb_:       option :private_network,         :long => "--private-network",         :description => "Use the private IP for bootstrapping rather than the public IP",         :boolean => true,         :default => false
[2013-08-26 22:43:33 -0400] dgarstang: nicb_: is that a command line option? my help output doesn't mention it
[2013-08-26 22:43:47 -0400] dgarstang: nicb_: and you mean private, not public
[2013-08-26 22:43:49 -0400] nicb_: dgarstang: yeah, have a look here: https://github.com/opscode/knife-rackspace/blob/master/lib/chef/knife/rackspace_server_create.rb
[2013-08-26 22:44:23 -0400] nicb_: well, the ruby code for :private_network in the option hash has default: false, so it defaults to public, but something may be overriding that
[2013-08-26 22:44:31 -0400] nicb_: crap, that's the rackspace one, not ec2
[2013-08-26 22:44:37 -0400] dgarstang: nicb_: as I said, -h doesn't even mention it
[2013-08-26 22:44:45 -0400] dgarstang: *sigh*
[2013-08-26 22:45:01 -0400] nicb_: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb
[2013-08-26 22:45:44 -0400] dgarstang: nicb_: no use private network option there... :(
[2013-08-26 22:46:25 -0400] ponyofdeath: hi, is it possible to make a for loop inside of an template with two arrays's? ie <% @cache_frontend.times do |frontend| %> and also backends
[2013-08-26 22:47:02 -0400] dgarstang: So it looks like after all this effort with knife I'm screwed. I can't spin up hosts in a different region.
[2013-08-26 22:48:07 -0400] nicb_: dgarstang: sorry :/ I got nothin', but I use RS, not EC2.
[2013-08-26 22:48:08 -0400] nicb_: good luck
[2013-08-26 22:48:14 -0400] dgarstang: :(
[2013-08-26 22:48:29 -0400] pontiki: yeah, EC2 sucks that way
[2013-08-26 22:48:54 -0400] dgarstang: pontiki: it's not ec2's fault. if the plugin had an option to connect to the public instead...
[2013-08-26 23:07:14 -0400] dysinger: anyone know of an ohai zk setup in the wild ?
[2013-08-26 23:07:19 -0400] dysinger: (zookeeper)
[2013-08-26 23:18:18 -0400] dgarstang: Anyone know of a hack way to get knife ec2 to use the public rather than the private ip when ssh-ing in?
[2013-08-26 23:24:35 -0400] siezer: dgarstang knife ssh "*:*" -a cloud.public_ipv4
[2013-08-26 23:26:54 -0400] j3pl: anyone using the "deploy" resource?
[2013-08-26 23:31:16 -0400] vipul_: hi
[2013-08-26 23:31:28 -0400] vipul_: hi TopChef !!!
[2013-08-26 23:31:31 -0400] douglaswth: howdy!
[2013-08-26 23:31:39 -0400] sn0wb1rd: hello
[2013-08-26 23:31:39 -0400] vipul_: i am getting this erro /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/mixlib-log-1.3.0/lib/mixlib/log.rb:97:in `level=': Log level must be one of :debug, :info, :warn, :error
[2013-08-26 23:31:54 -0400] vipul_: when i try to bootstrap the node
[2013-08-26 23:32:08 -0400] douglaswth: what's your log level set to?
[2013-08-26 23:32:47 -0400] vipul_: more ../.chef/knife.rb  log_level                :info
[2013-08-26 23:35:34 -0400] dgarstang: siezer: this is bootstrap
[2013-08-26 23:37:02 -0400] vipul_: douglaswth : any idea ?
[2013-08-26 23:37:25 -0400] douglaswth: what's the rest of the stack trace?
[2013-08-26 23:37:46 -0400] siezer: oh. it should be using the public dnsdomainname by default iirc
[2013-08-26 23:39:35 -0400] dgarstang: siezer: Actually, rather confused now. it uses the public?
[2013-08-26 23:43:17 -0400] ponyofdeath: anyone know if each_pair is supported or not in chef template? Chef::Mixin::Template::TemplateError: undefined method `each_pair'
[2013-08-26 23:48:40 -0400] dgarstang: NEXT! So... is there a way to make knife ec2 server create PAUSE after bringing up a host but BEFORE trying to ssh in? There's some cloud-init stuff that needs to happen first.
[2013-08-26 23:55:55 -0400] dgarstang: NEXT! So... is there a way to make knife ec2 server create PAUSE after bringing up a host but BEFORE trying to ssh in? There's some cloud-init stuff that needs to happen first.
