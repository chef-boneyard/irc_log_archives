[2013-08-06 00:00:15 -0400] Sauraus: What is the correct method for copying a file to a host?
[2013-08-06 00:00:17 -0400] coderanger: Yay for stupidly slow cell tethers
[2013-08-06 00:01:23 -0400] aslan: Sauraus: http://docs.opscode.com/resource_cookbook_file.html
[2013-08-06 00:02:36 -0400] coderanger: aslan: Hmm, so it is finding '' as the remote version, any chance something is interfering with talking to rubygems.org?
[2013-08-06 00:03:27 -0400] aslan: coderanger: i am running the same recipe on older machine ruby 1.9 and chef 10 and its running fine
[2013-08-06 00:05:16 -0400] coderanger: aslan: Hmm, does it work if you give it an explicit version?
[2013-08-06 00:05:31 -0400] aslan: let me try
[2013-08-06 00:10:51 -0400] aslan: coderanger: looks like that fixed it. so version is a requirement now??
[2013-08-06 00:10:56 -0400] coderanger: No
[2013-08-06 00:11:06 -0400] coderanger: It should be finding the latest one by default
[2013-08-06 00:11:14 -0400] coderanger: but something is interrupting that and returning ''
[2013-08-06 00:11:23 -0400] coderanger: Can't look into it much more from here
[2013-08-06 00:11:32 -0400] aslan: interesting
[2013-08-06 00:11:46 -0400] aslan: it could be a ruby 2 thing
[2013-08-06 00:11:51 -0400] aslan: i hope not though
[2013-08-06 00:25:55 -0400] MrBIOS: hm, with a freshly-installed chef-11 (omnibus) server, when listing the nodes or clients, I get "Could not list clients: 403 "Forbidden""
[2013-08-06 00:26:07 -0400] MrBIOS: any suggestions as to what I've managed to do incorrectly? :)
[2013-08-06 00:33:19 -0400] aslan: MrBIOS: is your knife setup properly?
[2013-08-06 00:33:27 -0400] aslan: MrBIOS: can you do knife status ?
[2013-08-06 00:33:36 -0400] MrBIOS: yes
[2013-08-06 00:33:38 -0400] MrBIOS: I most certainly can
[2013-08-06 00:34:35 -0400] aslan: MrBIOS: have you looked into chef-server logs?
[2013-08-06 00:34:51 -0400] MrBIOS: not yet, and I'm about to go through some tunnels, but I'll do that on the flipside :)
[2013-08-06 00:35:16 -0400] MrBIOS: sorry, I forgot to mention this was from the Chef WebUI
[2013-08-06 00:35:18 -0400] MrBIOS: not via knife
[2013-08-06 00:35:53 -0400] aslan: MrBIOS: is knife responding?
[2013-08-06 00:35:57 -0400] MrBIOS: yes
[2013-08-06 00:37:49 -0400] aslan: MrBIOS: i never use the webui :P
[2013-08-06 00:39:18 -0400] aslan: coderanger: this might be interesting for you. the reason gem_package was failing was that i was using https://rubygems.org instead of http://rubygems.org in my gemrc. as soon as i switched to http everything works fine
[2013-08-06 00:39:38 -0400] coderanger: aslan: There are no words for how sad that makes me
[2013-08-06 00:40:25 -0400] aslan: coderanger: do you think a chef rubygem wrapper is not handling https properly?
[2013-08-06 00:40:46 -0400] aslan: coderanger: this might deserve a ticket :)
[2013-08-06 00:40:50 -0400] coderanger: aslan: If this were a sane world, any machine that has ever installed gems over non-SSL would be considered compromised
[2013-08-06 00:40:58 -0400] coderanger: Yeah, I would believe it, still sad though
[2013-08-06 00:41:08 -0400] coderanger: and a ticket would be excellent once we can do that again
[2013-08-06 00:41:30 -0400] aslan: coderanger: should i make it, once we can do that? lol
[2013-08-06 00:41:45 -0400] coderanger: Yes please
[2013-08-06 00:42:01 -0400] aslan: sure thing :)
[2013-08-06 00:42:37 -0400] aslan: coderanger: thanks for the help anyways
[2013-08-06 00:51:26 -0400] jmickle: coderanger: you around?
[2013-08-06 00:51:34 -0400] coderanger: Yahr
[2013-08-06 00:51:47 -0400] jmickle: out of curiosity
[2013-08-06 00:51:57 -0400] jmickle: what are your thoughts for running multi region on chef?
[2013-08-06 00:52:06 -0400] jmickle: multi region aws
[2013-08-06 00:52:07 -0400] jmickle: with chef
[2013-08-06 00:52:46 -0400] jmickle: is there any best practices for placement and structure of chef server
[2013-08-06 00:52:46 -0400] ssd7: FYI: tickets and wiki are back up
[2013-08-06 00:53:16 -0400] Sauraus: @ssd7 just waiting for the password reset email ;)
[2013-08-06 00:55:29 -0400] coderanger: jmickle: Depends on how HA you want to be
[2013-08-06 00:55:50 -0400] coderanger: jmickle: The nice thing about chef is that if the server is down, all it means is you can't change state, existing state is unaffacted
[2013-08-06 00:56:27 -0400] dysinger: working on an extension to a client's cookbooks: they have an expectation on a file that is set in ruby with a if file_doesnt_exist system:exit thing in their cookbook which bombs out 1st pass of chef before any recipes are run.  the two options I have with test-kitchen are: 1) bake in a fake file into vm images 2) cry 3) go back and try to fix clients cookbooks. - in straight vagrant I could use a script provider _before_ the chef provider a
[2013-08-06 00:56:28 -0400] dysinger: inject things on the fly.  not sure what to do with test-kitchen.
[2013-08-06 00:56:53 -0400] coderanger: jmickle: If you want stronger HA and be able to roll out changes during a regional outage, then your best bet is probably multiple isolated chef servers with some custom nginx goo to make the slaves read-only by blocking non-GET requests
[2013-08-06 00:57:03 -0400] coderanger: jmickle: And then write some scripts to sync data across them
[2013-08-06 00:57:13 -0400] jmickle: got it
[2013-08-06 00:57:44 -0400] coderanger: jmickle: You could also active-passive the whole thing via drbd
[2013-08-06 00:57:56 -0400] coderanger: jmickle: Thats hard to scale past two regions though
[2013-08-06 00:58:03 -0400] jmickle: yeah and drbd sucks
[2013-08-06 00:58:25 -0400] coderanger: Well drbd sucking is 90% conservation of suck + distributed systems sucking
[2013-08-06 01:01:33 -0400] jmickle: hahaha
[2013-08-06 01:01:35 -0400] jmickle: awesome
[2013-08-06 01:02:14 -0400] coderanger: jmickle: I would look very carefully at your HA requirements before leaping in here
[2013-08-06 01:02:31 -0400] coderanger: jmickle: There is a decent chance that off-AWS backups + automated server spinup could be enough :)
[2013-08-06 01:02:54 -0400] jmickle: well right now I'm trying to accomplish nagios
[2013-08-06 01:02:57 -0400] jmickle: with the community recipe
[2013-08-06 01:03:02 -0400] jmickle: we spun up a new region
[2013-08-06 01:03:05 -0400] jmickle: and nagios freaked
[2013-08-06 01:03:19 -0400] jmickle: doesn't appear the community recipe supports slaving a nagios server either
[2013-08-06 01:03:32 -0400] coderanger: Color me unshocked
[2013-08-06 01:03:39 -0400] jmickle: haha
[2013-08-06 01:04:29 -0400] coderanger: Nagios' obscure features have their own obscure features
[2013-08-06 01:05:34 -0400] jmickle: haha
[2013-08-06 01:06:12 -0400] jmickle: i <3 chef and all the automation but sometimes i feel like i get backed into holes of not using architectures because of the complexity of having to extend other's code to support what i want to do
[2013-08-06 01:06:21 -0400] jmickle: vs spending 20 min just setting up the servers
[2013-08-06 01:07:14 -0400] jmickle: you know a good article for opscode to do
[2013-08-06 01:07:30 -0400] jmickle: theres always a lot of talk on physical infrastructure management of large infrastructures
[2013-08-06 01:07:36 -0400] jmickle: but no large cloud based infrastructures
[2013-08-06 01:10:30 -0400] coderanger: jmickle: It would be a hard thing for us to write about, while chef powers big deploys, we barely use public clouds at all and even our private cloud setups aren't that big.
[2013-08-06 01:10:45 -0400] jmickle: makes sense
[2013-08-06 01:17:31 -0400] yfeldblum: jmickle, automating an infrastructure is 10x as hard as building it manually
[2013-08-06 01:17:58 -0400] jmickle: agreed
[2013-08-06 01:18:18 -0400] coderanger: yfeldblum: Funny story, I haven't noticed a 10x raise lately
[2013-08-06 01:18:20 -0400] pontiki: the first time
[2013-08-06 01:18:27 -0400] coderanger: Methinks we might be getting the short of this stick :)
[2013-08-06 01:18:40 -0400] jmickle: hahahaha coderanger
[2013-08-06 01:32:46 -0400] dysinger: any test-kitchen guys in here ? anyway I can inject a file into the test run before chef is run ? with vagrant I used the script provider before the chef provider to do this.
[2013-08-06 01:34:10 -0400] digitalcake: Looking for a little help. I'm not really sure why I have an error. https://gist.github.com/digitalcake/6161258
[2013-08-06 01:42:09 -0400] digitalcake: oh found it. Looks like I needed to update chef
[2013-08-06 02:30:57 -0400] dysinger: answer to my question (above) was use 'sync_folders' in kitchen.yml driver section
[2013-08-06 02:32:31 -0400] |rt|: I asked this in #vagrant but haven't gotten a response yet so I'll ask here as someone in here may know the answer.  has anyone run into issues doing a vagrant box repackage with lxc?
[2013-08-06 03:09:46 -0400] yoshie902a: Hi Everyone, I'm trying to learn chef, but having a hell of a time learning it. So much lack of documentation.  Can anyone recommend some good sources?
[2013-08-06 03:13:33 -0400] pontiki: wiki.opscode.com?
[2013-08-06 03:13:41 -0400] pontiki: there's an o'reilly book
[2013-08-06 03:15:37 -0400] yoshie902a: pontiki: Hi, thanks for the recommendations, the O'reilly book is not released yet, at least according to amazon.  wiki.opscode, I read through, but not as helpful as I'd prefer.
[2013-08-06 03:18:39 -0400] pontiki: i thought it was on prerelease...
[2013-08-06 03:19:07 -0400] pontiki: yoshie902a: the wiki is about as good as it gets, sadly; chef is *complicated*
[2013-08-06 03:19:20 -0400] yoshie902a: how did you learn it?
[2013-08-06 03:19:37 -0400] yoshie902a: pontiki: ^
[2013-08-06 03:20:12 -0400] pontiki: reading the wiki and docs, and reading cookbooks and stuff, and chatting with my devops
[2013-08-06 03:20:22 -0400] pontiki: but he was often just confusing
[2013-08-06 03:20:42 -0400] pontiki: how good is your understanding of ruby?
[2013-08-06 03:21:03 -0400] pontiki: and how good is your experience deploying in other ways?
[2013-08-06 03:21:47 -0400] yoshie902a: ruby I understand, deploying in other ways, I'm a novice. I've built on apache web server on linux, but that's about it
[2013-08-06 03:21:57 -0400] pontiki: nod
[2013-08-06 03:22:03 -0400] yoshie902a: nod?
[2013-08-06 03:22:09 -0400] pontiki: what sort of application server are you building
[2013-08-06 03:22:25 -0400] pontiki: that indicates i'm nodding my head in understanding
[2013-08-06 03:24:11 -0400] yoshie902a: I'm looking to setup a simple architecture for learning. I'd like to setup separate machines, one postgres server, one redis/resque server with several machines as workers, one elastic search server, and one machine for a web app.
[2013-08-06 03:25:20 -0400] yoshie902a: I've gotten receipes downloaded and I can provision the servers, but I'm lost as how to customize the downloaded scripts and I have no idea how to get them talking to each other.
[2013-08-06 03:26:38 -0400] yoshie902a: basically, I know to to download opscode and push the meals to my servers.  sadly,  there is much more too it that I have no idea how to do
[2013-08-06 03:34:19 -0400] yoshie902a: thanks, have a good night!
[2013-08-06 07:04:28 -0400] reagleton: Is there anybody here who can help me with attributes in Chef Solo?
[2013-08-06 07:13:40 -0400] enigmabomb: Hello. I'm having an error using Vagrant with Chef Solo. I get this error trying to use the recipe from Rove.io: FATAL: NameError: undefined local variable or method `use_inline_resources'
[2013-08-06 07:14:22 -0400] enigmabomb: Im also using librarian-chef
[2013-08-06 07:15:11 -0400] shimo: maybe the chef in your vm is too old?
[2013-08-06 07:15:53 -0400] enigmabomb: How can I determine the chef version
[2013-08-06 07:23:00 -0400] reagleton: Is there anybody here who can help me with attributes in Chef Solo?
[2013-08-06 07:23:13 -0400] prognostikos: anyone know of recipes that transparently use regular and encrypted data bags?
[2013-08-06 07:23:40 -0400] prognostikos: hm, maybe regular OR encrypted data bags is more accurate
[2013-08-06 07:37:26 -0400] gkarekinian: enigmabomb: Yes that error means a cookbook is using a feature that's only in Chef 11. 'chef-solo --version' in the vm should give you the version
[2013-08-06 07:37:41 -0400] enigmabomb: Thank you so much gkarekinian
[2013-08-06 07:39:40 -0400] leehambley: can anyone shed any light on http://stackoverflow.com/questions/18069287/overriding-chef-attributes-in-role-file/18071099 ? I've tried a bunch of things - but nothing will stick, and opscode have broken their site by redirecting everything to the security vulnerability post
[2013-08-06 07:39:47 -0400] enigmabomb: gkarekinian: You're nuts on. Chef: 10.14.2
[2013-08-06 07:40:20 -0400] coderanger: leehambley: jira and confluence are back
[2013-08-06 07:40:37 -0400] leehambley: alright, good to know, but still - I should be able to override_attributes() in a role, right ?
[2013-08-06 07:40:53 -0400] leehambley: I heard chatter that there's some known issue with that on chef 11.4 erlated to cookbook load order
[2013-08-06 07:40:59 -0400] leehambley: but I can't find any reference to it
[2013-08-06 07:41:15 -0400] coderanger: leehambley: Yes, remove the node=> bit though
[2013-08-06 07:41:33 -0400] leehambley: I already did (see the answer that was posted, I tried that)  - no beans
[2013-08-06 07:41:34 -0400] coderanger: leehambley: And of course github is now down
[2013-08-06 07:41:37 -0400] leehambley: haha
[2013-08-06 07:41:41 -0400] coderanger: leehambley: COMPUTERS
[2013-08-06 07:42:26 -0400] coderanger: Can you pastebin that recipe file somewhere not github so I can see the code?
[2013-08-06 07:42:33 -0400] coderanger: https://github.com/elasticsearch/cookbook-elasticsearch/blob/master/attributes/default.rb#L51
[2013-08-06 07:42:35 -0400] coderanger: That one
[2013-08-06 07:42:39 -0400] coderanger: not a recipe file I guess, derp
[2013-08-06 07:43:01 -0400] leehambley: erm, sure -
[2013-08-06 07:43:03 -0400] enigmabomb: gkarekinian: So what do I need to do here. Make my cookbook install chef 11 or something? What docs do I look for to know what the correct way to get Chef 11 on the box
[2013-08-06 07:45:23 -0400] leehambley: I think I know the problem >_<
[2013-08-06 07:45:31 -0400] leehambley: the file in my local site cookbook doesn't match what's at GH
[2013-08-06 07:45:34 -0400] leehambley: >_<
[2013-08-06 07:45:46 -0400] gkarekinian: You can use older cookbooks if you don't want to use Chef 11 yet, or use/make a Vagrant base box that's using Chef 11. Another way would be to use a shell provisioner to install using something like "curl -L http://www.opscode.com/chef/install.sh | sudo bash
[2013-08-06 07:45:47 -0400] gkarekinian: " , before running your chef-solo provisioning
[2013-08-06 07:48:30 -0400] enigmabomb: gkarekinian: Ok, so Chef fails, I can run that command, then go again with the chef provisioning.
[2013-08-06 07:49:02 -0400] gkarekinian: You can put the shell provisioning before the chef-solo one
[2013-08-06 07:52:13 -0400] leehambley: god bless Github's downtime coderanger :-) made me go spelinking in my berks cache
[2013-08-06 07:52:20 -0400] leehambley: I wonder why berks hasn't installed master ?a
[2013-08-06 07:52:23 -0400] leehambley: anywway
[2013-08-06 07:52:31 -0400] coderanger: leehambley: berks update <name>
[2013-08-06 07:52:51 -0400] enigmabomb: gkarekinian: That worked a treat. Also, holy cow this is powerful.
[2013-08-06 07:53:04 -0400] gkarekinian: You're welcome
[2013-08-06 07:53:07 -0400] enigmabomb: Thanks =)
[2013-08-06 08:53:15 -0400] telefoonboek: Hello guys
[2013-08-06 08:53:52 -0400] telefoonboek: I have a small question: In a chef recipe I need to run a command and check the returncode. If the returncode is not 0, I need to do something
[2013-08-06 08:53:59 -0400] telefoonboek: What is the best way to achieve this?
[2013-08-06 09:00:12 -0400] Zhann: I have a notify set in an lwrp like this: http://pastie.org/private/jcbjiv4fispw7ih9upaora
[2013-08-06 09:00:16 -0400] Zhann: notifies :reload, "service[apache2]"
[2013-08-06 09:00:33 -0400] Zhann: the problem is, this gets run immediately and does not queue
[2013-08-06 09:00:37 -0400] Zhann: anyone have any idea why?
[2013-08-06 09:02:18 -0400] Zhann: telefoonboek: set the not_if attribute: not_if "command_that_can_return_0"
[2013-08-06 09:02:38 -0400] Zhann: telefoonboek: http://docs.opscode.com/resource_common.html#conditionals
[2013-08-06 09:04:03 -0400] telefoonboek: Allright, that looks good. Can I do multiple not_if's?
[2013-08-06 09:05:16 -0400] Zhann: good question, you'll have to try that out I don't know
[2013-08-06 09:06:20 -0400] Zhann: you can always combine them in 1 not_if statement: not_if "grep foo /etc/bar && test -f /a/b"
[2013-08-06 09:08:56 -0400] telefoonboek: Nice, thanks =)
[2013-08-06 09:17:11 -0400] telefoonboek: Another question: can I use variables in execute thingies? Like command "echo node['text'] >> /a/bb"
[2013-08-06 09:21:39 -0400] shimo: telefoonboek: it's ruby, so you'd have to use "echo #{node['text']} >> /a/bb"
[2013-08-06 09:21:46 -0400] Zhann: telefoonboek: yes, "echo #{node['text']}"
[2013-08-06 09:21:53 -0400] Zhann: telefoonboek: you should check this out: http://docs.opscode.com/just_enough_ruby_for_chef.html
[2013-08-06 09:23:39 -0400] telefoonboek: Ah, perfect. Thanks =)
[2013-08-06 09:24:11 -0400] Zhann: anyone who can help me with my problem? see 11h00
[2013-08-06 09:28:57 -0400] nvbasd: Zhann: what timezone?
[2013-08-06 09:56:44 -0400] telefoonboek: @Zhann: you shoudl add :delayed: "notifies :reload, "service[apache2]", :delayed"
[2013-08-06 10:19:30 -0400] lcccc: hi guys, any idea on how I can report the progress of a long-running chef run?
[2013-08-06 10:19:42 -0400] lcccc: I see the chef handlers are called at the end of the run
[2013-08-06 10:20:46 -0400] lcccc: except parsing the client output
[2013-08-06 11:00:01 -0400] jonlives: knife-spork user? use DSl-format environment files? Comments invited on https://github.com/jonlives/knife-spork/issues/51 :)
[2013-08-06 11:00:07 -0400] jonlives: *DSL format
[2013-08-06 11:14:03 -0400] zts: jonlives: yeah, good luck with that one :)  Also, what about DSL-format environment files that contain ruby beyond the DSL?  (eg, using a variable to DRY a common subset of environment runlists)
[2013-08-06 11:14:18 -0400] jonlives: zts: tell me about it :p
[2013-08-06 11:22:06 -0400] m4rcu5: jonlives: talking about knife-spork, it seems the plugin install type into the .chef folder does not seem to work anymore, it fails on the require 'runner'
[2013-08-06 11:23:47 -0400] jonlives: m4rcu5: that's actually a valid point, those docs need updated
[2013-08-06 11:24:30 -0400] jonlives: m4rcu5: tho the next version will give you the ability to specify a custom location for spork plugins so hopefully I can deprecate that method entirely :p
[2013-08-06 11:24:48 -0400] jonlives: hopefully once that's out, people can just install the gem for the main code.
[2013-08-06 11:25:20 -0400] m4rcu5: jonlives: i actually like to keep all the plugins into the .chef folder of my chef repo, so everyone who checks out the rpo has all the tools at hand
[2013-08-06 11:26:05 -0400] jonlives: m4rcu5: opened https://github.com/jonlives/knife-spork/issues/83 anyway :)
[2013-08-06 11:26:31 -0400] jonlives: m4rcu5: tho I'd suggest you include a gemfile in your repo instead so people can just do "bundle install"
[2013-08-06 11:31:38 -0400] m4rcu5: jonlives: i have never used a gemfile nor bundler, so i think i will need some investigation there
[2013-08-06 11:32:16 -0400] jonlives: m4rcu5: checkout http://bundler.io/v1.3/gemfile.html :)
[2013-08-06 11:32:31 -0400] jonlives: basically lets you specify a list of gems and versions to be installed
[2013-08-06 11:33:56 -0400] m4rcu5: jonlives: hehe, i do not even have bindler installed ;)
[2013-08-06 11:34:41 -0400] jonlives: m4rcus it's turtles all the way down :p
[2013-08-06 11:42:04 -0400] m4rcu5: jonlives: ah, i will check it out, it was cool though building everything into the chef repo, but i guess not everything will work like that anyway. I can still keep the config in there
[2013-08-06 11:46:01 -0400] jonlives: m4rcu5: well there's an issue in there now, I'll get the docs updated so it still works for now :)
[2013-08-06 11:55:16 -0400] perprogramming: does somebody has time and lust to give me some feedback on how chef, berkshelf and ant could play together? i am new to this tools and wonder which off them should handle what.
[2013-08-06 11:57:08 -0400] perprogramming: after some experiments (and a lot of documentation reading) i think that berkshelf is useful to develop my own cookbooks and to manage them on my chef server. but it is not useful to manage a concrete project, or is it?
[2013-08-06 11:58:35 -0400] perprogramming: furthermore i got the feeling, that there might be some tasks, that are more related to a concrete project (e.g. run database migrations, handle assets, project file permissions) than to a node. should i handle those with chef  or with ant and just trigger ant from chef?
[2013-08-06 11:59:59 -0400] zaargy: well this is a big topic
[2013-08-06 12:00:28 -0400] zaargy: typically you might build a project written in java with ant to produce an artifact and chef helps with the process of getting that artifact on to your servers
[2013-08-06 12:01:39 -0400] zaargy: and putting all the infrastrcucture in place that artifact might need etc
[2013-08-06 12:17:26 -0400] perprogramming: @zaargy thank you. any thoughts on berkshelf?
[2013-08-06 12:18:35 -0400] alx__: does anyone have a direct link to the starter kit?
[2013-08-06 12:25:39 -0400] zaargy: perprogramming: berkshelf is just a fancy way of managing dependencies for your infrastructure level components :)
[2013-08-06 12:27:39 -0400] perprogramming: @zaargy:  and is only necessary to resolve the dependencies and not really to provision a node, right?
[2013-08-06 12:30:05 -0400] zaargy: perprogramming: if you're just getting started yeah
[2013-08-06 12:30:22 -0400] perprogramming: great thanks.
[2013-08-06 12:30:24 -0400] zaargy: although it is a good thing to try to use from teh beginning i suppose
[2013-08-06 12:49:20 -0400] bcave: hi all
[2013-08-06 13:31:55 -0400] mancdaz: is it possible to 'unset' a node attribute in a recipe?
[2013-08-06 13:59:50 -0400] tlowrimore: I'm getting a "Private Key Not Found" when provisioning a Vagrant box using the :chef_client provisioner.  I've not run into this issue before, and at this point I've reached the limits of my knowledge of Chef/Vagrant.  Help?
[2013-08-06 14:00:01 -0400] tlowrimore: Here's a gist of my Vagrant file: https://gist.github.com/tlowrimore/6164630
[2013-08-06 14:00:49 -0400] tlowrimore: I have verified that validation.pem is not present in /etc/chef on the box.
[2013-08-06 14:02:57 -0400] tlowrimore: This only seems to be an issue when provisioning with chef-client.  Chef-solo works fine.
[2013-08-06 14:03:13 -0400] tlowrimore: Any ideas?
[2013-08-06 14:15:35 -0400] gchristensen: tlowrimore: make sure the path to your validation pem are right
[2013-08-06 14:15:54 -0400] aramus_: Hello, could someone give an example of how a .json file passed to chef-client with the -j option should be structured to create an attribute like node[:hello][:world] ?
[2013-08-06 14:16:43 -0400] mathewpeterson: Does anyone know of a recipe for apache 2.4? It appears that the current Apache2 recipe has an incompatible apache.conf
[2013-08-06 14:20:52 -0400] tlowrimore: gchristensen: How might one verify the path to the validation.pem?  Is this a Vagrantfile setting?
[2013-08-06 14:21:01 -0400] gchristensen: tlowrimore: yes
[2013-08-06 14:24:00 -0400] bcave: mathewpeterson: I think (untested) {"override_attributes" : { "hello" : { "world" : "attribute_value" } } }
[2013-08-06 14:24:50 -0400] bcave: stand to be corrected, I'm only using a run_list with the -j option
[2013-08-06 14:26:08 -0400] mathewpeterson: bcave: I'm not sure that would work in my case. It seems that the directive of "LockFile" has been removed. In the recipe it will always set that setting.. Is there a way to override a their config with my own?
[2013-08-06 14:29:46 -0400] tlowrimore: gchristensen: I have verified that the file to which `chef.chef_validation_key_path` points to a valid .pem file.  Is there some other setting I need to consider?
[2013-08-06 14:30:43 -0400] aramus_: bcave: thanks
[2013-08-06 14:50:02 -0400] bcave: sorry mathewpeterson, that was for aramus_
[2013-08-06 14:50:16 -0400] bcave: long day, i've started reading diagonally
[2013-08-06 14:50:34 -0400] mathewpeterson: bcave: no worries
[2013-08-06 16:00:10 -0400] d```: is opscode jira still down?
[2013-08-06 16:00:52 -0400] jtimberman: d```: Nope :)
[2013-08-06 16:01:07 -0400] jtimberman: http://www.opscode.com/blog/2013/08/05/public-wiki-and-ticketing-sites-back-online/
[2013-08-06 16:01:51 -0400] d```: jtimberman: thanks, all links off google were getting 502 errors
[2013-08-06 16:17:41 -0400] theCzar: Is there a good way to test for the existence of a recipe within a cookbook from another recipe in the same cookbook?
[2013-08-06 16:18:07 -0400] theCzar: I tried to do what I usually would do in ruby to test if a file exists in the same directory as a given file, but it doesn't seem to have worked.
[2013-08-06 16:18:41 -0400] theCzar: https://gist.github.com/0x783czar/6166023
[2013-08-06 16:21:12 -0400] jtimberman: theCzar: if one recipe in the cookbook is on the system, the other recipes have to be.
[2013-08-06 16:21:23 -0400] aramus_: Hello, how would you use knife node edit to edit an attribute of a node?
[2013-08-06 16:22:21 -0400] theCzar: jtimberman: yes, but I'm trying to do some sort of reflection.  It to pick a recipe within the cookbook, based on the platform and install type attribute.
[2013-08-06 16:22:52 -0400] Sauraus: Is tickets.opscode.com up again?
[2013-08-06 16:22:56 -0400] theCzar: jtimberman: and I'd like to throw a log before it fails
[2013-08-06 16:23:07 -0400] theCzar: jtimberman: in the event the cookbook does not exist yet
[2013-08-06 16:23:17 -0400] jtimberman: theCzar: something like: include_recipe "mycookbook::#{node['platform']}" or such.
[2013-08-06 16:23:19 -0400] jtimberman: Sauraus: yes.
[2013-08-06 16:23:28 -0400] jtimberman: Sauraus: you'll need to reset your password.
[2013-08-06 16:23:46 -0400] Sauraus: @jtimberman in that case something is still not quiet right because password reset emails are not being sent
[2013-08-06 16:24:00 -0400] jtimberman: theCzar: if you want to ensure that a *different* cookbook is available, depend on it in the metadata of the cookbook where you want ot use it.
[2013-08-06 16:24:13 -0400] jtimberman: Sauraus: hm, i got mine about 20 minutes ago. :-|
[2013-08-06 16:24:21 -0400] jtimberman: brb, rebootin this system for updates :)
[2013-08-06 16:25:40 -0400] theCzar: jtimberman: no, it's a recipe within the same cookbook (I mistyped earlier).  And I know I can just call the recipe in that way.  I just would like to test whether the recipe even exists so I can print a message to the chef-log.
[2013-08-06 16:26:28 -0400] jbz: I just tried to reset my password and didn't get a mail. :-/
[2013-08-06 16:27:53 -0400] theCzar: jtimberman: no, it's a recipe within the same cookbook (I mistyped earlier).  And I know I can just call the recipe in that way.  I just would like to test whether the recipe even exists so I can print a message to the chef-log.
[2013-08-06 16:28:17 -0400] theCzar: jtimberman: this gist shows what I'm trying to do: https://gist.github.com/0x783czar/6166023
[2013-08-06 16:28:25 -0400] Sauraus: got tickets.opscode.com login working... too bad half my tickets got nuked! :(
[2013-08-06 16:29:12 -0400] jtimberman: theCzar: Right, what I'm saying is that conditional isn't necessary, you'll have the whole cookbook when using chef-client/server, or you have to transfer the whole thing w/ solo.
[2013-08-06 16:31:16 -0400] theCzar: jtimberman: right, right.  I understand that the whole cookbook will be there, but I want to handle the case where such a combination of platform and install_type don't exist yet. (sorry if I'm not explaining myself well)
[2013-08-06 16:32:03 -0400] theCzar: jtimberman: it's not exactly essential, but I think it'd be nice to have
[2013-08-06 16:33:44 -0400] ggolin: hello
[2013-08-06 16:33:50 -0400] bcave: bleh... catch 22 while trying to set up a node, wondering if anyone has any advice on how to resolve this.....
[2013-08-06 16:34:21 -0400] ggolin: trying to use chef-solo with databag search. chef-solo complains about client.pem. is there a setting to bypass that, or is that file required?
[2013-08-06 16:34:24 -0400] bcave: i want to install a gem for chef.
[2013-08-06 16:34:44 -0400] bcave: the gem is fog. I'm using chef_gem "fog" do action :install
[2013-08-06 16:35:14 -0400] bcave: however, installing the gem requires some system packages - e.g. make
[2013-08-06 16:35:34 -0400] bcave: so I have packge "make" do action :install
[2013-08-06 16:35:53 -0400] bcave: but that fails because apt needs to update, so I have: include_recipe "apt", which sorts out apt
[2013-08-06 16:36:23 -0400] bcave: however, when i run my recipe, it tries to execute chef_gem before running apt or installing the packages
[2013-08-06 16:37:11 -0400] bean: do you have them in the correct order? :)
[2013-08-06 16:37:18 -0400] bcave: yes
[2013-08-06 16:37:32 -0400] bcave: the only "non-standard" is that the packages are in an each loop...
[2013-08-06 16:37:36 -0400] bcave: here's the gist of it...
[2013-08-06 16:37:51 -0400] ggolin: chef_gem probably runs in a different run phase
[2013-08-06 16:38:06 -0400] bean: that seems likely
[2013-08-06 16:38:25 -0400] bean: https://github.com/elasticsearch/cookbook-elasticsearch/blob/master/recipes/ebs.rb uses the fog gem
[2013-08-06 16:38:27 -0400] bean: in a chef_gem
[2013-08-06 16:39:10 -0400] thom: bcave: https://gist.github.com/thommay/103364b6107015f107fe
[2013-08-06 16:39:26 -0400] bcave: https://gist.github.com/brettcave/6103434
[2013-08-06 16:39:50 -0400] bcave: yeah thom - have tried that, but then the package installation runs before the include_recipe, and apt is broken
[2013-08-06 16:40:04 -0400] MrBIOS: jtgiri_: ping
[2013-08-06 16:40:16 -0400] thom: bcave: you have to do it that way, because chef_gem runs at compile phase not converge phase
[2013-08-06 16:40:21 -0400] bcave: i need an equivalent of recipe = include_recipe "apt" action :nothing end recipe.run_action(:include)
[2013-08-06 16:40:24 -0400] MrBIOS: I'm trying to import backup from 10 to 11 for migration, I am getting this error message : ERROR: JSON::ParserError: Unsupported `json_class` type 'Chef::WebUIUser'
[2013-08-06 16:40:46 -0400] MrBIOS: jtgiri_: looks like you had the same problem back on May 16th, according to http://community.opscode.com/chat/chef/2013-05-16
[2013-08-06 16:40:49 -0400] bcave: yeah - you can see from my gist that I use that approach. the blocker in my case is that when I do that, I can't run the apt recipe :(
[2013-08-06 16:41:05 -0400] yfeldblum: chef_gem is not a pure resource declaration; it takes action *immediately* (and is not merely declared and waiting for deferred convergence like all other resource declarations are)
[2013-08-06 16:41:44 -0400] bcave: is there a way to get the include_recipe out of the convergence phase and into the compile phase then?
[2013-08-06 16:41:56 -0400] bcave: or is the only solution to copy what the apt recipe does into my recipe?
[2013-08-06 16:42:11 -0400] thom: bcave: essentially yes
[2013-08-06 16:42:41 -0400] zts: theCzar: you could just try to include_recipe, and catch the exception when it fails
[2013-08-06 16:43:28 -0400] Sauraus: @bcave why not use the build-essentials cookbook instead of adding separate pacakges?
[2013-08-06 16:43:34 -0400] zts: theCzar: failing that, look at http://serverfault.com/a/526777/140520 - if you do manifest['recipes'] instead of the example in that answer, you'll get an array of hashes describing the recipes
[2013-08-06 16:43:35 -0400] bcave: erk... thought as much. thanks thom / yfeldblum
[2013-08-06 16:44:05 -0400] bcave: Sauraus: thanks for the suggestion
[2013-08-06 16:44:19 -0400] jtimberman: theCzar: i can appreciate good error condition handling, but i think you're putting too much effort into this, since chef will bail out with an error if it can't include the recipe :)
[2013-08-06 16:44:40 -0400] bcave: might do that, will add a note into my config. assuming that build-essentials installs dev tools like make and libraries, etc>?
[2013-08-06 16:45:17 -0400] pontiki: build-essential
[2013-08-06 16:45:19 -0400] pontiki: no s
[2013-08-06 16:45:24 -0400] theCzar: jtimberman: yeah I probably am, :P
[2013-08-06 16:45:27 -0400] Sauraus: stickler :P
[2013-08-06 16:45:29 -0400] bcave: thanks
[2013-08-06 16:45:30 -0400] theCzar: zts: thanks
[2013-08-06 16:45:43 -0400] bcave: i actually pronounced it with a silent s.
[2013-08-06 16:46:19 -0400] yfeldblum: bcave, `gem_package "the-gem-name" do ; gem_binary File.join(Gem.bindir, "gem") ; end` <--- chef_gem that runs at converge time, not at compile time
[2013-08-06 16:46:34 -0400] bcave: yeah, I have that in my recipe already
[2013-08-06 16:46:53 -0400] trobrock: Is there a way in a recipe in chef 11 to evaluate an attributes file?
[2013-08-06 16:47:03 -0400] bcave: I have 2 needs for the gem. one for internal use in my recipe, and the other for running outside of chef with other ruby scripts
[2013-08-06 16:47:34 -0400] bcave: gem_package is working great. it's only the chef_gem that breaks. understand now - as it's executed at compile time and not converge time
[2013-08-06 16:47:49 -0400] Sauraus: PS. There is a small bug in the build-essential cookbook for the kernel-devel package: http://tickets.opscode.com/browse/COOK-3413
[2013-08-06 16:47:59 -0400] Sauraus: And the fix for it: https://github.com/opscode-cookbooks/build-essential/pull/19
[2013-08-06 16:48:24 -0400] bcave: ok, thanks.
[2013-08-06 16:48:49 -0400] bcave: not sure if I'll need the build-essential right now, but will definitely come in handy soon
[2013-08-06 16:50:07 -0400] yfeldblum: bcave, http://pastie.org/pastes/8212069/text?key=gf0usl7kyra7gf0azssj6q
[2013-08-06 16:50:35 -0400] bcave: got the fix too. would that affect rhel systems primarily?
[2013-08-06 16:51:27 -0400] bcave: yfeldblum: what does the gem_binary do/
[2013-08-06 16:51:28 -0400] bcave: ?
[2013-08-06 16:51:56 -0400] bcave:  oooh. never mind. it installs the gem on the system, and then installs it into the chef gem dir
[2013-08-06 16:52:06 -0400] bcave: nice!
[2013-08-06 16:52:17 -0400] yfeldblum: bcave, right
[2013-08-06 16:52:36 -0400] bcave: that works MUCH better than duplicating a whole other recipe into mine.
[2013-08-06 16:52:47 -0400] ggolin: is there a way to mock a node object?
[2013-08-06 16:53:18 -0400] yfeldblum: bcave, keep in mind that the two resource declarations must have different names, even though they want to install the same gem; that's why one is named "#{gem_name}-external" and the other "#{gem_name}-internal" in my example
[2013-08-06 16:53:44 -0400] bcave: ok thanks. I've run into that error before. chef complains about that if i remember correctly
[2013-08-06 16:53:55 -0400] yfeldblum: bcave, that's why i put in the `name "#{gem_name}"` explicitly in each one as well
[2013-08-06 16:54:34 -0400] corehook: hi all
[2013-08-06 16:54:41 -0400] corehook: how i can change users password in private ospcode chef ?
[2013-08-06 16:54:49 -0400] corehook: [22:53]corehook@chef.robux.me:/opt/opscode$ sudo private-chef-ctl password corehook
[2013-08-06 16:54:52 -0400] corehook: Usage: private-chef-ctl password <username> [--disable]
[2013-08-06 16:55:25 -0400] corehook: in opscode db i dont know field name with user password
[2013-08-06 16:55:48 -0400] thehar: https://servername/users/thehar/edit =P
[2013-08-06 16:55:59 -0400] corehook: i dont remember user password
[2013-08-06 16:56:04 -0400] corehook: sorry,i mean reset password
[2013-08-06 16:56:39 -0400] thehar: use the webui to reset it and email i'm not familiar with the ctl
[2013-08-06 16:57:35 -0400] corehook:  no matter, thx
[2013-08-06 16:57:57 -0400] corehook: https://dpaste.de/E7kbZ/
[2013-08-06 16:59:04 -0400] thehar: ah yes
[2013-08-06 17:02:50 -0400] gchristensen: heh, lwrps are great. just made one up for autossh tunnels
[2013-08-06 17:03:09 -0400] spheromak: indeed lwrp's are great
[2013-08-06 17:03:24 -0400] gchristensen: I don't get to make htem frequently, but when I do... it always feels good.
[2013-08-06 17:15:43 -0400] mquinn: I'm having an odd issue where my run list seems to expand correctly, however when it actually is run, it is in the incorrect order
[2013-08-06 17:16:06 -0400] mquinn: specifically, the mysql::server recipe always wants to run first
[2013-08-06 17:16:57 -0400] mquinn: Anything obvious I may be doing wrong? or do I have a misunderstanding about how the run list works?
[2013-08-06 17:21:38 -0400] ggolin: hrm.. wit chef-solo is it at all possible to do things like node.save ? in a serverless scenario?
[2013-08-06 17:21:43 -0400] paulmooring: mquinn: what's first in your expanded run_list?
[2013-08-06 17:21:51 -0400] ggolin: (i am trying to test with test-kitchen)
[2013-08-06 17:22:18 -0400] gchristensen: ggolin: I'd say: try it and see. I don't know, but trying it can't hurt :)
[2013-08-06 17:22:53 -0400] ggolin: gchristensen, well, its asking for a client.pem - im not sure what it would use it for. i suspect it'd try to connect to a server or something :)
[2013-08-06 17:23:29 -0400] mquinn: paulmooring: recipe[gloto::apt-update], which simply runs apt-get update if it hasn't been run for a while.
[2013-08-06 17:24:39 -0400] gchristensen: ggolin: sounds like you're right :) and should detect if you're on chef-solo or not. the mysql cookbook handles this by requiring you to have set the attributes it would have otherwise generated
[2013-08-06 17:24:41 -0400] paulmooring: mquinn: hmm, the short answer is no the expanded run_list is the order things run in.  The longer answer is include_recipe, roles, and dependencies can make it a little muddy
[2013-08-06 17:24:45 -0400] mquinn: paulmooring: but that is not being run - so the mysql::server recipe fails when it tries to apt-get mysql
[2013-08-06 17:25:12 -0400] paulmooring: mquinn: ah, this doesn't sound like a run order problem so much as a compile vs. execute problem
[2013-08-06 17:25:20 -0400] JasonG_: mquinn: how are you determine "hasn't been run for a while" with apt? I'm setting a node attribute but I'm trying to factor that out so my stuff doesn't require chef-client and works with chef-solo
[2013-08-06 17:27:02 -0400] mquinn: JasonG_:  http://pastebin.com/LTGFwqZL is what I've been using
[2013-08-06 17:28:24 -0400] paulmooring: mquinn: do you have a snippet of where the mysql::server recipe blows up?
[2013-08-06 17:30:58 -0400] mquinn: paulmooring: sure - here you go http://pastebin.com/L0x49vat
[2013-08-06 17:32:15 -0400] paulmooring: mquinn: yeah this has a .run_action(:install)
[2013-08-06 17:32:26 -0400] mquinn: paulmooring: actually - does like 120  right was just about to ask about that
[2013-08-06 17:32:37 -0400] mquinn: ah, thats frustrating
[2013-08-06 17:32:37 -0400] paulmooring: so it's trying to install during compile rather than execute, which is before your execute block runs
[2013-08-06 17:33:13 -0400] paulmooring: https://github.com/opscode-cookbooks/build-essential/blob/master/recipes/debian.rb
[2013-08-06 17:33:24 -0400] paulmooring: mquinn: check out how this is handled in that cookbook
[2013-08-06 17:33:41 -0400] paulmooring: essentially you need to force the apt-get update to happend during compile
[2013-08-06 17:37:12 -0400] ggolin: gchristensen, yep, [2013-08-06T17:36:50+00:00] ERROR: Connection refused connecting to localhost:443 for /nodes/default-ubuntu-1204, retry 1/5
[2013-08-06 17:38:15 -0400] JasonG_: mquinn thanks! just was I was going to write actually. Here's what I was using before using node attributes: https://gist.github.com/jgerry/6166687
[2013-08-06 17:43:10 -0400] JasonG_: mquinn your way is much better
[2013-08-06 17:45:33 -0400] corehook: guys i have 1 RoR application and cookbooks for this project. Now i want automatically deploy RoR project. Any advices ?
[2013-08-06 17:47:31 -0400] bcave: yfeldblum: works like a charm, thanks for the guidance. only needed to fix up the attribute "name" to "package_name" from your pastie
[2013-08-06 17:47:39 -0400] yfeldblum: bcave, cool
[2013-08-06 17:47:47 -0400] yfeldblum: bcave, glad i could help
[2013-08-06 17:48:50 -0400] aramus_: Hello, does anyone know how to associate a node with a chef environment using knife?
[2013-08-06 17:50:26 -0400] yfeldblum: aramus_, `knife node edit NODE`
[2013-08-06 17:52:16 -0400] aramus_: I see, the documentation only says to "editing the chef_environment directly using Knife" but doesn't really say how. Thanks yfeldblum.
[2013-08-06 17:52:51 -0400] ggolin: argh
[2013-08-06 17:53:21 -0400] ggolin: for testing purposes is it possible to assign the node object to a variable?
[2013-08-06 17:53:38 -0400] jtimberman: aramus_: unfortunately the best we have right now is a ruby block in a knife exec script. e.g., knife exec -E 'nodes.transform("name:NODEYOUWANT") {|n| n.chef_environment = "ENVYOUWANT"}'
[2013-08-06 17:53:42 -0400] ggolin: as in, put the node object into an array element. im passing it to a template.
[2013-08-06 17:54:19 -0400] ggolin: (search in chef-solo does not work for me)
[2013-08-06 17:54:57 -0400] aramus_: @jtimberman: Oh, this is much easier than editing it using knife node edit, thanks!
[2013-08-06 17:55:08 -0400] mquinn: paulmooring: Thanks a lot. I'm new to chef. Why would one want to force a provider to run during the compile phase?
[2013-08-06 17:55:39 -0400] ggolin: because you need something to happen before you do other things
[2013-08-06 17:55:51 -0400] paulmooring: mquinn: only in the case it's need for the Chef run to succeed (like installing the chef_gem mysql so Chef can use it so hit a mysql db)
[2013-08-06 17:56:12 -0400] paulmooring: or in the case of build-essential, we need the tools available for Chef to use to build things from soruce
[2013-08-06 17:59:00 -0400] mquinn: Couldn't someone just put build-essential high in their run list? Or do you not want to have to force people to manage that dependency
[2013-08-06 18:02:40 -0400] yfeldblum: paulmooring, IMO install the mysql gem during converge, and write providers that can handle it
[2013-08-06 18:02:58 -0400] jtimberman: mquinn: needs to happen during the compile phase because e.g. "chef_gem" is done in the compile phase so that the RubyGem is available in the context of other recipes.
[2013-08-06 18:03:29 -0400] paulmooring: yfeldblum: yeah, that's a better approach I'm just guessing why mquinn's recipe is how it is
[2013-08-06 18:03:46 -0400] aramus_: Hello, I am trying to deploy multiple gliders with different settings for each. Environments are the best way to achieve this, yes?
[2013-08-06 18:04:14 -0400] yfeldblum: paulmooring, i've actually gone through converting things to my strategy ... and it works so much better
[2013-08-06 18:04:48 -0400] paulmooring: yfeldblum: is this on Github?
[2013-08-06 18:04:53 -0400] mathewpeterson: Does anyone have apache 2.4 working with a recipe?
[2013-08-06 18:04:55 -0400] yfeldblum: paulmooring, no
[2013-08-06 18:05:14 -0400] yfeldblum: paulmooring, just reporting on what works for Person XYZ in practice
[2013-08-06 18:05:54 -0400] mquinn: paulmooring: FYI Thats actually the opscode community mysql cookbook (https://github.com/opscode-cookbooks/mysql/blob/master/recipes/ruby.rb)
[2013-08-06 18:06:01 -0400] yfeldblum: paulmooring, viz., work within the abstractions when they're solid, rather than breaking them
[2013-08-06 18:06:24 -0400] bean: aramus_: or a role.
[2013-08-06 18:06:31 -0400] bean: but a lot of people would tell you that roles suck
[2013-08-06 18:06:37 -0400] yfeldblum: paulmooring, i've stopped using chef_gem for that reason
[2013-08-06 18:06:54 -0400] yfeldblum: paulmooring, for the most part, anyway, especially when the gem has package dependencies
[2013-08-06 18:07:22 -0400] paulmooring: yfeldblum: yfeldblum do you just avoid requiring gems in cookbooks altogether then?
[2013-08-06 18:07:41 -0400] yfeldblum: paulmooring, and anything in a provider that requires a gem can work without chef_gem
[2013-08-06 18:07:47 -0400] yfeldblum: paulmooring, not at all!
[2013-08-06 18:08:47 -0400] yfeldblum: paulmooring, e.g., good gems to use are the pg gem to configure postgres, the mongo gem to configure mongodb, the fog gem to fetch objects from cloud storage
[2013-08-06 18:09:27 -0400] yfeldblum: paulmooring, but they are installed with `gem_package("pg") { gem_binary(File.join(Gem.bindir, "gem")) }` in a recipe before any resources are declared that will need to use pg
[2013-08-06 18:09:44 -0400] paulmooring: yfeldblum: makes sense
[2013-08-06 18:10:05 -0400] aramus_: bean: Thanks.
[2013-08-06 18:10:17 -0400] paulmooring: yfeldblum: so did you library that bit up or just put it bare in the recipe?
[2013-08-06 18:10:55 -0400] yfeldblum: paulmooring, so that lets me install build-essential normally (`package "build-essential"`), install the postgres dev packages normally, install the pg gem normally, and use it normally
[2013-08-06 18:11:18 -0400] yfeldblum: paulmooring, rather than trying to fight chef
[2013-08-06 18:11:31 -0400] paulmooring: I like it
[2013-08-06 18:11:33 -0400] yfeldblum: paulmooring, you don't need to library it up
[2013-08-06 18:11:42 -0400] yfeldblum: paulmooring, it's so simple
[2013-08-06 18:11:58 -0400] paulmooring: I have an unhealty aversion to bare Ruby inside recipes
[2013-08-06 18:12:05 -0400] yfeldblum: paulmooring, i did library up the `File.join(Gem.bindir, "gem")` bin
[2013-08-06 18:12:23 -0400] yfeldblum: paulmooring, but there's no reason one would have to do that
[2013-08-06 18:12:54 -0400] zerokarmaleft: https://gist.github.com/zerokarmaleft/6167022 <= expecting postgres user to have "foo" set for the password, do I have to put this in a databag or something?
[2013-08-06 18:14:17 -0400] yfeldblum: paulmooring, i have an aversion to complex ruby inside recipes, and prefer to move that to libraries and providers, but not an aversion to simple ruby in recipes
[2013-08-06 18:15:31 -0400] paulmooring: yfeldblum: yeah it's mostly an aestetic thing for me, I already have a "helpers" cookbook so I prefer to through ruby snippets in there
[2013-08-06 18:16:45 -0400] yfeldblum: paulmooring, i do the same, but only for helpers that are truly generic; for helpers that are not generic across cookbooks, i have one or more helper modules as libraries in that cookbook
[2013-08-06 18:17:27 -0400] yfeldblum: paulmooring, e.g., i might have a PostgresCookbook::QuoteHelpers module in site-cookbooks/postgres/libraries/quote_helpers.rb
[2013-08-06 18:17:44 -0400] paulmooring: yfeldblum: yep that's spot on, global helpers for DRYing up code and local libraries to keep Ruby out of recipes
[2013-08-06 18:17:51 -0400] yfeldblum: paulmooring, which recipes and providers in the cookbook make use of
[2013-08-06 18:22:44 -0400] karamorf: is it possible to install a module before requiring it in a recipe? ie line 1 I want 'gem_package' then line 2 I want to 'require' it...
[2013-08-06 18:23:06 -0400] yfeldblum: karamorf, yes, using chef_gem rather than gem_package
[2013-08-06 18:23:08 -0400] bean: karamorf: what you're looking for is "chef_gem"
[2013-08-06 18:23:27 -0400] bean: keep in mind, it gets run during compile so the gem is available to the recipes
[2013-08-06 18:23:51 -0400] karamorf: perfect, thanks :)
[2013-08-06 18:27:55 -0400] mathewpeterson: Is there a way to ignore errors of an included recipe?
[2013-08-06 18:28:09 -0400] kryptek: catch the exception?
[2013-08-06 18:28:40 -0400] Sauraus: Hej OpsCode dudes :) how and when do you guys check on pull requests? Feels like the process is less than smooth even after jumping through all the hoops of a CCLA
[2013-08-06 18:29:24 -0400] kryptek: mathewpeterson, You can try wrapping your block of code in a begin..rescue..end block
[2013-08-06 18:29:41 -0400] bean: Sauraus: if its a community cookbook I think they have a weekly pull request thing where they go over some PRs
[2013-08-06 18:29:58 -0400] mathewpeterson: kryptek: Do you have a link to how that might be done?
[2013-08-06 18:30:22 -0400] Sauraus: ok so I should not hold my breath to get any action on my pull requests any time soon then I gues
[2013-08-06 18:30:22 -0400] kryptek: Why don't you create a gist of an example recipe (if it's not sensitive) and I can comment on it for you?
[2013-08-06 18:33:38 -0400] kryptek: mathewpeterson, Got that gist up?
[2013-08-06 18:34:56 -0400] mathewpeterson: kryptek: oh, I'm just including the apache2 recipe in my own, and when it restarts apache, it fails because the config is broken, after my include_recipe block i fix the apache config
[2013-08-06 18:35:23 -0400] kryptek: Ahh, the error you're getting is the return code from apache2 trying to start..
[2013-08-06 18:36:20 -0400] kryptek: mathewpeterson, Why not move that code that fixes the config higher up in your run list?
[2013-08-06 18:37:27 -0400] mathewpeterson: kryptek because it will get overwritten by the apache recipe.
[2013-08-06 18:38:25 -0400] kryptek: I see
[2013-08-06 18:39:11 -0400] kryptek: It's a little hard without being able to see the issue first hand
[2013-08-06 18:39:26 -0400] kryptek: Are you modifying the apache2 cookbook?
[2013-08-06 18:40:10 -0400] ggolin: mathewpeterson, you can ignore failure on the actual apache restart command
[2013-08-06 18:41:35 -0400] kryptek: ggolin, How do you ignore service failures?
[2013-08-06 18:41:36 -0400] mathewpeterson: ggolin: yeah, but that happens in the apache2 cookbook, which I cannot modify...
[2013-08-06 18:41:38 -0400] joelnn: is there a way to trigger an action if the contents of a file are different than desired, *without* updating the file contents? or to run some bash command prior to and after updating the file
[2013-08-06 18:42:09 -0400] ggolin: mathewpeterson, ah, sorry - i was under the impression you were rolling your own apache2 cb.
[2013-08-06 18:43:44 -0400] kryptek: joelnn, You can ::File.open() the file and do your conditional
[2013-08-06 18:45:20 -0400] suffix_: how do I determien my chef server version?
[2013-08-06 18:45:22 -0400] joelnn: kryptek: ok, thanks
[2013-08-06 18:46:47 -0400] karamorf: hmm, what about immedietly installing a system package so that the chef_gem can actually install the ruby gem?
[2013-08-06 18:48:29 -0400] kryptek: karamorf, package("package-name").run_action(:install)
[2013-08-06 18:48:48 -0400] suffix_: how do I determien my chef server version?
[2013-08-06 18:50:00 -0400] ggolin: suffix_, please google
[2013-08-06 18:51:04 -0400] suffix_: ggolin please diaf. I wouldn't have asked in here if I hadn't already googled.
[2013-08-06 18:51:40 -0400] ggolin: suffix_, keep asking the same question then, someone will surely answer. also, diaf yourself. fark ftw.
[2013-08-06 18:51:59 -0400] suffix_: ./ignore ggolin
[2013-08-06 18:52:05 -0400] ggolin: please do
[2013-08-06 18:52:25 -0400] kryptek: You know, he's got a point, suffix. With that attitude you can't expect to get much help
[2013-08-06 18:52:54 -0400] aramus_: ... What just happened?
[2013-08-06 18:53:00 -0400] kryptek: No idea, what a jerk
[2013-08-06 18:54:33 -0400] aramus_: Hi guys, I'm at th environments docs at opscode but they don't specify how to set multiple attributes in environments. Would anyone know how to do this?
[2013-08-06 18:54:35 -0400] ggolin: i did say "please"
[2013-08-06 18:54:41 -0400] kryptek: lol..
[2013-08-06 18:54:48 -0400] aramus_: ggolin: i just joined, what did he say? O.o
[2013-08-06 18:54:58 -0400] kryptek: aramus_, it's basically just a hash of data
[2013-08-06 18:55:01 -0400] ggolin: kept asking the same question
[2013-08-06 18:55:22 -0400] kryptek: aramus_, default_attributes({})
[2013-08-06 18:56:06 -0400] aramus_: what do you mean?
[2013-08-06 18:56:19 -0400] aramus_: kryptek: the syntax doesn't show normal parenthesis
[2013-08-06 18:57:22 -0400] aramus_: kryptek: something like this? https://gist.github.com/joshualan/b797afa1b2c9973781f1
[2013-08-06 18:57:36 -0400] kryptek: you can omit parantheses if you like
[2013-08-06 18:57:45 -0400] kryptek: but you're missing identifiers at the top.. commenting on gist; sec
[2013-08-06 18:59:48 -0400] kryptek: Commented
[2013-08-06 19:00:29 -0400] aramus_: I see, thanks, kryptek. Opscode should really add that to the environment documentation, would be super helpful.
[2013-08-06 19:00:42 -0400] kryptek: aramus_, yw; surprised they don't have it on there
[2013-08-06 19:01:15 -0400] freerobby: I wrote a very simple ohai plugin, it seems to run on subsequent chef deploys but not the first one. Does anybody have an idea why? https://github.com/freerobby/chef-ohai-public_ip/blob/master/files/default/plugins/ohai-public_ip.rb
[2013-08-06 19:01:31 -0400] freerobby: I see "- re-run ohai and merge results into node attributes" in the log, but it doesn't appear to be re-running.
[2013-08-06 19:01:39 -0400] freerobby: Is that a bug in ohai?
[2013-08-06 19:01:41 -0400] aramus_: kryptek: so how did you figure this out? did you have to ask the guys here in IRC too?
[2013-08-06 19:01:52 -0400] kryptek: aramus_, Nah, been using chef for like 2 years now
[2013-08-06 19:02:18 -0400] kryptek: I came into an environment already set up when I was learning chef hehe
[2013-08-06 19:02:59 -0400] prefix: how would I go about finding the version of my chef server? I am not seeing anything on google indicative of an answer.
[2013-08-06 19:05:29 -0400] kryptek: prefix, Not even really sure
[2013-08-06 19:06:05 -0400] jtimberman: kryptek: it's not really a chef specific thing, that's Ruby syntax rules. :)
[2013-08-06 19:06:38 -0400] kryptek: jtimberman, reference to ommitting the () ?
[2013-08-06 19:06:49 -0400] jtimberman: right
[2013-08-06 19:06:55 -0400] kryptek: jtimberman, yeah :P just explaining to him it can be ommitted
[2013-08-06 19:06:58 -0400] jtimberman: :D
[2013-08-06 19:07:07 -0400] kryptek: How you doing? Still crossfitting?
[2013-08-06 19:07:41 -0400] prefix: kryptek on EL, use rpm -iv
[2013-08-06 19:07:51 -0400] prefix: oops, *-qi
[2013-08-06 19:07:56 -0400] jtimberman: kryptek: yup
[2013-08-06 19:08:08 -0400] kryptek: jtimberman, nice! :)
[2013-08-06 19:08:19 -0400] jtimberman: kryptek: today's WOD (all levels class one) http://bighorncrossfit.wordpress.com/2013/08/06/tuesday-44/
[2013-08-06 19:09:01 -0400] kryptek: that's a lot of thrusters
[2013-08-06 19:09:03 -0400] kryptek: lol
[2013-08-06 19:10:35 -0400] bean: jtimberman: theres a huge push for crossfit where I live. Our gym is apparently really successful in competition
[2013-08-06 19:11:11 -0400] iroller: Ohai Chefs. Anyone uses CI job for auto-incrementing the cookbook version + uploading the cookbook to Chef-server on each commit? I like the idea but I'm not sure how to provide the level of version bump in such case
[2013-08-06 19:13:07 -0400] joelnn: is there a way to include the stdout/stderr from 'bash' resources in the chef log?
[2013-08-06 19:26:00 -0400] mattray: joelnn: I think with -l debug it shows up
[2013-08-06 19:26:37 -0400] prefix: it's possible to connect multiple workstations to a single chef instance, correct?
[2013-08-06 19:28:52 -0400] prefix: also, is it possible for one workstation to access multiple chef servers?
[2013-08-06 19:29:27 -0400] joelnn: mattray: thanks but no luck with that, I had tried
[2013-08-06 19:30:52 -0400] stormerider: prefix: knife-block helps with the latter
[2013-08-06 19:31:16 -0400] jbz: prefix: Accessing chef servers using knife (the CLI client) is done using config files to specify which server and which credentials.  You can switch config files around manually, or use a toolyeah, as stormerider said. :-)
[2013-08-06 19:31:29 -0400] jbz: (by 'switch around' I mean just specify which on the command line)
[2013-08-06 19:32:07 -0400] jbz: knife cookbook list -c ../.chef/server-A-config.rb
[2013-08-06 19:32:11 -0400] jbz: (for example).
[2013-08-06 19:32:18 -0400] prefix: ah
[2013-08-06 19:32:18 -0400] prefix: ok
[2013-08-06 19:33:27 -0400] prefix: so, what would happen if two different workstations added a cookbook with the same name to a server?
[2013-08-06 19:34:14 -0400] pontiki: save version in metadata?
[2013-08-06 19:34:40 -0400] gleam: the second one would overwrite the first
[2013-08-06 19:35:03 -0400] prefix: pontiki gleam which answer is correct?
[2013-08-06 19:35:19 -0400] gleam: oh i thought that was you saying they had the same version in metadata
[2013-08-06 19:35:26 -0400] gleam: if they have the same version then that's what would happen
[2013-08-06 19:35:37 -0400] prefix: what if they have different versions?
[2013-08-06 19:35:47 -0400] gleam: diff versions they'll both exist and unless you specify it some other way the highest version will be what nodes get
[2013-08-06 19:35:54 -0400] prefix: ok
[2013-08-06 19:35:58 -0400] prefix: thanks
[2013-08-06 19:36:00 -0400] pontiki: crap, *same* version in metadata
[2013-08-06 19:36:23 -0400] pontiki: gleam figured out what i meant
[2013-08-06 19:41:59 -0400] prefix: are we talking about same cookbook version or same recipe version?
[2013-08-06 19:42:04 -0400] prefix: or does it matter?
[2013-08-06 19:43:02 -0400] joelnn: there is no such thing as a recipe version
[2013-08-06 19:43:06 -0400] prefix: ok
[2013-08-06 19:44:34 -0400] aramus_: Not sure but is chef supposed to act this way? In my environment, I defined a default attribute called ['attribute'] but I also have other attributes in a default attribute file ['attribute']['attr1']
[2013-08-06 19:45:39 -0400] aramus_: So apparently, chef will interpret node['attribute']['attr1'] first by interpreting node['attribute'] and then applying ['attr1'] to it's value.
[2013-08-06 19:46:29 -0400] aramus_: so if node['attribute'] => "hello", node['attribute']['attr1'] => "hello"['attr1'], which will then throw an error.
[2013-08-06 19:47:52 -0400] joelnn: aramus_: consider that attributes are serializable to json. node['attribute'] is either a string or a hash, can't be both
[2013-08-06 19:49:05 -0400] aramus_: joelnn: I would have thought that it would parse the whole expression before evaluating it .
[2013-08-06 19:49:35 -0400] joelnn: sure it does, but it still evaluates left-to-right :)
[2013-08-06 19:49:50 -0400] prefix: where are all the knife options documented?
[2013-08-06 19:50:52 -0400] prefix: http://docs.opscode.com/chef/knife.html!
[2013-08-06 19:54:19 -0400] cheffer: any chefspecers out there? I have few questions
[2013-08-06 20:21:21 -0400] techminer: Can anyone confirm if ftp.ruby-lang.org is down?  My rbenv cookbook is failing.and attempting to reach it through my browser fails.  The site is up but not the ftp downloads that I can see.
[2013-08-06 20:23:05 -0400] qhartman: techminer, works for me, I get  a mailman page
[2013-08-06 20:23:12 -0400] techminer: Nevermind.there status page explains it  http://www.ruby-lang.org/en/news/2013/08/06/status-issue/
[2013-08-06 20:24:24 -0400] techminer: qhartman:  the binary links are broken    ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p448.tar.bz2
[2013-08-06 20:46:13 -0400] gchristensen: if my LWRP does nothing but use existing resources, do I need to do anything other than def whyrun_supported? true end ?
[2013-08-06 20:46:17 -0400] stevefink: Is one supposed to edit attributes/default.rb directly when editing a third party cookbook? (I'm looking at the postgres cookbook right now)
[2013-08-06 20:46:32 -0400] gchristensen: stevefink: no
[2013-08-06 20:46:54 -0400] gchristensen: you could use a cookbook which defines the attributes, or set them as role or environment or node attributes.
[2013-08-06 20:47:33 -0400] stevefink: I'm just using the opscode cookbook for postgres and I'm trying to figure out where I edit my own options in such a listen address, etc
[2013-08-06 20:47:46 -0400] gchristensen: you could use a cookbook which defines the attributes, or set them as role or environment or node attributes.
[2013-08-06 20:49:13 -0400] iverson0881: hi, is it possible to set a very specific node to have a specific value for an attribute?
[2013-08-06 20:57:16 -0400] kryptek: iverson0881, maybe you can set: node['key'] = value if node.name == 'node name'
[2013-08-06 20:58:07 -0400] iverson0881: kryptek: yeah i was wondering if there's a better way than using if statements
[2013-08-06 20:58:35 -0400] iverson0881: is it possible to do this via chef tags maybe?
[2013-08-06 20:59:02 -0400] kryptek: Yeah, I don't think so.. unless you're using a data bag to dynamically load keys based off node names or something
[2013-08-06 21:00:01 -0400] gchristensen: iverson0881: instead of using node attributes?
[2013-08-06 21:05:02 -0400] stompyj: Is there is a best practice for syncing remote / third party cookbooks?
[2013-08-06 21:05:04 -0400] stompyj: librarian?
[2013-08-06 21:05:08 -0400] stompyj: (using chef solo)
[2013-08-06 21:05:38 -0400] gchristensen: stompyj: librarian or berkshelf
[2013-08-06 21:05:50 -0400] stompyj: gchristensen: danke!
[2013-08-06 21:06:01 -0400] gchristensen: surely
[2013-08-06 21:06:16 -0400] MrBIOS: Hi folks, has anyone here successfully completed a Chef 10 to 11 migration?
[2013-08-06 21:06:20 -0400] MrBIOS: I'm having a bitch of a time
[2013-08-06 21:06:41 -0400] gchristensen: MrBIOS: speaking of which, you ping'd me?
[2013-08-06 21:07:15 -0400] stompyj: MrBIOS: Hah! I'm going to go down that path myself
[2013-08-06 21:07:16 -0400] stompyj: this week
[2013-08-06 21:07:18 -0400] MrBIOS: gchristensen: I did, just was wondering how you were doing
[2013-08-06 21:07:22 -0400] stompyj: I had to pin to 10.18
[2013-08-06 21:07:24 -0400] stompyj: for now
[2013-08-06 21:07:32 -0400] MrBIOS: during the upload phase (to the chef 11 server) I'm getting:
[2013-08-06 21:07:32 -0400] MrBIOS: Updated clients/web-5.bright.com.json
[2013-08-06 21:07:33 -0400] MrBIOS: ERROR: JSON::ParserError: Unsupported `json_class` type 'Chef::WebUIUser'
[2013-08-06 21:07:54 -0400] gchristensen: MrBIOS: I'm doing well :) I'm wrangling my boss's hellish chef work. have been since I started
[2013-08-06 21:07:56 -0400] MrBIOS: when I grep for WebUIUser, I get nothing
[2013-08-06 21:09:07 -0400] stormerider: MrBIOS: i did upgrade, had no issues using knife-backup
[2013-08-06 21:09:45 -0400] MrBIOS: stormerider: did you follow a particular guide/how-to?
[2013-08-06 21:10:06 -0400] stormerider: istr there was a blog post on the opscode site at the time.. was a while back now.
[2013-08-06 21:10:33 -0400] MrBIOS: yeah, I'm probably following the same thing
[2013-08-06 21:10:56 -0400] MrBIOS: this one? http://www.opscode.com/blog/2013/03/12/5106/
[2013-08-06 21:11:24 -0400] MrBIOS: I've downloaded everything from the old server, but getting the "Unsupported `json_class` type 'Chef::WebUIUser'" when uploading to the Chef 11 server
[2013-08-06 21:11:25 -0400] stevefink: So a silly question again, if I'm using a third party cookbook, where is the best documentation to learn how to configure my own settings for it, etc? just using chef-solo for vagrant
[2013-08-06 21:12:16 -0400] ianco_: stevefink, the readme should have info, but browsing the source is always the way to go
[2013-08-06 21:12:51 -0400] stormerider: yeah, that's the one. didn't run into that error myself.
[2013-08-06 21:12:51 -0400] stevefink: ianco_: Hmm, I'm going through https://github.com/opscode-cookbooks/postgresql right now, just want to know where I add my own attributes and how I install both client+server
[2013-08-06 21:13:34 -0400] ianco_: stevefink: https://github.com/opscode-cookbooks/postgresql/blob/master/attributes/default.rb
[2013-08-06 21:13:42 -0400] ianco_: youll want to override the 'config' attrs
[2013-08-06 21:13:45 -0400] ianco_: for instance
[2013-08-06 21:14:00 -0400] ianco_: with whatever better suits your environment
[2013-08-06 21:14:01 -0400] stevefink: ah so I'll actually write my changes in default.rb
[2013-08-06 21:14:11 -0400] ianco_: oh, no, not normally
[2013-08-06 21:14:22 -0400] ianco_: youll want to override the attributes
[2013-08-06 21:14:27 -0400] stevefink: yeah :-) that's what I'm trying to understand, where do I override the attributes
[2013-08-06 21:14:35 -0400] stevefink: do I create a new file, where does it go, etc.. just the fundamentals
[2013-08-06 21:15:17 -0400] ianco_: stevefink, in vagrant, you can set chef.json to include node attribute overrides
[2013-08-06 21:15:57 -0400] stevefink: so it's there where I would set config parameters? interesting
[2013-08-06 21:18:22 -0400] ianco_: stevefink, you can override node attributes in recipes, in your roles, in environments, etc
[2013-08-06 21:18:42 -0400] ianco_: for starters, you can just set them in your Vagrantfile
[2013-08-06 21:18:44 -0400] ianco_: chef.json = { :mysql_password => "foo" }
[2013-08-06 21:18:46 -0400] ianco_: for example
[2013-08-06 21:19:05 -0400] stevefink: Yeah that's more or less what I'm looking for, that I can set them in my Vagrantfile vs in the third party code base
[2013-08-06 21:19:32 -0400] ianco_: right, yeah, you dont want to do that
[2013-08-06 21:19:57 -0400] stevefink: looks like chef.json is the answer and I think the example is right here https://github.com/opscode-cookbooks/postgresql#chef-solo-note
[2013-08-06 21:20:12 -0400] stompyj: WOW! Berkshelf is no joke
[2013-08-06 21:26:54 -0400] stompyj: One other question, do people generally have all their cookbooks in a single repo, or package the cookbooks that comprise a service with the service itself?
[2013-08-06 21:30:46 -0400] jbz: Keeping them with the service code seems to me to be a bit of an antipattern.  Changes to cookbooks and changes to app code aren't that tightly coupled, so it's handy to be able to make changes to one or the other without having to trigger full test cycles.  Also, many chef tools assume that the repository is a Chef-specific one, and might have trouble finding the cookbooks as subdirectories in a project repo.  This is fully IMO.
[2013-08-06 21:31:34 -0400] stompyj: jbz: thanks! We have them spliced out into their own repo, so I'll keep things as-is.
[2013-08-06 21:31:38 -0400] jtimberman: jbz: i disagree :)
[2013-08-06 21:31:45 -0400] stompyj: jtimberman: how come?
[2013-08-06 21:31:45 -0400] jbz: jtimberman:  Please educate me!
[2013-08-06 21:31:48 -0400] jtimberman: i think keeping the cookbook for deploying the app with the app is a good thing.
[2013-08-06 21:32:10 -0400] jbz: jtimberman is obviously the much much better answer here.
[2013-08-06 21:32:14 -0400] jtimberman: further, keep a chef-repo for the app in the app source, w/ the requisite data bag/role stuff.
[2013-08-06 21:32:19 -0400] jtimberman: hah.
[2013-08-06 21:32:24 -0400] jtimberman: it's just an idea :)
[2013-08-06 21:32:31 -0400] jbz: jtimberman: I think I'm coming at this as an Op more than a dev or app-centric admin
[2013-08-06 21:32:38 -0400] jbz: I assume I will have many many projects/apps to deal with
[2013-08-06 21:32:45 -0400] jbz: and I want to simplify my own handling. :-)
[2013-08-06 21:32:49 -0400] jtimberman: sure even operationally it makes sense to keep all the code related to managing the app together.
[2013-08-06 21:33:07 -0400] jbz: Also, when people say to me 'chef cookbooks' I tend to mostly think about infrastructure stuff
[2013-08-06 21:33:11 -0400] jtimberman: if you ever used capistrano to deploy a rails app, the pattern here is evident.
[2013-08-06 21:33:17 -0400] qhartman: fwiw, I favor the independent chef-repo also. The idea of some of our devs getting into the automation code terrifies me.
[2013-08-06 21:33:27 -0400] jbz: qhartman++
[2013-08-06 21:33:28 -0400] jtimberman: why?
[2013-08-06 21:33:39 -0400] jtimberman: let them write the automation code for the application code.
[2013-08-06 21:33:43 -0400] qhartman: well, mostly because if it breaks, it's my job to pick up the pieces
[2013-08-06 21:33:58 -0400] jtimberman: i'm not suggesting that things like, users, postfix, dns, etc is in there
[2013-08-06 21:34:00 -0400] mattupstate: is there any good examples of how to use the callbacks with the deploy_revision and application providers?
[2013-08-06 21:34:13 -0400] jtimberman: qhartman: thats why you make it their job to pick up those pieces :)
[2013-08-06 21:34:17 -0400] qhartman: and many of them are less then rigorous when it comes to things that aren't "real software".
[2013-08-06 21:34:20 -0400] jbz: jtimberman: Yeah, that's what I think when people tell me 'cookbooks.'
[2013-08-06 21:34:20 -0400] mattupstate: none of my callbacks seem to get called and thus can't symlink
[2013-08-06 21:34:38 -0400] jbz: Sure, if there's a cookbook to deploy a particular app which just includes other cookbooks, *that* cookbook can live in the app repo, yes yes.
[2013-08-06 21:34:53 -0400] qhartman: jtimberman, if I could make that fly, I totally would
[2013-08-06 21:35:01 -0400] jtimberman: make a case for it :)
[2013-08-06 21:35:18 -0400] stompyj: jbz: for what it's worth, that was our thinking too. we just have one repo with all cookbooks, and some custom scripts I wrote to fire up a new box from scratch.  that practice seemed orthogonal to deploying application code for that service.  That said, with Berkshelf, it looks like you'd just need a Berkfile for each repo, which is why I had contemplated moving back
[2013-08-06 21:35:31 -0400] mattupstate: i'd just like to render a config file during the `before_symlink` callback
[2013-08-06 21:36:45 -0400] mattupstate: and they just aren't happening...
[2013-08-06 21:36:47 -0400] jbz: stompyj: In my last job, we had implemented a Berkshelf-based workflow (well, other, smarter people implemented it and I used it).  I agree that in that case, separate repos per cookbook make sense.
[2013-08-06 21:36:56 -0400] jbz: But not linked to app code.
[2013-08-06 21:37:03 -0400] qhartman: The other big reason is that most of them don't really understand the ops side of things, and don't have any interest in learning it.
[2013-08-06 21:37:05 -0400] jbz: (er, as in, I'm not making statements about that case).
[2013-08-06 21:38:06 -0400] qhartman: ultimately though, I don't think there's a right answer, it's just whatever works best for your org / process
[2013-08-06 21:38:37 -0400] stompyj: yeah
[2013-08-06 21:41:56 -0400] dgarstang: Is there a way to do a conditional recipe include in chef?
[2013-08-06 21:42:11 -0400] gchristensen: dgarstang: you can do if ... include_recipe end
[2013-08-06 21:42:17 -0400] gchristensen: but it probably won't do what you think
[2013-08-06 21:42:29 -0400] gchristensen: I guess it depends on what conditions you want to use
[2013-08-06 21:42:43 -0400] dgarstang: I'm using the users cookbook from opscode. Works fine on the server. On my chef-solo, it skips over the users module "This recipe uses search. Chef Solo does not support search unless you install the chef-solo-search cookbook" ... so I wanted to only include that recipe on the solo side
[2013-08-06 21:43:31 -0400] dgarstang: or... I suppose I could include it everywhere. Not sure if it's safe to use on server though
[2013-08-06 21:45:26 -0400] dgarstang: gchristensen guess Ill just include everywhere and see if it blows up
[2013-08-06 21:57:20 -0400] ranjib: fujin, you are coming to summit ?
[2013-08-06 22:16:25 -0400] jhulten: For those using vagrant, how are you determining if you are in a vagrant vm or a 'real' box based on node / ohai data?
[2013-08-06 22:18:12 -0400] gchristensen: I have an issue with an lwrp which runs ssh_opts << "something here", and if I call the lwrp three times it ends up with ssh_opts equalling ["something here", "something here", "something here"]. I'm setting ssh_opts from new_resource. is this intended behaviour, and is there a way to safely alter these variables within my scope?
[2013-08-06 22:27:31 -0400] qhartman: jhulten, There isn't a super relaible way to do it. for 99% of your stuff, it shouldn't matter. For the few things where it does, I ended up setting an attribute in the environment that specified that env was running on vagrant and used that as a switch in the cookbook logic
[2013-08-06 22:27:53 -0400] qhartman: (At least, there wasn't a real reliable way to do when I was working on such things about 6 months ago)
[2013-08-06 22:29:19 -0400] gchristensen: there isn't. because someone could use vagrant with vmware, which is a real production-ready method of deployingf
[2013-08-06 22:34:37 -0400] qhartman: yeah, whatever you did would have to be provider specific, and would be far from foolproof
[2013-08-06 22:35:19 -0400] qhartman: I ended up deciding it wasn't worth the effort to try to make it smart, but I only had two days for the project I was working on so that influenced my decision a bit
[2013-08-06 22:36:10 -0400] gchristensen: jhulten: I might do something similar to what you're wanting: I have a `datacenter` ohai plugin which gets placed, and detects what its running based on various network devices which are around. if itfails to identify the DC, it says its in the "not-identified" datacenter.
[2013-08-06 22:36:42 -0400] gchristensen: but this is custom to my deployments
[2013-08-06 22:42:34 -0400] enigmabomb: Hello chaffers. Google is giving me a hard time with finding docs for how I include mcrypt in my php recipe. There is some suggestion that a recipe exists, though it doesn't seem to work on my system.
[2013-08-06 22:42:45 -0400] enigmabomb: php::mcrypt
[2013-08-06 22:43:42 -0400] jmickle: is it possible to log to chef logger from templates?
[2013-08-06 22:44:23 -0400] grizo: anyone gotten knife vcloud to work successfully with vmware's vcloud hybrid service?
[2013-08-06 22:44:36 -0400] coderanger: enigmabomb: I don't see any such recipe in the opscode PHP cookbook, but there might be other cookbooks out there also named php
[2013-08-06 22:44:53 -0400] coderanger: jmickle: <% Chef::Log.debug('asdf') %>
[2013-08-06 22:44:55 -0400] enigmabomb: coderanger: Ok Im not crazy. thanks.
[2013-08-06 22:45:02 -0400] jmickle: thank you coderanger
[2013-08-06 22:45:13 -0400] jmickle: found a massive bug in the current community nagios cookbook regarding templates
[2013-08-06 22:45:21 -0400] grizo: knife times out and vcloud director shows non-existing VCD entity network
[2013-08-06 22:45:24 -0400] jmickle: but trying to find which portion of this giant nested IF loop its in
[2013-08-06 22:57:50 -0400] gchristensen: jmickle: what bug did you find?
[2013-08-06 22:58:16 -0400] jmickle: gchristensen: nagios_services data bag is not being evaluated properly
[2013-08-06 22:58:27 -0400] gchristensen: aye
[2013-08-06 22:58:39 -0400] jmickle: if a data bag service contains 2 or more host groups or contains negated nagios groups
[2013-08-06 22:58:47 -0400] jmickle: it does not populate or even run the template config for that block
[2013-08-06 22:59:01 -0400] jmickle: which results in services not being setup
[2013-08-06 23:00:58 -0400] Sauraus: Is the cookbook_file provider 'line ending' aware?
[2013-08-06 23:01:32 -0400] Sauraus: ie. will it transform line endings to the correct format?
[2013-08-06 23:02:07 -0400] jmickle: gchristensen: are you working on the nagios recipe?
[2013-08-06 23:03:28 -0400] gchristensen: jmickle: no, but I use it fairly extensively and I haven't experience this
[2013-08-06 23:03:37 -0400] jmickle: which version>
[2013-08-06 23:03:46 -0400] jmickle: this didn't surface until i upgraded to the latest 4.1 +
[2013-08-06 23:03:59 -0400] jmickle: with the new logic for creating the services
[2013-08-06 23:03:59 -0400] gchristensen: that said, I haven't had your same use case, and I'm not surprised by the bug.
[2013-08-06 23:04:29 -0400] jmickle: yeah mine is a bit of a unique case we run about 4 nagios servers all running in conjunction with each other
[2013-08-06 23:04:32 -0400] jmickle: 3 slaves and 1 master
[2013-08-06 23:04:33 -0400] jmickle: :-P
[2013-08-06 23:04:35 -0400] gchristensen: nice
[2013-08-06 23:04:45 -0400] gchristensen: I haven't needed / had the budget for that yet :P
[2013-08-06 23:04:48 -0400] jmickle: ah
[2013-08-06 23:05:01 -0400] jmickle: yeah we grew to 200+ servers in multi region here over the last 6 months
[2013-08-06 23:05:12 -0400] jmickle: so we have had to do some crazy things lately
[2013-08-06 23:05:24 -0400] jmickle: 200+ per region*
[2013-08-06 23:05:33 -0400] gchristensen: very nice
[2013-08-06 23:05:46 -0400] jmickle: maybe a little less, hard to keep track sometimes
[2013-08-06 23:05:47 -0400] jmickle: haha
[2013-08-06 23:07:57 -0400] qhartman: jmickle, I've had to do some wacky stuff with tenagios cookbook to make it work for our installations too
[2013-08-06 23:08:09 -0400] jmickle: yeah?
[2013-08-06 23:08:14 -0400] qhartman: Sounds like you're on AWS?
[2013-08-06 23:08:16 -0400] jmickle: care to share any of your fun?
[2013-08-06 23:08:19 -0400] jmickle: hehe yeah aws
[2013-08-06 23:08:28 -0400] qhartman: yeah, us too
[2013-08-06 23:08:59 -0400] qhartman: most of my stuff was just figuring out how to get stuff to configure correctly with the custom plugins and stuff we use
[2013-08-06 23:09:10 -0400] qhartman: mostly monitoring DB replication and our custom services and whatnot
[2013-08-06 23:09:23 -0400] jmickle: ahh
[2013-08-06 23:09:26 -0400] jmickle: yeah we did a lot of that too
[2013-08-06 23:09:34 -0400] jmickle: the recent project is we are utilizing pagerduty
[2013-08-06 23:09:39 -0400] jmickle: or trying to at least
[2013-08-06 23:09:42 -0400] jmickle: but with service escalations
[2013-08-06 23:09:45 -0400] qhartman: qhat kind of instance types are you running nagios on?
[2013-08-06 23:10:02 -0400] jmickle: i run an m1.large for all
[2013-08-06 23:10:04 -0400] jmickle: instance store
[2013-08-06 23:10:11 -0400] jmickle: but i don't use EBS anywhere in my infrastructure
[2013-08-06 23:10:13 -0400] jmickle: too risky
[2013-08-06 23:10:14 -0400] qhartman: yeah, I've looked at getting escalations working, and decided I needed to get more booze before tackliong that
[2013-08-06 23:10:31 -0400] jmickle: yeah I've been digging through the nagios and pagerduty code for the better part of a week
[2013-08-06 23:10:43 -0400] jmickle: trying to figure it out and modifying the recipe to get it working
[2013-08-06 23:10:45 -0400] qhartman: really? wow, what do you do if you have to migrate a machine to s different node?
[2013-08-06 23:11:09 -0400] jmickle: we don't store any data on the instances, all of my instances can be trashed and restored in less then 5 min
[2013-08-06 23:11:14 -0400] qhartman: when did you decide you needed to do the master /salve split?
[2013-08-06 23:11:22 -0400] jmickle: we can recover from a full scale region outage in about 15 min
[2013-08-06 23:11:30 -0400] qhartman: ah, gotcha, so you don't do any DBs or anything like that out there?
[2013-08-06 23:11:34 -0400] jmickle: we use redis
[2013-08-06 23:11:39 -0400] jmickle: for most of our data stores
[2013-08-06 23:11:48 -0400] qhartman: ah, so you're replicating that cross-region then?
[2013-08-06 23:11:54 -0400] jmickle: and i we have some complex backup processing happening
[2013-08-06 23:11:59 -0400] qhartman: heh
[2013-08-06 23:12:04 -0400] jmickle: and we are in phases of rolling out redis sentinel
[2013-08-06 23:12:14 -0400] qhartman: yeah, I have that project coming up too
[2013-08-06 23:12:20 -0400] qhartman: seems kinda awesome
[2013-08-06 23:12:32 -0400] jmickle: yeah we have some complex replication and backup policies going on
[2013-08-06 23:12:58 -0400] jmickle: i do have to admit the redis infrastructure is my most scary portion
[2013-08-06 23:12:59 -0400] jmickle: hehe
[2013-08-06 23:13:10 -0400] qhartman: yeah, I really like redis though
[2013-08-06 23:13:15 -0400] jmickle: same here
[2013-08-06 23:13:31 -0400] jmickle: great solution it just needs a bit of love on the HA side
[2013-08-06 23:13:36 -0400] qhartman: but I have like four layers of alerting on the redis boxes for watching high water marks on the RAM usage
[2013-08-06 23:13:41 -0400] qhartman: totally
[2013-08-06 23:13:44 -0400] jmickle: yeah
[2013-08-06 23:13:44 -0400] jmickle: haha
[2013-08-06 23:13:45 -0400] jmickle: so do we
[2013-08-06 23:14:02 -0400] jmickle: we did a whole extension of the collectd cook book and we pipe a lot of metrics to librato
[2013-08-06 23:14:07 -0400] jmickle: I'm waiting on miah to merge them in
[2013-08-06 23:14:15 -0400] qhartman: interesting
[2013-08-06 23:14:24 -0400] qhartman: never used librato
[2013-08-06 23:14:45 -0400] qhartman: oh! I've looked at this before
[2013-08-06 23:14:48 -0400] jmickle: its essentially hosted graphite
[2013-08-06 23:15:02 -0400] qhartman: yeah,
[2013-08-06 23:15:02 -0400] jmickle: its got a nice UI
[2013-08-06 23:15:05 -0400] jmickle: its cheap
[2013-08-06 23:15:12 -0400] jmickle: and doesn't require me to worry about carbon DB's
[2013-08-06 23:15:13 -0400] jmickle: :-P
[2013-08-06 23:15:17 -0400] jmickle: that alone is worth it to me
[2013-08-06 23:15:17 -0400] qhartman: hehe
[2013-08-06 23:15:32 -0400] qhartman: yeah, oh carbon, why can't you be just a little bit better?
[2013-08-06 23:15:42 -0400] jmickle: haha
[2013-08-06 23:15:53 -0400] jmickle: why must you make me specify how long you will live before i ever even know.....
[2013-08-06 23:15:55 -0400] jmickle: :-P
[2013-08-06 23:15:58 -0400] qhartman: hehe
[2013-08-06 23:16:00 -0400] qhartman: also that
[2013-08-06 23:16:36 -0400] jmickle: exactly why i would rather pay
[2013-08-06 23:16:38 -0400] jmickle: then deal with it
[2013-08-06 23:16:42 -0400] qhartman: a few months ago I had to put together this horrible one-liner to go through and resize a bunch of our whisper files on the fly because we were running out of space
[2013-08-06 23:16:43 -0400] jmickle: i got enough infrastructure to worry about
[2013-08-06 23:16:47 -0400] qhartman: it was "fun"
[2013-08-06 23:16:51 -0400] jmickle: haha
[2013-08-06 23:16:56 -0400] jmickle: i don't envy you on that
[2013-08-06 23:16:57 -0400] jmickle: haha
[2013-08-06 23:17:23 -0400] jmickle: too many moving parts
[2013-08-06 23:17:25 -0400] qhartman: and it was a because our devs made this bug that made it recursively create these metric files fo stuff that didn't actually exist
[2013-08-06 23:17:32 -0400] jmickle: ouch
[2013-08-06 23:17:34 -0400] qhartman: so it just kept making new files
[2013-08-06 23:17:38 -0400] jmickle: like i said dude librato
[2013-08-06 23:17:38 -0400] qhartman: it was awesome
[2013-08-06 23:17:45 -0400] jmickle: the 100 bucks or so you spend a month to not think about it
[2013-08-06 23:17:48 -0400] jmickle: will be well worth it
[2013-08-06 23:18:00 -0400] qhartman: Yeah, I may have to pitch that
[2013-08-06 23:18:10 -0400] qhartman: we spend more than that on the graphite AWS instances already
[2013-08-06 23:18:26 -0400] qhartman: the one rub will be the data security though, super paranoid about that
[2013-08-06 23:19:18 -0400] timewarrior: Hi Everyone, had a quick question.. While deploying I am notifying my service to restart. But it is not reloading the configuration. What is the best way to enforce reload along with restart. Am using upstart for service
[2013-08-06 23:19:23 -0400] timewarrior: thanks :)
[2013-08-06 23:19:28 -0400] jmickle: yeah qhartman that was my case too
[2013-08-06 23:19:29 -0400] qhartman: oh, ok, actually, with the granularity we need, that will get expensive fast
[2013-08-06 23:20:37 -0400] jmickle: qhartman: we are sending here about 3 million metrics every 4 hours and our bill is roughly 200 a month
[2013-08-06 23:20:41 -0400] jmickle: still cheaper then an m1.large
[2013-08-06 23:21:45 -0400] qhartman: jmickle, hm, based on https://metrics.librato.com/pricing/grid and my WAG of what we're tracking we'd be in the $2000 / month ballpark
[2013-08-06 23:22:02 -0400] jmickle: yeah id contact them and see
[2013-08-06 23:22:17 -0400] qhartman: assuming I'm understanding their definition of "metric" and "data sources" correctly
[2013-08-06 23:22:25 -0400] jmickle: true that thing looks a little sketchy
[2013-08-06 23:22:38 -0400] jmickle: I'm looking at my account page and thats the metrics i just gave you
[2013-08-06 23:23:02 -0400] qhartman: hm, well I'll look at it harder
[2013-08-06 23:23:10 -0400] timewarrior: anyone.. knows how to reload and restart the service on deploy :)
[2013-08-06 23:23:23 -0400] jmickle: but i mean generally idk about you guys but i figure the cost of admin overhead + time to setup + instance size i think its safe to say I'm willing to spend at least 1000 a month on it
[2013-08-06 23:23:23 -0400] jmickle: haha
[2013-08-06 23:24:05 -0400] qhartman: jmickle, yeah
[2013-08-06 23:24:16 -0400] qhartman: timewarrior, what service specifically?
[2013-08-06 23:24:30 -0400] timewarrior: its a custom service that I have written on upstart
[2013-08-06 23:24:34 -0400] qhartman: can you pastebin / gist the code that's not doing what you think it should be?
[2013-08-06 23:24:42 -0400] timewarrior: sure
[2013-08-06 23:25:38 -0400] timewarrior: its here
[2013-08-06 23:25:39 -0400] timewarrior: https://gist.github.com/anonymous/6169774
[2013-08-06 23:26:10 -0400] timewarrior: restart is not reloading the config
[2013-08-06 23:27:10 -0400] qhartman: and when you restart b hand it behaves as expected?
[2013-08-06 23:27:28 -0400] timewarrior: upstart restart won't load config
[2013-08-06 23:27:34 -0400] timewarrior: its needs start and stop
[2013-08-06 23:27:41 -0400] timewarrior: or reload and restart
[2013-08-06 23:27:49 -0400] timewarrior: was wondering how I can do it with reploy
[2013-08-06 23:28:11 -0400] timewarrior: if I put two notifies one after the other, are the blocking, as in will restart wait till reload is done
[2013-08-06 23:29:06 -0400] kisoku: anyone have any tips on how to do mocked nodes entries with test-kitchen and chef-zero
[2013-08-06 23:29:21 -0400] qhartman: If you change your service definition to say that it doesn't cupport restart, chef will issue a stop and start, that might get around your problem
[2013-08-06 23:29:53 -0400] timewarrior: ok.. so if I notify restart and say service doesn't support restart. chef is going to do stop and start
[2013-08-06 23:30:05 -0400] jmickle: <% unless service['hostgroup_name'].nil? || !(@hostgroups.include?(service['hostgroup_name']) || @search_hostgroups.include?(service['hostgroup_name']) || service['hostgroup_name'] == "all") -%>
[2013-08-06 23:30:07 -0400] qhartman: not sure what happens with multiple notifies entries
[2013-08-06 23:30:08 -0400] jmickle: found the line in nagios
[2013-08-06 23:30:10 -0400] jmickle: thats failing
[2013-08-06 23:30:16 -0400] jmickle: #codeFail!
[2013-08-06 23:30:22 -0400] jmickle: don't do double negatives in code
[2013-08-06 23:30:22 -0400] qhartman: timewarrior, yes, that is what it will do.
[2013-08-06 23:30:22 -0400] jmickle: haha
[2013-08-06 23:30:29 -0400] timewarrior: ok cool..
[2013-08-06 23:30:41 -0400] timewarrior: if I put a reload notify in template, when does that get executed
[2013-08-06 23:31:02 -0400] qhartman: jmickle, hah awesome, yeah, the stuff if this nagios book is kinda convoluted.
[2013-08-06 23:31:23 -0400] qhartman: timewarrior, that should get triggered any time the template changes
[2013-08-06 23:32:09 -0400] jmickle: dude qhartman I'm having a hard time even interpreting wtf this line is doin
[2013-08-06 23:33:15 -0400] qhartman: yeah, it will take some doing to take it apart
[2013-08-06 23:33:29 -0400] jmickle: ruby unless abuse
[2013-08-06 23:33:29 -0400] jmickle: haha
[2013-08-06 23:33:34 -0400] qhartman: looks like a bunch of it was tacked together to handle unset stuff
[2013-08-06 23:33:42 -0400] jmickle: where is coderanger he is epic at deciphering crazy stuff like this
[2013-08-06 23:33:46 -0400] qhartman: I can just imagine how that line grew....
[2013-08-06 23:34:11 -0400] qhartman: ok, so if all the crap is false, hostgroup is alll
[2013-08-06 23:34:44 -0400] timewarrior: but will that reload happen only when the chef-client is running or even when its not running
[2013-08-06 23:35:02 -0400] qhartman: timewarrior, only when chef-client runs
[2013-08-06 23:35:32 -0400] timewarrior: ok.. cool.. thanks
[2013-08-06 23:35:36 -0400] timewarrior: thanks a lot :)
[2013-08-06 23:35:40 -0400] qhartman: sure
[2013-08-06 23:36:34 -0400] qhartman: yeah, I'm going to need awhiteboard to break that apart
[2013-08-06 23:38:26 -0400] jmickle: ha
[2013-08-06 23:38:31 -0400] jmickle: yeah I'm hurting here
[2013-08-06 23:38:46 -0400] jmickle: why the heck would anyone do this
[2013-08-06 23:39:04 -0400] jmickle: who committed this
[2013-08-06 23:39:29 -0400] qhartman: what file is that in?
[2013-08-06 23:39:56 -0400] qhartman: looks like template? doesn't look like it's in the version of the cookbook we're using
[2013-08-06 23:41:15 -0400] jmickle: services.cfg.erb
[2013-08-06 23:41:38 -0400] jmickle: https://github.com/opscode-cookbooks/nagios/blob/master/templates/default/services.cfg.erb#L17
[2013-08-06 23:41:52 -0400] jmickle: ahhhhh jtimberman
[2013-08-06 23:41:56 -0400] jmickle: committed this change
[2013-08-06 23:41:57 -0400] jmickle: ahhh
[2013-08-06 23:42:35 -0400] qhartman: yeah, the version of the cookbook we branched off of doesn't have that
[2013-08-06 23:42:43 -0400] jmickle: you must be version 3.x
[2013-08-06 23:42:44 -0400] jmickle: right?
[2013-08-06 23:42:53 -0400] qhartman: ish
[2013-08-06 23:42:56 -0400] qhartman: It's a long story.....
[2013-08-06 23:42:59 -0400] jmickle: check your metadata
[2013-08-06 23:42:59 -0400] jmickle: haha
[2013-08-06 23:43:40 -0400] qhartman: Let's just say we're now living with the consequences of questionable choices made by people who no longer work here.
[2013-08-06 23:43:57 -0400] jmickle: haha
[2013-08-06 23:43:59 -0400] jmickle: that happens
[2013-08-06 23:48:08 -0400] timewarrior: @qhartman :restart notify without restart support didn't work. So put one notify for stop and another notify for start
[2013-08-06 23:52:28 -0400] qhartman: timewarrior, huh. Odd that didn't work. Howabout the double-notifies?
[2013-08-06 23:53:40 -0400] qhartman: also, this has some stuff in it that might help if that doesn't work the way you expect: http://docs.opscode.com/resource_service.html
[2013-08-06 23:53:55 -0400] qhartman: in particular "restart_command" attribute
[2013-08-06 23:54:31 -0400] qhartman: hm " if :restart is not specified, the chef-client will attempt to stop and then start a service." that really should be doing what I thought
[2013-08-06 23:57:36 -0400] timewarrior: maybe what it means is that if I do not notify restart it will call stop and start
[2013-08-06 23:58:04 -0400] qhartman: no, that snippet was right from the "supports" section of the service atter
[2013-08-06 23:59:07 -0400] timewarrior: it didn't work :(
[2013-08-06 23:59:21 -0400] timewarrior: using separate notifies for now
[2013-08-06 23:59:31 -0400] qhartman: weird, well, good luck!
[2013-08-06 23:59:38 -0400] timewarrior: thanks :)
