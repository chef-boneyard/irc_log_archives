[2013-08-29 00:00:13 -0400] rrrob: buildsci: with private chef server, do you get a validator key for a specific org? it is not a global validator like with open source chef server right?
[2013-08-29 00:00:39 -0400] martin_work: anyone using vim and setting the filetype to chef in an interesting way? having a hard time figuring out how to get it to set to chef instead of ruby.
[2013-08-29 00:03:20 -0400] buildscientist: rrrob: no you get a validator key for each environment - an organization is made up of many environments e.g. 1 org : many environments
[2013-08-29 00:07:44 -0400] rrrob: buildsci: hmmm when you say environment you mean the chef environment object, like one for _default and different one for other env objects?
[2013-08-29 00:08:27 -0400] buildscientist: rrrob: yes
[2013-08-29 00:09:12 -0400] shthap3ns: hello everyone!
[2013-08-29 00:09:31 -0400] shthap3ns: does anyone know if it's possible to get the private IP address of a node?
[2013-08-29 00:09:33 -0400] rrrob: buildsci: that is pretty nice! you can do that with the open source server too?
[2013-08-29 00:10:56 -0400] mveitas: shthap3ns: are you talking AWS?
[2013-08-29 00:11:15 -0400] shthap3ns: mveitas: linode
[2013-08-29 00:11:36 -0400] shthap3ns: i want to get it during a recipe run though
[2013-08-29 00:12:11 -0400] shthap3ns: i scanned the node's attributes using "knife node show -l" but couldn't find a private IP
[2013-08-29 00:14:59 -0400] shthap3ns: but when i created the node i saw the server's private ip so i know it's capable of getting it somehow, right?
[2013-08-29 00:23:47 -0400] rrrob: shthap3ns: do you see a private ip when you run ohai on the node?
[2013-08-29 00:26:34 -0400] shthap3ns: rrrob: i don't see it. but i can see it from my linode dashboard
[2013-08-29 00:28:13 -0400] shthap3ns: i'm looking at [network][interfaces][eth0]
[2013-08-29 00:28:36 -0400] rrrob: shthap3ns: i dont know linode, but maybe you can run some script within your recipe and get that way somehow
[2013-08-29 01:22:32 -0400] hasues: I have been following these instructions:
[2013-08-29 01:22:37 -0400] hasues: https://learnchef.opscode.com/quickstart/workstation-setup/#linux
[2013-08-29 01:22:49 -0400] hasues: And when I attempt to install chef as a gem it fails
[2013-08-29 01:22:59 -0400] hasues: ERROR:  Loading command: install (LoadError)
[2013-08-29 01:23:06 -0400] hasues: says it can't load zlib
[2013-08-29 01:24:25 -0400] hasues: hm, maybe it is zlib-devel
[2013-08-29 01:43:14 -0400] djstunami: So, does anyone know the command I can put in a recipe to force a chef-client daemon restart?  I'm trying to migrate chef hosts from one chef server to another, and created a recipe to update the chef_server_url in /etc/chef/client.rb but since the daemon is using the old chef_server_url it won't convert until I manually HUP it.
[2013-08-29 01:43:46 -0400] gchristensen: djstunami: I know the omnibus-updater cookbook raises an exception, forcing an immediate exit
[2013-08-29 01:44:04 -0400] djstunami: ha! what a fantastic hack
[2013-08-29 01:44:18 -0400] djstunami: thanks gchristensen!
[2013-08-29 01:44:24 -0400] gchristensen: surely!
[2013-08-29 02:48:55 -0400] hasues: On this page: http://docs.opscode.com/install_workstation.html, on step 3 of create the .chef directory, is that supposed to be echo .chef >> .gitignore ?
[2013-08-29 02:59:42 -0400] hasues: i'll post tomorrow when people are awake.
[2013-08-29 03:00:55 -0400] gchristensen: hasues: yes it is
[2013-08-29 03:01:12 -0400] hasues: oh, hello, okay.
[2013-08-29 03:02:59 -0400] hasues: gchristensen: I'm a bit lost.  I made a directory here /root/chef-repo/.chef
[2013-08-29 03:03:08 -0400] gchristensen: okay
[2013-08-29 03:03:11 -0400] hasues: gchristensen: I then ran knife configure --initial
[2013-08-29 03:03:35 -0400] hasues: And it is asking if I want to configure /root/.chef, should I say /root/chef-repo/.chef instead?
[2013-08-29 03:04:24 -0400] gchristensen: heh, that is confusing. so it recommends you keep your user stuff in /root/.chef, and then repo-specific stuff in repo/.chef, but nothing private should be stored in the repo (like the key0S
[2013-08-29 03:04:55 -0400] hasues: okay
[2013-08-29 03:07:38 -0400] hasues: so the /root/.gitconfig should contain which .chef?  Or by having ".chef" in it, does it automatically refer to /root/chef-repo/.chef?
[2013-08-29 03:09:11 -0400] hasues: gchristensen: Also, what is "the existing admin name"?
[2013-08-29 03:09:55 -0400] gchristensen: hasues: I recommend posting tomorrow when more people are awake :) I don't really have the mind for this right now, sorry
[2013-08-29 03:10:12 -0400] hasues: gchristensen: that's fine.  thanks anyway.
[2013-08-29 03:21:13 -0400] cwilkes: Hi, I'm using chef to install a webapp that depends on tomcat.  I don't want *tomcat* to start up but the default recipe's action is :enable, :start.  Is there a way to override that?
[2013-08-29 03:36:54 -0400] rafaelmagu: From Ted: https://twitter.com/ActionStep/status/372925442182762496
[2013-08-29 03:45:16 -0400] rafaelmagu: Whoops, wrong channel
[2013-08-29 03:45:17 -0400] rafaelmagu: hahaha
[2013-08-29 03:45:54 -0400] pontiki: aww, you say that like we don't care
[2013-08-29 03:52:11 -0400] awc737: why do berks cookbooks need thorfile
[2013-08-29 03:52:31 -0400] awc737: and why do they have vagrantfiles
[2013-08-29 04:03:18 -0400] douglaswth: awc737: I don't think they necessarily need them, they are just useful to have
[2013-08-29 04:03:56 -0400] awc737: hmm, can't imagine what a vagrantfile acomplishes within a cookbook
[2013-08-29 04:04:02 -0400] awc737: it looks exactly like the default vagrantfile
[2013-08-29 04:04:08 -0400] awc737: specifying a box, ip, etc...
[2013-08-29 04:25:39 -0400] flipsomebits: this maybe an incredibly dumb question, can you run the workstation on the same box as the open chef server?
[2013-08-29 04:26:54 -0400] n1ko: flipsomebits: what do you mean by "the workstation"
[2013-08-29 04:27:09 -0400] n1ko: do you mean can you run chef-server software on the same machine you are developing? Then yes
[2013-08-29 04:27:23 -0400] n1ko: but for such purposes you should use either chef-solo or chef-zero
[2013-08-29 04:28:07 -0400] flipsomebits: thanks
[2013-08-29 04:29:40 -0400] flipsomebits: I was just trying to figure out if there would be conflicts.  As you can tell I have no idea what I'm doing, just trying to sift through the documentation and figure it out.  I was going to throw the chef server on a VPS and use it to provision other VPS and what not.
[2013-08-29 04:30:30 -0400] n1ko: yes, and thats exactly how you should do it
[2013-08-29 04:30:48 -0400] n1ko: but for developing purposes you dont need(or want) a real remote server
[2013-08-29 04:31:01 -0400] n1ko: chef-zero is in-memory chef-server for developing
[2013-08-29 04:31:14 -0400] flipsomebits: Ok, cool.  I'm tracking now.
[2013-08-29 04:31:19 -0400] n1ko: when you have verified that your stuff works deploy to the real server (and via that to the real production machines)
[2013-08-29 04:32:28 -0400] flipsomebits: thanks again for the clarification.  I'm sure I'll be back if I run into any problems!
[2013-08-29 04:32:51 -0400] n1ko: sure, np :)
[2013-08-29 05:29:41 -0400] douglaswth: awc737: it provides an easy way to develop and test the cookbook
[2013-08-29 05:29:51 -0400] awc737: oh ok
[2013-08-29 05:30:00 -0400] awc737: vagrant up on the cookbook?
[2013-08-29 05:30:44 -0400] douglaswth: yeah, by default it will have the default recipe for the cookbook
[2013-08-29 07:27:24 -0400] abrkn: "10.0.1.110 Running 'configure' for libxml2 2.8.0... ERROR, review 'tmp//ports/libxml2/2.8.0/configure.log' to see what happened." <- where? happened during install of of the "chef-elb" cookbook
[2013-08-29 07:50:53 -0400] jensnorr: Is it normal to have a delay of about 5 minutes before updates to nodes is reflected in search? Running open source chef
[2013-08-29 07:58:34 -0400] ProfFalken: morning all, anyone in here doing code coverage of chef recipes using Sonar?
[2013-08-29 08:44:17 -0400] ichilton: I want a file in my chef-repo which will create an encrypted databag, but obviously don't want the secret details in
[2013-08-29 08:44:34 -0400] ichilton: is there a way I can check something into the repo with $ENV['myapikey'] etc in?
[2013-08-29 08:44:40 -0400] ichilton: like databags from erb
[2013-08-29 08:45:17 -0400] ichilton: then when I want to change it on the server, I can set the env vars and knife data bag from file secrets dnsimple.json --secret-file /etc/chef/encrypted_data_bag_secret
[2013-08-29 08:45:27 -0400] ichilton: but the secrets aren't then in the repo
[2013-08-29 08:45:34 -0400] ichilton: Any ideas anyone?
[2013-08-29 09:01:58 -0400] ichilton: jtimberman: In http://jtimberman.housepub.org/blog/2012/01/29/dnsimple-self-registration-recipe/ - why do you upload the data bag unencrypted and then encrypt it? - the 2nd command alone seems to work and uploads + encrypts it in one go....
[2013-08-29 09:07:21 -0400] labria: Hey, guys
[2013-08-29 09:07:27 -0400] labria: I have a problem
[2013-08-29 09:07:41 -0400] n1ko: ok
[2013-08-29 09:08:42 -0400] labria: If I update the node's run_list is updates when chef is running on the node, then the run_list is reset after the chef run finishes
[2013-08-29 09:09:48 -0400] labria: The chef-client updates it to what it was when it started in the end of it's run instead of merging it
[2013-08-29 09:14:45 -0400] gudmundur: When I run chef-client -W the first time after introducing chef-rewind (chef_gem 'chef-rewind and require 'chef/rewind'), it will fail because the gem isn't installed and loaded. Is there a nice pattern to deal with this?
[2013-08-29 09:15:45 -0400] abrkn: is there a way to swap out the amazon aws apt mirrors? i keep getting 404s on uncommon packages
[2013-08-29 09:19:58 -0400] labria: anyone?
[2013-08-29 09:20:13 -0400] ichilton: jtimberman: oh, or were you giving an example for both unencrypted and encrypted and not meaning for both to be ran?
[2013-08-29 09:43:42 -0400] remil: one tricky question, I need to create a few resources based of the content of a directory previously created in the run
[2013-08-29 09:44:12 -0400] remil: the issue is, when the run is evaluated the directory isn't populated yet and my resources list is obviously not built
[2013-08-29 09:44:18 -0400] remil: what would be the best way to proceed ?
[2013-08-29 10:08:09 -0400] labria: remil, ruby_block with notifiers should help you
[2013-08-29 10:09:05 -0400] remil: ok, thank you, i'll take a look
[2013-08-29 10:56:45 -0400] arpa: Is there a way to use knife bootstrap and define a user/pass to login with to run recipe1 and a different user/pass to run recipe2 all on the same command?
[2013-08-29 11:03:35 -0400] xhae: No.
[2013-08-29 11:07:43 -0400] arpa: Thanks.
[2013-08-29 11:19:43 -0400] ezotrank: Good day! How I can using chef-solo with knife sole create role? I do knife role create some_role and get error about /etc/chef/client.pem what I do wrong?
[2013-08-29 11:28:55 -0400] ichilton: ezotrank: what do you get if you say: knife role list
[2013-08-29 11:29:24 -0400] ezotrank: ERROR: Your private key could not be loaded from /etc/chef/client.pem
[2013-08-29 11:29:25 -0400] ezotrank: Check your configuration file and ensure that your private key is readable
[2013-08-29 11:29:34 -0400] ichilton: ok
[2013-08-29 11:29:43 -0400] ichilton: your knife isn't talking to your chef server
[2013-08-29 11:29:51 -0400] ichilton: are you running your own chef server or hosted chef?
[2013-08-29 11:30:00 -0400] ezotrank: yes, I see, but I use chef solo
[2013-08-29 11:30:03 -0400] ichilton: oh, sorry - chef solo
[2013-08-29 11:30:05 -0400] ezotrank: and knide solo
[2013-08-29 11:30:54 -0400] ichilton: Do you have a chef-repo?
[2013-08-29 11:31:25 -0400] ezotrank: Yep
[2013-08-29 11:31:54 -0400] ezotrank: I have repo, I done knife solo prepare and I can `cook`
[2013-08-29 11:32:02 -0400] ezotrank: on my test machine
[2013-08-29 11:32:16 -0400] ichilton: ok, then you should be able to just edit roles/myrole.json or roles/myrole.rb
[2013-08-29 11:32:41 -0400] ezotrank: And It's note problem to create role/some_role.json by hand, but I guess it's right way to do that by command
[2013-08-29 11:32:41 -0400] ichilton: http://docs.opscode.com/chef_solo.html#roles
[2013-08-29 11:33:27 -0400] ezotrank: ichilton, ok thx for answers )
[2013-08-29 11:44:04 -0400] teukka: ezotrank: `knife node` commands communicate with the chef-server. you can't use it with chef-solo/knife-solo
[2013-08-29 11:47:28 -0400] jensnorr: Is there a way to set a nodes chef_environment via the api / knife? ie via a script
[2013-08-29 11:50:26 -0400] fishGoM00: iirc correctly someone posted in here about moving all machines from one environment to another
[2013-08-29 11:50:43 -0400] fishGoM00: unfortunately my history doesn't go back that far but you could check the web archives!
[2013-08-29 12:08:57 -0400] ichilton: NameError: uninitialized constant Chef::EncryptedDataBagItem::DEFAULT_SECRET_FILE
[2013-08-29 12:09:02 -0400] ichilton: Am I doing something daft?
[2013-08-29 12:09:09 -0400] ichilton: The docs say thats there...
[2013-08-29 12:10:22 -0400] ichilton: hmm
[2013-08-29 12:10:22 -0400] ichilton: root@gw1:/opt/chef# grep -r DEFAULT_SECRET_FILE *
[2013-08-29 12:10:23 -0400] ichilton: root@gw1:/opt/chef#
[2013-08-29 12:13:05 -0400] ichilton: ah
[2013-08-29 12:13:18 -0400] ichilton: it seems somewhere along the line that constant was removed and the default is to use the default secret...
[2013-08-29 12:36:54 -0400] ichilton: Is there a way of telling chef-client not to sync the cookbooks and use the currently cached ones?
[2013-08-29 12:37:17 -0400] ichilton: I want to debug something without going through the whole make changes, bump version, commit and upload business
[2013-08-29 12:38:29 -0400] n1ko: use chef-zero and berkshelf
[2013-08-29 12:39:30 -0400] ichilton: that doesn't help me here :)
[2013-08-29 12:42:34 -0400] n1ko: well, it does. Rather than uploading them somewhere far far away you would be uploading them to a local server and rather than bumping versions you could use --force which would overwrite current cookbooks
[2013-08-29 12:42:55 -0400] fooJBar: ichilton: you can run chef-solo and point that to the cookbooks cache
[2013-08-29 12:42:56 -0400] n1ko: (and of course vagrant and all that)
[2013-08-29 12:43:13 -0400] n1ko: chef-solo is good if you dont need search,but you usually do :(
[2013-08-29 12:43:19 -0400] ichilton: n1ko: hmm, will have to look into that - thanks
[2013-08-29 12:43:33 -0400] ichilton: fooJBar: great idea - thanks!
[2013-08-29 12:43:57 -0400] ichilton: oh
[2013-08-29 12:44:08 -0400] ichilton: I don't need search, but I do need databags....
[2013-08-29 12:44:25 -0400] fooJBar: ichilton: If your recipe uses search won't work out of the box. Data bags you can use with solo
[2013-08-29 12:44:38 -0400] ichilton: are they cached somewhere though?
[2013-08-29 12:44:48 -0400] fooJBar: ichilton: make sure the data bags path points to the right place in solo.rb
[2013-08-29 12:45:27 -0400] ichilton: hmm
[2013-08-29 12:45:29 -0400] ichilton: might just do the update
[2013-08-29 12:45:38 -0400] ichilton: can I use puts in a recipe to see debugging?
[2013-08-29 12:45:55 -0400] ichilton: it looks like my encrypted databag isn't extracting properly and i'm trying to work out why....
[2013-08-29 12:46:03 -0400] fooJBar: ichilton: use Chef::Log.info 'your message'
[2013-08-29 12:46:25 -0400] ichilton: ah, cool
[2013-08-29 12:46:31 -0400] ichilton: what would puts do? - nothing?
[2013-08-29 12:46:40 -0400] fooJBar: not much
[2013-08-29 12:46:43 -0400] ichilton: Can I use variables in that? - i.e: Chef::log.info dnsimple_credentials
[2013-08-29 12:47:03 -0400] fooJBar: Chef::log.info "Hello this is text #{dnsimple_credentials}"
[2013-08-29 12:47:16 -0400] fooJBar: Log with capital
[2013-08-29 12:47:34 -0400] fishGoM00: ichilton: iirc you can stick one node... say production on a particular version of the cookbook
[2013-08-29 12:47:53 -0400] fishGoM00: develop it further on another node etc.
[2013-08-29 12:48:12 -0400] fooJBar: Chef::Log.info("Variable a: " + a + "or using interpolation: #{a}")
[2013-08-29 12:48:31 -0400] ichilton: yeah, I just wanted to quickly add some logs and run chef client without all the cookbook update polava
[2013-08-29 12:49:01 -0400] fooJBar: sometimes you need to explicitly do to_s (to string) as in: Chef::Log.info("Variable a: " + a.to_s)
[2013-08-29 12:52:59 -0400] arpa: If I run 'knife bootstrap ... -j {"test":"1"}' How do I actually get access to the key/val on my recipe?
[2013-08-29 12:53:17 -0400] pabst^: So today I am going to start teaching my team how to use chef, I have implemented the chef server here, and over the next few months we are going to be working on migrating from using bash and perl scripts to using chef. In my first hour of teaching (i am going to be having an hour long meeting every week with the team) I want to start introducing basic concepts. What would you guys think are the important concepts to cover in the first hour?
[2013-08-29 12:53:52 -0400] ichilton: fooJBar: I should see that output in stdout when running chef-client, right?
[2013-08-29 12:54:02 -0400] fooJBar: yes
[2013-08-29 12:54:19 -0400] fooJBar: ichilton: but it may happen sooner than you expected
[2013-08-29 12:54:39 -0400] fooJBar: ichilton: if you put logging inside a resource that will be printed when the recipe is compiled, not when the resource is converged
[2013-08-29 12:55:03 -0400] ichilton: odd, I don't seem to see it at all
[2013-08-29 12:59:15 -0400] fishGoM00: pabst^: keep it simple.. nodes, roles, environments and attribute precedence to get started perhaps
[2013-08-29 12:59:36 -0400] fishGoM00: illustrate it with the apache cookbook to ensure everyone can understand the example
[2013-08-29 13:00:44 -0400] NaTx: hi all
[2013-08-29 13:00:55 -0400] ichilton: fooJBar: Odd, I don't seem to be seeing Log info at all?
[2013-08-29 13:02:13 -0400] NaTx: I'm trying to find how to test, with chefspec, a recipe relying on the node's role list to choose one template
[2013-08-29 13:02:20 -0400] ichilton: fooJBar: logging is in there in /var/cache, but it doesnm't seem to show on chef-client
[2013-08-29 13:02:54 -0400] NaTx: does anybody know how to make chefspec to have a node with a role?
[2013-08-29 13:02:57 -0400] m4rcu5: quick one: whats the way to go? node['attribute'] or node[:attribute]? and what would it matter? :)
[2013-08-29 13:04:35 -0400] mattjalexander: :attribute is slightly faster, but i tend to prefer 'attribute' just because i'm used to it from other languages
[2013-08-29 13:04:40 -0400] arpa: If I run 'knife bootstrap ... -j {"test":"1"}' How do I actually get access to the key/val on my recipe?
[2013-08-29 13:04:54 -0400] m4rcu5: mattjalexander: faster as in typing it is faster?
[2013-08-29 13:05:25 -0400] ichilton: fooJBar: ah, log level (-l) !
[2013-08-29 13:07:38 -0400] mattjalexander: http://stackoverflow.com/questions/8189416/why-use-symbols-as-hash-keys-in-ruby
[2013-08-29 13:09:25 -0400] pabst^: fishGoM00: Kind of what I am thinking, basic concepts. Thanks for your input.
[2013-08-29 13:09:43 -0400] m4rcu5: mattjalexander: thanks for that one!
[2013-08-29 13:09:55 -0400] pabst^: I enjoy the fact that I have prepared in no way for this presentation, so I am frantically throwing something together now.
[2013-08-29 13:13:32 -0400] thebishop: how do I get the knife.rb and client.pem files from a self-hosted chef server?
[2013-08-29 13:14:29 -0400] NaTx: thebishop, it should be created by knife configure -i and saved into the chef directory (/etc/chef)
[2013-08-29 13:14:39 -0400] thebishop: NaTx, on the server?
[2013-08-29 13:14:45 -0400] NaTx: I think so
[2013-08-29 13:14:49 -0400] thebishop: ok i'll try that
[2013-08-29 13:17:03 -0400] fishGoM00: pabst^: That's how real men work :)
[2013-08-29 13:17:15 -0400] ichilton: Can you get at the current node or client name from within a recipe? - it's not in the ohai output....
[2013-08-29 13:17:40 -0400] ichilton: It seems DigitalOcean don't use the hostname as the fqdn
[2013-08-29 13:19:25 -0400] ichilton: hmm, although i've got the fqdn in /etc/hostname but ohai only seems to take the host part and not use the domain part
[2013-08-29 13:25:25 -0400] NaTx: sorry, but I can't find out how to fake a node belongs to a role using chefspec
[2013-08-29 13:31:41 -0400] arpa: If I run 'knife bootstrap ... -j {"test":"1"}' How do I actually get access to the key/val on my recipe?
[2013-08-29 13:34:11 -0400] NaTx: arpa, are you sure knife bootstrap has a -j flag?
[2013-08-29 13:35:33 -0400] arpa: Yep, see here; http://docs.opscode.com/knife_bootstrap.html
[2013-08-29 13:36:09 -0400] m4rcu5: in some recipes im doing a search and storing the outcome in a node.set[:myattrib] so other cookbooks can use it aswell, however it seems that this is stored in my node aswell? is there any way to make it behave like a normal attrib?
[2013-08-29 13:36:32 -0400] NaTx: true, arpa, first time I see this
[2013-08-29 13:37:10 -0400] arpa: NaTx: I just have no idea how to use it within a recipe, cannot find any example anywhere
[2013-08-29 13:38:55 -0400] ichilton: jtimberman: Around yet?
[2013-08-29 13:40:57 -0400] adnichols: ichilton does node['name'] not work? not sure I've ever tried
[2013-08-29 13:41:33 -0400] ichilton: adnichols: nope...
[2013-08-29 13:42:17 -0400] adnichols: Chef::Config[:node_name] ?
[2013-08-29 13:42:27 -0400] adnichols: or node.name
[2013-08-29 13:42:44 -0400] ichilton: adnichols: will come back to you in a sec....bigger question at play - just gisting it :)
[2013-08-29 13:42:55 -0400] adnichols: heh, np - just spewing thoughts
[2013-08-29 13:43:09 -0400] ichilton: need some advice on the least hacky fix to this mess ;)
[2013-08-29 13:45:59 -0400] teukka: ichilton: it's `node.name`. that's a method, not an attribute
[2013-08-29 13:46:11 -0400] NaTx: arpa, I think that bootstrap json attributes are available as normal node attributes, so, you should be able to read this within the recipe like : node["test"]
[2013-08-29 13:46:38 -0400] NaTx: I've seen this here: http://stackoverflow.com/questions/14281483/dynamik-role-attributes-in-chef
[2013-08-29 13:49:31 -0400] ichilton: adnichols: https://gist.github.com/ichilton/60414902b258711d2f13
[2013-08-29 13:49:34 -0400] ichilton: teukka: thanks
[2013-08-29 13:49:59 -0400] NaTx: how can I fake the node's role in a chefspec test?
[2013-08-29 13:50:16 -0400] arpa: NaTx: thanks I'll give it a try
[2013-08-29 13:50:56 -0400] ichilton: adnichols: Any thoughts?
[2013-08-29 13:51:05 -0400] adnichols: yeah, reading through it
[2013-08-29 13:51:08 -0400] ichilton: ta
[2013-08-29 13:51:46 -0400] adnichols: sucks when providers do this
[2013-08-29 13:52:22 -0400] ichilton: indeed
[2013-08-29 13:52:38 -0400] adnichols: so does the bootstrap actually fail as a result? Or receipes that rely on hostname just don't work?
[2013-08-29 13:52:47 -0400] ichilton: wel...
[2013-08-29 13:52:50 -0400] ichilton: well...
[2013-08-29 13:53:05 -0400] ichilton: i'm trying to be clever and use the dnsimple cookbook to setup the new nodes in dns :)
[2013-08-29 13:53:20 -0400] ichilton: so that's going pair shaped as I was doing this:
[2013-08-29 13:53:24 -0400] ichilton: if dnsimple_credentials && dnsimple_credentials['domains'].include?(node[:domain])
[2013-08-29 13:53:35 -0400] adnichols: ic
[2013-08-29 13:54:06 -0400] adnichols: can you toss a recipe in advance of that to fix the hosts file?
[2013-08-29 13:54:10 -0400] ichilton: so node[:domain] is blank...
[2013-08-29 13:54:16 -0400] ichilton: Yep
[2013-08-29 13:54:16 -0400] adnichols: actually that wont make ohai run again tho
[2013-08-29 13:54:25 -0400] ichilton: I just saw a way round that
[2013-08-29 13:54:36 -0400] adnichols: ah, can you get it to reload attribs?
[2013-08-29 13:54:44 -0400] ichilton: you can notify ohai
[2013-08-29 13:54:49 -0400] adnichols: nice - so that may work
[2013-08-29 13:55:13 -0400] ichilton: notifies :reload, "ohai[reload]"
[2013-08-29 13:55:33 -0400] ichilton: So actually, I can use this:
[2013-08-29 13:55:34 -0400] ichilton: https://github.com/3ofcoins/chef-cookbook-hostname/blob/master/recipes/default.rb
[2013-08-29 13:56:35 -0400] ichilton: but I need to know the fqdn, so it's the best way to get that - do I try and use the chef node name, or do I use the contents of /etc/hostname ?
[2013-08-29 13:57:25 -0400] ichilton: (and incidently, the above recipe - will it reload ohai 3 times, or is chef clever enough to only do that once at the end of the recipe??)
[2013-08-29 13:57:45 -0400] adnichols: well you have the first part - does the domain change often in your env?
[2013-08-29 13:58:36 -0400] ichilton: no, but I didn't want that attribute set, I wanted to pull it in case I do want a different one
[2013-08-29 13:58:44 -0400] ichilton: I can get it with `hostname` though
[2013-08-29 14:03:39 -0400] ichilton: adnichols: see comment in gist
[2013-08-29 14:06:26 -0400] NaTx: please, I need help to mock a node has a role set in a chefspec
[2013-08-29 14:06:34 -0400] NaTx: I can't find out how to make it work
[2013-08-29 14:07:37 -0400] adnichols: ichilton sorry was on a call - that may work
[2013-08-29 14:08:23 -0400] adnichols: ichilton the way I've dealt with this is to just define a domain per environment & have a recipe that manages the hosts file - but we also have used the hosts file for more than just the local systems hostname so we have to manage it either way
[2013-08-29 14:09:10 -0400] adnichols: it very much depends on how you use the domain portion - if it's broken down by site, same across everything, etc
[2013-08-29 14:09:19 -0400] ichilton: yeah, true
[2013-08-29 14:12:05 -0400] ichilton: adnichols: incidently, the above recipe - will it reload ohai 3 times, or is chef clever enough to only do that once at the end of the recipe??
[2013-08-29 14:12:40 -0400] adnichols: umm.. depends on the default for notifies - let me look
[2013-08-29 14:12:47 -0400] ichilton: ta
[2013-08-29 14:13:23 -0400] adnichols: ic - by default they are delayed, so it should only notify once
[2013-08-29 14:13:35 -0400] adnichols: http://docs.opscode.com/chef/resources.html - look at notifies syntax
[2013-08-29 14:14:27 -0400] ichilton: brill, thanks
[2013-08-29 14:14:38 -0400] ichilton: so when will it run - at the end of the current recipe?
[2013-08-29 14:14:59 -0400] adnichols: I think it actually waits till the end of the entire run
[2013-08-29 14:15:35 -0400] ichilton: indeed
[2013-08-29 14:15:37 -0400] ichilton: "By default, notifications are :delayed, that is they are queued up as they are triggered, and then executed at the very end of a chef-client run"
[2013-08-29 14:16:18 -0400] ichilton: so i'd want to trigger an immediate one after doing this...
[2013-08-29 14:16:47 -0400] adnichols: that's probably one solution
[2013-08-29 14:17:38 -0400] adnichols: you could probably also crack open one of those resources w/ a wrapper cookbook and change the notifies
[2013-08-29 14:19:01 -0400] adnichols: I gotta run - good luck
[2013-08-29 14:19:06 -0400] ichilton: adnichols: thank you!
[2013-08-29 14:24:22 -0400] ichilton: Does this:
[2013-08-29 14:24:22 -0400] ichilton: notifies :reload, "ohai[reload]"
[2013-08-29 14:24:30 -0400] ichilton: call this? -
[2013-08-29 14:24:31 -0400] ichilton:   ohai "reload" do
[2013-08-29 14:24:31 -0400] ichilton:     action :nothing
[2013-08-29 14:24:31 -0400] ichilton:   end
[2013-08-29 14:24:34 -0400] ezotrank: Maybe I do something wrong but I install knife-solo and want try to add role: knife role create aaaa but knife want to connect to localhost: ERROR: Connection refused connecting to localhost:443 for /roles/aaaa, retry 1/5
[2013-08-29 14:24:36 -0400] ichilton: or are they two separate things?
[2013-08-29 14:24:48 -0400] ezotrank: why it's does't save this to json file?
[2013-08-29 14:26:37 -0400] teukka: ezotrank: it triest to create the role to the chef-server. many (if not most) knife commands are meant to be used with the server
[2013-08-29 14:26:58 -0400] teukka: ezotrank: for knife-solo (and chef-solo) you just make the json/rb file to the file system
[2013-08-29 14:27:20 -0400] ezotrank: teukka,  manually?
[2013-08-29 14:27:45 -0400] teukka: ezotrank: yes. roles/<name>.json or .rb
[2013-08-29 14:27:58 -0400] ezotrank: ok, thx )
[2013-08-29 14:28:32 -0400] ichilton: will ohai "reload" do action :nothing end only do something if there has been notifies :reload, "ohai[reload]" ??
[2013-08-29 14:29:35 -0400] teukka: ichilton: yes, "nothing" action does nothing by default =)
[2013-08-29 14:30:27 -0400] ichilton: teukka: ok, but if there has been notifies :reload, "ohai[reload]" then it will actually reload ohai?
[2013-08-29 14:32:19 -0400] teukka: ichilton: yes, if the notifying resource was updated. but it should probably also have `:immediately` flag on or the reloading happens at the end of the chef run
[2013-08-29 14:33:03 -0400] teukka: http://docs.opscode.com/resource_common.html#notifications
[2013-08-29 14:33:04 -0400] ichilton: teukka: does that ohai "reload" action nothing force that though?
[2013-08-29 14:33:13 -0400] ichilton: teukka: i'm looking at this: https://github.com/3ofcoins/chef-cookbook-hostname/blob/master/recipes/default.rb
[2013-08-29 14:33:27 -0400] ichilton: teukka: I don't understand why it's doing notifies and then that ohai "reload" do thing?
[2013-08-29 14:34:59 -0400] teukka: the idea is to reload it only if the ohai data changes, as it is a slow operation
[2013-08-29 14:35:15 -0400] ichilton: nod
[2013-08-29 14:35:24 -0400] ichilton: so does the notifies signal that it needs to be reloaded
[2013-08-29 14:35:38 -0400] thom: yes
[2013-08-29 14:35:50 -0400] teukka: ichilton: yes, but by default it is delayed
[2013-08-29 14:35:50 -0400] ichilton: but then the ohai "reload" do.. part forces that to happen at the end of the recipe instead of waiting until the end of the chef run?
[2013-08-29 14:36:06 -0400] ichilton: and instead of using immediately and doing it 3x times
[2013-08-29 14:36:13 -0400] ichilton: right?
[2013-08-29 14:36:48 -0400] teukka: there is no such option as "at the end of the recipe". at the converge phase there are no idea about recipes any more. only list of resources
[2013-08-29 14:36:49 -0400] thom: you're right, but not for the right reasons.
[2013-08-29 14:37:06 -0400] thom: well, sort of right
[2013-08-29 14:37:16 -0400] ichilton: yeah, bad terminology
[2013-08-29 14:37:24 -0400] thom: to send a notification, you have to have an actor to send the notification to
[2013-08-29 14:37:32 -0400] ichilton: but then the ohai "reload" do.. part forces that to happen right then instead of waiting until the end of the chef run?
[2013-08-29 14:37:35 -0400] thom: the ohai block provides that actor
[2013-08-29 14:37:47 -0400] ichilton: actor?
[2013-08-29 14:37:54 -0400] teukka: I would say that that cookbook you linked does not work as expected. but I could be wrong of course
[2013-08-29 14:37:54 -0400] thom: thing that does something
[2013-08-29 14:38:23 -0400] ichilton: So, will...
[2013-08-29 14:38:23 -0400] ichilton:   ohai "reload" do
[2013-08-29 14:38:23 -0400] ichilton:     action :nothing
[2013-08-29 14:38:24 -0400] ichilton:   end
[2013-08-29 14:38:27 -0400] ichilton: actually cause a reload?
[2013-08-29 14:38:35 -0400] thom: no. it does nothing
[2013-08-29 14:38:40 -0400] ichilton: or just facilitate the delayed reload?
[2013-08-29 14:38:53 -0400] thom: but then you send it a notification, and then it does something
[2013-08-29 14:38:56 -0400] ichilton: ok
[2013-08-29 14:38:59 -0400] ichilton: so...
[2013-08-29 14:39:01 -0400] ichilton: notifies :reload, "ohai[reload]"
[2013-08-29 14:39:08 -0400] BryanWB: is there a way in the application_python django sub-resource to override one of the requirements specified in requirements.txt
[2013-08-29 14:39:13 -0400] ichilton: does that "ohai[reload]" actually call the above block?
[2013-08-29 14:39:45 -0400] ichilton: i.e is "ohai[reload]" referring to the ohai "reload" do bit?
[2013-08-29 14:40:16 -0400] thom: yes
[2013-08-29 14:40:28 -0400] ichilton: ok
[2013-08-29 14:40:36 -0400] thom: but because it's a delayed notification, that reload won't happen until the end of the chef run
[2013-08-29 14:40:41 -0400] ichilton: yep
[2013-08-29 14:40:50 -0400] thom: the position of the block in the recipe is irrelevant
[2013-08-29 14:40:56 -0400] ichilton: so how could I get it to reload immediately
[2013-08-29 14:41:05 -0400] ichilton: but not do it 3x times if I update each of those resources?
[2013-08-29 14:41:52 -0400] thom: you can't, wiht notifies
[2013-08-29 14:42:27 -0400] thom: you could do it with subscribes, but then you have to know the full list of things that you're subscribing to
[2013-08-29 14:43:16 -0400] yields: Is there large apps examples ?
[2013-08-29 14:43:22 -0400] ichilton: ah
[2013-08-29 14:43:23 -0400] ichilton: http://docs.opscode.com/resource_ohai.html
[2013-08-29 14:44:20 -0400] yields: i'm having trouble understanding how to override stuff in cookbooks, and how to use chef in general.
[2013-08-29 14:44:52 -0400] yields: any app examples that showcase chef features will be awesome.
[2013-08-29 14:48:58 -0400] fishGoM00: yields: I always recommend the apache cookbook
[2013-08-29 14:49:13 -0400] fishGoM00: View the attributes/defaul.rb file
[2013-08-29 14:49:28 -0400] fishGoM00: and then override those attributes on your roles\environments
[2013-08-29 14:49:44 -0400] arpa: Anyone has any idea about this? http://stackoverflow.com/questions/18512962/use-knife-to-bootstrap-recipe-on-server-and-forward-version-parameter
[2013-08-29 14:50:24 -0400] failshell: anyone having a master/master chef server setup? id like one chef server at each facility, with replication between them
[2013-08-29 14:52:36 -0400] yields: fishGoM00, yeah cookbooks are great to look at, but i'm looking for examples on how to setup an app.
[2013-08-29 14:54:48 -0400] fishGoM00: what type of app?
[2013-08-29 14:55:38 -0400] yields: fishGoM00 any type of app that uses a lot of chef features will do.
[2013-08-29 14:56:24 -0400] fishGoM00: sounds a bit vague :)
[2013-08-29 14:56:51 -0400] fishGoM00: if you get apache up and running... to get an understanding of attributes and their precedence
[2013-08-29 14:57:15 -0400] yields: fishGoM00 haha, it's a bit hard to get those running without examples / book.
[2013-08-29 14:57:25 -0400] fishGoM00: you can the write a wrapper cookbook which gets your app from a source... includes apache... imports a db etc etc
[2013-08-29 14:57:36 -0400] erthad: hiall
[2013-08-29 14:57:40 -0400] fishGoM00: m00
[2013-08-29 14:58:41 -0400] erthad: is it possible to define 2 dependencies for the single cookbook? for example I'd like the cookbook to depend on cookbook "foobar" versions "~> 0.1.2
[2013-08-29 14:58:44 -0400] yields: fishGoM00 no i can't since i don't know how chef works...
[2013-08-29 14:59:04 -0400] erthad: ... versions "~> 0.1.2" OR "~> 0.2.0" at the same time
[2013-08-29 14:59:10 -0400] erthad: is it possible to do so?
[2013-08-29 14:59:54 -0400] erthad: or should I just drop the support for "~> 0.1.2" in this case and go with that?
[2013-08-29 14:59:59 -0400] fishGoM00: yeilds: exactly the reason you should cut your teeth with a cook book like apache (to familiarise yourself with the system)
[2013-08-29 15:00:09 -0400] mcantu: @erthad I've never tried it before, but from my understanding you can do it. The best thing to do would be to try it out.
[2013-08-29 15:01:17 -0400] siezer: erthad absolutely
[2013-08-29 15:01:19 -0400] zaargy: what's teh sanest method to install deps required for a chef_gem resource?
[2013-08-29 15:01:21 -0400] siezer: just put multiple depends lines
[2013-08-29 15:01:34 -0400] siezer: er.... actually you cant do that OR on the same cookbook
[2013-08-29 15:01:39 -0400] siezer: thats what the squiggly is for
[2013-08-29 15:02:01 -0400] siezer: you can sqiggle 0.1.0
[2013-08-29 15:02:12 -0400] siezer: that'll say 0.1.x is good
[2013-08-29 15:02:31 -0400] adnichols: zaargy what kind of deps?
[2013-08-29 15:02:53 -0400] fishGoM00: erthad: http://docs.opscode.com/essentials_cookbook_metadata.html
[2013-08-29 15:03:12 -0400] zaargy: adnichols: library dep
[2013-08-29 15:03:16 -0400] zaargy: package install
[2013-08-29 15:03:20 -0400] zaargy: chef_gem seems to happen before anythign else
[2013-08-29 15:03:28 -0400] adnichols: zaargy you can look at how the build_requires cookbook works
[2013-08-29 15:03:35 -0400] adnichols: it does some magic to put itself ahead of chef_gem
[2013-08-29 15:03:42 -0400] zaargy: ven iah cool
[2013-08-29 15:04:06 -0400] zaargy: adnichols: okay will check it out
[2013-08-29 15:04:07 -0400] zaargy: thanks
[2013-08-29 15:04:08 -0400] siezer: unfortunately right now chef_gem uses "the hack" to do work at compile time, and so does build-essential
[2013-08-29 15:04:11 -0400] erthad: mcantu: siezer: yeap, it works that way. for some reason I thought the dependencies were processed with AND but not with OR
[2013-08-29 15:04:14 -0400] erthad: thanks
[2013-08-29 15:04:20 -0400] adnichols: build_essentials -  sorry
[2013-08-29 15:04:32 -0400] mcantu: awesome :) Thanks for the heads up
[2013-08-29 15:04:33 -0400] zaargy: adnichols: do you have a link? struggling to find it atm
[2013-08-29 15:04:38 -0400] zaargy: nevermind got it
[2013-08-29 15:04:45 -0400] adnichols: https://github.com/opscode-cookbooks/build-essential
[2013-08-29 15:05:23 -0400] erthad: fishGoM00: I haven't find anything about specifying dependencies for multiple versions of a single cookbook and that's why I've asked about it here
[2013-08-29 15:05:27 -0400] siezer: also.. just a heads up.. you should use the community site as an artifact server instead of github
[2013-08-29 15:05:35 -0400] erthad: fishGoM00: anyway, thank you for the link
[2013-08-29 15:05:39 -0400] siezer: knife cookbook site download build-essential
[2013-08-29 15:06:10 -0400] siezer: what's in git master isn't guaranteed to be the what's on the chef-server at that version number
[2013-08-29 15:06:12 -0400] adnichols: zaargy the "magic" is the r.run_action(:install) bit
[2013-08-29 15:06:17 -0400] siezer: or better yet, berkshelf
[2013-08-29 15:07:08 -0400] zaargy: adnichols: ah nice i see
[2013-08-29 15:09:12 -0400] null_route: Hey all! I'm looking at this Apllication + Library cookobook pattern -
[2013-08-29 15:10:04 -0400] null_route: What's the TOP level of the pattern - What do I set a node's run list to? The default recipe of a cookbook, or a recipe for each of my services in a top-level cookbook?
[2013-08-29 15:16:02 -0400] failshell: my only beef with Chef is its name when I google for something related to it :)
[2013-08-29 15:16:51 -0400] ianco: failshell: totally
[2013-08-29 15:17:09 -0400] ianco: or any related tools
[2013-08-29 15:34:06 -0400] fishGoM00: failshell & ianco: like knife..... grrrrr :)
[2013-08-29 15:35:20 -0400] sparr: what does it mean for a chef user to be an admin?
[2013-08-29 15:36:11 -0400] bean: sparr: it means they can modify stuff.
[2013-08-29 15:36:38 -0400] sparr: what sort of stuff?
[2013-08-29 15:37:00 -0400] cpasmoi: Role, json tree, etc
[2013-08-29 15:37:10 -0400] bean: I think anything.
[2013-08-29 15:37:14 -0400] bean: non admin can just view.
[2013-08-29 15:39:03 -0400] sparr: ahh, ok
[2013-08-29 15:39:06 -0400] sparr: different question
[2013-08-29 15:39:19 -0400] sparr: what is "idletime" in ohai output? or where can I find documentation on that
[2013-08-29 15:44:22 -0400] zaargy: can i access cookbook versions within a recipe?
[2013-08-29 15:44:33 -0400] zaargy: e.g. i want an attribute with the cookbook version of foo applied to that node
[2013-08-29 15:53:42 -0400] arpa: Anyone has any idea about this? http://stackoverflow.com/questions/18512962/use-knife-to-bootstrap-recipe-on-server-and-forward-version-parameter
[2013-08-29 16:03:11 -0400] djustin: I'm trying to re-add a node to the chef-server.  I've delete the node on the server, but still get the following error  * There may already be a client named....using knife client delete states: The object you are looking for could not be found
[2013-08-29 16:04:17 -0400] jbz: djustin: registering a node on a server creates a *node* record and a *client* record.
[2013-08-29 16:04:23 -0400] jbz: Oh sorry you tried that
[2013-08-29 16:04:35 -0400] jbz: hm, nothing like it shows up in client list?
[2013-08-29 16:06:22 -0400] ichilton: jtimberman: around?
[2013-08-29 16:08:11 -0400] djustin: jbz, correct, the node is gone
[2013-08-29 16:08:23 -0400] scarolan: djustin: What does "knife client list" show?
[2013-08-29 16:08:30 -0400] djustin: I had to append a number to my node-name on the client.rb
[2013-08-29 16:08:33 -0400] djustin: to get around it
[2013-08-29 16:08:40 -0400] jbz: djustin: is the *client* gone, not the node?
[2013-08-29 16:09:08 -0400] djustin: ha, that's it
[2013-08-29 16:09:09 -0400] jbz: what scarolan said :-)
[2013-08-29 16:09:11 -0400] djustin: thanks jbz
[2013-08-29 16:09:17 -0400] djustin: client is still there
[2013-08-29 16:09:29 -0400] djustin: oh, scarolan too, thanks
[2013-08-29 16:52:32 -0400] ichilton: Got a strange problem - a cookbook in my run list includes my common cookbook, which has a default recipe which includes other recipes. On provisioning a new server, it's going to the last one of those included recipes, which includes the dnsimple cookbook and trying to run the default recipe in the dnsimple cookbook which fails trying to install the fog gem because there is no gcc yet. How I thought Chef worked top to bottom??
[2013-08-29 16:55:36 -0400] adnichols: are you installing the fog gem w/ chef_gem?
[2013-08-29 16:55:52 -0400] ichilton: adnichols: i'm not, the dnsimple cookbook is.....
[2013-08-29 16:56:15 -0400] adnichols: ichilton either way - chef_gem will happen before most of the rest of your recipes
[2013-08-29 16:56:19 -0400] ichilton: but I don't understand why it's trying to execute dnsimple:default before anything else, when dnsimple isn't included until way down....
[2013-08-29 16:56:31 -0400] adnichols: because of chef_gem
[2013-08-29 16:56:35 -0400] ichilton: ah
[2013-08-29 16:56:46 -0400] ichilton: So how can I stop it?
[2013-08-29 16:56:50 -0400] adnichols: the way to deal w/ gcc is to use the build-essential cookbook
[2013-08-29 16:56:57 -0400] ichilton: i've got build-essential
[2013-08-29 16:57:08 -0400] ichilton: but it's trying to do dnsimple before it!
[2013-08-29 16:57:10 -0400] adnichols: you can't stop it - that's how chef works - it's necessary so that the gem is available for the LWRP to use
[2013-08-29 16:57:37 -0400] ichilton: but the gem isn't available because it falls over :)
[2013-08-29 16:57:47 -0400] adnichols: build-essential should put itself ahead of chef_gem
[2013-08-29 16:57:52 -0400] ichilton: it should listen to me, I know best ;)_
[2013-08-29 16:58:20 -0400] ichilton: so that's a problem with the dnsimple cookbook not having a build-essential dependancy?
[2013-08-29 16:58:28 -0400] adnichols: maybe
[2013-08-29 16:58:42 -0400] adnichols: I'm not sure if that impacts ordering in this scenario
[2013-08-29 16:59:49 -0400] ichilton: aha
[2013-08-29 16:59:49 -0400] ichilton: https://github.com/aetrion/chef-dnsimple/issues/7
[2013-08-29 17:00:23 -0400] adnichols: there ya go
[2013-08-29 17:00:44 -0400] adnichols: you could wrap it in a cookbook to fix that I guess
[2013-08-29 17:00:44 -0400] ichilton: but I don't understand how everyone trying to use the cookbook doesn't have this problem?
[2013-08-29 17:01:20 -0400] ichilton: I have got it wrapped in a cookbook, but it's ignoring all that and jumping straight to dnsimple:default :(
[2013-08-29 17:01:42 -0400] adnichols: does your cookbook list build-essential as a dependency?
[2013-08-29 17:02:01 -0400] ichilton: yes
[2013-08-29 17:02:05 -0400] ichilton: in metadata.rb
[2013-08-29 17:02:09 -0400] adnichols: huh, would have thought that would work
[2013-08-29 17:02:12 -0400] gkarekinian: A lot of people install a compiler when bootstrapping the node, that's why it doesn't happen to everyone
[2013-08-29 17:02:30 -0400] adnichols: a lot of people also fix their problems and never submit issues / PR's :)
[2013-08-29 17:02:31 -0400] ichilton: gkarekinian: ah, ok - i'm trying to do it as part of the chef run
[2013-08-29 17:02:54 -0400] adnichols: "I'll just fork/fix this"
[2013-08-29 17:03:50 -0400] cpuguy83: Anyone have any experience with chocolatey and the subsequent cookbook?
[2013-08-29 17:04:02 -0400] ichilton: so i've got mycompany_services::gw (in the run list) which includes mycompany_common, which is including mycompany::system (which is including build-essential) and later on, mycompany:dns which includes dnsimple.... but it's jumping straight to that dnsimple bit
[2013-08-29 17:04:26 -0400] cpuguy83: adnichols: I hate that
[2013-08-29 17:04:52 -0400] ichilton: so as far as I can see from what you're saying, the only way would be to change dnsimple::default to include build_essential directly, as my wrapper cookbook seems to be being bypassed...
[2013-08-29 17:04:55 -0400] adnichols: cpuguy83 yeah, me too - but I understand it and have done it
[2013-08-29 17:04:55 -0400] cpuguy83: adnichols: I have a gem that I saw someone ask a question about on SO once, he said he just updated the gem but never submitted an issue or a PR or anything... I'm just like WTF
[2013-08-29 17:05:19 -0400] ichilton: but this is another problem i'm having actually.....
[2013-08-29 17:05:27 -0400] ichilton: if I fork this cookbook and fix the problem
[2013-08-29 17:05:42 -0400] ichilton: I can update my Berksfile to point to the fork's github repo and it will work
[2013-08-29 17:06:17 -0400] adnichols: cpuguy83 yep - happens a lot
[2013-08-29 17:06:30 -0400] ichilton: But, when I berks update on my mycompany_services cookbook, which has mycompany_common as a github repo in the Berksfile, it will complain about the dnsimple fork dependancy
[2013-08-29 17:06:34 -0400] ichilton: as i've just had it with this:
[2013-08-29 17:06:35 -0400] ichilton: Cookbook 'fqdn-fix' not found in any of the default locations
[2013-08-29 17:07:10 -0400] ichilton: fqdn-fix is in the Berksfile of mycompany_common, but obviously mycompany_services doesn't know about that...
[2013-08-29 17:07:19 -0400] ichilton: it's looking for it on the community site.
[2013-08-29 17:07:32 -0400] adnichols: Pretty sure berks only looks at metadata.rb
[2013-08-29 17:07:37 -0400] ichilton: so I can get it working by berks upload in common, but services will obviously always complain - is there a way round that?
[2013-08-29 17:07:47 -0400] adnichols: so having something listed in a cookbooks berksfile doesn't make it follow dependencies
[2013-08-29 17:07:48 -0400] ichilton: can you do a git source in the metadata?
[2013-08-29 17:08:15 -0400] cpuguy83: So I'm setting up a strongswan cookbook which builds vpn connection settings based off of a databag.  I was trying to decide encrypted databag or not for PSK's.... reason for not is that we are running open source chef in our own private environment... if someone gets access to that server, they likely also have access to that VPN server anyway.  Just thinking it's useless to bother with encrypting those keys.
[2013-08-29 17:08:45 -0400] adnichols: ichilton no, but you could explicitly list it in your top level berksfile
[2013-08-29 17:08:46 -0400] cpuguy83: Assuming the databags already get transferred either of SCP or HTTPS
[2013-08-29 17:09:25 -0400] ichilton: adnichols: ok, thought so - that the only way?
[2013-08-29 17:09:39 -0400] adnichols: ichilton only way I can think of - doesn't mean it's actually the only way :)
[2013-08-29 17:09:44 -0400] ichilton: haha
[2013-08-29 17:09:50 -0400] ichilton: I shoudl maybe ask in #berkshelf
[2013-08-29 17:10:01 -0400] adnichols: cpuguy83 I see databags as protection against data stored in a repository
[2013-08-29 17:10:16 -0400] adnichols: cpuguy83 encrypted databags that is
[2013-08-29 17:10:21 -0400] cpuguy83: adnichols: What do you mean?
[2013-08-29 17:10:33 -0400] adnichols: cpuguy83 beyond that - access to a server generally means I'm hosed
[2013-08-29 17:10:55 -0400] adnichols: cpuguy83 I mean we use them when we want to store data in git that's sensitive
[2013-08-29 17:11:27 -0400] cpuguy83: I see the purpose of encryption is to keep prying eyes out, but in this case prying eyes would already be able to see them unencrypted on the server that has that cookbook installed anyway (since it needs to get written to a conf file)
[2013-08-29 17:11:46 -0400] adnichols: cpuguy83 yes, exactly - it doesn't mean there's no value though
[2013-08-29 17:12:14 -0400] adnichols: cpuguy83 I was just saying the value is really in protecting the data sitting in your git repo - not elsewhere
[2013-08-29 17:12:43 -0400] cpuguy83: adnichols: Right, and the databags are already not sitting in the git repo
[2013-08-29 17:12:54 -0400] cpuguy83: (I'm not arguing, I'm just thinking out loud)
[2013-08-29 17:13:05 -0400] adnichols: cpuguy83 right, so then you may be fine not using encryption
[2013-08-29 17:13:18 -0400] adnichols: because I agree w/ you - it does little to protect the data elsewhere
[2013-08-29 17:13:22 -0400] ichilton: I was thinking about that earlier
[2013-08-29 17:13:33 -0400] ichilton: the problem with encrypted data bags is the encryption key then needs to be put on every server
[2013-08-29 17:13:51 -0400] ichilton: so if a server gets hacked then they can get access to the encrypted data bags and hence your sensitive account details...
[2013-08-29 17:13:52 -0400] adnichols: ichilton that isn't necessarily a requirement - but it's the easiest option
[2013-08-29 17:13:55 -0400] hasues: I'm following this page: http://docs.opscode.com/install_workstation.html, and on running knife --configure initial it asks to enter the existing admin name [admin]. What does that pertain to?
[2013-08-29 17:14:10 -0400] ichilton: adnichols: how else could you do it?
[2013-08-29 17:14:15 -0400] cpuguy83: ichilton: yep... and the overhead of having to manage that manually, which is anti-chef
[2013-08-29 17:14:17 -0400] adnichols: ichilton you do have the option of requiring a passphrase each time you run chef-client I think
[2013-08-29 17:14:28 -0400] cpuguy83: * anti-<insert CM tool here>
[2013-08-29 17:14:37 -0400] ichilton: I guess the only saving grace is that the servers wont have a user key, only a client key, so they can't run stuff on the chef server, right?
[2013-08-29 17:14:55 -0400] ichilton: ah, ok
[2013-08-29 17:14:59 -0400] ichilton: yeah that's not nice
[2013-08-29 17:15:06 -0400] adnichols: ichilton the other thing is you can have multiple encryption keys - so access to one server doesn't necessarily mean access to all data
[2013-08-29 17:15:07 -0400] ichilton: manual automation! :)
[2013-08-29 17:15:26 -0400] adnichols: but with the increase in security comes an increase in complexity
[2013-08-29 17:15:32 -0400] ichilton: yep
[2013-08-29 17:18:11 -0400] hasues: Is the admin user on the server?  Is this credentials for reaching the server? or...?
[2013-08-29 17:24:06 -0400] jmickle: does anyone have a list of best practices with VPC?
[2013-08-29 17:29:34 -0400] tasslehawf: What do I need to put in metadata.rb to run the default recipe?
[2013-08-29 17:29:49 -0400] tasslehawf: For a cookbook
[2013-08-29 17:32:34 -0400] jmickle: nothing
[2013-08-29 17:32:47 -0400] jmickle: tasslehawf: default recipe runs on invocation of the recipe
[2013-08-29 17:33:28 -0400] mattupstate: jmickle: i've been trying to find some recommendations on VPC as well
[2013-08-29 17:33:28 -0400] a13x212: can anyone shed some light on the option  --bootstrap-proxy
[2013-08-29 17:39:30 -0400] arpa: Anyone has any idea about this? http://stackoverflow.com/questions/18512962/use-knife-to-bootstrap-recipe-on-server-and-forward-version-parameter
[2013-08-29 17:57:40 -0400] ichilton: mattray: around?
[2013-08-29 17:57:50 -0400] mattray: ichilton: yessir
[2013-08-29 17:57:56 -0400] ichilton: mattray: Hi
[2013-08-29 17:58:38 -0400] ichilton: Do you have any experience, or idea how I can get ohai to reload & re-populate the node tree part way through a Chef run?
[2013-08-29 17:59:11 -0400] ichilton: mattray: background of why is here: https://gist.github.com/ichilton/60414902b258711d2f13
[2013-08-29 17:59:40 -0400] ichilton: mattray: and my code to try and solve it is here: https://github.com/ichilton/chef-fqdn-fix/blob/master/recipes/default.rb
[2013-08-29 18:00:05 -0400] ichilton: mattray: as you can see at the bottom of that file, i've had to bodge it because ohai isn't reloading :(
[2013-08-29 18:00:28 -0400] chris6131: ichilton: I actually had that question come up yesterday. Hopefully someone has a suggestion.
[2013-08-29 18:00:39 -0400] mattray: ichilton: the ohai cookbook restarts the chef-client run I think, lemme look
[2013-08-29 18:01:07 -0400] ichilton: chris6131: you didn't solve it?
[2013-08-29 18:01:10 -0400] ichilton: mattray: thanks!
[2013-08-29 18:01:46 -0400] mattray: https://github.com/opscode-cookbooks/ohai/blob/master/recipes/default.rb
[2013-08-29 18:01:48 -0400] chris6131: ichilton: NAh, we just decided the cookbooks could do the right thing on the second run through. Not ideal, but I'm seeing that solution offered more and more on the mailing list and in here. "Aim for eventual convergence"
[2013-08-29 18:02:01 -0400] a13x212: anyone using chef bootstrap with a ssh-gateway or proxy?
[2013-08-29 18:02:04 -0400] mattray: ichilton: so DO needs a custom ohai plugin?
[2013-08-29 18:02:13 -0400] ichilton: chris6131: ah :(
[2013-08-29 18:02:55 -0400] ichilton: mattray: ahh, I looked at that file earlier
[2013-08-29 18:03:10 -0400] ichilton: mattray: is: resource.run_action(:reload) in there not the same as:
[2013-08-29 18:03:33 -0400] ichilton:      ohai "reload" do
[2013-08-29 18:03:33 -0400] ichilton:         action :reload
[2013-08-29 18:03:34 -0400] ichilton:       end
[2013-08-29 18:03:38 -0400] ichilton: which i'm doing?
[2013-08-29 18:04:18 -0400] mattray: it's
[2013-08-29 18:04:19 -0400] mattray: https://github.com/opscode-cookbooks/ohai/blob/master/recipes/default.rb#L46
[2013-08-29 18:04:54 -0400] mattray: so essentially that's causing ohai to reload before running anything else
[2013-08-29 18:04:54 -0400] mattray: http://docs.opscode.com/chef/resources.html#ohai
[2013-08-29 18:05:45 -0400] mattray: ichilton: based on my very short introduction to what you're doing, a custom ohai plugin would be your best bet for fixing your hostname issue
[2013-08-29 18:06:00 -0400] mattray: perhaps delivered by knife-digitalocean
[2013-08-29 18:06:44 -0400] ichilton: It was the "Reload Ohai" part of http://docs.opscode.com/chef/resources.html#ohai I got that reload block from which didn't seem to work...
[2013-08-29 18:07:51 -0400] ichilton: so you would suggest an ohai plugin to set node[:hostname], node[:domain] and node[:fqdn] properly, and then write out the files properly?
[2013-08-29 18:08:04 -0400] ichilton: would that be better than this? - https://github.com/ichilton/chef-fqdn-fix/blob/master/recipes/default.rb
[2013-08-29 18:10:11 -0400] mattray: ichilton: I think so. Are you the maintainer of the knife-do plugin?
[2013-08-29 18:10:22 -0400] ichilton: mattray: no...
[2013-08-29 18:10:33 -0400] ichilton: mattray: I could submit a pull request though
[2013-08-29 18:10:56 -0400] mattray: I'd make knife-do deliver the ohai plugin in the right place
[2013-08-29 18:11:00 -0400] ichilton: mattray: any good info anywhere on how i'd create such a plugin? - and what do you mean by knife  digital_ocean delivering it?
[2013-08-29 18:11:33 -0400] mattray: ichilton: http://docs.opscode.com/community_plugin_ohai.html
[2013-08-29 18:11:37 -0400] mattray: lots of examples
[2013-08-29 18:11:47 -0400] mattray: but the ohai plugin would ensure the right values get picked up
[2013-08-29 18:11:49 -0400] mattray: for Chef
[2013-08-29 18:11:58 -0400] mattray: having knife-do deliver it is a nicety
[2013-08-29 18:12:24 -0400] mattray: you could also just use the ohai cookbook to deliver it
[2013-08-29 18:12:29 -0400] mattray: having a separate cookbook just for hacking the /etc/hosts seems hacky
[2013-08-29 18:12:35 -0400] ichilton: so basically I just write a plugin so ohai returns the correct values in node[:hostname], node[:domain] and node[:fqdn] ?
[2013-08-29 18:13:42 -0400] mattray: ichilton: yessir
[2013-08-29 18:13:49 -0400] mattray: and put that first in your run list
[2013-08-29 18:14:09 -0400] ichilton: and then have my recipes write out /etc/hostname and /etc/hosts from templates using those variables?
[2013-08-29 18:14:19 -0400] mattray: ichilton: you probably don't need thtat
[2013-08-29 18:14:33 -0400] mattray: as long as Chef is happy, you don't need the other places set
[2013-08-29 18:14:47 -0400] ichilton: yeah but them being wrong could affect other things looking for the hostname etc so i'd rather they were right...
[2013-08-29 18:14:57 -0400] mattray: sure, then that would be worthwhile
[2013-08-29 18:15:24 -0400] ichilton: so how would knife-do deliver it?
[2013-08-29 18:15:41 -0400] ichilton: is that just a case of it getting put in a certain place before the chef run?
[2013-08-29 18:15:47 -0400] ichilton: s/it/a file/
[2013-08-29 18:17:21 -0400] mattray: ichilton: hmm link to the codebase?
[2013-08-29 18:18:16 -0400] ichilton: mattray: https://github.com/rmoriz/knife-digital_ocean
[2013-08-29 18:21:06 -0400] mattray: ichilton: hmm I can't find any examples of that, all we have right now is putting hint files in place for ohai plugins to know exactly where they are
[2013-08-29 18:21:25 -0400] mattray: ichilton: so for now just put the ohai cookbook in your run list
[2013-08-29 18:21:33 -0400] mattray: and that will deliver the file
[2013-08-29 18:21:37 -0400] ichilton: ah, ok
[2013-08-29 18:22:46 -0400] ichilton: mattray: would it not be better to do a pull request on this file: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/linux/hostname.rb - and add some code into the rescue block to return the right stuff if the --fqdn fails?
[2013-08-29 18:23:25 -0400] ichilton: mattray: rather than just do that Log.debug, I could add some logic to try and return the right data in this case...
[2013-08-29 18:23:33 -0400] ichilton: s/data/fqdn/
[2013-08-29 18:23:35 -0400] mattray: ichilton: you're welcome to, but if it's very specific to DO it's unlikely to go in
[2013-08-29 18:24:02 -0400] mattray: ichilton: what are you thinking?
[2013-08-29 18:24:11 -0400] ichilton: mattray: it's not DO specific - anywhere where there is a wrong /etc/hostname file - with the fqdn in
[2013-08-29 18:28:45 -0400] ichilton: mattray: thinking something like this: https://gist.github.com/ichilton/fb83af33e966c8abee4a
[2013-08-29 18:29:31 -0400] ichilton: i.e if you can't do hostname --fqdn because it errors, then check first whether there is a fqdn coming back from hostname
[2013-08-29 18:30:30 -0400] mattray: ichilton: seems legit. I'd say open a ticket with your PR and mark as "Fix Provided". btm and others will review it Monday at the Chef review
[2013-08-29 18:30:45 -0400] mattray: ichilton: maybe not Monday, holiday. Wednesday
[2013-08-29 18:31:28 -0400] ichilton: mattray: funky, thanks
[2013-08-29 18:31:41 -0400] ichilton: i'll do that and keep this fix cookbook for the time being
[2013-08-29 18:31:50 -0400] mattray: ichilton: thanks!
[2013-08-29 18:31:55 -0400] ichilton: mattray: thank you
[2013-08-29 18:31:58 -0400] ichilton: mattray: got time for another?
[2013-08-29 18:32:08 -0400] ichilton: mattray: https://gist.github.com/ichilton/22e8690f6fcde20206dc
[2013-08-29 18:32:22 -0400] mattray: sure
[2013-08-29 18:32:44 -0400] ichilton: encrypted data bag working from command line, but not from chef-shell
[2013-08-29 18:33:49 -0400] arpa: Anyone has any idea about this? http://stackoverflow.com/questions/18512962/use-knife-to-bootstrap-recipe-on-server-and-forward-version-parameter
[2013-08-29 18:34:58 -0400] mattray: ichilton: sounds like a bug, perhaps familiar
[2013-08-29 18:35:00 -0400] mattray: Chef version?
[2013-08-29 18:36:06 -0400] ichilton: mattray: 11.6.0
[2013-08-29 18:36:21 -0400] ichilton: mattray: shall I raise an issue on github?
[2013-08-29 18:36:31 -0400] mattray: tickets.opscode.com is preferred
[2013-08-29 18:36:38 -0400] ichilton: ah, ok - will do
[2013-08-29 18:36:40 -0400] mattray: I'm looking for a ticket
[2013-08-29 18:39:15 -0400] ichilton: mattray: is it possible to create an encrypted data bag from a .rb file? - I obviously dont want my secrets going into the chef-repo, so should I check a file in with the structure, but ENV['mysecret'] for the password I want to store and then when I want to re-create the data bag, I can knife data bag from file something.rb and have ENV['mysecret'] set?
[2013-08-29 18:40:08 -0400] mattray: I think you could set it in your knife.rb
[2013-08-29 18:40:28 -0400] mattray: ENV['ENC_DATA_BAG'] or somesuch
[2013-08-29 18:40:40 -0400] ichilton: mattray: and then how would I get that value into a data bag?
[2013-08-29 18:40:41 -0400] mattray: I can't find a ticket, but that sounds like a chef-shell bug
[2013-08-29 18:40:48 -0400] ichilton: ok, i'll raise one, thanks
[2013-08-29 18:41:56 -0400] mattray: ichilton: http://docs.opscode.com/knife_data_bag.html#id10
[2013-08-29 18:42:09 -0400] stormerider: i keep getting this error about highline, any idea what's going on? https://gist.github.com/anonymous/0765cf129a0b4dd82900
[2013-08-29 18:42:23 -0400] ichilton: mattray: Another possible bug is, on a new bootstrap, I keep getting "[2013-08-29T16:31:01+00:00] WARN: Missing gem 'fog'" - any ideas?
[2013-08-29 18:42:59 -0400] mattray: ichilton: knife[:secret_file] = ENV['ENC_FILE']
[2013-08-29 18:43:14 -0400] ichilton: mattray: sorry, bad use of terminology - i'm not talking about the secret - i'm on about values inside the encrypted databag
[2013-08-29 18:43:29 -0400] mattray: ichilton: sounds like the digitalocean plugin forgot their fog dependency?
[2013-08-29 18:44:29 -0400] ichilton: mattray: i.e I might want to store my dnsimple username, password & api key in an encrypted databag - but I want a way of creating that encypted databag from my chef-repo without putting those credentials into the repo - have them as ENV vars or something - see what I mean?
[2013-08-29 18:44:37 -0400] ichilton: mattray: ahh, ok - i'll look into that, ta
[2013-08-29 18:45:52 -0400] mattray: ichilton: you can store the encrypted versions of the JSON in your source control and keep the keys external
[2013-08-29 18:46:35 -0400] mattray: so plaintext the json, encrypt it up to the server, then download it and store the encrypted version in source control
[2013-08-29 18:46:52 -0400] mattray: then the server is encrypted, the source control is encrypted
[2013-08-29 18:47:10 -0400] arpa: mattray: Hey you have any idea how I can use parameters inside a recipe? I'm referring to parameters that are passed via the -j flag to knife bootstrap. Have an example here; http://stackoverflow.com/questions/18512962/use-knife-to-bootstrap-recipe-on-server-and-forward-version-parameter
[2013-08-29 18:48:11 -0400] mattray: arpa: they just become attributes on the node
[2013-08-29 18:48:23 -0400] mattray: arpa: not every plugin supports -j though (yet)
[2013-08-29 18:48:54 -0400] arpa: mattray: I'm just using knife bootstrap, I see that it does support it
[2013-08-29 18:50:10 -0400] ichilton: mattray: ah, ok - so as long as you dont loose the key file you are fine? :)
[2013-08-29 18:50:18 -0400] arpa: mattray: Just one more thing, I have a bash "install" do part in my code and I have some code written into the remote shell (you can see it in the link), I'm not sure how to exactly include the parameter taken from the knife -j flag within that code.. can't find any examples. can you assist please?
[2013-08-29 18:50:33 -0400] mattray: ichilton: correct
[2013-08-29 18:50:42 -0400] ichilton: mattray: how would you upload the encrypted one back to the chef server if you needed to?
[2013-08-29 18:50:54 -0400] mattray: arpa: the json blob becomes attributes on the node
[2013-08-29 18:51:08 -0400] ichilton: mattray: and presumably you could decrypt locally, modify and re-upload?
[2013-08-29 18:51:19 -0400] mattray: arpa: so node['foo']['bar'] if you pass {"foo":{"bar":"123"}}
[2013-08-29 18:51:28 -0400] mattray: ichilton: correct
[2013-08-29 18:52:29 -0400] arpa: mattray: will that work? http://pastebin.com/tmqHf6MW
[2013-08-29 18:52:37 -0400] ichilton: mattray: this might be another knife-do thing, but if the initial chef run fails, if I ssh into the server and run chef-client, the runlist is empty - it seems to only set it when the chef run completes ok - is that normal?
[2013-08-29 18:52:43 -0400] arpa: Just having trouble understand how to concatenate that part to my code
[2013-08-29 18:53:25 -0400] mattray: arpa: "app@#{node['version']}"
[2013-08-29 18:53:42 -0400] mattray: arpa: mixing strings and variables
[2013-08-29 18:53:46 -0400] arpa: mattray: Thank you so much, been trying to get an answer all day :)
[2013-08-29 18:53:58 -0400] mattray: ichilton: yes, that's normal
[2013-08-29 18:54:14 -0400] mattray: ichilton: the node only persists to the server on a completed chef-client run (or a node.save)
[2013-08-29 18:54:27 -0400] mattray: you don't want broken servers showing up in search results
[2013-08-29 18:54:35 -0400] ichilton: mattray: ah, ok - so what if it fails the initial run and you want to debug?
[2013-08-29 18:54:45 -0400] ichilton: mattray: run chef client with command line params specifying the runlist?
[2013-08-29 18:55:09 -0400] mattray: ichilton: or knife node run list add NODE "role[foo]"
[2013-08-29 18:55:20 -0400] ichilton: ok
[2013-08-29 18:55:35 -0400] mattray: ok, gotta go get some work done :)
[2013-08-29 18:55:38 -0400] ichilton: when you say persists to server on successful run, what do you mean? - it seems to show up in clients and nodes straight away?
[2013-08-29 18:56:23 -0400] ichilton: mattray: one more quick question - on the above note, is there a way of running chef-client, but not have it sync the cookbooks with the server, to run using the cached copy?
[2013-08-29 18:56:57 -0400] ichilton: mattray: so if a chef run fails I might want to do some debugging on the local copy, iterate until it works, then go and fix the version in my repo and upload to the chef server
[2013-08-29 18:58:42 -0400] mattray: ichilton: yes, the node has access to it. But if you're searching for other nodes, they're asking the Chef server for that info
[2013-08-29 18:59:03 -0400] mattray: ichilton: it downloads them once and compares hashes before downloading again
[2013-08-29 18:59:34 -0400] ichilton: mattray: by role/recipe you mean? - so the node has registered with the server but it doesn't get it's runlist until it's ok?
[2013-08-29 19:00:11 -0400] mattray: ichilton: the runlist is stored on the server, when a node checks in with the server it downloads the recipes specified by the runlist
[2013-08-29 19:00:16 -0400] ichilton: mattray: yeah, but if I change the local copy and run chef-client, it re-downloads and overwrites - but I couldn't see a flag which would stop that so I could debug?
[2013-08-29 19:00:29 -0400] mattray: ichilton: chef-solo
[2013-08-29 19:00:40 -0400] ichilton: ah, ok
[2013-08-29 19:00:41 -0400] mattray: that doesn't use the server
[2013-08-29 19:00:48 -0400] ichilton: just a bit of a pig if you use databags etc
[2013-08-29 19:00:51 -0400] ichilton: or need search!
[2013-08-29 19:01:11 -0400] adnichols: ichilton a world of tradeoffs :)
[2013-08-29 19:01:20 -0400] ichilton: true :)
[2013-08-29 19:01:50 -0400] ichilton: I guess the best way is to fix the recipe locally...
[2013-08-29 19:01:57 -0400] ichilton: sorry
[2013-08-29 19:02:07 -0400] ichilton: reproduce the problem locally, fix the problem, then try the node again...
[2013-08-29 19:02:24 -0400] ichilton: adnichols: do you use berkshelf?
[2013-08-29 19:02:31 -0400] ichilton: mattray: thanks for your help
[2013-08-29 19:02:32 -0400] adnichols: yeah, depends on your workflow - I use vagrant for that stuff whenever I can
[2013-08-29 19:02:39 -0400] teukka: ichilton: chef-solo supports data bags. you just have to download them in json/rb to the node
[2013-08-29 19:02:39 -0400] mattray: ichilton: there are all sorts of hacks around it. Chef-Zero is a better fit actually
[2013-08-29 19:02:48 -0400] mattray: it's just kinda new, but it works
[2013-08-29 19:02:52 -0400] mattray: it's a local chef server
[2013-08-29 19:02:56 -0400] ichilton: mattray: I keep seeing chef-zero mentioned - must check it out
[2013-08-29 19:02:59 -0400] mattray: so data bags and search will work
[2013-08-29 19:03:21 -0400] ichilton: adnichols: me too, but if it then fails on the server when it worked on vagrant it's a pig
[2013-08-29 19:03:23 -0400] teukka: ichilton: and then there is chef-solo-search cookbook that adds search for chef-solo, but again you need to export node data
[2013-08-29 19:03:29 -0400] ichilton: adnichols: or if you skip vagrant testing and try to test on the node :)
[2013-08-29 19:03:37 -0400] adnichols: yeah
[2013-08-29 19:04:24 -0400] adnichols: I do use berkshelf - we just recently moved to it tho, not super familiar yet
[2013-08-29 19:04:39 -0400] ichilton: teukka: ok, thanks
[2013-08-29 19:04:53 -0400] ichilton: something i've had today which is a bit of a pain...
[2013-08-29 19:05:17 -0400] ichilton: I have a mycompany_services cookbook which includes stuff from mycompany_common cookbook, which is in the Berksfile as a github repo
[2013-08-29 19:05:34 -0400] ichilton: if I update mycompany_common with a quick fix, or debugging or something
[2013-08-29 19:05:40 -0400] arpa: any ideas why this command returns a gems parse error? knife bootstrap 1.2.3.4 --ssh-user root --ssh-password password --ssh-port 22 -j {version:2.3.1} --run-list "recipe[app]"
[2013-08-29 19:05:45 -0400] ichilton: then on mycompany_services I berks update && berks upload
[2013-08-29 19:06:03 -0400] ichilton: but it doesn't seem to upload to the chef server unless the version number has been bumped...
[2013-08-29 19:06:05 -0400] arpa: error related to the -j flag
[2013-08-29 19:06:10 -0400] a13x212: how do you bootstrap remote servers without exposing your chef server to the world?
[2013-08-29 19:06:17 -0400] ichilton: is that  Berkshelf not uploading it, or the server not accepting it because it doesn't see it as changed?
[2013-08-29 19:06:33 -0400] ichilton: it would be nice to do a few fixes and test them before bumping the version to do a release....
[2013-08-29 19:06:36 -0400] ichilton: any ideas?
[2013-08-29 19:07:11 -0400] troyready: a13x212, vpn?
[2013-08-29 19:12:38 -0400] arpa: I can see that knife bootstrap should support the -j flag but I cannot pass any json to it without it failing.. any ideas?
[2013-08-29 19:13:35 -0400] troyready: arpa, I haven't tried it personally, but seen it mentioned in here a few times that you might need to put the -j as the last option
[2013-08-29 19:13:55 -0400] troyready: And possibly quote around the brackets
[2013-08-29 19:14:52 -0400] arpa: Tried both: knife bootstrap 1.2.3.4 --ssh-user root --ssh-password password --ssh-port 22 --run-list "recipe[jarvis]" -j "{version:2.3.1}"
[2013-08-29 19:14:54 -0400] hasues: I installed open chef server, issued chef-server-ctl start, and I'm not seeing anything on port 443.
[2013-08-29 19:15:00 -0400] arpa: and knife bootstrap 1.2.3.4 --ssh-user root --ssh-password password --ssh-port 22 --run-list "recipe[jarvis]" -j "{'version':'2.3.1'}"
[2013-08-29 19:15:04 -0400] arpa: both fail on parsing errors
[2013-08-29 19:15:20 -0400] stormerider: hasues: did you do a reconfigure after install?
[2013-08-29 19:15:33 -0400] hasues: yes, and I'm not opposed to doing it again
[2013-08-29 19:15:47 -0400] JoseM347: hi ladies and gents
[2013-08-29 19:16:10 -0400] JoseM347: the correct way to find out what version of chef I'm running is using chef-client --version right?
[2013-08-29 19:16:11 -0400] hasues: stormerider: I just issued a reconfigure now.
[2013-08-29 19:17:31 -0400] troyready: arpa, hmmm. Frustrating -- sorry I couldn't actually help
[2013-08-29 19:17:33 -0400] hasues: stormerider: I just issued elinks <FQDN>:443 and received an SSL Error
[2013-08-29 19:17:45 -0400] arpa: troyready: Thanks for trying :)
[2013-08-29 19:17:48 -0400] stormerider: hasues: yeah, because it's a self signed cert
[2013-08-29 19:18:22 -0400] hasues: stormerider: Well, I'm just trying to make sure it is working correctly so I can get a knife configure initial working correctly
[2013-08-29 19:18:23 -0400] stormerider: if you want to use a real cert you'll need to configure it in chef-server.rb
[2013-08-29 19:18:58 -0400] stormerider: hasues: so you have to tell elinks/whatnot to accept self signed certs or test it with a real browser
[2013-08-29 19:22:23 -0400] JoseM347: why would chef-client not report the right version?
[2013-08-29 19:22:59 -0400] JoseM347: I know I have Chef 11.6.0 installed but chef-client --version reports 10.14.2
[2013-08-29 19:23:19 -0400] JoseM347: chef-apply --version properly reports the 11.6.0 version
[2013-08-29 19:23:56 -0400] teukka: arpa: json only accepts double quotes: '{"version":"2.3.1"}'
[2013-08-29 19:23:56 -0400] bean: JoseM347: chef-apply is a chef 11 tool
[2013-08-29 19:24:00 -0400] ichilton: mattray: created that bug: http://tickets.opscode.com/browse/CHEF-4506
[2013-08-29 19:24:15 -0400] ichilton: hi bean
[2013-08-29 19:24:21 -0400] ichilton: bean: you use berkshelf don't you?
[2013-08-29 19:24:22 -0400] mattray: ichilton: thanks!
[2013-08-29 19:24:33 -0400] bean: JoseM347: so if you're on the server and look at "which chef-client" and "which chef-apply" you'll likely see they're different executables,.
[2013-08-29 19:24:36 -0400] bean: ichilton: yep!
[2013-08-29 19:24:56 -0400] ichilton: bean: is there a way to berks upload even though the version number hasn't been bumped?
[2013-08-29 19:25:24 -0400] bean: good question, I'm not sure.
[2013-08-29 19:25:26 -0400] ichilton: bean: It's a bit of a pain to have to keep bumping the version during development/testing - would rather test/debug/fix and then bump the version like a release - instead of after every daft change...
[2013-08-29 19:25:44 -0400] teukka: ichilton: I think berkshelf freezes the uploaded versions by default
[2013-08-29 19:25:50 -0400] bean: ichilton: We do a lot of testing with kitchen and vagrant.
[2013-08-29 19:25:57 -0400] bean: and then I do an upload once it's good to go
[2013-08-29 19:25:57 -0400] hasues: stormerider: well, my thoughts are if I can't telnet to port 443, there must be a server config issue.
[2013-08-29 19:26:07 -0400] ichilton: teukka: yeah but you can berks update to grab the latest
[2013-08-29 19:26:32 -0400] ichilton: but when I then berks upload, it doesn't seem to put the changes on the chef server without bumping the version - not sure if it's berkshelf not uploading or the chef server not accepting
[2013-08-29 19:26:39 -0400] JoseM347: bean: I'm seeing this on a vagrant vm that I just created
[2013-08-29 19:26:39 -0400] teukka: ichilton: I mean that berkshelf tries to upload it but if it is frozen the server rejects it
[2013-08-29 19:26:47 -0400] ichilton: ah, ok
[2013-08-29 19:26:48 -0400] JoseM347: and they are all in the same directory
[2013-08-29 19:27:25 -0400] JoseM347: I just did an omnibus install too.. even when I specified a different 10.26.0 omnibus install it still showed as 10.14.2
[2013-08-29 19:28:17 -0400] teukka: ichilton: `berks upload --force` might be what you need
[2013-08-29 19:28:31 -0400] bean: thats odd, JoseM347. I've never had an omnibus install not give me the right version.
[2013-08-29 19:28:46 -0400] bean: ichilton: teukka: I was going to suggest that but I wasn't sure if --force existed
[2013-08-29 19:28:47 -0400] bean: :)
[2013-08-29 19:28:51 -0400] stormerider: ichilton: istr that's the way it's supposed to work? you can tell berks to net freeze them
[2013-08-29 19:28:54 -0400] ichilton: ah brill - i'll try that on my next update!
[2013-08-29 19:29:06 -0400] teukka: bean: just checked the help output ;)
[2013-08-29 19:29:12 -0400] bean: ahhh, good idea.
[2013-08-29 19:29:14 -0400] ichilton: thanks
[2013-08-29 19:29:22 -0400] stormerider: but if you freeze them you need to force it or use a new version
[2013-08-29 19:29:56 -0400] JoseM347: bean: I ended up using chef-shell (or shef) to confirm what version I was really running on all of our boxes using Chef::VERSION
[2013-08-29 19:30:05 -0400] JoseM347: so I'm mostly fine now
[2013-08-29 19:30:08 -0400] bean: that's valid.
[2013-08-29 19:30:40 -0400] JoseM347: I have another question though -- how does one generally update the version of chef that you have running on the server?
[2013-08-29 19:30:58 -0400] JoseM347: I want to use/update some cookbooks that rely on a newer version of chef
[2013-08-29 19:31:14 -0400] JoseM347: and I also don't want to go to version 11, I want to stick with the 10.x series
[2013-08-29 19:31:40 -0400] bean: JoseM347: I'd re-bootstrap with a new version as the version flag
[2013-08-29 19:31:56 -0400] hasues: stormerider: so knife configure initial ends with a "ERROR: Errno::EHOSTUNREACH: No route to host - connect(2)"
[2013-08-29 19:32:10 -0400] JoseM347: how exactly do  you re-bootstrap?
[2013-08-29 19:32:25 -0400] adamjk-dev: hey all... has anyone seen instances where Chef says it changed a group on a directory to something but it was changed at the end?
[2013-08-29 19:32:27 -0400] bean: well, really, i'd upgrade the client version
[2013-08-29 19:32:48 -0400] mveitas: Running the command "knife upload /environments" should upload all of the environment json files found under the environments directory correct?
[2013-08-29 19:32:55 -0400] adamjk-dev: the chef run ran successfully, said it put /var/lib/jenkins to group "nogroup", but at the end it is "adm" on an ubuntu 12.04 box
[2013-08-29 19:33:02 -0400] adamjk-dev: so my test-kitchen tests fail
[2013-08-29 19:33:14 -0400] adamjk-dev: I believe a similar problem occurred on my own RHEL box
[2013-08-29 19:34:02 -0400] JoseM347: bean: would you upgrade the client versions using chef or manually on each box?
[2013-08-29 19:34:16 -0400] bean: but you could likely do it with chef
[2013-08-29 19:36:05 -0400] mveitas: how often are the cookbook reviews done?
[2013-08-29 19:36:05 -0400] JoseM347: as far as you know, are there any guidelines/instructions/articles on how to do a chef-client upgrade using chef itself?
[2013-08-29 19:36:45 -0400] a13x212: how would i rename a file with chef?
[2013-08-29 19:37:02 -0400] jhayden: probably a dumb question but is it possible to sleep n seconds between steps in a recipe?
[2013-08-29 19:37:30 -0400] Vitor: Hi everyone.. im using encrypt databag and i have a problema with chef-server... When I created my encrypted databag using knife it works fine, but when I run "knife download *" my databag broke and I have this error: "Error decrypting data bag value: 'bad decrypt'".
[2013-08-29 19:37:48 -0400] Vitor: Is it a bug?
[2013-08-29 19:38:46 -0400] bean: JoseM347: unsure, I tried googling it. i think I just used a curl of their "install.sh" with a specific -v flag for the version
[2013-08-29 19:39:00 -0400] JoseM347: ok, yeah I have that command
[2013-08-29 19:39:28 -0400] JoseM347: I found it here
[2013-08-29 19:39:29 -0400] JoseM347: http://wiki.opscode.com/display/chef/Upgrading+Chef+0.10.x+to+the+newest+version+of+Chef
[2013-08-29 19:39:39 -0400] JoseM347: sudo true && curl -L https://www.opscode.com/chef/install.sh | sudo bash -s -- -v VERSION
[2013-08-29 19:42:36 -0400] chris6131: Hi there. I've got a library function that requires a particular gem. We make sure it is available via chef_gem with an added "run_action(:install)" to force it in at compile time so recipes that need it will work. Unfortunately it seems that libraries load before recipes, so by the time the library load the gem isn't installed yet. What do?
[2013-08-29 19:42:40 -0400] adamjk-dev: anyone seen Chef says it changed the group on a directory, but at the end of the run it wasnt?
[2013-08-29 19:44:07 -0400] josephholsten: adamjk-dev: I've had a resource explicitly say the group on a directory, but have it not be applied
[2013-08-29 19:44:45 -0400] josephholsten: but it was a group for a user from pbis-open/likewise-open. and the chef convergence never said it was setting the group
[2013-08-29 19:45:39 -0400] josephholsten: any rackspace users who've hit ohai-499: I'd appreciate a review of https://github.com/opscode/ohai/pull/183
[2013-08-29 19:45:49 -0400] josephholsten: gchristensen: ^^
[2013-08-29 19:46:19 -0400] adamjk-dev: josephholsten: really? it says it did it and set it: nogroup:x:65534:
[2013-08-29 19:46:26 -0400] adamjk-dev: josephholsten: so i am quite confused
[2013-08-29 19:47:05 -0400] tasslehawf: What do I have to modify in order to make the opscode-cookbooks/jenkins actually install jenkins? Or should I create my own cookbook to load jenkins?
[2013-08-29 19:49:15 -0400] cwj: tasslehawf: are you using the cookbook from HEAD on github? the latest released version on the community site (0.6.3) does install jenkins
[2013-08-29 19:49:53 -0400] josephholsten: tasslehawf: I use jenkins::server and jenkins::proxy_apache2
[2013-08-29 19:50:52 -0400] tasslehawf: hm ok
[2013-08-29 19:51:28 -0400] adamjk-dev: tasslehawf: I use jenkins::server for the server, and jenkins::node for any slaves
[2013-08-29 19:51:51 -0400] tasslehawf: where do I specify jenkins::server?
[2013-08-29 19:54:26 -0400] gchristensen: josephholsten: hi
[2013-08-29 19:54:30 -0400] leifmadsen: chris6131: as we found out, the solution was to move the require line from above the class definition to inside the method. (noted for historical purposes)
[2013-08-29 19:54:58 -0400] gchristensen: josephholsten: looks fine to me
[2013-08-29 19:55:17 -0400] gchristensen: josephholsten: thank you a bundle for doing this :) I simply don't have the bandwidth to do it until like the 20th of next month.
[2013-08-29 19:55:22 -0400] josephholsten: hopefully it'll get it this time
[2013-08-29 19:56:09 -0400] josephholsten: you did the hard work of tracking down the actual problem. I've been hitting my head against it magically being broken for months
[2013-08-29 20:00:25 -0400] gchristensen: josephholsten: amusingly I didn't notice it being broken at all until they upgraded ohai, it was when they improved the rackspace detection when it broke all my infrastructure :)
[2013-08-29 20:05:33 -0400] benjohnson77: has anyone had experience with google cloud and could give me an off the record opinion of Google cloud engine (not app engine) and rackspace
[2013-08-29 20:06:39 -0400] siezer: benjohnson77 I haven't used it myself, but I hear its hella fast
[2013-08-29 20:06:54 -0400] siezer: I also heard something about there being a minimum monthly spend just to play
[2013-08-29 20:06:55 -0400] benjohnson77: boot from image time is 40 secs
[2013-08-29 20:06:58 -0400] siezer: not sure if that's still accurate
[2013-08-29 20:07:25 -0400] benjohnson77: we have haven't seen that
[2013-08-29 20:07:56 -0400] benjohnson77: started with 4 server and they accepted an quota increase to 25 servers in 24 hours
[2013-08-29 20:08:26 -0400] siezer: wow 40s?
[2013-08-29 20:09:21 -0400] benjohnson77: yeah boot from image and all the virtual machine operations are hella fast
[2013-08-29 20:09:23 -0400] gchristensen: benjohnson77: I do not care for rackspace... as a fairly large customer.
[2013-08-29 20:09:32 -0400] benjohnson77: yeah me too
[2013-08-29 20:09:53 -0400] gchristensen: my theory / concern is GCE is only super fast right now because its under-utilized
[2013-08-29 20:10:29 -0400] benjohnson77: true some degridation is expected ... but the starting point is really good
[2013-08-29 20:10:57 -0400] siezer: I think what took them so long to release GCE was they spent a brazillion years trying to get IO down
[2013-08-29 20:11:03 -0400] gchristensen: I'm migrating all my stuff over to softlayer's dedicated hardware, which is provisioned pretty great.
[2013-08-29 20:11:03 -0400] siezer: instead of using bigtable
[2013-08-29 20:11:20 -0400] siezer: I bet it stays fast
[2013-08-29 20:12:44 -0400] benjohnson77: well I am moving forward with migration from RS to GCE and so far I am liking it ... I think I conquered all the debian 7 issues so far
[2013-08-29 20:13:13 -0400] gchristensen: what sort of issues did you see?
[2013-08-29 20:13:44 -0400] mveitas: I am trying to run "knife upload environments", but nothing seems to be happening, other things such as roles are being pushed up just fine to the server
[2013-08-29 20:14:38 -0400] benjohnson77: Ubunutu handled $PATH differently so once I realized it I set path in my sudoers and fixed several issues. also locales recipe had to be added.
[2013-08-29 20:14:56 -0400] benjohnson77: the debian 7 image that GCE gives you is pretty bare
[2013-08-29 20:15:06 -0400] siezer: benjohnson77 good to know. I plan to give it a whirl on the eventual
[2013-08-29 20:15:38 -0400] gchristensen: ahh
[2013-08-29 20:18:40 -0400] benjohnson77: nothing big ... just some ubuntu niceties taken for granted. figuring out load balancing and google mysql stuff now
[2013-08-29 20:24:13 -0400] josephholsten: how would people feel about storing bootstrap templates in the chef-server?
[2013-08-29 20:28:28 -0400] dgarstang: Whoa! Google has a 2nd customr for GCE!
[2013-08-29 20:31:52 -0400] tasslehawf: This is my default.rb file
[2013-08-29 20:31:53 -0400] tasslehawf: https://github.com/hayesmp/jenkins-cookbook/blob/master/metadata.rb
[2013-08-29 20:32:06 -0400] tasslehawf: Still not actually installing anything on my server
[2013-08-29 20:34:20 -0400] eherot: How do I make something in a recipe run explicitly during the *converge* phase of a chef run?
[2013-08-29 20:38:42 -0400] eherot: nevermind, #chef.  Just found http://docs.opscode.com/resource_ruby_block.html
[2013-08-29 20:42:53 -0400] ianco: does anyone know if a cookbook for circus exist?
[2013-08-29 20:42:56 -0400] ianco: http://circus.readthedocs.org/
[2013-08-29 20:59:40 -0400] EricL: Is there a good way to do the touch tmp/restart.txt using the application_ruby cookbook for a Rails app?
[2013-08-29 21:00:06 -0400] EricL: I obviously only wnat to do this on new code deploys and not on every chef-client ruj.
[2013-08-29 21:00:39 -0400] mattupstate: EricL: set the restart command to that?
[2013-08-29 21:01:29 -0400] ianco: EricL, the deploy resource can do that
[2013-08-29 21:02:00 -0400] EricL: I know the deploy resource can do that, but I can't tell if the rails resource is a wrapper on the deploy resource.
[2013-08-29 21:02:07 -0400] EricL: If it is, then I can use the restart command.
[2013-08-29 21:02:16 -0400] dgarstang: Can anyone recommend a good tool for reading yaml config of ec2 instances and spinning em up?
[2013-08-29 21:02:39 -0400] ianco: What do you mean you cant tell?
[2013-08-29 21:04:28 -0400] EricL: ianco: I mean I looked in the application_ruby cookbook and I don't see it reference a deploy resource.
[2013-08-29 21:05:19 -0400] ianco: EricL: https://github.com/opscode-cookbooks/application/blob/master/providers/default.rb
[2013-08-29 21:06:25 -0400] ianco: rather, https://github.com/opscode-cookbooks/application/blob/master/providers/default.rb#L122
[2013-08-29 21:07:11 -0400] ianco: EricL, thats where the magic happens i guess. hopefully thats helpful
[2013-08-29 21:07:56 -0400] ianco: i dont use the app cookbooks mysql
[2013-08-29 21:08:01 -0400] ianco: er, myself :P
[2013-08-29 21:08:23 -0400] EricL: ianco: Ah, so I can use the restart command.  Excellent.
[2013-08-29 21:08:26 -0400] EricL: Thanks
[2013-08-29 21:10:30 -0400] ianco: anytime
[2013-08-29 21:11:24 -0400] dgarstang: Can anyone recommend a good tool for reading yaml config of ec2 instances and spinning em up?
[2013-08-29 21:17:11 -0400] pwf: ec2 instance got rebooted and now i'm getting this:
[2013-08-29 21:17:11 -0400] pwf: ==> /var/log/chef-server/chef-server-webui/current <==
[2013-08-29 21:17:11 -0400] pwf: 2013-08-29_21:16:44.07887 /usr/bin/env: ruby: No such file or directory
[2013-08-29 21:17:23 -0400] pwf: what have i done!
[2013-08-29 21:18:36 -0400] bean: it doesn't know where ruby is :o
[2013-08-29 21:19:13 -0400] pwf: yeah, there is no system ruby
[2013-08-29 21:19:21 -0400] pwf: not sure why it's not using the embedded ruby
[2013-08-29 21:42:55 -0400] dgarstang: Can anyone recommend a good tool for reading yaml config of ec2 instances and spinning em up?
[2013-08-29 21:44:08 -0400] benjohnson77: dgarstang: I usually keep a set of bash files in an infrastructure folder, these have my knife commands for building the env and boot strapping it
[2013-08-29 21:45:29 -0400] pwf: after rebooting, runsv is trying really hard to run nginx twice
[2013-08-29 21:45:34 -0400] pwf: why is this happening :(
[2013-08-29 21:46:31 -0400] JoseM347: can knife tell you the version of cookbook that a node is using?
[2013-08-29 21:46:40 -0400] dgarstang: benjohnson77: knife don't work for us. it's not so good at proxying through an intermediate ssh host
[2013-08-29 21:46:49 -0400] JoseM347: or can we get the information from the node itself using chef-client or some other tool?
[2013-08-29 21:46:59 -0400] kl4m: Can someone explain to me the logic behind changing node attributes like this? https://github.com/opscode-cookbooks/jenkins/commit/9a3c5c9c83b191b0f52297db2aae48d7be55488f
[2013-08-29 21:47:59 -0400] kl4m: pwf. Are there two installations of nginx fighting over the same listen port?
[2013-08-29 21:48:15 -0400] pwf: well it turns out it's happening for all chef-server processes
[2013-08-29 21:48:18 -0400] pwf: erchef too at least
[2013-08-29 21:51:20 -0400] zenloop: I am using the service resource to enable and start a service and while the service gets enabled it does not start.  Is anything wrong with this call of the service resource?  http://pastie.org/8281616
[2013-08-29 21:51:49 -0400] justizin: anyone use knife-ec2 with VPC? just seems to wait for ssh forever, even though it has a security group that allows 22, has an EIP attached, and a manual ssh works fine.
[2013-08-29 21:52:14 -0400] kl4m: zenloop, what does "/usr/sbin/service buildbot start" says?
[2013-08-29 21:53:13 -0400] zenloop: totally works.  hmmmm. I can use a list of actions right?
[2013-08-29 21:53:25 -0400] zenloop: kl4m: thanks for the tip though.
[2013-08-29 21:53:45 -0400] djustin: I'm playing around with the opscode cookbook for windows...resource: windows_zipfile, but can't get it to function...anyone familiar with this?  the resource installs rubyzip, but then fails on require'zip/zip'
[2013-08-29 21:53:47 -0400] kl4m: zenloop, yes, action can be an array.
[2013-08-29 21:59:16 -0400] ichilton: Is it possible to change a chef node name and client name during the chef run? (if changing the hostname of the box)?
[2013-08-29 22:06:22 -0400] cwj: ichilton: i think that would require two separate chef runs
[2013-08-29 22:06:51 -0400] cwj: and some mechanism for copying the node attributes if you wanted to preserve run list etc
[2013-08-29 22:08:16 -0400] ichilton: ok, thanks
[2013-08-29 22:12:17 -0400] ichilton: Is there a non-deprecated way of automatically copying the encrypted databag key file to nodes on bootstrap or only supplying the param to bootstrap?
[2013-08-29 22:14:33 -0400] dgarstang: Can anyone recommend a good tool for reading yaml config of ec2 instances and spinning em up?
[2013-08-29 22:25:36 -0400] micxer: I see the following error when doing a vagrant up using the opscode-debian-7.1.0 basebox
[2013-08-29 22:27:01 -0400] micxer: "sudo: no tty present and no askpass program specified" when vagrant tries to set the hostname
[2013-08-29 22:27:29 -0400] micxer: anyone else seeing this? did the basebox change in the last 24 hours?
[2013-08-29 22:27:44 -0400] micxer: didn't find any change in the bento repo
[2013-08-29 22:37:45 -0400] siezer: benr sweet ipv6 irc address
[2013-08-29 22:37:59 -0400] benr: Question.... I'm trying to use VAR.chomp in a recipe, but it doesn't actually seem to chomp.
[2013-08-29 22:38:00 -0400] micxer: hmm, seems like everybody is already sleeping...
[2013-08-29 22:38:09 -0400] benr: siezer, thanks. ;)
[2013-08-29 22:38:15 -0400] siezer: is VAR a string?
[2013-08-29 22:38:19 -0400] benr: yes
[2013-08-29 22:38:30 -0400] siezer: var = other_var.chomp?
[2013-08-29 22:38:38 -0400] benr: I'm returning a string from backticks...
[2013-08-29 22:38:38 -0400] siezer: or other_var.chomp!
[2013-08-29 22:38:47 -0400] benr: var = `some command`
[2013-08-29 22:38:48 -0400] benr: var.chomp
[2013-08-29 22:38:55 -0400] benr: i get the var, but no chomp :(
[2013-08-29 22:38:58 -0400] benr: same with strip
[2013-08-29 22:39:52 -0400] ichilton: Anyone with Berkshelf knowledge any idea on this? - https://github.com/RiotGames/berkshelf/issues/825
[2013-08-29 22:39:56 -0400] afirth: try var = `command`.chomp
[2013-08-29 22:40:03 -0400] benr: ya, trying that now
[2013-08-29 22:40:12 -0400] afirth: if you want in place, you need chomp!
[2013-08-29 22:40:17 -0400] afirth: http://ruby-doc.org/core-2.0.0/String.html#method-i-chomp
[2013-08-29 22:40:30 -0400] siezer: benr var.chomp! will replace var with the chomped version
[2013-08-29 22:40:55 -0400] siezer: var.returns a chomped string to whatever's listening (maybe nothing)
[2013-08-29 22:41:01 -0400] siezer: er.. var.chomp
[2013-08-29 22:41:31 -0400] afirth: sometimes ruby is really stupid
[2013-08-29 22:42:31 -0400] benr: var = x.chomp didn't work
[2013-08-29 22:42:33 -0400] siezer: the do_things_in_place! thing is a common ruby pattern
[2013-08-29 22:42:34 -0400] a13x212: anyone using rsync in chef recipes?
[2013-08-29 22:42:38 -0400] benr: trying `...`.chomp
[2013-08-29 22:43:59 -0400] benr: now it doesn't even show as defined.
[2013-08-29 22:44:22 -0400] siezer: benr https://gist.github.com/someara/4286e3551c97a42426c2
[2013-08-29 22:44:49 -0400] benr: siezer, I know how chomp works. :)
[2013-08-29 22:44:57 -0400] benr: I'm unclear on why its not working in my recipe
[2013-08-29 22:45:10 -0400] afirth: talk to the duck :)
[2013-08-29 22:45:15 -0400] siezer: and https://gist.github.com/someara/6eb0ce449c9963255681
[2013-08-29 22:45:17 -0400] siezer: oh
[2013-08-29 22:45:18 -0400] benr: :)
[2013-08-29 22:45:44 -0400] benr: thats why this is driving me slightly insane.
[2013-08-29 22:46:49 -0400] siezer: this isn't working for you? https://gist.github.com/someara/9be6477b5fd25776de12
[2013-08-29 22:47:13 -0400] benr: nope
[2013-08-29 22:47:31 -0400] benr: gonna just drop in some debug and figure out wuz up.
[2013-08-29 22:49:40 -0400] siezer:  /opt/chef/embedded/bin/gem install pry ; chef-shell -s
[2013-08-29 22:51:27 -0400] Arizona: hello everyone, please help me with encrypted databags?
[2013-08-29 22:54:45 -0400] benr: siezer, looks like var = `something`.chomp  is doing the trick for me now, i had another bug that was interfering
[2013-08-29 22:54:48 -0400] benr: thanks for the help! :)
[2013-08-29 22:55:36 -0400] siezer: squish!
[2013-08-29 23:02:22 -0400] ichilton: arpa: Did you get your parameter thing sorted?
[2013-08-29 23:05:14 -0400] dgarstang: Can I get 'knife ec2 server create' to bring up a new box  but NOT try and ssh into it?
[2013-08-29 23:05:29 -0400] derks: Hello, I have problem.  In my attributes/default.rb I define all the attributes, except a few which are required to be set..  in the template, all defaults appear except those three
[2013-08-29 23:05:56 -0400] derks: even though 'knife node edit -a' I can see those atrributes are set
[2013-08-29 23:06:11 -0400] derks: The cookbook is here https://github.com/TrueAbility/graphdat-cookbook
[2013-08-29 23:09:23 -0400] invsblduck: derks: i don't see anywhere in the recipe where the node attributes are getting set?
[2013-08-29 23:10:09 -0400] derks: invsblduck, the default is set in attributes/default.rb ... but the default is empty (because there is no sane default, the user has to set them)
[2013-08-29 23:10:21 -0400] invsblduck: derks: you mean set them from knife?
[2013-08-29 23:10:24 -0400] derks: in node/environment/role attributes
[2013-08-29 23:12:03 -0400] derks: invsblduck ... nm, I just realized my json is jacked
[2013-08-29 23:12:12 -0400] invsblduck: derks: hm, do you have the role..... nm :)
[2013-08-29 23:13:25 -0400] derks: i set the attrs in my environment... but nested under another attr accidentally
[2013-08-29 23:14:23 -0400] dgarstang: Can I get 'knife ec2 server create' to bring up a new box  but NOT try and ssh into it?
[2013-08-29 23:15:33 -0400] invsblduck: dgarstang: probably not unless you modify the ec2 plugin code
[2013-08-29 23:15:45 -0400] dgarstang: invsblduck: ugh
[2013-08-29 23:15:46 -0400] invsblduck: dgarstang: but that's only from my experience with the rackspace plugin.
[2013-08-29 23:16:33 -0400] invsblduck: dgarstang: but don't take my word for it... read the code
[2013-08-29 23:16:54 -0400] dgarstang: invsblduck: yeah, ruby.... err.... blah
[2013-08-29 23:17:37 -0400] dgarstang: where would the ruby files for knife-ec2 be installed?
[2013-08-29 23:18:08 -0400] invsblduck: dgarstang: gem contents knife-ec2
[2013-08-29 23:19:13 -0400] invsblduck: Anyone know if tags are easily searchable from a recipe?  Docs i found don't have examples for that.
[2013-08-29 23:24:21 -0400] siezer: invsblduck sure, just search for "tags:pattern"
[2013-08-29 23:32:57 -0400] dgarstang: invsblduck: Well, I can't even find the code. :(
[2013-08-29 23:33:59 -0400] dgarstang: ah there it is /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/knife-ec2-0.6.4/lib/chef/knife/ec2_server_create.rb
[2013-08-29 23:51:17 -0400] julian-delphiki: dgarstang, I honestly dont understand how you can work with chef and at least be /moderatly/ okay with working with ruby code.
[2013-08-29 23:51:26 -0400] julian-delphiki: chef is a ruby DSL ffs.
[2013-08-29 23:52:26 -0400] siezer: I've been using chef for 3 years and am just not getting around to "learning ruby"
[2013-08-29 23:52:32 -0400] siezer: er, "just now"
[2013-08-29 23:52:42 -0400] siezer: I've been able to fake it before
[2013-08-29 23:58:04 -0400] timsmith: you can get around with a VERY basic concept of ruby and do quite well
[2013-08-29 23:59:33 -0400] yfeldblum: but it really helps to learn ruby in order to do the advanced things
