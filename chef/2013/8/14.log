[2013-08-14 00:01:17 -0400] joefitzgerald: coderanger: i don't seem to be able to set issues @ tickets.opscode.com to the state 'fix provided'
[2013-08-14 00:01:22 -0400] joefitzgerald: i've signed the CLA, etc
[2013-08-14 00:02:16 -0400] joefitzgerald: coderanger: any idea why? http://tickets.opscode.com/browse/COOK-3447 / http://tickets.opscode.com/browse/COOK-3060 / http://tickets.opscode.com/browse/COOK-2098
[2013-08-14 00:04:22 -0400] coderanger: joefitzgerald: When did you sign it?
[2013-08-14 00:04:31 -0400] joefitzgerald: hmm yesterday ;)
[2013-08-14 00:04:45 -0400] joefitzgerald: patience is a virtue, i guess :P
[2013-08-14 00:04:52 -0400] coderanger: Heh, give it a few days, reviewing the CLAs and updating jira groups is manual still
[2013-08-14 00:05:03 -0400] joefitzgerald: ok, no worries
[2013-08-14 00:05:10 -0400] coderanger: It makes our legal dept happier to know that a human has to actually look at each :)
[2013-08-14 00:05:22 -0400] joefitzgerald: hehe
[2013-08-14 00:28:47 -0400] joefitzgerald: coderanger: think this might be a better option: https://github.com/opscode-cookbooks/windows/pull/45/files
[2013-08-14 00:29:06 -0400] joefitzgerald: instead of setting the default, just use the node attribute in preference to the timeout if it exists
[2013-08-14 00:29:16 -0400] joefitzgerald: avoids sequencing issues?
[2013-08-14 00:29:21 -0400] coderanger: Probably safer
[2013-08-14 00:29:31 -0400] coderanger: but I leave windows-y things to others :)
[2013-08-14 00:29:37 -0400] joefitzgerald: i wish i could
[2013-08-14 00:29:52 -0400] joefitzgerald: but i have to leave the safety of my mac daily
[2013-08-14 01:51:23 -0400] postwait: I have a variable I'm passing into anerb.
[2013-08-14 01:51:25 -0400] postwait: erb.
[2013-08-14 01:51:44 -0400] postwait: how can I take that variable and spit it into the erb as json?
[2013-08-14 01:58:31 -0400] coderanger: <%= @foo.to_json %>
[2013-08-14 02:05:51 -0400] coderanger: postwait: As a note, if the whole file is JSON it is generally easier to use a file resource and the #content attr
[2013-08-14 02:05:58 -0400] miah: assuming the variable object supports .to_json =)
[2013-08-14 02:06:02 -0400] postwait: thanks
[2013-08-14 02:32:18 -0400] postwait: can I use ohai info in a attributes/default.rb ?
[2013-08-14 02:32:57 -0400] coderanger: postwait: Yes
[2013-08-14 02:34:41 -0400] postwait: syntax for that?
[2013-08-14 02:35:15 -0400] postwait: I'm trying to get the primary IPs on every interface in my box.
[2013-08-14 02:37:12 -0400] postwait: think I found an example
[2013-08-14 03:35:35 -0400] joefitzgerald: how can i add a depends "mycookbook" with a git branch in metadata.rb?
[2013-08-14 03:37:18 -0400] joefitzgerald: my issue is that i am using berkshelf for the dependencies, and a berks update does get the right git branch, but on a vagrant up, it's resetting the cookbook back to the master branch (which i assume is because of metadata.rb)
[2013-08-14 03:47:25 -0400] coderanger: joefitzgerald: Add it to both the metadata.rb and the berksfile
[2013-08-14 03:49:52 -0400] joefitzgerald: whats the syntax for a branch for metadata.rb
[2013-08-14 03:50:54 -0400] coderanger: There isn't one
[2013-08-14 03:51:15 -0400] coderanger: metadata.rb only groks versions, the only "source" it understands is the chef server
[2013-08-14 03:51:24 -0400] coderanger: (or folder, if using solo)
[2013-08-14 06:03:07 -0400] Levin_22: somebody awake?
[2013-08-14 06:04:24 -0400] coderanger: For a few more minutes
[2013-08-14 06:05:40 -0400] Levin_22: Hi code ranger. I have a noob problem, i googled but no lucjs
[2013-08-14 06:05:47 -0400] Levin_22: lucks*
[2013-08-14 06:06:27 -0400] Levin_22: I've created a new cookbook to deploy an rails app with application_ruby cook
[2013-08-14 06:06:27 -0400] coderanger: What seems to be the issue
[2013-08-14 06:06:38 -0400] Levin_22: But i have a issue in the template.
[2013-08-14 06:07:04 -0400] Levin_22: The templates of apache compile fine..
[2013-08-14 06:07:26 -0400] Levin_22: with some attributes like node[apache][contact]
[2013-08-14 06:07:56 -0400] Levin_22: but I've added an attribute default['racking']
[2013-08-14 06:08:11 -0400] Levin_22: it doesn't compile
[2013-08-14 06:08:46 -0400] coderanger: What is the actual error
[2013-08-14 06:08:58 -0400] Levin_22: by the erb. I called with <%=  node['rackenv']%> and nothing
[2013-08-14 06:09:17 -0400] Levin_22: thats the error.  i want use the attaributes to setup the environment
[2013-08-14 06:09:30 -0400] Levin_22: But it no gets rendered
[2013-08-14 06:09:55 -0400] coderanger: Please pastebin the relevant files from the cookbook
[2013-08-14 06:10:02 -0400] Levin_22: ok
[2013-08-14 06:13:55 -0400] Levin_22: sorry
[2013-08-14 06:13:57 -0400] Levin_22: this
[2013-08-14 06:13:58 -0400] Levin_22: http://pastebin.com/74GnttH1
[2013-08-14 06:14:04 -0400] Levin_22: this look like
[2013-08-14 06:17:38 -0400] coderanger: Levin_22: Looks okay to me, what does the rendered template look like?
[2013-08-14 06:18:35 -0400] Levin_22: it rendered everything fine but node['rails-demo']['rackenv']
[2013-08-14 06:19:15 -0400] Levin_22: i don't know what mistake I'm doing
[2013-08-14 06:19:15 -0400] coderanger: What does that line look like
[2013-08-14 06:19:24 -0400] Levin_22: waitme
[2013-08-14 06:19:34 -0400] coderanger: or is it just not there
[2013-08-14 06:20:06 -0400] Levin_22: RackEnv "blank_space"
[2013-08-14 06:20:20 -0400] Levin_22: i mean "RackEnv" nothing more
[2013-08-14 06:20:48 -0400] Levin_22: that cause error on apache cookbook. I can put the environment manually in the template
[2013-08-14 06:21:17 -0400] coderanger: Okay, are you sure you are uploading the cookbook up to your chef server?
[2013-08-14 06:21:22 -0400] Levin_22: but i don't understand these error
[2013-08-14 06:21:34 -0400] Levin_22: Yes
[2013-08-14 06:21:52 -0400] Levin_22: i upload then use vagrant provision
[2013-08-14 06:22:00 -0400] Levin_22: ill try to halt the machine
[2013-08-14 06:22:03 -0400] coderanger: Hmm, are the other node['apache'] things filling in?
[2013-08-14 06:22:14 -0400] coderanger: Because that sounds weird, our cookbook is apache2, not apache
[2013-08-14 06:22:50 -0400] coderanger: apparently the attrs are under node['apache'] though
[2013-08-14 06:22:52 -0400] coderanger: thats ... weird
[2013-08-14 06:23:01 -0400] coderanger: But still, nothing wrong on your end there
[2013-08-14 06:23:33 -0400] coderanger: Is there anything else writing to that attribute or overriding it in a role?
[2013-08-14 06:24:41 -0400] Levin_22: I've try node['rackenv'] and node['rails-demo']['rack-env']
[2013-08-14 06:24:45 -0400] Levin_22: both fails
[2013-08-14 06:24:55 -0400] Levin_22: default['apache']['contact'] = "ops@example.com"
[2013-08-14 06:25:09 -0400] Levin_22: these are attributes defined on apache2 cookbook
[2013-08-14 06:25:19 -0400] coderanger: node['rails-demo']['rack-env'] is correct based on your attributes file
[2013-08-14 06:25:19 -0400] Levin_22: All these fine.
[2013-08-14 06:25:50 -0400] coderanger: Try this
[2013-08-14 06:26:15 -0400] coderanger: knife node show -Fj -l <the node name>
[2013-08-14 06:26:38 -0400] coderanger: and look for "rails-demo": {"rackenv": "production"}
[2013-08-14 06:26:43 -0400] coderanger: I'm fading, got to sleep, sorry
[2013-08-14 06:26:51 -0400] Levin_22: Ok, wait me a second the machine is rebooting
[2013-08-14 06:27:01 -0400] Levin_22: Ok, thanks bro.
[2013-08-14 06:29:06 -0400] Levin_22: i can't see there
[2013-08-14 06:29:17 -0400] Levin_22: maybe thats the problem
[2013-08-14 07:15:23 -0400] tugce: Hello everyone. I installed both chef server and client. When I ran command sudo chef-server-ctl reconfigure I get an error "Error executing action `run` on resource 'execute[/opt/chef-server/embedded/bin/chpst -u chef_server -U chef_server /opt/chef-server/embedded/bin/rabbitmqctl wait /var/opt/chef-server/rabbitmq/db/rabbit@localhost.pid]'  ". How can I reconfigure server without errors?
[2013-08-14 07:17:10 -0400] tugce: This is full error message; http://pastebin.com/6AJPGTVS
[2013-08-14 07:22:44 -0400] kisoku: so. I mass edited a bunch of nodes using knife exec and nodes.transform
[2013-08-14 07:22:56 -0400] kisoku: moved them from one environment to another
[2013-08-14 07:23:06 -0400] kisoku: but none of the changes are showing up in search
[2013-08-14 07:23:10 -0400] kisoku: any idea why ?
[2013-08-14 09:22:56 -0400] tugce: When using knife configure --initial, which keys we should refer?
[2013-08-14 10:49:58 -0400] mirkokiefer: hey, I'm having trouble with the mysql cookbook
[2013-08-14 10:50:14 -0400] mirkokiefer: it looks like it doesn't run "apt-get update" before the install
[2013-08-14 10:50:24 -0400] mirkokiefer: although I have added apt to the run list
[2013-08-14 10:57:09 -0400] jhammerman: Hi Chef IRC. Can anyone help me programtically get the ip of eth1.200? Using the logic I can find via Google, the value keeps getting rendered into a hash...
[2013-08-14 11:04:29 -0400] mirkokiefer: got it to work - sorry to bother
[2013-08-14 11:10:39 -0400] zts: mirkokiefer: no apologies necessary - what was the problem?
[2013-08-14 11:10:53 -0400] zts: jhammerman: can you gist/pastebin what you're trying that hasn't worked?
[2013-08-14 11:11:06 -0400] jhammerman: zts:sure
[2013-08-14 11:11:20 -0400] mirkokiefer: I don't actually know...
[2013-08-14 11:11:56 -0400] mirkokiefer: it still doesn't work if I change the order of includes in my recipe
[2013-08-14 11:12:06 -0400] zts: mirkokiefer: for what it's worth, having "recipe[apt]" on your run list should run 'apt-get update' occasionally.  I wouldn't expect the mysql cookbook to ensure that happened, though
[2013-08-14 11:12:32 -0400] jhammerman: http://pastebin.com/dB55xXm5
[2013-08-14 11:13:08 -0400] jhammerman: I've tried a variety of tactics, no matter what I get a MAC address when the value is rendered into a template
[2013-08-14 11:13:28 -0400] mirkokiefer: this is what I'm doing:
[2013-08-14 11:13:29 -0400] mirkokiefer: https://gist.github.com/mirkokiefer/6230099
[2013-08-14 11:13:40 -0400] mirkokiefer: I'm using vagrant
[2013-08-14 11:13:56 -0400] mirkokiefer: so when I do vagrant destroy and up I would expect apt to always run
[2013-08-14 11:15:02 -0400] zts: mirkokiefer: I would too, looking at that - although I've never used the add_recipe thing.
[2013-08-14 11:15:09 -0400] mirkokiefer: so in the gist when I move 'include_recipe "nodejs"' to the top it somehow doesn't run apt update before installing mysql
[2013-08-14 11:15:25 -0400] zts: jhammerman: just having a look now.  I guess cluster_members is a set of nodes returned by search?
[2013-08-14 11:15:47 -0400] jhammerman: zts:Yes
[2013-08-14 11:16:01 -0400] jhammerman: At the moment, that array consists of only this member
[2013-08-14 11:18:47 -0400] jhammerman: zts: is there a way to print the contents of the cluster_ips variable during the chef run?
[2013-08-14 11:21:48 -0400] mirkokiefer: I added my console output with the error to the gist
[2013-08-14 11:21:48 -0400] zts: jhammerman: well, yes and no - cluster_ips will be an array of node objects, printing them won't always give you any useful information.  You could call .to_json on the node and print that, but you'll get an awful lot of data you don't care about
[2013-08-14 11:21:49 -0400] mirkokiefer: https://gist.github.com/mirkokiefer/6230099
[2013-08-14 11:22:41 -0400] nebrera2: helllo
[2013-08-14 11:23:18 -0400] nebrera2: I have a variable I set to false with ohai (every time the chef-client connect to my erchef server)
[2013-08-14 11:24:01 -0400] nebrera2: sometimes I set the same to true path with api at erchef server (with the chef api gem) and it is always false
[2013-08-14 11:24:14 -0400] mirkokiefer: zts: would be great if you could have a look
[2013-08-14 11:24:19 -0400] zts: jhammerman: just playing around with that in the chef shell, and your snippet actually works for me
[2013-08-14 11:24:50 -0400] jhammerman: zts: I wonder it is because there is OS level VLAN tagging?
[2013-08-14 11:25:24 -0400] jhammerman: Even s[:ipaddress] is yielding a MAC addr
[2013-08-14 11:25:33 -0400] zts: jhammerman: possibly - I'd suggest stepping back a bit and looking at the data.  Let me gist what I saw on my example machine so that you've got something to compare to
[2013-08-14 11:27:45 -0400] zts: jhammerman: https://gist.github.com/zts/6f4a0e457a2588b62d1e
[2013-08-14 11:29:01 -0400] zts: mirkokiefer: ah, I think I understand the problem
[2013-08-14 11:31:01 -0400] mirkokiefer: zts: the add_recipe thing seems to correctly set the run_list
[2013-08-14 11:31:03 -0400] mirkokiefer: any idea?
[2013-08-14 11:31:07 -0400] zts: mirkokiefer: the mysql cookbook is attempting to install the packages at recipe compile time.  The apt cookbook doesn't run apt-get until the converge phase.  That means that even though the "apt" recipe comes first, "mysql::ruby" is forcing a package install before apt does its thing
[2013-08-14 11:32:12 -0400] zts: I'm not really sure what the right solution is for that, though it seems like it should be a common issue
[2013-08-14 11:32:33 -0400] mirkokiefer: but how come it works if the nodejs include is at the bottom?
[2013-08-14 11:33:45 -0400] mirkokiefer: I was under the impression that apt actually does an apt update at compile time
[2013-08-14 11:33:46 -0400] zts: mirkokiefer: no idea :)  Can you also gist the log from when it works?
[2013-08-14 11:33:48 -0400] mirkokiefer: reading this:
[2013-08-14 11:33:48 -0400] mirkokiefer: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time;jsessionid=996B67A5129809DDFF8915B72D6A018F
[2013-08-14 11:34:06 -0400] mirkokiefer: example 1
[2013-08-14 11:34:08 -0400] zts: if you use that code, yeah that will run at compile time
[2013-08-14 11:34:19 -0400] zts: but that's not what the apt cookbook does: https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb
[2013-08-14 11:35:03 -0400] mirkokiefer: this is my working output:
[2013-08-14 11:35:03 -0400] mirkokiefer: https://gist.github.com/mirkokiefer/6230099#file-working-console-output
[2013-08-14 11:37:06 -0400] zts: mirkokiefer: I see that the nodejs cookbook (in the install_from_package recipe) adds an apt repository, which I think will force an update
[2013-08-14 11:37:37 -0400] zts: although I'd have expected that to help if it came before the mysql recipes, not after
[2013-08-14 11:37:41 -0400] mirkokiefer: hm but then I would expect it to work if node is at the top?
[2013-08-14 11:37:46 -0400] mirkokiefer: right
[2013-08-14 11:37:50 -0400] zts: so I'm baffled
[2013-08-14 11:38:14 -0400] mirkokiefer: hm I could get it to work by adding
[2013-08-14 11:38:15 -0400] mirkokiefer: execute "apt-get-update" do
[2013-08-14 11:38:15 -0400] mirkokiefer:   command "apt-get update"
[2013-08-14 11:38:17 -0400] mirkokiefer:   ignore_failure true
[2013-08-14 11:38:18 -0400] mirkokiefer:   action :nothing
[2013-08-14 11:38:19 -0400] mirkokiefer: end
[2013-08-14 11:38:19 -0400] mirkokiefer: to my recipe
[2013-08-14 11:38:31 -0400] zts: running again with debug logging might give some more clues about what's actually happening
[2013-08-14 11:39:01 -0400] renchap: :win 149
[2013-08-14 11:45:47 -0400] mirkokiefer: I'm wondering how the mysql cookbook runs
[2013-08-14 11:45:48 -0400] mirkokiefer: apt-get -q -y install mysql-client=5.5.31-0ubuntu0.12.04.1
[2013-08-14 11:45:57 -0400] mirkokiefer: where does it get that specific version from?
[2013-08-14 11:48:33 -0400] mirkokiefer: when running apt-show-versions -a mysql-client
[2013-08-14 11:48:41 -0400] mirkokiefer: it gives me
[2013-08-14 11:48:49 -0400] mirkokiefer: mysql-client 5.5.22-0ubuntu1         precise          us.archive.ubuntu.com
[2013-08-14 11:48:49 -0400] mirkokiefer: mysql-client 5.5.31-0ubuntu0.12.04.1 precise-security security.ubuntu.com
[2013-08-14 11:48:50 -0400] mirkokiefer: mysql-client 5.5.31-0ubuntu0.12.04.1 precise-updates  us.archive.ubuntu.com
[2013-08-14 11:48:57 -0400] mirkokiefer: but after running apt-get update
[2013-08-14 11:49:07 -0400] mirkokiefer: its 5.5.32-0ubuntu0.12.04.1
[2013-08-14 12:41:11 -0400] paul--: When I edit an encrypted data bag, it updates however the updated file doesn't seem to get transferred to the servers on a chef run
[2013-08-14 12:41:21 -0400] paul--: Anyone ran into this before / know how I'd go about troubleshooting this
[2013-08-14 12:41:42 -0400] gpatmore: hi all.  is there a LWRP to test if a listener is active on a certain port?  I tried to search but no luck so far
[2013-08-14 12:43:21 -0400] gpatmore: @paul maybe clear chef cache
[2013-08-14 12:46:40 -0400] paul--: gpatmore: Thanks.. Is there a command for that or do i just delete /var/chef/cache ?
[2013-08-14 12:47:26 -0400] gpatmore: @paul thats what I do rm -rf /var/chef/cache/*
[2013-08-14 12:47:45 -0400] paul--: gpatmore, thanks will give that a go
[2013-08-14 12:49:05 -0400] yfeldblum: gpatmore, just try to open a tcp socket to that port with a short timeout?
[2013-08-14 12:50:05 -0400] gpatmore: yeah, doesn't look like anyone's made one.  would be nice to verify via netstat rather then open a port though
[2013-08-14 12:50:11 -0400] yfeldblum: paul--, after updating the file, did you run `knife data bag from file BAG ITEM.json` again?
[2013-08-14 12:50:25 -0400] paul--: its an encrypted data bag
[2013-08-14 12:51:07 -0400] gpatmore: open a socket*
[2013-08-14 12:51:14 -0400] yfeldblum: paul--, an encrypted data-bag item is a normal data-bag item which happens to have encrypted values inside of it
[2013-08-14 12:51:40 -0400] yfeldblum: paul--, so `knife data bag from file` would work for it just as well as it would work for an unencrypted data-bag item
[2013-08-14 12:51:57 -0400] gpatmore: he's right paul.  it won't get recognized by the server until you upload it
[2013-08-14 12:52:29 -0400] paul--: Ah okay.. Yeah i haven't don't that before.. I've always just done 'knife data bag create passwords id.. whatever'
[2013-08-14 12:52:35 -0400] paul--: then knife data bag edit to edit it
[2013-08-14 12:52:39 -0400] paul--: and its uploaded in the past
[2013-08-14 12:52:52 -0400] paul--: I mean, i'm pulling data from the file already - just its not updating
[2013-08-14 12:53:09 -0400] yfeldblum: paul--, yeah that works great too, but you were talking about "the updated file" so i assumed it's a file on disk on your machine
[2013-08-14 12:53:46 -0400] paul--: Ah right Sorry my bad.. Yeah I'm just editing it with knife data bag edit
[2013-08-14 12:53:52 -0400] paul--: and that isn't updating for some reason
[2013-08-14 12:54:18 -0400] gpatmore: I have my enc dbags locally, I edit and upload via knife and works for me so far
[2013-08-14 12:54:30 -0400] paul--: Will try that.. thanks
[2013-08-14 12:55:21 -0400] gpatmore: I guess I'll maybe try writing one as a wrapper to one of the netstat gems
[2013-08-14 12:55:59 -0400] gpatmore: thanks all hagd
[2013-08-14 13:05:10 -0400] paul--: yfeldblum, found the issue, I'm such an idiot and was using symbols instead of strings i.e. password[:this] not password["this"]
[2013-08-14 13:05:29 -0400] paul--: appreciate the help / enlightenment on how it works.. hope you have a good day!
[2013-08-14 13:26:12 -0400] r44: hello guys. i'm new to chef and i want to push some changes i've made to one of cookbooks. I changed template to my liking, said 'knife upload cookbook mycookbook' in terminal, then 'sudo chef-client' on remote node.
[2013-08-14 13:26:25 -0400] r44: then i opened updated config file in vim
[2013-08-14 13:26:31 -0400] r44: all i see is previous version
[2013-08-14 13:26:36 -0400] r44: am i doing it wrong?
[2013-08-14 13:29:16 -0400] gswallow: It's hella early but do any of you guys use knife ssh with Windows?
[2013-08-14 13:29:50 -0400] gswallow: I'm having issues that I think are related to PTY allocation.  I can run commands (e.g. mkdir) and they work but I get no output.
[2013-08-14 13:48:18 -0400] cpuguy83: I have about 135 digital signage players.  We frequently have to swap them out due to failing units.  One of the bits of info we need from each is the list of attached equipment as this varies from location to location and wasn't necessarily tracked properly upon installation (no system was in place to track it properly).  We do not do FQDN's for any of this,we just track based on IP address, essentially.
[2013-08-14 13:48:57 -0400] cpuguy83: Originally I was going to setup my nodenames as the MAC address to ensure uniqeness instead of hostname, since all locations have the same hostname.  But was thinking I should base the nodename off the IP address instead.
[2013-08-14 13:49:32 -0400] cpuguy83: So when we have a swap out, what I would expect to happen is the node attrs just get replaced on the chef-server by the new PC
[2013-08-14 13:49:53 -0400] cpuguy83: But the info is all within the same node record since it's the same IP address
[2013-08-14 13:50:25 -0400] cpuguy83: Does that seem right?
[2013-08-14 13:53:27 -0400] artcurmudgeon: I have a node behind a proxy, it will run chef-client,connect with chef-server and pull client.pem, then it tries to connect direct to the chef-server via a port in the 40000 range and then chef-client fails, I cant find any references to that port range.
[2013-08-14 14:18:40 -0400] gswallow: cpuguy83: sounds like a couple of issues.  First, ohai will report which hardware is attached in many instances.  If you need additional information out of ohai you can write a plugin.  Second, if you want to keep your node names the same whenever you replace the box, you would delete the existing client and node (e.g. knife (node|client) delete 1-2-3-4.my-company.com), bootstrap it, then the node attributes *should* stay pretty much the 
[2013-08-14 14:21:06 -0400] cpuguy83: gswallow: Yeah, the hardware info is not the problem, that I know is OK.  I guess the big problem is the client registration being that it is a different client and should have a different key.
[2013-08-14 14:21:38 -0400] cpuguy83: So either manually delete the node/client or transfer the key over
[2013-08-14 14:21:49 -0400] gswallow: correct
[2013-08-14 14:56:18 -0400] xhae: Hi! I'm using laradji's zabbix cookbook and some of the LWRPs seem to require LWRs to be passed to the attribute methods. Does anyone have an example of how to assign an LWR to a variable, so that I can pass it around?
[2013-08-14 15:00:03 -0400] nate`: hrm, for some reason can't log in to my chef server  after using knife to create my user.
[2013-08-14 15:12:29 -0400] gchristensen: cheesey petes, upgrading to chef  11.6.0 is causing all my Rackspace servers to have ['cloud'] attributes but not ['cloud']['local_ipv4'], and all the detection is "does the server have cloud? then up cloud.ipv4.
[2013-08-14 15:22:59 -0400] aramus_: Hello, is there a way to run chef-client on multiple nodes at once aside from using roles?
[2013-08-14 15:23:50 -0400] gleam: knife ssh -m fqdn1,fqdn2,fqdn3,fqdn4 chef-client
[2013-08-14 15:23:56 -0400] gleam: sorry, spaces not commas
[2013-08-14 15:24:18 -0400] aramus_: Thanks!
[2013-08-14 15:25:35 -0400] yfeldblum: seeing an "Error Syncing Cookbooks:" when bootstrapping a node with "Error connecting to https://s3-external-1.amazonaws.com/opscode-platform-production-data/organization-... - Connection timed out - connect(2)"
[2013-08-14 15:27:16 -0400] ismell: if I define attributes with defaults in metadata.rb do they actaully get applied or is it only for documentation?
[2013-08-14 15:28:17 -0400] chris613: ismell: Only for documentation; which I wish would write itself
[2013-08-14 15:28:18 -0400] clayb: Or is there a nice shell fragment to generate/validate metadata.rb from the attributes?
[2013-08-14 15:28:28 -0400] ismell: ah poo
[2013-08-14 15:28:33 -0400] chris613: clayb: I hope someone answers yes ;)
[2013-08-14 15:28:41 -0400] ismell: wish I chould just specify the default in the metadata and not duplicate it
[2013-08-14 15:30:13 -0400] chris613: Right. I put attributes in the attributes files, then in metadata, and then in README. I just want to do it once somewhere
[2013-08-14 15:30:35 -0400] artcurmudgeon: Does Chef use any ports other than 443?
[2013-08-14 15:30:36 -0400] chris613: I'm looking into doc toold (yard chef I think?) to generate the README from the metadata, so that might herlp with that step
[2013-08-14 15:30:57 -0400] jmartin: does anyone here use the kitchen-openstack driver for test-kitchen?
[2013-08-14 15:31:18 -0400] gleam: artcurmudgeon: i believe it redirects 80 to 443 for the sake of users, but otherwise no
[2013-08-14 15:31:30 -0400] jmartin: i seem to using the wrong information for driver_config, not sure where im going wrong
[2013-08-14 15:31:49 -0400] ismell: meh, i might just not bother with metadata.rb for now then
[2013-08-14 15:31:57 -0400] artcurmudgeon: my reason for asking is I just watched a node try to connect to a chef server off of a port in the 40000 range
[2013-08-14 15:32:05 -0400] jmartin: RoboticCheese: you dont happen to be around do you?
[2013-08-14 15:32:07 -0400] clayb: jmartin: Ooh cool, I didn't realize there was a kitchen-openstack; I'm just starting with testing of my chef though...
[2013-08-14 15:32:50 -0400] clayb: artcurmudgeon: For me, port 4000 is API and 4040 is human/https
[2013-08-14 15:33:25 -0400] clayb: artcurmudgeon: so clients connect to the API port and humans with web-browsers connect to the HTTPS port.
[2013-08-14 15:35:00 -0400] adnichols: artcurmudgeon is this chef11 or chef10?
[2013-08-14 15:35:19 -0400] gchristensen: ah hah! second ticket submission this week!
[2013-08-14 15:38:05 -0400] jmartin: nvm, got it! configuration names are just a bit misleading
[2013-08-14 15:38:22 -0400] sparr: I'm installing an init script via a `template`, and a matching `service`. the template notifies the service to enable, but I still don't get the service configured with chkconfig or runnig
[2013-08-14 15:43:25 -0400] sparr: alternate approach, if I just make the action on the service be :enable and :start then it gets configured with chkconfig, but doesn't end up running
[2013-08-14 15:43:36 -0400] sparr: * service[s3_client] action start[2013-08-14T15:44:16-04:00] INFO: Processing service[s3_client] action start (sma_node::default line 46)
[2013-08-14 15:43:36 -0400] sparr:  (up to date)
[2013-08-14 15:44:00 -0400] sparr: that appears to indicate that when trying to start the service it thinks it's already started and doesn't take action
[2013-08-14 15:44:14 -0400] adnichols: sparr is this upstart or init.d init script?
[2013-08-14 15:44:21 -0400] sparr: init.d
[2013-08-14 15:44:39 -0400] adnichols: starting the service manually works?
[2013-08-14 15:44:55 -0400] sparr: yes
[2013-08-14 15:47:06 -0400] adnichols: I'd agree with you that it looks like it thinks it's already running  does the init script support status?
[2013-08-14 15:47:12 -0400] sparr: yes
[2013-08-14 15:47:23 -0400] adnichols: and when it's not running that status correctly says it's not running?
[2013-08-14 15:48:04 -0400] sparr: yes
[2013-08-14 15:48:16 -0400] mattupstate: can in include a library from another cookbook in a recipe?
[2013-08-14 15:48:46 -0400] sparr: https://gist.github.com/sparr/70b10637ce7c9fb05786/raw/a490d48c5909d470d1aaee877c16a0f026e12fb0/gistfile1.txt
[2013-08-14 15:49:09 -0400] sparr: I think there's a lot of redundant notifies/action in there to enable and start the service
[2013-08-14 15:49:12 -0400] sparr: just trying to be thorough
[2013-08-14 15:49:49 -0400] bugoff: mattupstate: if you need to do that, isn't it better to create a new cookbook with that library's and include them from both?
[2013-08-14 15:51:24 -0400] mattupstate: bugoff: not sure i follow
[2013-08-14 15:52:13 -0400] mattupstate: i have a "library cookbook" with `libraries/helpers.rb` in it
[2013-08-14 15:52:52 -0400] mattupstate: i've "extended the recipe" as described here http://docs.opscode.com/essentials_cookbook_libraries.html
[2013-08-14 15:52:53 -0400] zts: mattupstate: cookbook libraries are loaded into the Chef run, and you can use them from anywhere (they're not scoped to the cookbook that they came from)
[2013-08-14 15:54:12 -0400] sparr: entirely unrelated question... when I run `chef-client` and `chef-client | tee foo` the output is different. a lot of data is left out of the tee'd results. how can I fix that?
[2013-08-14 15:54:12 -0400] mattupstate: hmm
[2013-08-14 15:54:26 -0400] mattupstate: zts: ok, let me try again, then
[2013-08-14 15:54:48 -0400] artcurmudgeon: adnichols - 10.18
[2013-08-14 15:54:59 -0400] artcurmudgeon: sorry I missed your question
[2013-08-14 15:55:50 -0400] gchristensen: what days do OHAI tickets get reviewed, and what days do COOK tickets get reviewed?
[2013-08-14 15:55:53 -0400] sparr: running that recipe I pasted above repeatedly ends up with all the files in the right places, and without the template and cookbook_file being processed I'm down to a single :enable and :start for the service from the service provider
[2013-08-14 15:56:05 -0400] sparr: and it still doesn't get started
[2013-08-14 15:57:16 -0400] mattupstate: zts: I think i just figured out what's wrongi was trying to use the helper method, nested in a LWRP directive
[2013-08-14 15:57:24 -0400] mattupstate: its really not obvious
[2013-08-14 15:57:46 -0400] adnichols: artcurmudgeon yeah, 10.x works differently than 11 & uses multiple ports afaik
[2013-08-14 15:58:22 -0400] mattupstate: zts: this sums it up http://tickets.opscode.com/browse/CHEF-1592?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel
[2013-08-14 15:58:46 -0400] artcurmudgeon: adnichols: do you know of a link that would list them?
[2013-08-14 15:59:43 -0400] zts: mattupstate: aha, wasn't aware of that - thanks for pointing out the ticket
[2013-08-14 16:00:03 -0400] gchristensen: freerobby: ping
[2013-08-14 16:00:27 -0400] mattupstate: zts: yeah, this seems like one of those chef oddities that isn't obvious unless you fully understand how chef works
[2013-08-14 16:00:57 -0400] freerobby: gchristensen: pong
[2013-08-14 16:01:07 -0400] adnichols: artcurmudgeon I've never installed 10.x but found this: http://www.bonusbits.com/main/HowTo:Install_Chef_Server_on_CentOS#Configure_Firewall_if_Needed
[2013-08-14 16:01:14 -0400] sparr: I am going to try specifying a pattern for the service
[2013-08-14 16:01:22 -0400] sparr: I have no idea what that would get used for, since the service supports status
[2013-08-14 16:01:43 -0400] gchristensen: freerobby: https://github.com/opscode/ohai/pull/173 are you experiencing this bug?
[2013-08-14 16:01:56 -0400] adnichols: sparr yeah, I'm not sure - the multiple notifies are something I've not tried before and I wonder if that's an issue but it may be fine
[2013-08-14 16:02:18 -0400] sparr: adnichols: I've removed them, and tried without them. I just kept adding them to try different things.
[2013-08-14 16:02:25 -0400] ismell: is it ok to wrap a group of resources in an if block, or do i need to add an only_if to each resource?
[2013-08-14 16:02:29 -0400] adnichols: sparr regardless I'd expect your service definition to at least enable the service via chkconfig
[2013-08-14 16:02:42 -0400] sparr: it does
[2013-08-14 16:02:52 -0400] sparr: chkconfig works when the service has a :enable action
[2013-08-14 16:03:03 -0400] adnichols: sparr ah ok, it's just not starting at this point?
[2013-08-14 16:03:09 -0400] sparr: chkconfig wasn't working when the service did not have that and I was trying to send a :enable notification from one of the other resources
[2013-08-14 16:03:17 -0400] btm: ismell: it's best practice if you're not going to need the resources, e.g. they're for a different platform, to wrap them in an if block so they never get created and put in the resource collection. If you may want to notify them or use them in some way, use only_if.
[2013-08-14 16:03:25 -0400] sparr: right, just not starting. the log says (up to date) on the start action
[2013-08-14 16:03:43 -0400] adnichols: sparr typically I'd notify :restart services because on the first run the service will execute anyhow & you just want to bounce it when those change (possibly)
[2013-08-14 16:04:01 -0400] freerobby: gchristensen: No, our public_ip always comes back as 1.1.1.1
[2013-08-14 16:04:15 -0400] freerobby: I am assuming that's some bizarre rackconnect thing and I've never looked into it
[2013-08-14 16:04:19 -0400] sparr: I actually don't want to bounce it when it's updated later until the next time the machine reboots
[2013-08-14 16:04:26 -0400] ismell: btm: well i'm doing a check if the node has a role
[2013-08-14 16:04:30 -0400] adnichols: sparr then probably just remove the notifies
[2013-08-14 16:04:48 -0400] ismell: but I don't think i'll ever notify them
[2013-08-14 16:05:13 -0400] sparr: I tried the notifies because there was some discussion online about a service trying to get started before its files existed. I'll remove them, but I don't think that will matter since those resources are being skipped now anyway
[2013-08-14 16:06:04 -0400] gchristensen: freerobby: interesting... what do you get for ifconfig?
[2013-08-14 16:07:02 -0400] btm: ismell: if this_node_is_a_webserver ; package "the_web_server" ; end # seems reasonable to me.
[2013-08-14 16:08:03 -0400] freerobby: gchristensen: Hmm, nothing
[2013-08-14 16:08:21 -0400] freerobby: gchristensen: maybe we are affectd, let me look into this
[2013-08-14 16:08:41 -0400] ismell: cool
[2013-08-14 16:08:42 -0400] sparr: I'm gonna change my log level to debug
[2013-08-14 16:08:57 -0400] sparr: see if I can figure out why it thinks the service is already started
[2013-08-14 16:09:21 -0400] ismell: is there a way to disable the logging of a template inflation?
[2013-08-14 16:09:32 -0400] ismell: i'm inflating some ssl keys and don't want them showing up
[2013-08-14 16:11:01 -0400] gchristensen: freerobby: okay :) sounds like something very fishy is going on with your machines. even with rackconnect, it all works okay.
[2013-08-14 16:11:02 -0400] sparr: oh mh god
[2013-08-14 16:11:12 -0400] gchristensen: the core of the issue here is I don't have a public IP
[2013-08-14 16:11:32 -0400] sparr: Checking s3_client...                             Service not running
[2013-08-14 16:11:33 -0400] sparr: [2013-08-14T16:12:33-04:00] DEBUG: service[s3_client] is running
[2013-08-14 16:11:41 -0400] sparr: it's looking for the word "running"
[2013-08-14 16:17:01 -0400] sparr: that seems so obvious
[2013-08-14 16:17:12 -0400] sparr: I used a random template init.d script that says "running" and "not running"
[2013-08-14 16:17:17 -0400] sparr: chef seems to want "running" and "stopped"
[2013-08-14 16:18:35 -0400] sparr: well, not obvious, but something I should have suspected and checked
[2013-08-14 16:18:39 -0400] gchristensen: old unix traditions die harder
[2013-08-14 16:18:45 -0400] gchristensen: s/er//
[2013-08-14 16:19:56 -0400] sparr: ...
[2013-08-14 16:19:58 -0400] sparr: hmm
[2013-08-14 16:20:01 -0400] sparr: might not have fixed it, after all
[2013-08-14 16:20:05 -0400] sparr: another debug run
[2013-08-14 16:22:11 -0400] sparr: oh, maybe it's looking at exit status?
[2013-08-14 16:23:33 -0400] randomautomator: hey stupid question
[2013-08-14 16:23:36 -0400] randomautomator: the user resource
[2013-08-14 16:23:45 -0400] randomautomator: should the action :create also do modifications?
[2013-08-14 16:24:13 -0400] randomautomator: or do i need to do something like "action => [:create, :modify]"
[2013-08-14 16:24:41 -0400] adnichols: randomautomator per the docs - yes it will do both "Use to create a user with given attributes. If the user already exists, use to ensure that the resource is in the correct state (which is effectively the same as :modify)."
[2013-08-14 16:24:42 -0400] gchristensen: randomautomator: http://docs.opscode.com/resource_user.html - check out the description of the :create action
[2013-08-14 16:25:01 -0400] randomautomator: yeah i use the :create but when the user exists it doesn't modify
[2013-08-14 16:25:03 -0400] randomautomator: it bombs out
[2013-08-14 16:25:13 -0400] gchristensen: what do you mean by "bombs out"
[2013-08-14 16:25:32 -0400] randomautomator: Error executing action `create` on resource 'user[dev.up.nfl.com]'
[2013-08-14 16:25:35 -0400] sparr: http://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/iniscrptact.html
[2013-08-14 16:25:39 -0400] sparr: learn something new every day
[2013-08-14 16:26:06 -0400] gchristensen: randomautomator: it'd be worth running it with -l debug to see what thespecific issue is. Generalyl when I see that happe,n you're trying to mkae he user have a UID that is not equal to the UID it already has.
[2013-08-14 16:26:52 -0400] randomautomator: would it also do that if i'm changing the name of the user?
[2013-08-14 16:27:02 -0400] randomautomator: from name user1 to user2
[2013-08-14 16:27:18 -0400] gchristensen: probably so :)
[2013-08-14 16:27:19 -0400] adnichols: randomautomator often if that user is logged in that'll fail
[2013-08-14 16:27:30 -0400] randomautomator: bloody hell
[2013-08-14 16:27:52 -0400] adnichols: randomautomator you can usually see the command chef is trying to run and try it yourself & find out why exactly it's failing
[2013-08-14 16:28:01 -0400] gchristensen: randomautomator: you'll probably save some headache by running with -l debug, seeing the command it runs and the error, and reading the manpage on useradd
[2013-08-14 16:28:02 -0400] randomautomator: yeah it's a useradd command
[2013-08-14 16:28:06 -0400] randomautomator: which was confusing to me
[2013-08-14 16:28:15 -0400] randomautomator: i was hoping it'd do something else if it detected the user already there
[2013-08-14 16:28:27 -0400] randomautomator: alright thanks guys
[2013-08-14 16:28:27 -0400] gchristensen: useradd is capable of manipulating existing users
[2013-08-14 16:29:17 -0400] randomautomator: yeah but reusing the same uid with useradd throw this : useradd: UID 2005 is not unique
[2013-08-14 16:30:08 -0400] gchristensen: randomautomator: you should seriously read this manpage: http://docs.opscode.com/resource_user.html
[2013-08-14 16:30:21 -0400] gchristensen: ":non_unique indicates whether non-unique UIDs are allowed. This option is currently unused by the existing providers." - oh my mistake, its not supported :9
[2013-08-14 16:31:47 -0400] _ci: I have 5 custom cookbooks each with attributes, recipes and templates
[2013-08-14 16:32:25 -0400] _ci: Can I call these recipes from a different cookbook?
[2013-08-14 16:33:25 -0400] _ci: I am trying to make a 6th cookbook that will execute the other 5 cookbooks.  I understand that is why there are runlists but this needs to be easily and clearly ported across multiple projects
[2013-08-14 16:33:47 -0400] _ci: How do I call the recipes from the new 6th cookbook?
[2013-08-14 16:35:30 -0400] adnichols: _ci check out "include_recipe" on this page: http://docs.opscode.com/essentials_cookbook_recipes.html
[2013-08-14 16:36:18 -0400] _ci: adnichols Thanks.  That works
[2013-08-14 16:52:25 -0400] eldavido: has anyone tried to install chef server on mac OS X?
[2013-08-14 16:52:28 -0400] eldavido: for local development?
[2013-08-14 16:52:34 -0400] eldavido: (chef 11)
[2013-08-14 16:52:43 -0400] gchristensen: eldavido: I use vagrant to make a chef server to use locally
[2013-08-14 16:53:01 -0400] eldavido: yeah i might end up using a virtualbox linux instance
[2013-08-14 16:54:10 -0400] btm: eldavido: opscode engineers use vagrant as well.
[2013-08-14 16:54:45 -0400] eldavido: btw i just got the card from opscode today in the mail
[2013-08-14 16:54:57 -0400] eldavido: i think for having a CLA-approved patch accepted
[2013-08-14 16:55:00 -0400] eldavido: thanks guys, nice touch
[2013-08-14 16:55:00 -0400] eldavido: :)
[2013-08-14 16:55:08 -0400] miah: oi
[2013-08-14 17:09:52 -0400] eldavido: one other question, does anyone know whether it's possible to install chef server on ubuntu 13.04
[2013-08-14 17:09:54 -0400] eldavido: or only 12.10?
[2013-08-14 17:12:39 -0400] btm: eldavido: should run on 13.04 fine. Opscode doesn't test it there is all.
[2013-08-14 17:12:59 -0400] eldavido: ok thanks
[2013-08-14 17:23:16 -0400] tabolario: has anyone had an issue with test-kitchen where it fails to authenticate to the vagrant box due to too many authentication failures?
[2013-08-14 17:24:11 -0400] btm: tabolario: do you have too many ssh keys such that it's trying all of them and runs out of chances before it gets too the right one?
[2013-08-14 17:24:51 -0400] tabolario: hmm that's a possibility let me try clearing out my agent
[2013-08-14 17:25:45 -0400] miah: `ssh-agent -t 30m` FTW
[2013-08-14 17:26:05 -0400] tabolario: ah that was it
[2013-08-14 17:26:30 -0400] tabolario: and thanks for that miah :) probably a good idea for me to start doing that instead of leaving them in forever
[2013-08-14 17:28:37 -0400] miah: yup. =)
[2013-08-14 17:28:57 -0400] TrinitronX: Is there a way to use the execute resource in a way that will detect an error if the command's stderr is not empty?
[2013-08-14 17:29:17 -0400] TrinitronX: I'm using an execute resource to run a command that always returns 0 exit status even on error, but it does write to stderr
[2013-08-14 17:30:00 -0400] postwait: I'm having issues with cookbook_file resources not updating when the shipped files change.
[2013-08-14 17:30:22 -0400] postwait: action :create not :create_if_missing
[2013-08-14 17:30:44 -0400] miah: TrinitronX: fix the program to use exist status correctly?
[2013-08-14 17:31:39 -0400] TrinitronX: miah: I wish... the command is osascript on OSX :-(
[2013-08-14 17:32:27 -0400] miah: :/
[2013-08-14 17:32:32 -0400] miah: does the command create any files?
[2013-08-14 17:32:50 -0400] miah: you can use the execute resources 'creates' to check for a file after the command runs. that will kinda do what you want.
[2013-08-14 17:33:19 -0400] TrinitronX: no, it doesn't create any files
[2013-08-14 17:33:34 -0400] TrinitronX: seems that osascript returns nonzero on syntax errors and such, but not applescript errors
[2013-08-14 17:35:23 -0400] btm: TrinitronX: https://gist.github.com/btm/6233398
[2013-08-14 17:40:18 -0400] TrinitronX: btm: Thanks! That works well   ( osascript -e 'do automation here' 2>&1 >/dev/null | grep -q '^$' ; echo $? )
[2013-08-14 17:43:21 -0400] btm: TrinitronX: np. of course, leave the echo statement off when you use it, so the exit code from grep gets returned.
[2013-08-14 17:45:10 -0400] TrinitronX: btm: good call ;-)
[2013-08-14 17:45:35 -0400] gchristensen: btm: is there a public schedule of code reviews?
[2013-08-14 17:48:14 -0400] btm: gchristensen: kinda. I've been working hard at getting one established lately. We're working on three month cycles with the Chef 11 and 10 client right now. 10.28.0 will come out this month, 11.8.0 will come out in october. 10.30.0 in november, 11.10.0 in january.
[2013-08-14 17:48:55 -0400] btm: gchristensen: we've been less than awesome at having any sort of cadence in the past, so we'll see how this goes for a few months.
[2013-08-14 17:50:32 -0400] dopacki: hi - trying to use "knife search node" to find boxes that didn't build correctly - how would I search for nodes that have a null ipaddress?
[2013-08-14 17:51:08 -0400] dopacki: knife search node "ipaddress:", knife search node "ipaddress:null", knife search node "ipaddress:NULL", knife search node "ipaddress:''" all throw errors
[2013-08-14 17:51:13 -0400] gchristensen: btm: gotcha. and patch-level releases more frequently? I ask because I submitted two tickets that I'm fairly interested (excited?) about getting merged in and resolved, and would like to be present for the code review if that is helpful, or would speed things up.
[2013-08-14 17:51:21 -0400] miah: s/null/nil
[2013-08-14 17:51:35 -0400] Vitor: Hello Guys, I'm from Brazil and recently started using Chef to automate processes deploy the company where I work. Since then there have been some questions on how to work with chef. This channel is a good place to share questions?
[2013-08-14 17:51:39 -0400] miah: but also. if they dont build correctly, how are they registered with chef?
[2013-08-14 17:51:48 -0400] gchristensen: Vitor: this is indeed
[2013-08-14 17:52:07 -0400] dopacki: hmm.. looks like I probably actually need to represent an empty string
[2013-08-14 17:52:19 -0400] dopacki: nil didn't return the node I know is broken
[2013-08-14 17:53:11 -0400] dopacki: lol. this works - knife search node "NOT ipaddress:*"
[2013-08-14 17:53:19 -0400] btm: gchristensen: we'll still code review on the regular schedule (wiki.opscode.com/display/chef/Code+Review) and merge along the way.
[2013-08-14 17:54:08 -0400] gchristensen: cool.
[2013-08-14 17:54:57 -0400] btm: gchristensen: right now we're only shipping patch releases due to apocalypse, as things iron out we've talked about having a monthly patch release schedule for 11, but we've got to work out how you get which releases. A 3mo Chef client 10 release is tested differently than a ThisIsShiny regular patch release.
[2013-08-14 17:55:21 -0400] gchristensen: understandably
[2013-08-14 17:55:28 -0400] gchristensen: its the patch-releases I'm primarily interested in
[2013-08-14 17:56:02 -0400] gchristensen: are you planning on altering the curl installer process?
[2013-08-14 17:56:55 -0400] tabolario: hrm so in a wrapper cookbook, is the practice to set default values for attributes in the cookbook being wrapped just to use default[] in the wrapper cookbook's attributes?
[2013-08-14 17:57:14 -0400] btm: gchristensen: we shipped an 11.6.0 patchish release as a hotfix, which omnitruck treats as a prerelease. that's what we're doing for uber bugs at the moment. It couldn't get the testing that 11.6.0 did, which is why it's in another bucket.
[2013-08-14 17:57:37 -0400] gchristensen: got it
[2013-08-14 17:58:14 -0400] btm: gchristensen: there are a few options for other buckets, but yeah, omnitruck could have something similar to the nightlies/prerelease flag that says, I'll take patch releases off a HEAD that you think is alright but you don't fully test, and have a corresponding flag to install.sh for that.
[2013-08-14 17:58:17 -0400] nathenharvey: postwait: did you answer your own question?  use :create not :create_if_missing as the action
[2013-08-14 17:58:27 -0400] postwait: nathenharvey:  working
[2013-08-14 17:58:29 -0400] postwait: sorry
[2013-08-14 17:58:31 -0400] postwait: not working
[2013-08-14 17:58:42 -0400] postwait: I am using :create.
[2013-08-14 17:59:17 -0400] postwait: it appears to not be checksumming the files.
[2013-08-14 18:02:15 -0400] tabolario: also, does anyone have experience using the heavywater graphite cookbook?
[2013-08-14 18:08:03 -0400] snipe: Hi - I'm trying to get through the Converge the Node part of learnchef.opscode.com but keep getting an error about magic_shell_alias resource not being found. Googled it over and over, but can't find anything useful.
[2013-08-14 18:08:14 -0400] snipe: localhost Cannot find a resource for magic_shell_alias on ubuntu version 12.04
[2013-08-14 18:08:30 -0400] gchristensen: fancy seeing you here, snipe
[2013-08-14 18:08:41 -0400] snipe: oh hai :)
[2013-08-14 18:08:50 -0400] gchristensen: `ohai` indeed
[2013-08-14 18:08:56 -0400] snipe: ha
[2013-08-14 18:09:58 -0400] gchristensen: snipe: are you running within a VM? or a recently bootstrapped node?
[2013-08-14 18:10:15 -0400] nathenharvey: postwait: I just ran a simple test using chef 11.6.0, hosted chef, and vagrant.  it worked fine for me.  you 'knife cookbook upload'ed your changes, right (I said 'with all due respect')
[2013-08-14 18:10:20 -0400] snipe: vagrant vm
[2013-08-14 18:10:36 -0400] postwait: nathenharvey: running chef-solo
[2013-08-14 18:10:41 -0400] postwait: the checkout on the box is correct.
[2013-08-14 18:10:41 -0400] calebhailey: tabolario: the heavywater team does :)
[2013-08-14 18:10:48 -0400] postwait: 0.10.8 here.
[2013-08-14 18:10:57 -0400] calebhailey: tabolario: we have an open irc channel on freenode (#heavywater)
[2013-08-14 18:11:08 -0400] snipe: gchristensen: literally walking through the steps in the walkthrough
[2013-08-14 18:11:08 -0400] tabolario: calebhailey: thanks! i will head on over
[2013-08-14 18:11:21 -0400] snipe: gchristensen: okay, not literally. but I am doing them all one by one.
[2013-08-14 18:11:22 -0400] gchristensen: snipe: me too, trying to figure out where you fell off.
[2013-08-14 18:11:41 -0400] snipe: gchristensen:  knife bootstrap localhost --ssh-user vagrant --ssh-password vagrant --ssh-port 2222 --run-list "recipe[apt],recipe[aliases],recipe[apache2],recipe[networking_basic]" --sudo --node-name "vagrant.vm2"
[2013-08-14 18:12:05 -0400] snipe: gchristensen: that gets me to Compiling Cookbooks. Then error: Recipe Compile Error in /var/chef/cache/cookbooks/aliases/recipes/default.rb
[2013-08-14 18:12:06 -0400] gchristensen: snipe: does your aliases cookbook `depend` upon 'magic_shell'?
[2013-08-14 18:12:44 -0400] snipe: gchristensen: I don't see anything for reps there - but again, it's the one from the example
[2013-08-14 18:13:01 -0400] snipe: deps. not reps
[2013-08-14 18:13:17 -0400] gchristensen: snipe: check step #3 on "Using Chef Repo"
[2013-08-14 18:13:35 -0400] gchristensen: under "Create a Simple Cookbook"
[2013-08-14 18:13:43 -0400] snipe: I did all that
[2013-08-14 18:14:19 -0400] snipe: mother....
[2013-08-14 18:14:26 -0400] gchristensen: did you find it?
[2013-08-14 18:14:51 -0400] snipe: yes. I don't know HOW I missed that.
[2013-08-14 18:15:02 -0400] gchristensen: was it the "depend" step? :)
[2013-08-14 18:15:06 -0400] snipe: (Actually, I know how. I was exhausted and should have gone to bed when I was doing it.)
[2013-08-14 18:15:23 -0400] snipe: Yes. :(
[2013-08-14 18:15:53 -0400] gchristensen: its fine, Vid is still learning about `depend`.
[2013-08-14 18:15:59 -0400] snipe: Hah!
[2013-08-14 18:16:09 -0400] snipe: No, I mean I didn't even see it. Skipped that entire block when I was reading it
[2013-08-14 18:16:48 -0400] snipe: Based on the error, the first thing I did was check aliases rbs for reps. Didn't see any. BECAUSE I DIDN'T ADD THEM. Sigh.
[2013-08-14 18:16:54 -0400] snipe: *deps
[2013-08-14 18:17:02 -0400] gchristensen: <3
[2013-08-14 18:17:03 -0400] snipe: (this autocorrect is killing me)
[2013-08-14 18:17:12 -0400] gchristensen: snipe: let me know if you need any more help :)
[2013-08-14 18:17:25 -0400] snipe: Thank you do much, Graham. I wish I had asked a while ago.
[2013-08-14 18:17:29 -0400] jcook-fastrobot: I have a question about attribute files in a cookbook that I'm hoping someone can clear up.  I was under the impression that named attribute files (ie. server.rb) would only be applied to the node if the server.rb recipe was in the nodes run_list...but after trying to track down an odd error I now believe that every attribute file in the cookbook will be applied to the ndoe regardless of which recipe has been applied.
[2013-08-14 18:17:46 -0400] kaerast: Is there a good vagrant setup for developing chef-client these days?  I've got a couple of bugs/feature tickets I'd like to have a go at
[2013-08-14 18:17:58 -0400] snipe: gchristensen: localhost Chef Client finished, 35 resources updated - boom. I'm an idiot.
[2013-08-14 18:18:04 -0400] gchristensen: snipe: there are a number of things in chef which make newcomer's brains hurt.
[2013-08-14 18:18:04 -0400] jcook-fastrobot: Can someone confirm / deny my suspicions?
[2013-08-14 18:18:12 -0400] gchristensen: w00t
[2013-08-14 18:18:36 -0400] gchristensen: jcook-fastrobot: I was under the same impression, but I believe you are correct.
[2013-08-14 18:18:48 -0400] yfeldblum: gchristensen, such as the model-driven declare/converge architecture
[2013-08-14 18:18:56 -0400] gchristensen: yup
[2013-08-14 18:19:01 -0400] yfeldblum: gchristensen, and ruby
[2013-08-14 18:19:17 -0400] snipe: gchristensen: FWIW, Puppet was worse
[2013-08-14 18:19:22 -0400] jcook-fastrobot: This will make me infinitely sad.
[2013-08-14 18:19:49 -0400] snipe: gchristensen: this was just pebkac at least. I didn't even see that step. We're not even at the hard part yet :P
[2013-08-14 18:19:55 -0400] gchristensen: snipe: I've heard it sort of randomizes its runs...
[2013-08-14 18:20:03 -0400] snipe: yah
[2013-08-14 18:20:35 -0400] snipe: gchristensen: I had puppet all set up (complete with awesomely named puppet master, Henson), but decided to switch us to chef
[2013-08-14 18:20:40 -0400] yfeldblum: jcook-fastrobot, yes, it is in the documentation that *all* attributes files for *all* cookbooks are run early in the chef run, before any recipes are run
[2013-08-14 18:21:00 -0400] gchristensen: snipe: nice. before you get *too* too far, check out Berkshelf
[2013-08-14 18:21:20 -0400] snipe: gchristensen: already have, it's partly why I decided to go with chef
[2013-08-14 18:21:29 -0400] gchristensen: good. berkshelf is a dream
[2013-08-14 18:22:50 -0400] snipe: gchristensen: the ever recipe in its own repo thing makes me a little brain-achy, but I like a lot of what I've seen
[2013-08-14 18:23:17 -0400] gchristensen: snipe: every cookbook* but yes. but it make updating and sharing much simpler.
[2013-08-14 18:23:46 -0400] snipe: gchristensen: yes, sorry. I know the reason for it, and it totally makes sense. But it hurts my brain a little. It's okay. Change is good. :)
[2013-08-14 18:24:02 -0400] snipe: I'll get used to it
[2013-08-14 18:24:06 -0400] gchristensen: +1
[2013-08-14 18:27:34 -0400] Boohbah: does anyone actually use chef with archlinux? i'm noticing lots of references to rc.conf
[2013-08-14 18:29:52 -0400] snipe: gchristensen: I also ran into a read-only filesystem issue on the vagrant image. I ended up having to add a line to the Vagrantfile to make it work
[2013-08-14 18:30:21 -0400] gchristensen: snipe: hrmm... is that a documentation bug?
[2013-08-14 18:32:12 -0400] snipe: gchristensen: I don't *think* so. It looked like it was supposed to be fixed in the version I have
[2013-08-14 18:32:58 -0400] snipe: gchristensen: I'm guessing I have a stupid version of something that made it harder. Once I get through this, I'm going to pave everything and reinstall everything and start again from scratch so I am more comfortable with it. I'll figure out what happened when I do that
[2013-08-14 18:33:20 -0400] gchristensen: :) good choice. there is a lot of stuff going on, and without domain knowledge it can be tryicky.
[2013-08-14 18:34:02 -0400] snipe: gchristensen: yeah - I'm going to keep paving it until I'm super comfy with all of the bits, so I know how to break it and how to fix it
[2013-08-14 18:36:03 -0400] jcook-fastrobot: If all attribute files in a cookbook are applied to a node, what is the point in breaking them up into multiple files in the first place?  (aside from possibly making them easier to find by grouping?)  I'm just interested at this point...
[2013-08-14 18:38:21 -0400] yfeldblum: jcook-fastrobot, for organization
[2013-08-14 18:38:31 -0400] yfeldblum: jcook-fastrobot, i suppose
[2013-08-14 18:40:00 -0400] jcook-fastrobot: I understand that you can manipulate the order that they are processed by using the include_attribute resource, but I'm still confused as to why one would take the time to break them up when you can always just look in the default file.  Meh.
[2013-08-14 18:41:56 -0400] jtimberman: jcook-fastrobot: all cookbook's attributes files are loaded by Chef at the start of the run.
[2013-08-14 18:42:23 -0400] failshell: can you check the existance of a gem with minitest? something like gem_package('foo').must_be_installed maybe?
[2013-08-14 18:42:27 -0400] jtimberman: jcook-fastrobot: splitting them up into separate files doesn't buy anything other than organizing data into separate files because some people like to do that.
[2013-08-14 18:42:52 -0400] jtimberman: or to keep all "like" things in a single place (like, all the server stuff in a server.rb, all the client stuff in a client.rb)
[2013-08-14 18:44:13 -0400] jchauncey: @jtimberman: have you guys started planning chef conf yet?
[2013-08-14 18:45:55 -0400] jcook-fastrobot: Yeah...this is where I got tripped up.  I added an atribute to the server.rb attribute file and then added a conditional only_if { node.attribute?('BLAH') } to a recipe thinking that only a node running the server.rb recipe would have the attribute...but then every node that ran the client recipe suddenly evaluated this conditional as true.  Much to my surprise.
[2013-08-14 18:46:19 -0400] jcook-fastrobot: Its an easy fix, but I'm now wondering how many times I've made this mistake in our cookbooks.
[2013-08-14 18:46:48 -0400] nathenharvey: jchauncey: Community Summit was recently announced.  We've started planning for #ChefConf 2014 but aren't ready to share any details yet
[2013-08-14 18:48:23 -0400] Samuel__: Excuse me, I've installed Chef Server on my localhost to try it out, and I'm trying to install Chef Client on my machine as well, but I keep getting errors trying to do any knife command
[2013-08-14 18:48:47 -0400] Samuel__: The errors vary with the url that I try to configure knife with
[2013-08-14 18:49:32 -0400] Samuel__: My Chef Server is running on 127.0.0.1:5672, but I don't know which url I should give knife
[2013-08-14 18:50:20 -0400] jtimberman: Samuel__: what version of Chef?
[2013-08-14 18:50:23 -0400] jtimberman: Samuel__: 11?
[2013-08-14 18:50:49 -0400] jtimberman: Samuel__: if chef 11, you want https://your.chef-server.fqdn.example.com
[2013-08-14 18:54:04 -0400] Samuel: Got disconnected, jtimberman. How do I determine what version of Chef I'm running?
[2013-08-14 18:56:11 -0400] artcurmudgeon: jtimberman: Samuel__: if chef 11, you want https://your.chef-server.fqdn.example.com
[2013-08-14 18:56:34 -0400] jmartin: Samuel: which version of chef did you install? if its running erlang, its chef 11
[2013-08-14 19:02:22 -0400] Boohbah: status of this bug? arch lost rc.conf long ago http://tickets.opscode.com/browse/CHEF-3637
[2013-08-14 19:04:39 -0400] erthad: hiall
[2013-08-14 19:05:27 -0400] erthad: is there a way to reload certain attributes after I do "ohai reload" inside recipe?
[2013-08-14 19:05:39 -0400] freerobby: What do folks use to automate the process of getting encrypted data bags onto nodes?
[2013-08-14 19:05:51 -0400] freerobby: sorry, i mean the secret files for decrypting encrypted data bags
[2013-08-14 19:20:53 -0400] freerobby: Somebody has to have solved this, no?
[2013-08-14 19:21:07 -0400] freerobby: I don't understand how anybody uses encrypted data bags without manually scping them to the server
[2013-08-14 19:22:42 -0400] bean: freerobby: have you read this? http://docs.opscode.com/chef/essentials_data_bags.html
[2013-08-14 19:24:10 -0400] Boohbah: is anyone working on systemd support in chef/ohai?
[2013-08-14 19:24:49 -0400] freerobby: bean: Yes, it doesn't cover anything about how to securely pass the secret key onto the server.
[2013-08-14 19:26:25 -0400] freerobby: bean: Am I crazy or is it handwaving over the part of encryption that is actually hard, which is securely giving access to a node to read a data bag with symmetric encryption?
[2013-08-14 19:31:01 -0400] bean: freerobby: check the "Store Keys on Nodes" part
[2013-08-14 19:32:09 -0400] yfeldblum: freerobby, the basic approach is to bootstrap the node with the key with `knife bootstrap`, which is run from the sysadmin's machine and copies the key from the sysadmin's machine
[2013-08-14 19:32:49 -0400] yfeldblum: freerobby, you can also deliver the key in other ways
[2013-08-14 19:33:17 -0400] yfeldblum: freerobby, key distribution beyond the simple, however, does not ship with chef
[2013-08-14 19:37:57 -0400] freerobby: yfeldblum: So would my best bet be to pass it as a -J attribute when I run chef bootstrap?
[2013-08-14 19:38:02 -0400] freerobby: err, knife bootstrap
[2013-08-14 19:38:24 -0400] yfeldblum: freerobby, i don't know what your best bet would be, as that would depend highly on your particular circumstances
[2013-08-14 19:38:33 -0400] yfeldblum: freerobby, but give it a go and see how it works
[2013-08-14 19:38:54 -0400] freerobby: yfeldblum: I'm just trying to clarify your first statement - what triggers the copy from the sysadmin's machine to the node?
[2013-08-14 19:39:11 -0400] freerobby: yfeldblum: Or do you mean that a sysadmin would manually do that after bootstrapping?
[2013-08-14 19:39:19 -0400] yfeldblum: freerobby, there may be an option in `knife bootstrap` or in one of the `knife $CLOUD server create` commands
[2013-08-14 19:40:04 -0400] freerobby: I don't believe that's the case, at least by my reading of the knife help output
[2013-08-14 19:40:09 -0400] bean: encrypted_data_bag_secret in my knife.rb
[2013-08-14 19:40:47 -0400] yfeldblum: freerobby, right, it may be an option in your `knife.rb` rather than an option passed on the command-line
[2013-08-14 19:41:24 -0400] freerobby: yfeldblum: I see an option to specify a default encryption secret, but there is nothing documented that leads me to think it will pass that onto a node.
[2013-08-14 19:41:48 -0400] bean: looks like --secret and --secret-file we're added to knife a while back
[2013-08-14 19:42:06 -0400] freerobby: bean: right, but those just tell knife to use the secret, they don't mention anything about passing that to a node
[2013-08-14 19:42:33 -0400] freerobby: I'm not trying to be a pain here; I'm just trying to figure out if I actually need to build this from the ground up or if I'm just missing something in the docs.
[2013-08-14 19:42:56 -0400] bean: pretty sure that will make it dump to /etc/chef/encrypted_data_bag_secret on the server
[2013-08-14 19:42:58 -0400] bean: i might be wrong though
[2013-08-14 19:43:17 -0400] freerobby: bean: Thanks. I will see if it does that for us.
[2013-08-14 19:43:39 -0400] freerobby: bean: mind running 'knife version' for me just so i can compare apples to apples on our end?"
[2013-08-14 19:43:56 -0400] bean: just reading the chef code
[2013-08-14 19:44:06 -0400] freerobby: ah
[2013-08-14 19:44:32 -0400] bean: https://github.com/opscode/chef/commit/b532c23d05b7d17eaa554fb04755f2b4c075a143#L1R50 specifically
[2013-08-14 19:44:40 -0400] yfeldblum: freerobby, https://github.com/opscode/chef/blob/11.6.0/lib/chef/knife/bootstrap/chef-full.erb#L34-L39
[2013-08-14 19:48:55 -0400] tabolario: freerobby: i know from experience with knife ec2 that it uses the encrypted_data_bag_secret specified in your knife.rb when bootstrapping a node
[2013-08-14 19:49:25 -0400] tabolario: (that's where that encrypted_data_bag_secret variable comes from in the bootstrap template yfeldblum linked)
[2013-08-14 19:51:37 -0400] yfeldblum: right, that's the "bootstrap script" which knife renders locally, scp's to the server being bootstrapped, and runs
[2013-08-14 19:53:42 -0400] chris613: A tidbit for the logs. Ever wanted to write environment.json version pins that match the current set of cookbooks in your repo? Enjoy: egrep '^\s*version' cookbooks/*/metadata.rb site-cookbooks/*/metadata.rb | awk -F / '{print $2 $3}' | sed 's/metadata.rb//' | sed "s/:version\\s*[\"']/\": \"= /" | sed "s/'\$/\"/"
[2013-08-14 19:53:58 -0400] chris613: Once you get over 100 cookbooks, updating those pins can be a pain. :)
[2013-08-14 20:00:24 -0400] freerobby: bean: yfeldblum: tabolario: thank you all very much
[2013-08-14 20:00:26 -0400] btm: @opscode cookbook code review starting a little late today, maybe 15m. stick around if you want to join.
[2013-08-14 20:01:11 -0400] surge_: Anyone else run into 403 Forbidden errors when deploying chef to a t1.micro instance?
[2013-08-14 20:01:45 -0400] surge_: Usually when I bootstrap on such small nodes, it's a hit or miss.
[2013-08-14 20:06:40 -0400] snipe: gchristensen: have you run into this issue at all? https://github.com/RiotGames/berkshelf/issues/787
[2013-08-14 20:07:45 -0400] bean: snipe: I think I've actually heard of that issue before
[2013-08-14 20:08:43 -0400] gchristensen: snipe: I have not, but I have experienced other issues :0
[2013-08-14 20:09:49 -0400] snipe: bean: allegedly fixed in 2.0.8, but I'm still seeing it
[2013-08-14 20:10:40 -0400] kryptek: Can someone here help me out? I'm loading a data bag from my recipe.. there's an array in it that I want to push more data to but when I try and do that the object it's trying to perform the operation on a Hash object instead of type Array
[2013-08-14 20:11:24 -0400] kryptek: the path for the object's array is variable['groups'].. i tried doing variable['groups'] << 'new-group'
[2013-08-14 20:11:43 -0400] freerobby: yfeldblum: tabolario: bean: interestingly that trick works for knife bootsrap but not knife ec2 server create as of 11.6.
[2013-08-14 20:11:52 -0400] bean: interesting
[2013-08-14 20:12:19 -0400] Boohbah: so what are the obstacles supporting system in archlinux? i see a bunch of tickets from last year
[2013-08-14 20:12:25 -0400] Boohbah: systemd*
[2013-08-14 20:14:37 -0400] Boohbah: i see the systemd provider was added https://github.com/opscode/chef/pull/93
[2013-08-14 20:14:44 -0400] Boohbah: but not the patches to make archlinux use it
[2013-08-14 20:15:22 -0400] Boohbah: https://github.com/opscode/chef/pull/506
[2013-08-14 20:16:17 -0400] kryptek: nm solved my issue
[2013-08-14 20:16:29 -0400] bean: snipe: my coworker says he just blows out his berksfile.lock and magically the problem goes away
[2013-08-14 20:16:48 -0400] snipe: bean: there is none tho. no berksfile or lock file
[2013-08-14 20:16:53 -0400] snipe: but no error on gem install
[2013-08-14 20:16:55 -0400] bean: ah
[2013-08-14 20:18:06 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/573d6969f0cdc0360234ba6fe8a48bf9731d1c74, watch: http://youtu.be/3qyJKN8p1zM
[2013-08-14 20:20:23 -0400] miah: Boohbah: i suspect that the tickets might need updating with links to code that fixes the problems stated
[2013-08-14 20:25:52 -0400] snipe: bean: looks like berkshelf docs want you to create a berkshelf file, learnchef docs imply its created. Berkshelf maintainers just told me to RTFM. *eyeroll*
[2013-08-14 20:26:12 -0400] bean: well,
[2013-08-14 20:26:15 -0400] bean: you have to create it somehow
[2013-08-14 20:26:38 -0400] snipe: bean: yeah, it's the learnchef docs that need a tweak
[2013-08-14 20:27:35 -0400] snipe: bean: do you know if those docs are formable? I'm happy to submit a pull request
[2013-08-14 20:27:48 -0400] snipe: formable? really autocorrect?
[2013-08-14 20:27:51 -0400] snipe: fork-able
[2013-08-14 20:28:00 -0400] Boohbah: miah: ahh, so the linked code does not actually fix the problem?
[2013-08-14 20:32:53 -0400] bean: snipe: i do not know anything about learn chef docs :)
[2013-08-14 20:33:02 -0400] snipe: :)
[2013-08-14 20:42:46 -0400] tabolario: well that's strange, berkshelf does not seem to be respecting the revision tagged in the lockfile for a git dependency
[2013-08-14 20:43:33 -0400] tabolario: it has the correct revision in the lockfile from the last time i did an update, but it keeps uploading the master branch
[2013-08-14 21:00:26 -0400] tabolario: hmm.. where does OSS chef server store its cookbooks?
[2013-08-14 21:01:22 -0400] failshell: i have this minitest for chef10/11 on ubuntu/rhel/sles. it only fails on ubuntu + chef 11. im a bit confused. https://gist.github.com/failshell/52177342670b81eaae65
[2013-08-14 21:01:32 -0400] failshell: if anyone can figure that one out :)
[2013-08-14 21:01:49 -0400] failshell: ownership is fine
[2013-08-14 21:10:14 -0400] ismell: jtimberman: you around? I have a question with application_python
[2013-08-14 21:12:40 -0400] joefitzgerald: btm: how long should i expect PR's with issues in 'fix provided' state to wait for review? a few weeks? seems unrealistic for you guys to be able to get through 100+ issues in a 1hr session - and i only completed my 3 PRs in the past day - just trying to gauge timeframes
[2013-08-14 21:44:19 -0400] ismell: hrmm, the before_migrate block is not getting called in my application block
[2013-08-14 21:58:54 -0400] btm: joefitzgerald: we do three 1 hour reviews a week for cook, which seems to be keeping pace. when we get a chance we usually throw in a random 2 hour sessions to catch up, but we're trying to encourage the community to help each other review PRs to reduce the cycle, and eventually, on some glorious day, implementing ways to make the whole process a little more community driven.
[2013-08-14 21:59:32 -0400] joefitzgerald: btm: makes sense is there a way to short circuit it for specific cookbooks?
[2013-08-14 21:59:40 -0400] joefitzgerald: i.e. by working with a cookbook 'maintainer'?
[2013-08-14 22:03:30 -0400] snipe: gchristensen: hm, knife ec2 server create provisioned the server correctly and installed chef, but errored with: Error executing action `install` on resource 'package[build-essential]'
[2013-08-14 22:06:09 -0400] joefitzgerald: (e.g. my 3 PRs are all for the 'windows' cookbook)
[2013-08-14 22:06:59 -0400] bean: snipe: i've seen stuff like that happen where apt-get update hasn't been run yet
[2013-08-14 22:11:34 -0400] jtimberman: ismell: i'm not actually that familiar with using the application_python cookbook.
[2013-08-14 22:11:36 -0400] gchristensen: snipe: check out the `apt` cookbook - it does a periodic update.
[2013-08-14 22:12:15 -0400] ismell: i actually ruled out application_python
[2013-08-14 22:12:33 -0400] ismell: it seems that the before_migrate and before_symlink are not geting called in the application cookbook
[2013-08-14 22:12:56 -0400] ismell: before_deploy gets called, but thats because the application cookbook implements it
[2013-08-14 22:20:01 -0400] ismell: and it's cuz i have to force_deploy
[2013-08-14 22:24:56 -0400] zuhaib: Whats the deal with shipping encrypted keys using knife.rb in 11.6, I am setting knife[:secret_file] = "#{current_dir}/encrypted_data_bag_secret_dev" but none of my boxes are getting the key
[2013-08-14 22:28:37 -0400] troyready: zuhaib, is secret_file the new syntax or the old syntax?
[2013-08-14 22:29:03 -0400] zuhaib: you mean "knife[:secret_file]" thats suppose to be the new syntax
[2013-08-14 22:29:23 -0400] troyready: Hmmm, right, not sure then
[2013-08-14 22:29:33 -0400] ismell: encrypted_data_bag_secret "#{current_dir}/encrypted_data_bag_secret"
[2013-08-14 22:29:37 -0400] ismell: then it will copy it over
[2013-08-14 22:31:42 -0400] zuhaib: ismell: see this: https://github.com/opscode/chef/commit/8b70c96d13fdf7f62c5b74326fafc04664b793b5
[2013-08-14 22:32:00 -0400] zuhaib: Chef 11.6 is already warning that encrypted_data_bag_secret is being removed
[2013-08-14 22:32:24 -0400] sparr: I use `chef-client -j foo.json` to specify the node's roles the first time chef is run. Without configuring the node as a workstation, is there a way to get that role into the run list for the node on the chef server?
[2013-08-14 22:32:36 -0400] zuhaib: I know it works right now as expected, I am standing up a new dev box and wanted to test the new style but it seems to be notworking as I expect
[2013-08-14 22:33:15 -0400] zuhaib: TBH I dont know why its being removed in the first place, the reasoning is a little (derp) to me
[2013-08-14 22:46:24 -0400] neh: I'm having a problem with my nodes not downloading newer versions of cookbooks from the server. It stopped several versions back, and I can't figure out why. I'm not pinning cookbook versions anywhere (and there was never a reason to pin to the last version being downloaded). Anybody have any pointers on how to debug this?
[2013-08-14 22:55:19 -0400] coderanger: neh: You can use knife exec to post to the cookbook_versions end point and see what the version solver is showing
[2013-08-14 22:55:32 -0400] coderanger: neh: Might be a versioned dependency between two cookbooks
[2013-08-14 22:57:46 -0400] Majost: huh..
[2013-08-14 22:58:34 -0400] Majost: Am I reading the code right, locking users is not implemented? https://github.com/opscode/chef/blob/4f3ae7200f693b3c5ad7278534aa0844b1bd225d/lib/chef/provider/user.rb#L170-L183
[2013-08-14 22:59:10 -0400] Majost: actually: https://github.com/opscode/chef/blob/4f3ae7200f693b3c5ad7278534aa0844b1bd225d/lib/chef/provider/user.rb#L170-L187
[2013-08-14 22:59:21 -0400] coderanger: Majost: It is implemented by the subclass
[2013-08-14 22:59:31 -0400] coderanger: Majost: Providers::User is not used directly
[2013-08-14 22:59:37 -0400] Majost: ah
[2013-08-14 22:59:44 -0400] coderanger: https://github.com/opscode/chef/blob/4f3ae7200f693b3c5ad7278534aa0844b1bd225d/lib/chef/provider/user/useradd.rb#L84-L86
[2013-08-14 22:59:45 -0400] coderanger: example
[2013-08-14 23:04:01 -0400] Majost: why would that function even exist in user.rb then?
[2013-08-14 23:05:17 -0400] coderanger: Majost: In case you forgot to implement it? Thats pretty standard in OO design
[2013-08-14 23:05:23 -0400] Majost: ah
[2013-08-14 23:05:29 -0400] coderanger: It also is at least somewhat self-documenting, etc
[2013-08-14 23:05:48 -0400] neh: coderanger: thanks for the tip, I'll give it a try
[2013-08-14 23:17:54 -0400] ggayan: Hi guys, I'm figuring out if there's some way to switch roles on a same node when runing knife
[2013-08-14 23:18:21 -0400] ggayan: in order to run one role at some time, and other in other instant
[2013-08-14 23:19:10 -0400] ggayan: currently I have a role for configuring an app in a node, and I have another role for a different app in the same node. What structure would you recommend? maybe using environments and switch them?
[2013-08-14 23:19:52 -0400] coderanger: ggayan: Just assign both roles to the same node
[2013-08-14 23:22:13 -0400] ggayan: sure, but I'd like to avoid running both at the same time
[2013-08-14 23:22:22 -0400] ggayan: or am I thinking it the wrong way?
[2013-08-14 23:22:47 -0400] troyready: Yeah, I would avoid trying to architect things like that if you can
[2013-08-14 23:22:59 -0400] coderanger: ggayan: Make both idempotent
[2013-08-14 23:23:11 -0400] coderanger: ggayan: It isn't about actions, it is about state
[2013-08-14 23:23:12 -0400] troyready: There shouldn't be any reason the two roles couldn't sit next to each other on the run_list
[2013-08-14 23:23:32 -0400] ggayan: okay, that sounds right
[2013-08-14 23:23:40 -0400] ggayan: I was trying to speedup the chef-client run
[2013-08-14 23:23:49 -0400] ggayan: maybe using more notifies
[2013-08-14 23:23:54 -0400] ggayan: if and not_if's right?
[2013-08-14 23:24:12 -0400] coderanger: ggayan: There are some report handlers you can use to debug which resources are making your runs slow
[2013-08-14 23:27:35 -0400] Otterley: anyone have a link to the issue that caused queued notifications to run after a convergence failure?
[2013-08-14 23:28:01 -0400] Otterley: this "feature" has complicated troubleshooting for us
[2013-08-14 23:28:06 -0400] coderanger: Otterley: Not sure what you mean, that was added explicitly
[2013-08-14 23:28:37 -0400] Otterley: coderanger, I've been told it was implemented under pressure
[2013-08-14 23:28:56 -0400] coderanger: Otterley: The issue was that otherwise things like service restarts get lost forever
[2013-08-14 23:29:05 -0400] Otterley: for our part, we don't want that
[2013-08-14 23:29:27 -0400] Otterley: if restarts are needed now, people can use :immediately
[2013-08-14 23:29:38 -0400] coderanger: Example case:
[2013-08-14 23:29:58 -0400] coderanger: You are configuring Apache, you change a bunch of config files each with a delayed reload notification
[2013-08-14 23:30:17 -0400] coderanger: you don't want to use immediately because then it has to reload multiple times during the converge
[2013-08-14 23:30:24 -0400] Otterley: *shrug*
[2013-08-14 23:30:48 -0400] coderanger: and you don't want the reload to be lost, since without that you have now drifted state and can never recover without further changes
[2013-08-14 23:31:12 -0400] Otterley: I agree with half of that - I don't see the harm in multiple reloads if you're concerned about it
[2013-08-14 23:31:31 -0400] coderanger: Speed, not everything supports a simple SIGHUP to reload its config
[2013-08-14 23:31:41 -0400] coderanger: many procs need a full restart cycle and that means downtime
[2013-08-14 23:31:46 -0400] Otterley: That's a premature optimization
[2013-08-14 23:32:03 -0400] Otterley: there is plenty of other low-hanging fruit WRT speed in Chef
[2013-08-14 23:32:17 -0400] coderanger: Such as ...
[2013-08-14 23:32:24 -0400] Otterley: persistent HTTP connections
[2013-08-14 23:32:30 -0400] Otterley: data bag caching
[2013-08-14 23:32:34 -0400] Otterley: search result caching
[2013-08-14 23:32:38 -0400] coderanger: Basically either we made this change, or we removed delayed notifications
[2013-08-14 23:33:13 -0400] coderanger: lmao if you think adding caches is "low-hanging"
[2013-08-14 23:33:30 -0400] Otterley: why not?
[2013-08-14 23:33:55 -0400] Otterley: store the result in memory indexed by query *shrug*
[2013-08-14 23:34:51 -0400] coderanger: Because 1) adding caches will definitely break anything that writes back to a data bag from Chef 2) search results already have major inconsistency problems thanks to the paging system, last thing we need is to make it even more difficult to get a sane picture of things
[2013-08-14 23:35:18 -0400] coderanger: Remember that most searches are not a single API call, it does server side pagination with a local cursor
[2013-08-14 23:35:46 -0400] coderanger: But all that aside
[2013-08-14 23:36:00 -0400] Otterley: anyway, I hear your point about the notifications issue, but there are bugs - like if a service is declared but the package containing the start script isn't installed yet due to a failure that occurs before it is installed, a notification can still get triggered to start that service even though the edge condition hasn't triggered yet
[2013-08-14 23:36:03 -0400] coderanger: if you want to have something like a delayed notification that only happens if the run succeeds, its relatively easy to build
[2013-08-14 23:36:37 -0400] coderanger: use a ruby_block to set something in the run state hash, and have a report handler that does the actions
[2013-08-14 23:36:49 -0400] coderanger: this is how we do reboots on windows, for example
[2013-08-14 23:36:51 -0400] Otterley: maybe throwing out queued delayed notifications is not the answer, but yeah, there are edge cases where it fails
[2013-08-14 23:37:09 -0400] coderanger: There are definitely edge cases, this just fails "safer"
[2013-08-14 23:37:18 -0400] coderanger: since you don't hit the case of invisible state diversion
[2013-08-14 23:37:24 -0400] coderanger: you can definitely get bad state
[2013-08-14 23:37:33 -0400] coderanger: but at least it is fixable bad state :)
[2013-08-14 23:37:53 -0400] Otterley: also, you don't have to cache by default
[2013-08-14 23:38:10 -0400] Otterley: but the option isn't even there
[2013-08-14 23:38:58 -0400] coderanger: Which option?
[2013-08-14 23:39:03 -0400] coderanger: To cache stuff?
[2013-08-14 23:39:12 -0400] Otterley: yes
[2013-08-14 23:39:15 -0400] coderanger: Sure it is
[2013-08-14 23:39:22 -0400] coderanger: use the run state
[2013-08-14 23:39:35 -0400] Otterley: I meant in the API
[2013-08-14 23:39:45 -0400] Otterley: of course we can cache ourselves with a wrapper method, but ew
[2013-08-14 23:40:39 -0400] Otterley: (also, who writes to data bags?  what's the use case?)
[2013-08-14 23:40:48 -0400] coderanger: mynodes = node.run_state[:search_mynodes] ||= search(:nodes, ...)
[2013-08-14 23:40:55 -0400] coderanger: Insta-cache
[2013-08-14 23:45:04 -0400] Otterley: what are some justifiable use cases for writing to data bags during a Chef run?
[2013-08-14 23:46:53 -0400] coderanger: Otterley: deploy tracking, cheap storage, master elections, etc
[2013-08-14 23:47:37 -0400] coderanger: Also just because you brought it up, persistent HTTP connections are a minimal increase in speed, I've tried
[2013-08-14 23:47:43 -0400] coderanger: The overhead is in the signing and sig verification
[2013-08-14 23:47:52 -0400] coderanger: which happens per-req regardless
[2013-08-14 23:47:55 -0400] Otterley: what's your RTT?
[2013-08-14 23:48:08 -0400] Otterley: on a LAN it's not going to matter
[2013-08-14 23:48:21 -0400] Otterley: on a long latency link it makes a tremendous difference.
[2013-08-14 23:48:38 -0400] coderanger: 64 bytes from 184.106.28.85: icmp_req=1 ttl=53 time=58.7 ms
[2013-08-14 23:48:44 -0400] coderanger: Thats from Portland to Chicago
[2013-08-14 23:48:46 -0400] Otterley: that's not enough to matter much
[2013-08-14 23:49:03 -0400] Otterley: I've got a European-west coast USA connection with 150ms latency, 300MS RTT
[2013-08-14 23:49:04 -0400] coderanger: (read: from the PSF network to api.opscode.com)
[2013-08-14 23:49:43 -0400] coderanger: Otterley: It can take 500ms+ between the client and server on request signing
[2013-08-14 23:49:47 -0400] Otterley: it takes 20-30 seconds to download some reasonably large cookbooks
[2013-08-14 23:50:00 -0400] Otterley: sorry, my real world experience wins
[2013-08-14 23:50:16 -0400] coderanger: Otterley: There will come a time when persistent HTTP stuffs help more, but for now its largely lost in the noise
[2013-08-14 23:50:38 -0400] coderanger: The low(er) hanging fruit there is non-RSA request verification
[2013-08-14 23:50:58 -0400] coderanger: which was being investigated at one point, but I think we got pulled on to other stuff
[2013-08-14 23:52:00 -0400] Otterley: we'll talk later - gotta go
[2013-08-14 23:52:25 -0400] jameson__: later
[2013-08-14 23:52:28 -0400] jameson__: @_@
[2013-08-14 23:52:40 -0400] coderanger: Check out the windows cookbook for an example of the notification trick I mentioned
[2013-08-14 23:55:41 -0400] troyready: I love the very.....*interesting*....personalities that drop by a project like this.
[2013-08-14 23:55:46 -0400] troyready: Some really strong opinions out there
[2013-08-14 23:57:19 -0400] coderanger: troyready: Dangers of making a tool that becomes part of the critical path to doing your job
[2013-08-14 23:57:38 -0400] coderanger: :)
[2013-08-14 23:57:55 -0400] troyready: Should have just gone into carpentry instead
[2013-08-14 23:58:05 -0400] troyready: That's what we've joked around with at work sometimes
[2013-08-14 23:58:11 -0400] coderanger: When Chef breaks (or behaves in unexpected ways) it literally ruins someone's day
[2013-08-14 23:59:02 -0400] troyready: Well, the funny part to me is how often people are vehemently opposed to thinking about something in a different way
[2013-08-14 23:59:03 -0400] coderanger: troyready: I go back and forth between cooking (the real kind) and astrophysics, we'll see which wins by the time I hit my mid-life crisis
[2013-08-14 23:59:11 -0400] troyready: :)
