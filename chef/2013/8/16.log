[2013-08-16 08:12:45 -0400] s2r2: good daytime[get_timezone].  I'm a little overwhelmed by the choice of unattended-updates-cookbooks... has anyone got any preference I can stupidly follow?
[2013-08-16 09:49:40 -0400] daxroc: How can I get a checksum of a cookbook_file with in a recipe ?
[2013-08-16 10:26:58 -0400] lh_: Hi there
[2013-08-16 10:28:30 -0400] lh_: I'm interested in asking some questions specifically about encrypted data bags, am I in the right place?
[2013-08-16 11:24:41 -0400] TheCodeAssassin: hi everyone
[2013-08-16 11:59:29 -0400] jds_: I've been having problems with the mysql/database recipes running before the apt recipe gets chance to run 'apt-get update'.  I can fix it by setting "node.default['build_essential']['compiletime'] = true", like in http://stackoverflow.com/questions/11380485/chef-why-are-resources-in-an-include-recipe-step-being-skipped ... but why isn't something similar just baked directly into the mysql recipe?
[2013-08-16 12:08:15 -0400] jds_: Huh.  It looks like it is : https://github.com/opscode-cookbooks/mysql/blob/master/recipes/ruby.rb#L23
[2013-08-16 12:08:22 -0400] jds_: Wonder what's going wrong in my case
[2013-08-16 12:18:13 -0400] joelteon: chef runs as root, right? should it be loading /etc/bashrc?
[2013-08-16 12:45:57 -0400] jds_: Oh, ffs.  I'd already done "include_recipe 'build-essential'", so when the mysql cookbook sets compiletime=true then requires build-essential again, it has no effect.
[2013-08-16 12:54:23 -0400] rlavoie: Is there a way I can add a resource to the entire chef repository (like file or template) so I do not have to rewrite code in every cookbook to do the same thing?
[2013-08-16 12:58:42 -0400] xhae: cobby: if you're repeating yourself move it out into another cookbook and depend on that
[2013-08-16 12:59:20 -0400] cobby: @xhae Is there another way to do that other than a cookbook?
[2013-08-16 12:59:58 -0400] cobby: @xhae I would rather not have to remember to depend on a cookbook and just add custom_resource to the recipe and not have to worry about it.
[2013-08-16 13:21:24 -0400] joelteon: so chef does NOT read bashrc
[2013-08-16 13:22:02 -0400] joelteon: ok, i'm setting some envars in /etc/bashrc. how should i make them visible to chef?
[2013-08-16 13:23:24 -0400] zts: cobby: yes, LWRPs are the easiest way of defining your own resource (like file or template) - http://docs.opscode.com/lwrp.html
[2013-08-16 13:24:13 -0400] cobby: @zts right.  But that is inside of a cookbook.  I would rather not create a cookbook just for an lwrp
[2013-08-16 13:24:23 -0400] zts: cobby: other ways of encapsulating code for reuse are definitions - http://docs.opscode.com/essentials_cookbook_definitions.html - and libraries - http://docs.opscode.com/essentials_cookbook_libraries.html
[2013-08-16 13:24:57 -0400] zts: cobby: well, cookbooks are how you ship code for use in a chef run, so that's the right place for them.
[2013-08-16 13:26:10 -0400] cobby: @zts :(
[2013-08-16 13:26:41 -0400] xhae: cobby: libraries, modules, cookbooks - whatever they're called, they're a common pattern, and not an onerous one.
[2013-08-16 13:26:46 -0400] atomic-penguin: joelteon, http://docs.opscode.com/resource_env.html
[2013-08-16 13:26:55 -0400] zts: cobby: what was the mechanism you were hoping for?  adding resources via gems, or something else?
[2013-08-16 13:27:08 -0400] atomic-penguin: joelteon, most likely by manipulating the ENV ruby variable
[2013-08-16 13:27:18 -0400] cobby: a custom "plugin" if you will.
[2013-08-16 13:27:56 -0400] cobby: @zts I would like to call this resource as I would call the "file" or "template" resource in any other cookbook.
[2013-08-16 13:29:15 -0400] zts: cobby: yes, which is what you'd do with LWRPs (or heavyweight resources shipped in libraries).  What I'm curious about is how you'd like to get that custom code into Chef for it to use?
[2013-08-16 13:29:58 -0400] xhae: Could new resources be added to the namespace in which chef looks for them by installing a gem?
[2013-08-16 13:30:48 -0400] zts: cobby: there might well be something else I'm not thinking of (since I've always used the aforementioned ways), so we might be able to think of something creative if you have an idea of how you'd like it to work
[2013-08-16 13:32:46 -0400] zts: xhae: that's what I'm wondering, too - I haven't seen it done, but that doesn't mean it's impossible.  I think you'd still need to use "chef_gem" to load it, though (I don't think the Chef code itself will automatically load unknown 3rd-party gems)
[2013-08-16 13:32:48 -0400] cobby: @zts I used puppet since it was 0.24 - 2.7  You could create a class and build resources in puppet code and send libraries over and that would give you the ability to use it in other "modules".  I found that handy, but all of the other pitfalls of puppet made me look else where. I love chef but I found this one thing that may bug me.  But not bug me too much since I can just (as you two have said) create cookbook with resources, providers 
[2013-08-16 13:33:12 -0400] cobby: I have zero ideas since I am still a bit new to chef.
[2013-08-16 13:34:51 -0400] zts: cobby: yeah, I'd suggest doing it the way everyone else does when you're starting out, and then revisit it when you know what's good/bad about it.
[2013-08-16 13:35:07 -0400] cobby: will do.  thx :)
[2013-08-16 13:35:45 -0400] zts: cobby: note that if you make a cookbook containing your LWRP, you don't _need_ to list it as a dependency from all your other cookbooks - you could specifically list it yourself in the run list
[2013-08-16 13:36:06 -0400] zts: cobby: it's just good practice to list it as a dependency, both to make it clear what you're doing, and to avoid some potentially-confusing errors
[2013-08-16 13:36:24 -0400] cobby: @zts yeah, thx for the tip :)
[2013-08-16 13:36:36 -0400] zts: cobby: if you're shipping code as a library, your library can extend the Chef::Recipe class to add stuff that will then be usable in every recipe
[2013-08-16 13:58:20 -0400] joelteon: atomic-penguin: can I do interpolation inside that?
[2013-08-16 14:00:56 -0400] atomic-penguin: joelteon, like string interpolation?
[2013-08-16 14:01:05 -0400] joelteon: atomic-penguin: well, if I wanted to set PATH
[2013-08-16 14:01:06 -0400] atomic-penguin: joelteon, no idea, haven't used it much
[2013-08-16 14:01:08 -0400] joelteon: I'll just find out for myself
[2013-08-16 14:01:16 -0400] atomic-penguin: joelteon, yeah, you'll have to experiment
[2013-08-16 14:03:04 -0400] aramus_: Hi guys, is there a way to find the node's OS?
[2013-08-16 14:06:13 -0400] siezer: node['platform']
[2013-08-16 14:06:32 -0400] aramus_: Thanks a lot, siezer. Have a good weekend.
[2013-08-16 14:07:52 -0400] aramus_: Siezer, is there a way to find if you're running different versions of the same OS i.e. RHEL 5 or RHEL 6?
[2013-08-16 14:10:01 -0400] siezer: this may be helpful: https://github.com/someara/squid-cookbook/blob/master/attributes/default.rb
[2013-08-16 14:11:02 -0400] aramus_: Thanks!
[2013-08-16 14:14:29 -0400] mveitas: I am having some issues using knife upload, for some reason nothing is being uploaded from the environments. I switched to using json for the chef_repo
[2013-08-16 14:17:09 -0400] mveitas: using -n --force to do a dry and force changes, only things from the data bags are being detected
[2013-08-16 14:32:03 -0400] Sundiata: Hola
[2013-08-16 14:32:08 -0400] Sundiata: anyone awake?
[2013-08-16 14:39:06 -0400] mveitas: issuing a command "knife upload . --force" should upload all the items (data_bags, environments, etc), correct?
[2013-08-16 14:39:56 -0400] nick__: hey guys
[2013-08-16 14:40:13 -0400] nick__: anyone ever see this issue while bootstraping centos:
[2013-08-16 14:40:14 -0400] nick__: 192.168.31.99  192.168.31.99 RubyGems 1.6.2 installed 192.168.31.99 ./lib/rubygems/custom_require.rb:36:in `gem_original_require' 192.168.31.99 : no such file to load -- rdoc/rdoc (LoadError) 192.168.31.99 from ./lib/rubygems/custom_require.rb:36:in `require' 192.168.31.99 from ./lib/rubygems/commands/setup_command.rb:330:in `run_rdoc' 192.168.31.99 from ./lib/rubygems/commands/setup_command.rb:240:in `install_rdoc' 192.168.31.99 fr
[2013-08-16 14:44:24 -0400] adamjk-dev: anyone know how I can use knife to download the data bags to my current working directory?
[2013-08-16 14:45:39 -0400] Sundiata: not sure that you can
[2013-08-16 14:46:00 -0400] adamjk-dev: weak....
[2013-08-16 14:47:28 -0400] daxroc: Do you need a chefignore in each cookbook dir?
[2013-08-16 14:48:09 -0400] BrianJ: so do i put the community cookbook in my cookbooks/ dir or site-cookbooks/ dir
[2013-08-16 14:48:10 -0400] BrianJ: ?
[2013-08-16 14:50:02 -0400] mveitas: issuing a command "knife upload . --force" should upload all the items (data_bags, environments, etc), correct? I am only seeing data bags being uploaded
[2013-08-16 14:50:06 -0400] nick__: anyone face issues with bootstrapping centos and ERROR:  While executing gem ... (Gem::DocumentError)
[2013-08-16 14:52:34 -0400] chris613: nick__: I actually had a problem like that yesterday. Turned out that root had rvm running in bash_profile
[2013-08-16 14:53:00 -0400] chris613: I doubt you have the same problem, but anything that sets the GEM_PATH and friends envvars can interfere with a bootstrap
[2013-08-16 14:53:37 -0400] nick__: i dont think i have anything setting the GEM path
[2013-08-16 14:53:52 -0400] nick__: its a brand new built server that is running only mysql
[2013-08-16 14:54:18 -0400] nick__: i dont have rvm either, i ran into that issue before
[2013-08-16 15:18:17 -0400] HAPPYFUNBALL: what sort of code can be contained in not_if clauses?
[2013-08-16 15:18:55 -0400] HAPPYFUNBALL: can I use bash inside?
[2013-08-16 15:20:39 -0400] HAPPYFUNBALL: or does not_if only work with ruby?
[2013-08-16 15:21:21 -0400] Sundiata: you can use shell commands
[2013-08-16 15:21:29 -0400] Sundiata: but not bash specific syntax
[2013-08-16 15:21:39 -0400] HAPPYFUNBALL: explain
[2013-08-16 15:22:09 -0400] nick__: anyone see this issue with centos: installing nagios-quick-start base role via bootstrap: execute[apt-get update] (apt::default line 20)
[2013-08-16 15:22:16 -0400] nick__: why does it try to do apt-get update
[2013-08-16 15:22:31 -0400] HAPPYFUNBALL: specifically, I need to ssh into a remote host to check if a file exists in order to determine whether if I should run a resource
[2013-08-16 15:22:33 -0400] jbz: HAPPYFUNBALL If you put your not_if condition in quotes, it will get executed by shell
[2013-08-16 15:22:44 -0400] jbz: and the condition will depend on the exit status
[2013-08-16 15:23:20 -0400] Sundiata: syntax that needs a bash shell to interpret, like for loops, do, while until, etc, won't work
[2013-08-16 15:23:41 -0400] Sundiata: of course you could do that in rubyanyways
[2013-08-16 15:24:03 -0400] Sundiata: but something like a file existence test would work, because '[' is a command
[2013-08-16 15:24:16 -0400] Sundiata: # which [
[2013-08-16 15:24:24 -0400] Sundiata:  /usr/bin/[
[2013-08-16 15:25:08 -0400] Sundiata: 'man test' for the kinds of checks that it supports
[2013-08-16 15:25:50 -0400] Sundiata: test, or [ is invoked by the shell
[2013-08-16 15:25:57 -0400] Sundiata: where loops and such are evaluated by the shell
[2013-08-16 15:26:32 -0400] Sundiata: commands have an exit status, and that's what chef uses, as jbz noted
[2013-08-16 15:26:41 -0400] HAPPYFUNBALL: Sundiata so this would work [ -f `ssh $hostname '/usr/local/file'` ]
[2013-08-16 15:27:46 -0400] Sundiata: the back tics are a callout to another shell
[2013-08-16 15:28:36 -0400] Sundiata: that wouldn't work as stated, because you're asking a local file to verify whether a remote file exists
[2013-08-16 15:28:40 -0400] Sundiata: er a local shell
[2013-08-16 15:29:04 -0400] Sundiata: 'test' can test local files
[2013-08-16 15:29:05 -0400] jbz: You probably want to just wrap the test in a script and then call the script
[2013-08-16 15:29:13 -0400] Sundiata: ^
[2013-08-16 15:31:26 -0400] denken: i must be doing something fundamentally wrong here https://gist.github.com/jlott/b8be2f7739aa1d24d932
[2013-08-16 15:31:34 -0400] denken: im so green with ruby though... its not clear what
[2013-08-16 15:32:36 -0400] denken: it works fine if i dont try to push hashes per environment in the data bag item
[2013-08-16 15:32:41 -0400] denken: s/push/put/
[2013-08-16 15:33:24 -0400] HAPPYFUNBALL: hm
[2013-08-16 15:34:12 -0400] HAPPYFUNBALL: jbz / Sundiata is there a way to perform this test with ruby?
[2013-08-16 15:34:16 -0400] fedgoat: when using execute can I use multiple commands?  what is the order of execution and is there a queue that takes place or do they run simultatneously, etc
[2013-08-16 15:34:33 -0400] Sundiata: testing a file on another system?
[2013-08-16 15:34:37 -0400] jbz: HAPPYFUNBALL Wellruby is still going to have to shell out
[2013-08-16 15:35:06 -0400] mveitas: issuing a command "knife upload . --force" should upload all the items (data_bags, environments, etc), correct? I am only seeing data bags being uploaded
[2013-08-16 15:35:06 -0400] jbz: Is this other system also managed by chef?
[2013-08-16 15:35:10 -0400] HAPPYFUNBALL: jbz well, if I use ruby, I can include the test inside my recipe.
[2013-08-16 15:35:10 -0400] denken: fedgoat: afaik you can just string together shell commands as you normally would
[2013-08-16 15:35:16 -0400] denken: fedgoat: using ; or && or whatever
[2013-08-16 15:35:33 -0400] Scott: good morning from san francisco
[2013-08-16 15:35:40 -0400] HAPPYFUNBALL: I would prefer to keep actions as encapsulated as possible
[2013-08-16 15:36:30 -0400] Sundiata: access to a remote system will slow down your chef run, and lots of things happen on systems, its hard enough working with local files. Are you certain that a remote file will not change between the time you checked it and when you attempt to do some operation that depends on that check?
[2013-08-16 15:36:32 -0400] fedgoat: denken yea thats what I was going to do, but I wanted to know if execute supported more than one command or if there was some sort of threading logic
[2013-08-16 15:36:41 -0400] Guest25134: ?
[2013-08-16 15:37:34 -0400] denken: fedgoat: my guess would be that it just shells out... so whatever logic/possibilities are already there. afaik you can only have one "execute" line though.
[2013-08-16 15:37:37 -0400] jbz: HAPPYFUNBALL What file are you checking for and why?  If it's possible to do this without the cross-box check it's better.  As Sundiata said.
[2013-08-16 15:37:50 -0400] Scotts_Lost: ok...that was fun
[2013-08-16 15:37:58 -0400] jbz: Having a machine's convergence depend on off-box state is a recipe for pain.
[2013-08-16 15:38:03 -0400] Scotts_Lost: good morning from san francisco...again
[2013-08-16 15:38:05 -0400] Sundiata: ^^
[2013-08-16 15:38:09 -0400] Sundiata: as jbz said
[2013-08-16 15:38:30 -0400] HAPPYFUNBALL: jbz / Sundiata it's not possible to do this without the off box checking. I am basically setting up a DB slave with my recipe.
[2013-08-16 15:38:47 -0400] HAPPYFUNBALL: it might be painful, but it's got to be done
[2013-08-16 15:39:00 -0400] jbz: HAPPYFUNBALL There's no way to do it by checking on the other node's attributes in chef?
[2013-08-16 15:39:06 -0400] Sundiata: I'm certain there is a better way than that :)
[2013-08-16 15:39:30 -0400] fedgoat: denken, yea, but can you have multiple "command"s within the execute   A good project would be to add some threading and queuing logic for fun with some checks/balances capability for process execution and possibly posix control
[2013-08-16 15:40:41 -0400] Sundiata: HAPPYFUNBALL: When you setup your db slave ( or master? ) have the recipe add some attribute you can check on the node, something that is searchable
[2013-08-16 15:40:53 -0400] jbz: HAPPYFUNBALL The normal method of interbox coordination in chef (well, I say 'normal', I mean for me) is to rely on the other box recording its state and any relevant config info in its node attributes, and then searching from teh dependent node.
[2013-08-16 15:40:58 -0400] jbz: heh
[2013-08-16 15:41:07 -0400] Sundiata: then have your recipe on the local system check for nodes that have that attribute
[2013-08-16 15:41:08 -0400] Sundiata: lol
[2013-08-16 15:44:25 -0400] Scotts_Lost: has anyone had any troubles getting the community version of chef to listen on any ip addie other than loopback?
[2013-08-16 15:48:26 -0400] artcurmudgeon: what is a good replacement for RestClient.get? would wget do the same thing in the default.rb?
[2013-08-16 15:48:55 -0400] gchristensen: I know this is probably an edge case... but using omnibus-updater and chef-hipchat and an auto-running chef-client, when chef updates itself and throws the exception "New omnibus chef version installed. Killing Chef run!" it comes through onHipchat as "LoadError: cannot load such file -- highline" - is there any way to debug this or determine what is going on? it only happens when it runs headless.
[2013-08-16 15:48:57 -0400] artcurmudgeon: or would http.get work?
[2013-08-16 15:49:13 -0400] HAPPYFUNBALL: jbz yeah, that sounds workable
[2013-08-16 15:50:13 -0400] HAPPYFUNBALL: jbz how do I set an attribute on a remote node from a local node?
[2013-08-16 15:50:24 -0400] jbz: HAPPYFUNBALL You don't
[2013-08-16 15:50:48 -0400] HAPPYFUNBALL: jbz is it possible
[2013-08-16 15:50:48 -0400] HAPPYFUNBALL: ?
[2013-08-16 15:50:58 -0400] jbz: HAPPYFUNBALL You would want the DB master to, during its own chef run, set an attribute declaring that it it the db master
[2013-08-16 15:51:10 -0400] jbz: HAPPYFUNBALL: If it is, I don't know how to do it, and it's definitely an antipattern.
[2013-08-16 15:51:15 -0400] HAPPYFUNBALL: ok
[2013-08-16 15:51:46 -0400] HAPPYFUNBALL: so how would i search for an attribute on a different node?
[2013-08-16 15:54:03 -0400] jbz: HAPPYFUNBALL check here and go to the section on searching from a recipe: http://docs.opscode.com/essentials_search.html
[2013-08-16 15:58:36 -0400] nick__: does anyone attend the chef meetups?
[2013-08-16 16:01:17 -0400] adamjk-dev: anyone use the --chef-repo-path option for 'knife download' ?
[2013-08-16 16:01:31 -0400] btm: Scotts_Lost: Chef 11 Server? Which service are you trying to get to bind to another interface? The server typically fronts internal services with nginx.
[2013-08-16 16:01:33 -0400] adamjk-dev: I want to download data bags to my current working directory.... how can this not be an option?
[2013-08-16 16:01:52 -0400] adamjk-dev: in my opinion, you should be able to use knife to download to an arbitrary location
[2013-08-16 16:16:58 -0400] _dumfries: adamjk-dev: you can if you're using chef server.
[2013-08-16 16:20:58 -0400] aruntomar: anybody using chef on gentoo or funtoo?
[2013-08-16 16:31:24 -0400] adamjk-dev: _dumfries: how do you mean?
[2013-08-16 16:33:44 -0400] _dumfries: adamjk-dev:  You can redirect the knife data bag show result to any arbitrary location.
[2013-08-16 16:34:01 -0400] adamjk-dev: _dumfries: yeah, that is what I ended up doing, but seems like a weak solution is all
[2013-08-16 16:34:20 -0400] adamjk-dev: for item in `knife data bag show trusted_certificates`; do knife data bag show trusted_certificates $item -f j > data_bags/trusted_certificates/${item}.json; done
[2013-08-16 16:35:44 -0400] _dumfries: adamjk-dev: failing that you could look at writing a simple knife plugin to solve your problem.
[2013-08-16 16:36:18 -0400] adamjk-dev: _dumfries: what failed?
[2013-08-16 16:36:30 -0400] _dumfries: adamjk-dev: rather, if you're not happy do that.
[2013-08-16 16:36:36 -0400] vigith: in my attributes file i have
[2013-08-16 16:36:39 -0400] vigith:  node[:host][:slave][:packages] = [ 'pkg1', 'pkg2', {'name' = pkg3, version = ver}, pkg4 ]
[2013-08-16 16:36:40 -0400] adamjk-dev: _dumfries: that's better, but point taken
[2013-08-16 16:37:07 -0400] vigith: earlier for each entry i used to do .class
[2013-08-16 16:37:16 -0400] adamjk-dev: _dumfries: I am only surprised at the limitation is all... seems weak from a developer's standpoint
[2013-08-16 16:37:32 -0400] vigith: and in chef-10.xxx it is used to return Mash for {'name' = pkg3, version = ver}
[2013-08-16 16:37:37 -0400] adamjk-dev: _dumfries: but you are correct, a plugin could be created to handle it
[2013-08-16 16:37:44 -0400] vigith: but, in chef-11 i don't see Mash
[2013-08-16 16:37:44 -0400] _dumfries: adamjk-dev: I agree, hardly ideal.
[2013-08-16 16:37:57 -0400] adamjk-dev: adamjk-dev: but I also dislike having to install 30 plugins to do what I consider 'basic'
[2013-08-16 16:39:08 -0400] vigith: so, how do i know whether it is string-element or hash-element
[2013-08-16 16:42:50 -0400] xmltok_: initial chef runs on nodes in remote colos (to my chef server) spend a lot of time downloading cookbook files, is there a pattern for putting a local caching server in a colo? would varnish just work?
[2013-08-16 17:13:55 -0400] zenloop: Hey guys, I am trying to load my newly provisioned chef server with my old chef servers validation.pem.  Has anyone done this with chef 11?
[2013-08-16 17:14:11 -0400] zenloop: I have tried just replacing the pem and restarting but that did not work.
[2013-08-16 17:14:30 -0400] zenloop: I think I have to update the pub key in postgres?
[2013-08-16 17:20:08 -0400] tubbo: when chef fails for the same reason after trying 5 different solutions http://i.imgur.com/I7I1Mjb.gif
[2013-08-16 17:25:51 -0400] adamjk-dev: tubbo: lol
[2013-08-16 17:28:33 -0400] _dumfries: adamjk-dev: https://gist.github.com/anonymous/6251822 FWIW
[2013-08-16 17:29:48 -0400] adamjk-dev: _dumfries: interesting
[2013-08-16 17:30:03 -0400] adamjk-dev: _dumfries: did you write that?
[2013-08-16 17:30:10 -0400] _dumfries: adamjk-dev: yep
[2013-08-16 17:30:22 -0400] adamjk-dev: _dumfries: nice, what do you pass it?
[2013-08-16 17:30:37 -0400] _dumfries: says in the banner ;)
[2013-08-16 17:30:50 -0400] _dumfries: 2 args, one is the data bag and the other the id of the data bag item.
[2013-08-16 17:30:56 -0400] adamjk-dev: _dumfries: Oh i see now
[2013-08-16 17:31:01 -0400] _dumfries: huzzah :)
[2013-08-16 17:31:07 -0400] adamjk-dev: adamjk-dev: BAM! a solution
[2013-08-16 17:32:58 -0400] adamjk-dev: _dumfries: so data bag name, and ID of the item or what?
[2013-08-16 17:33:41 -0400] _dumfries: adamjk-dev: correct, for example if you had a data bag for users and a user in that data bag called 'jdoe', you would run "knife bag dump users jdoe"
[2013-08-16 17:34:09 -0400] adamjk-dev: _dumfries: oh is that a knife plugin? I am not familiar enough
[2013-08-16 17:34:18 -0400] _dumfries: adamjk-dev: It is :)
[2013-08-16 17:34:31 -0400] adamjk-dev: _dumfries: sorry, I am catching up here haha
[2013-08-16 17:35:24 -0400] adamjk-dev: _dumfries: can u install it via knife or put in a directory?
[2013-08-16 17:35:25 -0400] _dumfries: adamjk-dev: just run "mkdir -p $HOME/.chef/plugins/knife" and download the gist to that directory.
[2013-08-16 17:35:37 -0400] adamjk-dev: _dumfries: ah, that is what I was wondering
[2013-08-16 17:36:45 -0400] _dumfries: adamjk-dev: no prob
[2013-08-16 17:37:02 -0400] dgarstang: Any AWS peeps here? Non chefy question I suppose.... i'm supposed to get two ephemerals on an m1.large right?
[2013-08-16 17:38:32 -0400] adamjk-dev: _dumfries: well, look at that! it worked. thanks, I appreciate it
[2013-08-16 17:38:46 -0400] _dumfries: adamjk-dev: glad to hear it man, no worries at all :)
[2013-08-16 17:39:05 -0400] adamjk-dev: _dumfries: i want to learn it and not just look for a solution....
[2013-08-16 17:39:26 -0400] adamjk-dev: _dumfries: so I can expand on this one if need be
[2013-08-16 17:39:38 -0400] _dumfries: adamjk-dev: good idea, it's a start for you :)
[2013-08-16 17:40:16 -0400] adamjk-dev: _dumfries: indeed, thanks
[2013-08-16 17:59:49 -0400] vigith: i have an entry in attribute file node[:host][:slave][:packages] = [ 'pkg1', 'pkg2', {'name' = pkg3, version = ver}, pkg4 ] .. what is the best way in chef-11 to know wether each element is string of hash-reference ?
[2013-08-16 18:00:33 -0400] vigith: ealier i could check for .class and it used to return Mash.. now it is different .. Something like Chef::Imutable::Mash.. i just want to know the right way
[2013-08-16 18:02:53 -0400] rep0st: ohai guys. Was thinking out load. Is there a way to skip a cookbook base on an if condition
[2013-08-16 18:03:20 -0400] rep0st: say i have an apt cookbook and i query for platform_family if it doesn't match then abort running the recipe
[2013-08-16 18:05:56 -0400] btm: rep0st: return unless platform_family?('debian')
[2013-08-16 18:07:00 -0400] cpuguy83: btm: it's not idiomatic to use return in Ruby, fyi
[2013-08-16 18:07:53 -0400] cpuguy83: because: def foo; unless bar; ### stuff; end is equivelant
[2013-08-16 18:10:29 -0400] yfeldblum: it's quite idiomatic to use return in ruby
[2013-08-16 18:11:01 -0400] yfeldblum: the question is: in which contexts in ruby is the use of return idiomatic, and in which contexts is it not?
[2013-08-16 18:13:40 -0400] cpuguy83: yfeldblum: early returns only, unless it's in a flow control statement as above.  And even then, I would likely use a case statement instead of unless/if in a recipe.
[2013-08-16 18:14:20 -0400] miah: ttps://github.com/bbatsov/ruby-style-guide
[2013-08-16 18:14:30 -0400] miah: i tend to follow that.
[2013-08-16 18:14:32 -0400] miah: "Avoid return where not required for flow of control.
[2013-08-16 18:16:18 -0400] rep0st: miah: so in my case it deems it to be ok ?
[2013-08-16 18:17:06 -0400] miah: yes
[2013-08-16 18:17:34 -0400] teukka: I have a feeling that btm knows how to use return in ruby ;)
[2013-08-16 18:18:24 -0400] miah: never said he didnt
[2013-08-16 18:18:29 -0400] cpuguy83: For chef stuff, https://gist.github.com/cpuguy83/6252225
[2013-08-16 18:18:43 -0400] teukka: miah: yeah, that was more to cpuguy83 =)
[2013-08-16 18:18:46 -0400] yfeldblum: miah, that basically says "if the code you write would be exactly equal with or without the use of an explicit 'return', then skip it because it's superfluous"
[2013-08-16 18:19:25 -0400] miah: its superfluous in most circumstances
[2013-08-16 18:19:30 -0400] gondoi: does anyone use knife-essentials? I cannot get it to work
[2013-08-16 18:19:35 -0400] gondoi: i keep getting ERROR: roles/base.rb: No such file or directory
[2013-08-16 18:19:42 -0400] yfeldblum: miah, but it's not an admonition to write code in any particular style over any other particular style, only to leave out keywords that are implied from their contexts
[2013-08-16 18:19:54 -0400] miah: agreed
[2013-08-16 18:19:54 -0400] rep0st: gondoi: check your knife.rb file for cookbook path
[2013-08-16 18:20:05 -0400] cpuguy83: Sorry, didn't mean to start a debate :)
[2013-08-16 18:20:08 -0400] miah: i didnt say anybody was right or wrong. just that 'i follow this, and it says..'
[2013-08-16 18:20:17 -0400] gondoi: rep0st, i have it set to my berkshelf of cookbooks
[2013-08-16 18:20:23 -0400] rep0st: cpuguy83: i'm the one that kicked off the question
[2013-08-16 18:20:24 -0400] yfeldblum: miah, also i the return-early / fail-fast patterns quite often
[2013-08-16 18:20:33 -0400] gondoi: and have versioning set to true
[2013-08-16 18:20:34 -0400] miah: ya
[2013-08-16 18:20:40 -0400] rep0st: gondoi: that's where i fall apart =( i don't use berkshelf yet
[2013-08-16 18:20:49 -0400] yfeldblum: miah, which does involve a lot of explicit returns, but also serves to reduce the nesting levels of a lot of code
[2013-08-16 18:21:05 -0400] btm: Actually, I'll bow out of any arguments over ruby correctness. I usually have kallistec make all the right choices there. The point is more that using return works in rep0st's pattern in a Chef recipe, not that it's the best ruby.
[2013-08-16 18:21:16 -0400] gondoi: it stopped complaining about my cookbooks when i set those up, but now it just always complains it can't find the files I'm trying to diff
[2013-08-16 18:21:19 -0400] miah: btm: agreed
[2013-08-16 18:21:46 -0400] yfeldblum: btm, agreed that `return` should typically be used only in explicit method contexts because the theoretical concept is "returning [early] from a method"
[2013-08-16 18:22:00 -0400] cpuguy83: rep0st: I like case statements for that because someone could easily just add in the code for another platform if needed later without having to change the structure, and it seems to be more intention revealing  (to me)
[2013-08-16 18:22:14 -0400] yfeldblum: btm, even if return works in more cases in ruby
[2013-08-16 18:22:18 -0400] miah: i honestly hate that case statement pattern
[2013-08-16 18:22:26 -0400] miah: because you end up with recipes that are thousands of lines long
[2013-08-16 18:22:54 -0400] yfeldblum: miah, clearly someone needed to write some library methods
[2013-08-16 18:23:05 -0400] miah: yes, i have
[2013-08-16 18:23:26 -0400] btm: cpuguy83: I like case statements when there's a lot of switches and a default. But if not and it's a long recipe, you end up reading forever just to discover it wouldn't have done anything in your case.
[2013-08-16 18:23:28 -0400] miah: https://github.com/miah/chef_logstash/blob/master/libraries/provider_logstash_instance.rb#L76-L85
[2013-08-16 18:23:36 -0400] btm: gondoi: do you have your roles on disk?
[2013-08-16 18:23:36 -0400] rep0st: cpuguy83: i have pretty little snow flakes that i can't get away from, where 99%  of my VMs are running debian i get the occasional request for centos. Being that i use roles (which work in my infrastructure) i don't want to move apt from a top level role.
[2013-08-16 18:23:42 -0400] gondoi: yes
[2013-08-16 18:23:46 -0400] miah: call a duck-typed class rather than case statement hell
[2013-08-16 18:24:00 -0400] btm: gondoi: tried with -V -V yet? got a gist of that?
[2013-08-16 18:24:20 -0400] yfeldblum: miah, or, called "object-oriented"
[2013-08-16 18:24:43 -0400] cpuguy83: miah: Yeah, I've thought a bit about how to properly introduce my own classes into a recipe, where they should go and all that.  Haven't decided yet.
[2013-08-16 18:24:44 -0400] amore: hi, I need some help with the logstash recipe, it heavily uses hashes inside roles to generate configuration files from templates, however as part of my desired configuration I need to get an IP address, I've tried using search() but it seems can't be used in a roles/name.rb, any ideas? thanks!
[2013-08-16 18:24:50 -0400] yfeldblum: miah, which is cool
[2013-08-16 18:24:50 -0400] miah: yes, object oriented ftw. =)
[2013-08-16 18:24:54 -0400] gondoi: btm, no extra output :(
[2013-08-16 18:25:23 -0400] jkeiser: gondoi: .rb files are not supported, only .json
[2013-08-16 18:25:26 -0400] gondoi: btm, i was getting a diff error with chef 11.4.0, but I just updated to 11.6.0 that seemed to have a "better" error
[2013-08-16 18:25:46 -0400] gondoi: jkeiser, oh
[2013-08-16 18:25:52 -0400] miah: im working on extracting that pattern into a superclass so i dont have to maintain as much code
[2013-08-16 18:26:31 -0400] gondoi: jkeiser, wouldn't a show still work, since it's looking that servers copy?
[2013-08-16 18:26:39 -0400] cpuguy83: miah: Chef just doesn't have a good place to put this stuff... needs to be a model directory that get autoloaded
[2013-08-16 18:26:50 -0400] jkeiser: gondoi: knife show roles/base.json will
[2013-08-16 18:26:58 -0400] miah: cpuguy83: libraries directory =)
[2013-08-16 18:27:00 -0400] miah: look at my codes
[2013-08-16 18:27:03 -0400] gondoi: ahh there it goes...
[2013-08-16 18:27:11 -0400] mveitas: is there a trick to getting knife upload to push up environments. I tried doing a 'knife upload . --force' and only the data bags appeared to be pushed up to the server
[2013-08-16 18:27:28 -0400] miah: https://github.com/SimpleFinance/chef-elasticsearch and https://github.com/miah/chef_logstash are my examples right now
[2013-08-16 18:27:44 -0400] miah: both need some serious clean up. i want to do a bit more to make inline_resources a bit cleaner
[2013-08-16 18:28:06 -0400] gondoi: so is it better to keep envs, roles, etc in json format instead of .rb these days?
[2013-08-16 18:28:08 -0400] miah: i could just use that mixin too i suppose though
[2013-08-16 18:28:51 -0400] miah: i prefer my roles/envs to be json simply because its easier to determine what they are explicitly doing
[2013-08-16 18:29:04 -0400] rep0st: miah: +1
[2013-08-16 18:29:17 -0400] miah: i might write ruby code to _generate_ roles / environments. but i dont believe that code belongs in them.
[2013-08-16 18:29:27 -0400] cpuguy83: miah: Those all get auto-required?
[2013-08-16 18:29:32 -0400] miah: cpuguy83: yup
[2013-08-16 18:29:40 -0400] miah: cpuguy83: http://docs.opscode.com/essentials_nodes_chef_run.html
[2013-08-16 18:29:42 -0400] cpuguy83: miah: excellent.
[2013-08-16 18:33:30 -0400] dgarstang: what port does the chef-server UI run on?
[2013-08-16 18:40:27 -0400] cpuguy83: dgarstang: I installed with the chef-server cookbook and it was 443/https by default
[2013-08-16 18:46:13 -0400] miah: chef 10 ran on 443(webui) and 4000(api) but in chef 11 both are port 443
[2013-08-16 18:46:17 -0400] jperry_: ohai
[2013-08-16 18:46:35 -0400] miah: the nginx just does some uri routing now
[2013-08-16 18:46:36 -0400] jperry_: anyone know if there is a way to run a shell command before using the vagrant-omnibus hook?
[2013-08-16 18:59:20 -0400] sprack: Is there an include_attributes or a way to include the attribs of another recipe without running it?
[2013-08-16 19:00:17 -0400] jbz: sprack:  That should only get you default attributes anyway...?
[2013-08-16 19:00:35 -0400] jbz: sprack: If you set an attrib via role/node/env/etc, it will be there no matter whether you load the recipe or not
[2013-08-16 19:02:15 -0400] sprack: jbz: I just want the default attribs. Trying to snag some env variables for a rake migrate that gets run later.
[2013-08-16 19:02:51 -0400] jbz: sprack *shrug* unsure then.  Might want to just declare them yourself for max safety.
[2013-08-16 19:11:21 -0400] lledet: Hi, is anyone using a PPA for ubuntu to install ruby 2.0? Or should I just compile it?
[2013-08-16 19:17:08 -0400] AskSteve: Is there a "Chef way" to add virtual hosts to an nginx server?
[2013-08-16 19:17:48 -0400] sprack: AskSteve: wrap the nginx cookbook and make an erb that builds them
[2013-08-16 19:18:36 -0400] AskSteve: sprack: that was my thought as well.  Just doesn't seem right to use a second cookbook to modify the output of the first cookbook
[2013-08-16 19:19:32 -0400] sprack: AskSteve: iirc that cookbook isn't fully lwrp'd so you have to. pretty common practice
[2013-08-16 19:23:58 -0400] dgarstang: Why would I be getting this on a knife upload? "ERROR: /users/admin.json failed to write: HTTP error writing: 400 "Bad Request"ERROR: /users/doug.json failed to write: HTTP error writing: 400 "Bad Request""
[2013-08-16 19:29:19 -0400] dgarstang: Why would I be getting this on a knife upload? "ERROR: /users/admin.json failed to write: HTTP error writing: 400 "Bad Request"ERROR: /users/doug.json failed to write: HTTP error writing: 400 "Bad Request""
[2013-08-16 19:30:03 -0400] dgarstang: Is there any way to 'clear out' a chef server?
[2013-08-16 19:39:04 -0400] nick__: 192.168.30.166 Recipe Compile Error in /var/chef/cache/cookbooks/nagios/recipes/server.rb 192.168.30.166 ================================================================================ 192.168.30.166  192.168.30.166  192.168.30.166 Net::HTTPServerException 192.168.30.166 ------------------------ 192.168.30.166 404 "Object Not Found" 192.168.30.166  192.168.30.166  192.168.30.166 Cookbook Trace: 192.168.30.166 --------------- 192.168.30
[2013-08-16 19:40:13 -0400] gkra: I'm having brain problems If I want to do an execute only_if a specific process is running, what would be the best way to do that?
[2013-08-16 19:40:26 -0400] gkra: only_if "ps -ef | grep <process name>" doesn't seem to be doing it.
[2013-08-16 19:40:43 -0400] cpuguy83: dgarstang: What do you mean "clear out"?
[2013-08-16 19:42:17 -0400] cpuguy83: dgarstang: take a look at "chef-server-ctl --help".  There is a "cleanse" option that seems like it would "clear out" the server, but I've not used it.
[2013-08-16 19:43:21 -0400] dgarstang: cpuguy83: worked it out, thanks
[2013-08-16 19:43:33 -0400] dgarstang: OK, weird... i'm on amazon but ohai has no knowledge of ec2...
[2013-08-16 19:43:40 -0400] dgarstang: hint thingy?
[2013-08-16 19:47:06 -0400] dgarstang: why the fudge can't ohai create /etc/chef/ohai/hints/ec2.json for me?
[2013-08-16 19:50:19 -0400] btm: dgarstang: ohai doesn't create that file, you create that file to tell ohai something (that you're on EC2). Those files are normally created by the knife plugin, e.g. knife-ec2.
[2013-08-16 19:52:39 -0400] yfeldblum: dgarstang, there are no good, simple, reliable, cross-platform, cross-cloud ways to determine what the proper hints file should be
[2013-08-16 19:53:06 -0400] yfeldblum: dgarstang, so knife-ec2 will deposit the ec2 hints file and knife-rackspace will deposit the rackspace hints file and so on
[2013-08-16 19:55:38 -0400] btm: if there was a reliable and fast way to determine what cloud you were on, on all of the clouds, we wouldn't have written the hints system ;)
[2013-08-16 19:58:26 -0400] gchristensen: speaking of which - when is the next OHAI code review?
[2013-08-16 19:59:03 -0400] dgarstang: if one recipe sets a variable, and another includes it, should be in scope, right?
[2013-08-16 19:59:20 -0400] dgarstang: yfeldblum: yah, not using knife-ec2. it's broken
[2013-08-16 19:59:44 -0400] yfeldblum: dgarstang, so you are responsible for depositing the ec2 hints file some other way
[2013-08-16 20:00:06 -0400] dgarstang: yfeldblum: apparently so. such a weird concept, because facter doesn't require it
[2013-08-16 20:00:16 -0400] yfeldblum: dgarstang, no, local variables are scoped to their lexical scope, and instance variables are scoped to the recipe instance
[2013-08-16 20:01:01 -0400] dgarstang: yfeldblum: var='A".... local or instance variable?
[2013-08-16 20:01:04 -0400] gchristensen: dgarstang: there are other ways of determining it, but they are not guaranteed
[2013-08-16 20:01:11 -0400] yfeldblum: dgarstang, local variable
[2013-08-16 20:01:23 -0400] dgarstang: yfeldblum: so not in scope when included from another recipe?
[2013-08-16 20:01:32 -0400] yfeldblum: dgarstang, correct
[2013-08-16 20:01:38 -0400] dgarstang: yfeldblum: dammit
[2013-08-16 20:02:04 -0400] MoonMan: Question; I want to change my validation .pem file before bootstrapping a node. Where would that file be stored on my workstation?
[2013-08-16 20:02:19 -0400] MoonMan: I don't believe /etc/chef exists on my machine. It's successfully seth up as a workstation.
[2013-08-16 20:02:27 -0400] dgarstang: yfeldblum: i just have a variable that gets set in one place in a common.rb recipe, rather than putting it in two places...
[2013-08-16 20:03:43 -0400] btm: starting cookbook code review in a few minutes, department meeting running long...
[2013-08-16 20:06:46 -0400] MoonMan: Department meeting? Sounds fun.
[2013-08-16 20:07:56 -0400] timsmith: Bryan has been late with his TPS reports recently
[2013-08-16 20:08:58 -0400] atomic-penguin: lol
[2013-08-16 20:10:10 -0400] btm: we're discussing we ended up with a red swingline stapler in EC2.
[2013-08-16 20:10:39 -0400] jbz: I'm gonna need you to move your instance back to the back of us-west-2yeahthanks...
[2013-08-16 20:12:16 -0400] MoonMan: jbz: Hey, quick question. Where might my validation.pem files be stored on a mac workstation? I'm trying to find them, can't.
[2013-08-16 20:13:04 -0400] jbz: Generally, the client.rb file will contain an entry specifying where the local validator pem can be found.
[2013-08-16 20:13:24 -0400] jbz: MoonMan: Hm, maybe knife.rb, actually.
[2013-08-16 20:13:32 -0400] jbz: Sorry, double braining right now
[2013-08-16 20:13:36 -0400] atomic-penguin: yup, knife.rb
[2013-08-16 20:13:37 -0400] btm: @opscode cookbook code review: join: https://plus.google.com/hangouts/_/3e9a07efa65d22b160a38051f2d3d90cb0a97355, watch: http://youtu.be/znrKCFxkf-Y
[2013-08-16 20:13:53 -0400] MoonMan: knife.rb. Thanks
[2013-08-16 20:16:40 -0400] MoonMan: So where is knife.rb usually? I looked in ~/, and there's chef-repo, but to the best of my knowledge it doesn't contain knife.rb
[2013-08-16 20:16:51 -0400] MoonMan: Is there another chef directory I'm missing?
[2013-08-16 20:17:07 -0400] MoonMan: Nothing chef related in /etc/
[2013-08-16 20:17:09 -0400] mattray: MoonMan: in your chef-repo, .chef
[2013-08-16 20:17:14 -0400] mattray: chef-repo/.chef/
[2013-08-16 20:17:38 -0400] MoonMan: mattray: Ah yes, found them. much thanks.
[2013-08-16 20:20:45 -0400] gchristensen: btm: tickets.opscode.com/browse/COOK-3440 is this fella on the docket for today?
[2013-08-16 20:26:34 -0400] MoonMan: Is there a way to regenerate your ~/chef-repo/.chef directory? It looks like the paths are all wrong, they're meant for the old validator key.
[2013-08-16 20:26:44 -0400] MoonMan: I changed my validator key.
[2013-08-16 20:28:07 -0400] jbz: MoonMan:  Why would you need to regenerate the directory?  Just change the path entry in knife.rb...?
[2013-08-16 20:31:16 -0400] MoonMan: jbz: It's saying "Can not find bootstrap definition for chef-full". I'm thinking a regeneration would be a better course of action than trying to troubleshoot.
[2013-08-16 20:31:43 -0400] MoonMan: Oh wait, I think I found the error.
[2013-08-16 20:34:59 -0400] dgarstang: how do I programatically set cookbook attributes in a cookbook?
[2013-08-16 20:35:17 -0400] dgarstang: node[cookbook_name][key] = val?
[2013-08-16 20:39:06 -0400] gchristensen: sure
[2013-08-16 20:40:20 -0400] dgarstang: gchristensen ?
[2013-08-16 20:41:10 -0400] gchristensen: you can do that
[2013-08-16 20:42:16 -0400] dgarstang: gchristensen: I looked at another cookbook and it used default['cookbook']['key'] = val ....
[2013-08-16 20:42:29 -0400] gchristensen: dgarstang: what is it you're trying to accomplish?
[2013-08-16 20:43:09 -0400] dgarstang: gchristensen: trying to set an attribute in one recipe that's accessible in another in the same cookbook
[2013-08-16 20:43:10 -0400] adnichols: dgarstang I think in 11 you have to do node.default or node.override to set
[2013-08-16 20:43:48 -0400] gchristensen: AH! I misunderstood. heh. sorry.
[2013-08-16 20:44:01 -0400] dgarstang: gchristensen: oki.... right way to do it?
[2013-08-16 20:44:25 -0400] gchristensen: dgarstang: you have to do node.<precedence>[attribute] : http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-08-16 20:44:37 -0400] yfeldblum: dgarstang, there are no such things as "cookbook attributes"; there are node attributes, and i will assume that's what you mean
[2013-08-16 20:45:17 -0400] dgarstang: yfeldblum: you mean everything is global, and scares the crap out of me
[2013-08-16 20:45:35 -0400] yfeldblum: dgarstang, there are various common places to set node attributes: an attributes file (in a cookbook), a recipe file (in a cookbook), a role, and an environment
[2013-08-16 20:45:57 -0400] dgarstang: yfeldblum: who cares when they're all global? :)
[2013-08-16 20:45:58 -0400] yfeldblum: dgarstang, well-written cookbooks take care to namespace the attributes they assign to nodes
[2013-08-16 20:46:16 -0400] dgarstang: yfeldblum: That's what I'm trying to do, but ... there's no guarantee, and that's scary
[2013-08-16 20:46:55 -0400] dgarstang: http://docs.opscode.com/essentials_cookbook_attribute_files.html talks about setting attributes in attribute files, nothing about how to set in the recipe
[2013-08-16 20:47:00 -0400] yfeldblum: dgarstang, e.g., from a recipe: node.default["other_cookbook"]["some_key"] = "some_value"
[2013-08-16 20:47:27 -0400] yfeldblum: dgarstang, e.g., from an attributes file: default["other_cookbook"]["some_key"] = "some_value"
[2013-08-16 20:47:46 -0400] dgarstang: yfeldblum: k. *sigh* opscode docs. *sigh*
[2013-08-16 20:47:53 -0400] yfeldblum: dgarstang, however, setting node attributes from cookbook A where the node attributes are namespaced to cookbook B is frowned upon
[2013-08-16 20:48:16 -0400] dgarstang: yfeldblum: not doing that, but a I said, since scope is global, there's so much potential for major problems
[2013-08-16 20:48:19 -0400] yfeldblum: dgarstang, is frowned upon when done in an attributes file, and is OK when done in a recipe
[2013-08-16 20:48:29 -0400] dgarstang: yfeldblum: cant imagine why
[2013-08-16 20:49:26 -0400] nebrera2: hello
[2013-08-16 20:49:32 -0400] dgarstang: yfeldblum: what about reading again?
[2013-08-16 20:49:39 -0400] nebrera2: what is chef-solr and chef-expander user for ?
[2013-08-16 20:49:48 -0400] dgarstang: yfeldblum 'node' or 'default' or 'node.default' ?
[2013-08-16 20:50:25 -0400] yfeldblum: dgarstang, when in an attributes file, you may read the default-level value with `default["other_cookbook"]["some_key"]`
[2013-08-16 20:50:44 -0400] yfeldblum: dgarstang, when in a recipe, you may read the default-level value with `node.default["other_cookbook"]["some_key"]`
[2013-08-16 20:50:45 -0400] dgarstang: yfeldblum: and in the recipe?
[2013-08-16 20:51:11 -0400] dgarstang: yfeldblum: not .... node? i thought 'default' was just to the scope for writing? I dunno. docs are bad. filing in bits with my head
[2013-08-16 20:51:17 -0400] yfeldblum: dgarstang, and when in a recipe, you may read the merged value with `node["other_cookbook"]["some_key"]`
[2013-08-16 20:51:47 -0400] dgarstang: yfeldblum: now I'm totally confused
[2013-08-16 20:52:06 -0400] yfeldblum: dgarstang, what with?
[2013-08-16 20:52:13 -0400] dgarstang: yfeldblum: what to do
[2013-08-16 20:52:38 -0400] dgarstang: yfeldblum: all i want to do is set an attribute in one recipe, and include in another in the same cookbook, and use it
[2013-08-16 20:53:28 -0400] yfeldblum: dgarstang, in the one recipe in Cookbook A, you can set the attribute with `node.default["cookbook_a"]["some_key"] = "some_value"`
[2013-08-16 20:53:40 -0400] dgarstang: yfeldblum: k, got that
[2013-08-16 20:53:48 -0400] yfeldblum: dgarstang, in the other recipe in Cookbook B, you can read the merged attribute with `node["cookbook_a"]["some_key"]`
[2013-08-16 20:54:02 -0400] dgarstang: yfeldblum: There is no cookbook B. Same cookbook.
[2013-08-16 20:54:37 -0400] yfeldblum: dgarstang, in that case it will work the same
[2013-08-16 20:54:46 -0400] dgarstang: yfeldblum: kk, thanks
[2013-08-16 20:59:40 -0400] gchristensen: w00t
[2013-08-16 21:02:04 -0400] nebrera2: I mean, do I need it to run erchef only ?
[2013-08-16 21:05:35 -0400] dgarstang: does the directory resource create parent directories?
[2013-08-16 21:05:42 -0400] btm: nebrera2: chef-solr and chef-expander are the parts of the Chef Server that provide search. erchef is the part of the Chef Server that provides an API. It's all meant to go together and ships together in the Chef Server 11 omnibus packages.
[2013-08-16 21:06:16 -0400] btm: dgarstang: if you set the recursive attribute to true: http://docs.opscode.com/resource_directory.html
[2013-08-16 21:06:50 -0400] dgarstang: btm: interesting, cuz that's not what the docs indicate at all
[2013-08-16 21:06:51 -0400] nebrera2: what happen if I do not run chef-sole and chef-expander
[2013-08-16 21:07:02 -0400] nebrera2: the only problem would be I cannot search objetcs ?
[2013-08-16 21:08:17 -0400] yfeldblum: dgarstang, yes, with the `recursive` attribute ... http://docs.opscode.com/resource_directory.html
[2013-08-16 21:08:31 -0400] dgarstang: yfeldblum: That's not what the docs say
[2013-08-16 21:09:05 -0400] dgarstang: yfeldblum: recursive implies creation of child directories. No mention of parent directories
[2013-08-16 21:10:20 -0400] yfeldblum: dgarstang, it is what the docs say and it also is that that attribute does; it is conceptually akin to `-p` in `mkdir`
[2013-08-16 21:11:18 -0400] dgarstang: yfeldblum: the word 'parent' doesnt appear anywhere on the doc page
[2013-08-16 21:16:01 -0400] btm: dgarstang: I'll ask the tech writer to add the word 'parent' in there.
[2013-08-16 21:17:03 -0400] btm: nebrera2: in theory, you wouldn't have search without chef-solr and chef-expander, but they weren't really designed to be left out. You might have some work cut out for you making other parts of the server not care that they're missing.
[2013-08-16 21:19:04 -0400] btm: dgarstang: he has updated it, it will be included in the next automated docs build.
[2013-08-16 21:24:03 -0400] LanceStacenko: What's the command to execute a runlist on a node?
[2013-08-16 21:26:22 -0400] dgarstang: btm: tanx
[2013-08-16 21:26:45 -0400] cubed: any thoughts to how to exactly specify a key from a encrypted databag? like, for example: mysql_password = Chef::EncryptedDataBagItem.load("passwords", "file") .. and let's say there's a key in there of "mysql"... how would i specify that?
[2013-08-16 21:27:56 -0400] btm: LanceStacenko: you can specify a temporary runlist, called an override runlist because it is used instead of what is on the node object, with 'chef-client -o RUNLIST'.
[2013-08-16 21:28:28 -0400] LanceStacenko: btm: No, I'm trying to run the run list on the node.
[2013-08-16 21:28:43 -0400] LanceStacenko: I'm just wondering which command I would use, and if I would execute the command from the workstation?
[2013-08-16 21:29:17 -0400] btm: cubed: http://docs.opscode.com/chef/essentials_data_bags.html#store-keys-on-nodes
[2013-08-16 21:30:17 -0400] btm: LanceStacenko: knife node run list add NODE RUNLIST && knife ssh name:NODE "sudo chef-client"
[2013-08-16 21:31:56 -0400] cubed: btm: was trying to find something to that! sweet, thx
[2013-08-16 21:32:10 -0400] cubed: like that, rather
[2013-08-16 21:59:08 -0400] LanceStacenko: Sorry for the double question, but how do I execute a run list, on a node from a workstation?
[2013-08-16 21:59:24 -0400] LanceStacenko: I know chef-client iterates through the run list, but I'm looking for a way to do it from the workstation.
[2013-08-16 22:04:50 -0400] jbz: LanceStacenko:  You can't.  All you can do is tell the node to run chef-client.
[2013-08-16 22:04:56 -0400] jbz: Chef-client is what actually executes the run list.
[2013-08-16 22:05:09 -0400] LanceStacenko: But chef-client can only be run from a node, correct?
[2013-08-16 22:05:14 -0400] LanceStacenko: It can't be run from a workstation?
[2013-08-16 22:05:20 -0400] jbz: Right.
[2013-08-16 22:05:25 -0400] jbz: Well, you can treat your workstation as a node.
[2013-08-16 22:05:28 -0400] jbz: :-)
[2013-08-16 22:05:37 -0400] jbz: run-lists are *only executed on nodes.*
[2013-08-16 22:05:49 -0400] jbz: If you want to debug stuff
[2013-08-16 22:05:56 -0400] jbz: you can use test-kitchen and vagrant
[2013-08-16 22:05:59 -0400] jbz: and use virtual nodes.
[2013-08-16 22:06:05 -0400] LanceStacenko: So I can run chef-client from my workstation and it should update my node?
[2013-08-16 22:06:16 -0400] LanceStacenko: Is there any way to do it via knife or ssh?
[2013-08-16 22:06:48 -0400] jbz: no
[2013-08-16 22:06:58 -0400] jbz: if you run chef-client from your workstation, it will treat your workstation as the node and update it.
[2013-08-16 22:07:10 -0400] LanceStacenko: But I'm trying to update a secondary system.
[2013-08-16 22:07:13 -0400] jbz: You can run chef-client on a node via ssh, sure.
[2013-08-16 22:07:28 -0400] jbz: LanceStacenko: I'm confused.  You're trying to update a system that isn't your workstation, correct?
[2013-08-16 22:07:52 -0400] jbz: In that case, you must install chef on that other system, and run chef-client as root from there.
[2013-08-16 22:08:27 -0400] LanceStacenko: Yes, I have a raspberry pi, set up as a node with a run list that I'm trying to execute, and my macbook pro is a workstation. I'm trying to find a command to enter from my macbook that updates the raspberry pi.
[2013-08-16 22:08:32 -0400] jbz: Chef is completely pull-based.  All changes/actions are done by the locally running chef-client (or chef-solo) based on *state information* given to it by the server (or passed directly to it, for chef solo).
[2013-08-16 22:08:42 -0400] dgarstang: so... I'm trying to write my cookbooks to work on aws, gce and vagrant. In order to use ohai ec2, you have to write the hint file. However, if you write the hint file, ohai hangs on vagrant. Grrr
[2013-08-16 22:08:56 -0400] jbz: LanceStacenko:  You *must install chef on the raspberry pi.*
[2013-08-16 22:08:59 -0400] jbz: Once that has been done
[2013-08-16 22:09:16 -0400] jbz: you can run chef-client on the raspberry pi using ssh from the mac
[2013-08-16 22:09:33 -0400] jbz: but it must be available on the raspberry pi to begin with, and must execute there.
[2013-08-16 22:10:03 -0400] dgarstang: .... therefore I have to put some logic in there to determine what hint file to create. What's the best indicator to use in ohai to indicate the cloud provider?
[2013-08-16 22:12:29 -0400] dgarstang: oh lovely. On GCE the virtualisation shows up as ''
[2013-08-16 22:49:40 -0400] dgarstang: can i rename a cookbook just by changing directory name and all references to it in metadata, attributes etc?
[2013-08-16 22:52:13 -0400] jmickle: what are the popular graphing engines right now
[2013-08-16 22:52:22 -0400] jmickle: graphite? ganglia? munin? zabbix?
[2013-08-16 22:52:30 -0400] jmickle: anyone care to share what they are using?
[2013-08-16 23:03:29 -0400] timsmith: graphite
[2013-08-16 23:03:39 -0400] timsmith: heavy water has a nice cookbook for it
[2013-08-16 23:03:48 -0400] timsmith: munin doesn't scale past 50 nodes
[2013-08-16 23:03:56 -0400] timsmith: and you can't do fun dynamic stuff
[2013-08-16 23:19:04 -0400] juliancdunn: dgarstang: yes
[2013-08-16 23:23:51 -0400] dgarstang: juliancdunn: whew
[2013-08-16 23:31:09 -0400] dgarstang: if I include a recipe in the run list, are it's LWRP's globally available to any cookbook? seems so...
[2013-08-16 23:31:34 -0400] timsmith: yep
[2013-08-16 23:31:39 -0400] juliancdunn: dgarstang: yep, but even if you mention that cookbook in another cookbook's metadata, the same will happen
[2013-08-16 23:31:52 -0400] juliancdunn: (as a depends)
[2013-08-16 23:37:15 -0400] force: Chef keeps creating a node with my client name. Should it be doing that? Like there's a Chef Client that is me that I use to do things, but I keep getting this empty node with the same name.
[2013-08-16 23:37:37 -0400] force: So when I enumerate my nodes in my recipes, I get this empty node that is useless and breaks things.
[2013-08-16 23:39:35 -0400] timsmith: sounds like your client system has the chef-client running as a daemon
[2013-08-16 23:39:55 -0400] force: nope. It looks like it creates a node when I issue commands to Chef Server with knife.
[2013-08-16 23:40:13 -0400] force: I have to define node_name in my .chef/knife.rb and it looks like if I run knife commands against Chef Server, it's going to create the node.
[2013-08-16 23:40:27 -0400] force: I just have to filter out nodes that don't have the attributes I need, I guess. Poop.
[2013-08-16 23:40:32 -0400] force: Thanks timsmith
[2013-08-16 23:44:30 -0400] dgarstang: more knife upload hangs. *sigh* DEBUG: Sending HTTP Request via POST to 10.37.161.208:443/sandboxes
[2013-08-16 23:48:17 -0400] timsmith: force: it shouldn't create a node from your use of knife.  I have a node name defined in my knife.rb, but no nodes are created from that.  Node creation happens with chef-client is run and a client.pem file doesn't exist already on the system.
[2013-08-16 23:55:52 -0400] dgarstang: more knife upload hangs. *sigh* DEBUG: Sending HTTP Request via POST to 10.37.161.208:443/sandboxes
[2013-08-16 23:58:57 -0400] force: timsmith: Then I'm back to having no idea where it comes from. A node appears periodically that has the same name as my client, but I'm the only person running chef-client in our data center and on my box.
