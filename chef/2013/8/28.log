[2013-08-28 00:00:10 -0400] alexkarp: only part of the code referenced there that's mine is the mysql_database resource
[2013-08-28 00:00:16 -0400] alexkarp: which, so far as I can tell, is correct
[2013-08-28 00:00:27 -0400] sn0wb1rd: alexkarp: What version of database cookbook are you using?
[2013-08-28 00:00:27 -0400] douglaswth: what's on /var/chef/cache/cookbooks/database/libraries/provider_database_mysql.rb:79:in `initialize'
[2013-08-28 00:00:28 -0400] douglaswth: ?
[2013-08-28 00:00:43 -0400] dgarstang: Can I set the run_list of a noe in client.rb?
[2013-08-28 00:01:50 -0400] steve_____: how does one restart the chef server services on the new runsv setup?
[2013-08-28 00:02:18 -0400] alexkarp: douglaswth: ahhh a call to Mysql.new() with 5 arguments. So something's possibly wrong with my mysql gem
[2013-08-28 00:02:27 -0400] alexkarp: because that looks like a pretty normal call to Mysql.new
[2013-08-28 00:03:42 -0400] dgarstang: scrap that. how about a way for knife-ec2 to create an instance but not attempt to log into it?
[2013-08-28 00:04:28 -0400] alexkarp: dgarstang: what's the goal there?
[2013-08-28 00:04:38 -0400] alexkarp: if chef can't log in, it can't install any of its requirements
[2013-08-28 00:04:48 -0400] alexkarp: or configure itself at all
[2013-08-28 00:05:08 -0400] cwj: provision instances with awscli or ec2-api-tools
[2013-08-28 00:05:22 -0400] dgarstang: alexkarp: knife-ec2 is borken. I don't want it to log in. I just want it to create the instance. I've had to bake the client details into an amazon AMI
[2013-08-28 00:05:24 -0400] alexkarp: if you just want to bring up a mostly preconfigured EC2 instance, but not log into it, you might be better off using a custom AMI
[2013-08-28 00:05:58 -0400] alexkarp: cwj is right, then, if you don't want to log in, just use ec2-run-instance or something
[2013-08-28 00:06:23 -0400] dgarstang: alexkarp: I wanted to provision the instance with knife to make use of whisk
[2013-08-28 00:06:59 -0400] dgarstang: alexkarp: plus, I still want to pass json data to the chef server for the new node
[2013-08-28 00:07:23 -0400] dgarstang: if knife-ec2 wasn't broken I would just use the ssh option in that
[2013-08-28 00:08:29 -0400] pcn: Can any opscode folks comment on the state of omnibus installers on x86_64 ubuntu 13.04?
[2013-08-28 00:10:36 -0400] dgarstang: So, errr, if I can't pass the runlist to a new node with knife-ec2 and I can't set the run-list on the client side, how do I pass th run_list to a new node?
[2013-08-28 00:11:06 -0400] dgarstang: I guess I have to.... create a nodes/node.json file and upload it?
[2013-08-28 00:11:18 -0400] pcn: https://gist.github.com/pcn/6360656
[2013-08-28 00:11:45 -0400] dgarstang: pcn: was that for me?
[2013-08-28 00:12:07 -0400] pcn: No, for you:
[2013-08-28 00:12:09 -0400] pcn: knife ec2 server create \
[2013-08-28 00:12:11 -0400] pcn:     -r "role[stamp_ubuntu_1304]" \
[2013-08-28 00:14:13 -0400] pcn: my gist is trying to understand why the installer isn't working
[2013-08-28 00:14:57 -0400] dgarstang: pcn: been through this 1000 times, sorry. That doesn't work
[2013-08-28 00:15:38 -0400] dgarstang: jeez. knife-ec2 seemed so simple and it's completely failed to deliver every step of the way. Really frustrated.
[2013-08-28 00:15:43 -0400] pcn: What's not working? it works for me
[2013-08-28 00:16:18 -0400] kallistec: dgarstang: upgrade knife to 11.6. Knife installs the current version instead of the later version by default
[2013-08-28 00:16:46 -0400] kallistec: dgarstang: this is to keep you from getting screwed by avoiding major version upgrades until you're ready
[2013-08-28 00:16:49 -0400] dgarstang: pcn: Where do I start... knife-ec2 ignores .ssh/config.... apparently. The -w proxy option doesn't work quite ... well at all and not documented. knife-ec2 seems to ssh in before the box is up
[2013-08-28 00:17:10 -0400] dgarstang: kallistec: you totaly lost me sorry
[2013-08-28 00:17:32 -0400] kallistec: dgarstang: your knife version on your workstation is 11.4.4.
[2013-08-28 00:17:32 -0400] pcn: OK, so you've got a proxy, you have specific ssh options.
[2013-08-28 00:17:59 -0400] kallistec: dgarstang: and, by default, any bootstrap attempts to install the exact version that you're using on your workstation
[2013-08-28 00:18:08 -0400] dgarstang: pcn: proxy required because command and control box that knife runs on can't reach the systems it builds without going throguh an intermediate ssh host
[2013-08-28 00:18:32 -0400] dgarstang: kallistec: not sure how that would help?
[2013-08-28 00:18:39 -0400] kallistec: dgarstang: if knife didn't do this, then you'd be fucked when we release a new major version that you're not ready to use
[2013-08-28 00:19:22 -0400] dgarstang: kallistec: my chef client is 11.6.0-1.ubuntu.12.04
[2013-08-28 00:20:08 -0400] dgarstang: kallistec and knife-ec2 is (0.6.4
[2013-08-28 00:20:27 -0400] kallistec: dgarstang: why does `sudo /tmp/install.sh -v 11.4.4` appear in your gist?
[2013-08-28 00:20:30 -0400] alexkarp: in case anyone finds these IRC logs later or something, I fixed the problem by using a chef_gem purge on mysql, and then made sure that mysql::client was included before the mysql_database resource
[2013-08-28 00:20:41 -0400] dgarstang: kallistec: that wasnt my gist. :)
[2013-08-28 00:21:04 -0400] kallistec: ah, oops
[2013-08-28 00:21:22 -0400] dgarstang: kallistec: if you cross the streams, the universe will explode
[2013-08-28 00:21:37 -0400] kallistec: risk worth taking
[2013-08-28 00:21:58 -0400] dgarstang: So... can anyone recommend a tool for buidlin ec2 instances from yaml? Cuz, knife-ec2, well it's got issues
[2013-08-28 00:22:51 -0400] pcn: kallistec: that's my gist if you look at it
[2013-08-28 00:23:07 -0400] pcn: And it appears there because I'm trying to get some version - any version - of chef installed on ubuntu 13.04
[2013-08-28 00:23:11 -0400] kallistec: dgarstang: so, anyway... I think your problem is that knife-ec2 doesn't have a reliable means to detect the "up-ness" of the remote ssh server through a proxy
[2013-08-28 00:23:23 -0400] kallistec: pcn: you seem to be on 13.10
[2013-08-28 00:23:46 -0400] kallistec: "URL: https://www.opscode.com/chef/download?v=&prerelease=false&p=ubuntu&pv=13.10&m=x86_64"
[2013-08-28 00:24:00 -0400] dgarstang: kallistec: maybe. i'm really not sure what's going on anymore though, because it's reporting 'ERROR: Net::SSH::Disconnect' which is not the same as a connection refused.
[2013-08-28 00:24:06 -0400] kallistec: pv is platform version detected from etc/lsb_release or what ever
[2013-08-28 00:24:37 -0400] pcn: kallistec: thanks, I missed that.  Time to fix that.
[2013-08-28 00:24:43 -0400] kallistec: dgarstang: right, because the connection to the proxy wasn't refused, so by using a proxy the error moves from the tcp layer to the application layer
[2013-08-28 00:24:52 -0400] dgarstang: kallistec: but the proxy functionality runs ssh port forwarding, so...
[2013-08-28 00:26:35 -0400] kallistec: dgarstang: I'm not sure that's true
[2013-08-28 00:27:14 -0400] dgarstang: kallistec: the box set by the -w option has something listening on port (some port I forgot) when this happens
[2013-08-28 00:32:44 -0400] kallistec: dgarstang: are you sure your gateway isn't booting you?
[2013-08-28 00:33:48 -0400] pcn: Also, can you run the bootstrap once you can confirm that the instane is up?
[2013-08-28 00:59:53 -0400] rafaelma_: Hi everyone
[2013-08-28 01:00:06 -0400] rafaelma_: Got a weird issue happening for the past couple of weeks that I haven't been able to solve
[2013-08-28 01:00:29 -0400] rafaelma_: There are two nodes on my Chef node list that don't seem to be saving their fqdn properly
[2013-08-28 01:01:06 -0400] rafaelma_: A knife ssh returns the following error when trying to run anything: WARNING: Failed to connect to  -- Net::SSH::AuthenticationFailed: ubuntu@
[2013-08-28 01:01:20 -0400] rafaelma_: If I do knife ssh -a ipaddress, I can connect to them fine
[2013-08-28 01:01:20 -0400] martin_work: anyone know if these are the same book ? http://shop.oreilly.com/product/0636920030973.do http://www.amazon.com/Chef-Definitive-Guide-Stephen-Nelson-Smith/dp/1449327443
[2013-08-28 01:01:36 -0400] martin_work: just seems weird the same author would put out 2 books at about the same time.
[2013-08-28 01:02:32 -0400] rafaelma_: A knife status also shows the nodes with a blank third parameter:
[2013-08-28 01:02:51 -0400] rafaelma_: 164 hours ago, node.domain.com, <EMPTY>, 1.2.3.4
[2013-08-28 01:03:26 -0400] rafaelma_: For all other nodes, the <EMPTY> ends up being the FQDN, or not showing at all
[2013-08-28 01:05:36 -0400] rafaelma_: Any ideas?
[2013-08-28 01:14:17 -0400] pkboyz: Has any one setup schedule task in windows with chef?
[2013-08-28 01:23:44 -0400] maraca: hey guys - is there a way to not display attributes that are encrypted data bags on the chefserver:443/node ?
[2013-08-28 01:23:53 -0400] maraca: having password in clear on there makes me nervous
[2013-08-28 01:51:58 -0400] JoelMcCracken: I want to create a few "uninstaller" type recipes; are there any guidelines for that?
[2013-08-28 01:52:35 -0400] JoelMcCracken: ie, I want to remove software from a node that has been installd by a recipe
[2013-08-28 01:53:13 -0400] JoelMcCracken: intuitively, it seems like an recipe named without_<recipe_name> would make sense
[2013-08-28 02:38:01 -0400] mveitas: any recommendations about setting up a Jenkins job to automatically push my chef-repo (environments, roles, and data bags)
[2013-08-28 02:38:35 -0400] mveitas: it seems knife wants to know the value of 'knife[:chef_repo_path]'
[2013-08-28 02:39:12 -0400] jbz: mveitas: Yep, it uses that to determine where cookbooks and data bag files and etc. are
[2013-08-28 02:39:20 -0400] jbz: woo
[2013-08-28 02:39:39 -0400] jbz: ;sorry, just joined channel I realize, didn't mean to jump in
[2013-08-28 02:50:59 -0400] mveitas: jbz: I am running chef client 11.6 and the knife upload is supposed to have an option to specify the --chef-repo-path, but for some reason it does not like that syntax
[2013-08-28 02:52:02 -0400] mveitas: in my Jenkins job, I am looking to run ==>  knife upload . --chef-repo-path $WORKSPACE
[2013-08-28 02:52:11 -0400] jbz: mveitas: Ah I see.  Can you put it into the knife.rb?
[2013-08-28 02:52:41 -0400] mveitas: I'd rather not, as then I have to hard code the path for the workspace/job into the knife.rb
[2013-08-28 02:53:13 -0400] jbz: ah
[2013-08-28 02:53:15 -0400] jbz: hm
[2013-08-28 02:53:21 -0400] mveitas: maybe the docs are out of date, but the 11.6 release notes state the --chef-repo-path should be available
[2013-08-28 02:54:45 -0400] jbz: oh hm
[2013-08-28 02:54:49 -0400] jbz: what's the error?
[2013-08-28 02:54:57 -0400] jbz: I'm wondering if it's complaining about the dot
[2013-08-28 02:55:34 -0400] jbz: It tends to want a path relative to the repo path
[2013-08-28 02:55:45 -0400] mveitas: Error: invalid option: --chef_repo_path
[2013-08-28 02:55:51 -0400] mveitas: USAGE: knife upload PATTERNS
[2013-08-28 02:56:33 -0400] jbz: oh
[2013-08-28 02:56:35 -0400] jbz: not underscores
[2013-08-28 02:56:38 -0400] jbz: dashes
[2013-08-28 02:56:48 -0400] jbz: Or was that underscore option in knife.rb?
[2013-08-28 02:57:03 -0400] mveitas: knife.rb has it as underscore
[2013-08-28 02:57:07 -0400] jbz: I think it's underscore in knife.rb and dashes in the option
[2013-08-28 02:57:27 -0400] mveitas: that would explain it :)
[2013-08-28 02:57:42 -0400] jbz: did that work?
[2013-08-28 02:58:10 -0400] mveitas: no that did not
[2013-08-28 03:00:39 -0400] mveitas: just to make sure knife --version is returning 11.6.0
[2013-08-28 03:01:00 -0400] mveitas: ** UPLOAD COMMANDS **
[2013-08-28 03:01:00 -0400] mveitas: knife upload PATTERNS
[2013-08-28 03:01:17 -0400] a13x212: if i just want to copy a file to a client, should i use cookbook_file?
[2013-08-28 03:02:04 -0400] mveitas: a13x212: You can copy a file to the client that way. But depending on the size of the file, you might want to store it somewhere and fetch it remotely.
[2013-08-28 03:03:15 -0400] mveitas: a13x212: I do that with a wrapper cookbook to install some additional jar files I use, anything large I need to pull down, I use a remote_file or something along those lines
[2013-08-28 03:04:47 -0400] a13x212: thanks, it's just some config files
[2013-08-28 03:05:17 -0400] jbz: mveitas:  OK, I concur, it is acting all broke over here too.
[2013-08-28 03:06:21 -0400] mveitas: jbz: for now I will hard code the path of the chef_repo_path into the knife.rb file so I can get our Jenkins job up and running
[2013-08-28 03:06:56 -0400] mveitas: jbz: I can submit a ticket for this issue
[2013-08-28 03:07:22 -0400] jbz: Yeah, I would
[2013-08-28 03:07:39 -0400] jbz: Did a quick ticket surf, didn't see anything there about it
[2013-08-28 03:08:09 -0400] mveitas: http://tickets.opscode.com/browse/CHEF-4487  This was the only somewhat related one
[2013-08-28 03:16:37 -0400] mveitas: FYI: Created http://tickets.opscode.com/browse/CHEF-4499 regarding the knife upload issue if you are interested in it at all
[2013-08-28 03:31:07 -0400] jbz: mveitas: +1-ing
[2013-08-28 03:31:39 -0400] mveitas: must have been something missed when knife-essentials was merged into the core
[2013-08-28 03:32:09 -0400] cwj: anyone know how to include_recipe inside a HWRP?
[2013-08-28 03:32:41 -0400] cwj: ive tried @run_context.include_recipe(runit) but it doesnt seem to execute the default recipe before my HWRP action executes
[2013-08-28 03:49:25 -0400] jkeiser: mveitas: really weird, I'll follow up on that when I get a chance.  I repro it here too
[2013-08-28 03:49:35 -0400] jkeiser: Good catch
[2013-08-28 03:50:10 -0400] jkeiser: CHEF-4487 isn't really related honestly, this is more about the command line argument and that is about knife.rb/client.rb
[2013-08-28 03:50:58 -0400] cwj: guess ill just do it in the default recipe
[2013-08-28 03:55:00 -0400] tabolario: cwj: that seems to be how i've seen it done in most places
[2013-08-28 03:55:22 -0400] tabolario: cwj: i think almost every cookbook i've come across that has dependent recipes just says "include the default recipe if you're going to use the LWRPs"
[2013-08-28 03:55:36 -0400] tabolario: *that has dependent recipes for its LWRPs
[2013-08-28 03:56:09 -0400] cwj: yeah thats often how ive done it in the past, but the @run_context.include_recipe(foo) trick works with LWRPs
[2013-08-28 03:56:16 -0400] cwj: not with HWRPs for some reason
[2013-08-28 03:56:19 -0400] cwj: oh well :)
[2013-08-28 03:59:58 -0400] tabolario: Maybe I should start writing HWRPs for new internal things just so I can get up to speed on Chef internals more
[2013-08-28 04:04:55 -0400] cwj: it is interesting. makes one appreciate how much boilerplate LWRPs abstract away
[2013-08-28 04:09:48 -0400] pipework: Local Waterfront Revitalization Program
[2013-08-28 04:09:49 -0400] pipework: ?
[2013-08-28 04:12:26 -0400] cwj: light weight resource and provider
[2013-08-28 04:12:26 -0400] cwj: http://docs.opscode.com/chef/lwrps_custom.html
[2013-08-28 04:28:21 -0400] zenloop: hey guys, I have a chef-run that fails after the initial boot strap of the node.  when I manually run the chef-client the recipe that fails will complete.   What is odd is that nothing has been changed as far as dependecies or anything else.  The only difference is that that the successful run is initiated from the command line and the other is initiated as a cloud init script.  Any ideas?  The cookbook that is failing is npm.  again if I r
[2013-08-28 04:28:21 -0400] zenloop: chef-client things work great - but if cloud init starts chef-client (on the inital boot strap) things fail.
[2013-08-28 04:29:41 -0400] jbz: zenloop: Does the npm cookbook depend on something that hasn't been configured by either the cloud init or the preceding cookbooks in the run?
[2013-08-28 04:29:57 -0400] cwj: zenloop: situations like that usually make me think there is something missing from the user/shell environment
[2013-08-28 04:30:24 -0400] jbz: ahhh cwj is smarter than I, indeed
[2013-08-28 04:30:36 -0400] zenloop: cwj: yah I thought about that.  I tried a login shell with no luck.
[2013-08-28 04:30:54 -0400] zenloop: jbz:  nodejs is the dependency but that is declared in each case.
[2013-08-28 04:31:06 -0400] jbz: What is the failure error?
[2013-08-28 04:31:18 -0400] zenloop: https://github.com/balbeko/chef-npm/issues/17
[2013-08-28 04:32:29 -0400] zenloop: so strange because everything works fine when I run the bash commands manually, or start the recipe from the command line.  makes me think (as cwj suggested) that their is something wrong with my env.
[2013-08-28 04:33:07 -0400] cwj: are the bash commands in question calling npm itself?
[2013-08-28 04:33:30 -0400] jbz: from that error it looks like when it packs up the working dir it's getting way more than it bargained for if I'm reading that right, which I may not be
[2013-08-28 04:34:18 -0400] zenloop: jbz: http://pastie.org/8276121
[2013-08-28 04:35:17 -0400] jbz: Huh.  When it fails, do you find the directory on the node that you'd expect?
[2013-08-28 04:35:48 -0400] zenloop: yeah.
[2013-08-28 04:35:51 -0400] zenloop: everything is there.
[2013-08-28 04:35:55 -0400] jbz: ...wacky.
[2013-08-28 04:35:56 -0400] zenloop: so weird.
[2013-08-28 04:36:08 -0400] zenloop: it works from command line chef-client.
[2013-08-28 04:36:16 -0400] zenloop: but when things start with chef-init no worky.
[2013-08-28 04:36:58 -0400] zenloop: I thought maybe chef-client version?  But the chef-client is put in embedded and in bin and the one in the path is in bin I believe.
[2013-08-28 04:37:29 -0400] zenloop: and the one from bin works from command line.
[2013-08-28 04:38:26 -0400] jbz: so what's different about the machine during cloud init
[2013-08-28 04:38:33 -0400] zenloop: jbz: at this point I am willing to use the packaged npm and forget about being able to pulled in different versions with the cookbook.
[2013-08-28 04:38:35 -0400] jbz: is there anything *after* the chef client run in cloud init?
[2013-08-28 04:39:22 -0400] zenloop: no unfortunately.
[2013-08-28 04:41:03 -0400] jbz: grrr
[2013-08-28 04:41:11 -0400] zenloop: during the chef run I do run the chef-client recipe.
[2013-08-28 04:41:37 -0400] jbz: did you look at the npm debug log
[2013-08-28 04:41:38 -0400] jbz: ?
[2013-08-28 04:41:46 -0400] zenloop: yah.  says the same thing.
[2013-08-28 04:41:51 -0400] jbz: gah.
[2013-08-28 04:42:03 -0400] zenloop: Thanks for the suggestions.
[2013-08-28 04:43:11 -0400] jbz: sorry
[2013-08-28 07:58:17 -0400] ichilton: Any idea why I don't see package installs happening in the chef solo output (vagrant provision)
[2013-08-28 07:58:39 -0400] ichilton: I see everything else, but package installs seem to happen silently...
[2013-08-28 08:00:34 -0400] ambz: hello all, I'm trying to install chef-server on an Amazon ec2 instance. "sudo chef-server-ctl reconfigure" gets stuck at the "ruby_block[supervise_rabbitmq_sleep] action run" stage... I think it might be a repro of http://tickets.opscode.com/browse/CHEF-3838. However, the suggested workaround (change /opt/chef-server/embedded/cookbooks/runit/recipes/default.rb) isn't working for me.
[2013-08-28 08:00:57 -0400] ambz: A little help please :)
[2013-08-28 08:07:33 -0400] flaccid:  /j plexapp
[2013-08-28 08:07:35 -0400] flaccid: woops!
[2013-08-28 08:18:27 -0400] abrkn: why would node[:chef_environment] be missing when the web console confirms that the node has environment set to "production"?
[2013-08-28 08:19:45 -0400] zed: hi there, i'm having a trouble with remote_file under windows, the directory is being created by chef but I have the following error: https://gist.github.com/anonymous/5e3a0552d10d9e548a2b
[2013-08-28 08:20:03 -0400] abrkn: knife node show also confirms that environment is set
[2013-08-28 08:40:45 -0400] ambz: all quiet in the western hemisphere
[2013-08-28 09:27:09 -0400] BryanWB: will application_python automatically install a db server for me if i use the database block? i assume i still need to set up the server separately
[2013-08-28 09:41:11 -0400] arpa: Hey.. trying to create a linode server via 'knife linode server create ...', I have a run list with a single recipe that I've created. When I run the knife command it should create a remote server and run the recipe on, but before it runs the recipe it installs chef on the remote machine. For some reason this fails with this message: Unable to resolve dependencies: net-ssh-gateway requires net-ssh (>= 2.6.5); net-ssh-multi requires net-s
[2013-08-28 09:41:46 -0400] arpa: I googled quite a bit and found only reports on this message being displayed to people trying to install some older versions of chef, however I'm not really controlling which chef version will be downloaded to the remote machine or anything like that
[2013-08-28 09:42:37 -0400] ichilton: I have an environments/remote.rb - should I be able to upload that to the chef server with knife upload environments or knife upload environments/remote.rb ? - I don't get an error but it doesn't appear on the cehf server
[2013-08-28 09:44:09 -0400] ichilton: ah, got it - knife environment from file environments/remote.rb
[2013-08-28 09:45:45 -0400] ichilton: Unless i'm understanding it wrong, http://docs.opscode.com/knife_upload.html is clearly rubbish!
[2013-08-28 09:46:03 -0400] ichilton: or only supports json ones?
[2013-08-28 09:51:47 -0400] ghatak: Hi guys, is there a way to make chef wait slightly before an action? for example wait for a service to start before issuing further commands ?
[2013-08-28 09:52:57 -0400] n1ko: ghatak: use :notifies
[2013-08-28 09:53:06 -0400] n1ko: or if you are into ugly hacks sleep
[2013-08-28 09:53:42 -0400] ghatak: n1ko: i will try notifies first
[2013-08-28 09:53:59 -0400] xhae: ghatak: notifies will simply run an action after your service's command returns
[2013-08-28 09:54:20 -0400] xhae: ghatak: so maybe that command should wait to return until the service is available or has failed to start
[2013-08-28 09:54:26 -0400] n1ko: which usually does what you want, but some stuff returns a code and keeps doing something
[2013-08-28 09:54:29 -0400] n1ko: like tomcat
[2013-08-28 09:54:56 -0400] xhae: I prefer to put the sleep loops in the bash script and keep the higher level clean, ymmv.
[2013-08-28 09:56:03 -0400] ghatak: n1ko: i see. so in my case probably a subscribe be better option since another recipie is interested in service initiated by default recipie ?
[2013-08-28 10:30:40 -0400] zaargy: notifies on a template resource should be idempotent as long as the params passed to the template don't change right?
[2013-08-28 10:35:55 -0400] abrkn: how do i access a data bag item from a template?
[2013-08-28 10:40:07 -0400] zaargy: require 'chef/data_bag', data_bag_item
[2013-08-28 10:43:39 -0400] GianArb: hi! sorry i'm trying to use mongo recipe of opcode.. but I have this error FATAL: RuntimeError: apt_repository[10gen] (mongodb::10gen_repo line 28) had an error: RuntimeError: The repository file to create is nil, cannot continue.
[2013-08-28 11:03:01 -0400] tugce: Hello, I want to connect a new client/node to the server but when I try to do it in webui a blank page is coming and in command line even after 10 minutes command just doesnt work and can't be stopped by ctrl+c. Any idea?
[2013-08-28 11:04:36 -0400] tugce: ubuntu@tugce:~/chef-repo$ knife client list centos_node chef-validator chef-webui debian_node ubuntu@tugce:~/chef-repo$ knife client create ubuntu_node  ^C^C^C^Z [1]+  Stopped                 knife client create ubuntu_node ubuntu@tugce:~/chef-repo$
[2013-08-28 11:04:48 -0400] tugce: this is what i get from command line
[2013-08-28 11:05:08 -0400] tugce: i can get client list but can't create a client
[2013-08-28 11:06:59 -0400] arpa: Hey.. trying to create a linode server via 'knife linode server create ...', I have a run list with a single recipe that I've created. When I run the knife command it should create a remote server and run the recipe on, but before it runs the recipe it installs chef on the remote machine. For some reason this fails with this message: Unable to resolve dependencies: net-ssh-gateway requires net-ssh (>= 2.6.5); net-ssh-multi requires net-s
[2013-08-28 11:07:01 -0400] arpa: I googled quite a bit and found only reports on this message being displayed to people trying to install some older versions of chef, however I'm not really controlling which chef version will be downloaded to the remote machine or anything like that
[2013-08-28 12:15:06 -0400] mikeb2: hello fellow cheffers? Anyone here with any experience of the nginx source cookbook and how to compile addtional modules? Thanls
[2013-08-28 12:35:59 -0400] mikeb2: hello - anyone with nginx::source recipe experience - I can't get an additonal module to be included - thanks
[2013-08-28 12:57:16 -0400] ghatak: Can I get uid/gid of a user at run time in chef ?
[2013-08-28 12:57:36 -0400] gchristensen: ghatak: you could use bash `id username`
[2013-08-28 12:59:33 -0400] ghatak: gchristensen: suppose i could, was looking for something chef native
[2013-08-28 13:02:36 -0400] gchristensen: I don't think chef has any sort of method for that. what are you looking to use it for?
[2013-08-28 13:04:46 -0400] davsharyan33: hey amigos, having stupid problem with adding recipe to node. Instead of adding say recipe[swap] it's adding recipe[recipes] . any idea what could be the problem ? kiitos
[2013-08-28 13:04:56 -0400] tugce: ghatak: well i'm not sure but ohai *might be* return the uid for a user. Howewer I did not check if it's possible.
[2013-08-28 13:05:58 -0400] davsharyan33: after that I even can't remove that recipe from the list, I MUST remove node/client from the server and re-add it
[2013-08-28 13:08:07 -0400] defishguy: Good morning!  I need to have chef manage a service that needs to run as a particular user. I've tried su -c '<command>' - user and all sorts of variations as the start command, and still the service starts as root.  Do I really need to resort to "execute" to make this happen, or is there a voodoo ritual that this acolyte hasn't learned?
[2013-08-28 13:08:23 -0400] gchristensen: tugce: oh good point, I think you're right
[2013-08-28 13:13:44 -0400] gchristensen: defishguy: best way is to put the user switching into the init script or what have you
[2013-08-28 13:18:36 -0400] defishguy: :gchristensen Thank you.  I was hoping to avoid that, but methinks you're correct.
[2013-08-28 13:18:45 -0400] gchristensen: well that is the most proper way anyway
[2013-08-28 13:18:51 -0400] gchristensen: because any other init script is going to be called by root
[2013-08-28 13:19:19 -0400] defishguy: tx
[2013-08-28 13:19:48 -0400] jsvana: So, I have two recipes. One (say, foo) that needs to run first and another (say, bar) that has one command at the end that needs to run after foo is run. So, I have bar include_recipe foo, but foo is not running all of its before the bar command runs.
[2013-08-28 13:19:52 -0400] jsvana: Any ideas?
[2013-08-28 13:24:18 -0400] mveitas: jsvana: One thing to think about would be the use of notifications: http://docs.opscode.com/resource_common.html#notifications
[2013-08-28 13:25:18 -0400] mveitas: jsvana: Why not just do include_recipe "foo" include_recipe "bar" in your recipe/default.rb?
[2013-08-28 13:26:01 -0400] jsvana: mveitas: that's what I'm doing (bar is default.rb)
[2013-08-28 13:27:28 -0400] mveitas: jsvana, what kind of resources or commands are these in your recipes?
[2013-08-28 13:28:14 -0400] jsvana: creating an ssh key and pushing it to github.
[2013-08-28 13:28:19 -0400] jsvana: mveitas: ^
[2013-08-28 13:30:07 -0400] mveitas: jsvana, are you creating the ssh key in a script or bash resource?
[2013-08-28 13:33:20 -0400] jsvana: mveitas: I'm using execute to run ssh-keygen
[2013-08-28 13:53:14 -0400] adamjk-dev: hey all... anyone know how to switch over the node platform in chef-minitest?     case node[:platform_family] is throwing an error
[2013-08-28 13:54:11 -0400] gchristensen: isn't it just node.platform_family
[2013-08-28 13:54:54 -0400] adamjk-dev: gchristensen: I can try that
[2013-08-28 13:55:11 -0400] mattjalexander: where are you referencing it?
[2013-08-28 13:55:20 -0400] mattjalexander: i think minitest can only reference node variables inside of the test cases
[2013-08-28 13:55:37 -0400] adamjk-dev: mattjalexander: yeah, from within a test recipe
[2013-08-28 13:55:56 -0400] adamjk-dev: mattjalexander: the jenkins cookbook installs jenkins different ways depending on the platform
[2013-08-28 13:56:26 -0400] adamjk-dev: adamjk-dev: so I was hoping to just write tests at the "server" level (and not have to write other ones), but perhaps I am taking a shortcut I shouldn't be
[2013-08-28 13:58:37 -0400] BryanWB: is it possible to modify the roles a node belongs to during a chef run?
[2013-08-28 14:01:31 -0400] mattjalexander: i would guess just modify node['roles']
[2013-08-28 14:01:33 -0400] yfeldblum: BryanWB, i assume so ... but it's hard to imagine that being a god idea
[2013-08-28 14:02:32 -0400] surge_: For chef report/exception handlers, has the method to check for failure changed? https://github.com/simplereach/chef-handler-campfire/blob/master/lib/chef/handler/campfire.rb#L30 << This always evaluates to the "else" condition it seems.
[2013-08-28 14:02:56 -0400] surge_: Though when a chef run does fail, the handler does nothing.
[2013-08-28 14:03:05 -0400] surge_: On success it works as intended.
[2013-08-28 14:04:40 -0400] adamjk-dev: gchristensen: node.platform_family did not work
[2013-08-28 14:06:24 -0400] ichilton: Hi bean
[2013-08-28 14:06:27 -0400] bean: hi ichilton
[2013-08-28 14:06:35 -0400] ichilton: Hey BryanWB!
[2013-08-28 14:06:37 -0400] jmartin: will chef 11 client work with .9.x server?
[2013-08-28 14:06:59 -0400] BryanWB: yfeldblum: hey buddy :), am using the applicaton_python cookbook w/out chef-server
[2013-08-28 14:07:04 -0400] BryanWB: ichilton: hey dude!
[2013-08-28 14:07:21 -0400] ichilton: BryanWB: How's things? - baby doing well?
[2013-08-28 14:07:43 -0400] bean: jmartin: I don't think so.
[2013-08-28 14:07:49 -0400] BryanWB: ichilton: very healthy :), crying quite loudly atm ;)
[2013-08-28 14:07:58 -0400] ichilton: BryanWB: haha, good good
[2013-08-28 14:08:27 -0400] jmartin: bean: what about 10.x ?
[2013-08-28 14:08:35 -0400] yfeldblum: BryanWB, howdy
[2013-08-28 14:09:23 -0400] bean: jmartin: in general I think you want your client version to at least be in the same major version as your server.
[2013-08-28 14:09:51 -0400] jmartin: bean: yeah...id like it to be but we are transitioning to a more recent version so im stuck in the middle atm
[2013-08-28 14:10:06 -0400] jtimberman: BryanWB: you can modify the node's run list during run time. however, node['roles'] is an automatic attribute that is generated from the expanded run list
[2013-08-28 14:10:08 -0400] jmartin: thanks for the info
[2013-08-28 14:20:07 -0400] [cg]: so... maintaining a chef-repo in git and pushing cookbooks and roles and whatnot to the chef server. Is there any editorial on why this is necessary or beneficial?
[2013-08-28 14:20:56 -0400] [cg]: would you ever have something in the repo not in the server or vice versa?
[2013-08-28 14:22:27 -0400] bean: [cg]: I don't have environments on my source control, but i'd like them to be eventually :)
[2013-08-28 14:22:34 -0400] bean: or, databags.
[2013-08-28 14:23:58 -0400] mikeb2: anyone got any idea why --add-module is ignored under nginx->source->default_configure_flags?
[2013-08-28 14:24:55 -0400] [cg]: is it simply to keep track of the history?
[2013-08-28 14:25:12 -0400] nicgrayson: [cg]: yep just for history
[2013-08-28 14:25:23 -0400] siezer: [cg] chef-server is a cookbook artifact server
[2013-08-28 14:25:33 -0400] siezer: what's in git isn't necessarily what's on chef-server
[2013-08-28 14:25:53 -0400] siezer: you can have multiple versions of a cookbook, pinned to different environments, for example
[2013-08-28 14:26:14 -0400] MattMaker: [cg]: I suppose you also get the benefit of branching and push requests, from git
[2013-08-28 14:27:05 -0400] [cg]: environments as in chef "environments"  or the broader concept of environments
[2013-08-28 14:28:00 -0400] ichilton: jtimberman: Just working on something like this: http://jtimberman.housepub.org/blog/2012/01/29/dnsimple-self-registration-recipe/
[2013-08-28 14:28:28 -0400] ichilton: jtimberman: I want every new node within a certain environment (remote) to auto-register with dnsimple
[2013-08-28 14:28:52 -0400] ichilton: jtimberman: Does every new node therefore need the encrypted_data_bag_secret file?
[2013-08-28 14:30:01 -0400] ichilton: jtimberman: or just the chef server?
[2013-08-28 14:31:00 -0400] jtimberman: ichilton: yes.
[2013-08-28 14:31:04 -0400] jtimberman: each node
[2013-08-28 14:32:22 -0400] adamjk-dev: anyone know if test-kitchen will pick up tests from recipes included dynamically?
[2013-08-28 14:32:43 -0400] adamjk-dev: for example, will test-kitchen pick up tests based on this: https://github.com/opscode-cookbooks/jenkins/blob/master/recipes/server.rb#L68
[2013-08-28 14:32:48 -0400] ichilton: jtimberman: how do you manage that then?
[2013-08-28 14:33:06 -0400] adamjk-dev: it includes either a _server_war or _server_package recipe, if I  have tests around those, will they be picked up?
[2013-08-28 14:33:15 -0400] adamjk-dev: it is looking like no right now, which isn't good
[2013-08-28 14:34:43 -0400] ichilton: jtimberman: i'm currently boostrapping DigitalOcean nodes with knife digital_ocean so the node is bootstrapped and provisioned in one go so I wouldn't be able to get the key file on there until after i'd have already wanted it registered with dns?
[2013-08-28 14:34:48 -0400] ichilton: jtimberman: am I screwed? :)
[2013-08-28 14:39:18 -0400] bean: ichilton: the bootstrap template can drop in the key, np?
[2013-08-28 14:39:20 -0400] bean: no?
[2013-08-28 14:39:21 -0400] jtimberman: ichilton: 'knife bootstrap' will copy the encrypted data bag secret over for you if you have one.
[2013-08-28 14:39:24 -0400] bean: ^
[2013-08-28 14:39:54 -0400] jtimberman: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb#L34-L39
[2013-08-28 14:40:09 -0400] ichilton: hmm, I guess
[2013-08-28 14:40:24 -0400] ichilton: Can you control the bootstrap stuff with the knife exentions like digital_ocean?
[2013-08-28 14:40:57 -0400] ichilton: <% if encrypted_data_bag_secret -%>
[2013-08-28 14:41:02 -0400] ichilton: where does that come from
[2013-08-28 14:41:17 -0400] zaargy: can i get the version of a cookbook during a chef run?
[2013-08-28 14:41:55 -0400] adamjk-dev: sorry, I should say does anyone know if minitest-handler will pick up tests from a recipe that is included dynamically from within a recipe. Based on this type of include: https://github.com/opscode-cookbooks/jenkins/blob/master/recipes/server.rb#L68
[2013-08-28 14:42:04 -0400] ichilton: jtimberman: ah, from config?
[2013-08-28 14:42:37 -0400] ichilton: jtimberman: so you'd put the contents of your secret file in your knife.rb?
[2013-08-28 14:42:58 -0400] jtimberman: ichilton: encrypted_data_bag_secret is a method in the Knife::Core::BootstrapContext: https://github.com/opscode/chef/blob/master/lib/chef/knife/core/bootstrap_context.rb#L53
[2013-08-28 14:43:27 -0400] mattjalexander: can the open source chef server talk to ad/ldap, or is that limited to private chef?
[2013-08-28 14:43:45 -0400] jtimberman: adamjk-dev: i believe the way minitest-handler works is by inspecting the node's run list for the recipes to run tests
[2013-08-28 14:43:59 -0400] ichilton: jtimberman: ahhh, ok - so you can set :secret_file in knife.rb, pointing it to the secret file you created - then it will automatically upload that when you bootstrap nodes?
[2013-08-28 14:44:13 -0400] siezer: mattjalexander its called "enterprise chef" now, but yea.
[2013-08-28 14:44:15 -0400] adamjk-dev: jtimberman: it is.... but does the run list get expanded to what is included during the run?
[2013-08-28 14:44:56 -0400] adamjk-dev: jtimberman: [2013-08-28T14:18:28+00:00] INFO: Run List is [recipe[apt], recipe[jenkins-test::server], recipe[minitest-handler]]
[2013-08-28 14:45:39 -0400] jtimberman: adamjk-dev: "include_recipe" is not expanded no.
[2013-08-28 14:45:55 -0400] jtimberman: mattjalexander: that's an Enterprise Chef feature.
[2013-08-28 14:46:15 -0400] adamjk-dev: jtimberman: okay, so when a recipe includes another recipe, I presume tests will not be picked up for that? like the jenkins cookbook does: https://github.com/opscode-cookbooks/jenkins/blob/master/recipes/server.rb#L68
[2013-08-28 14:47:43 -0400] jtimberman: adamjk-dev: i don't think so
[2013-08-28 14:48:50 -0400] adamjk-dev: jtimberman: weak..... my first attempt to actually contribute is halted.... https://github.com/opscode-cookbooks/jenkins/pull/55
[2013-08-28 14:53:32 -0400] jtimberman: adamjk-dev: :-|
[2013-08-28 14:54:18 -0400] adamjk-dev: jtimberman: I know, no fun.... I can make the tests really generic I guess and still contribute... but I was trying to very in-depth and check each installation method etc.... we shall see.... thanks for the help
[2013-08-28 15:04:23 -0400] dgarstang: maybe not chef totally... can anyone recommend a command line tool for spinning up new ec2 instances? Knife-ec2 has failed spectacularly.
[2013-08-28 15:05:59 -0400] jtimberman: dgarstang: AWS's ec2 cli tools perhaps?
[2013-08-28 15:06:09 -0400] gkarekinian: You can use fog also
[2013-08-28 15:06:31 -0400] dgarstang: jtimberman: Yes, but I wanted to put all the config into a yaml file in the same way whisk works
[2013-08-28 15:07:03 -0400] jtimberman: i've not used whisk
[2013-08-28 15:08:00 -0400] dgarstang: jtimberman: We have a home grown tool right now, which reads config from a yaml file. Basically, you want to spin up a new instance and only pass say, role, location, env. Tool reads role from yaml file, merges a lot of shit together, and spins up box
[2013-08-28 15:08:23 -0400] jtimberman: rad
[2013-08-28 15:08:40 -0400] dgarstang: jtimberman: (notsureif)
[2013-08-28 15:08:42 -0400] jtimberman: if that's working, i'd rock that, and teach it about chef
[2013-08-28 15:09:07 -0400] dgarstang: jtimberman: it's written in perl and I'd rather not rewrite it myself. :)
[2013-08-28 15:09:20 -0400] dgarstang: .... even in python
[2013-08-28 15:09:39 -0400] jtimberman: hahaha
[2013-08-28 15:09:41 -0400] jtimberman: fair enoguh
[2013-08-28 15:09:46 -0400] StormSilver: dgarstang: I have always used some kind of home grown tool to manage chef. With the advent of knife, I just farm out to the knife commands.
[2013-08-28 15:10:04 -0400] jtimberman: i haven't written any significant perl in like, 8 years.
[2013-08-28 15:10:16 -0400] StormSilver: But it's handy, as you say, to be able to merge your configs, set some defaults, etc etc, then have it do the knife command to spin up a box.
[2013-08-28 15:10:20 -0400] dgarstang: StormSilver: that's where I was headed too. :(
[2013-08-28 15:10:20 -0400] bean: dgarstang: is whisk at least working how you'd like it?
[2013-08-28 15:10:28 -0400] gchristensen: jtimberman: even the most basic line becomes uninteligable after a few days :)
[2013-08-28 15:10:40 -0400] dgarstang: bean: sure, whisk works fine until 'knife ec2 server create' fails to ssh into the new box
[2013-08-28 15:10:45 -0400] bean: haha
[2013-08-28 15:10:46 -0400] bean: :)
[2013-08-28 15:11:07 -0400] StormSilver: dgarstang: Not that bad. I usually write my "dev toolbox" within the capistrano framework which gives you easy access to running commands on remote servers.
[2013-08-28 15:11:24 -0400] StormSilver: dgarstang: Plus it will provide you the framework to define tasks and run them easily.
[2013-08-28 15:11:31 -0400] Kzim: hi is there any sort of replacement for chef server search for chef solo ? :)
[2013-08-28 15:11:31 -0400] gchristensen: okay so I think #learnchef might be a bit too basic. anyone have an example chef-solo repository I could look at that doesn't use vagrant? I'm looking for the basics on how to set up the client (or what have you) and a basic convergance, and I'm confident I can take it from there.
[2013-08-28 15:11:44 -0400] surge_: jtimberman: I know the docs suggest using the "success?" or "failed?" properties, but that doesn't seem to be triggering my handler and I don't want to remove the condition because I am only interested in failed chef runs only. Any idea how I might otherwise check for a failed run?
[2013-08-28 15:12:00 -0400] surge_: For "run_status" ^^^
[2013-08-28 15:12:10 -0400] dgarstang: StormSilver: i tried that with fabric. It sucks in fabric, and I assume it would suck in capistrano too, because it takes a lot of effort to make something idempotent in a scripting language
[2013-08-28 15:12:56 -0400] StormSilver: dgarstang: What I'm talking about is pre-idempotency, so maybe I misunderstood what you were asking about.
[2013-08-28 15:14:02 -0400] dgarstang: StormSilver: Well, eg: i was trying to use fabric to install chef... well, you gotta download it, but if the file is already there you don't need to, but you gotta check the checksum of the file to make sure it's valid before you decide you dont need to redownload it. Of course, even before any of that you have to check and see if the package is installed first, and so on
[2013-08-28 15:14:45 -0400] jtimberman: surge_: if you configure it only as an exception_handler, then it won't get run on a successful run :)
[2013-08-28 15:14:47 -0400] StormSilver: dgarstang: Aha, I get you. What about knife bootstrap?
[2013-08-28 15:15:23 -0400] StormSilver: What are the cool kids using these days to monitor and restart their services? Is nagios out of style?
[2013-08-28 15:15:31 -0400] dgarstang: StormSilver: see above. it dont work when a) your cloud-init script needs to change the username and hasn't run yet by the time it does, ignores .ssh/config and I just cant get the -w proxy option to work
[2013-08-28 15:15:43 -0400] surge_: jtimberman: well, that's exactly it it fails, but i never get the message in campfire. I remove the condition to check if it passed but now i get updated resources, which would be fine, but we have 200~300 nodes so that's jus spam haha
[2013-08-28 15:15:48 -0400] bean: StormSilver: I don't use nagios to restart things, I just use it to alert.
[2013-08-28 15:15:50 -0400] bean: :)
[2013-08-28 15:16:17 -0400] dgarstang: omg, why do all the jobs in Seattle involve windoze.
[2013-08-28 15:16:38 -0400] jtimberman: dgarstang: because MS is in Redmond? :)
[2013-08-28 15:16:54 -0400] dgarstang: jtimberman: I knew that. :-\
[2013-08-28 15:17:39 -0400] dgarstang: and no, I don't want to live in crowded, dirty, expensive, treeless San Francisco Mr Recruiter.
[2013-08-28 15:17:46 -0400] StormSilver: bean: In this case, I just need to check on pgpool and restart it if it's hung, since it hangs an awful lot.
[2013-08-28 15:18:25 -0400] bean: StormSilver: I can't say I'd even know where to start with that problem
[2013-08-28 15:20:33 -0400] jtimberman: dgarstang: you can live in expansive, relatively less expensive, treeless Denver!
[2013-08-28 15:21:38 -0400] dgarstang: jtimberman: I lived in very expansive, very less expensive Billings MT for a bit. :)
[2013-08-28 15:22:52 -0400] jtimberman: oh, very expansive.
[2013-08-28 15:23:17 -0400] dgarstang: lots of deer n stuff
[2013-08-28 15:26:25 -0400] surge_: jtimberman: Know of any good exception(only) handlers? I'm looking at hipchat and airbrake for ideas, but it's jus telling me what I already know (and tried) if run_status.formatted_exception  if run_status.failed? these don't work.
[2013-08-28 15:26:55 -0400] mirkokiefer: anyone who has experience in doing some kind of integration testing across servers?
[2013-08-28 15:27:03 -0400] mirkokiefer: I want to start a node.js server on machine A
[2013-08-28 15:27:10 -0400] mirkokiefer: another on machine B who calls to A
[2013-08-28 15:27:14 -0400] mirkokiefer: run some tests
[2013-08-28 15:27:18 -0400] mirkokiefer: and destroy everything
[2013-08-28 15:27:27 -0400] sc0: Vagrant?
[2013-08-28 15:27:32 -0400] surge_: +1 to vagrant
[2013-08-28 15:27:33 -0400] mirkokiefer: I'm using vagrant
[2013-08-28 15:27:35 -0400] adamjk-dev: mirkokiefer: i have used test-kitchen and vagrant to do so
[2013-08-28 15:27:45 -0400] adamjk-dev: mirkokiefer: then write some tests in chef-minitest or something
[2013-08-28 15:28:10 -0400] adamjk-dev: mirkokiefer: have to be tricky with test-kitchen (and tell it not to destroy) since it is really "meant" for single machine testing
[2013-08-28 15:28:56 -0400] freerobby: Hi, can somebody help me? We are trying to bootstrap a node with a custom bootstrap script, and it does not appear to use it and generate the correct client.rb
[2013-08-28 15:28:58 -0400] adamjk-dev: mirkokiefer: so, something like defining two machines (in the proper order) in Vagrant/test-kitchen, bring them both up, run whatever tests you have written (in something like chef-minitest), then destroy both machines
[2013-08-28 15:29:25 -0400] mirkokiefer: adamjk-dev: that would be the most extreme test
[2013-08-28 15:29:34 -0400] freerobby: knife bootstrap [redacted] -x ubuntu --sudo -E production -r "role[[redacted]]" -N [redacted] --template-file ./.chef/bootstrap/wistia.erb
[2013-08-28 15:29:34 -0400] mirkokiefer: but I'm looking for something more lightweight
[2013-08-28 15:29:41 -0400] freerobby: No errors, but it does not use the correct script
[2013-08-28 15:29:42 -0400] mirkokiefer: with both machines already running
[2013-08-28 15:29:57 -0400] mirkokiefer: and just starting the node.js servers again and running tests
[2013-08-28 15:30:03 -0400] mirkokiefer: and no machine destroy
[2013-08-28 15:30:04 -0400] adamjk-dev: mirkokiefer: http://serverspec.org/ ?
[2013-08-28 15:30:19 -0400] adamjk-dev: mirkokiefer: I am not sure, depends on the kinds of tests you need to run then...
[2013-08-28 15:30:23 -0400] fak3r: on opscode hosted chef, where can we find the logs to see when a server has had the last chef run?
[2013-08-28 15:30:48 -0400] mirkokiefer: adamjk-dev: I'm just testing the http interface
[2013-08-28 15:31:14 -0400] surge_: fak3r: Chef doesn't log anywhere except to STDOUT AFAIK. You can tell it to log somewhere though
[2013-08-28 15:31:21 -0400] adamjk-dev: mirkokiefer: then write your own test scripts and just run them after I guess? You just making REST calls or something?
[2013-08-28 15:31:21 -0400] jtimberman: fak3r: the last successful time that a node saved will be approximately equal to the ohai_time attribute of the node.
[2013-08-28 15:31:30 -0400] surge_: oh
[2013-08-28 15:31:34 -0400] surge_: that's useful didnt know that
[2013-08-28 15:31:51 -0400] jtimberman: fak3r: Opscode is working on the reporting feature of Enterprise Chef still, it's not GA yet.
[2013-08-28 15:32:03 -0400] jtimberman: (it was demoed at ChefConf earlier this year)
[2013-08-28 15:32:04 -0400] mirkokiefer: adamjk-dev: yeah I want to run the tests for machine B which depends on a server running on machine A
[2013-08-28 15:32:17 -0400] fak3r: jtimberman: surge_ ah, we'll check that, thank you
[2013-08-28 15:32:17 -0400] mirkokiefer: but the server on machine A should be recreated for each test run
[2013-08-28 15:32:57 -0400] ichilton: Should nodes be in the _default environment and any you create, or is _default not needed once you create your own?
[2013-08-28 15:33:01 -0400] mirkokiefer: adamjk-dev: so my problem is starting and stopping the server on machine A every time
[2013-08-28 15:33:27 -0400] adamjk-dev: mirkokiefer: vagrant destroy and vagrant up?   kitchen destroy and kitchen test?
[2013-08-28 15:33:42 -0400] jtimberman: fak3r: http://www.youtube.com/watch?v=erU1UOlmlvI
[2013-08-28 15:33:48 -0400] mirkokiefer: adamjk-dev: yeah but that would rebuild the vm
[2013-08-28 15:33:56 -0400] jtimberman: around minute 30-32 or so is the demo part, but the whole thing is good ;)
[2013-08-28 15:34:00 -0400] adamjk-dev: mirkokiefer: vagrant provision?
[2013-08-28 15:34:09 -0400] mirkokiefer: I basically just want to login to machina A through ssh
[2013-08-28 15:34:16 -0400] mirkokiefer: start the node.js server
[2013-08-28 15:34:21 -0400] mirkokiefer: run the tests on machine B
[2013-08-28 15:34:25 -0400] mirkokiefer: and stop the server on A
[2013-08-28 15:35:10 -0400] adamjk-dev: vagrant ssh, (execute command to start server), (run whatever tests on machine B), vagrant SSH and command to stop server
[2013-08-28 15:35:34 -0400] mirkokiefer: adamjk-dev: :)
[2013-08-28 15:35:42 -0400] mirkokiefer: thats probably the easiest way
[2013-08-28 15:36:02 -0400] adamjk-dev: you are likely going to have to write some wrapper scripts to do some of that manually..... unless you can jimmy vagrant and test-kitchen to do that
[2013-08-28 15:36:15 -0400] adamjk-dev: mirkokiefer: hopefully that helps
[2013-08-28 15:36:41 -0400] mirkokiefer: can you vagrant ssh from one vagrant machine into another?
[2013-08-28 15:37:30 -0400] mirkokiefer: or do I need to setup ssh properly?
[2013-08-28 15:41:00 -0400] prana: has anyone seen omnibus chef (10.26) get stuck in an infinite loop (or something) in GC? It's sitting in a call stack almost 20k frames deep.
[2013-08-28 15:41:13 -0400] fak3r: agoddard: yaya!
[2013-08-28 15:44:13 -0400] adamjk-dev: mirkokiefer: i don't believe you can use vagrant to SSH between machines, but I have not looked into it
[2013-08-28 15:44:22 -0400] adamjk-dev: mirkokiefer: you likely need to set up SSH properly beforehand
[2013-08-28 15:44:36 -0400] mirkokiefer: adamjk-dev: ok thanks
[2013-08-28 15:44:44 -0400] adamjk-dev: mirkokiefer: don't quote me on it though
[2013-08-28 15:44:49 -0400] adamjk-dev: mirkokiefer: np
[2013-08-28 15:45:02 -0400] surge_: jtimberman: Actually, I take that back. On failure, the handler doesn't even get called. http://pastebin.com/p0fpK0zW
[2013-08-28 15:45:35 -0400] surge_: jtimberman: on success, the handler runs, and I see the log text saying it gets called
[2013-08-28 15:45:38 -0400] pontiki: mirkokiefer: i seriously doubt it, since it would depend on the vagrant info being on the box your ssh'ing from
[2013-08-28 15:46:07 -0400] pontiki: and the second vagrant box would need to be running *on* the first vagrant box
[2013-08-28 15:46:38 -0400] gchristensen: vagrant could technically support ultimately spinning up vbox machines on other hosts though :)
[2013-08-28 15:46:50 -0400] slacker: hello all...quick question. Can the chef server and workstation be installed on the same machine?
[2013-08-28 15:53:10 -0400] adnichols: slacker sure
[2013-08-28 15:55:19 -0400] ichilton: If I do: Chef::EncryptedDataBagItem.load("secrets", "dnsimple", Chef::EncryptedDataBagItem::DEFAULT_SECRET_FILE)
[2013-08-28 15:55:46 -0400] ichilton: will that return nil if the databag doesn't exist, the secret file doesn't exist or it's wrong? - or will it throw an exception?
[2013-08-28 15:56:23 -0400] adnichols: ichilton pretty sure it'll throw an exception if it doesn't exist
[2013-08-28 15:56:52 -0400] ichilton: drat - is there a way of handling that gracefully?
[2013-08-28 15:56:58 -0400] adnichols: ichilton you could certainly wrap it in a begin / rescue block
[2013-08-28 15:57:28 -0400] adnichols: Lemme see if there's an example - saw one recently I thought
[2013-08-28 15:57:59 -0400] ichilton: I want it to work on nodes without the databag and/or secret in place
[2013-08-28 15:58:04 -0400] ichilton: eg: vagrant / chef-solo
[2013-08-28 15:58:08 -0400] slacker: adnichols thank you
[2013-08-28 15:58:11 -0400] ichilton: adnichols: thank you
[2013-08-28 15:58:16 -0400] ichilton: haha :)
[2013-08-28 15:58:55 -0400] adnichols: ichilton well the secret & databag have to go together, so if the databag exists you should throw an exception if the secret isn't there because you wont be able to decrypt
[2013-08-28 15:59:50 -0400] adnichols: ichilton you could really easily check for the secret and not even bother w/ the databag if that's not there - but IMO that's going to lead to folks wondering why this node mysteriously doesn't use the databag
[2013-08-28 16:00:33 -0400] adnichols: ah - found example - one sec
[2013-08-28 16:01:01 -0400] adnichols: ichilton https://gist.github.com/adnichols/a9638309e666337b0d60
[2013-08-28 16:01:24 -0400] ichilton: adnichols: either way is actually fine
[2013-08-28 16:01:29 -0400] ichilton: adnichols: i'm handling it like this: https://gist.github.com/ichilton/6367730
[2013-08-28 16:02:00 -0400] adnichols: ichilton is that working if the databag isn't there?
[2013-08-28 16:02:07 -0400] adnichols: I would expect it to toss an exception
[2013-08-28 16:03:09 -0400] ichilton: adnichols: i've not tried it yet :)
[2013-08-28 16:03:17 -0400] adnichols: heh, ok
[2013-08-28 16:03:20 -0400] ichilton: adnichols: that's why I was asking :)
[2013-08-28 16:03:35 -0400] ichilton: adnichols: thanks for the example - i'll switch it around that way
[2013-08-28 16:03:56 -0400] adnichols: yeah, in my example there's a raise because I want it to throw an exception w/ a message - but you can remove that
[2013-08-28 16:04:12 -0400] adnichols: do whatever you want in the rescue to choose the appropriate adventure
[2013-08-28 16:04:21 -0400] ichilton: How can I alert but don't throw an exception?
[2013-08-28 16:04:23 -0400] ichilton: Just puts?
[2013-08-28 16:04:37 -0400] adnichols: I'd use Log
[2013-08-28 16:04:45 -0400] ichilton: adnichols: have an example for that? :)
[2013-08-28 16:04:49 -0400] adnichols: same example
[2013-08-28 16:06:43 -0400] ichilton: adnichols: doh, sorry!
[2013-08-28 16:06:57 -0400] ichilton: adnichols: thanks for that! - gotta dash now but will be trying that out later! :)
[2013-08-28 16:07:06 -0400] adnichols: np - let me know if you have trouble
[2013-08-28 16:07:10 -0400] ichilton: ta
[2013-08-28 16:14:03 -0400] jtgiri_: Hey guys, I remember in Chef conference Disney guys mentioned that they are going to release a cookbook to manage OS patches using chef. I can't seem to find it any where. I wonder if there is a good cookbook already out there  for managing OS patches ?
[2013-08-28 16:23:46 -0400] BryanWB: anyone have an example kitchen.yml using 2 different drivers?
[2013-08-28 16:23:57 -0400] helllen: how could I avoid node creation with knife ?
[2013-08-28 16:24:27 -0400] helllen: if I delete is says it is not authorized but creeta it allows it
[2013-08-28 16:26:11 -0400] nicgrayson: BryanWB: if you find one let me know, i want this too
[2013-08-28 16:26:38 -0400] BryanWB: nicgrayson: k, fnichol told me u could do it, i just can't recall exactly how
[2013-08-28 16:27:17 -0400] BryanWB: nicgrayson: hello btw :)
[2013-08-28 16:27:37 -0400] BryanWB: nicgrayson: and say hi to our mutual friend knuckolls for me :)
[2013-08-28 16:28:42 -0400] awc737: how do you go about having different configs for up after destroy VS halt
[2013-08-28 16:28:54 -0400] awc737: so if it's the first time creating this VM, I want to run install configs
[2013-08-28 16:29:12 -0400] awc737: if its just been halted, I want to run update configs
[2013-08-28 16:32:00 -0400] awc737: I am getting errors like this
[2013-08-28 16:32:04 -0400] awc737: INFO: AptRepository light-weight provider already initialized -- overriding!
[2013-08-28 16:34:23 -0400] awc737: http://paste.laravel.com/MqK
[2013-08-28 16:34:25 -0400] jtimberman: that's not an error :)
[2013-08-28 16:34:33 -0400] jtimberman: it's an informative message.
[2013-08-28 16:34:40 -0400] awc737: jtimberman, it never used to happen until I used berkshelf which I'm not sure I'm using right
[2013-08-28 16:35:02 -0400] surge_: jtimberman: Wow, okay. It should be noted somewhere in the docs that exceptions caught OUTSIDE of chef resources will raise a chef exception and subsequently, pass that onto handlers. Anything else is a ruby error, and won't be caught by chef except in the STDOUT log.
[2013-08-28 16:35:14 -0400] awc737: if the VM has only been suspended, I would rather not check for these things, and just load the state it was in
[2013-08-28 16:35:33 -0400] surge_: jtimberman: I made a quick execute block to remove a non-existent file and finally, the handler works as I want it to.
[2013-08-28 16:35:47 -0400] surge_: caught inside*
[2013-08-28 16:35:58 -0400] surge_: That explains why my
[2013-08-28 16:36:09 -0400] surge_: "asdf" didn't do anything. (accidently hit enter jus now)
[2013-08-28 16:37:02 -0400] awc737: jtimberman, I just vagrant up my VM which does not use berkshelf, none of those errors
[2013-08-28 16:37:36 -0400] maraca: Hey guys, any of you using a cookbook to define their roles rather than using Chef roles?
[2013-08-28 16:38:06 -0400] tabolario: maraca: I've just started doing that, but one role per cookbook generally
[2013-08-28 16:38:23 -0400] maraca: so you don't have one centralized cookbook with all your roles in it then?
[2013-08-28 16:38:38 -0400] maraca: ^ i've basically been doing that, and now i am having the worst time ever :(
[2013-08-28 16:38:52 -0400] tabolario: No, because then if you want to use that for versioning, you wouldn't be able to peg different versions for different role recipes in your environments
[2013-08-28 16:38:54 -0400] maraca: all my attributes are being merged together, and all my nodes have all of my attributes
[2013-08-28 16:39:00 -0400] tabolario: And then there's that
[2013-08-28 16:39:14 -0400] tabolario: I've generally started using my wrapper cookbooks as my roles
[2013-08-28 16:39:21 -0400] surge_: this ^
[2013-08-28 16:39:24 -0400] surge_: wrapper cookbooks ftw
[2013-08-28 16:39:56 -0400] maraca: so - I have a wrapper cookbook, that has 1 recipe, should i add an extra recipe in there and call it "role"
[2013-08-28 16:40:09 -0400] tabolario: You probably don't need to
[2013-08-28 16:40:21 -0400] tabolario: If your wrapper cookbook has a default recipe that you do the wrapping in
[2013-08-28 16:40:27 -0400] tabolario: Just use that recipe as your role
[2013-08-28 16:41:08 -0400] maraca: so all attributes then become default attributes, unless I start using environments
[2013-08-28 16:41:11 -0400] maraca: correct?
[2013-08-28 16:41:41 -0400] tabolario: Yeah, and you can also set attributes from the cookbook your wrapping there as well
[2013-08-28 16:42:20 -0400] maraca: sweet - so what it means though is that instead of having one centralized place where I can edit all my configs, I have to clone the particular repo, and make my change there
[2013-08-28 16:42:36 -0400] tabolario: So as an example, I need to set a node['redis']['config']['requirepass'], my wrapper cookbook does various things to pull that from a data bag of my choosing and set the original attribute
[2013-08-28 16:42:52 -0400] tabolario: You mean the particular repo for your wrapper cookbook?
[2013-08-28 16:42:57 -0400] maraca: yeah
[2013-08-28 16:43:25 -0400] nicgrayson: BryanWB: yeah i figured you could do it. need to test some fog iam roles stuff. yeah it's been a while, i'll tell knuckolls you say hi
[2013-08-28 16:44:09 -0400] maraca: cc tabolario http://realityforge.org/code/2012/11/19/role-cookbooks-and-wrapper-cookbooks.html i think im starting to understand this a bit better
[2013-08-28 16:44:21 -0400] maraca: basically - dump the role cookbook idea, and focus on wrapper cookbooks
[2013-08-28 16:44:35 -0400] awc737: how do I tell vagrant to use the local cookbooks directory instead of ~/.berkshelf/... stuff
[2013-08-28 16:44:57 -0400] awc737: i've used berks install --path
[2013-08-28 16:45:01 -0400] awc737: and that puts them all in /cookbooks
[2013-08-28 16:45:09 -0400] awc737: but I don't believe that tells vagrant to use them on a new instance
[2013-08-28 16:45:54 -0400] dgarstang: any cloud-init power users here?
[2013-08-28 16:46:16 -0400] maraca: dgarstang, ive used it on ec2
[2013-08-28 16:47:50 -0400] nicgrayson: awc737: you probably want to change your berkshelf to point to path: "path/to/local/cookbook"
[2013-08-28 16:48:01 -0400] nicgrayson: awc737: in the Berksfile
[2013-08-28 16:48:59 -0400] awc737: in berks configure
[2013-08-28 16:49:00 -0400] awc737: ?
[2013-08-28 16:51:10 -0400] awc737: nicgrayson, I have never seen a command like this in a Berksfile
[2013-08-28 16:51:19 -0400] awc737: I know vagrantfile has chef.cookbooks_path = "cookbooks"
[2013-08-28 16:51:35 -0400] awc737: but I think berkshelf doc said not to use that with berksfile
[2013-08-28 16:51:54 -0400] dgarstang: maraca: don't suppose you added new users with it or changed the default user did you?
[2013-08-28 16:51:54 -0400] nicgrayson: awc737: the line should look like cookbook 'name', path: "../path/to/name"
[2013-08-28 16:52:08 -0400] maraca: no i do this with chef
[2013-08-28 16:52:22 -0400] maraca: i only use cloud-init to bootstrap my node with chef basically
[2013-08-28 16:52:32 -0400] nicgrayson: awc737: well first off why do you need to load from a different place?
[2013-08-28 16:52:34 -0400] zts: awc737: are you saying you want to disable the berkshelf plugin for a specific vagrantfile?
[2013-08-28 16:52:39 -0400] maraca: it installs the strict minimum and then bootstrap itself
[2013-08-28 16:54:11 -0400] awc737: nicgrayson, i'm saying if I give this to a windows developer for example
[2013-08-28 16:54:24 -0400] awc737: for distribution in general, I want all my cookbooks stored to app/cookbooks
[2013-08-28 16:54:37 -0400] awc737: and I want vagrant loading them from there, not from ~/.berkshelf, which I believe it's doing now
[2013-08-28 16:54:44 -0400] sparr: can a chef client find out what time it is on the chef server?
[2013-08-28 16:55:00 -0400] sparr: without installing additional clients/services
[2013-08-28 16:55:25 -0400] zts: awc737: http://berkshelf.com - search for "config.berkshelf.enabled", set it to false
[2013-08-28 16:55:42 -0400] zts: awc737: although I'm not sure whether that will blow up on a vagrant that doesn't have berkshelf installed
[2013-08-28 16:56:20 -0400] awc737: hmm
[2013-08-28 16:56:30 -0400] cwj: sparr: im not sure how you would accomplish that, but it might be helpful to note that chef api requests are signed with a time stamp (to thwart replay attacks), so one can be relatively certain that server and client clocks are in sync if the chef-client is able to make api requests successfully (e.g. run chef-client)
[2013-08-28 16:56:35 -0400] awc737: i would probably leave it enabled just in case then
[2013-08-28 16:56:57 -0400] awc737: but when a new dev types berks install, there is no sense in having berkshelf download all the cookbooks
[2013-08-28 16:57:02 -0400] sparr: cwj: my client and server clocks are definitely not in sync
[2013-08-28 16:57:05 -0400] awc737: i'd like to just use them from within /cookbooks
[2013-08-28 16:57:20 -0400] sparr: cwj: I'm trying and failing to set the time while using cobbler/kickstart, so I'm thinking of trying to do it with chef
[2013-08-28 16:57:35 -0400] zts: awc737: forgive me being a bit thick, but why would they type berks install at all, if you have shipped a directory containing the cookbooks they should be using?
[2013-08-28 16:58:27 -0400] awc737: well i think i'm being think becuase i don't understand
[2013-08-28 16:58:45 -0400] awc737: but I thought berks install just tied them into vagrant, verified they're there, installed any new ones
[2013-08-28 16:59:07 -0400] awc737: but OK, if they don't do berks install, they just do vagrant up, how does vagrant know where the cookbooks are
[2013-08-28 16:59:49 -0400] zts: awc737: well, first assuming vagrant without the vagrant-berkshelf plugin - it will use the configuration for the appropriate provisioner (chef-solo, chef-client, etc)
[2013-08-28 16:59:51 -0400] cwj: sparr: there is a timezone cookbook on the community site which may help you
[2013-08-28 16:59:59 -0400] zts: awc737: you can either specify the paths, or it has some sensible defaults
[2013-08-28 17:00:11 -0400] awc737: i do have berks plugin
[2013-08-28 17:00:11 -0400] cwj: sparr: but automatically getting the servers timezone, no idea
[2013-08-28 17:00:50 -0400] mattupstate: awc737: BERKSHELF_PATH environment variable
[2013-08-28 17:00:52 -0400] zts: awc737: if your vagrant has the vagrant-berkshelf plugin installed, and you have a Berksfile in the right place, vagrant will call Berkshelf to pull out the correct versions of the required cookbooks and it passes those in
[2013-08-28 17:00:55 -0400] sparr: cwj: not timezone, just time
[2013-08-28 17:00:56 -0400] mattupstate: could always use that
[2013-08-28 17:01:23 -0400] awc737: ok , so berks install --path PLACES the cookbooks in a local directory
[2013-08-28 17:01:44 -0400] mattupstate: BERKSHELF_PATH=PLACES
[2013-08-28 17:01:46 -0400] awc737: but when vagrant calls Berkshelf to pull the correct versions, how do I know it's using the local directory
[2013-08-28 17:01:49 -0400] zts: awc737: yup, and that's roughly what the vagrant-berkshelf plugin is doing behind the scenes (in some temporary directory somewhere)
[2013-08-28 17:02:01 -0400] awc737: where does BERKSHELF_PATH go
[2013-08-28 17:02:35 -0400] awc737: yes BERKSHELF_PATH was exactly what I needed
[2013-08-28 17:02:39 -0400] zts: awc737: it won't be.  Even if you have a "cookbooks" directory, and your Berksfile points to some cookbooks as paths under that directory, they'll still get pulled out, dumped in some temporary location, and that's what is used by Vagrant
[2013-08-28 17:02:59 -0400] mattupstate: https://github.com/RiotGames/vagrant-berkshelf/blob/master/lib/berkshelf/vagrant/config.rb
[2013-08-28 17:03:02 -0400] awc737: then what is the point of having them locally
[2013-08-28 17:03:50 -0400] awc737: can I change BERKSHELF_PATH per project? or is that an environment variable on my machine
[2013-08-28 17:04:14 -0400] awc737: I don't even really want another developer to have to have Berkshelf installed
[2013-08-28 17:04:16 -0400] mattupstate: awc737: thats an env var on your machine that Berkshelf should use over anything else, at least thats what the docs insinuate
[2013-08-28 17:04:18 -0400] zts: I don't think you can directly use the cookbooks in BERKSHELF_PATH anyway, as they have crazy names with versions and SCM hashes in them
[2013-08-28 17:04:25 -0400] awc737: oh ok
[2013-08-28 17:04:32 -0400] mattupstate: awc737: then how do you expect to get the cookbooks installed?
[2013-08-28 17:05:17 -0400] gchristensen: "/opt/chef/embedded/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find chef (>= 0) amongst [bigdecimal-1.1.0, bundler-1.3.5, bundler-unload-1.0.1, io-console-0.3, json-1.5.5, minitest-2.5.1, rake-10.1.0, rake-0.9.2.2, rdoc-3.9.5, rubygems-bundler-1.2.2, rvm-1.11.3.8]" - I'm getting this directly after installing chef on OSX with bundler. Have I misinstalled somehow?
[2013-08-28 17:05:31 -0400] awc737: mattupstate, with chef
[2013-08-28 17:05:31 -0400] awc737: https://gist.github.com/awc737/6368495
[2013-08-28 17:06:08 -0400] mattupstate: sounds complicated ;)
[2013-08-28 17:07:05 -0400] awc737: what
[2013-08-28 17:10:06 -0400] awc737: I think I can just disable the plugin, use berks to manage and install dependencies, and use chef to point to the dir and add_recipes
[2013-08-28 17:10:26 -0400] mattupstate: are you provisioning developer machines?
[2013-08-28 17:10:42 -0400] awc737: yeah
[2013-08-28 17:10:48 -0400] awc737: chef solo
[2013-08-28 17:11:00 -0400] mattupstate: ahh
[2013-08-28 17:11:00 -0400] mattupstate: i see
[2013-08-28 17:11:16 -0400] zts: awc737: for what it's worth, last Vagrant box I built for use by developers, I required them to install the vagrant-berkshelf and haven't had any issues (but on Linux and OS X, not Windows)
[2013-08-28 17:11:26 -0400] dgarstang: Can anyone recommend a good tool for provisioning ec2 boxes? (no, knife-ec2 won't work)
[2013-08-28 17:11:36 -0400] awc737: yeah it probably wouldn't be a problem
[2013-08-28 17:11:42 -0400] awc737: but damn windows users, i don't want to take any chance
[2013-08-28 17:11:54 -0400] zts: awc737: although they also expected to do some work with Chef.  If that wasn't true, creating a frozen set of cookbooks (using berks install) for distribution to the devs seems sane
[2013-08-28 17:12:05 -0400] maraca: cc tabolario if you're still around (or anyone who uses roles-cookbook and wrapper cookbook) - do you include your base role with every single wrapper cookbook? or do you just include role[base] in your actual roles?
[2013-08-28 17:13:12 -0400] awc737: thanks zts i appreciate that advice
[2013-08-28 17:14:50 -0400] zts: awc737: no problem, good luck with it - figuring out the right workflow can be a royal pain
[2013-08-28 17:15:30 -0400] awc737: zts, especially as a developer. all this time spend not developing. wondering when it will pay off lol
[2013-08-28 17:16:13 -0400] tabolario: maraca: i have a myorg-base cookbook
[2013-08-28 17:16:33 -0400] awc737: are most people that configure complex chef and VMs and deployment workflows developers?
[2013-08-28 17:16:35 -0400] tabolario: it sets attributes for and includes a few things like apt, hostname, ssh config, fail2ban, etc.
[2013-08-28 17:16:37 -0400] awc737: or sysadmins?
[2013-08-28 17:17:22 -0400] tabolario: awc737: well if you take my primary skillset (i.e. most experience) it's as a regular rails developer
[2013-08-28 17:17:40 -0400] tabolario: it's only in the last couple years that i decided to transition into more of an ops role
[2013-08-28 17:18:17 -0400] awc737: yeah i guess it's kind of a team leader role
[2013-08-28 17:18:20 -0400] tabolario: now i do all of our ops stuff and consult occasionally on dev things (there's plenty of code to write with the ops stuff :)
[2013-08-28 17:18:37 -0400] tabolario: i'm the leader of an ops team of one :)
[2013-08-28 17:18:42 -0400] awc737: haha oh
[2013-08-28 17:18:53 -0400] awc737: you sure decide a lot of things with these configs
[2013-08-28 17:18:58 -0400] awc737: yeah it seems like a nicer fit for a ruby developer, which I am not
[2013-08-28 17:19:16 -0400] tabolario: gotta consider your infrastructure as an application like everything else :D
[2013-08-28 17:21:21 -0400] dgarstang: Can anyone recommend a good tool for provisioning ec2 boxes? (no, knife-ec2 won't work)
[2013-08-28 17:21:32 -0400] mveitas: dgarstang: what are you looking to do?
[2013-08-28 17:22:34 -0400] dgarstang: mveitas: take the bazillion options that can be passed to ec2_run_instances and put it into a pretty yaml file... and have a tool that takes role, location, env, reads that, and spins it up.
[2013-08-28 17:23:30 -0400] mveitas: dgarstang: I wish there was such a tool. I ended up writing some custom python scripts using boto to do it all.
[2013-08-28 17:24:18 -0400] awc737: anyone know how I could add an a+x to this?
[2013-08-28 17:24:19 -0400] awc737: mode "0755"
[2013-08-28 17:24:57 -0400] pontiki: that would be 0777
[2013-08-28 17:25:03 -0400] awc737: I am in a template resource
[2013-08-28 17:25:35 -0400] awc737: i thought a+x was different
[2013-08-28 17:25:37 -0400] gchristensen: is it possible to have /etc/chef/solo.rb load another file for configuration?
[2013-08-28 17:25:39 -0400] awc737: like it made it executable
[2013-08-28 17:25:57 -0400] bean: awc737: what do you want the end result to be? ALL read,write,execute?
[2013-08-28 17:26:04 -0400] gchristensen: currently its complaining about methods like data_bag_path not existing
[2013-08-28 17:26:09 -0400] awc737: 0755 is fine
[2013-08-28 17:26:16 -0400] awc737: it's a bash script in /usr/bin/local
[2013-08-28 17:26:21 -0400] awc737: so as long as users can execute it from whereever
[2013-08-28 17:26:33 -0400] bean: yeah, 755 would be -rwxr-xr-x
[2013-08-28 17:26:46 -0400] bean: you mean, /usr/local/bin? :O)
[2013-08-28 17:27:10 -0400] awc737: yeah lol
[2013-08-28 17:29:52 -0400] abrkn: how do i fetch a specific branch with deploy_revision? i specified its name as "revision", but "master" is still being pulled
[2013-08-28 17:32:43 -0400] bean: abrkn: looks like there is a "branch" attribute
[2013-08-28 17:32:55 -0400] bean: but, that might just be an alias for revision
[2013-08-28 17:32:56 -0400] bean: hmm
[2013-08-28 17:34:20 -0400] abrkn: so it says
[2013-08-28 17:35:02 -0400] bean: looks like you can use a branch name in there, weird.
[2013-08-28 17:35:33 -0400] abrkn: i may have found a typo
[2013-08-28 17:35:47 -0400] abrkn: (i hope...)
[2013-08-28 17:35:56 -0400] gchristensen: is there a way to tell chef-client to read additional configuration files? ie: I want /etc/chef/client.rb to indicate it should read a second file
[2013-08-28 17:36:26 -0400] abrkn: in addition to what?
[2013-08-28 17:37:26 -0400] gchristensen: I don't understand the question... in addition to the default file it reads?
[2013-08-28 17:38:57 -0400] abrkn: gchristensen: ah, the config read by the node when you read chef-client?
[2013-08-28 17:39:04 -0400] gchristensen: right
[2013-08-28 17:39:17 -0400] abrkn: gchristensen: i was under the impression that you'd do that as part of the role
[2013-08-28 17:39:22 -0400] gchristensen: I want it to load /etc/chef/client.rb (like it does by default) and then also load a second file, which is indicated by the /etc/chef/client.rb file
[2013-08-28 17:39:24 -0400] gchristensen: ahh no
[2013-08-28 17:39:38 -0400] slillibri: gchristensen: I know you can do "Chef::Config.from_file" in a knife.rb, I don't know if it works in the client.rb.
[2013-08-28 17:39:52 -0400] gchristensen: let's see what happens :)
[2013-08-28 17:40:27 -0400] gchristensen: slillibri: not so bad! worked like a charm. thank you for the tip
[2013-08-28 17:40:46 -0400] tabolario: gcjrostemsem what does the second file have in it?
[2013-08-28 17:40:49 -0400] tabolario: wow fail
[2013-08-28 17:40:51 -0400] gchristensen: LOL
[2013-08-28 17:41:18 -0400] gchristensen: tabolario: this is a chef-solo project. I want to run chef-solo with no arguments, so I'm adding a file to /etc/chef/solo.rb which loads my repo's solo.rb
[2013-08-28 17:42:13 -0400] tabolario: gchristensen so your second file would just call the chef config methods as well?
[2013-08-28 17:42:32 -0400] gchristensen: tabolario: I'll provide a complete example, one moment :)
[2013-08-28 17:42:36 -0400] shanlar: is there a way to override chef from doing a restart with Upstart? i want it to always do a stop start.
[2013-08-28 17:43:16 -0400] shanlar: i want it to be a global override so i dont have to specify the service status restart => false on every service block
[2013-08-28 17:43:59 -0400] maraca: tabolario, thanks, makes a lot of sense. you made my day!
[2013-08-28 17:44:24 -0400] tabolario: maraca np :D
[2013-08-28 17:47:28 -0400] gchristensen: tabolario: https://github.com/grahamc/machine/blob/master/install.sh installs chef and places an /etc/chef/solo.rb which loads https://github.com/grahamc/machine/blob/master/config/solo.rb
[2013-08-28 17:49:14 -0400] tabolario: gchristensen that looks sane to me. so you want that to get loaded from client.rb?
[2013-08-28 17:49:30 -0400] gchristensen: yep, and my install.sh creates the file which successfully loads it. it works like a charm now
[2013-08-28 17:49:50 -0400] tabolario: neat, so Chef::Config.from_file worked in client.rb?
[2013-08-28 17:50:53 -0400] gchristensen: in this case solo.rb, but yes same idea. in short I'm tired of janky dotfile repos with terrible installation or update steps... so I'm fixing mine like this.
[2013-08-28 17:51:54 -0400] tabolario: is this kind of a bootstrap for new nodes then?
[2013-08-28 17:52:06 -0400] ryanschwartz: quick question for you file specificity nerds: can I distribute a specific template based on assigned recipe/cookbook/role? Or am I limited to fqdn/platform/platform_version ?
[2013-08-28 17:52:06 -0400] gchristensen: new workstations
[2013-08-28 17:52:50 -0400] tabolario: ahh
[2013-08-28 17:52:56 -0400] mveitas: Question about encrypted data bags we are planning on using encrypted data bags to store credentials for various resources. Do people usually store the unencrypted data in Git?
[2013-08-28 17:53:20 -0400] gchristensen: mveitas: I store the encrypted data in git, and I don't store the secret key in git.
[2013-08-28 17:54:07 -0400] tabolario: how do you keep those synced up with what's on the chef server gchristensen?
[2013-08-28 17:55:00 -0400] gchristensen: this may not be great at all, but my process for editing or creating them is to use knife to edit / create it, and then use knife data bag show with like -l or something enabled, to dump the full values. I can't say this is the best way, just a way.
[2013-08-28 17:55:40 -0400] mveitas: and that is what I am wrestling with in the end you have to "trust" someone with the unencrypted values
[2013-08-28 17:55:53 -0400] tabolario: Ah ok, that was what I figured you'd have to do
[2013-08-28 17:56:26 -0400] tabolario: I wonder if people still do like a private git repo with all their secret stuff
[2013-08-28 17:56:37 -0400] tabolario: Separate from their main chef repo I mean
[2013-08-28 17:56:38 -0400] gchristensen: mveitas: if you can't trust anyone, you should fire your entire team and start fresh
[2013-08-28 17:57:26 -0400] gchristensen: encrypted data bags are so you can not trust your chef-server as far as I understand it, not so you can avoid trusting your team.
[2013-08-28 17:58:19 -0400] awc737: why does using berkshelf give off these warning? but with vagrant/chef I don't have them?
[2013-08-28 17:58:20 -0400] awc737: warning: already initialized constant
[2013-08-28 17:58:24 -0400] awc737: http://paste.laravel.com/Mrq
[2013-08-28 18:12:58 -0400] Vitor_: Hi, I`m using service resource to create jboss service with restart, start and status supports and I have a template with notifies restart command (notifies :restart, resources(:service => "jboss"), :delayed) .. when I run my cookbook first time it work fine ,but when I run other times it dont work.. Any Ideas?
[2013-08-28 18:14:56 -0400] byggztryng: Hello all, is any one aware of a simple method to define a custom Rubygems URL for chef-client to use?
[2013-08-28 18:16:02 -0400] mwildt: Hi, got a quick question. Can the server_url that is specified in the client.rb be an IP address (w port) be used instead of a name ? If so will DNS be used at all or will it still require the chef-server to be known in DNS ?
[2013-08-28 18:16:55 -0400] mwildt: When running a test it appears it is using ip address fine for GET and POST then when it gets to https is uses 'name' and not ip address.
[2013-08-28 18:17:23 -0400] mwildt: If this is clarified in documentation I'm all ears since I haven't found this covered.
[2013-08-28 18:19:43 -0400] shanlar: is there a way to override chef from doing a restart with Upstart? i want it to always do a stop start.
[2013-08-28 18:19:44 -0400] shanlar: i want it to be a global override so i dont have to specify the service status restart => false on every service block
[2013-08-28 18:27:59 -0400] chance: can cookbook libraries include_recipe?
[2013-08-28 18:28:39 -0400] chance: atm my module includes_recipe "python" and it complains that include_recipe is undefined.
[2013-08-28 18:29:16 -0400] mattjalexander: i'm running into "ndefined local variable or method `use_inline_resources' for #<Class:0x000000012d43e8>" errors when i use test kitchen.
[2013-08-28 18:29:32 -0400] mattjalexander: this appears to be because the opscode boxes are using chef 10 instead of chef 11. is there an easy workaround while staying with kitchen?
[2013-08-28 18:29:39 -0400] dysinger: hola.  Is there a way to use chef-client but stop it from refreshing the cookbooks from chef-server first?  Sometimes you just want to tweak something & try again (for tiny things) to see if it works.
[2013-08-28 18:31:18 -0400] mveitas: +dysinger: isn't that what vagrant is for?
[2013-08-28 18:31:34 -0400] dysinger: yes
[2013-08-28 18:32:29 -0400] dysinger: we should only ever have perfect cookbooks on chef server or else 100 harsh cane strikes will be applied to the back of the offender.
[2013-08-28 18:32:56 -0400] dysinger: but sometimes you made a typo or something and it slipped past and you'd like to just confirm that your quick edit fixed the problem
[2013-08-28 18:33:03 -0400] dysinger: super tiny stuff
[2013-08-28 18:33:17 -0400] dysinger: there has to be a way to turn off the /var/chef/cache forced refresh
[2013-08-28 18:34:00 -0400] ianco: dysinger, you could chef-apply the single recipe
[2013-08-28 18:34:26 -0400] dysinger: nice. haven't tried that before
[2013-08-28 18:34:34 -0400] ianco: it sort of rocks
[2013-08-28 18:47:24 -0400] fak3r: ls a-
[2013-08-28 18:47:55 -0400] jmickle: quick question
[2013-08-28 18:48:16 -0400] jmickle: when you guys download files with remote_file that will later be extracted where do you guys typically place your files?
[2013-08-28 18:48:22 -0400] jmickle: just tmp file it then rm it?
[2013-08-28 18:49:54 -0400] aemcknig: jmickle: I was thinking of doing the same thing the other day, and that seemed to be the best option to me.
[2013-08-28 18:50:12 -0400] aemcknig: Disclaimer, though, I'm kind of new to this, so that's not coming from a person who knows how to properly Chef
[2013-08-28 18:50:14 -0400] jmickle: aemcknig: yeah thats what i typically do i just feel like there could be a better way :-P
[2013-08-28 18:50:36 -0400] aemcknig: (relatedly, if anybody knows a bit about lwrps and wants to come help me out in #learnchef I'd appreciate it, haha)
[2013-08-28 18:51:08 -0400] aemcknig: jmickle: I ended up wanting to keep mine around so we could only repull and extract if the file had been updated
[2013-08-28 18:51:39 -0400] jmickle: aemcknig: thats kind of what i want to do
[2013-08-28 18:51:48 -0400] jmickle: but we have etags available on the server
[2013-08-28 18:51:57 -0400] swedish_chef: Is there a best practice path for going from start and stop shell scripts for a piece of software to that software being a Chef service resource?
[2013-08-28 18:52:04 -0400] jmickle: I'm not too sure how the etags are going to work out with this resource as the documentation is a bit limited but
[2013-08-28 18:53:23 -0400] mattjalexander: is there a way to test code coverage of my spec/minitest tests?
[2013-08-28 18:53:35 -0400] mattjalexander: rcov doesn't seem to capture my cookbook
[2013-08-28 18:57:06 -0400] dgarstang: Can anyone recommend a good tool for provisioning ec2 boxes? (no, knife-ec2 won't work)
[2013-08-28 19:01:59 -0400] cwj: dgarstang: did you take a look at aws-cli as i suggested yesterday? its amazons new standard tool for interacting with ec2 and other aws service apis.
[2013-08-28 19:04:05 -0400] siezer: vagrant-aws?
[2013-08-28 19:05:44 -0400] btm: @opscode chef/ohai code review, join: https://plus.google.com/hangouts/_/008a749338bb6a4da6af76ecf81bdc51b496179e, watch: http://youtu.be/OA0yVciaC4M
[2013-08-28 19:05:48 -0400] jmickle: dgarstang: why won't knife ec2 work for you? also how about the option that cwj mentioned?
[2013-08-28 19:05:54 -0400] dgarstang: cwj: must have missed that. I'll take a look
[2013-08-28 19:07:13 -0400] dgarstang: jmickle: cuz.... the -w proxy option doesn't seem to work quite right, it ignores .ssh/config, and ... when sshing in, knife-ec2 fails because ssh isn't up yet and doesn't rety. Suspect that proxy is doing something weird and changing a connection refused to a disconnect (which cause knife-ec2 not to try and reconnect)
[2013-08-28 19:08:39 -0400] dgarstang: cwj: aw jeez it's in JSON
[2013-08-28 19:12:22 -0400] troyready: Time to contribute a python one back to the community? :)
[2013-08-28 19:13:03 -0400] jmickle: python what?
[2013-08-28 19:13:18 -0400] dgarstang: python no cause eyes to bleed?
[2013-08-28 19:13:33 -0400] dgarstang: python no require translation from squiggle speak?
[2013-08-28 19:13:55 -0400] troyready: Just giving a suggestion as to what might make dgarstang happy
[2013-08-28 19:14:33 -0400] mveitas: aws-cli is actually built using python (boto being the scenes)
[2013-08-28 19:14:51 -0400] dgarstang: mveitas: reading... seeing if it will do what we need
[2013-08-28 19:14:56 -0400] jmickle: yeah i mean json is essential
[2013-08-28 19:15:56 -0400] dgarstang: doesn't seem quite right
[2013-08-28 19:15:59 -0400] jmickle: dgarstang: i would take a look into your configuration with knife i don't seem to hit nearly half the same problems you do
[2013-08-28 19:16:00 -0400] jmickle: :-P
[2013-08-28 19:16:34 -0400] dgarstang: jmickle: Are you split across multiple amazon regions that require ssh access through an intermediate host?
[2013-08-28 19:16:41 -0400] jmickle: yep
[2013-08-28 19:17:08 -0400] dgarstang: jmickle: I dunno then. knife-ec2 clearly gives up before the new host is up
[2013-08-28 19:17:38 -0400] jmickle: dgarstang: sounds like some sort of dns issue or something
[2013-08-28 19:17:58 -0400] jmickle: dgarstang: the ssh option will retry for like 5 times i think it is and thats essentially a good like 10 min lol
[2013-08-28 19:18:10 -0400] dgarstang: jmickle: nope. I can ssh into the proxy as the correct user, and then into the new system as the correct user from the same box knife-ec2 fails on
[2013-08-28 19:18:24 -0400] dgarstang: jmickle: it gets a disconnect and immediately aborts
[2013-08-28 19:18:53 -0400] jmickle: dgarstang: are you trying to run this from your laptop to go to intermediate then to the system
[2013-08-28 19:18:59 -0400] dgarstang: jmickle: someone here was saying that made pefect sense. The proxy was translating the connection refused to a disconnect they said.
[2013-08-28 19:19:14 -0400] dgarstang: jmickle: a host in us-west-2 inside a VPC
[2013-08-28 19:20:12 -0400] jmickle: dgarstang: thats exactly what i do all day ;-p never have a problem i mean it makes sense if you are getting some sort of connection issue somewhere
[2013-08-28 19:20:24 -0400] jmickle: dgarstang: but i think you have a problem in your infrastructure and not on the tool
[2013-08-28 19:20:29 -0400] dgarstang: jmickle: but I'm not. the same process works manually
[2013-08-28 19:20:47 -0400] dgarstang: jmickle: if I can do it manually, then the infrastructure by defintion must be ok.
[2013-08-28 19:21:00 -0400] jmickle: dgarstang: i think thats a very broad statement to make :-)
[2013-08-28 19:21:21 -0400] jmickle: thats like saying "if i can ping the server it has to be up"
[2013-08-28 19:21:37 -0400] dgarstang: jmickle: I'd say that
[2013-08-28 19:23:15 -0400] dgarstang: jmickle: http://pastebin.com/MNXPKHn9 .... -> "@kallistec | dgarstang: so, anyway... I think your problem is that knife-ec2 doesn't have a reliable means to detect"
[2013-08-28 19:23:28 -0400] dgarstang: + "the "up-ness" of the remote ssh server through a proxy "
[2013-08-28 19:24:35 -0400] dgarstang: ""dgarstang: right, because the connection to the proxy wasn't refused, so by using a proxy the error moves from the tcp layer to the application layer"
[2013-08-28 19:25:01 -0400] kallistec: dgarstang: the relevant code for your situation is here: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb#L658
[2013-08-28 19:25:20 -0400] dgarstang: kallistec: We chatted about this yesterday. :)
[2013-08-28 19:26:12 -0400] dgarstang: I'm getting a disconnect, not refused
[2013-08-28 19:31:14 -0400] shanlar: how can i reopen a provider class and add to it?
[2013-08-28 19:33:20 -0400] adnichols: shanlar I think this is what you are asking for - this creates a new class that inherits from an existing & then adds to it: https://gist.github.com/peplin/470321
[2013-08-28 19:33:39 -0400] adnichols: If you want to actually add to an existing I'm not sure
[2013-08-28 19:33:57 -0400] shanlar: yea i want to reopen and add to an existing :/
[2013-08-28 19:35:06 -0400] adnichols: shanlar this kinda suggests you would just do it in a similiar way - within a library: http://docs.opscode.com/essentials_cookbook_libraries.html
[2013-08-28 19:35:51 -0400] adnichols: see examples of extending Chef::Recipe
[2013-08-28 19:38:27 -0400] mveitas: any idea why I might be getting an error, "
[2013-08-28 19:38:52 -0400] mveitas: any idea why I might be getting an error "can't convert nil into String" when doing something along this: Chef::EncryptedDataBagItem.load("secrets", node.chef_environment)
[2013-08-28 19:39:25 -0400] mveitas: my only guess is that node.chef_environment is null for some reason
[2013-08-28 19:44:15 -0400] chance: does the chef provisioner for vagrant have any way to find out what synced_folders are set to?
[2013-08-28 19:44:25 -0400] bean: hmm mveitas what chef version are you on?
[2013-08-28 19:44:27 -0400] chance: or will i just have to pass that to the chef.json dict manually
[2013-08-28 19:44:45 -0400] jmkacz: Hi all. What is the recommended workflow to iterate on a cookbook that handles AWS resources, such as an EBS volume?
[2013-08-28 19:45:07 -0400] jmkacz: (aside from uploading your changes to the chef server)
[2013-08-28 19:46:41 -0400] mveitas: bean: turns out I did had the wrong name of the encryption file for the data bags. I realized there was a default and it was never changed on the ec2 instance
[2013-08-28 19:46:46 -0400] bean: :)
[2013-08-28 19:49:46 -0400] kryptek: Does anyone here know if any chef resource supports 'not_if' ?  Can I supply 'not_if' to the 'git' resource, for example?
[2013-08-28 19:51:06 -0400] yfeldblum: kryptek, guards (only_if and not_if) are supported for all resources
[2013-08-28 19:51:24 -0400] yfeldblum: kryptek, including the git resource and all your lightweight resources
[2013-08-28 19:51:38 -0400] kryptek: yfeldblum, Thanks. What is that inherited from?
[2013-08-28 19:51:44 -0400] yfeldblum: kryptek, Chef::Resource
[2013-08-28 19:51:50 -0400] kryptek: Ahh. :P of course hehe
[2013-08-28 19:51:54 -0400] kryptek: Thanks man
[2013-08-28 20:01:38 -0400] fromonesrc: how can I tell chef to run an execute block and continue the run even if an error is encountered during execution?
[2013-08-28 20:02:15 -0400] fromonesrc: tried wrapping in a begin/rescue but it still fails
[2013-08-28 20:02:26 -0400] bean: fromonesrc: ignore_failure true
[2013-08-28 20:02:55 -0400] fromonesrc: bean <3 thank you
[2013-08-28 20:03:18 -0400] bean: np
[2013-08-28 20:03:33 -0400] Vitor_: Hi, I`m using service resource to create jboss service with restart, start and status supports and I have a template with notifies restart command (notifies :restart, resources(:service => "jboss"), :delayed) .. when I run my cookbook first time it work fine ,but when I run other times it dont work.. Any Ideas?
[2013-08-28 20:06:17 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/fe57ff40e5b17d39ad6b4b8aca390a5597a584bb, watch: http://youtu.be/gmZXmKscWR8
[2013-08-28 20:50:41 -0400] Papipo: Hi there
[2013-08-28 20:50:57 -0400] Papipo: how can I have a chef server running in a vagrant box?
[2013-08-28 20:51:14 -0400] Papipo: I would like to provision everything automatically from the Vagrantfile
[2013-08-28 20:51:28 -0400] Papipo: but I don't know how, if I use chef_solo, I get this error:
[2013-08-28 20:51:37 -0400] Papipo: Error executing action `run` on resource 'execute[boostrap-chef-server]'
[2013-08-28 20:57:46 -0400] bean: Papipo: do you have a longer stack trace than that.
[2013-08-28 20:57:53 -0400] bean: there should be more than just "Error executing"
[2013-08-28 20:57:56 -0400] bean: please pastebin :)
[2013-08-28 21:00:22 -0400] Papipo: http://pastebin.com/Cs5SBL3S
[2013-08-28 21:00:33 -0400] Papipo: May it have something to do with the hostname?
[2013-08-28 21:02:15 -0400] mveitas: how often do the cookbook reviews happen? Once a week?
[2013-08-28 21:03:43 -0400] buildscientist: Does anyone know how to retrieve a normal (persisted) attribute that's been set in a recipe/separate chef-run from another recipe/chef-run? I'm getting TypeError exceptions when I try to access the attribute
[2013-08-28 21:04:44 -0400] adnichols: buildscientist if it's persistent and (more importantly) hasn't been overridden by a higher precedence value it should be merged into a node attribute
[2013-08-28 21:05:34 -0400] adnichols: eg. node.set['foo']['bar'] in one run should be accessible as node['foo']['bar']
[2013-08-28 21:05:54 -0400] BriGuy: is there anyway with the subversion resource to compare a file for changes, and only update if different to use notify? From what I have seen it only updates the file every time Chef runs.
[2013-08-28 21:06:54 -0400] buildscientist: adnichols: makes sense - I think I might be accessing it incorrectly - thanks!
[2013-08-28 21:07:01 -0400] adnichols: np
[2013-08-28 21:09:24 -0400] bean: BriGuy: it should be idempotent
[2013-08-28 21:10:43 -0400] bean: Papipo: https://tickets.opscode.com/browse/CHEF-4273?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel should be related
[2013-08-28 21:12:12 -0400] alexheneveld: jtimberman: thanks for your answer on stackexchange.  but it doesn't quite make sense.
[2013-08-28 21:12:36 -0400] alexheneveld: i do the grep for postgresql when the service is not running, and nothing shows up (apart from my grep which presumably it is smart enough to filter out!)
[2013-08-28 21:13:01 -0400] alexheneveld: but chef thinks wrongly that it is running
[2013-08-28 21:13:10 -0400] alexheneveld: (this is using the stock postgres cookbook fwiw)
[2013-08-28 21:16:19 -0400] BriGuy: bean: What is the best way then to have a subversion sourced file get updated and restart a  then?
[2013-08-28 21:16:38 -0400] bean: in general, it shouldn't notify if nothing is updated.
[2013-08-28 21:18:58 -0400] BriGuy: so the force_export action would actually run a diff and only update if different?
[2013-08-28 21:26:23 -0400] ghatak: quit
[2013-08-28 21:34:40 -0400] pkboyz: does anyone know where i can get an example on windows_task
[2013-08-28 21:34:58 -0400] awc737: is it possible to have one set of recipes for initial install, and another set for resume?
[2013-08-28 21:35:10 -0400] awc737: like if I didn't destroy my container, I don't want to run all this crap again
[2013-08-28 21:35:13 -0400] alexheneveld: jtimberman: yt? updated question on service :status at http://serverfault.com/questions/534498/how-to-ensure-a-service-is-running-using-chef
[2013-08-28 21:35:30 -0400] adnichols: awc737 There is a pattern for creating 'run once' recipes
[2013-08-28 21:35:56 -0400] adnichols: awc737 http://docs.opscode.com/essentials_cookbook_resources_first_run.html
[2013-08-28 21:35:57 -0400] awc737: ok nice
[2013-08-28 21:36:15 -0400] adnichols: heed the warning at the top but otherwise...
[2013-08-28 21:36:47 -0400] adnichols: ideally they aren't really necessary - but there are some exceptions
[2013-08-28 21:37:06 -0400] awc737: hmm
[2013-08-28 21:37:07 -0400] adnichols: if you are just trying to avoid chef doing the same thing it does on the first run - it shouldn't if the recipes are correctly written
[2013-08-28 21:37:10 -0400] awc737: it just takes a long time to spin up this server
[2013-08-28 21:37:22 -0400] adnichols: awc737 yeah, this isn't gonna avoid that
[2013-08-28 21:37:23 -0400] awc737: and this is just a development server so fast would be nice
[2013-08-28 21:37:45 -0400] awc737: well the part where it gets here: [default] VM booted and ready for use!
[2013-08-28 21:37:45 -0400] adnichols: awc737 you could use a bootstrap method that starts with some base image that's already been provisioned once to speed it up
[2013-08-28 21:37:46 -0400] awc737: is very fast
[2013-08-28 21:38:45 -0400] adnichols: awc737 we do that in vagrant - keep a box around that's already been provisioned - but that can be more effort to maintain and is troublesome if you want to remove stuff
[2013-08-28 21:39:00 -0400] awc737: i believe if I do halt, it's still provisioned correct?
[2013-08-28 21:39:14 -0400] adnichols: awc737 what are we talking about ? vagrant?
[2013-08-28 21:39:20 -0400] awc737: yeah
[2013-08-28 21:39:32 -0400] adnichols: awc737 yes, a halt will keep all the changes chef has already made
[2013-08-28 21:39:42 -0400] awc737: i feel like if it was just suspended, chef shouldn't really need to do anything on vagrant up
[2013-08-28 21:39:46 -0400] awc737: if it's just halted i mean
[2013-08-28 21:39:51 -0400] benjohnson77: can I ask a possibly silly question in here about a chef recipe
[2013-08-28 21:39:54 -0400] awc737: let the developer just keep developing
[2013-08-28 21:40:02 -0400] adnichols: awc737 it'll still check to see if there are necessary changes - but it's faster
[2013-08-28 21:40:06 -0400] awc737: yeah
[2013-08-28 21:40:25 -0400] awc737: that would be really cool if there was a flag for do not check
[2013-08-28 21:40:35 -0400] adnichols: awc737 that's what we do - provision it once after we make some changes & then create a new basebox using the provisioned version
[2013-08-28 21:40:40 -0400] awc737: vagrant up --no-check
[2013-08-28 21:40:44 -0400] adnichols: cuts the initial setup
[2013-08-28 21:40:52 -0400] awc737: oh i see
[2013-08-28 21:40:53 -0400] adnichols: well you could very easily add a conditional to the vagrantfile
[2013-08-28 21:41:01 -0400] adnichols: use an env variable or something
[2013-08-28 21:41:05 -0400] benjohnson77: i have some bash for installing passenger_enterprise as a gem and then letting the gem install nginx
[2013-08-28 21:41:06 -0400] benjohnson77: rvmsudo passenger-install-nginx-module --auto-download --auto --prefix=/opt/nginx/
[2013-08-28 21:41:13 -0400] awc737: adnichols, create a conditional and completely skip the chef block? that's not a bad idea
[2013-08-28 21:41:18 -0400] adnichols: awc737 yes
[2013-08-28 21:41:41 -0400] benjohnson77: but I have tried execute and bash and I can't get the recipe to work like the manual approach
[2013-08-28 21:45:52 -0400] BriGuy: bean: I just tested it and the force_export for the subversion resource runs notify every time
[2013-08-28 21:46:29 -0400] bean: BriGuy: I don't use the subversion resource, personally, I was just referring to the fact that most default resources are idempotent
[2013-08-28 21:47:55 -0400] BriGuy: bean: Got you - any recommendation on how to pull a file from subversion and do something when different - without using a temp file for comparison?
[2013-08-28 21:48:51 -0400] jameson__: how could I suggest topics for the community summit?
[2013-08-28 21:49:00 -0400] jameson__: s/could/can/g
[2013-08-28 21:59:08 -0400] Sony_: hi
[2013-08-28 21:59:14 -0400] Sony_: undefined method `include_recipe' for Chef::Resource::RubyBlock any idea why this is happening
[2013-08-28 22:03:13 -0400] bean: Sony_: because you're doing an include_recipe in a ruby block?
[2013-08-28 22:08:58 -0400] jmickle: whats the chef provider for log
[2013-08-28 22:09:01 -0400] jmickle: chef::log.info?
[2013-08-28 22:09:33 -0400] cwj: jmickle: or log foo
[2013-08-28 22:09:37 -0400] jmickle: ty
[2013-08-28 22:09:51 -0400] jmickle: i can never remember those for some readon
[2013-08-28 22:09:56 -0400] cwj: http://docs.opscode.com/resource_log.html
[2013-08-28 22:10:06 -0400] jmickle: ty
[2013-08-28 22:10:12 -0400] cwj: \m/
[2013-08-28 22:21:44 -0400] rrrob: hi all
[2013-08-28 22:32:45 -0400] Sony_: undefined method `include_recipe' for Chef::Resource::RubyBlock any idea why this is happening
[2013-08-28 22:33:26 -0400] Sony_: how to fix this error ?//
[2013-08-28 22:36:51 -0400] sn0wb1rd: Sony_: Yes, you cannot include_recipe inside a rubyblock
[2013-08-28 22:40:28 -0400] rrrob: is there a way to get the path to the current cookbook in a recipe? I'm trying to include a number of script files with the cookbook and run them. Only I found so far is to use the file resource to copy them to somewhere on the filesystem and execute them from new location but it gets tedious when you have a bunch of scripts to copy over
[2013-08-28 22:45:41 -0400] buildscientist: rrrob: how about putting your scripts in the files/ directory with the cookbook and using the cookbook_file resource to copy them?
[2013-08-28 22:46:43 -0400] rrrob: buildsci: yeah that is what i am doing now, i meant I use cookbook_file to copy them
[2013-08-28 22:47:32 -0400] rrrob: i have about 20 files though, we will convert the script to recipes later but for now we are just trying to run them from a recipe
[2013-08-28 22:51:27 -0400] buildscientist: rrrob: I'm not 100% sure - but you should be able to wrap the cookbook_file resource in a loop - iterate over a list of the scripts
[2013-08-28 22:53:35 -0400] rrrob: buildsci: ok just checking if I missed something obvious, thx
[2013-08-28 22:57:13 -0400] buildscientist: rrrob: Try this - https://gist.github.com/buildscientist/6372430
[2013-08-28 22:57:34 -0400] buildscientist: rrrob: Should work - I haven't actually tried to run it though
[2013-08-28 22:59:16 -0400] rrrob: builldsci: thanks for the code, saves me the time to look up the ruby code for it :)
[2013-08-28 22:59:27 -0400] buildscientist: rrrob: np :)
[2013-08-28 23:28:18 -0400] ichilton: Can a node be in multiple environments? - everything seems to talk about environment, singular...
[2013-08-28 23:31:51 -0400] siezer: just one environment
[2013-08-28 23:34:04 -0400] ichilton: ah, ok - thanks
[2013-08-28 23:35:30 -0400] rrrob: do people usually use one chef server for both dev, test and prod or separate ones for each environment?
[2013-08-28 23:42:19 -0400] buildscientist: rrrob: depends on your requirements - you can use one chef server for those environments or you could buy private chef and have separate organizations each with their own set of environments
[2013-08-28 23:55:06 -0400] rrrob: buildsci: private chef would be nice, but unfortunately not up to me
