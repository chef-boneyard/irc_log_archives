[2013-08-05 02:02:04 -0400] stormerider: question beam.smp, what chef component does that map to? erchef?
[2013-08-05 02:16:10 -0400] stormerider: also, im trying to split chef-server components across two nodes and getting errors when I run chef-server-reconfigure on the node that I just want to run chef-solr any thoughts? https://gist.github.com/stormerider/5656de72d29385249fcd
[2013-08-05 05:53:39 -0400] ssd7: stormerider: Sorry of the late reply, but beam.smp is the VM that erlang code runs on.  Think of it as the JVM of the erlang world.  In Chef 11 any erlang component (erchef, rabbitmq, etc) will show up as beam.smp in the process list.
[2013-08-05 05:53:59 -0400] ssd7: You can look at the full command line of the process to see what a particular beam process corresponds to
[2013-08-05 07:18:52 -0400] stormerider: ssd7: thanks.
[2013-08-05 07:19:03 -0400] stormerider: ssd7: any thoughts on my next question?
[2013-08-05 07:41:47 -0400] linuxboy: hi
[2013-08-05 07:41:54 -0400] linuxboy: how do I convert my ruby environment files into json?
[2013-08-05 08:06:18 -0400] stormerider: linuxboy: easiest way is to upload and redownload them via knife environment show -Fj <env> > <env>.json
[2013-08-05 08:08:17 -0400] linuxboy: shot
[2013-08-05 08:28:37 -0400] paul--: Anyone able to help in regards to why this no_if statement isn't actually being triggered? https://gist.github.com/digitaldawn/5986bd793a2543a4302c
[2013-08-05 08:30:07 -0400] paul--: Ah, can I only have one command statement per execute? (When chef ran, it only created br-ex)
[2013-08-05 08:31:49 -0400] paul--: Yep, that was the issue
[2013-08-05 11:28:10 -0400] m4rcu5: i ahve a couple of cookbokos in a role, which include the apt cookbook, now i also apply this role to a freebsd machine for example, and the apt cookbook tries to run. Why? it has a supports statement in the cookbook, and that does not include freebsd
[2013-08-05 11:52:02 -0400] zts: m4rcu5: 'supports' is only used on the community site, and doesn't actually affect what chef-solo/chef-client do
[2013-08-05 11:52:46 -0400] zts: I'm sure the wiki made that clear, but the entry on the docs site certainly doesn't :(
[2013-08-05 11:53:24 -0400] m4rcu5: zts: thats a real shame. can you recommend a way to have a somewhat base role, with cookboos which might be platform specific?
[2013-08-05 11:53:50 -0400] m4rcu5: zts:  the docs aint clear on that, it really defines it as a supported platform restriction, not only an indicator
[2013-08-05 11:56:13 -0400] zts: m4rcu5: you could achieve it with a "role cookbook" - list the platform specific cookbooks in its metadata.rb as "depends", then have a recipe that uses "include_recipe" to load the appropriate one for the platform
[2013-08-05 11:56:23 -0400] zts: m4rcu5: I'm not sure of a more elegant way than that, unfortunately
[2013-08-05 11:57:43 -0400] m4rcu5: zts: i have this feeling that roles are getting more and more outdated at the moment everyone switches to role-cookbooks
[2013-08-05 12:00:37 -0400] zts: m4rcu5: yeah.  I think roles have a bunch of deficiencies, and I don't like role-cookbooks as the solution - but there doesn't seem to be any interest in improving roles, so I guess the trend will continue
[2013-08-05 12:02:08 -0400] d4m: G'morning, looking for some help with a single client upgrade to v11 that no longer wants to run the knife ec2 sub command.
[2013-08-05 12:03:42 -0400] d4m: It is getting the ec2 commands werre moved to plugins in Chef 0.10 error.  The knife-ec2 gem is installed to the system gems.  It looks like something where v11 has its own embedded ruby of v1.9.1 and the system is 1.8.7 and thus cannot locate the knife gem on the system.  Re-install has not helped.
[2013-08-05 12:05:09 -0400] m4rcu5: zts: thanks, im afraid that we will also need to defer to role-cookbooks, as out roles get more and more complex, and we would also like to use searches in the roles
[2013-08-05 12:06:18 -0400] d4m: This bug CHEF-2483 seems related but we are well past that version.  System is running chef 11.6.0-1.ubuntu.10.04 (from install.sh), knife-ec2 (0.6.4) gem, and chef (11.4.0) gem on maverick.
[2013-08-05 12:06:39 -0400] m4rcu5: im now just really struggeling to get chef and freebsd to go along, for example you cant active the service at boot, because thats all written in the massive rc.conf file no cookbook has support for that
[2013-08-05 12:16:07 -0400] zts: d4m: if you've installed chef using the omnibus installer, it does indeed ship its own ruby
[2013-08-05 12:16:20 -0400] zts: d4m: to install a gem into that ruby, use /opt/chef/embedded/bin/gem
[2013-08-05 12:16:36 -0400] d4m: zts: ah, perfect, thank you.  is that documented somewhere i missed?
[2013-08-05 12:18:39 -0400] zts: d4m: I'm not sure - one would hope so, but perhaps not.  If you can't see it mentioned on whichever documentation seemed appropriate, please do report the oversight
[2013-08-05 12:18:54 -0400] zts: if that's on docs.opscode.com, I believe the right place to report it is https://github.com/opscode/chef-docs/issues
[2013-08-05 12:18:54 -0400] d4m: zts: will do.  thank you.
[2013-08-05 12:19:03 -0400] zts: (where I've just created an issue to report that the site itself should link to that)
[2013-08-05 13:22:41 -0400] aramus_: Hello! Let's I have two recipes, one that prints out an attribute and one that changes an attribute. If I change the attribute using .normal, will it stay the same on continuous chef runs?
[2013-08-05 13:24:05 -0400] rb2k: any idea what's blowing up over here: https://gist.github.com/rb2k/e5e0d197ff44b1e704dc/raw/6a5a2e8d82cfc021e453f0dd6d988c4f00a0d0d1/gistfile1.txt ?
[2013-08-05 13:24:16 -0400] rb2k: seems like the application_ruby cookbook is broken O_o
[2013-08-05 13:27:33 -0400] adamjk-dev: anyone have issues using a Chef 11 server and Vagrant ?
[2013-08-05 13:27:47 -0400] adamjk-dev: since the chef server port changed etc. (no longer :4000)
[2013-08-05 13:28:50 -0400] adamjk-dev: Error connecting to https://chef-11-server/clients - getaddrinfo: Name or service not known
[2013-08-05 14:01:24 -0400] m4rcu5: adamjk-dev: can you ping chef-11-server from the client?
[2013-08-05 14:04:18 -0400] adamjk-dev: m4rcu5: I had to add a new domain to the base box file's /etc/resolv.conf
[2013-08-05 14:04:41 -0400] adamjk-dev: m4rcu5: had to add "search <new domain>" to the resolv.conf file on our internal box file
[2013-08-05 14:04:50 -0400] adamjk-dev: m4rcu5: which I am not sure is the best thing to do
[2013-08-05 14:08:09 -0400] m4rcu5: adamjk-dev: you can also cahnge the fqdn of your chef box to something that is resolveble
[2013-08-05 14:08:47 -0400] adamjk-dev: m4rcu5: I initially just made it "chef-11-server"  (with no domain on the end)
[2013-08-05 14:09:02 -0400] adamjk-dev: m4rcu5: perhaps I should have made it "chef-11-server.<domain>" ?
[2013-08-05 14:17:09 -0400] m4rcu5: adamjk-dev: if you can resolve chef-server.domain, yep
[2013-08-05 14:27:14 -0400] adamjk-dev: m4rcu5: thanks for the help... I will take it up some other folks here I guess
[2013-08-05 14:31:19 -0400] jtimberman: FYI about the wiki/tickets sites, posted yesterday: http://www.opscode.com/blog/2013/08/04/public-wiki-and-tickets-update/
[2013-08-05 14:49:51 -0400] rricard: Hi everyone, I'm trying to use application_nodejs(https://github.com/conradev/application_nodejs) into my cookbook, like many other application_* cookbooks, I end up with the following error "uninitialized constant Chef::Resource::ApplicationBase" I already googled that, and I already tried to add the application cookbook in both my Berksfile and my metadata.rb file  Note : I'm using Vagrant and Berkshelf for now  Here's the stacktrace:
[2013-08-05 14:49:51 -0400] rricard: https://gist.github.com/rricard/6156464 Thanks anyway !
[2013-08-05 14:56:58 -0400] rricard: Ok, found it ...
[2013-08-05 14:57:33 -0400] rricard: Just freeze the application version to 2.0.4
[2013-08-05 14:58:18 -0400] ralphie: hey guys. what is the best way in your experience to control permissions of a directories content with chef?
[2013-08-05 14:58:47 -0400] ralphie: is there any decent way with a resource (eg. dir) or does it need an execute?
[2013-08-05 15:02:33 -0400] bean: usually you'd do a "directory" and "cookbook_file" or "template" or w/e resource, ralphie
[2013-08-05 15:03:22 -0400] ralphie: yeah but how about you need to ensure file permissions of files which may get created by a service and not by chef itself?
[2013-08-05 15:03:50 -0400] jalateras: I have a question on the opscode nginx cookbook
[2013-08-05 15:04:13 -0400] bean: ralphie: i'd just use an execute in that case then
[2013-08-05 15:04:38 -0400] jalateras: i am trying to override some of the default attributes so that i can build from source but when i run it against chef solo it doesn't seem to be picking it up
[2013-08-05 15:05:14 -0400] kallistec: ralphie: after the fact? you could do `Dir["/path/to/files/*"].each do |path|; file path do; #permissions; end ;end
[2013-08-05 15:05:36 -0400] kallistec: but there's gonna be a window where they're wrong, of course
[2013-08-05 15:05:41 -0400] jalateras: it still does a package install using v 1.2.6
[2013-08-05 15:07:42 -0400] ralphie: okay, well I do an execute with a chmod now, thanks kallistec, but looks there is no chef resource capable of managing that?
[2013-08-05 15:09:20 -0400] kallistec: ralphie: nothing built-in. The file resource can manage permissions only when you ignore the `content` attribute, so you can use the code I posted to glob for files and then manage their permissions
[2013-08-05 15:09:30 -0400] d```: ralphie: you might be able to use the file resource and add an "only_if" statement to check that the file exists
[2013-08-05 15:46:43 -0400] suffix_: does it make sense to have a seperate git repo for each cookbook?
[2013-08-05 15:47:18 -0400] d```: suffix_: that's how we're managing it at our office, but I'm not sure if it's a best practice
[2013-08-05 15:47:32 -0400] suffix_: ok
[2013-08-05 15:48:59 -0400] eherot: same here
[2013-08-05 15:49:11 -0400] eherot: although i'm starting to think that also necessitates having a separate github account for the cookbooks
[2013-08-05 15:51:07 -0400] yfeldblum: suffix_, yes, for those cookbooks which you wish to manage separately - i.e., with their own versions, releases, etc.
[2013-08-05 15:52:00 -0400] eherot: suffix_: yeah it allows you to tag the repo with the current cookbook version which is like mandatory for sanity with Berkshelf (imho)
[2013-08-05 15:55:38 -0400] tabolario: eherot: yeah that's my issue :/
[2013-08-05 15:55:54 -0400] tabolario: i'd like to have separate repos for each of our site cookbooks
[2013-08-05 15:56:13 -0400] tabolario: right now it's not cost-effective for us to have that many private repos on GH though
[2013-08-05 15:56:20 -0400] tabolario: been thinking of an alternative just for cookbooks
[2013-08-05 15:56:21 -0400] eherot: tabolario: open source 'em!
[2013-08-05 15:56:24 -0400] tabolario: hehe
[2013-08-05 15:56:35 -0400] eherot: (that's why my bosses all told me to do when cost came up)
[2013-08-05 15:56:38 -0400] joelnn: tabolario: bitbucket? :)
[2013-08-05 15:56:40 -0400] tabolario: half of them i could but i would be embarrassed to
[2013-08-05 15:56:46 -0400] tabolario: joelnn: that was one of my alternatives :)
[2013-08-05 15:56:47 -0400] eherot: yeah I said that too
[2013-08-05 15:57:14 -0400] joelnn: don't be embarrassed, there is the high likelihood that no one will find the repos anyway :)
[2013-08-05 15:57:28 -0400] eherot: but then someone made the argument that it causes you to be more disciplined (and also if anything you wrote is really useful to someone, they'll probably rewrite it for you) ;-)
[2013-08-05 15:57:32 -0400] joelnn: or if they do, they will be grateful for an example that is related to what they want anyway
[2013-08-05 15:57:44 -0400] tabolario: we have enough private cookbooks for our apps though that it would still present a problem for the ones we need to keep private
[2013-08-05 15:58:06 -0400] tabolario: unless i rolled all those into one...
[2013-08-05 15:58:07 -0400] yfeldblum: tabolario, https://bitbucket.org/plans and http://www.codebasehq.com/packages
[2013-08-05 15:58:34 -0400] yfeldblum: tabolario, there is actually git hosting out there that isn't github :D
[2013-08-05 15:58:37 -0400] tabolario: thanks yfeldblum :) that $10 plan with bitbucket would certainly be doable
[2013-08-05 15:58:46 -0400] eherot: yfeldblum: lies!
[2013-08-05 15:59:04 -0400] eherot: :-)
[2013-08-05 15:59:05 -0400] tabolario: i would just prefer GH because we use it for all the GH stuff too
[2013-08-05 15:59:28 -0400] tabolario: i have a ton of tiny cookbooks though i could open source that simply install a libxxxxx package
[2013-08-05 15:59:34 -0400] yfeldblum: tabolario, there are a number of git hosting services which offer unlimited repositories for a flat price
[2013-08-05 15:59:45 -0400] cobby: Dang  wiki is still offline..  Does anyone remember how to bootstrap a server and have it place the encrypted_data_bag_secret file in /etc/chef?  I believe it is an attribute, but I do not rememver.
[2013-08-05 15:59:46 -0400] eherot: I feel like Github is kind of at its most useful when you *are* collaborating with the rest of the open source community, though...
[2013-08-05 15:59:51 -0400] d```: we have stash
[2013-08-05 15:59:56 -0400] d```: it's THE WORST
[2013-08-05 16:00:08 -0400] stormerider: so i was trying to set up a second server just to handle the chef-solr load, but ran into a problem running chef-server-ctl reconfigure https://gist.github.com/stormerider/5656de72d29385249fcd -- any thoughts?
[2013-08-05 16:00:10 -0400] eherot: cobby: You just have to mention it in yoru knife.rb
[2013-08-05 16:00:11 -0400] tabolario: we have a heavy pull request workflow for our stuff on GH
[2013-08-05 16:00:26 -0400] stormerider: d```: what's bad about stash vs say bitbucket hosted?
[2013-08-05 16:00:44 -0400] cobby: @eherot Its in there but never gets place in /etc/chef
[2013-08-05 16:00:45 -0400] stormerider: we're looking at migrating to it in the near future, potentially
[2013-08-05 16:00:47 -0400] eherot: cobby: e.g. encrypted_data_bag_secret "#{ENV['HOME']}/.chef/encrypted_data_bag_secret"
[2013-08-05 16:00:48 -0400] tabolario: and as i'm trying to institute a culture where it's more than just myself writing/contributing to our cookbooks, i want to try to keep with that :)
[2013-08-05 16:00:53 -0400] yfeldblum: tabolario, i don't think i would find a cookbook that installs a libxxxx package terribly useful; i could simply write a one-liner in another cookbook that needs libxxxx in most cases, right?
[2013-08-05 16:01:02 -0400] eherot: cobby: that's done by the default template unless you're using some other template...
[2013-08-05 16:01:37 -0400] tabolario: yfeldblum: well take libxml2/libxslt1 for example, both are dependencies for nokogiri to install, and i have two application cookbooks whose apps have nokogiri in the gemfile
[2013-08-05 16:02:03 -0400] cobby: @eherot default template for chef-client?  Because I have "encrypted_data_bag_secret = "path_to_edbs"
[2013-08-05 16:02:10 -0400] cobby: in my knife.rb
[2013-08-05 16:02:14 -0400] eherot: yfeldblum: A lot of the "one liners" I've written have ended up growing sub-requirements after a year of use, so I'm often inclined to do separate cookbooks "when in doubt."
[2013-08-05 16:02:30 -0400] tabolario: for those i find it nice in the applicationname/default recipe to include_recipe libxml2::dev and libxslt1::dev recipes
[2013-08-05 16:02:39 -0400] eherot: cobby: it's actually knife that sort of "owns" the templates
[2013-08-05 16:02:49 -0400] eherot: as they're in the knife/bootstrap subdirectory of the chef gem
[2013-08-05 16:02:58 -0400] fishGoM00: tabolario : Host github for yourself : )   http://gitlab.org/
[2013-08-05 16:03:36 -0400] tabolario: gitlab does look neat
[2013-08-05 16:03:58 -0400] tabolario: i used to work at a place that used gitorious a few years ago
[2013-08-05 16:04:15 -0400] eherot: do any of these tools let you fork (and pull request) actual Github repos in a sort of seamless way?
[2013-08-05 16:04:47 -0400] yfeldblum: tabolario, demand that they upgrade their nokogiri deps to 1.6.0+
[2013-08-05 16:06:28 -0400] yfeldblum: tabolario, nokogiri-1.6.0+ ships with the sources of, and builds its own private copies at gem-install time of, libxml2 and libxslt1
[2013-08-05 16:06:35 -0400] cobby: @eherot Still wondering why it doesn't put the encrypted_data_bag_secret file in the right place.
[2013-08-05 16:06:41 -0400] tabolario: yfeldblum ah i was not aware of that
[2013-08-05 16:06:47 -0400] yfeldblum: tabolario, https://github.com/sparklemotion/nokogiri/blob/master/CHANGELOG.rdoc#160rc1--2013-04-14
[2013-08-05 16:33:01 -0400] eherot: cobby: do you have anything in your knife config directing it to use a different bootstrap template besides "chef-full?"
[2013-08-05 16:34:00 -0400] cobby: @eherot I have nothing in here other than the default
[2013-08-05 16:34:23 -0400] qhartman: Just noticed that the current docs for the remote_file resource don't include the checksum attribute, but it's still used in the examples. Is this a doc bug, or is the checksum attr implied somehow?
[2013-08-05 16:39:19 -0400] eherot: cobby: Are you sure that the encrypted data bag secret is actually findable by "knife bootstrap" using the path you've given it?
[2013-08-05 16:39:50 -0400] cobby:  /etc/chef/encrypted_data_bag_secret
[2013-08-05 16:39:58 -0400] cobby: That is where I have it on my box
[2013-08-05 16:48:34 -0400] stormerider: aruntomar: i bootstrapped my windows boxes manually, sorry
[2013-08-05 16:52:15 -0400] aruntomar: stormerider: k
[2013-08-05 17:03:11 -0400] lledet: Hi, I set the owner of a directory to www-data then mounted a filesystem to it and now it's owned by root, how can I make sure it's owned by www-data?
[2013-08-05 17:04:12 -0400] stormerider: lledet: perms for a mounted directory and the original mount point are stored differently
[2013-08-05 17:04:33 -0400] stormerider: however a second chef run should reset the perms to www-data
[2013-08-05 17:05:51 -0400] lledet: Ah, it did change it on a second run, is there a way to make that unnecessary?
[2013-08-05 17:06:42 -0400] stormerider: change it so you mount the directory first.
[2013-08-05 17:09:08 -0400] lledet: the mount point doesn't exist yet, i guess i have to create it first, mount, then set owner
[2013-08-05 17:10:45 -0400] lledet: thanks for your help
[2013-08-05 17:20:47 -0400] dgarstang: *sigh* come on... fix google knife. I needs it.
[2013-08-05 17:21:08 -0400] jve: using the application_python cookbook (which internally uses deploy_revision), and i'm trying to get previous_release_path in the after_restart callback, but i'm getting an error "No resource found for previous_release_path"...any ideas what i'm doing wrong?
[2013-08-05 17:21:21 -0400] bean: you mean "knife google", dgarstang
[2013-08-05 17:21:32 -0400] dgarstang: bean: yeah, that
[2013-08-05 17:22:36 -0400] troyready: dgarstang, We use the knife-vsphere plugin, and when I encountered a problem with it, I forked it and made a pull request to fix my issue
[2013-08-05 17:22:47 -0400] troyready: Perhaps you could try the same and see if you could contribute back to the project?
[2013-08-05 17:23:12 -0400] dgarstang: troyready: it's ruby... really hurts my eyes.
[2013-08-05 17:23:38 -0400] bean: you're not going to get much help saying stuff like that, dgarstang
[2013-08-05 17:23:47 -0400] bean: a lot of people here are rubyists, through and through.
[2013-08-05 17:23:55 -0400] stormerider: bean: he's been doing that for a while
[2013-08-05 17:23:59 -0400] bean: oh i know
[2013-08-05 17:24:04 -0400] dgarstang: bean: I'm serious. I just can't stand to look at it.
[2013-08-05 17:24:11 -0400] pontiki: so is he
[2013-08-05 17:24:16 -0400] pontiki: SO ARE WE
[2013-08-05 17:24:17 -0400] bean: you sound way too opinionated for your own good.
[2013-08-05 17:24:24 -0400] bean: ruby is delightful
[2013-08-05 17:24:41 -0400] bean: I don't understand what would cause "my eyes to hurt"
[2013-08-05 17:24:42 -0400] dgarstang: bean: troyready said I should contribute back. I said I don't like ruby. Sorry, why are we still discussing this?
[2013-08-05 17:24:46 -0400] stormerider: dgarstang: then uninstall chef and move on, or shut up, IMO.
[2013-08-05 17:24:56 -0400] dgarstang: stormerider: troyready said I should contribute back. I said I don't like ruby. Sorry, why are we still discussing this?
[2013-08-05 17:25:13 -0400] pontiki: because you keep asking
[2013-08-05 17:25:20 -0400] dgarstang: pontiki: asking what?
[2013-08-05 17:25:21 -0400] bean: because you're shit talking the language that chef is written in
[2013-08-05 17:25:26 -0400] bean: and you keep asking about knife google
[2013-08-05 17:25:27 -0400] pontiki: why we're still discussing it
[2013-08-05 17:25:28 -0400] troyready: Because trying to use a config management system and complaining about its DSL every day is ridiculous
[2013-08-05 17:25:29 -0400] stormerider: because this is the Nth time you've been irritating about your personal predjudices
[2013-08-05 17:25:31 -0400] bean: which no one here knows about.
[2013-08-05 17:25:38 -0400] geggam: you guys are feeding the troll
[2013-08-05 17:25:57 -0400] pontiki: s'truth
[2013-08-05 17:26:09 -0400] bean: I'm just wondering whats so bad about ruby, lol
[2013-08-05 17:26:18 -0400] dgarstang: Well I'm confused. Someone suggested I contribute ruby code. I said I don't like ruby and now I'm getting attacked. Nice.
[2013-08-05 17:26:20 -0400] pontiki: oh, well, you know
[2013-08-05 17:26:33 -0400] pontiki: some ppl don't like dots
[2013-08-05 17:26:41 -0400] dgarstang: bean: I'm not going to answer that. it's fuel for the attacks to continue.
[2013-08-05 17:26:41 -0400] geggam: you were attacked because you wanted attention dgarstang
[2013-08-05 17:26:48 -0400] bean: ^
[2013-08-05 17:26:50 -0400] geggam: and you continue to ask for it
[2013-08-05 17:26:55 -0400] zts: dgarstang: for what it's worth, I don't think you have to have to contribute a fix
[2013-08-05 17:26:57 -0400] dgarstang: geggam: No, I was attacked because I said I didn't like ruby
[2013-08-05 17:26:58 -0400] stormerider: eh, screw it, welcome to my ignore list.
[2013-08-05 17:27:02 -0400] geggam: lets all take a minute out of our day to feed dgarstang's ego
[2013-08-05 17:27:07 -0400] bean: ^
[2013-08-05 17:27:11 -0400] geggam: because he needs a trophy
[2013-08-05 17:27:20 -0400] dgarstang: geggam: I don't like ruby. Sorry, which bit of that don't you understand?
[2013-08-05 17:27:25 -0400] zts: dgarstang: however your comment did sound pretty entitled - if you want to pay Opscode (or some other consultant) to do the work, that's cool.  Moaning in a community support channel usually doesn't win any friends though
[2013-08-05 17:27:35 -0400] bean: ^+1
[2013-08-05 17:27:46 -0400] dgarstang: zts: I didn't moan. I said I didn't like ruby. That was where I ended it.
[2013-08-05 17:28:01 -0400] zts: dgarstang: 17:29:04 dgarstang *sigh* come on... fix google knife. I needs it.
[2013-08-05 17:28:29 -0400] dgarstang: zts: That was before ruby came up, and before I ended it
[2013-08-05 17:28:56 -0400] zts: dgarstang: indeed.  Like I said, I don't think you have to contribute a fix, and I don't think you have to like ruby.
[2013-08-05 17:29:32 -0400] dgarstang: zts: sure, I don't have to... someone has to fix it though, and unfortunately it won't be me. :(
[2013-08-05 17:30:19 -0400] bean: "someone has to fix it"... someone will fix it when they find the same problem as you, or maybe they wont. It doesn't sound like a highly used knife pkugin
[2013-08-05 17:30:30 -0400] bean: plugin*
[2013-08-05 17:30:32 -0400] dgarstang: bean: Google is fixing it
[2013-08-05 17:30:46 -0400] bean: then why bitch in here, since you're just waiting for it at this point?
[2013-08-05 17:31:00 -0400] dgarstang: bean: why does anyone say anything in here?
[2013-08-05 17:31:04 -0400] troyready: I would agree with what you're saying zts, but I don't see how that can jive with with dgarstang is looking for in light of his use of the community supported version of Chef & the (lack of) popularity of that plugin
[2013-08-05 17:31:22 -0400] bean: most people are looking for help, not a place to gripe about things that are supposedly in progress.
[2013-08-05 17:31:52 -0400] dgarstang: bean: I will check everything I say before I press the enter key in future.
[2013-08-05 17:32:07 -0400] troyready: lol, dgarstang
[2013-08-05 17:32:23 -0400] dgarstang: Seems that's what people want.
[2013-08-05 17:32:40 -0400] troyready: you're just about at the final support vampire step. Did you read that blog post?
[2013-08-05 17:32:41 -0400] bean: most people would like you to not bitch about something that is supposedly already being fixed, yes.
[2013-08-05 17:32:44 -0400] bean: thats for true.
[2013-08-05 17:32:44 -0400] zts: troyready: in those shoes, I personally tend to first swallow my language preferences and try to do it myself, followed by finding out who to sweet talk to make a fix happen faster
[2013-08-05 17:33:07 -0400] bean: ^
[2013-08-05 17:33:12 -0400] dgarstang: and now comes the judgement phrase.
[2013-08-05 17:33:12 -0400] troyready: zts, I thought we would agree :)
[2013-08-05 17:33:15 -0400] zts: troyready:)
[2013-08-05 17:33:20 -0400] dgarstang: s/phrase/phase/
[2013-08-05 17:34:00 -0400] dgarstang: zts: already took a good look at the code. No idea what was going on.
[2013-08-05 17:34:06 -0400] troyready: dgarstang, I'm just (honestly) curious if you recall what the last step is, because I'm curious if you took the time to read the post as was suggested?
[2013-08-05 17:34:43 -0400] zts: dgarstang: yeah, I feel for you on that one.  Sweet-talking and offering bribes are all I can suggest on that one.  If I had ever used the google cloud stuff, I'd offer myself up as a potential recipient of either :)
[2013-08-05 17:36:14 -0400] troyready: dgarstang, point being not to "judge" you, but hopefully to give you some enlightenment. If you can recognize the bad behavior (which all of us have; none is perfect), you can change and be a valuable member of the community
[2013-08-05 17:37:16 -0400] dgarstang: troyready: you mean say I like ruby.
[2013-08-05 17:37:51 -0400] troyready: Now I think you're just doing it intentionally, and I'll just smile in response
[2013-08-05 17:39:20 -0400] tubbo: well currently i am porting chef to erlang
[2013-08-05 17:39:29 -0400] tubbo: because i hate myself
[2013-08-05 17:40:58 -0400] dgarstang: tubbo: ohoh... your in trouble.
[2013-08-05 17:41:17 -0400] tubbo: haha
[2013-08-05 17:41:57 -0400] tubbo: dgarstang: what languages do you enjoy to write in?
[2013-08-05 17:42:15 -0400] dgarstang: tubbo: python
[2013-08-05 17:42:28 -0400] tubbo: hmm, interesting
[2013-08-05 17:42:35 -0400] tubbo: i was expecting something more...not like ruby :P
[2013-08-05 17:42:59 -0400] dgarstang: tubbo: python is like ruby?
[2013-08-05 17:43:06 -0400] tubbo: dgarstang: are you kidding?
[2013-08-05 17:43:07 -0400] tubbo: lol
[2013-08-05 17:43:13 -0400] dgarstang: tubbo: not at all.
[2013-08-05 17:43:19 -0400] tubbo: ruby was directly influenced by python iirc
[2013-08-05 17:43:34 -0400] tubbo: it was like "hey python's got a great idea but it's ugly as sin, let's make it more pretty but less explicit"
[2013-08-05 17:43:39 -0400] joelnn: can you point out similar language features?
[2013-08-05 17:43:40 -0400] dgarstang: tubbo: I would have thought it was more influenced by Perl.
[2013-08-05 17:43:43 -0400] tubbo: "oh also lisp is cool let's add s-expressions"
[2013-08-05 17:43:49 -0400] tubbo: it was. so was python.
[2013-08-05 17:43:59 -0400] EricL: rubbish: Ruby was HEAVILY influenced by Perl.  Matz gives a talk on how he looked up to Larry Wall.
[2013-08-05 17:44:00 -0400] dgarstang: tubbo: jeez, they failed on the pretty part.
[2013-08-05 17:44:09 -0400] joelnn: imo python and ruby are very much different
[2013-08-05 17:44:12 -0400] dgarstang: ha, knew it.
[2013-08-05 17:44:24 -0400] tubbo: EricL: i showed a video of larry wall to a non-programmer friend. he was like "why are you watching this pedophile talk about nerd stuff?" :P
[2013-08-05 17:44:25 -0400] dgarstang: That explains a lot.
[2013-08-05 17:44:35 -0400] joelnn: does anyone not look up to Larry Wall?
[2013-08-05 17:44:54 -0400] tubbo: dgarstang: it's an opinion, but personally i find the syntax of ruby to be very similar to the syntax of python
[2013-08-05 17:44:56 -0400] EricL: He does look like a bit off.  But aren't all geniuses a bit off?
[2013-08-05 17:45:13 -0400] stormerider: maddog doesnt :)
[2013-08-05 17:45:16 -0400] tubbo: so much so that i can write python. i primarily write in ruby but i can still understand, read and write python. i've even submitted code to python projects.
[2013-08-05 17:45:27 -0400] tubbo: EricL: absolutely. it's just funny. :)
[2013-08-05 17:45:30 -0400] tabolario: soo watched that foodfight cast on secret data in chef, interesting stuff
[2013-08-05 17:45:32 -0400] stormerider: neither does Cohen
[2013-08-05 17:45:35 -0400] zts: It did make me sad (some years ago) that the new crop of ops tools were all being built in Ruby.  But I compared puppet to bcfg2, and bcfg2 was way too keen on XML
[2013-08-05 17:45:38 -0400] tabolario: curious to know how you folks are doing it
[2013-08-05 17:45:44 -0400] tubbo: zts: is puppet built with ruby?
[2013-08-05 17:45:49 -0400] tabolario: i pretty much exclusively use encrypted data bags myself
[2013-08-05 17:45:51 -0400] stormerider: tubbo: yes
[2013-08-05 17:45:51 -0400] tubbo: for some reason i always thought that was python
[2013-08-05 17:45:53 -0400] tubbo: oh wow
[2013-08-05 17:46:02 -0400] zts: I'm less of a python guy these days, though I guess I'd look at ansible/salt/whatever-the-python-one-is if I started over today
[2013-08-05 17:46:16 -0400] stormerider: tubbo: but it's more abstracted, more pseudocode than pure ruby
[2013-08-05 17:46:20 -0400] dgarstang: tubbo: I can't get past the {, | and the object.loop notation. Reading ruby is like translating from German to English in my head because that's so not the way I think.
[2013-08-05 17:46:25 -0400] EricL: My company is Ruby/Python/Node.js/Go/Ember/Rails
[2013-08-05 17:46:32 -0400] EricL: So yea, there's that.
[2013-08-05 17:46:48 -0400] tubbo: stormerider: right, the actual writing of recipes has its own syntax.
[2013-08-05 17:46:49 -0400] stormerider: my company is whatever-the-fuck-gets-the-job-done-best :)
[2013-08-05 17:46:51 -0400] tabolario: +1 Ember :)
[2013-08-05 17:47:11 -0400] stormerider: best being subjective due to employee knowhow, etc.
[2013-08-05 17:47:14 -0400] EricL: tabolario: We have an Ember commiter on staff.  It makes things really easy.
[2013-08-05 17:47:14 -0400] tubbo: that's why i enjoy Chef honestly, because you know it's *just* Ruby, so if you know Ruby, you know Chef.
[2013-08-05 17:47:19 -0400] tabolario: I really need to take a weekend for Go
[2013-08-05 17:47:26 -0400] tabolario: EricL Ah I bet
[2013-08-05 17:47:31 -0400] tubbo: EricL: just made this ember app :) http://choongang.herokuapp.com/
[2013-08-05 17:47:34 -0400] tabolario: EricL You aren't in the DC area by chance?
[2013-08-05 17:47:50 -0400] tubbo: if you're on the CoffeeScript and Haml bandwagon you *have* to check out http://emberscript.com and http://emblemjs.com
[2013-08-05 17:47:54 -0400] tubbo: best way to write a web app evar
[2013-08-05 17:47:55 -0400] EricL: tabolario: NYC
[2013-08-05 17:48:18 -0400] tabolario: EricL Ah ok, was going to ask if you had anything to do with the new meetup group here if you were :)
[2013-08-05 17:48:30 -0400] EricL: tabolario: We host the NYC meetup group.
[2013-08-05 17:48:36 -0400] EricL: One of the hosts anyway.
[2013-08-05 17:48:48 -0400] tabolario: What are you using Go for?
[2013-08-05 17:49:05 -0400] EricL: tabolario: NSQ and statsd.
[2013-08-05 17:49:17 -0400] tabolario: Oh using go-batsd?
[2013-08-05 17:49:41 -0400] EricL: tabolario: Nope, some custom rolled stuff that Bitly did that happens to work well for us.
[2013-08-05 17:50:03 -0400] tabolario: Setting up graphite/statsd is on my agenda for the next couple weeks
[2013-08-05 17:50:30 -0400] EricL: tabolario: https://github.com/bitly/statsdaemon/blob/master/statsdaemon.go
[2013-08-05 17:50:53 -0400] EricL: tabolario: It will make setting up statsd a shiteload easier using this one file than every other cookbook out there which requires installing node.
[2013-08-05 17:52:27 -0400] tabolario: EricL Oh I bet, that's one reason I had been considering go-batsd actually
[2013-08-05 17:53:23 -0400] EricL: tubbo: We use it very heavily and have quite a bit of Ember code running in production.
[2013-08-05 17:53:29 -0400] EricL: n
[2013-08-05 17:54:13 -0400] tubbo: EricL: sweet! who do you work for?
[2013-08-05 17:54:13 -0400] tabolario: Our newest prod app is using Ember for all the frontend stuff
[2013-08-05 17:54:24 -0400] EricL: rubbish:  SimpleReach
[2013-08-05 17:54:26 -0400] tabolario: Our frontend guy loves it
[2013-08-05 17:54:54 -0400] EricL: I actually sent our frontend team to EmberCamp with Tom and Yehuda to get a bit better at it and one of them ended up fixing some core bugs.
[2013-08-05 17:57:09 -0400] tubbo: that's cool
[2013-08-05 18:08:41 -0400] cubed: anyone getting a "ERROR: TypeError: can't convert Symbol into Integer" when they try to upload the snmp cookbook to a chef server?
[2013-08-05 18:19:55 -0400] MrBIOS: hi folks, I'm trying to follow http://www.opscode.com/blog/2013/03/12/5106/ ( "Turn it to 11: Upgrading From Chef 10" ) and running into some issues there surrounding knife-essentials
[2013-08-05 18:20:14 -0400] jkeiser: What issues are you having?
[2013-08-05 18:20:14 -0400] MrBIOS: back in May, someone named tomschlick had the same problem: http://community.opscode.com/chat/chef/2013-05-01
[2013-08-05 18:20:55 -0400] MrBIOS: after installing knife-essentials, I'm getting "/var/lib/gems/1.8/gems/chef-11.6.0/lib/chef/knife/delete.rb:5: superclass mismatch for class Delete (TypeError)" when running any knife command
[2013-08-05 18:21:29 -0400] jkeiser: You can safely uninstall knife-essentials with 11.6; that will fix your issue.  We merged the commands
[2013-08-05 18:21:39 -0400] jkeiser: It's curious that that is happening though, I'll investigate
[2013-08-05 18:22:01 -0400] jkeiser: i.e. knife upload and knife download in 11.6 do everything you need them to do
[2013-08-05 18:22:22 -0400] jkeiser: MrBIOS: what version of Ruby are you running?
[2013-08-05 18:22:38 -0400] MrBIOS: 1.8.7
[2013-08-05 18:22:42 -0400] MrBIOS: it's what comes with Ubuntu 12.04 LTS
[2013-08-05 18:23:28 -0400] jkeiser: Thanks.  Give "gem uninstall knife-essentials" a shot and I'll look into it.  It could be we have a loading order issue on 1.8.7
[2013-08-05 18:24:19 -0400] MrBIOS: that works, but I'm trying to follow a chef server migration step-by-step guide and I haven't found one which doesn't need knife-essentials
[2013-08-05 18:24:35 -0400] jkeiser: MrBIOS: knife-essentials is part of Chef
[2013-08-05 18:24:53 -0400] jkeiser: MrBIOS: it's just by installing the gem, you get a more recent version (since I update that more often than Chef updates)
[2013-08-05 18:24:59 -0400] MrBIOS: I see
[2013-08-05 18:25:17 -0400] jkeiser: MrBIOS: the reason the guide says to install it is at the time, you needed the advanced version to do versioned_cookbooks true
[2013-08-05 18:25:27 -0400] jkeiser: MrBIOS: but we've merged that as of Chef 11.6, so you should be safe
[2013-08-05 18:25:31 -0400] MrBIOS: ah, ok
[2013-08-05 18:25:47 -0400] MrBIOS: Thanks. do you have the ability to update the docs to reflect that?
[2013-08-05 18:26:06 -0400] jkeiser: I should, thanks
[2013-08-05 18:27:13 -0400] MrBIOS: also, it seems as if those docs are missing a step or two (but this might just be my own ignorance)
[2013-08-05 18:27:56 -0400] MrBIOS: it says "In the same ~/transfer directory, create a file named .chef/knife.rb"
[2013-08-05 18:28:12 -0400] MrBIOS: but later on, I don't see the knife command explicitly calling that alternative knife.rb config file
[2013-08-05 18:28:41 -0400] MrBIOS: so I can't possibly see how what it's asking me to be put there should be read/expected to work
[2013-08-05 18:36:34 -0400] MrBIOS: hm
[2013-08-05 18:36:57 -0400] MrBIOS: "ERROR: knife encountered an unexpected error. This may be a bug in the 'download' knife command or plugin"
[2013-08-05 18:37:16 -0400] MrBIOS: Looks like "Exception: NameError: uninitialized constant Chef::ChefFS::Parallelizer::Mutex"
[2013-08-05 18:37:41 -0400] MrBIOS: is Ruby 1.8.7 just not supported in conjunction with Chef 11.6?
[2013-08-05 18:37:46 -0400] freerobby: I'm using  Chef 11.4.4 and have found that knife bootstrap is not properly setting the environment when given the -E flag. Has anybody else seen this?
[2013-08-05 18:40:40 -0400] stormerider: MrBIOS: ruby 1.8 isn't supported. use omnibus.
[2013-08-05 18:41:10 -0400] stormerider: MrBIOS: and knife automatically looks for .chef/knife.rb, no need to specify it
[2013-08-05 18:42:38 -0400] MrBIOS: @stormerider thanks, will do
[2013-08-05 18:42:42 -0400] MrBIOS: I had it installed previously
[2013-08-05 18:43:04 -0400] MrBIOS: okay, installed
[2013-08-05 18:44:06 -0400] MrBIOS: would certainly be nice if chef told you that when running it under Ruby 1.8
[2013-08-05 18:44:21 -0400] MrBIOS: instead of barfing in a way that is completely uninformative
[2013-08-05 18:44:50 -0400] stormerider: it's a long standing discussion, but the end result at this point is: always use omnibus.
[2013-08-05 18:45:08 -0400] MrBIOS: yeah, understood
[2013-08-05 18:45:20 -0400] MrBIOS: still, programmers make shitty product people
[2013-08-05 18:45:30 -0400] MrBIOS: was: re: user experience
[2013-08-05 18:46:11 -0400] stormerider: i think they're considering ways to avoid uploading to rubygems as long as they can continue to build the packages without it. but gem installs are problematic and not just for 1.8 reasons.
[2013-08-05 18:46:29 -0400] gazarsgo: MrBIOS: that path leads to opscode offering chef as an appliance or a service  if you want to manage your own install you'll have to rely on reading the docs and interpreting them correctly
[2013-08-05 18:46:56 -0400] stormerider: bear in mind, omnibus setups are pretty new (or at least promotion of them is)
[2013-08-05 18:47:10 -0400] MrBIOS: well, in this instance, I *did* start with the omnibus installer, but then switched because I was encountering a bug with the knife-essentials gem in conjunction with the omnibus installer
[2013-08-05 18:49:07 -0400] MrBIOS: I totally hear what you're saying, but that doesn't mean you should get a get-out-of-jail-free card when it comes to easily-avoidable crappy user experience
[2013-08-05 19:02:02 -0400] jve: i'm trying to access some ruby attributes from inside a deploy_revision callback (after_restart)...how can i do that?
[2013-08-05 19:02:09 -0400] btm: still no open source code review today, expecting to be back on Wednesday.
[2013-08-05 19:05:58 -0400] stormerider: btm: is tickets/wiki still down, or are they back up now?
[2013-08-05 19:12:03 -0400] magoo: hopefully I'm not violating any rules here but I'm trying to find a talented sysops guy in the bay area and I don't have much experience with recruiting. Any advice for finding good talent?
[2013-08-05 19:12:22 -0400] adamjk-dev: any advice on which version of test-kitchen to be using?
[2013-08-05 19:12:30 -0400] adamjk-dev: still stick to 1.0.0.alpha?
[2013-08-05 19:13:31 -0400] ssd7: stormerider: still down, but they should be up near 1pm today
[2013-08-05 19:13:42 -0400] ssd7: (US Pacific time)
[2013-08-05 19:17:46 -0400] mattray: magoo: there's a LinkedIn group, that might be a better venue
[2013-08-05 19:18:55 -0400] stormerider: btm: thanks.
[2013-08-05 19:19:01 -0400] magoo: good thought... can anyone just post a job req on those groups?
[2013-08-05 19:19:55 -0400] tabolario: magoo: also try your local user groups :)
[2013-08-05 19:32:28 -0400] Sauraus: Anyone have experience with the 'jetty' cookbook on RHEL?
[2013-08-05 19:46:54 -0400] magoo: damn, it's $400 to post a job req on linkedin!
[2013-08-05 19:52:18 -0400] freerobby: We're using Rackspace, who doesn't make machines aware of their own public IP addresses. Is there any way to have Chef query this (something other than ohai, perhaps), so that we can use knife ssh with the -a attribute?
[2013-08-05 19:54:01 -0400] gchristensen: freerobby: 1) you might be able to use openstack's API for it, 2) you could make an ohai plugin which calls icanhazip.com or something :P
[2013-08-05 19:54:32 -0400] freerobby: gchristensen: Thanks. Do you mean to query openstack during the knife ssh, or to do it on deploy and then save it as a node attribute somewhere?
[2013-08-05 19:54:54 -0400] gchristensen: make an ohai attribute, so it gets populated on the chef run.
[2013-08-05 19:55:25 -0400] gchristensen: and then if the IP changes, it auto-updates. also: rackspace changes my IPs from under me sometimes, so this has been a life saver. (Where is this box? chef says its here. Yep, its there.)
[2013-08-05 19:55:26 -0400] freerobby: gchristensen: Thanks, I will look into that.
[2013-08-05 19:55:43 -0400] freerobby: gchristensen: Cool, so you just wrote an ohia plugin I take it then?
[2013-08-05 19:56:11 -0400] gchristensen: I did, but I tragically can't release it.
[2013-08-05 19:56:24 -0400] freerobby: gchristensen: Ha, no worries - wasn't hinting, was just curious which route you took.
[2013-08-05 19:56:31 -0400] freerobby: haha, yeah....
[2013-08-05 19:57:12 -0400] gchristensen: freerobby: we have a similar service like icanhazip.com which we use for that purpose, it isn't elegant but it gets the trick done, and we don't have to trust the author of icanhazip.com
[2013-08-05 20:03:08 -0400] jroberts235: I have a problem on my production chef server (10.16.2).  Solr stop running over the weekend due to a change in perms on the /var/log/chef and /var/run/chef dirs.  I fixed the issues and restarted sold and expander.  I tested with a knife search, it worked. But now,  cookbooks that rely on data bags and search are failing with errors related to empty arrays, "undefined method `[]' for nil:NilClass" .  I noticed that the expande
[2013-08-05 20:03:09 -0400] jroberts235: logs are empty.  A quick search lead me to believe that rabbitmq was somehow borked, so I restarted it. But it had no effect.  Does anyone have any guidance they can offer?
[2013-08-05 20:11:16 -0400] mattupstate: where can i put a file during a chef-client run that will be removed at the end of the run?
[2013-08-05 20:17:16 -0400] geggam: is there another tool similar to crowbar that works for chef ?
[2013-08-05 20:18:15 -0400] freerobby: gchristensen: Do you by chance know the easiest way to distribute an ohai plugin? Frustratingly all the opscode docs on it are down because of the security outage, eg wiki.opscode.com/display/ChefCN/Distributing+Ohai+Plugins
[2013-08-05 20:18:27 -0400] gchristensen: freerobby: sure - make a recipe :) one sec.
[2013-08-05 20:18:54 -0400] freerobby: just make the plugin a template and have it written to /chef/ohai_dir?
[2013-08-05 20:19:32 -0400] gchristensen: freerobby: https://gist.github.com/grahamc/5d3129ca4cea0d7b04f7 - this is all my plugin does. those chef-client and ohai cookbooks do the rest.
[2013-08-05 20:19:58 -0400] gchristensen: and then I make my NAMEOFPLUGIN available at files/default/plugins/NAMEOFPLUGIN.rb
[2013-08-05 20:20:33 -0400] freerobby: oh wow
[2013-08-05 20:20:47 -0400] gchristensen: yup
[2013-08-05 20:20:52 -0400] freerobby: gchristensen: thanks a bunch
[2013-08-05 20:21:05 -0400] gchristensen: surely, read the docs for those cookbooks, though
[2013-08-05 20:21:10 -0400] gchristensen: there might be things I'm forgetting
[2013-08-05 20:21:22 -0400] freerobby: will do, but i appreciate it.
[2013-08-05 20:22:09 -0400] gchristensen: freerobby: also, the nginx cookbook drops an ohai plugn - be sure to check that out.
[2013-08-05 20:25:25 -0400] freerobby: gchristensen: ah, thanks. we use that already
[2013-08-05 20:26:25 -0400] gchristensen: cool
[2013-08-05 20:33:29 -0400] mattupstate: anyone know where I can create a temp file that will be removed at the end of a chef-client run?
[2013-08-05 20:34:26 -0400] coderanger: mattupstate: ruby_block + ruby's tempdir lib?
[2013-08-05 20:34:47 -0400] coderanger: Hmm, no
[2013-08-05 20:34:59 -0400] mattupstate: is there a folder that chef-client will clean up after a run?
[2013-08-05 20:35:07 -0400] coderanger: You could make an LWRP using tempdir and have it send a delayed notification to remove it
[2013-08-05 20:35:13 -0400] mattupstate: i notice sometimes in the logs that it removes stuff if not needed
[2013-08-05 20:35:15 -0400] coderanger: thats the closest I can think of though
[2013-08-05 20:35:34 -0400] coderanger: mattupstate: No, it idempotently prunes the cookbook data cache, but thats it
[2013-08-05 20:35:38 -0400] mattupstate: ah, gotcha
[2013-08-05 20:35:42 -0400] mattupstate: thanks
[2013-08-05 20:35:51 -0400] coderanger: There is the run_state hash which is cleared on every run
[2013-08-05 20:35:54 -0400] coderanger: but thats not a file
[2013-08-05 20:38:13 -0400] kisoku: coderanger: inside a LWRP. Does 'not_if { ::File.exist? new_resource.path_to_file }' do what I expect ?
[2013-08-05 20:38:34 -0400] coderanger: Not sure what you mean, like inside a provider definition?
[2013-08-05 20:38:40 -0400] kisoku: yes
[2013-08-05 20:38:49 -0400] kisoku: the block gets executed at converge time
[2013-08-05 20:38:57 -0400] kisoku: but is new_resource in scope  ?
[2013-08-05 20:39:24 -0400] kisoku: or does that get interpreted to what I want at "compile" time
[2013-08-05 20:39:51 -0400] coderanger: Ahh right, that issue
[2013-08-05 20:39:55 -0400] kisoku: :-)
[2013-08-05 20:39:57 -0400] kisoku: tricky
[2013-08-05 20:40:17 -0400] coderanger: So right inside the "action :whatever do" block, add "new_resource = new_resource"
[2013-08-05 20:40:21 -0400] coderanger: and it will all JFW
[2013-08-05 20:40:38 -0400] kisoku: lol wut
[2013-08-05 20:40:45 -0400] kisoku: yeah I get it
[2013-08-05 20:40:56 -0400] coderanger: I really need to write up a blog post on this like I did about arrays
[2013-08-05 20:41:00 -0400] kisoku: forcing a reference ?
[2013-08-05 20:41:06 -0400] coderanger: method lookup vs. local variable
[2013-08-05 20:41:16 -0400] coderanger: local vars use lexical scoping and it all works correctly
[2013-08-05 20:41:28 -0400] coderanger: methods check the block context, which is usually wrong
[2013-08-05 20:41:31 -0400] kisoku: yeah, otherwise new_resource falls out of scope and doesn't get kept
[2013-08-05 20:41:40 -0400] kisoku: that will leak memory though no ?
[2013-08-05 20:41:49 -0400] coderanger: No, its just a normal local variable
[2013-08-05 20:42:00 -0400] coderanger: after the block finishes it vanishes
[2013-08-05 20:42:11 -0400] coderanger: but you are left with closure state pointing to the right places
[2013-08-05 20:42:25 -0400] coderanger: The fix is probably to make it "action :foo do |new_resource|"
[2013-08-05 20:42:36 -0400] coderanger: but I need to talk to kallistec about that
[2013-08-05 20:46:15 -0400] kisoku: so. I think it might already do the right thing on chef 11
[2013-08-05 20:46:21 -0400] kisoku: because my TK is not barfing
[2013-08-05 20:46:43 -0400] kisoku: not sure chef 10.26.0 is going to like it
[2013-08-05 20:46:53 -0400] kisoku: unfortunately I don't have 11 everywhere yet
[2013-08-05 21:06:06 -0400] kallistec: coderanger: you mean like: file "something" do |file_resouce|; file_resource.owner("bob")
[2013-08-05 21:06:33 -0400] CharlieSu: Has anyone using the user cookbook ever encountered an issue where a service takes the next available uid which causes issues when you try to add a new user ?
[2013-08-05 21:09:12 -0400] yfeldblum: CharlieSu, http://linux.die.net/man/8/useradd for the flag --system
[2013-08-05 21:09:55 -0400] yfeldblum: CharlieSu, are you trying to add users with uids in the range reserved for system user uids?
[2013-08-05 21:10:26 -0400] CharlieSu: yfeldblum: cookbooks I was  pulling in were doing it..
[2013-08-05 21:11:12 -0400] yfeldblum: CharlieSu, cookbooks for managing users? or cookbooks for configuring services?
[2013-08-05 21:11:57 -0400] CharlieSu: yfeldblum: cookbooks for configuring services w/ service users...
[2013-08-05 21:12:27 -0400] yfeldblum: CharlieSu, but you're separately "try[ing] to add a new user"?
[2013-08-05 21:12:55 -0400] coderanger: kallistec: No, I mean the literal #action thing from Provider::LWRPBase
[2013-08-05 21:13:30 -0400] CharlieSu: yfeldblum: correct..  system users were created..  services and service users were created..  then at a later time new users were added to the users databag w/ the next UID available, but chef wouldn't run successfully because the services created users in the wrong range...
[2013-08-05 21:14:06 -0400] coderanger: kallistec: Should be a pretty minor change and is backwards compatible since Ruby just ignore arguments like that
[2013-08-05 21:14:19 -0400] kallistec: coderanger: hrm, then I don't get it. new_resource is already available as an attr_accessor?
[2013-08-05 21:14:36 -0400] coderanger: kallistec: It is, and thats not helpful because it doesn't follow lexical scoping rules
[2013-08-05 21:15:06 -0400] kallistec: coderanger: when you define resources inside the action?
[2013-08-05 21:15:10 -0400] coderanger: kallistec: So if you use #new_resource in a nested resource, or a not_if/only_if block in a nested resource, Ruby gets confused
[2013-08-05 21:15:15 -0400] yfeldblum: coderanger, this is ruby, not haskell; lwrp actions are already an abuse of `def action_create` already
[2013-08-05 21:15:50 -0400] coderanger: kallistec: file 'asdf' do owner new_resource.owner end, you can get the wrong resource
[2013-08-05 21:16:48 -0400] coderanger: kallistec: A block arg would follow lexical scoping and closure rules :)
[2013-08-05 21:16:58 -0400] yfeldblum: coderanger, so `r = new_resource ; file 'asdf' do ; owner r.owner ; end`?
[2013-08-05 21:17:11 -0400] coderanger: yfeldblum: Yep, thats currently the way to do it
[2013-08-05 21:17:12 -0400] kallistec: coderanger: then why not apply that at the resource DSL level?
[2013-08-05 21:17:27 -0400] coderanger: kallistec: Not sure what you mean
[2013-08-05 21:17:31 -0400] yfeldblum: coderanger, why not keep doing it that way?
[2013-08-05 21:17:54 -0400] coderanger: yfeldblum: Because this is highly confusing to new LWRP authors that don't understand the inner details of Ruby scoping
[2013-08-05 21:17:59 -0400] kallistec: e.g, if the block passed to the resource creation method has arity 1, do a regualar call instead of instance eval
[2013-08-05 21:18:23 -0400] coderanger: kallistec: Why would the block on a resource have arity 1?
[2013-08-05 21:18:36 -0400] kallistec: coderanger: like the code sample I posted
[2013-08-05 21:18:46 -0400] coderanger: kallistec: Yes, thats code sample was not what I'm talking about
[2013-08-05 21:19:02 -0400] kallistec: totally solves your problem though
[2013-08-05 21:19:31 -0400] coderanger: http://hastebin.com/tudomitami.rb
[2013-08-05 21:19:35 -0400] coderanger: Something like that
[2013-08-05 21:19:41 -0400] kisoku: what's the best way to silence FC017 in a LWRP
[2013-08-05 21:19:50 -0400] coderanger: kallistec: Maybe, it solves it in a super complex way though
[2013-08-05 21:19:53 -0400] kallistec: coderanger: your solution only solves the lwrp case
[2013-08-05 21:20:10 -0400] coderanger: kallistec: Yes, because thats where this is a problem
[2013-08-05 21:20:20 -0400] kallistec: same problem everywhere
[2013-08-05 21:20:24 -0400] coderanger: The only other magic method generally used in resource blocks is #node
[2013-08-05 21:20:30 -0400] coderanger: and that already has explicit handling
[2013-08-05 21:20:35 -0400] yfeldblum: coderanger, writing custom abstractions in a programming language, whatever the language, assumes knowledge of the language, no?
[2013-08-05 21:20:39 -0400] coderanger: the issue is that the resource itself has its own #new_resource
[2013-08-05 21:20:47 -0400] coderanger: yfeldblum: No
[2013-08-05 21:21:08 -0400] coderanger: yfeldblum: LWRPs are supposed to be at the simplest just a way to make composable groups of resources
[2013-08-05 21:21:33 -0400] kallistec: coderanger: cf, the deploy resource or application cookbook. anywhere you have nested blocks changing scopes like that
[2013-08-05 21:21:34 -0400] coderanger: yfeldblum: That use case requires basically no knowledge of Ruby itself, its just a bit of new DSL + the existing recipe DSL
[2013-08-05 21:22:06 -0400] coderanger: kallistec: Yep, I've put explicit stuff in the app resources to make this easier, but it puts the burden on my side where I know what I'm doing :)
[2013-08-05 21:22:31 -0400] coderanger: kallistec: making it part of the resource syntax puts more burden on the resource user, instead of the author
[2013-08-05 21:22:38 -0400] kisoku: yfeldblum: that is a very developer centric mentality, most run of the mill sysadmins won't be reading the guts of a chef client to understand why their stuff doesn't work as intended
[2013-08-05 21:23:00 -0400] yfeldblum: kisoku, indeed
[2013-08-05 21:23:00 -0400] kisoku: instead they tend to pepper their stuff with hacks
[2013-08-05 21:23:16 -0400] kisoku: or just give up on using the confusing feature altogether
[2013-08-05 21:23:29 -0400] kisoku: I see it all the time at work
[2013-08-05 21:24:11 -0400] coderanger: Right, so the point is doing this on the #action method makes it as close to transparent as possible since that #action call is DSLy and boilerplate already
[2013-08-05 21:24:44 -0400] coderanger: Reduces the cognitive load while still getting the intuitive behavior
[2013-08-05 21:25:16 -0400] yfeldblum: kisoku, IMO pretending that recipes and lwrps are something other than writing software is the real problem
[2013-08-05 21:26:01 -0400] kisoku: I agree
[2013-08-05 21:26:18 -0400] yfeldblum: coderanger, i might prefer `parent_resource` for that case
[2013-08-05 21:26:21 -0400] coderanger: yfeldblum: Requiring a firm grasp of CS and software engineering directly impacts how many people can use chef and therefore my ability to continue getting a paycheck :)
[2013-08-05 21:26:33 -0400] kisoku: the real issue is that people approach them like they are replacements for definitions
[2013-08-05 21:26:43 -0400] kisoku: when they are considerably more complex
[2013-08-05 21:26:49 -0400] coderanger: I'll encourage the hell out of it, but I will also try to reduce the requirements whereever I can
[2013-08-05 21:26:57 -0400] yfeldblum: coderanger, `action(:create){ file('asdf') { owner parent_resource.owner } }`
[2013-08-05 21:28:00 -0400] yfeldblum: coderanger, but not a block argument
[2013-08-05 21:29:05 -0400] coderanger: yfeldblum: If you want to be technical, the "right" way to build LWRPs is to not use the recipe DSL at all, which makes you immune to this problem
[2013-08-05 21:29:13 -0400] coderanger: But I can't and won't expect everyone to do that
[2013-08-05 21:29:19 -0400] eherot: is there any way to get "knife data bag show" to print out the encrypted version of a data bag even when knife[:secret_file] is defined in knife.rb?
[2013-08-05 21:29:43 -0400] coderanger: eherot: No, you could use a knife exec script though
[2013-08-05 21:30:14 -0400] eherot: that'skinda gross
[2013-08-05 21:30:15 -0400] yfeldblum: coderanger, i'm fine with the lightweight DSL with the use of my version of `recipe_eval` (https://gist.github.com/yfeldblum/d85be145f3ff824ccc07) explicitly
[2013-08-05 21:31:12 -0400] coderanger: yfeldblum: That one is also wrong :)
[2013-08-05 21:31:31 -0400] coderanger: yfeldblum: I have the one with correct lexical notification behavior on my gists
[2013-08-05 21:33:39 -0400] coderanger: yfeldblum: It turns out the intuitive semantics for LWRPs are very tricky :) I've just been watching in here for a few years and know where people get caught easily
[2013-08-05 21:33:51 -0400] yfeldblum: coderanger, yours seems to break the resource/provider abstraction, no?
[2013-08-05 21:33:54 -0400] coderanger: yfeldblum: You are right that the inline compiler mode should be the default though, that is definitely on my list
[2013-08-05 21:33:59 -0400] kisoku: zomg so filled with hate for vim regexes right now
[2013-08-05 21:34:16 -0400] coderanger: yfeldblum: No? It just allows notifying to resources outside of the LWRP
[2013-08-05 21:34:38 -0400] coderanger: Thats the most common issue with use_inline_resources and why I couldn't argue for it being the default as it stands now
[2013-08-05 21:34:45 -0400] yfeldblum: coderanger, the current resource notifies its peer resources when it is marked updated; its child resources mark it as updated
[2013-08-05 21:34:57 -0400] coderanger: Yes, and that should still be the case
[2013-08-05 21:35:07 -0400] yfeldblum: coderanger, i don't think any sort of `use_inline_resources` mode should be default
[2013-08-05 21:35:20 -0400] yfeldblum: coderanger, X's child resources should not notify X's peers
[2013-08-05 21:35:21 -0400] coderanger: but resources inside the LWRP need to be able to notify in high contexts, this mostly comes up for things like service reloads
[2013-08-05 21:35:36 -0400] yfeldblum: coderanger, that's what breaks the abstraction
[2013-08-05 21:35:44 -0400] kisoku: I have the same criticism of use_inline_resource btw
[2013-08-05 21:35:49 -0400] coderanger: yfeldblum: Sorry, but enough people get caught on that behavior that I can empirically say you are wrong
[2013-08-05 21:35:54 -0400] coderanger: That is not expected behavior
[2013-08-05 21:36:04 -0400] coderanger: I can explain it, sure, but only by explaining internals
[2013-08-05 21:36:05 -0400] kisoku: that the items in the outer context are no longer notifiable is very confusing
[2013-08-05 21:36:14 -0400] yfeldblum: coderanger, go for it
[2013-08-05 21:36:32 -0400] coderanger: go for it?
[2013-08-05 21:36:41 -0400] yfeldblum: coderanger, explain internals
[2013-08-05 21:36:56 -0400] coderanger: To every person that comes in here not understand why their code doesn't work?
[2013-08-05 21:37:02 -0400] coderanger: That doesn't sound like a good idea
[2013-08-05 21:37:20 -0400] yfeldblum: coderanger, ah i thought you meant to me
[2013-08-05 21:37:33 -0400] coderanger: I mean that I can explain to users why their code doesn't work and its a relatively simple explanation, but it is only simple once you understand what use_inline_resource is doing and why it matters
[2013-08-05 21:37:43 -0400] coderanger: and thats a sign that things are not in a good state
[2013-08-05 21:37:58 -0400] coderanger: use_inline_resources was an experiment and it gets like 90% of the way there :)
[2013-08-05 21:38:24 -0400] yfeldblum: coderanger, how about "you get a miniature chef run that doesn't know about anything in the outside chef run, so you can't notify or subscribe to anything outside the recipe_eval block"?
[2013-08-05 21:39:31 -0400] coderanger: The next question will then be "how do I notify my service that the config has changed"
[2013-08-05 21:39:38 -0400] coderanger: Think of things like apache_site and nginx_site
[2013-08-05 21:39:55 -0400] coderanger: The answer to that better not be "you can
[2013-08-05 21:39:59 -0400] coderanger: "you can't"
[2013-08-05 21:40:19 -0400] yfeldblum: coderanger, "my_custom_resource "wirble" do ; notifies :restart, "service[nginx] ; end"
[2013-08-05 21:40:20 -0400] coderanger: And "add notifications to every use of the LWRP" is pretty gross too
[2013-08-05 21:40:39 -0400] coderanger: Since that pushes cognitive load again from the author to the user
[2013-08-05 21:41:01 -0400] coderanger: Not all LWRPs are designed to be perfectly resuable library-ish things
[2013-08-05 21:41:14 -0400] coderanger: some are just definitions++ and we need to support that use case
[2013-08-05 21:42:19 -0400] coderanger: (also when I say "some" that should be "most" given how most software usage vs. skill curves work)
[2013-08-05 21:42:42 -0400] yfeldblum: coderanger, sounds like giving a suicidal person a long rope
[2013-08-05 21:42:59 -0400] coderanger: That is a functional definition of all of operations :)
[2013-08-05 21:45:04 -0400] coderanger: But the important thing is not how complex the internal code will be, it is what UX do we want to craft that works for both advanced users while still matching what beginners expect
[2013-08-05 21:45:14 -0400] yfeldblum: coderanger, this sounds like a cross between definitions (macros) and resources/providers; it might be so much better to offer a new hybrid which are like definitions but run at converge time and notify outside themselves
[2013-08-05 21:45:23 -0400] coderanger: and in this case, adding a block argument to the provider DSL fills both needs
[2013-08-05 21:45:33 -0400] coderanger: advanced users can ignore it, beginners get much simpler semantics
[2013-08-05 21:45:36 -0400] gkra: ugh...
[2013-08-05 21:45:58 -0400] gkra: so, is there any way to delete a normal attribute from a node aside from "knife node edit" ?
[2013-08-05 21:46:20 -0400] coderanger: gkra: You need to make an API call of some kind
[2013-08-05 21:46:28 -0400] yfeldblum: coderanger, a hybrid which does not use separate files for resource & provider but keeps them together
[2013-08-05 21:46:33 -0400] coderanger: gkra: knife node edit, knife node from file, knife exec, or any API client library
[2013-08-05 21:47:00 -0400] coderanger: yfeldblum: Funny you should mention that https://github.com/coderanger/python-cookbook/blob/master/libraries/python.rb ;-)
[2013-08-05 21:47:29 -0400] gkra: coderanger: ugh this is looking hard :(
[2013-08-05 21:47:46 -0400] coderanger: gkra: Not sure what you mean, you need to something, there are many ways to do that thing
[2013-08-05 21:47:58 -0400] coderanger: gkra: What are you trying to do more specifically
[2013-08-05 21:48:19 -0400] coderanger: yfeldblum: Basically advanced users need to stop using LWRPs because they make subclassing impossible
[2013-08-05 21:48:36 -0400] kisoku: yfeldblum: adding a third option will only continue to confuse matters
[2013-08-05 21:48:55 -0400] coderanger: LWRPs should stay as the lightweight macro-ish option
[2013-08-05 21:49:06 -0400] coderanger: and defs should die in chef 12
[2013-08-05 21:49:11 -0400] coderanger: (IMO)
[2013-08-05 21:49:37 -0400] coderanger: (disclaimer for anyone reading this now or in the future, I speak for myself, not Opscode or anyone else)
[2013-08-05 21:49:49 -0400] kallistec: nah, definitions are good, just not for their original use case
[2013-08-05 21:50:26 -0400] coderanger: kallistec: If we fix the semantics of LWRPs, definitions become entirely redundant
[2013-08-05 21:50:49 -0400] gkra: coderanger: specifically, trying to undo a "node.set" mistake from a recipe, and delete the "normal" attribute "sysctl.params.vm.swappiness" from all nodes
[2013-08-05 21:51:06 -0400] coderanger: gkra: Check out the node transformer helper in knife exec
[2013-08-05 21:51:23 -0400] yfeldblum: coderanger, the hybrid should be for the simple cases, replacing LWRPs for the simple cases
[2013-08-05 21:51:45 -0400] kallistec: coderanger: no, sometimes you need reusable compile time code.
[2013-08-05 21:51:48 -0400] coderanger: yfeldblum: As I said, the advanced case _can't_ use LWRPs because no one can subclass those
[2013-08-05 21:52:05 -0400] coderanger: kallistec: Such as?
[2013-08-05 21:52:25 -0400] yfeldblum: coderanger, LWRPs cannot declare resources that are notifiable externally
[2013-08-05 21:52:36 -0400] kallistec: e.g., calling include_recipe in LWRPs is terrible, you're totally fucking up the ording in which things are supposed to happen
[2013-08-05 21:53:04 -0400] coderanger: kallistec: "If we fix the semantics of ..."
[2013-08-05 21:53:05 -0400] coderanger: :)
[2013-08-05 21:53:20 -0400] kallistec: nope
[2013-08-05 21:53:28 -0400] coderanger: yfeldblum: Sure, and I've not yet seen someone expect that to work
[2013-08-05 21:53:45 -0400] yfeldblum: coderanger, but definitions can do it
[2013-08-05 21:54:17 -0400] yfeldblum: coderanger, making definitions not entirely redundant
[2013-08-05 21:55:27 -0400] MrBIOS: I'm not sure what exactly I'm being asked to do
[2013-08-05 21:55:42 -0400] kallistec: I don't think there's any "fixing the semantics of" that would make using include_recipe in a provider make any sense whatsoever
[2013-08-05 21:55:55 -0400] gkra: coderanger: where is nodes.transformer documented?
[2013-08-05 21:57:24 -0400] gkra: slightly related: can I use a nested attribute as a search term?
[2013-08-05 21:57:29 -0400] gkra: doesn't seem to work
[2013-08-05 21:57:42 -0400] coderanger: kallistec: Why not? do it in the resource after_create ...
[2013-08-05 21:58:00 -0400] coderanger: yfeldblum: My goal is not to cover 100% of use cases, it is to cover the ones I see people actually using
[2013-08-05 21:58:36 -0400] kallistec: coderanger: now you're mixing recipe level concerns with resource ones. This ends in reinventing php in ruby
[2013-08-05 21:58:57 -0400] coderanger: kallistec: You know my opinions on that, there are no recipe-level concerns :)
[2013-08-05 21:59:07 -0400] coderanger: kallistec: Preferably it would be resources all the way down
[2013-08-05 21:59:21 -0400] coderanger: kallistec: But I can only fix so many things at once
[2013-08-05 21:59:54 -0400] leehambley: hi all, I'm trying to debug some node attributes not being applied (solo, attributes in override_attributes in a role .rb)
[2013-08-05 21:59:54 -0400] coderanger: kallistec: To use your java example, this is why in the new python cookbook, installing Python is a resource, not a recipe
[2013-08-05 22:00:06 -0400] leehambley: I'm trying to use chef-shell to dump the attributes for the current node, how can I do that?
[2013-08-05 22:00:54 -0400] coderanger: kallistec: This is indeed exactly why I'm fixing the python cookbook before I move on to ones built on top of it
[2013-08-05 22:01:23 -0400] leehambley: (specifically trying to override https://github.com/elasticsearch/cookbook-elasticsearch/blob/master/attributes/default.rb#L51 with http://pastie.org/private/rfrpsjvl2ldxjky91r6zqg )
[2013-08-05 22:01:51 -0400] yfeldblum: coderanger, fixing the python cookbook how?
[2013-08-05 22:01:53 -0400] coderanger: gkra: You can, the syntax is node['foo']['bar'] -> foo_bar:whatever
[2013-08-05 22:01:59 -0400] coderanger: yfeldblum: Rewriting it
[2013-08-05 22:02:06 -0400] coderanger: yfeldblum: That was the code I linked earlier
[2013-08-05 22:02:22 -0400] coderanger: https://github.com/coderanger/python-cookbook
[2013-08-05 22:04:45 -0400] yfeldblum: coderanger, what's wrong with it?
[2013-08-05 22:04:55 -0400] coderanger: yfeldblum: With the existing one?
[2013-08-05 22:05:04 -0400] yfeldblum: coderanger, right
[2013-08-05 22:05:38 -0400] coderanger: yfeldblum: No support for python 3 or pypy, no support for installing packages except via pip install from PyPI, no support for requirements.txt installs
[2013-08-05 22:06:03 -0400] coderanger: And generally out of date and poorly written interactions with Python itself
[2013-08-05 22:06:13 -0400] coderanger: example, python_pip vs. python_package
[2013-08-05 22:06:49 -0400] coderanger: the person that wrote it originally was unaware that gem : ruby :: pip : python doesn't extend to calling them "pips"
[2013-08-05 22:07:31 -0400] macros: coderanger: Slightly off topic, for bundler like workflow in python pip and virtualenv are they way to go?
[2013-08-05 22:07:56 -0400] coderanger: macros: Yeah, there is actually a full clone using pip, let me find it
[2013-08-05 22:08:08 -0400] macros: I'm going to be doing the same for perl with carton
[2013-08-05 22:08:41 -0400] macros: Just want to be able to vendor stuff for prod deploys and a local refresh command for dev environments
[2013-08-05 22:09:53 -0400] coderanger: macros: Something to remember for virtualenv is they aren't relocatable, you can fpm them up, but make sure you don't change the path
[2013-08-05 22:10:11 -0400] kisoku: kallistec: why is calling include_recipe from within lwrps terrible
[2013-08-05 22:10:20 -0400] yfeldblum: macros, for bundler-like workflow in python, it should all be handled from the application and none from the cookbook
[2013-08-05 22:10:27 -0400] macros: Yes
[2013-08-05 22:10:40 -0400] coderanger: kisoku: more specifically calling include_recipe from within an action method is awful
[2013-08-05 22:10:41 -0400] yfeldblum: kisoku, how is it in any sense sane?
[2013-08-05 22:10:44 -0400] macros: That is what we are moving to, jenkins job that build a package with fpm with all deps
[2013-08-05 22:10:55 -0400] yfeldblum: kisoku, given that a LWR is a resource and a LWP is a provider?
[2013-08-05 22:11:12 -0400] macros: Done for the ruby side, starting on python and perl
[2013-08-05 22:11:33 -0400] kisoku: I am asking you to define why it is not sane and your response it to ask me how it is sane
[2013-08-05 22:12:03 -0400] coderanger: macros: http://nvie.com/posts/better-package-management/
[2013-08-05 22:12:07 -0400] kisoku: forr exmple
[2013-08-05 22:12:25 -0400] kisoku: I have a provider that sets up solr instances
[2013-08-05 22:12:33 -0400] kisoku: it uses runit_service
[2013-08-05 22:12:55 -0400] coderanger: kisoku: Basically adding new resources at execute time is weird and results in strange nesting
[2013-08-05 22:13:02 -0400] kisoku: runit service requires that you do an include_recipe anywhere you want to call runit_service
[2013-08-05 22:13:05 -0400] macros: coderanger: Thanks, looks useful
[2013-08-05 22:13:15 -0400] kisoku: my solr provider also has a recipe it needs to be applied once on the node
[2013-08-05 22:13:22 -0400] coderanger: By the time any action is called, I would expect "everything" to be added to the resource collection
[2013-08-05 22:13:30 -0400] coderanger: kisoku: This matters for things like reporting data
[2013-08-05 22:13:45 -0400] kisoku: yeah
[2013-08-05 22:13:47 -0400] kisoku: I agree
[2013-08-05 22:13:52 -0400] macros: Now off to do hours worth of paperwork stuff so I don't feel guilty hacking on things
[2013-08-05 22:13:55 -0400] coderanger: kisoku: Use #after_create on the resource, thats at least a little less bad in terms of ordering
[2013-08-05 22:14:48 -0400] kisoku: yeah i finally figured out that that stuff needs to happen at resource creation time after thinking about it
[2013-08-05 22:15:03 -0400] kisoku: but none of these things are documented in any manner
[2013-08-05 22:15:21 -0400] kisoku: I don't see how any of you expect ANYONE to understand what you mean by sane and not sane
[2013-08-05 22:15:30 -0400] coderanger: kisoku: Preferably that one-shot stuff would be in its own resource though, you would just invoke the resource
[2013-08-05 22:15:50 -0400] coderanger: kisoku: But thats not a great solution for everyone
[2013-08-05 22:16:09 -0400] yfeldblum: kisoku, sane = useful && preserves abstractions; insane = not useful || breaks abstractions
[2013-08-05 22:17:15 -0400] gkra: coderanger: tested via chef-shell -z:
[2013-08-05 22:17:18 -0400] kisoku: how does it break abstractions, because it converges fine with a little recipe_eval love :-P
[2013-08-05 22:17:21 -0400] gkra: coderanger: node.set['sysct']['params'].tap{|param| param.delete('vm')}
[2013-08-05 22:17:30 -0400] gkra: coderanger: worked, but makes me nervous...
[2013-08-05 22:17:51 -0400] coderanger: gkra: I don't see why you have the tap in there, but sure
[2013-08-05 22:17:52 -0400] kisoku: on one hand, there's these ideals and on the other hand we have to ship things
[2013-08-05 22:18:45 -0400] kisoku: at the end of the day when I have spent my sprint working on this kickass LWRP that does not converge because of some undocumented subtlety and I am on the hook to ship code
[2013-08-05 22:18:49 -0400] kisoku: what do you think happens ?
[2013-08-05 22:18:50 -0400] coderanger: kisoku: Yep, hence my focus on cognitive load, not beauty
[2013-08-05 22:19:02 -0400] gkra: coderanger: following examples from stackoverflow; I'm a relative newb to chef/ruby
[2013-08-05 22:19:08 -0400] kisoku: fuckit, recipe_eval { include_recipe "runit" }
[2013-08-05 22:19:27 -0400] coderanger: gkra: Ahh, node.normal['sysct']['params'].delete('vm')
[2013-08-05 22:19:29 -0400] gkra: coderanger: so I could have just done: node.set['sysctl']['params'].delete('vm') ?
[2013-08-05 22:19:36 -0400] coderanger: yarp
[2013-08-05 22:19:40 -0400] yfeldblum: kisoku, recipes are meant to run once; provider actions are meant to be run hundreds of times
[2013-08-05 22:19:41 -0400] coderanger: node.set == node.normal
[2013-08-05 22:19:46 -0400] gkra: right-o
[2013-08-05 22:19:49 -0400] gkra: thanks :)
[2013-08-05 22:20:05 -0400] kisoku: yes and sometimes our provider code needs some basic stuff run once
[2013-08-05 22:20:08 -0400] kisoku: so for example
[2013-08-05 22:20:15 -0400] kisoku: I could install my solr jars once
[2013-08-05 22:20:23 -0400] kisoku: and create a million instances of solr on my box
[2013-08-05 22:20:55 -0400] kisoku: why is it wrong for my provider to make sure the dependency of the thing that needs to be run once is met magically ?
[2013-08-05 22:21:09 -0400] coderanger: kisoku: Eh, I try to avoid using magic in those cases
[2013-08-05 22:21:21 -0400] coderanger: kisoku: I would just make a recipe for "install solr jars"
[2013-08-05 22:21:26 -0400] kisoku: I asked why
[2013-08-05 22:21:30 -0400] kisoku: I did
[2013-08-05 22:21:40 -0400] kisoku: I don't want to have to remember to call it :-P
[2013-08-05 22:21:41 -0400] coderanger: and do that via run list
[2013-08-05 22:21:57 -0400] kisoku: so yeah about that
[2013-08-05 22:22:21 -0400] coderanger: kisoku: Why I avoid it is that it implies the user of the LWRP wants to install via your strategy
[2013-08-05 22:22:26 -0400] kisoku: run_list is not viable if you've decided to ditch roles and do the wrapper cb thing
[2013-08-05 22:22:26 -0400] coderanger: which works for purely internal stuff
[2013-08-05 22:22:40 -0400] coderanger: but think about how many ways there are to install java, for example
[2013-08-05 22:23:05 -0400] BrianJ: is there an issue if 2 machines have the same node name and same key?
[2013-08-05 22:23:09 -0400] kallistec: kisoku: so why doesn't your wrapper include_recipe, then? or, if it's all internal, use a resource defn which wraps an lwrp
[2013-08-05 22:23:11 -0400] BrianJ: with hosted chef
[2013-08-05 22:23:13 -0400] yfeldblum: cargo culting breaks things
[2013-08-05 22:23:41 -0400] yfeldblum: BrianJ, yes, if you have any interest in `knife status` or search
[2013-08-05 22:23:48 -0400] coderanger: BrianJ: No, though their node data will continually overwrite each other and if they are both running there are race conditions galore
[2013-08-05 22:24:00 -0400] BrianJ: ic
[2013-08-05 22:24:21 -0400] BrianJ: is there a way to give a client additional access when it installs itself?
[2013-08-05 22:24:32 -0400] BrianJ: basically I have a jenkins server which needs knife configured on it
[2013-08-05 22:24:50 -0400] BrianJ: and when jenkins creates itself it configures its own client key, etc.
[2013-08-05 22:25:03 -0400] gkra: coderanger: okay, I think I got it now (and thtanks for the help)
[2013-08-05 22:25:06 -0400] BrianJ: but the client key doesnt have knife's required permissions
[2013-08-05 22:25:16 -0400] gkra: coderanger: knife exec -E 'nodes.transform("chef_environment:perf") { |n| n.attributes.normal.sysctl.params.delete(:vm); n.save }'
[2013-08-05 22:26:06 -0400] coderanger: BrianJ: Hosted or Open source?
[2013-08-05 22:26:10 -0400] BrianJ: hosted
[2013-08-05 22:26:14 -0400] leehambley: can I use chef-shell to see the total node attributes, after resolving the runlist and loadin all recipes ?
[2013-08-05 22:27:22 -0400] oneness: Does anyone know how to force run a specific cookbook in using chef-client
[2013-08-05 22:27:23 -0400] coderanger: BrianJ: So you can knife-acl to change permissions
[2013-08-05 22:27:37 -0400] kallistec: oneness: `-o`
[2013-08-05 22:27:50 -0400] oneness: thanks.
[2013-08-05 22:28:24 -0400] BrianJ: @coderanger I think im left in a chicken or the egg scenario there. I need to give my client the permissions to run knife stuff, but I need knife to give my client the permissions
[2013-08-05 22:28:28 -0400] kallistec: leehambley: yes, but it was busted in 11.0-11.4, fixed now in 11.6. Use chef-shell -z
[2013-08-05 22:28:44 -0400] BrianJ: am i correct in saying so?
[2013-08-05 22:29:09 -0400] coderanger: BrianJ: Yes, you would need to do this from your admin workstation
[2013-08-05 22:29:21 -0400] coderanger: BrianJ: Thats just a given no matter what in any sane ACL system :)
[2013-08-05 22:29:48 -0400] MrBIOS: thoughts/opinions?
[2013-08-05 22:29:54 -0400] BrianJ: @coderanger. Makes sense. Another option would be for me to give increased access to clients
[2013-08-05 22:29:56 -0400] BrianJ: correcT?
[2013-08-05 22:30:02 -0400] coderanger: MrBIOS: Yes, because they all go through an nginx LB now
[2013-08-05 22:30:03 -0400] leehambley: I can't use -z kallistec, I'm using chef-solo, and there's no client PEM
[2013-08-05 22:30:05 -0400] kallistec: MrBIOS: I would take the opportunity to switch to ssl
[2013-08-05 22:30:09 -0400] leehambley: but thanks, good to know it's just broken
[2013-08-05 22:30:12 -0400] BrianJ: granted thats probably a bad practice
[2013-08-05 22:30:24 -0400] kallistec: leehambley: then it's `-s` or something for solo mode
[2013-08-05 22:30:29 -0400] coderanger: BrianJ: Yes, you could do it globally by granted perms to the clients group
[2013-08-05 22:30:44 -0400] leehambley: yep, but node.attributes.to_has doesn't include an attribute that I know is defined in a cookbook
[2013-08-05 22:31:10 -0400] BrianJ: the consequences of that huge security flaw?
[2013-08-05 22:31:31 -0400] kallistec: leehambley: I would guess your metadata is missing a dependency
[2013-08-05 22:31:43 -0400] coderanger: BrianJ: Depends on what perms you give out, but probably :)
[2013-08-05 22:31:50 -0400] leehambley: might be true, I've never been able to get overriding attributes in a role file working, though
[2013-08-05 22:34:18 -0400] BrianJ: @coderanger alright. Thanks
[2013-08-05 22:46:23 -0400] leehambley: anyone happen to know what this chap is doing wrong? http://stackoverflow.com/questions/12144592/chef-how-do-i-override-default-attributes-in-roles I have the same problem with https://github.com/elasticsearch/cookbook-elasticsearch/blob/master/attributes/default.rb#L51 using http://pastie.org/private/rfrpsjvl2ldxjky91r6zqg
[2013-08-05 22:52:30 -0400] pedahzur: I am trying to run chef inside a Kickstart "post scripts" section and getting the output seen at http://bpaste.net/show/R2cqYYci3fLLZzpyWiiE/  It is not repeatable, and there is nothing from chef indicating what might have gone wrong (500? 404? 403?)  Any ideas?
[2013-08-05 22:53:26 -0400] pedahzur: Nothing in my error logs indicated a failed request.
[2013-08-05 22:53:52 -0400] pedahzur: And running that same command later on that same node, it runs just fine.
[2013-08-05 23:00:45 -0400] MrBIOS: gchristensen: ping
[2013-08-05 23:08:10 -0400] jmickle: jtimberman: you in?
[2013-08-05 23:21:19 -0400] aslan: hey guys is this wrong in chef 11? https://gist.github.com/Aslan/6160547
[2013-08-05 23:26:04 -0400] ribo: does the cron provider support the slash notation, e.g. minute "*/15" for every 15 mins?
[2013-08-05 23:30:18 -0400] qhartman: ribo, it does in chef 10 at least, I use it all the time
[2013-08-05 23:30:24 -0400] ribo: ok, cool; thanks
[2013-08-05 23:32:29 -0400] aslan: hey guys is this wrong in chef 11? https://gist.github.com/Aslan/6160547 i am getting Gem::Requirement::BadRequirementError: Illformed requirement [""]
[2013-08-05 23:38:53 -0400] MrBIOS: grr
[2013-08-05 23:39:15 -0400] MrBIOS: trying to follow http://www.opscode.com/blog/2013/03/12/5106/ and step five, the 'knife upload /' only the environments get uploaded
[2013-08-05 23:39:22 -0400] MrBIOS: the cookbooks and everything else silently fails
[2013-08-05 23:39:26 -0400] MrBIOS: even with knife upload -VV
[2013-08-05 23:43:03 -0400] oneness: anyone know how to pass attribute k/v pair to chef-cliet from command line?
[2013-08-05 23:43:11 -0400] coderanger: aslan: Use chef_gem
[2013-08-05 23:43:20 -0400] coderanger: aslan: Or at least thats probably what you mean
[2013-08-05 23:43:55 -0400] aslan: coderanger: this used to work with chef 10
[2013-08-05 23:45:23 -0400] aslan: coderanger: i remember reading about chef_gem it will use chef's version of ruby and is not system wide.
[2013-08-05 23:45:32 -0400] coderanger: aslan: Yes
[2013-08-05 23:48:53 -0400] aslan: coderanger: same error :( . chef_gem[mysql] (mysql::client-5.1 line 41) had an error: Gem::Requirement::BadRequirementError: Illformed requirement [""]
[2013-08-05 23:49:38 -0400] coderanger: aslan: Please pastebin the full traceback
[2013-08-05 23:50:57 -0400] aslan: coderanger: updated https://gist.github.com/Aslan/6160547
[2013-08-05 23:51:32 -0400] coderanger: aslan: Oh heh, remove the action :nothing bits
[2013-08-05 23:51:38 -0400] coderanger: just "chef_gem 'mysql'"
[2013-08-05 23:51:46 -0400] aslan: oh ok
[2013-08-05 23:51:53 -0400] coderanger: It handles the at-compile-time stuffs internally
[2013-08-05 23:52:30 -0400] aslan: coderanger: is it chef 10 compatible?
[2013-08-05 23:52:42 -0400] coderanger: aslan: I don't remember when it was added, sorry
[2013-08-05 23:52:50 -0400] coderanger: I think it was in a 10.x version though
[2013-08-05 23:53:02 -0400] aslan: i am testing it right now. will tell you in few seconds :P
[2013-08-05 23:53:42 -0400] josephholsten: any word on when the tickets server will be back up?
[2013-08-05 23:53:53 -0400] coderanger: josephholsten: Soon
[2013-08-05 23:54:13 -0400] coderanger: Was going to be some time today, I think we're still waiting on the upstream security release though
[2013-08-05 23:54:38 -0400] josephholsten: k, I heard about a 1pm eta. I've just got a coworker who wants to contribute.
[2013-08-05 23:55:01 -0400] josephholsten: should I bring beer by the seattle office?
[2013-08-05 23:56:13 -0400] josephholsten: or hugs, pizza, &c?
[2013-08-05 23:57:16 -0400] aslan: coderanger: still failing
[2013-08-05 23:58:10 -0400] coderanger: aslan: Sec, diving code
