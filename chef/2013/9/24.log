[2013-09-24 01:31:23 -0400] Tharish: Hello
[2013-09-24 01:32:06 -0400] Tharish: Trying to install
[2013-09-24 01:32:06 -0400] Tharish: pg
[2013-09-24 01:32:43 -0400] Tharish: trying to install "pg" gem via chef and hitting an error with the install
[2013-09-24 01:33:10 -0400] Tharish: I can install the gem via the command line just fine, but having an issue with the sensu_gem method
[2013-09-24 01:33:25 -0400] Tharish: root@failmon2:/var/log/sensu# /opt/sensu/embedded/bin/gem install pg -q --no-rdoc --no-ri -v "0.17.0" Building native extensions.  This could take a while... ERROR:  Error installing pg: ERROR: Failed to build gem native extension.      /opt/sensu/embedded/bin/ruby extconf.rb checking for pg_config... yes Using config values from /usr/bin/pg_config checking for libpq-fe.h... yes checking for libpq/libpq-fs.h... yes checking for pg_co
[2013-09-24 01:35:24 -0400] bluepojo: doesn't appear to be a chef problem
[2013-09-24 01:35:39 -0400] bluepojo: you're missing a lib that pg requires to build the C extension
[2013-09-24 01:35:47 -0400] bluepojo: the log output should say what
[2013-09-24 02:07:50 -0400] apes: Is there a way to show recursive dependencies of cookbooks in chef?
[2013-09-24 03:09:01 -0400] yfeldblum: apes, since cookbooks are versioned and each version has its own dependencies, i'm not sure your question has an answer
[2013-09-24 03:15:31 -0400] apes: The chef server knows all that information though
[2013-09-24 03:15:38 -0400] apes: It looks like the answer is just "no"
[2013-09-24 03:21:18 -0400] douglaswth: apes: berkshelf is able to figure it out, so it is definitely possible, but I don't think there is a tool that just prints the tree
[2013-09-24 03:40:32 -0400] victor_lowther: so, how insane am I for wanting to set up a local chef 11.0.8 server to be able to communicate over ipv6?
[2013-09-24 04:12:25 -0400] Mallok: Hello
[2013-09-24 04:13:05 -0400] Mallok: Can anybody give me some help with a new relic chef?
[2013-09-24 04:13:51 -0400] Mallok: I'm using this https://github.com/escapestudios/chef-newrelic on my opsworks account
[2013-09-24 04:14:29 -0400] Mallok: And always I've get the same error:"Cookbook ms_dotnet4 not found. If you're loading ms_dotnet4 from another cookbook, make sure you configure the dependency in your metadata"
[2013-09-24 04:14:59 -0400] Mallok: and the meta have the depends "ms_dotnet4" whitin it
[2013-09-24 04:16:43 -0400] jbz: ok, is that cookbook available on your opsworks account then? I don't know how cookbooks work on there.
[2013-09-24 04:17:48 -0400] jbz: Unless you're using a third-party system that can parse and retrieve dependencies, Chef assumes that dependency cookbooks are available on the same Chef server, which usually means you must upload them.
[2013-09-24 04:20:53 -0400] Mallok: ho I don't know but now I understand the point
[2013-09-24 04:21:26 -0400] Mallok: I'll find the dependencies on opsworks
[2013-09-24 05:59:05 -0400] axsuul: In chef solo, how can I access a node's ipaddress attribute that I have specified in a recipe?
[2013-09-24 06:03:33 -0400] jkburges: @axsuul: node['ipaddress'] work for you?
[2013-09-24 06:04:04 -0400] jkburges: sorry, that may only be available in chef-client
[2013-09-24 06:04:06 -0400] jkburges: can't help you
[2013-09-24 06:05:41 -0400] axsuul: jkburges: my node looks like this
[2013-09-24 06:05:43 -0400] axsuul: https://gist.github.com/axsuul/07fa28d0f02253aa23c9
[2013-09-24 06:05:59 -0400] axsuul: jkburges: i tried putting it in default_attributes too but can't access it
[2013-09-24 06:45:40 -0400] spicy: any thoughts on why an encrypted data bag that works on a chef-server doesn't load when using chef-solo and vagrant (I'm getting "lexical error: invalid char in json text. Response: Cannot load data bag")? Checked that the secret file and data bag both exist on the vm, and other data bag objects seem to load okay.
[2013-09-24 09:36:57 -0400] arnebrasseur: Hi everyone!
[2013-09-24 09:37:25 -0400] arnebrasseur: We're having a problem where 'knife search' is returning too many nodes, i.e. nodes that don't match the query
[2013-09-24 09:37:29 -0400] arnebrasseur: see https://gist.github.com/6682491
[2013-09-24 09:37:47 -0400] arnebrasseur: I searched around a bit but didn't find anything... anyone seen this before?
[2013-09-24 09:37:52 -0400] arnebrasseur: any ideas on how to troubleshoot?
[2013-09-24 10:50:35 -0400] arussel: I'd forgot the name of a project that allows to start multiple instances on ec2. Anyone knows ?
[2013-09-24 10:56:41 -0400] irr: Ohai Chefs. Does anybody know if it's already possible to use kitchen-test with chef-zero? Seeing some changes here: https://github.com/opscode/test-kitchen/issues/36 but not sure how to pass "provisioner" option to .kitchen.yml
[2013-09-24 10:57:22 -0400] irr: @jtimberman ^^
[2013-09-24 11:30:12 -0400] irr: nm, just needed to add provisioner: chef_zero at the top level of yml
[2013-09-24 11:35:11 -0400] arussel: I'm looking for a small github project that allows to deploy multiple ec2 instance, anyone know it ?
[2013-09-24 11:40:12 -0400] arussel: answering myself: https://github.com/mattray/spiceweasel
[2013-09-24 11:43:42 -0400] arussel: jtimberman: fantastic post: http://sysadvent.blogspot.be/2012/12/day-24-twelve-things-you-didnt-know.html I wish I would have read it before, it would be nice to have a list of 'must read' post at the end for the learnchef tutorial.
[2013-09-24 12:39:17 -0400] konopka: anybody know why the chef 11 install docs push so hard to have a FQDN hostname?
[2013-09-24 12:42:30 -0400] s2r2: the node name defaults to the fqdn
[2013-09-24 12:42:57 -0400] s2r2: and without special precautions, that's what "knife ssh ..." will try to connect to, so it's most convenient if it is resolvable
[2013-09-24 12:43:15 -0400] s2r2: (if not, use "knife ssh role:... -a ipaddress -- uptime")
[2013-09-24 12:43:22 -0400] s2r2: just a guess though
[2013-09-24 12:50:48 -0400] konopka: yeah, i'm just not sure how the hostname on the server impacts client knife.rb settings
[2013-09-24 12:52:04 -0400] s2r2: oh, you we're referring to a chef server install... sorry
[2013-09-24 12:52:28 -0400] konopka: ah yes, that was not clear :)
[2013-09-24 12:52:29 -0400] konopka: http://docs.opscode.com/install_server.html
[2013-09-24 12:52:41 -0400] konopka: there"The hostname must be a FQDN, including the domain suffix."
[2013-09-24 12:52:49 -0400] konopka: There's a whole section devoted to it
[2013-09-24 12:53:07 -0400] s2r2: that's a different issue.  I don't know all the details, but it is important.... if the api_fqdn setting is wrong, you'll meet weird failures
[2013-09-24 12:53:18 -0400] s2r2: i.e. knife node list might work, knife cookbook upload will not etc
[2013-09-24 12:53:46 -0400] s2r2: it's ok to set api_fqdn to the server's IP address, though.  (at least it works fine)
[2013-09-24 12:57:14 -0400] s2r2: (not setting api_fqdn in chef-server.rb and having a non-resolvable (to clients) hostname is the problematic combination)
[2013-09-24 12:57:50 -0400] konopka: a resolvable hostname makes total sense. why it has to be a fqdn does not though.
[2013-09-24 13:00:33 -0400] s2r2: hmm I bet (= guess) having the hostname `chef` and `api_fqdn "chef.my.fqdn.net"` setting will work, too.
[2013-09-24 13:05:42 -0400] konopka: s2r2: Thanks for the pointer to api_fqdn
[2013-09-24 13:05:58 -0400] s2r2: konopka: :)
[2013-09-24 13:13:12 -0400] zeroXten: any documentation on getting chef 11.6 to log to syslog? Looks like 11.6 breaks log_location Logger::Syslog.new because of a File existence test
[2013-09-24 13:27:46 -0400] b-dean: I'm writing an LWRP where I'd like to use the jenkins_cli LWRP in my provider's load_current_resource to run a groovy script to get some information about the state of a jenkins server (to .. load the current resource). The problem is, I can't get it to run in the order of the code. that is, even if I say j = jenkins_cli { action(:nothing) }; j.run_action(:run), since jenkins_cli uses resources and it doesn't do the "run them now" trick, they just end up runni
[2013-09-24 13:27:47 -0400] b-dean: ng later, after the end of the load_current_resource method
[2013-09-24 13:30:33 -0400] b-dean: @schisamo, you know the jenkins cookbook well, how would I go about running jenkins_cli provider in a load_current_resource method and actually be able to get the results and use them to determine the current state of a resource?
[2013-09-24 13:32:57 -0400] jperry: ohai chefs!
[2013-09-24 13:33:06 -0400] jperry: I have an attribute file ordering question
[2013-09-24 13:33:35 -0400] siezer: they're loaded in the order that chef-client resolves the run_list
[2013-09-24 13:33:53 -0400] siezer: your best bet is to namespace them to the cookbook to avoid load order tomfoolery
[2013-09-24 13:33:54 -0400] jperry: say I have default.rb and a.rb and b.rb attribute files in a cookbook and they all set the same thing
[2013-09-24 13:34:07 -0400] siezer: default['cookbook_name']['your_attributes']
[2013-09-24 13:34:08 -0400] jperry: any way to have a particular attribute file loaded last so it wins?
[2013-09-24 13:34:43 -0400] siezer: I'm pretty sure, they're loaded a first, b second
[2013-09-24 13:34:44 -0400] siezer: but
[2013-09-24 13:34:52 -0400] jperry: yeah alphabetically
[2013-09-24 13:34:56 -0400] adamjk-dev: i thought it was alphabetically
[2013-09-24 13:35:04 -0400] jperry: but you can specify what one gets loaded first
[2013-09-24 13:35:08 -0400] siezer: best thing to do is to namespace the attributes so theres no conflicts anyway
[2013-09-24 13:35:16 -0400] mattray: and to just use 1 file
[2013-09-24 13:35:46 -0400] jperry: I see
[2013-09-24 13:35:57 -0400] jperry: so for my example we have different domains
[2013-09-24 13:36:15 -0400] jperry: sounds like it would be best to do default['cookbook']['domain']['value']
[2013-09-24 13:36:24 -0400] siezer: yep
[2013-09-24 13:43:52 -0400] jperry: siezer: thank you, that makes sense
[2013-09-24 13:44:04 -0400] ianco: is setting node overrides for another cookbook in attribues/ files normal practice?
[2013-09-24 13:44:05 -0400] jperry: I think I like the role approach better but at the least we have alternatives
[2013-09-24 13:44:08 -0400] ianco: it seems dirty to me
[2013-09-24 13:44:36 -0400] dmdeklerk: Hi all! What would be the syntax for referencing a local git repo in the community application? I want the `repository` resource to use my /home/me/repo git repo.
[2013-09-24 13:44:59 -0400] dmdeklerk: that would be application cookbook offcourse
[2013-09-24 13:45:32 -0400] siezer: all cookbook attribute files from EVERY cookbook in the run_list, and every cookbook that gets include_recipe'ed are all loaded into the node object during the chef-client run
[2013-09-24 13:46:05 -0400] siezer: its convention to set them as default['cookbook_name']['maybe_recipe_name']['whatever']
[2013-09-24 13:46:45 -0400] siezer: its *possible* for cookbook-a/attributes/default.rb to set default['cookbook-b']['something']
[2013-09-24 13:47:04 -0400] siezer: but thats not normal practice
[2013-09-24 13:50:55 -0400] Chammmmm: Hi, When I install chef with the rpm on centos 6.x.. does it wrap it with rubyenv and ruby 1.9.x or it still uses os ruby(1.8.x) ?
[2013-09-24 13:51:32 -0400] siezer: Chammmmm it ships its own ruby and used that. everything is in /opt
[2013-09-24 13:51:46 -0400] Chammmmm: siezer: thank you!! amazing
[2013-09-24 13:57:49 -0400] jperry: anyway to get the expanded run_list when calling node.run_list
[2013-09-24 14:09:15 -0400] schisamo: b-dean: I think something like this should work https://gist.github.com/schisamo/d5e8909150dc3ceb1b4b
[2013-09-24 14:19:08 -0400] cap10morgan: in a Kitchenfile, how do I tell a configuration to only run on some platforms (whitelist)?
[2013-09-24 14:41:16 -0400] juliancdunn: cap10morgan: there is no whitelist functionality in test-kitchen (yet)
[2013-09-24 14:41:43 -0400] cap10morgan: juliancdunn: oh, bummer. so I just need to exclude all the platforms it doesn't work on, eh?
[2013-09-24 14:41:54 -0400] juliancdunn: cap10morgan: yessir
[2013-09-24 14:41:58 -0400] cap10morgan: ok
[2013-09-24 14:49:11 -0400] adamjk-dev: cap10morgan: you can override a kitchen.yml file with a local one which can get you some odd wins
[2013-09-24 14:49:44 -0400] adamjk-dev: cap10morgan: for instance, I take the public jenkins cookbook one, and override it locally with my own platforms (RHEL), and run what I need against that to verify that the Jenkins cookbook will work with my local boxes
[2013-09-24 14:50:22 -0400] adamjk-dev: cap10morgan: or, put everything in there and have it (test-kitchen) do the cartesian product on the platforms and suites, and you need to keep track of which ones to run
[2013-09-24 14:50:45 -0400] adamjk-dev: i.e. kitchen test platform1_suite2, platform3_suite1, etc.
[2013-09-24 15:13:45 -0400] bigbigbang: Ohai there ! Does someone knows if it exists a way to execute a recipe for a given date or time ?
[2013-09-24 15:15:23 -0400] adnichols: bigbigbang you mean run a recipe at a certain time? cron?
[2013-09-24 15:15:54 -0400] kaldrenon: Hey all; I'm working on a chef recipe for nodes that will be running Ubuntu. I'm wondering if there's a best practice for modifying bashrc/bash_profile/zshrc/etc on a *nix box. I don't want to just copy a template over because I want whatever's in the AMI's default version to be preserved, but I want to maintain a custom section of the file in an idempotent way
[2013-09-24 15:16:00 -0400] bigbigbang: adnichols: yes for example, a recipe that launch only when we are the first day of month
[2013-09-24 15:16:36 -0400] adnichols: bigbigbang  you can run a specific recipe w/ 'chef-client -o "recipe[abc]"' - and you can schedule that to run using any number of standard scheduling tools
[2013-09-24 15:17:06 -0400] adnichols: I suppose if you are running chef as a daemon you could have the recipe check the date and choose whether to run or not as well
[2013-09-24 15:21:36 -0400] bigbigbang: adnichols: yeah it could work, but to automatize it (and deploy it) I will need to include the "cron" in a recipe, that launch every time but execute only when the date is ok .. I was hopping I could do this with Ruby .. and not using cron ..
[2013-09-24 15:22:17 -0400] adnichols: bigbigbang if you run chef regularly just do it in ruby
[2013-09-24 15:22:56 -0400] adnichols: I don't have an example but there are lots of date calculation options you can use - you can get a recipe to skip a run by using 'return'
[2013-09-24 15:23:18 -0400] bigbigbang: adnichols: yeah i think i will try to find a solution with Ruby ... thanks anyway, your solution was working !
[2013-09-24 15:23:29 -0400] kaldrenon: bigbigbang: You could always put the date check anywhere in the recipe. Chef recipes can handle regular Ruby so just wrap all or part of a recipe in and if..else..end block that checks against Time.now
[2013-09-24 15:23:57 -0400] kaldrenon: You could even do a time check in an only_if condition, I would think.
[2013-09-24 15:24:03 -0400] bigbigbang: kaldrenon: thx ! will do that
[2013-09-24 15:31:24 -0400] fak3r: I want to overwrite the NTP servers used by the ntpd cookbook. so:
[2013-09-24 15:32:06 -0400] fak3r: default['ntp']['servers']   = %w{ 0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org }  to> default['ntp']['servers']   = %w{ 111.222.333.444 }
[2013-09-24 15:32:48 -0400] fak3r: but that's not showing up in /etc/ntp.conf - so I'm doing something wrong - I've tried putting it with = [ "111.222.333.444" ] but that didn't work. trying to find an example of how to overwrite that array
[2013-09-24 15:36:36 -0400] fak3r: hi, please ignore my last question - I never berks upload'd to the chef server :/
[2013-09-24 15:41:42 -0400] cpuguy83: I'm performing an offline installation using chef-solo and I'm finding that when chef-solo completes (and it is completing successfully) that it is causing my script to exit
[2013-09-24 15:42:11 -0400] s2r2: cpuguy83: using something like "exec chef-solo"?
[2013-09-24 15:42:25 -0400] cpuguy83: s2r2: It's a Windows batch script, unfortunately.
[2013-09-24 15:42:45 -0400] s2r2: cpuguy83: ooh... no idea.
[2013-09-24 15:48:26 -0400] danger_: Hi guys I am new to chef world I am trying to call one cookbook from another
[2013-09-24 15:48:38 -0400] danger_: i am getting this message
[2013-09-24 15:48:38 -0400] danger_: Cookbook "A" not found. If you're loading "A" from another cookbook, make sure you configure the dependency in your metadata
[2013-09-24 15:49:09 -0400] danger_: can anyone point me as to where i should add the other cookbook path
[2013-09-24 15:49:59 -0400] siezer: danger puts "depends 'cookbook-a'" in cookbook b's metadata.rb
[2013-09-24 15:50:40 -0400] danger_: thanks siezer and what should be the syntax like?
[2013-09-24 15:51:05 -0400] danger_: sorry i am new to ruby as well
[2013-09-24 15:51:35 -0400] juliancdunn: danger_: http://docs.opscode.com/essentials_cookbook_metadata.html
[2013-09-24 15:51:37 -0400] juliancdunn: search for "depends"
[2013-09-24 15:51:47 -0400] siezer: something like this https://github.com/opscode-cookbooks/openssh/blob/master/metadata.rb#L15
[2013-09-24 15:52:27 -0400] danger_: awesome thanks i went to this page previously but did not catch that
[2013-09-24 15:52:37 -0400] danger_: thanks to both of you
[2013-09-24 15:53:16 -0400] kaldrenon: Can anyone recommend the best way to manage a box's /etc/profile in an idempotent way, or point me to an example?
[2013-09-24 15:56:50 -0400] cpuguy83: kaldrenon: What do you mean?  With cookbook_file and template the files will only get updated if you change them
[2013-09-24 15:58:02 -0400] kaldrenon: cpuguy83: The challenge I have is that I only want to manage part of the file - e.g. append a custom section if it's not there, update that section if it's outdated. I don't want to replace the whole file
[2013-09-24 15:58:24 -0400] juliancdunn: kaldrenon: try the "line" cookbook?
[2013-09-24 15:58:37 -0400] kaldrenon: juliancdunn: I'll take a look
[2013-09-24 15:59:56 -0400] kaldrenon: That looks like it will help me do what I want, thanks!
[2013-09-24 16:03:08 -0400] navap: I'm trying to follow gettingstartedwithchef.com, but with nginx instead of apache. I've downloaded the nginx cookbook and when I run chef-solo nginx does start, but I'm wondering why /var/www wasn't created since that's where the default nginx config points to
[2013-09-24 16:03:42 -0400] xhae: navap: try following it as written, the nginx cookbook causes issues for a lot of people.
[2013-09-24 16:05:03 -0400] navap: xhae: Is there a guide you'd recommend that would walk me through using the nginx cookbook?
[2013-09-24 16:09:07 -0400] juliancdunn: kaldrenon: no problem!
[2013-09-24 16:15:36 -0400] bobbywilson0: Is there a way to see if a resource is being included in a collection before an exception is raised? Here's my error https://gist.github.com/bobbywilson0/6687166
[2013-09-24 16:19:37 -0400] xhae: navap: I would recommend not using the nginx cookbook to learn chef
[2013-09-24 16:20:32 -0400] navap: Okay
[2013-09-24 16:26:40 -0400] dmdeklerk: How would I upload a directory recursively from chef DSL?
[2013-09-24 16:27:05 -0400] girishb: help please .. how can I create multiple directories
[2013-09-24 16:27:05 -0400] girishb: directory ["/home/test1","/home/test2"] do
[2013-09-24 16:27:26 -0400] girishb: not taking above syntax
[2013-09-24 16:27:41 -0400] jbz: girishb: no, use a ruby loop
[2013-09-24 16:28:08 -0400] girishb: jbz:okay thx
[2013-09-24 16:28:17 -0400] jbz: 1 sec will give example
[2013-09-24 16:29:39 -0400] jbz: girishb: https://gist.github.com/jbz/6687362
[2013-09-24 16:30:50 -0400] girishb: jbz:thx
[2013-09-24 16:30:53 -0400] jbz: yw
[2013-09-24 16:31:02 -0400] jbz: alternately you could have an array of hashes with options for each directory
[2013-09-24 16:33:26 -0400] techminer1: Is there a way to tell a recipe running on windows, that if it sees a reference to a user "root".replace that with "administrator"?
[2013-09-24 16:34:04 -0400] jbz: You could use an attritbute which uses logic to set its value depending on platform?
[2013-09-24 16:34:28 -0400] jbz: Unless you mean a user passed in to the recipe
[2013-09-24 16:35:35 -0400] dmdeklerk: Anyone know  of a complete chef DSL reference?
[2013-09-24 16:35:39 -0400] techminer1: Wellit's defined in the Sensu cookbook.  I can't overwrite it without forking that cookbook.
[2013-09-24 16:36:48 -0400] TrinitronX: techminer1: http://docs.opscode.com/dsl_recipe_method_platform.html
[2013-09-24 16:37:21 -0400] TrinitronX: Either fork & issue a pull request, or write a wrapper cookbook
[2013-09-24 16:37:53 -0400] techminer1: I'll have to issue a pull request I guess.  I'll check over on the sensu channel.
[2013-09-24 16:38:41 -0400] Jose___: Hi
[2013-09-24 16:39:28 -0400] Jose___: Is there any way to programatically modify a data-bag from the shell prompt?
[2013-09-24 16:39:50 -0400] Jose___: I see that knife data bag edit expects an interactive editor
[2013-09-24 16:40:42 -0400] cpuguy83: Jose___: You could fire up a Ruby script and load the ripple gem
[2013-09-24 16:44:22 -0400] xhae: that's a pretty awful solution
[2013-09-24 16:44:39 -0400] xhae: can a databag be modified via some API?
[2013-09-24 16:44:42 -0400] fak3r: in template: <%= @params[:bind_address] %> in recipe node.default['mysql']['bind_address'] = "0.0.0.0" error is FATAL: Chef::Mixin::Template::TemplateError: undefined method `[]' for nil:NilClass
[2013-09-24 16:44:56 -0400] fak3r: so should that be node.overide instead of default, or do I have something else wrong?
[2013-09-24 16:45:13 -0400] xhae: s/node.default/node/
[2013-09-24 16:45:30 -0400] cwj: coderanger: you around? trying to figure out how to modify parameters of an application_python celery subresource via resources(application[foo])
[2013-09-24 16:46:27 -0400] xhae: fak3r: default, override etc. are used for attribute definition to specify the priority level of the assignment; when you use the value, you want node
[2013-09-24 16:47:16 -0400] fak3r: xhae: ah, so it should be node['mysql']['bind_address'] = "0.0.0.0" ?
[2013-09-24 16:48:00 -0400] xhae: fak3r: default['mysql']['bind_address'] in the recipe
[2013-09-24 16:48:11 -0400] xhae: fak3r: node['mysql']['bind_address'] in the template
[2013-09-24 16:48:21 -0400] xhae: I got your error back to front
[2013-09-24 16:49:35 -0400] fak3r: xhae: ok, so in my template I have: bind-address    = <%= @params[:bind_address] %> that's not right?
[2013-09-24 16:50:28 -0400] xhae: fak3r: Ignore me plx
[2013-09-24 16:50:41 -0400] xhae: I shouldn't be trying to help, I'm making things worse.
[2013-09-24 16:51:13 -0400] dgarstang2: I can't get my head around this. One jenkins job per cookbook, or one job per jenkins cookbook that defines a role?
[2013-09-24 16:51:23 -0400] teukka: xhae: you can download and upload a data bag via the api. that is what `knife data bag edit` does
[2013-09-24 16:52:58 -0400] teukka: xhae: https://github.com/opscode/chef/blob/master/lib/chef/knife/data_bag_edit.rb
[2013-09-24 16:53:14 -0400] xhae: teukka: Thanks, you led me to Chef::REST
[2013-09-24 16:54:14 -0400] teukka: xhae: you could make you own knife plugin based on that or just use the api directly. depends on your use case
[2013-09-24 16:54:44 -0400] fak3r: xhae: np, I'm looking at an older one I tried yesterday
[2013-09-24 16:56:07 -0400] xhae: teukka: now I'm wondering whether there is a Ruby API used by knife to talk to the Chef Server API
[2013-09-24 16:57:26 -0400] teukka: xhae: it's bundled into the chef gem. then there is ridley, but I don't know if it implements the whole api
[2013-09-24 16:58:03 -0400] teukka: https://github.com/RiotGames/ridley
[2013-09-24 16:58:30 -0400] teukka: yeah: https://github.com/RiotGames/ridley#data-bag-resource
[2013-09-24 17:01:27 -0400] cpuguy83: xhae: Sorry, I said ripple gem, wrong gem, ridley is the correct one
[2013-09-24 17:02:46 -0400] xhae: cpuguy83: thought you were talking about some sort of ruby-specific charactermode 'expect'
[2013-09-24 17:02:47 -0400] cpuguy83: Chef Server is all REST API based, knife is a command line client for this API, ridley is a library that you can include in your project
[2013-09-24 17:03:15 -0400] cpuguy83: xhae: oh... I would never... ever... :|
[2013-09-24 17:03:16 -0400] cpuguy83: lol
[2013-09-24 17:10:34 -0400] fak3r: so I've followed a wrapper template/recipe pattern I followed before, but it's failing for mysql.
[2013-09-24 17:10:41 -0400] fak3r: anything here look out of sorts? https://gist.github.com/philcryer/6687940
[2013-09-24 17:13:39 -0400] teukka: fak3r: you're not even passing the `params` variable to the template
[2013-09-24 17:15:02 -0400] teukka: fak3r: either add `variables params: node['mysql']` to the template resource or use `node['mysql']['bind_address']` directly in the template
[2013-09-24 17:16:19 -0400] dgarstang2: I can't get my head around this. One jenkins job per cookbook, or one job per jenkins cookbook that defines a role?
[2013-09-24 17:16:22 -0400] techminer1: Trying to run Chef on Windows.  Sometimes a resource operation tries to use a network drive for some reason and fails.  Why is it trying to use P:/ instead of C:\ by default?  In this case it's the gem_package resource. https://gist.github.com/MattMencel/6687948
[2013-09-24 17:18:29 -0400] fak3r: teukka: thanks, taking a look
[2013-09-24 17:19:29 -0400] techminer1: Hmmm.gem has stored some gem data on that network drive in a .gem folder.  Guess I need to figure out where that config is coming from.
[2013-09-24 17:37:35 -0400] dgarstang2: I can't get my head around this. One jenkins job per cookbook, or one job per jenkins cookbook that defines a role?
[2013-09-24 17:38:08 -0400] dmdeklerk: Please help.. From recipe DSL, how do I run a bash command on the workstation (need to compress a directory before uploading with `file` resource)
[2013-09-24 17:38:19 -0400] sparr: http://docs.opscode.com/ctl_chef_solo.html says that chef-solo can be daemonized. what would that do, precisely?
[2013-09-24 17:38:46 -0400] sparr: dmdeklerk: http://docs.opscode.com/resource_bash.html
[2013-09-24 17:38:50 -0400] adamjk-dev: dmdeklerk: http://docs.opscode.com/resource_execute.html
[2013-09-24 17:39:12 -0400] adamjk-dev: woops.... take sparr's suggestion
[2013-09-24 17:39:31 -0400] adamjk-dev: dmdeklerk: these are your list of available resources: http://docs.opscode.com/resource.html
[2013-09-24 17:42:26 -0400] dmdeklerk: thanks sparr and adamjd-dev
[2013-09-24 17:45:42 -0400] dmdeklerk: Question: Is it wise to have your rails app and chef-repo in one git repo? (So your .chef dir is next to your config and app dir)
[2013-09-24 17:49:37 -0400] sparr: dmdeklerk: generally you should have one git repo per... "project"
[2013-09-24 17:49:53 -0400] tlr00: @dmdeklerk: I never keep it in one repo, usually best to abstract the two.
[2013-09-24 17:50:05 -0400] sparr: hard to quantify... if you might want to deploy things separately, or replace one part of it, then it should be two repos
[2013-09-24 17:50:21 -0400] tlr00: Are you using deploy() or capistrano to deploy?
[2013-09-24 17:50:38 -0400] dmdeklerk: no i'm using deploy resource, not cap
[2013-09-24 17:52:39 -0400] tlr00: Cool.
[2013-09-24 17:52:46 -0400] behemphi: Ohai!  And speaking of Ohai  when I lauch a node in AWS with knife ec2 -N my-name it seems this is being overwritten on the node itself
[2013-09-24 17:53:37 -0400] behemphi: so I am left in the situation where the chef server (hosted chef) is telling me the node name is 'my-name' while the chef-chell on the machien in question is telling me 'ip-10-236-153-97.ec2.internal'
[2013-09-24 17:53:40 -0400] dgarstang2: I can't get my head around this. One jenkins job per cookbook, or one job per jenkins cookbook that defines a role?
[2013-09-24 17:54:20 -0400] behemphi: I am just getting my feet wet in AWS, can someone enlighten me (maybe a link as I am sure I am not the first to be confused)
[2013-09-24 17:54:38 -0400] arussel: I want to create a cluster with spiceweasel, 1 DB node, and 200 worker nodes. I would like to be able to bulkdelete only the worker nodes and recreate them, not the db. Is it possible ?
[2013-09-24 17:57:48 -0400] arussel: I also need the path to the pem file not to be hardcoded, is there a way to do it ?
[2013-09-24 17:59:46 -0400] b-dean: schisamo: I added a comment to your gist, https://gist.github.com/schisamo/d5e8909150dc3ceb1b4b showing what I was seeing  happen with the jenkins_cli not running until after load_current_resource is done. (also, afk for a bit...)
[2013-09-24 18:00:45 -0400] fak3r: still having issues with getting a template defined by a recipe, here's what's failing -> https://gist.github.com/philcryer/6687940
[2013-09-24 18:01:50 -0400] juliancdunn: behemphi: I'm not sure what you're asking...
[2013-09-24 18:02:32 -0400] behemphi: hey Julian, thx for asking ...
[2013-09-24 18:02:59 -0400] behemphi: I issue this cmd knife ec2 server create <stuff> -S my-node -N my-node
[2013-09-24 18:03:08 -0400] behemphi: the knife node list
[2013-09-24 18:03:13 -0400] behemphi: in the list I see "my-node"
[2013-09-24 18:03:28 -0400] behemphi: so Hosted Chef knows the node is named "my-node"
[2013-09-24 18:03:43 -0400] behemphi: on the machine I run `sudo chef-shell`
[2013-09-24 18:04:00 -0400] behemphi: node.name tells me
[2013-09-24 18:04:00 -0400] behemphi: chef > node.name
[2013-09-24 18:04:01 -0400] behemphi:  => "ip-10-236-153-97.ec2.internal"
[2013-09-24 18:04:19 -0400] behemphi: I expect it to be "my-node" since that his the name of the node
[2013-09-24 18:04:31 -0400] juliancdunn: fak3r: you're not passing any variables to that template resource
[2013-09-24 18:04:42 -0400] behemphi: In the Rackspace cloud that is the behavior I am used to
[2013-09-24 18:04:46 -0400] juliancdunn: behemphi: are you running chef-shell in client mode or standalone?
[2013-09-24 18:05:03 -0400] behemphi: ah hell do i need a -z
[2013-09-24 18:05:08 -0400] juliancdunn: behemphi: yes sir
[2013-09-24 18:05:20 -0400] juliancdunn: otherwise, chef shell isn't loading the node object from Hosted Chef
[2013-09-24 18:05:56 -0400] behemphi: and the reason I saw it at RS is that RS lets me spec the hostname
[2013-09-24 18:06:01 -0400] behemphi: so mystery solved
[2013-09-24 18:06:10 -0400] behemphi: Thanks Julian (its Boyd Hemphill here)
[2013-09-24 18:06:22 -0400] juliancdunn: yeah, I figured by your nick that it was you behemphi :-)
[2013-09-24 18:08:22 -0400] miah: derp
[2013-09-24 18:15:24 -0400] dgarstang2: I can't get my head around this. One jenkins job per cookbook, or one job per jenkins cookbook that defines a role?
[2013-09-24 18:16:42 -0400] fak3r: juliancdunn: ok, thanks, will look for more examples
[2013-09-24 18:18:22 -0400] juliancdunn: fak3r: on line 38, the "#" won't actually stop the template processor from trying to render @params
[2013-09-24 18:20:50 -0400] arussel: is there a way to download an environment file from the server and put it into my chef-repo directory ?
[2013-09-24 18:21:22 -0400] jbz: knife environment show <environment> -Fjson
[2013-09-24 18:21:26 -0400] fak3r: juliancdunn: ok, that helped - now I see what I've done (we're not in bash anymore :/)
[2013-09-24 18:21:31 -0400] jbz: will dump the environment to stdout in json format
[2013-09-24 18:22:17 -0400] fak3r: only thing on mysql, can't get passwords to get set. cookbook page on opscode ""node['mysql']['server_root_password'] - Set the server's root password""
[2013-09-24 18:22:17 -0400] fak3r: "
[2013-09-24 18:22:42 -0400] arussel: jbz: thanks
[2013-09-24 18:22:46 -0400] fak3r: but in recipe this doesn't change it ""node.default['mysql']['server_root_password'] = "foobar""
[2013-09-24 18:22:49 -0400] jbz: arussel yw
[2013-09-24 18:25:33 -0400] miah: cookbooks don't define roles, roles define roles.
[2013-09-24 18:25:45 -0400] miah: many people abuse cookbooks and attempt to reimplement roles
[2013-09-24 18:27:02 -0400] sparr: I have what would be a one-cookbook role
[2013-09-24 18:27:12 -0400] sparr: in the run list of the relevant boxes I just have that cookbook
[2013-09-24 18:27:26 -0400] sparr: and I haven't actually implemented a role. seems like an unnecessary abstraction layer for now
[2013-09-24 18:28:21 -0400] arussel: what am I doing wrong in my spiceweasel file: http://pastebin.com/XPAPvbfX
[2013-09-24 18:28:33 -0400] arussel: I'm not a ruby dev and I'm having trouble debugging this
[2013-09-24 18:30:33 -0400] mattray: arussel: you want to show me the original file?
[2013-09-24 18:30:58 -0400] arussel: mattray: hmm, I've seen that username somewhere ...
[2013-09-24 18:31:16 -0400] mattray: I get around
[2013-09-24 18:32:13 -0400] fak3r: :)
[2013-09-24 18:32:50 -0400] dmdeklerk: "/Users/alexandrerussel/.rbenv/versions/1.9.3-p392/lib/ruby/gems/1.9.1/gems/spiceweasel-2.6.0/lib/spiceweasel/clusters.rb:41:in `block in cluster_process_nodes': undefined method `[]' for nil:NilClass (NoMethodError)" means some object on line 41 is nil. That tells you nothing unless you know which of your code is calling something in spiceweasel:23
[2013-09-24 18:33:28 -0400] arussel: mattray: http://pastebin.com/3UzqfNCz
[2013-09-24 18:33:42 -0400] kimba: What is the name of the chef cookbook that lets you change the check in time for a chef node...
[2013-09-24 18:33:58 -0400] miah: chef-client
[2013-09-24 18:34:03 -0400] miah: set its check in interval
[2013-09-24 18:35:22 -0400] kimba: it's currently set for 30 min's... I know there's one out there... I just can't find it..
[2013-09-24 18:35:25 -0400] mattray: ugh, this just in, YAML blows
[2013-09-24 18:35:32 -0400] mattray: arussel: indention
[2013-09-24 18:35:58 -0400] mattray: arussel: https://gist.github.com/6689246
[2013-09-24 18:36:08 -0400] miah: kimba: its configurable via the client.rb in /etc/chef
[2013-09-24 18:36:13 -0400] miah: the chef-client cookbook can manage that
[2013-09-24 18:36:36 -0400] teukka: miah: hey! could you help me with something?
[2013-09-24 18:36:41 -0400] miah: http://docs.opscode.com/config_rb_client.html
[2013-09-24 18:36:49 -0400] miah: teukka: ask question
[2013-09-24 18:37:17 -0400] teukka: miah: oh. I mean with what ever. I like to be helped by famous people :D
[2013-09-24 18:37:29 -0400] miah: heh. not famous. just productive =)
[2013-09-24 18:37:52 -0400] teukka: you are =)
[2013-09-24 18:38:01 -0400] teukka: miah: thanks for all the efforts!
[2013-09-24 18:38:27 -0400] miah: thanks
[2013-09-24 18:41:08 -0400] arussel: mattray: thanks working now. Is there an option to not hardcode the place of the pem file, an option to tell to build only the foo environment ? (I understand I can just create it in its own cluster file)
[2013-09-24 18:41:50 -0400] mattray: arussel: for the config, you can have it use your knife.rb with -c
[2013-09-24 18:42:06 -0400] mattray: and then just put whatever you want in there
[2013-09-24 18:42:44 -0400] mattray: for the environments right now it's just what's in the main file and/or a cluster file. Feel free to write up what you'd like in an issue and we can hash it out
[2013-09-24 18:43:09 -0400] arussel: mattray: thanks a lot. Love the tool and the doc is really nicely done.
[2013-09-24 18:43:22 -0400] mattray: thanks
[2013-09-24 18:53:07 -0400] dgarstang2: I can't get my head around this. One jenkins job per cookbook, or one job per jenkins cookbook that defines a role?
[2013-09-24 18:54:12 -0400] arussel: dgarstang2: third time I read you, I still don't understand the question :-)
[2013-09-24 18:56:22 -0400] dgarstang2: arussel: Oh. Jenkins building cookybooks...
[2013-09-24 18:56:58 -0400] miah: i have a single job per cookbook, regardless of function.
[2013-09-24 18:57:47 -0400] dgarstang2: miah: isn't that uneccessary tho? I mean... i you redeploy your base cookbook with berkshelf, it's gonna do the dependancies anyway right?
[2013-09-24 18:58:05 -0400] miah: i dont deploy via berkshelf. i deploy via jenkins.
[2013-09-24 18:58:20 -0400] dgarstang2: miah: how does jenkins get cookbooks to the chef servers?
[2013-09-24 18:58:26 -0400] miah: knife upload
[2013-09-24 18:58:37 -0400] dgarstang2: Hm.
[2013-09-24 18:58:44 -0400] teukka: I have three jobs per cookbook. one for fast unit tests, another for slow integration tests and third for uploading to the server
[2013-09-24 18:58:52 -0400] miah: also try to limit the amount of community cookbooks i depend on
[2013-09-24 18:59:09 -0400] miah: mostly because most cookbooks are authored in a way to make dependencies derpy.
[2013-09-24 18:59:34 -0400] miah: the problem being that most people see recipes as a way to do imperative programming
[2013-09-24 18:59:43 -0400] miah: but they dont realize that resources are evaluated and added a queue
[2013-09-24 19:00:08 -0400] ATX_123: i need to loop through a large static array to create some files on a server.  putting the variable inline seems ugly since it is about 100+ elements.  is there a way to include from an external file?
[2013-09-24 19:00:39 -0400] dmdeklerk: @ATX_123: what is YAML?
[2013-09-24 19:00:51 -0400] miah: sounds to me like you're making your problem harder than it needs to be
[2013-09-24 19:01:11 -0400] dgarstang2: miah: dunno. each cookbook has dependancies. gotta resolve them somehow.
[2013-09-24 19:01:23 -0400] miah: yes
[2013-09-24 19:01:34 -0400] miah: upload dependencies =)
[2013-09-24 19:01:47 -0400] miah: i fork and store locally all external dependencies
[2013-09-24 19:01:57 -0400] miah: and then try to reduce that
[2013-09-24 19:02:19 -0400] dgarstang2: miah, we're not, and before you tell me we should, don't.
[2013-09-24 19:02:40 -0400] dmdeklerk: @ATX_123: or http://www.ruby-doc.org/core-2.0.0/Kernel.html#method-i-load maybe?
[2013-09-24 19:03:08 -0400] ATX_123: dmdeklerk, thanks, i will look into it
[2013-09-24 19:03:56 -0400] miah: im not going to tell you anything you should do. i know where that leads =)
[2013-09-24 19:04:18 -0400] dgarstang2: miah: in a world without best practices, everyone has a different solution.
[2013-09-24 19:04:28 -0400] miah: its a good thing there are a ton of best practices
[2013-09-24 19:04:39 -0400] miah: they're just largely being ignored by the community. though mostly out of ignorance.
[2013-09-24 19:04:44 -0400] dgarstang2: miah: where? got a link to deploying cookbooks with jenkins?
[2013-09-24 19:04:57 -0400] dgarstang2: miah: how about a link to handling multiple chef servers?
[2013-09-24 19:05:19 -0400] dgarstang2: miah: how about a link to working with external and internal cookbooks?
[2013-09-24 19:05:36 -0400] miah: go read: http://www.amazon.com/Continuous-Integration-Improving-Software-Reducing/dp/0321336380 http://www.amazon.com/Continuous-Delivery-Deployment-Automation-Addison-Wesley/dp/0321601912
[2013-09-24 19:05:50 -0400] miah: its all the same shit. just different terms.
[2013-09-24 19:06:20 -0400] miah: i wrote a hack to community-zero, so i could resolve internal cookbooks from our github repository. it made dependency resolution trivial.
[2013-09-24 19:06:23 -0400] dgarstang2: miah: the concepts are the issue. it's the implementation details of those concepts with chef
[2013-09-24 19:06:27 -0400] dgarstang2: s/are/arent/
[2013-09-24 19:06:41 -0400] miah: i disagree. the implementaion is basically the same.
[2013-09-24 19:11:05 -0400] dgarstang2: miah: so your saying one of those books will tell me whether or not I need to have one jenkins job per cookbook, or whether environments should go in data bags?
[2013-09-24 19:11:50 -0400] miah: environments go in data bags?
[2013-09-24 19:12:07 -0400] miah: you should have one jenkins job per software project that requires testing
[2013-09-24 19:12:12 -0400] dgarstang2: miah: http://docs.opscode.com/essentials_environments.html search for 'Save in a Data Bag'
[2013-09-24 19:12:20 -0400] miah: each chef cookbook is its own unique software project
[2013-09-24 19:12:26 -0400] dgarstang2: miah: define 'software project' ?
[2013-09-24 19:12:51 -0400] dgarstang2: miah: so the fact that the role when used with berkshelf invalidates that need doesn't change anything?
[2013-09-24 19:12:58 -0400] prometheanfire: what version is the latest omnibus installer? I want to report a bug :D
[2013-09-24 19:13:17 -0400] miah: you need to stick to a single thing
[2013-09-24 19:13:22 -0400] miah: you cant jump all over the place
[2013-09-24 19:13:28 -0400] miah: lets continue with software project
[2013-09-24 19:13:48 -0400] miah: a series of codes, whether interpreted or compiled that will run on a system.
[2013-09-24 19:13:48 -0400] dgarstang2: miah: cookbooks aren't completely decoupled
[2013-09-24 19:13:54 -0400] miah: cookbooks are
[2013-09-24 19:14:02 -0400] miah: resources are their own private island
[2013-09-24 19:14:09 -0400] dgarstang2: miah: not if they have dependancies.
[2013-09-24 19:14:10 -0400] miah: resources know nothing about other resources
[2013-09-24 19:14:25 -0400] dgarstang2: miah: they also read data bags, environemnts, roles... that's also decoupling
[2013-09-24 19:14:38 -0400] miah: see. my personal opinion is that: most people using chef dont know any fucking thing about programming.
[2013-09-24 19:14:47 -0400] miah: programmers have solved all of these issues throughout the years
[2013-09-24 19:14:50 -0400] dgarstang2: miah: that's what the website says.
[2013-09-24 19:14:58 -0400] miah: so, now. as sysadmins coming in. we're trying to redo everything
[2013-09-24 19:15:06 -0400] miah: and stumbling over the same issues programmers did
[2013-09-24 19:15:07 -0400] dgarstang2: miah: why is it assumed that if your using chef your a programmer?
[2013-09-24 19:15:30 -0400] dmdeklerk: Question .. I want read only access from my node to my private bitbucket GIT repo.
[2013-09-24 19:15:36 -0400] miah: not understanding how chef works is a detrement to you actually being able to use it
[2013-09-24 19:15:38 -0400] dmdeklerk: Should `deploy_key` contain the contents of ~/.ssh/id_rsa as string?
[2013-09-24 19:15:47 -0400] dmdeklerk: Should I add ~/.ssh/id_rsa.pub in the "Add SSH Key" dialog on the bitbucket site?
[2013-09-24 19:15:53 -0400] miah: especially as you get into more complex scenerios
[2013-09-24 19:16:06 -0400] dgarstang2: miah: show me some good docs then
[2013-09-24 19:16:08 -0400] miah: the unfortunate job for opscode is that they need to reach the masses
[2013-09-24 19:16:20 -0400] dmdeklerk: deploy_key offcourse used in application LWRP
[2013-09-24 19:16:21 -0400] miah: so they dont try to push any specific styles
[2013-09-24 19:16:51 -0400] miah: the docs are piss poor i agree.
[2013-09-24 19:16:59 -0400] miah: they've certainly gotten better and im happy of that
[2013-09-24 19:17:14 -0400] cwj: dmdeklerk: yes, deploy_key should contain the key data (contents)
[2013-09-24 19:17:24 -0400] miah: but everybody should try to educate themselves on ruby, and the actual workings of chef
[2013-09-24 19:17:31 -0400] dgarstang2: miah: ah ruby
[2013-09-24 19:17:38 -0400] cwj: dmdeklerk: and yes the key you provide needs to be authorized with read access on the repo you want to deploy from
[2013-09-24 19:17:38 -0400] miah: if they are going to try to do complicated things, and use chef in ways that may be a stretch from the documentation
[2013-09-24 19:17:47 -0400] prometheanfire: ruby, a nice language with horrible packaging
[2013-09-24 19:17:55 -0400] miah: all languages have horrible packaging
[2013-09-24 19:18:00 -0400] miah: there is no such thing as a good packaging system
[2013-09-24 19:18:05 -0400] miah: even nixos is complex
[2013-09-24 19:18:05 -0400] prometheanfire: python is nice :P
[2013-09-24 19:18:13 -0400] miah: python is not perfect either
[2013-09-24 19:18:15 -0400] prometheanfire: also, ebuilds are nice
[2013-09-24 19:18:19 -0400] miah: getting a working easy_install can be nontrivial
[2013-09-24 19:18:19 -0400] chip-: Omnibus is pretty swell. :)
[2013-09-24 19:18:19 -0400] prometheanfire: not perfect
[2013-09-24 19:18:23 -0400] arussel: dmdeklerk: but don't use your own keys, create a new set for the purpose of chef.
[2013-09-24 19:18:24 -0400] prometheanfire: but that's not what I was saying
[2013-09-24 19:18:26 -0400] miah: especially on older macs
[2013-09-24 19:18:36 -0400] miah: omnibus is basically a poormans lxc =)
[2013-09-24 19:18:43 -0400] prometheanfire: omnibus, lets just untar stuff and link to diferent places
[2013-09-24 19:18:45 -0400] miah: chroot all the things
[2013-09-24 19:18:47 -0400] dmdeklerk: @arussel. Is there a naming scheme?
[2013-09-24 19:18:48 -0400] prometheanfire: not an actual installer
[2013-09-24 19:18:50 -0400] dgarstang2: i wouldn't call either of those packaging systems. RPM, DEB are packaging systems, and while debian packages is a black art, it works well.
[2013-09-24 19:19:19 -0400] prometheanfire: well, packaging to me is the entire process, building the install binary as well
[2013-09-24 19:19:25 -0400] dgarstang2: if the devs here had their way, we'd deploy software with 'git clone'.
[2013-09-24 19:19:27 -0400] dmdeklerk: @cwj. thnks
[2013-09-24 19:19:32 -0400] miah: a packaging system is any system that produces a container of software that is either pre-compiled, or source code to be interpreted later.
[2013-09-24 19:19:45 -0400] miah: it doesnt mean it _has_ to have post-install scripts
[2013-09-24 19:19:50 -0400] arussel: dmdeklerk: I believe ssh will look into ~/.ssh/id_rsa but you can change it
[2013-09-24 19:19:56 -0400] prometheanfire: so, what is the latest version of the omnibus installer? install.sh doesn't have a version string in it
[2013-09-24 19:20:05 -0400] miah: so, cpan, gem, etc are all valid
[2013-09-24 19:20:22 -0400] dmdeklerk: @arussel so basically ~/.ssh/id_rsa_1, 2 etc. could exist?
[2013-09-24 19:20:28 -0400] dgarstang2: miah: most packaging systems tied around software like ruby or perl execute more scripts than deploy files, which means its kind more like a script than a packaging system. Scripts are hard to unexecute.
[2013-09-24 19:20:35 -0400] dgarstang2: s/perl/python/
[2013-09-24 19:20:49 -0400] prometheanfire: miah: not saying it has to either, but I mean the entire process, including bootstraping
[2013-09-24 19:21:02 -0400] miah: rpm deb etc all run tons of scripts
[2013-09-24 19:21:08 -0400] miah: many have pre and post install
[2013-09-24 19:21:12 -0400] miah: so saying that is just wrong
[2013-09-24 19:21:16 -0400] prometheanfire: chef has a postinstall :D
[2013-09-24 19:21:20 -0400] dgarstang2: anyway, back to looking for docs on building cookbooks with chef, how to handle multiple enviroments... good luck to me.
[2013-09-24 19:21:32 -0400] miah: thats why i say, go educate yourself
[2013-09-24 19:21:34 -0400] miah: then write the docs
[2013-09-24 19:21:42 -0400] miah: because nobody is going to do it for you
[2013-09-24 19:21:48 -0400] miah: our community has a ways to go
[2013-09-24 19:21:54 -0400] prometheanfire: does no one know what version of the omnibus installer is currently in use?
[2013-09-24 19:22:04 -0400] prometheanfire: I'm trying to update a bug
[2013-09-24 19:22:05 -0400] miah: prometheanfire: /topic
[2013-09-24 19:22:14 -0400] arussel: dmdeklerk: sure, this is why you often see the ssh command with '-i ~/foo.pem', this is to indicate the place of your private key. (~/.ssh/chef_project.pem might be a better name than id_rsa_1)
[2013-09-24 19:22:18 -0400] prometheanfire: it's not in the topic
[2013-09-24 19:22:20 -0400] cilquirm: hi, quick q  :  how do i force a node to converge as if it's never been done before
[2013-09-24 19:22:25 -0400] dgarstang2: miah: that argument irks me. It's like 'wear headphones to cut out noise'. Can't write docs until I understand it. I can reverse engineer it, but that means I'd be writing doc on false assumptions
[2013-09-24 19:22:31 -0400] miah: if youre talking about omnibus omnibus go ask in #chef-hacking
[2013-09-24 19:22:34 -0400] prometheanfire: that's what the installer installs, not the installer itself
[2013-09-24 19:22:42 -0400] prometheanfire: ok
[2013-09-24 19:23:15 -0400] dmdeklerk: @arussel. that was the answer I was looking for. offcourse thanks
[2013-09-24 19:23:32 -0400] dmdeklerk: https://rubygems.org/gems/omnibus 1.2.0
[2013-09-24 19:23:45 -0400] freezey: anyone have news on the chef-server 11.0.10 release?
[2013-09-24 19:24:50 -0400] prometheanfire: ty
[2013-09-24 19:25:29 -0400] cilquirm: hi, quick q  :  how do i force a node to converge as if it's never been done before
[2013-09-24 19:26:48 -0400] siezer: you cant
[2013-09-24 19:27:06 -0400] siezer: you mean restore it to a pre-chef state?
[2013-09-24 19:30:55 -0400] jhulten: Anyone used start_handlers in client.rb
[2013-09-24 19:30:57 -0400] jhulten: ?
[2013-09-24 19:32:15 -0400] jhulten: cilquirm: There isn't a force in that sense. It will do what your resources specify whether there are one change needed or 100.
[2013-09-24 19:36:15 -0400] cwj: jhulten: i use start handlers but mine are recipe defined
[2013-09-24 19:36:19 -0400] cilquirm: siezer, jhulten i want it to run the recipes again
[2013-09-24 19:54:16 -0400] fak3r: anyone have an example of using the nfs cookbook? Not understanding how to create the exports
[2013-09-24 20:00:45 -0400] jmickle: does a node have a total memory attribute?
[2013-09-24 20:03:38 -0400] jhulten: cilquirm: It will run again for anything that is not in the expected state. This is the 'idempotent' part of chef. There isn't a "ignore the current state" flag.
[2013-09-24 20:03:51 -0400] jhulten: cwj: What do you use them for?
[2013-09-24 20:07:06 -0400] sparr: jmickle: I don't think so
[2013-09-24 20:21:34 -0400] cwj: jhulten: silencing monitoring checks on a node for the duration of the chef run
[2013-09-24 20:21:54 -0400] cwj: sensu checks specifically
[2013-09-24 20:27:39 -0400] danger_: hey guys i am try to run chef-client via box A which in turn does a chef-client(in between my recipe) to box B via box A
[2013-09-24 20:28:01 -0400] danger_: like ssh root@B 'chef-client -o "role[Test123]"'
[2013-09-24 20:28:08 -0400] danger_: it is working smoothly
[2013-09-24 20:28:43 -0400] danger_: but i want to send a runtime property to box B's recipe
[2013-09-24 20:28:49 -0400] danger_: is that possible
[2013-09-24 20:29:20 -0400] danger_: so like ssh root@B 'chef-client -o "role[Test123]"' value1 = x
[2013-09-24 20:31:59 -0400] jhulten: cwj: do you have example code anywhere? we are looking for similar things with load balancers
[2013-09-24 20:32:02 -0400] bean__: danger_: you may want to look at the -j attribute
[2013-09-24 20:32:25 -0400] danger_: i am working on load balancer for my team as well
[2013-09-24 20:32:42 -0400] danger_: bean_ can you point us to an example
[2013-09-24 20:33:46 -0400] mattjalexander: when using chef-zero with test-kitchen, how do use specific databags?
[2013-09-24 20:34:25 -0400] wamilton: anyone know if there's a way to 'expand attributes' for a given node, including roles and environments?
[2013-09-24 20:36:28 -0400] danger_: bean__ can you point us to an example
[2013-09-24 20:36:37 -0400] bean__: nope
[2013-09-24 20:38:31 -0400] danger_: bean__ thanks for the pointer
[2013-09-24 20:39:42 -0400] gchristensen: danger_: 0x3A28213A
[2013-09-24 20:40:32 -0400] danger_: gchristensen hahaha
[2013-09-24 20:41:05 -0400] danger_: jhulten this is how i am going to do it
[2013-09-24 20:41:26 -0400] danger_: knife bootstrap IP_OF_THE_NODE -r 'role[main_application]' -j '{ "network_interfaces" : {"device" : "bazinga"}}'
[2013-09-24 20:44:06 -0400] gchristensen: I want to make a LWRP which lets me mirror a webpage on a regular basis. I'm thinking about making: `mirror_website` write a script at a supplied path, and then using the cron resource separately to schedule it, and then bundling the two up into mirror_website_scheduled with an aggregate of the most common attributes. does this make sense? it seems a bit strange to me, but it can't possibly mirror it in-line:
[2013-09-24 20:44:08 -0400] gchristensen: it could take an hour+ to mirror the site.
[2013-09-24 20:44:34 -0400] jameson__: @_@
[2013-09-24 20:44:44 -0400] jameson__: sounds like you are suppose to kick off a background task or something
[2013-09-24 20:45:07 -0400] gchristensen: exactly, so none of these LWRPs woulda ctually run in-line, but add a script which would have the logic, and then add the script to a cron entrty.
[2013-09-24 20:45:34 -0400] gchristensen: but that seems like a weird separation of responsibilities
[2013-09-24 20:45:42 -0400] jameson__: gchristensen: but, if the job is regular, couldn't you make it just run regularly?
[2013-09-24 20:45:56 -0400] gchristensen: come again?
[2013-09-24 20:46:01 -0400] jameson__: the script itself is static
[2013-09-24 20:46:05 -0400] gchristensen: yeah
[2013-09-24 20:46:13 -0400] jameson__: chef is only responsible for adding the crontab line at start if necessary
[2013-09-24 20:46:19 -0400] jameson__: and making sure it's enabled
[2013-09-24 20:46:19 -0400] gchristensen: right
[2013-09-24 20:46:21 -0400] gchristensen: yep
[2013-09-24 20:46:29 -0400] gchristensen: perhaps a paste would be helpful :)
[2013-09-24 20:46:39 -0400] gchristensen: one moment
[2013-09-24 20:46:47 -0400] jameson__: so you just want a template file that turns into the script and the cron LWRP
[2013-09-24 20:48:21 -0400] bean__: danger_: sorry I was in a meeting
[2013-09-24 20:48:38 -0400] danger_: thats fine
[2013-09-24 20:48:44 -0400] danger_: this is what i got  knife bootstrap IP_OF_THE_NODE -r 'role[main_application]' -j '{ "network_interfaces" : {"device" : "bazinga"}}'
[2013-09-24 20:48:52 -0400] danger_: i am going to try it soon
[2013-09-24 20:48:58 -0400] bean__: that sounds correct
[2013-09-24 20:49:22 -0400] danger_: i hope "network_interfaces" is the cookbook name in this example
[2013-09-24 20:49:35 -0400] danger_: i am very new to chef and ruby ...correct me if wrong
[2013-09-24 20:49:52 -0400] bean__: I believe its just the attribute name
[2013-09-24 20:50:35 -0400] danger_: oki so u mean i can just have {"device" : "bazinga"} if i am only intrested in that value
[2013-09-24 20:50:40 -0400] danger_: cool thanks
[2013-09-24 20:51:25 -0400] bean__: I think so
[2013-09-24 20:51:33 -0400] bean__: unsure
[2013-09-24 20:52:48 -0400] bean__: danger_: http://gettingstartedwithchef.com/introducing-chef-server.html down in the "Bootstrapping a node with Knife" bit
[2013-09-24 20:55:12 -0400] cwj: jhulten: try https://github.com/needle-cookbooks/chef-sensu-handler
[2013-09-24 20:56:09 -0400] gchristensen: jameson__: what do you think, is this LWRP's knowledge about 1) the script, 2) the location of the script, and 3) how to add it to cron too much? https://gist.github.com/grahamc/d5db090a41b24fef2ec7
[2013-09-24 20:57:58 -0400] jameson__: that seems reasonable.
[2013-09-24 20:58:22 -0400] jameson__: gchristensen: the LWRP should wrap the template file, etc.
[2013-09-24 20:58:26 -0400] gchristensen: of course
[2013-09-24 20:58:50 -0400] gchristensen: that one would call another LWRP called mirror_website_script
[2013-09-24 21:00:37 -0400] jameson__: yes? I feel like you will only call mirror_website_script from this LWRP, so it might be better off being rolled into one.
[2013-09-24 21:01:49 -0400] gchristensen: I suppose. I was going to wrap it in order to reduce the size of that LWRP... I try not to have anything do too much
[2013-09-24 21:02:18 -0400] jameson__: :3 I have long LWRPs, but from what you are saying, this seems perfectly reasonable.
[2013-09-24 21:02:26 -0400] gchristensen: excellent
[2013-09-24 21:02:50 -0400] jameson__: mirroring for failover purposes I assume :3? or CDN?
[2013-09-24 21:03:01 -0400] gchristensen: yeah, static failover
[2013-09-24 21:03:16 -0400] gchristensen: my company has offered it as a service to a few customers, but its always been a hackjob. fixing that right up.
[2013-09-24 21:03:52 -0400] jameson__: nice.
[2013-09-24 21:05:12 -0400] gchristensen: yeah, should be good. I'm hoping we can upsell more customers on it once its more available en-masse. some bigger customers don't allow anything that isn't static in production in the first place, so it might even open us up to some new markets.
[2013-09-24 21:07:48 -0400] jameson__: hehe
[2013-09-24 21:07:51 -0400] jameson__: business value.
[2013-09-24 21:07:52 -0400] jameson__: hehe
[2013-09-24 21:08:24 -0400] gchristensen: and a simple thing to do, too :)
[2013-09-24 21:24:10 -0400] danger_: i was using -j option to send config at runtime while running chef client
[2013-09-24 21:24:18 -0400] danger_:  chef-client -o "role[Test456]" --json-attributes '{"Test456":{"device" : "bazinga"}}'
[2013-09-24 21:24:34 -0400] danger_: i get
[2013-09-24 21:24:34 -0400] danger_: WARN: Did not find config file: /etc/chef/client.rb, using command line options.
[2013-09-24 21:24:41 -0400] danger_: FATAL: I cannot find {"Test456":{"device" : "bazinga"}}
[2013-09-24 21:25:19 -0400] danger_: i also tried  -j
[2013-09-24 21:25:53 -0400] cwj: danger_: the usage for that flag indicates it expects a file path or url
[2013-09-24 21:26:03 -0400] cwj: chef-client --help
[2013-09-24 21:26:32 -0400] gchristensen: lol... I've imported this database dump into this server three times now, and right when its about to finish (a 5 hour process) the hypervisor crashes.
[2013-09-24 21:31:00 -0400] danger_: cwj then i have to create json file on the fly to pass any value via chef-client at runtime
[2013-09-24 21:31:20 -0400] danger_: is there any better way to pass value via chef-client?
[2013-09-24 21:31:49 -0400] cwj: danger_: you could try a data bag
[2013-09-24 21:32:41 -0400] danger_: u mean create data bag at runtime ? its not an encrypted stuff
[2013-09-24 21:33:36 -0400] danger_: he thing is , its not a constant value , I have to generate a value on the fly and run the chef client
[2013-09-24 21:33:43 -0400] danger_: the*
[2013-09-24 22:17:56 -0400] azret: anyone know how to reset an organization, i seemed to have locked myself out of my own by deleting myself as a client
[2013-09-24 22:21:35 -0400] jbz: azret: on hosted chef?
[2013-09-24 22:21:59 -0400] miah: email support@opscode.com
[2013-09-24 22:22:46 -0400] azret: yea i figuredyes on hosted chef jbz
[2013-09-24 22:22:58 -0400] jbz: yeah what miah saidd:-)
[2013-09-24 22:23:29 -0400] jesseadams: Is there anyway to get chefspec to output stuff that didn't match an expectation but was in the same context? I am trying to use expect(chef_run).to create_remote_file but it fails and doesn't give much info
[2013-09-24 22:24:07 -0400] jesseadams: tried to search for a solution, may be using the wrong search terms and/or not know the proper naming for something like this
[2013-09-24 22:24:27 -0400] fak3r: php_apc installing via the opscode php cookbook, timing out?
[2013-09-24 22:27:48 -0400] juliancdunn: fak3r: IIRC that cookbook installs stuff from pear.php.net, maybe it's broken
[2013-09-24 22:28:46 -0400] fak3r: juliancdunn:  I think so, it's timing out :(
[2013-09-24 22:29:00 -0400] fak3r: so how can I add a local YUM repo? (we have one in house here apparently)
[2013-09-24 22:29:33 -0400] juliancdunn: fak3r: look into the yum cookbook
[2013-09-24 22:29:43 -0400] juliancdunn: it has a yum_repository resource that you can use declaratively
[2013-09-24 22:30:02 -0400] fak3r: ok, thanks
[2013-09-24 22:31:26 -0400] fak3r: ok, found resources/repository.rb
[2013-09-24 22:35:46 -0400] aslan: hey guys. i have one recipe that is acting up a little bit. once i upload it it runs fine. next time the run list can't find it . i do a knife cookbook show recipes and its not listed! what is happening to this recipes?
[2013-09-24 22:35:58 -0400] juliancdunn: yeah, if you read the README it'll tell you how to use it fak3r
[2013-09-24 22:42:08 -0400] aslan: hey guys. i have one recipe that is acting up a little bit. once i upload it it runs fine. next time the run list can't find it . i do a knife cookbook show recipes and its not listed! what is happening to this recipes? is it solr?
[2013-09-24 22:53:05 -0400] miah: look at the cookbooks metadata.rb
[2013-09-24 22:53:11 -0400] miah: it should define a 'name'
[2013-09-24 22:53:20 -0400] miah: if it doesnt, then knife names it based on the directory name
[2013-09-24 22:53:35 -0400] miah: fwiw all metadata.rb should have a 'name' but many don't.
[2013-09-24 23:02:59 -0400] aslan: miah: i have never setup name in my cookbooks metadata.rb what are the implications?
[2013-09-24 23:09:25 -0400] miah: that the name could vary if your directory name varies
[2013-09-24 23:11:18 -0400] jblack: Hey guys.  I thinka recent commit to the  postfix cookbook is causing me trouble with vagrant&chef.
[2013-09-24 23:12:25 -0400] juliancdunn: aslan: also, Chef may eventually care... some external tools already do
[2013-09-24 23:12:37 -0400] jblack: https://github.com/opscode-cookbooks/postfix/blob/master/attributes/default.rb#L40  has  "default['postfix']['main']['mydomain'] = node['domain'].chomp('.') || node['hostname'].chomp('.')"
[2013-09-24 23:13:49 -0400] jblack: I think the problem is that when vagrant includes the postfix cookbook, but  domain and/or hostname attributes aren't set, then loading the postfix cookbook breaks
[2013-09-24 23:13:51 -0400] aslan: juliancdunn: i have never used anything other than knife. I am just interested to know what kind of tools you usually use?
[2013-09-24 23:14:07 -0400] maraca: hey guys - how can i check that a recipe is running on a box? using host.recipes I only get what's on the run list. I'm looking for a list of all recipes.
[2013-09-24 23:15:58 -0400] juliancdunn: aslan: Berkshelf cares, I think
[2013-09-24 23:16:24 -0400] chgravier: Hello everyone, I am using the generic-users cookbook to fetch a user's info from a databag. Is it ok to call the user LWRP afterwards to effectively create user (like I did here: https://gist.github.com/cgravier/f61f75e27504833184b9), or isn't this cookbook supposed to create the user in the system ? I'm confused (and unexperienced :s). Thanks you in advance  if you have any experience in this cookbook !
[2013-09-24 23:16:30 -0400] juliancdunn: jblack: even Vagrant boxes should have one of those... well-built ones should that is
[2013-09-24 23:17:10 -0400] aslan: maraca: all the cookbooks that you use are going to be dumped into a cache folder. in my case its in /var/chef/cache/cookbooks/
[2013-09-24 23:17:26 -0400] jblack: Ok. I'll add hostname in =)
[2013-09-24 23:17:55 -0400] maraca: aslan, unfortunately that's not accurate enough :/ since Chef 11 loads all recipes of a cookbook in cache
[2013-09-24 23:18:10 -0400] jblack: I'm not sure what I did to cause hostname and domain to get stripped out of vagrant nodes.
[2013-09-24 23:18:12 -0400] juliancdunn: jblack: your Vagrantfile could set config.vm.hostname,that'd do it
[2013-09-24 23:18:30 -0400] maraca: i need to know if a recipe is actually included - im working on a recipe from a separate cookbook, that needs to know if another recipe has been included or not on the node
[2013-09-24 23:19:33 -0400] jblack: I must have deleted that on accident. I just reworked  vagrantfile a bit yesterday
[2013-09-24 23:19:46 -0400] aslan: maraca: how about running chef-client -l debug and greping for the recipe name?
[2013-09-24 23:20:29 -0400] aslan: maraca: from what i know if a recipe is included in an external recipe the external recipe will fail until the cookbook is listed in its dependencies under metadata.rb
[2013-09-24 23:22:51 -0400] aslan: juliancdunn: Berkshelf was interesting. i didn't know about it. what else do you keep in your tool set? (regardless of name attribute in metadata.rb)
[2013-09-24 23:23:20 -0400] maraca: aslan, im trying to execute an action on a template based on whether the recipe is included or not
[2013-09-24 23:24:31 -0400] maraca: aslan, roughly something like that https://github.com/Spaaza/chef-logstash/blob/b289fed2a1dde0950eabe677f13450e92acfd7d9/templates/default/init.erb#L15
[2013-09-24 23:24:37 -0400] maraca: except this doesn't seem to work
[2013-09-24 23:25:09 -0400] maraca: thanks for your help btw aslan !
[2013-09-24 23:26:23 -0400] juliancdunn: aslan: oh, all manner of things... I work for Opscode :)
[2013-09-24 23:27:04 -0400] aslan: maraca: np, i am sure there is a way to do this, node object has a run list and there should be a way to expand it and get an array or recipes and see if the recipe you want is included or now
[2013-09-24 23:27:07 -0400] aslan: not*
[2013-09-24 23:27:40 -0400] maraca: yeah - i did a search on github, looks like a bunch of tickets were open since node.recipe was deprecated
[2013-09-24 23:28:05 -0400] juliancdunn: can't you use a guard like this:
[2013-09-24 23:28:14 -0400] juliancdunn: only_if { node.run_list.include?("recipe[whatever]") }
[2013-09-24 23:28:23 -0400] juliancdunn: ^ maraca
[2013-09-24 23:30:01 -0400] maraca: trying now juliancdunn
[2013-09-24 23:30:34 -0400] maraca: juliancdunn, no since it's not in my run_list, it's included in the code of the recipe.
[2013-09-24 23:31:23 -0400] maraca: looks like this might be what im looking for http://docs.opscode.com/breaking_changes_chef_11.html#node-run-state-replaced
[2013-09-24 23:33:12 -0400] juliancdunn: maraca: oh, you mean like via include_recipe
[2013-09-24 23:33:24 -0400] maraca: yeah - sorry i suck at explaining stuff :(
[2013-09-24 23:34:03 -0400] juliancdunn: that's ok... yeah, if you poke at run_context it should work
[2013-09-24 23:34:04 -0400] maraca: basically im trying to find out if another cookbook's recipe did an include_recipe on a particular recipe. If so, take action in the template.
[2013-09-24 23:36:40 -0400] dgarstang2: the chef-client cookbook...
[2013-09-24 23:39:00 -0400] dgarstang2: if I want to use cron, i set node["chef_client"]["init_style"] = "none" ?
[2013-09-24 23:39:21 -0400] dgarstang2: cuz... node["chef_client"]["init_style"] = "cron" seems to use /etc/init.d/chef-service
[2013-09-24 23:41:32 -0400] dgarstang2: oh, so I have to include chef-client::cron. What's the point of having both that and the attribute?
[2013-09-24 23:44:05 -0400] miah: ouch
[2013-09-24 23:53:58 -0400] dgarstang2: What's the best way to override a broken template in a wrapper cookbook?
[2013-09-24 23:55:24 -0400] dgarstang2: What's the best way to override a broken template in a wrapper cookbook?
[2013-09-24 23:56:58 -0400] juliancdunn: dgarstang2: I use jtimberman's trick of resources("template[/etc/whatever.conf]").cookbook "wrapper"
[2013-09-24 23:57:19 -0400] dgarstang2: juliancdunn: i was reading that. i have no idea jay
[2013-09-24 23:57:29 -0400] dgarstang2: oops... no idea whats going on with that
[2013-09-24 23:58:22 -0400] dgarstang2: this? https://gist.github.com/fujin/1713157
