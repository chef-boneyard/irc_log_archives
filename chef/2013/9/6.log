[2013-09-06 00:01:21 -0400] tasslehawf: https://github.com/hayesmp/jenkinsbox-cookbook/blob/master/recipes/jenkins.rb
[2013-09-06 00:01:50 -0400] tasslehawf: undefined method `jenkins_cli' for Chef::Resource::Execut
[2013-09-06 00:02:40 -0400] jameson__: tasslehawf: are you creating a jenkins box @_@?
[2013-09-06 00:04:09 -0400] tasslehawf: @jameson: yes. I'm trying to install the github plugin and restart jenkins
[2013-09-06 00:06:09 -0400] jameson__: you should be doing just jenkins_clie "blahblahblah"
[2013-09-06 00:06:28 -0400] jameson__: you are asking execute to set the attribute 'jenkins_cli' to "blahblahblah" and run
[2013-09-06 00:06:46 -0400] tasslehawf: OH
[2013-09-06 00:06:55 -0400] tasslehawf: heh
[2013-09-06 00:07:06 -0400] tasslehawf: thanks
[2013-09-06 01:05:55 -0400] bixu: Can I expect environment attributes to be available to chef-client during the initial compile that takes place upon bootstrap?
[2013-09-06 01:10:18 -0400] jameson__: I believe so
[2013-09-06 01:10:25 -0400] jameson__: https://github.com/opscode/chef-fundamentals/blob/master/slides/anatomy-of-a-chef-run/01_slide.md
[2013-09-06 01:11:33 -0400] bixu: jameson__: ...because I'm not seeing override attributes showing up...
[2013-09-06 01:12:29 -0400] jameson__: ah, during initial bootstrap only the defaults are available
[2013-09-06 01:12:49 -0400] bixu: I see.  Well, that explains it :)
[2013-09-06 01:13:04 -0400] jameson__: http://docs.opscode.com/essentials_nodes_chef_run.html
[2013-09-06 01:13:09 -0400] bixu: What about attributes I set in a recipe?
[2013-09-06 01:14:47 -0400] bixu: It looks like that should work?
[2013-09-06 01:15:19 -0400] jameson__: yes?
[2013-09-06 01:16:05 -0400] jameson__: wait.. actually you should have all the variables
[2013-09-06 01:16:15 -0400] bixu: Oh - but this sucks, because I need to create an a-record in DNS zones that map to my Chef environments.
[2013-09-06 01:16:36 -0400] bixu: That is, I really need these attributes to be in my envs.
[2013-09-06 01:16:38 -0400] jameson__: attribute, recipes, etc are all resolved before the convergence so
[2013-09-06 01:16:46 -0400] bixu: But not environments?
[2013-09-06 01:17:05 -0400] jameson__: environments should be there too.
[2013-09-06 01:17:26 -0400] jameson__: unless you are doing stuff with the node attribute during the initial resource collection
[2013-09-06 01:17:35 -0400] jameson__: which I believe was called the compile phase?
[2013-09-06 01:17:40 -0400] bixu: Yes.
[2013-09-06 01:17:44 -0400] bixu: It is called that.
[2013-09-06 01:17:48 -0400] bixu: is/was
[2013-09-06 01:18:15 -0400] bixu: I'm not overriding ohai attributes - just adding attributes that are specific to the dynect cookbook.
[2013-09-06 01:19:24 -0400] jameson__: yeah the attribute should already be there during the compile/convergence phase
[2013-09-06 01:19:58 -0400] bixu: So I just need to figure out why it's not.
[2013-09-06 01:21:08 -0400] jameson__: i'd recommend shef or Chef::Log.info to print stuff
[2013-09-06 01:21:41 -0400] jameson__: i remember foodfightshow mentioned there is a tool that will break a chef run and drop you into an interactive environment somewhere.
[2013-09-06 01:22:14 -0400] jameson__: chef-shell :3
[2013-09-06 01:23:06 -0400] jameson__: bixu: http://docs.opscode.com/chef_shell.html
[2013-09-06 01:25:25 -0400] jameson__: now the other thing I am about to find out is if directory resource was indempotent
[2013-09-06 01:25:41 -0400] jameson__: idempotent.
[2013-09-06 01:36:45 -0400] bixu: Yes - this used to be called "shef".
[2013-09-06 01:36:51 -0400] bixu: I can't imagine why the name was changed.
[2013-09-06 01:44:36 -0400] AlainODea: bixu: shef was a great name. chef-shell --client does the job, but it's a bit verbose. You can create an alias :)
[2013-09-06 01:44:51 -0400] bixu: AlainODea: I know :)
[2013-09-06 01:45:23 -0400] bixu: But I also understand the difficulty of talking about 'chef' and 'shef' on, say, a phone call.
[2013-09-06 01:45:38 -0400] AlainODea: bixu: good point!
[2013-09-06 01:46:11 -0400] AlainODea: bixu: is there a proper way to exit a recipe? I have a precondition type scenario with Java license acceptance
[2013-09-06 01:46:31 -0400] AlainODea: If I don't stop the recipe it will fail after a while with a memory issue
[2013-09-06 01:46:54 -0400] bixu: AlainODea: I'm not sure I fully understand the use case.
[2013-09-06 01:47:18 -0400] Prad123: hi
[2013-09-06 01:47:44 -0400] Prad123: can any 1 help me on chef windows plugin??
[2013-09-06 01:47:47 -0400] bixu: AlainODea: Maybe have a look at some work we did here? https://github.com/wanelo-chef/java
[2013-09-06 01:47:54 -0400] AlainODea: Here's the situation. The java recipe on SmartOS will attempt to run, but if node['java']['accept_license_agreement'] isn't set it will fail
[2013-09-06 01:48:44 -0400] AlainODea: The site distributed java cookbook now works with Eric's fixes in, but the failure mode for non-README readers is confusing :D
[2013-09-06 01:50:57 -0400] AlainODea: Prad123: I've used it a little bit. I may be able to help. What is happening?
[2013-09-06 01:51:16 -0400] bixu: AlainODea: I'm still not sure I understand your problem.
[2013-09-06 01:51:55 -0400] bixu: Maybe have a site-specific cookbook that runs the java recipe only if that node attribute is set?
[2013-09-06 01:52:12 -0400] AlainODea: bixu: package[sun-jdk6] action install fails with [FATAL] failed to allocate memory
[2013-09-06 01:52:12 -0400] AlainODea: bixu: it suggests a totally separate kind of problem
[2013-09-06 01:52:37 -0400] bixu: Oh - that's really odd.
[2013-09-06 01:52:44 -0400] bixu: What does debug mode say?
[2013-09-06 01:53:21 -0400] AlainODea: bixu: I'm not worried about my own setup. Now that I know, I set an override for node['java']['accept_license_agreement'] in my roles
[2013-09-06 01:54:48 -0400] AlainODea: Watching with Cloud Analytics the memory is being used by ruby.  I suspect it is freaking out and continuously buffering many copies of Sun's old license agreement.  Not sure why it keeps them in memory
[2013-09-06 01:55:10 -0400] AlainODea: The installer has an interactive step to accept the DLJ
[2013-09-06 01:55:46 -0400] AlainODea: This is going away very soon. I am prepping a Pull Request for the java cookbook that will get it to use openjdk on SmartOS
[2013-09-06 01:55:52 -0400] rockpunk: hola! i'm trying to use the community postfix cookbook but i'm running into a circular dependency problem. i'd like to use an attribute that looks like: default['postfix']['main']['virtual_uid_maps'] = "static:#{pfix_user['uid']}". The problem is, the postfix user isn't created yet (it's created in the postfix package resource). I think I'm approaching this the wrong way and would appreciate some guidance. thanks!
[2013-09-06 02:00:58 -0400] bixu: AlainODea: That sounds like the right plan.
[2013-09-06 02:01:57 -0400] AlainODea: rockpunk: does the postfix user need to own the mailboxes? Are there usage examples for that attribute?
[2013-09-06 02:02:55 -0400] AlainODea: rockpunk: I'm not overly deep with postfix, but here is the doc for that piece. I think I am reading it correctly. http://www.postfix.org/postconf.5.html#virtual_uid_maps
[2013-09-06 02:03:06 -0400] bixu: rockpunk: It's quite common to have community cookbooks that set some stuff up and then site-specific (and possibly private) cookbooks that set up configs just for you (like custom permissions).  Think of these as 'overlay' cookbooks.
[2013-09-06 02:03:11 -0400] AlainODea: bixu: cool. Thanks :)
[2013-09-06 02:04:24 -0400] rockpunk: AlainODea: the way i set up postfix is that it is only handling virtual users that don't exist on the system. i could have them being owned by 'mail' i suppose, but i figured postfix made more sense since it was the process that wrote the files on disk.
[2013-09-06 02:06:32 -0400] rockpunk: AlainODea: where the 'files on disk' are the maildir files for each virtual user. so... yeah, that's what i'm trying to replicate in chef. i *think* i'm using a site-specific cookbook cause i'm modifying the community cookbook with all my changes and uploading to my personal chef acct...
[2013-09-06 02:09:11 -0400] rockpunk: so i tried to put Etc::getpwnam('postfix') somewhere in the recipe (after running package 'postfix') thinking that the user would be created, but it appears that chef doesn't work that way. it will try to parse to parse the recipe and attributes before running the package.
[2013-09-06 02:11:50 -0400] AlainODea: rockpunk: I suspect the default would achieve that.  You should be able to leave virtual_uid_maps unchanged if my understanding is correct.
[2013-09-06 02:12:46 -0400] rockpunk: AlainODea: oh! i didn't even think of that... that's a good idea. will try to see if that works.
[2013-09-06 02:13:12 -0400] AlainODea: rockpunk: good stuff :)
[2013-09-06 02:13:43 -0400] Prad123: hi all
[2013-09-06 02:13:51 -0400] AlainODea: Prad123: hi
[2013-09-06 02:14:13 -0400] Prad123: need some help on knife bootstrap windows command
[2013-09-06 02:14:13 -0400] AlainODea: Prad123: did you work out the issue with the windows cookbook after?
[2013-09-06 02:14:33 -0400] AlainODea: Prad123: knife plugin. I've had some run ins with that. winrm or ssh?
[2013-09-06 02:14:47 -0400] Prad123: ssh
[2013-09-06 02:15:04 -0400] AlainODea: Prad123: what kind of problem are you encountering?
[2013-09-06 02:15:17 -0400] Prad123: it says network error
[2013-09-06 02:15:49 -0400] AlainODea: Prad123: direct PuTTY works (or ssh from Linux)?
[2013-09-06 02:15:58 -0400] Prad123: yep
[2013-09-06 02:16:58 -0400] Prad123: where can i get the windows plug in?
[2013-09-06 02:16:59 -0400] AlainODea: Have you tried the -VV (max verbose debug)?
[2013-09-06 02:17:07 -0400] Prad123: no
[2013-09-06 02:17:14 -0400] Prad123: im very new to chef
[2013-09-06 02:17:31 -0400] AlainODea: gem install knife-windows --no-ri --no-rdoc
[2013-09-06 02:17:38 -0400] AlainODea: Prad123: no worries. I'm glad to help
[2013-09-06 02:17:57 -0400] Prad123: thanks
[2013-09-06 02:18:03 -0400] Prad123: will try today
[2013-09-06 02:18:37 -0400] Prad123: yep
[2013-09-06 02:19:18 -0400] AlainODea: Prad123: This page was helpful for me. http://docs.opscode.com/plugin_knife_windows.html
[2013-09-06 02:19:39 -0400] Prad123: y'day when i tried install windows plug in.. it asked for a path /opt/.........
[2013-09-06 02:19:41 -0400] rockpunk: AlainODea: wah wah wahhhh.... unfortunately the default postfix virtual_uid_maps settings does not appear to work. any other ideas? =)
[2013-09-06 02:19:49 -0400] AlainODea: Bear in mind that I largely abandoned Windows due to automation headaches. You may not have that luxury.
[2013-09-06 02:20:41 -0400] Prad123: :D
[2013-09-06 02:21:02 -0400] Prad123: its what my manager provides
[2013-09-06 02:21:45 -0400] AlainODea: Prad123: it's a good challenge. Using Windows builds character. That's what my Dad always said.
[2013-09-06 02:22:02 -0400] Prad123: :D
[2013-09-06 02:22:04 -0400] Prad123: TY
[2013-09-06 02:22:21 -0400] Prad123: will try and research lil more and reach to u again
[2013-09-06 02:22:23 -0400] AlainODea: Prad123: My pleasure. I hope you enjoy using Chef and have success with it.
[2013-09-06 02:22:55 -0400] AlainODea: rockpunk: hmm. I see nothing about virtual_uid_map on https://github.com/opscode-cookbooks/postfix
[2013-09-06 02:23:25 -0400] rockpunk: AlainODea: it's not in the cookbook. i added it to make it look like my /etc/postfix/main.cf
[2013-09-06 02:24:02 -0400] AlainODea: rockpunk: Aha! Is this in a separate cookbook you are running after (as a kind of overlay)?
[2013-09-06 02:24:15 -0400] rockpunk: AlainODea: perhaps i'm not using the workflow right? knife cookbook site install postfix .  do my thang to it. knife cookbook upload postfix. add to the node's run-list and then run chef-client on the node.
[2013-09-06 02:24:58 -0400] AlainODea: That's pretty much right. Editing the community cookbook's themselves is a bit of a merge nightmare as fixes come from upstream though
[2013-09-06 02:25:21 -0400] AlainODea: I have found it better to do customizations like you describe in separate cookbooks.
[2013-09-06 02:25:40 -0400] AlainODea: Doing that won't fix your immediate problem though, so it's secondary
[2013-09-06 02:26:50 -0400] AlainODea: rockpunk: what is the end-goal? What do you want in the file system? What services do you want running?
[2013-09-06 02:27:12 -0400] AlainODea: rockpunk: you may have a simpler path if you only need to write /etc/postfix/main.cf
[2013-09-06 02:28:39 -0400] rockpunk: AlainODea: ok, yeah, that makes sense. i didn't really think about merging from upstream... So you'd create something like my-postfix and have it include "postfix::server" or something?  as far as end result: I want postfix installed and running. and I want the /etc/postfix/main.cf to reference the uid/gid (implicitly) created by the postfix recipe.
[2013-09-06 02:29:33 -0400] rockpunk: AlainODea: re: customization, I've been doing all my stuff in a recipe. so like postfix/recipes/my_stuff.rb
[2013-09-06 02:31:44 -0400] AlainODea: rockpunk: there are many options and I'm far from expert, but my approach would be to create <companyname>_postfix or <usecase>_postfix as a full separate site cookbook that I would put in the run list after postfix.
[2013-09-06 02:32:32 -0400] AlainODea: I'm actually not a fan of include_recipe. I find it is too prescriptive. Sometimes I want to simply overlay on an existing, non-chef provided postfix. It makes things easier though
[2013-09-06 02:33:01 -0400] AlainODea: However, include_recipe is conventional and is what Opscode does most of the time so it's probably best to go with the flow there :)
[2013-09-06 02:33:08 -0400] rockpunk: AlainODea: that would at least help the circular part of things.  if we install postfix normally and then just use the site overly to overwrite the config, at least the postfix user should be created by that point in time.
[2013-09-06 02:34:07 -0400] AlainODea: rockpunk: Indeed. The circularity is definitely resolved. All node attributes from the postfix recipe (and others in your run list before) should be available to your recipe when it runs
[2013-09-06 02:34:25 -0400] AlainODea: I use this to overlay our app on top of Tomcat for example
[2013-09-06 02:35:02 -0400] AlainODea: My recipe has node['tomcat']['webapp_dir'] for example
[2013-09-06 02:37:02 -0400] rockpunk: oh, ok. cool, i think this will work!  haha, it's kinda funny that chef creates an entire recipe directory tree that in the end is just creating a file on disk, but whatev. =)
[2013-09-06 02:38:33 -0400] rockpunk: AlainODea: thanks for the guidance! i think i can move forward now =)
[2013-09-06 02:38:38 -0400] AlainODea: rockpunk: "I am busy concocting new recipes, do not disturb the chef!" :D
[2013-09-06 02:38:51 -0400] AlainODea: rockpunk: I'm glad to help.
[2013-09-06 03:36:23 -0400] a13x212: anyone have an example of creating a node attribute from an output of a bash command
[2013-09-06 04:28:33 -0400] ap33: new to chef, I'm setting up an apache cookbook, with a recipe to install apache and setup it's listen port. I have two types of webserver that need different ports. How can I reuse the apache recipe but configure with different parameters ?
[2013-09-06 04:31:22 -0400] jameson-pmac: you should have a business logic cookbook that sets the ports
[2013-09-06 04:31:58 -0400] jameson-pmac: it would include_recipe "apache2", and in it's attribute set stuff like the port it needs
[2013-09-06 04:32:29 -0400] jameson-pmac: and in your chef run_list do recipe[server_type_1] kind of thing.
[2013-09-06 04:32:38 -0400] jameson-pmac: ap33: ^
[2013-09-06 04:37:35 -0400] ap33: thanks jameson-pmac
[2013-09-06 05:11:55 -0400] binamov: clearly bip isn't working out for me, or i am using it wrong :/
[2013-09-06 07:40:09 -0400] haakon_: I need to set up several memcached instances on a group of servers. Can anyone recommend an existing, good cookbook? The "official" one does not have that functionality and I do not want to modify existing recipes: https://github.com/opscode-cookbooks/memcached
[2013-09-06 08:35:27 -0400] xhae: haakon_: several memcached instances on each server? whyever for?
[2013-09-06 08:36:35 -0400] xhae: haakon_: anyway, that cookbook's memcached_instance define will let you do it
[2013-09-06 09:34:33 -0400] arussel``: would someone has an example of a cookbook to donwlaod an artifact from a private repository ?
[2013-09-06 09:35:14 -0400] s2r2: private git repo?
[2013-09-06 09:35:33 -0400] arussel``: private artifactory repo
[2013-09-06 09:35:52 -0400] s2r2: ah I see. sorry, no clue.
[2013-09-06 09:36:00 -0400] arussel``: I presume it works like a nexus repo
[2013-09-06 09:37:39 -0400] s2r2: hmm Riotgames/artifact-cookbook comes to mind... never used it with nexus though
[2013-09-06 09:38:53 -0400] arussel``: I'm going through it but not really sure where/how to put my credentials
[2013-09-06 09:48:26 -0400] s2r2: arussel``: https://github.com/RiotGames/artifact-cookbook#nexus-usage < databag usage
[2013-09-06 09:58:18 -0400] BryanWB_: is there an easy way in chef to determine if I am running inside an AWS VPC?
[2013-09-06 09:58:34 -0400] arussel``: s2r2: that should do, thank a lot
[2013-09-06 10:00:03 -0400] s2r2: BryanWB_: doesn't the EC2 metadata give that away?
[2013-09-06 10:00:23 -0400] s2r2: http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AESDG-chapter-instancedata.html -- "Some items are only available for instances in a VPC."
[2013-09-06 10:00:29 -0400] BryanWB_: s2r2: in a roundabout way i can determine it
[2013-09-06 10:00:40 -0400] BryanWB_: was hoping there was a helper like node.vpc?
[2013-09-06 10:01:58 -0400] s2r2: hmm no idea... the ohai ec2 plugin just slurps in everything it finds from metadata...
[2013-09-06 10:05:23 -0400] arussel``: I'm testing first with a simple artifact from public maven repo and I'm getting this error:
[2013-09-06 10:05:32 -0400] arussel``: (/var/chef/cache/cookbooks/artifact/providers/deploy.rb line 577) had an error: NoMethodError: undefined method `to_hash' for nil:NilClass
[2013-09-06 10:07:34 -0400] BryanWB_: s2r2: tks, didn't think of that
[2013-09-06 10:07:46 -0400] s2r2: :)
[2013-09-06 10:41:51 -0400] arussel``: I'm testing artifact_deploy: http://pastie.org/8302791
[2013-09-06 10:42:16 -0400] arussel``: I would expect both to work, but only the first one deploy the zip, the other gives an error:
[2013-09-06 10:42:25 -0400] arussel``:  (/var/chef/cache/cookbooks/artifact/providers/deploy.rb line 577) had an error: NoMethodError: undefined method `to_hash' for nil:NilClass
[2013-09-06 10:50:40 -0400] arussel``: when I tried to add a nexus configuration, I get: undefined method `NexusConfiguration' for Chef::Artifact:Module
[2013-09-06 12:15:07 -0400] attyz: 2
[2013-09-06 12:24:33 -0400] abrkn\: whats a good loggly cookbook? need both syslog and some other .log files
[2013-09-06 12:28:01 -0400] m4rcu5: if you edit a node with `knife node edit <nodename>` and you make a type, exit vim with :wq, chef fails to upload ans trows an error. is there a way to recover from this mistake?
[2013-09-06 12:42:34 -0400] abrkn\: re-upload?
[2013-09-06 12:42:40 -0400] abrkn\: knife upload -a
[2013-09-06 12:42:53 -0400] s2r2: m4rcu5: you could save it before... (:w node.backup.json)
[2013-09-06 12:43:20 -0400] s2r2: (which is surely far from "recovery")
[2013-09-06 13:07:49 -0400] nimbius: hey chef, im looking for a way to include metrics generated in a file on a target marchine in a MOTD...
[2013-09-06 13:09:05 -0400] xhae: nimbius: are you running Ubuntu?
[2013-09-06 13:09:16 -0400] nimbius: xhae: nope
[2013-09-06 13:09:18 -0400] nimbius: centos
[2013-09-06 13:10:01 -0400] xhae: nimbius: Pity. Ubuntu has a nice package called update-motd which concatenates the output of all the scripts in /etc/update-motd.d into /etc/motd on a cron job.
[2013-09-06 13:10:10 -0400] xhae: Maybe you can copy that.
[2013-09-06 13:10:52 -0400] nimbius: xhae: basically i want to include disk statistics for top users of a partition in the MOTD. ive a script that already compiles the data into a csv but adding it using chef into the MOTD would be nice.
[2013-09-06 13:11:21 -0400] nimbius: i feel like..maybe...a databag?
[2013-09-06 13:11:31 -0400] nimbius: 0.o
[2013-09-06 13:12:15 -0400] m4rcu5: s2r2: meh, then i could write everything to file and upload with role from file :-/
[2013-09-06 13:12:53 -0400] ichilton: Do people tend to use the opscode nginx cookbook, or another one?
[2013-09-06 13:12:57 -0400] ichilton: Package or source?
[2013-09-06 13:14:29 -0400] nimbius: ichilton: opscode nginx cookbook and i extend mine using a custom recipe.
[2013-09-06 13:14:39 -0400] nimbius: in a custom cookbook that is.
[2013-09-06 13:14:55 -0400] ichilton: nimbius: what do you extend/override?
[2013-09-06 13:15:00 -0400] ichilton: nimbius: source or package?
[2013-09-06 13:15:49 -0400] nimbius: ichilton: not much, I override some of the template.
[2013-09-06 13:16:38 -0400] ichilton: ah, I was wondering about that - how do you get it to use an overriden template in your wrapper cookbook instead of the one in the cookbook you've included?
[2013-09-06 13:17:52 -0400] nimbius: ichilton: source
[2013-09-06 13:18:13 -0400] nimbius: variables from the vanilla template are cherrypicked as necessary.
[2013-09-06 13:18:46 -0400] ichilton: Is source faster as there are less modules compiled in, or doesn't it matter?
[2013-09-06 13:19:05 -0400] ichilton: i've always used packages, but this opscode cookbook seems more geared to source as there is options which dont work if you go package
[2013-09-06 13:19:36 -0400] nimbius: ive never benchmarked.
[2013-09-06 13:19:55 -0400] ichilton: if you just do a template in your wrapper cookbook, doesn't that get into a fight with the template in the nginx cookbook though? - so on a chef run the nginx one would put its in place then your cookbook would then put its in place?
[2013-09-06 13:24:54 -0400] adamjk-dev: ichilton: chef-rewind?
[2013-09-06 13:25:04 -0400] ichilton: adamjk-dev: ?
[2013-09-06 13:25:28 -0400] adamjk-dev: ichilton: chef-rewind is a way to override resources in a "wrapper" cookbook if you like that mentality. https://github.com/bryanwb/chef-rewind
[2013-09-06 13:25:48 -0400] adamjk-dev: ichilton: you can "override" the template resource in the original nginx cookbook
[2013-09-06 13:26:32 -0400] ichilton: ahh, ok
[2013-09-06 13:26:40 -0400] ichilton: is there no way to do it with default chef?
[2013-09-06 13:27:22 -0400] ichilton: This nginx cookbook is really buggy :(
[2013-09-06 13:27:53 -0400] adamjk-dev: ichilton: I haven't looked at the cookbook, but chef-rewind is a common way..... unless the nginx cookbook allowed the template to be dynamically chosen... then I would imagine not
[2013-09-06 13:28:03 -0400] ichilton: ok
[2013-09-06 13:28:07 -0400] adamjk-dev: ichilton: for example, if you could set some node attributes to vary where the template was taken from... that might help
[2013-09-06 13:28:34 -0400] adamjk-dev: ichilton: but perhaps there is another way, I am not positive
[2013-09-06 13:28:44 -0400] ichilton: so if I just did my own template, would it happen as I said above? - on every run the nginx cookbook would see that the file has changed and write it's, then my wrapper would see that the file has changed and write it's?
[2013-09-06 13:29:54 -0400] ichilton: this is crazy
[2013-09-06 13:29:57 -0400] ichilton: this file: https://github.com/opscode-cookbooks/nginx/blob/master/attributes/source.rb
[2013-09-06 13:30:08 -0400] ichilton: has duplicate lines, both saying:
[2013-09-06 13:30:09 -0400] ichilton: default['nginx']['source']['version']                 = node['nginx']['version']
[2013-09-06 13:30:18 -0400] ichilton: and I still end up with:
[2013-09-06 13:30:19 -0400] ichilton: [2013-09-06T13:24:27+00:00] INFO: ver = 1.4.2
[2013-09-06 13:30:19 -0400] ichilton: [2013-09-06T13:24:27+00:00] INFO: source ver = 1.2.9
[2013-09-06 13:30:36 -0400] ichilton: after overriding ['nginx']['version'] to 1.4.2
[2013-09-06 13:30:59 -0400] adamjk-dev: weird... why is it duplicated
[2013-09-06 13:31:09 -0400] ichilton: no idea - it seems a bit of a mess
[2013-09-06 13:31:41 -0400] adamjk-dev: where did you override the version
[2013-09-06 13:32:18 -0400] ichilton: I have a web_server recipe which is doing: include_recipe 'nginx'
[2013-09-06 13:32:27 -0400] ichilton: and I have a web_server attributes file - in there
[2013-09-06 13:32:37 -0400] ichilton: tried default & override....
[2013-09-06 13:32:37 -0400] adamjk-dev: and you specified with override?
[2013-09-06 13:32:40 -0400] adamjk-dev: gotcha
[2013-09-06 13:32:44 -0400] ichilton: tried both
[2013-09-06 13:33:14 -0400] ichilton: it's getting through to node['nginx']['version'], but it seems that those default['nginx']['source']['version']                 = node['nginx']['version'] parts get run before the override some how
[2013-09-06 13:33:28 -0400] adamjk-dev: did you try set[] ?
[2013-09-06 13:33:32 -0400] adamjk-dev: instead of default and override
[2013-09-06 13:33:40 -0400] ichilton: what's that?
[2013-09-06 13:33:55 -0400] adamjk-dev: set["java"]["install_flavor"] = "oracle"
[2013-09-06 13:34:02 -0400] adamjk-dev: I am looking through our "role" cookbooks
[2013-09-06 13:34:07 -0400] adamjk-dev: to see what we ended up using
[2013-09-06 13:34:15 -0400] adamjk-dev: i know default doesn't do the trick
[2013-09-06 13:34:24 -0400] adamjk-dev: i thought override would.... but I am not sure
[2013-09-06 13:34:35 -0400] adamjk-dev: and some of our role cookbooks in the attributes file uses the set
[2013-09-06 13:34:47 -0400] ichilton: ah, ok
[2013-09-06 13:34:51 -0400] ichilton: wonder what the difference is...
[2013-09-06 13:35:19 -0400] nimbius: ichilton: im just going to include inline ruby in the template to pull the file data i want
[2013-09-06 13:35:23 -0400] ichilton: it seems if I set ['nginx']['source']['version'] and ['nginx']['version'] it works, with override or default
[2013-09-06 13:35:24 -0400] adamjk-dev: I am not sure off hand
[2013-09-06 13:35:29 -0400] adamjk-dev: have to always consult the documentation
[2013-09-06 13:35:32 -0400] adamjk-dev: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-09-06 13:39:18 -0400] ichilton: so annoying
[2013-09-06 13:39:29 -0400] ichilton: it's now failed because:
[2013-09-06 13:39:30 -0400] ichilton: default['nginx']['source']['conf_path'] = "/opt/nginx-#{node['nginx']['source']['version']}"
[2013-09-06 13:39:39 -0400] ichilton: is still looking at the pre-overriden version?
[2013-09-06 13:41:56 -0400] ichilton: nginx is so popular, how can the opscode cookbook be this bad!?!
[2013-09-06 13:47:26 -0400] ichilton: think I need a pepsi
[2013-09-06 13:47:29 -0400] ichilton: #badcheffriday
[2013-09-06 13:56:46 -0400] adamjk-dev: weird
[2013-09-06 13:57:22 -0400] cwj: there are some weird things that go on with attribute ordering in that cookbook
[2013-09-06 13:57:51 -0400] adamjk-dev: yeah... taht path gets set likely before you "re-set" the version
[2013-09-06 13:57:58 -0400] adamjk-dev: doesn't seem like the set approach is best
[2013-09-06 14:01:07 -0400] ichilton: or is this a general problem with chef?
[2013-09-06 14:01:21 -0400] ichilton: if you do x = y in an atribute file
[2013-09-06 14:01:39 -0400] ichilton: does that get executed then and there and then y can get overriden down the precidence tree?
[2013-09-06 14:02:09 -0400] ichilton: or does that assignment get stored and executed after the rest of the compile has completed and the final value of y has been computed?
[2013-09-06 14:02:59 -0400] ichilton: i.e is my problem that ['nginx']['version'] is set to 1.2.9 as default in the cookbook
[2013-09-06 14:03:03 -0400] ichilton: that's assigned to source
[2013-09-06 14:03:05 -0400] ichilton: and used in the path
[2013-09-06 14:03:15 -0400] ichilton: and then it's only later down the execution that i'm overriding it
[2013-09-06 14:03:31 -0400] ichilton: but it's too late.... it's already been assigned to ['source']['version'] long ago?
[2013-09-06 14:03:34 -0400] ichilton: make sense?
[2013-09-06 14:05:17 -0400] mveitas: ichilton, I ran into this before as wellnow it's bringing back some memories
[2013-09-06 14:05:30 -0400] ichilton: mveitas: bad memories? :)
[2013-09-06 14:05:40 -0400] ichilton: mveitas: did you ever conclude?
[2013-09-06 14:05:49 -0400] mveitas: let me dig into one of my cookbooks
[2013-09-06 14:05:55 -0400] ichilton: mveitas: thanking you
[2013-09-06 14:06:16 -0400] mveitas: and you are right on in that there is some weird ordering happening
[2013-09-06 14:10:09 -0400] mveitas: I should start a personal blog and write this shit down :)
[2013-09-06 14:10:36 -0400] lococo: For anyone wondering about my knife cookbook upload missing files question yesterday, the issue is that I was unaware of the existence of a repo-wide chefignore file that was ignoring all 'test' files.
[2013-09-06 14:11:07 -0400] lococo: It would be handy if knife cookbook upload noted files it's ignoring in debug output. Current state is silent "failure" in that the files don't get uploaded.
[2013-09-06 14:12:31 -0400] mveitas: ichilton: take a look at https://tickets.opscode.com/browse/CHEF-4234
[2013-09-06 14:13:13 -0400] mveitas: ichilton: it is using the java cookbook as an example and this is the exact problem you are seeing
[2013-09-06 14:14:12 -0400] mveitas: maybe not the exact problem, but pretty close
[2013-09-06 14:16:37 -0400] ichilton: mveitas: hmm, yes, same problem
[2013-09-06 14:17:05 -0400] mveitas: ichilton: and here is a thread on IRC: http://community.opscode.com/chat/chef/2013-07-17#id-396638   Search for the ticket number in there
[2013-09-06 14:17:06 -0400] ichilton: looks like the cleanest way is just to override all of the attributes - the version and those using it
[2013-09-06 14:18:15 -0400] mveitas: yup. It's a good thing I put that Ticket # into my commit message :)
[2013-09-06 14:18:25 -0400] ichilton: whats odd though
[2013-09-06 14:18:46 -0400] ichilton: is if i'm setting that attribute using override
[2013-09-06 14:18:53 -0400] ichilton: and the including the nginx recipe
[2013-09-06 14:19:13 -0400] ichilton: shouldn't the default one in the nginx cookbook be ignored as there is already an override set?
[2013-09-06 14:20:04 -0400] ichilton: i.e shouldn't my override be getting executed first because myrecipe will load it's corrisponding attribute file before executing the recipe and therefore doing include_recipe 'nginx' ?
[2013-09-06 14:20:16 -0400] jtimberman: ichilton: note that there's an ohai plugin in the nginx cookbook that is going to set an automatic attribute of the nginx version that it detects.
[2013-09-06 14:20:43 -0400] ichilton: jtimberman: detects from where?
[2013-09-06 14:20:52 -0400] jtimberman: it'll be like, node['nginx']['version'] or something like that, which may conflict with an attribute you can set in the cookbook.
[2013-09-06 14:20:52 -0400] ichilton: jtimberman: surely on a blank provision it won't detect anything?
[2013-09-06 14:20:59 -0400] jtimberman: i don't know :)
[2013-09-06 14:21:26 -0400] cwj: jtimberman: ohai! any thoughts on the status of this PR? https://github.com/jtimberman/ruby-cookbook/pull/3
[2013-09-06 14:21:35 -0400] ichilton: jtimberman: ah :)
[2013-09-06 14:22:46 -0400] jtimberman: cwj: status is: haven't looked at it
[2013-09-06 14:23:14 -0400] jtimberman: seemslegit.jpg
[2013-09-06 14:23:46 -0400] cwj: i can at least confirm that without that fix the cookbook fails on fedoras
[2013-09-06 14:25:11 -0400] jwilf: howdy guys
[2013-09-06 14:25:25 -0400] jwilf: anyone here using the nagios cookbook?
[2013-09-06 14:27:58 -0400] adamjk-dev: ichilton: sorry, I stepped away for a bit... but it looks like you found a ticket for an existing issue
[2013-09-06 14:28:22 -0400] ichilton: adamjk-dev: yeah, seems to be just the way attributes work...
[2013-09-06 14:28:57 -0400] adamjk-dev: ichilton: okay, and the resolution is to override both of them in your "wrapper" cookbook?
[2013-09-06 14:29:05 -0400] ichilton: Yep
[2013-09-06 14:29:16 -0400] adamjk-dev: ichilton: are you using "set" or override?
[2013-09-06 14:29:36 -0400] zts: ichilton: in case it helps with understanding, the "wrapped" cookbooks attributes will be loaded soon after the cookbook is loaded - which is considerably earlier than when include_recipe is run in your wrapper cookbook
[2013-09-06 14:29:37 -0400] ichilton: default will probably work ok
[2013-09-06 14:30:10 -0400] ichilton: zts: and the attributes for the included cookbook will be afterwards?
[2013-09-06 14:30:48 -0400] zts: ichilton: and in Chef 11, if you were overriding those attributes in a role or environment, the computed attribute would apparently come out right - http://lists.opscode.com/sympa/arc/chef/2012-11/msg00079.html
[2013-09-06 14:31:38 -0400] zts: ichilton: as I understand it, all cookbook attributes will be loaded before any recipes are compiled
[2013-09-06 14:32:01 -0400] ichilton: this is chef 11, but i'm setting in recipes/attributes - not roles or env
[2013-09-06 14:32:09 -0400] adamjk-dev: so, technically, you could set both attributes in the wrapper's recipe :)
[2013-09-06 14:32:27 -0400] adamjk-dev: which would execute last (of both cookbook's attributes files) etc.
[2013-09-06 14:32:42 -0400] adamjk-dev: if I understand both of you correctly
[2013-09-06 14:33:26 -0400] zts: yeah, explicitly overriding the computed attribute (ie, the one that makes use of other attributes) is what I've found myself having to do
[2013-09-06 14:33:38 -0400] ichilton: the attributes file has:
[2013-09-06 14:33:38 -0400] ichilton: default['nginx']['source']['version']                 = node['nginx']['version']
[2013-09-06 14:33:39 -0400] ichilton: default['nginx']['source']['prefix']                  = "/opt/nginx-#{node['nginx']['source']['version']}"
[2013-09-06 14:33:51 -0400] adamjk-dev: so if you set both of those in your wrapper's recipe
[2013-09-06 14:33:55 -0400] adamjk-dev: it would execute last
[2013-09-06 14:34:03 -0400] adamjk-dev: and set appropriately perhaps
[2013-09-06 14:34:09 -0400] ichilton: so you need to override node['nginx']['version'], default['nginx']['source']['version'] and default['nginx']['source']['prefix']
[2013-09-06 14:34:16 -0400] ichilton: not just node['nginx']['version']
[2013-09-06 14:34:18 -0400] ichilton: but
[2013-09-06 14:34:22 -0400] ichilton: what I don't understand is why.
[2013-09-06 14:35:12 -0400] ichilton: as surely if I am overriding override node['nginx']['version'] and then include_recipe nginx, it would come to the default attribute for node['nginx']['version'] and say "ah, i'll ignore that because it's already been overridden" ?
[2013-09-06 14:36:07 -0400] ichilton: as surely during the compile phase it would load myrecipe's attributes file first, then see the include recipe and go and look at that recipe's attributes file and that cookbook's default attributes file ?
[2013-09-06 14:37:11 -0400] zts: ichilton: no, it doesn't parse the attributes files again
[2013-09-06 14:37:54 -0400] zts: that happens in an earlier phase, before the recipes are compiled
[2013-09-06 14:38:13 -0400] zts: and I don't believe there's a way to say "please go over the attributes files again"
[2013-09-06 14:38:15 -0400] nimbius: every place i work theres an excuse why we dont use quota(8) and warnquoate
[2013-09-06 14:38:22 -0400] nimbius: and every time i hear it, i roll my eyes.
[2013-09-06 14:38:32 -0400] nimbius: because the reason its ignored is a wet-ware reason.
[2013-09-06 14:38:37 -0400] cwj: you also have an ohai plugin in the mix, which tries to populate nginx[:version] based on whats currently installed
[2013-09-06 14:38:45 -0400] zts: you can do "include_attributes" from inside an attribute file to ensure they are ordered properly, but I don't think there's an equivalent you can call from your recipe
[2013-09-06 14:39:23 -0400] siezer: tbis is why you need to namespace your attributes to your cookbook
[2013-09-06 14:39:37 -0400] siezer: default['cookbookname']['whatever']
[2013-09-06 14:39:45 -0400] siezer: and dont try to do computation in there.
[2013-09-06 14:39:52 -0400] siezer: if you need to do math, do it in a recipe.
[2013-09-06 14:40:16 -0400] ichilton: zts: so are you saying that my attributes file will be parsed at compile time, but the nginx one won't be looked at until the execution time when it comes across the include_recipe in my recipe?
[2013-09-06 14:40:31 -0400] siezer: attributes files are parsed during cookbook load time
[2013-09-06 14:40:41 -0400] ichilton: zts: i.e the compile phase doesn't look for included recipes?
[2013-09-06 14:41:07 -0400] ichilton: siezer: but is a cookbook only loaded when it hits the include_recipe when executing that recipe?
[2013-09-06 14:41:16 -0400] siezer: include_recipe is a compile phase operation
[2013-09-06 14:41:32 -0400] ichilton: ok
[2013-09-06 14:41:35 -0400] zts: ichilton: no, a cookbook is loaded way before include_recipe
[2013-09-06 14:41:43 -0400] ichilton: so my original question still stands then!?
[2013-09-06 14:41:49 -0400] ichilton: as surely if I am overriding override node['nginx']['version'] and then include_recipe nginx, it would come to the default attribute for node['nginx']['version'] and say "ah, i'll ignore that because it's already been overridden" ?
[2013-09-06 14:41:51 -0400] zts: ichilton: it will be loaded when your cookbook's metadata.rb is parsed, and it sees "depends 'nginx'"
[2013-09-06 14:42:19 -0400] ichilton: ah wait
[2013-09-06 14:42:29 -0400] zts: ichilton: so what I'm saying is that your attributes file, and the nginx attributes file, will both be loaded early in the compile phase, before any recipes are loaded
[2013-09-06 14:42:38 -0400] ichilton: which is before or after it loads my web_server.rb attributes file?
[2013-09-06 14:42:39 -0400] siezer: right
[2013-09-06 14:42:48 -0400] ichilton: ok, gotcha
[2013-09-06 14:42:57 -0400] siezer: http://docs.opscode.com/essentials_nodes_chef_run.html
[2013-09-06 14:43:01 -0400] ichilton: so it first goes through metadata.rb and loads attributes for all the dependancies
[2013-09-06 14:43:11 -0400] zts: ichilton: check out this diagram - https://wiki.opscode.com/display/ChefCN/Anatomy+of+a+Chef+Run
[2013-09-06 14:43:14 -0400] ichilton: then it will go through the attributes for the cookbook itseklf?
[2013-09-06 14:43:34 -0400] siezer: it does a "cookbook syncronization"
[2013-09-06 14:43:36 -0400] siezer: so
[2013-09-06 14:43:43 -0400] siezer: run_list "foobar"
[2013-09-06 14:43:50 -0400] zts: actually, that's a good question
[2013-09-06 14:43:54 -0400] siezer: it download the foobar cookbook
[2013-09-06 14:43:58 -0400] ichilton: zts: yeah, I get the attributes at compile time thing - it's which order those attributes are loaded in i'm questioning
[2013-09-06 14:44:00 -0400] siezer: parses its metadata.rb
[2013-09-06 14:44:09 -0400] zts: ichilton: I believe that Chef first figures out what the list of cookbooks is going to be.  It then loads the attributes from all of them, in alphabetical order
[2013-09-06 14:44:10 -0400] ichilton: zts: is it my attributes then included ones, or the other way around?
[2013-09-06 14:44:33 -0400] zts: ichilton: if you need to ensure that one cookbook's attributes are loaded before another, you can use "include_attribute" - see http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-09-06 14:45:00 -0400] zts: ichilton: so in your cookbook's attributes file, you'd do "include_attribute 'nginx'", to make sure those are loaded first
[2013-09-06 14:45:11 -0400] ichilton: yeah, but I actually want to load them last lol
[2013-09-06 14:45:19 -0400] zts: yeah, you can't do that :)
[2013-09-06 14:45:22 -0400] ichilton: :)
[2013-09-06 14:45:29 -0400] zts: or rather, I guess you could put it at the bottom of your file
[2013-09-06 14:45:42 -0400] zts: but it wouldn't help, because then the attributes you just set would be overwritten :)
[2013-09-06 14:46:06 -0400] zts: (I would imagine - I don't use the nginx cookbook myself, sorry)
[2013-09-06 14:46:34 -0400] ichilton: yeah, got it now I think
[2013-09-06 14:46:56 -0400] ichilton: I think i'm going to use packages rather than source, but I wanted to understand what was going on before moving on! :)
[2013-09-06 14:46:59 -0400] ichilton: thanks guys
[2013-09-06 14:55:14 -0400] jtimberman: cwj: hmm, i think i'm going to drop ruby 1.8 from that ruby cookbook.
[2013-09-06 14:55:27 -0400] jtimberman: unless it's the default package from the distro :)
[2013-09-06 14:56:15 -0400] Tinuva: is there a IDE for Chef like Geppetto is for Puppet?
[2013-09-06 14:57:55 -0400] lococo: For anyone interested in what was going on with minitest-handler failing to find tests yesterday, it was this bug (https://github.com/btm/minitest-handler-cookbook/issues/42) where minitest-handler 0.2.1 is incompatible with chef-server/chef-client (only works properly in chef-solo setups). There is a fix in git-latest, and I'd actually applied that fix before but I'm in the midst of migrating some cookbooks to a new chef repo and accidentally reverted to to 0.
[2013-09-06 14:58:37 -0400] cwj: jtimberman: http://www.schwarzenegger.0me.com/sounds/killmelong.wav
[2013-09-06 14:59:11 -0400] jtimberman: Tinuva: not specifically. Chef cookbooks are Ruby though, so you get a lot of benefit from the built in (or optionally installed) Ruby language support from popular programmers editors and IDEs.
[2013-09-06 14:59:48 -0400] drrk: jtimberman: do you have a recent script for backing up node, role, enviroment and databags ?
[2013-09-06 15:09:55 -0400] bgant: has anyone run across Unexpected API Request Failure / Cannot load role foo?
[2013-09-06 15:09:56 -0400] jtimberman: drrk: knife-essentials (included in chef 11) has a backup command
[2013-09-06 15:10:12 -0400] ichilton: how can I rename a file if it exists? - anyone have an example?
[2013-09-06 15:10:18 -0400] Tinuva: jtimberman, alright thank you
[2013-09-06 15:10:23 -0400] ichilton: actually, just move it will do...
[2013-09-06 15:11:42 -0400] jblaine: help a dude update the wiki's git instructions: https://gist.github.com/jblaine/6465204
[2013-09-06 15:13:26 -0400] drrk: jtimberman: thanks
[2013-09-06 15:13:43 -0400] drrk: jtimberman: is that on the server?
[2013-09-06 15:16:03 -0400] jblaine: ichilton: maybe better to consider that Chef will keep backups of files on its own
[2013-09-06 15:16:42 -0400] fishGoM00: ichilton: something like this?
[2013-09-06 15:16:44 -0400] jblaine: ichilton: If a file needs mods, by default Chef will store the old file in /var/chef
[2013-09-06 15:16:44 -0400] fishGoM00: execute "Move file" do
[2013-09-06 15:16:44 -0400] fishGoM00:   cwd "/path/of/file/"
[2013-09-06 15:16:44 -0400] fishGoM00:   command "mv filename newfilename"
[2013-09-06 15:16:44 -0400] fishGoM00:   only_if {File.exists?("/path/of/file/filename")}
[2013-09-06 15:16:45 -0400] fishGoM00: end
[2013-09-06 15:16:58 -0400] fishGoM00: bit nasty :)
[2013-09-06 15:18:00 -0400] cpuguy83: fishGoM00: That's not bad, actually.
[2013-09-06 15:18:34 -0400] jblaine: ichilton: See 'backup' parameter to some resources: "The number of backups to be kept. Set to false to prevent backups from being kept. Default value: 5"
[2013-09-06 15:23:11 -0400] flyingbuddha: Need some help.. Typing in: bundle exec veewee vbox export 'ubuntu-13.04'
[2013-09-06 15:23:11 -0400] flyingbuddha: Get: Could not parse PKey: no start line from net-ssh-2.6.8
[2013-09-06 15:25:58 -0400] zts: jblaine: re: git, try running "git fetch opscode" and then your checkout command again
[2013-09-06 15:26:40 -0400] jblaine: zts: Whoa. That worked. Why?
[2013-09-06 15:26:50 -0400] mattupstate: anyone use the nginx cookbook, install from source, and set the version above 1.2.9?
[2013-09-06 15:26:59 -0400] mattupstate: something is fishy with it
[2013-09-06 15:27:45 -0400] mattupstate: it always recompiles, and always ends up with a prefix of /opt/nginx-1.2.9
[2013-09-06 15:27:56 -0400] mattupstate: yet the installed version is 1.4.2, as i've specified
[2013-09-06 15:28:59 -0400] zts: jblaine: the problem was that the steps you followed declared the "opscode" remote, but didn't actually pull any data from it
[2013-09-06 15:29:20 -0400] zts: jblaine: the checkout command then failed as it was intended to check out the branch "master" from the remote "opscode", which didn't yet exist in your clone
[2013-09-06 15:30:02 -0400] jblaine: zts: I think maybe the issue is the wording in the wiki: "Once all this is done, you'll be able to keep your local master up to date with the simple command: git checkout master; git pull --rebase"
[2013-09-06 15:30:24 -0400] jblaine: zts: That is, it's worded as if "don't do this now, but this is what you will be able to do once we get all of this set up"
[2013-09-06 15:31:02 -0400] jblaine: zts: And it clearly needed to be done first before continuing down the page
[2013-09-06 15:31:07 -0400] jblaine: zts: Thanks
[2013-09-06 15:31:43 -0400] zts: jblaine: yeah, I guess it assumes that time has passed and you just happen to have done that in the mean time (which is entirely possible)
[2013-09-06 15:32:39 -0400] nimbius: hi chef, i need to create a ton of symlinks based on directories listed on a machine, how can i do this?
[2013-09-06 15:32:48 -0400] nimbius: without a buncha file resources :)
[2013-09-06 15:33:34 -0400] cwj: write some ruby to read in the list of directories to an array or hash, and then iterate over it with a link resource?
[2013-09-06 15:35:16 -0400] nimbius: cwj: sweet, thanks
[2013-09-06 15:36:40 -0400] jblaine: zts: fixed wiki page: "If (and only if) you are working on a brand new clone of the chef repo and have only just configured it as above, you will need to fetch from your newly established upstream remote named 'opscode': git fetch opscode"
[2013-09-06 15:37:04 -0400] jblaine: zts: As part of the "Working on Topic Branches" section.
[2013-09-06 15:40:14 -0400] zts: nice one!
[2013-09-06 15:40:56 -0400] nicgrayson: mattupstate: are you wrapping the opscode one?
[2013-09-06 15:41:54 -0400] mattupstate: nicgrayson: just trying to override some attributes in a cookbook
[2013-09-06 15:42:03 -0400] mattupstate: nicgrayson: but yes
[2013-09-06 15:42:43 -0400] nicgrayson: mattupstate: there are some strange attr things with that guy
[2013-09-06 15:42:48 -0400] nicgrayson: mattupstate: i'll gist something
[2013-09-06 15:42:58 -0400] mattupstate: yeah, i'm realizing that now
[2013-09-06 15:43:24 -0400] nicgrayson: https://gist.github.com/6465697
[2013-09-06 15:43:45 -0400] mattupstate: so use normal instead of override, huh?
[2013-09-06 15:43:54 -0400] nicgrayson: i have a companywrapper_nginx cookbook, had to add that to the attr/default.rb
[2013-09-06 15:44:14 -0400] nicgrayson: you have to reset a lot of the attrs
[2013-09-06 15:44:25 -0400] mattupstate: nicgrayson: i'll give it a whirl, thanks for the tip
[2013-09-06 15:44:32 -0400] nicgrayson: np
[2013-09-06 15:49:47 -0400] mveitas: mattupstate: we just had this conversation on here about an hour ago with the nginx cookbook
[2013-09-06 15:50:25 -0400] mveitas: take a look at the #chef irc logs around 10am today
[2013-09-06 15:50:48 -0400] mattupstate: mveitas: ok
[2013-09-06 15:50:51 -0400] mveitas: mattupstate: https://tickets.opscode.com/browse/CHEF-4234  This has a work around for it
[2013-09-06 15:58:28 -0400] benjohnson77: hey gents
[2013-09-06 16:00:09 -0400] benjohnson77: how can I assign an attribute file to a recipe ... qa have a different atttribute file for each env ... so say you have and install recipe and you have different settings for each env ... why can't I just duplicate the whole file and force it to run.
[2013-09-06 16:00:41 -0400] siezer: benjohnson77 use chef Environments to override the attributes set in cookbooks
[2013-09-06 16:01:08 -0400] siezer: http://docs.opscode.com/essentials_environments.html
[2013-09-06 16:07:36 -0400] mattupstate: nicgrayson:
[2013-09-06 16:07:39 -0400] mattupstate: that helped, thanks
[2013-09-06 16:08:19 -0400] benjohnson77: siezer: thanks ... I'll go that direction
[2013-09-06 16:13:19 -0400] EricL: I have a ruby script with cron blocks for chef in a repo that chef deploys to a node.  The ruby script is run by a ruby block from within a recipe. chef-client shows me it's running, but nothing is added to cron. How do I troubleshoot that?
[2013-09-06 16:15:35 -0400] tasslehawf: I am trying to install a jenkins plugin using jenkins_cli and getting this error:
[2013-09-06 16:15:38 -0400] tasslehawf: Error executing action `run` on resource 'jenkins_execute[java -jar /home/jenkins/jenkins-cli.jar -s http://syncopated-soaring:8080 install-plugin git]'
[2013-09-06 16:16:35 -0400] tasslehawf: https://github.com/hayesmp/jenkinsbox-cookbook/blob/master/recipes/default.rb
[2013-09-06 16:16:51 -0400] tasslehawf: oops this one https://github.com/hayesmp/jenkinsbox-cookbook/blob/master/recipes/jenkins.rb
[2013-09-06 16:17:41 -0400] Majost: Is there a doc somewhere which details upgrading the chef-client on a node for which chef was originally installed via knife bootstrap?
[2013-09-06 16:18:35 -0400] Majost: Professor Google wont give me a clear answer on this one.
[2013-09-06 16:25:31 -0400] troyready: Majost, it's probably not entirely clear, because as usual the answer it "it depends" :)
[2013-09-06 16:25:55 -0400] troyready: Specifically, it depends on the bootstrap template used
[2013-09-06 16:26:37 -0400] troyready: I'm not sure if it was different back in the day, but I believe the default has been for some time for knife bootstrap to do an omnibus install
[2013-09-06 16:29:13 -0400] masterkorp: Guys i seem to have some false " Chef client  is running, will wait for it to finish and then run." alarms
[2013-09-06 16:29:19 -0400] masterkorp: i killed all chef-clients
[2013-09-06 16:29:35 -0400] masterkorp: does chef-client check a file or someting to chef is its runing
[2013-09-06 16:29:42 -0400] Majost: troyready: yeah.. It from 11.4.4 to 11.6
[2013-09-06 16:29:58 -0400] Majost: so it should technically be the omnibus installer
[2013-09-06 16:32:34 -0400] troyready: Yeah, then it should  just be a matter of running the simple install script from the website
[2013-09-06 16:32:57 -0400] troyready: Which will detect and install the latest system package (rpm/deb) for your distro
[2013-09-06 16:33:04 -0400] Majost: I wish knife had an upgrade command or something.
[2013-09-06 16:34:18 -0400] troyready: yeah, that would make it more simple ("detect if omnibus" -> "then upgrade omnibus" else "yell at user for unsupported system gem install")
[2013-09-06 16:34:26 -0400] troyready: "curl -L https://www.opscode.com/chef/install.sh | sudo bash" should do it
[2013-09-06 16:35:43 -0400] stormerider: there's also a cookbook to update clients via omnibus from heavy water
[2013-09-06 16:40:37 -0400] AskSteve: I'm having trouble with the nscd cookbook.  Has anybody had any luck with it?
[2013-09-06 16:41:48 -0400] fubrish: I'm having problems passing chef::config variables into windows recipes w/powershell I was hoping to get some help with. My setup works fine with linux bootstrap/recipes, just not windows.
[2013-09-06 16:42:06 -0400] fubrish: Here's my cmd: knife bootstrap windows winrm <ec2 fqdn> -x <username> -P "<passwd>" -r "my_recipe" -c "<path to ../chef/knife.rb" -VV
[2013-09-06 16:53:40 -0400] eherot: Does anyone have thoughts on why this error might be occurring? https://gist.github.com/eherot/6466532
[2013-09-06 16:53:58 -0400] eherot: this should be running version 1.6.0 of the rsyslog cookbook: https://github.com/opscode-cookbooks/rsyslog/blob/1.6.0/recipes/default.rb
[2013-09-06 16:54:52 -0400] eherot: wherein node['rsyslog']['service_name'] is an attribute: https://github.com/opscode-cookbooks/rsyslog/blob/1.6.0/attributes/default.rb#L33
[2013-09-06 16:55:09 -0400] eherot: The system is Ubuntu/12.04 btw.
[2013-09-06 16:55:34 -0400] fak3r: berkshelf question; I can do berks install and berks upload to the server, but during vagrant up, berks fails to upload tot he server
[2013-09-06 16:55:37 -0400] fak3r: Ridley::Errors::ConnectionFailed: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed
[2013-09-06 16:55:52 -0400] jmickle: is it possible to assign an elastic ip with knife -ec2?
[2013-09-06 16:56:18 -0400] zts: eherot: my guess is that et_base doesn't list rsyslog as a dependency in its metadata
[2013-09-06 16:56:54 -0400] zts: actually, that makes no sense, ignore me
[2013-09-06 16:56:59 -0400] eherot: zts: it lists et_logger, which lists rsyslog.
[2013-09-06 16:57:14 -0400] zts: (I noticed chef-solo-search in your list of cookbooks, and jumped to the wrong conclusion that you're using chef-solo)
[2013-09-06 16:57:51 -0400] rshade98: is it possible to trap NameError Resource not found
[2013-09-06 16:57:57 -0400] eherot: zts: gotcha ;-)
[2013-09-06 16:58:01 -0400] rshade98: I want to put in a custom log message
[2013-09-06 17:05:51 -0400] eherot: weird part is that it's failing during compile
[2013-09-06 17:06:04 -0400] eherot: also, doesn't fail a chef-zero test of the et_base cookbook
[2013-09-06 17:06:20 -0400] eherot: only fails when the logserver cookbook (which really shouldn't affect these attributes) is loaded...
[2013-09-06 17:07:06 -0400] mattsurabian: oh hai!
[2013-09-06 17:07:37 -0400] mattsurabian: got a question about using quotes inside a bash resources "code" parameter
[2013-09-06 17:08:21 -0400] eherot: omg I totally just answered my own question. ;-)
[2013-09-06 17:08:22 -0400] mattsurabian: if the code chunk is wrapped in ye old EOH do I need to worry about it?
[2013-09-06 17:08:37 -0400] eherot: mattsurabian: you shouldn't need to
[2013-09-06 17:08:50 -0400] mattsurabian: that was my thought, but figured I'd ask before I blew up a node
[2013-09-06 17:08:51 -0400] mattsurabian: heh
[2013-09-06 17:08:52 -0400] mattsurabian: thanks
[2013-09-06 17:10:49 -0400] eherot: mattsurabian: You should be unit testing
[2013-09-06 17:11:07 -0400] mattsurabian: eherot don't I know it
[2013-09-06 17:11:19 -0400] eherot: gem install berkshelf
[2013-09-06 17:11:27 -0400] mattsurabian: I'm not a big fan of the bash resource in general, cause you know, kinda ghetto
[2013-09-06 17:11:27 -0400] eherot: https://wiki.opscode.com/display/chef/Vagrant
[2013-09-06 17:11:39 -0400] eherot: yeah I prefer execute whenever possible.
[2013-09-06 17:11:47 -0400] mattsurabian: I'm using chef in rightscale so testing via solo or vagrant is a real pita
[2013-09-06 17:12:06 -0400] mattsurabian: in this case I just need to fire off a quick curl request toa webhook
[2013-09-06 17:12:17 -0400] mattsurabian: so our chatroom robot knows some recipes were just run
[2013-09-06 17:12:30 -0400] mattsurabian: little bit quick a dirty
[2013-09-06 17:12:33 -0400] eherot: actually that seems like a pretty good use of execute
[2013-09-06 17:12:45 -0400] eherot: *for execute
[2013-09-06 17:29:12 -0400] gabrtv: is there a way to query the chef server to find out a node failed to complete a chef-client run?
[2013-09-06 17:30:31 -0400] gabrtv: i.e. some node attribute similar to automatic.idletime
[2013-09-06 17:31:07 -0400] jbz: gabrtv: this might help - http://jtimberman.housepub.org/blog/2013/02/16/last-check-in-time-for-nodes/
[2013-09-06 17:32:53 -0400] gabrtv: jbz: thx for the link.. i'm looking for a solution for finding out that first checkin failed, this seems more geared at subsequent checkins
[2013-09-06 17:33:14 -0400] jbz: gabrtv: Well, do you mean registration?  Or the first convergence?
[2013-09-06 17:33:26 -0400] gabrtv: first convergence
[2013-09-06 17:33:29 -0400] jbz: ok
[2013-09-06 17:33:36 -0400] jbz: when the node registers it doesn't upload node state
[2013-09-06 17:33:45 -0400] gabrtv: right now i'm polling on automatic.idletime.. which is great when converge works
[2013-09-06 17:33:54 -0400] gabrtv: but when it doesn't it just spins and spins
[2013-09-06 17:33:54 -0400] jbz: so you'll only see attributes on the chef server if the convergence was successful and it uploaded the nodestate at the end of the run.
[2013-09-06 17:34:15 -0400] jbz: you can probably just pick an attribute that gets set by one of your cookbooks
[2013-09-06 17:34:18 -0400] jbz: and see if it exists?
[2013-09-06 17:34:37 -0400] gabrtv: i think that only happens after successful converge
[2013-09-06 17:34:44 -0400] gabrtv: (but i could be wrong)
[2013-09-06 17:35:00 -0400] gabrtv: i'm basically trying to determine the difference between "converge in process" and "coverge failed"
[2013-09-06 17:35:14 -0400] gabrtv: both seem to have the same attributes, afaik
[2013-09-06 17:35:31 -0400] jbz: yeah, well
[2013-09-06 17:35:44 -0400] jbz: the server doesn't maintain live state info so you're going to have to interpolate.
[2013-09-06 17:36:39 -0400] gabrtv: unfortunately i don't have any control flow, because cloud-init is doing the chef registration/bootstrapping
[2013-09-06 17:36:47 -0400] mattsurabian: eherot: execute would require me to escape the " though right?
[2013-09-06 17:36:54 -0400] mattsurabian: doesn't it use the name parameter for the command
[2013-09-06 17:37:08 -0400] gabrtv: jbz: thx for the help tho
[2013-09-06 17:37:44 -0400] mattsurabian: well, I can pass a command explicitly, but I'd still need to escape "
[2013-09-06 17:37:46 -0400] jbz: dabrtv:  Suggestion
[2013-09-06 17:37:51 -0400] jbz: er, gabrtv sorry
[2013-09-06 17:38:01 -0400] jbz: gabrtv You can do an explicit node.save action during a run
[2013-09-06 17:38:11 -0400] EricL: I have a ruby script with cron blocks for chef in a repo that chef deploys to a node.  The ruby script is run by a ruby block from within a recipe. chef-client shows me it's running, but nothing is added to cron. How do I troubleshoot that?
[2013-09-06 17:38:15 -0400] jbz: you could put a recipe at the start of your runlist that just sets a status attribute and does a node.save
[2013-09-06 17:38:23 -0400] jbz: and then if successful, removes itself from the runlist
[2013-09-06 17:38:50 -0400] gabrtv: jbz: very interesting.. wonder what kind of side effects that might have
[2013-09-06 17:39:00 -0400] jbz: that way, as soon as the node *starts* to converge, you'd get a flag, and if the time since checkin was longer than the clietn interval, assume failure.
[2013-09-06 17:39:22 -0400] gabrtv: yeah as long as i have a flag at start of converge, i'm good
[2013-09-06 17:39:25 -0400] jbz: gabrtv: self-removing cookbooks aren't that odd - it's one common way to set up the chef-client and remove the validator key from the node
[2013-09-06 17:39:55 -0400] jbz: and if you're only going to do this on the first run, and then remove it, the node.save isn't a real drag
[2013-09-06 17:41:02 -0400] gabrtv: jbz: agreed. i guess i was hoping that failed chef-client runs reported back to the server and set a flag of some sort.. seems reasonable, no?
[2013-09-06 17:41:22 -0400] jbz: gabrtv: no, they don't, because they don't have a predictable exit
[2013-09-06 17:41:25 -0400] jbz: gabrtv:  oh wait
[2013-09-06 17:41:27 -0400] jbz: hang on
[2013-09-06 17:41:31 -0400] jbz: you could use an error handler
[2013-09-06 17:41:40 -0400] jbz: and have it send a message on failure.
[2013-09-06 17:42:22 -0400] gabrtv: hmm
[2013-09-06 17:42:23 -0400] jbz: gabrtv: http://docs.opscode.com/essentials_handlers.html
[2013-09-06 17:42:47 -0400] jbz: that will let you perform arbitrary actions on exceptions
[2013-09-06 17:43:08 -0400] kl4m: Could someone tell me why I see this search() syntax around and it never seems to work for me? https://github.com/coderanger/chef-collectd/blob/master/recipes/client.rb#L23
[2013-09-06 17:43:09 -0400] jbz: you could either send a message outside of chef, or you could set a particular attribute and force a node.save maybe?
[2013-09-06 17:43:25 -0400] jbz: (I'd be really leery of pushing node state after an exception myself though)
[2013-09-06 17:43:56 -0400] gabrtv: sounds promising though
[2013-09-06 17:54:14 -0400] jmickle: anyone have experience assigning elastic ip with knife ec2?
[2013-09-06 17:54:58 -0400] mattsurabian: I've worked with EIP reassigning recipes
[2013-09-06 17:55:22 -0400] mattsurabian: but always through righscale instead of straight knife
[2013-09-06 17:57:04 -0400] jmickle: mattsurabian: got it yeah I'm trying to spin up VPC instances in a public subnet
[2013-09-06 17:59:58 -0400] mattsurabian: ahhh nice
[2013-09-06 18:10:58 -0400] tasslehawf: how do I set the hostname in chef solo?
[2013-09-06 18:12:14 -0400] gabrielqs: i'm writing a recipe to create nginx vhosts and mysql databases and users
[2013-09-06 18:12:31 -0400] gabrielqs: the vhost part is fine, but while trying to create the database, i keep on getting this error:
[2013-09-06 18:12:41 -0400] gabrielqs: cannot load such file -- mysql
[2013-09-06 18:12:56 -0400] gabrielqs: i know this is the mysql gem, but how do i make it available for my recipe?
[2013-09-06 18:13:17 -0400] gabrielqs: i thought a require 'mysql' would do the trick, but it didn't have no effect
[2013-09-06 18:13:20 -0400] arussel: what recipe can I use to download a remote file, I need to add Header and username/password for authentication.
[2013-09-06 18:13:31 -0400] gabrielqs: and i have mysql listed as a dependency on metadata.json
[2013-09-06 18:17:00 -0400] gabrielqs: argh
[2013-09-06 18:17:02 -0400] gabrielqs: stupid me
[2013-09-06 18:17:03 -0400] gabrielqs: include_recipe 'database::mysql'
[2013-09-06 18:17:09 -0400] gabrielqs: moving on..
[2013-09-06 18:46:14 -0400] arussel: how do you do a 'apt-get update' that would work on both redhat and debian ?
[2013-09-06 18:46:49 -0400] jtimberman: arussel: red hat doesn't have apt... so, you don't. :)
[2013-09-06 18:48:39 -0400] arussel: I know, I meant the equivalent :-)
[2013-09-06 18:48:46 -0400] EricL: I'm trying to execute a recipe as a script from a repo.  I want that script to run in chef context so I can use LWRPs.  I tried using a ruby block that that didn't work.
[2013-09-06 18:48:51 -0400] EricL: What I am I doing wrong?
[2013-09-06 18:49:24 -0400] rshade98: @arussel use package
[2013-09-06 18:49:48 -0400] spox: something something apt-rpm
[2013-09-06 18:49:48 -0400] arussel: rshade98: just 'package update' at the begining of the recipe ?
[2013-09-06 18:51:23 -0400] arussel: hhmmm, nope: Cannot find a resource for update on ubuntu version 12.04
[2013-09-06 18:52:17 -0400] spox: just include the relevant cookbooks as dependencies (apt, yum, etc)
[2013-09-06 18:52:27 -0400] spox: then include the recipe for it based on the node.platform_family value
[2013-09-06 18:52:31 -0400] spox: and fin
[2013-09-06 19:00:25 -0400] EricL: I'm just trying to mimic the behavior of a before_restart.rb file.
[2013-09-06 19:00:41 -0400] EricL: Is calling it via Ruby block incorrect?
[2013-09-06 19:05:21 -0400] gondoi: coderanger, in berkshelf, you pinned activesupport due to install failures.. what type of failures were you seeing?
[2013-09-06 19:05:52 -0400] coderanger: gondoi: I did?
[2013-09-06 19:06:10 -0400] gondoi: oh sorry.. looks like you put in the PR, but it was seth's commit :/
[2013-09-06 19:06:18 -0400] coderanger: And I think that was because of some breakage when rails 4 was released, berkshelf fixed it soon after
[2013-09-06 19:06:22 -0400] gondoi: https://github.com/RiotGames/berkshelf/pull/710
[2013-09-06 19:06:50 -0400] coderanger: Did that never get removed?
[2013-09-06 19:06:50 -0400] gondoi: yeah, we are seeing some odd behaviour and want to verify the symptoms before updating berkshelf
[2013-09-06 19:07:00 -0400] coderanger: The issue was
[2013-09-06 19:07:11 -0400] coderanger: was "berkshelf crashes on startup"
[2013-09-06 19:07:19 -0400] coderanger: because of some API change in activesupport
[2013-09-06 19:07:32 -0400] gondoi: hmmm
[2013-09-06 19:07:51 -0400] gondoi: okay we are seeing a blank file in a cookbook in the shelf...
[2013-09-06 19:07:55 -0400] gondoi: so i guess it could be that
[2013-09-06 19:08:07 -0400] coderanger: I find it unlikely ...
[2013-09-06 19:08:26 -0400] coderanger: The issue was a complete crash, not something intricate
[2013-09-06 19:08:33 -0400] gondoi: hmm
[2013-09-06 19:08:34 -0400] gondoi: okay
[2013-09-06 19:08:53 -0400] gondoi: well we aren't seeing those crashes.. the combo is berkshelf 2.0.4 and activesupport 4.0
[2013-09-06 19:09:27 -0400] gondoi: thanks for the info coderanger
[2013-09-06 19:12:24 -0400] coderanger: right, berkshelf 2 removed all use of activesupport
[2013-09-06 19:12:29 -0400] coderanger: as mentioned in the PR
[2013-09-06 19:13:49 -0400] gregf: Not sure what changed on my system, but today test-kitchen is telling me I need to gem install berkshelf. I am able to require 'berkshelf' in pry under the same environment. Anyone have any ideas? It appears I have Berkshelf 2.0.10 and test-kitchen 1.0.0.beta3.
[2013-09-06 20:01:36 -0400] btm: @opscode cookbook code review: join: https://plus.google.com/hangouts/_/5db75d01a599d425117ee4664293ee6cd134f02b, watch: http://youtu.be/XowYolR7beQ
[2013-09-06 20:05:25 -0400] ichilton: How do people manage populating app server ip's on the web server?
[2013-09-06 20:06:17 -0400] ichilton: I could do a search based on role[app] and environment[production], but what if one isn't ready to be in the pool or has a problem?
[2013-09-06 20:06:45 -0400] ichilton: An attribute to enable or disable it, or is there a better way?
[2013-09-06 20:11:45 -0400] cwj: ichilton: personally i am interested in exploring the use of etcd (https://github.com/coreos/etcd) for stuff like that
[2013-09-06 20:11:55 -0400] cwj: so that the node registers itself with the service when it is ready
[2013-09-06 20:12:58 -0400] cwj: then of course you need another piece to help the load balancer stay up to date
[2013-09-06 20:13:14 -0400] cwj: app server, whatever
[2013-09-06 20:28:10 -0400] jameson__: someone at opscode write a wrapper to the awscli into the aws cookbook :3
[2013-09-06 20:28:30 -0400] cwj: heh
[2013-09-06 20:28:38 -0400] jameson__: as an lwrp
[2013-09-06 20:28:59 -0400] cwj: i can see how that might work
[2013-09-06 20:29:11 -0400] cwj: but fjear
[2013-09-06 20:29:36 -0400] jameson__: aws_cli "exact command you want awscli to run because it wasn't made lwrp-ed yet" ...
[2013-09-06 20:36:47 -0400] jameson__: was that seth that get annoyed if you move things around?
[2013-09-06 21:32:49 -0400] techminer: I include a recipe in my base cookbook that tries to grab a file from a local mirror.  During a bootstrap I have to set the bootstrap-proxy param to get out to pull down the Chef install.  Then when it gets to the point in my base cookbook where it goes out to grab a file from my local mirror it fails.I'm guessing because it's trying to send that local request out through my proxy.
[2013-09-06 21:33:22 -0400] techminer: Any thoughts on a workaround?
[2013-09-06 21:33:27 -0400] techminer: I don
[2013-09-06 21:36:28 -0400] mindlace: is it necessary to not use the latest Virtual Box still?
[2013-09-06 21:38:36 -0400] jameson__: you can use latest now
[2013-09-06 21:39:24 -0400] jameson__: (I am running latest vagrant, virtualbox) vagrant-berkshelf will warn you that it wasn't built/tested against the latest vagrant though
[2013-09-06 21:39:43 -0400] mindlace: ok. hm, wonder whether https://learnchef.opscode.com/quickstart/workstation-setup/ can be updated
[2013-09-06 21:56:26 -0400] jameson__: ther are a few docs here and there that needs to be updated..
[2013-09-06 23:36:47 -0400] bixu: How can I keep chef-client from re-downloading all cookbooks every time the bootstrap fails?  I don't need new versions of the cookbooks unless I've made changes to them (and the checksums have changed...)
[2013-09-06 23:41:28 -0400] chris_woods: Hey all,  I made some changes to an install recipie to install a different version of some software.  chef-client still thinks that part of the recipie is up-to-date, though.  (even after I apt-get removed the software).  Is there a way to tell chef something is not up to date?
[2013-09-06 23:41:56 -0400] kallistec: bixu: as long as the run_list is the same and nothing's been updated, all the files in the cache should be valid. Are you using one-shot run lists or something?
[2013-09-06 23:42:27 -0400] chris_woods: the cookbook has been updated.  I'm not using one-shots or anything.
[2013-09-06 23:42:42 -0400] kallistec: chris_woods: use the version attribute of the package resource, or set action to upgrade?
[2013-09-06 23:43:07 -0400] chris_woods: kallistec: Okay, yeah good point.  I should probably be updating the verion of the cookbook.
[2013-09-06 23:43:29 -0400] bixu: kallistec: This is during bootstrapping.
[2013-09-06 23:43:58 -0400] bixu: The node doesn't yet have a populated run list.
[2013-09-06 23:44:41 -0400] kallistec: chris_woods: that's a good practice, but I don't think it will matter in this case. action :install (default, IIRC) only makes sure a package is installed unless you set the version attribute, in which case it will try to change to the specified version of the package
[2013-09-06 23:45:11 -0400] kallistec: chris_woods: action :upgrade will always try to get the newest version according to the sorting rules for your package manager
[2013-09-06 23:45:49 -0400] kallistec: bixu: what exactly are you doing in this case? knife bootstrap [args], that fails, then re-run knife bootstrap?
[2013-09-06 23:46:23 -0400] bixu: Knife bootstrap is failing, then I'm logging into the machine and running chef-client -j /etc/chef/first-boot.json
[2013-09-06 23:47:04 -0400] chris_woods: kallistec: Ahh, I'm actually going backwards (it installed an unstable build because I used the wrong repo). If I specify the version flag will it figure it out?  I actually apt-get removed the thing, but that wasn't enough to convince chef.
[2013-09-06 23:47:44 -0400] kallistec: bixu: and chef is re-downloading the same cookbook's files over again?
[2013-09-06 23:48:44 -0400] kallistec: chris_woods: is chef not just re-installing the newer one? pretty sure you'll need to set the version attribute on the package to get it to go backwards
[2013-09-06 23:48:54 -0400] bixu: kallistec: yes
[2013-09-06 23:49:10 -0400] bixu: (only so long as the bootstrap continues to fail)
[2013-09-06 23:49:14 -0400] kallistec: chris_woods: or maybe apt pinning would work, I forget
[2013-09-06 23:49:38 -0400] kallistec: bixu: is chef deleting the files at the end of the failed run?
[2013-09-06 23:49:42 -0400] chris_woods: kallistec: chef is blowing past the package :install thinking it's up to date.  It then tries a services start and failed because nothing is there to start.
[2013-09-06 23:49:59 -0400] bixu: kallistec: I think so, though I've not specifically checked the cache.
[2013-09-06 23:51:03 -0400] a13x212: has anyone used the cookbook line? the examples seem simple but don't seem to be working
[2013-09-06 23:51:56 -0400] kallistec: bixu: I've got to go soon, if you could investigate by running with -ldebug and create a ticket that would be cool. you might need to hack the bootstrap template to turn on debug for the first run
[2013-09-06 23:52:26 -0400] bixu: kallistec: I'll check it out if it happens again.
[2013-09-06 23:52:59 -0400] kallistec: chris_woods: weird. chef uses `apt-cache policy PACKAGE` to query the state of the package
[2013-09-06 23:53:15 -0400] kallistec: maybe you could look at that to get some insight.
