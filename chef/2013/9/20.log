[2013-09-20 00:00:02 -0400] yfeldblum: Majost, do you know what Module#include does?
[2013-09-20 00:04:00 -0400] yfeldblum: Rapzid, is that sarcasm?
[2013-09-20 00:05:43 -0400] Majost: I just figured it out
[2013-09-20 00:05:44 -0400] Majost: heh
[2013-09-20 01:16:44 -0400] storme_out: gchristensen: yeah, i should be able to revisit that this weekend
[2013-09-20 01:33:08 -0400] matticulous: ssd7_: I pulled down the .rpm and just did 'rpm -Uvh [rpm_loc]. then did chef-server-ctl reconfigure.
[2013-09-20 01:33:35 -0400] matticulous: ssd7_: the other functions of chef server "seem" to be ok.
[2013-09-20 02:24:48 -0400] gchristensen: storme_out: I would appreciate that :)
[2013-09-20 02:38:09 -0400] matticulous: ssd7_: also looks like other client registrations that were previously working (knife ec2 server creates) are now failing with the same type of pattern.
[2013-09-20 03:09:33 -0400] chance: With application type cookbooks (ie rails, node or something), would it be normal to include a vagrant environment + vagrant file with the cookbook?
[2013-09-20 03:19:04 -0400] |rt|: chance: we do that....use a few json files that live in the cookbook to drive the vagrant environment
[2013-09-20 03:19:35 -0400] |rt|: chance: the idea is that anyone on the team should be about the clone the cookbook repo and do a vagrant up without having to jump through any hoops and have it work
[2013-09-20 03:26:42 -0400] chance: i was thinking of doing the same. makes it easier to test too
[2013-09-20 03:26:59 -0400] chance: could include an env for testing with jenkins :)
[2013-09-20 03:31:44 -0400] |rt|: chance: yeah we are moving more towards testkitchen and use strainer in our jenkins setup
[2013-09-20 03:33:54 -0400] |rt|: chance: so with that test kitchen is driving the vagrant setup on workstations....that's the direction we are going still working out a few things
[2013-09-20 03:52:01 -0400] dysinger: try to install 11.6 on OS X
[2013-09-20 03:52:29 -0400] dysinger: X11 bouncing over and over and sometimes crashing.  install lags forever.  X11 bouncing doesn't stop after abort.
[2013-09-20 03:52:31 -0400] dysinger: WAT
[2013-09-20 07:49:10 -0400] PeterBengton: Hello everyone. Does anyone know if there still is a working way of making "knife ec2 server create" install the encrypted_data_bag_secret? I get the deprecation warning, but nothing is installed on the instance.
[2013-09-20 07:51:08 -0400] ocholetras: never worked with ec2 sorry
[2013-09-20 07:52:03 -0400] PeterBengton: So what is the recommended way of getting the encrypted_data_bag_secret installed on an instance?
[2013-09-20 07:52:23 -0400] PeterBengton: knife bootstrap after first creating the instance manually?
[2013-09-20 07:52:28 -0400] ocholetras: afaik you can put on a path that you know
[2013-09-20 07:52:48 -0400] PeterBengton: That's not the issue.
[2013-09-20 07:53:09 -0400] ocholetras: aha
[2013-09-20 07:53:31 -0400] PeterBengton: It's nice if it ends up in /etc/chef/encrypted_data_bag_secret, but nowadays that location can be specified in Chef::Config
[2013-09-20 07:53:36 -0400] PeterBengton: :)
[2013-09-20 07:54:01 -0400] PeterBengton: The problem is that Opscode have changed stuff, and in a way, it seems, that makes it impossible to upload the key at all
[2013-09-20 07:54:26 -0400] ocholetras: https://tickets.opscode.com/browse/CHEF-4011
[2013-09-20 07:54:57 -0400] PeterBengton: I'm well aware of CHEF-4011. Problem is that the procedure doesn't seem to work as described.
[2013-09-20 07:55:47 -0400] PeterBengton: Setting knife[:secret_file] isn't an option unless you want ALL your databags to be encrypted.
[2013-09-20 07:56:52 -0400] PeterBengton: And besides, setting knife[:secret_file] to point to a key file doesn't in fact install it on the instance, even though the deprecation warning appears.
[2013-09-20 08:20:10 -0400] PeterBengton: The underlying problem is described here: https://tickets.opscode.com/browse/KNIFE-349
[2013-09-20 08:27:35 -0400] ocholetras: so is a knife ec2 integration stuff
[2013-09-20 08:28:20 -0400] ocholetras: may be you can do a workaround
[2013-09-20 08:28:59 -0400] ocholetras: something like downloading the key file with scp from your deploy server or whatever..
[2013-09-20 08:29:08 -0400] ocholetras: less segure but works till the issue is resolved..
[2013-09-20 08:33:21 -0400] PeterBengton: A second step is not an option to our use case, it must be atomic. I see that Opscode have added --secret-file and --secret to "knife ec2 server create", but it doesn't seem they have released the fix.
[2013-09-20 08:35:23 -0400] ocholetras: it would be an extra step on the bootstrap script..
[2013-09-20 08:42:16 -0400] PeterBengton: I was hoping not having to go down the bootstrap script modification path.
[2013-09-20 08:42:52 -0400] PeterBengton: Seems hackish, when there's other alternatives advertised by opscode
[2013-09-20 08:49:37 -0400] PeterBengton: Interesting: --secret-file and --secret *have* been released (gem v0.6.4), but they don't work and don't turn up in the list of options. Must be a bug, but I can't find a bug report anywhere.
[2013-09-20 08:57:37 -0400] ocholetras: yea sounds like that
[2013-09-20 09:00:28 -0400] pkieszcz: Any bright idea what i misspeled? 169>> default['httpd']['kerberos']['mod_auth_kerb']['package'] = "mod_auth_kerb-5.4-9.x86_64.rpm"
[2013-09-20 09:00:28 -0400] pkieszcz:  gives me
[2013-09-20 09:00:39 -0400] pkieszcz: undefined method `[]=' for nil:NilClass
[2013-09-20 09:01:02 -0400] maloik: Anyone aware of any good resources on using chef-solo for setting up (mac osx) workstations ?
[2013-09-20 09:01:29 -0400] ocholetras: workstations or nodeS
[2013-09-20 09:01:38 -0400] maloik: workstations, as in developer machines
[2013-09-20 09:01:47 -0400] ocholetras: ok
[2013-09-20 09:02:23 -0400] ocholetras: so you are going to use chef-solo for provisioning the workstations?
[2013-09-20 09:02:38 -0400] ocholetras: gem install chef + clone repo + knife.rb + .pem files?
[2013-09-20 09:02:49 -0400] maloik: correct... I have a number of examples here from github but very little experience with the process
[2013-09-20 09:02:57 -0400] ocholetras: never used chef-solo
[2013-09-20 09:03:00 -0400] maloik: so kind of looking for a walkthrough / guide
[2013-09-20 09:03:34 -0400] ocholetras: cant help you mor than google right now
[2013-09-20 09:03:36 -0400] ocholetras: more
[2013-09-20 09:04:02 -0400] maloik: np, if anyone else has any clues on comfirmed good quality guides, I'm happy to hear it
[2013-09-20 09:04:14 -0400] ocholetras: pkieszcz: are u shure that the execution fails there?
[2013-09-20 09:04:28 -0400] ocholetras: sounds like ruby code fail not attribute assingment
[2013-09-20 09:06:46 -0400] pkieszcz: http://pastebin.com/xwvaMxRS
[2013-09-20 09:06:50 -0400] pkieszcz: this is my output
[2013-09-20 09:07:17 -0400] PeterBengton: Just filed this: https://tickets.opscode.com/browse/KNIFE-374
[2013-09-20 09:09:05 -0400] pkieszcz: ocholetras: http://pastebin.com/bUcaf7gF my recipe where i want to use it
[2013-09-20 09:13:11 -0400] ocholetras: pkieszcz:  cant see anything wrong on your code , at least on the default.rb attributes O_o
[2013-09-20 09:13:23 -0400] ocholetras: i dont know if it is a chef-issue
[2013-09-20 09:13:33 -0400] pkieszcz: yep - this is kinda strange
[2013-09-20 09:13:34 -0400] ocholetras: chef-solo issue
[2013-09-20 09:13:35 -0400] pkieszcz: so that's why asked on irc ;)
[2013-09-20 09:13:35 -0400] ocholetras: i mean
[2013-09-20 09:13:54 -0400] ocholetras: have you tried that recipe on a chef-server
[2013-09-20 09:13:54 -0400] ocholetras: ?
[2013-09-20 09:14:04 -0400] pkieszcz: i use the chef-solo
[2013-09-20 09:15:04 -0400] pkieszcz: and
[2013-09-20 09:15:07 -0400] pkieszcz: i think i found the issue
[2013-09-20 09:15:12 -0400] pkieszcz: on my recipe
[2013-09-20 09:15:25 -0400] pkieszcz: missing the ['httpd']
[2013-09-20 09:15:36 -0400] pkieszcz: cookbook_file node['kerberos']['mod_auth_kerb']['package'] do
[2013-09-20 09:15:40 -0400] ocholetras: lol
[2013-09-20 09:15:52 -0400] ocholetras: didnt saw the pastebin for your recipe
[2013-09-20 09:16:20 -0400] ocholetras: but comipler fails on attribute file
[2013-09-20 09:16:25 -0400] ocholetras: curious he he
[2013-09-20 09:55:26 -0400] lewiz: What's the best place to define variables used by multiple cookbooks?  e.g. the hostname of a database server?
[2013-09-20 10:04:01 -0400] pkieszcz: ocholetras: acuatlly it didn't help me :(
[2013-09-20 10:09:08 -0400] pkieszcz: 169:  default['kerberos']['mod_auth_kerb']['package'] = "mod_jk-1.2.31-httpd-2.2.x.so"
[2013-09-20 10:09:09 -0400] pkieszcz: 170>> default['httpd']['kerberos']['mod_auth_kerb']['conf'] = "xcs_kerb.conf.erb"
[2013-09-20 10:09:09 -0400] pkieszcz: 4 attributes are too much?
[2013-09-20 10:11:11 -0400] pkieszcz: chef-11.6.0-1.el6.x86_64
[2013-09-20 13:03:15 -0400] ocholetras: any of you have used encrypted data bags with users cookbook
[2013-09-20 13:03:15 -0400] ocholetras: ?
[2013-09-20 13:04:34 -0400] bmoritz: ocholetras: I didn't think they were supported
[2013-09-20 13:06:37 -0400] ocholetras: yea
[2013-09-20 13:06:38 -0400] ocholetras: xD
[2013-09-20 13:06:51 -0400] ocholetras: oficially they are not supported he he
[2013-09-20 13:07:00 -0400] ocholetras: but dont like to store passwords plain style
[2013-09-20 13:07:56 -0400] ocholetras: or to make a hash with and encryption method
[2013-09-20 13:07:59 -0400] ocholetras: for each platform
[2013-09-20 13:08:06 -0400] ocholetras: rh uses md5
[2013-09-20 13:08:11 -0400] ocholetras: ubuntu uses sha512
[2013-09-20 13:08:13 -0400] ocholetras: and so on...
[2013-09-20 13:08:16 -0400] ocholetras: -_-'
[2013-09-20 13:08:43 -0400] a_ro: we use encrypted onesbut we use chef-solo...
[2013-09-20 13:08:57 -0400] a_ro: aeh..knife-solowithout a chef server
[2013-09-20 13:10:25 -0400] ocholetras: yea and custom cookbook i bet?
[2013-09-20 13:10:42 -0400] ocholetras: users cookbook is great because it looks for a users with a group on your data bag
[2013-09-20 13:10:52 -0400] ocholetras: and creates each user with his info etc..
[2013-09-20 13:11:10 -0400] ocholetras: but looks like password management is not so useful
[2013-09-20 13:11:13 -0400] ocholetras: ><'
[2013-09-20 13:13:11 -0400] a_ro: with a wrapper cookbook, yesbut the user cookbook just needs apropriate data_bags to create users imho
[2013-09-20 13:13:33 -0400] a_ro: e.g. users_YOURUSER.json
[2013-09-20 13:14:15 -0400] ocholetras: yea
[2013-09-20 13:14:20 -0400] ocholetras: but the passwords
[2013-09-20 13:14:23 -0400] ocholetras: should be
[2013-09-20 13:14:28 -0400] ocholetras: shadow hashes
[2013-09-20 13:14:41 -0400] ocholetras: and for each system there is a diferent encryption alogrithn
[2013-09-20 13:16:08 -0400] a_ro: ahnow I see what you mean..
[2013-09-20 13:19:35 -0400] ocholetras: yea ^^
[2013-09-20 13:19:47 -0400] ocholetras: i dont know if can put plain text password on "password" field
[2013-09-20 13:19:51 -0400] ocholetras: if i would
[2013-09-20 13:19:57 -0400] ocholetras: using encrypted data bag
[2013-09-20 13:20:01 -0400] ocholetras: and go ahead!
[2013-09-20 13:20:40 -0400] a_ro: hm..don't know either...
[2013-09-20 13:20:46 -0400] ocholetras: thx!
[2013-09-20 13:20:48 -0400] ocholetras: anyway!
[2013-09-20 13:20:50 -0400] ocholetras: see you!
[2013-09-20 13:30:59 -0400] pkieszcz: Is there
[2013-09-20 13:31:02 -0400] pkieszcz: any easy way
[2013-09-20 13:31:12 -0400] pkieszcz: to change attribute value to lower case?
[2013-09-20 13:34:59 -0400] pkieszcz: .<%= LOWER(node['kerberos']['realm']) %>  - wonder if this does work
[2013-09-20 13:35:08 -0400] thom: foo.downcase
[2013-09-20 13:35:47 -0400] thom: in your case <%= node["kerberos"]["realm"].downcase %> , pkieszcz
[2013-09-20 13:36:01 -0400] pkieszcz: thank you :)
[2013-09-20 14:21:39 -0400] mveitas: I am looking to use a cookbook and install the logstash agent the problem is has an 'include_recipe "java"'.  Is there any way to ignore the included recipe?
[2013-09-20 14:23:04 -0400] mveitas: This is the agent recipe: https://github.com/lusis/chef-logstash/blob/master/recipes/agent.rb
[2013-09-20 14:26:26 -0400] adamjk-dev: mveitas: you can look at chef-rewind, that might do the trick
[2013-09-20 14:26:51 -0400] Raboo: hi, what has happened to https://github.com/opscode/chef-rundeck ?
[2013-09-20 14:26:57 -0400] adamjk-dev: mveitas: you would essentially write a "wrapper" cookbook and see if you can remove the resource (if that is how an include happens, not sure) to include the java recipe
[2013-09-20 14:27:47 -0400] jchauncey: why would you want to remove it?
[2013-09-20 14:27:55 -0400] adamjk-dev: Raboo: uh oh, not sure.... but this might be close: https://github.com/smoyer/chef-rundeck
[2013-09-20 14:28:14 -0400] mveitas: We are on EC2 and already have java installed on a base AMI that we use
[2013-09-20 14:28:38 -0400] adamjk-dev: Raboo: or I found this too: https://github.com/oswaldlabs/chef-rundeck
[2013-09-20 14:28:40 -0400] jchauncey: does it not ignore the fact that java is already installed and try to install it as well?
[2013-09-20 14:28:53 -0400] jchauncey: i thought the java recipe was pretty smart like that
[2013-09-20 14:29:06 -0400] jchauncey: at least it would do that if the same version is trying to be installed
[2013-09-20 14:31:41 -0400] adnichols: The java cookbook looks for the install it creates - doesn't look for other java installs
[2013-09-20 14:32:09 -0400] mveitas: jchauncey: it's not as smart as you can think from what I can see and like adnichols just said, only looks for installs it creates
[2013-09-20 14:32:28 -0400] Raboo: adamjk-dev ok thanks
[2013-09-20 14:33:09 -0400] adamjk-dev: Raboo: sure, there could be difference, not sure. But, I have no idea where the old one went either :)
[2013-09-20 14:33:55 -0400] Raboo: well i guess someone deleted it
[2013-09-20 14:34:02 -0400] jtimberman: Raboo: the rubygem seems to point here: https://github.com/oswaldlabs/chef-rundeck
[2013-09-20 14:34:08 -0400] jchauncey: adnichols: that kind of stinks. seems like you would want it to abort if the same version of java is already installed
[2013-09-20 14:34:34 -0400] jtimberman: adnichols: one version of java per container! ;)
[2013-09-20 14:35:43 -0400] mveitas: you can have many different versions of java installed and many different apps running different flavors I'll just create a PR to conditionally include the java recipe if an attribute is set
[2013-09-20 14:46:22 -0400] matticulous: can anyone help with a chef server issue? latest problem is a failure when doing chef-server-ctl test. Encountered an error attempting to create client pedant_admin_client
[2013-09-20 14:46:23 -0400] matticulous: Response Code was: 500
[2013-09-20 14:46:24 -0400] matticulous: Response Body was: {"error":["internal service error"]}
[2013-09-20 14:46:24 -0400] matticulous: Exception during Pedant credentials setup
[2013-09-20 14:47:06 -0400] mveitas: Wondering if it makes sense to add a conditional in the java::default to look at a node attribute to determine if the recipe should actually install java
[2013-09-20 14:48:36 -0400] mveitas: We have our own wrapper cookbook that installs Java onto AMIs that we use to reduce the bootstrap time. I am sure there are lots of other cookbooks that require java, but it could already exist on the system
[2013-09-20 15:00:19 -0400] matticulous: can anyone point me in the direction of some information on backing up/restoring chef 11 data? use case would be to migrate an existing server to a new installation in a new data center.
[2013-09-20 15:01:20 -0400] s2r2: matticulous: http://www.opscode.com/blog/2013/03/12/5106/  it's a migration guide, but it's a start ;)
[2013-09-20 15:02:03 -0400] matticulous: s2r2: perfect. thx! i'll start there.
[2013-09-20 15:02:39 -0400] s2r2: :)
[2013-09-20 15:10:06 -0400] lewiz: Is it possible to apply a recipe multiple times but with a different variable passed in each time?  e.g. if I have three services ftp, sftp, webdav which are all deployed in the same fashion - can I create subrecipies that each set a variable and execute another recipe that has the bulk of the work?
[2013-09-20 15:13:32 -0400] jtimberman: lewiz: no, the recipes are only included one time. you should use a definition or a LWRP for repeated patterns of resources.
[2013-09-20 15:15:17 -0400] lewiz: jtimberman: thanks - I'll check them out
[2013-09-20 15:16:34 -0400] lewiz: jtimberman: definition looks to be it - thanks
[2013-09-20 15:17:51 -0400] ortho_stice: Anyone have any good blog posts / links regarding roles vs "role cookbooks"?  Not easy to good on those terms...
[2013-09-20 15:18:01 -0400] ortho_stice: *google*
[2013-09-20 15:19:13 -0400] whitefinch: Question: I'm just setting up my knife workstation and I am a bit confused by the instructions here: http://docs.opscode.com/install_workstation.html I'm at the "Get knife.rb and .pem files" section...
[2013-09-20 15:23:33 -0400] ichilton: How can I use a variable in a search string?
[2013-09-20 15:23:57 -0400] ichilton: i.e I want hosts with a certain role in the same environment as the node?
[2013-09-20 15:24:29 -0400] ichilton: Can I do? -  search(:node, "chef_environment:#{node.chef_environment}")
[2013-09-20 15:24:31 -0400] adnichols: include #{node.chef_environment} ?
[2013-09-20 15:24:46 -0400] adnichols: yeah, that should work
[2013-09-20 15:25:08 -0400] ichilton: thanks adnichols
[2013-09-20 15:26:30 -0400] ichilton: adnichols: Is there a neater way of doing this?
[2013-09-20 15:26:32 -0400] ichilton: adnichols: http://pastebin.com/xiLFn9Bs
[2013-09-20 15:26:42 -0400] ichilton: too much in and out of erb :)
[2013-09-20 15:27:25 -0400] adnichols: why not do the search in your recipe and pass the results into the template?
[2013-09-20 15:27:56 -0400] ichilton: could do!
[2013-09-20 15:28:08 -0400] adnichols: That'd probably cleanup the template at least
[2013-09-20 15:28:16 -0400] ichilton: what's the best way of doing that? - just set: default[:something] ?
[2013-09-20 15:28:29 -0400] adnichols: look at variables() in templates
[2013-09-20 15:29:59 -0400] ichilton: ah yes, thanks
[2013-09-20 15:33:57 -0400] ichilton: adnichols: ok, so ive got:
[2013-09-20 15:33:58 -0400] ichilton: app_servers = search(:node, "chef_environment:#{node.chef_environment} AND role:audacious-app").{ |n| n['ipaddress'] }
[2013-09-20 15:34:04 -0400] ichilton: and:
[2013-09-20 15:34:05 -0400] ichilton: variables({ :app_servers => app_servers })
[2013-09-20 15:34:07 -0400] ichilton: which I think is ok?
[2013-09-20 15:34:22 -0400] ichilton: adnichols: but then still this in the template:
[2013-09-20 15:34:22 -0400] ichilton:   <%
[2013-09-20 15:34:23 -0400] ichilton:     app_servers.each do |app_server|
[2013-09-20 15:34:23 -0400] ichilton:       %> server <%= app_server %> fail_timeout=0; <%
[2013-09-20 15:34:23 -0400] ichilton:     end
[2013-09-20 15:34:25 -0400] ichilton:   %>
[2013-09-20 15:34:35 -0400] ichilton: Is there a way to loose some <% and %>'s?
[2013-09-20 15:34:56 -0400] ichilton: can I use interpolation some how?
[2013-09-20 15:34:59 -0400] adnichols: Sure - you don't have to close the erb just to print "server" :)
[2013-09-20 15:35:47 -0400] jtimberman: ortho_stice: blog post on the subject: http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html and it contains links to some others.
[2013-09-20 15:36:03 -0400] adnichols: I gotta run and do some dadops - my son demands pixelmon time...
[2013-09-20 15:36:09 -0400] ortho_stice: thanks jtimberman
[2013-09-20 15:38:04 -0400] ichilton: adnichols: how? - can you use puts?
[2013-09-20 15:43:19 -0400] jtimberman: ichilton: https://gist.github.com/jtimberman/b659ed348927b13c7001 i believe
[2013-09-20 15:45:28 -0400] ichilton: jtimberman: ahhh, of course :)
[2013-09-20 15:45:32 -0400] ichilton: mind block there - thanks
[2013-09-20 15:45:41 -0400] ichilton: what's the difference between %> and -%> ?
[2013-09-20 15:46:45 -0400] jtimberman: -%> suppresses a blank  line in the rendered template
[2013-09-20 15:47:55 -0400] ichilton: ahh, funky
[2013-09-20 15:47:56 -0400] ichilton: thanks
[2013-09-20 15:50:21 -0400] ichilton: I was thinking of an attribute that defaults to false that I override on a node level to enable app servers in the pool to go in there - does that sound sane or is there a better way?
[2013-09-20 15:53:06 -0400] whitefinch: When running knife configure --initial -- i keep getting this error: ERROR: OpenSSL::PKey::RSAError: private key needed.
[2013-09-20 16:15:16 -0400] whitefinch: does anyone run knife on their chef server?
[2013-09-20 16:15:33 -0400] whitefinch: I was told its best practice to have a separate box for knife....
[2013-09-20 16:18:06 -0400] gad0lin: heyo, I am looking for the hint for sharing chef repository between many projects, does it make sense or everyone should fork from clean repo, what works best for you?
[2013-09-20 16:18:59 -0400] gad0lin: we have a little bit mess, with many chef server used by many teams, keys being kept in common repo. Everyone is afraid of the complexity.
[2013-09-20 16:19:44 -0400] gad0lin: in my project i am using my own repo and am happy but 3 other teams has monster repo with all the hacks, and it really looks ugly
[2013-09-20 16:21:23 -0400] Majost: I found a bug in the docs: http://docs.opscode.com/resource_link.html
[2013-09-20 16:21:39 -0400] Majost: Do I report this via tickets.opscode.com?
[2013-09-20 16:33:09 -0400] miah: yes
[2013-09-20 16:39:01 -0400] ragusource: hey guys, I'm using the apache2 module, how do I get apache2 to be enabled when the vm come up?
[2013-09-20 16:42:58 -0400] Majost: ragusource: It should be done for you by default
[2013-09-20 16:43:16 -0400] Majost: the service provider handles this though
[2013-09-20 16:43:34 -0400] ragusource: Majost: It did before, but it doesn't anymore since I updated vagrant :(
[2013-09-20 16:44:29 -0400] Majost: This line in the default recipe for the service provider does what you were asking about: https://github.com/opscode-cookbooks/apache2/blob/master/recipes/default.rb#L43
[2013-09-20 16:44:45 -0400] tscanausa: ragusource: is vagrant running the provision step?
[2013-09-20 16:45:08 -0400] ragusource: No, they seem to have removed the provision step from the up command.
[2013-09-20 16:45:13 -0400] ragusource: Annoying!
[2013-09-20 16:45:50 -0400] ragusource: But I would of thought once it was provisioned, it should remember the state it was in previously.
[2013-09-20 16:46:09 -0400] Majost: depends if you destroy the VM or not.
[2013-09-20 16:46:19 -0400] ragusource: I did halt, then up
[2013-09-20 16:46:19 -0400] tscanausa: they removed reprovision on the up command, if a machine was already provision they really is no need to reprovision it. ( I understand that, agree is different) use vagrant provision
[2013-09-20 16:46:21 -0400] chip-: ragusource: From the 1.3.0 change log: "vagrant up will now only run provisioning by default the first time it is run. Subsequent reload or up will need to explicitly specify the --provision flag to provision. [GH-1776]"
[2013-09-20 16:46:30 -0400] Majost: then yeah, the disk state should remain the same
[2013-09-20 16:46:59 -0400] Majost: not sure about memory state though
[2013-09-20 16:47:06 -0400] chip-: I disagree with that choice, honestly. But since they started shipping non-convergent provisioners in the mainline, I suppose I see where it came from.
[2013-09-20 16:47:47 -0400] ragusource: It makes sense in a way, just annoying.
[2013-09-20 16:48:23 -0400] tscanausa: it used to bug me when I had a bad ffmpeg chef recipe and the up command took 20 minutes to run.
[2013-09-20 16:48:36 -0400] chip-: I'd have solved it by dropping non-convergent provisioners from mainline myself, but the ansible cats would probably scream. :)
[2013-09-20 16:48:44 -0400] ragusource: does the apache2 module have some option to set the service to run at boot? I can't find it
[2013-09-20 16:49:18 -0400] Majost: halt and up is not a reboot
[2013-09-20 16:49:28 -0400] Majost: I don't think anyway
[2013-09-20 16:49:53 -0400] ragusource: it's shutdown and boot up as far as i know
[2013-09-20 16:50:01 -0400] Majost: huh
[2013-09-20 16:50:07 -0400] ragusource: halt = shutdown
[2013-09-20 16:50:11 -0400] Majost: ah
[2013-09-20 16:50:13 -0400] ragusource: up = power up
[2013-09-20 16:50:14 -0400] chip-: ragusource: It should be set to start at boot. Line 43 of the default.rb in the current release.
[2013-09-20 16:50:15 -0400] Majost: I usually use reload
[2013-09-20 16:50:32 -0400] ragusource: yeah, reload is reboot
[2013-09-20 16:50:51 -0400] Majost: also reprovisions though
[2013-09-20 16:51:36 -0400] ragusource: Not anymore
[2013-09-20 16:51:50 -0400] ragusource: Nothing runs provision anymore
[2013-09-20 16:52:04 -0400] ragusource: you have to manually specify it, by adding --provision
[2013-09-20 16:56:24 -0400] ragusource: chip-: It should persist, but it does not, have a look at this: http://pastebin.com/rYJ9abBt
[2013-09-20 16:56:52 -0400] chip-: What's chkconfig say?
[2013-09-20 16:56:56 -0400] ragusource: httpd is stopped for some reson.
[2013-09-20 16:57:28 -0400] ragusource: chkconfig httpd, says nothing.
[2013-09-20 16:58:15 -0400] chip-: chkconfig --list httpd ?
[2013-09-20 16:58:22 -0400] ragusource: httpd          0:off1:off2:on3:on4:on5:on6:off
[2013-09-20 16:59:30 -0400] wizonesolutions: I am trying to `sudo gem install chef` onto an Ubuntu 13.04 machine, and it's failing on highline-1.6.19 with "undefined method 'size' on nil:NilClass"
[2013-09-20 16:59:40 -0400] chip-: OK, that says it's set to start at boot when the system comes on
[2013-09-20 17:00:41 -0400] ragusource: but it's stopped strange, some other issue maybe
[2013-09-20 17:00:42 -0400] chip-: wizonesolutions: What version of Ruby does 13.04 come with? Is it still 1.8?
[2013-09-20 17:01:45 -0400] wizonesolutions: chip-: I think 1.9.3 is installed manually I am actually using a tool called Veewee, which automates most of the box building...but that's what it fails on. I notice that another template uses install.sh from Opscode's site though instead of using the gem. Maybe that is worth a shot?
[2013-09-20 17:01:56 -0400] wizonesolutions: chip-: not sure if the install script only works on some OSes though
[2013-09-20 17:02:33 -0400] wizonesolutions: chip-: to answer your question directly, the VM in question returns 1.9.3-p392 for `ruby -v`
[2013-09-20 17:02:43 -0400] chip-: wizonesolutions: Ah! If you're installing Chef to a Vagrant image, use the vagrant-omnibus plugin. It will automate the installation of Chef into your guest images, and then you don't have to build Chef into your guest.
[2013-09-20 17:03:32 -0400] tasslehawf: Is there a way to setup basic security in jenkins with chef?
[2013-09-20 17:03:43 -0400] chip-: wizonesolutions: FWIW Opscode ships bare-bones vagrant images for Virtualbox, https://github.com/opscode/bento/
[2013-09-20 17:04:01 -0400] wizonesolutions: chip-: yeah, I could do that on my own stuff, but I'd like if possible to contribute a fix to them without just saying "tell people to use a plugin" :)
[2013-09-20 17:04:04 -0400] chip-: wizonesolutions: The VeeWee definitions used to create them are in that repo too, if you'd like to roll on a different virtualization platform.
[2013-09-20 17:04:10 -0400] wizonesolutions: chip-: good to know about that plugin in any case.
[2013-09-20 17:04:41 -0400] wizonesolutions: chip-: Oh, neat. Yeah, I am putting Parallels through its paces now that yshahin/vagrant-parallels is coming along
[2013-09-20 17:06:07 -0400] wizonesolutions: chip-: good to know also tha Opscode itself doesn't include Chef anymore, though. that's something of a convincing case for, "maybe you don't need to do this anymore in Veewee either" if it comes to that
[2013-09-20 17:06:07 -0400] chip-: wizonesolutions: Back to the question you've actually asked, though, might try installing the high line gem yourself and seeing what it needs. Not sure if it has dependencies / compilation under the hood or not?
[2013-09-20 17:06:34 -0400] wizonesolutions: chip-: yeah I think I'll try that next and see if it spits out anything more verbose
[2013-09-20 17:06:52 -0400] ragusource: Starting httpd: httpd: Could not reliably determine the server's fully qualified
[2013-09-20 17:06:53 -0400] ragusource:  domain name, using 127.0.0.1 for ServerName
[2013-09-20 17:06:53 -0400] ragusource:                                                            [  OK  ]
[2013-09-20 17:06:54 -0400] chip-: wizonesolutions: So the install.sh script will install Omnibus Chef into /opt/chef, which includes its own embedded Ruby stack with everything linked back there. Punts completely on trying to use system ruby.
[2013-09-20 17:07:06 -0400] ragusource: chip-: thats what my boot.log says
[2013-09-20 17:07:09 -0400] ragusource: but it's lying!
[2013-09-20 17:08:34 -0400] chip-: ragusource: I've gotta bail in a second, but check /var/log/httpd and see what comes up there
[2013-09-20 17:08:42 -0400] wizonesolutions: chip-: hmm, that doesn't seem like a bad idea. I mean given that it works on another existing template. I can avoid RubyGem hell entirely. Thanks for the help!
[2013-09-20 17:08:48 -0400] ragusource: chip-: thanks buddy
[2013-09-20 17:09:36 -0400] chip-: wizonesolutions: The vagrant-omnibus plugin just automates the installation of that version of Chef for you. :)
[2013-09-20 17:09:38 -0400] wizonesolutions: chip-: ah, waitwait. it's using /opt/ruby/bin/gem which is 2..3
[2013-09-20 17:09:39 -0400] ragusource: Starting httpd: Warning: DocumentRoot [/vagrant/workspace/phalcon-tutorial2/publ
[2013-09-20 17:09:39 -0400] ragusource: ic] does not exist
[2013-09-20 17:09:41 -0400] ragusource: Found it!
[2013-09-20 17:09:45 -0400] wizonesolutions: chip-: 2.0.3* I mean
[2013-09-20 17:09:52 -0400] wizonesolutions: chip-: issues with that maybe?
[2013-09-20 17:10:00 -0400] ragusource: Don't use the /vagrant mount I guess, lol
[2013-09-20 17:10:07 -0400] chip-: Chef should work on 2. but it's not necessarily supported.
[2013-09-20 17:10:42 -0400] wizonesolutions: chip-: Ruby's not 2 though, same as version I mentioned above. The script seems more reliable though. Gonna try it.
[2013-09-20 17:10:55 -0400] chip-: Ahhh.
[2013-09-20 17:11:44 -0400] wizonesolutions: chip-: worst case, I'll just remove it in my own definition and file an issue about it. not a show stopper. I'm not even going to be using Chef on this box. I just do unnecessary things like this. lol
[2013-09-20 17:11:48 -0400] nbouscal: Using community nginx cookbook, trying to specify version 1.2.8 to mirror production, won't converge. I believe I ran into this same error ~6mo ago, ohai is overriding the version number that I specify. Anyone know about this?
[2013-09-20 17:22:54 -0400] fak3r: so on a node that I've bootstrapped, I have chef-client running: /opt/chef/embedded/bin/ruby /usr/bin/chef-client -i 1800 -s 300
[2013-09-20 17:22:58 -0400] dgarstang: Shoudln't installing the chef client get me a ruby and a gem in /opt/chef/bin ?
[2013-09-20 17:23:19 -0400] fak3r: but knife status says: 43 minutes ago
[2013-09-20 17:23:30 -0400] log1kal: dgarstang beleive it's /opt/chef/embedded/bin
[2013-09-20 17:23:59 -0400] fak3r: if I login to the node and `clief-client` it'll run, see an updated recipe in a role and install it - but why isn't it doing this automatically every 1800 seconds?
[2013-09-20 17:24:03 -0400] dgarstang: log1kal: ah, ok. Weird. it didn't set alternatives like on a different box
[2013-09-20 17:24:16 -0400] log1kal: `find /opt/chef/ -type f -iname ruby` will find it for you
[2013-09-20 17:24:25 -0400] log1kal: oh , it shouldn't be an 'alternative'
[2013-09-20 17:24:38 -0400] dgarstang: hm
[2013-09-20 17:25:04 -0400] log1kal: it's meant to be chef's own isolated ruby interpreter
[2013-09-20 17:25:18 -0400] dgarstang: log1kal: i thought it set that as the default
[2013-09-20 17:25:45 -0400] log1kal: on an instance with no ruby, the omnibus ruby won't be added as a 'system' ruby
[2013-09-20 17:30:30 -0400] mstyne: is there a means to delete an attribute from a node from within a recipe
[2013-09-20 17:30:37 -0400] mstyne: i'm completely missing it in the documentation, if it exists
[2013-09-20 17:30:43 -0400] miah: fak3r: you have to configure it to run as a daemon for it to do so.
[2013-09-20 17:31:54 -0400] fak3r: miah: ok in my base role I use: recipe[chef-client] and recipe[chef-client::runitservice] so it is running is that the right way to have it setup?
[2013-09-20 17:32:18 -0400] miah: if its working correctly, then you will see chef-client running as a daemon when you use 'ps'
[2013-09-20 17:33:04 -0400] fak3r: yep, I have 2 lines when I ps: root      5039  4959  0 10:26 ?        00:00:00 runsv chef-client
[2013-09-20 17:33:04 -0400] fak3r: root      5095  5039  0 10:26 ?        00:00:24 /opt/chef/embedded/bin/ruby /usr/bin/chef-client -i 1800 -s 300
[2013-09-20 17:33:46 -0400] fak3r: miah: so that's my question, it is running, but knife status on the chef-server says, "55 minutes ago"
[2013-09-20 17:34:13 -0400] miah: sounds like you need to do some debugging
[2013-09-20 17:34:18 -0400] miah: check logs and what not
[2013-09-20 17:34:54 -0400] Majost: So all this test kitchen and bento stuff is great. I am wondering if anyone knows if there are any plans to make Windows a first class citizen in all this stuff. I should note - it's not that I like windows, quite the opposite -- I hate Windows and rather have  Chef to do all the Windows work for me.
[2013-09-20 17:35:30 -0400] miah: its totally possible to make windows more first class, but we need to move away from the infantile recipe development model first
[2013-09-20 17:36:19 -0400] Majost: I am assuming you are referring to some of the hard-coded *nix sytle paths and whatnot?
[2013-09-20 17:37:11 -0400] fak3r: miah: chef/current log: Error Syncing Cookbooks so it's trying every 1800 secs, but then failing to sync the cookbooks. ok, thanks
[2013-09-20 17:37:40 -0400] miah: Majost: the whole model is flawed because people are trying to implment procedural programming in a declarative programming environment.
[2013-09-20 17:37:59 -0400] Majost: ah
[2013-09-20 17:38:13 -0400] miah: furthermore, there is a huge gap between how people understand how the chef client actually runs, and what happens when chef evaluates a recipe
[2013-09-20 17:38:24 -0400] miah: so we've falling into a flawed model of 'cookbook role wrappers'
[2013-09-20 17:38:36 -0400] Majost: yeah, you're <sarcasm> gonna love my next pull request then. </sarcasm>
[2013-09-20 17:38:55 -0400] miah: instead of embracing oop fundamentals and writing better abstractions
[2013-09-20 17:40:57 -0400] Majost: miah: you should do a session on that very subject at the next chefconf -- or foodfight for that matter
[2013-09-20 17:41:05 -0400] miah: i will continue to do so =)
[2013-09-20 17:41:13 -0400] miah: i ranted about this at chefconf already
[2013-09-20 17:41:20 -0400] miah: but i'll be discussing more at summit
[2013-09-20 17:41:26 -0400] log1kal: miah:  woo!
[2013-09-20 17:41:39 -0400] Majost: yeah, I wish I could go...  =(
[2013-09-20 17:41:40 -0400] log1kal: my problem with getting there is learning better ruby to do so.
[2013-09-20 17:41:42 -0400] log1kal: getting there.
[2013-09-20 17:41:54 -0400] log1kal: but it definitely raises the bar for "just enough ruby for chef"
[2013-09-20 17:41:55 -0400] Majost: I've got that issue as well
[2013-09-20 17:42:56 -0400] miah: go read: http://www.amazon.com/Practical-Object-Oriented-Design-Ruby-ebook/dp/B0096BYG7C/ http://www.amazon.com/The-Well-Grounded-Rubyist-David-Black/dp/1933988657 and http://www.amazon.com/Eloquent-Ruby-Addison-Wesley-Professional-Series/dp/0321584104
[2013-09-20 17:43:13 -0400] log1kal: I have Eloquent, but not the other two
[2013-09-20 17:43:16 -0400] log1kal: thanks for the suggestions :)
[2013-09-20 17:43:29 -0400] miah: poodr especially is what you should all read
[2013-09-20 17:44:04 -0400] miah: if we start thinking of software like 'apache' as our abstraction, and writing a resource that defines and manages that
[2013-09-20 17:44:17 -0400] miah: instead of a recipe, which abstractly defines that.
[2013-09-20 17:44:32 -0400] miah: see, a recipe, you have like 'service[:foo]' etc. but nothing that really says "apache"
[2013-09-20 17:44:37 -0400] miah: unless you know exactly what to look for
[2013-09-20 17:44:58 -0400] miah: so its impossible to make resources inspect the resourcecollection and make intelligent decisions based on their siblings
[2013-09-20 17:45:53 -0400] miah: eg, there is no reason why resources like say 'apache' couldnt define a attribute that returns a hash of its associated logs, and their format.
[2013-09-20 17:46:11 -0400] miah: and there is no reason why the logstash resource couldnt look for that information on all the resources and automatically configure itself
[2013-09-20 17:46:33 -0400] miah: instead, we have the pattern of 'hard code everything as node attributes (aka global variables)'
[2013-09-20 17:46:50 -0400] miah: though attributes aren't really global variables, they behave very similarly
[2013-09-20 17:47:01 -0400] miah: the whole merging / precedence thing makes for fun
[2013-09-20 17:47:21 -0400] miah: especially when you're explicitly setting node attributes all over the goddamn place
[2013-09-20 17:47:26 -0400] log1kal: ^
[2013-09-20 17:47:50 -0400] log1kal: currently trying to untangle a "setting node attribs all over the place" yak right now, actually
[2013-09-20 17:47:53 -0400] Majost: I am guilty of that for sure
[2013-09-20 17:48:09 -0400] miah: imho attributes should be the most minor bits of information that you are passing to resources as attributes to define some method of operation
[2013-09-20 17:48:22 -0400] miah: but they shouldn't be the entirety of the configuration
[2013-09-20 17:48:37 -0400] miah: consider this, configuration files don't necessarily represent the current state of a daemon
[2013-09-20 17:48:51 -0400] miah: but we spend a lot of time on templates etc
[2013-09-20 17:49:06 -0400] miah: when some software even has api's to set/retrieve the running configuraiton
[2013-09-20 17:49:26 -0400] miah: i get frustrated
[2013-09-20 17:49:54 -0400] miah: because its all a mess and its going to take a while for people to change their development habits
[2013-09-20 17:50:09 -0400] miah: most of these problems have already been solved or thought about in the actual programming world
[2013-09-20 17:50:40 -0400] Majost: how do you deal with the opposite -- that is, when some application lacks the api calls or an api entirely to configure it
[2013-09-20 17:51:03 -0400] miah: well, in that case you have to deal with its configuration files
[2013-09-20 17:51:38 -0400] miah: but i think we can be much more intelligent there too with a common data structure to store configurations in chef, and then a presenter on top of that which renders the configuraiton into the approrpriate format for the app.
[2013-09-20 17:51:50 -0400] miah: that is obviously not a easy task.
[2013-09-20 17:51:55 -0400] miah: but its not insurmountable either
[2013-09-20 17:52:03 -0400] miah: and i think its what we should be concentrating on
[2013-09-20 17:52:16 -0400] miah: rather than the current state of fragility
[2013-09-20 17:52:34 -0400] miah: with 'oh, well i need a slightly different configuration template how do i overwrite that in this recipe that i downloaded'
[2013-09-20 17:53:09 -0400] miah: even easier is templates can actually be arguments to the resource
[2013-09-20 17:53:37 -0400] miah: but because these are written as recipes, and not resources (or even definitions) its tricky to maintain/modify without actually modifying the code itself
[2013-09-20 17:53:51 -0400] miah: definitions aren't perfect either, as they are not really resources
[2013-09-20 17:53:57 -0400] miah: but they are what most 'recipes' should be
[2013-09-20 17:55:10 -0400] miah: they are a way to package an abstract collection of resources into a mock resource that takes arguments in as attributes and actions
[2013-09-20 17:56:34 -0400] miah: fwiw http://docs.opscode.com/essentials_cookbook_definitions.html
[2013-09-20 17:56:41 -0400] miah: and i never see _anybody_ use them
[2013-09-20 17:57:01 -0400] miah: and ideally, they'd be better than most 'role cookbooks'
[2013-09-20 17:57:07 -0400] Majost: huh
[2013-09-20 17:57:32 -0400] Majost: I didn't even know about this
[2013-09-20 17:57:40 -0400] Majost: probably because I have never seen them used
[2013-09-20 17:57:40 -0400] Majost: heh
[2013-09-20 17:57:56 -0400] miah: ya, exactly =)
[2013-09-20 17:59:06 -0400] miah: and users really _really_ and im not kidding but __really__ need to read and understand this: http://docs.opscode.com/essentials_nodes_chef_run.html
[2013-09-20 17:59:08 -0400] dgarstang: I'm trying to do a knife upload from jenkins... since jenkins puts jobs not under a common directory and knife requires the directory above the cookbook directory to be the sane name...
[2013-09-20 17:59:42 -0400] log1kal: miah: +1 on understanding the way chef runs work
[2013-09-20 17:59:53 -0400] log1kal: instead of what it looks like a chef run does :)
[2013-09-20 18:00:14 -0400] Majost: dgarstang: there are a couple of ways to deal with this
[2013-09-20 18:01:11 -0400] dgarstang: Majost: ooooh?
[2013-09-20 18:01:50 -0400] Majost: dgarstang: the way I have used is to specify the checkout/clone directory in the jenkins job scm config section, and then when you do a knife cookbook upload -o ${WORKSPACE}/pathspecified
[2013-09-20 18:02:13 -0400] dgarstang: Majost: kk, thanks! Lemme check that out.
[2013-09-20 18:02:27 -0400] Majost: the other is to just pass -o ${WORKSPACE} -- but its not as controlled imho
[2013-09-20 18:09:19 -0400] dgarstang: I'm wondering.... if I am using jenkins to deploy cookbooks... should I use knife to upload only that cookbook, or should I use berkshelf instead?
[2013-09-20 18:09:58 -0400] Majost: yeah, I haven't revisited that workflow recently... I use to commit and let jenkins do it for me...
[2013-09-20 18:10:18 -0400] dgarstang: Majost: Hm.
[2013-09-20 18:10:27 -0400] Majost: but berkshelf has altered my workflow significantly enough that I haven't been using jenkins for this stuff lately
[2013-09-20 18:11:00 -0400] dgarstang: Majost: We need to upload to multiple chef servers so jenkins seems like a common place to run that from.
[2013-09-20 18:11:10 -0400] Majost: that makes sense.
[2013-09-20 18:11:27 -0400] dgarstang: Majost: yah. the knife vs berkshelf bit is ... somewhat more murky.
[2013-09-20 18:12:58 -0400] dgarstang: meh now I'm getting '/var/lib/gems/1.8/gems/chef-11.6.0/lib/chef/cookbook_uploader.rb:16:in `work_queue': uninitialized constant Chef::CookbookUploader::Queue (NameError)' with a knife upload.
[2013-09-20 18:15:24 -0400] miah: i dont upload cookbooks to our chef server at all, jenkins handles it. we still use librarian/berkshelf stuff though for deb.
[2013-09-20 18:15:57 -0400] Majost: I wish jenkins could interpret travis files
[2013-09-20 18:16:05 -0400] Majost: we should all poke kk on that one
[2013-09-20 18:16:05 -0400] miah: ya
[2013-09-20 18:16:07 -0400] Majost: heh
[2013-09-20 18:16:35 -0400] dgarstang: miah: ... that's what I'm trying to get jenkins to do.
[2013-09-20 18:17:03 -0400] dgarstang: Errors like '/var/lib/gems/1.8/gems/chef-11.6.0/lib/chef/cookbook_uploader.rb:16:in `work_queue': uninitialized constant Chef::CookbookUploader::Queue (NameError)' aren't particularly helpful.
[2013-09-20 18:17:25 -0400] miah: honestly, at that point i'd rather run travis
[2013-09-20 18:17:35 -0400] dgarstang: travis? more fu to google
[2013-09-20 18:17:56 -0400] Majost: dgarstang: I haven't run chef 11.6 under ruby 1.8 before
[2013-09-20 18:18:07 -0400] Majost: do you have the RVM plug-in installed?
[2013-09-20 18:18:17 -0400] miah: ruby 1.8 is dead, done. finito.
[2013-09-20 18:18:22 -0400] dgarstang: Majost: I should be using the ruby 1.9 from chef. Dunno...
[2013-09-20 18:18:34 -0400] Majost: that path suggest it's 1.8
[2013-09-20 18:18:50 -0400] dgarstang: Hm... cuz 'which ruby' == '/opt/chef/embedded/bin/ruby'
[2013-09-20 18:18:51 -0400] miah: https://www.ruby-lang.org/en/news/2013/06/30/we-retire-1-8-7/
[2013-09-20 18:19:20 -0400] Majost: what about which knife
[2013-09-20 18:19:22 -0400] miah: if you can't upgrade, then i dare you to really articulate on _why_
[2013-09-20 18:19:28 -0400] dgarstang: == /usr/local/bin/knife
[2013-09-20 18:19:29 -0400] miah: because its probably bs =)
[2013-09-20 18:19:39 -0400] dgarstang: miah: lost me.
[2013-09-20 18:19:39 -0400] Majost: dgarstang: thats a symlink to something
[2013-09-20 18:19:45 -0400] Majost: what does the link resolve to
[2013-09-20 18:20:09 -0400] dgarstang: Majost: nothing. 'ls -l /usr/local/bin/knife' == '/usr/local/bin/knife'
[2013-09-20 18:20:12 -0400] Majost: huh
[2013-09-20 18:20:16 -0400] dgarstang: no linky
[2013-09-20 18:20:35 -0400] dgarstang: hm. first line of that is ruby 1.8
[2013-09-20 18:20:43 -0400] dgarstang: *sigh*
[2013-09-20 18:20:55 -0400] dgarstang: i JUST installed knife. apparently I did something wrong.
[2013-09-20 18:21:00 -0400] Majost: yeah, you seem to be using the gem version from your system ruby
[2013-09-20 18:21:02 -0400] dgarstang: chef rather
[2013-09-20 18:21:20 -0400] dgarstang: doesn't knife come with chef tho?
[2013-09-20 18:21:25 -0400] Majost: yes
[2013-09-20 18:21:46 -0400] dgarstang: i guess when I installed chef.... i hadn't switched to newer ruby... but doesn't chef do that? Much confused.
[2013-09-20 18:21:50 -0400] Majost: but you probably have two versions installed if you installed the omnibus package as well
[2013-09-20 18:22:24 -0400] dgarstang: well, of course the one at /opt/chef/embedded/bin is 1.9
[2013-09-20 18:23:10 -0400] dgarstang: i mean... dpkg -i chef ... that's what I did. What did I miss?
[2013-09-20 18:26:03 -0400] Majost: it looks like you may have also done gem install chef using ruby 1.8
[2013-09-20 18:26:10 -0400] Majost: but thats just a guess
[2013-09-20 18:26:21 -0400] dgarstang: Majost: nope. dpkg -i chef-client
[2013-09-20 18:26:42 -0400] dgarstang: so... do i remove chef, upgrade system ruby to 1.9 and reinstall chef again?
[2013-09-20 18:29:17 -0400] Majost: just try doing gem uninstall chef with the system ruby
[2013-09-20 18:29:35 -0400] dgarstang: 'Successfully uninstalled chef-11.6.0'
[2013-09-20 18:29:53 -0400] Majost: now check which knife
[2013-09-20 18:30:05 -0400] dgarstang: hm now knife is a linky
[2013-09-20 18:30:11 -0400] dgarstang: to /opt/chef/bin/knife
[2013-09-20 18:30:18 -0400] Majost: that looks right
[2013-09-20 18:30:20 -0400] dgarstang: which used /opt/chef/embedded/bin/ruby
[2013-09-20 18:30:24 -0400] dgarstang: suppose that's better
[2013-09-20 18:30:28 -0400] Majost: should be all set now
[2013-09-20 18:30:34 -0400] dgarstang: jeez. Thanks
[2013-09-20 18:30:38 -0400] Majost: np
[2013-09-20 18:31:06 -0400] dgarstang: upload works. Woo.
[2013-09-20 18:47:23 -0400] djstunami: If a particular rpm package has dependencies, how do you get chef to allow those dependencies to be installed?
[2013-09-20 18:51:27 -0400] sn0wb1rd: djstunami: Can't you use the package resource for that?
[2013-09-20 18:52:36 -0400] djstunami: sn0wb1rd: I was looking and it appears you can pass options to yum, but that seems very non-chef-like
[2013-09-20 18:54:35 -0400] douglaswth: yum should install dependencies automatically? are you seeing some different behavior?
[2013-09-20 18:55:12 -0400] sn0wb1rd: douglaswth: that's what I would guess so
[2013-09-20 18:58:34 -0400] djstunami: huh, looks like I'm using rpm_package rather than yum (as these are non-repo residing rpms) which runs "rpm -U" rather than yum
[2013-09-20 18:58:48 -0400] djstunami: I mean, rpm_package rather than "package"
[2013-09-20 19:00:14 -0400] daved: does anyone here know if Chef allows license renewal via webform order or do we need to call sales?
[2013-09-20 19:00:57 -0400] daved: my environment is very dynamic and a sudden increase in nodes can be expected
[2013-09-20 19:08:57 -0400] isotope: does anyone know if the example for creating the custom ohai plugin works
[2013-09-20 19:09:35 -0400] isotope: I'm trying to write one and am starting with the example but its failing saying that the attribute orly doesn't exist
[2013-09-20 19:10:46 -0400] isotope: btw I have other ohai plugins working
[2013-09-20 20:01:19 -0400] djstunami: isotope: are you using the ohai cookbook?
[2013-09-20 20:02:24 -0400] djstunami: I've done the orly example and it's worked fine
[2013-09-20 20:07:09 -0400] isotope: yeah I figured it out
[2013-09-20 20:15:39 -0400] dgarstang: aw man. I thought getting jenkins to deploy cookbooks would be easy. Not so much. I can't use knife to upload, since if a dependant cookbook isn't on the server, the upload fails. If I use berkshelf, then it can go and gran community cookbooks from upstream, but local ones we've been grabbing from ../ and that's not gonna work so well from a jenkins job.
[2013-09-20 20:22:28 -0400] dgarstang: And... jenkins is building on a commit. it could go and grab the local cookbook from a local chef server, but you'd have to do the commit (which cause jenkins to start te build), and make sure you also uploaded the deps before jenkins tried to grab it.
[2013-09-20 20:31:45 -0400] dgarstang: I'm guessing not many people have actually used jenkins to deploy cookbooks.
[2013-09-20 20:42:11 -0400] MrBIOS: hi folks, does anyone here know much about using chef-client in conjunction with an HTTPS/SSL proxy?
[2013-09-20 20:51:41 -0400] dgarstang: Errr... https://github.com/RiotGames/berkshelf/wiki/deprecated-locations What happened to chef_api?
[2013-09-20 20:52:15 -0400] dgarstang: 'Last edited by Jamie Winsor, 3 months ago' ... 3 months and not documented yet?
[2013-09-20 21:01:26 -0400] idlemich1el: can anyone explain to me what line 1 does in this recipe? https://github.com/elasticsearch/cookbook-elasticsearch/blob/master/recipes/default.rb#L1
[2013-09-20 21:01:46 -0400] idlemich1el: because it doesn't work with chef-client 11.6.0
[2013-09-20 21:06:04 -0400] sn0wb1rd: idlemich1el: It includes the Extensions module to the Recipe and Resource classes. Extensions is defined in https://github.com/elasticsearch/cookbook-elasticsearch/blob/1389723bd30f71813a770f46a8814c2436a440ee/libraries/print_value.rb#L1
[2013-09-20 21:07:33 -0400] volker-: Did anyone deploy their individual jenkins jobs? I don't mean the stuff jenkins builds but the job itself to the jenkins server.
[2013-09-20 21:08:34 -0400] drogoh: is there a way to get whichever role a node is using? my google-fu is failing
[2013-09-20 21:11:49 -0400] log1kal: drogoh : knife node show 'nodename' will show you the runlists and the last applied roles/recipes
[2013-09-20 21:14:00 -0400] cwj: drogoh: node[roles'] should be an array containing the list of roles on a node, expanded from the contents of the run list
[2013-09-20 21:14:16 -0400] dgarstang: I'm trying to do a berks install here and berks is telling me bc-apt isn't on the server but it is.
[2013-09-20 21:14:36 -0400] fak3r: new server, on the workstation knife configure initial but it won't/can't get the admin.pem from the path on the server, but it's right
[2013-09-20 21:23:56 -0400] rrrob: hi all, ive been trying to read role attributes from a recipe and dont know why it isnt working
[2013-09-20 21:24:36 -0400] rrrob: role json: { name: "blah", "default_attributes: { "test": "blah", "bag": { ... } } }
[2013-09-20 21:25:05 -0400] rrrob: in recipe: node["test"], node["bag"]["x"]
[2013-09-20 21:25:22 -0400] rrrob: dont get anything, i see the attributes being set when viewing the node on the chef server
[2013-09-20 21:28:14 -0400] drogoh: cwj: thanks. that got me where I needed to go
[2013-09-20 21:29:34 -0400] cwj: drogoh: rock on
[2013-09-20 21:47:08 -0400] Urocyon: Intermittently, like every couple of weeks I guess, my chef validation pem stops working.  I reregister my chef-validator and the new pem works fine for a while, then stops working again.  I don't believe anyone else is reregistering the chef-validator what else might it be?
[2013-09-20 21:54:30 -0400] lionel_: Hello
[2013-09-20 21:55:30 -0400] lionel_: I was wondering if anyone knew why intermittently chef-client runs on a server would produce the error "ArgumentError: invalid byte sequence in US-ASCII".
[2013-09-20 21:55:35 -0400] lionel_: This is in Chef 11
[2013-09-20 22:06:33 -0400] cap10morgan: has anyone seen nil returned from node.chef_environment when bootstrapping an instance with knife-ec2 under chef 11.6.0?
[2013-09-20 22:19:20 -0400] jessicab1: hm.. so if chef cant find a node attribute because it didnt exist.. why would it continue without errors? it used to always throw an error but it hasnt for a few days now and i cant figure out why.. currently its just filling in missing attributes with an empty string
[2013-09-20 22:21:54 -0400] fak3r: new chef-server, no web access to it, so I can ssh to it, but no knife to reregister a user (and running install again says chef is installed, but I need chef-client for knife)
[2013-09-20 22:25:08 -0400] rrrob: fak3r: get the validation.pem from the server and register new client with the validation.pem?
[2013-09-20 22:32:41 -0400] dgarstang: This is doing ABSOLUTELT nothin. The path isn't even valid. What's up? knife upload /roles/location_co.jsond -c /var/lib/jenkins/.chef/us1/knife.rb  -VV
[2013-09-20 22:34:45 -0400] jbz: dgarstang: The path isn't valid?  Are you sure?  It's relative to the chef_repo location...?
[2013-09-20 22:35:37 -0400] dgarstang: jbz: relative to chef_repo from knife.rb?
[2013-09-20 22:35:45 -0400] jbz: dgarstang: yep.
[2013-09-20 22:36:03 -0400] jbz: '/' is top level of the repo directory
[2013-09-20 22:36:14 -0400] dgarstang: hm i don't have a chef_repo option in any of my knife.rb files.
[2013-09-20 22:36:26 -0400] jbz: thatmight be why it's not working...
[2013-09-20 22:36:40 -0400] dgarstang: jbz: everything else works. This is on jenkins
[2013-09-20 22:36:48 -0400] jbz: you can specify at runtime using --chef-repo-path option
[2013-09-20 22:36:55 -0400] dgarstang: jbz: kk, lemme see
[2013-09-20 22:37:09 -0400] dgarstang: jbz: --chef-repo-path is.... what?
[2013-09-20 22:37:25 -0400] dgarstang: top level where roles/, cookbooks/ etc are?
[2013-09-20 22:37:30 -0400] jbz: yes
[2013-09-20 22:37:36 -0400] dgarstang: ah. ok
[2013-09-20 22:39:27 -0400] dgarstang: 'Error: invalid option: --chef-repo-path'
[2013-09-20 22:39:43 -0400] jbz: what command line are you using?
[2013-09-20 22:39:58 -0400] dgarstang: jbz: knife upload / --chef-repo-path /var/lib/jenkins/jobs/chef-sauce/workspace -c /var/lib/jenkins/.chef/us1/knife.rb  -VV
[2013-09-20 22:41:30 -0400] jbz: uh hm.  That I dunno...
[2013-09-20 22:41:37 -0400] dgarstang: jbz: Darn it.
[2013-09-20 22:42:09 -0400] jbz: You could try putting the chef_repo_path in your knife.rb
[2013-09-20 22:42:33 -0400] dgarstang: jbz: no can do. i could for a test... but jenkins is checking out multiple stuff... the repo path keeps changing
[2013-09-20 22:42:54 -0400] gchristensen: is there any documentation on the difference between FOSSChef and hosted Chef?
[2013-09-20 22:43:22 -0400] jbz: that shouldn't happen.  I'm not sure why it's puking on that option...
[2013-09-20 22:43:24 -0400] jbz: what version of knife?
[2013-09-20 22:44:08 -0400] dgarstang: jbz: downloaded chef client on this box today. knife -v == 'Chef: 11.6.0'
[2013-09-20 22:44:12 -0400] jbz: hm
[2013-09-20 22:44:14 -0400] dgarstang: yah
[2013-09-20 22:44:45 -0400] dgarstang: not in the help either, but then again, none of the options in knife.rb are there
[2013-09-20 22:45:40 -0400] jbz: hm
[2013-09-20 22:45:50 -0400] jbz: I have to admit I've not used knife upload
[2013-09-20 22:45:50 -0400] fak3r: does knife.rb need a FQDN for the chef-server URL, or can it be the server's IP?
[2013-09-20 22:46:58 -0400] fak3r: when I just have the IP I get: ERROR: Errno::EHOSTUNREACH: No route to host - connect(2)
[2013-09-20 22:48:30 -0400] dgarstang: jbz: works when I put chef_repo_path in knife.rb
[2013-09-20 22:48:45 -0400] jbz: dgarstang I have vague memories of a bug involving this...
[2013-09-20 22:48:50 -0400] dgarstang: ugh
[2013-09-20 22:49:31 -0400] jbz: oh hahaha
[2013-09-20 22:49:31 -0400] jbz: yes
[2013-09-20 22:49:35 -0400] jbz: I confirmed this bug: https://tickets.opscode.com/browse/CHEF-4499
[2013-09-20 22:50:04 -0400] dgarstang: well, since the cookbooks are all in their own repo, and only the roles, data bags etc are in the core repo, I think I can get away with a single setting in knife.rb
[2013-09-20 22:50:05 -0400] jbz: it seems that knife-upload specifically has issues.
[2013-09-20 22:52:42 -0400] redfive_: reading back, I thought he was about to go over the edge with his comment "I suspect most people in this channel do", but he managed to save it somehow.
[2013-09-20 22:57:59 -0400] joemiller: is there anything like minitest-handler-cookbook that instead looks for bats tests from included recipes runs them during the handlers stage?
[2013-09-20 23:05:48 -0400] gchristensen: bats?
[2013-09-20 23:06:06 -0400] joemiller: gchristensen: https://github.com/sstephenson/bats
