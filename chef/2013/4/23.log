[2013-04-23 00:22:50 -0400] k0rupted_: Have a question on foodcritic. I can't figure out why I am using "unnecessary string interpolation when not required" here: http://pastebin.com/eVH0ZSXP
[2013-04-23 00:23:05 -0400] k0rupted_: lines 2 and 5
[2013-04-23 00:23:39 -0400] jed_: [roleName]
[2013-04-23 00:25:40 -0400] jed_: so you made roleName, a string, and you're then immediately interpolating it by saying "#{roleName}", which gives you a string back
[2013-04-23 00:25:56 -0400] jed_: this is coming from somebody who's never written ruby beyond chef configs, so if I'm wrong, sorry
[2013-04-23 00:26:23 -0400] k0rupted_: trying now... thx, thought i'd need it inside the []'s but I'll give it a go
[2013-04-23 01:31:06 -0400] pwelch: anyone having issues using nginx cookbook 1.4.0 on ubuntu/runit? Having an issue on initial boot
[2013-04-23 02:31:59 -0400] a13x212: anyone run into issues using ruby_block?
[2013-04-23 03:10:14 -0400] a13x212: how do you debug ruby_block? -l debug doesn't give me any info on what's going on
[2013-04-23 03:14:14 -0400] bluekelp: a13x212: for bash scripting i touch files in /tmp or use something to write to syslog
[2013-04-23 03:14:33 -0400] bluekelp: a13x212: also shef/chef-shell might have more tools to help debugging
[2013-04-23 03:57:30 -0400] kallistec: Patch releases of Chef shipped/shipping: http://lists.opscode.com/sympa/arc/chef/2013-04/msg00265.html
[2013-04-23 03:57:59 -0400] idk_chef: hey guys..im trying to change the password of a user but it doesnt seem to be working...
[2013-04-23 03:58:02 -0400] idk_chef: user "user" do   action :modify   password "plaintextpassword" end
[2013-04-23 03:58:15 -0400] idk_chef: can i do that?
[2013-04-23 04:00:14 -0400] kallistec: idk_chef: generally you need to provide the shadow password
[2013-04-23 04:00:25 -0400] kallistec: a little bit of info here: http://docs.opscode.com/resource_user.html
[2013-04-23 04:02:13 -0400] idk_chef: yes i was looking at that...thanks ill try with the shadow password and see if that works
[2013-04-23 06:04:21 -0400] alvin_: hey peeps, i'm pretty new to chef (about 2-3 days into exploring chef-solo on windows)
[2013-04-23 06:04:22 -0400] alvin_: i've been trying to use
[2013-04-23 06:04:23 -0400] alvin_:     windows_package "software_name" do
[2013-04-23 06:04:25 -0400] alvin_:       source "local_installation_path"
[2013-04-23 06:04:26 -0400] alvin_:       action :install
[2013-04-23 06:04:28 -0400] alvin_:     end
[2013-04-23 06:04:29 -0400] alvin_: to install a windows program from a local installer
[2013-04-23 06:04:31 -0400] alvin_: problem:
[2013-04-23 06:04:32 -0400] alvin_: for some reason there is some connection refused, even though i'm working with a local file.
[2013-04-23 06:04:34 -0400] alvin_: error log (eventually times out):
[2013-04-23 06:04:35 -0400] alvin_:   * remote_file[C:/Users/Alvin/Documents/GitHub/dviz/Application/Setup/cache/jdk
[2013-04-23 06:04:37 -0400] alvin_: -7u21-windows-i586.exe] action create[0m[2013-04-22T23:02:25-07:00] ERROR: Conn
[2013-04-23 06:04:38 -0400] alvin_: ection refused connecting to : for /Users/Alvin/Documents/GitHub/dviz/Applicatio
[2013-04-23 06:04:40 -0400] alvin_: n/Setup/installers/jdk-7u21-windows-i586.exe/jdk-7u21-windows-i586.exe/C:/Users/
[2013-04-23 06:04:41 -0400] alvin_: Alvin/Documents/GitHub/dviz/Application/Setup/installers/jdk-7u21-windows-i586.e
[2013-04-23 06:04:42 -0400] alvin_: xe/jdk-7u21-windows-i586.exe, retry 1/5
[2013-04-23 06:04:43 -0400] alvin_: has anyone encountered the same issue? am i doing something wrong? thanks in advance!
[2013-04-23 06:21:14 -0400] adamr: pwelch: I ran into some issues in the past week. For me there was a variable name mis-match between 2 recipes (I installed the cookbook via opscode)
[2013-04-23 07:29:51 -0400] gad0lin: ohai, how can I put delay between two execute resources?
[2013-04-23 07:30:39 -0400] gad0lin: I am running 2 sql scripts one create db and next put data. Looks that the second is run before db is created
[2013-04-23 07:46:39 -0400] auxome: for the chef 11.x client on win...is there a silent install option? trying to programatically install it without the installshield gui experience
[2013-04-23 07:49:37 -0400] marcellu1: hasp-air: maybe check the knife-windows bootstrap script
[2013-04-23 07:50:06 -0400] marcellu1: https://github.com/opscode/knife-windows/blob/master/lib/chef/knife/bootstrap/windows-chef-client-msi.erb
[2013-04-23 07:50:48 -0400] marcellu1: my bad, the install is actually in the Chef context here:
[2013-04-23 07:50:55 -0400] marcellu1: https://github.com/opscode/knife-windows/blob/master/lib/chef/knife/core/windows_bootstrap_context.rb#L155
[2013-04-23 07:51:04 -0400] marcellu1: msiexec /qb /i "%LOCAL_DESTINATION_MSI_PATH%"'
[2013-04-23 08:58:56 -0400] adamr: when using Berkshelf to manage cookbooks, does one create self-written cookbooks using the 'berks cookbook' command? I find that when I use 'berks cookbook' , my newly created cookbooks/recipes are running out of order.
[2013-04-23 09:00:55 -0400] alisdair: if i have a 'notifies :create, ' in a git block with action :sync will it only notify the first time it syncs or every time?
[2013-04-23 09:17:30 -0400] pspringett: Can anyone help with a question about the nginx cookbook? I'm trying to update to the latest version (1.2.6), add the "http_stub_status_module" and recompile nginx. I have added the line include_recipe "nginx::http_stub_status_module" and also updated default['nginx']['source']['modules'] to include the stub_status module. My chef run does NOT recompile nginx and then fails on the restart as "stub_status" directive is missing (becau
[2013-04-23 09:18:13 -0400] pspringett: Does anyone know how to force the nginx::source recipe to recompile?
[2013-04-23 09:18:21 -0400] pspringett: Thanks in advance
[2013-04-23 09:20:22 -0400] pspringett: Also worth noting I have set default['nginx']['version'] = '1.2.6'
[2013-04-23 09:24:53 -0400] kechagia: remote_file seems to always use /tmp as a temporary directory, no matter what file_cache_path is set to. Is there a way to make it download to a different path? /tmp is not big enough to hold some of the files that I need temporarily. I worked around it using execute and wget, but foodcritic is judging me, so I'm looking for a "cleaner" approach.
[2013-04-23 09:26:43 -0400] kechagia: furthermore, foodcritic advices to use the new notification syntax [FC043], but now I have trouble using variables. "template[#{my_path}]" now rasies an "undefined method `notifies' " error.
[2013-04-23 09:31:56 -0400] siXy: kechagia: looking at the source, seems that file_cache_path is only used by cookbook_file not remote_file.  If you can't use a cookbook_file here, you could consider extending the remote_file class, I guess
[2013-04-23 09:35:13 -0400] kechagia: siXy: cookbook_file is inconvenient, as the files are pretty big (several gb)
[2013-04-23 09:35:43 -0400] kechagia: siXy: thanks. Do you happen to know in which file the remote_file class is defined?
[2013-04-23 09:36:05 -0400] siXy: chef-11.4.0/lib/chef/provider/remote_file.rb
[2013-04-23 09:38:14 -0400] kechagia: siXy: thx
[2013-04-23 09:43:10 -0400] marcellu1: kechagia: i did use "ENV['TMPDIR'] = "/some/path"" once
[2013-04-23 09:43:30 -0400] marcellu1: but there is no other way to override this
[2013-04-23 09:45:52 -0400] kechagia: marcellu1: interessting hint. Mmh, I was using wget with a custom path before, both approaches feel kinda workaroundy
[2013-04-23 09:55:37 -0400] zunkree: hi
[2013-04-23 09:55:46 -0400] zunkree: have some questions
[2013-04-23 09:56:14 -0400] MattJ: 42
[2013-04-23 09:56:45 -0400] zunkree: how can I build chef-server v11 from source, manual on official wiki only for chef-server v10
[2013-04-23 09:57:21 -0400] zunkree: I want write ebuild for gentoo
[2013-04-23 10:03:07 -0400] gad0lin: zunkree: have a look on chef server cookbook - https://github.com/opscode-cookbooks/chef-server/blob/master/recipes/dev.rb
[2013-04-23 10:05:14 -0400] gad0lin: zunkree: havent compiled it myself.  It gives initial clues...so probably someone might have better sugestion.
[2013-04-23 10:07:09 -0400] kernel_panik: Hi guys!
[2013-04-23 10:07:38 -0400] kernel_panik: I forgot how to set the version of chef when I install it w/ curl ttp://www.opscode.com/chef/install.sh...  do u remember?   thank you very much
[2013-04-23 10:09:06 -0400] zunkree: gad0lin: thanks a lot
[2013-04-23 10:12:18 -0400] s2r2: kernel_panik: is that possible at all?  I just found that when you want to get a specific version, http://www.opscode.com/chef/install/ offers you a .deb file (for apt'ish distributions)
[2013-04-23 10:12:30 -0400] kernel_panik: thanks
[2013-04-23 10:12:33 -0400] kernel_panik: but I think also curl -L http://www.opscode.com/chef/install.sh verion='10.24.0' | sudo bash
[2013-04-23 10:12:54 -0400] kernel_panik: I saw on the script that there is a parameter.. I try and I let u know
[2013-04-23 10:13:19 -0400] s2r2: k
[2013-04-23 10:15:01 -0400] s2r2: kernel_panik: install.sh takes a version parameter, "-v"; so two steps might get you there
[2013-04-23 10:15:51 -0400] s2r2: i.e. "curl -O -L http://.../install.sh && sudo bash install.sh -v $VERSION"
[2013-04-23 10:16:53 -0400] kernel_panik: yes works , thank you guys
[2013-04-23 10:33:34 -0400] Azrael: hey folks, can anyone tell me about their experiences using librarian-chef vs. berkshelf for cookbook management?
[2013-04-23 10:33:52 -0400] Azrael: i'm trying to determine an overall workflow with respect to my infrastructure repository
[2013-04-23 10:35:23 -0400] gad0lin: Azrael: berkshelf
[2013-04-23 10:36:23 -0400] gad0lin: Azrael: have a look: http://vialstudios.com/guide-authoring-cookbooks.html
[2013-04-23 10:36:32 -0400] Azrael: thanks gad0lin
[2013-04-23 10:37:35 -0400] Azrael: gad0lin: i have a concern
[2013-04-23 10:37:45 -0400] Azrael: with chef, i am managing multiple environments
[2013-04-23 10:37:54 -0400] Azrael: each environment corresponds to different clusters of systems
[2013-04-23 10:38:07 -0400] Azrael: with those environments we set constraints for cookbooks
[2013-04-23 10:38:32 -0400] Azrael: saying this environment (cluster) is officially released on cookbook X version Y, cookbook A version B, etc
[2013-04-23 10:38:43 -0400] Azrael: if i use berkshelf within my infrastructure repository
[2013-04-23 10:38:45 -0400] alexbst: you keep the environments in git I trust ?
[2013-04-23 10:38:48 -0400] Azrael: yes
[2013-04-23 10:38:53 -0400] Azrael: environments/*.json
[2013-04-23 10:38:59 -0400] Azrael: if i use berkshelf
[2013-04-23 10:39:23 -0400] Azrael: how/can i specify the versions (and repo locations) of each cookbook, for each environment
[2013-04-23 10:39:36 -0400] Azrael: is it as simple as just using a berksfile per environment?
[2013-04-23 10:40:31 -0400] gad0lin: Azrael: you are worried about cookbook versions lokcs? like each prod is using cookbook version 1.0, staging 1.1 and dev whatever from master
[2013-04-23 10:41:19 -0400] Azrael: yep
[2013-04-23 10:41:25 -0400] Azrael: ahh perhaps berkshelf "groups" ?
[2013-04-23 10:42:39 -0400] alexbst: it's not so much workflow as part of the job
[2013-04-23 10:43:02 -0400] Azrael: ahh well, i'm not lookign to have berkshelf automagically do the version locks etc for me
[2013-04-23 10:43:32 -0400] alexbst: fwiw Azrael - if you are in an env where it is more than just you managing the envs, I recommend knife spork for tracking changes
[2013-04-23 10:44:05 -0400] alexbst: you can publish your actions to hipchat or irc or whatever, for logging purposes
[2013-04-23 10:44:20 -0400] alexbst: one of my biggest complaints about the chef api is the lack of change tracking
[2013-04-23 10:44:41 -0400] alexbst: you can also use spork to publish cookbook promotion work
[2013-04-23 10:45:54 -0400] Azrael: interesting
[2013-04-23 10:45:57 -0400] Azrael: thanks alexbst
[2013-04-23 10:49:15 -0400] moco: hello chefs
[2013-04-23 10:49:29 -0400] alexbst: oui chef!
[2013-04-23 10:50:11 -0400] moco: total beginer here, managed to set up chef server (community) but stuck on next steps
[2013-04-23 10:55:59 -0400] moco: anyone out there?
[2013-04-23 12:07:27 -0400] gudmundur: are there any guides for creating sub-resources? I need to template a rather nasty tomcat config file.
[2013-04-23 12:09:52 -0400] jdar: so, I'm getting an error about 'cookbook ulimit not found' but it's definitely a submodule in the parent repo, and in redisio/metadata.rb and include_recipe is called in a redisio/recipe/foo.rb.
[2013-04-23 12:09:55 -0400] jdar: I'm pretty new so I'm wondering what I've biffed.
[2013-04-23 12:14:47 -0400] jdar: ah. It's not updating. (on opsworks)
[2013-04-23 12:21:51 -0400] gyre007: guys IM banging my head against a table trying to figure out why ONLY rabbit1 is added to the hosts file in this recipe https://gist.github.com/milosgajdos83/5443123
[2013-04-23 12:22:04 -0400] gyre007: when in fact BOTH rabbit1 and rabbit2 should be included...
[2013-04-23 12:22:12 -0400] gyre007: for some reason rabbit2 never gets appended...
[2013-04-23 12:22:14 -0400] gyre007: mmm
[2013-04-23 12:31:00 -0400] gyre007: ok sorted
[2013-04-23 12:31:35 -0400] ivey: Azrael: you still need a command and control tool to lock environments
[2013-04-23 12:32:17 -0400] ivey: but this https://github.com/RiotGames/berkshelf/pull/473 may be interesting for you
[2013-04-23 12:36:08 -0400] gyre007: I need to say latest rabbit cookbook is a bit of a disaster...
[2013-04-23 12:36:10 -0400] gyre007: arrgh
[2013-04-23 12:36:23 -0400] gyre007: maybe its Chef...but its trying to START the service which is ALREADY running
[2013-04-23 12:36:29 -0400] gyre007: it shouldnt do that afaik
[2013-04-23 12:36:34 -0400] gyre007: wheres the idempotency
[2013-04-23 12:36:59 -0400] gyre007: https://gist.github.com/milosgajdos83/5443217
[2013-04-23 12:37:32 -0400] gyre007: https://github.com/opscode-cookbooks/rabbitmq/blob/master/recipes/default.rb#L87
[2013-04-23 12:37:56 -0400] gyre007: this is starting rabbitmq server EVEN THOUGH its already ruuning and its causing chef convergence to fail...
[2013-04-23 12:40:08 -0400] jpluscplusm: what does the status command give you when run on the node?
[2013-04-23 12:41:46 -0400] gyre007: yeah i did that...it comes up as node down..mmm thats the reason why chef is starting the service...
[2013-04-23 12:42:00 -0400] gyre007: must be something dodgy with rabbit cookbook then...mmm
[2013-04-23 12:43:17 -0400] gyre007: but this seems to be happening only when you're trying to set up rabbit cluster...if you do standalone node all works finw
[2013-04-23 12:48:47 -0400] gyre007: is this some kind of new mode in Chef ? :) mode 00644
[2013-04-23 12:48:56 -0400] gyre007: https://github.com/opscode-cookbooks/rabbitmq/blob/master/recipes/default.rb#L123
[2013-04-23 12:48:57 -0400] gyre007: mm
[2013-04-23 13:04:57 -0400] Azrael: ivey: interesting.  thanks.
[2013-04-23 13:05:03 -0400] Azrael: ivey: that isn't merged yet right?
[2013-04-23 13:17:43 -0400] zaargy: any way to make knife search return json? (a plugin maybe?)
[2013-04-23 13:18:50 -0400] zaargy: i can just use -a for now but this would let do more filtering..
[2013-04-23 13:39:11 -0400] adamr: tips on how to install the ruby-shadow gem in Chef? to install it, you need 'make' (in build-essential) but all 'chef_gem' statements run before 'include_recipe' statements (chicken/egg problem)
[2013-04-23 13:41:01 -0400] s2r2: that's what the compiletime node attribute of build-essential is for, isn't it?  just stumbled upon that today
[2013-04-23 13:41:07 -0400] cwj: yes ^^
[2013-04-23 13:48:00 -0400] adamr: hmm, I have compiletime = true in my build-essentials attributes file, but I still get the 'make not found' (from build-essential not being installed yet).  Even adding a puts statement directly in the build-essential recipe, doesn't give me any output before the chef run tries to install the gem
[2013-04-23 13:52:11 -0400] benadderson: Hi
[2013-04-23 13:52:36 -0400] benadderson: I'm hoping somebody can help me with a problem I'm having with knife
[2013-04-23 13:52:39 -0400] benadderson: (on windows)
[2013-04-23 13:53:05 -0400] benadderson: I've run through knife configure, and copied the relevant keys into my .chef folder
[2013-04-23 13:53:14 -0400] cwj: adamr: you might be missing a package that provides header files
[2013-04-23 13:53:26 -0400] benadderson: but then when I run "knife client list" to check it works I get the following error:
[2013-04-23 13:53:28 -0400] cwj: e.g. -libfoodev packages on ubuntu
[2013-04-23 13:53:33 -0400] cwj: er libfoo-dev
[2013-04-23 13:53:37 -0400] benadderson: ERROR: JSON::ParserError: Top level JSON object must be a Hash or Array. (actual : NilClass)
[2013-04-23 13:54:06 -0400] cwj: benadderson: what version of chef are you using
[2013-04-23 13:54:09 -0400] Azrael: ivey: you use berkshelf within your infrastructure chef-repo too, correct?
[2013-04-23 13:54:39 -0400] benadderson: cwj: knife --version returns 11.4.2
[2013-04-23 13:54:56 -0400] adamr: cwj:  do you mean a package that is meant to be installed by chef? or a package that would be a default on the OS image i'm using?
[2013-04-23 13:56:14 -0400] cwj: adamr: i mean you probably need to install such a package as provided by your OS distribution
[2013-04-23 13:56:48 -0400] cwj: i.e. if you are on ubuntu you are probably missing libruby1.9.1-dev or whatever version lines up with your installed ruby interpreter
[2013-04-23 13:57:51 -0400] cwj: benadderson: the error you're describing sounds reminiscent of some recent chef/json gem incompatibility. the fix for which i would have expect to be in 11.4.2
[2013-04-23 13:58:40 -0400] cwj: benadderson: did you install via the chef full installer msi?
[2013-04-23 13:58:52 -0400] benadderson: cwj: I did, yes
[2013-04-23 13:59:10 -0400] geekbri: Can you use chef search from inside an attributes file?
[2013-04-23 13:59:23 -0400] benadderson: cwj: Should I be checking the versions of gem & json that it installed then?
[2013-04-23 14:01:37 -0400] cwj: benadderson: if you have installed via the full installer msi, then i doubt it is the same problem i have suggested
[2013-04-23 14:01:45 -0400] adamr: cwj: I see. To continue clarifying... I would need to check the OS on the chef-node, before a chef run occurs, right? Since that is the box that actually goes through the cookbooks and checks the compiletime attribute. Seems like I'll have to generate my own OS image. Is there a source you know of that I can refer to for the package dependencies?
[2013-04-23 14:02:31 -0400] benadderson: cwj: Right. Any thoughts on how I should proceed then? I'm a bit stumped :(
[2013-04-23 14:04:11 -0400] cwj: benadderson: can you gist/pastebin a full stacktrace?
[2013-04-23 14:05:18 -0400] |rt|: has anyone tried to reload ohai in a lwrp?  It appears as if the new node data isn't available to the lwrp when I tried this....had to move my ohai reload back into the recipe and manually call it before calling my lwrp...which makes my lwrp a little less self contained
[2013-04-23 14:05:25 -0400] benadderson: cwj: the error I posted earlier is the only output I get from the command line. Is there a log file somewhere that will have the stack trace in?
[2013-04-23 14:05:26 -0400] cwj: adamr: you could put the package installation into OS-specific bootstrap scripts to be used with knife, or you can use the install-at-compile time trick, similar to what chef_gem and the compiletime mode of build-essentials cookbook are doing
[2013-04-23 14:05:46 -0400] cwj: benadderson: oh i was hoping it would tell us where in the knife code the error was occuring
[2013-04-23 14:06:33 -0400] adamr: cwj: thanks for the tips. I have to do some reading to familiarize myself with those approaches.
[2013-04-23 14:07:31 -0400] cwj: adamr: this page might be relevant to your interests http://docs.opscode.com/resource_common_compile.html
[2013-04-23 14:08:57 -0400] adamr: cwj: great, thanks a lot.
[2013-04-23 14:09:35 -0400] cwj: np
[2013-04-23 14:15:53 -0400] benadderson: cwj: OK, a little more info. I ran the knife command with the verbosity on, and got the following output. Looks like the server is erroring when it tries to authenticate my user account? http://pastebin.com/7978iRQ6
[2013-04-23 14:19:25 -0400] cwj: if you werent being authed i'd expect to see a 401
[2013-04-23 14:19:39 -0400] cwj: the 500 internal server error response makes me think there is a problem in your chef-server
[2013-04-23 14:20:57 -0400] benadderson: cwj: I could definitely believe that
[2013-04-23 14:21:41 -0400] benadderson: cwj: I'm running the server in a VM (Ubuntu 12.10), and I had to mess around with chef-server.rb in order to have the webui be accessible from outside the VM
[2013-04-23 14:22:34 -0400] benadderson: cwj: specifically I modified chef_server_webui['listen'] and chef_server_webui['url']
[2013-04-23 14:23:25 -0400] cwj: ok, your knife.rb should be specifying the url to your chef-server, did you give it the webui port in that url?
[2013-04-23 14:23:44 -0400] cwj: because the webui is separate from the api that knife wants to talk to
[2013-04-23 14:24:15 -0400] magoo: is there a config param that fixes the 11.4 client timing out after 15 mins?
[2013-04-23 14:24:16 -0400] benadderson: cwj: ahh, yes I did include the webui port
[2013-04-23 14:25:59 -0400] benadderson: cwj: should I specify a different port for the url in knife.rb then, or omit the port altogether?
[2013-04-23 14:26:49 -0400] cwj: benadderson: off the top of my head i dont remember what the default api port is, been using hosted chef too long :)
[2013-04-23 14:26:57 -0400] cwj: sudo lsof | grep LISTEN
[2013-04-23 14:27:09 -0400] cwj: er sudo netstat -lnap | grep LISTEN
[2013-04-23 14:27:14 -0400] cwj: something like that
[2013-04-23 14:27:19 -0400] cwj: in your chef-server VM
[2013-04-23 14:27:25 -0400] magoo: -ntlp
[2013-04-23 14:27:35 -0400] ivey: Azrael: Sorry had to leave home. On my phone
[2013-04-23 14:27:39 -0400] magoo: both probably work
[2013-04-23 14:27:59 -0400] ivey: And no, we don't have cookbooks in chef-repo at all. Each one has its own build job
[2013-04-23 14:29:02 -0400] benadderson: which process am I looking for?
[2013-04-23 14:33:47 -0400] Azrael: jtimberman: hi, are you around?  i had some questions regarding the nginx cookbook
[2013-04-23 14:34:28 -0400] programm1: Azrael: it's possible others may be able to answer. what are your questions?
[2013-04-23 14:35:42 -0400] Azrael: well, i'd like to use the nginx cookbook from within my own cookbook.  i'd like to create a site, other than the default site, which listens on a port that isn't the default (80)
[2013-04-23 14:36:21 -0400] Azrael: is that possible from whats provided in the nginx cookbook?
[2013-04-23 14:36:27 -0400] programmerq: that sounds similar to what we do with the nginx cookbook
[2013-04-23 14:36:47 -0400] programmerq: we use the nginx cookbook to install nginx itself
[2013-04-23 14:37:30 -0400] Azrael: right
[2013-04-23 14:37:40 -0400] programmerq: we set the ['nginx']['default_site_enabled'] attribute to false
[2013-04-23 14:37:40 -0400] Azrael: and then you create your own nginx site file?
[2013-04-23 14:37:47 -0400] Azrael: and then nginx_site :enable ?
[2013-04-23 14:37:49 -0400] programmerq: and then you template out your own site file
[2013-04-23 14:37:53 -0400] programmerq: exactly
[2013-04-23 14:37:55 -0400] Azrael: ok
[2013-04-23 14:37:56 -0400] Azrael: cool
[2013-04-23 14:37:59 -0400] Azrael: thank you programmerq
[2013-04-23 14:38:01 -0400] behemphi: Hi Azrael
[2013-04-23 14:38:01 -0400] behemphi: https://gist.github.com/behemphi/5421091
[2013-04-23 14:38:09 -0400] behemphi: that is my wrapper cookbook for nginx
[2013-04-23 14:38:15 -0400] behemphi: using the community cookoboo
[2013-04-23 14:39:20 -0400] Azrael: link '/etc/nginx/sites-enabled/undefined_reqs' do
[2013-04-23 14:39:21 -0400] Azrael: ahh
[2013-04-23 14:39:27 -0400] Azrael: but you do the linking manually
[2013-04-23 14:39:29 -0400] Azrael: but thats ok
[2013-04-23 15:03:03 -0400] magoo: i'm trying to figure out why ip address values are broken inside my vagrant environment. I'm using the latest vagrant-ohai and my cookbooks are up-to-date. 11.x server and 11.4 client but I still get these kind of values for IP address ["08:00:27:DA:34:7D", {"family"=>"lladdr"}]
[2013-04-23 15:23:27 -0400] alex_: someone who knows why ohai cannot define a fqdn?
[2013-04-23 15:23:58 -0400] alex_: its searching for it in the etc/hosts file right?
[2013-04-23 15:25:14 -0400] adnichols: alex_: I believe it uses the output of 'hostname -f'
[2013-04-23 15:25:46 -0400] alex_: returns nothing on my solaris zone
[2013-04-23 15:26:12 -0400] alex_: even not on working machines
[2013-04-23 15:26:27 -0400] techminer1: can you pass a parameter in a notifies?  (e.g. notifies :run, 'execute[my_exec_block]', SOME_PARAMETER)
[2013-04-23 15:27:37 -0400] techminer1: The block calling the notifies is inside a loop.and I need to sent a loop variable through to the execute block.
[2013-04-23 15:29:21 -0400] masterkorp: i hate how knife github cookbooks always merges into master branch
[2013-04-23 15:36:44 -0400] makerbreakr: why would i not be seeing a recipe in a cookbook on the chef server web interface?
[2013-04-23 15:39:55 -0400] awgross: techminer1: if it is in a loop, you should be changing the name of the execute block `execute[my_exec_block_#{loop_var}]`
[2013-04-23 15:40:26 -0400] awgross: techminer1: beyond that there isn't a ton of information you can easily set
[2013-04-23 15:41:20 -0400] techminer1: okended up I didn't need it after all, but that's good to know....
[2013-04-23 15:53:09 -0400] dfrey: i'm trying to install nginx, but at the same time run a custom template for the nginx.conf file. it seems like modifying the cookbook directly would be easiest, but for maintainability it seems as though it would be better to separate it out. is there a standard chef way to do this?
[2013-04-23 15:55:06 -0400] dfrey: currently i'm running my own template resource after the fact, so that the nginx.conf file ends up being written twice, which does (rarely) confuse the attributes between runs
[2013-04-23 15:56:11 -0400] pwelch: dfrey: there is a way to call the #resource method in a recipe and have it point to your template
[2013-04-23 15:56:12 -0400] pwelch: http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/
[2013-04-23 15:56:20 -0400] pwelch: jtimberman uses it in that blog post
[2013-04-23 15:56:25 -0400] awgross: dfrey: why dont you write your site specific nginx conf to sites-enabled?
[2013-04-23 15:56:37 -0400] pwelch: or you could do as awgross mentioned
[2013-04-23 15:57:19 -0400] techminer1: Anyone have a minute to look at my code?  http://pastie.org/7703566  I'm getting a "can't add a new key into hash during iteration" error on line 23 and nto sure what I'm doing wrong.
[2013-04-23 15:58:46 -0400] dfrey: awgross: its not just site specific, it should apply to all sites running on the machine.
[2013-04-23 15:59:03 -0400] dfrey: pwelch: i'll give it a look
[2013-04-23 15:59:54 -0400] richleland: hi gang - I want to rename my chef server node in the node list
[2013-04-23 16:00:06 -0400] richleland: I know how to do this for any other node
[2013-04-23 16:00:07 -0400] jordane: techminer1: you should access the node attributes as "node['key']", not "node.default['key']"
[2013-04-23 16:00:16 -0400] richleland: are there any issues w/renaming the chef server node?
[2013-04-23 16:00:20 -0400] richleland: that I should be aware of/
[2013-04-23 16:00:21 -0400] richleland: ?
[2013-04-23 16:02:56 -0400] awgross: dfrey: gotcha
[2013-04-23 16:04:53 -0400] techminer1: jordane:  tried that.got "undefined method include? for nil:NilClass"
[2013-04-23 16:05:20 -0400] jordane: techminer1: then the dict doesn't exist.
[2013-04-23 16:05:33 -0400] techminer1: hmmm
[2013-04-23 16:05:38 -0400] jordane: techminer1:  i.e node['key']...['installed'] should at least be {}
[2013-04-23 16:05:41 -0400] jordane: but is currently nil
[2013-04-23 16:06:34 -0400] jordane: i'd set default['zimbra']['zimlets']['installed'] = {} in your attributes
[2013-04-23 16:07:45 -0400] techminer1: jordane:  I don't know what's installed on a node until I run the ruby_block.
[2013-04-23 16:08:10 -0400] techminer1: Oh set it to empty in attributes.gotcha let me try that
[2013-04-23 16:10:15 -0400] techminer1: jordane:  now I get "Invalid only_if/not_if command: true (TrueClass)" on that same line.bleh
[2013-04-23 16:11:30 -0400] techminer1: can you do .include? on an empty Hash?  Is that my problem?
[2013-04-23 16:11:38 -0400] jordane: techminer1: you should use not_if instead of only_if !
[2013-04-23 16:11:45 -0400] jordane: you can do .include? on an empty hash
[2013-04-23 16:11:51 -0400] techminer1: oh.duh!
[2013-04-23 16:13:09 -0400] bakins: what's the site someone did that generates chef for managing workstations? I seem to remember it having a catchy name that I obviously didn't stick...
[2013-04-23 16:16:30 -0400] techminer1: jordane:  awesome.thanks!
[2013-04-23 16:17:14 -0400] dfrey: pwelch: but how can i affect a resource after it has been run? if i run #resource before the run the resource hasn't been created yet, while after it has already run.
[2013-04-23 16:17:42 -0400] jordane: techminer1: np
[2013-04-23 16:30:40 -0400] directionless: Is there a way to use the chef git resource and *not* end up with a local deploy branch?
[2013-04-23 16:57:05 -0400] techminer1: how do you send a notifies to a ruby_block?  :run doesn't seem to be doing it,,,,
[2013-04-23 16:58:18 -0400] techminer1: or should i use "subscribes" in the ruby_block to subscribe to the execute block I am trying to notify from?
[2013-04-23 17:06:09 -0400] pwelch: dfrey: sorry, I stepped out for lunch. What was the question?
[2013-04-23 17:07:38 -0400] mshilling: can anyone help take a stab at this.  in a recipe I need to determine if a hostname is odd or even, and if so, mount a certain nfs filesystem.  Anyone got any ruby for odd/even comparison?
[2013-04-23 17:07:46 -0400] yfeldblum: techminer1, the :create action
[2013-04-23 17:08:15 -0400] nlloyds: mshilling: 1.even? 2.odd?
[2013-04-23 17:08:17 -0400] mshilling: hostname would be something like xxxx01xxxx or xxxx02xxxx
[2013-04-23 17:08:33 -0400] mshilling: is it really that simple?
[2013-04-23 17:08:34 -0400] geekbri: you will probably need to use scan to get the numbers out of it
[2013-04-23 17:08:53 -0400] geekbri: http://rubular.com/ is helpful for that
[2013-04-23 17:09:19 -0400] nlloyds: "xxxx01xxxx".scan(/\d+/).first.to_i.even?
[2013-04-23 17:09:41 -0400] techminer1: yfieldblum:  OK thanks.I went with the subscribes from the ruby_block and that works too
[2013-04-23 17:09:49 -0400] nlloyds: (scan the string for digits, get the first match, convert it to integer, is it even?
[2013-04-23 17:09:51 -0400] nlloyds: )
[2013-04-23 17:10:57 -0400] mshilling: interesting.  I'll try some variations of that.  now that I think of it, there could be other numbers in the hostname (rididulous, I realize)
[2013-04-23 17:11:32 -0400] techminer1: next problem.I'm getting multiple instances of the same execute block in a single chef run and not sure why.see the pastie  http://pastie.org/7703927
[2013-04-23 17:12:23 -0400] techminer1: execute[get_installed_zimlets] and the ruby_block[read_installed_zimlets] both happen twice for some reason
[2013-04-23 17:15:01 -0400] yfeldblum: techminer1, in any event, that's not actually going to run in the order you want
[2013-04-23 17:15:13 -0400] yfeldblum: techminer1, in fact, you should implement it differently
[2013-04-23 17:15:15 -0400] jordane: techminer1: if yu're using notifies/subscribes, you should set action :nothing so it doesn't run immediately
[2013-04-23 17:15:30 -0400] jordane: or rather, not immediately, but upon the definition
[2013-04-23 17:17:32 -0400] yfeldblum: techminer1, also why isn't chef running as root?
[2013-04-23 17:17:48 -0400] yfeldblum: techminer1, ah nvm
[2013-04-23 17:17:49 -0400] techminer1: it is running as root
[2013-04-23 17:18:07 -0400] techminer1: has to sudo to the correct user to run some commands
[2013-04-23 17:19:03 -0400] yfeldblum: techminer1, you could make a LWRP for this; that's probably the ideal approach
[2013-04-23 17:19:28 -0400] techminer1: that would be new for me   :)
[2013-04-23 17:21:04 -0400] gleam: you can also pass user "zimbra" to the execute resource
[2013-04-23 17:21:06 -0400] gleam: instead of using sudo
[2013-04-23 17:21:32 -0400] techminer1: gleam:  oh right
[2013-04-23 17:22:45 -0400] alisdair: can i have a recipe that is only lwrp's?
[2013-04-23 17:22:57 -0400] gleam: sure
[2013-04-23 17:23:14 -0400] gleam: or a cookbook rather
[2013-04-23 17:23:19 -0400] alisdair: do i need a default.rb in recipes?
[2013-04-23 17:23:22 -0400] techminer1: yfieldblum.so put some stuff in /resources that does the actions I need?
[2013-04-23 17:23:36 -0400] alisdair: or just metadata.rb, /providers/default.rb and resources/default.rb?
[2013-04-23 17:23:56 -0400] gleam: you don't need a recipe, no
[2013-04-23 17:24:02 -0400] alisdair: thanks
[2013-04-23 17:24:11 -0400] gleam: here's an example one:
[2013-04-23 17:24:12 -0400] gleam: https://github.com/customink-webops/hostsfile
[2013-04-23 17:26:57 -0400] alisdair: gleam: if my lwrp has a dependency on another cookbook where would i include_recipe it?
[2013-04-23 17:27:18 -0400] alisdair: recipes/default.rb with a content of just 'include_recipe "foo"'?
[2013-04-23 17:32:15 -0400] yfeldblum: techminer1, something like: http://pastie.org/pastes/7704021/text?key=0fam2eldwxrovk8fqstngw
[2013-04-23 17:33:15 -0400] yfeldblum: techminer1, if your cookbook is named "zimlet" then you could put them in resources/default.rb and providers/default.rb
[2013-04-23 17:33:49 -0400] yfeldblum: techminer1, if your cookbook is named something else (like it's a bigger overall cookbook) then you could put them in resources/zimlet.rb and providers/zimlet.rb
[2013-04-23 17:35:09 -0400] ranjibd: yfeldblum, u'll be at #chefconf?
[2013-04-23 17:35:17 -0400] yfeldblum: ranjibd, sadly, no
[2013-04-23 17:36:05 -0400] |rt|: I'm sitting here waiting for my ride to take me to the airport for chefconf....can't wait.
[2013-04-23 17:36:14 -0400] yfeldblum: techminer1, i haven't tried out that code at all, but that's the general form of it; let me know if it's helpful
[2013-04-23 17:36:35 -0400] yfeldblum: techminer1, or if you've got any questions about it
[2013-04-23 17:36:38 -0400] cjerdonek: what's the recommended way to include code in a chef repo to be shared across multiple cookbooks?
[2013-04-23 17:37:13 -0400] ivey: Azrael: back at my desk if you still have berkshelf questions
[2013-04-23 17:37:18 -0400] yfeldblum: cjerdonek, put it in a library in one cookbook, and have all the other cookbooks declare a dependency on the one with the library file
[2013-04-23 17:37:54 -0400] cjerdonek: yfeldblum: great, thanks
[2013-04-23 17:42:08 -0400] philsturgeon: I've just started getting FATAL: NoMethodError: undefined method `unpack' for #<Hash:0x000000020216e0>
[2013-04-23 17:43:15 -0400] techminer1: yfieldblum:  Thanks!
[2013-04-23 17:43:53 -0400] philsturgeon: backtrace http://pastie.org/7704072
[2013-04-23 17:44:53 -0400] techminer1: should that be "action_create" in the provider.to match the action in the resource?
[2013-04-23 17:46:47 -0400] miah: yes
[2013-04-23 17:47:09 -0400] xmltok: does anyone know of a good cookbook helper function that would allow you to replace lines in a configuration file and enabling them if they are commented out with a #? Basically its a long file with VAR=digit or # VAR=digit, and i'd like to be able to just func("VAR", "digit") on it
[2013-04-23 17:47:18 -0400] xmltok: basically avoiding templating out the huge thing
[2013-04-23 17:49:23 -0400] philsturgeon: nobody have a clue about that backtrace? http://pastie.org/7704072
[2013-04-23 17:49:33 -0400] philsturgeon: just started happening after I edited a data bag
[2013-04-23 17:49:50 -0400] philsturgeon: jtimberman: sorry to bug, do you know what I've done to break things?
[2013-04-23 17:49:57 -0400] jstallard: xmltok: http://michaelschmook.wordpress.com/2012/09/27/chef-how-to-insert-or-append-a-line-to-a-file/ and http://rubydoc.info/gems/chef/Chef/Util/FileEdit
[2013-04-23 17:50:03 -0400] philsturgeon: backtrace related to data bags, after editing a data bag
[2013-04-23 17:50:08 -0400] philsturgeon: but the file looks like valid json
[2013-04-23 17:51:41 -0400] xmltok: jstsallard: yeah that is pretty much what i want to do, but with something a little cleaner. i'll just write a library def to take in some parameters and iterate over the changes into the file.
[2013-04-23 17:53:00 -0400] xmltok: https://github.com/someara/line-cookbook this looks like the stuff
[2013-04-23 17:54:00 -0400] yfeldblum: techminer `action :create do ...` just makes a method named `action_create`
[2013-04-23 17:54:16 -0400] yfeldblum: techminer1, oh sorry wrong question
[2013-04-23 17:54:33 -0400] yfeldblum: techminer1, i would use `action :install ; default_action :install` in the resource
[2013-04-23 17:54:51 -0400] yfeldblum: techminer1, because you're installing a zimbra package rather than creating one
[2013-04-23 17:55:00 -0400] philsturgeon: HI IM GOING TO START TALKING IN ALL CAPS FOR A WHILE
[2013-04-23 17:55:27 -0400] philsturgeon: this, is bizarre http://pastie.org/7704072
[2013-04-23 17:55:58 -0400] yfeldblum: philsturgeon, you edited an encrypted-data-bag-item improperly, and now it can't be decrypted?
[2013-04-23 17:56:52 -0400] yfeldblum: philsturgeon, or perhaps you're running a newer version of chef on your workstation than on your server being configured, and the newer version of chef on the workstation saved the encrypted data-bag item in the newer format which is incompatible with the older format?
[2013-04-23 17:58:39 -0400] philsturgeon: yfeldblum: ahh yes vagrant has 11.4.0 and my local computer is rocking 10.12
[2013-04-23 17:59:41 -0400] alisdair: is there a way to override the name of a cookbook and not just use the name of the folder it lives in?
[2013-04-23 17:59:49 -0400] yfeldblum: philsturgeon, i'd have thought it's the other way around, since chef-11 is compatible with both chef-11 and chef-10 versions of encrypted-data-bag-item
[2013-04-23 18:00:10 -0400] yfeldblum: alisdair, why would you do that?
[2013-04-23 18:00:28 -0400] yfeldblum: alisdair, you can specify the name in the metadata.rb, but you should make them consistent for your own sanity
[2013-04-23 18:00:39 -0400] alisdair: i have a project called 'foo' and i would like to write a cookbook for it but i can't have two github repos called 'foo'
[2013-04-23 18:01:00 -0400] philsturgeon: yfeldblum: I ran the data bag edit form my mac, then ran vagrant provision, which is running 10.x on the server
[2013-04-23 18:01:10 -0400] philsturgeon: yfeldblum: oh yes sorry I wrote it the wrong way around
[2013-04-23 18:01:19 -0400] yfeldblum: philsturgeon, :D
[2013-04-23 18:01:24 -0400] alisdair: i'd like to call the cookbook 'chef-foo' but have it included/used as 'foo' in recipes
[2013-04-23 18:02:28 -0400] yfeldblum: alisdair, what?
[2013-04-23 18:02:47 -0400] yfeldblum: alisdair, why not have it called "foo"? - if you're talking about what the *git repository* is named, it can certainly be named "chef-foo"
[2013-04-23 18:03:21 -0400] yfeldblum: alisdair, `git repository == cookbook` #=> false; `git_repository.include?(cookbook)` #=> true
[2013-04-23 18:03:52 -0400] ivey: philsturgeon: once you edit an encrypted data bag w/ chef 11 the format changes
[2013-04-23 18:04:00 -0400] ivey: you'll need to get the decrypted data
[2013-04-23 18:04:10 -0400] ivey: then edit w/ chef 10 and put it back in
[2013-04-23 18:04:35 -0400] philsturgeon: ivanoats: thats. im trying to upgrade everything now
[2013-04-23 18:04:43 -0400] alisdair: i guess that's what i'm asking. if i clone a cookbook to a folder 'bar' chef seems to think that's the cookbook name
[2013-04-23 18:04:50 -0400] philsturgeon: not sure how to update chef on my vagrant bo
[2013-04-23 18:05:06 -0400] alisdair: how can i override that to ensure chef thinks the cookbook name/namespace is 'foo' instead?
[2013-04-23 18:05:35 -0400] alisdair: philsturgeon: you can have two provision runs, in the first one update chef, then running the second will use the new chef
[2013-04-23 18:06:53 -0400] yfeldblum: philsturgeon, get a new vagrant base box
[2013-04-23 18:08:40 -0400] philsturgeon: yfeldblum: but I like my base box, it's shiny and loyal.
[2013-04-23 18:08:56 -0400] philsturgeon: http://stackoverflow.com/questions/11325479/how-to-control-the-version-of-chef-that-vagrant-uses-to-provision-vms
[2013-04-23 18:09:00 -0400] gzc: play with veewee and generate up-to-date ones constantly :)
[2013-04-23 18:09:01 -0400] philsturgeon: this seems to be working so far
[2013-04-23 18:09:11 -0400] philsturgeon: gzc: yeah VeeWee is installing now, looks like a good solution
[2013-04-23 18:09:21 -0400] philsturgeon: i dont mind f**king around with my base box but I dont want to make everyone else do it
[2013-04-23 18:09:32 -0400] gzc: veewee is awesome, you just may have to play with your definitions a bit
[2013-04-23 18:09:46 -0400] |rt|: bento is also worth taking a look at if you need to be building base boxes in an automated fashion
[2013-04-23 18:10:39 -0400] gzc: last time i tried building from the included definitions i had problems, but i'm sure they've been fixed by now
[2013-04-23 18:11:00 -0400] gzc: but it's kind of nuts to just build base windows and linux boxes programmatically
[2013-04-23 18:11:07 -0400] gzc: nuts in the 'holy crap it's the future' sense
[2013-04-23 18:14:43 -0400] |rt|: I'm taking the cookbook authoring workshop tomorrow at ChefConf and they are going to be covering bento, vagrant, and berkshelf
[2013-04-23 18:14:57 -0400] |rt|: looking forward to learning more about berkshelf
[2013-04-23 18:20:17 -0400] gzc: berkshelf is great and really only takes a couple of minutes to get acquainted with
[2013-04-23 18:20:22 -0400] gzc: think of it as bundler for cookbooks
[2013-04-23 18:21:15 -0400] gzc: cwj: oh hey cameron, speakin' of chefconf
[2013-04-23 18:22:48 -0400] aneto: Is there a way to list items in a databag from a recipe? Sort of like Chef::DataBag.list.key? But for the item
[2013-04-23 18:25:08 -0400] gyre007: why insert_line_if_no_match only allows you to insert one line...even if you have multiple insert_line_if_no_match statements one after another it will only write only first one to the file...
[2013-04-23 18:25:10 -0400] gyre007: mmm
[2013-04-23 18:27:25 -0400] gzc: aneto: yes, see http://docs.opscode.com/essentials_data_bags_use_search.html
[2013-04-23 18:27:50 -0400] sfalcon: aneto: You can obtain the items in a data bag from the API like this: api.get("data/toys").keys
[2013-04-23 18:27:53 -0400] gzc: it's as easy as data_bag('your_dbag').each { |item| item }
[2013-04-23 18:27:56 -0400] sfalcon: (that's using chef-shell)
[2013-04-23 18:28:18 -0400] gzc: oh yeah my example was from a recipe, not api
[2013-04-23 18:35:37 -0400] aneto: thanks gzc and sfalcon
[2013-04-23 18:35:41 -0400] damian_: did a new version of the windows client get pushed today?
[2013-04-23 18:36:12 -0400] damian_: because all of a sudden i cant build windows hosts, the freak out on the powershell LWRP
[2013-04-23 18:36:25 -0400] damian_: i already grabbed the newest version of the powershell cookbook
[2013-04-23 18:37:46 -0400] eliklein: so i'm trying to execute a "become_node" in chef-shell, and I'm getting this: https://gist.github.com/rteabeault/5446187
[2013-04-23 18:38:03 -0400] eliklein: has anyone run into this?
[2013-04-23 18:40:41 -0400] kallistec: damian_: what version of chef, and what version did you have before? and can you gist/pastebin/carrier pigeon the error message?
[2013-04-23 18:42:32 -0400] damian_: i dynamicly provision aws hhosts, and they jsut grab the newest version everytime
[2013-04-23 18:42:38 -0400] damian_: this is with hosted chef as well
[2013-04-23 18:43:00 -0400] cwj: gzc: oh hi
[2013-04-23 18:43:41 -0400] damian_: does the windows client not dump a crash report to disk?
[2013-04-23 18:45:47 -0400] damian_: this is the error
[2013-04-23 18:45:55 -0400] damian_: [31mRecipe Compile Error in c:/chef/cache/cookbooks/powershell/resources/default.rb[0m
[2013-04-23 18:46:43 -0400] damian_: and the dump
[2013-04-23 18:47:01 -0400] damian_: Relevant File Content:[0m
[2013-04-23 18:47:01 -0400] damian_: ----------------------[0m
[2013-04-23 18:47:01 -0400] damian_: C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.2/lib/chef/resource/
[2013-04-23 18:47:03 -0400] damian_: lwrp_base.rb:
[2013-04-23 18:47:05 -0400] damian_:  36:        # Evaluates the LWRP resource file and instantiates a new Resource c
[2013-04-23 18:47:07 -0400] damian_: lass.
[2013-04-23 18:47:09 -0400] damian_:  37:        def self.build_from_file(cookbook_name, filename, run_context)
[2013-04-23 18:47:11 -0400] damian_:  38:          rname = filename_to_qualified_string(cookbook_name, filename)
[2013-04-23 18:47:13 -0400] damian_:  39:
[2013-04-23 18:47:15 -0400] damian_:  40:          # Add log entry if we override an existing light-weight resource.
[2013-04-23 18:47:17 -0400] damian_:  41:          class_name = convert_to_class_name(rname)
[2013-04-23 18:47:19 -0400] damian_:  42:          if Resource.const_defined?(class_name)
[2013-04-23 18:47:21 -0400] damian_:  43>>           old_class = Resource.send(:remove_const, class_name)
[2013-04-23 18:47:23 -0400] damian_:  44:            # CHEF-3432 -- Chef::Resource keeps a list of subclasses; need t
[2013-04-23 18:47:25 -0400] damian_: o
[2013-04-23 18:47:27 -0400] damian_:  45:            # remove old ones from the list when replacing.
[2013-04-23 18:47:29 -0400] damian_:  46:            resource_classes.delete(old_class)
[2013-04-23 18:47:31 -0400] damian_:  47:            Chef::Log.info("#{class_name} light-weight resource already init
[2013-04-23 18:47:33 -0400] damian_: ialized -- overriding!")
[2013-04-23 18:47:35 -0400] damian_:  48:          end
[2013-04-23 18:47:37 -0400] damian_:  49:
[2013-04-23 18:47:39 -0400] damian_:  50:          resource_class = Class.new(self)
[2013-04-23 18:47:41 -0400] damian_:  51:
[2013-04-23 18:47:43 -0400] damian_:  52:          resource_class.resource_name = rname
[2013-04-23 18:47:45 -0400] damian_: [0m
[2013-04-23 18:48:54 -0400] miah: please paste to gist.github.com, not the channel.
[2013-04-23 18:50:15 -0400] damian_: im opening a support ticket, this is breaking my production and I need to know why ASAP
[2013-04-23 18:50:36 -0400] damian_: can anyone at least tell me if there was a new windows client released????
[2013-04-23 18:50:48 -0400] kallistec: damian_: yeah
[2013-04-23 18:50:56 -0400] damian_: awesome, when?
[2013-04-23 18:51:12 -0400] kallistec: damian_: can you post your stacktrace also?
[2013-04-23 18:51:24 -0400] damian_: its comming in the support ticket
[2013-04-23 18:51:24 -0400] miah: (preferrably to gist)
[2013-04-23 18:51:36 -0400] kallistec: on unix it goes to a /var/chef/cache/chef-stacktrace.out
[2013-04-23 18:51:43 -0400] damian_: this is windows
[2013-04-23 18:51:47 -0400] damian_: i have the stack trace
[2013-04-23 18:51:56 -0400] kallistec: should be similar-ish
[2013-04-23 18:52:08 -0400] kallistec: just under c:\chef something somethign
[2013-04-23 18:52:13 -0400] damian_: i have it
[2013-04-23 18:52:26 -0400] kallistec: can you post it to a gist?
[2013-04-23 18:54:27 -0400] damian_: https://gist.github.com/damiancurry/b4befec40173d719e321
[2013-04-23 18:55:21 -0400] damian_: ticket #14508
[2013-04-23 18:55:36 -0400] damian_: is there a way for me to attach a file to a support ticket?
[2013-04-23 18:56:01 -0400] damian_: the failed run data file is too big to copy/paste to gist
[2013-04-23 18:56:08 -0400] ssd7_: damian_: email it to support@opscode.com.  Grabbing your ticket now.
[2013-04-23 18:56:26 -0400] damian_: I have opened tickets about that with you guys before, you bounce my emails
[2013-04-23 18:56:57 -0400] ssd7_: damian_: If you email support@opscode I still get whatever you send even if the ticketing system bounces
[2013-04-23 18:57:05 -0400] ssd7_: also, feel free to email me directly with it at steve@opscode.com
[2013-04-23 18:58:10 -0400] damian_: just responded to the initial ticket email
[2013-04-23 18:58:28 -0400] ssd7_: damian_: Got it, thanks
[2013-04-23 18:58:33 -0400] damian_: thanks
[2013-04-23 18:59:02 -0400] damian_: fyi, i have tried to start ~10 servers, all failed with that exact same output
[2013-04-23 19:01:38 -0400] avleen: any opscode folks here? :)
[2013-04-23 19:01:44 -0400] ssd7_: avleen: Yes
[2013-04-23 19:01:58 -0400] avleen: :D
[2013-04-23 19:02:41 -0400] avleen: hey ssd7, i have a question. I'm about to implement iptables functionality in this: https://github.com/opscode-cookbooks/firewall    silly question, but do I just assign copyright to Opscode (as part of the existing cookbook)?
[2013-04-23 19:02:49 -0400] avleen: is there existing protocol aroudn this i should follow?
[2013-04-23 19:03:10 -0400] avleen: obviously I intent to send a pull request, which is why I'm asking ;)
[2013-04-23 19:03:21 -0400] ivey: http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-04-23 19:03:25 -0400] ssd7: avleen: Yes, you do not assign up copyright but you do sign a license agreement.
[2013-04-23 19:03:29 -0400] ssd7: See ivey's link :)
[2013-04-23 19:03:34 -0400] avleen: sweet thanks :)
[2013-04-23 19:03:47 -0400] avleen: I'll get it done! thanks guys!
[2013-04-23 19:04:28 -0400] richleland: hey gang - upgrading chef server to 11
[2013-04-23 19:04:48 -0400] richleland: used the omnibus installer - whenever I try to upload cookbooks I get a getaddrinfo error
[2013-04-23 19:05:07 -0400] richleland: having trouble finding a solution via the googs
[2013-04-23 19:05:15 -0400] richleland: getaddrinfo: nodename nor servname provided, or not known
[2013-04-23 19:05:24 -0400] richleland: ^--- that ---^
[2013-04-23 19:05:54 -0400] kallistec: richleland: chef-server is giving you back URLs that knife tries to upload to
[2013-04-23 19:06:14 -0400] kallistec: probably your chef-server doesn't have its FQDN correctly configured
[2013-04-23 19:06:35 -0400] richleland: ok I'll try to reset that
[2013-04-23 19:06:40 -0400] richleland: thx
[2013-04-23 19:06:52 -0400] richleland: I just left it the default (which worked on my chef 10 installation)
[2013-04-23 19:07:00 -0400] kallistec: richleland: probably need to run chef-server-ctl reconfigure after
[2013-04-23 19:07:17 -0400] kallistec: richleland: yeah, chef 10 server used the Host header sent by the client
[2013-04-23 19:07:30 -0400] richleland: ah
[2013-04-23 19:08:04 -0400] richleland: kallistec and when you run the reconfigure command, is that updating config files somewhere or something?
[2013-04-23 19:08:14 -0400] richleland: or re-reading system info, etc.?
[2013-04-23 19:09:11 -0400] droy: hi all, has anyone had problems with setup of mac osx workstations lately?
[2013-04-23 19:09:46 -0400] droy: when i run curl -L https://www.opscode.com/chef/install.sh | sudo bash, it errors out with "Unable to retrieve a valid package!"
[2013-04-23 19:09:49 -0400] ssd7: damian_: We know the bug and believe that we can work around it with a cookbook edit.  Details to come in the support ticket.
[2013-04-23 19:10:27 -0400] droy: "URL: https://www.opscode.com/chef/download?v=&prerelease=false&p=mac_os_x&pv=10.7&m=x86_64"
[2013-04-23 19:11:03 -0400] damian_: ssd7: I am going to need more than a cookbook work around, I have many LWRP that I use on different hosts that caused this same error.  I removed the unnecassry ones from this particular run so that I could try to get it to work
[2013-04-23 19:11:45 -0400] damian_: the other LWRP's are needed when I bring different types of hosts online
[2013-04-23 19:11:46 -0400] richleland: kallistec nevermind I see what the reconfig is doing - excellent - worked like a charm - thx
[2013-04-23 19:12:49 -0400] droy: it might be because I'm on 10.8?
[2013-04-23 19:13:21 -0400] ssd7: damian_: Roger.  My next update will describe the error.  I'll work to see if there is a more general fix that we can deploy via a cookbook until a new release is ready.
[2013-04-23 19:15:20 -0400] eliklein: is there anyone around who's familiar with how to use chef-shell and "become_node"?
[2013-04-23 19:17:48 -0400] damian_: ssd7: is it an option to roll back to the older version that worked?
[2013-04-23 19:18:20 -0400] ssd7: damian_: Yes, given this bug, rolling back to 11.4.0 should fix it.
[2013-04-23 19:18:57 -0400] damian_: I mean can you change where the default bootstrap config pulls from to be the working version
[2013-04-23 19:19:17 -0400] damian_: i have a fix since my AMI has version 10.4 installed, so i just comment out the line to download and install
[2013-04-23 19:19:39 -0400] ssd7: If you pass --bootstrap-version 11.4.0, it should install that version
[2013-04-23 19:20:11 -0400] cheeseplus: is the "knife cookbook site share" still borked for everyone?
[2013-04-23 19:22:14 -0400] richleland: is there a notification setup for releases made to cookbooks in github.com/opscode-cookbooks? or how do you keep up-to-date w/releases?
[2013-04-23 19:23:06 -0400] richleland: or I guess for community cookbooks in general
[2013-04-23 19:23:45 -0400] gzc: richleland: yep, built-in to github :) http://developer.github.com/v3/repos/hooks/#pubsubhubbub
[2013-04-23 19:23:56 -0400] gchristensen: richleland: generally I follow the chef mailing list, and they sendo ut emails
[2013-04-23 19:25:26 -0400] richleland: gzc oh thx
[2013-04-23 19:26:09 -0400] gzc: np, I need to start using it myself
[2013-04-23 19:26:33 -0400] gzc: i wonder if anyone's already set up a bot for this channel to notify about new releases
[2013-04-23 19:26:45 -0400] richleland: gzc yeah that's what I want to do
[2013-04-23 19:29:21 -0400] gzc: too bad fnichol isn't around, i'm loving knife-server
[2013-04-23 19:29:45 -0400] gzc: and want to try adding some route53 integration
[2013-04-23 19:29:58 -0400] wdilly: Hi there, can anyone help me understand why knife cookbook upload -a seems to give me an error fro only one of my cookbooks, I get the error: ERROR: internal server error
[2013-04-23 19:30:27 -0400] wdilly: i should mention nothing has changed in this cookbook for some time
[2013-04-23 19:41:16 -0400] cheeseplus: before I lose battery on this plane: anybody else able to use knife cookbooks site share?
[2013-04-23 19:41:49 -0400] cheeseplus: I'm getting the typical 'Server response: {"error_code": "AUTHENTICATION_FAILED"}' but have plugged in the appropriate key (regenerated even) and username
[2013-04-23 19:42:23 -0400] cheeseplus: still no dice and I'm wondering if I should continue to even bother as this seems broken every other time I try to use the functionality :(
[2013-04-23 19:42:58 -0400] cjerdonek: why aren't functions defined in a recipe file visible to a resource block in that file, but variables defined in the recipe are? e.g. http://le-huy.blogspot.com/2011/05/chef-different-between-method-defined.html
[2013-04-23 19:45:27 -0400] stormerider: trying to bootstrap a 10.04 node with chef 11 client, getting the following error: [2013-04-23T19:44:50+00:00] FATAL: Unknown error processing config file  with error undefined method `ConfigurationError' for Chef::Exceptions:Class
[2013-04-23 19:45:51 -0400] stormerider: i even tried running "chef-client -j bootstrap.json -c /etc/chef/client.rb" and it still gave the same error
[2013-04-23 19:46:15 -0400] stormerider: rather odd that it doesn't show the name of the config file it's complaining about
[2013-04-23 19:46:35 -0400] stormerider: 11.4.2 deb for the client, btw.
[2013-04-23 19:46:59 -0400] cjerdonek: stormerider: it looks like there are two spaces after "config file" so maybe the file name is the empty string?
[2013-04-23 19:47:27 -0400] stormerider: cjerdonek: *nod* that's why i specified the config file explicitly but that didnt change anything
[2013-04-23 19:48:21 -0400] thehar: omg i saw jtimberman on the street!
[2013-04-23 19:48:23 -0400] thehar: :D
[2013-04-23 19:49:31 -0400] fly9: if I declare an attribute in a role's default_attributes section, how can I access that from a recipe within another role? possible?
[2013-04-23 19:50:12 -0400] gzc: there's only one attribute namespace per node, so as long as you set it in a predictable location you can always get to it
[2013-04-23 19:50:24 -0400] richleland: gzc FYI - apparently you can't subscribe to repos you don't own
[2013-04-23 19:50:34 -0400] richleland: via Github's PSHB
[2013-04-23 19:50:47 -0400] gzc: i.e. node.set['toplevel']['leaf'] from recipe 1, you can always get it with node['toplevel']['leaf'] from another recipe
[2013-04-23 19:50:52 -0400] gzc: richleland: damn, that sucks :(
[2013-04-23 19:51:21 -0400] stormerider: is there a more verbose level beyond "-l debug" ?
[2013-04-23 19:51:46 -0400] fly9: gzc: does that mean I can't get an attribute declared in role a from a recipe in role b?
[2013-04-23 19:52:26 -0400] fly9: or do roles not have anything to do with it
[2013-04-23 19:52:31 -0400] gzc: fly9: yep, absolutely
[2013-04-23 19:52:45 -0400] gzc: roles are just groupings of recipes and other environment 'stuff'
[2013-04-23 19:53:19 -0400] gzc: richleland: dang, I can't find another option, but it'd certainly make sense for opscode to publish that kind of thing via rss or irc or something
[2013-04-23 19:53:47 -0400] coderanger: stormerider: No
[2013-04-23 19:53:50 -0400] richleland: gzc yeah - I mean I could subscribe to repos on gh, write a bot that consumes the news feed, but meh
[2013-04-23 19:54:14 -0400] stormerider: coderanger: thanks. i guess ill downgrade to 11.4.0 and see if it still barfs on the config file
[2013-04-23 19:54:19 -0400] coderanger: richleland: What are you trying to do?
[2013-04-23 19:54:36 -0400] coderanger: stormerider: Sorry, just reading scrollback while digesting lunch, whats the issue?
[2013-04-23 19:54:37 -0400] richleland: coderanger oh hey - just wondering the best way to keep up to date on community releases
[2013-04-23 19:54:49 -0400] coderanger: richleland: as in cookbook releases or chef client?
[2013-04-23 19:54:52 -0400] richleland: coderanger I just have a ton of out of date shit (I've been bad :))
[2013-04-23 19:54:59 -0400] richleland: coderanger no sry for cookbooks
[2013-04-23 19:55:15 -0400] coderanger: richleland: community.opscode.com lets you subscribe to new releases :)
[2013-04-23 19:55:19 -0400] richleland: coderanger basically I want notifications when a new version of a cookbook is pushed
[2013-04-23 19:55:25 -0400] coderanger: One thing the site actually fracking does right
[2013-04-23 19:55:59 -0400] stormerider: coderanger: bootstrapping 10.04 ubuntu with the 11.4.2 node is throwing [2013-04-23T19:51:03+00:00] FATAL: Unknown error processing config file  with error undefined method `ConfigurationError' for Chef::Exceptions:Class
[2013-04-23 19:56:07 -0400] richleland: coderanger via the follow button?
[2013-04-23 19:56:14 -0400] coderanger: richleland: Yep
[2013-04-23 19:56:26 -0400] stormerider: coderanger: even when i specify "-c client.rb" it still doesn't show the file name in the error
[2013-04-23 19:56:37 -0400] coderanger: richleland: You can also follow a user to get notifications for everything they do
[2013-04-23 19:56:38 -0400] richleland: coderanger how's that update you tho?
[2013-04-23 19:56:43 -0400] coderanger: richleland: email
[2013-04-23 19:56:54 -0400] fly9: gzc: beautiful thanks
[2013-04-23 19:56:55 -0400] richleland: coderanger oh word didn't know that
[2013-04-23 19:57:02 -0400] stormerider: coderanger: i didn't know about that, ill have to go follow a few cookbooks now, sweet
[2013-04-23 19:57:07 -0400] richleland: coderanger would be slick if you could specify notification hooks - irc, etc.
[2013-04-23 19:57:16 -0400] coderanger: richleland: Heh, we'll get there
[2013-04-23 19:57:33 -0400] richleland: coderanger lemme know if you need any help ;-)
[2013-04-23 19:57:43 -0400] coderanger: stormerider: whats the full chef-client command you are running
[2013-04-23 19:58:46 -0400] stormerider: coderanger: chef-client -j /etc/chef/bootstrap.json -c /etc/chef/client.rb -l debug
[2013-04-23 19:59:16 -0400] coderanger: That should definitely show the trace on exception, hmmm
[2013-04-23 19:59:27 -0400] coderanger: Does your client.rb have a log_level in it?
[2013-04-23 19:59:29 -0400] coderanger: That might be overriding
[2013-04-23 19:59:35 -0400] stormerider: i can gist the client.rb if that'd help
[2013-04-23 19:59:39 -0400] coderanger: sure
[2013-04-23 20:00:08 -0400] stormerider: it did, but changing it from info to debug didnt help. sec.
[2013-04-23 20:01:36 -0400] stormerider: coderanger: https://gist.github.com/5446912
[2013-04-23 20:02:41 -0400] coderanger: Hmm, the only thing that looks non-standard is the signing_ca_user line
[2013-04-23 20:02:41 -0400] stormerider: hm. 11.4.0 gives same error.
[2013-04-23 20:03:10 -0400] stormerider: coderanger: removing that doesnt change it, either.
[2013-04-23 20:06:10 -0400] stormerider: seems to be the log_location line...
[2013-04-23 20:06:52 -0400] coderanger: Heh, was about to post that
[2013-04-23 20:06:52 -0400] coderanger: raise Chef::Exceptions::ConfigurationError("Failed to open or create log file at #{location.to_str}")
[2013-04-23 20:07:08 -0400] coderanger: I would bet there is a missing require
[2013-04-23 20:07:22 -0400] stormerider: apparently /var/log/chef didn't exist. creating that solved the error.
[2013-04-23 20:07:25 -0400] coderanger: Yep
[2013-04-23 20:07:31 -0400] coderanger: ssd7: Poke
[2013-04-23 20:07:49 -0400] coderanger: https://github.com/opscode/chef/blob/master/lib/chef/config.rb needs to have a require for the exceptions file
[2013-04-23 20:08:04 -0400] coderanger: Am I allowed to just change things like that or should I follow the public process? :)
[2013-04-23 20:08:38 -0400] stormerider: is this a bug or should i be creating that path explicitly as part of my bootstrap process since the omnibus package doesn't create that?
[2013-04-23 20:08:50 -0400] stormerider: or both, i suppose :)
[2013-04-23 20:09:09 -0400] coderanger: On that I defer to others that know the omnibus bootstrap process better than I
[2013-04-23 20:09:23 -0400] coderanger: but we should definitely fix the grumpy secondary error :)
[2013-04-23 20:10:11 -0400] stormerider: im more familiar with the 10 ubuntu packages myself, but omnibus seems to be the way everything is heading with 11 (which, not having to argue with ruby 1.8 vs 1.9.x, I can't complain about)
[2013-04-23 20:11:23 -0400] stormerider: anyways, thanks for the help coderanger :)
[2013-04-23 20:13:26 -0400] gleam: i have noticed that at least on squeeze, the chef 11 omnibus deb uses about 50mb more memory when it runs than chef 10 from apt.opscode.com
[2013-04-23 20:14:05 -0400] coderanger: gleam: Yes, there is a known leak in 11.4.0
[2013-04-23 20:14:08 -0400] coderanger: new version incoming
[2013-04-23 20:14:31 -0400] gzc: damnit, this is exactly what i want https://github.com/opscode/knife-ec2/pull/19
[2013-04-23 20:15:34 -0400] rdickeyvii: hey question about cookbooks on community.opscode.com: is there a way to rename a public cookbook there that I own?  Main reason to rename rather than re-create is to keep the first upload date and download history
[2013-04-23 20:15:35 -0400] coderanger: gzc: knife really isn't a good choice as an AWS control layer :P
[2013-04-23 20:15:43 -0400] cwj: tend to agree
[2013-04-23 20:15:58 -0400] coderanger: rdickeyvii: Not really, I could do it manually though
[2013-04-23 20:16:05 -0400] gleam: great news.
[2013-04-23 20:16:26 -0400] rdickeyvii: coderanger: that would be awesome.  would I need to create a ticket or something?
[2013-04-23 20:16:33 -0400] cwj: gzc: maybe https://github.com/pcorliss/ruby_route_53 is relevant to your interests
[2013-04-23 20:16:48 -0400] coderanger: rdickeyvii: email support@opscode.com with deetz and include a "talk to coderanger" so they know the find me
[2013-04-23 20:17:01 -0400] gzc: coderanger: oh absolutely, but it's a useful thing for a plugin to handle in some cases
[2013-04-23 20:17:07 -0400] rdickeyvii: coderanger: thanks!  will do that now
[2013-04-23 20:17:30 -0400] ssd7: coderanger: I think we'll probably have to have a follow up release to 11.4.2 so you might want to coordinate with whoever is going to lead that change
[2013-04-23 20:17:35 -0400] coderanger: rdickeyvii: With chefconf about to eat all our brains, probably wont get to it until next week
[2013-04-23 20:17:37 -0400] gzc: knife is definitely creepin' up there in functionality
[2013-04-23 20:17:56 -0400] stormerider: 11.4.2 is out with those fixes, actually
[2013-04-23 20:18:16 -0400] rdickeyvii: coderanger: yeah we kinda pushed this to the last minute
[2013-04-23 20:18:27 -0400] coderanger: oh hey, it is
[2013-04-23 20:18:33 -0400] coderanger: I wonder why I don't see a git tag for it
[2013-04-23 20:18:50 -0400] coderanger: Apparently because I just can't read, derpppp
[2013-04-23 20:19:01 -0400] stormerider: coderanger: that was actually why i was asking about the update process for omnibus on the mailing list :)
[2013-04-23 20:20:54 -0400] coderanger: stormerider: http://tickets.opscode.com/browse/CHEF-4114
[2013-04-23 20:20:59 -0400] coderanger: fix was submitted 10 hours ago
[2013-04-23 20:21:00 -0400] coderanger: :)
[2013-04-23 20:22:17 -0400] gzc: to amend my previous statement, the route53 gem is pretty awesome
[2013-04-23 20:22:24 -0400] gzc: huzzah
[2013-04-23 20:22:57 -0400] stormerider: coderanger: perfect, thanks
[2013-04-23 20:46:46 -0400] stormerider: hm. i just tried to do "knife cookbook site install omnibus_updater" and it's giving me an error about not finding the .git/modules path. my repo has chef-repo as a subdirectory off of the main ops config, is that something i need to configure knife to know about? havent had the issue with other cookbooks (just updated chef-client/chef-server)
[2013-04-23 21:08:03 -0400] gansbrest: Hi. When I'm starting new ec2 machine with knife ec2 server create - I'm getting ERROR: ArgumentError: Could not parse PKey: no start line
[2013-04-23 21:08:36 -0400] gansbrest: it seems like it could be related to the net-ssh gem ( I'm using 2.6.7 )
[2013-04-23 21:27:16 -0400] richleland: anyone around that can field a Berkshelf question?
[2013-04-23 21:27:35 -0400] ivey: richleland: sure
[2013-04-23 21:27:55 -0400] richleland: ivey I have local path cookbooks that I'm installing
[2013-04-23 21:28:02 -0400] richleland: ivey they install just fine
[2013-04-23 21:28:13 -0400] richleland: ivey but when I upload I get a "Cookbook 'X' not found in any of the default locations"
[2013-04-23 21:28:28 -0400] richleland: ivey is there some trick to get it to recognize that local path when uploading?
[2013-04-23 21:28:41 -0400] richleland: ivey it's a dep of some other cookbooks I have
[2013-04-23 21:29:01 -0400] ivey: no trick it should just work
[2013-04-23 21:29:35 -0400] richleland: ivey I have noticed it doesn't copy any local path cookbooks into ~/.berkshelf/cookbooks/
[2013-04-23 21:29:41 -0400] ivey: right
[2013-04-23 21:29:47 -0400] ivey: that is correct
[2013-04-23 21:30:03 -0400] ivey: but upload should find it still
[2013-04-23 21:30:32 -0400] richleland: ivey hrmph I'll keep digging then
[2013-04-23 21:30:38 -0400] richleland: must be something w/my local setup
[2013-04-23 21:30:51 -0400] ivey: open an issue on github and paste your berksfile?
[2013-04-23 21:30:59 -0400] ivey: i can dig in after dinner, too
[2013-04-23 21:31:13 -0400] richleland: oh ok - on the berksfile gh?
[2013-04-23 21:31:22 -0400] ivey: yeah riotgames/berkshelf
[2013-04-23 21:31:27 -0400] richleland: ivey thx
[2013-04-23 21:33:47 -0400] techminer1: Can I use a Hash in the default attributes file?  node['blah'] = {"k1" => "v1","k2" => "v2"}
[2013-04-23 21:35:00 -0400] techminer1: Because in my recipe it's not letting me use each_value..tells me "undefined method `each_pair' for nil:NilClass" even though I have defined that in my default attributes file.
[2013-04-23 21:35:16 -0400] techminer1: each_pair not each_value
[2013-04-23 21:39:36 -0400] techminer1: Here's a pastie showing the code and error. http://pastie.org/7705337
[2013-04-23 21:45:12 -0400] Kzim: hi
[2013-04-23 21:46:12 -0400] Kzim: how can i but sure that my code is executed on the second reading of the recipe please ? i would like to set a var in the first run and then use this var on the second phase of the chef-client run to actually do something
[2013-04-23 21:50:46 -0400] bluekelp: Kzim: set an attribute or tag on the node
[2013-04-23 21:52:56 -0400] sfalcon: Hey all Chef Server 11.0.8 is released! http://www.opscode.com/blog/2013/04/23/chef-server-11-0-8-released/
[2013-04-23 21:53:14 -0400] kallistec: techminer1: are you sure your attributes file is being read? Could you be on chef-solo, and depending on a cookbook without setting a dependency in your metadata?
[2013-04-23 21:59:10 -0400] Kzim: blueben, i mean i would like it to be in a single run
[2013-04-23 21:59:43 -0400] Kzim: blueben, by second run i mean you know chef-client have a sort of evaluation phase then it run things
[2013-04-23 22:06:09 -0400] thehar: sfalcon: yay
[2013-04-23 22:12:47 -0400] techminer1: kallistec:  I don't think it liked that my attributes were similarly named
[2013-04-23 22:13:18 -0400] Wynn: Has anyone had much success with exporting and importing users on chef 11?
[2013-04-23 22:13:45 -0400] Wynn: I can't find anything online to move user accounts to another chef server
[2013-04-23 22:14:07 -0400] Wynn: for saydisaster recovery and whatnot
[2013-04-23 22:14:21 -0400] tomdzk: Wynn: have you looked at http://www.opscode.com/blog/2013/03/12/5106/ ?
[2013-04-23 22:14:38 -0400] tomdzk: the same might work for chef 11 (knife download & massaging)
[2013-04-23 22:15:20 -0400] Wynn: Thanks tomdzk! I tried that, but the knife download command doesn't export users
[2013-04-23 22:15:36 -0400] Wynn: it does export nodes, clients, cookbooks and data bags
[2013-04-23 22:15:54 -0400] Wynn: but not users, at least not when I did it
[2013-04-23 22:16:39 -0400] tomdzk: Wynn: knife download users/foo.json doesn't work ?
[2013-04-23 22:21:08 -0400] Wynn: tomdzk: I don't seem to have a user directory
[2013-04-23 22:21:26 -0400] Wynn: When I do a knife list , it just shows:
[2013-04-23 22:21:26 -0400] Wynn: /cookbooks     /data_bags     /environments  /roles
[2013-04-23 22:22:01 -0400] Wynn: but knife user list shows some accounts
[2013-04-23 22:22:13 -0400] Wynn: am I missing something here?
[2013-04-23 22:26:15 -0400] tomdzk: Wynn: I see code for handling users in knife-essentials, but I'm not sure how to trigger it
[2013-04-23 22:26:33 -0400] tomdzk: I'm not very familiar with it, but maybe somebody else in here is
[2013-04-23 22:26:46 -0400] franzaz: anyone seen this when trying to use the chef deploy_revision provider:
[2013-04-23 22:26:51 -0400] franzaz: Begin output of git checkout -b deploy 61a189fcc65ae66a296bb69801a4bfa9d633b85b ----
[2013-04-23 22:26:51 -0400] franzaz: STDOUT:
[2013-04-23 22:26:51 -0400] franzaz: STDERR: fatal: reference is not a tree: 61a189fcc65ae66a296bb69801a4bfa9d633b85
[2013-04-23 22:27:40 -0400] Wynn: Thanks tomdzk! I'll check out knife-essentials. I haven't used it very much, but it's a place to start. Much appreciated. =)
[2013-04-23 22:28:17 -0400] tdg5: can anyone give me some insight into how conditional execution (only_if, not_if) and notifies/subscribes interact?
[2013-04-23 22:28:26 -0400] tomdzk: Wynn: you prob. have to use the latest knife-essentials (and maybe also local chef gem to get the most recent knife)
[2013-04-23 22:31:25 -0400] Wynn: tomdzk: I think I have it
[2013-04-23 22:31:50 -0400] Wynn: I'm running version 11.4.0
[2013-04-23 22:33:13 -0400] Kzim: hello, i have a directory resource in a provider that execute before the lvm resource placed before the declaration of my provider in my reciepe. how can i force execute the lvm before the directory please ?
[2013-04-23 22:33:26 -0400] tomdzk: Wynn: found it - you need to add repo_mode "everything" to your knife.rb
[2013-04-23 22:33:38 -0400] tomdzk: Wynn: otherwise it will not map users, clients, nodes
[2013-04-23 22:33:52 -0400] Wynn: oh, let me see
[2013-04-23 22:48:28 -0400] frazras: hi @all I am getting this error http://hastebin.com/raw/gixeyuvahu
[2013-04-23 22:48:43 -0400] frazras: the run_list seems to always append recipe[ to the list
[2013-04-23 22:48:56 -0400] frazras: what am I doing wrong
[2013-04-23 22:50:07 -0400] tomdzk: frazras: can you put up your vagrant config ?
[2013-04-23 22:50:38 -0400] tomdzk: (looks like it's using vagrant?)
[2013-04-23 22:51:52 -0400] frazras: http://hastebin.com/maquqibeli.avrasm
[2013-04-23 22:52:12 -0400] tomdzk: frazras: also, your "run_list" is enclosed in {} ?
[2013-04-23 22:52:47 -0400] frazras: tomdzk:  it is in the actual file, that was an exerpt
[2013-04-23 22:53:23 -0400] tomdzk: frazras: in vagrant you'd generally do: chef.add_recipe "devudo::vagrant"
[2013-04-23 22:54:35 -0400] tomdzk: frazras: so in your case, attributes["run_list"].each do {|item| chef.add_recipe item} (assuming they all are recipes)
[2013-04-23 22:54:41 -0400] frazras: tomdzk: but I want to pass in the recipes as attaributes
[2013-04-23 22:54:55 -0400] frazras: ok
[2013-04-23 23:01:43 -0400] frazras: tomdzk: OK I was assuming the code was syntax free, because I have little to no knowledge of ruby http://hastebin.com/raw/goxonetomo
[2013-04-23 23:02:29 -0400] tomdzk: err, yeah, remove the 'do'
[2013-04-23 23:08:04 -0400] frazras: tomdzk:  more errors, I think if I knew a little more ruby, it would have helped http://hastebin.com/raw/jenajeraya
[2013-04-23 23:09:01 -0400] tomdzk: frazras: for one, I think you still have this line in there: chef.add_recipe attributes["run_list"]
[2013-04-23 23:10:37 -0400] frazras: no I actually deleted that
[2013-04-23 23:11:31 -0400] tomdzk: frazras: could be the chef.json = attributes line then
[2013-04-23 23:13:03 -0400] tomdzk: frazras: try http://hastebin.com/minididibo.avrasm
[2013-04-23 23:14:08 -0400] ctennis: so chefs what's the server upgrade procedure for 11.0.6 -> 11.0.8?
[2013-04-23 23:17:50 -0400] frazras: tomdzk: it failed again :-( http://hastebin.com/raw/cogixexebi
[2013-04-23 23:18:03 -0400] frazras: maybe we could modify the json format
[2013-04-23 23:19:27 -0400] tomdzk: frazras: my regex is weak today, try http://hastebin.com/femajoqono.avrasm
[2013-04-23 23:23:25 -0400] jed_: kallistec: did your fix for the PID issue make it into 11.4.2 as the JIRA says?
[2013-04-23 23:23:35 -0400] kallistec: jed_: yes
[2013-04-23 23:23:53 -0400] jed_: root     30864  0.0  0.4 207608 30448 ?        Sl   23:20   0:00 /opt/chef/embedded/bin/ruby /usr/bin/chef-client -d -c /etc/chef/client.rb -L /var/log/chef/client.log -P /var/run/chef/client.pid -i 300 -s 300 --fork
[2013-04-23 23:23:57 -0400] jed_: root     31373  0.0  0.4 207612 30388 ?        Sl   23:21   0:00 /opt/chef/embedded/bin/ruby /usr/bin/chef-client -d -c /etc/chef/client.rb -L /var/log/chef/client.log -P /var/run/chef/client.pid -i 300 -s 300 --fork
[2013-04-23 23:24:01 -0400] jed_: jed@ezem10 ~ $ cat /var/run/chef/client.pid
[2013-04-23 23:24:04 -0400] jed_: cat: /var/run/chef/client.pid: No such file or directory
[2013-04-23 23:24:23 -0400] jed_: jed@ezem10 ~ $ /usr/bin/chef-client --version
[2013-04-23 23:24:24 -0400] jed_: Chef: 11.4.2
[2013-04-23 23:24:37 -0400] jed_: it's beginning its fork bomb descent, I think
[2013-04-23 23:24:41 -0400] jed_: there's already two running
[2013-04-23 23:25:28 -0400] jed_: now 3... I caught a ps in flight and it looked like 'service' was running, so it was trying to restart chef-client, maybe
[2013-04-23 23:26:42 -0400] magoo: is it possible to specify a larger ebs size with vagrant-aws?
[2013-04-23 23:27:01 -0400] jed_: kallistec: https://gist.github.com/jedsmith/5448309
[2013-04-23 23:28:29 -0400] magoo: meh, wrong room
[2013-04-23 23:29:28 -0400] franzaz: franzaz: don't use 'shallow_clone true'
[2013-04-23 23:30:05 -0400] jed_: jed@ezem10 ~ $ ps auxfwwww | grep -c ruby
[2013-04-23 23:30:05 -0400] jed_: 8
[2013-04-23 23:30:07 -0400] jed_: yep, off it goes
[2013-04-23 23:30:21 -0400] jed_: it's an exponential bug, too, so the children spawn 2, which spawn 4, which spawn 8 ...
[2013-04-23 23:30:30 -0400] frazras: tomdzk: u saved the day ;-)
[2013-04-23 23:30:37 -0400] frazras: tomdzk++
[2013-04-23 23:31:09 -0400] tomdzk: frazras: cool
[2013-04-23 23:32:30 -0400] jed_: I'm going to reopen this JIRA if I can
[2013-04-23 23:32:39 -0400] stevenator: hello. does anyone have information on how chefs are handling first node to converge scenarios. i only have a few nodes in the smallest state of my clustering, but some of them are in auto-scaling arrays (EC2). I am just wondering if the community iOS handling smaller cases like mine without using rundeck or some other orchestration tool. Node tags?
[2013-04-23 23:35:29 -0400] jackery: Most of the backup tutorials I've seen in the wild cover backing up everything on the Chef 11 server except the "user" information. Anyone know the trick to backup/restore for user data?
[2013-04-23 23:39:19 -0400] tomdzk: jackery: Wynn had a similar problem earlier today, presumably knife-essentials lets you download/upload user (and client/node) data when you add 'repo_mode "everything"' to your knife.rb, maybe that helps
[2013-04-23 23:39:47 -0400] jackery: tomdzk: I'll give it a shot! Thanks :)
[2013-04-23 23:40:13 -0400] Wynn: Actually, I tried that and it still wasn't working
[2013-04-23 23:40:47 -0400] tomdzk: jackery: though you that info might be stored in the postgres DB so a backup/restore of that might do what you want
[2013-04-23 23:41:18 -0400] jackery: tomdzk: I'll ask my sick my DBAs on that.
[2013-04-23 23:44:46 -0400] jed_: kallistec: JIRA commented upon, but I cannot reopen it
[2013-04-23 23:46:31 -0400] kallistec: jed_: hrm, I'll look into it more, we explicitly tested this and I cannot repro it right now
[2013-04-23 23:46:48 -0400] jed_: so my sequence of events that I noticed
[2013-04-23 23:47:00 -0400] jed_: 1) start chef-client, it gets pid A. I didn't check PID file here
[2013-04-23 23:47:10 -0400] jed_: 2) USR1 pid A, suddenly pid B is running and pid A is gone
[2013-04-23 23:47:29 -0400] jed_: 3) pid B begins the cancerous fork bomb cycle
[2013-04-23 23:47:46 -0400] jed_: let me see if I can repro
[2013-04-23 23:49:17 -0400] jed_: hm, I can't make it do anything, now -- not even log to client.log
[2013-04-23 23:50:21 -0400] jed_: my last client.log entry is [2013-04-23T23:37:34+00:00] FATAL: SIGTERM received, stopping, from when I killall'd chef-client
[2013-04-23 23:50:32 -0400] jed_: sudo service chef-client start kicked off a chef-client, but it's not speaking in client.lgo
[2013-04-23 23:50:36 -0400] jed_: and USR1 isn't waking it up...
[2013-04-23 23:50:38 -0400] jed_: interesting
[2013-04-23 23:50:54 -0400] kallistec: jed_: some other process probably has the per-run lock
[2013-04-23 23:51:23 -0400] kallistec: see if you can find something with /var/chef/cache/chef-client-running.pid in lsof
[2013-04-23 23:52:05 -0400] jed_: intriguing, that has a PID *after* the one that's currently running
[2013-04-23 23:52:39 -0400] coderanger: chefconfchefconfchefconf
[2013-04-23 23:52:53 -0400] jed_: so I did a 'sudo /opt/chef/embedded ...', that launched 8154, 8154 launched some children apparently for its first run, 8157 got written to chef-client-running.pid
[2013-04-23 23:53:09 -0400] jed_: no 8157 running now, BUT /var/run/chef/client.pid is intact with 8154
[2013-04-23 23:53:49 -0400] jed_: I caught this in progress: https://gist.github.com/jedsmith/5448462
[2013-04-23 23:54:04 -0400] jed_: so there's 8157, which is doing service chef-client status, which ... hm.
[2013-04-23 23:55:22 -0400] jed_: this could be some kind of bug in the chef-client cookbook interacting weirdly with chef client
