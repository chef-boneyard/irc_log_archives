[2013-04-03 02:10:13 -0400] log1kal: Hey everyone. I remember seeing an article that talked about levels of config management nirvana, or something. L1 was something like "direct shell script replacement"
[2013-04-03 02:10:36 -0400] log1kal: anyone else remember that, or have better google-fu than I do?
[2013-04-03 02:13:20 -0400] bluekelp: log1kal: sounds interesting but i haven't seen it
[2013-04-03 02:19:18 -0400] log1kal: Hrmm, I found one, but not the one I was looking for.
[2013-04-03 02:19:24 -0400] log1kal: of course this one is Allspaw.
[2013-04-03 02:19:35 -0400] log1kal: http://www.kitchensoap.com/2012/09/21/a-mature-role-for-automation-part-i/
[2013-04-03 02:20:07 -0400] log1kal: that's actually more automation focused.
[2013-04-03 02:38:58 -0400] Axsuul: How do I get around " requested operation requires superuser privilege " error when preparing an ode?
[2013-04-03 02:39:02 -0400] Axsuul: dpkg: requested operation requires superuser privilege
[2013-04-03 02:39:08 -0400] Axsuul: Ubuntu 12.04
[2013-04-03 02:50:22 -0400] miah: run chef as root
[2013-04-03 02:54:35 -0400] atomic-penguin: what miah said ^^
[2013-04-03 04:03:04 -0400] silk: im sure this gets filed under stupid questions, but does any chef release > 10.18.0 have to be installed either via gems or omnibus?
[2013-04-03 04:05:51 -0400] chefologist: hi trying to get the 3 files in the prereq steps on opscode quickstart, how do I get these? where are they? thanks in advance
[2013-04-03 04:06:38 -0400] chefologist: oooh there is a screen cast :) https://learnchef.opscode.com/screencasts/manage-pem-files/
[2013-04-03 04:20:22 -0400] Guest22248: anyone here familiar with knife ec2 server?
[2013-04-03 04:43:29 -0400] gleam: a'
[2013-04-03 06:36:20 -0400] jtimberman: tanto: there's a few reasons for not having chef 11 server packages in an apt repo. primarily of which our effort for such things is the "full stack" (omnibus) package, which is a single package, single download, and contains everything you'll need for a running chef server, with versions of all the software at a known tested state that we can support. the same can't be said for upstream distribution-provided packages via apt installation (whic
[2013-04-03 06:37:19 -0400] jtimberman: tanto: specific plans for the apt server are best answered by btm, as he knows the story on that better than i do; i believe a rebuild of the systme it runs on is planned, but i don't know more than that.
[2013-04-03 07:24:37 -0400] Oik741: hi guys, second day cant understand how to create chef repository =) cookbooks stored in /var/lib/chef/cookbooks, in configs i dont find any directives to set repo, only cookbook_path
[2013-04-03 07:25:01 -0400] Mithrandir: you need to upload them to the chef server, have you done that?
[2013-04-03 07:25:23 -0400] Oik741: in which dir?
[2013-04-03 07:25:59 -0400] Oik741: in configs no information about where repo must be lcoated
[2013-04-03 07:26:12 -0400] Oik741: on host
[2013-04-03 07:30:14 -0400] Mithrandir: using knife cookbook upload.
[2013-04-03 07:31:37 -0400] Oik741: huge thx =)
[2013-04-03 09:44:03 -0400] pikesley: Anybody around? Might be a bit early, I guess
[2013-04-03 09:44:05 -0400] pikesley: But
[2013-04-03 09:44:13 -0400] pikesley: I have a problem
[2013-04-03 09:44:32 -0400] pikesley: When I run chef by hand on this node, it works fine
[2013-04-03 09:44:50 -0400] pikesley: when it runs automatically via chef-client::service
[2013-04-03 09:44:52 -0400] pikesley: KABOOM
[2013-04-03 09:44:52 -0400] pikesley: [2013-04-03T09:39:35+00:00] ERROR: NoMethodError: Undefined method or attribute `ipaddress' on `node'
[2013-04-03 09:44:59 -0400] pikesley: and it craps out
[2013-04-03 10:01:10 -0400] josqu4red: hi there
[2013-04-03 10:01:49 -0400] josqu4red: is there a way to define a method/resource which would be available in recipes and within ruby_blocks ?
[2013-04-03 10:02:24 -0400] josqu4red: i tried extendind Chef::Recipe, define, lwrp, but none of them seems callable from a ruby_block
[2013-04-03 10:02:47 -0400] josqu4red: at least i found no way to do it
[2013-04-03 10:03:44 -0400] Mez: Ok, this is going to potentially be a weird question: Is there anything that can talk to the chef API that *isn't* ruby (looking at the Mixlib::Authentication dependency)
[2013-04-03 10:26:14 -0400] Mez: Ok. Scrap that I worked it out.  Is there a way of installing chef server via a cookbook that doesn't use omnibus? (I want to use apt packages)
[2013-04-03 10:27:23 -0400] ShawnMcCool: hi, so i have a bunch of cookbooks in my setup like.. the opscode official stuff.. apache, etc, etc. but, then i seem to have cookbooks that accept parameters from my Vagrantfile and set up my dev environments in a specific way.. like, automatically installing development databases from a server.. is there a specific distinction between these types of cookbooks?
[2013-04-03 10:28:05 -0400] Mez: ShawnMcCool: what do you mean by "specific distinction"?
[2013-04-03 10:28:49 -0400] siXy: josqu4red: you might be able to use a library within a ruby-block
[2013-04-03 10:29:03 -0400] ShawnMcCool: Sorry, I'm lacking the appropriate jargon and understanding to make myself clear. I'm trying to see if my approach of having a cookbook that is designed to retrieve a DB from a remote machine and installing it locally is an appropriate way of approaching the problem.
[2013-04-03 10:30:16 -0400] Mez: ShawnMcCool: no problem about jargon etc, if I don't understand I'll just ask you to clarify :) Might be useful to know what the problem is @ShawnMcCool
[2013-04-03 10:30:47 -0400] Mez: ShawnMcCool: If it's what I think it is (distinguishing a vagrant environment from a production environment) then - that's what chef "environments" are for.
[2013-04-03 10:31:28 -0400] ShawnMcCool: When I bring a box up with 'vagrant up' I want it to create a database and import basically an SQL seed from another machine that is created from production periodically.
[2013-04-03 10:32:37 -0400] Mez: Ok. That can be done fairly simply... what're you having trouble with
[2013-04-03 10:32:37 -0400] Mez: ?
[2013-04-03 10:33:27 -0400] ShawnMcCool: I have it working, essentially. I just am not sure if I should add a new recipe to the mysql cookbook. Create a new helper cookbook with a bunch of this type of recipe within. Or, if I should create an isolated cookbook for specifically this purpose.
[2013-04-03 10:34:19 -0400] Mez: I think that's a personal decision really.  Personally, I'd put it in a cookbook related to the app that I'm bringing the DB in for.
[2013-04-03 10:35:03 -0400] ShawnMcCool: i have it parameterized so that i could send in a number of configurations from the vagrantfile (json) and it fits any number of sites
[2013-04-03 10:35:15 -0400] ShawnMcCool: well, at least.. that's where i'm working towards. I only actually have it fully working in prototype
[2013-04-03 10:35:32 -0400] ShawnMcCool: So, I get the feeling from your responses that this is a somewhat reasonable approach.
[2013-04-03 10:36:06 -0400] Mez: ShawnMcCool - if you've parameterised it and want to use it for multiple things, have you considered making it an LWRP?
[2013-04-03 10:36:24 -0400] Mez: http://docs.opscode.com/lwrp.html <--
[2013-04-03 10:36:31 -0400] ShawnMcCool: thanks, i'm not familiar with the term, i'll read it
[2013-04-03 10:36:33 -0400] Mez: This basically means you can call something like
[2013-04-03 10:36:42 -0400] Mez: import_mysql "foo" do
[2013-04-03 10:36:49 -0400] Mez:   action :install
[2013-04-03 10:36:59 -0400] Mez:   from 'remote@server'
[2013-04-03 10:37:01 -0400] Mez: end
[2013-04-03 10:37:32 -0400] ShawnMcCool: ah, so it basically extends the dsl
[2013-04-03 10:37:33 -0400] Mez: (LWRP = lightweight resource provider)
[2013-04-03 10:38:34 -0400] Mez: ShawnMcCool: yes, for example, the "apt" cookbook has a "repository" provider - allowing you to define apt_repository 's simply
[2013-04-03 10:39:12 -0400] ShawnMcCool: Thank you, this is exactly the kind of advice i was looking for. I'll read up on this and then take a shot at it.
[2013-04-03 10:39:46 -0400] Mez: Great :) Have a look over the apt repository provider :) It's kinda a simple one to have a look out and work out how things are done
[2013-04-03 10:41:17 -0400] Mez: ShawnMcCool: http://docs.opscode.com/essentials_cookbook_lwrp.html might be useful aswell
[2013-04-03 10:41:38 -0400] ShawnMcCool: thanks, pocketed
[2013-04-03 11:00:13 -0400] Mez: Where can I report documentation bugs to ?
[2013-04-03 11:31:52 -0400] asdbla: hi
[2013-04-03 11:32:02 -0400] asdbla: http://tickets.opscode.com/browse/CHEF-3939 I have exactly the same issue
[2013-04-03 11:32:17 -0400] asdbla: after migration databags from old chef to new erchef11
[2013-04-03 11:32:24 -0400] asdbla: any ideas how to fix this?
[2013-04-03 11:38:53 -0400] josqu4red: siXy: reopening Chef::Recipe should do the trick so, but I can't figure out how to call my method in the block
[2013-04-03 11:40:10 -0400] gyre007: guys has anyone here managed to send metrics to Graphite via Sensu from Command line ? I'm trying to figure it out...
[2013-04-03 11:40:34 -0400] iroller: Ohai Chefs. Is there any good way to mask @secret="..." in "Compiled resource" output when chef-client fails to run?
[2013-04-03 11:40:51 -0400] iroller: @secret from encrytped data bag
[2013-04-03 11:46:33 -0400] gyre007: wrong channel...damn :)
[2013-04-03 12:01:16 -0400] BryanWB__: sup sup chefs!
[2013-04-03 12:13:40 -0400] Mez: In chef, I can do node.set_unless['foo']['bar']
[2013-04-03 12:14:08 -0400] Mez: but how can I create a block for that (I want to echo some extra output and save a file if I'm setting that)
[2013-04-03 12:15:31 -0400] Mez: I can use node.attribute?('foo')
[2013-04-03 12:15:55 -0400] Mez: nvm
[2013-04-03 12:41:25 -0400] railsraider: Hi, I'm trying to uninstall using dpkg provdier with action purge but it doesn't remove the package
[2013-04-03 12:41:56 -0400] railsraider:  * package[munin-async] action purge[2013-04-03T12:41:35+00:00] INFO: Processing package[munin-async] action purge (gettaxi_munin::uninstall_async line 22)
[2013-04-03 12:41:56 -0400] railsraider:  (up to date)
[2013-04-03 12:42:55 -0400] railsraider: dpkg -l | grep munin still shows it installed
[2013-04-03 12:44:25 -0400] visit0r: and you gave the resource the :remove action?
[2013-04-03 12:46:54 -0400] railsraider: i gave it :action purge but the dpkg show the status as (rc) remove config file present
[2013-04-03 12:47:02 -0400] Mez: How do I get a recipe to output something to the log ? (or echo to screen?)
[2013-04-03 12:47:04 -0400] railsraider: removed
[2013-04-03 12:47:22 -0400] railsraider: Mez: Chef::Lof.info("hello world")
[2013-04-03 12:47:26 -0400] visit0r: yes
[2013-04-03 12:47:35 -0400] visit0r: you can lamely use Ruby "puts"
[2013-04-03 12:47:37 -0400] railsraider: Chef::Log.info
[2013-04-03 12:47:41 -0400] visit0r: if you so desire
[2013-04-03 12:47:45 -0400] Mez: railsraider: cheers :) (I understood your typo)
[2013-04-03 12:48:07 -0400] railsraider: Mez: you can add vars to the string like in puts
[2013-04-03 12:48:32 -0400] visit0r: railsraider: Which platform are you on?
[2013-04-03 12:48:49 -0400] visit0r: purge: Use to purge a package. This action typically removes the configuration files as well as the package. (Debian platform only; for other platforms, use the :remove action.)
[2013-04-03 12:49:00 -0400] railsraider: ubuntu 10.04 LTS
[2013-04-03 12:49:31 -0400] railsraider: so how do i removed the config on ubuntu?
[2013-04-03 12:49:47 -0400] railsraider: i've installed as apt-get intially
[2013-04-03 12:49:58 -0400] railsraider: i'll try apt-get purge
[2013-04-03 12:50:14 -0400] Mez: railsraider: apt-get remove --purge
[2013-04-03 12:50:32 -0400] railsraider: Mez i want the package resource to do it
[2013-04-03 12:51:17 -0400] Mez: railsraider: I was just ttrying to correct you using  apt-get purge - it's remove --purge
[2013-04-03 12:51:35 -0400] railsraider: yeah that's what i meant mate
[2013-04-03 12:58:33 -0400] maraujop: Hi I'm writing a script resource in which I switch user with "user" however $PATH variable is set to root, even though I'm doing a "source .bashrc" within, any ideas? I'm totally lost
[2013-04-03 12:59:20 -0400] railsraider: maraujop: pastiebin the script
[2013-04-03 13:01:04 -0400] maraujop: railsraider: here it is http://pastebin.com/qnxKWqLN
[2013-04-03 13:02:11 -0400] Mez: maraujop: does the .bashrc set $PATH ?
[2013-04-03 13:02:24 -0400] maraujop: Mez: no, it doesn't
[2013-04-03 13:02:41 -0400] maraujop: Mez: I was expecting Chef to handle that when using the user directive
[2013-04-03 13:03:12 -0400] railsraider: the script runs non interactively which means you must set the PATH in the bashrc as well
[2013-04-03 13:03:30 -0400] Mez: maraujop no. PATH is an environment variable, you're still running in the same environment as Chef is.
[2013-04-03 13:04:17 -0400] maraujop: Ok, I see, so I need to manually handle the environment change, no helper for this?
[2013-04-03 13:04:56 -0400] railsraider: what cookbook do you use for the user creation?
[2013-04-03 13:05:15 -0400] maraujop: railsraider: I'm simply doing a user resource
[2013-04-03 13:06:56 -0400] maraujop: railsraider: why?
[2013-04-03 13:07:54 -0400] Mez: maraujop: a "user" resource won't setup the .bashrc for that user, AFAIK
[2013-04-03 13:08:44 -0400] railsraider: maraujop:  you can set the environment inside the script
[2013-04-03 13:08:50 -0400] railsraider: http://docs.opscode.com/resource_script.html
[2013-04-03 13:08:59 -0400] railsraider: or even path
[2013-04-03 13:09:08 -0400] maraujop: Mez: Well .bashrc file exists
[2013-04-03 13:09:21 -0400] maraujop: railsraider: I'm already setting HOME variable, but I find this quite error prone
[2013-04-03 13:09:25 -0400] Mez: maraujop: that's (I beleive) due to /etc/skel
[2013-04-03 13:09:36 -0400] railsraider: use the enviromenty hash
[2013-04-03 13:09:57 -0400] railsraider: sorry i missed that part you did
[2013-04-03 13:10:05 -0400] maraujop: railsraider: No problem :)
[2013-04-03 13:10:25 -0400] maraujop: I guess I have two options, or add it myself to .bashrc or handle PATH within environment hash
[2013-04-03 13:11:11 -0400] Mez: maraujop: when adduser is called - it creates a home directory based on /etc/skel
[2013-04-03 13:12:18 -0400] Mez: maraujop: why is mkvirtualenv not in PATH for Chef ?
[2013-04-03 13:13:43 -0400] railsraider: maraujop: use these settings in the environment hash http://ayarshabeer.com/
[2013-04-03 13:14:02 -0400] maraujop: Mez: I see, well I'm not sure why mkvirtualenv is not in root PATH
[2013-04-03 13:14:23 -0400] Mez: maraujop: what's the path to mkvirtualenv and whats your PATH setting ?
[2013-04-03 13:14:53 -0400] maraujop: Thanks Mez and railsraider I think I can get this working with all you've explained to me
[2013-04-03 13:14:56 -0400] maraujop: thanks a lot!
[2013-04-03 13:15:05 -0400] Mez: np, glad to be useful
[2013-04-03 13:15:07 -0400] railsraider: np :)
[2013-04-03 13:15:47 -0400] railsraider: so is there no action :remove options "purge" for apt-get provider?
[2013-04-03 13:16:39 -0400] Mez: what do you mean by "apt-get provider" ?
[2013-04-03 13:17:07 -0400] railsraider: the basic pakacge resource
[2013-04-03 13:17:24 -0400] railsraider: isnt apt-get is the default for ubuntu?
[2013-04-03 13:18:31 -0400] Mez: railsraider: yes - but that's the package resource, not the "apt-get provider" - weird terminology.
[2013-04-03 13:18:50 -0400] Mez: package "foo" do
[2013-04-03 13:18:53 -0400] Mez:   action :purge
[2013-04-03 13:18:54 -0400] Mez: end
[2013-04-03 13:19:01 -0400] railsraider: the provider is being selected automatically for package
[2013-04-03 13:19:06 -0400] railsraider: based on the system
[2013-04-03 13:19:22 -0400] railsraider: action :purge will only work on debian
[2013-04-03 13:19:33 -0400] railsraider: should be action :remove for ubuntu
[2013-04-03 13:19:58 -0400] Mez: railsraider: is that an actual error you're getting ?
[2013-04-03 13:20:12 -0400] railsraider: just not sure about this Additional options that are added to the underlying package command
[2013-04-03 13:20:33 -0400] Mez: railsraider: what is your actual problem?
[2013-04-03 13:20:45 -0400] railsraider: no when i do dpkg -l | grep munin-async i see the status as rc meaning removed but config files present
[2013-04-03 13:20:50 -0400] Mez: I seem to have missed the original earlier on - and am jumping in halfway
[2013-04-03 13:20:55 -0400] railsraider: i wanna purge the config too
[2013-04-03 13:21:03 -0400] Mez: then - use action :purge
[2013-04-03 13:21:21 -0400] railsraider: it doesnt work cause im on ubuntu 10.04
[2013-04-03 13:21:30 -0400] railsraider: the purge works just for debian
[2013-04-03 13:21:41 -0400] railsraider: http://docs.opscode.com/resource_package.html
[2013-04-03 13:21:44 -0400] Mez: githubhave you *tried* it ?
[2013-04-03 13:21:51 -0400] Mez: s/github//
[2013-04-03 13:21:56 -0400] railsraider: yes
[2013-04-03 13:22:24 -0400] railsraider: its ok, no worries about the config
[2013-04-03 13:22:32 -0400] railsraider: as long as its removed
[2013-04-03 13:22:58 -0400] Mez: railsraider: then that's a bug that you should report.
[2013-04-03 13:23:12 -0400] Mez: ;purge should work with platform_family debian
[2013-04-03 13:23:16 -0400] Mez: not just platform
[2013-04-03 13:24:53 -0400] Mez: railsraider: weird thing is - any apt_package can be purged.
[2013-04-03 13:25:22 -0400] Mez: The code makes no distinction whether it's debian or ubuntu or what - it just allows purge if it's using apt.
[2013-04-03 13:25:44 -0400] Mez: railsraider: what version are you using?
[2013-04-03 13:26:13 -0400] railsraider: chef server 11.04
[2013-04-03 13:26:21 -0400] railsraider: ubuntu 10.04 is my node
[2013-04-03 13:26:41 -0400] Mez: railsraider: what version of chef-client
[2013-04-03 13:26:42 -0400] Mez: ?
[2013-04-03 13:26:54 -0400] railsraider: varies
[2013-04-03 13:27:08 -0400] railsraider: but 11.4
[2013-04-03 13:27:18 -0400] railsraider: is the one that i tried on
[2013-04-03 13:27:32 -0400] Mez: Can you pastebin the error you got when using action :purge?
[2013-04-03 13:27:44 -0400] railsraider: no error
[2013-04-03 13:27:47 -0400] railsraider: it says removed
[2013-04-03 13:28:04 -0400] railsraider: but when i do dpkg -l  i see rc
[2013-04-03 13:28:10 -0400] railsraider: should be rr
[2013-04-03 13:29:20 -0400] Mez: it should say it was purged... not removed.
[2013-04-03 13:30:07 -0400] Mez: railsraider: and it should just not show rather than show rr :)
[2013-04-03 13:30:48 -0400] railsraider: ok Mez  gonna try purge on a different node now
[2013-04-03 13:31:27 -0400] railsraider: [2013-04-03T13:31:09+00:00] INFO: package[munin-async] purged
[2013-04-03 13:31:44 -0400] railsraider: ok it worked on this one
[2013-04-03 13:32:08 -0400] railsraider: maybe it was my trials that didnt work
[2013-04-03 13:32:13 -0400] railsraider: thanks for the help
[2013-04-03 13:34:14 -0400] Mez: np :)
[2013-04-03 14:36:44 -0400] gamafranco: hi
[2013-04-03 14:36:52 -0400] gamafranco: hi PierreO :)
[2013-04-03 14:37:36 -0400] PierreO: hi gamafranco :)
[2013-04-03 14:37:44 -0400] gamafranco: :)
[2013-04-03 14:40:16 -0400] toioiz: question, we have a ticket open for this, but I figured I would ask if anyone has seen it before. Has anyone seen an instance where lsof reports that chef is holding open 2-3,000 sockets?
[2013-04-03 14:42:20 -0400] geekbri: i have not seen that.  That sounds like a lot of sockets.  How are you running chef-client
[2013-04-03 14:42:41 -0400] geekbri: If it's run as a cron job, maybe you have something hanging and the runs are piling up and holding onto their sockets?
[2013-04-03 14:42:47 -0400] toioiz: it's currently running the chef-client recipe in 'service' mode. it's running on RHEL5.5
[2013-04-03 14:42:56 -0400] toioiz: restarting the service clears them up and it goes down to 5.
[2013-04-03 14:43:16 -0400] geekbri: try looking into the --fork option
[2013-04-03 14:43:23 -0400] toioiz: but it's definately holding open it's old 'out-bound' ports, that were used over 2 months ago
[2013-04-03 14:43:25 -0400] geekbri: depending on what version you are using that is.
[2013-04-03 14:43:39 -0400] toioiz: based on /proc
[2013-04-03 14:43:49 -0400] visit0r: hey guys
[2013-04-03 14:43:55 -0400] visit0r: I was using search in a recipe
[2013-04-03 14:44:03 -0400] visit0r: to try to access a node attribute for another node
[2013-04-03 14:44:45 -0400] visit0r: and I got the following error: TypeError: can't convery String into Integer
[2013-04-03 14:45:02 -0400] visit0r: code was :
[2013-04-03 14:45:20 -0400] visit0r: node = search(:node, 'query)'
[2013-04-03 14:45:28 -0400] visit0r: pust node['fqdn']
[2013-04-03 14:45:42 -0400] kavi: i have installed open chef server, but when i'm login in chef server webui, i'm getting error
[2013-04-03 14:46:18 -0400] toioiz: if that is a copy/paste, you appear to be missing a ' on the other side of query
[2013-04-03 14:46:32 -0400] visit0r: oh, copy paste error, sorry
[2013-04-03 14:46:37 -0400] visit0r: (rather, typing manually)
[2013-04-03 14:54:46 -0400] kavi: anyboy pls advise, for chef serv webui error(we are sorry something went wrong)
[2013-04-03 15:04:03 -0400] techminer: ohai chefs - Is it possible to return only a select set of attributes with 'knife search node 'roles:ROLENAME'?  I'd like to maybe just return the node name, IP, and Roles.
[2013-04-03 15:04:14 -0400] basic`: are there any tricks for bootstrapping a chef server with knife so that I can use things like http://community.opscode.com/cookbooks/omnibus_updater and my firewall recipes on it?
[2013-04-03 15:04:58 -0400] techminer: I could grep out what I want in a different step.just thought maybe I could do it with knife search...
[2013-04-03 15:04:58 -0400] pdignan_w: does specifying the user attribute for the git provider use that user to perform the action or just set the owner of the directory to that user?
[2013-04-03 15:04:59 -0400] chris613: basic`: I bootstrap with a cookbook that includes omnibus_updater via include_recipe
[2013-04-03 15:05:34 -0400] basic`: chris613: perfect
[2013-04-03 15:05:53 -0400] basic`: chris613: have you hit issues with chef_server user vs. chef user?
[2013-04-03 15:06:28 -0400] chris613: basic`: Nope. Note about the updater, though, you won't get the new version until the next run, so it's best to just specify the version you want to the bootstrap command line
[2013-04-03 15:06:31 -0400] djdarkbeat: anyone in here at the #mwrc for devops day?
[2013-04-03 15:07:31 -0400] basic`: okay, i think that makes sense, i'm less concerned about updating the omnibus install and more concerned about getting base packages and firewall recipes on the server
[2013-04-03 15:08:01 -0400] basic`: so as long as there aren't any conflicts or reasons i can't just bootstrap, i'll go ahead with it :)
[2013-04-03 15:12:27 -0400] chris613: basic`: I can't see any reason why not
[2013-04-03 15:13:34 -0400] basic`: chris613: great, i just wanted to check as I hadn't seen documentation that bootstraps the chef server (probably because of hosted chef)
[2013-04-03 15:13:55 -0400] withnale: is it possible to specify a different set of locality rules for a templatE?
[2013-04-03 15:15:30 -0400] dfrey: I'm trying to install Chef Server 10 on Ubuntu 12.10 (Quantal). I am stuck with a dependency error for libyajl-ruby. Anyone know any way around this?
[2013-04-03 15:17:08 -0400] cburroughs: Is there consensus around how to handle multiple data centers?  Google just turns up this inconclusive thread from 2011 http://lists.opscode.com/sympa/arc/chef/2011-06/msg00176.html
[2013-04-03 15:19:38 -0400] dfrey: There is a ticket out, but there haven't been any updates on it. http://tickets.opscode.com/browse/CHEF-3668
[2013-04-03 15:19:38 -0400] toady00: Is it possible to search for an empty attribute? This doesn't work but something like: knife search node "role:''"
[2013-04-03 15:20:22 -0400] withnale: not role:* ?
[2013-04-03 15:20:41 -0400] toady00: no, that would return everything with a role. I want everything without a role set
[2013-04-03 15:22:04 -0400] toady00: googling has let me down, and I'm out of ideas to try
[2013-04-03 15:22:46 -0400] chris613: cburroughs: We handle it with a data bag called 'datacenters
[2013-04-03 15:23:06 -0400] chris613: with an object for each datacenter which holds the dc-specific stuff (mail server to use or whatever)
[2013-04-03 15:23:19 -0400] cburroughs: So one global chef server instance?
[2013-04-03 15:24:15 -0400] withnale: is there no way to override the locality settings when defining a template?
[2013-04-03 15:24:18 -0400] djdarkbeat: devops day is streaming at http://mtnwestrubyconf.org/
[2013-04-03 15:31:09 -0400] visit0r: hey guys, can you set node attributes in the Vagrantfile while using the chef-client provisioner?
[2013-04-03 15:32:02 -0400] adipoli: hii, anyone used chef/knife with vsphere ? please help
[2013-04-03 15:35:40 -0400] dfrey: does anyone know the most recent version of chef 10?
[2013-04-03 15:37:20 -0400] dfrey: i downloaded 10.18.2 directly from opscode but on feb 7 10.20.0 came out. where can i find this?
[2013-04-03 15:39:29 -0400] gleam: omnibus
[2013-04-03 15:39:35 -0400] gleam: or download it directly
[2013-04-03 15:39:37 -0400] toady00: So I got it to work with: knife search node "NOT role:*"
[2013-04-03 15:40:57 -0400] dfrey: gleam: is there a repo other than apt.opscode.com?
[2013-04-03 15:42:06 -0400] gleam: apt.opscode.com is out of date, your only option is to download from opscode.com
[2013-04-03 15:43:33 -0400] dfrey: i can only find Chef 11 at opscode.com
[2013-04-03 15:44:12 -0400] gleam: which platform/server or client?
[2013-04-03 15:45:11 -0400] dfrey: ubuntu 12.10 and server
[2013-04-03 15:45:22 -0400] tomduckering: Hello. I'm having trouble with using knife bootstrap. For some reason it's connecting to the target machine as the provisioner user despite my having specified --ssh-user root. I'm at a loss as to why. Can anyone help?
[2013-04-03 15:45:36 -0400] dfrey: i would install 11 but i'm stuck with a 32 bit arch
[2013-04-03 15:45:43 -0400] gleam: https://opscode-omnitruck-release.s3.amazonaws.com/
[2013-04-03 15:46:04 -0400] gleam: dunno if it's there
[2013-04-03 15:46:22 -0400] gleam: but that's where it would be
[2013-04-03 15:46:26 -0400] geekbri: techminer: you can use the -a flag
[2013-04-03 15:46:35 -0400] geekbri: techminer: so like knife search node "chef_environment:staging" -a fqdn
[2013-04-03 15:46:43 -0400] withnale: toady: wasn't that what I said originally?
[2013-04-03 15:47:18 -0400] geekbri: techminer: you can also method chain the attributes so like knife search node "chef_environment:staging" -a first.second.third
[2013-04-03 15:47:36 -0400] techminer: geekbri:  Ah OKthanks
[2013-04-03 15:47:40 -0400] dfrey: thanks gleam!
[2013-04-03 15:50:51 -0400] pcn_: ohai chefs
[2013-04-03 15:54:48 -0400] dani3113: quick question: After uploading a cookbook, how do i determine which nodes use that cookbook?
[2013-04-03 15:55:44 -0400] techminer: dani3113:  You can use "knife search node 'recipe:RECIPENAME'
[2013-04-03 15:55:54 -0400] dani3113: oh thanks
[2013-04-03 15:56:04 -0400] dani3113: :)
[2013-04-03 15:56:18 -0400] techminer: I just learned that myself :)
[2013-04-03 15:56:34 -0400] dani3113: ah, yeah, i'm still a noob
[2013-04-03 15:56:42 -0400] dani3113: converting chef10 cookbooks to chef11
[2013-04-03 15:58:22 -0400] dani3113: that search doesn't return any nodes for some reason
[2013-04-03 15:58:33 -0400] dani3113: even though i uploaded it
[2013-04-03 15:58:33 -0400] techminer: http://docs.opscode.com/essentials_search_keys.html
[2013-04-03 15:59:01 -0400] techminer: recipe may not be a key.I know "roles" is.you can check the docs to see what will work for you...
[2013-04-03 15:59:34 -0400] dani3113: okay, cool thanks
[2013-04-03 15:59:48 -0400] visit0r: hey guys, can you set node attributes in the Vagrantfile while using the chef-client provisioner?
[2013-04-03 16:00:04 -0400] Mez: visit0r: yes.
[2013-04-03 16:00:36 -0400] Mez: visit0r: it's the chef.json object
[2013-04-03 16:00:42 -0400] Mez: (though I've just done     chef.json.merge!(JSON.parse(File.read("install/solo-dev.json")))
[2013-04-03 16:00:42 -0400] visit0r: i see
[2013-04-03 16:00:44 -0400] visit0r: i tried:
[2013-04-03 16:01:15 -0400] visit0r: chef.json = { "cookbook_name" => { "attribute_name_that_does_not_exist_yet" = "attribute_value" } }
[2013-04-03 16:01:44 -0400] visit0r: and I don't think I saw that attribute on my node object (in the Chef server wub UI)
[2013-04-03 16:02:22 -0400] Mez: visit0r: you're missing a > I think
[2013-04-03 16:02:40 -0400] visit0r: yeah, typo on my part
[2013-04-03 16:02:51 -0400] visit0r: chef.json = { "cookbook_name" => { "attribute_name_that_does_not_exist_yet" => "attribute_value" } }
[2013-04-03 16:03:38 -0400] visit0r: well, it appears it did work
[2013-04-03 16:03:41 -0400] visit0r: i searched via knife and found it
[2013-04-03 16:03:45 -0400] adipoli: hii, anyone used chef/knife with vsphere ? please help
[2013-04-03 16:03:46 -0400] visit0r: just didnt see it in the web UI
[2013-04-03 16:03:52 -0400] visit0r: thanks Mez
[2013-04-03 16:04:42 -0400] cburyta: i'm not sure you would see the attribs in the web-ui, i wonder if it changes the json data _just before_ running chef-client locally i wonder
[2013-04-03 16:05:20 -0400] Mez: Note to self: Don't run the wrong recipe that's going to lock you out from running chef-client
[2013-04-03 16:05:20 -0400] adipoli: hi, anyone used knife-vSphere ?
[2013-04-03 16:05:34 -0400] Mez: (now I gotta wait for half hour for the next chef-client run!)
[2013-04-03 16:05:57 -0400] techminer: adipoli:  I do
[2013-04-03 16:06:17 -0400] techminer: what's the issue?
[2013-04-03 16:08:31 -0400] visit0r: Mez: Have you set node attributes via the Vagrantfile? Not just on a cookbook?
[2013-04-03 16:08:55 -0400] adipoli: techminer: hi , am knife to knife-vsphere, how can i provision a VM in VMware - how to mention its cpu,memory,storage and apply runlists
[2013-04-03 16:09:15 -0400] Mez: visit0r: I didn't set them directly in the Vagrantfile, but I had the vagrantfile pull in a .json file with the attributes in there.
[2013-04-03 16:09:20 -0400] adipoli: techminer: hi , am new to knife-vsphere, how can i provision a VM in VMware - how to mention its cpu,memory,storage and apply runliss
[2013-04-03 16:09:51 -0400] Mez: visit0r: https://gist.github.com/Mezzle/6a6933f6dee10fb0539b
[2013-04-03 16:10:44 -0400] visit0r: Mez: I see, yeah I mean the exacmple I gave above set an attribute of a cookbook. But, I want to set a new (non-existent) attribute on a node in the Vagrantfile
[2013-04-03 16:11:23 -0400] techminer: adipoli:  do you know Ruby?
[2013-04-03 16:11:29 -0400] Mez: visit0r: should work.
[2013-04-03 16:12:02 -0400] visit0r: Mez: okay, yeah it appears to be working, thanks!
[2013-04-03 16:12:49 -0400] techminer: I wrote a custom ruby script for my site that works really well and will show you how knife vsphere works.
[2013-04-03 16:13:08 -0400] adipoli: techminer: yes am a beginner in Ruby!
[2013-04-03 16:13:27 -0400] techminer: K.one sec
[2013-04-03 16:13:49 -0400] adipoli: techminer: but i have been using chef for the past few months with aws ec2 instances
[2013-04-03 16:13:59 -0400] adipoli: techminer: sure
[2013-04-03 16:21:12 -0400] ortho_stice: Random question about the package resource.  We're writing a provider for it (for omnios/IPS) and we're curious about the intdended behavior when the action is :upgrade , and the package is not installed.  Should it error out?  Should it install the package to the specified (or latest) version?
[2013-04-03 16:21:41 -0400] techminer: adipoli:  I'm putting it in a Gist.have to strip or comment out my site specific stuff first though..almost done.
[2013-04-03 16:22:19 -0400] wamcvey: ortho_stice: pretty sure the answer is the latter (install it).  I use action :upgrade in recipes that get run on new hosts and I don't depend on doing an initial :install prior to the :upgrade
[2013-04-03 16:23:24 -0400] ortho_stice: wamcvey: which prover/platform is that, for comparison?
[2013-04-03 16:23:47 -0400] wamcvey: at least the Deb and  RPM ones.
[2013-04-03 16:23:54 -0400] adipoli: techminer: okey when done , please let me know where i can find it !!
[2013-04-03 16:25:03 -0400] wamcvey: I suspect it's the same behavior across all. From an end user standpoint, throwing an error doesn't make any sense. If it isn't installed, and you've asked for the system to upgrade to latest available one, it's obvious that installing the package initially is a required dependency.
[2013-04-03 16:25:47 -0400] ranjibd: morning chefs
[2013-04-03 16:27:17 -0400] ortho_stice: wancvey - agreed - thanks
[2013-04-03 16:35:29 -0400] KarlHungus: are chef 11 migration tools available yet?
[2013-04-03 16:35:45 -0400] rvchef: how can I access the webui console outside the localhost? what files do I have to modify?
[2013-04-03 16:37:01 -0400] techminer: adipoli:  I use this to bootstrap VMware templates that are prepped with a base install and our default root password.  https://gist.github.com/MattMencel/5302820
[2013-04-03 16:39:19 -0400] techminer: It does some interesting stuff with menus and will bootstrap a VMware template into a fully Chef managed running OS very quickly.depending on template size.  It's pretty site specific. but should get you started.
[2013-04-03 16:40:26 -0400] techminer: It's got some custom DHCP stuff that won't work anywhere else.  You can code up your own solution.
[2013-04-03 16:42:02 -0400] techminer: KarlHungus:  http://www.opscode.com/blog/2013/03/12/5106/
[2013-04-03 16:42:31 -0400] techminer: Let me know how it goesI want to upgrade at my site  :)
[2013-04-03 16:44:40 -0400] KarlHungus: techminer: lovely. ty
[2013-04-03 16:44:57 -0400] KarlHungus: i've been meaning to start a blog for a long long time. maybe this will push me over the edge
[2013-04-03 16:45:21 -0400] KarlHungus: also, any fbsd users? want to test my omnibus packages?
[2013-04-03 16:57:08 -0400] toady00: withnale: Sorry, I read your comment wrong. I thought you were asking me: not 'role:*' as opposed to 'not role:*'
[2013-04-03 17:10:19 -0400] context: whats this mean: http://pastie.org/7302597
[2013-04-03 17:10:25 -0400] context: trying to get opsworks on aws working
[2013-04-03 17:11:56 -0400] context: using: https://github.com/zacheryph/clubit-opsworks/tree/master/postgresql
[2013-04-03 17:15:05 -0400] adipoli: techminer: thanksalot, will this work with windows 2008 aswell , because thats what i looking to configure with or is it os independent
[2013-04-03 17:28:15 -0400] adipoli: techminer: can we  create a windows 2008 VM, assign a public IP to it & add to a windows domain using Knife-vSphere chef plugin
[2013-04-03 17:28:29 -0400] adipoli: can we  create a windows 2008 VM, assign a public IP to it & add to a windows domain using Knife-vSphere chef plugn
[2013-04-03 17:28:44 -0400] knuckolls: context: unsure about that specific error, but in general i haven't been too interested in opsworks since I discovered that it's on a really old version of chef. i imagine any modern cookbooks off the shelf are going to have slight incompatibility problems. not sure if that's the problem in this instance, but it's something worth being aware of.
[2013-04-03 17:32:42 -0400] sanguisdex: noob here, gettting a "FATAL: SocketError: Error connecting to https://api.opscode.com/organizations/knectar/clients - getaddrinfo: Temporary failure in name resolution" error, where should I start trouble shooting?
[2013-04-03 17:32:54 -0400] sanguisdex: or what should I read
[2013-04-03 17:33:56 -0400] sanguisdex: ahh I will goto learnchef and ask so yall can take care of big boy questions
[2013-04-03 17:35:13 -0400] miah: dns
[2013-04-03 17:35:22 -0400] miah: getaddrinfo: Temporary failure in name resolution" is very telling
[2013-04-03 17:38:32 -0400] mihasya: I feel like I'm missing something dumb.. is there a way to get knife to unfold cookbook dependencies and download/install the dependencies? I just added a new cookbook, and knife complains when I try to upload it that a dependency isn't being uploaded with it. Do I have to go and install them all one at a time?
[2013-04-03 17:39:39 -0400] miah: you need to use something like berkshelf or librarian to manage cookbook dependencies
[2013-04-03 17:39:53 -0400] mihasya: ah. cool, thanks
[2013-04-03 17:39:56 -0400] sanguisdex: miah: this seems to be on the opscode server side than? nothing I can do about it?
[2013-04-03 17:40:24 -0400] miah: sanguisdex: no, thats your server unable to lookup the domain 'api.opscode.com'. fix your dns.
[2013-04-03 17:40:54 -0400] sanguisdex: miah: I can get to that via the browser
[2013-04-03 17:40:58 -0400] techminer: adipoli:  I'm not an AD expert, but I think you'll have to use some other tool to add it to a domain.  Some sort of post bootstrap script that uses "netdom.ext" maybe?
[2013-04-03 17:41:08 -0400] techminer: netdome.exe
[2013-04-03 17:41:18 -0400] techminer: netdom.exe..sheesh
[2013-04-03 17:41:22 -0400] scalp42: sanguisdex: she meant on the chef server
[2013-04-03 17:41:52 -0400] knuckolls: mihasya: +1 vote for berkshelf. it's cookbook development easy-mode.
[2013-04-03 17:41:53 -0400] EJC: is there a way to change the checksum to be sha1 or md5 instead of sha256? I may not know what I'm doing...
[2013-04-03 17:42:01 -0400] sanguisdex: scalp42: it's a hoested chef server how do I sort that out?
[2013-04-03 17:42:14 -0400] sanguisdex: hosted*
[2013-04-03 17:42:23 -0400] mihasya: knuckolls i had read about it, didn't realize that I had to use something like that just to get cookbook dependencies resolved
[2013-04-03 17:42:35 -0400] mihasya: doing very basic stuff here at the moment, if you can't tell :)
[2013-04-03 17:42:40 -0400] scalp42: sanguisdex: sorry never used hosted one :/
[2013-04-03 17:42:53 -0400] sanguisdex: scalp42: no wories
[2013-04-03 17:43:29 -0400] knuckolls: mihasya: yeah during the chef-run it's just going to resolve dependencies based on the cookbooks it's been handed if it's chef-solo, or the cookbooks that happen to have been uploaded to the server if it's chef-server.
[2013-04-03 17:43:30 -0400] miah: sanguisdex: your browser is not your node, or server.
[2013-04-03 17:43:57 -0400] knuckolls: mihasya: traditionally, i had to upload all the damn dependencies 1 by 1. berkshelf abstracts that away.
[2013-04-03 17:44:00 -0400] miah: make sure you are performing your test from where the problem is occuring: debugging problems 101
[2013-04-03 17:44:50 -0400] miah: 'dig api.opscode.com' or 'nslookup api.opscode.com' from the node where you cannot connect to the api will probably help you find the issue
[2013-04-03 17:45:59 -0400] mihasya: hrrmm now knife cookbook install git is saying not found, even though http://community.opscode.com/cookbooks/git
[2013-04-03 17:46:05 -0400] mihasya: err download, not install
[2013-04-03 17:46:44 -0400] mihasya: ohhh i'm being dense
[2013-04-03 17:46:45 -0400] mihasya: nm
[2013-04-03 17:47:38 -0400] sanguisdex: miah: so I should shell into the vagrant box  check from there? I am just trying to follow bloody https://learnchef.opscode.com/quickstart/converge/
[2013-04-03 17:47:41 -0400] knuckolls: mihasya: yeah i think you're looking for `knife cookbook site download`. i never use that though.
[2013-04-03 17:47:58 -0400] mihasya: knuckolls looks like berkshelf is gonna have to come sooner than I had expected
[2013-04-03 17:48:01 -0400] miah: sanguisdex: yes, indeed. thats where the problem is.
[2013-04-03 17:48:13 -0400] mihasya: (also WHAT IS UP MAN!)
[2013-04-03 17:49:22 -0400] knuckolls: mihasya: heh i just started over getting chef going at my new gig. this time around i'm doing berkshelf from the ground up and i really do think it's the way to go. this video took me from "eh looks cool but i'll have to figure it out" to "oh god it's so easy i'll do it right now" http://www.ustream.tv/recorded/27487546/highlight/309841
[2013-04-03 17:49:56 -0400] miah: if you've ever used bundler its essentially the same
[2013-04-03 17:50:10 -0400] mihasya: i watched a talk by the berkshelf guy, it makes sense. I had just never done it the "other way" before and I'm.. shocked  :)
[2013-04-03 17:50:37 -0400] matti: Shock.
[2013-04-03 17:50:38 -0400] mihasya: first time actually building up a chef repo myself, so just feeling my way around
[2013-04-03 17:50:39 -0400] mihasya: anyway, bbl
[2013-04-03 17:52:01 -0400] jclark__: Anyone have any advice on integrating ldap into the community version of chef server?
[2013-04-03 18:01:04 -0400] jrcloud: Anyone else seeing Errno::ECONNRESET: Connection reset by peer  frequently on chef 11 server?
[2013-04-03 18:01:10 -0400] jrcloud: I've upgraded and now I'm seeing this intermittenly.
[2013-04-03 18:03:01 -0400] sanguisdex: miah: FYI I had to bridge my vagrant box
[2013-04-03 18:03:03 -0400] sanguisdex: thanks
[2013-04-03 18:07:51 -0400] miah: np
[2013-04-03 18:08:17 -0400] Toger: If I have cookbook AAA, which has a library that defines module BBB, which contains method CCC; how do I reference that method in abother cookbook?
[2013-04-03 18:08:37 -0400] adipoli: techminer: okey , :-)
[2013-04-03 18:13:11 -0400] miah: Toger: 'depends' then use it.
[2013-04-03 18:13:56 -0400] Toger: miah: got the depends; but im unclear on the actual way to reference it. Do I say AAA::BBB.CCC, ::BBB.CCC, etc, ?
[2013-04-03 18:14:20 -0400] mdevolving: hi, a question about encrypted data bags in recipes
[2013-04-03 18:14:44 -0400] miah: if your method is named 'foo' then invoke 'foo'
[2013-04-03 18:14:53 -0400] mdevolving: what is a safe way to write a password to a file without using a template? as in, the password should be the only thing in the file
[2013-04-03 18:17:19 -0400] yfeldblum: mdevolving, in what way is that a question about "encrypted data bags in recipes"
[2013-04-03 18:17:28 -0400] yfeldblum: mdevolving, and what do you mean by "safe"?
[2013-04-03 18:17:40 -0400] Toger: ah found it, I needed a a class / include as a recipe in AAA which then exposes it
[2013-04-03 18:17:43 -0400] mdevolving: as in, won't show up in logs or anything silly like that
[2013-04-03 18:19:44 -0400] mdevolving: i.e. a template with variables(:password => Chef::EncryptedDataBagItem.load("foo", "var")['password'])
[2013-04-03 18:20:06 -0400] mdevolving: i can't find any examples of this, thus i am asking #chef
[2013-04-03 18:21:45 -0400] mdevolving: also, if it's not stored in the cache, that would be great
[2013-04-03 18:22:48 -0400] yfeldblum: mdevolving, with normal ruby code, using Pathname#stat, Pathname#read, Pathname#write, FileUtils.chmod, FileUtils.chown, etc
[2013-04-03 18:23:49 -0400] mdevolving: ok, so bypass chef resources entirely? hadn't thought of that
[2013-04-03 18:24:18 -0400] mdevolving: thanks yfeldblum
[2013-04-03 18:24:22 -0400] yfeldblum: mdevolving, and if you need the checks and the actions to happen at converge time rather than compile time, then you can put the checks inside guards and put the the actions into ruby_block blocks
[2013-04-03 18:26:21 -0400] mdevolving: i was wary of using execute because it may show up in logs or stacktraces
[2013-04-03 18:27:03 -0400] mdevolving: but then, the entire cache is root-owned read-protected, so i guess it's kind of moot
[2013-04-03 18:27:08 -0400] yfeldblum: mdevolving, don't use execute
[2013-04-03 18:27:18 -0400] yfeldblum: mdevolving, just use normal ruby code
[2013-04-03 18:28:57 -0400] yfeldblum: mdevolving, specifically the check methods and action methods i listed above
[2013-04-03 18:29:08 -0400] miah: you could also just generate the content and pass it to 'file'
[2013-04-03 18:29:21 -0400] miah: the file resource has a 'content' attribute and that data is rendered to the output file
[2013-04-03 18:29:25 -0400] miah: no need for a template
[2013-04-03 18:29:33 -0400] yfeldblum: miah, no controlling whether chef prints the content to the log
[2013-04-03 18:30:04 -0400] miah: i dont think it does
[2013-04-03 18:30:51 -0400] yfeldblum: miah, or to the console; also, chef does print to the console
[2013-04-03 18:31:08 -0400] yfeldblum: miah, i use `file` resource with `content` attribute plenty of times
[2013-04-03 18:31:34 -0400] yfeldblum: miah, and chef will absolutely show you the diff if it changes the file
[2013-04-03 18:32:56 -0400] royaldvl: i'm using the opscode cobbler cookbook, but i need to add a verification check (cobbler check) to ensure it installed properly.  any tips?
[2013-04-03 18:52:17 -0400] tomsthumb: hi, I _think_ that when running knife rackspace server list my plugin is throwing an exception because it is trying to show (incomplete) information for nodes that do not show up in knife client list or knife node list.  is it possible that i have done something bizzare to get data mixed up between these different things?
[2013-04-03 18:52:49 -0400] tomsthumb: also, is there a way to double check what opscode is seeing against what it shows me in particular circumstances?
[2013-04-03 19:01:23 -0400] visit0r: I was wondering if someone could help me with attributes and node searches
[2013-04-03 19:01:31 -0400] visit0r: I have a client/server model install
[2013-04-03 19:01:46 -0400] visit0r: and I install the server first, and want to make his pulic SSH key searchable (via node attributes)
[2013-04-03 19:02:03 -0400] visit0r: and I want the client install to search for that node and read the SSH public key and store that in the authorized_keys file on the client
[2013-04-03 19:02:07 -0400] visit0r: so SSH works out of the box
[2013-04-03 19:07:30 -0400] btm: @opscode chef code review, join: http://bit.ly/XqdJSG, watch: http://youtu.be/Jy6piqCPuVk
[2013-04-03 19:13:04 -0400] jrcloud: Anyone seeing connection refused to rabbit mq using chef server 11.4?
[2013-04-03 19:13:56 -0400] dfrey: does anyone know where knife uploads cookbooks to?
[2013-04-03 19:15:49 -0400] billyoung: @dfrey, its configured in knife.rb
[2013-04-03 19:15:50 -0400] billyoung: cookbook_path
[2013-04-03 19:24:23 -0400] wamcvey: billyoung: that's where they are loaded *from*.   dfrey: when you 'knife cookbook upload' you're loading the cookbook to the server.  Are you asking where on the server those bits reside?
[2013-04-03 19:30:13 -0400] visit0r: Does anyone know if certain attributes files are only loaded when certain recipes are run?
[2013-04-03 19:30:27 -0400] visit0r: or if any recipe in a cookbook is run, are all attribute files loaded again?
[2013-04-03 19:30:38 -0400] visit0r: like the opscode jenkins cookbook
[2013-04-03 19:30:43 -0400] visit0r: has default, node, and server
[2013-04-03 19:30:50 -0400] visit0r: the server sets the server node name to be node
[2013-04-03 19:30:55 -0400] visit0r: node['fqdn']
[2013-04-03 19:31:15 -0400] visit0r: and the node attributes file sets the node name to be node['fqdn']
[2013-04-03 19:31:33 -0400] visit0r: if those were loaded on both the server and the node, then both node names would be the same right?
[2013-04-03 19:41:54 -0400] dfrey: wamcvey: yes, i was wondering where on the server the cookbooks end up
[2013-04-03 19:43:22 -0400] context: anyone know of any opsworks related guides to different stuff out ther e:x
[2013-04-03 19:43:46 -0400] wamcvey: dfrey: assuming your server is the opensource server (and not hosted chef), I imagine they end up in the server's postgresql tables (if your server is 11.x) or CouchDB (if you're server is 10.x).
[2013-04-03 19:44:12 -0400] Majost: can you send a notifies to a template resource?
[2013-04-03 19:45:51 -0400] dfrey: wamcvey: ok, i assumed they would end up in my chef repo located on the server. thanks for the heads up. i am using opensource
[2013-04-03 19:47:05 -0400] wamcvey: dfrey: your repo?  As in your git repo?  There really is no strong binding between git and chef other than git provides a useful collaborative revision control and development workflow.
[2013-04-03 19:49:37 -0400] dfrey: wamcvey: no, my chef repo aka my chef folder containing my cookbooks and environments etc. so that folder does not exist on the server? instead all of the info is held in the db?
[2013-04-03 19:51:44 -0400] wamcvey: dfrey: Yeah. You see a filesystem of files and such cause that's a convienient way of organizing files for a human. The server gets blobs of objects uploaded to it and it stores the content of those objects in its  datastore (CouchDB/postgresql).
[2013-04-03 19:53:00 -0400] arghhhhh: can anyone point me in the direction of some information on how to install a gem from github using chef please?
[2013-04-03 19:54:01 -0400] dfrey: wamcvey: well that helps me understand why my filesystem isnt loading automatically. thanks!
[2013-04-03 19:55:47 -0400] wamcvey: dfrey: no prob... I ask so many questions on here myself, it's nice to actually know one of the answers and be able to help someone else out.  A nice little role reversal from the norm. ;-)
[2013-04-03 19:55:55 -0400] mdevolving: thanks again yfeldblum, i came up with this http://pastebin.com/tVLmfXy8
[2013-04-03 19:56:00 -0400] dfrey: arghhhhh: you could try the execute resource http://docs.opscode.com/resource_execute.html
[2013-04-03 20:02:43 -0400] btm: @opscode Cookbook code review, join: http://bit.ly/Z2oXYH, watch: http://youtu.be/dPufM_u5UCc
[2013-04-03 20:03:37 -0400] yfeldblum: mdevolving, right
[2013-04-03 20:04:14 -0400] btm: arghhhhh: use remote_file to download the gem: http://docs.opscode.com/resource_remote_file.html then use gem_package with a source attribute to install it from disk: http://docs.opscode.com/resource_package.html
[2013-04-03 20:05:37 -0400] kklimonda: hmm, why would search(:node, "role:xyz") return nil, but $ knife search 'role:xyz' returned result? How can I debug it?
[2013-04-03 20:06:31 -0400] arghhhhh: @btm Yeah that looks like the best option, shame gem_package doesn't support it directly as i would think it is quite common
[2013-04-03 20:10:09 -0400] btm: arghhhhh: I think you can put a url in the source attribute to gem_package and it'll work. Personally, I think that starts overloading gem_package. there's features in providers written for downloading files to help make them more idempotent, two resources should be doing the same thing.
[2013-04-03 20:11:42 -0400] arghhhhh: the source attribute needs to be local i think, coming from bundler I'm used to specify gem and source in one command
[2013-04-03 20:17:01 -0400] helllen: helllo
[2013-04-03 20:17:01 -0400] Harveste`: ohai! I have a set of templates I'm going to be processing with Chef 11. There are hundreds of values that need to be populated. I have the values stored in JSON files at the moment. What is the best way to read those in so they can be used in the templates?
[2013-04-03 20:17:31 -0400] helllen: I would like to search all nodes has one role assigned
[2013-04-03 20:17:39 -0400] helllen: search(:node, "*:*") -> search all nodes
[2013-04-03 20:18:05 -0400] helllen: how do I limit to the one has specific role in their list ?
[2013-04-03 20:19:08 -0400] techminer: helllen:  knife search node 'roles:ROLENAME'
[2013-04-03 20:19:29 -0400] helllen: I would like to do it into recipie :-D
[2013-04-03 20:20:12 -0400] wdilly: can somebody help me understand why I get this error: NoMethodError ------------- undefined method `length' for nil:NilClass when attempting to use this opscode site cookbook, https://github.com/opscode-cookbooks/openldap/blob/master/attributes/default.rb (NOTE line 22)
[2013-04-03 20:21:37 -0400] yfeldblum: mdevolving, i was thinking of something like this: http://pastie.org/pastes/7304949/text?key=pyztc5k2kql2dljgjfkqg
[2013-04-03 20:22:27 -0400] kklimonda: helllen: I think it should be search(:node, 'role:your-role') but I can't get it to work ;)
[2013-04-03 20:22:29 -0400] yfeldblum: mdevolving, because it will avoid marking the ruby_block resource as updated if there's nothing to change
[2013-04-03 20:22:33 -0400] techminer: helllen:  http://docs.opscode.com/essentials_search_targets.html
[2013-04-03 20:23:14 -0400] ranjibd: wdilly: the node dont have a domain set
[2013-04-03 20:23:50 -0400] ranjibd: helllen: search(:node,"roles:foo") should work
[2013-04-03 20:24:04 -0400] helllen: thanks
[2013-04-03 20:24:07 -0400] helllen: I try :-D
[2013-04-03 20:24:21 -0400] wdilly: ranjibd: where do i define that?
[2013-04-03 20:24:51 -0400] mdevolving: yfeldblum: to secure compare, perhaps md5sum both sides?
[2013-04-03 20:24:52 -0400] yfeldblum: mdevolving, http://pastie.org/pastes/7304986/text?key=fljnw45ucliieiecmx3xzq   <--fixed a typo
[2013-04-03 20:24:53 -0400] geekbri: Anybody here using the java cookbook to install openJDK on ubuntu 12.04?
[2013-04-03 20:25:03 -0400] geekbri: It looks like it sets JAVA_HOME incorrectly, just looking to verify others are seeing this issue as well
[2013-04-03 20:25:23 -0400] geekbri: BryanWB: Looks like maybe the java cookbook sets JAVA_HOME wrong on ubuntu 12.04
[2013-04-03 20:25:26 -0400] ranjibd: wdilly:  i think its an automatic attribute .. obtained from ohai,, check if `hostname -f` is working on your instance
[2013-04-03 20:25:36 -0400] BryanWB: geekbri, fuck
[2013-04-03 20:25:48 -0400] BryanWB: ranjibd, sup homez
[2013-04-03 20:26:03 -0400] yfeldblum: mdevolving, i was thinking https://github.com/rails/rails/blob/v3.2.13/activesupport/lib/active_support/message_verifier.rb#L58-L67
[2013-04-03 20:26:05 -0400] geekbri: BryanWB: Oh looks like you have comitted to this CB in a while, I should probably go through the proper channels for a fix :-P
[2013-04-03 20:26:12 -0400] ranjibd: BryanWB: having a blast at pagerduty :-p
[2013-04-03 20:26:25 -0400] drgage: hi, how do i correctly say "if this node is a member of role foo, output bar" in a template? i'm struggling with syntax.
[2013-04-03 20:26:27 -0400] geekbri: I met two pager duty dudes last weekend.  They were nice.
[2013-04-03 20:26:30 -0400] BryanWB: geekbri, heh, not for about 8 months :)
[2013-04-03 20:26:32 -0400] wdilly: hostname -f isnt but "hostname" returns properly
[2013-04-03 20:26:49 -0400] yfeldblum: mdevolving, but it's not necessary; you are comparing text to a secret, but you're probably not comparing attacker-chosen text to the secret as a public network service with no ratelimits
[2013-04-03 20:27:03 -0400] ranjibd: drgage: node.attributexx if node.roles.include?('xxx')
[2013-04-03 20:27:09 -0400] geekbri: BryanWB: Yeah looks like open JDK and the JRE HEADLESS doesn't use /usr/lib/jvm/default-java anymore :)
[2013-04-03 20:27:25 -0400] ranjibd: geekbri: you are in SF?
[2013-04-03 20:27:28 -0400] wdilly: ranjibd: i have added in my specific info in the two lines  default['openldap']['basedn'] = "dc=localdomain" default['openldap']['server'] = "ldap.localdomain"
[2013-04-03 20:27:33 -0400] geekbri: ranjibd: I'm not, but I was at monitorama
[2013-04-03 20:27:40 -0400] drgage: ranjibd that doesn't look like template syntax? needs <%= or something?
[2013-04-03 20:27:42 -0400] wdilly: ranjibd: thats the only change ive made to the file
[2013-04-03 20:27:46 -0400] yfeldblum: mdevolving, it's not necessary *this time* but it is necessary to use a constant-time comparison method in many other cases
[2013-04-03 20:28:00 -0400] geekbri: ranjibd: I met the founder and whomever was with him (somebody from the ops team i believe)
[2013-04-03 20:28:04 -0400] ranjibd: drgage: you can pass that stuff in the template resource as a variable, from the recipe
[2013-04-03 20:28:13 -0400] ranjibd: and use that variable in the template
[2013-04-03 20:28:16 -0400] mdevolving: ok, thanks for the clarification yfeldblum
[2013-04-03 20:28:17 -0400] yfeldblum: mdevolving, also we no longer use md5 in a security context
[2013-04-03 20:28:37 -0400] drgage: ranjibd ok, is that recommended vs having a conditional in the template? the latter seemed more clear to me.
[2013-04-03 20:28:38 -0400] ranjibd: or use directly in the template, using the <% %>  (without the =)
[2013-04-03 20:28:41 -0400] yfeldblum: mdevolving, definitely not for new stuff; and we don't use sha1 in a security context either
[2013-04-03 20:28:44 -0400] drgage: ok
[2013-04-03 20:28:44 -0400] ranjibd: but thats considered bad
[2013-04-03 20:29:03 -0400] drgage: huh. got a style reference?
[2013-04-03 20:29:16 -0400] drgage: i mean, where should i learn more about why it's bad
[2013-04-03 20:29:20 -0400] ranjibd: geekbri: James and alex probably
[2013-04-03 20:29:36 -0400] geekbri: ranjibd: sounds about right. I have their business carsd laying around somewhere.  I certainly wore my pager duty tshirt running the other day :-P
[2013-04-03 20:29:45 -0400] yfeldblum: mdevolving, anyway can you see what i was going for in my snippet based on your snippet?
[2013-04-03 20:30:03 -0400] ranjibd: :-) nice
[2013-04-03 20:31:00 -0400] mdevolving: yfeldblum: i see that it uses chef keywords for the logic, but i don't quite understand the benefit. something to do with chef's awareness of what resources have actually passed their conditions and been run?
[2013-04-03 20:31:16 -0400] geekbri: BryanWB__: Looks like you were aware of it at one point or another ;) http://tickets.opscode.com/browse/COOK-1626
[2013-04-03 20:31:24 -0400] spicy: are the opscode apt repos going to go away in favor of omnibus?
[2013-04-03 20:31:35 -0400] yfeldblum: mdevolving, right that is one benefit which will become more apparent as you use chef more
[2013-04-03 20:32:31 -0400] KarlHungus: spicy: i expect they'll just deliver the omnibus debs if they dont already
[2013-04-03 20:32:31 -0400] yfeldblum: mdevolving, i also moved the part about fetching the data into the recipe top-level, so that it happens at recipe compile time and not converge time
[2013-04-03 20:33:01 -0400] spicy: KarlHungus: i think there are some on S3 already, linked from the download page
[2013-04-03 20:33:16 -0400] mdevolving: ok yfeldblum, that's another thing i'm not sensitive to yet, but just from that sentence i think i understand it a little better :)
[2013-04-03 20:33:18 -0400] spicy: i guess i need to figure out of i want to use omnibus or not going forward
[2013-04-03 20:33:24 -0400] KarlHungus: spicy: you do.
[2013-04-03 20:33:27 -0400] ranjibd: drgage: generally templates should be without any logic.. for readability and various other reasons.. logic should be inside the recipe or libraries.. keep the templates as closest to the actual config file as possible and just pass the data to it..it also helps in testing
[2013-04-03 20:33:40 -0400] KarlHungus: we run our own omnibus builds at $work
[2013-04-03 20:33:50 -0400] KarlHungus: its rock solid
[2013-04-03 20:34:18 -0400] spicy: does omnibus install the upstard/init scripts and such?
[2013-04-03 20:34:23 -0400] spicy: *upstart
[2013-04-03 20:34:33 -0400] drgage: ranjibd, thanks. my template works now!
[2013-04-03 20:35:51 -0400] jtimberman: spicy: i said this earlier: http://community.opscode.com/chat/chef#id-327347
[2013-04-03 20:35:55 -0400] jtimberman: re apt repo
[2013-04-03 20:36:26 -0400] helllen: ranjibd, worker
[2013-04-03 20:36:27 -0400] helllen: thanks
[2013-04-03 20:36:29 -0400] jtimberman: omnibus doesn't put anything on the filessytem except /opt/chef. it's up to you to tell chef its config, which service management system to use, etc.
[2013-04-03 20:36:36 -0400] jgoulah: can i override a roles override_attribute on the node level?
[2013-04-03 20:36:46 -0400] jtimberman: we have the chef-client cookbook for managing that, and knife bootstrap can do initial configuration
[2013-04-03 20:36:48 -0400] KarlHungus: jtimberman: and its gorgeous :)
[2013-04-03 20:37:11 -0400] jtimberman: :)
[2013-04-03 20:37:38 -0400] spicy: jtimberman: okay, thanks for the info! should have checked the backlog apparently :)
[2013-04-03 20:37:52 -0400] c_t: you know
[2013-04-03 20:38:08 -0400] c_t: I just realized that omnibus should have been installed in /yak/chef
[2013-04-03 20:38:17 -0400] spicy: i've started at a new job to deploy chef, at my previous job we had used the apt method
[2013-04-03 20:38:46 -0400] spicy: but setting up the service management using recipes makes more sense, i think
[2013-04-03 20:38:52 -0400] jtimberman: :)
[2013-04-03 20:38:54 -0400] ranjibd: im pretty sure in my next job i'll just use telepathy to install chef
[2013-04-03 20:39:12 -0400] KarlHungus: ranjibd: chef will probably install you into the next job
[2013-04-03 20:39:23 -0400] jtimberman: ranjibd: i think that's a chef 13 release feature! ;)
[2013-04-03 20:39:24 -0400] spicy: haha, likely
[2013-04-03 20:39:25 -0400] ranjibd: :-) possible
[2013-04-03 20:40:16 -0400] dfrey: anyone know why "knife upload cookbooks/" is working but "knife uploads environments/" doesn't upload my environments?
[2013-04-03 20:40:27 -0400] dfrey: upload*
[2013-04-03 20:40:36 -0400] ranjibd: knfie upload from file
[2013-04-03 20:41:33 -0400] ranjibd: dfrey: sorry, knife environment from file environments/name.rb
[2013-04-03 20:42:01 -0400] ranjibd: it can take * also.. and use the bash expansion for mass uploads
[2013-04-03 20:42:30 -0400] dfrey: nice
[2013-04-03 20:43:04 -0400] jgoulah: let me ask another way: i have override_attributes set on a role,  and i actually need one node to override a key in there, is that possible?
[2013-04-03 20:43:31 -0400] dfrey: ranjibd: i'm getting ERROR: ArgumentError: wrong number of arguments (1 for 2
[2013-04-03 20:43:53 -0400] jgoulah: looks like maybe according the order or precendence i can do "Forced override attributes applied on a node directly in a recipe" ?
[2013-04-03 20:44:41 -0400] dfrey: according to the docs it should be "knife environment create|edit from file environments/env.rb" but this doesn't load from the file, it just creates a new env
[2013-04-03 20:45:14 -0400] ranjibd: dfrey: can you paste the entire command you are tying ?
[2013-04-03 20:45:16 -0400] yfeldblum: jtimberman, http://pastie.org/pastes/7304986/text?key=fljnw45ucliieiecmx3xzq <--- style
[2013-04-03 20:45:30 -0400] dfrey:  knife environment from file environments/dev.rb
[2013-04-03 20:45:59 -0400] helllen: with search(:node,"roles:foo")  how the elements are sort ?
[2013-04-03 20:46:45 -0400] mdevolving: yfeldblum: one more nit, chmod needs an int instead of a string
[2013-04-03 20:47:07 -0400] yfeldblum: mdevolving, right
[2013-04-03 20:47:15 -0400] yfeldblum: mdevolving, heh i just typed it up; i didn't try running it
[2013-04-03 20:47:53 -0400] ranjibd: helllen: not sure. but its an array and can be sorted anyway you want
[2013-04-03 20:48:23 -0400] mdevolving: i preciate it yfeldblum, will be blogging about this since i couldn't find a good answer
[2013-04-03 20:48:35 -0400] ranjibd: search(:nodes,"*:*").sort{|n1,n2|n1.name <=> n2.name} will sort by node names, lexically
[2013-04-03 20:48:59 -0400] yfeldblum: mdevolving, cool
[2013-04-03 20:53:29 -0400] bluekelp: i have two roles that both add the same recipe in their run_lists - an attribute determines the difference in behavior.  am i correct in assuming that chef will run the recipe only once during a chef-client run?
[2013-04-03 20:54:57 -0400] dfrey: bluekelp: does the node have both roles?
[2013-04-03 20:55:18 -0400] bluekelp: dfrey: yes. i meant to convey that
[2013-04-03 20:56:07 -0400] jessicab: bluekelp: isnt that on the list of things they fixed in chef 11? i vaguely remember that being one of the changes.. that now a recipe will only run once
[2013-04-03 20:56:10 -0400] dfrey: bluekelp: i'm not sure, but i wouldn't assume that until you can prove it
[2013-04-03 20:56:17 -0400] jgoulah: see, nobody understands attribute precendence ;)
[2013-04-03 20:56:23 -0400] jgoulah: otherwise someone would answer me
[2013-04-03 20:56:53 -0400] bluekelp: jessicab: thanks i'll research.
[2013-04-03 20:57:17 -0400] bluekelp: jgoulah: i believe you can set attributes directly on nodes.  there is a precedence chart: http://docs.opscode.com/essentials_cookbook_attribute_files_attribute_precedence.html
[2013-04-03 20:57:24 -0400] dfrey: is chef 11 really only for 64-bit boxes?
[2013-04-03 20:57:58 -0400] jgoulah: yup i've been looking at that bluekelp
[2013-04-03 20:58:04 -0400] jgoulah: and yes you can set them on nodes
[2013-04-03 20:58:12 -0400] jgoulah: its just that i have to override and override on a role :)
[2013-04-03 20:58:18 -0400] jgoulah: i think the answer is forced attrib in the recipe
[2013-04-03 20:58:29 -0400] jgoulah: just have to figure out the syntax for that
[2013-04-03 20:59:11 -0400] KarlHungus: dfrey: no
[2013-04-03 21:00:52 -0400] bluekelp: jgoulah: do they need to be overide attrs in the role?  given precedence would it be possible to have them be default attrs in the role so the override attrs for the node overwrite?  still trying to visually scan to get your whole thread
[2013-04-03 21:01:43 -0400] jgoulah: that is a really great question, why are they override in the role, have to ask whoever set that up
[2013-04-03 21:02:34 -0400] bluekelp: roles will override default attrs of recipes and nodes so you might be able to get the same (Current) effect by making them role default attrs and allow you to override in nodes/recipes.  hope this works for you
[2013-04-03 21:03:05 -0400] jgoulah: bluekelp: it makes sense, i will see thanks
[2013-04-03 21:03:20 -0400] jgoulah: if not any clue how to set forced attributes on a node in the recipe?
[2013-04-03 21:04:20 -0400] jessicab: jgoulah: pretty sure forced attributes only work on chef 11 btw
[2013-04-03 21:05:07 -0400] bluekelp: i've never done but looks like "node.force_override[:foo][:bar] = 'bat'"
[2013-04-03 21:05:38 -0400] jgoulah: jessicab: oh so close
[2013-04-03 21:05:39 -0400] jgoulah: bluekelp: thanks
[2013-04-03 21:12:10 -0400] silk: Is there a more 'correct' way to determine whether you are running an omnibus install or normal / old install, other than looking at node.chef_packages.chef.chef_root ?
[2013-04-03 21:13:41 -0400] yfeldblum: silk, def chef_embedded? ; Gem.bindir =~ %r< /opt/(opscode|chef)/embedded/bin >x ; end
[2013-04-03 21:15:14 -0400] jessicab: hm.. is there some reason why a recipe would work just fine if i run it when i ssh in and run chef-client, but if i try to run it through knife bootstrap or knife ssh it doesnt start a service correctly? it does start it and it passes minitest, but it dies right when chef dies if i run it remotely
[2013-04-03 21:19:31 -0400] bluekelp: jessicab: sounds vagely like a process group or tty issue but different. i ran into something similar and just did it manually. had to move on due to lack of time to research
[2013-04-03 21:19:42 -0400] knuckolls: jessicab: i've only had this happen once in the past and it had to do with something I didn't fully understand about process groups. Specifically it was when I was working with the rabbitmq cookbook. It would show that it had started the init script, which forked off the daemon process but the daemonized service would be killed the moment the chef-client process ended. This had in some way to do with process groups, and i found
[2013-04-03 21:19:42 -0400] knuckolls:  that if i used the setsid command to force the init script to run in it's own process group that it worked fine. All that to say, in your service resource, try appending setsid to the command.
[2013-04-03 21:20:06 -0400] knuckolls: you may have to install the setsid command on the system first. i can't remember what package it was in
[2013-04-03 21:21:47 -0400] bluekelp: jessicab: can you set it up to run with runsv/runit? it should take care of the pgroup/daemonizing stuff
[2013-04-03 21:22:02 -0400] jessicab: oh interesting, yea.. that makes sense, ill try sending it
[2013-04-03 21:22:03 -0400] ranjibd: the forked process must detach from its parent and reattach to init
[2013-04-03 21:22:54 -0400] ranjibd: thats a true daemon. whose ppid is 1
[2013-04-03 21:22:58 -0400] jessicab: id kind of rather not use runsv/runit if i can avoid it, its something thatll be used by a few groups and im trying to keep the dependancies down really
[2013-04-03 21:23:06 -0400] silk: yfeldblum; thx. Can that just be dropped into a common cookbooks libraries?
[2013-04-03 21:23:23 -0400] knuckolls: jessicab: setsid should solve it, if it is indeed a process group problem
[2013-04-03 21:23:42 -0400] bluekelp: jessicab: if you have control over the proc that's run you can do the "proper" damonization inside it as well.  but setsid(1) might be a quick fix
[2013-04-03 21:24:49 -0400] yfeldblum: sure
[2013-04-03 21:31:16 -0400] redf0x_: hey guys
[2013-04-03 21:32:09 -0400] redf0x_: I'm quite new to chef and I'm playing around with a local setup
[2013-04-03 21:33:22 -0400] redf0x_: when i try to download cookbooks from chef-server i get: Exception: NoMethodError: undefined method `manifest' for #<Hash:0x007faa5bd21038>
[2013-04-03 21:34:04 -0400] jessicab: knuckolls: sweet, that totally solved it.. thanks!
[2013-04-03 21:34:42 -0400] redf0x_: seems to be a problem in the cookbook-download.rb: /Users/Dale/.rvm/gems/ruby-2.0.0-p0/gems/chef-11.0.0/lib/chef/knife/cookbook_download.rb:69:in `run': undefined method `manifest' for #<Hash:0x007fa5bc5ba130> (NoMethodError)
[2013-04-03 21:35:18 -0400] knuckolls: jessicab: awesome. when i ran up against that problem it was a solid 6 hours of awful debugging to figure out what was going on. i didn't even know process groups existed.
[2013-04-03 21:35:22 -0400] knuckolls: glad to save you from that. :)
[2013-04-03 21:35:29 -0400] redf0x_: any ideas what's going wrong?
[2013-04-03 21:38:11 -0400] redf0x_: would be nice if someone could point me in the right direction
[2013-04-03 21:40:25 -0400] jessicab: redf0x_: dunno how stable chef 11 is these days, you could try downgrading to 10.24 if youre not using 11 a lot? or upgrade to a more recent version of 11
[2013-04-03 21:41:01 -0400] jessicab: and i didnt even know ruby 2.0 was out, no clue how well thatll work with chef.. you might want to try omnibus which will install ruby 1.9.3
[2013-04-03 21:42:47 -0400] redf0x_: ok so chef 10 is the way to go for now?
[2013-04-03 21:42:56 -0400] kklimonda: how much memory would I need to run a chef server for ~10 nodes?
[2013-04-03 21:43:29 -0400] jessicab: redf0x_: well, chef 11.0 was the very first version so i imagine it had some bugs :P
[2013-04-03 21:43:44 -0400] gleam: i have ~70 nodes in chef 11 and it seems to be using ~800mb give or take
[2013-04-03 21:44:20 -0400] gleam: ~900 if you include pg
[2013-04-03 21:44:39 -0400] kklimonda: mhm, thanks
[2013-04-03 21:46:45 -0400] ponyofdeath: hi, dont know if I am doing something wrong but I am trying to manage my chef env and roles with the knife command and files stored in mercurial. seems that if i have to download roles from server then check in then modify then check in then knife upload them back?
[2013-04-03 21:48:29 -0400] bluekelp: ponyofdeath: i do something similar except i assume local (git) repo is authorative and have a Makefile that pushes all roles to the server
[2013-04-03 21:49:01 -0400] bluekelp: same with envs, data-bags, etc.
[2013-04-03 21:50:04 -0400] ponyofdeath: bluekelp: ahh ok can you share that make file if you are ok with it
[2013-04-03 21:50:11 -0400] denken: so.. knife cannot dump objects from the server in ruby, can it?
[2013-04-03 21:50:21 -0400] denken: knife show role base --format=ruby for example
[2013-04-03 21:50:24 -0400] denken: doesnt appear to be possible
[2013-04-03 21:50:40 -0400] bluekelp: yeah just a sec i'll gist it
[2013-04-03 21:50:50 -0400] redf0x_: didn't realize that my chef gem was that old. upgrading fixed the issue! thanks jessicab
[2013-04-03 21:50:53 -0400] spheromak: denken: one reason to not do it in ruby, use json instead :)
[2013-04-03 21:51:22 -0400] denken: spheromak: yeah... a lot of the docs available for cookbooks have everything listed in ruby
[2013-04-03 21:51:31 -0400] denken: just wondering
[2013-04-03 21:51:39 -0400] denken: i am using json currently, fwiw
[2013-04-03 21:52:55 -0400] bluekelp: ponyofdeath: https://gist.github.com/bluekelp/5305762  -- there is a "known" issue with error if no *.json files in the dirs but i think you get the idea
[2013-04-03 21:53:21 -0400] bluekelp: ponyofdeath: hrm, guess i'm still managing data-bags manually. i think b/c it was a two-part to create then "from file" to get it to work
[2013-04-03 21:53:55 -0400] ponyofdeath: bluekelp: ty ty
[2013-04-03 22:17:38 -0400] gad0lin: ohai chefs, my chef server died, I have 20 nodes that were connected to it, I have no brought new chef server, how can I reconfigure existing nodes to use new chef server?
[2013-04-03 22:19:13 -0400] maplebed: what do you use to install python modules that aren't available as distribution packages? is there a chef resource for pip or easy_install or something like that?
[2013-04-03 22:19:40 -0400] bluekelp: gad0lin: you can re-bootstrap them to the new server - you'll need to delete /etc/chef/client.pem on each node
[2013-04-03 22:19:48 -0400] gleam: https://github.com/opscode-cookbooks/python/blob/master/providers/pip.rb
[2013-04-03 22:19:50 -0400] vegardx_: Or you can reinstante a backup
[2013-04-03 22:19:59 -0400] bluekelp: gad0lin: but before you do, any chance you have a backup you can restore to and drop in a replacement server?
[2013-04-03 22:20:10 -0400] maplebed: gleam: thanks
[2013-04-03 22:20:18 -0400] gleam: https://github.com/opscode-cookbooks/python/blob/master/resources/pip.rb is probably easier to figure out
[2013-04-03 22:20:34 -0400] gad0lin: bluekelp: no backups at all
[2013-04-03 22:21:02 -0400] maplebed: gleam: ... easier than what? (did you mean to repaste the same link?)
[2013-04-03 22:21:10 -0400] gleam: they're diff links
[2013-04-03 22:21:15 -0400] maplebed: oh!
[2013-04-03 22:21:19 -0400] maplebed: right. resources vs. provider.
[2013-04-03 22:21:20 -0400] maplebed: ok, thanks.
[2013-04-03 22:21:22 -0400] gleam: yeah
[2013-04-03 22:27:27 -0400] helllen: I would like to execute a command after all services are started, how could I do it ?
[2013-04-03 22:36:00 -0400] gad0lin: bluekelp: great thx, it worked. Is there description of backup process(good tool)? One from here seems to be outdated http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server.
[2013-04-03 22:36:38 -0400] gleam: there are some knife exec scripts+plugins that can do it
[2013-04-03 22:37:02 -0400] gleam: i use this one: https://github.com/fnichol/knife-server
[2013-04-03 22:38:47 -0400] jhayden: I could use a little insight into an odd problem!
[2013-04-03 22:39:12 -0400] gad0lin: gleam: thx
[2013-04-03 22:39:12 -0400] jhayden: I have 2 servers in was that should be identical but one has a corrupted conf file
[2013-04-03 22:40:02 -0400] jhayden: I stopped tomcat, deleted the corrupted file and ran /var/lib/cloud/data/script/part-000 to reinstall everything
[2013-04-03 22:40:31 -0400] jhayden: the conf file is now good but 5 minutes later when chef-client runs again
[2013-04-03 22:40:44 -0400] KarlHungus: gad0lin: knife-essentials is good as well
[2013-04-03 22:40:48 -0400] jhayden: the conf file reverts to the corrupted version!!!
[2013-04-03 22:40:53 -0400] KarlHungus: see http://www.opscode.com/blog/2013/03/12/5106/ for notes on it ;)
[2013-04-03 22:41:20 -0400] jhayden: anybody got a clue what I can do to track this down?
[2013-04-03 22:41:45 -0400] jhayden: the other server is fine
[2013-04-03 22:41:52 -0400] bluekelp: gad0lin: no i don't practice what i preach! we're not backed up other than the EBS volume, atm. it's on the list but the list grows longer each day :(
[2013-04-03 22:43:38 -0400] bluekelp: jhayden: any chance that conf file is being templated by chef? otherwise it seems it's a side-effect of something else going on in the recipes (or a bad coincidence)
[2013-04-03 22:44:20 -0400] jhayden: it is a templated file but as I said the other server is fine
[2013-04-03 22:44:51 -0400] KarlHungus: i was considering making a cookbook called 'bailout' that would exit the chef run before converging anything if a file was present (e.g. /etc/NOCHEF). for maint windows, etc. is there a more elegant way?
[2013-04-03 22:45:00 -0400] spicy: ls
[2013-04-03 22:45:03 -0400] spicy: wrong window..
[2013-04-03 22:45:40 -0400] bluekelp: KarlHungus: thx for the link. essentials looks, well, essential (for sane people)
[2013-04-03 22:46:02 -0400] Babar: KarlHungus: at least use an attribute, not a file?
[2013-04-03 22:46:21 -0400] KarlHungus: bluekelp: yeah. we cron that backup and have the target dir in our tarsnap rotation
[2013-04-03 22:46:34 -0400] KarlHungus: Babar: maybe, both? ;) configurable as an attr?
[2013-04-03 22:47:22 -0400] KarlHungus: trap 'rm -f /etc/NOCHEF' INT TERM ; touch /etc/NOCHEF ; do_shell_magic
[2013-04-03 22:47:36 -0400] KarlHungus: useful if you need a cron job to block chef, etc
[2013-04-03 22:48:04 -0400] KarlHungus: but, i agree it feels janky =)
[2013-04-03 22:49:49 -0400] timsmith: We have a recipe that can be put on nodes that just exits the run
[2013-04-03 22:49:55 -0400] timsmith: same purpose
[2013-04-03 22:49:56 -0400] bluekelp: KarlHungus: for the examples in the link cookbook_path is nil (explicitly) - is there a reason you're aware of for this to be required for the download?
[2013-04-03 22:50:49 -0400] KarlHungus: bluekelp: the example in the link is for upgrading chef 10 to 11 using a transfer dir. i'd look to the knife-essential github readme for more generic docs
[2013-04-03 22:51:42 -0400] KarlHungus: timsmith: makes sense
[2013-04-03 22:51:57 -0400] KarlHungus: at least you're validating a need for such a thing. and that i'm not yet 100% crazy :P
[2013-04-03 22:52:49 -0400] timsmith: or just stop chef daemon in bulk with knife ssh
[2013-04-03 22:52:57 -0400] timsmith: that's the norm for us usually
[2013-04-03 22:53:19 -0400] KarlHungus: timsmith: we use cron, so i'd have to remove the job
[2013-04-03 22:53:26 -0400] KarlHungus: which is the current solution
[2013-04-03 22:53:28 -0400] timsmith: that makes it harder
[2013-04-03 23:01:47 -0400] jhayden: Here's an interesting twist on my problem.
[2013-04-03 23:02:30 -0400] jhayden: Since the 2 servers are on an autoscale group, I took the nuclear option and terminated the one with the bad conf file
[2013-04-03 23:03:01 -0400] jhayden: I figured when autoscale rebooted the new server I would pick up the correct conf file
[2013-04-03 23:03:04 -0400] jhayden: NO!!!
[2013-04-03 23:03:19 -0400] jhayden: I still have the corrupted file
[2013-04-03 23:03:29 -0400] jhayden: on a brand new server
[2013-04-03 23:05:03 -0400] jhayden: So my question is, how could the chef server give one tomcat server a bad conf file and not the other one?
[2013-04-03 23:05:17 -0400] jhayden: both are running chef-client on a cron job
[2013-04-03 23:06:09 -0400] gleam: dump the nodes from the chef server and see if they have any key attrib differences
[2013-04-03 23:06:55 -0400] jhayden: gleam: if that was at me, a great idea
[2013-04-03 23:10:37 -0400] zts: is it possible to suppress file content diffs on a per-resource basis?  There's a Chef config option to turn it off entirely, but I was hoping for something more fine-grained
[2013-04-03 23:26:11 -0400] wamcvey: I'm doing a migration from 10.x to 11.x open source server. I've migrated (nearly) all my cookbooks, and now one of my roles is triggering an error of: "Precondition failed: Unable to satisfy constraints on cookbook hg, which does not exist."  None of my recipes/roles references an 'hg' recipe (that I can tell at least). I've done a 'find/xargs/grep' for 'hg' in my entire cookbooks & roles hierarchy and came with zilch
[2013-04-03 23:26:41 -0400] wamcvey: any suggestions for tracking  down where it might be referenced?
[2013-04-03 23:30:38 -0400] wamcvey: Oh... found the issue... It wasn't in any of my *current* cookbooks, but in an old version of one of my cookbooks that was uploaded and obsoleted a long time ago.  (knife download, combined with find/xargs/grep  to the rescue)
[2013-04-03 23:32:59 -0400] jhayden: I may have figured it out!!!!
[2013-04-03 23:33:29 -0400] jhayden: Turns out my chef-server was hosed in an odd state.
[2013-04-03 23:33:45 -0400] jhayden: It wouldn't shut down or restart
[2013-04-03 23:34:17 -0400] jhayden: I shut down all chef services, killed chef-server and started up the services
[2013-04-03 23:34:47 -0400] jhayden: I let chef-client do its work on the affected client and it worked!!
[2013-04-03 23:35:06 -0400] jhayden: I will wait one more cycle to verify the cure!!!
[2013-04-03 23:42:15 -0400] jhayden: it worked, I can go home
[2013-04-03 23:42:21 -0400] jhayden: 8-)
