[2013-04-18 00:01:20 -0400] miah: meonkeys: it doesnt require chef server, it just requires knowing where your role_path is
[2013-04-18 00:01:48 -0400] meonkeys: miah: which I don't. Sorry, I'm new to chef, and this is the first time I've tried to run knife
[2013-04-18 00:03:22 -0400] meonkeys: miah: so, it works if I just `cp -a` my project's `roles` dir into /var/chef . Good enough. :)
[2013-04-18 00:04:53 -0400] meonkeys: aha, I just had to set role_path in my knife.rb. Whew. And huh: https://github.com/miketheman/knife-role-spaghetti/issues/2
[2013-04-18 00:31:05 -0400] Kzim: hi
[2013-04-18 00:31:33 -0400] Kzim: i need to start a service before apply a conf but service action doesn't handle :immediatly
[2013-04-18 00:31:40 -0400] Kzim: any idea please ?
[2013-04-18 00:51:17 -0400] flaccid: Kzim: see if you can string notifications
[2013-04-18 01:37:42 -0400] bluekelp: anyone run into issues w/running chef from cron? i migrated a cluster today to cron (from service) and they're all lagging on check-ins now.  log reports SIGTERM on the node i'm debugging
[2013-04-18 02:04:58 -0400] jasonsmr: hello chef channel
[2013-04-18 02:11:11 -0400] jasonsmr: Question how can I have diffrent node.json setup files for diffrent server types?
[2013-04-18 02:12:22 -0400] jasonsmr: what I want to do is to have seperate node files for each type of role
[2013-04-18 02:15:33 -0400] duellsy: hey all
[2013-04-18 02:27:28 -0400] shanlar: in a recipe, is it possible to get a list of recipes that the node is loading?
[2013-04-18 02:28:56 -0400] barefoot: you can check node.recipes
[2013-04-18 02:30:10 -0400] barefoot: jasonsmr: what benefit are after with your setup? just curious
[2013-04-18 02:46:15 -0400] flukes1_: does chef-solo not support default attributes in recipes?
[2013-04-18 02:47:49 -0400] barefoot: do you mean you are using 'default[:something]' in a recipe?
[2013-04-18 02:48:09 -0400] flukes1_: i'm using the pip cookbook, which does this: source node['python']['distribute_script_url']
[2013-04-18 02:48:39 -0400] barefoot: what is the error?
[2013-04-18 02:48:51 -0400] flukes1_: that appears to come from python/attributes/default.rb
[2013-04-18 02:48:57 -0400] flukes1_: NoMethodError: undefined method `[]' for nil:NilClass
[2013-04-18 02:49:19 -0400] barefoot: and what is it set to in default.rb?
[2013-04-18 02:49:36 -0400] flukes1_: default['python']['distribute_script_url'] = 'http://python-distribute.org/distribute_setup.py'
[2013-04-18 02:50:03 -0400] barefoot: should be fine, maybe you are overriding it somewhere?
[2013-04-18 02:50:14 -0400] flukes1_: not to my knowledge
[2013-04-18 02:50:24 -0400] flukes1_: oddly enough this config works in vagrant
[2013-04-18 02:53:55 -0400] flukes1_: the answer here says that solo does not support default attribs: http://stackoverflow.com/questions/13735232/chef-solo-undefined-method-for-nilnilclass
[2013-04-18 02:53:59 -0400] flukes1_: are you saying that's incorrect info?
[2013-04-18 02:54:39 -0400] barefoot: no, Im saying I use littlechef which runs chef-solo and I dont have this problem with the python cookbok
[2013-04-18 02:55:05 -0400] barefoot: so seems strange
[2013-04-18 02:55:10 -0400] flukes1_: and the same with vagrant
[2013-04-18 02:55:15 -0400] flukes1_: works fine
[2013-04-18 02:57:00 -0400] flukes1_: i'm gonna downgrade to 10.14.2 which my vagrant box uses
[2013-04-18 02:57:05 -0400] monokrome: Is there a way to tell the "application" cookbook to perform a specific action after everything else?
[2013-04-18 02:57:35 -0400] monokrome: I guess that I can just use execute
[2013-04-18 02:58:06 -0400] monokrome: but if it's possible to do it before the application is considered "current", that would be beter
[2013-04-18 02:58:09 -0400] monokrome: better*
[2013-04-18 03:00:12 -0400] ssd7: Ohai Chefs
[2013-04-18 03:00:21 -0400] monokrome: ohai
[2013-04-18 03:01:25 -0400] ssd7: flukes1_: Can you post the full stack trace for that issue to something like gist or pastebin?
[2013-04-18 03:11:02 -0400] flukes1_: 10.14.2 works fine
[2013-04-18 03:14:09 -0400] ssd7: Cool
[2013-04-18 03:14:48 -0400] ssd7: Was that error on latest Chef 10 or a different version?
[2013-04-18 03:17:37 -0400] monokrome: Can I do "before_symlink" inside of a resource?
[2013-04-18 03:17:51 -0400] monokrome: IE, define a function that runs execute inside of my recipe?
[2013-04-18 03:17:56 -0400] monokrome: and then
[2013-04-18 03:18:05 -0400] monokrome: before_symlink my_function
[2013-04-18 03:20:54 -0400] ickymettle: hey chefs ... we've got an elderly chef 10 server (10.4) on doing an index rebuild for solr it's only indexing 35 of our 1200+ nodes ... seeing absolutely nothing useful in the logs ... anyone seen this before ?
[2013-04-18 03:22:28 -0400] monokrome: 1200 NODES O_O
[2013-04-18 03:24:07 -0400] ickymettle: just a few
[2013-04-18 03:24:40 -0400] ickymettle: it gets even more fun when most of them are missing and you start getting templates that rely on search regenerating with no data in them :(
[2013-04-18 03:24:51 -0400] monokrome: Anyone know how I can get the directory of the current revision in the application resource? :/
[2013-04-18 03:25:13 -0400] jtimberman: ickymettle: you should upgrade to chef 11 for all the scaling goodness ;)
[2013-04-18 03:26:17 -0400] monokrome: IE, before_symlink I need to access releases/323j2f32fgj23g23g3
[2013-04-18 03:26:28 -0400] monokrome: but I don't know how to get the "releases/8HSADHf8af09ASFF" part
[2013-04-18 03:26:29 -0400] ickymettle: jtimberman: we're literally about 2 weeks away from that
[2013-04-18 03:28:13 -0400] jtimberman: ickymettle: :D
[2013-04-18 03:28:21 -0400] monokrome: No ideas? :(
[2013-04-18 03:28:36 -0400] jtimberman: monokrome: it should be the git revision of whatever you specified in the resource.
[2013-04-18 03:28:52 -0400] monokrome: git revision is specified as 'master'
[2013-04-18 03:28:59 -0400] monokrome: but it uses the commit ID for the directory name
[2013-04-18 03:29:28 -0400] jtimberman: yes
[2013-04-18 03:30:07 -0400] monokrome: So, releases/master doesn't exist
[2013-04-18 03:30:13 -0400] monokrome: It's releases/<commit id>
[2013-04-18 03:30:16 -0400] monokrome: Am I missing something here?
[2013-04-18 03:30:32 -0400] ickymettle: jtimberman: any tips on debugging would be awesome
[2013-04-18 03:32:36 -0400] jtimberman: chef-solr logging turned up to 11? (debug)
[2013-04-18 03:33:00 -0400] jtimberman: monokrome: nope, it's going to deploy master every time. so if the commit is different, you get a deploy.
[2013-04-18 03:33:24 -0400] jtimberman: might not be the thing you want to do. unless you're etsy (they deploy eleventy thousand times a day from master, right ickymettle ;))
[2013-04-18 03:34:26 -0400] monokrome: jtimberman: I understand that, but I'm just trying to get a string of the current revision
[2013-04-18 03:35:05 -0400] monokrome: so that I can run a command before it gets symlinked into current
[2013-04-18 03:35:13 -0400] jtimberman: ickymettle: maybe some help in here: http://tickets.opscode.com/browse/CHEF-2346
[2013-04-18 03:35:46 -0400] monokrome: but to run the command, I need to execute it with cwd set to "#{path}/releases/3safg42462ESG44gg43..."
[2013-04-18 03:35:48 -0400] jtimberman: monokrome: you can use the before_symlink callback
[2013-04-18 03:35:59 -0400] monokrome: but I don't have the string for after the "releases" segment of the path
[2013-04-18 03:36:01 -0400] monokrome: if that makes sense
[2013-04-18 03:36:07 -0400] monokrome: Yeah, I'm using before symlink
[2013-04-18 03:36:31 -0400] jtimberman: i don't know offhand how to get that
[2013-04-18 03:36:39 -0400] monokrome: :(
[2013-04-18 03:37:32 -0400] monokrome: Maybe CWD is automatically set to the right place? :/
[2013-04-18 03:40:25 -0400] ickymettle: jtimberman: ha -- we actually deploy slightly less frequently now but have more conncurrent users per push ;)
[2013-04-18 03:40:34 -0400] ickymettle: jtimberman: thanks for the pointer ... will keep digging
[2013-04-18 03:41:01 -0400] jtimberman: gotta run
[2013-04-18 03:41:05 -0400] jtimberman: good luck
[2013-04-18 03:41:41 -0400] ickymettle: monokrome: etsy
[2013-04-18 03:41:49 -0400] monokrome: oh cool :}
[2013-04-18 03:42:04 -0400] ickymettle: monokrome: about 850 physical hardware the rest VMs
[2013-04-18 03:44:30 -0400] monokrome: cool! :}
[2013-04-18 03:45:11 -0400] ssd7: ickymettle: Still having that solr/search issue?
[2013-04-18 03:46:26 -0400] ickymettle: ssd7: ya
[2013-04-18 03:46:43 -0400] ssd7: ickymettle: If you don't see expander or solr giving obvious errors, my first suspicion when nodes start disapparing is: http://tickets.opscode.com/browse/CHEF-2346
[2013-04-18 03:47:05 -0400] ickymettle: ssd7: ah yeah ... we ran into that a few weeks ago and bumped it up
[2013-04-18 03:48:18 -0400] ickymettle: in our situation kicked off a reindex and now only 35 nodes appear in the solr index
[2013-04-18 03:48:36 -0400] ickymettle: couch appears to be fine in that we can still see nodes
[2013-04-18 03:48:45 -0400] ickymettle: but no errors in expander log or solr log
[2013-04-18 03:48:55 -0400] ickymettle: or rabbit logs
[2013-04-18 03:51:42 -0400] ssd7: ickymettle: Is the server currently serving requests?  Might be useful to try to follow a single node save through the system, but that can be hard to do if it is servering lots of nodes at the moment.
[2013-04-18 03:58:39 -0400] ssd7: Random question: Has anyone had troubles with mirrorlist.centos.org over the last few days?
[2013-04-18 04:38:15 -0400] coderanger: Before I brave the actual channel, any Rails experts(-ish) around in here?
[2013-04-18 04:50:25 -0400] duellsy: bit of a noob here, all i'm looking to do is install composer, and run composer install, and also change permissions on a few folders can someone direct me to where I can learn how to do this?
[2013-04-18 04:51:31 -0400] coderanger: duellsy: I think you might be in the wrong place
[2013-04-18 04:52:02 -0400] duellsy: what if I said I wanted to do the above using a chef recipe?
[2013-04-18 04:52:16 -0400] coderanger: That would help :)
[2013-04-18 04:52:32 -0400] coderanger: Can you link me to whatever "composer" is?
[2013-04-18 04:52:38 -0400] duellsy: :P sorry, thought that was implied
[2013-04-18 04:52:38 -0400] duellsy: sure
[2013-04-18 04:52:49 -0400] duellsy: http://getcomposer.org/
[2013-04-18 04:53:11 -0400] duellsy: http://getcomposer.org/download/
[2013-04-18 04:53:28 -0400] coderanger: okay, looks simple enough
[2013-04-18 04:53:41 -0400] coderanger: http://docs.opscode.com/resource.html is a place to start
[2013-04-18 04:53:45 -0400] duellsy: so basically want to install that like the example has, then just run `composer update`
[2013-04-18 04:53:46 -0400] duellsy: ok
[2013-04-18 04:53:50 -0400] coderanger: the directory resource lets you set perms/owner
[2013-04-18 04:54:16 -0400] coderanger: For the install, if you want to do it using the curl | php style, you would probably use an execute resource with that command
[2013-04-18 04:54:22 -0400] duellsy: cool, so that handles my permissions
[2013-04-18 04:54:26 -0400] coderanger: just grab the php cookbook so php itself will be installed
[2013-04-18 04:54:36 -0400] coderanger: and you can use a package resource to install curl
[2013-04-18 04:54:48 -0400] coderanger: (though curl is usually around by default in most places)
[2013-04-18 04:54:52 -0400] duellsy: i'm using amazons OpsWorks, so there's a few things already being installed by that like php etc
[2013-04-18 04:55:26 -0400] coderanger: Ahh, so just beware that their version of chef is much older than our docs are describing
[2013-04-18 04:55:31 -0400] coderanger: so you may run into some roadbumps
[2013-04-18 04:55:32 -0400] flaccid: yeah its 0.9 yeek
[2013-04-18 04:55:41 -0400] duellsy: lovely
[2013-04-18 04:55:45 -0400] duellsy: of course it is :S
[2013-04-18 04:55:59 -0400] coderanger: But the basics should work
[2013-04-18 04:56:05 -0400] coderanger: and for this it should be all you need :)
[2013-04-18 04:56:06 -0400] flaccid: coderanger: i wouldn't mind getting a little help on application cookbook question. like how to set variables for template in application resource that are not the database context..
[2013-04-18 04:56:25 -0400] coderanger: flaccid: Which template do you mean?
[2013-04-18 04:56:26 -0400] flaccid: nobody has know here so far and it seems an oversight at least in the readme
[2013-04-18 04:56:38 -0400] flaccid: coderanger: the local settings one
[2013-04-18 04:56:46 -0400] flaccid: i can set stuff in database do
[2013-04-18 04:56:55 -0400] flaccid: but i wanna set ones that are not in the context of database
[2013-04-18 04:56:56 -0400] duellsy: so my next question, I'm not sure if this is OpsWorks specific what do I do to run a specific recipe?
[2013-04-18 04:57:08 -0400] coderanger: duellsy: Just make sure you do something like 'creates "/usr/bin/composer"'
[2013-04-18 04:57:14 -0400] flaccid: duellsy: opsworks specific
[2013-04-18 04:57:19 -0400] coderanger: duellsy: Sorry, that would be opsworks specific
[2013-04-18 04:57:29 -0400] coderanger: They use chef-solo as the low-level engine
[2013-04-18 04:57:33 -0400] flaccid: duellsy: ##aws
[2013-04-18 04:57:36 -0400] coderanger: but the runner framework is custom
[2013-04-18 04:57:40 -0400] duellsy: cool
[2013-04-18 04:57:45 -0400] duellsy: thanks
[2013-04-18 04:58:30 -0400] flaccid: coderanger: so like https://github.com/opscode-cookbooks/application_php/blob/master/README.md#usage i dunno how to set things for the template other than the database
[2013-04-18 04:58:38 -0400] coderanger: flaccid: https://github.com/opscode-cookbooks/application_python/blob/master/providers/django.rb#L133 :)
[2013-04-18 04:58:40 -0400] flaccid: i can't create my own method in that block
[2013-04-18 04:58:53 -0400] coderanger: flaccid: The #settings hash forms the basis of the template vars
[2013-04-18 04:59:00 -0400] coderanger: and you can swap out the template too
[2013-04-18 04:59:13 -0400] coderanger: via #settings_template
[2013-04-18 04:59:43 -0400] flaccid: hmm so i can do settings do foo in the php sub resource in the application resource?
[2013-04-18 05:00:00 -0400] gleam: i'm pretty sure the answer is no, but is there a good way to force a recipe or block of recipe code to execute at teh very end of a run, after every other recipe but before the handler?
[2013-04-18 05:00:01 -0400] coderanger: settings is just a hash, not an optionscollector like the DB thing
[2013-04-18 05:00:05 -0400] coderanger: but other than that, yes
[2013-04-18 05:00:15 -0400] coderanger: gleam: Just put it at the end?
[2013-04-18 05:00:20 -0400] gleam: without doing that ;)
[2013-04-18 05:00:38 -0400] coderanger: gleam: Not that I know of, you could probably do something funky with notifications though
[2013-04-18 05:01:01 -0400] flaccid: coderanger: ok but like where should i set the settings hash, outside of the application block?
[2013-04-18 05:01:13 -0400] coderanger: Use a no-op ruby_block and a delayed notification to a ruby_block with your actual code
[2013-04-18 05:01:25 -0400] coderanger: flaccid: no, its a property of the django subresource
[2013-04-18 05:01:26 -0400] gleam: oh good idea
[2013-04-18 05:01:45 -0400] coderanger: django do settings whatever:42 end
[2013-04-18 05:01:45 -0400] flaccid: coderanger: i am am only using the application and application_php cookbooks..
[2013-04-18 05:02:02 -0400] coderanger: flaccid: I'm confused, I thought you said local_settings which is in the python one
[2013-04-18 05:02:05 -0400] gleam: i'm trying to generate iptables rules based on seen recipes, but also want to include the cookbook in my base role instead of having to push it to the end of the run list for everything
[2013-04-18 05:02:27 -0400] coderanger: flaccid: Let me read the app_php code, I'm less familiar with that one
[2013-04-18 05:02:32 -0400] flaccid: coderanger: thanks mate
[2013-04-18 05:02:48 -0400] coderanger: gleam: Use LWRPs :)
[2013-04-18 05:03:01 -0400] flaccid: i mean i could set it in the database block but its incorrect semantics
[2013-04-18 05:03:03 -0400] coderanger: Each one can just add its rule as needed
[2013-04-18 05:03:12 -0400] joonas: man
[2013-04-18 05:03:17 -0400] joonas: these new chef docs make so much more sense
[2013-04-18 05:03:23 -0400] gleam: well, i don' want to modify the source cookbooks to do it
[2013-04-18 05:03:25 -0400] gleam: that's how i currently do it
[2013-04-18 05:03:32 -0400] gleam: but i'd rather have the apache2 cookbook pristine
[2013-04-18 05:03:35 -0400] coderanger: flaccid: Yeah, doesn't look like app_php includes the same raw settings hash as app_python does
[2013-04-18 05:03:40 -0400] coderanger: flaccid: Patches welcome :)
[2013-04-18 05:03:57 -0400] coderanger: gleam: Ahh, so our usual pattern for that is companyname-apache2
[2013-04-18 05:04:02 -0400] coderanger: which has the local magics
[2013-04-18 05:04:09 -0400] gleam: yes, but then if i have another source cookbook that include_recipes apache2
[2013-04-18 05:04:12 -0400] coderanger: so opscode-apache::iptables
[2013-04-18 05:04:13 -0400] gleam: i have to manually include ours-apache2
[2013-04-18 05:04:22 -0400] flaccid: coderanger: ok, good to know I can get to that. recommend just using database for now yeah, seems cleanest?
[2013-04-18 05:04:26 -0400] gleam: which makes me a sad panda
[2013-04-18 05:04:26 -0400] coderanger: Yep, this is why cookbooks should be written as libs!
[2013-04-18 05:04:27 -0400] coderanger: :D
[2013-04-18 05:04:31 -0400] gleam: haha
[2013-04-18 05:04:37 -0400] gleam: sounds good to me
[2013-04-18 05:04:38 -0400] coderanger: flaccid: I think thats your only option
[2013-04-18 05:04:59 -0400] flaccid: coderanger: excellent, thanks y0; i hope to circle back to the contrib on that
[2013-04-18 05:05:01 -0400] coderanger: gleam: I'll bash good dev practices into the ops world if it is the last thing I do :)
[2013-04-18 05:05:06 -0400] gleam: hell if i could override the cookbook name on the fly in some way, that'd be fine
[2013-04-18 05:05:21 -0400] gleam: so companyname-apache2 -> apache2 and apache2 -> opscode-apache2
[2013-04-18 05:05:30 -0400] gleam: but that doesn't work
[2013-04-18 05:06:21 -0400] flaccid: thats a bit crazy
[2013-04-18 05:06:23 -0400] gleam: so here i am instead looking at forcing code to run at the very end
[2013-04-18 05:06:35 -0400] gleam: or at least after every other recipe has been processed
[2013-04-18 05:06:40 -0400] gleam: but delayed notifications seems like a good bet
[2013-04-18 05:07:51 -0400] coderanger: gleam: In an ideal world the way this would work is corpname-apache2 subclasses the apache2 resource and adds extra logic re: iptables (probably just a resource)
[2013-04-18 05:08:18 -0400] gleam: that'd be great
[2013-04-18 05:08:21 -0400] gleam: but yeah.
[2013-04-18 05:08:26 -0400] gleam: not an ideal world
[2013-04-18 05:08:37 -0400] gleam: haha good luck
[2013-04-18 05:09:30 -0400] littleidea: I have a question about RBAC on chef platform if someone thinks they know how it all works.
[2013-04-18 05:10:15 -0400] coderanger: littleidea: I like to pretend I do
[2013-04-18 05:10:40 -0400] coderanger: Just don't ask me what an authjoin table is since I still don't know :)
[2013-04-18 05:10:53 -0400] coderanger: (maybe by year 3 I'll get that far)
[2013-04-18 05:11:43 -0400] littleidea: coderanger: can you arbitrarily restrict what hosts or environments individuals can manipulate?
[2013-04-18 05:11:58 -0400] coderanger: If by hosts you mean nodes, yes
[2013-04-18 05:12:10 -0400] littleidea: nodes
[2013-04-18 05:12:48 -0400] coderanger: You can independently restrict read, update, and delete
[2013-04-18 05:35:56 -0400] ssd7: BryanWB: Around?
[2013-04-18 05:36:08 -0400] BryanWB: ssd7, yeah, what's up?
[2013-04-18 05:37:04 -0400] ssd7: I kinda want this cookbook name http://community.opscode.com/cookbooks/xinetd for https://github.com/stevendanna/cookbook-xinetd
[2013-04-18 05:37:18 -0400] ssd7: I thought I had searched before I wrote mine but I guess the community site was trolling me.
[2013-04-18 05:37:39 -0400] BryanWB: ssd7, ok is mine old and out of date?
[2013-04-18 05:37:52 -0400] BryanWB: am i squatting?
[2013-04-18 05:39:17 -0400] ssd7: Not particularly old, just more features in my new one.  Happy to open a big pull request to yours as well if you want to keep the name.  Need to look into the cookbooks depending on yours still.
[2013-04-18 05:39:42 -0400] BryanWB: ssd7, hrm, am happy to hand it over to you
[2013-04-18 05:44:42 -0400] ssd7: BryanWB: Cool. I don't think my cookbook would break anyone using your cookbook currently as the only thing I do differently in the default recipe is ensure the .d directory exists and manage the config file, but centos and ubuntu both seem to have default configs from the xinetd source tree anyway.
[2013-04-18 05:44:57 -0400] BryanWB: ssd7, bbiab
[2013-04-18 05:56:07 -0400] fvae: hi all.. is there any known issues with chef-solo 11 and rubygems 2 (latest version)?
[2013-04-18 05:56:14 -0400] ssd7: BryanWB: Cool, leave yours for now.  I'll shoot you an email.  There is no rush and I don't want to accidently break any of your users.  ttyl :)
[2013-04-18 09:52:15 -0400] skroon: anyone that can recommend a book as a good introduction to chef?
[2013-04-18 10:00:35 -0400] mattt: skroon: not sure there are any :-/
[2013-04-18 10:13:25 -0400] s2r2: there's "test-driven infrastructure with chef", but I only know it exists
[2013-04-18 10:21:36 -0400] newbi: hi! it hit some error about this "Chef encoutered an error attempting to create the client "debian.localdomain" where should i change the value debian.localdomain to ipaddress ?
[2013-04-18 10:26:37 -0400] gnoll110: .R
[2013-04-18 10:26:43 -0400] gnoll110: .r
[2013-04-18 10:53:50 -0400] kesor: can someone help me? have a problem using a definition https://gist.github.com/kesor/5411806
[2013-04-18 10:55:16 -0400] skroon: mattt: too bad, I've been trying to start with Chef, but I always got too many questions (even after watching screencasts etc, because they don't really discuss stuff I'm thinking about)
[2013-04-18 10:57:34 -0400] laurent\: you still ask here or on the mailing list
[2013-04-18 10:58:02 -0400] skroon: laurent\: it's really basic questions though actually, i'll feel ashamed asking it on the list perhaps :-)
[2013-04-18 10:58:19 -0400] skroon: s2r2: I really love the idea of cucumber-chef, I have that book actually, but haven't yet used it too much
[2013-04-18 10:58:34 -0400] skroon: anyone else in here that uses cucumber-chef? I see it's still active project on github
[2013-04-18 11:01:18 -0400] laurent\: skroon: ask them here then :) no reason to be ashamed ;)
[2013-04-18 11:02:10 -0400] skroon: laurent\: i'm trying to setup my environment with LXC, and would like to start using chef for my deployments, later on use it to automatically scale up and also really importantly scale down. So I would need to use chef-server for this right away right?
[2013-04-18 11:04:55 -0400] laurent\: you benefit from its features if you do. look at what you would miss if only using chef-solo: http://docs.opscode.com/chef_solo.html
[2013-04-18 11:06:39 -0400] kesor: can I somehow remove resources in a wrapper recipe? say, I want to have resources("service[monit]") removed completely, what is the API for that?
[2013-04-18 11:07:47 -0400] laurent\: removed as disabled or removed as disabled + init script deleted ?
[2013-04-18 11:08:04 -0400] kesor: removed as-in not existing during the converge phase
[2013-04-18 11:09:01 -0400] kesor: say I have the monit cookbook that has a template+service I don't want to converge, I'll make my own in my wrapper cookbook.
[2013-04-18 11:09:52 -0400] laurent\: oh so you don't want to alter the monit cookbook, do you ?
[2013-04-18 11:10:09 -0400] kesor: it has been forked too many times already  and its still shit. pardon my french.
[2013-04-18 11:10:28 -0400] kesor: github is spammed with dozens and dozens of its forks.
[2013-04-18 11:11:57 -0400] vegardx: Does salt support preseeding package installs?
[2013-04-18 11:12:00 -0400] vegardx: err
[2013-04-18 11:12:02 -0400] vegardx: worng channel.
[2013-04-18 11:12:19 -0400] laurent\: oh so you want to use a shitty cookbook and add a lot of shit around it to make it work for your needs ? :) (i'm french, pardon me ;-))
[2013-04-18 11:12:50 -0400] kesor: no, I just want to remove the shittiest parts. and use the parts that do work.
[2013-04-18 11:13:31 -0400] kesor: without creating yet another fork that no one needs
[2013-04-18 11:13:50 -0400] laurent\: i guess i'd fork it, split it into several recipes and eventually propose a pull request but that's not what you want :)
[2013-04-18 11:14:17 -0400] kesor: I just want to remove a resource("something") from the list so it does not exist during the converge phase.
[2013-04-18 11:15:25 -0400] laurent\: removing or altering it so its action is :nothing
[2013-04-18 11:16:05 -0400] kesor: so I can't remove it?
[2013-04-18 11:16:13 -0400] laurent\: might be doable, i would have to play with shef (and reading the source) to give you an answer
[2013-04-18 11:16:20 -0400] laurent\: i don't know :)
[2013-04-18 11:16:34 -0400] kesor: action :nothing still means that other resources can notify it to do some action, like restart.
[2013-04-18 11:16:41 -0400] laurent\: but it's lunch time for me right now.
[2013-04-18 11:16:44 -0400] laurent\: yep correct
[2013-04-18 11:16:49 -0400] kesor: bon appetit
[2013-04-18 11:16:56 -0400] laurent\: merci :)
[2013-04-18 11:44:36 -0400] railsraider: any way to set a specific version of mysql with the opscode cookbook for ubunutu?
[2013-04-18 12:02:18 -0400] adamjk-dev: is there not an attribute for that?
[2013-04-18 12:10:40 -0400] nebrera: helllo
[2013-04-18 12:11:07 -0400] nebrera: how could I stop a service before modifying a template file ?
[2013-04-18 12:11:24 -0400] nebrera: the notify, do it after the modification
[2013-04-18 12:11:42 -0400] nebrera: I would like to do something before, then modify the file and after the notify
[2013-04-18 12:11:45 -0400] nebrera: if possible
[2013-04-18 12:11:58 -0400] kesor: what about notify :restart ?
[2013-04-18 12:12:20 -0400] nebrera: the problem is to stop it need the file exactly it was running
[2013-04-18 12:15:14 -0400] skroon: laurent\: the chef-server is also free and opensouce right? or just chef-solo?
[2013-04-18 12:18:34 -0400] railsraider: adamjk-dev: no only for windows
[2013-04-18 12:18:45 -0400] railsraider: by default it installs 5.5 on ubuntu 12.04
[2013-04-18 12:19:46 -0400] gchristensen: skroon: it is all open source
[2013-04-18 12:24:33 -0400] adamjk-dev: railsraider: Ah, that is lame, I didn't look myself was just wondering
[2013-04-18 12:24:48 -0400] adamjk-dev: railsraider: hence why I wanted to start the best practices Wiki or something for the community
[2013-04-18 12:24:57 -0400] adamjk-dev: railsraider: if you install something, it should be fully configurable....
[2013-04-18 12:25:33 -0400] adamjk-dev: railsraider: a cookbook should allow you to override the binary version to install... and where to get it (a URL or something) so you can grab it locally if you host your own installers or get it online
[2013-04-18 12:26:35 -0400] skroon: gchristensen: the chef-server is also installed via simple gem install chef  ?
[2013-04-18 12:28:24 -0400] kesor: skroon: you probably want to use the omnibus installer, from opscode.com/chef/install
[2013-04-18 12:36:00 -0400] kesor: can someone please help me understand why definition can't use cookbook_name directly? https://gist.github.com/kesor/5411806
[2013-04-18 13:03:02 -0400] willejs: hi, I'm using the opscode-aws cookbook, and attempting to use the ebs_raid lwrp
[2013-04-18 13:03:38 -0400] willejs: however, after including the recipe in my other recipe and declaring it as a dependency in my metadata.rb, i still get this error
[2013-04-18 13:03:39 -0400] willejs: FATAL: NameError: Cannot find a resource for ebs_raid on ubuntu version 12.04
[2013-04-18 13:06:35 -0400] willejs: anyone active with any ideas?
[2013-04-18 13:14:18 -0400] jwilf: hey guys, what is the best way to change the ssl cert for nginx in chef 11?
[2013-04-18 13:14:46 -0400] jwilf: can i do this via chef-server-ctl?
[2013-04-18 13:24:11 -0400] skroon: gchristensen: so would this be called 'private chef' /
[2013-04-18 13:24:31 -0400] akhet: i cant afford a private chef
[2013-04-18 13:24:53 -0400] gchristensen: skroon: no, private chef is where Opscode handles your private install of the chef server
[2013-04-18 13:25:05 -0400] skroon: gchristensen: ah ok :-)
[2013-04-18 13:25:35 -0400] gchristensen: akhet: check the pricing page on opscode.com, private chef is the same cost as hosted right now :P (bug? probably.)
[2013-04-18 13:25:52 -0400] johndesp: Good MorningI have a stupid question how can I overcome the following error when uploading a cookbook?
[2013-04-18 13:25:58 -0400] gchristensen: jtimberman: is private and hosted chef supposed to have identical costs on the website??
[2013-04-18 13:26:16 -0400] akhet: sorry - i was just making a stupid joke :P
[2013-04-18 13:26:21 -0400] gchristensen: LOL
[2013-04-18 13:26:28 -0400] gchristensen: sorry, I skipped your "a" :)
[2013-04-18 13:26:29 -0400] johndesp: ERROR: Cookbook nfs depends on cookbook line version >= 0.0.0,
[2013-04-18 13:26:29 -0400] johndesp: ERROR: which is not currently being uploaded and cannot be found on the server.
[2013-04-18 13:26:40 -0400] akhet: ;)
[2013-04-18 13:26:58 -0400] gchristensen: johndesp: you need to get the nfs cookbook, and uplod it to chef.
[2013-04-18 13:28:36 -0400] johndesp: I copied the nfs cookbook from a different local-repois that the problem?
[2013-04-18 13:28:56 -0400] skroon: laurent\: do you use some special lxc container template, that includes the chef client, with perhaps the right configuration to point at the chef server?
[2013-04-18 13:31:02 -0400] gchristensen: my mistake johndesp, I misread your error. you need to get the 'line' cookbook and upload that to Chef.
[2013-04-18 13:31:30 -0400] gchristensen: johndesp: usually that dependency is for a cookbook on community.opscode.com, so it probably wants this one: http://community.opscode.com/cookbooks/line
[2013-04-18 13:31:41 -0400] johndesp: thanks
[2013-04-18 13:34:23 -0400] johndesp: Omnibus vs manual  on a macbook..whats the difference..whats the best route?
[2013-04-18 13:34:46 -0400] gchristensen: omnibus is easier to deal with in general.
[2013-04-18 13:37:03 -0400] skroon: is there like a good resource on how to get started on chef server ?
[2013-04-18 13:37:53 -0400] masterkorp: gchristensen: http://i.imgur.com/PoET5f3.gif
[2013-04-18 13:38:34 -0400] gchristensen: masterkorp: I don't know what that is in reference to, but I laughed out loud :P
[2013-04-18 13:41:11 -0400] masterkorp:   gchristensen | omnibus is easier to deal with in general.
[2013-04-18 13:41:17 -0400] masterkorp: packages br0
[2013-04-18 13:41:21 -0400] gchristensen: hah
[2013-04-18 13:51:37 -0400] laurent\: skroon: nothing really special, basically i use the chef-client cookbook
[2013-04-18 13:53:41 -0400] laurent\: and i bootstrap my guests (lxc,xen) with a special bootstrap script. something that i should definitely rewrite as a knife plugin
[2013-04-18 13:56:51 -0400] skroon: laurent\: but this default installation of your guest, includes a chef-client? or you need to manually go into this newly deployed client and trigger the installation and configuration, and only then will chef-server do the rest?
[2013-04-18 14:08:33 -0400] laurent\: oops too late
[2013-04-18 14:31:44 -0400] billyoung: l
[2013-04-18 14:39:37 -0400] lojak: in the postgresql cookbook, setting pg_hba is run before set-postgres-password. I ran into a case where my pg_hba would prevent set-postgres-password from ever finishing since it takes a password as input
[2013-04-18 14:39:51 -0400] lojak: wouldn't it make sense to run set-postgres-password first, and then the pg_hba template?
[2013-04-18 14:41:44 -0400] lojak: https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/server.rb#L84
[2013-04-18 15:01:36 -0400] till_: jtimberman: was wondering if you guys use vagrant 1.2.x with bento yet?
[2013-04-18 15:03:16 -0400] till_: there are also a ton of trivial PRs open on opscode/bento
[2013-04-18 15:08:04 -0400] a13x212: i have a recipe where i am adding users, when users don't exist chef runs without any errors, once a user exist i get the following error
[2013-04-18 15:08:08 -0400] a13x212: Chef::Exceptions::User: Couldn't lookup integer GID for group name 501
[2013-04-18 15:09:24 -0400] KarlHungus: till_: i'm using it with 1.1, but haven't tested the 1.2 stuff. any breaking changes?
[2013-04-18 15:13:24 -0400] directionless: I'd like to write a helper function and call it from a template. Do I want a definition or a library?
[2013-04-18 15:13:34 -0400] pb56673: Does anyone here use the opscode recipe apt::cacher-ng ?
[2013-04-18 15:13:40 -0400] directionless: I think I want a library, but I always get the namespacing confused
[2013-04-18 15:13:55 -0400] jwilf: directionless: sounds like you want a library
[2013-04-18 15:14:28 -0400] till_: KarlHungus: yeah, it fails on `bundle exec vagrant basebox build etc.`
[2013-04-18 15:14:43 -0400] till_: and displays the a vagrant error and vagrant's -h
[2013-04-18 15:14:49 -0400] directionless: jwilf: Cool, thanks for the sanity checl
[2013-04-18 15:25:01 -0400] till_: KarlHungus: it works when i bundle install again and get some older vagrant version through rubygems
[2013-04-18 15:31:13 -0400] till_: i also had to add `/etc/init.d/vboxadd setup` to vagrant.sh
[2013-04-18 15:38:15 -0400] BryanWB: how can i reference the current recipe inside a ruby_block?
[2013-04-18 15:38:25 -0400] BryanWB: ::Chef::Recipe doesn't do it
[2013-04-18 15:45:04 -0400] till_: BryanWB: it's a hack, but you could write it into node[] and use that
[2013-04-18 15:45:18 -0400] BryanWB: till_, ugh :( there must be a bester way
[2013-04-18 15:45:21 -0400] BryanWB: better*
[2013-04-18 15:48:55 -0400] schulz: I'm getting "Connection reset" when clients try to post to /reports/nodes/[NODNAME]/runs/, it looks like resource reporting isn't enabled on the chef server, anybody have any idea how I can enable that?
[2013-04-18 15:51:19 -0400] frantz: i've upgraded to chef-client 11.4.0 and have a recipe that syncs a git repo
[2013-04-18 15:52:03 -0400] frantz: keep getting the following error: "ERROR: Mixlib::ShellOut::ShellCommandFailed: git[my-repo] (my::recipe) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '128'"
[2013-04-18 15:52:19 -0400] frantz: STDERR: fatal: Failed to expand user dir in: '~/.gitignore'
[2013-04-18 15:52:42 -0400] frantz: i've explicitly set a value for the 'user' attribute, but no love
[2013-04-18 15:52:52 -0400] frantz: the googles don't help
[2013-04-18 15:52:57 -0400] frantz: any ideas?
[2013-04-18 15:53:29 -0400] frantz: nathenharvey: howdy!
[2013-04-18 15:53:35 -0400] j^2: put a blank ~/.gitignore?
[2013-04-18 15:54:39 -0400] schulz: frantz: are you sure it's looking for the right git repor?  The 128 is remote hanging up
[2013-04-18 15:56:31 -0400] frantz: schulz: yes, but i'll double check
[2013-04-18 15:57:16 -0400] jcm_img: afternoon all - quick omnibus installer question; after using the "curl|sudo bash" install method, and then using the /opt/chef gem binary to install knife-windows, I'm still getting this message:
[2013-04-18 15:57:20 -0400] jcm_img: FATAL: Cannot find sub command for: 'windows'; The windows commands were moved to plugins in Chef 0.10; You can install the plugin with `(sudo) gem install knife-windows
[2013-04-18 15:57:31 -0400] frantz: schulz: i can manually pull the repo
[2013-04-18 15:57:33 -0400] jcm_img: this is on centos 6.4
[2013-04-18 15:57:44 -0400] frantz: also, a manual run of chef (chef-client --once) works just fine
[2013-04-18 15:57:55 -0400] frantz: it seems like chef doesn't know what $HOME is
[2013-04-18 15:58:34 -0400] jcm_img: is this a known problem when using the omnibus installer (and is there a fix)?
[2013-04-18 15:59:11 -0400] schulz: frantz: hmmm, yeah, try hard coding it real quick to the home dir you want and see if that fixes it, then you know where to look
[2013-04-18 15:59:31 -0400] frantz: j^2: no, chef can't seem to figure out how to find ~/.gitignore
[2013-04-18 16:00:03 -0400] FunnyLookinHat: Trying to understand Chef...  it looks like the over-arching goal is similiar to JuJu - i.e. spin up a box for each "instance" of an application.  Is that correct?  Or could it be manipulated to make multiple services run on a single box ?
[2013-04-18 16:01:04 -0400] till_: you can combine almost arbitrary recipes
[2013-04-18 16:02:15 -0400] frantz: schulz: how do you mean? here's a mocked up gist for reference: https://gist.github.com/RyanFrantz/5413926
[2013-04-18 16:02:40 -0400] gchristensen: FunnyLookinHat: if you can run commands on a server and make it do XYZ, there is a 99% guarantee that you can do it in chef :)
[2013-04-18 16:03:50 -0400] FunnyLookinHat: gchristensen, Hah - right I get that...  I guess what I meant was... my goal is to create a sort of multi-tenancy solution to deploy my application on virtual servers ( spun up as necessary... basics, etc. ) - where each "application instance" is a hosted directory for PHP code.
[2013-04-18 16:03:57 -0400] FunnyLookinHat: Does that sound like a good fit?
[2013-04-18 16:04:21 -0400] schulz: frantz: I was thinking your path there was a ~/something and it was having trouble finding $HOME, try what j^2 suggested and put the blank .gitignore in $USER/$HOMEDIR
[2013-04-18 16:05:32 -0400] gad0lin: FunnyLookinHat: yes
[2013-04-18 16:06:23 -0400] frantz: schulz: i'll try anything, but like I said, it works when running 'chef-client --once'
[2013-04-18 16:06:31 -0400] frantz: and the error states that it can't expand the user dir
[2013-04-18 16:06:48 -0400] gad0lin: FunnyLookinHat:   you still have to build multitenancy logic yourself, maybe lxc container would be ok
[2013-04-18 16:07:08 -0400] FunnyLookinHat: gad0lin, Ah ok... so that would still fit within a recipe ?
[2013-04-18 16:09:11 -0400] zts: FunnyLookinHat: a recipe can only be applied once in a run, but Chef offers a number of ways of making things reusable - an easy way of applying a recipe multiple times (with different parameters) is to turn it into a Definition
[2013-04-18 16:09:30 -0400] zts: FunnyLookinHat: somewhat more complicated (and flexible) are LWRPs, which are something else to explore
[2013-04-18 16:09:34 -0400] gad0lin: FunnyLookinHat: chef is configuration management tool,  so it can bring your system to desire status, but later you need to have sth to manage your services.
[2013-04-18 16:09:54 -0400] FunnyLookinHat: zts, Ah interesting
[2013-04-18 16:11:17 -0400] zts: FunnyLookinHat: so one pattern people will use for your use case is to have a definition or LWRP that is responsible for setting up an application instance, then have a "data bag" which lists the instances you want to setup
[2013-04-18 16:11:52 -0400] zts: FunnyLookinHat: you'd then have one recipe which looked through the data bag for application instances, and then declared the definition/LWRP for each one, with the right parameters
[2013-04-18 16:12:29 -0400] FunnyLookinHat: zts, Ok - given that solution - beyond spinning up a box and installing the basics - what would Chef be providing?  It sounds to me like 99% of the work and effort resides within the definitions / recipes
[2013-04-18 16:12:37 -0400] zeroXten: is there a clean way of merging (concat) a bunch of config files? I don't want to have to turn them into attributes or anything
[2013-04-18 16:12:54 -0400] FunnyLookinHat: zts, sorry - I'm trying to understand what problems Chef solves...  not start a fight  :)
[2013-04-18 16:12:57 -0400] zeroXten: something nice source [ "file1, "file2" ] would be nice for cookbook_file
[2013-04-18 16:13:08 -0400] zts: FunnyLookinHat: it's a fair question :)  I find that Chef's value comes in two places
[2013-04-18 16:13:41 -0400] zts: FunnyLookinHat: the basic one is that Chef abstracts all the details of checking whether a system is configured correctly, and setting it up the way that you want
[2013-04-18 16:14:26 -0400] directionless: I want to use a library def in a template. How do I get this through the namespaces?
[2013-04-18 16:14:39 -0400] zts: FunnyLookinHat: so instead of caring about exactly how to check whether a particular user exists, create the user, etc, you just declare that user "foo" should be present
[2013-04-18 16:14:48 -0400] FunnyLookinHat: zts, Ah ok - so it ensures that all of your system-level dependencies and whatnot are good to go
[2013-04-18 16:15:41 -0400] zts: FunnyLookinHat: yeah, and it does so safely and repeatably.  If you were scripting it yourself, you could get the same result - but it's a bunch of work you'd be doing (and wheels you'd be reinventing) that Chef (or Puppet, or whatever) can provide for you
[2013-04-18 16:15:58 -0400] zeroXten: the value I get from Chef revision control and repeatability
[2013-04-18 16:16:05 -0400] zeroXten: and self documentation
[2013-04-18 16:16:26 -0400] FunnyLookinHat: zts, ok - so that's #1 what's #2 ?
[2013-04-18 16:16:26 -0400] zts: FunnyLookinHat: the related benefit is that there's greater consistency between how people build things - if you and I script stuff manually, we'll both come up with different solutions.  If we're both using Chef, there will be much more common ground
[2013-04-18 16:16:40 -0400] zts: FunnyLookinHat: but that is true of Chef, Puppet, CFengine, whatever
[2013-04-18 16:16:44 -0400] FunnyLookinHat: zts, right right, a "language" for the cloud
[2013-04-18 16:17:14 -0400] zts: FunnyLookinHat: the areas where I think Chef stands apart are when you are using it in client/server mode.  The Chef server knows about all your nodes, so you can be far more intelligent about how you configure things
[2013-04-18 16:17:44 -0400] zts: FunnyLookinHat: for example, instead of hardcoding the IP addresses of your webservers, you can search for "all nodes that are webservers"
[2013-04-18 16:18:06 -0400] zts: that's a bit of a trivial example, but I find it hard to think of concise ones :)
[2013-04-18 16:18:19 -0400] FunnyLookinHat: That's fair
[2013-04-18 16:18:32 -0400] FunnyLookinHat: zts, That helps me understand things much more clearly though - thanks  :)
[2013-04-18 16:19:33 -0400] FunnyLookinHat: You guys obviously do a lot of scaling - so can I throw a non-Chef curveball?  I'm trying to figure out how to have a wildcarded domain ( %.myapp.com ) redirect to whichever server a unique app instance is hosted on...  how do you guys solve that usually ?
[2013-04-18 16:19:40 -0400] sparr0: I am going to use cobbler to deploy centos and a chef client to a physical server. I then want chef on that server to install a bunch of OS packaged. Later chef will be instructed to upgrade some of those packages, but it might be doing so from a chef-solo instance with all the package files in a local repository (or just a local filesystem). Are there any guidelines for that sort of environment?
[2013-04-18 16:21:36 -0400] barefoot: directionless: 'class Chef::Recipe include your_lib end' maybe?
[2013-04-18 16:22:27 -0400] directionless: barefoot: I've currently got class Chef::Recipe  def blah, but when I call blah from my template I get "undefined method"
[2013-04-18 16:23:05 -0400] directionless: Might be something simple like, just needing a ::Chef::Recipe::blah instead of blah
[2013-04-18 16:25:02 -0400] barefoot: not sure, my include is a module and it seems to work fine
[2013-04-18 16:25:54 -0400] theCzar: Can anyone think of a way to refresh my session mid chef run?
[2013-04-18 16:26:42 -0400] directionless: barefoot: Yeah. I suspect I'm getting tangled in mixins and namespaces. I can't quite get it to work
[2013-04-18 16:28:37 -0400] directionless: barefoot: https://gist.github.com/directionless/5414106  has a very truncated set of files/outputs.
[2013-04-18 16:29:48 -0400] mconigliaro: ugh, has anyone figured out how to load custom ohai plugins? I'm following http://docs.opscode.com/ohai_plugins.html, and it's not working...
[2013-04-18 16:29:52 -0400] gad0lin: FunnyLookinHat: I would solve that with loadbalancer, e.g. nginx
[2013-04-18 16:30:40 -0400] gad0lin: FunnyLookinHat: you will update nginx config depending on the chef searches
[2013-04-18 16:39:32 -0400] directionless: Ah ha. If I remove the Class Chef::Recipe and just put in the global namespace, it works
[2013-04-18 16:49:25 -0400] barefoot: mconigliaro: what problem are you having with them
[2013-04-18 16:54:48 -0400] gad0lin: any chef-server cookbook master around? it fails behind the proxy, in omnitruck_client.rb?
[2013-04-18 16:56:59 -0400] gad0lin: I wonder what is the best practice to set http_proxy in cookbook when you make call from ruby libs, i guess there should be sth like http = Net::HTTP.new(url.host, url.port, URI(proxy).host, URI(proxy).port )  if proxy =  ENV["http_proxy"] not nil
[2013-04-18 16:58:10 -0400] gad0lin: not it in recipe it is  http = Net::HTTP.new(url.host, url.port), and that does not use  http_proxy from env
[2013-04-18 16:58:21 -0400] gad0lin: s/not/now/
[2013-04-18 17:03:05 -0400] mconigliaro: barefoot: it looks like it's just not loading the custom plugins
[2013-04-18 17:03:20 -0400] mconigliaro: i verified that the plugin directory is correct, and the files are there
[2013-04-18 17:03:26 -0400] djustin: when using the registry_key resource, is there any real difference between actions :create and :create_if_missing?
[2013-04-18 17:03:48 -0400] mconigliaro: but o.orly always returns nil
[2013-04-18 17:03:58 -0400] mconigliaro: i basically just followed the example
[2013-04-18 17:15:16 -0400] barefoot: mconigliaro: hmm, can you pastebin your session? it works for me
[2013-04-18 17:17:14 -0400] mconigliaro: barefoot: https://gist.github.com/mconigliaro/ac4df9a50654539c6373
[2013-04-18 17:19:00 -0400] mconigliaro: am i missing something stupid?
[2013-04-18 17:19:13 -0400] mconigliaro: that's basically the example from the opscode docs
[2013-04-18 17:20:06 -0400] barefoot: hmm
[2013-04-18 17:20:18 -0400] barefoot: its nil when I drop it in /etc/chef/ohai_plugins as well
[2013-04-18 17:20:35 -0400] barefoot: but works from ~/.plugins when added the same way to plugin_path
[2013-04-18 17:20:48 -0400] mconigliaro: odd
[2013-04-18 17:24:00 -0400] ranjibd: BryanWB: every resource has a source line
[2013-04-18 17:32:54 -0400] barefoot: mconigliaro: no idea why, but it works now oO
[2013-04-18 17:33:05 -0400] mconigliaro: haha
[2013-04-18 17:33:06 -0400] barefoot: irb(main):006:0> o.orly
[2013-04-18 17:33:06 -0400] barefoot: => "yeah, rly."
[2013-04-18 17:33:13 -0400] mconigliaro: and its still in the same place?
[2013-04-18 17:33:17 -0400] mconigliaro: the /etc location?
[2013-04-18 17:33:18 -0400] barefoot: yeah
[2013-04-18 17:37:03 -0400] mconigliaro: and you didn't change anything
[2013-04-18 17:37:03 -0400] mconigliaro: ?
[2013-04-18 17:37:17 -0400] barefoot: no, just ran it again heh
[2013-04-18 17:39:14 -0400] barefoot: mconigliaro: http://pastebin.com/Lf7KiyXn
[2013-04-18 17:43:56 -0400] david415: hi
[2013-04-18 17:44:17 -0400] david415: berkshelf fans... we've done it! we have beat berkshelf into submission.
[2013-04-18 17:44:45 -0400] david415: it'll play nicely with our CI system and our usage of envornments...
[2013-04-18 17:45:01 -0400] david415: however we had to write a custom release/deploy script utilizing the berkshelf api
[2013-04-18 17:45:09 -0400] david415: i plan on open sourcing this soon.
[2013-04-18 17:46:06 -0400] david415: if no one here gives a shit then it might mean that you do not test your cookbooks via CI in for instance a staging environment before pushing those changes to a production environment
[2013-04-18 17:46:46 -0400] david415: i think environments are a good idea! also CI is good too!
[2013-04-18 17:48:07 -0400] zts: david415: I look forward to the open sourcing and write-up :)
[2013-04-18 17:48:32 -0400] david415: zts: yes... to be fair it does deserve a write-up.
[2013-04-18 17:49:15 -0400] david415: since it is tricky to explain... i will even have my collegues review the write up.
[2013-04-18 17:50:11 -0400] skroon: hi
[2013-04-18 17:50:20 -0400] david415: hi
[2013-04-18 17:50:54 -0400] skroon: how much is chef-server different from chef-solo, can I use the same cookbooks etc?
[2013-04-18 17:51:57 -0400] adamjk-dev: skroon: yes
[2013-04-18 17:52:29 -0400] adamjk-dev: skroon: chef solo just download the cookbooks from "someone's" chef server and runs then locally (by mounting shared folders to the VM being provisioned etc.)
[2013-04-18 17:52:43 -0400] zts: skroon: for the most part - if the cookbook requires server features, it obviously won't work
[2013-04-18 17:52:46 -0400] adamjk-dev: skroon: so yes, you use the same cookbooks... just beware the limitations of chef solo
[2013-04-18 17:54:16 -0400] skroon: adamjk-dev: does that also mean I can start learning chef-solo step-by-step and then later on move to chef-server, or you say just go with chef-server directly if I want to go for it eventually?
[2013-04-18 17:54:49 -0400] adamjk-dev: skroon: chef solo has its limitations (no search, etc.)
[2013-04-18 17:54:54 -0400] billyoung: @skroon if you're just looking for a place to learn, i'd recommend signing up for a free opscode "hosted chef" account
[2013-04-18 17:55:15 -0400] billyoung: pair that up with a vagrant dev environment, and you'll be good to go
[2013-04-18 17:55:28 -0400] adamjk-dev: skroon: http://serverfault.com/questions/283470/what-are-the-benefits-of-running-chef-server-instead-of-chef-solo
[2013-04-18 17:55:44 -0400] skroon: great, reading...
[2013-04-18 17:55:51 -0400] adamjk-dev: skroon: lol
[2013-04-18 17:56:17 -0400] adamjk-dev: skroon: billyoung has a point.... we host our own chef server
[2013-04-18 17:56:41 -0400] theCzar: OK, so I've created my own LWRP and it works great.  Except when I try to notify it from another resource.  Then it just gets skipped.  Any idea what I could check first?
[2013-04-18 17:56:50 -0400] skroon: billyoung: just signed up indeed :-)
[2013-04-18 17:57:16 -0400] billyoung: skroon: awesome! happy hacking :)
[2013-04-18 17:58:17 -0400] skroon: i'm planning to use LXC, instead of full virtualization at the moment. When I want to be able to automatically start up new machines, and have them contact tact chef directly after startup. I'm guessing this can only be done, if I supply a special template for the new machine, which already knows how to reach chef-server and which role it should assign it self right?
[2013-04-18 17:59:30 -0400] billyoung: skroon: are you just starting up with chef, or have you read the entry level docs already?
[2013-04-18 17:59:42 -0400] spox: skroon: see also, lxc cookbook
[2013-04-18 18:00:18 -0400] skroon: billyoung: to behonest, I find the documentation really hard to follow, and the pages don't really are looking all that great, so I find it hard to find a good place to start reading about chef-server
[2013-04-18 18:00:54 -0400] billyoung: skroon:  this may be useful https://learnchef.opscode.com/
[2013-04-18 18:00:56 -0400] skroon: billyoung: I have seen lot's of screencasts already, and read the cucumber-chef book, but still it all feels a bit vague to me, so I really need to get started and play around :)
[2013-04-18 18:01:05 -0400] billyoung: it doesn't go into detail, but its a good starting point
[2013-04-18 18:01:12 -0400] awgross1: anyone else getting JSON Parse errors when trying to hit the chef search API?
[2013-04-18 18:01:16 -0400] awgross1: (hosted chef)
[2013-04-18 18:01:20 -0400] mconigliaro: barefoot: interesting. it works in that script, but not in irb
[2013-04-18 18:01:34 -0400] barefoot: hmm that is odd
[2013-04-18 18:01:51 -0400] skroon: spox: great, it will have the containers automatically connect to the chef-server?
[2013-04-18 18:02:18 -0400] jtimberman: https://twitter.com/ChefConf/status/324945505446682625
[2013-04-18 18:03:21 -0400] billyoung: @jtimberman w00t!
[2013-04-18 18:04:37 -0400] theCzar: Anyone know how to make it so that a LWRP can accept notifications?
[2013-04-18 18:04:59 -0400] theCzar: or point me toward the documentation on how to do so?
[2013-04-18 18:06:00 -0400] skroon: i'm guessing the chef-server is hard to find, because ideally everyone should use opscode hosted chef? :)
[2013-04-18 18:06:48 -0400] pizzahead: Can someone explain to me how I'm supposed to create user hashes?  I'm almost to the point of rolling out chef into our production environment but I think I might be lacking knowledge with an important aspect.  Right now I'm trying to use the rvm cookbook gem to have it install under a user and their documentation says to create a user hash like this: http://pastebin.com/raw.php?i=pWKaVyYQ  .  I've created recipes and configured attributes in roles but I'm con
[2013-04-18 18:11:37 -0400] awgross1: Still seeing a JSON encoding issue, Search and Databag JSON parsing    UndefinedConversionError: "\x8B" from ASCII-8BIT to UTF-8>
[2013-04-18 18:11:45 -0400] awgross1: Ruby 1.9, Chec 10.18.2
[2013-04-18 18:20:05 -0400] awgross1: Is there an issue with the databags API endpoint right now? Still seeing lots of issues on one of my accounts
[2013-04-18 18:25:57 -0400] markp_: ohai chefs!
[2013-04-18 18:26:24 -0400] markp_: i have a problem with merging hashes
[2013-04-18 18:27:15 -0400] markp_: i copy the hash output of a node object ... hash = node.myattr.to_hash
[2013-04-18 18:27:45 -0400] markp_: Then load a data bag and attempt to merge databag["key"] to hash
[2013-04-18 18:27:57 -0400] markp_: always get an Immutable Error
[2013-04-18 18:28:31 -0400] markp_: not trying to write to the node object just another hash with entries from node object
[2013-04-18 18:33:16 -0400] skroon: does the chef-server portion need a UI? or it's mostly configured via config files and cli ?
[2013-04-18 18:33:36 -0400] laurent\: it doesn't
[2013-04-18 18:36:48 -0400] laurent\: and to answer to your question before, my bootstrap script install chef-client and configure it; most people use http://docs.opscode.com/install_bootstrap.html
[2013-04-18 18:37:20 -0400] skroon: laurent\: thanks
[2013-04-18 18:38:53 -0400] jaclar: hi there
[2013-04-18 18:38:59 -0400] jaclar: how can i limit knife commands to specific environments?
[2013-04-18 18:39:24 -0400] jaclar: knife ssh "role:web" "uptime" -E ENVIRONMENTNAME gives me all nodes
[2013-04-18 18:41:08 -0400] log1kal: chef_environment:foo AND role:web
[2013-04-18 18:41:47 -0400] log1kal: that's a horrible response, let me clean it up
[2013-04-18 18:42:54 -0400] log1kal: jaclar: you can use "chef_environment" in your search terms to limit to a specific environment. in your case: knife ssh "chef_environment:foo AND role:web" "uptime"
[2013-04-18 18:43:09 -0400] jaclar: great!
[2013-04-18 18:43:27 -0400] jaclar: already tried it and it works like breeze.
[2013-04-18 18:43:43 -0400] log1kal: woot!
[2013-04-18 18:44:01 -0400] jaclar: thanks loglkal!
[2013-04-18 18:53:58 -0400] holoway: theCzar: they just do automatically - you don't have to do any work at all
[2013-04-18 18:54:07 -0400] skroon: laurent\: so you also use your own chef-server instance?
[2013-04-18 18:55:14 -0400] pizzahead: Can someone explain to me how I'm supposed to create user hashes?  I'm almost to the point of rolling out chef into our production environment but I think I might be lacking knowledge with an important aspect.  Right now I'm trying to use the rvm cookbook gem to have it install under a user and their documentation says to create a user hash like this: http://pastebin.com/raw.php?i=pWKaVyYQ  .  I've created recipes and configured attributes in roles but I'm con
[2013-04-18 18:56:03 -0400] theCzar: holoway... well it's not working for me for some reason.  I can use the resource just fine, but if I try to use notifications, it just gets skipped
[2013-04-18 18:56:19 -0400] log1kal: pizzahead: you're getting cut off after your pastebin link
[2013-04-18 18:57:04 -0400] pizzahead: log1kal: does the pastebin link complete?
[2013-04-18 18:57:27 -0400] log1kal: yes
[2013-04-18 18:57:29 -0400] pizzahead: log1kal: I had been trying to figure out how specify what I put in pastebin into a role
[2013-04-18 18:57:38 -0400] pizzahead: log1kal: but I'm not sure if it's uspposed to end up in a data bag?
[2013-04-18 18:57:55 -0400] pizzahead: log1kal: they keep referring to "user hashes"
[2013-04-18 18:58:09 -0400] pizzahead: this is the cookbook, https://github.com/fnichol/chef-rvm
[2013-04-18 18:58:33 -0400] pizzahead: and I'm trying to install rvm as a particular user by using recipe rvm::user
[2013-04-18 18:58:52 -0400] pizzahead: 'add a user hash to the user_installs attribute list'
[2013-04-18 18:59:48 -0400] barefoot: pizzahead: yeah, the one in attributes/default.rb
[2013-04-18 19:00:29 -0400] zts: pizzahead: can you pastebin the role you've tried?
[2013-04-18 19:01:04 -0400] mahmoudimus: What other tools are recommended for provisioning systems on AWS/Rackspace/etc? I'm not interested in configuring them -- chef's great at that, but essentially figuring out how to provision them. These tools would ideally that complement Chef.
[2013-04-18 19:01:42 -0400] log1kal: mahmoudimus: we use cloudformation in AWS, but I'm not sure I could recommend it.
[2013-04-18 19:01:58 -0400] zts: theCzar: can you pastebin an example showing how you're notifying the LWRP, and also what shows up in the logs of your chef run?
[2013-04-18 19:02:05 -0400] log1kal: I really liked ironfan's "clusters", but it didn't support everything we needed when we evaluated it
[2013-04-18 19:02:19 -0400] holoway: theCzar: what do you mean, it gets skipped? are you notifying from another LWRP? Is it setting new_resource.updated_by_last_action?
[2013-04-18 19:02:20 -0400] mahmoudimus: log1kal, interesting - I've heard about Opswerk as well (though haven't heard anything about it)
[2013-04-18 19:02:34 -0400] log1kal: Yeah, we haven't checked out opsworks yet
[2013-04-18 19:03:07 -0400] mahmoudimus: We tried to do provisioning with Chef and it's just a clusterfuck :P
[2013-04-18 19:03:10 -0400] theCzar: zts: for sure, one sec
[2013-04-18 19:03:56 -0400] log1kal: pizzahead: I'm sorry, I haven't used chef-rvm extensively
[2013-04-18 19:06:54 -0400] theCzar: zts: http://pastebin.com/W7jFZsey  Here's the output of the run
[2013-04-18 19:07:11 -0400] theCzar: zts: and here's how I'm calling the lwrp: http://pastebin.com/FeUuA0hH
[2013-04-18 19:07:56 -0400] theCzar: Basically you can see where the github[clone_monitor_repo] gets called in the output, but it doesn't do anything.  Causing the run to fail
[2013-04-18 19:08:16 -0400] theCzar: when it tries to execute the next resource
[2013-04-18 19:08:59 -0400] theCzar: holoway: I have a notifies in my ruby_block which sends :sync to my github lwrp but it doesn't actually do anything which causes the next resource to fail
[2013-04-18 19:09:20 -0400] pizzahead: log1kal: do you understand what they mean by hashes and where they need to be stored?
[2013-04-18 19:09:21 -0400] theCzar: holoway: I'm not familiar with the new_resource.updated_by_last_action?  where's that documented?
[2013-04-18 19:13:47 -0400] zts: theCzar: does your github resource work with "action :sync" (ie, not using notifies)
[2013-04-18 19:13:55 -0400] theCzar: zts: yes
[2013-04-18 19:14:40 -0400] theCzar: This is on Chef-Solo, does that make a difference?
[2013-04-18 19:15:05 -0400] zts: theCzar: no, that won't make a difference
[2013-04-18 19:15:44 -0400] zts: theCzar: I'm not sure, is the code to this github LWRP anywhere I can see it?  I think my next step would be to add some logging to the provider code to check whether the action is being invoked, because that log looks like it is
[2013-04-18 19:16:58 -0400] theCzar: zts: https://github.com/Pagoda/chef-github/tree/lwrp you'll find it in the default files under resources & providers
[2013-04-18 19:17:57 -0400] zts: theCzar: at a guess, the issue is that the inlined resources aren't converging before your other notification fires
[2013-04-18 19:18:02 -0400] zts: theCzar: you will need to use inline compilation mode
[2013-04-18 19:18:21 -0400] zts: theCzar: see http://docs.opscode.com/breaking_changes_chef_11.html#inline-compile-mode-for-lightweight-resources
[2013-04-18 19:19:02 -0400] pizzahead: bah, I just set it in /attributes/default.rb :P
[2013-04-18 19:23:06 -0400] theCzar: zts: well, what do you know?  That worked
[2013-04-18 19:23:31 -0400] theCzar: does that only work with chef 11 on?
[2013-04-18 19:24:23 -0400] tmichael: have chef-validator issue where what's in db doesn't match what's on fs.  how do i regenerate in chef 11?  in chef 10 i thought i just removed from fs and restarted chef, but doesn't seem to work in chef 11
[2013-04-18 19:24:24 -0400] zts: theCzar: yeah, there are hoops you can jump through to achieve the same thing on Chef 10
[2013-04-18 19:24:57 -0400] zts: theCzar: to be honest, I'm a bit confused about what you're doing, though - is that example simplified from what you're planning on doing?
[2013-04-18 19:25:18 -0400] zts: ...actually, that wouldn't help, nevermind
[2013-04-18 19:26:28 -0400] theCzar: zts: simply put the github lwrp is meant to be a convenience wrapper for the git resource to make it easy to clone private repos from github
[2013-04-18 19:26:57 -0400] zts: theCzar: no no, I meant the ruby_block having the not_if, and sending two immediate notifications
[2013-04-18 19:27:34 -0400] zts: theCzar: I was going to suggest that your github resource might notify the execute instead, but that actually does nothing to help you in this case
[2013-04-18 19:28:53 -0400] theCzar: zts: oh, yeah, I generally like that pattern more than just daisy chaining them
[2013-04-18 19:29:56 -0400] zts: theCzar: http://realityforge.org/code/2012/07/17/lwrp-notify-on-changed-resources.html <- You'll need to get your ruby on, but that's what inline compilation mode is basically doing
[2013-04-18 19:34:41 -0400] theCzar: zts: oh i stumbled on this earlier but figured it was talking about something else because the documentation made it sound like lwrps already supported notifies.
[2013-04-18 19:37:26 -0400] zts: theCzar: :) they do, but "it's complicated".  A simpler solution in your case might be to change your notification to the execute resource so that it's delayed, instead of immediate
[2013-04-18 19:37:47 -0400] zts: theCzar: but you're not wrong in thinking that you've found a gotcha
[2013-04-18 19:38:26 -0400] theCzar: zts: haha, alright, well thanks for helping me out with that
[2013-04-18 19:38:38 -0400] zts: you're welcome :)
[2013-04-18 19:39:30 -0400] Kzim: Hi
[2013-04-18 19:40:59 -0400] Kzim: i have some trouble manage my recipe for step by step process. like start a service if it is stoped then execute this ruby code then start another process etc. anyone know the best practices or have a good documentation about that please ?
[2013-04-18 19:41:18 -0400] markp: can anyone help with merging hashes in a recipe
[2013-04-18 19:41:30 -0400] markp: getting Immutable errors
[2013-04-18 19:43:20 -0400] dfrey: is there a way to write ruby code inside a resource?
[2013-04-18 19:45:13 -0400] dfrey: ruby_block, got it
[2013-04-18 20:08:53 -0400] heathsnow: Anyone familiar with the 2.0 version of the rabbitmq cookbook?  Even if not...does anyone know what's wrong with the following cmd on a rabbit server:  rabbitmqctl set_permissions -p / uatq "".*"" "".*"" "".*""
[2013-04-18 20:09:33 -0400] heathsnow: blech....too many ""
[2013-04-18 20:09:34 -0400] heathsnow:  :P
[2013-04-18 20:20:32 -0400] steveb: hey, anyone here going to ChefConf next week?
[2013-04-18 20:20:40 -0400] doomviking: yup
[2013-04-18 20:20:45 -0400] pcn: yup
[2013-04-18 20:20:52 -0400] steveb: did you get confirmation emails after booking?
[2013-04-18 20:21:02 -0400] steveb: (also awesome. see you there :) )
[2013-04-18 20:21:15 -0400] zts: yup I'm going, presume I got confirmation mails but it was some time ago :)
[2013-04-18 20:21:17 -0400] jackl0phty: yup. chefconf whooo hooo!
[2013-04-18 20:21:30 -0400] akhet: chefffffffconffffffff
[2013-04-18 20:22:02 -0400] steveb: Mine were booked for me last week or the week before or something. Didn't get an email so just wanted to see if they had actually been sent or if something went wrong in the mean time
[2013-04-18 20:22:15 -0400] doomviking: no email confirmation, but I have a receipt and a plane ticket and a hotel. so I think I'll be there.
[2013-04-18 20:22:23 -0400] pcn: Yeah, there was an email receipt confirmation after payment
[2013-04-18 20:22:42 -0400] steveb: interesting
[2013-04-18 20:22:49 -0400] steveb: hmm
[2013-04-18 20:22:52 -0400] pcn: look for an email from busyconf.com
[2013-04-18 20:23:18 -0400] steveb: i shall. I'll also ask the person who booked it to check
[2013-04-18 20:23:23 -0400] steveb: thanks guys :) see you there (i hope)
[2013-04-18 20:24:59 -0400] doomviking: sold out. so you'd better get on that :)
[2013-04-18 20:25:08 -0400] steveb: right
[2013-04-18 20:27:34 -0400] RayS: I'm installing nginx::source and on first run its not compiling nginx, on second run through it does...
[2013-04-18 20:30:47 -0400] RayS: anyone seen that before?
[2013-04-18 21:04:06 -0400] adamjk-dev: anyone using vagrant 1.2.1
[2013-04-18 21:04:12 -0400] adamjk-dev: and having trouble importing boxes?
[2013-04-18 21:04:36 -0400] adamjk-dev: vagrant up
[2013-04-18 21:04:36 -0400] adamjk-dev: Bringing machine 'default' up with 'virtualbox' provider...
[2013-04-18 21:04:37 -0400] adamjk-dev: [default] Box 'rhel-5.8-x86_64' was not found. Fetching box from specified URL for
[2013-04-18 21:04:37 -0400] adamjk-dev: the provider 'virtualbox'. Note that if the URL does not have
[2013-04-18 21:04:37 -0400] adamjk-dev: a box for this provider, you should interrupt Vagrant now and add
[2013-04-18 21:04:37 -0400] adamjk-dev: the box yourself. Otherwise Vagrant will attempt to download the
[2013-04-18 21:04:37 -0400] adamjk-dev: full box prior to discovering this error.
[2013-04-18 21:04:38 -0400] adamjk-dev: Downloading or copying the box...
[2013-04-18 21:04:38 -0400] adamjk-dev: An error occurred while downloading the remote file. The error
[2013-04-18 21:04:39 -0400] adamjk-dev: message, if any, is reproduced below. Please fix this error and try
[2013-04-18 21:04:39 -0400] adamjk-dev: again.
[2013-04-18 21:04:40 -0400] adamjk-dev: Failed initialization
[2013-04-18 21:05:41 -0400] doomviking: possibly the wrong channel for that q
[2013-04-18 21:15:12 -0400] adamjk-dev: i asked in vagrant too
[2013-04-18 21:15:16 -0400] adamjk-dev: i think it is an open issue
[2013-04-18 21:27:52 -0400] chef_newbie: hey guys..a newb question...i am using hosted chef and i have some secret keys that i need to push during the bootstrap...is there a way for me to do that without creating a recipe?
[2013-04-18 21:30:16 -0400] chef_newbie: i cant create a recipe coz then it is publicly available on the chef server
[2013-04-18 21:32:34 -0400] whack: knife is trying to install cookbooks to the wrong place, it seems: https://gist.github.com/jordansissel/385ca85e9ee2113f521b - any ideas?
[2013-04-18 21:33:02 -0400] whack: ( I know the cookbook_path looks weird, but the repo I'm working with is weird, it's not related;) )
[2013-04-18 21:34:45 -0400] gyre007: anyone knows if berkshelf-vagrant is working with vagrant 1.2 ??
[2013-04-18 21:35:16 -0400] ivey: gyre007: i have done testing w/ vbox and it's ok, have a fix for aws
[2013-04-18 21:35:31 -0400] jarthur: Any of you interested in some indie contracting? Got an Amazon OpsWork project in the works.
[2013-04-18 21:36:20 -0400] gyre007: Im on vagrant 1.1 wich works....and noticed that 1.2 was released yesterday....might give it a sot ivey....cheers for the heads up!
[2013-04-18 21:36:37 -0400] gyre007: jarthur: aaah amazon Opswork...Chef ripoff :)
[2013-04-18 21:36:50 -0400] ivey: ping me in #berkshelf or gh issues for berkshelf-vagrant if you have any issues
[2013-04-18 21:37:18 -0400] gyre007: ivey: will do...I'll be playing with the new version in couple of hours ish...will let you know indeed!
[2013-04-18 21:37:25 -0400] doomviking: chef_newbie: look at encrypted data bags
[2013-04-18 21:37:39 -0400] jarthur: gyre007: yea, and it's a old, hacked up version of Chhef. It offers nice one-click buttons for clustery operations though.
[2013-04-18 21:37:53 -0400] doomviking: oh, bootstrap. hrm.
[2013-04-18 21:38:28 -0400] gyre007: ivey: what version of berkshelf plugins are you using with 1.2 ?
[2013-04-18 21:38:36 -0400] gyre007: I mean vagrant 1.2 ...
[2013-04-18 21:38:37 -0400] gokr: I am using "knife ec2 server create" blabla with chef11, but the output from the chef client run is... debug level?
[2013-04-18 21:38:48 -0400] ivey: gyre007: latest
[2013-04-18 21:38:50 -0400] gokr: And what is all this "[0m" and "[32m" etc...
[2013-04-18 21:38:57 -0400] gyre007: gokr: tthat is configurable afaik
[2013-04-18 21:39:03 -0400] gyre007: ivey: cheers
[2013-04-18 21:39:30 -0400] gokr: gyre007: As option to "knife ec2 server create" ? Hmmm.
[2013-04-18 21:39:43 -0400] gyre007: nope...in knife...
[2013-04-18 21:39:50 -0400] gokr: aaah.
[2013-04-18 21:40:08 -0400] gokr: I have :info
[2013-04-18 21:40:31 -0400] gokr: Hmmm, I read something about this 10 min ago...
[2013-04-18 21:40:38 -0400] chef_newbie: i have the encrypted data bags but how do i get the data bag secret key to the client server with bootstrap
[2013-04-18 21:40:45 -0400] gyre007: but the client config on the newly created client is overriding it...or some other dodgy stuff...there was some mention of this in jira
[2013-04-18 21:40:56 -0400] gyre007: chef_newbie: scp ?
[2013-04-18 21:41:16 -0400] chef_newbie: whats the point of automation then?
[2013-04-18 21:41:59 -0400] ehlerst: chef_newbie, you may as well push out your chef secret key with puppet then =)
[2013-04-18 21:42:02 -0400] chef_newbie: if i have 100 servers that i need to bootstrap...i would like an automated way to push my secret key out to the clients
[2013-04-18 21:42:32 -0400] doomviking: chef_newbie: knife.rb can have encrypted_data_bag_secret '/path/to/local/encrypted_dbag_key'
[2013-04-18 21:42:53 -0400] gyre007: doomviking: but that requires bootstrap
[2013-04-18 21:43:02 -0400] gyre007: and chef_newbie doesnt like that...apparently
[2013-04-18 21:43:06 -0400] gokr: Btw, slightly off topic - anyone using CloudSigma here? Curious about it vs EC2.
[2013-04-18 21:43:10 -0400] gyre007: oh
[2013-04-18 21:43:15 -0400] gyre007: WITH...I misread that
[2013-04-18 21:43:15 -0400] chef_newbie: hmmm..i was looking at http://docs.opscode.com/knife_bootstrap.html but didnt find that option
[2013-04-18 21:43:17 -0400] doomviking: I thought this was on bootstrap
[2013-04-18 21:43:18 -0400] gyre007: yeah
[2013-04-18 21:43:24 -0400] gyre007: listen to doomviking
[2013-04-18 21:43:31 -0400] gyre007: man...I have serious dyslexia :)
[2013-04-18 21:43:33 -0400] gyre007: oopsie
[2013-04-18 21:43:44 -0400] gyre007: my bad
[2013-04-18 21:44:06 -0400] chef_newbie: yes iam talkin about during bootstrap
[2013-04-18 21:44:25 -0400] joemiller: PR: rename chef-solo to chef-yolo, what do you think?
[2013-04-18 21:44:45 -0400] chef_newbie: doomviking: so if i can specify "encrypted_data_bag_secret '/path/to/local/encrypted_dbag_key'" as you suggested..then that might work
[2013-04-18 21:45:05 -0400] doomviking: chef_newbie: its in the example here: http://docs.opscode.com/essentials_data_bags_encrypt.html
[2013-04-18 21:45:13 -0400] gyre007: chef_newbie: that should work...im doing the same thing on daily basis :)
[2013-04-18 21:45:25 -0400] gyre007: only with rackspace plugin...
[2013-04-18 21:45:27 -0400] doomviking: it is definitely what I am doing :)
[2013-04-18 21:45:45 -0400] doomviking: with ec2. but that doesnt matter
[2013-04-18 21:45:50 -0400] doomviking: I dont think
[2013-04-18 21:46:32 -0400] chef_newbie: "/path/to/your/data_bag_key to the location of where the data bag key is locate" -> looks like would just set the path to the key...would this also push the key to client server?
[2013-04-18 21:46:42 -0400] doomviking: thats the idea
[2013-04-18 21:46:48 -0400] cwj: is there a reasonable way to detect if a recipe is running in an omnibus chef install?
[2013-04-18 21:47:00 -0400] mivok: Hi, is there a simple way if you have a lightweight provider to include Chef::Mixin::Command (or other quick way to grab the output of a command)?
[2013-04-18 21:47:49 -0400] mivok: (require 'chef/mixin/command'; include Chef::Mixin::Command doesn't seem to work - I'm guessing there's something obvious I'm missing)
[2013-04-18 21:47:55 -0400] doomviking: should put it in /etc/chef/encrypted_data_bag_secret by default
[2013-04-18 21:48:03 -0400] jtimberman: chef_newbie: if you have a secret file (encrypted_data_bag_secret "/path/to/my_secret", e.g. in knife.rb), then it will be copied by the knife bootstrap plugin.
[2013-04-18 21:48:12 -0400] jtimberman: if you're using the chef-full bootstrap template (this is the default)
[2013-04-18 21:48:30 -0400] chef_newbie: knife bootstrap mysuperserver.com --run-list "role[blah]" -E development --encrypted_data_bag_secret '/path/to/your/data_bag_key'
[2013-04-18 21:48:33 -0400] chef_newbie: i can do that?
[2013-04-18 21:49:46 -0400] chef_newbie: oh wait
[2013-04-18 21:49:51 -0400] chef_newbie: i know what you are saying
[2013-04-18 21:50:10 -0400] chef_newbie: but where would it put in the client server?
[2013-04-18 21:50:56 -0400] doomviking: should put it in /etc/chef/encrypted_data_bag_secret by default
[2013-04-18 21:51:24 -0400] chef_newbie: i guess i can test that to see where it would put the secret key
[2013-04-18 21:51:34 -0400] chef_newbie: im assuming it would go in /etc/chef dir
[2013-04-18 21:51:43 -0400] chef_newbie: oh cool
[2013-04-18 21:51:50 -0400] chef_newbie: yeah that might work
[2013-04-18 21:52:11 -0400] chef_newbie: thanks alot doomviking, jtimberman and gyre007
[2013-04-18 21:53:08 -0400] mivok: for reference, the something stupid I happened to be missing was that I didn't need to require 'chef/mixin/command' at all
[2013-04-18 21:56:16 -0400] gokr: Aha, the "[32m" etc are bash color codes... ok.
[2013-04-18 22:01:46 -0400] tmichael: i need to quit a chef run with explanatory log message.  thought i could do with Chef::Application.fatal! but not showing up in Chef-Shell as option
[2013-04-18 22:12:24 -0400] gansbrest: hi. If I need to distribute different config files depending on let say instance size, how would I do it with chef?
[2013-04-18 22:13:06 -0400] troyready: gansbrest, you could your recipe to include different templates depending on any given evaluation
[2013-04-18 22:13:33 -0400] gansbrest: ah, so I would read ohai properties of the node and use different template source?
[2013-04-18 22:14:44 -0400] troyready: gansbrest, Yeah, I think that's what I'd do
[2013-04-18 22:18:31 -0400] troyready: Anyone know how (or the best way) to compare two existing files on a system in a chef recipe? I'm looking to do something like "if (localfile1.checksum) != (localfile2.checksum)", but I'm at a loss as to what exactly to call to do it
[2013-04-18 22:18:39 -0400] juliancdunn: gokr: you can run with --no-color if you want to turn those off (they won't render under Windows)
[2013-04-18 22:19:22 -0400] gokr: juliancdunn: Those are actually not my problem, I am wondering why I don't get any "INFO:" etc. Those are the logger outputs I gather.
[2013-04-18 22:19:34 -0400] juliancdunn: troyready: Chef::Digester.checksum_for_file can do that
[2013-04-18 22:20:16 -0400] juliancdunn: gokr: the default formatter when running interactively is different than the one running as a service
[2013-04-18 22:20:25 -0400] juliancdunn: there's a "-F" flag to chef-client that will let you change that
[2013-04-18 22:20:25 -0400] gokr: juliancdunn: Also, I am using "knife ec2 server create" here so... :) not sure how I can affect options like "--no-color"
[2013-04-18 22:20:47 -0400] gokr: Yeah, but... what values can I use for -F?
[2013-04-18 22:20:51 -0400] gokr: I can't tell.
[2013-04-18 22:20:56 -0400] juliancdunn: gokr: knife will take --no-color as well
[2013-04-18 22:21:03 -0400] juliancdunn: there's an "-Fdoc"
[2013-04-18 22:22:01 -0400] troyready: juliancdunn, thanks -- would that be like "if Chef::Digester.checksum_for_file("filename1) == ..." then?
[2013-04-18 22:22:18 -0400] gokr: -Fdoc?
[2013-04-18 22:22:55 -0400] juliancdunn: troyready: yeah exactly
[2013-04-18 22:23:00 -0400] gokr: I have a little state machine looking for these "INFO:" etc, but... not sure why they disappeared when I moved to chef 11.
[2013-04-18 22:23:16 -0400] troyready: juliancdunn, sweet, thanks so much
[2013-04-18 22:23:17 -0400] juliancdunn: troyready: you, of course, need to have "require 'chef/digester'"
[2013-04-18 22:24:30 -0400] juliancdunn: gokr: http://wiki.opscode.com/display/chef/Breaking+Changes+in+Chef+11
[2013-04-18 22:24:36 -0400] juliancdunn: read "Output Formatters are the Default Output when Running in the Console"
[2013-04-18 22:24:50 -0400] gokr: I have read that but I don't get it :)
[2013-04-18 22:25:11 -0400] juliancdunn: gokr: so previous to Chef 11 there was only one formatter which formatted everything the same way
[2013-04-18 22:25:52 -0400] juliancdunn: if you run with "--force-logger" you can get the Chef 10 behaviour, which is to write to interactive sessions in the same way that a daemon would write to log files
[2013-04-18 22:25:58 -0400] troyready: juliancdunn, interesting. Sorry for the noob follow up question, but why is that? Is there something I can read to understand why I can use something like "remote file 'blah'", but Chef::Digester needs a require statement?
[2013-04-18 22:26:37 -0400] gokr: Sooo... ok, it runs with "warn" and thus I don't get my INFOs. But how do I get "knife ec2 server create" to use --force-logger?
[2013-04-18 22:27:01 -0400] juliancdunn: troyready: because you wanted to write extra logic that isn't part of defining a resource
[2013-04-18 22:27:05 -0400] juliancdunn: "remote_file" is a resource
[2013-04-18 22:27:23 -0400] juliancdunn: maybe you can back up and show what you're trying to do in general?
[2013-04-18 22:27:58 -0400] juliancdunn: gokr: which part is showing the undesired output -- the first chef client run on the target?
[2013-04-18 22:28:24 -0400] gokr: Yeah, or rather - it doesn't include the logger output, only the colored bash stuff.
[2013-04-18 22:28:45 -0400] gokr: And I am not sure what to tell "knife ec2" to get the logger output.
[2013-04-18 22:29:11 -0400] david415: coderanger: chef11 server resolves deps for a given cookbook and looking at the deps for ALL versions of a given cookbook instead of the latest one... ;-(
[2013-04-18 22:29:20 -0400] troyready: juliancdunn, Yeah, totally: I have a vendor's script on a server that my chef recipe is running, which is creating a file (/tmp/newoutput.txt)
[2013-04-18 22:29:27 -0400] coderanger: david415: Hmm?
[2013-04-18 22:29:32 -0400] gokr: I do notice it sets client.rb loglevel to :auto - instead of :info. But not sure how to make "knife ec2" set it to :info.
[2013-04-18 22:29:51 -0400] troyready: juliancdunn, I'd like the recipe to compare this new file to an existing file on the system (via a checksum), and then take different actions depending on the outcome
[2013-04-18 22:29:51 -0400] david415: coderanger: John here at causes seems to have found a bug...
[2013-04-18 22:30:06 -0400] troyready: juliancdunn, (i.e. if they match, do X, else do X)
[2013-04-18 22:31:23 -0400] coderanger: david415: Not sure what you mean, thats kind of the point :) It tries to preferentially weight towards more recent versions when solving but it has to solve all constraints too
[2013-04-18 22:31:33 -0400] coderanger: david415: Having old versions included is a feature, not a bug :)
[2013-04-18 22:31:59 -0400] troyready: juliancdunn, obviously, my code writing experience is pretty limited (thus these types of questions) :)
[2013-04-18 22:32:54 -0400] david415: we had an old version of cookbook 'foo' which depends on cookbook 'bar'; the new version of 'foo' no longer depends on 'bar'; we remove 'bar' from the chef server. now cookbook 'foo' doesn't work because the dependency resolver is unsatisfied since an older version of 'foo' has an unresolvable dependency.
[2013-04-18 22:32:59 -0400] david415: that's a feature?
[2013-04-18 22:33:40 -0400] david415: our workaround was to delete the older version of cookbook 'foo' that depended on 'bar'
[2013-04-18 22:34:01 -0400] troyready: david415, yeah, I think that's intentional
[2013-04-18 22:34:02 -0400] Kzim: hi is there a :start_if_stopped action for service or something please
[2013-04-18 22:34:05 -0400] coderanger: david415: Only if something is forcing it to use that old version
[2013-04-18 22:34:27 -0400] troyready: david415, since that old cookbook version is still available for use
[2013-04-18 22:34:44 -0400] david415: troyready: ah right...
[2013-04-18 22:34:47 -0400] david415: ok that makes sense
[2013-04-18 22:35:34 -0400] coderanger: Basically you should never be deleting from the chef server
[2013-04-18 22:35:46 -0400] coderanger: it is like PyPI, append-only except in case of mistakes :)
[2013-04-18 22:35:51 -0400] coderanger: (deleting cookbooks that is)
[2013-04-18 22:35:53 -0400] david415: coderanger: yeah that makes sense
[2013-04-18 22:36:00 -0400] coderanger: you can actually enforce that with the --freeze flag too
[2013-04-18 22:36:50 -0400] david415: ok. agreed! thanks for clarifying this for me!
[2013-04-18 22:39:40 -0400] coderanger: david415: If there is a cookbook you are deprecating you can push a new version that is empty except for the metadata.rb
[2013-04-18 22:39:53 -0400] coderanger: david415: Just to prevent anyone from having a rouge include or something
[2013-04-18 22:40:05 -0400] troyready: juliancdunn, you had kindly asked for perspective on my noob question, not sure if you saw it before the disconnect: I have a vendor's script on a server that my chef recipe is running, which is creating a file (/tmp/newoutput.txt).
[2013-04-18 22:40:41 -0400] troyready: juliancdunn, so I'm looking to compare that new file's checksum with the checksum of an existing file on the server, and perform different actions accordingly
[2013-04-18 22:40:57 -0400] miah: meh
[2013-04-18 22:41:28 -0400] troyready: and it's just brought to light that I've never done anything like that in our recipes before; I've always just been using different existing resources
[2013-04-18 22:49:01 -0400] gokr: juliancdunn: Sorry for pestering - but you didn't really know how I can get "knife ec2 server create" to set /etc/chef/client.rb to use log_level :info ? I tracked down the bootstrap template chef-full but... well, I don't want to hack this.
[2013-04-18 22:50:46 -0400] david415: coderanger: yeah that makes sense...
[2013-04-18 23:06:45 -0400] monokrome: Has anyone else noticed that the :django symbol in application_python's gunicorn resource doesn't work?
[2013-04-18 23:08:09 -0400] coderanger: monokrome: It did originally, might have broken along the way
[2013-04-18 23:11:17 -0400] juliancdunn: troyready: sorry, I had to take a call. so what are the "different actions" you want to take?
[2013-04-18 23:11:29 -0400] justicefries: can I use chef to manage LXCs?
[2013-04-18 23:11:33 -0400] juliancdunn: gokr: I looked in the code... unfortunately the client.rb it's creating is hardcoded
[2013-04-18 23:11:44 -0400] juliancdunn: gokr: but, you could create your own bootstrap template if you wish
[2013-04-18 23:11:46 -0400] gokr: I saw some config_contents or such.
[2013-04-18 23:12:03 -0400] monokrome: coderanger: It's definitely looking to run app_module as if it were a string over here
[2013-04-18 23:12:16 -0400] juliancdunn: gokr: yeah, exactly. config_contents is read out of a hardcoded string in the source code for knife itself, which sets the log level and formatter
[2013-04-18 23:12:31 -0400] gokr: juliancdunn: Ok, so you agree that is what I need to do? I was wondering about this --json-attributes thingy that gets passed to bootstrap...
[2013-04-18 23:13:38 -0400] juliancdunn: gokr: no, that just sets up initial attributes for the run
[2013-04-18 23:13:43 -0400] juliancdunn: one sec, I'll show you the source code
[2013-04-18 23:13:47 -0400] gokr: Ok, got it.
[2013-04-18 23:14:31 -0400] juliancdunn: gokr: so <%= start_chef %> is replaced with: https://github.com/opscode/chef/blob/master/lib/chef/knife/core/bootstrap_context.rb#L88
[2013-04-18 23:14:58 -0400] juliancdunn: I think your solution is to cut your own boostrap template and replace the <%= start_chef %> with the way you want things done on the initial chef run
[2013-04-18 23:15:10 -0400] gokr: yeah.
[2013-04-18 23:16:08 -0400] gokr: background: I am automating this so I track the output from the client run and have a little state maching looking for certain "cues" in the output.
[2013-04-18 23:16:28 -0400] gokr: machine.
[2013-04-18 23:17:14 -0400] juliancdunn: ah, I see... just curious, what do you do with that?
[2013-04-18 23:18:08 -0400] gokr: I am constructing an app that will auto scale a system.
[2013-04-18 23:18:23 -0400] gokr: And also be able to take up and down stuff on schedules blabla.
[2013-04-18 23:19:38 -0400] gokr: So I am building  a little domain model for handling different "clouds" with machines in them etc. So I have an instance of "Machine" and I can tell it to go "up" or "down" etc, spawning off chef commands as background processes - and then I track the output from those commands.
[2013-04-18 23:19:59 -0400] juliancdunn: oh interesting
[2013-04-18 23:20:13 -0400] gokr: So the fact that chef supports multiple cloud vendors is very nice for us.
[2013-04-18 23:20:36 -0400] juliancdunn: you could also have a Chef recipe do something like POST to a web service as part of the initial run_list to solve such a problem
[2013-04-18 23:20:41 -0400] juliancdunn: rather than output scraping... just a thought
[2013-04-18 23:21:03 -0400] gokr: Yeah, but I want to track "milestones" during the output.
[2013-04-18 23:21:15 -0400] gokr: Like "chef installed", "chef client run started" etc.
[2013-04-18 23:21:17 -0400] troyready: juliancdunn, No apologies needed, I just got back from break myself
[2013-04-18 23:21:45 -0400] juliancdunn: gokr: oh I see... you could still do multiple POSTs at various stages
[2013-04-18 23:21:55 -0400] juliancdunn: anyway, up to you, I was just wondering why you were output scraping
[2013-04-18 23:22:05 -0400] gokr: sure
[2013-04-18 23:22:27 -0400] troyready: juliancdunn, specifically, if the two checksums don't match I want to do a few normal recipe things (stop a service, call an execute resource to copy some files, then start the service again)
[2013-04-18 23:23:16 -0400] gokr: Btw, this --format option... I read that it can take "json" as argument - but it sure doesn't happen much when used with "knife ec2".
[2013-04-18 23:23:27 -0400] gokr: I know that is a plugin so... not part of core chef.
[2013-04-18 23:23:39 -0400] juliancdunn: troyready: right, so you could add an only_if clause to a resource like service
[2013-04-18 23:24:12 -0400] juliancdunn: gokr: well, you have to be clear about which "chef" or "knife" you're configuring the output for
[2013-04-18 23:24:29 -0400] juliancdunn: if you pass it on your workstation's command line it won't be that useful, since you're telling the plugin to format its output as JSON
[2013-04-18 23:24:38 -0400] juliancdunn: (which is senseless in this situation)
[2013-04-18 23:25:46 -0400] gokr: Ehm?
[2013-04-18 23:26:01 -0400] gokr: "knife ec2 server list --help" lists --format as an option.
[2013-04-18 23:26:27 -0400] gokr: Although it doesn't list what FORMATs I can use - had to google that. But json should work, no?
[2013-04-18 23:26:46 -0400] juliancdunn: gokr: yeah, but there's no output that's part of the initial bootstrap that even resembles a data structure that could be formatted
[2013-04-18 23:27:06 -0400] gokr: Sorry, I jumped subject here - I am asking about "server list" in this case.
[2013-04-18 23:27:07 -0400] juliancdunn: "--format=json" is more sensible for things like "knife node show" or "knife role show"
[2013-04-18 23:27:14 -0400] juliancdunn: gokr: ohhhhhhh
[2013-04-18 23:27:21 -0400] juliancdunn: yeah, format won't work for that
[2013-04-18 23:27:52 -0400] juliancdunn: because it's just calling out to an Amazon API, not poking at a Chef data structure
[2013-04-18 23:28:07 -0400] gokr: Ok, so it's formatted from Amazon? Odd.
[2013-04-18 23:28:33 -0400] juliancdunn: gokr: no, Amazon gives you back some XML, we parse it and give it in a tabular format
[2013-04-18 23:28:34 -0400] gokr: Anyway, no problem, I already have code that parses that stuff. Just realized I could've used json.
[2013-04-18 23:28:40 -0400] gokr: Aha. :)
[2013-04-18 23:28:52 -0400] gokr: Darn ya!
[2013-04-18 23:28:54 -0400] juliancdunn: the same stuff you'd get with "ec2-describe-instances"
[2013-04-18 23:28:54 -0400] gokr: ;)
[2013-04-18 23:28:57 -0400] juliancdunn: :-)
[2013-04-18 23:29:57 -0400] gokr: Ok... so... I will hack my own bootstrap then. But it feels like you guys should "fix" it somehow ;)
[2013-04-18 23:30:09 -0400] gokr: Thanks for the help
[2013-04-18 23:30:31 -0400] juliancdunn: np
[2013-04-18 23:35:26 -0400] duellsy: anyone know why when a new PHP App Server instance is fired up, why don't the deploy recipes get called?
[2013-04-18 23:47:13 -0400] flaccid_: duellsy: what is this using?
[2013-04-18 23:48:00 -0400] duellsy: sorry, using Amazon OpsWorks
[2013-04-18 23:48:12 -0400] flaccid_: oh, ##aws for that..
[2013-04-18 23:48:27 -0400] flaccid_: or consider purchasing aws premium support :)
[2013-04-18 23:50:09 -0400] flaccid_: i'm actually working on a high level recipe for that myself duellsy
[2013-04-18 23:50:44 -0400] duellsy: i'm in ##aws too but it's so rare to get any response at all in there
[2013-04-18 23:50:58 -0400] flaccid_: yeah probably coz i don't go in there very much any more :)
[2013-04-18 23:51:08 -0400] duellsy: haha
