[2013-04-15 01:08:17 -0400] jpl: Is there a way to set the default owner/group/perms for files created by cookbook_file?
[2013-04-15 01:53:22 -0400] alxism: Hi
[2013-04-15 01:53:48 -0400] alxism: I created an ec2 instance with a standard ubuntu image.
[2013-04-15 01:53:48 -0400] alxism: but `knife bootstrap` is failing with: "dpkg: error: requested operation requires superuser privilege"
[2013-04-15 01:53:57 -0400] alxism: ubuntu user is a sudoer, how come the install script is not using sudo? what am i missing?
[2013-04-15 01:54:02 -0400] alxism: thx in advance.
[2013-04-15 02:02:27 -0400] jpl: Is the ubuntu user required to enter a password?
[2013-04-15 02:18:33 -0400] normj: hey sorry about that. lost internet so i'm not sure if anyone was able to help with my ACL question
[2013-04-15 02:58:53 -0400] alxism: @jpl no
[2013-04-15 07:22:52 -0400] pantsd_: So this is probably dumb, but once I've updated the run lists for a node how do I make it get applied to that node
[2013-04-15 07:30:06 -0400] bluekelp: pantsd_: run chef-client on the node
[2013-04-15 07:30:42 -0400] bluekelp: pantsd_: i like to add the 'recipe[chef-client]' to all run_lists so this happens automatically about every 30 minutes
[2013-04-15 08:11:28 -0400] pantsd_: cool :)
[2013-04-15 08:11:35 -0400] pantsd_: bluekelp: thanks
[2013-04-15 09:19:53 -0400] zts: alxism: are you using the --sudo option?
[2013-04-15 09:54:57 -0400] kernel_panik: Hi to all :)
[2013-04-15 09:55:26 -0400] kernel_panik: Is possible put in  only_if  or not_if  a my custom function ?
[2013-04-15 10:01:19 -0400] haakond_: sure
[2013-04-15 11:24:18 -0400] alxism: @zts: yes I found the sudo option. Thank you!
[2013-04-15 11:27:42 -0400] gyre007: ohai chefs...
[2013-04-15 11:27:58 -0400] gyre007: I noticed that the latest knife-rackspace version is 0.6.3 https://github.com/opscode/knife-rackspace/blob/master/lib/knife-rackspace/version.rb
[2013-04-15 11:28:17 -0400] gyre007: however when I try to install knife-rackspace plugin I can only install 0.6.2 ?
[2013-04-15 11:28:19 -0400] gyre007: mmm
[2013-04-15 11:28:29 -0400] gyre007: any ideas why ?
[2013-04-15 11:28:56 -0400] gyre007: when I do gem list knife-rackspace --remote --all it doesn't list 0.6.3 ...only 0.6.2
[2013-04-15 11:34:07 -0400] situ: Is it possible to have a conditional dependency in a cookbook's metadata.rb file ?
[2013-04-15 11:54:42 -0400] kernel_panik: If I made custom  function for only_if  for example.. is standard put the code of function in  mycookbook/libraries/default.rb ?
[2013-04-15 12:47:30 -0400] zts: gyre007: the commit message says "bump version for development", so I would expect that means that 0.6.3 has not been released yet
[2013-04-15 12:47:36 -0400] zts: situ: no
[2013-04-15 12:47:41 -0400] zts: kernel_panik: what do you mean by "custom function" ?
[2013-04-15 12:47:58 -0400] gyre007: yeah I figured that zts cheers
[2013-04-15 12:48:06 -0400] zts: np
[2013-04-15 12:48:39 -0400] kernel_panik: :zts  I meant functions created by me that I would like call on my recipe.. anyway, I put them in libraries/default.rb
[2013-04-15 12:49:23 -0400] zts: kernel_panik: yeah, that is the right place to put library code
[2013-04-15 12:51:18 -0400] zts: kernel_panik: how does that relate to only_if?  are you using a function from your library as the code for only_if to run?
[2013-04-15 12:51:50 -0400] kernel_panik: yes! a function that return true or false
[2013-04-15 12:52:31 -0400] situ: zts: Where's the dependency calculation actually done ? and why it can't be conditional ?
[2013-04-15 12:56:56 -0400] zts: situ: chef-solo does it (as of Chef 11) when loading cookbooks, 'knife cookbook upload' does it, chef-client also does it when loading cookbooks / expanding the run list... I'm not sure whether that's calculated client-side or server-side
[2013-04-15 12:57:55 -0400] zts: situ: as for why it can't be conditional, I'm not aware of any reason why it's impossible, simply that the code does not yet exist
[2013-04-15 12:59:23 -0400] situ: I have tried to make it conditional by putting code like "if defined? node && node['platform'] != "windows" ... in metadata.rb but still I get same behaviour on different platforms.
[2013-04-15 12:59:24 -0400] zts: situ: are you thinking of platform-specific dependencies (eg, only depend 'yum' on RHEL-like platforms), or some other criteria?
[2013-04-15 12:59:47 -0400] zts: yes, that will not work
[2013-04-15 13:01:10 -0400] zts: metadata.rb is turned into JSON, and that's what is used
[2013-04-15 13:03:48 -0400] situ: zts: Is the JSON stored on Chef server ? How can I see it ?
[2013-04-15 13:03:49 -0400] adamjk-dev: is anyone here using vagrant 1.1.x and berkshelf?
[2013-04-15 13:04:10 -0400] adamjk-dev: I installed berkshelf via a vagrant plugin now
[2013-04-15 13:04:17 -0400] adamjk-dev: and am getting errors from my Vagrantfile
[2013-04-15 13:04:35 -0400] adamjk-dev: I followed the instructions here: https://github.com/RiotGames/berkshelf-vagrant
[2013-04-15 13:07:03 -0400] zts: situ: you could do something like, knife cookbook show <cookbook> <version> metadata -Fj
[2013-04-15 13:07:34 -0400] adamjk-dev: config.berkshelf.enabled = true (setting this in my Vagrantfile does not seem to be doing the trick)
[2013-04-15 13:07:42 -0400] MerlinDMC: adamjk-dev, here it seems to work fine ... just installed the plugin - but I also had problems a while ago
[2013-04-15 13:08:05 -0400] adamjk-dev: MerlinDMC: vagrant plugin list gives you what? and vagrant --version?
[2013-04-15 13:08:52 -0400] adamjk-dev: I have --> vagrant plugin list: berkshelf-vagrant (1.1.0), thor (0.18.1), vagrant-butcher (1.0.0)
[2013-04-15 13:09:10 -0400] adamjk-dev: vagrant --version yields: 1.1.5
[2013-04-15 13:21:29 -0400] situ: zts: Thanks for your help ! :)
[2013-04-15 13:21:53 -0400] zts: situ: no problem!
[2013-04-15 13:31:29 -0400] s2r2: vagrant-butcher... hmm nice
[2013-04-15 13:38:30 -0400] fclausen: hello all - Chef barfs when it tries to remove a symlink to a read-only location with "action: delete". How can I best tell Chef to delete a "file" whether or not it is a symlink? I.e. don't dereference if symlink; if normal file just delete
[2013-04-15 13:39:07 -0400] fclausen: I am using "action: delete" with a "file" resource
[2013-04-15 13:42:12 -0400] situ: fclausen: Use two separate blocks, one to delete a symlink and other to delete a file, and use "only_if" condition to check whether the path which you want to delete is a file or symlink.
[2013-04-15 13:42:40 -0400] fclausen: site: thanks, I'll try that out
[2013-04-15 13:43:03 -0400] fclausen: sorry, I mean "situ"
[2013-04-15 13:49:29 -0400] kernel_panik: if I have in my script resource a variable k..   k=5 for example.. inside the script I need node['mycookbook']['value_of_k']..... is possible passing the value of k for call this attribute of cookbook?
[2013-04-15 14:16:41 -0400] treefrog_: Now to the point of having some recipes in production with a default environment. What is the best practice for setting up a dev sandbox?
[2013-04-15 14:41:16 -0400] jib: Hi all, just wanted to check if anyone in here has seen issues installing the debian packages?
[2013-04-15 14:41:33 -0400] alex_: is it possible to change permissions for al underlaying folders
[2013-04-15 14:41:33 -0400] jib: I am getting the following error: "find: `/var/cache/chef/checksums/': No such file or directory"
[2013-04-15 14:41:34 -0400] alex_: ?
[2013-04-15 14:42:25 -0400] alex_: directory "/opt/tomcat/" do owner "tomcat" group "appserver" recursive true
[2013-04-15 14:42:25 -0400] alex_: end
[2013-04-15 14:42:32 -0400] alex_: doe not work
[2013-04-15 14:42:35 -0400] btm: alex_: you should use an exectue resource with 'chmod -R' with an only_if/not_if that's appropriate to your situation, because it is complicated to do it idempotently: http://tickets.opscode.com/browse/CHEF-690
[2013-04-15 14:42:36 -0400] alex_: does*
[2013-04-15 14:42:50 -0400] alex_: ah oke
[2013-04-15 14:43:05 -0400] alex_: so i cannot be done with the directory resource
[2013-04-15 14:44:14 -0400] jib: the error happens when configuring the chef-server-api package
[2013-04-15 14:45:01 -0400] btm: alex_: the directory resource 'recursive' attribute will create intermediate directories with the provided attributes for ownership _if needed_ , e.g. 'mkdir -p /tmp/foo/bar/does_not_exist/charlie/delta' http://docs.opscode.com/resource_directory.html
[2013-04-15 14:45:27 -0400] btm: jib: version of debianubuntu, version of chef server package?
[2013-04-15 14:45:43 -0400] alex_: btw ah thanks
[2013-04-15 14:45:58 -0400] jib: debian squeeze with the ops code repository
[2013-04-15 14:46:26 -0400] jib: Package: chef-server-api Version: 0.9.18+dfsg-1
[2013-04-15 14:48:13 -0400] btm: jib: are you intentionally trying to use Chef 0.9?
[2013-04-15 14:48:18 -0400] jib: nope
[2013-04-15 14:48:30 -0400] jib: just want to use chef in debian sqeeze
[2013-04-15 14:50:05 -0400] btm: jib: it's best to use the omnibus Chef 11 server packages: http://docs.opscode.com/install_server.html they will install a deb (although not debian policy compliant)
[2013-04-15 14:50:45 -0400] jib: so is the apt repository likely to remain broken??
[2013-04-15 14:51:02 -0400] btm: jib: if you want to stick to mostly debian compliant packages for Chef 10 server, you probably need to modify your sources.list file and change 'squeeze' to 'squeeze-0.10' as mentioned here: http://wiki.opscode.com/dosearchsite.action?queryString=chef+debian+repository
[2013-04-15 14:51:22 -0400] btm: or here I mean: http://wiki.opscode.com/display/ChefCN/Package+Installation+on+Debian+and+Ubuntu
[2013-04-15 14:52:30 -0400] btm: jib: Opscode won't be making Chef 11 upstream debian packages, although the community may, there's a lot of work to do to get erlang and such ready in debian.
[2013-04-15 14:59:30 -0400] jib: btm: i can't remove the package now as it is an inconstant state, any idea how I can fix it? can i generate /var/cache/chef/checksums/ myself??
[2013-04-15 15:07:50 -0400] dozzy: Hey All... have an interesting issue here with client 11.4.0 and server 11.0.6, the bookshelf service is returning a 403 Forbidden after 15 minutes due to the 'Expires=' timestamp in the request url being set at the beginning of the client run and not getting updated... every request in the nginx access.log shows the same expires value... so if the run lasts more than 15 minutes, no bookshelf
[2013-04-15 15:07:51 -0400] dozzy: requests succeed after 15 minutes.  This is on a request to bookshelf (dl a template) during the run... are there any configuration options to extend the bookshelf cache expiry?
[2013-04-15 15:10:12 -0400] spox: dozzy: fwiw, i was hitting this issue the last couple weeks and found the same issue over the weekend.
[2013-04-15 15:10:18 -0400] spox: i'm still poking around at things though
[2013-04-15 15:11:20 -0400] jwilf: hi all, is it possible to subscribe to a resource defined in a provider that is called earlier in the recipe? i tried but i get Chef::Exceptions::ResourceNotFound
[2013-04-15 15:11:45 -0400] adamjk-dev: is anyone using vagrant 1.x along with berkshelf?
[2013-04-15 15:11:47 -0400] jwilf: the resource in question is a file btw
[2013-04-15 15:11:56 -0400] ranjibd: dozzy: i cant find anything http://docs.opscode.com/config_rb_chef_server.html
[2013-04-15 15:11:59 -0400] dozzy: spox: good good, at least I'm not the only one running into it... it's quite confusing until you dig into the server logs and see the expiry run out :)
[2013-04-15 15:12:03 -0400] adamjk-dev: I am having issued with using the latest vagrant and berkshelf, trouble with the Vagrantfile perhaps
[2013-04-15 15:12:15 -0400] spox: dozzy: indeed :)
[2013-04-15 15:12:40 -0400] ranjibd: adamjk-dev:  i am
[2013-04-15 15:13:02 -0400] dozzy: ranjibd: yeah, I upped the s3_ttl but to no avail... nothing else seems to be relevant... somewhere else it's being set to 900 seconds
[2013-04-15 15:13:24 -0400] adamjk-dev: ranjibd: Well, I updated to using the v2 format for Vagrantfiles, and am enabling berkshelf, but when I do a 'vagrant up', it is not using the berkshelf cookbooks
[2013-04-15 15:13:32 -0400] ranjibd: adamjk-dev: if you are using vagrant 1.1+ , install berkshelf and test-kitchen alpha system wide  (i.e. without bundler)
[2013-04-15 15:13:55 -0400] ranjibd: yeah.. you need to install the vagrant plugin for berkshelf too
[2013-04-15 15:14:08 -0400] ranjibd: vagrant plugin install vagrant-berkshelf
[2013-04-15 15:14:11 -0400] adamjk-dev: ranjibd: I do not have test-kitchen there.... I have the vagrant plugin for berkshelf and a gem of berkshelf installed
[2013-04-15 15:14:23 -0400] ranjibd: ohh.. ok
[2013-04-15 15:14:33 -0400] adamjk-dev: which berks --> ~/.rvm/gems/ruby-1.9.3-p392/bin/berks
[2013-04-15 15:14:42 -0400] ranjibd: have you  installed the vagrant plugin >?
[2013-04-15 15:14:52 -0400] adamjk-dev: vagrant plugin list --> berkshelf-vagrant (1.1.0), vagrant-butcher (1.0.0)
[2013-04-15 15:14:57 -0400] ranjibd: vagrant plugin install vagrant-berkshelf
[2013-04-15 15:15:09 -0400] adamjk-dev: ranjibd: yeah, it is installed
[2013-04-15 15:15:24 -0400] ranjibd: have  you enabled the plugin? its disabled by default
[2013-04-15 15:15:45 -0400] adamjk-dev: my Vagrantfile has the line: 'config.berkshelf.enabled = true'
[2013-04-15 15:15:46 -0400] ranjibd: you have to put a vagrantfile in your HOME/vagrant.d/
[2013-04-15 15:16:25 -0400] ranjibd: this is in the project specific vagrantfile? or in the home/vagrant.d/vagrantfile?
[2013-04-15 15:16:27 -0400] adamjk-dev: ranjibd: do you have to enable berkshelf in the home one?
[2013-04-15 15:16:43 -0400] adamjk-dev: ranjibd: the project specific vagrantfile has that line
[2013-04-15 15:17:00 -0400] adamjk-dev: ranjibd: the sad thing is.... I did a berks init... and did a vagrant up there, and it used berkshelf it seems
[2013-04-15 15:17:45 -0400] adamjk-dev: ranjibd: I have no idea what the problem is, but I am following sources around
[2013-04-15 15:17:52 -0400] adamjk-dev: https://gist.github.com/MerlinDMC/d882834ca6e71a8792c6
[2013-04-15 15:17:52 -0400] ranjibd: i  tried,, didnt work for me, i had to use the older vagrant-berkshelf, the new one disables the plugin by default, and i was not able to get it enabled.. but teukka told me it should work
[2013-04-15 15:18:01 -0400] ranjibd: if you put it in your home dir.
[2013-04-15 15:18:11 -0400] adamjk-dev: ranjibd: really? interesting
[2013-04-15 15:18:22 -0400] adamjk-dev: ranjibd: do you have to use the version 2 format for Vagrantfiles?
[2013-04-15 15:18:29 -0400] adamjk-dev: ranjibd: version 1 does not like it
[2013-04-15 15:19:00 -0400] ranjibd: im using berkshelf-vagrant (1.0.6) now..
[2013-04-15 15:19:22 -0400] ranjibd: cant assert , i need to test them more thoroughly
[2013-04-15 15:20:04 -0400] adamjk-dev: ranjibd: does the vagrant plugin 'berkshelf-vagrant (1.0.6)' allow you to enable berkshelf via the project specific Vagrantfile?
[2013-04-15 15:20:23 -0400] ranjibd: no its enabled b default  :0)
[2013-04-15 15:20:46 -0400] ranjibd: the profile vagrantfile trick didnt work for me. i might be missing something
[2013-04-15 15:21:06 -0400] ranjibd: but i could only spend an hour fixing this. so i just revert back to 1.0.6
[2013-04-15 15:21:13 -0400] MattP___: Hi everybody
[2013-04-15 15:21:18 -0400] adamjk-dev: ranjibd: interesting, yeah it is not working as I suspect it should
[2013-04-15 15:21:24 -0400] adamjk-dev: ranjibd: its being really iffy
[2013-04-15 15:22:15 -0400] treefrog_: Question about updating chef recipes.
[2013-04-15 15:22:37 -0400] MattP___: What is the syntax to reference a role attribute in a recipe
[2013-04-15 15:22:39 -0400] MattP___: ?
[2013-04-15 15:22:40 -0400] treefrog_: Is the work flow to use two environments, and have matching git branches?
[2013-04-15 15:22:47 -0400] jwilf: can anyone help with using resources defined in a provider?
[2013-04-15 15:23:14 -0400] adamjk-dev: ranjibd: where did you get 1.0.6 from?
[2013-04-15 15:25:50 -0400] ranjibd: vagrant plugin install has a --plugin-version option
[2013-04-15 15:26:12 -0400] adamjk-dev: ranjibd: ah, I just noticed that, thanks.... but apparently vagrant plugin list doesn't show versions  correctly?
[2013-04-15 15:26:24 -0400] adamjk-dev: ranjibd: I installed 1.0.6 and a vagrant plugin list showed 1.1.0
[2013-04-15 15:26:40 -0400] ranjibd: MattP___: all attributes are accessed directly from node. node.attribute  or node[:attribute]
[2013-04-15 15:26:55 -0400] treefrog_: jwilf: first thing to watch is that your recipe method name is created by cookbook name and provider file name.
[2013-04-15 15:27:49 -0400] jwilf: treefrog_: can you give me an example please?
[2013-04-15 15:28:18 -0400] adamjk-dev: ranjibd: berkshelf-vagrant v1.0.6 didn't work either.... could it be something about a path to the cookbooks or something?
[2013-04-15 15:28:36 -0400] ranjibd: treefrog_: why you need the resource defined inside the lwrp? you can send/receive notification from the lwrp itself
[2013-04-15 15:28:52 -0400] MattP___: Thanks ranjidb; If I set 'myversion' at the role level, I just call node[:myversion], and it should work, right ?
[2013-04-15 15:29:01 -0400] ranjibd: yes
[2013-04-15 15:29:11 -0400] treefrog_: jwilf: I have a cookbook called "db_config" and a provider file named "update_phone_rule.rb"
[2013-04-15 15:29:22 -0400] AskSteve: I'm looking to have nagios send me an sms for each notification of service down.  How can I configure that?
[2013-04-15 15:29:36 -0400] jwilf: treefrog_: well i've got a provider used by 2 different recipes, its called app.rb
[2013-04-15 15:29:44 -0400] treefrog_: jwilf: my recipe method will be "db_config_update_phone_rule"
[2013-04-15 15:29:55 -0400] ranjibd: AskSteve: do you have asterix or something similar setup? or use PagerDuty :-)
[2013-04-15 15:29:55 -0400] jwilf: treefrog_: inside app.rb i deploy an app and touch a file if its been deployed
[2013-04-15 15:30:17 -0400] AskSteve: No, I'm comfortable having it just email my sms address for now
[2013-04-15 15:30:20 -0400] sascha_d: Has anyone written up a "why/when you begin recipe names with an underscore?"
[2013-04-15 15:30:26 -0400] jwilf: but in the recipe that calls the provider i want to know if the app was deployed, so i want to subscribe to that file
[2013-04-15 15:30:55 -0400] jwilf: but it seems i can't see resources inside the lwrp
[2013-04-15 15:30:55 -0400] sascha_d: I'm about do some of that and was wondering if there's a style guide or blog post I can point inquiring minds at
[2013-04-15 15:32:10 -0400] treefrog_: jwilf: difficult -- one thing to think about: we push some common code out to external gems, so that multiple cookbooks can access
[2013-04-15 15:32:59 -0400] jwilf: hmm i don't really want to go down that road... ok never mind i'll work around it - thanks for your help
[2013-04-15 15:33:09 -0400] dsdeiz: hey all, sorry, kinda new to chef but say i'm reading this https://github.com/opscode-cookbooks/database#examples most of those things are to be in a cookbook right?
[2013-04-15 15:33:36 -0400] MattP___: thanks ranjibd, works like a charm
[2013-04-15 15:33:44 -0400] AskSteve: ranjibd: I'm not using a gateway, I want it to simply email my cell phone for now
[2013-04-15 15:34:02 -0400] adamjk-dev: ranjibd: so...... I think I found the problem
[2013-04-15 15:34:31 -0400] adamjk-dev: ranjibd: I don't think something was right in my Vagrantfile.... I was defining a VM to have a multi-vm environment... and I think that was breaking it
[2013-04-15 15:34:32 -0400] ranjibd: AskSteve: you have to use wrap that call in a command (nagios dsl) and use that as notify_by_sms (or somethig) and the attach it to hosts/services
[2013-04-15 15:34:52 -0400] adamjk-dev: ranjibd: I removed the defined VM and it seems to have brought in the cookbooks for Vagrant at that point
[2013-04-15 15:35:09 -0400] AskSteve: ranjibd: is there a page/doc that describes this?
[2013-04-15 15:35:17 -0400] ranjibd: adamjk-dev: ok.. let me know if  you get it working with upstream berkshelf-vagrant
[2013-04-15 15:35:32 -0400] adamjk-dev: ranjibd: v 1.1.0?
[2013-04-15 15:35:39 -0400] adamjk-dev: ranjibd: I was about to try that hehe
[2013-04-15 15:38:15 -0400] adamjk-dev: ranjibd: berkshelf-vagrant 1.1.0 seems to be working as well (you just need to enable berkshelf in your vagrantfile)
[2013-04-15 15:38:40 -0400] adamjk-dev: ranjibd: I only tried my projec one at the moment, since my workspace one is the old version (v1, which doesn't let you set the berkshelf enabled flag)
[2013-04-15 15:42:52 -0400] AskSteve: ranjibd: Any page/doc that describes how to setup emailing a second address for admins?
[2013-04-15 15:42:57 -0400] AskSteve: ranjibd: for nagios?
[2013-04-15 15:57:39 -0400] theCzar: Are resource names namespaced under each cookbook?  Or should I refrain from reusing resource names between cookbooks.  I ran into an issue with that a few versions back.
[2013-04-15 16:07:52 -0400] adamjk-dev: does anyone know if you can set the bridged interface in Vagrant version 2 config for setting the :public network (so it automatically uses an adapter)?
[2013-04-15 16:08:11 -0400] adamjk-dev: so you don't get prompted for 1) em1, 2) virbr0, etc.?
[2013-04-15 16:08:39 -0400] theCzar: I'm pretty sure... ask in #vagrant
[2013-04-15 16:08:42 -0400] adamjk-dev: in V1 of Vagrantfile configuration, it was to set :bridge I think
[2013-04-15 16:19:45 -0400] theCzar: Are Only_If lines executed at compile time or right before trying to run the resource?
[2013-04-15 16:21:00 -0400] yfeldblum: theCzar, they are run right before a provider attempts to perform an action (they can be run multiple times if there are multiple actions) during convergence
[2013-04-15 16:22:08 -0400] theCzar: yfeldblum: awesome so if a previous resource changes the state that my not_if is checking it would affect my whether my next resource runs or not
[2013-04-15 16:22:22 -0400] yfeldblum: theCzar, yes
[2013-04-15 16:24:26 -0400] theCzar: is there some generic resource from which all other resources inherit?  Some kind of generic resource that I can call if I only need a resource to notify others?
[2013-04-15 16:25:27 -0400] yfeldblum: theCzar, i use ruby_block for that
[2013-04-15 16:25:36 -0400] theCzar: cool, thanks
[2013-04-15 16:26:51 -0400] yfeldblum: theCzar, http://pastie.org/pastes/7587422/text?key=ao0bdbzz3gvwnj1wzpvqa
[2013-04-15 16:27:24 -0400] theCzar: alright, thank-you
[2013-04-15 16:28:27 -0400] shthap3ns: I suddenly started getting 401 auth errors with hosted Chef today saying "The request failed because your clock has drifted by more than 15 minutes." Anyone know why?
[2013-04-15 16:28:51 -0400] dozzy: adamjk-dev: use config.vm.network :private_network, :bridge => "full_name_of_adapter"
[2013-04-15 16:29:19 -0400] adamjk-dev: dozzy: I will give that a try, thanks
[2013-04-15 16:29:41 -0400] dozzy: adamjk-dev: ahh, sorry, it's :public_network
[2013-04-15 16:30:23 -0400] dozzy: adamjk-dev: :bridged isn't working as a network type, even though it's mentioned in the 1.1 docs
[2013-04-15 16:31:14 -0400] adamjk-dev: dozzy: I see, yeah I was looking at the documentation, and it doesn't mention the , :bridge option
[2013-04-15 16:31:35 -0400] adamjk-dev: dozzy: but I believe you were correct on the syntax, so thank you
[2013-04-15 16:33:46 -0400] dozzy: adamjk-dev: it's mentioned here in the "Confused?" callout, http://docs.vagrantup.com/v2/networking/public_network.html
[2013-04-15 16:35:07 -0400] dozzy: adamjk-dev: which is particularly ironic since it muddies the issue further
[2013-04-15 16:42:30 -0400] jtimberman: shthap3ns: yeah, that's on purpose. you need to keep your clock synchronized. i imagine that's because you have a VM that was suspended and then resumed but didn't have ntp run? the reason it's required by the Chef Server API is to prevent time based replay attacks.
[2013-04-15 16:45:14 -0400] timsmith: anyone have a solution to reinstalling chef on a hosted chef client.  In open source I just deleted the client.  In hosted I get Forbidden errors when the system tries to save it's node at the end of the run unless I delete the client and the node, but then I lose all the attributes and the runlist
[2013-04-15 16:56:52 -0400] shthap3ns: jtimberman: i'm getting that error when creating a new node/server (ubuntu), and i'm installing ntp in my bootstrap file
[2013-04-15 16:57:52 -0400] timsmith: I had some issues with time that I solved by putting a time sync into my bootstrap
[2013-04-15 16:57:57 -0400] timsmith: ntpdate ntp.ubuntu.com
[2013-04-15 16:58:03 -0400] timsmith: that'll sync you up during the bootstrap
[2013-04-15 16:58:23 -0400] jtimberman: shthap3ns: you need to run ntpdate prior to chef starting.
[2013-04-15 16:58:34 -0400] shthap3ns: thanks guys, i'll try that
[2013-04-15 16:58:52 -0400] jtimberman: timsmith: you have to grant permission to the new API client to update the node object in the ACL
[2013-04-15 16:59:32 -0400] timsmith: any docs on how to do that.  I'm still a bit new to the hosted world
[2013-04-15 16:59:44 -0400] jtimberman: timsmith: you can also write the node object to a json file, delete the node on the server, and pass that in with knife bootstrap on the new one
[2013-04-15 17:00:00 -0400] jtimberman: timsmith: docs for it are "click fourteen times in the webui" :(
[2013-04-15 17:00:17 -0400] jtimberman: timsmith: we have a "experimental/alpha/unsupported" knife plugin (that totally works).
[2013-04-15 17:00:29 -0400] jtimberman: but writing the node object out to a file and passing that to knife bootstrap is probably easier :)
[2013-04-15 17:07:14 -0400] timsmith: webui.  what's that
[2013-04-15 17:07:48 -0400] jtimberman: timsmith: right? :)
[2013-04-15 17:08:14 -0400] timsmith: The hosted one renders really funky so I've never really used it.
[2013-04-15 17:08:26 -0400] timsmith: probably just me being the last guy that still likes Firefox
[2013-04-15 17:10:10 -0400] jtimberman: timsmith: is it because it's Super Duper Wide?
[2013-04-15 17:10:17 -0400] jtimberman: get a bigger monitor, obv ;)
[2013-04-15 17:10:31 -0400] c_t: timsmith: if it makes you feel any better, I think I was the last person to use the complete Mozilla suite
[2013-04-15 17:10:41 -0400] timsmith: I think you guys designed it for 10 in high and 30in wide monitors
[2013-04-15 17:15:29 -0400] pwelch_: does anyone know how you can check the expanded run_list on a node? I want to check if a node running a recipe has a recipe but using `node.run_list.include?("foo") doesnt work if recipe foo is in a role on the node
[2013-04-15 17:15:33 -0400] pwelch_: might be doing it wrong..
[2013-04-15 17:15:34 -0400] david415: does berkshelf actually have documentation?
[2013-04-15 17:15:46 -0400] justincampbell: david415: berkshelf.com ?
[2013-04-15 17:15:56 -0400] pwelch_: david415: http://berkshelf.com/ didnt help?
[2013-04-15 17:16:37 -0400] justincampbell: or do you mean http://rubydoc.info/gems/berkshelf/frames
[2013-04-15 17:21:45 -0400] david415: pwelch_: i'm trying to make an old monolithic git repo containing many chef cookbooks work... as well as smaller opscode git repos
[2013-04-15 17:23:33 -0400] miah: david415: berkshelf.com
[2013-04-15 17:24:00 -0400] miah: whole page is documentation
[2013-04-15 17:24:49 -0400] david415: hmm ok i will take a closer look
[2013-04-15 17:25:44 -0400] miah: you dont have to look hard
[2013-04-15 17:25:47 -0400] miah: just read the words
[2013-04-15 17:26:16 -0400] david415: right. thanks!
[2013-04-15 17:26:31 -0400] jtimberman: david415: i wrote up a post about how i converted my personal chef-repo to use berkshelf: http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/
[2013-04-15 17:27:10 -0400] miah: sometimes i miss working with david415 =)
[2013-04-15 17:27:59 -0400] david415: jtimberman: interesting... i'll take a look
[2013-04-15 17:29:38 -0400] kindsol: david415: for monolithic cookbook repo take a look at the Berksfile "rel" option.
[2013-04-15 17:29:41 -0400] kindsol: "An optional rel key can be specified if your repository contains many cookbooks in a single repository under a sub-directory or at root."
[2013-04-15 17:31:36 -0400] david415: kindsol: perfect. just what i need...
[2013-04-15 17:32:09 -0400] kindsol: ;)
[2013-04-15 17:49:21 -0400] pwelch_: jtimberman: that was an interesting post. My co-worker just pointed that to me a few days ago for an example using the #resource method
[2013-04-15 17:49:29 -0400] jtimberman: :)
[2013-04-15 17:49:53 -0400] jtimberman: resources() is awesome.
[2013-04-15 17:50:38 -0400] pwelch_: it solves a lot of issues for us when we try to write an application cookbook and only need to change a single thing that is not in the library cookbook
[2013-04-15 17:56:52 -0400] jtimberman: yup
[2013-04-15 18:03:14 -0400] dogmeat: hello, has anyone used knife ec2 server create lately?
[2013-04-15 18:03:23 -0400] j^2: <- me
[2013-04-15 18:03:26 -0400] btm: dogmeat: 10 seconds ago.
[2013-04-15 18:03:31 -0400] dogmeat: Mine kept on being stuck on Waiting for sshd
[2013-04-15 18:03:47 -0400] j^2: your security groups allow ssh?
[2013-04-15 18:03:50 -0400] dogmeat: i'm following the tutorial on the opscode site for setting up the memcached
[2013-04-15 18:03:56 -0400] j^2: (i got caught on that one myself)
[2013-04-15 18:03:57 -0400] btm: dogmeat: after you cancelled it, could you ssh in just using ssh?
[2013-04-15 18:04:05 -0400] dogmeat: i can't ssh in at all
[2013-04-15 18:04:23 -0400] dogmeat: I used to be able to when I was doing it manually w/o chef
[2013-04-15 18:05:28 -0400] btm: dogmeat: j^2 is probably correct then. run ec2-describe-instances and look at your security group settings.
[2013-04-15 18:05:48 -0400] j^2: :D
[2013-04-15 18:06:01 -0400] dogmeat: let me check. thanks @btm @j^2
[2013-04-15 18:27:13 -0400] jstallard: in a role, is it possible to specify different node attributes based on the environment?
[2013-04-15 18:30:21 -0400] log1kal: jstallard, not directly I think
[2013-04-15 18:30:50 -0400] log1kal: you could a) include a recipe that does some logic to insert the attributes
[2013-04-15 18:31:01 -0400] log1kal: or b) just put the attrs in the environment...
[2013-04-15 18:31:53 -0400] jstallard: hmm, ok. how about in a cookbook attributes file? Could I potentially put a case statement in there, setting different default attributes based on the environment?
[2013-04-15 18:32:14 -0400] KarlHungus: jstallard: its a .rb file...
[2013-04-15 18:33:30 -0400] jstallard: KarlHungus: that implies I could do the same thing in a role file, right? I'm just starting with chef, so I'm still a bit foggy on the difference between the chef DSL and pure ruby. Does ruby always work, and the DSL is just syntactic sugar on top of it?
[2013-04-15 18:35:21 -0400] KarlHungus: jstallard: well, sure you could in a role, but a role is compiled to json when its stored on the chef server. you won't have access to the node object
[2013-04-15 18:35:56 -0400] jstallard: KarlHungus: ahh, that makes sense.
[2013-04-15 18:36:00 -0400] jstallard: KarlHungus: log1kal: thanks!
[2013-04-15 18:47:39 -0400] miah: you should just put the differing attributes in the environment
[2013-04-15 18:47:48 -0400] miah: and set them at a higher precedence than the role
[2013-04-15 18:49:24 -0400] btm: @opscode No Chef code review today, still planning on squeezing in cookbook review.
[2013-04-15 18:50:11 -0400] jameson_: is it possible for in a recipe
[2013-04-15 18:50:38 -0400] jameson_: to do include_attribute to overwrite a bunch of default attributes, and then call another recipe via include_recipe?
[2013-04-15 18:50:58 -0400] jameson_: (and force the other recipe to run)
[2013-04-15 18:52:03 -0400] holoway: jameson_: that's not really what normally happens - the attributes get applied (in chef 11, in run list order) then the recipes get called
[2013-04-15 18:53:25 -0400] jameson_: mm, I wanted to because I have 2 recipes that are virtually identical except for variables stored in attriutes
[2013-04-15 18:53:54 -0400] holoway: jameson_: consider making them LWRPs or definitnions?
[2013-04-15 18:54:04 -0400] miah: ^^
[2013-04-15 18:54:11 -0400] miah: most cookbook recipes _should_ be definitions
[2013-04-15 18:54:39 -0400] jameson_: ah thanks holoway I will look at the definition route
[2013-04-15 18:54:56 -0400] jameson_: I've started to convert most things into lwrp
[2013-04-15 18:55:00 -0400] jameson_: fun times.
[2013-04-15 18:55:15 -0400] miah: also consider making the attributes into data stored in a databag or something
[2013-04-15 18:55:31 -0400] holoway: miah: eh, I don't know if I would go that far - but all ya'll might just be ahead of me
[2013-04-15 18:55:49 -0400] holoway: I'm sort of always going to be the last on the train :)
[2013-04-15 18:56:12 -0400] miah: holoway: =) i think that anyhthing in recipes/*.rb should simply be business logic wrapping resources or definitions
[2013-04-15 18:56:47 -0400] holoway: miah: that's what it is already, really
[2013-04-15 18:56:56 -0400] holoway: (a list of resources that reflect business logic)
[2013-04-15 18:56:59 -0400] holoway: I think we agree
[2013-04-15 18:57:00 -0400] miah: because in chef you are working primarily with resources, and sometimes with abstract resource collections (definitions recipes)
[2013-04-15 18:57:03 -0400] miah: yes true true
[2013-04-15 18:57:11 -0400] holoway: ie: stuff like what jameson_ is doing, abstract
[2013-04-15 18:57:17 -0400] holoway: because you basically want a function
[2013-04-15 18:57:19 -0400] miah: but if its not built into a definition or resource provider its tougher to reuse
[2013-04-15 18:57:24 -0400] holoway: right
[2013-04-15 18:58:03 -0400] jtimberman: i find definitions annoyingly tricky at times due to their lack of being a real resource, and tend to prefer just LWRP :)
[2013-04-15 18:58:10 -0400] miah: jtimberman: yes definitely
[2013-04-15 18:58:16 -0400] miah: im not saying we should all start writing definitons
[2013-04-15 18:58:16 -0400] holoway: kids these days
[2013-04-15 18:58:19 -0400] jstallard: miah: the reason I hesitated to put this all in the environments is because then I'm going to end up with a giant environment definition, that has all the details of every different component of our infrastructure. I wanted to keep the pieces related to "application X" bundled neatly together
[2013-04-15 18:58:26 -0400] jtimberman: holoway: it's cool, i can lean ;)
[2013-04-15 18:58:41 -0400] miah: but if you are going to write a recipe based purely on internal resources or other cookbook resources you should give it a standardized interface through a definition or resource
[2013-04-15 18:58:47 -0400] countdigi: qq if i have a metadata.json and metadata.rb in my cookbook and i upload, which one wins? when i download from the chef-server i have both
[2013-04-15 18:59:15 -0400] miah: jstallard: ya. working on what values are actually node attributes vs resource attributes is tricky.
[2013-04-15 18:59:43 -0400] miah: i think attributes get abused and used too much
[2013-04-15 18:59:58 -0400] miah: they certainly make it easy to transport configuration data though
[2013-04-15 19:00:03 -0400] miah: ok. i have a meeting.
[2013-04-15 19:02:14 -0400] countdigi: so reading from docs:  Metadata is compiled whenever the following happens: a cookbook is uploaded to the Chef Server and the knife cookbook metadata sub-command is run.
[2013-04-15 19:02:23 -0400] countdigi: so uploading the cookbook itself does not update metadata?
[2013-04-15 19:02:32 -0400] countdigi: u must run metadata sub-command?
[2013-04-15 19:02:51 -0400] jstallard: so, if I'm thinking about this clearly, instead of [ab]using node attributes, I could instead abstract stuff out into resources, have a different recipe for each environment, then specify the appropriate recipe to use based on the environment in the role
[2013-04-15 19:03:30 -0400] jstallard: cookbook_name::recipe-{prod,staging,dev}, each of which uses the same resources but with different attributes
[2013-04-15 19:21:45 -0400] avishai: hi
[2013-04-15 19:21:57 -0400] avishai: anyone using test-kitchen 1.0.0 with vagrant?
[2013-04-15 19:22:27 -0400] jtimberman: avishai: yes
[2013-04-15 19:22:42 -0400] jtimberman: test-kitchen 1.0.0.alpha.4
[2013-04-15 19:22:49 -0400] jtimberman: vagrant 1.1.
[2013-04-15 19:23:52 -0400] avishai: tes
[2013-04-15 19:23:54 -0400] avishai: yes
[2013-04-15 19:23:59 -0400] avishai: can't get it to work :(
[2013-04-15 19:24:22 -0400] avishai: + it seems berkshelf 1.4.0 doesn't play nice with kitchen-vagrant
[2013-04-15 19:24:26 -0400] avishai: 0.7.4
[2013-04-15 19:24:34 -0400] avishai: could use a hand
[2013-04-15 19:24:43 -0400] avishai: or a tip
[2013-04-15 19:24:44 -0400] ivey: there's a patch on kitchen-vagrant
[2013-04-15 19:24:48 -0400] ivey: pending
[2013-04-15 19:24:57 -0400] ivey: or you could use an older vagrant-berkshelf
[2013-04-15 19:25:01 -0400] ivey: vagrant-berkshelf
[2013-04-15 19:25:04 -0400] avishai: aha
[2013-04-15 19:25:16 -0400] ivey: vagrant-berkshelf added a flag to automatically be disabled
[2013-04-15 19:25:18 -0400] avishai: the patch seems straightforward, looked at the code
[2013-04-15 19:25:24 -0400] ivey: and kitchen needs to set it
[2013-04-15 19:25:36 -0400] avishai: i thought i was missing something
[2013-04-15 19:25:36 -0400] ivey: i think that flag is a bad idea and need to reopen my issue to make it go away
[2013-04-15 19:25:59 -0400] avishai: i tried setting config.berkshelf.enabled in the master vagrantfile
[2013-04-15 19:26:03 -0400] avishai: didn't work
[2013-04-15 19:26:16 -0400] avishai: anyway, just so i'm clear on this subject
[2013-04-15 19:26:23 -0400] avishai: with new test-kitchen
[2013-04-15 19:26:33 -0400] avishai: test cookbooks now go in ./cookbooks ?
[2013-04-15 19:26:47 -0400] avishai: unless i set :kitchen_root
[2013-04-15 19:30:11 -0400] avishai: anyone?
[2013-04-15 19:31:09 -0400] nlloyds: avishai: Sorry, ask again?
[2013-04-15 19:31:27 -0400] nlloyds: just walked in
[2013-04-15 19:32:51 -0400] techminer1: Does this block statement work in a recipe?  "if File.exists?('/path/to/file') do"
[2013-04-15 19:33:18 -0400] techminer1: or is there a better way?
[2013-04-15 19:33:53 -0400] nlloyds: techminer1: Sounds like the best place to put something like that would be in an only_if on a resource
[2013-04-15 19:33:57 -0400] jtimberman: avishai: you need berkshelf-vagrant v1.0.6
[2013-04-15 19:34:33 -0400] nlloyds: techminer1: It's shown as an example on http://docs.opscode.com/chef/resources.html#only-if-examples
[2013-04-15 19:34:59 -0400] techminer1: nlloyds:  awesome thanks I'll take a look
[2013-04-15 19:36:27 -0400] jameson_: how are lwrp and definitions different? or how should i be using them differently?
[2013-04-15 19:36:58 -0400] jameson_: are definitions a heavy-weight-resource-provider?
[2013-04-15 19:37:13 -0400] avishai: jtimberman, ok. what about location of test cookbooks and specs/features?
[2013-04-15 19:37:22 -0400] jameson_: because you can access node parameters and stuff?
[2013-04-15 19:37:29 -0400] nlloyds: jameson_: Definintions are similar to LWRPs, but don't respond to notifications and subscriptions.
[2013-04-15 19:37:54 -0400] jameson_: oh, that makes more sense.
[2013-04-15 19:38:09 -0400] jameson_: nlloyds: thanks!
[2013-04-15 19:38:14 -0400] nlloyds: jameson_: It's almost always better to use an LWRP; definitions pre-date the existence of LWRPs and are not exactly deprecated, but not used as much.
[2013-04-15 19:38:36 -0400] jameson_: but LWRPs can't use node attributes right?
[2013-04-15 19:38:40 -0400] jameson_: you have to feed it all
[2013-04-15 19:38:44 -0400] jameson_: the related data
[2013-04-15 19:38:54 -0400] jameson_: (or hard code it in resources)
[2013-04-15 19:38:57 -0400] nlloyds: jameson_: There's a good discussion of this on a recent food fight show episode: http://foodfightshow.org/2013/03/lwrps.html
[2013-04-15 19:39:17 -0400] jameson_: i've been meaning to listen to that for month(s).... heh
[2013-04-15 19:40:31 -0400] nlloyds: jameson_: I think you can access node attributes in both, just not a good idea to modify them
[2013-04-15 19:40:51 -0400] gdhagger: hey guys.... inadvertantly deleted the client that's key was being used by knife using a local chef server - trying to figure out how to get knife working again.  anyone got any tips?
[2013-04-15 19:41:08 -0400] nlloyds: jameson_: Like here in the apache web_app definition: https://github.com/opscode-cookbooks/apache2/blob/master/definitions/web_app.rb#L32
[2013-04-15 19:41:22 -0400] gdhagger: trying to re-run knife configure -i results in being told my client key isn't valid
[2013-04-15 19:41:50 -0400] nlloyds: jameson_: Or a definition https://github.com/opscode-cookbooks/nagios/blob/master/providers/nrpecheck.rb#L26
[2013-04-15 19:41:55 -0400] nlloyds: er, I mean LWRP
[2013-04-15 19:42:54 -0400] nlloyds: gdhagger: Can you regenerate it through the web UI?
[2013-04-15 19:43:13 -0400] jameson_: oh yay
[2013-04-15 19:44:37 -0400] jtimberman: avishai: test stuff goes in the test/ directory imo. structure still kind of undetermined; cookbook could be anywhere berkshelf can find it.
[2013-04-15 19:44:44 -0400] gdhagger: nlloyds,  not right now - webui is won't startup - this is an oldish chef server i've just inherited... taking a look to see if i can get the ui running
[2013-04-15 19:45:27 -0400] nlloyds: gdhagger: Do you have sudo shell access on any other nodes?
[2013-04-15 19:45:49 -0400] gdhagger: nlloyds, all
[2013-04-15 19:46:17 -0400] auser: hey fairchild
[2013-04-15 19:46:29 -0400] avishai: jtimberman, do i need to manually set the run_list to include the test handlers?
[2013-04-15 19:48:36 -0400] nlloyds: gdhagger: hmm, nm it looks like you need the existing key for another admin in order to generate a new one
[2013-04-15 19:48:38 -0400] jtimberman: avishai: you need recipe[minitest-handler] in your suites in the .kitchen.yml.
[2013-04-15 19:49:58 -0400] gdhagger: nlloyds, starting to wonder if there are any other admin accounts left on this server...
[2013-04-15 19:50:49 -0400] jameson_: http://docs.opscode.com/essentials_cookbook_definitions_example_create_resource.html
[2013-04-15 19:51:14 -0400] jameson_: the `apache_site Definition` at the top is not a typo?
[2013-04-15 19:52:07 -0400] nlloyds: jameson_: Yes looks like that's supposed to be a comment
[2013-04-15 19:58:30 -0400] gad0lin: does eucalyptus supports VPCs in current release?
[2013-04-15 20:02:31 -0400] mhalligan: hrm. did the latest sensu cookbook go fubar for anyone else?
[2013-04-15 20:07:00 -0400] btm: @opscode cookbook code review, join: http://bit.ly/YLubfQ, watch: http://youtu.be/NN1DLRY1IOI #opschef
[2013-04-15 20:26:39 -0400] jameson_: nlloyds, jtimberman: if I am writing new things I should write lwrp and not definitions?
[2013-04-15 20:26:43 -0400] jameson_: or should i not care?
[2013-04-15 20:26:55 -0400] nlloyds: jameson_: Most likely LWRP
[2013-04-15 20:27:08 -0400] surge__: Does anyone use the Nagios cookbook with Nginx and PHP? The only way I ever got it to work was to use PHP FPM not simplecgi. Just curious, because I'm about to put together a pull request since the Nagios cookbook should work out of the box, but yet it doesn't when you enable those 2 settings in the attributes dir.
[2013-04-15 20:35:05 -0400] barefoot: hmm, can you not use include_attribute from `shef` ?
[2013-04-15 20:43:44 -0400] jameson_: nlloyds: using node attributes inside a lwrp is acceptable, but changing them is not?
[2013-04-15 20:44:16 -0400] nlloyds: jameson_: It may be possible, but discouraged
[2013-04-15 20:44:29 -0400] pizzahead: anyone using knife ec2 from master with the knife-151 changes?
[2013-04-15 21:19:55 -0400] maplebed: any suggestions on the easiest way to replace a template provided by an included cookbook?
[2013-04-15 21:20:42 -0400] maplebed: i.e. my wrapper cookbook want's to replace the apache config file that's included in a library cookbook
[2013-04-15 21:23:17 -0400] thehar: maplebed: yes https://github.com/bryanwb/chef-rewind
[2013-04-15 21:23:33 -0400] maplebed: hmph.  I thought there was an easier way than that.
[2013-04-15 21:23:55 -0400] thehar: which cookbook
[2013-04-15 21:24:07 -0400] maplebed: ganglia
[2013-04-15 21:24:52 -0400] thehar: more specifc? which one?
[2013-04-15 21:25:26 -0400] gleam: resources("resourcename").cookbook "whatever"
[2013-04-15 21:25:45 -0400] maplebed: gleam: I think that's what I was looking for.
[2013-04-15 21:26:02 -0400] gleam: e.g. resources("template[/etc/apache2/sites-available/ganglia]").cookbook "ours_ganglia"
[2013-04-15 21:26:47 -0400] nlloyds: gleam: rad
[2013-04-15 21:27:17 -0400] maplebed: gleam: do you have a link to stuff that talks about that? googling for 'chef resources' doesn't get me very far.  :P
[2013-04-15 21:28:02 -0400] gleam: http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/ mentions it
[2013-04-15 21:28:03 -0400] benkay: heyo. i'm working with the apt cookbook (1.7) to update my repositories and download the AppFirst "collector" (it's a monitoring thing), but cannot figure out how to pass `--force-yes` through the LWRP. thoughts?
[2013-04-15 21:28:38 -0400] benkay: ?through the LWRP to apt-get, which is failing on non-authenticated packages.
[2013-04-15 21:28:59 -0400] jtimberman: the resources() method takes a resource as an argument, and returns that resource object.
[2013-04-15 21:29:10 -0400] jtimberman: so you can send methods available to that kind of resource.
[2013-04-15 21:29:29 -0400] jtimberman: parameters in resources you write in the recipe are available as methods to send.
[2013-04-15 21:29:34 -0400] maplebed: gleam: I've seen that one; sadly I think I need more than the brief discussion there.
[2013-04-15 21:29:43 -0400] jtimberman: cookbook is a parameter you can use with 'template' resources.
[2013-04-15 21:29:53 -0400] jtimberman: if you want to explore more, i suggest the chef-shell "recipe_mode"
[2013-04-15 21:30:00 -0400] maplebed: ah, brilliant.
[2013-04-15 21:30:01 -0400] maplebed: thanks.
[2013-04-15 21:30:11 -0400] gleam: http://docs.opscode.com/dsl_recipe_method_resources.html
[2013-04-15 21:30:18 -0400] gleam: not that that gives much more info
[2013-04-15 21:30:45 -0400] techminer1: is there a Chef way to push ssh key pairs to a server, both public and private?  Right now I'm using the Users cookbook but that only distributes the public key.
[2013-04-15 21:31:05 -0400] gleam: i use deploy_wrapper to push private keys
[2013-04-15 21:31:26 -0400] gleam: but that might not be what your use case is
[2013-04-15 21:31:28 -0400] jtimberman: a great blog post describing some of the interactions with Chef resources and how they play out during the run is here: erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/
[2013-04-15 21:32:03 -0400] techminer1: gleam:  thanks I'll take a look
[2013-04-15 21:34:32 -0400] techminer1: gleam: Yea not sure I need the wrapper.  I just have a key pair that I want deployed for a specific user on a set of nodes.  So all nodes in this group have the same key pair for that user.
[2013-04-15 21:34:45 -0400] benkay: does anyone have any ideas about passing "--force-yes" through the apt LWRP?
[2013-04-15 21:35:44 -0400] techminer1: I suppose I could just use a file resource to deploy key files?
[2013-04-15 21:38:00 -0400] jtimberman: benkay: package resource can have a options parameter.
[2013-04-15 21:38:10 -0400] jtimberman: benkay: options "--force-yes"
[2013-04-15 21:38:57 -0400] benkay: thanks jtimberman. were your previous comments addressed at me as well? i feel supes teh fool.
[2013-04-15 21:52:21 -0400] qwertyuiopasdf: ERROR: Chef::Exceptions::ValidationFailed: Option admin must be a kind of TrueClassFalseClass!  You passed "https://[redacted]/users/admin"
[2013-04-15 21:52:42 -0400] qwertyuiopasdf: Trying to run a knife configure -i on a Chef 11.04 server
[2013-04-15 21:52:56 -0400] qwertyuiopasdf: and it's failing with that message
[2013-04-15 21:54:10 -0400] organicveggie: Dumb question about LWRPs. Try to create a template from an LWRP and I can't access stuff in the template the way I would expect.
[2013-04-15 21:54:39 -0400] organicveggie: If my template, inside the LWRP, has something like the following: variables(:my_app=> new_resource)
[2013-04-15 21:54:56 -0400] organicveggie: Should I be able to reference things in the template as "@my_app['foo']"?
[2013-04-15 21:55:21 -0400] gleam: i do believe
[2013-04-15 21:55:41 -0400] organicveggie: Instead, I'm getting an error: Chef::Mixin::Template::TemplateError (undefined method `[]' for Chef::Resource::MyApp)
[2013-04-15 21:55:49 -0400] organicveggie: Would this work even with Chef 0.9.14?
[2013-04-15 21:56:14 -0400] nlloyds: organicveggie: You might need to cast it to a hash
[2013-04-15 21:57:11 -0400] organicveggie: Hrmmm. Dumb question #2. I've never had to cast anything in Ruby How do I cast an object as a Hash? :)
[2013-04-15 21:57:34 -0400] nlloyds: organicveggie: new_resource.to_hash should work
[2013-04-15 21:57:57 -0400] organicveggie: nlloyds: awesome. i'll give that a shot.
[2013-04-15 21:59:42 -0400] kgraham_: hello
[2013-04-15 21:59:51 -0400] kgraham_: i am having the following error
[2013-04-15 22:00:14 -0400] kgraham_: atal: unable to access '/root/.config/git/config': Permission denied
[2013-04-15 22:00:20 -0400] kgraham_: is there a known work around for this?
[2013-04-15 22:01:44 -0400] nlloyds: kgraham_: Where are you seeing that? Could you gist the whole error?
[2013-04-15 22:02:24 -0400] qwertyuiopasdf: Is there a known workaround for this apparently common error?
[2013-04-15 22:02:50 -0400] miah: qwertyuiopasdf: try true or false without quotes
[2013-04-15 22:03:01 -0400] miah: and not another string =)
[2013-04-15 22:03:17 -0400] mikeg: I have multiple resources all calling for a delayed restart of a service.  I was under the impression that in that case chef would only restart the service once.  does anyone know if that's supposed to be true.  or if each of the restarts happening is what I should expect
[2013-04-15 22:03:24 -0400] miah: ah i see. sorry. i misspoke.
[2013-04-15 22:03:29 -0400] miah: getting that when you do a knife configure
[2013-04-15 22:03:30 -0400] kgraham_: sure
[2013-04-15 22:04:40 -0400] kgraham_: nlloyds: https://gist.github.com/kevingraham77/7bfc6a94245b040bba88
[2013-04-15 22:06:14 -0400] miah: qwertyuiopasdf: http://jtimberman.housepub.org/blog/2013/02/10/install-chef-11-server-on-centos-6/#comment-823056529
[2013-04-15 22:07:23 -0400] nlloyds: kgraham_: It might be better to try the deploy_wrapper cokbook ( http://community.opscode.com/cookbooks/deploy_wrapper ) before troubleshooting it too much more. I'm guessing you're already running chef-client as root or through sudo, but it looks like it's confused as to which keys it wants to use to auth with github
[2013-04-15 22:08:57 -0400] kgraham_: nah, this is https://tickets.opscode.com/browse/CHEF-3940
[2013-04-15 22:09:07 -0400] kgraham_: sorry, is there a known workaround for that ?^^
[2013-04-15 22:09:17 -0400] kgraham_: i can't get it fixed right
[2013-04-15 22:10:32 -0400] nlloyds: kgraham_: Ah. Not sure about a workaround and I have to run; sorry I couldn't be of more assistance.
[2013-04-15 22:11:46 -0400] kgraham_: no problem, thank you
[2013-04-15 22:18:54 -0400] qwertyuiopasdf: ERROR: Failed to authenticate to [redacted] as true with key /etc/chef-server/admin.pem
[2013-04-15 22:19:10 -0400] qwertyuiopasdf: Response:  Failed to authenticate as 'true'. Ensure that your node_name and client key are correct.
[2013-04-15 22:19:28 -0400] qwertyuiopasdf: root@chef-server:~# knife configure -i Overwrite /root/.chef/knife.rb? (Y/N) Y Please enter the chef server URL: [http://chef-server.noubox.net:4000] http://chef-server.noubox.net Please enter a name for the new user: [ubuntu] Please enter the existing admin name: [admin] true Please enter the location of the existing admin's private key: [/etc/chef/admin.pem] /etc/chef-server/admin.pem Please enter the validation clientname: [
[2013-04-15 22:19:57 -0400] miah: qwertyuiopasdf: and 'admin' gives the error?
[2013-04-15 22:20:04 -0400] qwertyuiopasdf: Yeah
[2013-04-15 22:20:23 -0400] qwertyuiopasdf: Doing it again using admin as name to get original error
[2013-04-15 22:20:54 -0400] qwertyuiopasdf: root@chef-server:~# knife configure -i Overwrite /root/.chef/knife.rb? (Y/N) Y Please enter the chef server URL: [http://chef-server.noubox.net:4000] http://chef-server.noubox.net Please enter a name for the new user: [ubuntu] ubuntu Please enter the existing admin name: [admin] Please enter the location of the existing admin's private key: [/etc/chef/admin.pem] /etc/chef-server/admin.pem Please enter the validation clientname:
[2013-04-15 22:21:33 -0400] qwertyuiopasdf: tion of the validation key: [/etc/chef/validation.pem] /etc/chef-server/chef-validator.pem Please enter the path to a chef repository (or leave blank): Creating initial API user... Please enter a password for the new user: ERROR: Chef::Exceptions::ValidationFailed: Option admin must be a kind of TrueClassFalseClass!  You passed "https://chef-server.noubox.net/users/admin"
[2013-04-15 22:22:08 -0400] qwertyuiopasdf: So knife 11.04 is just plain broken
[2013-04-15 22:22:18 -0400] qwertyuiopasdf: Is there a workarond around the brokenness?
[2013-04-15 22:22:18 -0400] miah: i suspect there is a ticket open for it, but i can't find it.
[2013-04-15 22:22:23 -0400] miah: you should open one up
[2013-04-15 22:22:26 -0400] qwertyuiopasdf: how?
[2013-04-15 22:22:31 -0400] miah: tickets.opscode.com
[2013-04-15 22:22:42 -0400] qwertyuiopasdf: I tried going to tickets.opscode.com, but there's no place to make a ticket
[2013-04-15 22:23:24 -0400] miah: 'create issue' upper right corner, but you might need to make an account first
[2013-04-15 22:24:13 -0400] qwertyuiopasdf: Thanks.  Making a ticket now
[2013-04-15 22:26:14 -0400] gad0lin_: ohai, how can I specify defaults for company, license, author, author mail for newly created cookbooks?
[2013-04-15 22:26:53 -0400] gad0lin_: I know I can pass them, but can i put them in ~/.chef/knife.rb ?
[2013-04-15 22:28:43 -0400] gad0lin_: ok... there was no question :)
[2013-04-15 22:29:19 -0400] chip-:  gad0lin_ http://docs.opscode.com/config_rb_knife.html
[2013-04-15 22:29:26 -0400] chip-: whoop too late
[2013-04-15 22:30:36 -0400] gad0lin_: chip-: thx!
[2013-04-15 22:54:16 -0400] gad0lin_: why people host zips on google drive, e.g. for gatling I get https://drive.google.com/uc?export=&confirm=no_antivirus&id=0B1zTVlhQrNiyOGhSc3I4QnVCanc? And ark complains Don't know how to expand  ....?
[2013-04-15 22:54:35 -0400] gad0lin_: is there any hack for ark to pull such files?
[2013-04-15 22:54:48 -0400] stuartrexking: Can anyone recommend a particular redis cookbook? There seem to be a few...
[2013-04-15 22:56:24 -0400] bluekelp: client nodes often show up in "knife status" with days since last check-in. manually running chef-client often resolves. is this known and/or ideas on debugging?
[2013-04-15 23:01:33 -0400] gad0lin_: any hints how to pull google drive @!#$ file with ark?
[2013-04-15 23:07:40 -0400] gnoll110_: .b p
[2013-04-15 23:11:04 -0400] miah: stuartrexking: github.com/miah/chef-redis =)
[2013-04-15 23:21:56 -0400] bluekelp: ok i'll re-ask - does anyone else have issues with running chef-client as a service instead of cron? i see a lot of refs to it barfing when runs out of memory. is cron a viable fix?
[2013-04-15 23:25:28 -0400] miah: bluekelp: you can use --fork to cause it to fork a new process on each run interval
[2013-04-15 23:25:41 -0400] miah: i typically run it as a service and haven't seen issues with that
[2013-04-15 23:28:33 -0400] laurent\: yep --fork is definitely a good workaround
[2013-04-15 23:29:43 -0400] bluekelp: miah: do you use the node['chef-client']['daemon_options'] for that?
[2013-04-15 23:30:15 -0400] bluekelp: miah: is there a preferred way (other than wrapping the cookbook/recipe) to put attrs like this on every node?
[2013-04-15 23:31:39 -0400] miah: use roles / environments =)
[2013-04-15 23:32:29 -0400] bluekelp: problem is roles aren't versioned so run into the "global" problem. still this "should" be global enough to be ok
[2013-04-15 23:32:55 -0400] laurent\: it's global here :)
[2013-04-15 23:33:37 -0400] laurent\: what chef version are you running ?
[2013-04-15 23:33:54 -0400] bluekelp: 11
[2013-04-15 23:33:58 -0400] miah: i keep hearing that 'roles arent versioned' but i still say its not a problem
[2013-04-15 23:35:17 -0400] laurent\: i haven't really read the latest comments on CHEF-3367, you might want to have a look at it.
[2013-04-15 23:35:32 -0400] laurent\: (issue with pidfile and --fork)
[2013-04-15 23:35:51 -0400] miah: roles and environments are fine without 'versions' as long as you understand how attribute precedence works.
[2013-04-15 23:36:46 -0400] log1kal: miah I've shot myself in the foot with roles not being versioned, but it was more my fault than "roles aren't versioned"'s fault
[2013-04-15 23:37:02 -0400] log1kal: if that role had been a versioned cookbook, It wouldn't have happened
[2013-04-15 23:37:24 -0400] miah: i think the problem exists because of how most cookbooks are written
[2013-04-15 23:37:38 -0400] miah: people are using attributes to quickly swap variables in a recipe
[2013-04-15 23:38:25 -0400] miah: and so you end up with the same cookbook being called in multiple different run_lists but with different attribute sets
[2013-04-15 23:38:57 -0400] log1kal: the place where roles failed me was the runlists aren't versionable
[2013-04-15 23:39:00 -0400] miah: ive written that type of cookbook myself and see them to be problematic
[2013-04-15 23:39:08 -0400] log1kal: so I can do the env_run_list juggle as something goes through to prouction
[2013-04-15 23:39:19 -0400] miah: that doesnt matter
[2013-04-15 23:39:20 -0400] log1kal: or I can just promote versions of cookbooks through environments
[2013-04-15 23:39:25 -0400] miah: because you can specify attributes in environments
[2013-04-15 23:39:37 -0400] log1kal: right, my issue had nothing to do with attributes
[2013-04-15 23:39:47 -0400] miah: if you have an attribute that changes based on environment. it should be set in an environment and not a role.
[2013-04-15 23:40:01 -0400] log1kal: it was that a role's runlist was changing as we were promoting from dev -> prod
[2013-04-15 23:40:18 -0400] miah: its tricky
[2013-04-15 23:40:28 -0400] miah: CI and CD are not simple problems
[2013-04-15 23:40:45 -0400] miah: and chef as a framework lets you do lots of things
[2013-04-15 23:40:58 -0400] miah: so you really need to create some standards in your infrastructure for how you are going to handle such things
[2013-04-15 23:41:07 -0400] log1kal: I appreciate that chef isn't so opinionated that it'll let me shoot myself in the foot
[2013-04-15 23:41:08 -0400] miah: (within chefs limitations / features)
[2013-04-15 23:42:15 -0400] pixlpushr: anyone else experiencing this when running chef-client: FATAL: SocketError: Error connecting to [URL to node] - getaddrinfo: Temporary failure in name resolution
[2013-04-15 23:42:47 -0400] pixlpushr: could servers be down? i was able to run chef-client successfully a few minutes prior
[2013-04-15 23:43:04 -0400] jameson_: is there a way to make the script command's not_if command run before the script?
[2013-04-15 23:43:11 -0400] jameson_: or am I just reading this wrong..
[2013-04-15 23:44:18 -0400] pixlpushr: jameson: that resource won't run if not_if evaluates to true
[2013-04-15 23:45:37 -0400] jameson_: not_if "test -f /path/to/a/file"
[2013-04-15 23:48:28 -0400] jameson_: pixlpushr: I do not_if "test -f /path/to/test_file"
[2013-04-15 23:48:30 -0400] jameson_: but it still runs
[2013-04-15 23:59:08 -0400] mikeg: anyone know of any HA guides for chef 11?  maybe too soon but not finding via google.
[2013-04-15 23:59:29 -0400] tmichael: seems knife will not pretty-print for me when i use chef 11 client, but works okay if i use 10.x.  anything change that would explain this?
[2013-04-15 23:59:59 -0400] tmichael: tried forcing --format pp via knife.rb, but that didn't help
