[2013-06-20 00:05:13 -0400] log1kal: who can I send money and hugs to for a chef sticker? miss my "whipping up awesome" sticker :(
[2013-06-20 00:05:51 -0400] log1kal: Wish I could just reorder the sticker from stickermule :(
[2013-06-20 00:11:22 -0400] stormerider: unfortunately i can't really sticker my work laptop (or, at least, i don't feel like i should)
[2013-06-20 00:17:55 -0400] flaccid: coderanger: i think i've made some process but i'm getting /srv/blank-django/shared/env/bin/python: can't open file 'manage.py': [Errno 2] No such file or directory
[2013-06-20 00:17:57 -0400] stormerider: is there a quick/easy way to get the current run_list for a given node?
[2013-06-20 00:18:28 -0400] flaccid: coderanger: i'm trying to get it to work with https://github.com/toast38coza/blank-django
[2013-06-20 00:19:57 -0400] flaccid: coderanger: must be expecting a certain structure for the project. i can't find what its expecting
[2013-06-20 00:22:28 -0400] flaccid: anyone else alive familiar with using application_python with django?
[2013-06-20 00:26:19 -0400] flaccid: looks like it expects manage.py in the root of the repos
[2013-06-20 00:27:38 -0400] flaccid: its also not installing django with its virtualenvs pip
[2013-06-20 00:32:50 -0400] flaccid: ok so i can ensure django is installed by using requirements
[2013-06-20 00:38:10 -0400] stormerider: if i use chef-rewind and include_recipe "blah::blah2", do i still need "recipe[blah::blah2]" in the run_list or can I just have my rewound recipe instead?
[2013-06-20 00:41:07 -0400] Majost: Is there a cookbook or built-in to manage linux facls?
[2013-06-20 00:48:43 -0400] flaccid: this might seem like a silly question, but how do you do boolean as a value in json?
[2013-06-20 00:49:17 -0400] flaccid: oh i can just do true or whatever
[2013-06-20 01:30:50 -0400] bluethundr: hey all.. I'm using open source chef and attempting to run some knife commands. I find that can run chef-client successfully and without error. But when I try to knife I see the following error:
[2013-06-20 01:30:52 -0400] bluethundr: http://paste.jokefire.com/index.php/view/79807619
[2013-06-20 01:31:08 -0400] bluethundr: can someone please point me in the right direction here? thanks
[2013-06-20 01:31:57 -0400] stormerider: does the user running knife have permissions to read /etc/chef/client.pem?
[2013-06-20 01:32:07 -0400] bluethundr: let me check
[2013-06-20 01:32:40 -0400] bluethundr: yes she does
[2013-06-20 01:32:41 -0400] bluethundr: -rw-------  1 walkiriasoares  staff  1679 Jun 19 21:16 /etc/chef/client.pem
[2013-06-20 01:33:08 -0400] bluethundr: drwxr-xr-x  5 walkiriasoares  staff  170 Jun 19 21:16 /etc/chef
[2013-06-20 01:34:00 -0400] flaccid: coderanger: yay finally got it going with a blank project :)
[2013-06-20 01:34:05 -0400] bluethundr: [walkiriasoares@wal-mac:~] #whoami
[2013-06-20 01:34:05 -0400] bluethundr: walkiriasoares
[2013-06-20 01:36:45 -0400] stormerider: im not sure, off the top of my head.
[2013-06-20 01:36:59 -0400] stormerider: i usually create a client key separate from the machine key
[2013-06-20 01:37:01 -0400] bluethundr: hmm ok
[2013-06-20 01:37:25 -0400] stormerider: though i know you can work around that, i haven't personally done so.
[2013-06-20 01:38:37 -0400] bluethundr: maybe I need to recreate the client key? is there a doc on how to do that with open source server?
[2013-06-20 01:52:10 -0400] stormerider: i would just create another. if chef-client works with that key, then it should be an ok key.
[2013-06-20 01:53:21 -0400] bluethundr: hmm ok sounds good
[2013-06-20 01:53:41 -0400] bluethundr: however I think I may have found a document that deals with the problem I'm having
[2013-06-20 01:53:41 -0400] bluethundr: http://wiki.opscode.com/pages/viewpage.action?pageId=19071326
[2013-06-20 01:53:42 -0400] stormerider: im thinking it might be a client name issue with the key
[2013-06-20 01:54:12 -0400] stormerider: yeah, that sounds right
[2013-06-20 01:54:12 -0400] bluethundr: hmm could be
[2013-06-20 01:54:28 -0400] stormerider: because knife isn't using the same name as the client
[2013-06-20 01:54:44 -0400] stormerider: knife is using walkiri... and the client is wal-mac
[2013-06-20 01:54:51 -0400] stormerider: im guessing, at least.
[2013-06-20 01:54:51 -0400] bluethundr: hmmm ok .. specified in knife.rb I take it
[2013-06-20 01:54:56 -0400] stormerider: yeah.
[2013-06-20 01:54:59 -0400] bluethundr: ahh
[2013-06-20 01:55:00 -0400] bluethundr: ok
[2013-06-20 01:55:02 -0400] bluethundr: cool
[2013-06-20 01:55:31 -0400] stormerider: if you want them to be the same, try "node_name 'wal_mac'" and see if that works
[2013-06-20 01:55:58 -0400] stormerider: but i prefer the separation of clients anyways, seems operationally cleaner.
[2013-06-20 01:58:57 -0400] bluethundr: cool I'll give it a shot
[2013-06-20 03:03:10 -0400] swedish_chef: Any strong opinions on process runners (Bluepill, Upstart, Runit, etc.)  + process monitoring for a diverse set of processes/nodes (both foreground + background). I'm curious about experiences you may have had with them + which ones have high-quality HW/LWRPs, etc.
[2013-06-20 03:06:44 -0400] stormerider: ive been using bluepill and it's been pretty decent. upstart works ok but i had problems with it tracking things that forked, because it doesn't support reading from a pid file.
[2013-06-20 03:07:45 -0400] stormerider: there's also a bluepill-nagios gem to allow you to send NCSA events to a nagios server; i opted to just write nagios process checkers instead for higher personal comfort level/paranoia
[2013-06-20 03:08:36 -0400] stormerider: im currently managing the pills by hand instead of via chef, but it's on the tech-debt list
[2013-06-20 03:12:36 -0400] jamesgolick: where should I go to get support for hosted chef?
[2013-06-20 03:26:39 -0400] swedish_chef: stormerider thanks
[2013-06-20 03:26:58 -0400] swedish_chef: paranoia saves the day
[2013-06-20 03:27:21 -0400] stormerider: swedish_chef: np
[2013-06-20 03:43:40 -0400] cwj: jamesgolick: https://www.opscode.com/support/tickets/
[2013-06-20 03:43:47 -0400] jamesgolick: yea just found that thanks
[2013-06-20 03:43:58 -0400] cwj: cheers
[2013-06-20 03:43:59 -0400] jamesgolick: one of our indexes is out of date
[2013-06-20 03:44:14 -0400] jamesgolick: lol inconsistent systems
[2013-06-20 03:47:51 -0400] cwj: eventually consistent, provided someone jiggles the handle
[2013-06-20 03:50:01 -0400] Otterley: depends on your rate of change ;)
[2013-06-20 04:02:56 -0400] FuZion755: hi all, I'm working on using ruby_build to install a system wide ruby during my chef run.  I'm running into an issue with some opscode recipes though.  The recipes reference node[:languages][:ruby] attributes, but they point to the ruby version that exited prior to install... I'm coming across references to refreshing these attributes in my searches but can't find a concrete example, is it possible to refresh the attrib
[2013-06-20 04:02:57 -0400] FuZion755: utes?
[2013-06-20 04:13:38 -0400] stormerider: FuZion755: it sounds like you're not using the omnibus client, is that correct?
[2013-06-20 04:16:03 -0400] FuZion755: stormerider, nope.. looking into that now though, I've been doing some more research it seems like the node[:languages] hash is generated by ohai?  Considering reloading Ohai, but it'd be nice if I could just reload the languages part
[2013-06-20 04:48:21 -0400] rava: can chef 10 clients connect ok to chef 11 server?
[2013-06-20 04:48:46 -0400] rava: trying to monkey out if i can roll it out incrementally
[2013-06-20 04:49:18 -0400] flaccid: i think they can but i don't know for sure
[2013-06-20 04:52:50 -0400] stormerider: yes, they can
[2013-06-20 04:53:29 -0400] rava: anyone use encrypted data bags with knife backup plugin?
[2013-06-20 04:53:45 -0400] rava: it keeps bailing on me when trying to restore my auth data bag items
[2013-06-20 04:57:44 -0400] rava: and if i try to just push specific parts of my back up, i get permission denied /var/chef
[2013-06-20 04:58:35 -0400] rava: just cookbooks it seems
[2013-06-20 05:09:52 -0400] flaccid: anyone know off the top of their head which version of the python cookbook would be pre why-run and work on chef 0.10.10 ?
[2013-06-20 05:29:21 -0400] flaccid: i finks 1.0.8 should be old enough
[2013-06-20 06:05:36 -0400] rava: anyoen got a work around for the 1.1 chef-server cookbook bailing on the rubygems-install recipe?
[2013-06-20 06:05:57 -0400] rava: it does a not_if against where the gems might be stored, but if the directories don't exist it just pukes the recipe
[2013-06-20 06:07:15 -0400] rava: getting this to be more exact: https://gist.github.com/5820623
[2013-06-20 06:15:12 -0400] rava: anyone around that can help with the chef 1.1.0 cookbook?
[2013-06-20 06:20:41 -0400] rava: or could it be failing because i'm using omnibus chef-client to install a gem based chef-server
[2013-06-20 06:20:46 -0400] stormerider: blargh, just got someone pinging me on my personal email about a chef/puppet gig in AZ. a) personal email, b) ... i'm in WA, why would I want to move to AZ?
[2013-06-20 06:20:50 -0400] stormerider: frelling recruiters
[2013-06-20 06:21:04 -0400] rava: lol
[2013-06-20 06:27:09 -0400] flaccid: hmm Installing python_pip[virtualenv] version latest. error: "pip install  virtualenv" exited with 127, expected 0. <-- why would this happen? isn't 127 not found?
[2013-06-20 06:27:29 -0400] flaccid: hmm don't think this box does the sane path
[2013-06-20 06:28:35 -0400] stormerider: flaccid: are you sure that pip has been installed?
[2013-06-20 06:28:52 -0400] stormerider: i know a bunch of times i've had to easy_install pip first
[2013-06-20 06:28:53 -0400] flaccid: yeah i think its coz this node doesn't do the sane path defaults. pip is in /usr/local/bin
[2013-06-20 06:29:06 -0400] stormerider: ah, yeah, that'd do it
[2013-06-20 06:29:34 -0400] flaccid: hmm now next one is virtualenv: not found
[2013-06-20 06:30:08 -0400] flaccid: i'm doing application_python with django. so i am wondering what is responsible here for installing virtualenv
[2013-06-20 06:30:36 -0400] flaccid: perhaps this should be in requirements.txt in the app
[2013-06-20 06:31:33 -0400] flaccid: ah this is the system one. no sane path again
[2013-06-20 07:21:53 -0400] fiebre: hi
[2013-06-20 07:22:11 -0400] fiebre: i have a weird problem with knife under Mint Linux 14
[2013-06-20 07:22:28 -0400] fiebre: i try to bootstrape a vagrant VM with knife
[2013-06-20 07:22:59 -0400] fiebre: knife bootstrap localhost -p 2222 -r 'role[logstash-server]' -x vagrant -P vagrant --sudo -VV
[2013-06-20 07:23:19 -0400] fiebre: DEBUG: Looking for bootstrap template in /var/lib/gems/1.9.1/gems/chef-11.4.4/lib/chef/knife/bootstrap
[2013-06-20 07:23:19 -0400] fiebre: DEBUG: Found bootstrap template in /var/lib/gems/1.9.1/gems/chef-11.4.4/lib/chef/knife/bootstrap
[2013-06-20 07:23:19 -0400] fiebre: Bootstrapping Chef on localhost
[2013-06-20 07:23:20 -0400] fiebre: DEBUG: Adding localhost
[2013-06-20 07:23:20 -0400] fiebre: DEBUG: establishing connection to localhost:2222
[2013-06-20 07:23:20 -0400] fiebre: ERROR: Network Error: getaddrinfo: Name or service not known
[2013-06-20 07:23:54 -0400] fiebre: its weird because after some time it starts working
[2013-06-20 07:24:33 -0400] fiebre: hopefully anybody has an idear
[2013-06-20 07:28:26 -0400] flaccid: fiebre: what does host localhost return?
[2013-06-20 07:40:35 -0400] rava: anyone get a good backup and restore running with knife backup?
[2013-06-20 07:40:46 -0400] rava: it doesn't seem to handle the node client keys
[2013-06-20 07:41:17 -0400] fiebre: flaccid: host localhost
[2013-06-20 07:41:17 -0400] fiebre: localhost has address 127.0.0.1
[2013-06-20 07:41:33 -0400] fiebre: flaccid: ssh to the vagrant box over localhost and port 2222 is possible with no problems
[2013-06-20 07:42:23 -0400] fiebre: rava: https://github.com/mdxp/knife-backup
[2013-06-20 07:43:10 -0400] rava: fiebre: right, i used that plugin to backup my server
[2013-06-20 07:43:19 -0400] flaccid: fiebre: i'm not quite sure, but did you run that command in the vagrant box?
[2013-06-20 07:43:32 -0400] rava: when i restored to the new server, and pointed an existing node at it, the chef-client run gets 403ed
[2013-06-20 07:43:34 -0400] fiebre: flaccid: nope on my kniw orkstation
[2013-06-20 07:43:45 -0400] flaccid: fiebre: isn't the chef run int he box?
[2013-06-20 07:43:50 -0400] fiebre: faccid: it works sometimes - thats the weird part
[2013-06-20 07:44:04 -0400] flaccid: i dunno, try #vagrant i guess
[2013-06-20 07:44:05 -0400] fiebre: flaccid: it is. knife bootstraps chef-client into the vagrant box.
[2013-06-20 07:44:13 -0400] fiebre: flaccid: ok thanks
[2013-06-20 07:45:46 -0400] rava: but it's weird, for my admin user's client key works
[2013-06-20 07:47:20 -0400] fiebre: rava: what does -> knife client list -VV shows you if you point it to the cloned chef server ?
[2013-06-20 07:48:17 -0400] rava: gives me a client list
[2013-06-20 07:48:42 -0400] rava: for my user's client, it works just fine
[2013-06-20 07:48:51 -0400] rava: it's my node clients that it's puking on
[2013-06-20 07:49:45 -0400] fiebre: ah sorry - my mistake
[2013-06-20 07:50:15 -0400] rava: also can't seem to rebuild the indexes on the host
[2013-06-20 07:50:40 -0400] fiebre: if the key is recognized as valid - this is the correect behaviour
[2013-06-20 07:51:01 -0400] rava: the key for knife usage, yes
[2013-06-20 07:51:06 -0400] rava: the key for a chef-client run on a node, no
[2013-06-20 07:51:49 -0400] fiebre: mhm
[2013-06-20 07:52:03 -0400] fiebre: you have seen this comment on the knife backup script ? -> "Known limitation: currently it is not possible to overwritte a client object already available on the target server and these will be skipped."
[2013-06-20 07:53:02 -0400] rava: hrm, any work around?
[2013-06-20 07:53:25 -0400] fiebre: delete the client before import i guess
[2013-06-20 07:53:31 -0400] fiebre: in the chef server
[2013-06-20 07:55:27 -0400] flaccid: coderanger: it all worked out y0 http://www.rightscale.com/library/server_templates/Django-App-Server/lineage/2096
[2013-06-20 08:04:02 -0400] railsraider: hi, how can use search to add nodes to an attrbute, i tried making a library and i get Undefined node attribute or method `search' on `node'
[2013-06-20 08:04:14 -0400] railsraider:   search(:node, 'block_device:xvd*')
[2013-06-20 08:04:32 -0400] railsraider: in my attribute file i did => default['icinga']['servers_with_group']['xvd_volumes'] = xvd_volumes
[2013-06-20 08:05:02 -0400] railsraider: the xvd_volumes is a method that has the line   search(:node, 'block_device:xvd*') in it
[2013-06-20 08:07:09 -0400] railsraider: is this ok to do ?   node.set['icinga']['servers_with_group']['xvd_volumes'] = search(:node, 'block_device:xvd*')
[2013-06-20 08:12:01 -0400] railsraider: i guess my question is really, how do i use search to make an attribute
[2013-06-20 08:15:37 -0400] rava: is there any way to restore a previous chef server's client and validation keys to a clone server?
[2013-06-20 08:21:46 -0400] railsraider: what's the right way to use search for attribute files?
[2013-06-20 08:22:00 -0400] railsraider: do i need to always use the search in a recipe and set  node?
[2013-06-20 08:22:26 -0400] koaps: rava: look at https://github.com/jkeiser/knife-essentials
[2013-06-20 08:22:57 -0400] koaps: assuming you still have access to the previous server
[2013-06-20 08:25:06 -0400] rava: koaps: thanks, i'll look into it
[2013-06-20 08:25:15 -0400] koaps: rava: for reference, http://www.opscode.com/blog/2013/03/12/5106/
[2013-06-20 08:25:29 -0400] koaps: I did that to go from a old server with chef 10 to a new server with chef 11
[2013-06-20 08:25:50 -0400] koaps: only issue I had was with the users accounts, had to reset the passwords
[2013-06-20 08:26:11 -0400] koaps: client and nodes were fine
[2013-06-20 08:26:54 -0400] koaps: railsraider: wish I could help ya, but having messed with searches yet
[2013-06-20 08:28:34 -0400] koaps: are you using that search data for reference in a cookbook? or just want to be able to find the servers that have those block devices for icinga?
[2013-06-20 08:45:23 -0400] GianArb: hi! sorry can you help me? http://pastebin.com/v46y6fVh
[2013-06-20 08:45:44 -0400] GianArb: i have the problem with opscode database recipe
[2013-06-20 08:52:13 -0400] koaps: GianArb: https://github.com/opscode-cookbooks/mysql ?
[2013-06-20 08:52:59 -0400] GianArb: yes thanks koaps the problem is in confiuration of mysql recipe :) i'm try another configuration!
[2013-06-20 08:53:02 -0400] GianArb: thanks!
[2013-06-20 08:53:40 -0400] koaps: so you aren't using the mysql_database_user  anymore right?
[2013-06-20 08:55:22 -0400] GianArb: mmm yes but the problem is mysql
[2013-06-20 08:55:55 -0400] GianArb: becouse if i try to connect from console doesn't found :D
[2013-06-20 08:56:11 -0400] GianArb: now i'm trying to resolve this problem :)
[2013-06-20 09:12:48 -0400] zeroXten: any eta for chef client 11.6 ?
[2013-06-20 09:14:09 -0400] zeroXten: and anyone else have issues with 11.4 hanging when it loses connection to managed chef?
[2013-06-20 09:38:06 -0400] rava: so using knife download, then upload to clone server, doesn't seem my clients are recognized
[2013-06-20 09:39:21 -0400] koaps: you see all the clients in the dir you downloaded to?
[2013-06-20 09:39:45 -0400] rava: yup
[2013-06-20 09:39:52 -0400] rava: along with the key for the client
[2013-06-20 09:40:07 -0400] koaps: chef 11 or 10?
[2013-06-20 09:40:10 -0400] rava: 10
[2013-06-20 09:40:16 -0400] rava: restoring from 10 to 10
[2013-06-20 09:40:29 -0400] koaps: humm, cause I know in 11 you do a reindex
[2013-06-20 09:40:41 -0400] rava: did a knife index rebuild
[2013-06-20 09:43:53 -0400] koaps: do you see the same pub keys for the clients on both chef servers in the webui?
[2013-06-20 09:45:14 -0400] rava: my web login works
[2013-06-20 09:45:40 -0400] koaps: so the user accounts where transfered
[2013-06-20 09:46:10 -0400] rava: the keys don't match
[2013-06-20 09:46:27 -0400] rava: what the heck could be the difference?
[2013-06-20 09:46:41 -0400] koaps: did they already exist before?
[2013-06-20 09:46:55 -0400] koaps: I think the upload skips existing data
[2013-06-20 09:48:48 -0400] rava: hrm..yes i see how it could be the case
[2013-06-20 09:49:07 -0400] rava: since the couchdb data is from a snapshot volume
[2013-06-20 09:49:20 -0400] koaps: humm
[2013-06-20 09:49:42 -0400] rava: though i wonder why the keys are different after
[2013-06-20 09:49:47 -0400] koaps: yea
[2013-06-20 09:49:57 -0400] rava: going to try deleting all the clients, then re-uploading
[2013-06-20 09:50:16 -0400] koaps: the other thing could be if the clone and the clients clocks are different
[2013-06-20 09:50:34 -0400] koaps: but you would see that as an error about time skew
[2013-06-20 09:50:45 -0400] rava: ya, this is just a 403
[2013-06-20 09:50:48 -0400] rava: er, 401
[2013-06-20 09:52:06 -0400] koaps: I have seen an issue where regenerating a existing client key has failed, we had to delete the client entirely and then it worked
[2013-06-20 09:52:32 -0400] koaps: believe that was chef 10 too
[2013-06-20 09:53:12 -0400] rava: including the chef admin client keys?
[2013-06-20 09:53:57 -0400] rava: damn, deleting the clients, then re-upload didnt' work
[2013-06-20 09:54:16 -0400] koaps: not sure, I saw it today for a user's client key when he was switching chef servers, had to delete his key and create a new one, but that was for knife.
[2013-06-20 09:54:54 -0400] koaps: we tried to regenereate his key from the webui, but chef kept refusing it
[2013-06-20 09:55:51 -0400] rava: could it be that the download is fro ma chef 10.18 server and this is a chef 10.26 server?
[2013-06-20 09:56:45 -0400] koaps: don't think it should matter, everything is over the API, why you can go from 10 to 11 with the down/upload method
[2013-06-20 09:57:02 -0400] rava: ya, i figured as much, and am even more boggled
[2013-06-20 09:58:03 -0400] rava: yeah, all hte client keys are different
[2013-06-20 09:58:07 -0400] rava: faaawwwwkkk
[2013-06-20 09:58:43 -0400] rava: going to hit this again in the morning, it's driving me a little batty
[2013-06-20 09:58:46 -0400] rava: thanks for the help
[2013-06-20 09:59:01 -0400] koaps: l8rs
[2013-06-20 10:53:17 -0400] n0xie: https://www.youtube.com/watch?v=sdyC1BrQd6g
[2013-06-20 10:53:20 -0400] n0xie: this still cracks me up
[2013-06-20 10:53:34 -0400] n0xie: woops wrong channel :)
[2013-06-20 10:57:31 -0400] prognostikos: anyone know of other resources like this: http://jtimberman.housepub.org/blog/2012/11/19/chef-repository-berkshelf-conversion/ for converting away from the old monolithic style of chef repo?
[2013-06-20 11:41:06 -0400] hirohanin: Hey (newbie) here
[2013-06-20 11:41:35 -0400] hirohanin: was facing an issue with chef-solo and zenoss::server  ...
[2013-06-20 11:41:50 -0400] hirohanin: is this the right place to pose the question
[2013-06-20 11:43:07 -0400] hirohanin: Nevertheless - Here is the error which is see : Generated at 2013-06-20 11:09:40 +0530 Mixlib::ShellOut::CommandTimeout: execute[zendmd] (/home/rohan/chef/cookbooks/zenoss/providers/zendmd.rb line 16) had an error: Mixlib::ShellOut::CommandTimeout: command timed out: ---- Begin output of /usr/local/zenoss/zenoss/bin/zendmd --commit --script=846099.dmd ---- STDOUT: STDERR: 2013-06-20 10:08:39 WARNING ZEO.zrpc (29100) CW: error conne
[2013-06-20 12:44:20 -0400] tevren: g'morning
[2013-06-20 12:45:40 -0400] tevren: scenerio: im writing a plugin to delete nodes/clients from chef and schedule downtime in nagios, however i dont know how to call knife ssh in my plugin to write to the nagios cmd file with my plugin
[2013-06-20 12:46:10 -0400] tevren: does anyone have experience in using knife::ssh in their knife plugins?
[2013-06-20 13:15:43 -0400] simon____: Hello!
[2013-06-20 13:19:57 -0400] axyelp: i have this on my node
[2013-06-20 13:19:58 -0400] axyelp: Run List:    role[base], role[api]
[2013-06-20 13:19:58 -0400] axyelp: Roles:       base, api
[2013-06-20 13:20:01 -0400] axyelp: but yet when i attempt to fetch node.roles in a recipe, it doesn't work! any thoughts?
[2013-06-20 13:20:05 -0400] aabes: I'm trying to find instructions on creating a user on hosted chef that has read-only permissions to access all current nodes and new nodes....
[2013-06-20 13:20:09 -0400] aabes: any pointers?
[2013-06-20 13:21:00 -0400] aabes: axyelp - when you say "doesn't work"... what happens?
[2013-06-20 13:21:41 -0400] axyelp: abbes: oh, sorry. it returns as empty list.
[2013-06-20 13:21:48 -0400] axyelp: aabes: **
[2013-06-20 13:23:27 -0400] axyelp: aabes: but when i fetch the same in the default recipes of the default run list [base,api], i get the expected values ["base","api"]
[2013-06-20 13:24:23 -0400] aabes: can you put your recipe on gist
[2013-06-20 13:26:45 -0400] axyelp: what? the recipe? it is only this statement: 'log "ROLE LIST #{node.roles}"'
[2013-06-20 13:27:00 -0400] axyelp: whilst this one works well everywhere 'log "ENVIRONMENT #{node.chef_environment}"'
[2013-06-20 13:33:09 -0400] aabes: hmm.. i think in chef11 the process of resolving attributes has been enhanced in a way that only fully evaluates them after all recipies have been compiled
[2013-06-20 13:33:19 -0400] aabes: the short version - try the same thing, but wrap it in a ruby block
[2013-06-20 13:33:21 -0400] axyelp: aabes: & like it should, it works when i include_recipe base::deploy in the default recipe
[2013-06-20 13:33:41 -0400] axyelp: oh! ruby_block? alright! will do that!
[2013-06-20 13:33:45 -0400] axyelp: aabes: thanks!
[2013-06-20 13:33:48 -0400] aabes: to force it to be executed during the converge phase, rather than compile phase
[2013-06-20 13:50:13 -0400] defishguy2: Running chef-sever 11.0.2 on a new server.  On our other chef-servers we have apache running along side to serve up files that our app servers need.  I'm having a hella time trying to get nginx to serve up static files over 80.  Has anyone else ran into this or something similar?
[2013-06-20 14:05:36 -0400] aruntomar: defishguy2: ideally, you should be running chef server on a separate instance. but anyways, if you have to, then paste the config in gist so that we can see what you are trying to do and try to help you out.
[2013-06-20 14:10:00 -0400] jmkacz: ohai chefs
[2013-06-20 14:10:43 -0400] jmkacz: Question about databags. Is it documented anywhere the formats of BAG_NAME and ITEM_NAME? (http://docs.opscode.com/essentials_data_bags.html)
[2013-06-20 14:10:55 -0400] jmkacz: For example, periods are not allowed in ITEM_NAME.
[2013-06-20 14:20:22 -0400] jmkacz: Found it. "/^[\-[:alnum:]_]+$/" in ./lib/chef/data_bag.rb and ./lib/chef/data_bag_item.rb
[2013-06-20 14:31:57 -0400] cpasmoi: Well, can someone add this information in the documentation ?
[2013-06-20 14:33:12 -0400] coderanger: flaccid: woot!
[2013-06-20 14:35:33 -0400] ddyke: Has anyone had any issues with Berks 2 and it locking ref's?
[2013-06-20 14:37:51 -0400] ianco: ddyke: sort of, seeing an issue with berks lying about what branch its actually using
[2013-06-20 14:41:21 -0400] SkiDamien_: Folks, my company needs to do local password management pushed out by Chef. I was wondering what people used a mechanism to change passwords. So I am trying to provide users to change their password and then have Chef push them out. Thoughts?
[2013-06-20 14:42:31 -0400] ianco: SkiDamien_: sounds terrifying. use ldap?
[2013-06-20 14:43:31 -0400] gchristensen: ldap is pretty gerat
[2013-06-20 14:43:35 -0400] gchristensen: great too
[2013-06-20 14:43:48 -0400] SkiDamien_: we are trying to just use local auth
[2013-06-20 14:44:34 -0400] SkiDamien_: I've done local auth with Chef pushing out keys but this is the first time with shadow passwords
[2013-06-20 14:45:22 -0400] ianco: SkiDamien_: i think ldap was created to avoid what you proposed, but thats my opinion
[2013-06-20 14:51:13 -0400] jchauncey: if i do a knife cookbook create foo where is foo put? if i dont have the cookbook path set
[2013-06-20 14:51:21 -0400] jchauncey: it is not put in cwd
[2013-06-20 14:51:31 -0400] admin0: find . | grep foo ?
[2013-06-20 14:52:49 -0400] ddyke: ianco: Yeah similiar, I will update the master branch, reload berks however it loads the old commit
[2013-06-20 15:02:08 -0400] ddyke: I am trying to notify my ruby block from a File resource, however all that happens on chef run is the action :nothing,
[2013-06-20 15:02:15 -0400] ddyke: any suggestiones?
[2013-06-20 15:04:23 -0400] cpasmoi: can you paste the ruby and cookbook_file blocks ?
[2013-06-20 15:05:37 -0400] chris613: Is there a proper generic way to check if a specific version of a package is already installed on the system?
[2013-06-20 15:05:44 -0400] cpasmoi: see http://docs.opscode.com/resource_common_notifications.html#examples also
[2013-06-20 15:07:25 -0400] ddyke: cpasmoi: I think I figured it out, I had the ruby_block defined after the resource, so iM placing the ruby_block a head in the file, and vagrant provisioning to see
[2013-06-20 15:07:35 -0400] cpasmoi: chris613, you mean install a specific version of a package, or do something if a specific version is installed ?
[2013-06-20 15:07:59 -0400] chris613: cpasmoi: To do something if a specific version is installed
[2013-06-20 15:08:15 -0400] cpasmoi: hum indeed, I've always set the block with action :nothing before the other block with notifies...
[2013-06-20 15:09:05 -0400] ddyke: http://pastebin.com/j0pGgcy4
[2013-06-20 15:09:19 -0400] ddyke: that is the re-order, I had it below the s3_file resource
[2013-06-20 15:09:30 -0400] cpasmoi: chris613, well in that case I don't know a generic way =/
[2013-06-20 15:11:19 -0400] ddyke: chris613: nothing generic, but you can search the installed packages `rpm -qva | grep package name` | awk -the version and have logic around that
[2013-06-20 15:11:53 -0400] cpasmoi: only for redhat based, though
[2013-06-20 15:12:33 -0400] cpasmoi: ddyke, you can also create an external script called by your tomcat startup which waits for all webapps to be deployed
[2013-06-20 15:12:34 -0400] ddyke: yeah that example RHEL but you can do the deb check too
[2013-06-20 15:13:18 -0400] cpasmoi: that's what I'm using on production : seeks for all wars in the webapps directory and wait till all corresponding directory exist.
[2013-06-20 15:13:32 -0400] chris613: ddyke: Yeah, I'm doing that essentially
[2013-06-20 15:13:48 -0400] cpasmoi: the benefit is when you start manually tomcat
[2013-06-20 15:16:05 -0400] ddyke: cpasmoi: yeah I almost just thoughtabout dropping to bash shell and do it there
[2013-06-20 15:17:58 -0400] gems: I've moved my role override attributes into a chef environment.  My environment now contains attributes specific to that env for the proxy and webserver roles.  When I set a node to that environment, the node now has attributes for proxy and webserver.  However, a node will only be *either* a proxy or webserver, and doesn't need attributes for the other.  Anyone have any tips or is this ok?
[2013-06-20 15:20:12 -0400] ddyke: cpasmoi: how would one call the external script? (still green in chef)
[2013-06-20 15:21:10 -0400] itchyouch: Is there a way to have a recipe restart the chef client from the beginning again?
[2013-06-20 15:21:40 -0400] itchyouch: When the client updates, it breaks the recipes mid run.
[2013-06-20 15:25:17 -0400] chris613: itchyouch: I'm wondering the same thing, and saw someone else in here asking related questions yesterday. chef-client and omnibus_updater seem to be the most problematic in this respect
[2013-06-20 15:26:34 -0400] cpasmoi: ddyke, change the startup tomcat script so that it checks for the existence of an external script. The external script should be in your role confirguration, like node[:tomcat][:warmup_script] and your tomcat startup should also be a template (I still don't use the opscode tomcat cookbook, but one of my own)
[2013-06-20 15:26:48 -0400] cpasmoi: I'll paste you that
[2013-06-20 15:43:31 -0400] funjon: so i'm trying to build a cookbook that is more or less cross-platform (We have a bunch of installed centos/rhel, we are slowly moving to ubuntu), and i'm having an issue testing it with vagrant.  right now it's complaining about trying to create yum repos, even though our yum cookbook is thoroughly wrapped in case's on platform family.  is there a best practice for this?
[2013-06-20 15:43:54 -0400] funjon: (like, is there a way to only make it depend on the yum cookbook when it's rhel, and depend on the apt cookbook when it's debian?)
[2013-06-20 15:44:10 -0400] chris613: funjon: No. Some discussion on the mailing list about this recently, though
[2013-06-20 15:44:16 -0400] funjon: alas :(
[2013-06-20 15:44:37 -0400] ddyke: funjon: i think in yesterdays code review they were discussing this as well; bar from a case switch on platform not sure
[2013-06-20 15:44:42 -0400] dsteen: @funjon are you using "case" exactly?  It would probably be better to use the only_if stanza on the provider no?
[2013-06-20 15:44:48 -0400] funjon: hmm
[2013-06-20 15:45:20 -0400] chris613: funjon: To clarify, I was referring to the metadata.rb "depends", not anything inside a recipe, where of course you could use case/only_if/etc
[2013-06-20 15:46:00 -0400] funjon: *nod*
[2013-06-20 15:46:17 -0400] funjon: the body of our recipe is inside 'case node['platform_family']'
[2013-06-20 15:46:21 -0400] funjon: and there's only 'when rhel'
[2013-06-20 15:46:24 -0400] funjon: so, mrf.
[2013-06-20 15:46:33 -0400] dsteen: @funjon:  are you using a ruby_block around that?
[2013-06-20 15:46:35 -0400] funjon: (similarly, the apt one only has 'when debian'
[2013-06-20 15:48:01 -0400] funjon: dont think so
[2013-06-20 15:48:16 -0400] funjon: (I am newish to ruby and chef, the guy who made most of these platform cookbooks is, sadly, not awake yet)
[2013-06-20 15:48:36 -0400] dsteen: ah.  I'm pretty sure that the ruby logic will not work the way you expect
[2013-06-20 15:48:43 -0400] dsteen: unless you use a ruby_block
[2013-06-20 15:49:13 -0400] dsteen: "The ruby_block resource is used to execute Ruby code during a Chef run. Ruby code in the ruby_block resource is evaluated with other resources during convergence, whereas Ruby code outside of a ruby_block resource is evaluated before other resources, as the recipe is compiled."
[2013-06-20 15:49:17 -0400] ddyke: yeah, I think ruby code gets execute first before chef run time if its pure ruby code unless its in a ruby_block or execute
[2013-06-20 15:49:45 -0400] dsteen: from the ruby_block doc
[2013-06-20 15:50:15 -0400] dsteen: not sure what that means in terms of nested code
[2013-06-20 15:50:20 -0400] funjon: hmm, okay
[2013-06-20 15:53:31 -0400] dsteen: I know that chef makes backups of files that it modifies, but does anyone know of a way to find out what the path to that backup is (since it differes depending on architecture)?
[2013-06-20 15:55:59 -0400] dsteen: turns out it's in the attributes
[2013-06-20 15:56:06 -0400] dsteen: node[:backup_path]
[2013-06-20 16:00:09 -0400] lflux: Ohai
[2013-06-20 16:00:54 -0400] lflux: i'm migrating from chef-10 to chef-11, and when uploading my cookbooks from the transfer repo (where I downloaded the chef-10 data), i'm getting 500's from the chef-11 server
[2013-06-20 16:01:13 -0400] lflux: seems to be cookbooks giving me problems
[2013-06-20 16:03:39 -0400] lflux: anyone recognize this? I seem to be able to restart the uploads and get further along in the cookbook uploading, but it's kinda alarming.
[2013-06-20 16:14:45 -0400] hakunin: Is there a way in to have a secret/encrypted file in Chef 11 that gets decrypted when placed on a node?
[2013-06-20 16:20:31 -0400] sprack: hakunin: are you asking about encrypted databags?
[2013-06-20 16:21:02 -0400] hakunin: sprack: i asked also on chef-hacking, i meant a whole file full of keys, YAML in my case
[2013-06-20 16:21:44 -0400] hakunin: sprack: i just want to keep the file whole, and put it up on nodes, but keep it encrypted
[2013-06-20 16:21:57 -0400] hakunin: sprack: until it's deployed to nodes
[2013-06-20 16:22:26 -0400] sprack: hakunin: so during the deploy it decrypts it? sure same method as this: http://docs.opscode.com/essentials_data_bags_encrypt.html
[2013-06-20 16:22:39 -0400] hakunin: sprack: exactly, just like data bags
[2013-06-20 16:23:18 -0400] hakunin: sprack: but data bags store json content, and if you want to store a whole file you'd have to do some text transformation to stick multiline yaml file into json
[2013-06-20 16:24:37 -0400] sprack: hakunin: i meant that you can use the same encrypt/decrypt method as the databags. just use openssl to (en/de)crypt it either in an execute or ruby_code block
[2013-06-20 16:25:24 -0400] hakunin: sprack: i see a custom solution, that makes sense, will look into that. thank you.
[2013-06-20 16:27:47 -0400] sprack: anyone know how to force a template to re-render every time it is run, regardless of whether it thinks it's changed?
[2013-06-20 16:29:45 -0400] hakunin: sprack: put this on top of your template # Generated at: <%= Time.now.to_s %> (if it supports comments)
[2013-06-20 16:30:56 -0400] sprack: hakunin: clever. thank you
[2013-06-20 16:36:35 -0400] sprack: hakunin: spoke too soon. it only changed the one line
[2013-06-20 16:41:12 -0400] stormerider: sprack: it should cause the template to be re-run each time chef-client runs, however
[2013-06-20 16:42:03 -0400] geggam: any bay area chef'rs looking for employment ?
[2013-06-20 16:42:03 -0400] sprack: stormerider: it does, but it only does a differential change rather than regening it entirely
[2013-06-20 16:42:37 -0400] funjon: geggam: that depends, what are you looking for? :)
[2013-06-20 16:42:40 -0400] stormerider: huh. that wasn't my understanding of how it worked.
[2013-06-20 16:43:37 -0400] stormerider: are you using template partials?
[2013-06-20 16:44:48 -0400] geggam: looking for candidates to help take a huge 50 petabyte system from all manual to chef
[2013-06-20 16:46:07 -0400] funjon: sounds interesting
[2013-06-20 16:46:34 -0400] geggam: it is...  you want me to connect you to the headhunter ?
[2013-06-20 16:47:00 -0400] funjon: depends, what company is it?
[2013-06-20 16:47:04 -0400] geggam: HP
[2013-06-20 16:47:09 -0400] funjon: ugh
[2013-06-20 16:47:11 -0400] geggam: :D
[2013-06-20 16:47:36 -0400] geggam: if it was easy it wouldnt be fun
[2013-06-20 16:47:52 -0400] qhartman: What location?
[2013-06-20 16:47:56 -0400] geggam: pleasanton
[2013-06-20 16:48:06 -0400] qhartman: ah, I'm out then
[2013-06-20 16:48:12 -0400] funjon: oh, yeah, definitely out
[2013-06-20 16:48:17 -0400] funjon: not venturing to the east bay anymore
[2013-06-20 16:48:21 -0400] funjon: i did my time in hell
[2013-06-20 16:48:38 -0400] qhartman: glhf!
[2013-06-20 16:48:48 -0400] geggam: i empathize... somehow i like hell... easy things bore me
[2013-06-20 16:49:24 -0400] geggam: if you have any friends that are looking and actually have a clue about devops ill be at devops days
[2013-06-20 16:49:41 -0400] geggam: this weekend
[2013-06-20 16:50:18 -0400] rkesters: I am working on integrating chef with AD, I have read the only documentation, but it appears that all the users I want to have access to chef need to be under the same dn.
[2013-06-20 16:50:48 -0400] rkesters: but I have to OU developers and admins that i want to add to the chef, hence how would i do that?
[2013-06-20 16:52:58 -0400] sprack: stormerider: no. its a single
[2013-06-20 16:54:17 -0400] stormerider: sprack: huh. interesting. c11 or 10?
[2013-06-20 16:58:23 -0400] sprack: stormerider: C11
[2013-06-20 16:58:58 -0400] stormerider: will have to keep that in mind, then. thanks.
[2013-06-20 17:03:39 -0400] rkesters: is the chef server source code posted online anywhere?
[2013-06-20 17:06:57 -0400] rkesters: Nickhighlight/rkesters
[2013-06-20 17:09:58 -0400] robb_: How do I force my cookbook to use the external ruby instead of the internal Chef ruby?
[2013-06-20 17:14:55 -0400] hakunin: sprack: stormerider: are you sure the problem isn't elsewhere, in, say, attributes load order or something along those lines?
[2013-06-20 17:15:44 -0400] hakunin: sprack: stormerider: i don't think chef is even capable of not rendering a whole template, it should be a simple ERB call on the file
[2013-06-20 17:16:15 -0400] hakunin: sprack: stormerider: and after the erb call if the file != current file - it replaces it, that's it
[2013-06-20 17:16:36 -0400] StDiluted: unless you're using chef-rewind
[2013-06-20 17:17:18 -0400] sprack: hakunin: when it does the template action create it only applies a diff'd change.
[2013-06-20 17:18:29 -0400] hakunin: sprack: i'm not quite sure what that means
[2013-06-20 17:19:02 -0400] sprack: hakunin: hold on. I'll make a gist
[2013-06-20 17:19:07 -0400] hakunin: StDiluted: i thought chef-rewind is compile time
[2013-06-20 17:19:42 -0400] StDiluted: well, i just meant that it renders the whole template, and then goes back and edits it
[2013-06-20 17:20:07 -0400] hakunin: StDiluted: doesn't it redefine the template resource before template ever got rendered?
[2013-06-20 17:20:32 -0400] sprack: hakunin: https://gist.github.com/sprack/5824702
[2013-06-20 17:21:17 -0400] hakunin: sprack: what you see here is output that shows you how your new file is different from the file that was already there
[2013-06-20 17:21:17 -0400] StDiluted: well, yes, it does so i suppose technically you are correct, but it's final result is that piece of templates can be rendered differently than the .erb
[2013-06-20 17:21:25 -0400] hakunin: sprack: but it did replace the whole file
[2013-06-20 17:21:52 -0400] hakunin: sprack: you just don't have any changes in that file besides time
[2013-06-20 17:21:56 -0400] sprack: hakunin: no, because there are other lines whose vars changed that did not get update
[2013-06-20 17:22:08 -0400] sprack: *updated
[2013-06-20 17:22:34 -0400] hakunin: sprack: that's where i think your problem is. your vars didn't change, or not yet at the moment where your template is defined
[2013-06-20 17:23:51 -0400] sprack: that's possible, but at runtime I "p var" to stdout and see the correct values, but the template is not updated with them
[2013-06-20 17:23:56 -0400] hakunin: StDiluted: right, just wanted to be clear that it renders once overridden settings, not twice during the chef run
[2013-06-20 17:24:08 -0400] StDiluted: understood
[2013-06-20 17:24:11 -0400] hakunin: sprack: that might be misleading
[2013-06-20 17:25:49 -0400] hakunin: sprack: the context in which your vars are printed to stdout might not be the same context as when they're going into the template, that's definitely where the problem is
[2013-06-20 17:26:03 -0400] hakunin: sprack: and having "Time.now" printed into template just confirms that template resource works as expected
[2013-06-20 17:27:14 -0400] sprack: hakunin: that makes sense. I'm just not sure how to fix it
[2013-06-20 17:27:27 -0400] hakunin: sprack: well, if you gist more of that stuff, i might be able to help
[2013-06-20 17:27:48 -0400] hakunin: sprack: like where variables are coming from, and your template resource
[2013-06-20 17:31:25 -0400] sprack: hakunin: haha. well. I figured it out. your comment made me rescan the provider generating the hash for vars passed to the template. found a stupid mistake that was passing an empty string. thank you for your help though
[2013-06-20 17:31:50 -0400] hakunin: sprack: no problem
[2013-06-20 17:32:47 -0400] hakunin: sprack: so no need for timestamp, cause that's a hack that can rarely be useful
[2013-06-20 17:36:47 -0400] sprack: hakunin: probably not. but I'm going to leave it since these are going onto baked systems
[2013-06-20 17:37:44 -0400] hakunin: sprack: ok, but keep in mind that if your templates have a "notify" setup for restarting services upon change - this will restart services every time you run chef
[2013-06-20 17:39:38 -0400] sprack: hakunin: yes. that's fine here since chef is only run once during baking
[2013-06-20 17:40:24 -0400] harwilk: Hello, I have a question about cookbook testing with test kitchen: we have a Chef handler that sends an HTTP request to a particular service after the Chef client run, and I'd like to find some way to stub that request during testing any suggestions?
[2013-06-20 17:42:03 -0400] hakunin: harwilk: via attribute perhaps?
[2013-06-20 17:42:11 -0400] StDiluted: Sprack, just out of curiosity, why are you using chef if you are baking systems?
[2013-06-20 17:42:43 -0400] StDiluted: (not saying you shouldn't, just wondering what led to that decision)
[2013-06-20 17:44:09 -0400] harwilk: hakunin: would you mind elaborating on that a little?  I could set the URI I want to stub in an attribute, but how would I actually stub it?
[2013-06-20 17:44:22 -0400] hakunin: harwilk: i was thinking more to disable it
[2013-06-20 17:44:31 -0400] harwilk: ah
[2013-06-20 17:44:40 -0400] harwilk: well that solves half the problem
[2013-06-20 17:45:12 -0400] harwilk: the first half is that the tests fail because the URI is inaccessible outside a production environment
[2013-06-20 17:45:13 -0400] hakunin: harwilk: i haven't used server or tested with it, so i'm not sure what testing provisions are there. people talk about chef-zero as a great tool for testing. with it you can perhaps leave the http call
[2013-06-20 17:45:37 -0400] sprack: StDiluted: it's a bit cleaner than shell scripts and I prefer ohai to having to rip all the info manually. rest of the devs are ruby-ists too so they feel more comfortable making changes.
[2013-06-20 17:45:51 -0400] StDiluted: gotcha
[2013-06-20 17:45:54 -0400] StDiluted: just curious
[2013-06-20 17:46:18 -0400] StDiluted: we are small  now but I'm trying to get chef going so when we get bigger we are not trying to scramble to become more flexible
[2013-06-20 17:46:35 -0400] hakunin: sprack: StDiluted: I'm trying this baking approach too with snapshots, but it's always good to be able to run chef on already existing machine and converge it further from that point, while also making new versions of snapshots on the side
[2013-06-20 17:46:37 -0400] sprack: StDiluted: cant use managed chef though because it'd kill boot-time on our boxes
[2013-06-20 17:47:07 -0400] harwilk: hakunin: afaiu chef-zero is for stubbing requests to the chef server, whereas this request is to a different server
[2013-06-20 17:47:35 -0400] hakunin: harwilk: oh i must've misread, sorry
[2013-06-20 17:47:52 -0400] hakunin: harwilk: you might want to try something like fakeweb rubygem
[2013-06-20 17:48:21 -0400] hakunin: harwilk: or webmock https://github.com/bblimke/webmock
[2013-06-20 17:48:27 -0400] jmartin: harwilk: yeah, use fakeweb or maybe VCR or webmock
[2013-06-20 17:49:17 -0400] harwilk: hakunin: jmartin: yeah, it has to run in the same process though - not sure if the tests run in the same Ruby process as the cookbook?
[2013-06-20 17:49:45 -0400] harwilk: I'm pretty new to Chef testing, less so to general Ruby testing
[2013-06-20 17:49:46 -0400] hakunin: harwilk: you are making good points
[2013-06-20 17:51:27 -0400] hakunin: harwilk: i use bash scripts (bats) for testing, so i'm not sure how i would do it
[2013-06-20 17:51:51 -0400] hakunin: harwilk: perhaps i would search for a tool that can fake the web on the machine, not just inside a proces
[2013-06-20 17:52:13 -0400] harwilk: hakunin: I'm getting the feeling that's what I need to do
[2013-06-20 17:52:48 -0400] harwilk: is there some handy Unix tool that can stub a request on a port?  maybe netcat can do it
[2013-06-20 17:52:49 -0400] hakunin: harwilk: i definitely remember seeing somewhere aforementioned rubygems being used in chef tests, but don't remember how
[2013-06-20 17:53:19 -0400] harwilk: hm, ok
[2013-06-20 17:55:30 -0400] hakunin: harwilk: i would consider some hook in iptables as well
[2013-06-20 17:55:44 -0400] hakunin: harwilk: "if this request happened, execute a script"
[2013-06-20 17:55:53 -0400] hakunin: which creates a file, check for file's existence
[2013-06-20 17:56:18 -0400] harwilk: hakunin: oh I didn't know you could do that
[2013-06-20 17:56:20 -0400] hakunin: but i'm making up this functionality, just vectors of search
[2013-06-20 18:05:00 -0400] harwilk: I reckon I can hack something together with netcat
[2013-06-20 18:05:06 -0400] harwilk: hakunin: thanks for your help
[2013-06-20 18:05:59 -0400] hakunin: harwilk: sure, sorry can't help better
[2013-06-20 18:09:26 -0400] ianco: any minitest pros around?
[2013-06-20 18:09:56 -0400] ianco: in my tests, i dont seem to have node available
[2013-06-20 18:31:26 -0400] rb1980: does anyone know: is it possible to use a regex in a knife search? I just can't figure out the solr syntax for what i need to do.
[2013-06-20 18:36:53 -0400] defishguy: My recipes are set up as /foo/recipes/default.rb and /foo/recipes/otherrecipe.rb  I would like to do a conditional include in default.rb that uses a role attribute to determine if otherrecipe should be included.  I have "sectun = node[:nrole].include? "sectunserver" "include_recipe "foo::otherrecipe" if sectun" as two lines in default.  The client does not error out but otherrecipe does not apply.  Help?
[2013-06-20 18:37:26 -0400] miah: rb1980: https://lucene.apache.org/core/old_versioned_docs/versions/2_9_1/queryparsersyntax.html
[2013-06-20 18:40:40 -0400] chip-: defishguy: Check out the current release of the chef-client cookbook for a good example of conditional includes.
[2013-06-20 18:42:04 -0400] defishguy: chip-:  Thank you.
[2013-06-20 18:42:38 -0400] chip-: defishguy: service.rb does some conditionals to determine which init you want based on an attribute.
[2013-06-20 19:18:58 -0400] cybasheep: So I when I run chef-client on a machine that I created in a specific environment (knife ec2 create [...] -E therightenvironment) ... and when it finishes the chef run it ends up in a different environment and I am very certain that the recipes that run do not do that - am I just not looking hard enough for a recipe that does do it after all or could there be another explanation?
[2013-06-20 19:21:30 -0400] Otterley: cybasheep, I'm also having unexpected environment-related issues
[2013-06-20 19:24:41 -0400] Otterley: I'm still trying to figure out a problem we had last night where we had a node associated with a particular environment, and a number of cookbook versions locked to said environment, yet when we ran a Chef run, it didn't update my cookbook to the version in the environment
[2013-06-20 19:25:04 -0400] cybasheep: God, it would be so nice to just come back to work tomorrow and the sillyness were simply gone. It's completely baffling. I can knife node edit that instance to be in the correct environment, start chef-client and all bits in the recipes that have conditionals on node.chef_environment will do the right thing (but not in erubis templates!!!) and when it's done it'll be back in the wrong environment.
[2013-06-20 19:26:33 -0400] Otterley: cybasheep, I'd advise against predicating on an environment
[2013-06-20 19:26:44 -0400] Otterley: I recommend predicating on an attribute instead
[2013-06-20 19:36:56 -0400] Breeze: Has anyone successfully used rvm with application_ruby or similar?
[2013-06-20 19:45:12 -0400] will: hello I'm trying to track down version 0.6.0 of chef for a vagrant box (attempting to match engineyard's version). It's not on ruby gems, and I'm not having much luck building from the repo. Any advice or direction would be greatly appreciated. Thanks!
[2013-06-20 19:45:54 -0400] stormerider: will: 0.6.0? that's... ancient.
[2013-06-20 19:46:02 -0400] will: yah I know :/
[2013-06-20 19:46:10 -0400] will: unfortunately that's what engineyard uses
[2013-06-20 19:46:11 -0400] bluepojo: they still haven't upgraded?
[2013-06-20 19:46:22 -0400] will: they are on 10 in the newer stack
[2013-06-20 19:46:26 -0400] bluepojo: ah cool
[2013-06-20 19:46:27 -0400] will: but they still provide a stack with .6
[2013-06-20 19:46:39 -0400] will: and unfortunately the project I'm working on uses the old stack
[2013-06-20 19:46:44 -0400] Otterley: maybe ask them for it?
[2013-06-20 19:46:53 -0400] will: so I'm trying to build a box to test the old recipes locally
[2013-06-20 19:47:40 -0400] will: there are a good number of recipes that would need to be updated to use the newer stack
[2013-06-20 19:48:07 -0400] will: I'd love to get on it eventually (soon), but having an environment where I can test the current ones seems like the first move
[2013-06-20 19:49:04 -0400] miah: will: just download the git repository and then git checkout 0.6.0
[2013-06-20 19:49:17 -0400] sylvainsf: was wondering if someone could point me to where I should look if ohai isn't populating the node with info during a chef run. Some of my cookbooks successfully add info to the node (the aws cookbook specifically) and I see ohai run successfully but none of the default info is populated into the node
[2013-06-20 19:49:26 -0400] miah: will: also the funbit is that they run gentoo =)
[2013-06-20 19:49:29 -0400] will: I've done that so far I'm not having much luck building it
[2013-06-20 19:49:31 -0400] will: haha
[2013-06-20 19:49:31 -0400] will: yah
[2013-06-20 19:49:35 -0400] will: 'fun' :)
[2013-06-20 19:49:39 -0400] Otterley: they do whatnow?
[2013-06-20 19:49:42 -0400] miah: their environment is a shitshow and they should be embarassed
[2013-06-20 19:50:27 -0400] miah: i'll be glad when i get this new job and dont have to deal with EY anymore
[2013-06-20 19:50:38 -0400] will: without a doubt
[2013-06-20 19:51:23 -0400] miah: will: have you seen https://support.cloud.engineyard.com/entries/22355466-Engine-Yard-Local-1-0
[2013-06-20 19:51:37 -0400] will: yah, it's where my morning went
[2013-06-20 19:51:51 -0400] miah: :(
[2013-06-20 19:52:04 -0400] miah: i read the page and knew it was a waste of my time before i downloaded it
[2013-06-20 19:52:32 -0400] will: the default stack uses passanger and nginx
[2013-06-20 19:52:34 -0400] jmartin: im shuddering reading it now
[2013-06-20 19:52:55 -0400] miah: ya. dont even get me started about their haproxy config =)
[2013-06-20 19:53:15 -0400] will: and after 'ey-local up' I ended up with a box that had nginx compiled without passenger
[2013-06-20 19:53:19 -0400] will: that just wouldn't do much of anything
[2013-06-20 19:53:21 -0400] sylvainsf: hey btm are you getting dusty this year?
[2013-06-20 19:53:57 -0400] will: so tracking down an old version of chef seemed like the better option
[2013-06-20 19:54:08 -0400] will: though who knows at this point :)
[2013-06-20 19:54:16 -0400] miah: lol
[2013-06-20 19:55:35 -0400] will: checking out 0.6.0 was the easy part, it's figuring out which old versions I need to make rake gem stop chocking
[2013-06-20 19:56:38 -0400] will: are there breaking changes between 0.6.0 and 0.7.10 (the oldest version on ruby gems), maybe I could get away with using that
[2013-06-20 19:57:18 -0400] miah: ya
[2013-06-20 20:00:04 -0400] sylvainsf: does ohai store all of its output in the node by default? ie: knife node edit <nodename> would show all the ohai results too
[2013-06-20 20:02:11 -0400] Otterley: sylvainsf, automatic attributes provided by ohai are reset at the beginning of every chef run.  even if you tried to edit them, they wouldn't have any effect
[2013-06-20 20:02:26 -0400] sylvainsf: my issue is none of the automatic attributes are being populated
[2013-06-20 20:02:33 -0400] StDiluted: anyone using chef to write nagios/icinga configs?
[2013-06-20 20:02:46 -0400] sylvainsf: brand new chef 11.4.4 install, test node
[2013-06-20 20:02:58 -0400] Otterley: sylvainsf, why do you believe that is so?
[2013-06-20 20:03:53 -0400] sylvainsf: because this is the entirety of the node data after the run: https://gist.github.com/sylvainsf/5826120
[2013-06-20 20:04:08 -0400] Otterley: how did you obtain that?
[2013-06-20 20:04:49 -0400] sylvainsf: knife node edit base-test10
[2013-06-20 20:04:57 -0400] Otterley: try: knife show node -Fj -l base-test10
[2013-06-20 20:05:06 -0400] Otterley: err,  knife node show -Fj -l base-test10
[2013-06-20 20:05:21 -0400] Otterley: I do not believe the edit command will show non-editable attributes
[2013-06-20 20:06:01 -0400] sylvainsf: weird it did in MUCH older versions of chef
[2013-06-20 20:06:10 -0400] sylvainsf: haven't worked with the latest in awhile
[2013-06-20 20:06:26 -0400] sylvainsf: yup that shows the read only attributes, thanks!
[2013-06-20 20:06:36 -0400] Otterley: I suspect that to show them would be misleading, because people might think editing them would be effective.
[2013-06-20 20:07:00 -0400] sylvainsf: yeah when I first started using chef 3 years ago that did frustrate me a few times
[2013-06-20 20:07:38 -0400] sylvainsf: thanks again for the help Otterley
[2013-06-20 20:17:08 -0400] jgood: Hey all, what's the best way to set up ohai plugins, do you have to go through the ohai recipe?
[2013-06-20 20:19:36 -0400] Otterley: that's what we do jgood
[2013-06-20 20:21:44 -0400] jgood: alright thanks that's what I was thinking
[2013-06-20 20:32:56 -0400] AskSteve: I'm having a problem with the SUDO cookbook of all things and its at the package install part of the code.
[2013-06-20 20:32:57 -0400] AskSteve: NoMethodError
[2013-06-20 20:32:57 -0400] AskSteve: -------------
[2013-06-20 20:32:58 -0400] AskSteve: private method `readlines' called for "":String
[2013-06-20 20:34:47 -0400] AskSteve: I can add/remove sudo package with yum without issue
[2013-06-20 20:39:22 -0400] webbower: Does anyone know how to install an older version of MySQL with the apt cookbook on Ubuntu?
[2013-06-20 20:41:56 -0400] Otterley: webbower, the package resource can take an optional "version" attribute
[2013-06-20 20:42:16 -0400] webbower: In other words, I'd have to NOT use the mysql cookbook?
[2013-06-20 20:42:20 -0400] Otterley: however, said package version must be accessible via apt.  this may require you set up a private repository
[2013-06-20 20:43:17 -0400] webbower: I see that I can override the node['mysql']['client']['packages'] with a different list, but my apt-fu is weak and I don't know how to figure out how find the proper version
[2013-06-20 20:43:43 -0400] Otterley: the server recipe doesn't let you specify a package version
[2013-06-20 20:44:07 -0400] Otterley: you may have to make your own cookbook that installs the packages first, then includes the community recipe
[2013-06-20 20:44:27 -0400] webbower: :-(
[2013-06-20 20:45:07 -0400] Otterley: feel free to patch the cookbook and open a ticket against it with a PR
[2013-06-20 20:45:59 -0400] webbower: I need to figure out how to fetch older versions in Ubuntyu
[2013-06-20 20:48:28 -0400] Otterley: you'll probably have to set up a private repository first, because Ubuntu doesn't usually keep old versions other than the original release available -- e.g., if you're using Precise, then there's one version (the original in the precise distribution), and another in the precise-updates or precise-security distribution.  The latter is usually a moving target.
[2013-06-20 20:49:09 -0400] Otterley: Once you've set up a private repo, then you can add it using the apt_repository resource from the apt cookbook.  Then, you can simply declare "version x.y.z" as an attribute to a package resource, and you'll get what you need.
[2013-06-20 20:50:14 -0400] webbower: Ya, my Linux-fu is also weak
[2013-06-20 20:50:28 -0400] webbower: I know enough to get around, but not enough for serious configuration
[2013-06-20 20:50:35 -0400] webbower: <--- needs to learn more
[2013-06-20 20:50:53 -0400] Otterley: here's your chance :)
[2013-06-20 21:21:53 -0400] aneto: Is it possible to overide an attribute from a provider?
[2013-06-20 21:24:58 -0400] Astral303: can i set a hierarchy of attributes in a recipe using a multilevel hash syntax?
[2013-06-20 21:25:38 -0400] Astral303: i know i can call node.set[:a][:b][:c] = d, but i'd like to be ale to say { :b => { :c => d } }
[2013-06-20 21:25:49 -0400] Astral303: i know i can do that in a role using override_attributes
[2013-06-20 21:32:28 -0400] ianco: So I am writing a cookbook for my little http server, and it includes a lwrp to setup a proxy pass sort of config
[2013-06-20 21:32:51 -0400] ianco: I want to test the lwrp, and i thought it would be cool to have a test recipe use the lwrp
[2013-06-20 21:33:12 -0400] ianco: and then have minitest connect and verify it gets the right response
[2013-06-20 21:33:39 -0400] ianco: but i cant think of the best way to setup a faux upstream server
[2013-06-20 21:33:43 -0400] ianco: any ideas?
[2013-06-20 21:44:18 -0400] gems: Can someone clear up env_run_list in a role vs env_run_list in an environment?  I see the purpose for it in a role, as a roles run list can change between environments, but when is it used for an environment?
[2013-06-20 21:44:39 -0400] miah: you cant env_run_list in an environment
[2013-06-20 21:45:07 -0400] miah: attributes, and cookbook version pinning only.
[2013-06-20 21:46:13 -0400] gems: well, no wonder it didn't make any sense to me.  :) thanks
[2013-06-20 21:57:14 -0400] perezd: are recipes allowed to modify the node atributes?
[2013-06-20 21:58:27 -0400] benkay: looking at data bag stuffs (http://docs.opscode.com/essentials_data_bags.html) I note lots of leading underscores. are those necessary?
[2013-06-20 21:59:53 -0400] spheromak: benkay, if you're referring to the directory structure. No they are not required.
[2013-06-20 22:03:51 -0400] spheromak: benkay, it's just perezd yea you can use  node.normal  node.default node.override.  Those attributes won't be saved back to chef-server until the end of the (successful) run however.
[2013-06-20 22:03:56 -0400] spheromak: woops
[2013-06-20 22:04:02 -0400] spheromak: perezed ^^
[2013-06-20 22:04:24 -0400] perezd: Ok cool, I have a default recipe that I include in specific recipes
[2013-06-20 22:04:29 -0400] perezd: and I want the recipe to set an attribute on the node
[2013-06-20 22:04:31 -0400] perezd: if its run on it
[2013-06-20 22:04:34 -0400] perezd: make sense?
[2013-06-20 22:04:45 -0400] spheromak: i think so
[2013-06-20 22:04:54 -0400] spheromak: thats a pretty standard thing
[2013-06-20 22:05:00 -0400] spheromak: you can also use include_attribute
[2013-06-20 22:05:43 -0400] perezd: ok, cool.
[2013-06-20 22:05:44 -0400] perezd: thanks
[2013-06-20 22:12:49 -0400] benkay: thankee kindly, spheromak
[2013-06-20 22:42:58 -0400] jmickle: oof 2 weeks of vacation on a carribean island makes it hard to come back and write recipes :-P
[2013-06-20 22:53:15 -0400] spheromak: jmickle, I did that with 22 days in thailand last december. Def hard to get back to work
[2013-06-20 22:54:22 -0400] jmickle: haha
[2013-06-20 23:01:49 -0400] Astral303: does not_if let you do any comparisons?
[2013-06-20 23:02:38 -0400] Astral303: i am trying to run a blockdev --setra 32 if blockdev --getra returns anything other than 32. it only prints a number. feels a little ghetto to write not_if "blockdev --getra | grep 32"
[2013-06-20 23:05:40 -0400] Astral303: ok i can limit things using grep '^32$'
[2013-06-20 23:06:36 -0400] Otterley: who's going to DevOps Days tomorrow?
[2013-06-20 23:13:33 -0400] ranjibd: Otterley: i'll be there
[2013-06-20 23:13:46 -0400] ranjibd: Otterley: we are sponsoring the drinks in the evening
[2013-06-20 23:15:26 -0400] Otterley: who's "we"?
[2013-06-20 23:31:30 -0400] stkowski: I need to print my stuff out and figure what I'll go to
[2013-06-20 23:50:11 -0400] sbimikesmullin: is there a way to set role or node attributes by chef environment in chef/knife-solo ? i was hoping to control this via the -E argument
[2013-06-20 23:50:58 -0400] sbimikesmullin: but its starting to look like i need to make files like roles/prod-web.rb, roles/stage-web.rb, roles/web.rb, etc.
[2013-06-20 23:52:37 -0400] ivey: Anyone know why the users cookbook users_manage resource requires group_id?
[2013-06-20 23:57:26 -0400] ranjibd: Otterley: PagerDuty
[2013-06-20 23:58:32 -0400] Otterley: oh yes, they owe me lots of drinks as an apology for that iPhone app ;)
[2013-06-20 23:58:50 -0400] Otterley: (to be fair, so does Flowdock.)
