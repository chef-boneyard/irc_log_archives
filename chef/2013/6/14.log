[2013-06-14 00:03:02 -0400] brucelee: when i provision a server off a VM template, the HDD is usually 8GBs to the VM, even though in the hypervisor, i expanded it to 20GBs or something
[2013-06-14 00:03:20 -0400] brucelee: can a chef recipe do all the LVM expansion
[2013-06-14 00:03:39 -0400] brucelee: a recipe where somewhere along the lines, it will reboot the server
[2013-06-14 00:16:53 -0400] Otterley: do lightweight resources have access to node attributes?
[2013-06-14 00:19:05 -0400] RayS: still having some elasticsearch issues any ideas on this one? "FATAL: NoMethodError: ruby_block[Create EBS volume on /dev/sda2 (size: 50GB)] (elasticsearch::ebs line 16) had an error: NoMethodError: undefined method `volumes' for nil:NilClass"
[2013-06-14 00:28:47 -0400] dysinger: how do I launch with knife-ec2 & encrypted data bags together ?
[2013-06-14 00:29:03 -0400] dysinger: I need to pass a secret_key to the node
[2013-06-14 00:32:52 -0400] teukka: dysinger: if you have `encrypted_data_bag_secret` specified in knife.rb the bootstrap template should copy it to the node
[2013-06-14 00:33:28 -0400] teukka: knife-ec2 uses Knife::Bootsrap internally
[2013-06-14 00:39:44 -0400] new2chef: hello!  i was wondering if someone might be able to help me out- is there a way to force roles to get passed to a cookbook during a chef-client override (-o)?  I have a cookbook that uses the roles to populate fields in a template.
[2013-06-14 00:43:40 -0400] Guest98148: do you mean -o "role[my_role]" ?
[2013-06-14 00:45:43 -0400] new2chef: no, here's what i'm trying to do.. i have an iptables cookbook that populates a template based on the roles the node belongs to.  I want to be able to do a chef-client -o "recipe[iptables]" and have the cookbook still know what roles the node as associated with it.
[2013-06-14 00:46:50 -0400] new2chef: if possible, i'd like to be able to pass the roles as an attribute, not in the run-list since there are recipes in the roles that i don't want run every time i want to refresh iptables.
[2013-06-14 00:47:26 -0400] Guest98148: i think -o overrides the entire run list so the roles it belongs to would no longer exist
[2013-06-14 00:48:04 -0400] new2chef: right, that's the problem i'm having.. is there a way to pass in the roles?
[2013-06-14 00:48:17 -0400] Guest98148: maybe you could set attributes instead of looking for the role membership
[2013-06-14 00:49:10 -0400] new2chef: I tried doing that dynamically in the cookbook, to add it as a global variable and pass it to the template, however I couldn't figure out a way for it to pass the roles in without having the roles in the run-list
[2013-06-14 00:49:17 -0400] Guest98148: you can comma-separate and list the roles, but that would then add them to the run list as well
[2013-06-14 00:49:26 -0400] new2chef: I see
[2013-06-14 00:49:48 -0400] new2chef: so there's no way to just pass in role attributes without having it run the roles in the run-list?
[2013-06-14 00:50:23 -0400] Guest98148: i'm not an expert, so there might be a way
[2013-06-14 00:52:13 -0400] new2chef: yeah, i've been scratching my head with this one for a while now.  i've been just doing full chef-client runs every time I want to update iptables, but I was wondering if there was a way to avoid that
[2013-06-14 00:52:54 -0400] Guest98148: i think that's what you're supposed to do
[2013-06-14 00:53:13 -0400] Guest98148: since chef-runs are designed to be idempotent, it should be ok
[2013-06-14 00:53:19 -0400] gkra: maybe in your "normal" runs, do a: node.set['your_cookbook']['saved_roles'] = node.roles
[2013-06-14 00:53:25 -0400] Guest98148: maybe just not as fast as you'd like
[2013-06-14 00:53:45 -0400] gkra: so then you could pull node['your_cookbook']['saved_roles'] when you're doing your one-offs?
[2013-06-14 00:53:59 -0400] gkra: and it's updated in normal runs, should role memberships change...
[2013-06-14 00:54:04 -0400] new2chef: gkra- that's a great idea!
[2013-06-14 00:54:09 -0400] new2chef: thanks!
[2013-06-14 00:54:27 -0400] gkra: might work. :)
[2013-06-14 00:55:00 -0400] new2chef: i know what i'm going to be working on tonight :)
[2013-06-14 00:55:01 -0400] gkra: it could introduce latency, though, for things that depend on the roles, depending on what order things get done in.
[2013-06-14 00:55:13 -0400] gkra: someone with more experience than I with chef will have to weigh in on that
[2013-06-14 01:19:45 -0400] braidn_: Hey all, having a little issue with Vagrant/Virtualbox/Chef. For some reason when I jump to provisioning I get an error in the cookbook apt concerning 'use_inline_resource'
[2013-06-14 01:19:56 -0400] braidn_: This is the vagrant file https://gist.github.com/5778745
[2013-06-14 01:23:09 -0400] new2chef: gkra- worked like a charm in my test environment!  thanks again!
[2013-06-14 01:30:05 -0400] miah: sup
[2013-06-14 01:52:13 -0400] gouthamvel: any good tutorial other than official one on chef-shell?
[2013-06-14 02:35:48 -0400] hakunin: ivey: i see that you guys have been involved in nginx cookbook, any plans to fix source install by any chance?
[2013-06-14 02:50:22 -0400] ivey: hakunin: dunno. what's broken about it?
[2013-06-14 02:50:48 -0400] hakunin: ivey: impossible to install non-default version, can't override version attribute due to ohai
[2013-06-14 02:50:53 -0400] hakunin: ivey: but it's ok, was just curious
[2013-06-14 02:51:06 -0400] hakunin: ivey: going to explore alternatives
[2013-06-14 02:51:48 -0400] ivey: why can't you set node['nginx']['source']['version'] ?
[2013-06-14 02:52:36 -0400] freezey: doing a restore and has anyone ran into this? "ERROR: ArgumentError: can't get const Chef::WebUIUser: uninitialized constant Chef::WebUIUser"
[2013-06-14 03:05:32 -0400] bobbyz: Out of curiosity, what are people in here using for cookbook version pinning and promotion?  Manual editing of environment files?  Knife-spork?  Other tools?
[2013-06-14 03:13:57 -0400] hakunin: ivey: it gets overridden
[2013-06-14 03:14:09 -0400] hakunin: ivey: by ohai primarily
[2013-06-14 03:14:18 -0400] ivey: oh by the nginx ohai plugin?
[2013-06-14 03:14:24 -0400] hakunin: ivey: yes
[2013-06-14 03:15:31 -0400] ivey: https://github.com/opscode-cookbooks/nginx/commit/0629f880cefc40f4784b54f0c421b4f4ea04267e
[2013-06-14 03:15:38 -0400] ivey: looks like that was fixed 6 months ago?
[2013-06-14 03:16:28 -0400] hakunin: ivey: perhaps because i already had it installed wrong, it doesn't seem to work no matter what i try
[2013-06-14 03:16:38 -0400] hakunin: ivey: notice that source version is set from regular version without ||=
[2013-06-14 03:16:42 -0400] hakunin: or any such thing
[2013-06-14 03:16:45 -0400] ivey: default['nginx']['source']['url']      = "http://nginx.org/download/nginx-#{node['nginx']['source']['version']}.tar.gz" is what you need to set
[2013-06-14 03:16:47 -0400] ivey: or
[2013-06-14 03:17:00 -0400] ivey: set that to nil and set default['nginx']['source']['version']
[2013-06-14 03:17:31 -0400] ivey: still a bug, that setting version won't work unless you also unset the URL
[2013-06-14 03:17:40 -0400] ivey: but not an insurmountable bug
[2013-06-14 03:18:18 -0400] ivey: gotta go throw a bunch of stuff away, but hope that helps
[2013-06-14 03:19:01 -0400] hakunin: ivey: i tried overwriting the url and version both, and got this: https://gist.github.com/maxim/ef89eee3c3d0867c2d12
[2013-06-14 03:19:28 -0400] hakunin: ivey: and it didn't recompile it
[2013-06-14 03:19:49 -0400] hakunin: ivey: (the 1.2.6 was the installed one)
[2013-06-14 03:19:50 -0400] hakunin: just weird
[2013-06-14 03:20:08 -0400] ivey: you have the latest version of the cookbook?
[2013-06-14 03:20:11 -0400] hakunin: yes
[2013-06-14 03:20:39 -0400] ivey: is 1.4.4 the one you want?
[2013-06-14 03:20:43 -0400] ivey: er 1.4.1
[2013-06-14 03:20:45 -0400] hakunin: yes
[2013-06-14 03:21:06 -0400] hakunin: with a few modules
[2013-06-14 03:22:26 -0400] ivey: sure you set node['nginx']['source']['version'] along with the url? looks like you set node['nginx']['version']
[2013-06-14 03:22:54 -0400] hakunin: ivey: said it didn't recompile due to "not_if"
[2013-06-14 03:23:15 -0400] hakunin: ivey: perhaps you're right
[2013-06-14 03:23:17 -0400] hakunin: ivey: trying again
[2013-06-14 03:24:27 -0400] hakunin: ivey: ok this got it to recompile but omg, why am i seeing this
[2013-06-14 03:24:44 -0400] hakunin: ivey: https://gist.github.com/maxim/ca633652459d6c10b3cf
[2013-06-14 03:24:47 -0400] hakunin: in compilation
[2013-06-14 03:25:10 -0400] hakunin: ivey: is it using ohai's version in a bunch of paths and stuff?
[2013-06-14 03:26:27 -0400] ivey: default['nginx']['source']['default_configure_flags'] probably has the wrong stuff too
[2013-06-14 03:26:50 -0400] hakunin: ivey: yeah, looks like it installed it into all 1.2.6 paths
[2013-06-14 03:27:00 -0400] hakunin: :(
[2013-06-14 03:27:20 -0400] hakunin: ivey: i see what's happening now, thanks a lot for this bit of hand holding :)
[2013-06-14 03:28:31 -0400] ivey: from the old version
[2013-06-14 03:29:01 -0400] ivey: you're welcome! now i want to fix this cookbook :/
[2013-06-14 03:29:16 -0400] hakunin: ivey: :)
[2013-06-14 03:30:04 -0400] pcn: ohai chefs
[2013-06-14 03:30:41 -0400] pcn: Anyone know why an instance store instance in ec2 (ubuntu-based image) may be listing more instance-store disks being there than are actually provisioned?
[2013-06-14 03:31:19 -0400] hakunin: I think there should be an attribute override level that beats ohai
[2013-06-14 03:31:36 -0400] hakunin: but not a new level
[2013-06-14 03:31:45 -0400] hakunin: perhaps "override"
[2013-06-14 03:32:22 -0400] techiegurl: anyone here try chef-zero yet
[2013-06-14 03:32:28 -0400] techiegurl: git://github.com/jkeiser/chef-zero.git
[2013-06-14 03:32:43 -0400] pcn: Not yet - some people were excited at chefconf, but I haven't come up with a use case yet
[2013-06-14 03:32:51 -0400] pcn: I mean I haven't yet - others clearly have
[2013-06-14 03:33:32 -0400] techiegurl: it installed fine and i run it in CLI mode...yet, try to use knife against it and network timeout
[2013-06-14 03:36:55 -0400] bfraser: pcn: what do you mean? you're referring to the ephemeral storage?
[2013-06-14 03:37:24 -0400] bfraser: anyone able to help with a problem related to the read-only node attribute change in chef 11?
[2013-06-14 03:38:53 -0400] pcn: bfraser: yeah, ephemeral storage is showing 2 volumes in ohai, but this instance type only actually has 1 device you can allocate
[2013-06-14 03:39:08 -0400] bfraser: pcn: which instance type?
[2013-06-14 03:40:38 -0400] pcn: bfraser: m2.x2large
[2013-06-14 03:41:16 -0400] bfraser: pcn: hmm, that should indeed only have one ephemeral disk
[2013-06-14 03:42:03 -0400] pcn: So you get this: https://gist.github.com/pcn/5779310
[2013-06-14 03:51:57 -0400] pcn: OK, look at the gist again.  I'm just being lied to
[2013-06-14 03:54:10 -0400] bfraser: pcn: it considers the base file system from the AMI as one ephemeral, and the extra space as a second ephemeral?
[2013-06-14 03:56:32 -0400] pcn: It's not that. The base ami/root filesystem is one fs, and the ephemeral is another device afaik
[2013-06-14 03:56:43 -0400] pcn: I'm wondering if the image creation has something to do with this.
[2013-06-14 03:56:58 -0400] pcn: E.g. if the image was created on an instance type that had 2 disks, is that somehow preserved when launching other instances?
[2013-06-14 03:57:07 -0400] pcn: I don't think so, since I've launched mediums with this
[2013-06-14 03:57:11 -0400] pcn: and smalls
[2013-06-14 03:58:04 -0400] freezey: does chef 11 not allow cookbook names with something-something
[2013-06-14 03:58:05 -0400] freezey: ?
[2013-06-14 03:58:40 -0400] bfraser: pcn: comparing with another m2.2xlarge and I see two devices as well
[2013-06-14 03:58:59 -0400] bfraser: in my case, /dev/sda1 for the root fs and /dev/sdb for the ephemeral
[2013-06-14 03:59:39 -0400] pcn: right but notice how the metadata doesn't call the root vol ephemeral?
[2013-06-14 03:59:47 -0400] bfraser: yep
[2013-06-14 04:00:26 -0400] pcn: does your launch have an sdb and sdc listed?
[2013-06-14 04:01:21 -0400] bfraser: I can't reproduce the metadata you see
[2013-06-14 04:01:31 -0400] bfraser: I get 404 not found for ephemeral1
[2013-06-14 04:08:13 -0400] pcn: OK. so it probably has something to do with the specific AMI that I launched with.
[2013-06-14 04:12:02 -0400] pcn: Aaaaand when I try to launch an instance with ephemeral1 not mapped, it gives me an F for bad parametrs
[2013-06-14 04:12:31 -0400] pcn: OK, I'll stop blogging here on #chef.  Thanks for confirming that it's jus tme
[2013-06-14 04:12:53 -0400] bfraser: hah
[2013-06-14 04:14:37 -0400] bfraser: anyone around to help me with a problem related to read-only node attributes in chef 11?
[2013-06-14 04:17:08 -0400] bfraser: I'm hitting Chef::Exceptions::ImmutableAttributeModification and having trouble identifying which part of the recipe is the problem
[2013-06-14 04:19:09 -0400] sascha_d: @bfraser look for something adding on or changing a node attr in the recipe
[2013-06-14 04:19:27 -0400] banachtarski: why do i get all sorts of recipe compile errors when i perform commands on directories that don't exist yet?
[2013-06-14 04:19:43 -0400] banachtarski: the recipe that i'm writing creates the directory with the directory resource
[2013-06-14 04:19:56 -0400] banachtarski: then tries to cat a file in there
[2013-06-14 04:20:02 -0400] banachtarski: but the recipe complains
[2013-06-14 04:22:06 -0400] bfraser: sascha_d: from what I can tell, it's just creating a file based on node attributes and isn't actually changing anything
[2013-06-14 04:22:15 -0400] bfraser: sascha_d: https://gist.github.com/bfraser/5779436
[2013-06-14 04:22:52 -0400] sascha_d: @bfraser is this your recipe or community?
[2013-06-14 04:23:00 -0400] ssd7: banachtarski: Mind posting the recipe to something like gist or pastebin
[2013-06-14 04:23:26 -0400] bfraser: sascha_d: community, opscode maintainer .. http://community.opscode.com/cookbooks/zenoss
[2013-06-14 04:27:57 -0400] sascha_d: my plane will cut off internet access soon so don't be surprised if I disappear
[2013-06-14 04:29:12 -0400] sascha_d: @bfraser but I'd say that something is being set up as an attribute and then the provider is trying to modify the attribute somehow. I've never looked at the zenoss cookbook and it looks complex so I probably wont' be much use.
[2013-06-14 04:30:06 -0400] sascha_d: before my plane lands
[2013-06-14 04:30:08 -0400] banachtarski: ssd7: nvm it ran correctly on the second invocation
[2013-06-14 04:30:27 -0400] banachtarski: ssd7: looks like it needs debugging sorry
[2013-06-14 04:30:49 -0400] bfraser: d'oh .. thanks anyway sascha_d
[2013-06-14 04:31:38 -0400] bfraser: anyone else feel like having a stab at it?
[2013-06-14 04:32:43 -0400] bfraser: I've had a look at the provider ( https://github.com/opscode-cookbooks/zenoss/blob/master/providers/zenbatchload.rb ) and don't see where it's attempting to change an attribute
[2013-06-14 04:37:48 -0400] freezey: anyway with chef11 to set hostname on reconfigure?
[2013-06-14 04:44:44 -0400] banachtarski: is there any reason a directory resource with the :create action wouldn't actaully make the directory?
[2013-06-14 06:57:14 -0400] rkesters: how to I get all attributes to be reloaded during a chef-client run?
[2013-06-14 06:58:39 -0400] isbaran: rkesters: if you mean ohai attributes, you reload ohai
[2013-06-14 07:02:21 -0400] rkesters: how to I get all attributes to be reloaded during a chef-client run??
[2013-06-14 07:49:35 -0400] _smadamr: anyone have experience with chef-user and vagrant?  My users aren't being created as expected and I'm trying to determine if that is because of a bug or if it's just me.
[2013-06-14 07:56:45 -0400] dieend: hello, can I ask how to set up mysql server with chef so the password not automatically generated?
[2013-06-14 07:57:47 -0400] dieend: where to set["mysql"]["server_root_password"] should be placed?
[2013-06-14 07:58:37 -0400] _smadamr: dieend: check the mysql cookbook, server.rb recipe. in there is a section that checks for the 'server_root_password' attribute. and check out some info about attributes: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-06-14 08:00:00 -0400] _smadamr: dieend: most cookbooks have attributes, and examples on how to access them. If the docs aren't clear, another great option would be to take a cookbook you are familiar with and see how they are creating and accessing attributes.
[2013-06-14 08:23:47 -0400] yanc0: Hi everybody! I have a run list with a defined execution order, but there is a recipe which is always executed before other, anyway of the place in the runlist. I don't know why. Any ideas? Thanks
[2013-06-14 08:27:22 -0400] bradbeam: check to see if the recipe is explicity calling the other ... also maybe check environments/roles to see if there are any runlists specified there
[2013-06-14 08:29:09 -0400] yanc0: Thanks, the recipe executed before doesn't contains any calls. It just installs some packages.
[2013-06-14 08:30:13 -0400] yanc0: ... Installs some packages but I wanted to do an apt-get update before (recipe apt)
[2013-06-14 08:34:58 -0400] _smadamr: yanc0: if you need packages installed before any other recipe runs, you can't put them simply as any other recipe block. You need to install them at  compile time perhaps
[2013-06-14 09:30:34 -0400] kisoku: silly question
[2013-06-14 09:30:50 -0400] kisoku: is there any way to disable colors in test-kitchen
[2013-06-14 09:41:26 -0400] spheromak: kisoku,  you don't like the christmas tree ?
[2013-06-14 09:47:32 -0400] Hildgrim: I'm trying to do a bash "download_a_file" code <<-EOH wget url.com/file.zip in a recipe. But I don't want to download it if a checksum file already exists and if the downloaded checksum file is the same as the one that exists. Can I do two not_if after eachother?
[2013-06-14 09:47:58 -0400] spheromak: use the chef resource for this
[2013-06-14 09:49:44 -0400] spheromak: Hildgrim, http://docs.opscode.com/chef/resources.html#http-request
[2013-06-14 09:50:22 -0400] Hildgrim: Ooh, that's nice. Thank you
[2013-06-14 09:51:07 -0400] spheromak: anytime you find yourself shelling out to do something you should look for a resource to do it instead first :D
[2013-06-14 09:51:13 -0400] spheromak: then you should write an lwrp :)
[2013-06-14 09:51:15 -0400] Hildgrim: Truly :)
[2013-06-14 09:51:56 -0400] spheromak: currently i don't think that supports etag  on get
[2013-06-14 09:52:13 -0400] spheromak: so you can do a HEAD first to get teh  etag  then use that to trigger a get
[2013-06-14 09:53:50 -0400] Hildgrim: hmm that work out just fine. sweet!
[2013-06-14 09:59:58 -0400] kisoku: spheromak: jenkins
[2013-06-14 10:00:10 -0400] spheromak: kisoku theres a plugin for that
[2013-06-14 10:00:21 -0400] kisoku: which one ?
[2013-06-14 10:00:46 -0400] spheromak: one sec looking it up
[2013-06-14 10:01:49 -0400] spheromak: ansicolor
[2013-06-14 10:02:02 -0400] spheromak: https://github.com/cloudware-cookbooks/ci/blob/develop/attributes/server.rb#L50 :D
[2013-06-14 10:05:16 -0400] kisoku: uh
[2013-06-14 10:05:28 -0400] kisoku: yeah that's the opposite of what I wanted but ok
[2013-06-14 10:05:29 -0400] kisoku: :-P
[2013-06-14 10:05:43 -0400] kisoku: I don't want colors :-P
[2013-06-14 10:05:56 -0400] kisoku: also. the colors seem hella broken
[2013-06-14 10:19:08 -0400] spheromak: yea
[2013-06-14 10:19:12 -0400] spheromak: output is hella broken
[2013-06-14 10:19:39 -0400] spheromak: but you can work it out
[2013-06-14 10:20:19 -0400] spheromak: man github api is being mad at me.  I shall sleep on it and deal with it in the morning
[2013-06-14 10:21:31 -0400] spheromak: Octokit::UnprocessableEntity makes me a sad panda
[2013-06-14 10:22:21 -0400] spheromak: kisoku, ill be in seul in a week and a 1/2 to keep you company in here :)
[2013-06-14 10:22:30 -0400] spheromak: shit seoul
[2013-06-14 11:16:21 -0400] _br_: Anyone have an idea what this error is about? "undefined local variable or method `use_inline_resources' for #<Class:0xb69e9f74>" using Chef 10.18.2 and guessing that this might be a chef issue?
[2013-06-14 12:20:03 -0400] pikesley: it's apt
[2013-06-14 12:20:14 -0400] pikesley: pin the apt cookbook at 1.9.0
[2013-06-14 13:19:34 -0400] kvs: or upgrade to Chef 11 :)
[2013-06-14 14:00:17 -0400] dsteen: morning all (or at least here it is anyway) :-)   Is it possible to store unencrypted data in an encrypted data bag?  I get "wrong final block length" when I try.
[2013-06-14 14:00:39 -0400] dsteen: on decrypt
[2013-06-14 14:43:00 -0400] juliancdunn: dsteen: no, your data bag item has to be entirely encrypted or not
[2013-06-14 14:43:17 -0400] juliancdunn: although data bags can contain a mix of encrypted and unencrypted items, of course
[2013-06-14 15:01:03 -0400] zackf: Is there a good link on how to get a erchef development environment setup
[2013-06-14 15:11:27 -0400] juliancdunn: zackf: beyond what's at https://github.com/opscode/erchef#how-to-hack-on-erchef ?
[2013-06-14 15:20:44 -0400] freezey: with chef11 anyway to set a different hostname besides what it gets from hostname --fqdn? I checked through the chef-server cookbooks on the system itself and after a reconfigure it still sets it
[2013-06-14 15:39:45 -0400] mattray: freezey: use -N when you bootstrap the node
[2013-06-14 15:39:52 -0400] mattray: hostname or node name?
[2013-06-14 15:39:53 -0400] freezey: no no
[2013-06-14 15:39:56 -0400] freezey: for chef-server
[2013-06-14 15:40:03 -0400] freezey: when installing chef-server 11
[2013-06-14 15:40:10 -0400] freezey: you run the chef-server-ctl
[2013-06-14 15:41:33 -0400] dsteen: you can change the results of hostname --fqdn by prepending entries to the 127.0.0.1 line in /etc/hosts
[2013-06-14 15:41:53 -0400] dsteen: @freezy
[2013-06-14 15:44:32 -0400] zackf: @juliancdunn sorry for the delay
[2013-06-14 15:44:35 -0400] zackf: Yes Beyond that.
[2013-06-14 15:49:47 -0400] mstyne: morning all
[2013-06-14 15:50:02 -0400] mstyne: has anyone encountered chef_gem blatantly lying about installing a gem?
[2013-06-14 15:51:15 -0400] mstyne: even running my chef_gem block in chef-shell returns true; however the gem is nowhere to be found according to /opt/chef/embedded/bin/gem list
[2013-06-14 15:52:18 -0400] vaskas: hi guys. I'm implementing an LWRP and I'm calling template from within it. How do I make it refer to templates inside the LWRP cookbook, not the ones inside the caller cookbook?
[2013-06-14 15:52:27 -0400] juliancdunn: zackf: I dunno then, probably best to ask one of our SDEs once they're here like kallistec
[2013-06-14 15:53:26 -0400] juliancdunn: vaskas: the template resource takes a cookbook attribute
[2013-06-14 15:55:13 -0400] vaskas: juliancdunn oh, it does! thanks a lot!
[2013-06-14 15:55:28 -0400] zackf: ok thanks juliancdunn
[2013-06-14 15:56:00 -0400] juliancdunn: mstyne: "blatantly lying" -- lol
[2013-06-14 15:56:30 -0400] juliancdunn: what gem are you trying to install?
[2013-06-14 15:57:14 -0400] mstyne: per some additional research this seems to be a known issue
[2013-06-14 15:57:24 -0400] mstyne: it's /is/ installing the gem, but with the system ruby
[2013-06-14 15:57:29 -0400] mstyne: not in /opt/chef
[2013-06-14 15:58:09 -0400] mstyne: so it's not lying per se, it's just really confused/broken
[2013-06-14 16:02:53 -0400] kallistec: zackf: what in particular do you want to know?
[2013-06-14 16:04:04 -0400] zackf: I'm having troulbe using vagrant omnibus to build a deb of my changes.
[2013-06-14 16:04:56 -0400] zackf: I've got vagrant-omnibus plugin installed, but I run the commaned detailed on https://github.com/opscode/erchef  It says invalid syntax.
[2013-06-14 16:05:25 -0400] pcn: chefs, is there a simple way to use shef/chef-shell in solo mode to see what node data would look like, without having to construct a json doc or solo.rb?
[2013-06-14 16:06:27 -0400] pcn: Oh, never mind
[2013-06-14 16:06:41 -0400] pcn: ARRGH.  PEBKAC
[2013-06-14 16:07:12 -0400] zackf: In short, I'm having trouble building a pakckage
[2013-06-14 16:07:34 -0400] Guest96492: when using the open source chef server what do I have to use to view the management console? is it a download?
[2013-06-14 16:08:41 -0400] markmc_att: chef problem: still have complaints about 'ruby-shadow not installed' when it is installed and explicitly included in the run_list. Suggestions?
[2013-06-14 16:10:19 -0400] zackf: @kallistec I'm not sure if there  are any other documents out there I can dig on, but I can't seem to get it to go
[2013-06-14 16:10:42 -0400] freezey: that chef11 upgrade doc doesnt really work as well as the site says
[2013-06-14 16:10:43 -0400] freezey: heh
[2013-06-14 16:11:27 -0400] kallistec: zackf: I just updated the README, you need omnibus-chef-server and not omnibus-chef now
[2013-06-14 16:11:33 -0400] kallistec: might be the issue
[2013-06-14 16:12:17 -0400] zackf: Ok, thanks kallistec! I'll give it a go, appreciate it greatly.
[2013-06-14 16:12:24 -0400] kallistec: updating the cookbook that auto-fetches the repos right now
[2013-06-14 16:12:44 -0400] zackf: kk, I'll hold off for a bit.
[2013-06-14 16:12:51 -0400] kallistec: basically edit chef/cookbooks/dev/recipes/setup.rb and do s/omnibus-chef/omnibus-chef-server/
[2013-06-14 16:13:11 -0400] kallistec: then run make clone_for_dev again
[2013-06-14 16:14:14 -0400] zackf: kk running now
[2013-06-14 16:16:11 -0400] zackf: kk that looks better.
[2013-06-14 16:16:17 -0400] zackf: when I run this bin/vagrant omnibus build ubuntu-10.04 chef-server
[2013-06-14 16:16:27 -0400] zackf: That should build with the changes I made locally and throw it under /pkg
[2013-06-14 16:16:29 -0400] zackf: Correct?
[2013-06-14 16:19:07 -0400] kallistec: zackf: should work
[2013-06-14 16:19:29 -0400] kallistec: hopefully the vagrant 1.0->1.1 carnage didn't break it
[2013-06-14 16:19:58 -0400] _br_: pikesley: kvs: Thanks I'll try that.
[2013-06-14 16:34:24 -0400] zackf: Ok, I'm trying I'll let you know if i hitt road blocks thanks alot kallistec greatly appreciated.
[2013-06-14 16:35:33 -0400] kallistec: zackf: you bet
[2013-06-14 16:40:57 -0400] asharp: what's the difference between the git and deploy resources?
[2013-06-14 16:45:37 -0400] coderanger: asharp: git is simply a wrapper around git, getting code in a place
[2013-06-14 16:45:52 -0400] coderanger: asharp: deploy is basically a chef version of the capistrano deploy format
[2013-06-14 16:47:41 -0400] asharp: coderanger: so if all i want to do is clone a repo, the best practice is to use the git resource?
[2013-06-14 16:48:15 -0400] coderanger: If by "best practice" you mean "the way to do it", yes
[2013-06-14 16:48:23 -0400] asharp: coderanger: lol gotcha
[2013-06-14 16:48:29 -0400] asharp: coderanger: thanks
[2013-06-14 16:48:30 -0400] coderanger: best practice implies multiple options or some kind of opinion
[2013-06-14 16:48:49 -0400] asharp: coderanger: deploy doesn't provide a way of cloning a git repo?
[2013-06-14 16:49:06 -0400] coderanger: It just use the git resource internally
[2013-06-14 16:49:14 -0400] asharp: coderanger: alright makes sense
[2013-06-14 17:26:21 -0400] idlemichael: is there a way to force a "login shell" when you specify the user in a resource, and things like that?
[2013-06-14 17:27:21 -0400] Otterley: is it a user resource?
[2013-06-14 17:27:27 -0400] Otterley: that you're declaring
[2013-06-14 17:27:52 -0400] coderanger: idlemichael: No, "login shell" isn't really a thing
[2013-06-14 17:28:17 -0400] kallistec: coderanger: for bash, it is
[2013-06-14 17:28:30 -0400] idlemichael: kallistec: was just about o say that ;)
[2013-06-14 17:28:33 -0400] Otterley: can you guys explain?
[2013-06-14 17:28:39 -0400] kallistec: e.g, all the stuff in the "invocation" section of the bash manpage
[2013-06-14 17:28:45 -0400] Otterley: login shell is a very technical term
[2013-06-14 17:28:52 -0400] coderanger: There is no simple unified way to launch a specified proc inside an arbitrary shell
[2013-06-14 17:28:57 -0400] idlemichael: Otterley: it's  a preconfigured environment
[2013-06-14 17:29:10 -0400] coderanger: For bash there is bash -c, but good luck finding something that works everywhere ;-)
[2013-06-14 17:29:22 -0400] kallistec: coderanger: right, which is why I don't think it's supportable for the execute resource
[2013-06-14 17:29:26 -0400] idlemichael: coderanger: ya -- bash is pretty universal though
[2013-06-14 17:29:32 -0400] kallistec: for bash script resource, totally doable
[2013-06-14 17:29:34 -0400] idlemichael: coderanger: and even if it wasn't you could install it first?
[2013-06-14 17:29:37 -0400] coderanger: kallistec: Yeah, thats what I meant by "a thing"
[2013-06-14 17:29:46 -0400] idlemichael: kallistec: how do i get a login shell with the bash resource?
[2013-06-14 17:29:47 -0400] coderanger: idlemichael: But "login shell" != bash
[2013-06-14 17:30:03 -0400] Otterley: what's the use case?  I've discovered 99% of the need of a "login shell" can be eliminated through other means with fewer side effects
[2013-06-14 17:30:03 -0400] coderanger: You need to use the actual user's shell, which is defined as "any executable"
[2013-06-14 17:30:05 -0400] kallistec: idlemichael: anyway, there's an open feature request
[2013-06-14 17:30:18 -0400] kallistec: that describes how it would work
[2013-06-14 17:30:32 -0400] coderanger: Otterley: The use case is anything that relies on environment variables or other things setup in shell init files
[2013-06-14 17:30:34 -0400] Otterley: people say they want a login shell usually because they don't know how to accomplish what they want to accomplish
[2013-06-14 17:30:34 -0400] idlemichael: kallistec: oh -- it's not implemented ? :<
[2013-06-14 17:30:51 -0400] kallistec: idlemichael: no, you can probably fake it though
[2013-06-14 17:31:15 -0400] coderanger: Otterley: I've noticed you are extremely combative when dealing with questions in here, please try to tone that down a bit
[2013-06-14 17:31:45 -0400] coderanger: execute "bash -c 'foo'" is definitely a thing
[2013-06-14 17:32:08 -0400] kallistec: idlemichael: http://tickets.opscode.com/browse/CHEF-2288
[2013-06-14 17:32:08 -0400] Otterley: my apologies - I'm not sure how to better communicate that you may be accommodating bad practice
[2013-06-14 17:32:53 -0400] miah: sup
[2013-06-14 17:32:55 -0400] idlemichael: kallistec: saw an old ticket like that
[2013-06-14 17:32:59 -0400] coderanger: Otterley: We try to steer people towards good habits when possible, but sysops in general and Chef in particular are built to accommodate all manner of legacy nonsense and ugly hacks
[2013-06-14 17:33:05 -0400] idlemichael: kallistec: thanks -- i'll hack my way around it :D
[2013-06-14 17:33:56 -0400] Otterley: I view that as making the problem worse instead of better
[2013-06-14 17:34:11 -0400] coderanger: Otterley: And thats fine, but please do that elsewhere
[2013-06-14 17:34:27 -0400] coderanger: This is a support channel for Chef, not a "how to be the best sysadmin"
[2013-06-14 17:34:30 -0400] Otterley: fair enough
[2013-06-14 17:35:07 -0400] coderanger: ##infra-talk is a good place to hang if you want to just shoot the shit about making good infrastructure :)
[2013-06-14 17:36:19 -0400] miah: and ##redit-sysadmin if you want to blab and not know wtf your talking about ;)
[2013-06-14 17:36:45 -0400] cwj: sign me up
[2013-06-14 17:36:53 -0400] miah: i just flew back from pdx and BOY ARE MY ARMS TIRED
[2013-06-14 17:37:02 -0400] coderanger: I'm not a sysadmin, I just play one on TV
[2013-06-14 17:37:33 -0400] miah: everything i know about irc i learned from numb3rs https://www.youtube.com/watch?v=O2rGTXHvPCQ
[2013-06-14 17:37:46 -0400] c_t: that has to be the most boring TV show ever
[2013-06-14 17:37:59 -0400] cwj: and yet the best description of IRC ever provided on TV
[2013-06-14 17:38:04 -0400] c_t: (the sysadmin TV show, I mean. I'm sure there's more boring shows than Numb3rs.)
[2013-06-14 17:38:06 -0400] kallistec: Otterley: http://www.listbox.com/member/archive/182179/2013/05/sort/time_rev/page/1/entry/1:75/20130508172342:8CF96552-B825-11E2-98EE-8CBB5940B2DC/
[2013-06-14 17:38:55 -0400] miah: this is still the best description of what i do: https://www.youtube.com/watch?v=bLlj_GeKniA
[2013-06-14 17:39:12 -0400] aneto: holy crap tv has got ridiculous
[2013-06-14 17:39:19 -0400] aneto: thats from an actual tv show?
[2013-06-14 17:39:53 -0400] c_t: aneto: I consider myself lucky that Nick at Nite was available when I was a lad
[2013-06-14 17:40:05 -0400] c_t: because it taught me that no matter how dire TV seems now, it was worse in the 50s
[2013-06-14 17:42:13 -0400] coderanger: aneto: A show from the 90s
[2013-06-14 17:43:01 -0400] coderanger: Also miah, this is what you do https://www.youtube.com/watch?v=i1IqqlW1U4k
[2013-06-14 17:47:16 -0400] miah: coderanger: a little, but more: https://www.youtube.com/watch?v=UE_czPc7o5Y
[2013-06-14 17:48:55 -0400] coderanger: miah: Does this mean we have an excuse to buy red and blue lasers for our ops team?
[2013-06-14 17:51:30 -0400] miah: YES
[2013-06-14 17:54:54 -0400] Otterley: what are your thoughts on best practices for handling forked community cookbooks?
[2013-06-14 17:55:42 -0400] Otterley: we need to use our patches faster than they can be integrated, but I'm concerned about managing Berksfiles and version numbers so that we can go back to the community cookbook someday.  right now it feels like a one-way street
[2013-06-14 17:55:48 -0400] coderanger: Otterley: What kind of situations are you running in to that require patching?
[2013-06-14 17:56:05 -0400] coderanger: In general I try to keep alterations in companyname-something
[2013-06-14 17:56:16 -0400] Otterley: one example is the runit cookbook, which we've patched to fix a couple of bugs and add log/config functionality
[2013-06-14 17:56:35 -0400] Otterley: (I'm about to submit a PR for the latter as an enhancement ticket)
[2013-06-14 17:57:11 -0400] Otterley: we also have a <companyname>-runit cookbook but that's to implement site-specific providers atop runit
[2013-06-14 17:57:29 -0400] coderanger: Yeah, there isn't a great workflow for that right now
[2013-06-14 17:57:43 -0400] coderanger: Most people just keep the version number the same as the upstream release
[2013-06-14 17:58:00 -0400] coderanger: and just overwrite it each time, that sucks though since you can't use cookbook version controls anymore
[2013-06-14 17:59:36 -0400] Otterley: maybe a 4-tuple for version number?
[2013-06-14 17:59:52 -0400] PierreO1: I din't find a great workflow neither Fork -> patch & change version number -> change Berksfile -> berks upload to the chef server
[2013-06-14 17:59:57 -0400] Otterley: I'm not sure existing tools could deal with that though
[2013-06-14 18:00:08 -0400] coderanger: Otterley: Yeah, a better way would be to allow x.y.z-r
[2013-06-14 18:00:15 -0400] coderanger: But that would require big changes
[2013-06-14 18:00:19 -0400] Otterley: Yeah
[2013-06-14 18:00:26 -0400] Otterley: It's frustrating
[2013-06-14 18:00:53 -0400] PierreO1: and if you go back to the official cookbook, you'll have to delete your cookbook from your server
[2013-06-14 18:01:26 -0400] Otterley: It's even more frustrating because Berkshelf doesn't recursively find dependencies, so if you change it in one cookbook, you have to change it in all its dependent cookbooks as well
[2013-06-14 18:01:38 -0400] PierreO1: (Ah, and from your local ~/.berkshelf )
[2013-06-14 18:01:59 -0400] ivey: berkshelf recursively finds dependencies specified in metadata
[2013-06-14 18:02:23 -0400] Otterley: ivey, but  as soon as you use a forked version, you can't use metadata anymore unless you have your own Gem repo
[2013-06-14 18:02:26 -0400] ivey: it's only when you do tricks like :git or :path locations that you have to specify them multiple times
[2013-06-14 18:02:28 -0400] Otterley: err, cookbook repo
[2013-06-14 18:02:44 -0400] ivey: have a CI job for the fork, that pushes it to your chef server
[2013-06-14 18:02:50 -0400] ivey: then other cookbooks get it from chef server
[2013-06-14 18:03:11 -0400] Otterley: my preference would be that git be treated like a first-class citizen, but that's out of Chef's bailiwick
[2013-06-14 18:03:39 -0400] coderanger: Otterley: No, we are very specifically agnostic
[2013-06-14 18:05:30 -0400] coderanger: And yeah, Berkshelf is largely built expecting to use a chef server as an artifact repo
[2013-06-14 18:05:35 -0400] PierreO1: Otterley: I'm thinking about giving a try to https://github.com/tobami/littlechef as I think the issue is chef-server somehow
[2013-06-14 18:05:48 -0400] coderanger: Or rather, Riot does that, so Berkshelf makes that easy
[2013-06-14 18:06:21 -0400] PierreO1: (chef-server doesn't care about the cookbook version you are specifying in the Berksfile)
[2013-06-14 18:06:26 -0400] Otterley: I'm still trying to grok Jamie's thinking there
[2013-06-14 18:06:28 -0400] ivey: we'd be open to additional ways of finding deps, but we're very much against recursively loading berksfiles. Suggestions that don't involve that are more than welcome.
[2013-06-14 18:06:50 -0400] Otterley: ivey, what's the objection to that, specifically?
[2013-06-14 18:07:57 -0400] coderanger: Otterley: Executing upstream berksfile is a security risk if nothing else
[2013-06-14 18:08:11 -0400] ivey: It opens up some thorny edge cases (deps defined multiple times, from different sources, who wins?) and it encourages what we see as really bad habits. Plus it's a  what coderanger said
[2013-06-14 18:08:45 -0400] Otterley: yeah, that's the danger of DSLs :(
[2013-06-14 18:08:55 -0400] Otterley: that aren't real DSLs that is
[2013-06-14 18:10:42 -0400] Otterley: coderanger, wait, err, why would berks run as root?
[2013-06-14 18:10:55 -0400] coderanger: Otterley: Because berks can upload cookbooks, cookbooks run as root
[2013-06-14 18:11:06 -0400] coderanger: By transient analysis, berks process holds root
[2013-06-14 18:11:17 -0400] coderanger: Not on the local system, but on everything running chef-client
[2013-06-14 18:11:24 -0400] Otterley: ah
[2013-06-14 18:12:08 -0400] Otterley: how's that substantively different from uploading cookbooks that declare dependencies on other cookbooks?
[2013-06-14 18:14:05 -0400] coderanger: If you are using version locking correctly, you should have a chance to review any external cookbook before any of its code is run
[2013-06-14 18:14:06 -0400] ignatz: urr, debian 7.0 doesn't appear to include curl. nice.
[2013-06-14 18:14:59 -0400] Otterley: isn't that also true if you are using Berkshelf?  it's subject to the same version locking restrictions as any other Chef cookbook API client, no?
[2013-06-14 18:15:34 -0400] coderanger: Sure, but executing a remote berksfile would mean that if it does evil things, it can change stuff before you have a chance to review
[2013-06-14 18:15:48 -0400] coderanger: The act of uploading a cookbook should, in theory, always be safe
[2013-06-14 18:16:02 -0400] coderanger: (if you setup your version constraints correctly)
[2013-06-14 18:16:11 -0400] jgood: What do I have to do log into the chef server webUI?
[2013-06-14 18:16:52 -0400] coderanger: jgood: Hosted Chef, Private Chef, or Open Source?
[2013-06-14 18:17:34 -0400] jgood: Open source
[2013-06-14 18:19:20 -0400] coderanger: Did we disable that by default?
[2013-06-14 18:19:29 -0400] coderanger: I don't remember anymore, we definitely talked about doing that
[2013-06-14 18:20:01 -0400] Otterley: Thanks coderanger, ivey, PierreO1  - my current thinking is leaning towards a different cookbook name that replaces/conflicts with the community cookbook
[2013-06-14 18:20:21 -0400] ivey: +1 on that
[2013-06-14 18:20:45 -0400] ivey: we (Riot) have a rule that no cookbook can go on our chef server that has the same name as community unless it came from community
[2013-06-14 18:21:02 -0400] ivey: we don't even use git/master for community cookbooks, we just annoy the maintainer to release a new version
[2013-06-14 18:21:31 -0400] ivey: and when we fork, we first try to get the changes merged / released, before we rename and use the fork
[2013-06-14 18:21:42 -0400] spheromak: ivey lol
[2013-06-14 18:22:00 -0400] Otterley: That would be my preference too, but Opscode resources are clearly very constrained
[2013-06-14 18:22:10 -0400] Otterley: and they are the gatekeepers right now
[2013-06-14 18:22:11 -0400] spheromak:  " we just annoy the maintainer to release a new version"
[2013-06-14 18:22:37 -0400] ivey: i've found that when you hand opscode folks a working PR and a freshly updated JIRA ticket, they're usually pretty happy to get fixes out :-)
[2013-06-14 18:22:46 -0400] spheromak: ivey,  We do the same, but I end up forking and making integration branches with TODOS:  and refrences to pull requests in berks files.
[2013-06-14 18:22:57 -0400] spheromak: ivey,  yea
[2013-06-14 18:23:42 -0400] Otterley: ivey, I've had a different experience, I'm still trying to get my partial search cache code accepted - not because it doesn't work but because partial_search is still being integrated into Chef 11 as a first-class provider
[2013-06-14 18:24:40 -0400] Otterley: it has made our runs _significantly_ faster
[2013-06-14 18:24:47 -0400] ivey: yeah but now you're not talking about bug fixes/enhancements to cookbooks. chef internals is a different story, inherently more complex because of multiple versions and multiple license models
[2013-06-14 18:25:32 -0400] Otterley: it was a cookbook at the time :)  but yes, I understand
[2013-06-14 18:34:54 -0400] geggam: anyonehere work at opscode ?
[2013-06-14 18:35:50 -0400] geggam: let me rephrase... i work at HP and im interested in professional chef :)
[2013-06-14 18:36:44 -0400] aneto: http://www.opscode.com/private-chef/
[2013-06-14 18:36:58 -0400] geggam: i wanted a conversation... not a website
[2013-06-14 18:37:12 -0400] aneto: How bout them sports teams?
[2013-06-14 18:37:21 -0400] geggam: what is sports ?
[2013-06-14 18:37:31 -0400] geggam: you realize you are in IRC ?
[2013-06-14 18:37:54 -0400] shanlar: https://www.youtube.com/watch?v=O2rGTXHvPCQ
[2013-06-14 18:39:32 -0400] shanlar: d0 y0|_| r34l1z3 y0|_| 4r3 1n 1rc?
[2013-06-14 18:40:25 -0400] ivey: geggam: are you looking for pre-sales info or just have questions?
[2013-06-14 18:41:18 -0400] geggam: we are probably working you from two offices ivey... let me sync up with the guy in chicago before i get back to you
[2013-06-14 18:41:30 -0400] ivey: i don't work for opscode
[2013-06-14 18:41:39 -0400] ivey: but i use private chef
[2013-06-14 18:41:46 -0400] geggam: thats nice
[2013-06-14 18:41:50 -0400] ivey: so if you have questions, this is a good forum
[2013-06-14 18:41:59 -0400] ivey: if you need pre-sales info, this isn't the right place
[2013-06-14 18:42:25 -0400] geggam: im being lazy... instead of calling im checking IRC first
[2013-06-14 18:55:53 -0400] organicveggie: Trying to setup Chef Server 11 on CentOS and I want to set my own SSL certificates. Any documentation on that?
[2013-06-14 18:56:19 -0400] organicveggie: I'm using the omnibus installer.
[2013-06-14 18:58:29 -0400] organicveggie: More to the point, I'm not sure where the omnibus nginx setup stores the vhost files which is where I'm assuming I would customize the SSL vert it's using.
[2013-06-14 19:07:11 -0400] ivey: shanlar: Luckily, I speak leet.
[2013-06-14 19:11:47 -0400] freezey: after doing the the chef upload during the upgrade.. the users cannot login to the webui and i dont see any errors in the logs.. anybody experience this?
[2013-06-14 19:11:58 -0400] freezey: admin user cant get in either
[2013-06-14 19:13:22 -0400] banachtarski: i have a script resource that appears to do nothing
[2013-06-14 19:13:25 -0400] banachtarski: http://pastebin.com/NkzA7vty
[2013-06-14 19:13:40 -0400] banachtarski: it just copies one folder somewhere else
[2013-06-14 19:13:50 -0400] banachtarski: any troubleshooting ideas?
[2013-06-14 19:20:13 -0400] swedish_chef: This may be a "let me Google it for you" question but my main problem is that I don't know the right query to give Google to find the answer :/
[2013-06-14 19:20:15 -0400] swedish_chef: I am wondering how can I make a Ruby module available to all Chef cookbooks. Libraries provide this for recipes. What is the equivalent pattern for cookbooks?
[2013-06-14 19:20:51 -0400] stormerider: swedish_chef: like a gem?
[2013-06-14 19:20:56 -0400] swedish_chef: yup
[2013-06-14 19:21:00 -0400] swedish_chef: worst case
[2013-06-14 19:21:16 -0400] stormerider: chef_gem will install it into Chef itself instead of the system ruby
[2013-06-14 19:21:26 -0400] siezer: swedish_chef libraries become available to the chef-client, not a cookbook. so, to use a library shipped in cookbookA, simply put "require cookbookA" in cookbookB's metadata.rb
[2013-06-14 19:22:20 -0400] swedish_chef: @sielzer so I could create a "global"/shared cookbook for this instead of a gem?
[2013-06-14 19:23:25 -0400] siezer: swedish_chef you could either distribute your libraries as a gem, and require them with chef_gem, or put them into a file in the libraries/ directory of a cookbook, and have any other cookbook that needs to use it depend on it
[2013-06-14 19:24:41 -0400] swedish_chef: siezer thanks, this will work well
[2013-06-14 19:24:56 -0400] siezer: no prob
[2013-06-14 19:28:10 -0400] organicveggie: Trying to setup Chef Server 11 on CentOS with the omnibus RPM package and I want to set my own SSL certificates. Any documentation on that?
[2013-06-14 19:28:52 -0400] stormerider: organicveggie: once you have it installed, customize /etc/chef-server/chef-server.rb with your own ssl variables. sec, ill dig up the lines.
[2013-06-14 19:29:23 -0400] zackf: @kallistec: you around?
[2013-06-14 19:29:43 -0400] organicveggie: @stormrider I don't seem to have a chef-server.rb floating around anywhere...
[2013-06-14 19:29:43 -0400] kallistec: zackf: what's up?
[2013-06-14 19:29:44 -0400] stormerider: nginx['ssl_certificate']        = "/etc/ssl/private/...pem", nginx['ssl_certificate_key']    = "/etc/ssl/private/...pem"
[2013-06-14 19:30:08 -0400] stormerider: organicveggie: it customizes the defaults, you dont have to have one. it's an override config file.
[2013-06-14 19:30:19 -0400] organicveggie: @stormerider: Ahhh gotcha!
[2013-06-14 19:30:21 -0400] zackf: running omnibus build project chef-server: throwing Error raised "dont know how to build task software:prepartion".
[2013-06-14 19:30:24 -0400] stormerider: once you set those values do a chef-server-ctl reconfigure
[2013-06-14 19:30:29 -0400] organicveggie: Thanks. I'll give that a shot.
[2013-06-14 19:31:02 -0400] zackf: Have you seen this before, I've started completely from scratch after the help you gave me earlier. Can't get passed this to build a pkg.
[2013-06-14 19:32:39 -0400] ianco: how do you folks feel about having an lwrp added to the haproxy community cookbook, like haproxy_http and haproxy_tcp for example
[2013-06-14 19:33:11 -0400] kallistec: zackf: I've seen that but I don't remember the cause
[2013-06-14 19:33:29 -0400] zackf: Ok. I"ll keep digging.
[2013-06-14 19:33:34 -0400] kallistec: schisamo: any ideas? ^^
[2013-06-14 19:35:41 -0400] coderanger: ianco: Its coming, already done in my fork
[2013-06-14 19:35:47 -0400] coderanger: I just haven't had time to clean it up
[2013-06-14 19:36:21 -0400] coderanger: ianco: feel free to steal though https://github.com/python/psf-chef/tree/master/cookbooks/haproxy
[2013-06-14 19:37:28 -0400] coderanger: ianco: See psf-loadbalancer::haproxy for an example of usage
[2013-06-14 19:38:47 -0400] ianco: coderanger: aw man, i already started!
[2013-06-14 19:38:48 -0400] ianco: hehe
[2013-06-14 19:38:51 -0400] ianco: cool
[2013-06-14 19:39:02 -0400] _br_: Still getting "undefined local variable or method `use_inline_resources' for #<Class:0xb6af119c>" for "/tmp/vagrant-chef-1/chef-solo-1/cookbooks/ark/providers/default.rb:23:in `class_from_file'" for Chef solo 10.18.2. Any ideas?
[2013-06-14 19:39:49 -0400] coderanger: ianco: I've also got another branch with an attempt to DSL-ize the whole HAProxy section config, that was silly though so its unfinished
[2013-06-14 19:42:13 -0400] lazukars: I'm setting up a chef server on ec2.  What should the chef_server_url  be on my local machine's knife.rb?  Just the elastic ip of my ec2 instance?
[2013-06-14 19:42:53 -0400] coderanger: lazukars: Sure, or the public IP, just has to get packets to the machine
[2013-06-14 19:43:02 -0400] ianco: coderanger, this looks pretty radical
[2013-06-14 19:43:06 -0400] ianco: ^5
[2013-06-14 19:43:20 -0400] coderanger: lazukars: Also as a word of warning, running a chef server on EC2 is basically always more expensive than Hosted Chef (not that I'm unbiased of course)
[2013-06-14 19:43:33 -0400] coderanger: ianco: :-) I try
[2013-06-14 19:45:02 -0400] lazukars: Thanks @coderanger!
[2013-06-14 19:45:19 -0400] geggam: its sort of funny... people think renting space on a virtual server will save money... only way it does is if you use it part time. EC2 has to make money and they are running the server you would be ... but they are running it all the time
[2013-06-14 19:45:34 -0400] geggam: so they have to charge more than the cost of hardware and running the server
[2013-06-14 19:45:40 -0400] lazukars: Well, when I run knife-client list, I get this error: "Error connecting to http://my-elastic-ip/clients - Error connecting to https://ip-my-internal-ip.ec2.internal/clients"
[2013-06-14 19:45:55 -0400] lazukars: it's trying to redirect to an internal ip on ec2.  But why?
[2013-06-14 19:47:16 -0400] coderanger: lazukars: Make sure the hostname is set correctly in your server config and chef-server-ctl reconfigure
[2013-06-14 19:47:52 -0400] coderanger: geggam: There are sometimes reasons to do it, usually IT depts that allow cloud providers but not SaaS vendors
[2013-06-14 19:48:37 -0400] geggam: im aware of the reasons to do it... im also aware of the reasons to not do it, was an observation on perspectives i see
[2013-06-14 19:49:28 -0400] lazukars: @coderanger: Well, I'm using the direct ip address of the ec2 machine, so the hostname should not matter, correct?
[2013-06-14 19:49:37 -0400] coderanger: Yep, definitely way more people that try it than should
[2013-06-14 19:49:39 -0400] lazukars: In the knife.rb file at least
[2013-06-14 19:49:51 -0400] coderanger: lazukars: That error was on redirect
[2013-06-14 19:50:00 -0400] coderanger: lazukars: the server redirects http to https
[2013-06-14 19:50:25 -0400] coderanger: You should set https in the knife.rb
[2013-06-14 19:50:25 -0400] lazukars: Rigth, that's where I'm confused.
[2013-06-14 19:50:29 -0400] lazukars: k
[2013-06-14 19:50:30 -0400] coderanger: but you will want to make sure the hostname is correct anyway
[2013-06-14 19:50:41 -0400] coderanger: because EC2 VMs see their internal name as the FQDN
[2013-06-14 19:50:46 -0400] ianco: coderanger, do you think your haproxy stuff will end up merged into the community one
[2013-06-14 19:50:52 -0400] organicveggie: @stormerider: weird problem. tried setting the custom cert/key. saw it get picked up during chef-server-ctl reconfigure. nginx looks like it's running, but it's not responding. nothing obvious in /var/log/chef-server/nginx - just access messages. Remove the custom cert/key lines and it works again.
[2013-06-14 19:51:07 -0400] coderanger: ianco: Yeah, I've been slowly taking over :)
[2013-06-14 19:51:28 -0400] ianco: solid
[2013-06-14 19:51:41 -0400] coderanger: ianco: I need to sort out how to deal with multiple install methods still
[2013-06-14 19:51:52 -0400] coderanger: source vs. package
[2013-06-14 19:51:59 -0400] Otterley: organicveggie, if you post a diff of the generated nginx config files before and after the change + chef-server-ctl reconfigure, perhaps we can figure it out
[2013-06-14 19:52:14 -0400] ianco: i thought folks would just include an install source and then go nuts with the providers
[2013-06-14 19:52:46 -0400] coderanger: ianco: Yeah, just have to clean up the haproxy resource/provider to allow for subclassing
[2013-06-14 19:52:47 -0400] organicveggie: is it possible i'm just grabbed the wrong cert and it's expired? would that cause the same problem?
[2013-06-14 19:52:55 -0400] coderanger: has to be converted to HWRP instead of LWRP, etc
[2013-06-14 19:54:10 -0400] Otterley: organicveggie, expired certs wouldn't cause a failure to connect or route, just certificate errors if verification is enabled
[2013-06-14 19:54:43 -0400] organicveggie: Where do I find the generated nginx config files with the omnibus installer?
[2013-06-14 19:55:16 -0400] coderanger: organicveggie: opt/chef-server/embedded/ I think
[2013-06-14 19:55:23 -0400] geggam: rpm installer organicveggie  ?
[2013-06-14 19:55:31 -0400] geggam: rpm -ql rpmname
[2013-06-14 19:55:31 -0400] organicveggie: @geggam: rpm, yes
[2013-06-14 19:55:35 -0400] coderanger: I'm more familiar with the OPC layout, but OSC chef server is similar
[2013-06-14 19:55:35 -0400] Otterley: organicveggie, /var/opt/chef-server/nginx/etc
[2013-06-14 19:55:39 -0400] geggam: you will find it
[2013-06-14 19:55:48 -0400] coderanger: No, the nginx configs are not part of the package
[2013-06-14 19:56:01 -0400] coderanger: they are generated by solo during the reconfigure
[2013-06-14 19:56:02 -0400] organicveggie: Ahh right. I keep forgetting about /var/opt/chef since I just started testing Chef 11 (been on Chef 9 for ages).
[2013-06-14 19:56:40 -0400] brma: I am trying to get a single chef recipe to run on one machine.  I want to use chef-solo and have everything installed and ready to run except chef can't find my cookbook.  Where should I put it/how should I debug?
[2013-06-14 19:59:10 -0400] organicveggie: Here's the diff between the two revisions of /var/opt/chef-server/nginx/etc/chef_https_lb.conf: https://gist.github.com/organicveggie/08b40d373994bf55d5f3#file-chef_https_lb-conf-diff
[2013-06-14 19:59:20 -0400] organicveggie: Just two lines.
[2013-06-14 19:59:28 -0400] organicveggie: ssl_certificate and ssl_certificate_key
[2013-06-14 19:59:50 -0400] Otterley: no diffs in nginx.conf or chef_http_lb.conf ?
[2013-06-14 20:00:04 -0400] organicveggie: I'll check those too. just a second.
[2013-06-14 20:01:39 -0400] organicveggie: Nope. No diffs in nginx.conf and check_http_lb.conf.
[2013-06-14 20:01:50 -0400] organicveggie: Only chef_https_lb.conf shows changes.
[2013-06-14 20:02:14 -0400] Otterley: after making the changes, can you connect to port 443 with "openssl s_client -connect <host>:443" ?  does it present the correct certificate?
[2013-06-14 20:02:15 -0400] btm: @opscode cookbook code view, join: https://plus.google.com/hangouts/_/f4845683897fdc0e280ec3ebf7522cafbcf9340c, watch: http://youtu.be/_mMwPsz1ccg
[2013-06-14 20:03:18 -0400] organicveggie: @Otterley: Well, that's the weird thing. I can't even connect after making the changes. Connection refused.
[2013-06-14 20:03:31 -0400] organicveggie: But it looks like nginx is running.
[2013-06-14 20:03:41 -0400] coderanger: organicveggie: Check the log
[2013-06-14 20:03:47 -0400] coderanger: runit might just be restart-spamming it
[2013-06-14 20:04:06 -0400] organicveggie: @coderange: the only log getting populated is the access.log. error.log and current are both empty. :(
[2013-06-14 20:04:09 -0400] coderanger: Non-zero chance of something like "can't read key" or "malformed key" in the log and it is just dying on startup
[2013-06-14 20:04:20 -0400] coderanger: organicveggie: Which log are you looking at?
[2013-06-14 20:04:39 -0400] coderanger: Check the runit log, not nginx's log :)
[2013-06-14 20:04:49 -0400] Otterley: hmm, he said current is empty
[2013-06-14 20:05:03 -0400] organicveggie: I'm looking at the logs in /var/log/chef-server/nginx
[2013-06-14 20:05:11 -0400] Otterley: that is the right place ...
[2013-06-14 20:05:17 -0400] organicveggie: access.log, current, error.log, lock and rewrite-port-80.log
[2013-06-14 20:05:22 -0400] organicveggie: Only access.log is non-zero.
[2013-06-14 20:05:28 -0400] coderanger: You can also grab the runit script and just try running it by hand
[2013-06-14 20:05:42 -0400] Otterley: that's puzzling - even error.log should have something in it in a normal start
[2013-06-14 20:05:59 -0400] organicveggie: @coderanger: awesome. could you point me at the runit script? i've never gotten around to joining the runit bandwagon. :)
[2013-06-14 20:06:38 -0400] coderanger: organicveggie: try something like /opt/chef-server/embedded/service/nginx/run
[2013-06-14 20:06:53 -0400] coderanger: Or some close permutation on that
[2013-06-14 20:07:20 -0400] coderanger: That should just be a hash script you can either run directly or copy-pasta to a shell
[2013-06-14 20:07:23 -0400] organicveggie: I think it's /opt/chef-server/service/nginx/run. Lemme try that.
[2013-06-14 20:07:37 -0400] coderanger: That sounds believable
[2013-06-14 20:08:11 -0400] organicveggie: Ahhh. Prompting for the PEM passphrase.
[2013-06-14 20:08:14 -0400] organicveggie: Dang it.
[2013-06-14 20:08:21 -0400] coderanger: :-)
[2013-06-14 20:08:49 -0400] organicveggie: Well. Why the heck did I put a passphrase on the key? What on earth was I thinking? :)
[2013-06-14 20:09:00 -0400] coderanger: Sekuritee
[2013-06-14 20:09:14 -0400] organicveggie: I suppose that means I need to generate a new key *without* a passphrase and re-key the certificate?
[2013-06-14 20:11:12 -0400] coderanger: No, you can strip it
[2013-06-14 20:11:19 -0400] coderanger: Lets see if I can find the openssl voodoo
[2013-06-14 20:11:25 -0400] organicveggie: @coderange: I can google it. no worries.
[2013-06-14 20:11:44 -0400] coderanger: probably something like openssl x509 -in old.pem -out new.pem
[2013-06-14 20:12:37 -0400] coderanger: I was close, openssl rsa -in ...
[2013-06-14 20:13:16 -0400] organicveggie: Now I just have to remember/find the passphrase :)
[2013-06-14 20:13:29 -0400] Otterley: it's the key that is encrypted, not the cert
[2013-06-14 20:13:37 -0400] coderanger: That part I can't help with :)
[2013-06-14 20:14:02 -0400] Otterley: openssl rya -in <in> -out <outfile>
[2013-06-14 20:14:07 -0400] Otterley: s/rya/rsa/
[2013-06-14 20:14:30 -0400] Otterley: see the first paragraph under EXAMPLES in rsa(1ssl)
[2013-06-14 20:16:41 -0400] organicveggie: WOOO WOOO!!!
[2013-06-14 20:16:48 -0400] organicveggie: Thanks folks. That worked like a champ. Much obliged.
[2013-06-14 20:19:23 -0400] Otterley: I'd file a bug about the logs not appearing, though
[2013-06-14 20:19:29 -0400] Otterley: that's obviously not desirable behavior
[2013-06-14 20:19:48 -0400] organicveggie: @Otterley: where's the best place to file a bug? GitHub? Or ?
[2013-06-14 20:19:58 -0400] Otterley: tickets.opscode.com
[2013-06-14 20:20:03 -0400] organicveggie: great.
[2013-06-14 20:20:53 -0400] coderanger: Otterley: I don't think we can fix that
[2013-06-14 20:21:00 -0400] coderanger: if nginx was halting during startup
[2013-06-14 20:21:04 -0400] AskSteve: Can a role execute a search to populate variables?
[2013-06-14 20:21:16 -0400] Otterley: coderanger, surely that's gotta show up in the runit log
[2013-06-14 20:21:17 -0400] coderanger: unless there is a "--never-ask-for-passphrase" option or something
[2013-06-14 20:21:27 -0400] coderanger: Otterley: No, runit just logs stdout/stderr
[2013-06-14 20:21:33 -0400] organicveggie: @coderange seems like we could have at least output the error that nginx was throwing...
[2013-06-14 20:21:37 -0400] Otterley: oh, it is being sent to a nonexistent TTY?
[2013-06-14 20:21:46 -0400] coderanger: Probably, password prompts usually are
[2013-06-14 20:21:56 -0400] Otterley: oh, yeah, not much to be done about that then :(
[2013-06-14 20:22:07 -0400] organicveggie: Ahhh. Good point.
[2013-06-14 20:22:34 -0400] coderanger: Most things have a --no-input mode though
[2013-06-14 20:22:36 -0400] Otterley: that sounds like a bug in nginx then
[2013-06-14 20:22:39 -0400] coderanger: which we should pass if possible
[2013-06-14 20:22:54 -0400] coderanger: No idea if nginx does though
[2013-06-14 20:25:19 -0400] coderanger: Yeah, if nginx has an option to do this I'm not seeing it
[2013-06-14 20:25:49 -0400] coderanger: It really should detect that stdin isn't a tty and fatal error though :(
[2013-06-14 20:35:04 -0400] Otterley: organicveggie, which version of nginx?
[2013-06-14 20:35:23 -0400] organicveggie: Not sure. What ever ships in the latest omnibus for Chef-Server 11.0.8.
[2013-06-14 20:36:06 -0400] organicveggie: is there an easy way for me to check that?
[2013-06-14 20:36:26 -0400] Otterley: 1.2.3
[2013-06-14 20:36:32 -0400] Otterley:  /opt/chef-server/embedded/sbin/nginx  -v
[2013-06-14 20:36:58 -0400] coderanger: You can also always check the versions text file
[2013-06-14 20:37:19 -0400] coderanger: that should have the build versions for everything in that omnibus project
[2013-06-14 20:38:10 -0400] zackf: Hey @kallistec, looks like i got it working.
[2013-06-14 20:38:13 -0400] zackf: Thanks again
[2013-06-14 20:38:36 -0400] kallistec: zackf: nice!
[2013-06-14 21:42:59 -0400] techminer: template question - cookbook A has an rsyslog template.I include cookbook A in cookbook B.and want the rsyslog template to be different there.  Can I use the "Location Specificity" feature even though it's in two different cookbooks?  Or does that only work if all the templates are in the same cookbook?
[2013-06-14 21:43:19 -0400] techminer: http://docs.opscode.com/essentials_cookbook_templates.html#location-specificity
[2013-06-14 21:43:29 -0400] coderanger: techminer: unrelated
[2013-06-14 21:43:44 -0400] coderanger: thats for different versions of the file on different types of servers (OS, hostname)
[2013-06-14 21:44:21 -0400] techminer: coderanger:  I want to override the template in the default rsyslog community cookbook, but only on one host.
[2013-06-14 21:45:07 -0400] coderanger: techminer: Use chef-rewind
[2013-06-14 21:45:10 -0400] bean__: i'd use rewind and a wrapper cookbook, techminer
[2013-06-14 21:45:12 -0400] bean__: ^
[2013-06-14 21:45:52 -0400] techminer: I need to add a couple lines to one of the templates in that rsyslog cookbook.  I'm using a wrapper cookbook and including the rsyslog cookbook recipes in my wrapper.  I'll loot at the chef-rewind stuff...
[2013-06-14 21:46:01 -0400] techminer: look
[2013-06-14 21:47:47 -0400] techminer: This?  https://github.com/bryanwb/chef-rewind
[2013-06-14 21:47:54 -0400] coderanger: Yahr
[2013-06-14 21:49:16 -0400] techminer: interesting.thanks!
[2013-06-14 21:53:03 -0400] Otterley: techminer, also consider syslog-ng if you haven't already.  we're big fans
[2013-06-14 21:55:16 -0400] gkra: looking at chef-rewind if I include a Gemfile in my policy cookbook, those gems will be magically installed on the nodes when the cookbook is run?
[2013-06-14 21:56:09 -0400] coderanger: gkra: No, unrelated
[2013-06-14 21:56:13 -0400] gkra: 'k
[2013-06-14 21:56:35 -0400] techminer: gkra:  that would be my guess.if by "policy" cookbook.you mean the base cookbook that is applied to all nodes
[2013-06-14 21:56:42 -0400] coderanger: gkra: That gemfile is for dev/testing on rewind itself
[2013-06-14 21:56:47 -0400] gkra: 'cause I've got a case where I want to use the sudo cookbook to install/manage the sudo package, but I want to completely replace the template....
[2013-06-14 21:57:24 -0400] gkra: and if I depend/include_recipe, won't the sudo cookbook template be installed, and then mine would overwrite it?
[2013-06-14 21:57:52 -0400] coderanger: gkra: chef recipes are a two-pass system
[2013-06-14 21:58:07 -0400] coderanger: So first all resources are compiled, and then all resources are executes
[2013-06-14 21:58:11 -0400] coderanger: er, executed
[2013-06-14 21:58:28 -0400] coderanger: rewind happens during compile phase, just altering paramters on existing resources
[2013-06-14 21:59:22 -0400] gkra: hmm.
[2013-06-14 21:59:33 -0400] gkra: oh, hey, sudo cookbook updated a lot since I looked at it last...
[2013-06-14 22:00:29 -0400] gkra: I'll need to come back to this other fires burning right now. :(
[2013-06-14 22:03:53 -0400] sn0wb1rdz: Chefs: Do I always have to specify the "-E" flag for the environments when I run the chef-client for the first time?
[2013-06-14 22:04:26 -0400] sn0wb1rdz: I have the "chef_environment" specified in the runlist.json file though
[2013-06-14 22:05:18 -0400] coderanger: sn0wb1rdz: The command line is just an override for the node data, either via JSON or from the chef-server
[2013-06-14 22:08:45 -0400] sn0wb1rdz: Will the node have any data even though I run for the first time?
[2013-06-14 22:15:58 -0400] coderanger: sn0wb1rdz: Is this with solo or chef-client?
[2013-06-14 22:16:04 -0400] sn0wb1rdz: chef-client
[2013-06-14 22:16:58 -0400] coderanger: then it will be blank to start with, if you are using knife bootstrap or any of the cloud plugins that use bootstrap internally, it takes care of setting up the initial data though
[2013-06-14 22:17:46 -0400] sn0wb1rdz: coderanger: ah. I see..
[2013-06-14 22:19:17 -0400] sn0wb1rdz: thanks!
[2013-06-14 22:28:10 -0400] Otterley: when's the next cookbook feature PR review?
[2013-06-14 22:34:08 -0400] polo: Can one echo output using the bash provider?
[2013-06-14 22:34:26 -0400] polo: I am trying to run "chef-client" but the bash code does not show any output.
[2013-06-14 22:34:34 -0400] polo: I do a simple echo "hello"
[2013-06-14 22:35:32 -0400] Otterley: Try Chef::Log.info
[2013-06-14 22:35:58 -0400] coderanger: polo: The output from subprocs is not normally shown
[2013-06-14 22:36:04 -0400] coderanger: polo: Use -l debug to see it
[2013-06-14 22:38:03 -0400] polo: @coderanger: use -l debug like: chef-client -l debug, but no output is generated - meaning my echo does not show up
[2013-06-14 22:38:25 -0400] coderanger: polo: Do you see your resource running?
[2013-06-14 22:39:02 -0400] polo: @coderanger: yes, but I am going to update it to make it write a file to ensure it does run, there are no conditions
[2013-06-14 22:39:08 -0400] polo: I see the recipe is invoked
[2013-06-14 22:39:39 -0400] coderanger: polo: Can you pastebin your recipe code?
[2013-06-14 22:41:57 -0400] polo: @coderanger: btw the output to a file gets created, so it does execute the code, but no output http://pastebin.com/P0yH2ucE
[2013-06-14 22:42:33 -0400] coderanger: and what is the output of chef-client -l debug?
[2013-06-14 22:43:45 -0400] polo: @coderanger: sorry - my 'dfue' - wrong grep
[2013-06-14 22:44:35 -0400] polo: @coderanger: working fine - but still, then no other way but to use -l debug?  How about outside the code - any way I can print stuff?
[2013-06-14 22:45:35 -0400] coderanger: polo: From recipe code you can either the log resource or Chef::Log.info
[2013-06-14 22:45:50 -0400] coderanger: They behave slightly differently, but both will get stuff to the screen
[2013-06-14 22:46:15 -0400] polo: @coderanger - thank you - that's what I needed.
[2013-06-14 23:33:18 -0400] webbower: Which cookbook would people recommend for yum-based Linux systems? yum or yumrepo?
[2013-06-14 23:34:32 -0400] webbower: They both seem to have little exposure
[2013-06-14 23:34:42 -0400] webbower: chip- ?
[2013-06-14 23:35:34 -0400] coderanger: They do different, though slightly overlapping things
[2013-06-14 23:35:46 -0400] coderanger: yum cookbook's main thrust is configuring yum
[2013-06-14 23:36:06 -0400] coderanger: It does have an LWRP for managing extra repos though
[2013-06-14 23:36:35 -0400] coderanger: yumrepo depends on the yum cookbook and adds some extra helpers
[2013-06-14 23:36:46 -0400] coderanger: A few common repos, etc
[2013-06-14 23:36:56 -0400] coderanger: Not much to it unless you need one of those
[2013-06-14 23:41:02 -0400] webbower: cool, thanks
[2013-06-14 23:58:40 -0400] mveitas: What is the best practice for configuring attributes that do not have a reasonable default? Example might be an API key used to connect to a service that is needed for the recipe to run sucessfully
