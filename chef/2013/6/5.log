[2013-06-05 00:02:18 -0400] ssd7: Ohai Chefs
[2013-06-05 00:03:03 -0400] spheromak: evening ssd7
[2013-06-05 00:03:38 -0400] Otterley: is it possible to make knife bootstrap look somewhere other than /etc/chef for a validation key?
[2013-06-05 00:03:58 -0400] spheromak: otterley it will look first in ./chef/
[2013-06-05 00:04:02 -0400] spheromak: then in ~/.chef/
[2013-06-05 00:04:04 -0400] Otterley: doesn't appear to be
[2013-06-05 00:04:10 -0400] spheromak: then in /etc/chef
[2013-06-05 00:04:13 -0400] spheromak: it uses the knife.rb
[2013-06-05 00:04:23 -0400] spheromak: in those locations to know where the validation key is
[2013-06-05 00:04:34 -0400] Otterley: ah, thanks
[2013-06-05 00:04:52 -0400] Otterley: had the wrong value in my config
[2013-06-05 00:05:01 -0400] spheromak: sweet
[2013-06-05 00:05:05 -0400] spheromak: somenes problem is fixed :D
[2013-06-05 00:05:20 -0400] spheromak: *someones
[2013-06-05 00:05:53 -0400] spheromak: jtimberman,  I didn't have time this weekend for getting back at that OpenSSL provider stuffs. Possibly latter this week
[2013-06-05 00:05:53 -0400] Otterley: also, do you know whether bootstrap ever honors a pre-existing run list for a node, if it's already configured on the server?
[2013-06-05 00:06:09 -0400] Otterley: it seems like bootstrap always tries to "help" me by setting it to the empty list
[2013-06-05 00:06:30 -0400] Otterley: then overwriting the node definition on my server :(
[2013-06-05 00:06:35 -0400] spheromak: yea its gonna generate a  .json that it includes which has the run list
[2013-06-05 00:06:42 -0400] spheromak: only way round that I think is with a custom template
[2013-06-05 00:06:52 -0400] spheromak: or specifying the run_list on the bootstrap with -r
[2013-06-05 00:07:08 -0400] Otterley: if it's already configured on the server, shouldn't it be honored?
[2013-06-05 00:07:11 -0400] spheromak: bootsstrap assumes you are setting up a new node
[2013-06-05 00:07:21 -0400] Otterley: I *am* setting up a new node.
[2013-06-05 00:07:32 -0400] spheromak: i mean a new to the server and everything node
[2013-06-05 00:08:06 -0400] Otterley: I'll file a bug; this behavior is stupid
[2013-06-05 00:08:07 -0400] spheromak: https://github.com/opscode/chef/tree/master/lib/chef/knife/bootstrap
[2013-06-05 00:08:09 -0400] spheromak: for the templates
[2013-06-05 00:08:55 -0400] spheromak: take that and remove the first_boot  stuff
[2013-06-05 00:09:05 -0400] spheromak: drop it in ~/.chef/ or ./chef
[2013-06-05 00:09:15 -0400] spheromak: and you can spec the template with -d or -T  (iirc)
[2013-06-05 00:09:29 -0400] spheromak: and use your own template to bootstrap with
[2013-06-05 00:09:29 -0400] segv: -d 'namehere'
[2013-06-05 00:09:45 -0400] segv: spheromak: actually drop it in ~/.chef/bootstrap ;)
[2013-06-05 00:09:51 -0400] spheromak: yea or -T full path
[2013-06-05 00:09:52 -0400] spheromak: thats right
[2013-06-05 00:09:57 -0400] spheromak: segv,  :)
[2013-06-05 00:10:04 -0400] Otterley: I don't need a template.  I already have the node configured on my Chef server.
[2013-06-05 00:10:16 -0400] spheromak: no these are the bootstrap templates
[2013-06-05 00:10:26 -0400] segv: bootstrapping != configuring a node in chef.
[2013-06-05 00:10:26 -0400] spheromak: by default knife bootstrap  will use chef_full
[2013-06-05 00:10:45 -0400] spheromak: bootstrap == gett the client on this node and setup its first run (register it with server) etc etc
[2013-06-05 00:10:48 -0400] segv: Yeah, it will call for whatever the bootstrap is, register the node with chef with no run_list or anything
[2013-06-05 00:10:59 -0400] segv: unless you specify it that is
[2013-06-05 00:11:08 -0400] Otterley: I don't want it to touch the node definition on the server.
[2013-06-05 00:11:19 -0400] Otterley: the server should be authoritative
[2013-06-05 00:11:20 -0400] segv: It always will.
[2013-06-05 00:11:32 -0400] spheromak: so if you ahve another process creating your nodes,  you can spec your own bootstrap template that will not populate the first_boot.json
[2013-06-05 00:11:49 -0400] segv: Node information is always generated, modified or inherited via recipes/cookbooks and environments/roles.
[2013-06-05 00:12:04 -0400] spheromak: well I think he doesn't want the existing node info wiped on bootstrap
[2013-06-05 00:12:09 -0400] Otterley: segv, sure, I get that, but I meant the run list and non-automatic attributes
[2013-06-05 00:12:12 -0400] spheromak: which means he needs to make a blank first_boot.json
[2013-06-05 00:12:18 -0400] segv: oh well dump it first before you do the run :D
[2013-06-05 00:12:18 -0400] spheromak: in his custom bootstrap
[2013-06-05 00:12:37 -0400] spheromak: so he could remove the start_chef and the first_boot bitts from the bootstrap template
[2013-06-05 00:12:43 -0400] spheromak: and just setup the validator and do chef-client
[2013-06-05 00:12:49 -0400] segv: I just knife node show blahnodename -Fj > nodename.json
[2013-06-05 00:13:05 -0400] segv: you can then bootstrap it, reimport that from file and run chef-client
[2013-06-05 00:13:13 -0400] spheromak: yeap that works :D
[2013-06-05 00:13:23 -0400] spheromak: and then toss it back up after you rebuild
[2013-06-05 00:13:26 -0400] Otterley: segv, I agree that it works, but it's Wrong.
[2013-06-05 00:13:30 -0400] spheromak: I just wipe the wole thing out and add -r
[2013-06-05 00:13:35 -0400] spheromak: thats your opinion
[2013-06-05 00:13:43 -0400] segv: spheromak: yeah that works too
[2013-06-05 00:13:44 -0400] spheromak: I want it to work the way it works (thats my opinion)
[2013-06-05 00:13:50 -0400] Otterley: it is a correct opinion, borne of years and years of experience.
[2013-06-05 00:13:51 -0400] segv: Otterley: with chef there are many ways to skin a cat :P
[2013-06-05 00:14:04 -0400] spheromak: Otterley, you can get the behavior you want with a custom bootstrap template
[2013-06-05 00:14:36 -0400] spheromak: and that is all of deleting 4 lines in chef_full and adding one :)
[2013-06-05 00:14:41 -0400] segv: yep
[2013-06-05 00:14:45 -0400] Otterley: yes, but that doesn't scale to my whole team.
[2013-06-05 00:14:54 -0400] spheromak: it does cause you can put it in your repo
[2013-06-05 00:14:58 -0400] segv: yeah
[2013-06-05 00:15:06 -0400] spheromak: in repo/.chef/bootstrap/
[2013-06-05 00:15:08 -0400] Otterley: you don't need a repo to run knife.
[2013-06-05 00:15:26 -0400] segv: I have a "dotchef" directory in git so everyone of my team mates shares the same config options, paths etc.
[2013-06-05 00:15:33 -0400] Otterley: and you can't put personal details in a shared repo.
[2013-06-05 00:15:35 -0400] segv: ANd until that is checked out they don't get chef access :)
[2013-06-05 00:15:36 -0400] spheromak: theres way around it.
[2013-06-05 00:15:45 -0400] segv: Otterley: you don't put the pems in there.
[2013-06-05 00:15:52 -0400] spheromak: I think nmore people preferre that bootstrap can take a node from nothing -> runlist specified on teh commandline
[2013-06-05 00:15:54 -0400] segv: you send out a blank file with "place files here"
[2013-06-05 00:16:03 -0400] spheromak: than having to generate a node json and upload that to server then bootstrap
[2013-06-05 00:16:08 -0400] spheromak: to me that is totally wrong
[2013-06-05 00:16:08 -0400] segv: spheromak: yeah exactly
[2013-06-05 00:16:08 -0400] Otterley: spheromak, I don't disagree with that either.  you should have a choice.
[2013-06-05 00:16:13 -0400] spheromak:  you do
[2013-06-05 00:16:18 -0400] Otterley: what is wrong with it, spheromak?
[2013-06-05 00:16:21 -0400] spheromak: you can use a custom template
[2013-06-05 00:16:21 -0400] spheromak: :D
[2013-06-05 00:16:22 -0400] segv: spheromak: it's just jenky to do the node first, then bootstrap it afterwords
[2013-06-05 00:16:37 -0400] segv: makes for some hardships especially if some recipes have node.set flags in them that override your node attributes
[2013-06-05 00:16:38 -0400] spheromak: Otterley, by design you should be able to re-create that node without worry from the run_list
[2013-06-05 00:16:51 -0400] Otterley: the run_list is exactly what you need to recreate the node!!
[2013-06-05 00:17:00 -0400] Otterley: otherwise your node is a worthless bag of OS.
[2013-06-05 00:17:07 -0400] spheromak: and if you adopt that attitude about your boxes you will be better off.
[2013-06-05 00:17:11 -0400] segv: Otterley: yeah, you can specify that with knife w/out having to use the node attributes
[2013-06-05 00:17:12 -0400] spheromak: so all you need from bootstrap
[2013-06-05 00:17:14 -0400] spheromak: is the run_list
[2013-06-05 00:17:18 -0400] spheromak: and you are golden
[2013-06-05 00:17:24 -0400] spheromak: you don't need to create the node in the server first
[2013-06-05 00:17:28 -0400] spheromak: thats what bootstrap -r is for
[2013-06-05 00:17:30 -0400] spheromak: :D
[2013-06-05 00:17:46 -0400] segv: yeah, bootstrap->creates node->modify node attributes->chef-client, golden
[2013-06-05 00:17:52 -0400] Otterley: why should I have to respecify what is already on the server?
[2013-06-05 00:18:06 -0400] Otterley: and why can't I have one person define the node and another one bootstrap it?
[2013-06-05 00:18:10 -0400] spheromak: I gotcha
[2013-06-05 00:18:15 -0400] spheromak: you wnat to recreaet that exact box
[2013-06-05 00:18:18 -0400] Otterley: YES
[2013-06-05 00:18:22 -0400] spheromak: but only the run_list/
[2013-06-05 00:18:27 -0400] spheromak: not the node data
[2013-06-05 00:18:34 -0400] Otterley: and its non-automatic attributes
[2013-06-05 00:18:35 -0400] spheromak: dunno seems prety simple to me to get what you want
[2013-06-05 00:18:39 -0400] segv: knife boostrap -r 'role[blah]'
[2013-06-05 00:18:42 -0400] segv: Create a role :\
[2013-06-05 00:18:55 -0400] segv: fill that role with your specified run_list and be on your marry way
[2013-06-05 00:19:01 -0400] Otterley: a run list of a node is often more than one role.
[2013-06-05 00:19:08 -0400] spheromak: knife node show -a run_list | awk | knife bootstrap    .. (psuedo code)
[2013-06-05 00:19:11 -0400] spheromak: UNIX
[2013-06-05 00:19:13 -0400] spheromak: rawr
[2013-06-05 00:19:24 -0400] segv: Otterley: you can specify more than one role with -r.
[2013-06-05 00:19:30 -0400] Otterley: I know that.
[2013-06-05 00:19:42 -0400] segv: -r 'role[one],role[two]' just do that and your life is easier than recreating the node every time
[2013-06-05 00:19:43 -0400] Otterley: but I shouldn't have to know what that is if the server already does!
[2013-06-05 00:19:45 -0400] spheromak: i mean by all means submit a patch :D
[2013-06-05 00:20:08 -0400] spheromak: if you want bootstrap to check for a client and node first and then do some other stuff .. It's totally doable
[2013-06-05 00:20:28 -0400] segv: you're just going to hand that off to your respective team mates as well.
[2013-06-05 00:20:37 -0400] segv: If you do it that way
[2013-06-05 00:20:52 -0400] Otterley: there is no reason why the first run of Chef should be any different than the second run, in terms of its run_list
[2013-06-05 00:21:08 -0400] spheromak: well
[2013-06-05 00:21:11 -0400] spheromak: the point is
[2013-06-05 00:21:12 -0400] segv: Otterley: are you manually creating the nodes AND the clients?
[2013-06-05 00:21:21 -0400] spheromak: the Base assumption with knife-bootstrap
[2013-06-05 00:21:23 -0400] Otterley: segv, the nodes, yes.  the clients, no.
[2013-06-05 00:21:27 -0400] segv: why?
[2013-06-05 00:21:28 -0400] spheromak: is your building a box that sserver doens't know about
[2013-06-05 00:21:31 -0400] spheromak: If you wnat to re-create it
[2013-06-05 00:21:39 -0400] spheromak: go grab the client.rb and client.pem
[2013-06-05 00:21:41 -0400] spheromak: and restor it
[2013-06-05 00:21:51 -0400] Otterley: segv, because it's the most efficient method to deploy hundreds of hosts
[2013-06-05 00:21:52 -0400] spheromak: and then you ahve the same state on server and same client on the box
[2013-06-05 00:21:58 -0400] segv: Otterley: not really haha
[2013-06-05 00:22:08 -0400] Otterley: segv, prove otherwise
[2013-06-05 00:22:08 -0400] segv: Otterley: I can deploy 300 hosts in one second w/out creating nodes AT ALL.
[2013-06-05 00:22:18 -0400] segv: bootstrap DOES IT for you.
[2013-06-05 00:22:21 -0400] spheromak: ^^
[2013-06-05 00:22:27 -0400] Otterley: segv, sure you can, but it won't be consistent with your source control.
[2013-06-05 00:22:31 -0400] spheromak: um
[2013-06-05 00:22:36 -0400] spheromak: sure it will
[2013-06-05 00:22:37 -0400] segv: when you pass that -r 'role[blah]' IT stores it in the node attributes dude
[2013-06-05 00:22:38 -0400] segv: haha
[2013-06-05 00:22:43 -0400] spheromak: you just add a &&  show
[2013-06-05 00:22:52 -0400] spheromak: but really I give no shits about the node data. its ephemeral
[2013-06-05 00:22:55 -0400] spheromak: I keep the run list
[2013-06-05 00:23:08 -0400] Otterley: if you want your source control to be authoritative, you always update the server from your source repo.
[2013-06-05 00:23:20 -0400] segv: for i in `cat list_of_servers`;do knife bootstrap $i -r 'bunchofcrazyrolesrecipesandstuff';done
[2013-06-05 00:23:21 -0400] spheromak: but you're assuming that node data is code
[2013-06-05 00:23:23 -0400] segv: that's it.
[2013-06-05 00:23:23 -0400] spheromak: which it is not
[2013-06-05 00:23:24 -0400] spheromak: its data
[2013-06-05 00:23:38 -0400] spheromak: its like storing a sql table in source control
[2013-06-05 00:23:39 -0400] Otterley: spheromak, that's a red herring
[2013-06-05 00:23:53 -0400] segv: spheromak: or using zookeeper as a sql service haha
[2013-06-05 00:23:57 -0400] Otterley: the stuff in source control is static state which must never change
[2013-06-05 00:24:05 -0400] spheromak: then store the run list in source controll
[2013-06-05 00:24:07 -0400] Otterley: that includes the run list and many attributes
[2013-06-05 00:24:11 -0400] segv: Otterley: node attributes change on there oiwn everytime you run chef
[2013-06-05 00:24:25 -0400] segv: Otterley: recipes can modify the node itself.
[2013-06-05 00:24:28 -0400] Otterley: segv, dynamic state attributes do, but we don't keep those in source control, nor in the node object
[2013-06-05 00:24:42 -0400] Otterley: rather, in the JSON representation of it in source control
[2013-06-05 00:24:54 -0400] spheromak: so you can easily bootstrap && knife node from file  foo.json
[2013-06-05 00:24:57 -0400] spheromak: and be done with it all
[2013-06-05 00:25:00 -0400] spheromak: cause its in source controll
[2013-06-05 00:25:02 -0400] segv: you're making this extremely difficult for yourself
[2013-06-05 00:25:04 -0400] spheromak: problem solved moving on
[2013-06-05 00:25:11 -0400] Otterley: our method is to load the cookbooks, roles and nodes from source control, then bootstrap
[2013-06-05 00:25:20 -0400] segv: Step 1) Bootstrap all the nodes you need 2) Dump all their node attributes, 3) store that in source control.
[2013-06-05 00:25:23 -0400] segv: Done.
[2013-06-05 00:25:24 -0400] spheromak: if you  bootstrap with a null run_list then load
[2013-06-05 00:25:31 -0400] spheromak: you will be right where you want to be
[2013-06-05 00:25:34 -0400] Otterley: I think we'll just have to agree to disagree.
[2013-06-05 00:26:01 -0400] segv: Otterley: if it obviously isn't working for you now, then how can you disagree?
[2013-06-05 00:26:02 -0400] segv: lol
[2013-06-05 00:26:13 -0400] spheromak: hey man im not gonna dogg your decisions. they are your s (re process) just trying to help :D (and ignoring work i should be doing)
[2013-06-05 00:26:22 -0400] Otterley: the only thing that's not working is that I have to do an extra step.
[2013-06-05 00:26:26 -0400] segv: yeah, we're trying to help you go the standard path of chef.
[2013-06-05 00:26:38 -0400] segv: Not some cockeyed opinion.
[2013-06-05 00:26:43 -0400] spheromak: I do agree that its a bit extreem but
[2013-06-05 00:26:55 -0400] spheromak: Otterley,  i.e.  &&
[2013-06-05 00:26:57 -0400] spheromak: zoiks
[2013-06-05 00:27:01 -0400] segv: spheromak: yeah
[2013-06-05 00:27:02 -0400] Otterley: and that step is necessitated by bootstrap not honoring a pre-existing node object and run_list that's already on the server.
[2013-06-05 00:27:14 -0400] spheromak: Otterley, you can write your own tool for it that wraps bootstrap and upload
[2013-06-05 00:27:20 -0400] spheromak: and put it in a Gemfile
[2013-06-05 00:27:20 -0400] Otterley: I know I can.
[2013-06-05 00:27:21 -0400] segv: Otterley: Because knife is not designed to do it the way you are, like we were stating
[2013-06-05 00:27:26 -0400] spheromak: There are lots of ways to skin it.
[2013-06-05 00:27:38 -0400] Otterley: you both are begging the question.  I give up.
[2013-06-05 00:28:00 -0400] segv: That's not begging the question, we were explaining how it worked, that was all..
[2013-06-05 00:28:08 -0400] spheromak: You coming here and saying your outlier of a process is how the default should be I don't think is the right aproach.  If you want to mod knife-bootstrap to support your workflow with an argument I don't think anyone will complain about a pull request :D
[2013-06-05 00:28:14 -0400] Otterley: segv, http://en.wikipedia.org/wiki/Begging_the_question
[2013-06-05 00:28:43 -0400] segv: So the standard way of chef is a "falacy" in your eyes?
[2013-06-05 00:29:04 -0400] Otterley: no, I'm saying that "nobody does it this way because knife doesn't work that way" is not a valid argument.
[2013-06-05 00:29:20 -0400] segv: It's not an argument at all haha
[2013-06-05 00:29:20 -0400] spheromak: nah I think no one does it like that cause you shouldn't have ot
[2013-06-05 00:29:23 -0400] spheromak: *have too
[2013-06-05 00:29:28 -0400] segv: yeah, it's more work on your behalf
[2013-06-05 00:29:29 -0400] spheromak: and mostly people don't
[2013-06-05 00:29:41 -0400] segv: That's not an arguement it's just a fact :\
[2013-06-05 00:29:59 -0400] segv: But however you want to view it and do the task you are trying to do, be my guest.
[2013-06-05 00:30:09 -0400] spheromak: maybe you are the 2nd person I've heard of that stores all nodes in version controll.  (*and i've been here for a long while)
[2013-06-05 00:30:16 -0400] Otterley: I don't think it's more work.  It saves me work if I can take a node json I've already defined for data center, copy it to another node json, make a few changes, bootstrap it, and have it immediately come up.
[2013-06-05 00:30:21 -0400] segv: I only store them in VCS *after* I've bootstrapped them.
[2013-06-05 00:30:24 -0400] spheromak: not judging it. just saying its not common
[2013-06-05 00:31:07 -0400] spheromak: Otterley, well also i think your being way to static :) and adding a heap of work for very little gain, but thats another topic.  Like I said you got your reasons for your process.
[2013-06-05 00:31:14 -0400] segv: Otterley: your process is solved with bootstrap a bootstrap file, like spheromak was suggesting earlier, all that work your doing is 100% repeatable with a bootstrap file.
[2013-06-05 00:31:40 -0400] spheromak: anyhow
[2013-06-05 00:31:40 -0400] segv: and you can hand it off to anyone on your team
[2013-06-05 00:31:43 -0400] Otterley: my process would similarly be solved if the first run just contacted the server without overriding the run_list.
[2013-06-05 00:31:56 -0400] segv: spheromak: roger
[2013-06-05 00:31:59 -0400] spheromak: Otterley, and i say submit a patch that adds the option to bootstrap
[2013-06-05 00:31:59 -0400] spheromak: :D
[2013-06-05 00:32:24 -0400] Otterley: as for static, I'm working in a different environment than many of you.  we're not on EC2.
[2013-06-05 00:32:33 -0400] spheromak: Im not on ec2
[2013-06-05 00:32:34 -0400] segv: I'm not on EC2 *at all*.
[2013-06-05 00:32:38 -0400] segv: or an VM's.
[2013-06-05 00:32:41 -0400] segv: I am a baremetal env.
[2013-06-05 00:32:44 -0400] spheromak: I build  infra as a service :D
[2013-06-05 00:32:49 -0400] segv: spheromak: same haha
[2013-06-05 00:33:08 -0400] segv: from a dry as metal iLO->running service and install in less than 10 minutes per physical machine.
[2013-06-05 00:33:12 -0400] segv: Gotta love pxe and knife <3
[2013-06-05 00:33:22 -0400] spheromak: using razor these days
[2013-06-05 00:33:29 -0400] segv: Ah nice, haven't tried razor
[2013-06-05 00:33:29 -0400] Otterley: agreed, I think only our procedural stance is different
[2013-06-05 00:33:46 -0400] spheromak: segv, I would do it another way (was working on another way), but its the best thing out there right now.
[2013-06-05 00:33:53 -0400] segv: spheromak: cool
[2013-06-05 00:34:12 -0400] segv: at this point all I need is a mac address and what said device will be doing to pxe boot/run chef with a node name based off pxe.
[2013-06-05 00:34:29 -0400] segv: PXE goes OH SWEET I HAVE AN UBUNTU INSTALL
[2013-06-05 00:34:44 -0400] spheromak: segv, we have the hardware using LLDP to figure out vlan->interface topology and dropping that in the chef-server its pretty damn slick
[2013-06-05 00:35:10 -0400] segv: spheromak: ah, cool, we're a little lazier than that, each switch has it's own blocks of network ports that do N vlan and what not
[2013-06-05 00:35:13 -0400] spheromak: so we only require the cables be in the right switches from the DC guys
[2013-06-05 00:35:18 -0400] segv: Just plug it in and off you go.
[2013-06-05 00:35:30 -0400] spheromak: yea but we don't care which segment of the swithch -> which port of the box
[2013-06-05 00:35:36 -0400] spheromak: thats the sexy part :D
[2013-06-05 00:35:39 -0400] segv: ah, yeah, we do unfortunately
[2013-06-05 00:35:44 -0400] segv: even though we have nexus line equipment :(
[2013-06-05 00:35:51 -0400] spheromak: goal is to get that rack build time as fast as possible :D
[2013-06-05 00:36:18 -0400] segv: yeah, we don't need that much horse power ;)
[2013-06-05 00:36:22 -0400] spheromak: anyhow the razor enables that stuff .. which is pretty sweet
[2013-06-05 00:38:00 -0400] segv: hah, one of our vendors sent us a manual with comic sans as the font
[2013-06-05 00:38:15 -0400] segv: Oh the satire.
[2013-06-05 01:20:17 -0400] gansbrest: hi. Question - I'm using embedded chef-client with its own precompiled verison of ruby rubygems and etc. Now I install a handler gem using gem_package and it's installed into default ruby location (not to the embedded gems location). What's the bes way to deal with those kinds of problems
[2013-06-05 01:23:25 -0400] spheromak: chef_gem
[2013-06-05 01:23:33 -0400] spheromak: gansbrest,  ^^
[2013-06-05 01:24:00 -0400] gansbrest: ohh, chef_gem instead of gem_package to install into embedded location!
[2013-06-05 01:24:07 -0400] spheromak: :D
[2013-06-05 01:36:33 -0400] Otterley: chef_client appears to make a new HTTP connection every time it downloads a cookbook file.
[2013-06-05 01:37:31 -0400] bradbeam: any tips on the best way to restart a service only if it is running?  currently the restarts are initiated by a notifies block
[2013-06-05 01:49:36 -0400] scalp42: I'm no expert, but you could have the service resource do what you want
[2013-06-05 01:51:08 -0400] scalp42: bradbeam: you have access to the restart_command for example
[2013-06-05 01:51:16 -0400] scalp42: but I'm not expert again.
[2013-06-05 01:51:34 -0400] bradbeam: oh, maybe redefine it to do a status && restart or something like that?
[2013-06-05 01:52:30 -0400] scalp42: right hang on
[2013-06-05 01:53:09 -0400] bradbeam: i'll give it a run
[2013-06-05 01:54:04 -0400] scalp42: https://gist.github.com/scalp42/5711097 ?
[2013-06-05 01:54:23 -0400] scalp42: you see that restart_command, maybe grep for the service or something
[2013-06-05 01:54:23 -0400] Otterley: seems reasonable
[2013-06-05 01:54:34 -0400] scalp42: but I think what im saying might be totally wrong
[2013-06-05 01:55:47 -0400] bradbeam: i think its a solid train of thought
[2013-06-05 01:55:54 -0400] scalp42: but then they created all these service providers so we dont have to care about init, upstart or whatever else. so use with caution
[2013-06-05 01:59:39 -0400] Otterley: the other thing is, should this service be started or not?
[2013-06-05 01:59:55 -0400] scalp42: alright back to that SHA256 thingy :) ping me if I can help
[2013-06-05 02:00:08 -0400] Otterley: if it's not supposed to be started, then there's no point in declaring config files that would restart said service.
[2013-06-05 02:00:26 -0400] Otterley: therefore the restart notification should never occur
[2013-06-05 02:00:43 -0400] Otterley: if it is supposed to be started, then sending a restart should never be a problem
[2013-06-05 02:00:52 -0400] bradbeam: if i want to build out a server but wait until later to turn on the service is the condition
[2013-06-05 02:01:07 -0400] Otterley: I'd put that in an attribute then
[2013-06-05 02:01:09 -0400] bradbeam: if the service is already running, a restart is what i want
[2013-06-05 02:01:38 -0400] Otterley: predicate the resource creation on a boolean attribute
[2013-06-05 03:36:38 -0400] spheromak: define the service with action nothing, have some config file notify it to start. Make that notification be a delayed notification.
[2013-06-05 03:37:37 -0400] spheromak: bradbeam, ideally your service scrip handles restart, and then you simply say restart on your notification.
[2013-06-05 03:38:09 -0400] bradbeam: roger
[2013-06-05 05:10:43 -0400] ssd7: Ohai Chefs
[2013-06-05 07:50:43 -0400] admin0: hi all .. i am getting a Chef::Exceptions::CookbookNotFound  . but knife cookbook lists the cookbook
[2013-06-05 07:52:54 -0400] shay: hi when bootstrapping a node the following occures any ideas?
[2013-06-05 07:52:59 -0400] Guest64279: 10.60.251.184 /usr/lib/ruby/gems/1.8/gems/mixlib-log-1.3.0/lib/mixlib/log.rb:97:in `level=': Log level must be one of :debug, :info, :warn, :error, or :fatal (ArgumentError) 10.60.251.184   from /usr/lib/ruby/gems/1.8/gems/chef-0.10.6/bin/../lib/chef/application.rb:107:in `configure_logging' 10.60.251.184   from /usr/lib/ruby/gems/1.8/gems/chef-0.10.6/bin/../lib/chef/application/client.rb:201:in `configure_logging' 10.60.251.184   f
[2013-06-05 08:03:27 -0400] Cope: ohai
[2013-06-05 08:07:03 -0400] isbaran: admin0: add it to metadata.rb
[2013-06-05 08:08:56 -0400] admin0: isbaran, i fixed it .. i had a slight typo in the include
[2013-06-05 08:09:11 -0400] isbaran: anyone using nagios cookbook ?
[2013-06-05 08:09:55 -0400] isbaran: are you using data bag approach or modifying the cookbook for custom metrics
[2013-06-05 08:23:07 -0400] stormerider: chat
[2013-06-05 08:23:13 -0400] stormerider: gr. mt.
[2013-06-05 08:51:38 -0400] alex____: i have a little question is there a way to wait for a service to come online before going further
[2013-06-05 08:52:22 -0400] alex____: like i am enabling a service and my next command in chef tries to talk to that service how would i do that
[2013-06-05 08:54:15 -0400] isbaran: alex____: yes, http://docs.opscode.com/resource_common_compile.html
[2013-06-05 09:35:07 -0400] alex____: thanks
[2013-06-05 09:57:09 -0400] bubu: is there an 'only_when' a chef attribute?
[2013-06-05 09:57:54 -0400] bubu: need a cookbook to retry a block until it comes back ok, i.e. an infinite amount of time, not retries 999?
[2013-06-05 10:02:59 -0400] quattro_: i just installed chef-server on centos 6.4 x64, everything installed fine and I can start with chef-server-ctl start but nothing runs on port 4000
[2013-06-05 10:03:06 -0400] quattro_: it seems like only the webui is running
[2013-06-05 10:08:08 -0400] kreisys: quattro_: chef 11 works on port 443
[2013-06-05 10:08:28 -0400] bubu: netstat is your friend
[2013-06-05 10:10:26 -0400] quattro_: thanks
[2013-06-05 10:13:05 -0400] m4rcu5: i just installed a chef 11 server, and chanched some ssl settings in the chef-server.rb, but how to i force it to regenerate the ssl certs and include my info
[2013-06-05 10:20:45 -0400] isbaran:  m4rcu5 chef-server-ctl reconfigure i believe
[2013-06-05 10:32:12 -0400] UukGoblin: did you notice hosted chef servers act funny at certain times
[2013-06-05 10:32:22 -0400] UukGoblin: i.e. :00, :30, and similar?
[2013-06-05 10:40:08 -0400] Chandra: UukGoblin which version of chef you are using
[2013-06-05 10:44:40 -0400] UukGoblin: Chandra, 11.4.4 roughly
[2013-06-05 10:45:13 -0400] UukGoblin: my knife on localhost actually says 11.4.0, and it was hanging indefinitely when I ran 'knife status' near the :00 minute
[2013-06-05 10:45:49 -0400] UukGoblin: chef-client tends to retry connecting to api.opscode.com a lot if you run it at or near :00
[2013-06-05 10:45:58 -0400] UukGoblin: sometimes fails even after 5th retry
[2013-06-05 10:54:56 -0400] astlock: Ohai. Could someone help me to say what to do if https://github.com/laradji/zabbix  cookbook doesn't work? Create issue at github or mail authors?
[2013-06-05 11:21:52 -0400] yruss972: Hi- I'm having trouble with role attributes and bash resources. Since I moved something into the role's default attributes, the bash resource doesn't find the attributes
[2013-06-05 11:53:59 -0400] m4rcu5: isbaran: cant seem to be able to update the ssl certs by running chef-server-ctl reconfigure
[2013-06-05 13:12:49 -0400] HAPPYFUNBALL: LOL!
[2013-06-05 13:52:14 -0400] chris613: Inside a recipe is there an easy way to load a node object by name without using search(:node, "name:#{node-im-interested-in}") ? The search is a bit slow
[2013-06-05 14:07:06 -0400] ssd7: chris613: If you just need a single node and you know its name: other_node = Chef::Node.load("name") should do what you want.
[2013-06-05 14:15:20 -0400] chris613: ssd7: Thanks!
[2013-06-05 14:15:20 -0400] chris613: ssd7: Is there a partial_search equivalent for that? So that I can load just the three attributes I need instead of the whole massive node object?
[2013-06-05 14:16:09 -0400] ssd7: chris613: Unfortunately there is no way to stop the whole node from coming back from the API. You could only save the attributes you want client-side, but that is likely only to save you a bit of memory during the run.
[2013-06-05 14:18:05 -0400] chris613: ssd7: Okay thanks
[2013-06-05 14:23:13 -0400] shay: hi where does knife look for plugins? im using chef v11
[2013-06-05 14:50:13 -0400] adnichols: Guest45309 how was knife installed? via omnibus or gem install?
[2013-06-05 14:50:13 -0400] Guest45309: FATAL: Cannot find sub command for: 'backup restore clients nodes'
[2013-06-05 14:50:14 -0400] gansbrest:  hi. Is there a way to upgrade embeded chef gem using chef_gem and use it later in other recipes or handlers. It seems like upgrade does the job, I see updated gem in the folder, but it's available only for next chef-client run and I need it right after upgrade happened.
[2013-06-05 14:50:14 -0400] Guest45309: I installed using the newst rpm from opscode website
[2013-06-05 14:50:14 -0400] Guest45309: then I installed gem install knife-backup
[2013-06-05 14:50:14 -0400] Guest45309: this worked fine
[2013-06-05 14:50:14 -0400] adnichols: and I assume if you 'gem list' you see knife-backup listed?
[2013-06-05 14:50:15 -0400] Guest45309: yes and reinstall also does not help
[2013-06-05 14:51:21 -0400] adnichols: When I've run into this it's been an issue w/ the cwd - I haven't completely run it down yet
[2013-06-05 14:52:42 -0400] Guest45309: ok thanks anyway
[2013-06-05 15:15:41 -0400] dJustin: is there any way to speed up the connection to a chef server via a windows7 box?  Just to connect takes 40+ seconds
[2013-06-05 15:21:47 -0400] adnichols: Running into a 403 forbidden error about 25 minutes into the bootstrap of a new host, looks like the error happens when trying to access the bookshelf presumably to download a template file. If I re-run chef it'll complete just fine so I assume this is a problem related to the duration of the chef run on bootstrap. Have folks run into this and found a fix? http://pastebin.com/W42MMxFB chef-server 11.0.6 chef-client 11.4.0
[2013-06-05 15:23:45 -0400] adnichols: I did see CHEF-3045 and tried adjusting erchef['s3_url_ttl'] and it didn't help - we are not using s3 for our bookshelf
[2013-06-05 15:34:32 -0400] UukGoblin: Is there a way to find all nodes that use a given recipe? And let me clarify: including recipes that were included from other recipes with include_recipe?
[2013-06-05 16:07:32 -0400] cbarrafoz: i have a question about using omnibus to package an app, is this the best place to ask it?
[2013-06-05 16:11:04 -0400] trobrock: I am trying to execute some ruby code at convergence time and use that to set a variable that I want to use as a parameter to a lwrp in the same recipe, but I cannot figure out how to get the param passed since the provider is evaluated before convergence.
[2013-06-05 16:17:39 -0400] dJustin: I'm playing around with initiating multiple remote chef-client runs (knife winrm) via "knife exec"...so I only have to connect to the chef server once.  I have the query down, but is there any way to initiate the knife winrm without re-connecting to the server?
[2013-06-05 16:37:24 -0400] gabrtv: is there an API endpoint for creating an organization against a private chef installation?  can't find the docs for it
[2013-06-05 16:47:57 -0400] aspiers: please can someone review http://tickets.opscode.com/browse/OHAI-339 ? it's blocking us ...
[2013-06-05 16:48:50 -0400] timsmith: btm is your guy for ohai
[2013-06-05 16:48:56 -0400] aspiers: ah, wrong channel too
[2013-06-05 16:48:59 -0400] aspiers: timsmith: thanks!
[2013-06-05 17:07:11 -0400] desaila_: I'm new to chef, but not necessarily that new to sys admin type work, and am having a hard time making a user home directory in chef. I've outlined the problem at the top of this relatively small gist: https://gist.github.com/mylons/f817e2d544713435aa30
[2013-06-05 17:09:08 -0400] eponymi: How are the files test/features/support/* recognized by cucumber in MySQL cookbook? I don't see any require statements anywhere
[2013-06-05 17:39:39 -0400] trobrock: I am trying to lazily set the value of an sttribute on a lwrp, how can this be done?
[2013-06-05 17:40:29 -0400] eponymi: trobrock: when are you trying to do it, and what are you using to do it?
[2013-06-05 17:42:12 -0400] trobrock: eponymi: what I am trying to do is pass a value that is gathered at converge time to a lwrp, so at converge time retreive some information about the system and pass that info as the value to an attribute to another lwrp
[2013-06-05 17:42:15 -0400] timsmith: are there any plans for an omnibus release for freebsd?
[2013-06-05 17:42:53 -0400] eponymi: trobrock: is that value available via node attribute...
[2013-06-05 17:44:37 -0400] trobrock: not until this block runs the first time... h/o ill create a gist of what im attempting
[2013-06-05 17:45:28 -0400] dJustin: how would I update an attribute on an environment via ruby in a "knife exec" command?  I have the search in the ruby find the environment: search(:environment, "name:#{Environment}") do |e|...just need to know the syntax for the attribute update...tried e.gsBuildToDeploy_Releas and e.set[gsBuildToDeploy_SubBuild]
[2013-06-05 17:45:52 -0400] trobrock: eponymi: https://gist.github.com/trobrock/5715767
[2013-06-05 17:46:03 -0400] trobrock: that should give an idea of what I am trying to do
[2013-06-05 17:48:06 -0400] eponymi: i don't know what run_state is. are you using chef 10? it looks like what i'd use run_context for
[2013-06-05 17:48:18 -0400] trobrock: Im on chef 11
[2013-06-05 17:48:47 -0400] trobrock: oh interesting didnt realized that was replaced
[2013-06-05 17:49:32 -0400] eponymi: at any rate, not pertinent to the problem, just didn't know what it was. gimme a second to think on the gist.
[2013-06-05 17:51:02 -0400] trobrock: got the idea from this (for the run_state) btw, although like you said not relevant to the problem: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L63
[2013-06-05 17:53:55 -0400] eponymi: whoa that just confused me
[2013-06-05 17:54:28 -0400] eponymi: so that's not a node attribute as much as a variable stored in a contextual catch-all hash for the run?
[2013-06-05 17:55:21 -0400] trobrock: yea, from what I understand just a central place to store things for this run on a node
[2013-06-05 17:55:50 -0400] eponymi: huh. i was just using it to check for various recipes inclusion in the run list
[2013-06-05 17:56:13 -0400] eponymi: if i understand it correctly, it looks like exactly what you were doing before will work if you just replace `run_state` with `run_context`
[2013-06-05 17:59:16 -0400] trobrock: eponymi: so something like this then? https://gist.github.com/trobrock/5715767
[2013-06-05 18:01:07 -0400] eponymi: i think it should be `run_state` not `run_context`
[2013-06-05 18:01:19 -0400] eponymi: i should also warn you that i have very little clue what i'm talking about.
[2013-06-05 18:02:06 -0400] trobrock: then we are in the same boat, I've been trying different things all morning to get this to work that way I want
[2013-06-05 18:05:19 -0400] eponymi: but this (including variables set by previous actions in a run) actually solves a problem that's been puzzling me for a couple days.
[2013-06-05 18:10:11 -0400] eponymi: trobrock: i also realize that i looked at the old file when you said "something like this". and then i dyslexiced the `run_state` and `run_context`. your revision looks like it should work. please let me know if it does.
[2013-06-05 18:19:44 -0400] grosendorf: hi all, I'm trying to search in a recipe for all nodes that have the same chef env as the node that is running the recipe... using this: seeds = search(:node, "chef_environment:#{node[chef_environment]}"), and I'm getting the following name error: NameError: Cannot find a resource for chef_environment on centos version 6.4
[2013-06-05 18:19:51 -0400] grosendorf: >_<
[2013-06-05 18:20:10 -0400] grosendorf: what am I doing wrong?!?
[2013-06-05 18:21:23 -0400] kallistec: grosendorf: `node.chef_environment` -- it's not a node attribute, it's a property of the node object itself
[2013-06-05 18:21:41 -0400] kallistec: unfortunately chef does a lot to blur that distinction
[2013-06-05 18:22:20 -0400] grosendorf: ah
[2013-06-05 18:22:33 -0400] grosendorf: thanks, kallistec
[2013-06-05 18:27:36 -0400] dJustin: search(:node, node.chef_environment)
[2013-06-05 18:28:45 -0400] dJustin: I'm doing an environment search...how would I access the attributes in it?  search(:environment, "name:#{Environment}") do |e|      e...and then what?  tried a ton of options
[2013-06-05 18:36:43 -0400] dJustin: so i can change a nodes attribute easily...can't change the enivronment attribute though...node: search(:node, "chef_environment:#{Environment}") do |n| n.set[attribute]="something" n.save
[2013-06-05 18:40:04 -0400] gzc: sorry to be vaguely off-topic, but re: attributes...
[2013-06-05 18:41:26 -0400] gzc: I'm trying to merge in a bunch of attrs that were originally stored as json... is there a 'preferred' way to do that other than this?
[2013-06-05 18:41:30 -0400] gzc: node.normal = node.normal_attrs.merge(JSON.parse(json_node_attrs))
[2013-06-05 18:53:31 -0400] gansbrest: Hi. I'm curious is it a good strategy to prebuild binaries (install packages) and use chef for config management only. Theoretically it should speed up init process when we need new machines (traffic spike), at the same time it could be not flexible in terms of how other cookbooks work.. What's your thought on it guys?
[2013-06-05 18:57:52 -0400] gswallow: is anyone here experienced with the opscode runit cookbook?
[2013-06-05 18:59:57 -0400] btm: @opscode #opschef code review now, join:https://plus.google.com/hangouts/_/6354441d96c8002d7f9db0db646ccae76b0770d7, watch: http://youtu.be/APfV9TmWRIE
[2013-06-05 19:00:42 -0400] ivey: gswallow: yes I have used runit cookbook some
[2013-06-05 19:02:02 -0400] gswallow: soooI would like to add the -w <timeout> flag to the sv command when it runs.  However I am stumped trying to add timeout / verbose (-v, -w) options to the resource / provider libraries that exist in version 1.1.4
[2013-06-05 19:17:20 -0400] justizin: anyone familiar with rbenv cookbook? i have rbenv_gem "bundler" for my ruby version, and it seems to install fine, but there's no shim for the 'bundle' command..
[2013-06-05 19:20:28 -0400] jmartin: justizin: even after a rehash?
[2013-06-05 19:22:07 -0400] justizin: yah actually i think i assumed the rbenv cookbook did that for me, it's looking like it doesn't..
[2013-06-05 19:23:39 -0400] justizin: hm, nope, even after a rehash, no bundle exec
[2013-06-05 19:23:44 -0400] justizin: the gem is certainly there
[2013-06-05 19:24:55 -0400] jmartin: hrm, try restarting the login shell? there is a rbenv_rehash LWRP
[2013-06-05 19:25:03 -0400] jmartin: seems weird
[2013-06-05 19:25:09 -0400] jmartin: ive never used the cookbook
[2013-06-05 19:26:15 -0400] ranjib: usedata is bootstrap with out that erb foo
[2013-06-05 19:26:20 -0400] ranjib: *userdata
[2013-06-05 19:26:47 -0400] ranjib: aws is not the only cloud
[2013-06-05 19:27:40 -0400] ranjib: damn.. wrong channel :-(
[2013-06-05 19:30:21 -0400] gswallow: ivey: ok, if I add this to libraries/resource_runit_service.rb, that's the same as defining sv_timeout and sv_verbose attributes in a traditional LWRP?
[2013-06-05 19:30:22 -0400] gswallow: http://pastebin.com/gv6xzpYz
[2013-06-05 19:30:25 -0400] gswallow: (or anyone, really)
[2013-06-05 19:31:51 -0400] eponymi: is there any way to request that a community cookbook be taken out of the community? like, a cookbook already exists with a particular name, but it's horrendous, so you request that it be removed from the community so it can't hoard that name?
[2013-06-05 19:33:50 -0400] justizin: jmartin: hm, i don't see the rbenv_rehash LWRP, i was looking for it.. neither in the opscode community docs nor the riotgames git repo, or any of the forks afaict..
[2013-06-05 19:33:59 -0400] justizin: as for restarting the shell, the shims dir doesn't have a 'bundle'
[2013-06-05 19:35:33 -0400] jtimberman: opscode community docs wouldn't have documentation about a cookbook we don't maintain.
[2013-06-05 19:35:45 -0400] lojak: what does client_fork in the chef-client cookbook do?
[2013-06-05 19:35:57 -0400] jtimberman: "community" docs - docs.opscode.com or wiki.opscode.com..
[2013-06-05 19:36:11 -0400] jmartin: justizin: have to wait for fnichol to show up maybe :D
[2013-06-05 19:36:32 -0400] jtimberman: lojak: if true, when running chef-client as a daemon, it will fork a child process to run chef, helps reduce overall memory consumption when running chef
[2013-06-05 19:36:42 -0400] justizin: jtimberman: settle down, boy, i was just trying to make it clear that i checked both the whatever, opscode cookbook site which has some documentation, as well as the github docs, since i am using the branch from github. ;)
[2013-06-05 19:36:50 -0400] justizin: jmartin: i can do that ;d
[2013-06-05 19:37:17 -0400] eponymi: my connection just disappeared. i had asked about potentially invalidating a cookbook on the community site. anybody have any info about that?
[2013-06-05 19:37:22 -0400] justizin: maybe some other people are using the rbenv-rehash plugin and it isn't clearly documented as such..
[2013-06-05 19:38:06 -0400] jtimberman: justizin: Ok.
[2013-06-05 19:38:54 -0400] lojak: @jtimberman: would that explain why chef-client is completely running out of memory and then failing to run after a day or two?
[2013-06-05 19:39:55 -0400] justizin: jtimberman: thanks for being johnny-on-the-spot with input, though. ;)
[2013-06-05 19:46:44 -0400] justizin: hm even after doing a gem install bundler and an rbenv rehash no bundle executable :/
[2013-06-05 19:47:17 -0400] gswallow: Am I even close, trying to extend the runit_service "resource" library?
[2013-06-05 19:47:17 -0400] gswallow: http://pastebin.com/YEM0FXDv
[2013-06-05 19:51:29 -0400] dougireton: In Private Chef how do I show the version?
[2013-06-05 19:52:45 -0400] dougireton: private-chef-ctl version didn't work
[2013-06-05 19:53:21 -0400] trobrock: eponymi: btw that run_context change did not work either, got an error about run_context not having method []=
[2013-06-05 19:54:37 -0400] trobrock: jtimberman: do you know how to set the value of a parameter on an lwrp at convergence, example of what I'm trying is here: https://gist.github.com/trobrock/5715767
[2013-06-05 19:56:47 -0400] jmartin: jtimberman: do you happen to know if private chef is per server instance or all node based licensing?
[2013-06-05 19:58:03 -0400] dougireton: Second question: Are there existing logrotate config files for Chef Server apps (e.g. nginx, postgresql, etc) or do I need to write my own?
[2013-06-05 19:58:53 -0400] eponymi: trobrock: have you tried just setting the node attribute?
[2013-06-05 20:00:38 -0400] btm: jmartin: based on nodes http://www.opscode.com/private-chef/#plans-pricing
[2013-06-05 20:01:07 -0400] eponymi: trobrock: `node.default["your_var"] = "value"'
[2013-06-05 20:02:22 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/7ea9ba4745e5ddce329bdc615eca8235f91d8d64, watch: http://youtu.be/W4YnYiWz-7g
[2013-06-05 20:04:13 -0400] AlainODea: I am encountering a bug with the usermod provider on SmartOS (http://tickets.opscode.com/browse/CHEF-4199).  I know the fix (https://github.com/opscode/chef/pull/768), but trying to hack it in with a recipe that overwrites usermod.rb does not work
[2013-06-05 20:04:36 -0400] AlainODea: Is there a way to override providers or fix them prior to running other recipes.
[2013-06-05 20:07:08 -0400] rundeckuser9: hi all, i'm trying to use rundeck with the knife winrm, and i'm getting /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.4/lib/chef/knife.rb:235:in `pwd': No such file or directory - getcwd (Errno::ENOENT)
[2013-06-05 20:07:14 -0400] derferman: will chef-client pull down new cookbooks that haven't changed versions?
[2013-06-05 20:07:30 -0400] gswallow: yes
[2013-06-05 20:07:40 -0400] derferman: gswallow: thanks
[2013-06-05 20:08:36 -0400] rundeckuser9: when i set plugin.script-exec.default.command=knife -v it works fine but when i add knife winrm it says can't find cwd
[2013-06-05 20:10:18 -0400] rundeckuser9: i followed these directions https://groups.google.com/forum/?fromgroups#!topic/rundeck-discuss/iMbcMeFIoOI
[2013-06-05 20:10:59 -0400] Eiam: I have a recipe setup for postgresql::ruby & postgresql::server & database, but when I the VM came up postgres was not running & I ended up having to apt-get install it ?
[2013-06-05 20:11:14 -0400] Eiam: the install showed it 'came up' fine and says it ran those recipes
[2013-06-05 20:21:43 -0400] bean: Eiam: yeesh, I wouldn't apt-get install it. I'd check your recipe and make sure it actually did the things you think it did.
[2013-06-05 20:21:48 -0400] bean: and double check your run list
[2013-06-05 20:22:17 -0400] Eiam: well, at a certain point I need to do 'actual work' and not muck around with vagrant & chef =)
[2013-06-05 20:22:24 -0400] bean: valid.
[2013-06-05 20:22:35 -0400] bean: chef is actual work ;)
[2013-06-05 20:22:42 -0400] Eiam: its not my deliverable
[2013-06-05 20:22:52 -0400] Eiam: and i can have a deliverable without it, its just a means to make my process less painful =)
[2013-06-05 20:23:51 -0400] Eiam: so I see "processing package [postgresql-client[ action install
[2013-06-05 20:24:16 -0400] Eiam: and then it moves onto the next line
[2013-06-05 20:24:19 -0400] gkarekinian: That's the client, not the server
[2013-06-05 20:25:45 -0400] vigith: how do i read a file in chef recipe @ run time.. i am getting an error at compile time saying file is missing.. i do use cookbook_file to copy the file
[2013-06-05 20:26:36 -0400] Eiam: okay.. lets see.. also postgresql::ruby installed..okay, so postgresql::server never ran, but i see "run list expands to [postgresql::server] but it never ran?
[2013-06-05 20:27:10 -0400] Eiam: and no errors about it not running
[2013-06-05 20:28:23 -0400] GianArb: hi! sorry this is my first test, i'm trying to create a easy cookbook
[2013-06-05 20:28:32 -0400] GianArb: but i have this error with i use bash command
[2013-06-05 20:28:32 -0400] GianArb: Error executing action `run` on resource 'bash[install-sphinx]
[2013-06-05 20:28:42 -0400] GianArb: can you help me please?
[2013-06-05 20:30:03 -0400] ranjib: GianArb, check if the action is :create
[2013-06-05 20:30:17 -0400] ranjib: can you pastebin ur recipe?
[2013-06-05 20:32:12 -0400] Eiam: so im not supposed to need more than recipe[postgresql::ruby, server] to get up & running?
[2013-06-05 20:33:22 -0400] bean: Eiam: [postgresql::ruby, postgresql::server] i'd imagine
[2013-06-05 20:33:34 -0400] vigith: (reposting) how do i read a file in chef recipe @ run time.. i am getting an error at compile time saying file is missing.. i do use cookbook_file to copy the file
[2013-06-05 20:33:59 -0400] GianArb: thanks
[2013-06-05 20:35:03 -0400] Eiam: bean: right, i was being lazy in my typing =)
[2013-06-05 20:35:12 -0400] GianArb: ra
[2013-06-05 20:35:20 -0400] GianArb: ranjib https://gist.github.com/GianArb/5717079
[2013-06-05 20:35:22 -0400] magiccyril: Hi, I have a problem with chef using vagrant, could anyone help ?
[2013-06-05 20:35:37 -0400] GianArb: magiccyril: i can try :)
[2013-06-05 20:35:42 -0400] bean: Eiam: yeah, have you looked at your client.log post run to make sure it actually ran and did what you want
[2013-06-05 20:35:43 -0400] magiccyril: cool
[2013-06-05 20:36:05 -0400] magiccyril: I updated vagrant, and now it's telling me "undefined local variable or method `use_inline_resources'" when I'm provisioning
[2013-06-05 20:36:48 -0400] GianArb: but in where recipe you have this error? :)
[2013-06-05 20:37:00 -0400] ranjib: GianArb, your resource definition is fine.. and chef is attempting toi execute it,. but its failing
[2013-06-05 20:37:25 -0400] ranjib: you might want to change the cwd parameter to give absolute path
[2013-06-05 20:37:57 -0400] ranjib: also.. share the error you are getting.. run the chef client in debug mode
[2013-06-05 20:37:59 -0400] GianArb: ah ok.. mm
[2013-06-05 20:38:03 -0400] ranjib: -l debug
[2013-06-05 20:38:22 -0400] GianArb: ok but for tast this resource i use vagrant.. is an error?
[2013-06-05 20:38:31 -0400] ranjib: ohai exposes all the user info .. including their home directories.. btw
[2013-06-05 20:38:32 -0400] GianArb: exist a good tool?
[2013-06-05 20:38:52 -0400] ranjib: vagrant is good
[2013-06-05 20:39:15 -0400] ranjib: you can use cwd Chef::Config[:file_cache_path] .. also
[2013-06-05 20:39:39 -0400] GianArb: Chef::Config[:file_cache_path] goole time!
[2013-06-05 20:40:24 -0400] GianArb: Chef::Config[:file_cache_path] is a home for user?
[2013-06-05 20:40:42 -0400] GianArb: *of.. sorry for my english
[2013-06-05 20:41:03 -0400] ranjib: no.. its a directory where chef stores caqching data
[2013-06-05 20:41:10 -0400] ranjib: stuff like cookbook sate
[2013-06-05 20:41:13 -0400] ranjib: *etc
[2013-06-05 20:41:35 -0400] ranjib: on linux .. its typically in /var/cache/chef
[2013-06-05 20:42:44 -0400] GianArb: ok but for resolve my problem i set absolute cwd and not a relative path
[2013-06-05 20:45:46 -0400] magiccyril: even when I include an empty recipe I still have "undefined local variable or method `use_inline_resources'" error, does anyone has an idea ?
[2013-06-05 20:47:29 -0400] gkarekinian: That's a method only available in Chef 11, grep for it in your cookbooks to find which one uses this method
[2013-06-05 20:48:14 -0400] gkarekinian: http://docs.opscode.com/breaking_changes_chef_11.html
[2013-06-05 20:49:01 -0400] chaosmaker: Hi, someone knows where to set "Fix provided" on the opscode Jira for cookbooks contribution?
[2013-06-05 20:49:04 -0400] miah: its likely a lwrp
[2013-06-05 20:49:11 -0400] magiccyril: ok, it's apt recipe, what could I do ? comment the line ?
[2013-06-05 20:49:13 -0400] miah: since that method is only available to them
[2013-06-05 20:49:20 -0400] miah: magiccyril: how about updating your chef?
[2013-06-05 20:49:24 -0400] miah: or using a older version of the recipe?
[2013-06-05 20:50:22 -0400] magiccyril: miah: why not ! could you explain me how to do that, or just send me an URL that explain to do that. I'm using vagrant and chef solo
[2013-06-05 20:51:03 -0400] rundeckuser9: has anyone used rundeck and chef knife?
[2013-06-05 20:52:10 -0400] ranjib: chaosmaker, you have login to tickets.opscode.com ?
[2013-06-05 20:52:16 -0400] chaosmaker: yes
[2013-06-05 20:52:30 -0400] ranjib: oin top there should be a panel
[2013-06-05 20:52:33 -0400] chaosmaker: ranjib I'm trying to follow the document about contributions
[2013-06-05 20:52:34 -0400] chaosmaker: 8. Set the COOK ticket to "Fix Provided" and link to your pull request in a comment. We will review the ticket and contribution as soon as possible in an upcoming COOK Code Review meetings.
[2013-06-05 20:52:42 -0400] ranjib: signed the CLA?
[2013-06-05 20:53:10 -0400] chaosmaker: At least the document said that is not necessary for a single contribution
[2013-06-05 20:53:22 -0400] ranjib: really .. i dont know..
[2013-06-05 20:53:35 -0400] chaosmaker: http://wiki.opscode.com/display/chef/How+to+Contribute
[2013-06-05 20:53:40 -0400] chaosmaker: Individual Contributions
[2013-06-05 20:53:44 -0400] ranjib: anyway.. if you go to the tickets.opscode.com/TICKE_NUMBER
[2013-06-05 20:53:51 -0400] chaosmaker: right
[2013-06-05 20:54:04 -0400] ranjib: u should see the button on left - top
[2013-06-05 20:54:04 -0400] chaosmaker: I'm on it
[2013-06-05 20:54:11 -0400] ranjib: right after the heading
[2013-06-05 20:54:18 -0400] ranjib: whats the ticket number?
[2013-06-05 20:54:29 -0400] chaosmaker: http://tickets.opscode.com/browse/COOK-3122
[2013-06-05 20:55:09 -0400] chaosmaker: Maybe it's something related to my user, because I can't edit anything on the ticket after the creation
[2013-06-05 20:55:40 -0400] ranjib: you sure you are logged in ?
[2013-06-05 20:55:47 -0400] ranjib: i can see the fix provided button
[2013-06-05 20:55:53 -0400] ranjib: you want i hit it?
[2013-06-05 20:55:54 -0400] chaosmaker: yes, my name is on the top right
[2013-06-05 20:55:55 -0400] ranjib: :-)
[2013-06-05 20:56:02 -0400] ranjib: whats ur name?
[2013-06-05 20:56:05 -0400] chaosmaker: Cassiano Aquino
[2013-06-05 20:56:14 -0400] chaosmaker: username caquino
[2013-06-05 20:56:27 -0400] chaosmaker: maybe it's related to some user permission
[2013-06-05 20:56:33 -0400] ranjib: nah..
[2013-06-05 20:56:37 -0400] ranjib: its not there
[2013-06-05 20:56:45 -0400] ranjib: when you have registered?
[2013-06-05 20:56:49 -0400] chaosmaker: yesterday
[2013-06-05 20:56:58 -0400] ranjib: i think you have to sign the individual contributor CLA
[2013-06-05 20:57:15 -0400] ranjib: then some dude from opscode will do some foo
[2013-06-05 20:57:29 -0400] ranjib: after that you will be able to assign the ticket against you
[2013-06-05 20:57:33 -0400] miah: once the legal dept from opscode replies you can get thigns done =)
[2013-06-05 20:57:47 -0400] ranjib: and also change the state of ticket to fix provided
[2013-06-05 20:57:50 -0400] miah: they usually respond in 24 - 48 hours, but i dunno how busy they are these days. it was really quick the two times i did it.
[2013-06-05 20:57:55 -0400] chaosmaker: right, thanks ppl! I think I misunderstood the CLA document
[2013-06-05 20:57:57 -0400] ranjib: yeah.. thats it
[2013-06-05 20:58:01 -0400] chaosmaker: I will do it right now
[2013-06-05 20:59:01 -0400] Cheeezit: What is the best place chef object to store a nginx configuration file in?
[2013-06-05 20:59:28 -0400] scairbus: am I not able to check for node.chef_environment? in a chef 11 recipe? for example: if node.environment?("production")
[2013-06-05 20:59:29 -0400] rundeckuser9: do i need to call knife with a login shell option like /bin/bash -l -c knife in a script?
[2013-06-05 20:59:46 -0400] chaosmaker: thanks miah  ranjib
[2013-06-05 20:59:48 -0400] chaosmaker: Opscode Individual Contributor License Agreement (between Cassiano Morgado de Aquino and Opscode) is Signed and Filed!
[2013-06-05 20:59:49 -0400] chaosmaker: :)
[2013-06-05 20:59:55 -0400] chaosmaker: let's wait
[2013-06-05 21:00:10 -0400] ranjib: welcome to the club :-) .. skynet is near
[2013-06-05 21:02:53 -0400] chaosmaker: thanks! ranjib T-800 cookbook on the way
[2013-06-05 21:12:01 -0400] coderanger: reset: Does berkshelf only look in ~/.berkshelf for its config by default, or does it check ./.berkshelf a la knife?
[2013-06-05 21:12:50 -0400] ivey: ~/.berkshelf
[2013-06-05 21:13:08 -0400] ivey: we have an open issue for per-project configs, I think
[2013-06-05 21:13:16 -0400] coderanger: Also https://github.com/RiotGames/berkshelf/blob/master/lib/berkshelf/config.rb#L8-L9
[2013-06-05 21:13:22 -0400] coderanger: copy-pasta error?
[2013-06-05 21:13:29 -0400] coderanger: Ahh, leading .
[2013-06-05 21:13:33 -0400] coderanger: ignore me :)
[2013-06-05 21:13:45 -0400] coderanger: The alignment threw me off
[2013-06-05 21:14:05 -0400] ivey: i take it back
[2013-06-05 21:14:06 -0400] coderanger: Any chance I could throw a finger on the scale re: per-project configs?
[2013-06-05 21:14:19 -0400] ivey: we do have per-project
[2013-06-05 21:14:37 -0400] coderanger: Okay, thats what I thought from reading this
[2013-06-05 21:14:45 -0400] ivey: all of those default locations are in ., and then there's ~/.berkshelf
[2013-06-05 21:14:55 -0400] coderanger: Okay, excellente :)
[2013-06-05 21:15:07 -0400] coderanger: Go go gadget dynamic config!
[2013-06-05 21:29:05 -0400] reset: coderanger: sorry I was getting some lunch. Did you get what you needed from ivey?
[2013-06-05 21:29:11 -0400] coderanger: Yarp :)
[2013-06-05 21:29:28 -0400] reset: ok awesome
[2013-06-05 21:30:24 -0400] gzc: has anyone else observed the java cookbook installing a 6-era jdk even when specifying a jdk_version of 7 ?
[2013-06-05 21:31:34 -0400] jmartin: btm: thanks (re: private chef pricing), just wanted to be sure we could install the server portion as often as we'd like :D
[2013-06-05 21:42:55 -0400] Trinitro1X: Is anyone here successfully able to use edelight/chef-solo-search?
[2013-06-05 21:44:19 -0400] philsturgeon: hey guys
[2013-06-05 21:44:55 -0400] philsturgeon: Graylog uses ruby to run a web interface, but its fighting with the main version of ruby instead of using a gemset, i think. http://d.pr/i/bBlb
[2013-06-05 21:49:14 -0400] tBunnyMan: Chef-11.4.4 depends on [json (<= 1.7.7, >= 1.4.4)]. However knife-linode depends on json (~> 1.7). How does one rig this to work?
[2013-06-05 21:53:12 -0400] Trinitro1X: So I'm trying to test a cookbook with berkshelf + vagrant, and I've added depends on 'chef-solo-search', but I'm getting an error
[2013-06-05 21:53:15 -0400] Trinitro1X: https://gist.github.com/5717611
[2013-06-05 21:53:48 -0400] freezey: question if i want to distribute an ohai plugin to a specific node alls i would have to do is include that file into that directory for the node?
[2013-06-05 21:54:04 -0400] freezey: or even put the file there myself and it should populate?
[2013-06-05 22:02:58 -0400] siezer: ohai
[2013-06-05 22:03:08 -0400] c_t: ohai
[2013-06-05 22:06:30 -0400] freezey: yeah seem like adding the file there myself doesnt really work
[2013-06-05 22:10:03 -0400] siezer: k
[2013-06-05 22:13:56 -0400] freezey: nevermind it does
[2013-06-05 22:13:57 -0400] freezey: foolish
[2013-06-05 22:21:06 -0400] Otterley: has anyone noticed that Chef 11.4.4 has much worse error reporting than Chef 10?
[2013-06-05 22:22:41 -0400] supergrilo: http://pastebin.ca/2390722 i have a problem with chef 11 and debian wheezy. Anyone cam help?
[2013-06-05 22:24:54 -0400] jtimberman: Otterley: worse how?
[2013-06-05 22:25:11 -0400] Otterley: jtimberman, allow me to demonstrate with a gist
[2013-06-05 22:27:11 -0400] Otterley: jtimberman, note that without -l debug, the run doesn't tell me what really failed.  this used to work under 10.4.
[2013-06-05 22:29:25 -0400] Otterley: @supergrilo, ensure you're using the Omnibus Chef install, and run it with -l debug
[2013-06-05 22:30:04 -0400] supergrilo: Otterley i use apt.opscode.com wheezy-0.10
[2013-06-05 22:30:31 -0400] Otterley: is that Omnibus Chef?  is it installed in /opt/chef ?
[2013-06-05 22:32:47 -0400] supergrilo: Otterley i don't know, I always used the debian package of Opscode respo
[2013-06-05 22:33:06 -0400] supergrilo: but in wheezy is the firt time
[2013-06-05 22:33:24 -0400] supergrilo: backtrace with -l debug : http://pastebin.ca/2390725
[2013-06-05 22:35:08 -0400] Otterley: this does not appear to be Omnibus chef.
[2013-06-05 22:35:51 -0400] supergrilo: root@debian:~# cat /etc/apt/sources.list.d/opscode.list
[2013-06-05 22:35:51 -0400] supergrilo: deb http://apt.opscode.com/wheezy-0.10 main
[2013-06-05 22:36:15 -0400] supergrilo: root@debian:~# lsb_release -c
[2013-06-05 22:36:15 -0400] supergrilo: Codename:wheezy
[2013-06-05 22:38:12 -0400] Otterley: supergrilo, try installing Omnibus Chef; don't use the opscode repo
[2013-06-05 22:38:13 -0400] Otterley: http://www.opscode.com/chef/install/
[2013-06-05 22:38:29 -0400] Otterley: you'll need to remove the chef packages first
[2013-06-05 22:39:35 -0400] supergrilo: why not
[2013-06-05 22:39:35 -0400] supergrilo: i need use it. My process workflow is based on this method
[2013-06-05 22:40:24 -0400] supergrilo: to migrate from squeeze to wheezy transparently.
[2013-06-05 22:40:32 -0400] supergrilo: :/
[2013-06-05 22:40:59 -0400] ggolin: hello all
[2013-06-05 22:41:24 -0400] ggolin: ubuntu, omnibus chef, application_ruby, and chef-rvm.
[2013-06-05 22:41:36 -0400] Otterley: we use that ggolin
[2013-06-05 22:41:48 -0400] ggolin: Otterley, how's that working out for you?
[2013-06-05 22:42:00 -0400] Otterley: well, except for rvm being evil, just fine
[2013-06-05 22:42:54 -0400] ggolin: https://gist.github.com/anonymous/5717910
[2013-06-05 22:43:00 -0400] ggolin: Otterley, ever seen anything like this?>
[2013-06-05 22:44:06 -0400] Otterley: no, that's a new one to me, sorry ggolin
[2013-06-05 22:44:21 -0400] ggolin: alright. thanks for taking a look.
[2013-06-05 22:56:40 -0400] Otterley: anyone know why Chef 11.4.4 might not be updating a cookbook on a node when I bump its version number in the environment associated with the node?
[2013-06-05 22:56:52 -0400] Otterley: the wrong version is in the cache
[2013-06-05 22:57:14 -0400] Otterley: hmm, nevermind
[2013-06-05 23:03:59 -0400] Otterley: jtimberman, did you get my gist?
[2013-06-05 23:04:19 -0400] btm: jmartin: no worries, the sales folks can answer all your questions and hook you up with field engineers too.
[2013-06-05 23:07:05 -0400] supergrilo: opscode team do not maintain the debian repository anymore?
[2013-06-05 23:07:05 -0400] supergrilo: the unique method to install debian package, is to use omnibuss?
[2013-06-05 23:07:27 -0400] supergrilo: apt.opscode.com is deprecated?
[2013-06-05 23:10:50 -0400] supergrilo: Otterley omnibuss package works fine. thank you
[2013-06-05 23:10:51 -0400] supergrilo: :)
[2013-06-05 23:11:01 -0400] Otterley: cool
[2013-06-05 23:11:16 -0400] Otterley: you can upload the package to your own repo and use it - that's what we do
[2013-06-05 23:13:15 -0400] supergrilo: that's what I'll do.
[2013-06-05 23:26:20 -0400] jtimberman: supergrilo: it's not that we don't maintain it "anymore", we just haven't updated with later packages as our focus has been on the omnibus packages. i don't have an ETA when it will be updated, though.
[2013-06-05 23:26:25 -0400] jtimberman: Otterley: rg
[2013-06-05 23:27:42 -0400] jtimberman: Otterley: not sure why that is, i see the errors when they occur like the debug output your gist has.
[2013-06-05 23:27:53 -0400] jtimberman: Otterley: what does your /etc/chef/client.rb have?
[2013-06-05 23:28:54 -0400] supergrilo: jtimberman still makes sense to keep them? the last release on repository is 10.18-2
[2013-06-05 23:29:02 -0400] Otterley: jtimberman, check your pm
[2013-06-05 23:29:39 -0400] GianArb: hi but for create a good cookbooks what is a best book/tutorial?
[2013-06-05 23:30:06 -0400] supergrilo: I did not know that, thought it was a stable release the 10.18-2
[2013-06-05 23:30:46 -0400] supergrilo: jtimberman and this version does not works in debian wheezy
[2013-06-05 23:31:49 -0400] supergrilo: is abandoned and forgotten. affect who use the repository
[2013-06-05 23:32:36 -0400] timsmith: any idea if Opscode plans to merge windows_package from the windows cookbook into core chef
[2013-06-05 23:43:28 -0400] Otterley: has anyone noticed that if you change a runit script template in a cookbook that declares a runit resource, the runit cookbook doesn't update the script file?
[2013-06-05 23:59:23 -0400] jtimberman: timsmith: I believe that is already in opscode/chef master :)
[2013-06-05 23:59:26 -0400] jtimberman: or at least a branch
[2013-06-05 23:59:49 -0400] jtimberman: supergrilo: doesn't work how, like, won't install if you try to use wheezy codename?
[2013-06-05 23:59:50 -0400] jmickle: coderanger: miah  you around?
[2013-06-05 23:59:54 -0400] timsmith: .6 release?
