[2013-06-13 00:00:01 -0400] Otterley: recipes are scoped to a cookbook
[2013-06-13 00:00:17 -0400] coderanger: recipes are contained in a cookbook, there is no scoping involved though
[2013-06-13 00:00:18 -0400] apes: I meant "scope" as in "what would the cookbook contain"
[2013-06-13 00:00:47 -0400] coderanger: chance: Hmm, it should, but you could force this issue like this
[2013-06-13 00:01:20 -0400] chance: http://pastebin.osuosl.org/2260/
[2013-06-13 00:01:25 -0400] chance: thats what im using
[2013-06-13 00:01:32 -0400] chance: and im retarded.
[2013-06-13 00:01:36 -0400] coderanger: migration_command do r = execute ... do ... action :nothing end; r.run_action(:run) end
[2013-06-13 00:01:52 -0400] coderanger: oh heh
[2013-06-13 00:01:56 -0400] coderanger: a command would help :)
[2013-06-13 00:01:58 -0400] chance: yeah.
[2013-06-13 00:02:07 -0400] chance: lets see if that changes it
[2013-06-13 00:04:49 -0400] chance: doesnt work..but no errors, or messages or warnigns about it, whats up with that?
[2013-06-13 00:05:06 -0400] coderanger: Are you sure you have migrate true set?
[2013-06-13 00:05:14 -0400] chance: yeah at the top
[2013-06-13 00:05:33 -0400] chance: it runs syncdb with migration_command not set.
[2013-06-13 00:06:22 -0400] coderanger: I don't have the cycles to dive the code right now, I would say your best bet is just migration_command '/whatever/the/deploy/path/is/shared/virtualenv/bin/python manage.py syncdb --migrate"
[2013-06-13 00:06:43 -0400] chance: yeah, im just going to do that after one more try to check if its something dumb.
[2013-06-13 00:12:10 -0400] chance: personally what i would like is an actual python lwrp so i can do stuff like self.python.virtualenv in my application lwrp
[2013-06-13 00:12:42 -0400] apes: If you want to manage slightly different versions of the same file, one for each type of role you have, what is a good pattern to follow for that?
[2013-06-13 00:13:01 -0400] chance: also, i think the execute block works, i just had another dumb issue :)
[2013-06-13 00:13:09 -0400] chance: thanks coderanger, im out for the day. cya
[2013-06-13 00:13:56 -0400] freezey: migrating to chef11 from 10 and during the knife upload it just bombs out on sandboxes upload
[2013-06-13 00:13:58 -0400] coderanger: apes: Is it a text file?
[2013-06-13 00:14:00 -0400] freezey: continue to get server returned error
[2013-06-13 00:14:19 -0400] apes: coderanger: Yes, mostly config files to be precise
[2013-06-13 00:14:21 -0400] hakunin: reset: would you recommend to put real data bags like keys, users into my application cookbook or into whatever chef-solo repo where I'm running my cookbook from? (like server, but for solo)
[2013-06-13 00:15:03 -0400] coderanger: apes: Just use conditionals in a template would be my vote
[2013-06-13 00:15:30 -0400] apes: coderanger: That was one solution I have seen, but it seems to result in very complex templates, unfortunately
[2013-06-13 00:16:00 -0400] reset: hakunin: probably whatever repo that you're running it from since it's not data that you want to ship with the cookbook
[2013-06-13 00:16:02 -0400] coderanger: depends on how slightly "slightly" is
[2013-06-13 00:16:38 -0400] hakunin: reset: hm so if i'm testing the cookbook, i'd just throw some dummy databags in there as fixtures i guess
[2013-06-13 00:17:06 -0400] apes: coderanger: Suppose you remove the "slightly" constraint from my initial question, what about then?
[2013-06-13 00:17:10 -0400] hakunin: reset: thx
[2013-06-13 00:17:26 -0400] reset: ya, i'd keep some example/test data with the cookbook
[2013-06-13 00:18:01 -0400] coderanger: apes: Just separate files with the key in the name and do something like template "whatever" do source "foo_#{node[:mythingy]}.erb" end
[2013-06-13 00:18:05 -0400] coderanger: apes: and then have that key set in the role, with a sane defualt
[2013-06-13 00:18:32 -0400] coderanger: apes: The complexity with that is you can only pick one variant, so if you end up with "x or y" situations, you are better off with one file
[2013-06-13 00:19:48 -0400] apes: coderanger: I like that solution, I didn't realize you could source in a filename generated at runtime like that.
[2013-06-13 00:27:04 -0400] Otterley: how can one guard creation of a cookbook_file resource such that it's skipped if the file doesn't exist?
[2013-06-13 00:27:15 -0400] coderanger: Otterley: The file on disk?
[2013-06-13 00:27:19 -0400] Otterley: the file in the cookbook
[2013-06-13 00:27:31 -0400] Otterley: e.g. if the source file is based on some attribute
[2013-06-13 00:27:48 -0400] coderanger: You cannot directly do that, the presence or absence of data files is not exposed as config information
[2013-06-13 00:27:54 -0400] Otterley: bah
[2013-06-13 00:28:06 -0400] coderanger: You can either use ignore_errors or you can make a request to the cookbook API and get back the file list and check manually
[2013-06-13 00:28:14 -0400] Otterley: ok, thanks
[2013-06-13 00:28:21 -0400] Otterley: you mean ignore_failure ?
[2013-06-13 00:28:23 -0400] coderanger: cookbook files are transferred on demand, so there is no way to know at compile time if the file exists or not
[2013-06-13 00:28:26 -0400] coderanger: yeah, that :)
[2013-06-13 00:28:47 -0400] Otterley: well, it's the same cookbook
[2013-06-13 00:28:54 -0400] Otterley: AFAIK all cookbook files are transferred
[2013-06-13 00:29:07 -0400] Otterley: are they not?
[2013-06-13 00:29:34 -0400] coderanger: No
[2013-06-13 00:29:45 -0400] Otterley: good to know, thanks
[2013-06-13 00:29:53 -0400] coderanger: As I said, files/ and templates/ files are retrieved lazily
[2013-06-13 00:32:39 -0400] ccapndave: Does anyone know how I can tell the apache2 cookbook to run apache as a different user:group to the normal www-data:www-data?
[2013-06-13 00:33:06 -0400] coderanger: ccapndave: node['apache']['user'] - User Apache runs as
[2013-06-13 00:33:14 -0400] coderanger: and similarly for group
[2013-06-13 00:33:21 -0400] coderanger: override it in a role or environment :)
[2013-06-13 00:33:24 -0400] ccapndave: coderanger Thanks very much!
[2013-06-13 00:40:22 -0400] hakunin: I wonder what kind of practices chef solo folks use to manage iptables and /etc/hosts?
[2013-06-13 00:40:56 -0400] freezey: i have chef solo stuff running for our devs vagrant instances
[2013-06-13 00:41:21 -0400] freezey: it does some /etc/hosts stuff and iptables things
[2013-06-13 00:41:30 -0400] freezey: created a role dev-vagrant-class
[2013-06-13 00:41:41 -0400] freezey: and since the nodes are instantly in _default
[2013-06-13 00:41:49 -0400] freezey: have statements that follow that
[2013-06-13 00:41:57 -0400] hakunin: freezey: do you have some adding/removing nodes magic to get them all talk to one another?
[2013-06-13 00:42:17 -0400] freezey: nah the dev vagrant nodes dont have to talk to one another
[2013-06-13 00:42:17 -0400] hakunin: like when one node goes up, the others should get it in hosts and added to iptables
[2013-06-13 00:42:19 -0400] freezey: just for local dev
[2013-06-13 00:42:28 -0400] freezey: ahhh nah dont have that
[2013-06-13 00:42:33 -0400] freezey: install the entire app stack on 1 node
[2013-06-13 00:42:38 -0400] hakunin: i see
[2013-06-13 00:42:54 -0400] freezey: quickest way to get them up
[2013-06-13 01:28:24 -0400] freezey: has anyone seen this on a fresh 11 install? ERROR: ArgumentError: can't get const Chef::WebUIUser: uninitialized constant Chef::WebUIUser
[2013-06-13 01:30:13 -0400] hakunin: If I have community cookbook => wrapper cookbook => kitchen setup and i want to set attributes for testing in wrapper cookbook, and then actual real attributes in kitchen, which attr precedence should i use? normal and override? or default and normal?
[2013-06-13 01:31:07 -0400] hakunin: I guess biggest question is if my wrapper cookbook depends on community cookbook and i put default attrs in my wrapper, will it override the defaults in the community one?
[2013-06-13 01:33:57 -0400] hakunin: actually just realized that for testing i can set attributes in kitchen.yml
[2013-06-13 01:39:10 -0400] jfchevrette: hello. i have trying chef with ec2 and I am getting this when creating a server. any ideas?: http://pastie.org/8037813
[2013-06-13 02:42:33 -0400] aub: using hosted chef on EC2, how should I manage dependencies between nodes? for example, my web front-end needs the IP/port of the database host.
[2013-06-13 03:16:41 -0400] dieend_: Hello, I was trying to bootstrap a node with knife. But it giving error like this:
[2013-06-13 03:16:53 -0400] dieend_: localhost /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/mixlib-log-1.4.1/lib/mixlib/log.rb:97:in `level=' localhost :  localhost Log level must be one of :debug, :info, :warn, :error, or :fatal localhost  ( localhost ArgumentError localhost ) localhost  localhost localhost from /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application.rb:117:in `configure_logging' localhost from /opt/chef/embedded/lib/ruby/gems/1.9.1
[2013-06-13 03:17:02 -0400] dieend_: chef-client -v gives 11.4.4
[2013-06-13 03:17:07 -0400] dieend_: so I assume it is because incompatible version
[2013-06-13 03:17:11 -0400] dieend_: If I am correct, how to fix the problem?
[2013-06-13 03:19:19 -0400] juliancdunn: aub: you'll want to use Chef's search functionality
[2013-06-13 03:19:53 -0400] aub: juliancdunn: ok, cool. i saw that. how does it work when the nodes are created in random order?
[2013-06-13 03:20:06 -0400] aub: juliancdunn: like let's say i create the web app then the db?
[2013-06-13 03:20:40 -0400] juliancdunn: aub: it doesn't matter... the end state will still be the same
[2013-06-13 03:21:06 -0400] aub: juliancdunn: ok, so once chef_client runs again on the web host it'll get updated?
[2013-06-13 03:21:14 -0400] juliancdunn: aub: yup
[2013-06-13 03:21:34 -0400] aub: juliancdunn: ok, that makes sense. thanks
[2013-06-13 03:21:41 -0400] juliancdunn: aub: no problem
[2013-06-13 03:22:11 -0400] juliancdunn: dieend_: that output is unreadable, i'm not sure what all the localhosts are about
[2013-06-13 03:24:19 -0400] juliancdunn: like it says, your log_level directive has to be one of those symbols
[2013-06-13 03:25:09 -0400] dieend_: I'm actually following the tutorial from https://learnchef.opscode.com/quickstart/converge/
[2013-06-13 03:25:36 -0400] dieend_: and when running "knife bootstrap localhost \   --ssh-user vagrant \   --ssh-password vagrant \   --ssh-port 2222 \   --run-list "recipe[apt],recipe[aliases],recipe[apache2],recipe[networking_basic]" \   --sudo" it gives me that error
[2013-06-13 03:25:48 -0400] dieend_: I'll printscreen the error so it clearer
[2013-06-13 03:28:12 -0400] dieend_: https://dl.dropboxusercontent.com/u/26870090/Screenshot%20from%202013-06-13%2010%3A26%3A29.png
[2013-06-13 03:29:09 -0400] dieend_: juliancdunn: here is the console output,  https://dl.dropboxusercontent.com/u/26870090/Screenshot%20from%202013-06-13%2010%3A26%3A29.png
[2013-06-13 03:31:00 -0400] juliancdunn: dieend_: can you show your knife.rb?
[2013-06-13 03:31:57 -0400] dieend_: current_dir = File.dirname(__FILE__) log_level                :info log_location             STDOUT node_name                "dieend" client_key               "#{current_dir}/dieend.pem" validation_client_name   "dieendorganization-validator" validation_key           "#{current_dir}/dieendorganization-validator.pem" chef_server_url          "https://api.opscode.com/organizations/dieendorganization" cache_type               'BasicFile'
[2013-06-13 03:32:46 -0400] juliancdunn: next time plz pastebin that :-)
[2013-06-13 03:33:34 -0400] juliancdunn: what version of Chef are you running on your workstation?
[2013-06-13 03:33:46 -0400] dieend_: how to check the running chef version?
[2013-06-13 03:33:48 -0400] juliancdunn: (type knife --version)
[2013-06-13 03:34:20 -0400] dieend_: juliancdunn: 11.4.4
[2013-06-13 03:35:06 -0400] juliancdunn: dieend_: it's strange that you would have a chef 10 gem in there then
[2013-06-13 03:35:17 -0400] dieend_: yeah I thought so
[2013-06-13 03:35:33 -0400] juliancdunn: try to blow away /opt/chef on your workstation and reinstall?
[2013-06-13 03:35:34 -0400] dieend_: But I think I used the omnibox
[2013-06-13 03:35:44 -0400] dieend_: just delete that folder?
[2013-06-13 03:36:08 -0400] juliancdunn: dieend_: yeah
[2013-06-13 03:36:10 -0400] juliancdunn: as root
[2013-06-13 03:36:18 -0400] juliancdunn: and reinstall omnibus chef from our site
[2013-06-13 03:37:13 -0400] dieend_: with this instruction? https://learnchef.opscode.com/quickstart/workstation-setup/#linux
[2013-06-13 03:37:52 -0400] juliancdunn: dieend_: yeah, that curl command will work
[2013-06-13 03:38:31 -0400] juliancdunn: if you're on Linux, might not be a bad idea to use your package manager to remove the Chef package
[2013-06-13 03:38:55 -0400] juliancdunn: e.g. "yum remove chef" or the equivalent, rather than deleting /opt/chef
[2013-06-13 03:42:11 -0400] dieend_: juliancdunn: ok, I used synaptic to remove chef 11.4.4. Currently I'm on progress reinstalling the chef
[2013-06-13 03:43:01 -0400] juliancdunn: dieend_: cool. I gotta bail. if you still have problems, we run office hours. https://learnchef.opscode.com/feedback/
[2013-06-13 03:43:05 -0400] juliancdunn: there's also a #learnchef channel
[2013-06-13 03:43:42 -0400] juliancdunn: good luck!
[2013-06-13 03:43:43 -0400] dieend_: juliancdunn: thanks.
[2013-06-13 04:53:13 -0400] ssd7: Ohai Chefs
[2013-06-13 05:04:50 -0400] hakunin: is Bryan Berry around by any chance?
[2013-06-13 05:21:45 -0400] MrBIOS: hi folks
[2013-06-13 05:21:47 -0400] MrBIOS: anybody alive?
[2013-06-13 05:22:23 -0400] MrBIOS: I'm trying to do a bootstrap with knife/chef and it's failing with a 403. I *know* the validation PEM is good (used it a hundred times before, literally)
[2013-06-13 05:23:12 -0400] ssd7: MrBIOS: What kind of Chef server are you using?
[2013-06-13 05:23:14 -0400] MrBIOS: I had a previous botched bootstrap due to a typo earlier
[2013-06-13 05:23:18 -0400] MrBIOS: not hosted
[2013-06-13 05:23:30 -0400] MrBIOS: so I removed the node from the server manually
[2013-06-13 05:24:40 -0400] MrBIOS: and now i can't get a straightforward bootstrap to succeed
[2013-06-13 05:25:01 -0400] ssd7: MrBIOS: Can't get it to succeed any new node or this node in particular?
[2013-06-13 05:25:11 -0400] MrBIOS: this one
[2013-06-13 05:25:14 -0400] MrBIOS: I haven't tried another
[2013-06-13 05:25:30 -0400] MrBIOS: I've also verified that the validation PEM that is on the node to be bootstrapped is identical to the one on my client
[2013-06-13 05:25:34 -0400] MrBIOS: which is known-good
[2013-06-13 05:26:08 -0400] MrBIOS: under possible causes, the client states " * There may already be a client named "bs-3.bright.com" and "* Your validation client (chef-validator) may have misconfigured authorization permissions."
[2013-06-13 05:27:48 -0400] ssd7: MrBIOS: Well the first is easy to rule out, what does `knife client show bs-3.bright.com` return?
[2013-06-13 05:28:40 -0400] MrBIOS: it does show an entry
[2013-06-13 05:29:10 -0400] MrBIOS: I take it I need to nuke that?
[2013-06-13 05:29:22 -0400] ssd7: MrBIOS: I would start by `knife client delete bs-3.bright.com` and then making sure the client key is also gone
[2013-06-13 05:29:27 -0400] ssd7: from /etc/chef/client.pem
[2013-06-13 05:31:11 -0400] MrBIOS: that seemed to do it
[2013-06-13 05:31:21 -0400] MrBIOS: so I removed the node but not the client entry
[2013-06-13 05:32:42 -0400] ssd7: MrBIOS: Looks like it.  In terms of authentication, clients and users are the only entities that can make API requests
[2013-06-13 05:33:53 -0400] ssd7: The client on a given host running chef-client will typically have the same name as the node, so you'll sometimes seem people be a bit loose with the distinction
[2013-06-13 05:34:17 -0400] ssd7: since when everything is working it is mostly an implementation detail imho
[2013-06-13 05:58:42 -0400] MrBIOS: ssd7: lovely, on to the next issue, heh
[2013-06-13 05:58:48 -0400] MrBIOS: ArgumentError: wrong number of arguments (2 for 1) when it comes to something lwrp related
[2013-06-13 05:59:23 -0400] MrBIOS: ah, looks like I'm running up against http://tickets.opscode.com/browse/CHEF-4123
[2013-06-13 06:13:48 -0400] ssd7: MrBIOS: Sorry, went afk for a bit, but the bug you linked to only affects ruby 1.8 I believe.
[2013-06-13 06:14:25 -0400] MrBIOS: I believe that's what I was running
[2013-06-13 06:14:34 -0400] MrBIOS: whatever comes with Ubuntu 12.04.1 LTS
[2013-06-13 06:27:01 -0400] ssd7: Hrmm, I /think/ that may still be 1.8.  If you installed the latest version of Chef using omnibus, you'll likely avoid that bug.
[2013-06-13 06:54:58 -0400] scalp42: has anyone run into the issue where you can't log in the UI after settings up chef_server_webui['web_ui_admin_default_password'] in chef-server.rb ?
[2013-06-13 06:55:08 -0400] scalp42: just keep getting "Could not complete logging in."
[2013-06-13 07:05:12 -0400] dyu: what's the cookbook for adding stuff to $PATH?
[2013-06-13 07:06:23 -0400] scalp42: dyu I believe you can pass environment variables using resource attributes
[2013-06-13 07:11:15 -0400] axyelp: dyu: the way we've managed to do is, source a file in bash.bashrc which we change! so whenever we wish to change it, we only replace the sourced file!
[2013-06-13 07:16:41 -0400] dyu: so you do it manually?
[2013-06-13 07:23:01 -0400] axyelp: not manually per se! but we don't require to change the environment variables every now and then!
[2013-06-13 07:23:10 -0400] axyelp: dyu: ^^
[2013-06-13 07:26:57 -0400] dyu: i see. in our case i'll just tell them on the wiki to manually add it to the $PATH
[2013-06-13 07:27:56 -0400] dyu: the machine already has stuff in it and people tend to put their own stuff in bashrc
[2013-06-13 08:03:09 -0400] kernelpanik: Hi! a question about ohai... is there an attribute that returns cpu usage?
[2013-06-13 08:11:17 -0400] isbaran: kernelpanik: its not a monitoring tool
[2013-06-13 08:12:11 -0400] isbaran: also cpu usage at one point in time doesn't mean anything useful
[2013-06-13 08:13:44 -0400] kernelpanik: ok thanks!  I will do it w/ bash
[2013-06-13 08:14:29 -0400] isbaran: kernelpanik: how do you plan to use this information ? just curious
[2013-06-13 08:16:01 -0400] kernelpanik: I am biuld a rails app that takes data in real time.. I would like use chef in order to take data from the nodes :)
[2013-06-13 09:22:15 -0400] _JamieD_: hi all, does anyone know if it's possible to change a nodes environment easily or is it best to just fire up a new server and migrate the data across?
[2013-06-13 09:24:25 -0400] z: _JamieD_: knife node edit <name>
[2013-06-13 09:24:30 -0400] m4rcu5: _JamieD_: depends on that your differences are. if you add recipes of change attributes, no problem, removing them is harder. knife node edit nodename and change the environment name
[2013-06-13 09:24:43 -0400] z: _JamieD_: it's trivial to change the environment. the ramifications of doing it can be interesting.
[2013-06-13 10:08:12 -0400] _JamieD_: z: sorry was on a long call. It's just DB credentials and domain names in nginx config that will change mostly so it should hopefully be simple
[2013-06-13 10:08:20 -0400] _JamieD_: m4rcu5: cc above
[2013-06-13 10:13:18 -0400] m4rcu5: _JamieD_: you should be fine in just changing the environment then
[2013-06-13 10:13:44 -0400] _JamieD_: m4rcu5: great, I'll give it a go now. Thanks
[2013-06-13 10:34:07 -0400] angelicvenus: Got a problem where my attributes seem to be being wiped in all cookbooks (including ones not maintained by me that I include) http://pastebin.com/VrBASrJh
[2013-06-13 10:34:13 -0400] angelicvenus: anything obvious that can cause this?
[2013-06-13 10:34:22 -0400] angelicvenus: and hello :)
[2013-06-13 10:37:18 -0400] _smadamr: do you structure your system users in data bags by cookbook, or globally?
[2013-06-13 10:39:38 -0400] angelicvenus: _smadamr, was that directed to me?
[2013-06-13 10:40:31 -0400] _smadamr: angelicvenus: hmm, it was in general. Could have made that more clear.
[2013-06-13 10:40:54 -0400] angelicvenus: ah, sorry, didn't realise you only joined after me anyway so it couldn't have been a response to me
[2013-06-13 10:41:33 -0400] angelicvenus: I structure mine in databags, use https://github.com/fnichol/chef-user
[2013-06-13 10:42:01 -0400] angelicvenus: you can change data bag per cookbook by setting node[:user][:data_bag_name]
[2013-06-13 10:43:46 -0400] _smadamr: i did take a look at chef-user. it seems like it fits my needs nicely, just wanted to check in and see if there were any alternatives
[2013-06-13 10:44:16 -0400] _smadamr: do you happen to know if it supports encrypted data bags as-is?
[2013-06-13 10:45:02 -0400] angelicvenus: actually not sure on that one what do you need them to be encrypted for, out of interest?
[2013-06-13 10:45:58 -0400] _smadamr: transfer between workstation/server/node...but in that case there's always https
[2013-06-13 10:46:05 -0400] angelicvenus: it doesn't look like it does support encrypted data bags out of the box
[2013-06-13 10:46:33 -0400] angelicvenus: yeh, I'd use secure transport for that, personally
[2013-06-13 10:46:46 -0400] _smadamr: i suppose it's more of paranoia than anything, but https does the trick.
[2013-06-13 10:46:59 -0400] angelicvenus: the data in there shouldn't be anything tooooo special anyway
[2013-06-13 10:47:11 -0400] angelicvenus: public keys, some user names
[2013-06-13 10:47:58 -0400] _smadamr: exactly, that's pretty much it. all private keys are either generated, or transferred in another manner if they happen to exist already. most of the accounts are logged into with keys anyway, so passwords aren't too much of an issue
[2013-06-13 10:49:50 -0400] _smadamr: well thanks for the tip, lunch and then gonna try out chef-user
[2013-06-13 10:50:09 -0400] angelicvenus: enjoy and gl
[2013-06-13 11:06:31 -0400] derferman: Is there any way to show progress of a remote_file download?
[2013-06-13 11:23:21 -0400] angelicvenus: is it usual that when using include_recipe, from within a recipe, that the attribute files for those recipes won't be read?
[2013-06-13 11:25:35 -0400] isbaran: angelicvenus: no
[2013-06-13 11:27:44 -0400] angelicvenus: isbaran: so if I am running `include_recipe "foo"` I should expect the default attributes for foo to be brought in?
[2013-06-13 11:27:54 -0400] isbaran: angelicvenus: yes
[2013-06-13 11:28:21 -0400] isbaran: you can also override them in your recipe
[2013-06-13 11:28:27 -0400] angelicvenus: yep
[2013-06-13 11:29:13 -0400] angelicvenus: the problem I am having is that the attribute files seem to not be being read, or the attributes are being wiped somehow
[2013-06-13 11:29:28 -0400] angelicvenus: cookbooks that I haven't even written can't access their own attributes from within their recipes
[2013-06-13 11:29:49 -0400] isbaran: how did you com to that conclusion
[2013-06-13 11:30:00 -0400] isbaran: maybe you're reading the error wrong
[2013-06-13 11:30:01 -0400] angelicvenus: http://pastebin.com/VrBASrJh
[2013-06-13 11:30:17 -0400] isbaran: or you're overwriting them somewhere
[2013-06-13 11:30:42 -0400] angelicvenus: I've looked up and down the chain, and am pretty sure I am not overwriting them
[2013-06-13 11:30:52 -0400] angelicvenus: and it seems to be every recipe I import has this problem
[2013-06-13 11:31:39 -0400] isbaran: hmm, i'm not sure about chef-solo setup, do you have the required data bag defined ?
[2013-06-13 11:32:08 -0400] angelicvenus: the users data bag?
[2013-06-13 11:32:27 -0400] isbaran: node['user']['data_bag_name']
[2013-06-13 11:32:48 -0400] isbaran: ah sorry, this comes from users data bag i guess
[2013-06-13 11:32:50 -0400] angelicvenus: that node is defined within the recipe's default attributes and I don't overwrite it
[2013-06-13 11:33:30 -0400] isbaran: angelicvenus: i have users cookbook not user, could this be the issue
[2013-06-13 11:33:41 -0400] angelicvenus: it just seems that it's attributes aren't getting imported even though it's a pretty vanilla `include_recipe "user::data_bag"` I am calling
[2013-06-13 11:33:58 -0400] angelicvenus: I have even tried wiping everything except for that line, including all of my attributes files
[2013-06-13 11:34:02 -0400] angelicvenus: and still I have the problem
[2013-06-13 11:34:12 -0400] angelicvenus: it must be something to do with how I am running chef-solo
[2013-06-13 11:36:19 -0400] angelicvenus: ok
[2013-06-13 11:36:24 -0400] angelicvenus: I think I know what this is about now
[2013-06-13 11:36:30 -0400] angelicvenus: http://tickets.opscode.com/browse/CHEF-3820
[2013-06-13 11:36:44 -0400] angelicvenus: need to define cookbook dependencies more thoroughly
[2013-06-13 11:42:28 -0400] angelicvenus: isbaran: seems to be exactly that, thanks for bouncing ideas
[2013-06-13 11:55:10 -0400] Zhann: can anyone tell me how to access node attributes in a library file?
[2013-06-13 11:55:29 -0400] Zhann: I have a class Chef::Recipe::Foo
[2013-06-13 11:55:51 -0400] Zhann: where I try to access it by: node['bar']['baz']
[2013-06-13 11:56:05 -0400] Zhann: this is what I get: undefined local variable or method `node' for #<Chef::Recipe::Foo:0x00000002cd0a58>
[2013-06-13 11:56:37 -0400] isbaran: Zhann: you should pass it as arguments
[2013-06-13 12:02:27 -0400] Zhann: was afraid so
[2013-06-13 12:02:39 -0400] Zhann: means I'll have to change a lot of files, was trying to avoid that
[2013-06-13 12:02:50 -0400] Zhann: there's no other way?
[2013-06-13 12:04:22 -0400] isbaran: Zhann: check nagios cookbook, it has libraries and resources defining node attributes
[2013-06-13 12:07:27 -0400] Zhann: thanks for the tip!
[2013-06-13 14:44:29 -0400] Hildgrim: G'day guys. After setting a notification in something_else to :delayed, is it problematic to execute it with notifies :run, "execute[something_else]", :immediately if the execute includes a not_if { ::File.exists?("/foo/bar.conf")} statement?
[2013-06-13 14:45:08 -0400] Hildgrim: I'm getting a execute[something_elese] cannot be found in the resource collection error
[2013-06-13 14:45:13 -0400] Hildgrim: else*
[2013-06-13 14:46:44 -0400] rkesters: hi, how/where do I install an Ohai plugin so that it is used by all my chef clients. I installed the chef server using the installer.
[2013-06-13 14:54:20 -0400] siezer: rkesters use the ohai cookbook from the community site
[2013-06-13 14:54:26 -0400] siezer: knife cookbook site download ohai
[2013-06-13 14:54:34 -0400] mattray: rkesters: http://community.opscode.com/cookbooks/ohai
[2013-06-13 14:55:13 -0400] _smadamr: angelicvenus: do you use chef-user with vagrant?
[2013-06-13 15:03:09 -0400] gswallow: Does anyone here use Chef on Windows?
[2013-06-13 15:10:03 -0400] erthad: hi
[2013-06-13 15:10:52 -0400] erthad: my chef run recommends me to change `node["key"] = "value"` into node.set["key"] = "value" -- is there a way to know lineno, recipe or cookbook in which this occurs?
[2013-06-13 15:12:20 -0400] isbaran: erthad: chef-client -l debug
[2013-06-13 15:17:25 -0400] guix: Does anyone know if it is possible to rename a cookbook such as: apache2 community cookbook to opscode-chef?
[2013-06-13 15:17:50 -0400] mattray: guix: in the metadata.rb, update it there
[2013-06-13 15:18:16 -0400] guix: is that the only place? becuase include_recipe entries must be changes as well right?
[2013-06-13 15:19:07 -0400] erthad: isbaran: thx, it looks like it helped
[2013-06-13 15:19:14 -0400] guix: the reason I want to do this is because I have downloaded a previous version of apache2 and forked it. Now I would like to keep the community version clean and use cookbook wrappers to override certain functions
[2013-06-13 15:19:51 -0400] guix: This means I do already have a cookbook apache2 uploaded on the chef server
[2013-06-13 15:24:54 -0400] willejs: hi all, I've was going to use the aws cookbook to automatically make certain nodes join certain load balancers however, it uses the right_aws gem, and that gem isn't compatible with VPCs?
[2013-06-13 15:25:24 -0400] willejs: the alternative is that i make it part of my provisioning tool, but i am less inclined to do that...
[2013-06-13 15:26:09 -0400] willejs: it looks like the right_aws gem is no longer very active/maintained?
[2013-06-13 15:30:46 -0400] till_: jtimberman: do you know if anyone is working on making bento work with vagrant 1.2.x ?
[2013-06-13 15:31:15 -0400] Cheeezit: is there a good way to package or persist a VM deployed by vagrant using the aws-provider
[2013-06-13 15:33:04 -0400] willejs: cheezit: in what way?
[2013-06-13 15:33:14 -0400] willejs: you mean create a custom AMI?
[2013-06-13 15:35:59 -0400] Cheeezit: williejs: maybe i'll rephrase the question, how do you handle deploying a production or staging environment using vagrant
[2013-06-13 15:36:59 -0400] Cheeezit: the vm/ec2 instances created seem to be tied to files in the .vagrant directory
[2013-06-13 15:37:19 -0400] willejs: personally i use vagrant to develop on, then when deploying to production (was) i spin up nodes using knife or autoscaling groups, and let chef take care of the heavy lifting
[2013-06-13 15:37:25 -0400] till_: Cheeezit: I saw that too, hence we're not using it to deploy production
[2013-06-13 15:37:33 -0400] till_: i use it to spin up a test cluster, but that's it
[2013-06-13 15:37:39 -0400] willejs: (*aws)
[2013-06-13 15:38:14 -0400] Cheeezit: so maybe i need to transition package the custom cookbook and use chef server to manage those nodes
[2013-06-13 15:38:34 -0400] willejs: vagrant is just for development really
[2013-06-13 15:39:15 -0400] bean: yeah. I'd only use vagrant for dev.
[2013-06-13 15:39:25 -0400] bean: chef server is probably the way to go
[2013-06-13 15:39:27 -0400] bean: or hosted chef
[2013-06-13 15:39:33 -0400] zackf: Anyone here hack on erchef?
[2013-06-13 15:41:22 -0400] Cheeezit: thanks for the info guys
[2013-06-13 15:41:23 -0400] tabolario: willejs: we have a separate base_aws role that uses our base role that we use for the aws-specific stuff
[2013-06-13 15:41:40 -0400] Cheeezit: hmm i was told to avoid roles :P
[2013-06-13 15:42:08 -0400] tabolario: oh, is that the general guidance now? if so then i'm very interested to hear the reasons
[2013-06-13 15:42:21 -0400] paulmooring: tabolario: because roles are not versioned
[2013-06-13 15:42:37 -0400] paulmooring: (I'm not agreeing, just explaining)
[2013-06-13 15:43:05 -0400] tabolario: ah
[2013-06-13 15:43:26 -0400] Cheeezit: let me see if i can dig up the links
[2013-06-13 15:43:47 -0400] paulmooring: also that's not really universally accepted, just what part of the "Berkshelf way" from Riot Games
[2013-06-13 15:43:50 -0400] willejs: tabolario: does the cookbook in the role attach detach nodes from elbs?
[2013-06-13 15:44:01 -0400] Cheeezit: yeah, i think that's where i pulled the idea from
[2013-06-13 15:44:20 -0400] Cheeezit: or heard it referenced
[2013-06-13 15:44:33 -0400] willejs: i use roles to describe nodes, and to contain wrapper cookbooks
[2013-06-13 15:44:54 -0400] tabolario: willejs: well, for our nodes that use ebs, i have an aws-raid cookbook that wraps the opscode aws cookbook and let's me specify raid arrays with attributes
[2013-06-13 15:44:57 -0400] willejs: not a fan of recipies and attributes in roles, personally. willing to be shown a better way...
[2013-06-13 15:45:35 -0400] paulmooring: willejs: I'm confused what's left if you take out recipes and attributes
[2013-06-13 15:45:42 -0400] paulmooring: are they basically tags at that point
[2013-06-13 15:46:02 -0400] willejs: tabolario: ahh yes, I'm doing the same. but the elb provider is broken for elbe in VPCs
[2013-06-13 15:46:13 -0400] willejs: paulmooring: putting wrapper cookbooks inside them
[2013-06-13 15:46:18 -0400] willejs: so i can search for nodes with that role
[2013-06-13 15:46:26 -0400] willejs: as recipes are only searchable after a chef run
[2013-06-13 15:46:36 -0400] tabolario: that's another reason i use roles, because (unless i'm missing something), you can't search for a node based on a particular recipe it uses from a cookbook
[2013-06-13 15:46:53 -0400] paulmooring: hmm, aren't wrapper cookbooks recipes? or am I misunderstanding that term?
[2013-06-13 15:47:15 -0400] tabolario: i have roles like appname-app-server, appname-worker-server, etc., and those are used to determine upstreams for nginx, etc.
[2013-06-13 15:47:17 -0400] willejs: yeah they are, they are cookbooks wrapping community cookbooks, and overriding values
[2013-06-13 15:47:54 -0400] paulmooring: ah ok, so you wrap up community cookbooks in wrapper cookbooks and still put a run_list in the role
[2013-06-13 15:48:02 -0400] paulmooring: that is also my perferred approach
[2013-06-13 15:48:23 -0400] Cheeezit: Jamie Winsor mentioned avoiding roles when writing encapsulated cookbooks in his presentation - http://www.youtube.com/watch?v=hYt0E84kYUI
[2013-06-13 15:48:24 -0400] willejs: yeah, exactly
[2013-06-13 15:48:25 -0400] willejs: http://devopsanywhere.blogspot.co.uk/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-06-13 15:48:29 -0400] Cheeezit: it's around the 25 min mark
[2013-06-13 15:49:27 -0400] Cheeezit: its a great presentation all around
[2013-06-13 15:49:45 -0400] Cheeezit: and league of legends is awesome anyways :)
[2013-06-13 15:50:03 -0400] MrBIOS: dafuq?
[2013-06-13 15:50:06 -0400] tabolario: i'm more of a minecraft person myself :)
[2013-06-13 15:50:26 -0400] Cheeezit: don't ge me started on trying to mod minecraft for the kids
[2013-06-13 15:50:35 -0400] Cheeezit: needs more standards imo
[2013-06-13 15:50:44 -0400] paulmooring: Cheeezit: yeah I've seen that and Jamie is a smart guy, nothing wrong with doing it that way if it works for you
[2013-06-13 15:51:07 -0400] Cheeezit: yeah, i'm not advocating changing workflows for anyone w/e works for you is great
[2013-06-13 15:51:11 -0400] MrBIOS: my most recent knife bootstrap is failing with. /var/lib/gems/1.8/gems/chef-11.4.4/bin/../lib/chef/resource/lwrp_base.rb: "Evaluates the LWRP resource file and instantiates a new Resource class. def self.build_from_file(cookbook_name, filename, run_context) rname = filename_to_qualified_string(cookbook_name, filename)
[2013-06-13 15:51:13 -0400] MrBIOS: any advice?
[2013-06-13 15:51:15 -0400] tabolario: ah i haven't looked into chef-rewind yet
[2013-06-13 15:51:21 -0400] MrBIOS: I have no idea what is going on
[2013-06-13 15:51:24 -0400] Cheeezit: i've only been doing this for about 2 months so i'm by no means an expert
[2013-06-13 15:51:50 -0400] tabolario: i need to start hanging out in here more, i'm going to be doing the second edition of my book soon with chef instead of puppet
[2013-06-13 15:52:01 -0400] paulmooring: tabolario: what book?
[2013-06-13 15:52:05 -0400] tabolario: Deploying Rails
[2013-06-13 15:52:18 -0400] c_t: Yertle the DevOps Turtle
[2013-06-13 15:52:29 -0400] Cheeezit: c_t: sold
[2013-06-13 15:52:31 -0400] _smadamr: anyone familiar with chef-users on vagrant? having trouble determining if the fact that the users aren't created upfront is due to vagrant or my cookbook itself
[2013-06-13 15:53:12 -0400] tabolario: the first edition was all puppet, but i haven't actually used puppet for some time now, been mostly about chef for the last year and a half or so, and just launched a new aws infrastructure at work with chef
[2013-06-13 15:53:39 -0400] Cheeezit: are most of you sys admins or systems engineers, just curious
[2013-06-13 15:54:04 -0400] tabolario: i'm a software developer turned passionate for sysadmin/devops
[2013-06-13 15:54:24 -0400] c_t: I've been doing both dev and sysadmin work since time immemorial
[2013-06-13 15:55:25 -0400] Cheeezit: i'm a sysadmin gravitating towards software engineer
[2013-06-13 15:55:45 -0400] tabolario: i would consider myself a junior sysadmin if anything on that side of things but a good deal of experience with configuration management
[2013-06-13 15:56:41 -0400] tabolario: kind of the implied sysadmin where i work now
[2013-06-13 15:58:02 -0400] Cheeezit: dropping off for lunch, thx again for the insights
[2013-06-13 16:01:07 -0400] mmccarthy: The guys over in #learnchef couldn't help. I am trying to create a server using a role, but every time I run the role I get an error "he following cookbooks are required by the client but don't exist on the server:" and  under that it says "roles".
[2013-06-13 16:01:48 -0400] mmccarthy: I am able to run a role with a simple runlist if "recipe[apt]" but seems like as soon as I add more than that I get the error above. I tried to recreate my runlist from the web client (hosted chef), and get the same error.
[2013-06-13 16:01:58 -0400] _smadamr: mmccarthy: are you using a wrapper cookbook?
[2013-06-13 16:02:19 -0400] mmccarthy: _smadamr: I'm not sure what that means, but I don't think so.
[2013-06-13 16:02:54 -0400] tabolario: did you upload all of your cookbooks to the chef server?
[2013-06-13 16:03:21 -0400] _smadamr: mmccarthy: I ask because I had a similar problem with recipes when I used a wrapper cookbook. I avoided it by defining a run_list instead of a pseudo-run_list within the wrapper cookbook
[2013-06-13 16:03:32 -0400] mmccarthy: yes, they were uploaded after every/any change. Even tried creating it on the server, same issue.
[2013-06-13 16:04:08 -0400] mmccarthy: _smadamr: I am just using a role, to run different recipes. Not a cookbook to run other recipes.
[2013-06-13 16:06:23 -0400] mmccarthy: Here is the role: http://pastebin.com/hcdQmdvJ
[2013-06-13 16:06:45 -0400] mmccarthy: at least one incarnation of it, it's super simple, not sure how that can fail.
[2013-06-13 16:08:55 -0400] c_t: tabolario: That reminded me of a question I was wondering about recently
[2013-06-13 16:09:11 -0400] c_t: Do people actually buy computer/tech books these days?
[2013-06-13 16:09:49 -0400] tabolario: Well, we sold decently on that book in imo, ~4500 copies (mostly ebooks)
[2013-06-13 16:09:55 -0400] joshmyers: hey guys, anyone know how I can do something like when node.name/^bla/ do a chef block ......
[2013-06-13 16:10:02 -0400] joshmyers: but only if the node.name matches
[2013-06-13 16:10:05 -0400] joshmyers: ?
[2013-06-13 16:10:37 -0400] tabolario: you could just do a regular conditional with a regular expression on the node name couldn't you?
[2013-06-13 16:10:47 -0400] tabolario: regular == ruby
[2013-06-13 16:10:52 -0400] joshmyers: so something like
[2013-06-13 16:11:05 -0400] joshmyers: if node.name[/^bla]
[2013-06-13 16:11:07 -0400] joshmyers: chef block
[2013-06-13 16:11:08 -0400] joshmyers: end
[2013-06-13 16:11:08 -0400] joshmyers: ?
[2013-06-13 16:11:10 -0400] tabolario: if node.name =~ /.../; chef block; end
[2013-06-13 16:11:30 -0400] joshmyers: cool thx will try
[2013-06-13 16:11:46 -0400] tabolario: c_t: personally i'm still trying to collect all the more timeless tech books (design patterns, refactoring, etc.)
[2013-06-13 16:11:57 -0400] tabolario: c_t: and i never buy print books anymore
[2013-06-13 16:13:05 -0400] c_t: indeed
[2013-06-13 16:13:23 -0400] c_t: I've been making use of ebooks a lot more lately, finally
[2013-06-13 16:14:02 -0400] tabolario: c_t: i wish i could do the second edition in more of an evolving ebook-as-a-website thing, but at least for this go-around i'm still going to go through my publisher
[2013-06-13 16:14:14 -0400] tabolario: i think i'm going to supplement this time with a blog, maybe screencasts
[2013-06-13 16:15:06 -0400] tabolario: i feel like books are still a worthwhile investment for some people, especially those starting out in a topic, worth paying that $20 so they don't necessarily have to google everything
[2013-06-13 16:15:29 -0400] c_t: yeah, some of the tech books are really handy
[2013-06-13 16:15:38 -0400] c_t: especially, as you said, the timeless ones
[2013-06-13 16:59:23 -0400] djustin: is there a variable or attribute that defines the name of the curren recipe running?
[2013-06-13 16:59:31 -0400] djustin: ^current
[2013-06-13 17:11:35 -0400] piclez: hello, is there a recipe or package to install rvm?
[2013-06-13 17:17:16 -0400] sascha_d: @piclez https://github.com/fnichol/chef-rvm
[2013-06-13 17:17:59 -0400] willejs: anyone autoscaling in was vpc?
[2013-06-13 17:18:09 -0400] willejs: and, using elastic ips?
[2013-06-13 17:18:15 -0400] willejs: *aws
[2013-06-13 17:18:52 -0400] piclez: thanks sascha_d
[2013-06-13 17:19:06 -0400] piclez: also any recipe for rbenv?!
[2013-06-13 17:20:23 -0400] sascha_d: same url, sub rbenv
[2013-06-13 17:22:14 -0400] piclez: sweet
[2013-06-13 17:29:09 -0400] Otterley: is there a cookbook review meeting today?
[2013-06-13 17:34:52 -0400] michaelhart: how does chef-client know if there's an existing chef-client run happening? That is, when I see this in the chef client log, what's the mechanism by which it determines it? "Chef client  is running, will wait for it to finish and then run."
[2013-06-13 17:36:51 -0400] awgross: knuckolls: so I figured out that Vagrant Plugin config issue: https://github.com/RiotGames/vagrant-berkshelf/issues/14#issuecomment-19409321
[2013-06-13 17:36:57 -0400] awgross: it gets really dark
[2013-06-13 17:37:16 -0400] willejs: michaelhart: I'm guessing it checks a pidfile, or process
[2013-06-13 17:37:20 -0400] willejs: mostlilkely pidfile.
[2013-06-13 17:38:11 -0400] michaelhart: @willejs i guessed that too, but I'm not entirely sure anymore. I've got chef-client running as a daemon, pidfile is there always, regardless if the chef run is happening or not.
[2013-06-13 17:38:41 -0400] Otterley: michaelhart, hopefully it sends a kill -0 to the PID located in the pidfile first
[2013-06-13 17:38:48 -0400] willejs: thats a good point
[2013-06-13 17:38:48 -0400] asharp: how does chef check if a package is already installed? it doesn't seem to detect installed Java
[2013-06-13 17:38:53 -0400] Otterley: if it returns 0, it means the process is already running
[2013-06-13 17:39:03 -0400] willejs: i only encountered this properly today, now i have started running it as a daemon
[2013-06-13 17:40:15 -0400] michaelhart: lol me too. I have a weird bug, if chef hits some exceptions (timeout to chef server) it ends the run, but the next run thinks the previous run is still in progress and hangs forever.
[2013-06-13 17:41:02 -0400] Otterley: the consensus here seems to be that running from cron is the best practice, daemon mode has lots of warts
[2013-06-13 17:41:27 -0400] awgross: Otterley: the main problem with cron is the lack of splay
[2013-06-13 17:41:44 -0400] Otterley: so preface your cron job with:
[2013-06-13 17:41:46 -0400] awgross: Otterley: not impossible to fix, but could be bad with a large number of noes
[2013-06-13 17:41:50 -0400] Otterley: SHELL=/bin/bash
[2013-06-13 17:42:33 -0400] Otterley: and then the command could be sleep $(($RANDOM \% 60)) && ...
[2013-06-13 17:42:48 -0400] Otterley: or whatever you want your splay to be
[2013-06-13 17:42:53 -0400] awgross: fair enough
[2013-06-13 17:43:22 -0400] hakunin: So the official nginx cookbook is still broken
[2013-06-13 17:44:07 -0400] michaelhart: alternately you could set the minute on the cron job with a random minute. I have a daily restart cron job in place for chef to "fix" this hanging problem already. It's ugly though, i'd much prefer to have the daemon mode working.
[2013-06-13 17:44:30 -0400] hakunin: i remember last time i tried it almost a year ago, it was broken as well, but differently
[2013-06-13 17:44:35 -0400] hakunin: so i forked and rewrote a bunch of it
[2013-06-13 17:44:52 -0400] hakunin: was hoping to finally just depend on official one
[2013-06-13 17:44:52 -0400] Otterley: michaelhart, that works too
[2013-06-13 17:45:17 -0400] Otterley: running it from runit also works
[2013-06-13 17:45:49 -0400] michaelhart: Thanks Otterley and awgross, I will log a bug for this and if I can't solve it shortly I'll switch to cron.
[2013-06-13 17:45:53 -0400] hakunin: It doesn't respect the version i'm setting, because of ohai it seems
[2013-06-13 17:47:16 -0400] hakunin: It's unusual given how popular it must be
[2013-06-13 17:48:41 -0400] hakunin: Not sure if this is really a fix, but it's been sitting there for a year, and cannot be considered because pull requester didn't follow guidelines: https://github.com/opscode-cookbooks/nginx/pull/14
[2013-06-13 17:48:50 -0400] willejs: vpc elastic ip allocation and association? how do people do this with chef?
[2013-06-13 17:49:44 -0400] awgross: willejs: normally I assign before bootstrapping, (after instance created, before SSH happens)
[2013-06-13 17:52:22 -0400] willejs: what about in autoscale groups? :D
[2013-06-13 17:52:30 -0400] willejs: thats my problem...
[2013-06-13 17:52:37 -0400] asharp: how does chef check if a package is already installed? it doesn't seem to detect installed Java
[2013-06-13 17:52:49 -0400] Otterley: asharp, check the package provider source
[2013-06-13 17:52:55 -0400] willejs: also, how do you do that with knife ec2 server create
[2013-06-13 17:53:05 -0400] Otterley: it depends on the distribution
[2013-06-13 17:53:52 -0400] willejs: awgross: theres no chef cookbook for it right?
[2013-06-13 17:54:07 -0400] swhite: i've got a weird issue that I can't figure out  I'm using the zabbix recipe from https://github.com/laradji/zabbix and when I add the zabbix::database to the end of my run list, somehow it tries to run mysql::client as the first thing in my list.  This always fails because it's running before apt-get update (which is supposed to run first)
[2013-06-13 17:54:43 -0400] swhite: has anyone seen an issue where a recipe somehow changes the run_list order at execution-time?
[2013-06-13 17:54:55 -0400] asharp: Otterley: thanks
[2013-06-13 17:55:14 -0400] Otterley: swhite, other than by include_recipe ?
[2013-06-13 17:56:05 -0400] swhite: yes, it has to be somehow bumping itself above other items in the run list
[2013-06-13 18:03:41 -0400] RayS: anyone here install ElasticSearch via chef? I'm getting "NameError: uninitialized constant Extensions"
[2013-06-13 18:04:24 -0400] michaelhart: regarding my question about chef client knowing when another chef client is running, it's done via File.lock (ruby class), essentially flock() on the pid file, which in my case is /var/cache/chef/chef-client-running.pid. code found in chef/run_lock.rb in the chef gem.
[2013-06-13 18:04:41 -0400] awgross: willejs: unsure for during a run
[2013-06-13 18:07:58 -0400] michaelhart: Bug opened: http://tickets.opscode.com/browse/CHEF-4274
[2013-06-13 18:11:58 -0400] kallistec: michaelhart: that's already fixed in master
[2013-06-13 18:12:46 -0400] michaelhart: bah, i looked for it. my search-fu was not good enough I guess. what bug # is it?
[2013-06-13 18:12:54 -0400] swhite: Anyone have an idea how I can fix this:
[2013-06-13 18:12:55 -0400] swhite: sudo chef-client -o "recipe[ubuntu::default]" -W ---> first Recipe: apt::default (expected)
[2013-06-13 18:12:56 -0400] swhite: sudo chef-client -o "recipe[ubuntu::default],recipe[zabbix::database]" -W ---> first Recipe: build-essential::debian
[2013-06-13 18:12:57 -0400] swhite: why is apt not running first?
[2013-06-13 18:13:24 -0400] kallistec: michaelhart: CHEF-4010
[2013-06-13 18:14:20 -0400] michaelhart: kallistec thank you, I will close mine. Apologies.
[2013-06-13 18:14:31 -0400] kallistec: michaelhart: already done :)
[2013-06-13 18:14:47 -0400] michaelhart: :) anyone know when chef client 11.6 is coming out?
[2013-06-13 18:17:01 -0400] juliancdunn: michaelhart: spox says mid-July
[2013-06-13 18:17:08 -0400] michaelhart: thank you!
[2013-06-13 18:17:19 -0400] juliancdunn: (hopefully :-) )
[2013-06-13 18:17:28 -0400] spox: yay, i'm call chef releases now \o/
[2013-06-13 18:17:43 -0400] teukka: michaelhart: http://lists.opscode.com/sympa/arc/chef/2013-06/msg00206.html
[2013-06-13 18:20:33 -0400] swanson: Hey all.  I've got a thing where when Chef runs a restart of my jetty service it doesn't come up right (can't make javascript compressed bundles), but when I restart jetty manually it can.  I think this is more Jetty-specific than Chef-specific, but I'd love to hear any wisdom about what is different environmentally when this stuff is done in Chef.  I have the impression it's not bound to a TTY in the same way, but I haven't plumbed those dep
[2013-06-13 18:23:42 -0400] awgross: swanson: TTY is a good place to start, I know on ubuntu the "default" shell for shell out is 'dash', though my TTY is bash
[2013-06-13 18:30:12 -0400] swanson: awgross:  Ahh, I hadn't thought of a different shell running the programs, though I'd considered the likelihood that the program might be getting forked without a shell at all.  Maybe I'll try replacing the service start/stop with a little custom provider that does it through bash -- at least as an experiment, if not as a real fix.  Thanks!
[2013-06-13 18:34:24 -0400] piclez: sascha_d, in which file/where I specify the rvm attibutes?
[2013-06-13 18:35:44 -0400] Otterley: @kallistec, don't use flock, just do kill -0, flock doesn't tell you if the PID is accurate
[2013-06-13 18:37:33 -0400] kallistec: Otterley: that's not designed to handle race conditions the way flock is
[2013-06-13 18:37:45 -0400] Otterley: ok, then do both
[2013-06-13 18:37:50 -0400] Otterley: you're relying on it for multiple purposes
[2013-06-13 18:37:52 -0400] kallistec: e.g, start 2 chef clients at exactly the same time
[2013-06-13 18:38:15 -0400] Otterley: if the pid isn't accurate then trying to stop the service manually won't work either
[2013-06-13 18:38:24 -0400] Otterley: but perhaps we're discussing two separate problems
[2013-06-13 18:38:25 -0400] kallistec: no, it's only used as a lock. the file could be empty for all anyone cares, we just write the pid as a convenience
[2013-06-13 18:38:55 -0400] Otterley: the initscript doesn't look at the value of the pidfile for determining which process to kill?
[2013-06-13 18:39:00 -0400] kallistec: note that it's separate from the pidfile that chef creates when you run it daemonized
[2013-06-13 18:39:19 -0400] Otterley: I se
[2013-06-13 18:39:20 -0400] Otterley: see
[2013-06-13 18:39:54 -0400] kallistec: TBH, the daemonization code should probably have a flock as well, I think it may be subject to race conditions
[2013-06-13 18:40:17 -0400] Otterley: writing daemons is hard and best avoided if you can
[2013-06-13 18:40:39 -0400] Otterley: that's why I like runit so much
[2013-06-13 18:40:49 -0400] kallistec: yeah, I'd rather everyone just used runit
[2013-06-13 18:53:35 -0400] wdpro_kevin: hai
[2013-06-13 18:53:42 -0400] wdpro_kevin: test-kitchen question: Can I pass the target chef environment to the vagrant vms via the .kitchen.yml?
[2013-06-13 18:53:52 -0400] mmccarthy: I am trying to install Java with the opscode Java cookbook. For some reason it is installing both open jdk and oracle jdk. I am using a wrapper cookbook and node.override to set the java install_flavor. Any ideas why both are installed?
[2013-06-13 19:04:15 -0400] juliancdunn: wdpro_kevin: what do you mean by "environment"
[2013-06-13 19:04:46 -0400] wdpro_kevin: chef_environment
[2013-06-13 19:05:04 -0400] wdpro_kevin: I'm goign to try and pass it as an attribute
[2013-06-13 19:05:54 -0400] wdpro_kevin: I have some conditionals in my recipe that depend on which chef environment the node is in
[2013-06-13 19:06:20 -0400] wdpro_kevin: I wasn't sure how to fake that in chef-solo mode
[2013-06-13 19:06:33 -0400] juliancdunn: wdpro_kevin: yeah.. chef solo doesn't have environments
[2013-06-13 19:08:36 -0400] wdpro_kevin: it would be good to have a way to fake it for testing purposes
[2013-06-13 19:09:13 -0400] wdpro_kevin: I'm sure some way in the attributes setting chef_environment didn't seem to work
[2013-06-13 19:10:23 -0400] cwj: chef_environment isnt an attribute, so setting attributes wont influence it
[2013-06-13 19:10:46 -0400] cwj: perhaps you should check whether Chef::Config[:solo] is true and then fake whatever is required
[2013-06-13 19:11:40 -0400] cwj: http://tickets.opscode.com/browse/CHEF-3356 seems relevant fwiw
[2013-06-13 19:11:46 -0400] wdpro_kevin: I'm doing this via test-kitchen so didnt' know if there was something
[2013-06-13 19:13:44 -0400] wdpro_kevin: thanks cwj. I'm looking at that page
[2013-06-13 19:14:23 -0400] cwj: i doubt if the kitchen-vagrant driver has any wiring for the feature described in that ticket
[2013-06-13 19:14:30 -0400] cwj: but i havent looked
[2013-06-13 19:17:29 -0400] RayS: Anyone here install ElasticSearch via chef? I'm getting "NameError: uninitialized constant Extensions"
[2013-06-13 19:28:32 -0400] yanc0: I everybody, I am wondering how to automaticaly create a complete achitecture loadbalanced on aws ec2 with chef. I want to create a database server with a 'random' IP address, I want to get it and put it in many webservers configuration. How can I do?  Thanks
[2013-06-13 19:33:51 -0400] cheflevelramen: yanc0: This is a pretty loaded question. There is a lot to the explanation, and you'd likely be better off doing some tutorials on AWS EC2/Chef, if you aren't familiar with the products. As for the IP address, AWS will automatically create a random IP. If you are using Hosted or Private Chef, you can use search to search the node's ohai data for that node's IP address.
[2013-06-13 19:36:52 -0400] yanc0: cheflevelramen: thank you! I'm interested by the search function. I will read stuff about that. Thanks ;)
[2013-06-13 19:37:39 -0400] cheflevelramen: yanc0: np, good luck
[2013-06-13 19:47:47 -0400] mmccarthy: It turns out Tomcat was installing open jdk after oracle jdk was installed. Is there a good way to stop open jdk from being installed during tomcat installation?
[2013-06-13 19:49:08 -0400] juliancdunn: mmccarthy: whose cookbook are you using?
[2013-06-13 19:49:18 -0400] mmccarthy: opscode
[2013-06-13 19:50:23 -0400] juliancdunn: that's weird
[2013-06-13 19:50:36 -0400] juliancdunn: because all that cookbook does is "include_recipe "java"
[2013-06-13 19:51:13 -0400] mmccarthy: It sure is. Just tested it, install java (opscode) installs only oracle jdk, install tomcat installs oracle JDK and open jdk.
[2013-06-13 19:51:32 -0400] juliancdunn: mmccarthy: what OS are you on?
[2013-06-13 19:51:39 -0400] mmccarthy: juliancdunn: ubuntu
[2013-06-13 19:51:47 -0400] mmccarthy: 10.04
[2013-06-13 19:51:59 -0400] juliancdunn: I wonder if your OS's tomcat packages depending on its idea of Java "being installed" and that's how openjdk is getting sucked in
[2013-06-13 19:52:09 -0400] mmccarthy: I was thinking that also
[2013-06-13 19:52:36 -0400] mmccarthy: Depends: default-jre-headless | java6-runtime-headless, libecj-java, libcommons dbcp-java, libcommons-pool-java, libservlet2.5-java (>= 6.0.24-2ubuntu1)
[2013-06-13 19:52:46 -0400] mmccarthy: Somewhere down the line tomcat has those dependencies.
[2013-06-13 19:53:21 -0400] juliancdunn: so, since the Java cookbook is installing Sun Java from a tarball and not a deb, apt thinks it still needs a Java
[2013-06-13 19:54:30 -0400] mmccarthy: I hate to be dim, but how can I fix that?
[2013-06-13 19:54:50 -0400] juliancdunn: it depends on how you'd do it without Chef, I guess
[2013-06-13 19:54:57 -0400] juliancdunn: and then try to solve the problem in Chef
[2013-06-13 19:55:03 -0400] jtimberman: yeah
[2013-06-13 19:55:04 -0400] jtimberman: so
[2013-06-13 19:55:08 -0400] jtimberman: oracle's java doesn't come from apt
[2013-06-13 19:55:22 -0400] jtimberman: in fact iirc its not a package at all.
[2013-06-13 19:55:29 -0400] juliancdunn: jtimberman: does debian have a way to apt-get an Oracle Java?
[2013-06-13 19:55:35 -0400] jtimberman: juliancdunn: LMAO. no.
[2013-06-13 19:55:41 -0400] juliancdunn: jtimberman: I know, I just had to ask :)
[2013-06-13 19:55:42 -0400] mmccarthy: right, so I guess if there is a way to tell apt that java is installed, if not that, reset the default jdk after open jdk is installed using alternatives.
[2013-06-13 19:56:00 -0400] jtimberman: mmccarthy: it's not at the alternatives level
[2013-06-13 19:56:22 -0400] jtimberman: mmccarthy: tomcat package metadata says "I need a java package!" It has no idea that you "have" a java package in the form of the Oracle install.
[2013-06-13 19:56:33 -0400] mmccarthy: jtimberman: Well, the java version used is reset from oracle jdk to open jdk. I think this is done using alternatives, no?
[2013-06-13 19:56:49 -0400] jtimberman: the alternatives system just updates symlinks
[2013-06-13 19:56:53 -0400] jtimberman: it doesn't touch the package manager.
[2013-06-13 19:57:08 -0400] jtimberman: you could untar a directory with a shell script called "java" and point alternatives to taht.
[2013-06-13 19:58:17 -0400] jtimberman: the tomcat cookbook is coupled w/ the package manager, so you either use it with openjdk, or you'd have to write a recipe to manage tomcat installation as a jar.
[2013-06-13 19:58:32 -0400] jtimberman: e.g., grab the jar from apache.org or whereever
[2013-06-13 19:59:01 -0400] juliancdunn: or, just live with having an extra JRE on the system
[2013-06-13 19:59:07 -0400] juliancdunn: that's not used
[2013-06-13 19:59:10 -0400] juliancdunn: which is what I usually do :-)
[2013-06-13 19:59:55 -0400] siezer: is there a attribute for which java is default?
[2013-06-13 20:00:14 -0400] mmccarthy: juliancdunn: The point is that when Tomcat installs openjdk (or I guess apt), tomcat ends up using open jdk rather than the oracle that was previously installed. I need tomcat to use oracle.
[2013-06-13 20:00:45 -0400] mmccarthy: siezer: I think their might be
[2013-06-13 20:00:50 -0400] siezer: default['java']['install_flavor'] = "openjdk"
[2013-06-13 20:00:56 -0400] siezer: try setting that to oracle
[2013-06-13 20:01:08 -0400] siezer: then include_recipe "java" should just do the right thing
[2013-06-13 20:01:35 -0400] siezer: also you have to give oracle a cookie
[2013-06-13 20:01:48 -0400] mmccarthy: siezer: That's what I'm doing. Since Oracle is installed as a tarball apt doesnt know about it. When installing tomcat, open jdk is installed also.
[2013-06-13 20:01:57 -0400] jtimberman: siezer: thats not going to fix the issue.
[2013-06-13 20:02:07 -0400] juliancdunn: mmccarthy: I'll bet the installation of openjdk mucks with alternatives
[2013-06-13 20:02:07 -0400] siezer: well I guess I'm confused then
[2013-06-13 20:02:09 -0400] jtimberman: the issue is the tomcat package wants the java package, openjdk provides it.
[2013-06-13 20:02:27 -0400] mmccarthy: juliancdunn: Exactly, openjdk does muck with alternatives!
[2013-06-13 20:02:57 -0400] juliancdunn: gahhh
[2013-06-13 20:03:10 -0400] juliancdunn: so then you'll have to write a recipe to update it after tomcat is installed
[2013-06-13 20:04:08 -0400] rkesters: I have a chef-repo that includes a number of data bags, I want to be about to upload them to a new chef server. I am required to manually create the bags before using upload from file?
[2013-06-13 20:04:23 -0400] mmccarthy: juliancdunn: Going to give it a try, will report back afterwards.
[2013-06-13 20:04:33 -0400] siezer: o i c
[2013-06-13 20:06:18 -0400] siezer: wait I'm not seeing that
[2013-06-13 20:06:30 -0400] siezer: I see tomcate doing an include_recipe "java"
[2013-06-13 20:07:04 -0400] siezer: oOOOOH the platform package
[2013-06-13 20:15:22 -0400] tobin: can someone help me with a simple recipe loop? http://paste.ubuntu.com/5762596/
[2013-06-13 20:15:44 -0400] tobin: Im new to chef/ruby. trying to pull a item out of a databag
[2013-06-13 20:15:55 -0400] tobin: and loop over users_manage
[2013-06-13 20:22:07 -0400] aub_: i'm using "knife ec2 server create" to spin up new instances. as i'm just getting started, this fails with various errors midway through the provisioning of the host. is there a way to get it to just restart the provision?
[2013-06-13 20:22:24 -0400] aub_: I've been doing it by deleting the node and starting over, but that takes forever
[2013-06-13 20:24:08 -0400] cheflevelramen: aub_: Depends. If it's failing because of EC2 or knife information, than no. If that's the case, remove all recipes/cookbooks from runlist and do that until you have a blank server coming up. If it's failing because of a recipes failing, then my suggestion would be to look into Vagrant and change your workflow to test locally first.
[2013-06-13 20:24:28 -0400] cheflevelramen: aub_: Otherwise I'm not sure if there is a way to restart a run. Someone else may know
[2013-06-13 20:25:10 -0400] aub_: cheflevelramen: ok, thanks. it's the latter, and i've gotten it working with vagrant but have had some things fail differently in ec2
[2013-06-13 20:26:56 -0400] juliancdunn: aub_: test with the vagrant-aws plugin :)
[2013-06-13 20:27:16 -0400] aub_: juliancdunn: oh, neat. will try that. thanks
[2013-06-13 20:27:18 -0400] cheflevelramen: aub_: Ah, okay. Well, another thing I do sometimes is just bring up a machine with no runlists, and then add the runlists after the instance is up and running. That way you can just rerun chef-client until it works, without having to reboot the machine each time. Unfortunately, sometimes there are errors that only happen on boot
[2013-06-13 20:27:40 -0400] awgross: Getting the `Trace/BPT trap: 5` issue on OSX when using Ridley due to WinRM, anyone know of a workaround?
[2013-06-13 20:27:45 -0400] cheflevelramen: juliancdunn: What what WHAT!? There's a vagrant-aws plugin? I must look into this
[2013-06-13 20:27:47 -0400] aub_: cheflevelramen: good idea, thanks
[2013-06-13 20:28:31 -0400] cheflevelramen: aub_: np
[2013-06-13 20:32:22 -0400] mmccarthy: jtimberman: juliancdunn: If I re-symlink the /usr/lib/jvm/default-java dir after openjdk overwrites it, seems to work as I expect. I haven't figured out how to get that into a recipe yet though.
[2013-06-13 20:32:27 -0400] juliancdunn: cheflevelramen: yup! and written by mitchellh too!!
[2013-06-13 20:32:58 -0400] cheflevelramen: juliancdunn: so awesome. Reading the docs now. Thanks for the heads up!
[2013-06-13 20:33:04 -0400] juliancdunn: sure!
[2013-06-13 20:34:27 -0400] hakunin: Is there any updates on the status of nginx cookbook? Currently it seems impossible to install any non-default version. /cc jtimberman
[2013-06-13 20:34:45 -0400] awgross: ahh, solved it
[2013-06-13 20:35:08 -0400] awgross: requiring 'ridley' earlier in my code fixes the problem.  Why does ruby have so many silly issues like this
[2013-06-13 20:35:10 -0400] deven_: yo!
[2013-06-13 20:35:16 -0400] hakunin: it's probably one of the most fragmented/forked cookbooks
[2013-06-13 20:36:07 -0400] deven_: can someone tell me what's recommended practice to populate chef server with all dependant cookbooks.
[2013-06-13 20:37:37 -0400] cheflevelramen: deven_: If you haven't already, take a look at Berkshelf.
[2013-06-13 20:37:42 -0400] awgross: deven_: berks upload
[2013-06-13 20:39:03 -0400] deven_: perfect! thanks guys!
[2013-06-13 20:41:19 -0400] deven_: sorry to bother once again, have you guys seen: "Ridley::Connection crashed!" "certificate verify failed" while performing `berks upload`
[2013-06-13 20:41:42 -0400] cheflevelramen: juliancdunn: vagrant-aws looks really cool. I'm curious how it fits into the workflow when compared to knife-ec2. Do you find yourself using vagrant-aws instead? Or do the compliment each other somehow?
[2013-06-13 20:44:09 -0400] asharp: if i want to create a file in a users home directory and i don't know the users username, how do i know the path to create the file?
[2013-06-13 20:44:10 -0400] ivanoats: is there  recipe for chef 11 for ruby that works? I don't care if it's rvm, rbenv, or just compiled..
[2013-06-13 20:44:27 -0400] spheromak: chruby rbenv  i've had both those work fine
[2013-06-13 20:44:33 -0400] deven_: Alright my bad, i was in bad ruby env.
[2013-06-13 20:44:36 -0400] spheromak: rbenv from RiotGames
[2013-06-13 20:45:59 -0400] mwatson: I can't seem to find the path where the node data is stored on the chef-server. any help?
[2013-06-13 20:47:31 -0400] ivanoats: cool thanks spheromak, I'll try rbenv from RiotGames on github
[2013-06-13 20:48:45 -0400] Death_Syn: i use ruby_installer cookbook
[2013-06-13 20:48:50 -0400] Death_Syn: seems to work fine on my chef 11 clients
[2013-06-13 20:52:24 -0400] tabolario: ivanoats: i use the ruby_build cookbook
[2013-06-13 20:52:35 -0400] asharp: just trying to run chef-solo, getting this error
[2013-06-13 20:52:36 -0400] asharp: NoMethodError: undefined method `delete' for role[test-users]:Chef::Role
[2013-06-13 20:52:46 -0400] ivanoats: Death_Syn tabolario are those on community.opscode.com ?
[2013-06-13 20:55:09 -0400] jtimberman: hakunin: everyone has different opinions about how to install / manage nginx, and that nginx itself is mostly installed by compiling from source doesn't help.
[2013-06-13 20:55:35 -0400] jtimberman: by non-default, do you mean overriding the version attribute for a source install?
[2013-06-13 20:55:35 -0400] hakunin: jtimberman: i'd love to install from package, but how would i get the modules?
[2013-06-13 20:55:41 -0400] hakunin: jtimberman: yes
[2013-06-13 20:55:54 -0400] jtimberman: you'd have to install a package that has the modules already compiled in.
[2013-06-13 20:56:02 -0400] jtimberman: fwiw, this is why i really dislike nginx :)
[2013-06-13 20:56:25 -0400] jtimberman: (I know *why* it's required, performance-wise, but it irks me for this reason)
[2013-06-13 20:56:30 -0400] hakunin: jtimberman: :) there are some combinations of nginx packages out there, but the cookbook seems to be hardlinked at "nginx" for ubuntu
[2013-06-13 20:57:53 -0400] hakunin: jtimberman: but i think the problem in that cookbook is mostly from ohai plugin
[2013-06-13 20:58:02 -0400] hakunin: and it seems like such a fundamental cookbook in general
[2013-06-13 21:00:21 -0400] hakunin: jtimberman: this is from a year ago, and look at how the discussion ended: https://github.com/opscode-cookbooks/nginx/pull/14
[2013-06-13 21:00:43 -0400] jtimberman: yeah
[2013-06-13 21:01:06 -0400] jtimberman: we have 140 cookbooks.
[2013-06-13 21:01:20 -0400] hakunin: jtimberman: hence my "fundamental cookbook" point :)
[2013-06-13 21:01:55 -0400] asharp: if i want to create a file in a users home directory and i don't know the users username, how do i know the path to create the file?
[2013-06-13 21:02:14 -0400] jtimberman: fundamental as in commonly used?
[2013-06-13 21:02:21 -0400] jtimberman: because commonly used != fundamental :)
[2013-06-13 21:02:26 -0400] jtimberman: anyway
[2013-06-13 21:02:44 -0400] hakunin: jtimberman: both :)
[2013-06-13 21:02:47 -0400] jtimberman: the process exists for our sanity in managing a shitload of software.
[2013-06-13 21:04:09 -0400] hakunin: jtimberman: it might just be my opinion, but having fewer high quality, opinionated cookbooks would be more beneficial, than many hardly working ones. I will try to contribute.
[2013-06-13 21:04:20 -0400] jmartin: jtimberman: just curious on your thoughts of the wrapper cookbook pattern? is that the way that you all recommend going forward?
[2013-06-13 21:05:58 -0400] hakunin: jtimberman: and something like nginx seems to deserve a place in the top priority
[2013-06-13 21:07:54 -0400] hakunin: jtimberman: my 2 cents: put the cookbooks that you immediately see on this page as top priority: http://community.opscode.com/cookbooks. It's only 33, and not all of them are under Opscode.
[2013-06-13 21:08:11 -0400] hakunin: so probably less than 30
[2013-06-13 21:08:17 -0400] jtimberman: there's a lot of priorities.
[2013-06-13 21:08:39 -0400] hakunin: i mean only the cookbooks against one another
[2013-06-13 21:08:45 -0400] hakunin: not everything in the pipeline
[2013-06-13 21:09:06 -0400] ivanoats: hakunin: great idea
[2013-06-13 21:09:19 -0400] jtimberman: jmartin: i don't
[2013-06-13 21:09:22 -0400] jtimberman: jmartin: i like roles.
[2013-06-13 21:09:28 -0400] jtimberman: :)
[2013-06-13 21:09:39 -0400] jtimberman: this is where jamie and i go to hand to hand combat
[2013-06-13 21:09:46 -0400] jmartin: ah
[2013-06-13 21:09:50 -0400] jtimberman: ehehehehe
[2013-06-13 21:10:00 -0400] spox: +1
[2013-06-13 21:10:06 -0400] jtimberman: i don't like the name wrapper cookbook, i like "site" cookbook, but i'm also old.
[2013-06-13 21:10:30 -0400] ivanoats: tabolario: ruby_build barfed with a wrong number of arguments (2 for 1) error. https://gist.github.com/ivanoats/5777400
[2013-06-13 21:10:37 -0400] jmartin: jtimberman: im just concerned about versioning/backing up attribute data etc
[2013-06-13 21:11:06 -0400] jmartin: and that chef 11 told me that site-cookbooks might be going away
[2013-06-13 21:11:08 -0400] jmartin: heh
[2013-06-13 21:11:24 -0400] tabolario: hrm
[2013-06-13 21:11:29 -0400] jtimberman: the cookbook shadowing feature is going away.
[2013-06-13 21:11:58 -0400] jtimberman: i don't know if having multiple locations in cookbook_path is included in that scope
[2013-06-13 21:12:06 -0400] jtimberman: jmartin: attributes are data.
[2013-06-13 21:12:08 -0400] jtimberman: why version data?
[2013-06-13 21:12:15 -0400] jtimberman: its in version control
[2013-06-13 21:12:28 -0400] jtimberman: as in you can go back and see previous values.
[2013-06-13 21:12:33 -0400] jtimberman: but does that actually have value?
[2013-06-13 21:12:44 -0400] jtimberman: i need to run
[2013-06-13 21:13:06 -0400] jmartin: jtimberman: it can if someone fails to test things properly hah (that is surely another battle)
[2013-06-13 21:13:16 -0400] spox: weird
[2013-06-13 21:13:57 -0400] spox: i had pulled the version url building in nginx out to the recipe, so overrides from roles/envs would be proper concatenated in at run time
[2013-06-13 21:15:48 -0400] cheflevelramen: @jtimberman: what about the added value of having 'library' cookbooks being pulled in and resolved by tools like berkshelf, and then having the 'site' cookbooks in local repos. That makes it very easy and clean to keep that data that your company modifies, and the data the community modifies, completely serarate. Unless I'm missing something
[2013-06-13 21:15:51 -0400] hakunin: spox: what's your nick on github?
[2013-06-13 21:16:08 -0400] spox: hakunin: chrisroberts
[2013-06-13 21:17:43 -0400] hakunin: spox: your commit was quite a long time ago
[2013-06-13 21:17:53 -0400] spox: indeed it was
[2013-06-13 21:18:08 -0400] spox: though it seems like just yesterday
[2013-06-13 21:18:30 -0400] tabolario: cheflevelramen: that's what i've been doing
[2013-06-13 21:18:56 -0400] tabolario: all of my library coookbooks get pulled in by librarian-chef, and my company-specific ones stay in the chef repo in site-cookbooks
[2013-06-13 21:19:23 -0400] tabolario: now granted i haven't instituted a very good TDD workflow with the site cookbooks yet, so that approach may not lend itself as well to that
[2013-06-13 21:19:55 -0400] hakunin: spox: don't let these thoughts bring you down, focus on the present. build new memories
[2013-06-13 21:22:06 -0400] goshawk: hi all
[2013-06-13 21:22:20 -0400] goshawk: I'm trying to bootstrap in a new ubuntu machine but i receive a ERROR: RuntimeError: chef-solo failed. See output above.
[2013-06-13 21:22:26 -0400] goshawk: what should i do
[2013-06-13 21:22:27 -0400] goshawk: ?
[2013-06-13 21:23:32 -0400] ivanoats: every single ruby recipe is failing for me and three of my coworkers is failing with this wrong number of arguments error (2 for 1) from line 42 in chef/resource/lwrp_base.rb
[2013-06-13 21:23:58 -0400] ivanoats: https://gist.github.com/ivanoats/5777400
[2013-06-13 21:25:30 -0400] hakunin: ivanoats: this might be a problem with ruby version
[2013-06-13 21:26:07 -0400] ivanoats: it's a vagrant precise base box
[2013-06-13 21:27:03 -0400] hakunin: ivanoats: yep chef 11.4.4 requires 1.9
[2013-06-13 21:27:08 -0400] hakunin: ivanoats: you're running 1.8
[2013-06-13 21:27:25 -0400] hakunin: ivanoats: const_defined? method only started accepting two arguments in ruby 1.9.x
[2013-06-13 21:27:50 -0400] ivanoats: so, we should downgrade chef on laptop and the vm?
[2013-06-13 21:28:02 -0400] hakunin: ivanoats: i would suggest upgrading ruby
[2013-06-13 21:28:20 -0400] hakunin: ivanoats: if you install chef with omnibox you'd get everything right
[2013-06-13 21:28:33 -0400] hakunin: *omnibus
[2013-06-13 21:29:03 -0400] hakunin: ivanoats: if you're using chef solo, then knife solo will bootstrap a vagrant box for you properly
[2013-06-13 21:29:15 -0400] ivanoats: hakunin: thanks! is omnibus on vagrantbox.es ?
[2013-06-13 21:29:48 -0400] ivanoats: hakunin: can kinfe solo be run from the Vagrantfile ? or just command line
[2013-06-13 21:30:13 -0400] hakunin: ivanoats: knife solo bootstraps any host you point it at
[2013-06-13 21:30:21 -0400] hakunin: ivanoats: use this machine for ubuntu 12.04 https://opscode-vm.s3.amazonaws.com/vagrant/opscode_ubuntu-12.04_provisionerless.box
[2013-06-13 21:30:41 -0400] hakunin: ivanoats: see, the point is there is nothing on that machine, no chef, it's empty
[2013-06-13 21:30:48 -0400] ivanoats: right
[2013-06-13 21:30:49 -0400] hakunin: ivanoats: then knife solo will install chef on it via omnibus
[2013-06-13 21:31:13 -0400] hakunin: ivanoats: and you'll get an entirely clean machine that is ready for chef
[2013-06-13 21:31:30 -0400] ivanoats: so the vagrant base box is not clean
[2013-06-13 21:31:33 -0400] hakunin: ivanoats: it won't even have ruby, because chef's ruby is isolated and doesn't get in the way
[2013-06-13 21:31:40 -0400] ivanoats: ok
[2013-06-13 21:33:01 -0400] hakunin: ivanoats: it used to be that chef was installed via rubygem into system ruby, and vagrant encouraged to have baseboxes come with chef and puppet ready to roll
[2013-06-13 21:33:21 -0400] hakunin: ivanoats: but chef installation method has evolved faster than vagrant baseboxes and people started disliking being locked into basebox's chef
[2013-06-13 21:33:33 -0400] ivanoats: ok
[2013-06-13 21:35:16 -0400] ivanoats: so.. to sum up. I'm going to add a different box (linked above). vagrant destroy, comment out my recipes from Vagrantfile, vagrant up, knife solo bootstrap, uncomment my recipes, vagrant provision ? sound right?
[2013-06-13 21:35:41 -0400] hakunin: ivanoats: sounds like that would work.
[2013-06-13 21:35:53 -0400] ivanoats: sweet THANK YOU going to try it.
[2013-06-13 21:35:56 -0400] teukka: ivanoats, hakunin: other option is to use vagrant-omnibus plugin (if there is no other need for knife-solo)
[2013-06-13 21:36:16 -0400] hakunin: teukka: ivanoats: didn't know about that
[2013-06-13 21:36:27 -0400] teukka: https://github.com/schisamo/vagrant-omnibus
[2013-06-13 21:37:09 -0400] hakunin: ivanoats: that's probably quicker, but with knife solo you can provision remote or local servers alike, anything you can ssh to as root
[2013-06-13 21:38:22 -0400] hakunin: ivanoats: that said, if you have vagrant plugin for your hosting company (aws/linode/digital ocean) you could let vagrant provisioin that stuff too, the options are plenty and intimidating
[2013-06-13 21:38:52 -0400] hakunin: and all "work in progress"
[2013-06-13 21:39:23 -0400] josephholsten: I've definitely been enjoying how easy it was to hook up rackspace to test-kitchen via vagrant
[2013-06-13 21:39:46 -0400] hakunin: test-kitchen is yet another option if you want proper testing environment for your cookbook
[2013-06-13 21:40:16 -0400] hakunin: it's basically doing what you are already doing, creates vagrant machines and runs your recipes on them, except in the end it runs tests as well from your test/integration dir
[2013-06-13 21:40:45 -0400] hakunin: i setup test kitchen for my application cookbook as well
[2013-06-13 21:41:48 -0400] hakunin: josephholsten: but i didn't actually provision production with my test kitchen setup, because i thought that's sort of against its purpose
[2013-06-13 21:41:56 -0400] hakunin: josephholsten: only vagrant
[2013-06-13 21:42:01 -0400] hakunin: vms
[2013-06-13 21:45:59 -0400] josephholsten: hakunin: I just have been trying to optimize rackspace boot speed, and so I wanted to see how much work it would be to get testing on rackspace instances
[2013-06-13 21:46:13 -0400] josephholsten: no production through test-kitchen
[2013-06-13 21:46:32 -0400] hakunin: josephholsten: ok i see
[2013-06-13 21:46:44 -0400] josephholsten: it's also nice to be able to run many more instances in parallel
[2013-06-13 21:47:35 -0400] hakunin: josephholsten: the new thing in town is vagabond if you're on ubuntu, provision a cluster out of lxc containers
[2013-06-13 21:48:19 -0400] hakunin: josephholsten: oh, which seems to be spox's creation: https://github.com/chrisroberts/vagabond
[2013-06-13 21:51:26 -0400] hakunin: ivanoats: btw if you end up with knife solo, you can set it up to do a whole bootstrap of your vagrant machine, not just install chef. just remove all recipes from vagrantfile and let knife do it all on an empty machine. Or the opposite, use vagrant-omnibus _and_ vagrantfile recipes and entirely avoid knife solo
[2013-06-13 21:52:09 -0400] hakunin: ivanoats: the way you described it is kind of combining vagrant's and knife provisioner giving half the job each
[2013-06-13 21:57:52 -0400] nebrera_: helllo
[2013-06-13 21:58:23 -0400] nebrera_: I would like to upload binary file in a databag
[2013-06-13 21:58:35 -0400] nebrera_: and copy it at the rest of the nodes
[2013-06-13 21:58:39 -0400] nebrera_: how can I do it ?
[2013-06-13 22:01:03 -0400] hakunin: nebrera_: usually files are distributed via files directory inside cookbooks, but i'm not familiar with chef server culture
[2013-06-13 22:01:06 -0400] log1kal: So, this Error message: "Unable to satisfy constraints on cookbook foo due to run list item (bar >= 0.0.0). Run list items that may result in a constraint on foo:" that means that bar is asking for a version of foo that's not going to work for some reason?
[2013-06-13 22:01:13 -0400] log1kal: or do I have that backwards?
[2013-06-13 22:02:13 -0400] nebrera_: actually I would like to distribute a directory
[2013-06-13 22:02:46 -0400] nebrera_: but it must be dynamic I mean, I can change it and I need to sync rest of nodes
[2013-06-13 22:02:51 -0400] nebrera_: is it possible ?
[2013-06-13 22:03:26 -0400] hakunin: log1kal: i've never seen that message, but it looks like there are 2 cookbooks depending on conflicting versions of the same cookbook
[2013-06-13 22:03:33 -0400] log1kal: ok, that's what I thought
[2013-06-13 22:03:55 -0400] log1kal: I'm having a hard time figuring out which cookbook is being called with different versions
[2013-06-13 22:04:03 -0400] log1kal: and who might be stating the dependency
[2013-06-13 22:04:27 -0400] maplebed: If I have an attribute named node['foo'] = 'bar', does that mean I can not have an attribute named node['foo']['bar'] = 'baz'?
[2013-06-13 22:04:41 -0400] maplebed: (because the attr is a string not an array, so can't be subindexed?)
[2013-06-13 22:04:47 -0400] log1kal: I'm assuming foo, hakunin
[2013-06-13 22:05:25 -0400] log1kal: especially since later it says the following: https://gist.github.com/logikal/5777788
[2013-06-13 22:05:37 -0400] log1kal: which is more confusin, since they're asking for the same version of foo
[2013-06-13 22:09:22 -0400] hakunin: maplebed: yes
[2013-06-13 22:12:15 -0400] maplebed: hakunin: thanks.
[2013-06-13 22:17:50 -0400] maplebed: hakunin: do I need to declare (say in an attributes file) default['foo'] = [] before I can declare default['foo']['bar'] = 'baz'?
[2013-06-13 22:18:20 -0400] hakunin: maplebed: i think they made this part magical, as in, you don't have to
[2013-06-13 22:18:37 -0400] maplebed: good.  That's what I thought as well.  Thanks agani.
[2013-06-13 22:27:24 -0400] pmariani: Hi
[2013-06-13 22:27:35 -0400] pmariani: I am just getting started with Chef and a new project. I am using rackspaces
[2013-06-13 22:27:51 -0400] pmariani: should I use vagrant-rackspace, or knife-rackspace?
[2013-06-13 22:30:51 -0400] cheflevelramen: pmariani: Ha, I'm trying to figure the same thing out right now, though for knife-ec2 vs vagrant-aws. Watching this video by vagrant creator to see if he provides any insight: http://www.youtube.com/watch?v=vk7hHhhIt10
[2013-06-13 22:31:40 -0400] awgross: are you two using a Chef Server, or Chef Solo
[2013-06-13 22:31:50 -0400] pmariani: chef solo
[2013-06-13 22:31:52 -0400] cheflevelramen: awgross: I'll be using Chef Server
[2013-06-13 22:32:10 -0400] awgross: for solo, probably Vagrant, for server, you will want to become familiar with Knife
[2013-06-13 22:32:41 -0400] pmariani: thanks
[2013-06-13 22:33:39 -0400] cheflevelramen: awgross: interesting. Now, I use chef-solo when testing in my local vagrant box, but chef server for the production environment. Is there a specific reason you think knife is better suited for chef server?
[2013-06-13 22:33:56 -0400] hakunin: so looks like people are starting to prefer vagrant to do their provisioning instead of knife solo? I setup knife solo and like it
[2013-06-13 22:34:14 -0400] awgross: cheflevelramen: it has handelrs for interacting with parts of Chef server you wouldnt normally see with Vagrant
[2013-06-13 22:34:28 -0400] awgross: like Chef Search, uploading databags and environments
[2013-06-13 22:34:42 -0400] hakunin: knife is a tool to talk to chef server api
[2013-06-13 22:36:42 -0400] cheflevelramen: awgross: Good point. One problem I'm still trying to resolve is having versioned provisioning environments. For example, scripts that spin up whole clusters if needed, and store those in version control. So for strictly provisioning instances, is knife still better? I don't use knife to do any searches at time of provisioning instances. I do use knife in the manner you stated, but just at other times than provisioning.
[2013-06-13 22:39:45 -0400] awgross: cheflevelramen: for clusters of machines, check out spice weasel
[2013-06-13 22:40:44 -0400] cheflevelramen: awgross: Nice, looks perfect. Man, learning about a lot of cool new tools today. Thanks!
[2013-06-13 22:41:20 -0400] quattro_: is it possible to bootstrap all my nodes with one command?
[2013-06-13 22:53:24 -0400] idlemichael: ls
[2013-06-13 22:53:52 -0400] idlemichael: anyone run into chef client forking processes, and those processes going defunct?
[2013-06-13 22:54:06 -0400] idlemichael: chef-client never completes in these cases
[2013-06-13 22:54:32 -0400] quattro_: anyone know if there is a cookbook that updates all the nodes on the chefserver?
[2013-06-13 23:08:13 -0400] dysinger: where to file an issue with knife-ec2 ?
[2013-06-13 23:10:57 -0400] jtimberman: dysinger: KNIFE project in jiar
[2013-06-13 23:11:00 -0400] jtimberman: s/jiar/jira/
[2013-06-13 23:11:05 -0400] hakunin: dysinger: looks like it's somewhere in here: http://tickets.opscode.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+KNIFE+AND+resolution+%3D+Unresolved+AND+component+%3D+knife-ec2+ORDER+BY+priority+DESC&mode=hide
[2013-06-13 23:11:49 -0400] dysinger: k thanks
[2013-06-13 23:15:31 -0400] log1kal: jtimberman: ever had a cookbook 'foo' depend on a cookbook 'bar', and have it throw a constraint error? I've checked that the cookbook isn't constrained in the environment, and no other cookbook is depending on this cookbook
[2013-06-13 23:17:32 -0400] dysinger: let me ask if it's a bug first, jtimberman - when I launch with knife-ec2, I'm using an AMI that already has chef 10.2x on it.  knife-ec2 tries to bootstrap with a client.rb "log_level :auto" which chef 10.2x vomits over.
[2013-06-13 23:17:59 -0400] jtimberman: dysinger: are you using chef 11 locally?
[2013-06-13 23:18:06 -0400] dysinger: yes
[2013-06-13 23:18:09 -0400] dysinger: I thought that might be it
[2013-06-13 23:18:13 -0400] jtimberman: its probably getting the bootstrap template with the chef 11 bootstrap_context
[2013-06-13 23:18:24 -0400] jtimberman: IOW seems like a bug
[2013-06-13 23:18:30 -0400] jtimberman: but i don't think its with knife-ec2
[2013-06-13 23:18:34 -0400] Otterley: hey @jtimberman, can you please take a look at my fix to CHEF-2353?
[2013-06-13 23:18:37 -0400] jtimberman: but with knife bootstrap
[2013-06-13 23:18:38 -0400] dysinger: bummer - that means I have to uninstall locally & roll back to chef 11 or not use knife-ec2
[2013-06-13 23:18:47 -0400] Otterley: err, COOK-2353
[2013-06-13 23:18:57 -0400] dysinger: roll back to chef 10 rather
[2013-06-13 23:19:09 -0400] jtimberman: dysinger: or make a custom bootstrap template :)
[2013-06-13 23:19:20 -0400] jtimberman: which is probably the easiest thing to do in the short term
[2013-06-13 23:19:21 -0400] dysinger: i'm just going to tell everyone to upgrade
[2013-06-13 23:19:27 -0400] dysinger: get with it
[2013-06-13 23:19:30 -0400] jtimberman: :D
[2013-06-13 23:19:32 -0400] dysinger: (the program)
[2013-06-13 23:19:37 -0400] jtimberman: Otterley: not right now no sorry
[2013-06-13 23:20:05 -0400] Otterley: ETA?
[2013-06-13 23:20:10 -0400] log1kal: concerning my cookbook dependency issue: https://gist.github.com/logikal/5777788
[2013-06-13 23:37:46 -0400] sn0wb1rdz: What is the quick way to verify if the "chef_environment" I have on my run_list.json file is applied when I run chef_client?
[2013-06-13 23:47:15 -0400] awgross: sn0wb1rdz: Chef::Log.info("Current Environment: #{node.chef_environment}")
[2013-06-13 23:47:18 -0400] awgross: drop that in a recipe
[2013-06-13 23:48:12 -0400] sn0wb1rdz: awgross: Will give that a shot!
[2013-06-13 23:48:36 -0400] awgross: anyone here have experience developing Vagrant Plugins?  Having trouble getting access to the custom config fields defined in the Vagrantfile
[2013-06-13 23:48:47 -0400] awgross: I can define them. but I dont seem to be able access them in my plugin
[2013-06-13 23:48:52 -0400] b0c1: anyone using logstash+kibana ?
