[2013-06-28 00:38:56 -0400] MrBIOS: hi folks
[2013-06-28 00:39:04 -0400] coderanger: HELLO
[2013-06-28 00:39:46 -0400] MrBIOS: My organization is using Chef 10.18.2 in production, I'm curious to know when the reporting stuff (run reporting) was fully operational, and if there are any bugfixes/features that would make it a no-brainer to upgrade sooner rather than later
[2013-06-28 00:40:05 -0400] itwasntandy: wow. that's ancient
[2013-06-28 00:40:43 -0400] MrBIOS: yeah, I inherited the environment
[2013-06-28 00:41:19 -0400] coderanger: MrBIOS: Reporting is still in development, not sure where the best place to contact to get on the list for the beta is, probably support@opscode.com
[2013-06-28 00:41:45 -0400] coderanger: As for upgrading from chef 10 to 11, there is nothing beyond just read the various upgrade guides
[2013-06-28 00:41:55 -0400] MrBIOS: also, is there any way I can tell Chef-client to STFU about IPv6 (it's disabled on our hosts)
[2013-06-28 00:42:17 -0400] coderanger: MrBIOS: What about it? The only thing that should be looking is ohai which is silent by default
[2013-06-28 00:43:39 -0400] Drewzar: Is there anyway to block 'knife <whatever> edit's from happening on a chefserver and only allow knife from files?
[2013-06-28 00:44:06 -0400] MrBIOS: @coderanger it just prints "WARN: unable to detect ip6address"
[2013-06-28 00:44:09 -0400] coderanger: Drewzar: No
[2013-06-28 00:44:15 -0400] coderanger: Drewzar: They look the same to the API
[2013-06-28 00:44:37 -0400] coderanger: MrBIOS: Ahh, yeah thats just from ohai, you could override the plugin probably, I wouldn't bother though :)
[2013-06-28 00:44:38 -0400] itwasntandy: MrBIOS: default runlist was one of the biggest things in chef11 for us from memory
[2013-06-28 00:45:06 -0400] Drewzar: lame, I want people to stop hand editing role/envs and only upload from vcs
[2013-06-28 00:45:42 -0400] MrBIOS: yeah ok, not worth it :)
[2013-06-28 00:45:58 -0400] coderanger: Drewzar: Fire anyone that breaks the policy? ;-)
[2013-06-28 00:46:18 -0400] coderanger: Drewzar: You can also remove upload permissions from everyone and have a jenkins server do the actual upload
[2013-06-28 00:46:24 -0400] coderanger: so the only way to upload is to push to git
[2013-06-28 00:47:11 -0400] Drewzar: I like that idea
[2013-06-28 00:47:37 -0400] MrBIOS: what's the right way of figuring out my version of chef-server?
[2013-06-28 01:23:37 -0400] BrianJ: is there a way that i can use attributes from a different cookbook?
[2013-06-28 01:26:29 -0400] bluepojo: BrianJ: Depend on the cookbook
[2013-06-28 01:26:44 -0400] bluepojo: depends "other_cookbook" in your metadata.rb
[2013-06-28 01:26:57 -0400] BrianJ: then how do i acess it?
[2013-06-28 01:26:59 -0400] bluepojo: dependencies have their attributes pulled in
[2013-06-28 01:26:59 -0400] BrianJ: access*
[2013-06-28 01:27:09 -0400] bluepojo: it'll be added to the node object automatically
[2013-06-28 01:27:20 -0400] BrianJ: node['tomcat']['home'] just the same as normal?
[2013-06-28 01:27:21 -0400] BrianJ: ah ok
[2013-06-28 01:27:24 -0400] BrianJ: thanks
[2013-06-28 01:27:52 -0400] bluepojo: yep
[2013-06-28 02:02:50 -0400] markba: Hi there. With Chef 10, I used the chef-solo bootstrap method to config a new server. Is there something similar for Chef 11? I want to be able to script the install. Thanks!
[2013-06-28 02:11:02 -0400] coderanger: markba: No, because it isn't needed anymore :)
[2013-06-28 02:11:07 -0400] coderanger: Just install the deb or rpm
[2013-06-28 02:27:07 -0400] MikeTLive: reference architectures wanted : behind firewall, non-cloud, non-git, static provisioning.  three functional environments:  prd, qal, dev. ContinuousIntegration with jenkins. SCM with Perforce.  chef-server. multiple classes of servers - web(apache). webapp(apache+jboss/tomcat), app,(jboss/tomcat)  developers and ops folks. living together in harmony. devs write the apps, ops run the world.
[2013-06-28 02:28:11 -0400] MikeTLive: oh yeah ... and i want a pony too. :)
[2013-06-28 02:54:19 -0400] DandyPandy: I'm writing my first LWRP and I'm wondering can you nest resources? For example, a virtual host with multiple locations within it? I'm trying to avoid doing anything hacky if there's an established pattern I'm just not finding.
[2013-06-28 02:58:03 -0400] coderanger: MikeTLive: " devs write the apps, ops run the world" This is called doing it wrong
[2013-06-28 02:58:46 -0400] coderanger: MikeTLive: If jenkins supports Perforce you should be able to do the whole CI->Chef-server thing there just fine
[2013-06-28 02:58:55 -0400] coderanger: MikeTLive: You'll want to add perforce support to berkshelf though
[2013-06-28 02:59:06 -0400] coderanger: or use an artifact repo that isn't perforce
[2013-06-28 02:59:31 -0400] coderanger: (some people use an otherwise empty chef org in OPC as an artifact repo, for example)
[2013-06-28 03:00:12 -0400] coderanger: DandyPandy: Nothing super established, I've been on a quest to improve things there but conferences are eating my brain lately
[2013-06-28 03:00:54 -0400] DandyPandy: coderanger: any examples you might be able to think of off the top of your head?
[2013-06-28 03:03:46 -0400] coderanger: DandyPandy: Check out my haproxy cookbook in the psf-chef repo on github
[2013-06-28 03:05:39 -0400] coderanger: Or lock me in a room and don't let me out until I finish my python cookbook rewrite
[2013-06-28 03:06:26 -0400] coderanger: I'm too full of curry to try and escape right now anyway
[2013-06-28 03:06:53 -0400] DandyPandy: coderanger: much appreciated.
[2013-06-28 03:16:16 -0400] hakunin: jtimberman: went with a local bash script hack to test different nodes with different tests. It literally creates the test dir locally before running kitchen verify by taking tests from a different dir and placing them into test dir. https://gist.github.com/maxim/5882234
[2013-06-28 03:16:58 -0400] hakunin: far from ideal, but not a crazy hack, not patching anything
[2013-06-28 03:27:06 -0400] hakunin: i hate this hack
[2013-06-28 03:55:10 -0400] stormerider: mm, curry.
[2013-06-28 03:56:23 -0400] coderanger: stormerider: chicken korma ftw
[2013-06-28 03:56:56 -0400] stormerider: coderanger: my wife likes that, though she usually goes for the tikka masala. me, i like my lamb.
[2013-06-28 03:57:22 -0400] coderanger: lamb korma > chicken korma, but this place doesn't make it :(
[2013-06-28 03:57:32 -0400] coderanger: they do, however, make excellent kheer
[2013-06-28 03:58:07 -0400] stormerider: are you in the seattle office?
[2013-06-28 03:58:33 -0400] coderanger: Yahr
[2013-06-28 03:59:00 -0400] stormerider: which place do you order from? (my office is by the ferry, though im remote 90% of the time)
[2013-06-28 03:59:10 -0400] coderanger: Chutneys
[2013-06-28 03:59:16 -0400] coderanger: via grubhub
[2013-06-28 03:59:30 -0400] stormerider: hm, i went to a different place, let me see if i can find them
[2013-06-28 03:59:53 -0400] coderanger: I've been to a bunch around here, they just the best that will deliver :)
[2013-06-28 04:01:49 -0400] stormerider: maharaja, i think. not sure, it's been a while.
[2013-06-28 04:02:08 -0400] stormerider: i usually just hit Okinawas since it's across from where i park by my office
[2013-06-28 04:02:22 -0400] coderanger: That was lunch today :)
[2013-06-28 04:02:43 -0400] coderanger: Opscode HQ is right next to it
[2013-06-28 04:03:40 -0400] stormerider: i love their spicy teriyaki and their beef yaki udon
[2013-06-28 04:04:08 -0400] stormerider: i know you folks are close by us, we're at 1011 western (i work for livemocha/rosetta)
[2013-06-28 04:04:32 -0400] coderanger: 1008, the national building
[2013-06-28 04:04:36 -0400] stormerider: (rosetta corporate is very interested in chef, btw, once we get past the livemocha/rosetta integration challenges)
[2013-06-28 04:04:47 -0400] stormerider: oh, wow, that's damned close.
[2013-06-28 04:05:14 -0400] coderanger: You guys are probably in the building across western which I'm staring at right now
[2013-06-28 04:05:15 -0400] coderanger: ::waves::
[2013-06-28 04:05:16 -0400] stormerider: i thought it was like 3-5 blocks away but that's like... next door almost?
[2013-06-28 04:05:51 -0400] coderanger: which floor is the office?
[2013-06-28 04:05:59 -0400] stormerider: im at home but it's the building across from the bakery. that has apartments in part of it and offices in another and has that furniture store on the bottom level.
[2013-06-28 04:06:01 -0400] stormerider: 10th
[2013-06-28 04:06:33 -0400] coderanger: Yeah, you're just right across from us then
[2013-06-28 04:07:09 -0400] stormerider: that'll make it very convenient if i can get them to spring for training :)
[2013-06-28 04:07:45 -0400] stormerider: which i think they're thinking about doing once the dust settles and perhaps getting some corporate training for the folks in harrisonburg as well. we'll have to see.
[2013-06-28 04:08:02 -0400] stormerider: afk a bit, though :) ive been spreading the chef love ;)
[2013-06-28 04:08:11 -0400] coderanger: I happily stay away from that side of the business :)
[2013-06-28 04:08:22 -0400] stormerider: hah, dont blame you :)
[2013-06-28 04:24:27 -0400] stormerider: coderanger: btw, is there a list of chef blogs somewhere? im thinking like planet gnome, etc, but for chef?
[2013-06-28 04:24:50 -0400] coderanger: Not that I know of
[2013-06-28 04:24:56 -0400] coderanger: Its on my super-long-term list
[2013-06-28 04:25:29 -0400] n1ko: would be nice
[2013-06-28 04:27:05 -0400] coderanger: We just got an internal-facing dev for my web team, and so our long-awaited rebuild of opscode.com can now actually move forward :)
[2013-06-28 04:39:11 -0400] stormerider: ah, is that the impetus behind d.o.c?
[2013-06-28 04:39:24 -0400] stormerider: (i love that that acronym is so apropos)
[2013-06-28 04:43:18 -0400] coderanger: As opposed to the wiki?
[2013-06-28 04:43:25 -0400] coderanger: Wikis are terrible for making high quality docs
[2013-06-28 05:16:11 -0400] stormerider: you folks had done a decent job, but yeah, the new site is much cleaner.
[2013-06-28 05:16:32 -0400] stormerider: is there going to be an export feature like the old wiki had, btw?
[2013-06-28 05:16:50 -0400] stormerider: i think i grabbed the entire wiki as a pdf or something at one point
[2013-06-28 05:18:49 -0400] coderanger: Its just a git repo
[2013-06-28 05:19:03 -0400] coderanger: https://github.com/opscode/chef-docs
[2013-06-28 05:19:09 -0400] coderanger: and sphinx supports PDF output natively
[2013-06-28 05:31:04 -0400] stormerider: cool.
[2013-06-28 06:50:41 -0400] axyelp: is it possible for a chef-apply to get the recipes from the chefserver?
[2013-06-28 06:52:11 -0400] coderanger: axyelp: That is what chef-client -o is
[2013-06-28 06:53:51 -0400] axyelp: coderanger:  right! but i also want to pass parameters which chef-apply allows. okay, i'll reframe the problem then - i want to pass parameters with $chef-client -o <recipe>
[2013-06-28 06:54:04 -0400] coderanger: What kind of params?
[2013-06-28 06:54:17 -0400] axyelp: coderanger: only way i can think of is using -j & databags
[2013-06-28 06:54:21 -0400] coderanger: There a -j option to chef-client to inject data
[2013-06-28 06:54:34 -0400] coderanger: bags you need to just use normally
[2013-06-28 06:57:48 -0400] axyelp: coderanger: oh! alright! -j should do the job. i guess there's no other way, is there? the parameters are only momentary but bear no relevance to future runs & thus are to be discarded immediately!
[2013-06-28 06:58:17 -0400] coderanger: Not really, what are you trying to do?
[2013-06-28 06:58:29 -0400] coderanger: You could also use env vars to do some level of transient config
[2013-06-28 07:12:46 -0400] axyelp: coderanger: Alright. The problem demands a post of its own - but will try to be concise. we have multiple vpcs & each have their presence as an environment on chefserver. also we want immediate deploys so we've got a machine in every vpc set up as a workstation which is accessible from a single machine (say mainstation). these workstations do chef bootstraps & so can access all the servers in their respective private network through 'knife ssh'. now workstation
[2013-06-28 07:38:50 -0400] emanuelez: how do i update knife on my workstation? i tried rerunning the install.sh script, but that does not work
[2013-06-28 07:52:16 -0400] axyelp: emanuelez: what do you mean update? if install.sh doesn't work it should mean it's already the latest!
[2013-06-28 07:59:40 -0400] emanuelez: my bad. i thought 11.6 was released already :( i'm facing the 403 timeout error :(
[2013-06-28 08:48:13 -0400] rurounijones: Ahoi all, I am trying to merge some defaults in a recipe with a value set in a .json file like so: https://gist.github.com/rurounijones/5883385 - My understanding is that the force_override should work in this case. however if only includes the data in the .json file. Is my thinking incorrect?
[2013-06-28 08:48:27 -0400] rurounijones: (If there is nothing set in the .json file then it uses the data set in default_db_users)
[2013-06-28 09:53:46 -0400] adam_: Hi there, how to access the role of the current node within a recipe? node.role and node.chef_role are obviously not correct
[2013-06-28 09:55:35 -0400] shimo: not sure, but keep in mind that a node can have multiple roles
[2013-06-28 09:55:39 -0400] shimo: or none
[2013-06-28 09:56:39 -0400] adam_: ok, well my goal is to have a conditional in a template based on some setting/attribute of a node....I thought the role would be the least likely to forget to set vs. a simple attribute
[2013-06-28 10:06:04 -0400] willejs: is it possible to search for a role in a role?
[2013-06-28 10:07:25 -0400] willejs: or is the roles attribute the one?
[2013-06-28 10:15:24 -0400] profil: I want to have a recipe which takes an array of parameters which then runs the subversion resource on each element
[2013-06-28 10:15:37 -0400] profil: how would I do this? using role attributes?
[2013-06-28 10:16:08 -0400] adam_: profil: that's up to you and should be based on where and why those specific parameters are set
[2013-06-28 10:16:22 -0400] adam_: but some sort of attribute would be a good approach
[2013-06-28 10:18:40 -0400] profil: adam_: I think role attributes, because different machines should have different svn repos
[2013-06-28 10:19:13 -0400] profil: adam_: but how di I loop through a node["subversion-repos"] variable? if I do .each I cant have it empty
[2013-06-28 10:19:30 -0400] adam_: do each of your different machine have different roles? Otherwise it is possible to make them node attributes
[2013-06-28 10:20:17 -0400] profil: oh, that would be better, I must have missed that
[2013-06-28 10:21:28 -0400] adam_: you can also have environment attributes
[2013-06-28 10:21:38 -0400] bcave: good afternoon :)
[2013-06-28 10:21:42 -0400] adam_: there are different layers, and it also depends if you are using chef-client or chef-solo
[2013-06-28 10:22:07 -0400] profil: I am using chef-client, with open source chef server. So there are many nodes
[2013-06-28 10:22:58 -0400] profil: adam_: how do I set node attributes, cant find anything about it than ohai automatic
[2013-06-28 10:24:00 -0400] adam_: see http://stackoverflow.com/questions/13381843/how-to-set-node-attributes-on-a-chef-client
[2013-06-28 10:25:40 -0400] profil: oh, I can do it by using knife node
[2013-06-28 10:25:43 -0400] profil: thanks
[2013-06-28 10:26:07 -0400] profil: but how about looping through the array?
[2013-06-28 10:26:52 -0400] adam_: that is more of a ruby question, but look into the %w{item1 item2} syntax...I'm sure the .each could work too if the array is structured properly
[2013-06-28 10:29:59 -0400] bcave: is anyone using chef_gem or gem_package for 'aws-sdk' in a recipe?
[2013-06-28 10:32:34 -0400] axyelp: is there some way to change attributes for all servers from a chef-run in an instance?!
[2013-06-28 10:33:32 -0400] bcave: never mind, got it to work
[2013-06-28 10:54:03 -0400] bcave: random "403 forbidden" messages when trying to install packages from a recipe.. is that normal?
[2013-06-28 11:03:00 -0400] bcave: strange... works if i manually run apt-get update first.
[2013-06-28 11:04:34 -0400] bcave: its to do with the resolved order of recipes in a role.
[2013-06-28 11:05:13 -0400] bcave: I would have thought that the order of a run_list in a role would be preserved
[2013-06-28 11:47:11 -0400] pluesch0r: hi everybody. we're currently on chef 10 (installed via opscode packages, _not_ the omnibus ones). i'm pondering upgrading to version 11 with omnibus packages. is there some wiki page or something that describes the upgrade process?
[2013-06-28 11:47:47 -0400] BryanWB: ohai chefs!
[2013-06-28 11:54:13 -0400] pluesch0r: oh, and, aside from the information in http://www.opscode.com/blog/2013/03/12/5106/ - is it possible to do the migration from 10 to 11 without creating a _new_ chef box? i'd like to do an in-place upgrade.
[2013-06-28 11:58:01 -0400] emanuelez: is compiling ruby the only way to be able to use 1.9.3 with the rbenv cookbook? it's a big waste of time since you end up always compiling the same stuff on different VMs
[2013-06-28 12:10:34 -0400] pluesch0r: should clients running version 10 just work with server version 11?
[2013-06-28 12:30:09 -0400] axyelp: i have my chef-client setup & got client.rb in /etc/chef, ~/.chef as well as in the working directory. but still when i start chef-shell or chef-apply without config, it doesn't get the correct config!
[2013-06-28 13:26:56 -0400] tabolario: good morning #chef
[2013-06-28 13:38:18 -0400] ProfFalken: hi all, in Chef 10.x does direcotry have an action :create_if_missing ?
[2013-06-28 13:38:35 -0400] ProfFalken: docs seem to suggest not but I want to check before I get too far involved...
[2013-06-28 13:46:54 -0400] ianco: ProfFalken, just create and delete. create_if_missing wouldnt really make sense
[2013-06-28 13:47:24 -0400] ianco: http://docs.opscode.com/resource_directory.html
[2013-06-28 13:51:34 -0400] bdemers: is the metadata 'replaces' actually used or is it just for doc purposes ?
[2013-06-28 13:57:07 -0400] bcave: is there anyone around that uses Fog + IAM Instance Profiles with chef?
[2013-06-28 14:00:42 -0400] rubbish: yes
[2013-06-28 14:00:52 -0400] rubbish: we use to self register with route53.
[2013-06-28 14:01:19 -0400] bcave: rubbish: have you ever run into authentication issues using the temporary authentication mechanisms?
[2013-06-28 14:02:23 -0400] kisoku: ls
[2013-06-28 14:02:23 -0400] kisoku: s
[2013-06-28 14:02:35 -0400] bcave: I get  "The request signature we calculated does not match the signature you provided. Check your key and signing method." when using Fog Storage  with the :use_iam_profile => true
[2013-06-28 14:03:17 -0400] rubbish: bcave: i don't think we have ran into problems. do you run into a problem right away or after the 24 hr time limit the temp creds are good for?
[2013-06-28 14:03:27 -0400] bcave: straight away.
[2013-06-28 14:03:43 -0400] rubbish: and there's no clock drift?
[2013-06-28 14:04:10 -0400] bcave: I launch an EC2 instance with the instance profile set, bootstrap it with chef, apply a chef role that installs gems, and then tries to authenticate.
[2013-06-28 14:04:38 -0400] ProfFalken: ianco: ok, thanks.
[2013-06-28 14:04:44 -0400] bcave: Its a standard Ubuntu AMI, time is UTC and looks right...
[2013-06-28 14:05:08 -0400] rubbish: yeah, we use a quasi standard ubuntu AMI too
[2013-06-28 14:06:11 -0400] rubbish: https://gist.github.com/rubbish/805c474d92e2c022cfa5 is all we do
[2013-06-28 14:07:21 -0400] bcave: http://stackoverflow.com/questions/17365404/fog-s3-and-iam-instance-profile-excon-forbidden
[2013-06-28 14:07:41 -0400] bcave: Current time: 14:06:25 UTC
[2013-06-28 14:08:03 -0400] bcave: Last Updated on the credentials: 2013-06-28T13:48:19Z
[2013-06-28 14:08:10 -0400] bcave:   "Expiration" : "2013-06-28T20:11:57Z"
[2013-06-28 14:08:33 -0400] bcave: I don't think it's a timing issue. only thing I can think of is perhaps a region issue. are you doing everything in us-east-1?
[2013-06-28 14:09:01 -0400] bcave: oh, not, its not even that. im testing in us-east-1
[2013-06-28 14:09:42 -0400] rubbish: yeah, we use us east.
[2013-06-28 14:13:51 -0400] mutombo: greetings
[2013-06-28 14:14:33 -0400] mutombo: someone can give ma a tip about this problem with chef client and svn?
[2013-06-28 14:14:36 -0400] mutombo: svn: Can't convert string from native encoding to 'UTF-8':
[2013-06-28 14:15:22 -0400] mutombo: the file is UTF8, the system locales are set to UTF8 and when  i can svn update myself it works too
[2013-06-28 14:15:48 -0400] mutombo: only when chef-client calls the svn update it fails
[2013-06-28 14:16:05 -0400] mutombo: does chef call the svn binary with its own environment?
[2013-06-28 14:42:49 -0400] aramus_: Hello, simple question, are you supposed to be able to run 'knife' on both the chef-server and client or only the client?
[2013-06-28 14:43:33 -0400] cheflevelramen: aramus_: You would normally just run it on chef-server or a workstation, not the client nodes
[2013-06-28 14:44:27 -0400] cheflevelramen: aramus_: the only thing I run on the clients are 'chef-client' and 'chef-shell'
[2013-06-28 14:45:08 -0400] aramus_: cheflevelramen: but when you create "knife.rb" for the first time, according to http://docs.opscode.com/install_workstation.html, I need to run "knife configure --initial"
[2013-06-28 14:46:05 -0400] rocket: aramus_: you can run knife on any system you configure it on
[2013-06-28 14:47:06 -0400] cheflevelramen: aramus_: maybe we're talking about different things. There are three main computers that chef gets installed on: 1) Chef Server (you may just be using Hosted Chef for this), 2) Workstation (this is where you install knife and do your development/deployment from), 3) Client (this is a node that was setup/configured by chef, like an Apache server for instance)
[2013-06-28 14:48:02 -0400] cheflevelramen: aramus_: So normally you would do your work from a workstation, which would have knife installed and configured. The end nodes that are managed by Chef can have knife configured too, but you usually wouldn't use it there.
[2013-06-28 14:54:08 -0400] aramus_: cheflevelramen: Alright, here's the problem. I have a private chef-server. Is it a problem if I cannot run knife on the chef-server?
[2013-06-28 14:55:02 -0400] aramus_: cheflevelramen: I can run knife perfectly from my workstation though
[2013-06-28 14:55:25 -0400] coderanger: Do you have the right knife config in your homedir on the server?
[2013-06-28 14:55:38 -0400] failshell: got this chicken and egg situation. this library i use requires a gem, but its loaded before i can install it in a recipe. what can i do?
[2013-06-28 14:55:53 -0400] coderanger: it would not just work out of hte box because you happen to be on the server if thats what you mean
[2013-06-28 14:56:17 -0400] coderanger: failshell: In the library code, move the require into the relevant function right before that code is used
[2013-06-28 14:56:35 -0400] coderanger: Or if there isn't such a function, wrap the code in a function :)
[2013-06-28 14:56:59 -0400] aramus_: @coderanger: what do you mean knife config?
[2013-06-28 14:57:23 -0400] aramus_: @coderanger: if you are referring to the knife.rb, it doesn't evne exist on the server.
[2013-06-28 14:57:30 -0400] coderanger: knife uses a .chef/knife.rb file to know what API server to talk to and what keys to use
[2013-06-28 14:57:44 -0400] coderanger: Indeed, it wouldn't exist on the server by default because there is nothing special about the server in this case
[2013-06-28 14:57:58 -0400] coderanger: Using knife on the server box is just like running it anywhere else
[2013-06-28 14:57:58 -0400] failshell: coderanger: its inherited by a class ..
[2013-06-28 14:58:17 -0400] coderanger: failshell: Then you get to learn the joy of Ruby meta-metaprogramming
[2013-06-28 14:58:29 -0400] coderanger: sec, linkying
[2013-06-28 14:58:55 -0400] coderanger: failshell: https://github.com/coderanger/chef-funnel/blob/master/libraries/python.rb#L71-L74
[2013-06-28 14:59:02 -0400] coderanger: Thats how you build a class at runtime
[2013-06-28 14:59:19 -0400] aramus_: Thanks, so to run knife on the server, I need to install chef-client also on the server. But that's really unnecessary.
[2013-06-28 15:00:08 -0400] coderanger: aramus_: As I said, the server is not special in any way when it comes to knife or chef-client
[2013-06-28 15:00:47 -0400] coderanger: and knife is intended to be used on your workstation, so there isn't much need for it to be special
[2013-06-28 15:01:14 -0400] coderanger: In chef 10 it used to be that it was used for certain server-admin-ish tasks, but those are now a part of chef-server-ctl
[2013-06-28 15:01:29 -0400] coderanger: (which is a local script, not an API tool)
[2013-06-28 15:02:25 -0400] aramus_: @coderanger: Okay, I guess I was confused by the installation instructions here, http://docs.opscode.com/install_workstation.html , where it mentions that "knife.rb. This configuration file must be created by running the knife configure --initial command from the server on which the open source Chef Server is installed."
[2013-06-28 15:02:54 -0400] aramus_: @coderanger: Maybe that should be fixed to saying that "knife configure --initial" should be ran on the workstation.
[2013-06-28 15:05:01 -0400] mutombo: ok i guess i got it, chef executes svn update with LC_ALL=C, this breaks the  svn client when it needs UTF8 support
[2013-06-28 15:05:26 -0400] mutombo: anyone knows how to change the environment for this?
[2013-06-28 15:06:30 -0400] gleam: you can pass environment variables to chef in client.rb
[2013-06-28 15:12:40 -0400] coderanger: mutombo: Just set it in your recipe code
[2013-06-28 15:13:03 -0400] coderanger: https://github.com/python/psf-chef/blob/master/cookbooks/pydotorg-redesign/recipes/staging.rb#L76-L77
[2013-06-28 15:15:27 -0400] jgood: is it possible to write a chef script that will pull an updated file from a subversion repository?
[2013-06-28 15:15:48 -0400] mutombo: coderanger, thanks
[2013-06-28 15:16:03 -0400] coderanger: jgood: Use the svn resource
[2013-06-28 15:17:22 -0400] iwilson: I'm using 'knife bootstrap' to install chef on my EC2 nodes, however, it appears that every host that I'm attempting to bootstrap doesn't actually bootstrap the nodes -- the last error message that I receive is 'bash: line 74: chef-client: command not found' and then the bootstrap process ends.
[2013-06-28 15:17:28 -0400] jgood: @coderanger: thanks, i don't know why i didn't think to look there first
[2013-06-28 15:17:57 -0400] coderanger: iwilson: What version of knife do you have and what bootstrap template are you using?
[2013-06-28 15:18:39 -0400] iwilson: coderanger: According to knife --version, I'm running 11.4.4
[2013-06-28 15:18:48 -0400] coderanger: Okay, good sign
[2013-06-28 15:19:16 -0400] iwilson: and I'm assuming that I am using the default bootstrap template -- I'm literally running 'knife bootstrap <HOSTNAME> -x <MYUSERNAME> --sudo' on the hosts.
[2013-06-28 15:19:43 -0400] coderanger: iwilson: Can you pastebin all the output from the bootstrap?
[2013-06-28 15:20:10 -0400] iwilson: coderanger: http://hastebin.com/kawaqawulu.mel
[2013-06-28 15:20:45 -0400] coderanger: Okay, so it did download the RPM and install it
[2013-06-28 15:20:47 -0400] mutombo: coderanger: seems like the subversion ressource is ignoring the ENV variables
[2013-06-28 15:20:52 -0400] coderanger: Do you see an /opt/chef/bin/chef-client?
[2013-06-28 15:21:08 -0400] mutombo: as is the bash ressource
[2013-06-28 15:21:44 -0400] iwilson: ls -l does shoe that /opt/chef/bin/chef-client exists and has 755's
[2013-06-28 15:21:51 -0400] mutombo: i've created a ticket, perhaps someone can make sense out of this: http://tickets.opscode.com/browse/COOK-3256
[2013-06-28 15:22:12 -0400] iwilson: s/shoe/show/g
[2013-06-28 15:23:09 -0400] iwilson: coderanger: Running it results in a 401 (Unauthorized) back from the chef server
[2013-06-28 15:23:28 -0400] iwilson: so...I'm assuming that I need to go in and set up the clients by hand in order to complete the process?
[2013-06-28 15:23:40 -0400] coderanger: iwilson: No, just run the bootstrap again and it should work
[2013-06-28 15:23:45 -0400] coderanger: But weird that it didn't the first time
[2013-06-28 15:24:03 -0400] iwilson: coderanger: ok.  Let me try it again.
[2013-06-28 15:24:05 -0400] coderanger: what filesystem are you using? It is something networked that might have some latency in files being visible?
[2013-06-28 15:24:40 -0400] coderanger: mutombo: Okay, I'll have to look again, maybe we changed how that code works
[2013-06-28 15:24:42 -0400] iwilson: coderanger: ec2 instances, EBS backed volumes with ext4.
[2013-06-28 15:25:56 -0400] coderanger: iwilson: Weird, maybe EBS just decided to stop acknowledging writes for a few hundred ms, wouldn't be the first time
[2013-06-28 15:27:51 -0400] wdilly: Can I get get chef to keep track of clients using a different unique identifier than its hostname, in my preliminary usage, it seems to now allow duplicate hostnames, however, strangely my environment is going to require that. My thought is to get the client name to be something other than hostname. Any help or clarification is apprciated.
[2013-06-28 15:29:44 -0400] coderanger: wdilly: The only thing that can't be a dup is the node name, by default node name == fqdn, but you can override it to be anything
[2013-06-28 15:30:22 -0400] coderanger: wdilly: For new nodes, use the -N option to bootstrap, for existing ones you'll have to update client.rb with the new node_name, let it reregister with the server, and then copy over the node data
[2013-06-28 15:31:50 -0400] wdilly: coderanger, great, it should only be relevant for "new ones" I will look into the -N option. Thanks for pointing me in the right direction
[2013-06-28 15:33:21 -0400] bcave: if i want to fetch something over http in a recipe, what's the "best" way of doing it? using a library? exec "wget ... " ?
[2013-06-28 15:33:43 -0400] spox: bcave: see the remote_file resource
[2013-06-28 15:33:48 -0400] bcave: thanks spox
[2013-06-28 15:34:26 -0400] bcave: ah, perfect :)
[2013-06-28 15:47:04 -0400] xerxas: Hi all
[2013-06-28 15:47:09 -0400] stkowski: Good morning
[2013-06-28 15:48:58 -0400] xerxas: application_{ruby,python,java} have 'depends "application"' in metadata.rb , but application_php doesn't
[2013-06-28 15:49:02 -0400] xerxas: is that intentional ? or a bug ?
[2013-06-28 15:53:05 -0400] aramus_: Hello, I am about to make my first chef recipe. From what I understand, recipes are really just ruby files so I can create variables and do string manipulation and NOT just use resources?
[2013-06-28 15:53:08 -0400] aramus_: fa
[2013-06-28 15:53:33 -0400] hakunin: I notice that upload_chef_data in test-kitchen is incredibly slow with ssh driver, it uploads each file separately via scp, and it takes about a second for each file Time to fork and try fix?
[2013-06-28 15:54:46 -0400] hakunin: aramus_: that's correct, but if you don't stick with resources primarily you will have a bad time. Resources ensure idempotence, and resources are maintained for you.
[2013-06-28 15:56:28 -0400] aramus_: hakunin: Alright, thanks for the heads up!
[2013-06-28 15:56:35 -0400] hakunin: aramus_: the rule of thumb: use community cookbooks. If you must, use non-community cookbooks from somebody who is a proven maintainer. If you must, make your own custom recipes that use resources. If you must, add custom code to your recipes.
[2013-06-28 15:57:26 -0400] jleveque: Hello . I've changed (without chef) the IP @ of a node : I can see through knife node show nodeFQDN that chef still knows the old IP@ , and now the chef run is failing saying that it misses some cookbooks (which are present in the bookshelf). Is there a way to modify the node IP without destroying and recreating the node ?
[2013-06-28 15:57:28 -0400] aramus_: hakunin: what are community cookbooks?
[2013-06-28 15:57:43 -0400] hakunin: aramus_: http://community.opscode.com/cookbooks
[2013-06-28 15:58:19 -0400] hakunin: jleveque: are you using chef solo?
[2013-06-28 15:59:42 -0400] phoellig: Hello, I'm working with the jenkins:node_windows recipe and having a spot of trouble. I'm receiving "ArgumentError: You must supply a name when declaring a default resource" when running the recipe. It fails with that error when running the jenkins-cli.jar to connect the node to the jenkins master. Can anyone explain what that error means?
[2013-06-28 15:59:59 -0400] aramus_: hakunin: Oh, maybe I don't even have to write my own cookbook for this. Thanks!
[2013-06-28 16:00:01 -0400] jleveque: hakunin, I am using chef server opensource
[2013-06-28 16:00:27 -0400] hakunin: jleveque: i see, not familiar then sorry
[2013-06-28 16:01:22 -0400] jleveque: I am thinking of a knife node edit -a nodeFQDN and then do all the changes from here, but to be correct it would require to change  lot of stuff
[2013-06-28 16:02:58 -0400] hakunin: phoellig: i have no idea about your particular case, but the error seems to suggest that you put a resource in your recipe (e.g. package) but did not give it a name (e.g. package "foo"). Or maybe not in a recipe. Basically somewhere you seem to be missing a name that you should pass to a resource
[2013-06-28 16:06:10 -0400] phoellig: hakunin: The failing line is here: https://github.com/opscode-cookbooks/jenkins/blob/master/providers/cli.rb#L64 it's using the jenkins_execute resource, which from what I can tell is defined here: https://github.com/opscode-cookbooks/jenkins/blob/master/providers/execute.rb
[2013-06-28 16:06:57 -0400] phoellig: I'm a bit new to ruby so the linking isn't entirely clear to me, it seems like the path is cookbookname_providername to handle the reference. Or is it more an issue with what's being passed in?
[2013-06-28 16:10:25 -0400] hakunin: phoellig: i'm not sure what chef is doing there exactly, but i'm guessing that jenkins_execute takes a command, which we can tell is defined, and then declares a resource "new_resource" passing the output of said command as the name. However, the output of command seems to be nil or empty, and new_resource requires someting. So basically whatever is in "command" doesn't return the right thing into stdout.
[2013-06-28 16:12:06 -0400] hakunin: phoellig: make sure that the command generated on lines 53 through 62 is writing something to stdout
[2013-06-28 16:12:13 -0400] phoellig: Interesting, The jenkins_execute resource essentially is a feed to the Chef::Mixins::ShellOut resource. It passes some command line args in to run a java process to connect the node to the jenkins server.
[2013-06-28 16:13:06 -0400] hakunin: phoellig: the point here is that on line 66 it uses stdout from that command to declare a resource, and that stdout seems empty
[2013-06-28 16:13:26 -0400] hakunin: phoellig: it could be empty for many reasons that have to do with what you put in that command using various attributes
[2013-06-28 16:14:08 -0400] phoellig: hakunin: OK, I ran the command directly on the server and it's outputting an empty JSON object.
[2013-06-28 16:14:18 -0400] hakunin: phoellig: java, cli_jar, url, @new_resource.command, username, password, password_file <-- all these things could affect or break the command
[2013-06-28 16:15:46 -0400] hakunin: phoellig: perhaps that's not what they expect
[2013-06-28 16:16:33 -0400] phoellig: hakunin: I'm guessing so. The command appears to be executing this groovy script (fun): https://github.com/opscode-cookbooks/jenkins/blob/0fd63650e7feda7db5187088c8ce980643d96470/files/default/node_info.groovy and the empty JSON return is an error case.
[2013-06-28 16:17:38 -0400] phoellig: hakunin: So I'm thinking that the jenkins slave configuration is somehow incomplete at this phase, even though it's attempting to register with the master.
[2013-06-28 16:18:04 -0400] hakunin: phoellig: or something else could be broken with your setup, i would check that first
[2013-06-28 16:18:15 -0400] hakunin: phoellig: but i haven't used jenkins cookbook, so can't be sure
[2013-06-28 16:20:08 -0400] phoellig: hakunin: I've been running a variety of other cookbooks without issue. Some community and some personal. I think the windows aspect of the jenkins cookbook hasn't been as well maintained, there are some references to non existing variables and bad URLs to maven repos in it that I need to put in a pull request for.
[2013-06-28 16:20:58 -0400] phoellig: hakunin: I'll double check my env to save my sanity though.
[2013-06-28 16:21:20 -0400] hakunin: phoellig: i see. Good luck, hope you resolve it
[2013-06-28 16:21:34 -0400] phoellig: hakunin: Thanks for your help.
[2013-06-28 17:15:53 -0400] aramus_: Hello, is running a resource in a loop in accordance with the chef philosophy?
[2013-06-28 17:25:50 -0400] hakunin: aramus_: you don't exactly run a resource, you declare a resource
[2013-06-28 17:26:40 -0400] hakunin: aramus_: you can declare multiple resources using a shortcut like %w[foo bar baz].each { |name| package name }
[2013-06-28 17:27:00 -0400] paulmooring: building on what hakunin said, a resource should be idempotent so after 1 "run" said resource shouldn't do anything on subsquent runs
[2013-06-28 17:27:32 -0400] paulmooring: meaning no, the "Chef philosophy" would have you never put a resource in a loop
[2013-06-28 17:28:44 -0400] aramus_: hakunin: Thanks, I'll look into .each then.
[2013-06-28 17:28:45 -0400] hakunin: yep
[2013-06-28 17:29:01 -0400] hakunin: aramus_: what are you trying to o
[2013-06-28 17:29:03 -0400] hakunin: do
[2013-06-28 17:29:52 -0400] aramus_: hakunin: I have an unknown number of files that I want to copy over. So, coming from a c background, I slagged together a for loop that has a bash resource that copies over the file.
[2013-06-28 17:30:33 -0400] aramus_: something like : i.upto( j ) {
[2013-06-28 17:31:13 -0400] aramus_: file_name = data_bag_item( "test", "copy_over")[ "file" ]
[2013-06-28 17:31:24 -0400] aramus_: then a bash resource that does the copying
[2013-06-28 17:31:27 -0400] hakunin: aramus_: wouldn't it be possible to put then all in a directory?
[2013-06-28 17:32:11 -0400] aramus_: hakunin: Well, there are other files in the directory that I don't want to copy over.
[2013-06-28 17:33:45 -0400] hakunin: aramus_: and these files, they aren't configs by any chnace?
[2013-06-28 17:34:23 -0400] hakunin: aramus_: oh they are tests
[2013-06-28 17:35:17 -0400] aramus_: hakunin: no, they are tar files with update scripts. if they were, what would be the correct way of handling those?
[2013-06-28 17:35:39 -0400] hakunin: aramus_: for configs you normally use template resource
[2013-06-28 17:36:48 -0400] hakunin: aramus_: if your set of tar files is not just a bunch of junk, you would declare a file resource for each individually
[2013-06-28 17:38:12 -0400] hakunin: aramus_: file '/destination/path1.tar' { source 'my_file1.tar' }; file '/destination/path2.tar' { source 'my_file2.tar' }; etc <-- then you could actually use ruby array's each to loop through filenames in an array and generate a resource declaration for each, like i showed with package example
[2013-06-28 17:40:20 -0400] aramus_: hakunin: but once you declare a file resource for them, how would you copy them over? It doesn't seem like there's a copy resource or anything like that.
[2013-06-28 17:41:41 -0400] hakunin: aramus_: should've been cookbook_file : http://docs.opscode.com/resource_cookbook_file.html
[2013-06-28 17:42:06 -0400] hakunin: aramus_: "The cookbook_file resource is used to transfer files from a sub-directory of the files/ directory in a cookbook to a specified path that is located on the host running the chef-client or chef-solo."
[2013-06-28 17:42:37 -0400] hakunin: aramus_: you put your files in a files/ dir under your cookbook, then you declare them with cookbook_file resource
[2013-06-28 17:45:03 -0400] aramus_: hakunin: Oh, I see, that's definitely going to be useful. But I just want to move a file on chef-client to a different directory.
[2013-06-28 17:45:43 -0400] hakunin: aramus_: sounds a bit strange, but alright sure
[2013-06-28 18:03:23 -0400] ANGRYFUNBALL: I'm seeing the following when bootstrapping a node. what gives? ERROR: Errno::ENOENT: No such file or directory - /root/.ssh/id_dsa
[2013-06-28 18:03:46 -0400] chris613: ANGRYFUNBALL: Specify a password via -P
[2013-06-28 18:03:57 -0400] chris613: It's attempting to authenticate with your non-existent ssh key
[2013-06-28 18:04:04 -0400] ANGRYFUNBALL: chrisp666 doesn't work. please try again
[2013-06-28 18:04:36 -0400] ANGRYFUNBALL: chris613 doesn't work. please try again.
[2013-06-28 18:06:02 -0400] cassianoleal: how do I assert that a definition has been called with chefspec (if at all possible) ?
[2013-06-28 18:06:32 -0400] cassianoleal: I want to verify that I'm calling apache2's web_app resource with specific parameters depending on the node's attributes
[2013-06-28 18:06:42 -0400] chris613: ANGRYFUNBALL: Want to paste the exact command line you're using? You can use -x to specify a differnt key, or -P to specify a password, otherwise it looks for your default key in .shh/id_dsa as you show.
[2013-06-28 18:07:08 -0400] ANGRYFUNBALL: chris613 knife bootstrap 192.168.1.1 -x username -P PASSWORD --sudo
[2013-06-28 18:07:12 -0400] ANGRYFUNBALL: do you work for opscode?
[2013-06-28 18:12:11 -0400] chris613: no I do not
[2013-06-28 18:16:46 -0400] chris613: ANGRYFUNBALL: I'm not sure, TBH, that looks ok to me
[2013-06-28 18:16:51 -0400] ANGRYFUNBALL: yeah
[2013-06-28 18:16:55 -0400] ANGRYFUNBALL: that's because it is ok
[2013-06-28 18:17:05 -0400] ANGRYFUNBALL: gg opscode documentation
[2013-06-28 18:33:04 -0400] ANGRYFUNBALL: hypothetical: I have a node that I need to bootstrap that has no outbound internet connectivity. My chef workstation and server have outside internet connectivity though. How can I bootstrap my nodes?
[2013-06-28 18:36:35 -0400] coderanger: ANGRYFUNBALL: You need to build a custom bootstrap template that installs chef from something internal
[2013-06-28 18:36:46 -0400] ANGRYFUNBALL: oh that is so good
[2013-06-28 18:36:49 -0400] ANGRYFUNBALL: so joyful
[2013-06-28 18:36:53 -0400] ANGRYFUNBALL: I am so happy
[2013-06-28 18:37:09 -0400] coderanger: The default is to use opscode.com to grab the relevant deb/rpm/whatever
[2013-06-28 18:37:43 -0400] ANGRYFUNBALL: where is the default bootstrap code?
[2013-06-28 18:43:12 -0400] coderanger: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2013-06-28 18:43:15 -0400] coderanger: Thats the default one
[2013-06-28 18:43:46 -0400] coderanger: http://docs.opscode.com/knife_bootstrap.html has info on how custom templates work
[2013-06-28 18:44:11 -0400] coderanger: Specifically https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb#L13-L25 is the part you'll want to change
[2013-06-28 18:46:28 -0400] aramus_: Hello, I've been making changes to a data bag using "knife data bag edit", but none of the changes take effect. Does it take awhile for the changes to propagate or is something wrong?
[2013-06-28 18:47:28 -0400] coderanger: No, they are saved immediately, unless it shows an error after the edit
[2013-06-28 18:49:07 -0400] aramus_: Okay, there must be a connection error or something then.
[2013-06-28 18:50:32 -0400] jstallard: Is there a way to have access to a cookbook's lwrps without including any of said cookbook's recipes?
[2013-06-28 18:50:39 -0400] coderanger: Unlikely, the various edit commands just do an API GET, put the results in $EDITOR, and then put the output into a POST
[2013-06-28 18:50:45 -0400] jtimberman: jstallard: depend on it in your cookbook's metadata.
[2013-06-28 18:50:48 -0400] coderanger: If there was a conn error, it wouldn't allow the GET
[2013-06-28 18:50:58 -0400] jtimberman: jstallard: chef-client will download it and be able to use the LWRPs.
[2013-06-28 18:51:14 -0400] jstallard: jtimberman: awesome, thanks!
[2013-06-28 19:03:32 -0400] aramus_: Hello, would anyone know why knife is not making changes to a data bag even after it says it saves correctly?
[2013-06-28 19:07:04 -0400] luckymike: aramus_: can you be more specific?
[2013-06-28 19:07:41 -0400] aramus_: luckymike: This doesn't work: knife data bag create test; knife data bag delete test
[2013-06-28 19:08:40 -0400] luckymike: are you running that on one line?
[2013-06-28 19:09:28 -0400] aramus_: Nope.
[2013-06-28 19:09:38 -0400] luckymike: okay :)
[2013-06-28 19:09:46 -0400] luckymike: so after the create what does a knife data bag show give you?
[2013-06-28 19:10:27 -0400] aramus_: # knife data bag create test  Created data_bag[test] # knife data bag delete test  Do you really want to delete test? (Y/N) Y  ERROR: The object you are looking for could not be found  Response: Cannot load data bag test
[2013-06-28 19:11:21 -0400] luckymike: do you get the same error if you do a show?
[2013-06-28 19:13:35 -0400] aramus_: Yes.
[2013-06-28 19:13:50 -0400] aramus_: # knife data bag show test ERROR: The object you are looking for could not be found Response: Cannot load data bag test
[2013-06-28 19:13:50 -0400] luckymike: try adding a data bag item after you create the bag
[2013-06-28 19:14:22 -0400] luckymike: it seems like what you're doing should work
[2013-06-28 19:15:26 -0400] aramus_: luckymike: still not working, cannot be found.
[2013-06-28 19:40:47 -0400] Majost: What is the proper workflow for tickets which have been resolved, and patches merged into the current master branch of a cookbook?
[2013-06-28 19:40:50 -0400] Majost: Do I close the issue?
[2013-06-28 19:41:11 -0400] Majost: Or is this done automagically when the version of the cookbook is 'released'
[2013-06-28 19:54:00 -0400] erratic: hey is anyone here from the bay area I was wondering if I could ask a few questions
[2013-06-28 19:55:03 -0400] ANGRYFUNBALL: has anyone in here ever seen output like this:
[2013-06-28 19:55:03 -0400] ANGRYFUNBALL: [root@chef1 repository]# knife data bag create test yolo -e nano  Created data_bag[test]  ERROR: The object you are looking for could not be found Response: Cannot load data bag test
[2013-06-28 19:55:09 -0400] ANGRYFUNBALL: if so, what the hell?
[2013-06-28 19:55:59 -0400] erratic: test is like a file its looking for?
[2013-06-28 19:56:10 -0400] erratic: or something inside the file maybe
[2013-06-28 19:56:30 -0400] erratic: also you should check out #learnchef
[2013-06-28 19:57:42 -0400] ANGRYFUNBALL: erratic do you ever know what you're talking about?
[2013-06-28 19:57:45 -0400] ANGRYFUNBALL: *even
[2013-06-28 19:57:54 -0400] ANGRYFUNBALL: test is the databag name.
[2013-06-28 19:58:44 -0400] erratic: well
[2013-06-28 19:59:05 -0400] erratic: -l debug -vvv
[2013-06-28 20:01:38 -0400] btm: @opscode cookbook code review, join: https://plus.google.com/hangouts/_/8e6566814562d86786576655936ffa7018caac35, watch: http://youtu.be/rds8WK3Idpc
[2013-06-28 20:03:23 -0400] ANGRYFUNBALL: btm should a databags directory exist in a repo?
[2013-06-28 20:03:31 -0400] ANGRYFUNBALL: *data_bags
[2013-06-28 20:05:36 -0400] ANGRYFUNBALL: why would I be able to create a cookbook but not a databag via knife
[2013-06-28 20:06:48 -0400] paulmooring: ANGRYFUNBALL: you can create a data bag via knife it just creates it on the server
[2013-06-28 20:07:45 -0400] ANGRYFUNBALL: paulmooring not so
[2013-06-28 20:07:47 -0400] ANGRYFUNBALL: [root@chef1 repository]# knife data bag create ikfs test -e nano  Created data_bag[ikfs]  Created data_bag_item[test]  [root@chef1 repository]# knife data bag edit ikfs test -e nano  ERROR: The object you are looking for could not be found  Response: Cannot load data bag item test for data bag ikfs  [root@chef1 repository]#
[2013-06-28 20:08:10 -0400] ANGRYFUNBALL: wtf does that mean?
[2013-06-28 20:08:11 -0400] |rt|: is Dan Deleo on irc?  I have a question about some code in the freebsd package provider that he was the last person to touch.
[2013-06-28 20:08:36 -0400] paulmooring: |rt|: he's kallistec
[2013-06-28 20:09:07 -0400] ANGRYFUNBALL: paulmooring so, it would appear that even though knife tells me that the DB is created, it isn't
[2013-06-28 20:09:27 -0400] paulmooring: so did you create the data bag first?
[2013-06-28 20:09:36 -0400] paulmooring: like `knife data bag create ikfs
[2013-06-28 20:09:53 -0400] ANGRYFUNBALL: paulmooring did you not see the output that I just pasted less than 20 lines up?
[2013-06-28 20:09:59 -0400] ANGRYFUNBALL: yes, I created it
[2013-06-28 20:10:07 -0400] ANGRYFUNBALL: here let's go through this slowly
[2013-06-28 20:10:18 -0400] ANGRYFUNBALL: [root@chef1 repository]# knife data bag create ikfs test -e nano
[2013-06-28 20:10:22 -0400] |rt|: paulmooring: thanks
[2013-06-28 20:10:25 -0400] ANGRYFUNBALL: Created data_bag[ikfs]
[2013-06-28 20:10:30 -0400] ANGRYFUNBALL: Created data_bag_item[test]
[2013-06-28 20:10:36 -0400] ANGRYFUNBALL: [root@chef1 repository]# knife data bag edit ikfs test -e nano
[2013-06-28 20:10:43 -0400] ANGRYFUNBALL: ERROR: The object you are looking for could not be found
[2013-06-28 20:10:48 -0400] ANGRYFUNBALL: Response: Cannot load data bag item test for data bag ikfs
[2013-06-28 20:11:00 -0400] ANGRYFUNBALL: paulmooring
[2013-06-28 20:12:02 -0400] bcave: when I do this http://pastie.org/8092400 chef tries to create the child directories before the parent... why is that?
[2013-06-28 20:13:10 -0400] ANGRYFUNBALL: paulmooring ah, very helpful of you
[2013-06-28 20:13:21 -0400] jbz_: Has anyone run into trouble with 10.16.4 where chef-client doesn't clean up /var/cache/chef/checksums?
[2013-06-28 20:13:25 -0400] paulmooring: ANGRYFUNBALL: that should work try doing -VV on the end of edit
[2013-06-28 20:13:30 -0400] jbz_: I know there was a bug for that that was fixed in an earlier version
[2013-06-28 20:13:35 -0400] paulmooring: should give more info on where it failed
[2013-06-28 20:13:41 -0400] ANGRYFUNBALL: paulmooring already did:
[2013-06-28 20:13:42 -0400] ANGRYFUNBALL: INFO: HTTP Request Returned 404 Object Not Found: Cannot load data bag item test for data bag ikfs
[2013-06-28 20:14:08 -0400] ANGRYFUNBALL: paulmooring the data bag item isnt being created in the first place
[2013-06-28 20:14:12 -0400] tabolario: ANGRYFUNBALL: do you have a chef server UI you can access to verify the data bag was created on the server?
[2013-06-28 20:14:14 -0400] ANGRYFUNBALL: why would cause that?
[2013-06-28 20:14:35 -0400] ANGRYFUNBALL: tabolario I have shell acces
[2013-06-28 20:14:36 -0400] ANGRYFUNBALL: s
[2013-06-28 20:15:09 -0400] tabolario: what's the output of `knife data bag list` after you run the create command?
[2013-06-28 20:15:09 -0400] paulmooring: ANGRYFUNBALL: so normally that process should work, if you want to verify w/o ui `knife data bag show ikfs` should show any items that were created
[2013-06-28 20:15:22 -0400] tabolario: and/or that ^^
[2013-06-28 20:15:26 -0400] paulmooring: tabolario: I think his problem is the item isn't getting created
[2013-06-28 20:15:43 -0400] tabolario: paulmooring: ah yeah see that now
[2013-06-28 20:15:50 -0400] ANGRYFUNBALL: paulmooring tabolario yes, it isn't being created. why?
[2013-06-28 20:16:36 -0400] ANGRYFUNBALL: I can't create new databag items in the UI
[2013-06-28 20:17:32 -0400] paulmooring: ANGRYFUNBALL: sounds like a server side error, using `knife data bag create ikfs testitem -VV` might hopefully shed more light, otherwise you probably need to check out some server logs
[2013-06-28 20:17:47 -0400] ANGRYFUNBALL: additionally:
[2013-06-28 20:17:47 -0400] ANGRYFUNBALL: ERROR: No route matches {:action=>"new", :controller=>"databag_items", :databag_id=>nil}
[2013-06-28 20:18:01 -0400] ANGRYFUNBALL: I can create a databag, but I cannot create databag items
[2013-06-28 20:20:06 -0400] ANGRYFUNBALL: paulmooring http://pastebin.com/6fUM5BN5
[2013-06-28 20:23:43 -0400] paulmooring: ANGRYFUNBALL: what's your server version?
[2013-06-28 20:24:06 -0400] ANGRYFUNBALL: sec
[2013-06-28 20:25:25 -0400] ANGRYFUNBALL: paulmooring how do i find the version of the server?
[2013-06-28 20:25:54 -0400] paulmooring: I think on the open source server there's a text file in /opt/chef
[2013-06-28 20:26:04 -0400] paulmooring: or `dkpg -l |grep chef`
[2013-06-28 20:26:17 -0400] paulmooring: if you install via dpkg or apt
[2013-06-28 20:26:24 -0400] ANGRYFUNBALL: paulmooring 11.0.4
[2013-06-28 20:26:41 -0400] stormerider: ANGRYFUNBALL: 11.0.8 is the current release, might want to upgrade
[2013-06-28 20:26:45 -0400] ANGRYFUNBALL: yeah never mind
[2013-06-28 20:26:52 -0400] ANGRYFUNBALL: 11.0.8
[2013-06-28 20:27:27 -0400] ANGRYFUNBALL: I think I'm going to just reinstall
[2013-06-28 20:27:29 -0400] ANGRYFUNBALL: this is insane
[2013-06-28 20:27:32 -0400] paulmooring: ANGRYFUNBALL: there's a similar bug report open: http://tickets.opscode.com/browse/CHEF-3955
[2013-06-28 20:27:55 -0400] ANGRYFUNBALL: goddamnit
[2013-06-28 20:28:25 -0400] paulmooring: I've not hit this one before but if you want to add to that ticket I'll see if I can track down some more info when I have a minute and update there
[2013-06-28 20:30:27 -0400] yanick: how do you update the server (like 11.0.6->11.0.8)? does "chef-server-ctl reconfigure" download the last version or will I need to get a new .deb from the website?
[2013-06-28 20:34:00 -0400] ANGRYFUNBALL: paulmooring what kind of information should i add to the ticket
[2013-06-28 20:34:55 -0400] paulmooring: ANGRYFUNBALL: chef server version for sure, but also the text from the errors you've seen
[2013-06-28 20:35:10 -0400] trollwork: I'm using the opcode postfix cookbook.. it mentions stocking the aliases with a array.. I'm not seeing any examples on how to do this.. anyone have any experience there?
[2013-06-28 20:35:17 -0400] prefix: this is baf
[2013-06-28 20:35:19 -0400] paulmooring: basically it's not a universal issue, so anything that might make it easier to reproduce for the devs
[2013-06-28 20:37:36 -0400] prefix: paulmooring do you believe a reinstall might help?
[2013-06-28 20:37:59 -0400] prefix: also, where are databags stored on the chef-server?
[2013-06-28 20:39:04 -0400] paulmooring: prefix: sorry but I really don't think I could give good answer there, I don't understand how this is happening on some instances and not others.
[2013-06-28 20:40:14 -0400] prefix: paulmooring ok. do you know where databags are stored ont eh chef server?
[2013-06-28 20:42:05 -0400] paulmooring: prefix: I think in the postgres db
[2013-06-28 20:42:37 -0400] prefix: eh
[2013-06-28 20:42:40 -0400] prefix: I figured
[2013-06-28 20:43:14 -0400] prefix: hm
[2013-06-28 20:43:17 -0400] prefix: wait a second
[2013-06-28 20:44:14 -0400] prefix: paulmooring http://pastebin.com/RU8V3XTH
[2013-06-28 20:46:13 -0400] lflux: jtimberman: you here?
[2013-06-28 20:59:34 -0400] |rt|: fujin: are you around?
[2013-06-28 21:09:34 -0400] prefix: how can I completely uninstall chef from a server?
[2013-06-28 21:09:45 -0400] Otterley: depends on how it was installed
[2013-06-28 21:09:53 -0400] Otterley: gem, or omnibus?
[2013-06-28 21:10:37 -0400] prefix: gem
[2013-06-28 21:10:45 -0400] Otterley: gem uninstall chef
[2013-06-28 21:10:58 -0400] prefix: hm
[2013-06-28 21:11:06 -0400] prefix: nevermind. it was install with omnibus
[2013-06-28 21:11:24 -0400] Otterley: then remove the package; directions vary according to your OS
[2013-06-28 21:11:48 -0400] prefix: will it remove all data/
[2013-06-28 21:11:49 -0400] prefix: ?
[2013-06-28 21:12:00 -0400] Otterley: depends on how you invoke your package manager
[2013-06-28 21:12:02 -0400] prefix: (I would like it to)
[2013-06-28 21:12:10 -0400] prefix: RHEL5
[2013-06-28 21:12:19 -0400] Otterley: man rpm, should be in there somewhere
[2013-06-28 21:17:53 -0400] vbo2: Hi all.  I have just a couple of hours experience with Chef, so excuse my newbiness.  I need to start an service (with the Upstart provider) *and* pass a parameter to the service.  I've seen that this was covered by the issue #3048 but I couldn't find an example in the official doc nor the wiki.  Do you have any pointer/example?
[2013-06-28 21:18:23 -0400] Otterley: does it have to be upstart?
[2013-06-28 21:19:04 -0400] vbo2: yes, upstart is a hard requirement
[2013-06-28 21:19:12 -0400] Otterley: can't use runit?
[2013-06-28 21:19:38 -0400] danngrant: quick questions...   I'm getting invailid signature, I have updated my .pem file, but still get the same error...
[2013-06-28 21:21:23 -0400] vbo2: well, I didn't know about runit but all our custom debian packages already use upstart...  What I would need is just an example in the doc for the issue #3048
[2013-06-28 21:25:58 -0400] Otterley: vbo2, I don't really use the upstart provider, but it looks like it now accepts a "parameters" attribute that takes  arbitrary k/v parameters
[2013-06-28 21:26:56 -0400] kallistec: Hey Chefs, 11.6 RC available: https://gist.github.com/danielsdeleo/5887397
[2013-06-28 21:27:15 -0400] Otterley: @kallistec, please tell me you fixed why-run for directories
[2013-06-28 21:27:30 -0400] Otterley: 11.6 shouldn't go out the door without it IMHO
[2013-06-28 21:28:01 -0400] prefix: any idea why I'd be getting this when trying to run the chef install: bash: /usr/bin/chef-server-ctl: No such file or directory
[2013-06-28 21:28:20 -0400] Otterley: prefix, are you install chef client or server?
[2013-06-28 21:28:26 -0400] prefix: server
[2013-06-28 21:28:30 -0400] prefix: http://docs.opscode.com/install_server.html
[2013-06-28 21:28:35 -0400] prefix: RHEL5
[2013-06-28 21:28:46 -0400] prefix: it appears to install just fine
[2013-06-28 21:28:57 -0400] vbo2: Otterley : something like : parameters = Hash["a" => 100, "b" => 200]
[2013-06-28 21:29:00 -0400] vbo2: ?
[2013-06-28 21:29:09 -0400] prefix: Thank you for installing Chef!  [root@chef2 ~]# chef-server-ctl reconfigure  -bash: /usr/bin/chef-server-ctl: No such file or directory
[2013-06-28 21:29:16 -0400] Otterley: parameters { 'a' => 100, 'b' => 200 }
[2013-06-28 21:29:40 -0400] Otterley: actually you'll probably have to put it in parens
[2013-06-28 21:29:44 -0400] kallistec: Otterley: internet here is being crappy, not sure if that posted. But yeah, that's fixed.
[2013-06-28 21:29:48 -0400] Otterley: parameters('a' => 100, 'b' => 200)
[2013-06-28 21:29:57 -0400] vbo2: Otterley: thanks!  I promise I will send a patch for the documentation!
[2013-06-28 21:29:57 -0400] Otterley: @kallistec, excellent =)
[2013-06-28 21:30:46 -0400] prefix: Otterley any thoughts?
[2013-06-28 21:30:57 -0400] Otterley: prefix, I don't run it on RHEL so I'm not sure
[2013-06-28 21:31:05 -0400] Otterley: sounds like the package didn't install properly
[2013-06-28 21:31:14 -0400] prefix: yep
[2013-06-28 21:32:25 -0400] prefix: well
[2013-06-28 21:32:41 -0400] prefix: where are the RPMs for chef-server 11.0.8?
[2013-06-28 21:33:11 -0400] Otterley: check the content of the install.sh script
[2013-06-28 21:49:08 -0400] gwar9999: I'm currently using puppet but am looking at chef.  Do Chef nodes stay in sync automatically (ie. do you have to "run" something on the node to trigger the updates from the master server)?  Thanks.
[2013-06-28 21:50:38 -0400] Otterley: gwar9999, typically you run chef-client via cron or runit or as a daemon from an initscript.  the frequency of synchronization is up to you.
[2013-06-28 21:51:04 -0400] gwar9999: Otterley: thanks, so Chef is more of a pull system then?
[2013-06-28 21:51:08 -0400] Otterley: correct.
[2013-06-28 21:51:28 -0400] Otterley: I like to think of it as a fancy-schmancy shell script that talks to a server to get some data.
[2013-06-28 21:51:32 -0400] prefix: yo, when knife configure --initial asks for a name for a new user, what user am I creating?
[2013-06-28 21:51:53 -0400] prefix: put differently, what will this "user" do
[2013-06-28 21:52:09 -0400] Otterley: prefix, have you read the documentation thoroughly?
[2013-06-28 21:52:16 -0400] prefix: Otterley I sure have
[2013-06-28 21:53:15 -0400] prefix: is this the main admin user for chef?
[2013-06-28 21:53:31 -0400] Otterley: prefix, it's a user on the Chef server.  it has its own user authentication system, separate from the system it runs on
[2013-06-28 21:53:34 -0400] prefix: knife configure --initial isn't clear on this point
[2013-06-28 21:53:58 -0400] gwar9999: Can you force any updates to one-or-more nodes from a master (say you want to push a change to all Apache nodes right now)?  I see that Chef uses ZeroMQ so I figured that was possible but not sure.
[2013-06-28 21:54:19 -0400] prefix: so Otterley I know you know the asnwer. why don't you tell me?
[2013-06-28 21:54:25 -0400] Otterley: Chef doesn't user ZeroMQ, maybe you're thinking of something else
[2013-06-28 21:54:40 -0400] Otterley: prefix, see above
[2013-06-28 21:54:41 -0400] anoldhacker: given that cookbook names are joined to resource names to create method names for accessing the resource in the cookbook, why are there dashes in so many upstream cookbooks?
[2013-06-28 21:55:05 -0400] Otterley: gwar9999, the only thing Chef provides at the moment is 'knife ssh', which you can use to force a chef-client run.
[2013-06-28 21:55:15 -0400] Otterley: it's basically a Capistrano wrapper.
[2013-06-28 21:56:15 -0400] gwar9999: Oh my mistake, I think it's rabbitmq it uses for indexing but I guess not for pushing changes.
[2013-06-28 21:56:58 -0400] Otterley: that said, you could probably get Chef and MCollective to work together if you wanted to
[2013-06-28 21:57:26 -0400] Otterley: or whatever the new orchestration hotness is these days
[2013-06-28 21:57:41 -0400] gwar9999: haha, thanks Otterley.
[2013-06-28 22:06:34 -0400] anoldhacker: given that cookbook names are joined to resource names to create method names for accessing the resource in the cookbook, why are there dashes in so many upstream cookbooks?
[2013-06-28 22:11:46 -0400] prefix: uh. what does this mean? ERROR: Chef::Exceptions::ValidationFailed: Option admin must be a kind of [TrueClass, FalseClass]!  You passed "https://chef2.com/users/admin"
[2013-06-28 22:14:21 -0400] prefix: ok
[2013-06-28 22:14:46 -0400] prefix: the helper for knife configure --initial is broken
[2013-06-28 22:14:52 -0400] prefix: paulmooring ^
[2013-06-28 22:15:29 -0400] prefix: chef 11's server url should be https + should include no port
[2013-06-28 22:28:18 -0400] tabolario: in response to earlier, are there a lot of folks out there just using capistrano to orchestrate things alongside chef?
[2013-06-28 22:31:34 -0400] Otterley: we are, but it's not gonna scale
[2013-06-28 22:36:34 -0400] tabolario: Otterley: yeah my thoughts too it's manageable for me right now but i can see my cap recipes filling up pretty rapidly everytime i want to automate something across nodes
[2013-06-28 22:36:50 -0400] Otterley: I meant in terms of concurrency
[2013-06-28 22:37:01 -0400] tabolario: ah
[2013-06-28 22:37:17 -0400] Otterley: you can't effectively ssh to 1000 machines in parallel from one host
[2013-06-28 22:37:25 -0400] tabolario: well along the same lines, the output is pretty useless too when you have 10 nodes running chef client into the same stdout
[2013-06-28 22:37:41 -0400] tabolario: what alternatives have you considered?
[2013-06-28 22:39:13 -0400] stormerider: tabolario: this is what i use, but im only dealing with 50 or so instances atm: https://gist.github.com/stormerider/5888710
[2013-06-28 22:40:16 -0400] Otterley: nothing at the moment, I'll probably open source something I wrote several years ago for another company at some point
[2013-06-28 22:57:23 -0400] gokr: Hey folks, got a problem.
[2013-06-28 22:57:52 -0400] gokr: I have a client with a machine that reports a "custom" platform. I wonder where ohai picks up platform?
[2013-06-28 23:13:14 -0400] gokr: Ok, so I figured that out myself.
[2013-06-28 23:17:41 -0400] mjb91: Does opscode maintain the cookbooks they've published? Looking at the github repo I see lots of months old pull requests that haven't been merged or even commended on.
[2013-06-28 23:18:02 -0400] mjb91: (postfix cookbook)
[2013-06-28 23:19:12 -0400] Otterley: they do, but they need more than a PR to accept contributed code
[2013-06-28 23:19:45 -0400] idlemichael: i'm beating my head against the wall trying to write a service that isn't a "normal" service. does anyone have experience doing this? ie, not wrapping a standard web server, but wrapping your own script?
[2013-06-28 23:20:07 -0400] Otterley: what are you trying to do, idlemichael ?
[2013-06-28 23:20:23 -0400] Otterley: have you read the LWRP docs carefully?
[2013-06-28 23:21:41 -0400] mjb91: That makes sense. I remember reading about the needed CLA before.
[2013-06-28 23:21:42 -0400] mjb91: Thanks.
[2013-06-28 23:21:51 -0400] idlemichael: tehre's this app: http://shopify.github.io/dashing/, it uses Sinatra, which eventually uses thin server to run itself. it has a built in daemon starter, but it gets installed as a gem. I want to run this process, "dashing", as a service. I've tried a few things so far
[2013-06-28 23:22:24 -0400] Otterley: idlemichael, set it up as a runit-managed service.  shouldn't be too hard
[2013-06-28 23:23:06 -0400] idlemichael: heh
[2013-06-28 23:25:10 -0400] Otterley: runit really is perfect for such things
[2013-06-28 23:25:15 -0400] Otterley: and there's even a cookbook.
[2013-06-28 23:25:23 -0400] idlemichael: Otterley: the documentaiton for both is rather unforgiving, imo
[2013-06-28 23:25:59 -0400] Otterley: yeah, it assumes you've set up such a service before - unfortunately I don't have the resources to provide a deep dive here
[2013-06-28 23:26:03 -0400] idlemichael: Otterley: not to say that it isn't the right or wrong way
[2013-06-28 23:27:50 -0400] Otterley: the essence of runit, though, is that you write a script called a "run" script that you can make do anything you want, as long as the last line is a line that calls "exec <some_program> [args]".  and whatever program you're exec'ing must not daemonize or detach itself
[2013-06-28 23:28:24 -0400] Otterley: in this case it would be the thin webserver.
[2013-06-28 23:31:00 -0400] Otterley: runit contains a program called "runsvdir" which watches a "service directory", which, in turn contains a number of subdirectories, one per service.   for each service directory, runsvdir spawns a program called "runsv", which runs the "run" script and restarts it if it dies.
[2013-06-28 23:31:23 -0400] Otterley: the runit cookbook takes care of setting up the service directories for you
