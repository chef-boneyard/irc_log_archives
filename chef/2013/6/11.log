[2013-06-11 00:17:09 -0400] hakunin: hi guys
[2013-06-11 00:17:22 -0400] hakunin: (i mean it in a unisex way)
[2013-06-11 00:17:43 -0400] hakunin: can somebody explain how the hell do i use test kitchen?
[2013-06-11 00:18:22 -0400] hakunin: i already watched a bunch of talks and read a bunch of blog posts, then dug through source code and examples for the last 2 days
[2013-06-11 00:18:41 -0400] hakunin: i use berkshelf and "the berkshelf way"
[2013-06-11 00:19:02 -0400] ivey: http://starkandwayne.com/articles/2013/05/07/tdd-your-devops-with-test-kitchen/
[2013-06-11 00:19:09 -0400] hakunin: just created a cookbook, and i have a vagrant instance bootstrapping just fine
[2013-06-11 00:19:15 -0400] ivey: good intro, includes berkshelf
[2013-06-11 00:19:27 -0400] hakunin: oh yeah i saw Nick's talk
[2013-06-11 00:19:40 -0400] hakunin: ivey: but not this post
[2013-06-11 00:20:30 -0400] hakunin: ivey: oh it is the same cast
[2013-06-11 00:20:46 -0400] ivey: i basically did what he did
[2013-06-11 00:20:56 -0400] ivey: except i used mintest instead of bats
[2013-06-11 00:20:58 -0400] ivey: and got it working
[2013-06-11 00:21:11 -0400] ivey: https://github.com/RiotGames/artifact-cookbook has some basic kitchen tests
[2013-06-11 00:21:53 -0400] ivey: and here's the PR where we did the first pass if you want to see what all we did https://github.com/RiotGames/artifact-cookbook/commit/524511818750fbf4b10e4b2f452b61e4acc2a9c1
[2013-06-11 00:22:16 -0400] hakunin: so half of opscode cookbooks use minitest handler under files/default/, another half have tests setup under "tests" directory, berkshelf generates "test/integration" directories for you which i have no idea what to do with, kitchen verify does nothing, tk-demo uses rspec, i'm so lost
[2013-06-11 00:23:04 -0400] hakunin: ivey: i'll settle on this if i figure out how to set it up
[2013-06-11 00:23:07 -0400] ivey: test/integration is kitchen
[2013-06-11 00:23:45 -0400] hakunin: ivey: yeha but placing things there does nothing. I have also a Thorfile with million commands that essentially repeat all the kitchen commands, so seems redundant
[2013-06-11 00:24:12 -0400] hakunin: but not a single doc or explanation of how to use actually setup any tests
[2013-06-11 00:24:24 -0400] ivey: placing things there that match a defined kitchen suite will let kitchen run them
[2013-06-11 00:25:38 -0400] hakunin: ivey: sorry i'm a little upset having spent quite a long time trying to make sense of all this. do you have any link i could possibly read about that test/integration setup?
[2013-06-11 00:25:49 -0400] ivey: http://jtimberman.housepub.org/blog/2013/03/19/anatomy-of-a-test-kitchen-1-dot-0-cookbook-part-1/ is also useful but somewhat dated
[2013-06-11 00:26:01 -0400] hakunin: i've read that, it's not very useful at this point
[2013-06-11 00:26:21 -0400] hakunin: this says i should add more recipes to the runlist
[2013-06-11 00:26:28 -0400] hakunin: for tests
[2013-06-11 00:27:11 -0400] ivey: this commit: https://github.com/RiotGames/artifact-cookbook/commit/524511818750fbf4b10e4b2f452b61e4acc2a9c1 adds pure test-kitchen + minitest
[2013-06-11 00:27:52 -0400] ivey: best i can offer you, since we just followed along w/ drnic's video and then read the source of busser-minitest to figure out how to use it
[2013-06-11 00:29:50 -0400] hakunin: ivey: alright, thanks a lot for that commit and pointers, i'll continue the battle now
[2013-06-11 00:31:45 -0400] stormerider: hakunin: thank you for the unisex reference :)
[2013-06-11 00:32:48 -0400] hakunin: stormerider: i try avoid using "guys", but can't edit what i already sent :(
[2013-06-11 00:33:08 -0400] stormerider: hakunin: *nodnod* likewise
[2013-06-11 00:35:57 -0400] hakunin: I'm sure Jamie Winsor has some specific opinion on how testing should be setup, i see conversations in berkshelf issues
[2013-06-11 00:36:17 -0400] ivey: he doesn't use TK much yet
[2013-06-11 00:36:33 -0400] hakunin: he did say he wanted to encourage its use asap
[2013-06-11 00:36:38 -0400] ivey: yes
[2013-06-11 00:36:56 -0400] hakunin: what does he use?
[2013-06-11 00:36:58 -0400] ivey: i'm talking to him on video right now, which is why i feel OK speaking for him ;-)
[2013-06-11 00:37:08 -0400] ivey: we (Riot) are starting to put TK in everything
[2013-06-11 00:37:34 -0400] hakunin: so you guys wrote berkshelf that generates test kitchen for you
[2013-06-11 00:37:45 -0400] hakunin: but you are not sure how best to use it
[2013-06-11 00:37:50 -0400] hakunin: :)
[2013-06-11 00:37:58 -0400] ivey: yes, although given the state of TK we hid some of that in berks 2.0
[2013-06-11 00:38:05 -0400] ivey: and i just showed you how to use it :-)
[2013-06-11 00:38:13 -0400] ivey: i just don't have a good tutorial to share
[2013-06-11 00:39:44 -0400] hakunin: ivey: so placing files under test/integration/minitest and requiring minitest/autorun is enough to get them to run?
[2013-06-11 00:40:00 -0400] ivey: yes
[2013-06-11 00:44:00 -0400] reset: hakunin: test kitchen is still under heavy development and the documentation is coming. Last friday we had community tools hangout where we discussed the last remaining issues
[2013-06-11 00:44:23 -0400] reset: we encourage the use of it and we generate files for you in Berkshelf 2.0
[2013-06-11 00:44:42 -0400] reset: nobody has a really awesome tutorial of how to put it all together yet
[2013-06-11 00:45:01 -0400] hakunin: reset: hey Jamie, that's great to hear. I see lots of CLI, but no help :). your talk was pretty eye-opening though
[2013-06-11 00:45:24 -0400] hakunin: heh
[2013-06-11 00:46:09 -0400] reset: hakunin: thanks man, I hope that we can make a push to educate and get test kitchen in the forefront in the next few months
[2013-06-11 00:46:17 -0400] reset: just hang in there while we smooth it out
[2013-06-11 00:48:36 -0400] stormerider: reset: cool. i haven't worked on getting test / ci integration set up yet but it's on my list :)
[2013-06-11 00:49:02 -0400] reset: It's something that we (RiotGames) are focusing in on in the next few months
[2013-06-11 00:49:27 -0400] reset: hopefully some nice how to guides will come out of that
[2013-06-11 00:49:33 -0400] grobot: has chef-client::upgrade been replaced by a new command?
[2013-06-11 00:49:40 -0400] hakunin: reset: btw i'm on berkshelf 2.0.1 and .kitchen dir still gets generated outside of cookbook, despite the commit that should fix it. just fyi
[2013-06-11 00:50:13 -0400] reset: hakunin: drop an issue in the tracker and we'll take a look at it. Sorry about that
[2013-06-11 00:50:13 -0400] grobot: "could not find recipe upgrade" - trying to do https://gist.github.com/xurizaemon/513c2c3a7dc411be0cc4
[2013-06-11 00:50:27 -0400] grobot: (in vagrantfile there)
[2013-06-11 01:07:53 -0400] gkarekinian: There's never been a chef-client::upgrade recipe
[2013-06-11 01:08:59 -0400] grobot: heh ok
[2013-06-11 01:09:18 -0400] grobot: note chef-client::upgrade not chef::upgrade
[2013-06-11 01:10:03 -0400] grobot: basically, i want to provision the vm (vagrant) and upgrade chef-client out of the box
[2013-06-11 01:10:34 -0400] grobot: because devs on team run into everything if it's not already sorted
[2013-06-11 01:10:55 -0400] grobot: so i'm trying to eliminate chef-client / chef-solo / ruby version issues for them
[2013-06-11 01:11:10 -0400] gkarekinian: You could use something like https://github.com/hw-cookbooks/omnibus_updater
[2013-06-11 01:11:45 -0400] grobot: haven't heard of omnibus before
[2013-06-11 01:12:05 -0400] grobot: using librarian-chef atm
[2013-06-11 01:12:20 -0400] grobot: oh ok it's a vendor release from opscode?
[2013-06-11 01:12:31 -0400] ivey: https://github.com/schisamo/vagrant-omnibus
[2013-06-11 01:12:46 -0400] grobot: ooooo
[2013-06-11 01:12:54 -0400] ivey: A Vagrant plugin that ensures the desired version of Chef is installed via the platform-specific Omnibus packages.
[2013-06-11 01:12:54 -0400] grobot: ok, i'll give that a spin
[2013-06-11 01:13:15 -0400] grobot: if only i had virtualised developers so i can fire them up and get them to break things so i can fix it
[2013-06-11 01:13:26 -0400] grobot: thx
[2013-06-11 01:15:08 -0400] Otterley: grobot, https://github.com/Netflix/SimianArmy
[2013-06-11 01:15:19 -0400] hakunin: ivey: am i insane if i'm trying to setup kitchen.yml to start a bunch of servers at once and have them talking to one another?
[2013-06-11 01:15:34 -0400] hakunin: ivey: i thought this was possible: https://github.com/bryanwb/tk-demo/blob/master/.kitchen.yml
[2013-06-11 01:15:48 -0400] hakunin: ivey: but that file uses "platforms" different from you guys
[2013-06-11 01:16:12 -0400] ivey: i don't know
[2013-06-11 01:16:41 -0400] hakunin: sorry for speaking @you, intertia
[2013-06-11 01:16:56 -0400] hakunin: *inertia
[2013-06-11 01:29:28 -0400] danryan: Hrm. `berks` == `berks update`, _not_ `berks install`
[2013-06-11 01:50:00 -0400] alff: does the chef 11 support data bag nested search?
[2013-06-11 01:50:58 -0400] alff: looks like a bug
[2013-06-11 01:52:28 -0400] sol11chefintrain: would anyone happen to know how chef distinguishes between Solaris SMF services that share similar names - example : nis/client nis/domain?  if i specify 'service "nis" do', and mean to only affect nis/domain, would i have to specify 'service "nis/domain" do' or would 'service "anyname" do' be sufficient as long as I specify start_command, restart_command, etc?
[2013-06-11 01:56:05 -0400] koaps: heya all
[2013-06-11 02:01:30 -0400] alff: anyone?
[2013-06-11 02:02:04 -0400] koaps: alff: what was the Q?
[2013-06-11 02:02:37 -0400] alff: koaps: does the chef 11 support data bag nested search?looks like a bug
[2013-06-11 02:03:35 -0400] koaps: ah dont know that one, I'm still trying to get through the migrate process without failure
[2013-06-11 02:28:41 -0400] dyu: is it possible to get data from data bags from inside the attributes/ directory?
[2013-06-11 02:35:10 -0400] gkra: Okay, I'm probably doing something wrong, but...
[2013-06-11 02:35:54 -0400] gkra: I need to search for /some/path/to/*/blah/file.txt
[2013-06-11 02:36:09 -0400] gkra: and if it exist, grab the path component that matched the *
[2013-06-11 02:36:21 -0400] gkra: what's the cheffiest way to get that done?
[2013-06-11 02:38:09 -0400] gkra: hmm ruby_block and use Find?...
[2013-06-11 03:02:13 -0400] dyu: gkra: use the execute block?
[2013-06-11 03:02:54 -0400] koaps: anyone know why I might be getting a 401 "Authorization Required" when click on a cookbook version number in Chef 11
[2013-06-11 03:27:48 -0400] koaps: in chef 11 is there a way to flush out the cookbook data? something is funkytown
[2013-06-11 03:37:22 -0400] koaps: man that suckd, figured it out bookshelf wasn't happy
[2013-06-11 05:16:21 -0400] koblas: Anybody know how to convince chef it's a first run (hosted chef) - getting the following error
[2013-06-11 05:16:21 -0400] koblas: [2013-06-11T05:15:49+00:00] DEBUG: I am not loading homesick, because I have already seen it.
[2013-06-11 05:31:51 -0400] timsmith: how do you search for a nested attribute in knife search?
[2013-06-11 05:32:10 -0400] Otterley: timsmith, outerkey_innerkey
[2013-06-11 05:32:22 -0400] timsmith: what if the key has a _ in it like a lot of them do
[2013-06-11 05:32:27 -0400] Otterley: that's fine
[2013-06-11 05:32:35 -0400] Otterley: just include it
[2013-06-11 05:32:50 -0400] timsmith: perfec thanks
[2013-06-11 05:32:52 -0400] Otterley: e.g. outer_key_inner_key
[2013-06-11 05:35:22 -0400] Otterley: koblas, cookbooks are cached in /var/chef/cache/cookbooks; you can blow it away
[2013-06-11 05:35:48 -0400] Otterley: (assuming you installed the omnibus client)
[2013-06-11 05:39:31 -0400] koblas: thanks - otterley
[2013-06-11 06:00:11 -0400] stormerider: out of curiousity, is it possible to specify the environment a node should use in the JSON file that you pass to chef-client, or does it have to be in client.rb?
[2013-06-11 06:05:09 -0400] Otterley: it can go in the JSON, I believe
[2013-06-11 06:05:26 -0400] Otterley: or, you can pass -E to chef-client
[2013-06-11 07:03:51 -0400] proppen: Otterley: Yes you can, just add "chef_environment": "Environment", to your node json file
[2013-06-11 07:06:57 -0400] admin0: good morning all
[2013-06-11 07:15:41 -0400] m4rcu5: meurning
[2013-06-11 07:20:12 -0400] dyu: what's the recommended way of doing version control for chef?
[2013-06-11 07:21:04 -0400] dyu: right now my team is planning to just keep track of everything(chef-repo, data bags, cookbooks, etc) in one large/monolithic repository
[2013-06-11 07:21:25 -0400] dyu: i'm against it, by the way haha
[2013-06-11 07:22:32 -0400] dyu: i suggested that we just keep a data bags repo, one repo for each cookbook, and use an unchanged clone of chef-repo
[2013-06-11 07:25:38 -0400] proppen: dyu: I have been wondering about the same actually. I guess it can be done in a better way, but for now I check all node data, scripts etc into a SVN repo called something like "chef-repo", then I have subfolders named "dev test stage prod". All these sub folders contains a deploy script with knife commands, and folders "cookbooks nodes environment roles"
[2013-06-11 07:27:15 -0400] proppen: When something is checked in to chef-repo/dev/nodes/ for example, Bamboo detects it and triggers an SVN check out, and runs the deploy script with the appropriate knife commands
[2013-06-11 07:28:29 -0400] m4rcu5: proppen: are you running prod and dev on the same chef server?
[2013-06-11 07:29:48 -0400] proppen: m4rcu5 I have not implemented prod yet, only dev so I'm not 100% decided yet, but I'm leaning towards it.
[2013-06-11 07:31:30 -0400] proppen: I really think it would be nice to work out some good best practice for this
[2013-06-11 07:39:53 -0400] m4rcu5: proppen: i cant seem to find a real nice way on how to make sure that the following does not happen: new cookbook uploaded, cookbook pinned in dev, role modified to include cookbook, now prod starts running the cookbook because someone forgot to pin it there
[2013-06-11 07:42:53 -0400] proppen: m4rcu5: Can't you do something with "knife cookbook upload cook_book --freeze"?
[2013-06-11 07:44:07 -0400] proppen: I guess it's not 100% fool proof
[2013-06-11 07:45:02 -0400] superbaloo: would github be using parts of chef ? https://github.com/github/enterprise-ohai
[2013-06-11 07:46:30 -0400] m4rcu5: proppen: yep that would prevent accedental updating, but as long as there is no, only accept cookbooks if they are pinned in the env file, accidents could still happen
[2013-06-11 07:46:46 -0400] m4rcu5: knife-spork however seems to make it a bit better
[2013-06-11 07:50:41 -0400] proppen: m4rcu5: knife-spork seems a bit on the way, yes :) I'll look into that too I think
[2013-06-11 08:16:45 -0400] stoked: how would I apply a default role to all nodes in an environment?
[2013-06-11 08:42:13 -0400] admin0: hi .. anyone knows how to put data bags path in solo ?
[2013-06-11 08:43:16 -0400] admin0: i used data_bag_path  just like the cookbook path, but when I do knife solo data bag list, I get; ERROR: TypeError: can't convert Array into String
[2013-06-11 08:43:59 -0400] admin0: i am on Chef: 11.4.4
[2013-06-11 08:57:53 -0400] m4rcu5: Chef::Config['chef_server_url'].scan(/http[s]?:\/\/([a-z0-9\.\-]+)/), that should give me the hostname of the chef server right? it used tow ork with chef 10 at least
[2013-06-11 09:34:29 -0400] bcave: good day :)
[2013-06-11 09:35:22 -0400] bcave: quick question for everyone, what sort of infrastructure are you primarily using chef for? physical, virtual, combination, cloud?
[2013-06-11 09:36:08 -0400] m4rcu5: bcave: i guiess virtual is the most common
[2013-06-11 09:36:51 -0400] bcave: yeah, that's what i was thinking. either virtual (private) or cloud (service-provider based virt)
[2013-06-11 09:38:23 -0400] bcave: busy cooking with AWS at the moment
[2013-06-11 09:45:18 -0400] dyu: how come the definitions/ directory is not updated when doing an upload?
[2013-06-11 09:55:01 -0400] laurent\: bcave: combination of physical & virtual
[2013-06-11 09:55:06 -0400] dyu: nvm. it was my fault
[2013-06-11 09:58:25 -0400] bcave: thanks laurent
[2013-06-11 11:25:52 -0400] draiken: Hello, I'm having a weird problem that it's probably stupid
[2013-06-11 11:26:09 -0400] draiken: but I am trying to search for my nodes and nothing is returned
[2013-06-11 11:26:28 -0400] draiken: even tho when I rebuild the index it says it adds my nodes there
[2013-06-11 11:26:39 -0400] draiken: knife search node name:*
[2013-06-11 11:26:42 -0400] draiken: returns nothing
[2013-06-11 11:38:00 -0400] adamjk-dev: interesting
[2013-06-11 11:38:08 -0400] adamjk-dev: and 'knife node list' returns the nodees?
[2013-06-11 11:38:10 -0400] adamjk-dev: nodes*
[2013-06-11 11:39:20 -0400] draiken: yes
[2013-06-11 11:39:59 -0400] draiken: adamjk-dev: must be something really wrong, but I created the node with the bootstrap command
[2013-06-11 11:40:11 -0400] draiken: there is pretty much nothing in the node
[2013-06-11 11:40:17 -0400] adamjk-dev: weird
[2013-06-11 11:40:21 -0400] adamjk-dev: I have not done that myself
[2013-06-11 11:40:27 -0400] draiken: but I can't seem to find it through the search
[2013-06-11 11:40:55 -0400] adamjk-dev: strange
[2013-06-11 11:41:06 -0400] draiken: on the server log I see: INFO: Reloading 2 Chef::Node objects into the indexer
[2013-06-11 11:41:19 -0400] draiken: when using the reindex
[2013-06-11 11:47:25 -0400] adamjk-dev: hm
[2013-06-11 11:47:33 -0400] adamjk-dev: Sorry, I am not sure at all
[2013-06-11 11:48:34 -0400] draiken: I did have to upgrade the solr
[2013-06-11 11:48:40 -0400] draiken: maybe something is not right after that
[2013-06-11 11:49:05 -0400] draiken: cause I see the logs of the chef server saying it's reloading the node things, but nothing from the slot log
[2013-06-11 11:49:16 -0400] bcave: try \* ?
[2013-06-11 11:49:19 -0400] draiken: solr log*
[2013-06-11 11:49:47 -0400] draiken: 0 items found
[2013-06-11 12:13:47 -0400] alex____2: heh what happen if a execute command fails (with ignore failure) and it has a notitify
[2013-06-11 12:14:03 -0400] alex____2: would the notify be run or not?
[2013-06-11 12:26:54 -0400] alex____2: ?
[2013-06-11 13:06:57 -0400] kernelpanik: Hi guys!  does exist a node attribute that returns the amount or ram?  like node.memory?
[2013-06-11 13:12:07 -0400] m4rcu5: kernelpanik: yep, let me dig it up
[2013-06-11 13:13:28 -0400] m4rcu5: kernelpanik: node["memory"]["total"].to_i
[2013-06-11 13:14:26 -0400] kernelpanik: I try, thanks!
[2013-06-11 13:15:02 -0400] kernelpanik: gre8! chef > node.memory.total
[2013-06-11 13:15:03 -0400] kernelpanik:  => "3925308kB"
[2013-06-11 13:16:36 -0400] m4rcu5: kernelpanik: chef > puts node["memory"]["total"].to_i/1024 => 7996
[2013-06-11 13:16:53 -0400] kernelpanik: yes is better w/ the conversion in mb
[2013-06-11 14:04:44 -0400] mosez: is there a way to get knife bootstrap verbose? there seems to be any error within my knife.rb or on another place... even with -V i'm getting "ERROR: TypeError: can't convert nil into String" only :(
[2013-06-11 14:10:20 -0400] mosez: ok, error comes from my bootstrap file... got to figure out how i can see the exact error -.-
[2013-06-11 14:19:15 -0400] jgood: Hi, I'm new to chef and was wondering if I will have to include some sort of stop/end program command before updating programs and exe's.
[2013-06-11 14:20:25 -0400] m4rcu5: mosez: look for a undefined variable, maybe you don't pass some node attribute
[2013-06-11 14:21:04 -0400] m4rcu5: jgood: if they are services, you can define the serverice and use action :stop and :start in you cookbook
[2013-06-11 14:23:42 -0400] UukGoblin: why do I get a result with "knife search node 'role:foo'" but no results when I search for "knife search node 'roles:foo'"?
[2013-06-11 14:23:51 -0400] UukGoblin: using hosted chef?
[2013-06-11 14:24:54 -0400] mosez: m4rcu5: can not see anything... http://pastebin.com/h4LePGFH
[2013-06-11 14:25:15 -0400] mosez: uukgoblin: role and roles?
[2013-06-11 14:25:20 -0400] UukGoblin: mosez, yeah
[2013-06-11 14:25:38 -0400] UukGoblin: mosez, like, "roles" should return whatever "role" returns, and more (i.e. dependent roles)
[2013-06-11 14:26:17 -0400] UukGoblin: if you have a role "foo" that contains role "bar", then "roles" should find both "foo" and "bar", whereas "role" should show only "foo"
[2013-06-11 14:26:58 -0400] UukGoblin: http://docs.opscode.com/essentials_search.html#roles-in-run-lists
[2013-06-11 14:27:01 -0400] m4rcu5: mosez: looking at your bootstrap file, why not use the default?
[2013-06-11 14:37:17 -0400] surge_: When you `node.set['an']['attr'] = 'value' , are those supposed to cleared on the next Chef run? I'm not seeing that behavior with my Virtualbox VM
[2013-06-11 14:37:27 -0400] surge_: I had to manually delete the attributes from Chef Server
[2013-06-11 14:40:30 -0400] surge_: Nvm found the relevant documentation
[2013-06-11 14:54:49 -0400] masterkorp: How can check which nodes have a certain role on the run_list ?
[2013-06-11 14:56:17 -0400] mattupstate: masterkorp: knife node search "roles:<role-name>"
[2013-06-11 14:57:20 -0400] masterkorp: thanks
[2013-06-11 15:07:47 -0400] mosez: m4rcu5: because the default uses omnibus, and omnibus currently didnt like wheezy ;)
[2013-06-11 15:08:03 -0400] mosez: hum... is there a way to set a default environment on the knife.rb?
[2013-06-11 15:08:13 -0400] mosez: specificly for bootstrapping
[2013-06-11 15:09:27 -0400] awgross1: mosez: you can pass your own bootstrap script
[2013-06-11 15:09:36 -0400] FuZion755: hi all, I'm attempting to use the opscode application cookbook to deploy my application (application_php, specifically).   What I don't understand is in my database block (lines 12 - 14), then node variable is nil.  Outside of the database block I can access the node variable with no problem.  Does anyone have any idea why this would be?  https://gist.github.com/jamifsud/5757601
[2013-06-11 15:09:42 -0400] FuZion755: Any help would be greatly appreciated!
[2013-06-11 15:10:28 -0400] mosez: awgross1: already got my own bootstrap script. that's not the point.
[2013-06-11 15:11:17 -0400] mosez: got knife[:run_list] = "role[basics]" in my knife.rb. is there something like that for environment?
[2013-06-11 15:12:34 -0400] mosez: got it...
[2013-06-11 15:12:48 -0400] mosez: simply add knife[:environment] = "production" to knife.rb
[2013-06-11 15:19:23 -0400] awgross1: mosez: ahh sorry, i misread the question, you have the right solution
[2013-06-11 15:20:23 -0400] gswallow: Hello, all. I have a question about the mount resource.  http://pastebin.com/pBX00vAs
[2013-06-11 15:21:05 -0400] gswallow: Specifically, do you think the remount resource should do nothing if the volume isn't mounted?  I would think it should just mount the device.
[2013-06-11 15:23:21 -0400] jgood: m4rcu5: it took me a while to get back to this, but what i am trying to update is not a service. i'm having my recipe check an online repository for newer working copy of an exe, and replace the old with the new, but I wanted to check if there is anything that I need to do to stop this task if it is running, or if chef may do that on its own
[2013-06-11 15:31:58 -0400] m4rcu5: jgood: if you just ask chef to replace the exe it will not do anything with the process
[2013-06-11 15:41:56 -0400] pwf: so my chef server changed hostnames, and now all my knife commands fail with 'ERROR: OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv2/v3 read server hello A: (null)'
[2013-06-11 15:42:02 -0400] pwf: anyone know what the issue might be?
[2013-06-11 15:42:20 -0400] pwf: no way to change the hostname back... aws hardware failed and i had to stop/restart the instance
[2013-06-11 15:42:25 -0400] pwf: i'm now using an elastic ip :(
[2013-06-11 15:45:23 -0400] stormerider: pwf: im guessing that they're failing because the hostname for the cert was for the old ec2 name.
[2013-06-11 15:45:57 -0400] stormerider: pwf: there should be a way to reconfigure it, or disable ssl verification in knife (fixing would be better, of course)
[2013-06-11 15:46:02 -0400] pwf: is there any way to make it not care
[2013-06-11 15:46:07 -0400] pwf: this is an old, testing server
[2013-06-11 15:46:54 -0400] stormerider: in the client.rb, add ssl_verify_mode    :verify_none
[2013-06-11 15:47:07 -0400] stormerider: or knife.rb, i guess
[2013-06-11 15:47:16 -0400] stormerider: something along those lines
[2013-06-11 15:49:21 -0400] pwf: cool, that should give me a good start
[2013-06-11 15:49:22 -0400] pwf: thank you
[2013-06-11 15:50:33 -0400] stormerider: np
[2013-06-11 15:50:47 -0400] stormerider: i got a lot of help from the chef community, always happy to pay it forward
[2013-06-11 16:01:26 -0400] alexbilbie: Suppose I have a number of nodes that have been configured with Chef recipes (e.g. two web servers and a cache server), if I add a new cache server how do I update the config files of my web servers so they are aware of the new cache server?
[2013-06-11 16:08:14 -0400] rracterr: alexbilbie: presumably you have the cache servers to use in your attributes for say your web server role... you change the attributes on the role then wait for your chef-client to phone home and apply them... or push it with knife ssh chef-client
[2013-06-11 16:13:20 -0400] masterkorp: [2013-06-11T08:56:41-07:00] FATAL: Chef::Exceptions::Exec: package[munin] (munin::server line 73) had an error: Chef::Exceptions::Exec: apt-get -q -y install munin=1.4.6-3ubuntu3.3 returned 100, expected 0
[2013-06-11 16:13:25 -0400] masterkorp: what's 100 mean ?
[2013-06-11 16:13:59 -0400] mattupstate: 100 is very generic, often means a network error, or apt-get hasn't been updated first
[2013-06-11 16:17:39 -0400] pwf: stormerider: sooo that option apparently isn't an option anymore
[2013-06-11 16:17:53 -0400] pwf: and i just generated a new cert with that cname and it still doesn't seem to like it
[2013-06-11 16:18:35 -0400] adnichols: am I correct that using include_recipe "blah" in a recipe called "foo" doesn't actually add 'recipe[blah]' to my runlist? The runlist would only contain the original recipe[foo] & then include the code from the other recipes? I ask because if you have a recipe which checks for the existence of recipe[blah] in the runlist but recipe[blah] is only included via the recipe[foo] entry in the runlist I'm assuming the check for recipe[blah] would fail?
[2013-06-11 16:18:53 -0400] masterkorp: mattupstate: pretty sure it was
[2013-06-11 16:19:17 -0400] pwf: curl -vvv says common name matched
[2013-06-11 16:19:30 -0400] gkarekinian: adnichols: Yes, include_recipe doesn't add the recipe to your run_list (there's a ticket discussing this)
[2013-06-11 16:19:38 -0400] adnichols: gkarekinian thanks
[2013-06-11 16:20:21 -0400] erratic: yaawwwwwwwn
[2013-06-11 16:20:56 -0400] gkarekinian: I can't find the ticket though
[2013-06-11 16:21:01 -0400] erratic: does anyone here use gentoo
[2013-06-11 16:21:40 -0400] gkarekinian: http://tickets.opscode.com/browse/CHEF-1977
[2013-06-11 16:21:52 -0400] adnichols: perfect, thanks
[2013-06-11 16:27:40 -0400] bakins: alexbilbie: if you are using search to generate the configs on the web server, then you could run chef-client on them
[2013-06-11 16:29:43 -0400] alexbilbie: bakins: thanks, I didn't know about search to generate attributes
[2013-06-11 16:29:56 -0400] alexbilbie: how often does chef-client sync? or does it manually have to be called?
[2013-06-11 16:30:30 -0400] bakins: alexbilbie: depends on your config. we run chef-client once an hour. that may be fine for you, or you may want to trigger it on your web servers
[2013-06-11 16:31:08 -0400] alexbilbie: thanks a lot :)
[2013-06-11 16:32:25 -0400] Guest6785: "To make it easier for developers to dive into OpenStack so that they can productively contribute without having to understand every part of the system at once"
[2013-06-11 16:32:38 -0400] Guest6785: I really wish I could quit being a programmer now
[2013-06-11 16:32:50 -0400] Guest6785: thats the stupidest idea I've ever heard of
[2013-06-11 16:33:37 -0400] Guest6785: ssd7: hi
[2013-06-11 16:34:57 -0400] Guest6785: I need some programmer fuckin counseling or something
[2013-06-11 16:35:07 -0400] Guest6785: I hate this goddamn computer
[2013-06-11 16:35:42 -0400] c_t: fire up the ol' Eliza bot
[2013-06-11 16:36:18 -0400] Guest6785: here
[2013-06-11 16:36:21 -0400] Guest6785: go to this page
[2013-06-11 16:36:29 -0400] Guest6785: https://github.com/openstack-dev/devstack
[2013-06-11 16:36:31 -0400] Guest6785: read the goals.
[2013-06-11 16:36:43 -0400] Guest6785: makes me want to stab kittens
[2013-06-11 16:38:12 -0400] stormerider: if you dont like openstack, find something else.
[2013-06-11 16:39:16 -0400] pwf: so i finally got this crap to work by putting the old ec2 hostname in /etc/hosts and pointing it to my new elastic IP
[2013-06-11 16:39:28 -0400] pwf: does ruby have its own known_hosts file or something somehwere
[2013-06-11 16:39:55 -0400] Guest6785: stormerider: omg really
[2013-06-11 16:40:09 -0400] Guest6785: Im perfectly ok using virt-manager
[2013-06-11 16:40:20 -0400] Guest6785: obviously
[2013-06-11 16:41:46 -0400] stormerider: *rolls eyes*
[2013-06-11 16:42:17 -0400] Guest6785: hey
[2013-06-11 16:42:21 -0400] stormerider: pwf: i bet it was looking at something cached
[2013-06-11 16:42:53 -0400] stormerider: pwf: as for known_hosts file, that's ssh specific i believe
[2013-06-11 16:43:02 -0400] pwf: yeah but i meant some ruby analog or something
[2013-06-11 16:43:15 -0400] pwf: i got it working with my change to /etc/hosts, but i'm reaaaaally curious what was going on
[2013-06-11 16:43:34 -0400] stormerider: did you regenerate the cert after the hostname change?
[2013-06-11 16:46:09 -0400] pwf: yeah
[2013-06-11 16:46:24 -0400] pwf: common name was matching afterwards according to curl
[2013-06-11 16:46:41 -0400] pwf: and now it's NOT matching because i'm using the old hostname and the cert for the new IP, but it still works
[2013-06-11 16:56:46 -0400] Guest6785: failfailfailfailfailfail
[2013-06-11 16:57:40 -0400] Guest6785: everyone says that xenserver base is free but I dont think it is
[2013-06-11 16:57:46 -0400] Guest6785: their site says its an eval
[2013-06-11 16:57:58 -0400] Otterley: it is free as in beer
[2013-06-11 16:58:04 -0400] Guest6785: also xen is dead afaik
[2013-06-11 16:58:14 -0400] Otterley: based on what, Guest6785 ?
[2013-06-11 16:58:23 -0400] Otterley: EC2 uses Xen as its HV
[2013-06-11 16:58:24 -0400] Guest6785: I think kvm is actually getting more development time than xen is
[2013-06-11 16:58:54 -0400] Guest6785: I dont really care about ec2 also yeah so does rackspace
[2013-06-11 16:59:11 -0400] Otterley: we use XenServer - a VM solution is far more than its kernel component
[2013-06-11 16:59:28 -0400] Guest6785: the only thing that sounds remotely interesting is spot instances
[2013-06-11 16:59:37 -0400] Otterley: things like being able to relocate VMs easily from one HV to another without downtime is super useful
[2013-06-11 16:59:39 -0400] Guest6785: Otterley: yeah
[2013-06-11 17:00:03 -0400] Guest6785: Im just thinking holy shit they want a lot of money..per server
[2013-06-11 17:00:05 -0400] Otterley: also the userspace component of XenServer is very very nice
[2013-06-11 17:00:20 -0400] Otterley: (i.e. the xe command set)
[2013-06-11 17:00:42 -0400] Guest6785: so how deep into it do you get like heartbeat and corosync and all that
[2013-06-11 17:00:45 -0400] Guest6785: and drbd?
[2013-06-11 17:00:54 -0400] Otterley: we don't use that
[2013-06-11 17:02:59 -0400] Guest6785: I've put together a pretty reliable gentoo hardened image
[2013-06-11 17:03:16 -0400] Guest6785: working on getting the openstack overlay setup BUT
[2013-06-11 17:03:20 -0400] Guest6785: I dont like it :S
[2013-06-11 17:03:25 -0400] Otterley: I think we're paying around $2500/HV for the Advanced version, but that's less than the price of one bare-metal server, so it's worth it to us
[2013-06-11 17:03:30 -0400] Guest6785: I dont like alot of stuff though
[2013-06-11 17:03:53 -0400] Guest6785: yeah haha
[2013-06-11 17:04:05 -0400] Guest6785: hm
[2013-06-11 17:04:05 -0400] timsmith: anyone seeing timeouts on hosted right now?
[2013-06-11 17:04:22 -0400] Otterley: we were living on the Free edition for about 18 months but we wanted the Storage XenMotion feature as well as official support
[2013-06-11 17:04:56 -0400] Guest6785: hows the support
[2013-06-11 17:05:07 -0400] Otterley: I can't say - we haven't had to use it yet
[2013-06-11 17:05:41 -0400] Guest6785: yeah
[2013-06-11 17:06:14 -0400] Guest6785: https://forums.grsecurity.net/viewtopic.php?f=3&t=2710
[2013-06-11 17:07:11 -0400] Guest6785: thats really old though
[2013-06-11 17:07:29 -0400] Guest6785: Im surprised I haven't had any problems with it :S
[2013-06-11 17:08:02 -0400] Guest6785: although I think the most stable I could find at the time was 3.2.40-hardened
[2013-06-11 17:08:22 -0400] Guest6785: I think that was because I couldn't get dlm support higher than that though
[2013-06-11 17:08:29 -0400] Guest6785: the libdlm packages were a little out of date
[2013-06-11 17:08:51 -0400] Guest6785: oh also
[2013-06-11 17:09:00 -0400] Guest6785: I really dont like the openstack configs they're so ugly
[2013-06-11 17:09:34 -0400] Guest6785: and the examples I found on the openstack website are based on the correct semantics and I had to go through and quote a bunch of strings and figure out what needed to be unquoted and quoted
[2013-06-11 17:09:42 -0400] Guest6785: stupid ini format
[2013-06-11 17:12:38 -0400] Guest6785: [filter:validator]
[2013-06-11 17:12:38 -0400] Guest6785: paste.filter_factory = nova.api.ec2:Validator.factory
[2013-06-11 17:12:55 -0400] Guest6785: that looks like ... C# kinda
[2013-06-11 17:12:56 -0400] Guest6785: lol
[2013-06-11 17:13:04 -0400] Otterley: Guest6785, not sure how this discussion helps Chef users
[2013-06-11 17:13:15 -0400] Guest6785: sorry mister
[2013-06-11 17:13:19 -0400] Guest6785: im trying to make it help me
[2013-06-11 17:13:40 -0400] Guest6785: not too worried about anything else sir
[2013-06-11 17:13:56 -0400] amaltson: quick question, is there a way to pipe the output of an execute resource to the Chef log? We've tried putting Chef::Log into debug mode and the only way we've gotten it working so far is to use a Ruby block and call out using system
[2013-06-11 17:13:58 -0400] jmartin: Guest6785: keep trollin bro
[2013-06-11 17:14:01 -0400] Otterley: perhaps there's an openstack or kvm channel Guest6785 ?
[2013-06-11 17:14:28 -0400] Guest6785: dude stfu
[2013-06-11 17:14:29 -0400] Guest6785: lol
[2013-06-11 17:16:06 -0400] Otterley: amaltson, I'd like that feature myself
[2013-06-11 17:16:22 -0400] Otterley: suggest filing a feature request if it's not already there
[2013-06-11 17:16:52 -0400] amaltson: already a ticket: http://tickets.opscode.com/browse/CHEF-1190
[2013-06-11 17:17:13 -0400] amaltson: hrm, alright, ruby_block it is
[2013-06-11 17:18:25 -0400] amaltson: Otterley: thanks
[2013-06-11 17:25:48 -0400] ordos: Hi anyone from opscode here, maybe coderanger? :)
[2013-06-11 17:26:03 -0400] coderanger: ordos: In a meeting, whats up?
[2013-06-11 17:26:28 -0400] ordos: Just wondering if you guys know if someone has used Chef to manage embedded devices/routers before
[2013-06-11 17:26:28 -0400] geggam: in a meeting == anything to distract me from boring drivel ?
[2013-06-11 17:27:20 -0400] justizin: ordos: it should have well over 100mb of ram to spare during normal operation, unless you only want to use it for initial build.
[2013-06-11 17:27:24 -0400] justizin: and be able to run ruby
[2013-06-11 17:27:42 -0400] coderanger: ordos: Yes, we have builds running on Arista devices I know
[2013-06-11 17:28:04 -0400] btm: ordos: Arista cookbooks: https://github.com/opscode/eos-cookbooks
[2013-06-11 17:28:26 -0400] ordos: Never heard of Arista. I'm running Chef on a Netgear WNDR3800 now (128mb ram)
[2013-06-11 17:28:34 -0400] coderanger: We also have people that have done a lot with running chef-client on a normal server and just interacting with the network device over ssh or (shudder) telnet
[2013-06-11 17:29:47 -0400] coderanger: That tends to just look like execute "expect /some/script"
[2013-06-11 17:30:00 -0400] coderanger: but still, technically using Chef :)
[2013-06-11 17:30:03 -0400] Guest6785: "should turn off all the part and join messages for the channel because they're not related to chef"
[2013-06-11 17:30:30 -0400] ordos: I'm configuring the whole router configuration from a bare debian image with it
[2013-06-11 17:30:48 -0400] ordos: + retrieving databag settings
[2013-06-11 17:31:11 -0400] Guest6785: ordos: thats a really interesting idea, you should check out google native client someone ported ruby to it
[2013-06-11 17:31:39 -0400] Guest6785: dont know about ruby ffi or the sdk or anything though
[2013-06-11 17:32:45 -0400] justizin: ordos: i don't think you can do much with chef on a system with 128mb of ram, but it's worth a shot.  i also haven't memory profiled chef 11..
[2013-06-11 17:33:09 -0400] coderanger: If you put a swapfile on it, its all the same :)
[2013-06-11 17:33:10 -0400] Guest6785: justizin: just chef client
[2013-06-11 17:33:11 -0400] coderanger: just slow
[2013-06-11 17:33:11 -0400] ordos: justizin: it's not that bad, not using swap or anything
[2013-06-11 17:33:37 -0400] Guest6785: what kinda embedded devices only have 128m of ram anymore
[2013-06-11 17:33:55 -0400] ordos: Consumer routers
[2013-06-11 17:34:35 -0400] Guest6785: pff yeah of course and of course those are all more expensive than raspberry pi boards
[2013-06-11 17:34:49 -0400] Guest6785: prob cheaper cost of labor and parts too
[2013-06-11 17:34:55 -0400] ordos: Guest6785: but they handle network traffic a lot better :)
[2013-06-11 17:35:17 -0400] Guest6785: ahh yeah
[2013-06-11 17:35:32 -0400] Guest6785: ordos: I wouldn't know
[2013-06-11 17:35:45 -0400] Guest6785: I use linux on hypervisors that use 802.1q
[2013-06-11 17:35:50 -0400] ordos: coderanger: It does indeed run a bit slow, 20 seconds for a stable run atm. But it does not matter that much in my case.
[2013-06-11 17:37:45 -0400] ordos: coderanger: If only it would use a bit less memory so I could use it on cheaper routers, that would be a big +
[2013-06-11 17:38:26 -0400] Guest6785: what about chef zero
[2013-06-11 17:38:49 -0400] Guest6785: https://github.com/jkeiser/chef-zero
[2013-06-11 17:39:00 -0400] Guest6785: jkeiser:
[2013-06-11 17:39:27 -0400] ordos: Guest6785: Chef-zero is the server?
[2013-06-11 17:39:36 -0400] justizin: ordos: i just know on chef 10 i couldn't go under like 108M with a hello world cookbook
[2013-06-11 17:39:38 -0400] Guest6785: oh thats right
[2013-06-11 17:39:49 -0400] justizin: (at one point i had to troubleshoot chef runs that took like a GB of RAM ;d)
[2013-06-11 17:40:10 -0400] Guest6785: heh
[2013-06-11 17:40:25 -0400] ordos: justizin: I ran chef 11 on a 32mb device, and still workde
[2013-06-11 17:40:38 -0400] ordos: justizin: But it used about 30mb swap
[2013-06-11 17:41:07 -0400] justizin: ah..
[2013-06-11 17:41:20 -0400] justizin: is that what the arista looks like?
[2013-06-11 17:41:31 -0400] Guest6785: chef's api is pretty easy to work with isn't it ?
[2013-06-11 17:41:43 -0400] Guest6785: like what is mixlib
[2013-06-11 17:41:57 -0400] justizin: oh nvm, tangled the two of you ordos / coderanger ;d
[2013-06-11 17:41:57 -0400] Guest6785: I can only remember the auth mech stuff by "mixlib-authentication"
[2013-06-11 17:42:11 -0400] Guest6785: ordos: https://github.com/opscode/mixlib-authentication make your own client
[2013-06-11 17:42:43 -0400] coderanger: chef-zero and the API both have nothing to do with Chef's RAM usage on the client
[2013-06-11 17:42:50 -0400] ordos: Guest6785: Don't think I would be able to do a better client than opscode: p
[2013-06-11 17:44:16 -0400] ordos: Anyway, @
[2013-06-11 17:44:26 -0400] ordos: thanks for the advice!
[2013-06-11 17:44:41 -0400] miah: ram usage would probably be more of a ruby issue
[2013-06-11 17:44:42 -0400] stoked: is there a way to automatically apply a role to all nodes in a specific envrionment?
[2013-06-11 17:44:55 -0400] miah: stoked: run chef as a daemon?
[2013-06-11 17:45:08 -0400] miah: and add the node to that role?
[2013-06-11 17:45:15 -0400] justizin: miah: well, there are different usages of ruby.  sounds like things have improved a lot in chef11, i have been using it but just haven't measured
[2013-06-11 17:45:24 -0400] stoked: MinhP_: well I mean for new nodes
[2013-06-11 17:45:30 -0400] miah: justizin: ya.
[2013-06-11 17:45:32 -0400] stoked: my use case is vagrant boxes on dev machines
[2013-06-11 17:45:46 -0400] miah: you can easily configure that with your vagrant runs
[2013-06-11 17:45:52 -0400] Guest6785: justizin: I dont feel so bad now that I haven't bothered with migrating from 10
[2013-06-11 17:45:57 -0400] miketheman: can a ruby environments file include external ruby files?
[2013-06-11 17:46:03 -0400] stoked: miah: I was hoping to avoid hardcoding that into Vagrantfiles
[2013-06-11 17:46:18 -0400] miah: http://docs.vagrantup.com/v2/provisioning/chef_client.html
[2013-06-11 17:46:18 -0400] Guest6785: justizin: well I have but theres like no point right now
[2013-06-11 17:46:27 -0400] miah: write some code then. your vagrantfile is just ruby
[2013-06-11 17:48:02 -0400] stoked: miah: looking to centrally manage roles at chef-server vs vagrantfiles on each machine
[2013-06-11 17:48:36 -0400] wdilly: is it possible to have chef keep track of nodes using something other than a hostname, say i have an enviro where there will be lots of nodes with potentially the same hostname and it would be a thorn in my side to change that
[2013-06-11 17:49:16 -0400] miah: write some wrapper code that pulls roles from your chef-server and exports them to your vagrant instances
[2013-06-11 17:49:32 -0400] geggam: at some point that pain in your side is going to cause bigger problems
[2013-06-11 17:49:39 -0400] geggam: you should fix it
[2013-06-11 17:49:43 -0400] miketheman: wdilly: same hostname? jeez. Chef uses a client-name for the process running chef-client to authorize itself with chef-server, and then provides a nodename based on input from ohai (or -N when bootstrapping)
[2013-06-11 17:49:55 -0400] Guest6785: wdilly: knife-hacks has like backup/export for sourcing and exporting json files
[2013-06-11 17:49:57 -0400] miketheman: wdilly: how would you differentiate them?
[2013-06-11 17:51:56 -0400] wdilly: miketheman: its not important really that i do differentiate them as they are ephemeral VMs I have another software package that wants to control hostnames (starcluster)
[2013-06-11 17:52:38 -0400] miketheman: wdilly: no idea, first time I've heard of that
[2013-06-11 17:53:03 -0400] miketheman: wdilly: because we need Yet Another Management Tool
[2013-06-11 17:53:36 -0400] Guest6785: yeah I donno there needs to be like some programmer counseling because I feel like I shouldn't be a programmer because everything pisses me off and I don't like to do things the way others do
[2013-06-11 17:53:43 -0400] Guest6785: so there must be something wrong with me
[2013-06-11 17:53:47 -0400] miah: i would chef-solo the vm's
[2013-06-11 17:53:51 -0400] miketheman: Guest6785: probably means you're human
[2013-06-11 17:53:56 -0400] miketheman: miah: I thinkyou're right
[2013-06-11 17:54:12 -0400] Guest6785: miketheman: thanks
[2013-06-11 17:54:14 -0400] Guest6785: lol
[2013-06-11 17:55:11 -0400] miah: if they are ephemeral, then you really don't need them registering with centralized chef-server
[2013-06-11 17:55:23 -0400] miah: unless you need to use the search or databag functionality
[2013-06-11 17:55:49 -0400] geggam: enabling bad operational practices ensures you will need to bring in an operations guy at some point.. thanks for the job security miah
[2013-06-11 17:55:51 -0400] Guest6785: miah: i often find myself using knife ssh more than anything
[2013-06-11 17:55:55 -0400] geggam: >:]
[2013-06-11 17:56:00 -0400] Guest6785: to start chef-client because
[2013-06-11 17:56:08 -0400] Guest6785: chef-client really doesn't need to run all the time on my instances.
[2013-06-11 17:56:25 -0400] Guest6785: but at the same time something with fanout! would be really cool
[2013-06-11 17:56:27 -0400] Guest6785: like push
[2013-06-11 17:56:35 -0400] miah: geggam: ?
[2013-06-11 17:56:51 -0400] Guest6785: yeah because chef-client running on one host, kinda needs to trigger chef-client on another host to run and update its iptables
[2013-06-11 17:57:14 -0400] Guest6785: just gets into how chef is not supposed to be used though
[2013-06-11 17:57:22 -0400] miah: look at flock-of-chefs; https://github.com/chrisroberts/flock_of_chefs
[2013-06-11 17:57:46 -0400] Guest6785: miah: sick!
[2013-06-11 17:58:05 -0400] miah: well, the chef-client that opscode provides does work in a certain way, but the api is open and that means you can replace the client if you really want to. or make changes to how that client fundamentally works. but its non-trivial.
[2013-06-11 17:58:31 -0400] miketheman: miah: any ideas on environments files including other ruby snippets?
[2013-06-11 17:58:34 -0400] miah: and chefs use will continue to change, so 'not supposed to be' will also
[2013-06-11 17:58:44 -0400] miah: miketheman: they shouldnt
[2013-06-11 17:59:09 -0400] miah: roles and environments should be seen as static content. though, that static content could be dynamically generated.
[2013-06-11 17:59:11 -0400] Guest6785: miah: ty, yeah its crossed my mind a few times, I'll see at some point if this works for me
[2013-06-11 17:59:30 -0400] miah: so, write code to generate them, but dont put code in them.
[2013-06-11 17:59:45 -0400] miketheman: miah: we're storing a lot of data in env files, b/c they are particular per env, but it's getting unwieldy
[2013-06-11 18:00:06 -0400] miah: ya. attribute driven development is a bad practice
[2013-06-11 18:01:22 -0400] Guest6785: I still like using tar, nc, scp, cron, sed, awk
[2013-06-11 18:01:35 -0400] Guest6785: rsync
[2013-06-11 18:01:41 -0400] miah: i use them, but they are tools to do what i really like.
[2013-06-11 18:02:01 -0400] Guest6785: yeah nobody can read sed and awk
[2013-06-11 18:02:02 -0400] Guest6785: lol
[2013-06-11 18:02:06 -0400] Guest6785: oh god
[2013-06-11 18:02:07 -0400] Guest6785: one sec
[2013-06-11 18:02:24 -0400] Guest6785: http://wiki.gentoo.org/wiki/Netflix
[2013-06-11 18:02:29 -0400] Guest6785: ^ that guy is a boss
[2013-06-11 18:02:48 -0400] Guest6785: every block is something you can copy and paste
[2013-06-11 18:03:49 -0400] miah: dont copy and paste. comprehend and reimplement. you learn more.
[2013-06-11 18:04:33 -0400] Guest6785: I agree with you totally but considering this is a matter of ... configuring wine on linux to run something that I think is ridiculous that i cant already use on linux...
[2013-06-11 18:04:52 -0400] geggam: run an adroid emulator and install the netflix app
[2013-06-11 18:04:55 -0400] Guest6785: when Id rather be finishing vga pass through for kvm (need to add some patches, pretty tedious implementation)
[2013-06-11 18:05:35 -0400] scalp42: anyone know how to mark a ticket in JIRA with fix provided?
[2013-06-11 18:05:44 -0400] geggam: or quit being cheap and buy a roku box... or a 20 dollar wii to run netflix
[2013-06-11 18:05:48 -0400] Guest6785: plus all the other stuff that Im avoiding copying and pasting (rackspace private cloud) rather using gentoo hardened (kvm works great) working on getting the openstack overlay for other peeps because they want openstack...
[2013-06-11 18:05:52 -0400] Guest6785: I have a lot going on
[2013-06-11 18:06:15 -0400] Guest6785: more than my statement about copying and pasting really implies
[2013-06-11 18:06:24 -0400] Guest6785: or my time here now on irc
[2013-06-11 18:06:26 -0400] miketheman: scalp42: if you've signed the CLA, you typically get access to that
[2013-06-11 18:06:48 -0400] scalp42: miketheman: weird can only mark it as in progress
[2013-06-11 18:06:58 -0400] miketheman: jira #?
[2013-06-11 18:07:06 -0400] scalp42: miketheman: might be why my PR never makes it to review
[2013-06-11 18:07:17 -0400] scalp42: miketheman: COOK-3131
[2013-06-11 18:07:38 -0400] geggam: anyone here use crowbar  ?
[2013-06-11 18:07:47 -0400] miketheman: scalp42: have you signed the opscode CLA?
[2013-06-11 18:08:10 -0400] miketheman: scalp42: see https://github.com/opscode-cookbooks/rabbitmq/blob/master/CONTRIBUTING
[2013-06-11 18:08:42 -0400] scalp42: miketheman: thanks, I thought I did it
[2013-06-11 18:09:00 -0400] miketheman: hm. they are typically good about updating the users in jira pretty quickly
[2013-06-11 18:09:21 -0400] scalp42: no I mean might be me, I remember reading all that stuff
[2013-06-11 18:09:29 -0400] miketheman: http://wiki.opscode.com/display/chef/Approved+Contributors
[2013-06-11 18:09:32 -0400] scalp42: no worries anyway, thanks for the help miketheman!
[2013-06-11 18:09:38 -0400] miketheman: scalp42: sure thing
[2013-06-11 18:28:42 -0400] pwf: anyone know why i'd get a 409 conflict for a cookbook even RIGHT after uploading it with --force? http://hastebin.com/xijopuboso.txt
[2013-06-11 18:29:21 -0400] gkarekinian: Because it's still frozen?
[2013-06-11 18:34:09 -0400] pwf: gkarekinian: how do i unfreeze it...? i thought reuploading with the same version number and --force would unfreeze it
[2013-06-11 18:34:27 -0400] pwf: i'm asking all this because 'knife upload /' doesn't seem to take --force as an option
[2013-06-11 18:40:28 -0400] pwf: or rather, 'knife upload' DOES take --force, but it means something completely different
[2013-06-11 18:40:55 -0400] pwf: whatever, "rm -rf cookbooks/newsyslog-0.1.0/"
[2013-06-11 18:40:56 -0400] pwf: solved.
[2013-06-11 18:48:31 -0400] gkarekinian: What are you trying to do? It's normal behavior to have to force the upload of a frozen cookbook
[2013-06-11 19:00:46 -0400] stormerider: pwf: forcing an upload of a frozen cookbook shouldn't result in it getting unfrozen
[2013-06-11 19:01:58 -0400] pwf: gkarekinian: i'm trying to do stupid things. we didn't have an elastic IP for our chef server, the hardware failed, the DNS changed, and we had referenced that domain in a bunch of cookbooks and node overrides
[2013-06-11 19:02:30 -0400] pwf: so i 'knife download'ed the whole thing, sed 's/old_domain/new_elastic_ip/g', and tried to 'knife upload' it
[2013-06-11 19:04:25 -0400] bgood: are there any good articles/tutorials etc. that explain how to properly do chef deploys with rvm?
[2013-06-11 19:04:32 -0400] stormerider: pwf: if you want to work around the freeze, you should be bumping the cookbook version
[2013-06-11 19:05:37 -0400] freezey: so i am guessing http://www.opscode.com/blog/2013/03/12/5106/ this is the best upgrade path?
[2013-06-11 19:05:50 -0400] bgood: i am having to use bash blocks in the callbacks and source the .rvmrc in the project's release_path
[2013-06-11 19:06:27 -0400] freezey: are chef 10 clients able to talk to chef 11 server without issues?
[2013-06-11 19:06:39 -0400] stormerider: yes
[2013-06-11 19:07:38 -0400] freezey: cool thanks
[2013-06-11 19:35:38 -0400] defishguy: Is there a way a way to to use case in a recipe that queries a nodes role?  I'm setting up monitoring of a mysql box and I want the slaves configured differently.
[2013-06-11 19:46:18 -0400] toddiuszho: Is this the latest version I should follow when determining hardware requirements for Private Chef? http://docs.opscode.com/server/private_chef_1x_install.html
[2013-06-11 19:47:37 -0400] Kyle11: Does anyone have an example of running multiple VMs for vagrant in chef11/vagrant1.2, similar to http://jtimberman.housepub.org/blog/2012/03/18/multivm-vagrantfile-for-chef/
[2013-06-11 19:49:15 -0400] jameson__: anyone have a link to virtualbox images like the ones provides with bento for redhat and/or debian?
[2013-06-11 19:51:23 -0400] juliancdunn: toddiuszho: that should still be accurate, yes
[2013-06-11 19:52:05 -0400] juliancdunn: jameson__: we have some in our S3... links on https://github.com/opscode/bento
[2013-06-11 19:52:29 -0400] toddiuszho: Thank you, Julian.
[2013-06-11 19:53:32 -0400] juliancdunn: Kyle11: the Vagrantfile format has changed only slightly, so I think anything jtimberman says in that post is probably still relevant
[2013-06-11 19:53:45 -0400] juliancdunn: he does a lot of customization though, so YMMV
[2013-06-11 19:54:52 -0400] Kyle11: ok thanks juliancdunn
[2013-06-11 19:58:04 -0400] kgraham77: hello, i am having some diffficulty with the opscode 'nagios' cookbook, no matter what I do, I cannot get it to add the 'host_name' attribute, anyone have this problem beforE?
[2013-06-11 19:58:10 -0400] kgraham77: these machines are in ec2
[2013-06-11 19:58:52 -0400] stormerider: kgraham77: you have to customize the hosts/hostgroups templates, i found
[2013-06-11 20:00:48 -0400] kgraham77: can you elaborate? i am really desparte to get this working
[2013-06-11 20:00:56 -0400] kgraham77: i figured i had to do something with the templates
[2013-06-11 20:00:57 -0400] bgood_: are there any good articles/tutorials etc. that explain how to properly do chef deploys with rvm?  My deploy is all nasty see the gist: https://gist.github.com/bgood-clip/5760094
[2013-06-11 20:01:17 -0400] kgraham77: it just doesn't do it right 'n.name' should return 'node.name' for the node it's searched for in the object passed to the hosts.cfg tempalte
[2013-06-11 20:01:32 -0400] kgraham77: what was your customization?
[2013-06-11 20:04:27 -0400] kgraham77: @bgood_: try using rvm exec
[2013-06-11 20:04:36 -0400] kgraham77: and node.rvm.default_ruby as attribute
[2013-06-11 20:04:47 -0400] pwf: so i set my chef_server_url to an IP address in a client's client.rb, and halfway through the chef run it starts using the fqdn to access the 'bookshelf'
[2013-06-11 20:04:58 -0400] pwf: where is it getting the domain name from?
[2013-06-11 20:05:06 -0400] jameson__: juliancdunn: yeah I use the ubuntu and centos from there, but I am having issues with default packages that does/doesn't exist on redhat/centos and also with debian :(
[2013-06-11 20:05:09 -0400] pwf: because that domain will not work, only the IP that i configured as chef_server_url
[2013-06-11 20:05:46 -0400] miah: it likely has to do with SSL and how verification works.
[2013-06-11 20:06:02 -0400] jameson__: I want to advertise that cookbook (*cough* mongo *cough*) works with debian, rhel family but really I only test with ubuntu/centos
[2013-06-11 20:06:24 -0400] bgood_: kgraham77 so the command for "rake db:migrate" should be "rvm exec rake db:migrate"
[2013-06-11 20:06:38 -0400] pwf: nevermind, found it
[2013-06-11 20:07:01 -0400] pwf: /var/opt/chef-server/erchef/etc/app.config: {s3_url, "***********"},
[2013-06-11 20:07:10 -0400] pwf: for those who might have the same problem in the future ^
[2013-06-11 20:08:09 -0400] scalp42: thanks for heads up pwelch
[2013-06-11 20:08:12 -0400] scalp42: pwf
[2013-06-11 20:08:13 -0400] scalp42: my bad
[2013-06-11 20:09:59 -0400] pwf: now i have no clue what that's generated from, and i'm pretty sure that just changing it in-place is bad, but that's how i fixed it
[2013-06-11 20:18:35 -0400] juliancdunn: jameson__: those boxes are generated with a very, very minimal package set on purpose
[2013-06-11 20:19:06 -0400] juliancdunn: if people want things like "unzip" (or whatever makes "that cookbook" go :-) ) then they should be declared in the recipe
[2013-06-11 20:21:31 -0400] Otterley: it's generally safest to assume nothing is installed on a host except ruby and Bourne shell
[2013-06-11 20:22:20 -0400] Otterley: defishguy, word of advice, do not attempt to use Chef to configure mysql replication.
[2013-06-11 20:22:34 -0400] Otterley: there lay dragons
[2013-06-11 20:23:33 -0400] miah: configuring replication is fine. failing over is another topic.
[2013-06-11 20:23:43 -0400] Otterley: what's the point, then?
[2013-06-11 20:23:53 -0400] miah: consistent configuration
[2013-06-11 20:24:17 -0400] Otterley: I posit that it is impossible to write a cookbook that can correctly configure MySQL replication except in the most simplest case.
[2013-06-11 20:24:20 -0400] miah: but unless you write some really smart code, making mysql failover should probably be a mostly human intervention
[2013-06-11 20:24:45 -0400] miah: no. its quite possible and i've done it.
[2013-06-11 20:24:49 -0400] Otterley: Chef is very good at managing static state, but MySQL replication is a textbook example of dynamic state.
[2013-06-11 20:24:51 -0400] miah: the problem is, its hard to generalzie.
[2013-06-11 20:24:52 -0400] Otterley: Show me your code,  miah.
[2013-06-11 20:25:03 -0400] Otterley: and I will find a million holes and corner cases in it
[2013-06-11 20:25:08 -0400] miah: im sure you will
[2013-06-11 20:25:18 -0400] justizin: nothing like a flesh-and-blood DBA :)
[2013-06-11 20:25:38 -0400] miah: like i said, its hard to generalize. the way one company does replication may not necessarily be the same way that others do it.
[2013-06-11 20:25:48 -0400] miah: so any cookbook that implements that is going to be heavily biased
[2013-06-11 20:26:11 -0400] defishguy: Otterley:  If I only had a choice......
[2013-06-11 20:26:14 -0400] Otterley: replication topologies may vary, but I'm even talking about the simplest case (one master, one slave)
[2013-06-11 20:26:22 -0400] miah: yup. its doable.
[2013-06-11 20:26:30 -0400] miah: no, note im saying 'configure replication'
[2013-06-11 20:26:37 -0400] miah: im not saying 'start mysql and make sure replication works'
[2013-06-11 20:26:49 -0400] miah: but i still think it can be done
[2013-06-11 20:26:53 -0400] Otterley: there's not a lot of value in such a short goalpost, IMO
[2013-06-11 20:26:55 -0400] justizin: if you bring up a new slave into an existing setup, you need to load it with known-good data so it can catch up to the replication stream
[2013-06-11 20:27:00 -0400] miah: yup
[2013-06-11 20:27:25 -0400] miah: hopefully you have snapshots of that data that you can easily import that doesn't rely on 'master'
[2013-06-11 20:27:42 -0400] Otterley: it's like saying "I configured replication by setting a master_host and master_password, and set read_only to true"
[2013-06-11 20:28:08 -0400] miah: heh
[2013-06-11 20:28:23 -0400] Otterley: it's like saying you automated the bring up of a host by PXE booting it to a base OS.   sure, but you haven't added much value.
[2013-06-11 20:28:39 -0400] miah: i disagree, but thats fine.
[2013-06-11 20:31:11 -0400] bdha: Otterley: Value for whom? The guy who doesn't have to sit at the datacenter installing opeating systems for eight hours?
[2013-06-11 20:31:35 -0400] Otterley: allow me to clarify - you've added some value but you haven't completed the work.
[2013-06-11 20:31:46 -0400] Otterley: it was a poor analogy, I admit
[2013-06-11 20:32:09 -0400] bdha: I don't think anyone who has used Chef would argue that it is the only and final solution for the lifecycle of systems and services.
[2013-06-11 20:32:16 -0400] bdha: (or Puppet, or cfengine, or whatever else)
[2013-06-11 20:32:25 -0400] bdha: That does not reduce its usefulness, though.
[2013-06-11 20:32:26 -0400] Otterley: I agree, in fact, I'm suggesting to use other tools
[2013-06-11 20:32:47 -0400] Otterley: but when you have a hammer, everything looks like your thumb, and I see a lot of that in the Chef community
[2013-06-11 20:33:04 -0400] bdha: There is value in configuring MySQL (or Riak, Membase, Mongo replicas...) with Chef. You have context.
[2013-06-11 20:33:13 -0400] bdha: Especially in shitty environments like EC2, where things tend to be _quite_ dynamic.
[2013-06-11 20:33:17 -0400] Otterley: (and the MySQL community and the Redis community)
[2013-06-11 20:33:49 -0400] Otterley: bdha, you don't have sufficient context from Chef to automatically configure MySQL replication.
[2013-06-11 20:33:58 -0400] Otterley: you have some, but not enough
[2013-06-11 20:34:25 -0400] bdha: Oh? What lacks?
[2013-06-11 20:34:39 -0400] justizin: you can bring up new slaves into an existing environment, i suppose.
[2013-06-11 20:34:49 -0400] Otterley: for one, realtime knowledge of the master bin log pointer
[2013-06-11 20:35:08 -0400] miah: you can get that knowledge. you could write a resource provider that actually talks to the mysql server and gets those details.
[2013-06-11 20:35:20 -0400] bdha: Otterley: Depends on how you're doing things.
[2013-06-11 20:35:32 -0400] jameson__: juliancdunn: yeah, I use those because they are so minimal, opscode have plans to publish similar ones for redhat, debian?
[2013-06-11 20:35:39 -0400] bdha: Otterley: For instance, if /data/mysql is empty, you can pull a recent Percona backup from your dump repo. That has that information.
[2013-06-11 20:35:52 -0400] jameson__: i feel like I should just use bento and make them myself but hostiinngggg
[2013-06-11 20:36:10 -0400] Otterley: bdha, how about failover?
[2013-06-11 20:36:19 -0400] bdha: I don't trust automated tools for failover.
[2013-06-11 20:36:22 -0400] bdha: Chef or anything else.
[2013-06-11 20:36:29 -0400] juliancdunn: jameson__: we can't publish any RHEL ones, for obvious reasons
[2013-06-11 20:36:30 -0400] bdha: Something will shoot something in the head and _you_ in the foot.
[2013-06-11 20:36:47 -0400] miah: ^
[2013-06-11 20:36:53 -0400] chance: hey guys, im wondering about the best way to deploy an app. Atm my default is django with gunicorn + nginx, but id like the user using the cookbook to also be able to use something like uwsgi + nginx as an alternate.
[2013-06-11 20:36:56 -0400] juliancdunn: jameson__: there are Debian ones... I guess I should publish the link :-P
[2013-06-11 20:36:59 -0400] miah: which is part of why i say, configure it and let somebody finish it
[2013-06-11 20:37:26 -0400] miah: but i still think you can do _most_ of it
[2013-06-11 20:37:39 -0400] chance: i was thinking using attributes to define the default "web_server_role" or something, but it doesnt seem like the best way to go about it
[2013-06-11 20:37:48 -0400] Otterley: as soon as I see the code I will believe it :D
[2013-06-11 20:37:57 -0400] miah: =)
[2013-06-11 20:38:00 -0400] bdha: Otterley: For rsyncing data if /data/mysql is empty..?
[2013-06-11 20:38:02 -0400] bdha: uh, ok.
[2013-06-11 20:38:22 -0400] Otterley: bdha, for a complete solution
[2013-06-11 20:38:31 -0400] bdha: Otterley: fwiw, I hardly use community cookbooks.
[2013-06-11 20:38:42 -0400] bdha: So... "complete" solutions are pretty site specific.
[2013-06-11 20:38:47 -0400] miah: indeed
[2013-06-11 20:38:49 -0400] Otterley: even for a given site
[2013-06-11 20:38:52 -0400] miah: heavily biased
[2013-06-11 20:39:04 -0400] bdha: Ok, well, that's how I build replicas. But I can't share the code. :)
[2013-06-11 20:39:35 -0400] bdha: Building generic solutions to anything is hard.
[2013-06-11 20:39:59 -0400] bdha: Our QA guys are writing system/service rspec tests now for our environment.
[2013-06-11 20:40:01 -0400] bdha: They're to 400.
[2013-06-11 20:40:54 -0400] bdha: Spin new instance, bootstrap, chef runs, execs tests, .. reason about the results.
[2013-06-11 20:41:05 -0400] kgraham77: why wouldn't a node be able to access 'ec2' attributes after a search
[2013-06-11 20:41:09 -0400] kgraham77: i can if i use chef-shell
[2013-06-11 20:41:15 -0400] Otterley: So you found a MySQL package that doesn't blow up if set your datadir to /data/mysql ?
[2013-06-11 20:41:26 -0400] kgraham77: ex: 'Undefined method or attribute `ec2' on `node''
[2013-06-11 20:41:44 -0400] bdha: Otterley: We build our own packages. Our own (templated) configs.
[2013-06-11 20:41:58 -0400] kgraham77: but when i chef-shell, run the exact commands in the nagios templates/default/hosts.cfg , it returns the attributes i want
[2013-06-11 20:41:59 -0400] Otterley: ah, we're using Percona
[2013-06-11 20:42:08 -0400] bdha: We actually install Percona to /opt/<us>/embedded.
[2013-06-11 20:42:09 -0400] bdha: So are we.
[2013-06-11 20:42:19 -0400] Otterley: I mean Percona Ubuntu packages
[2013-06-11 20:42:28 -0400] bdha: Yeah, we build our full stack ourselves.
[2013-06-11 20:42:50 -0400] Otterley: they really don't like having their datadir anywhere other than /var/lib/mysql, which is fine, but we learned it the hard way
[2013-06-11 20:43:20 -0400] miah: mount --bind /data/mysql /var/lib/mysql
[2013-06-11 20:43:32 -0400] Otterley: no need, we just mount directly
[2013-06-11 20:43:44 -0400] miah: that works too
[2013-06-11 20:43:48 -0400] bdha: Otterley: Haven't run into that one.
[2013-06-11 20:44:00 -0400] Otterley: bdha, it's the startup scripts; they're to blame
[2013-06-11 20:44:09 -0400] miah: why are you using the default startup scripts?
[2013-06-11 20:44:20 -0400] bdha: Ah. We use our own SMF or daemontools scripts.
[2013-06-11 20:44:23 -0400] miah: i rarely trust initscripts that i didnt write (or atleast vet)
[2013-06-11 20:44:33 -0400] Otterley: because fixing them isn't high on my priority list
[2013-06-11 20:45:13 -0400] Otterley: also, we pay for support, so making as few changes as possible helps keep them from blaming us
[2013-06-11 20:45:39 -0400] bdha: +1 to that.
[2013-06-11 20:46:07 -0400] bdha: Our Riak EE stuff is all the Basho packages for that reason, installed however they want it.
[2013-06-11 20:46:18 -0400] Otterley: that's next in our stack, bdha
[2013-06-11 20:46:24 -0400] bdha: Riak is cool.
[2013-06-11 20:46:26 -0400] Otterley: I may have questions for you, if you don't mind
[2013-06-11 20:46:31 -0400] kgraham77: anyone know why a 'node' object in a template context would not have the 'ec2' or 'cloud' attributes?
[2013-06-11 20:46:46 -0400] bdha: I have only done a little in terms of operating Riak so far. But I can pass the questions upstream.
[2013-06-11 20:46:54 -0400] bdha: In terms of suppoer from Basho, I'm super, super happy.
[2013-06-11 20:46:58 -0400] bdha: er, support.
[2013-06-11 20:47:06 -0400] Otterley: cool.  they're literally down the street from us :D
[2013-06-11 20:47:37 -0400] miah: they're literally the next building to me
[2013-06-11 20:47:45 -0400] miah: (and imgur)
[2013-06-11 20:47:56 -0400] Otterley: oh, you work at the shoe store miah? ;)
[2013-06-11 20:48:09 -0400] miah: nope. im at 901 market
[2013-06-11 20:48:20 -0400] Otterley: I kid
[2013-06-11 20:48:59 -0400] scalp42: lol
[2013-06-11 20:49:13 -0400] Otterley: aren't they renovating that building?
[2013-06-11 20:49:16 -0400] miah: yes
[2013-06-11 20:49:21 -0400] miah: nordstrom rack is moving in
[2013-06-11 20:49:21 -0400] scalp42: I'm across the street! I kid.
[2013-06-11 20:49:46 -0400] Otterley: that will make some people very happy
[2013-06-11 20:50:02 -0400] miah: consumers sure
[2013-06-11 20:50:25 -0400] miah: it just adds to the level of anxiety i have for this part of the city
[2013-06-11 20:51:21 -0400] Otterley: anyone else a heavy riak user?
[2013-06-11 20:52:16 -0400] miah: i bet cheeseplus is
[2013-06-11 20:55:51 -0400] surge_: How does Chef set the node[:fqdn] ?
[2013-06-11 20:56:02 -0400] Otterley: from Ohai
[2013-06-11 20:56:10 -0400] surge_: It used to be working properly, but now I am getting `nil` in the chef-shell
[2013-06-11 20:56:29 -0400] Otterley: what does 'ohai' say?
[2013-06-11 20:57:03 -0400] surge_: ohai > ohai.txt doesn't have a FQDN key
[2013-06-11 20:57:06 -0400] surge_: which i found odd
[2013-06-11 20:58:33 -0400] Otterley: what does 'hostname -f' say?
[2013-06-11 20:59:05 -0400] gyre007: this is brilliant commit https://github.com/opscode-cookbooks/apt/commit/ca612ad941cfb40a2753a838a8a57e896d35b341 breaks all my cookbooks dependant on apt :)
[2013-06-11 20:59:13 -0400] gyre007: use_inline_resources...w00t
[2013-06-11 20:59:21 -0400] Otterley: gyre007, requires Chef >= 11
[2013-06-11 20:59:28 -0400] gyre007: yeah
[2013-06-11 20:59:29 -0400] Otterley: as the README states
[2013-06-11 21:00:09 -0400] gyre007: errr
[2013-06-11 21:00:34 -0400] surge_: hostname: Name or service not known ... sigh, this is what i get for doing a hacky work around for Collectd+nagios integration
[2013-06-11 21:00:45 -0400] surge_: I guess i need to edit /etc/hosts as well
[2013-06-11 21:00:48 -0400] gyre007: what apt cookbook version is compatible with Chef <11
[2013-06-11 21:00:49 -0400] surge_: instead of just /etc/hostname
[2013-06-11 21:01:01 -0400] Otterley: gyre007, 1.x
[2013-06-11 21:01:28 -0400] Otterley: but there's a bug in the latest 1.x release re: why-run that seems like it will never be fixed at this point :(
[2013-06-11 21:02:53 -0400] gyre007: mmm
[2013-06-11 21:11:52 -0400] surge_: Otterley: so updating /etc/hosts fixed it. thanks
[2013-06-11 21:14:57 -0400] jameson__: juliandunn: yes please :)
[2013-06-11 21:31:45 -0400] jgood: Hi, I have to ssh into a CentOS 6 server, and I need to install chef server on there. I tried using cURL to download the rpm file but I think I messed up. What would be the proper way to get download the install file?
[2013-06-11 21:33:52 -0400] jgood: I'm not very used to linux. Would I be better of using yum?
[2013-06-11 21:36:48 -0400] programmerq: hello all. we're trying to subclass Chef::Provider::Service::Runit from our own cookbook. About 50% of the time, our runs complain that Chef::Provider::Service::Runit is an unitiliazed constant.
[2013-06-11 21:36:55 -0400] programmerq: the other half of the time, the run completes successfully.
[2013-06-11 21:37:01 -0400] Otterley: jgood, yum is pretty much the standard for installing packages on CentOS
[2013-06-11 21:37:12 -0400] programmerq: I'm guessing that we're simply failing to include the file that defines Chef::Provider::Service::Runit
[2013-06-11 21:37:14 -0400] Otterley: jgood you should also be installing Omnibus Chef Server
[2013-06-11 21:37:44 -0400] Otterley: programmerq, are you doing an include_recipe from your wrapper cookbook's default recipe
[2013-06-11 21:38:18 -0400] programmerq: Otterley: I can certainly do that, but I am also interested in the "chef anatomy" that makes that "trick" possible?
[2013-06-11 21:38:43 -0400] programmerq: I'm also guessing that I might need to put a require line inside my libraries/my_lib.rb as well?
[2013-06-11 21:38:52 -0400] programmerq: or will the include_recipe pull everything in magically somehow?
[2013-06-11 21:38:55 -0400] Otterley: programmerq, I don't think you need a require line
[2013-06-11 21:39:25 -0400] Otterley: but I believe you do need to include the cookbook containing the library you're patching/redefining
[2013-06-11 21:40:26 -0400] jgood: Otterley: I understand I need to install the Omnibus Chef Server, I tried to download the package using "curl -O <link>", but I think that failed because when I ran yum to install the package i got an error saying package could not be opened
[2013-06-11 21:41:13 -0400] juliancdunn: programmerq: just do a depends on the runit cookbook in your metadata
[2013-06-11 21:41:19 -0400] programmerq: :q
[2013-06-11 21:41:22 -0400] programmerq: shoot
[2013-06-11 21:41:28 -0400] programmerq: juliancdunn: sounds good. We'll try that.
[2013-06-11 21:41:40 -0400] juliancdunn: it's defined here: https://github.com/opscode-cookbooks/runit/blob/master/libraries/provider_runit_service.rb
[2013-06-11 21:41:41 -0400] programmerq: hmm, we already have a depends line
[2013-06-11 21:41:45 -0400] Otterley: jgood, ah, invoke rpm directly for that
[2013-06-11 21:41:51 -0400] programmerq: we are, however, using chef 10.16.2
[2013-06-11 21:41:55 -0400] Otterley: jgood: rpm -ihv chef-server-11.0.8-1.el6.x86_64.rpm
[2013-06-11 21:42:10 -0400] juliancdunn: programmerq: ahh... the inconsistency makes me think it might be a bug fixed in a later version
[2013-06-11 21:42:19 -0400] programmerq: juliancdunn: that's what I'm guessing as well.
[2013-06-11 21:43:00 -0400] programmerq: we just did a 'gem install chef -v 10.16.2' on all our nodes in the system ruby. what's the best way to go about upgrading that? mass out a shell command to gem update it to the latest chef 11?
[2013-06-11 21:43:17 -0400] programmerq: (I'm in a big enough org that we can't go to 11 just yet)
[2013-06-11 21:43:45 -0400] programmerq: to the latest chef 10 (not 11)
[2013-06-11 21:43:57 -0400] jgood: Otterley: it's coming up with an error saying "error: chef-server-11.0.8-1.e16.x86_64.rpm: not an rpm package (or package manifest)"
[2013-06-11 21:44:06 -0400] juliancdunn: programmerq: yeah, the latest 10 is... 10.26.0 I believe
[2013-06-11 21:44:44 -0400] Otterley: jgood, sounds like it wasn't downloaded properly then
[2013-06-11 21:45:15 -0400] Otterley: programmerq, best to use the Omnibus client, you'll have better support and fewer surprises
[2013-06-11 21:47:01 -0400] jgood: Otterley: yeah that's kinda what I thought might be happening. I'll try figuring out why. thanks for the help
[2013-06-11 21:47:16 -0400] programmerq: Otterley: I remember we had an issue with the omnibus client when we first started building out our system. I don't remember what it was, unfortunately.
[2013-06-11 21:48:09 -0400] programmerq: that might be the best idea actually
[2013-06-11 21:48:18 -0400] programmerq: and then it's basically just an rpm
[2013-06-11 21:53:18 -0400] gchristensen: are there plans to support OSX 10.9 soon? :)
[2013-06-11 21:57:15 -0400] Majost: Does anyone know if there is a way to pass --log_level to chef-solo or chef-client when doing a vagrant up?
[2013-06-11 21:57:34 -0400] jtimberman: gchristensen: Since it's not even released yet?
[2013-06-11 21:57:35 -0400] jtimberman: :)
[2013-06-11 21:58:10 -0400] jtimberman: Majost: i submitted a PR to do arbitrary command-line options but i don't know if it was ever merged (or reimplemented differently)
[2013-06-11 21:58:18 -0400] Majost: ah
[2013-06-11 21:58:28 -0400] mattray: gchristensen: we'd take ohai patches if you have them
[2013-06-11 21:58:38 -0400] Majost: yeah, it would definitely be nice.
[2013-06-11 21:58:53 -0400] gchristensen: some ... *hem* members of my team upgraded already. also, I just installed Omnibus on OSX 10.8 and its telling me that chef isn't in the dependencies: https://gist.github.com/grahamc/6301343f90aae8851416/raw/a174a5ca97f3330ae49e1b60d3175238db06d8b7/gistfile1.txt - "/opt/chef/embedded/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find chef (>= 0) amongst" ... any thoughts on that?
[2013-06-11 21:59:10 -0400] c_t: gchristensen: huh
[2013-06-11 21:59:33 -0400] c_t: I installed chef on an OS X 10.8 machine just yesterday with omnibus, and it went smoothly
[2013-06-11 21:59:38 -0400] gchristensen: this happened, so I installed again, and its still failing.
[2013-06-11 21:59:49 -0400] jtimberman: Majost: there's a config.arguments
[2013-06-11 22:00:01 -0400] jtimberman: Majost: you should be able to add that to your vagrantfile
[2013-06-11 22:00:05 -0400] Majost: ah, nice
[2013-06-11 22:00:06 -0400] Majost: thanks!
[2013-06-11 22:00:43 -0400] jtimberman: disclaimer: I've never used this, I'm just reading the vagrant source :)
[2013-06-11 22:00:55 -0400] Majost: hah
[2013-06-11 22:00:55 -0400] jtimberman: https://github.com/mitchellh/vagrant/blob/c0539d6e31967dad5cfb42956a84fc15c2ac3c69/plugins/provisioners/chef/provisioner/chef_client.rb#L66-L67
[2013-06-11 22:00:57 -0400] Majost: np
[2013-06-11 22:01:36 -0400] Otterley: gchristensen, are you running rvm there?
[2013-06-11 22:01:41 -0400] gchristensen: I am
[2013-06-11 22:01:47 -0400] Otterley: rvm use system, try again
[2013-06-11 22:01:55 -0400] gchristensen: hey look at that
[2013-06-11 22:02:20 -0400] Otterley: in today's chapter of "rvm is evil"...
[2013-06-11 22:02:30 -0400] gchristensen: yeah man, RVM is clearly magic from the devil
[2013-06-11 22:02:43 -0400] Otterley: Rubyists love their magic
[2013-06-11 22:02:51 -0400] c_t: Otterley: I hear "War and RVM" has something like 1500 named characters
[2013-06-11 22:03:02 -0400] leucotomy: http://i930.photobucket.com/albums/ad141/fulgutsa/stfu-grumpy-cat_zps5c0e29bf.jpg
[2013-06-11 22:03:07 -0400] leucotomy: totes
[2013-06-11 22:05:13 -0400] leucotomy: I cant remember the time I actually laughed at a cat picture on the internetz
[2013-06-11 22:05:28 -0400] leucotomy: that one is ok though
[2013-06-11 22:05:59 -0400] gchristensen: I only laughed at http://1-media-cdn.foolz.us/ffuuka/board/tg/image/1363/53/1363531376180.gif
[2013-06-11 22:06:28 -0400] c_t: I rather like this one: http://si.wsj.net/public/resources/images/OB-XQ703_CATAGE_GV_20130529225155.jpg#.png
[2013-06-11 22:06:31 -0400] leucotomy: hellz yeah
[2013-06-11 22:07:13 -0400] leucotomy: c_t: I assume you're not trying to be funny by sending me to a 404
[2013-06-11 22:07:20 -0400] leucotomy: but if you are then lool
[2013-06-11 22:07:31 -0400] c_t: oh no, I wasn't
[2013-06-11 22:07:43 -0400] gyre007: anyone here uses redis community cookbook ?
[2013-06-11 22:07:44 -0400] c_t: maybe this then: http://si.wsj.net/public/resources/images/OB-XQ703_CATAGE_GV_20130529225155.jpg
[2013-06-11 22:07:52 -0400] c_t: (loads for me...)
[2013-06-11 22:07:59 -0400] jameson__: gyre007: i recommend the redisio cookbook to start
[2013-06-11 22:08:11 -0400] c_t: leucotomy: it's just the WSJ picture of Grumpy Cat
[2013-06-11 22:08:20 -0400] c_t: done in that trademark WSJ style of picture
[2013-06-11 22:08:28 -0400] leucotomy: ahh hahahah
[2013-06-11 22:08:34 -0400] gyre007: the thing is when using Berkshelf, it's grabbing Redis one...
[2013-06-11 22:09:01 -0400] leucotomy: lol you got redis'd
[2013-06-11 22:09:09 -0400] leucotomy: sorry
[2013-06-11 22:15:47 -0400] kisoku: anyone have any pointers for using application_ruby with rvm ?
[2013-06-11 22:26:38 -0400] miah: havent tried it
[2013-06-11 22:26:45 -0400] miah: i've used application_ruby though
[2013-06-11 22:28:10 -0400] miah: you should be able to swap out the bundler_command and use the rvm stuff. which problem are you having specifrically?
[2013-06-11 22:29:21 -0400] kisoku: I think we are close to getting it working
[2013-06-11 22:29:38 -0400] miah: i had some fun issues with the way the deployment stuff works
[2013-06-11 22:29:45 -0400] miah: but i havent spent much time trying to straighten it out
[2013-06-11 22:29:51 -0400] Otterley: how is your stack going to handle non-uniform versioning across the servers?
[2013-06-11 22:30:03 -0400] miah: non-uniform versioning?
[2013-06-11 22:30:04 -0400] Otterley: I've always wondered how folks deal with that when using Chef as a deployment tool
[2013-06-11 22:30:25 -0400] Otterley: yeah, in most installations Chef doesn't update every host at once
[2013-06-11 22:31:00 -0400] kisoku: we do manual orchestration of our chef runs
[2013-06-11 22:31:11 -0400] kisoku: on our more comple production services
[2013-06-11 22:31:19 -0400] Otterley: how well does that scale?
[2013-06-11 22:31:36 -0400] kisoku: slowly moving towards automating all the easy bits in jenkins using the pipeline plugin
[2013-06-11 22:31:58 -0400] kisoku: it doesn't scale well
[2013-06-11 22:32:05 -0400] kisoku: luckily we don't have huge scale stuff
[2013-06-11 22:32:24 -0400] kisoku: and are not going to have really large scale stuff ever
[2013-06-11 22:32:28 -0400] Otterley: that's. good?
[2013-06-11 22:32:35 -0400] kisoku: it is what it is
[2013-06-11 22:33:10 -0400] kisoku: I wouldn't recommend it doing it the way we do if you have more than 20 machines in your app cluster
[2013-06-11 22:34:33 -0400] segv: hey guys quick Q, looked at the dns cookbooks but none seem to do this, I want to create/manage my internal dns with a chef search, figured this might already be done but not in the opscode cookbooks
[2013-06-11 22:40:51 -0400] gzc: https://gist.github.com/fnichol/5469998
[2013-06-11 22:41:36 -0400] asharp: using percona cookbook for mysql. then database cookbook for creating databases. i can successfully install percona, but when i try to create a database i get "LoadError: cannot load such file  mysql"
[2013-06-11 22:50:06 -0400] spheromak: anyone know how/if you can get test-kitchen 1.0 to build in parellel either from the Rake task or by specifying in your local yaml ?
[2013-06-11 22:50:18 -0400] ccapndave3: Hey everyone, how can I get a file to copy from a cookbook to the client?
[2013-06-11 22:50:34 -0400] spheromak: ccapndave3,  cookbook_file
[2013-06-11 22:50:57 -0400] ccapndave3: spheromak Thanks!
[2013-06-11 22:51:03 -0400] Otterley: is there a parallel Rake?
[2013-06-11 22:51:19 -0400] spheromak: Otterley, I have a task spawning kitchen:tests
[2013-06-11 22:51:29 -0400] Otterley: yeah, but that's not quite the same thing :D
[2013-06-11 22:51:32 -0400] spheromak: I just want the tests to launch parellel. Thats in kitchen not rake
[2013-06-11 22:51:35 -0400] spheromak: :D
[2013-06-11 22:51:45 -0400] spheromak: I get that its not the same, thats why
[2013-06-11 22:58:39 -0400] asharp: about my previous problem (loaderror on mysql file), somebody says downgrading rubygems fixes the problem. i'm new, how do i 'downgrade rubygems'
[2013-06-11 23:01:38 -0400] Otterley: asharp, are you using omnibus chef?
[2013-06-11 23:01:48 -0400] asharp: probably notwhat is omnibus chef?
[2013-06-11 23:02:04 -0400] Otterley: it's the blessed Chef client installer
[2013-06-11 23:02:13 -0400] asharp: i've got to use chef-solo
[2013-06-11 23:02:25 -0400] Otterley: chef-solo comes in that
[2013-06-11 23:02:36 -0400] Otterley: did you install chef via gem or via a native OS package?
[2013-06-11 23:02:53 -0400] asharp: i didn't do it, i just cloned a colleague's repository
[2013-06-11 23:03:12 -0400] Otterley: suggest asking your colleague for help, he's pushing you way out of your comfort zone
[2013-06-11 23:03:17 -0400] asharp: lol
[2013-06-11 23:03:25 -0400] asharp: she's not very helpful
[2013-06-11 23:03:38 -0400] asharp: do i just put in a bash script to downgrade?
[2013-06-11 23:04:11 -0400] Otterley: I cannot answer those questions without knowing the basics of how Chef is installed on your system
[2013-06-11 23:04:19 -0400] Otterley: nor can I help with HR problems ;)
[2013-06-11 23:04:27 -0400] asharp: lol no worries
[2013-06-11 23:04:31 -0400] paulmooring: asharp: this all depends on how Chef/Ruby/Rubygems was installed
[2013-06-11 23:04:52 -0400] asharp: it's all going to a vagrant vm, does that help?
[2013-06-11 23:04:53 -0400] paulmooring: if you run the command: ls -l $(which chef-client)
[2013-06-11 23:05:11 -0400] paulmooring: you should get some idea of how it's set up
[2013-06-11 23:05:22 -0400] asharp: lrwxrwxrwx. 1 root root 25 May 29 01:09 /usr/bin/chef-client -> /opt/chef/bin/chef-client
[2013-06-11 23:05:39 -0400] paulmooring: so that is the omnibus installer
[2013-06-11 23:05:51 -0400] paulmooring: with a separate ruby/rubygems for chef from the system ruby
[2013-06-11 23:05:56 -0400] Otterley: I do not believe it's trivial to get the mysql gem installed in there...
[2013-06-11 23:06:06 -0400] paulmooring: you probably do not want to downgrade/upgrade/ect. the ruby or gems
[2013-06-11 23:07:01 -0400] Otterley: pure-ruby gems can be installed fairly easily using the chef_gem resource, but C Ruby gems like mysql are harder
[2013-06-11 23:07:33 -0400] paulmooring: asharp: if you can use community cookbooks, the Opscode mysql cookbook has a ruby recipe that will take care of this for you
[2013-06-11 23:08:01 -0400] paulmooring: otherwise it's opensource, so I would take a look and adapt your own solution from there even if you can't use it wholesale
[2013-06-11 23:08:09 -0400] paulmooring: https://github.com/opscode-cookbooks/mysql
[2013-06-11 23:08:15 -0400] asharp: okay so just include_recipe "mysql::ruby"?
[2013-06-11 23:08:43 -0400] Otterley: mysql::server
[2013-06-11 23:08:44 -0400] paulmooring: yeah, in the run_list *before* the cookbook trying to use the mysql gem
[2013-06-11 23:08:52 -0400] asharp: yeah okay
[2013-06-11 23:08:58 -0400] asharp: mysql is already installed on the golden image
[2013-06-11 23:09:01 -0400] asharp: it's percona
[2013-06-11 23:09:06 -0400] paulmooring: yeah to mysql::ruby, I don't know that you want the server recipe
[2013-06-11 23:09:23 -0400] Otterley: ah
[2013-06-11 23:09:36 -0400] asharp: okay i'll try the mysql::ruby thanks
[2013-06-11 23:14:46 -0400] idlemichael: how do you handle cloning private github repos with chef? i can't seem to find a guide on google or advice
[2013-06-11 23:17:35 -0400] lukewaite: http://docs.opscode.com/resource_deploy.html#examples
[2013-06-11 23:17:48 -0400] lukewaite: ^^ One of the examples is "Deploy from a private git repository without using the application cookbook" and goes over how to create an ssh wrapper to do it
[2013-06-11 23:18:05 -0400] asharp: here's what i got
[2013-06-11 23:18:06 -0400] asharp: FATAL: Chef::Exceptions::Exec: package[mysql] (mysql::client line 46) had an error: Chef::Exceptions::Exec:  returned 1, expected 0
[2013-06-11 23:18:23 -0400] idlemichael: thanks lukewaite
[2013-06-11 23:30:45 -0400] asharp: i think i may need to chef_gem "mysql"
[2013-06-11 23:33:13 -0400] paulmooring: asharp: what distro?
[2013-06-11 23:33:28 -0400] asharp: paulmooring: CentOS
[2013-06-11 23:33:58 -0400] paulmooring: it's trying to install mysql and mysql-devel
[2013-06-11 23:34:02 -0400] paulmooring: and failing
[2013-06-11 23:34:24 -0400] paulmooring: if you turn up the log level you can see the except command that failed with an exit status of 1
[2013-06-11 23:34:34 -0400] paulmooring: chef-client -l debug -L /tmp/chef-log.txt
[2013-06-11 23:37:34 -0400] asharp: i'm looking at that log
[2013-06-11 23:37:42 -0400] asharp: it says "Private Key Not Found"
[2013-06-11 23:37:54 -0400] asharp: it's looking in /etc/chef
[2013-06-11 23:37:58 -0400] asharp: but there is no /etc/chef
[2013-06-11 23:38:10 -0400] asharp: and it tries to mkdir /etc/chef, but "Permission denied"
[2013-06-11 23:38:18 -0400] c_t: you need to run chef-client as root
[2013-06-11 23:38:29 -0400] asharp: it's chef-solo on a vagrant vm
[2013-06-11 23:39:00 -0400] paulmooring: you shouldn't get the Private Key error on chef-solo
[2013-06-11 23:39:41 -0400] asharp: it's only a "WARN", but then it tries to mkdir /etc/chef and fails and that's where the log stops
[2013-06-11 23:40:32 -0400] asharp: maybe i should just be making databases with bash
[2013-06-11 23:41:19 -0400] asharp: i'm going to look into that
[2013-06-11 23:48:24 -0400] asharp: i think that's my best option
[2013-06-11 23:48:29 -0400] asharp: at least it works
[2013-06-11 23:48:44 -0400] ccapndave: How can I run a command on the chef target machine and get back the value?
[2013-06-11 23:49:04 -0400] ccapndave: Or do all commands run on the target machine by definition?
[2013-06-11 23:49:08 -0400] ccapndave: e.g. extension_dir = `php -i | grep extension_dir`.scan(/^w* => ([\/\w]*)/)
[2013-06-11 23:50:26 -0400] Otterley: chef-client runs on nodes
[2013-06-11 23:50:33 -0400] Otterley: therefore, the recipes do as well
[2013-06-11 23:50:45 -0400] ccapndave: Otterley Jolly good
[2013-06-11 23:50:50 -0400] ccapndave: Otterley Sorry, I am new to all this :)
[2013-06-11 23:51:35 -0400] Otterley: I'd suggest reading the documentation thoroughly
[2013-06-11 23:56:45 -0400] ccapndave: Otterley I'm trying, but the commands are quite spread out
[2013-06-11 23:56:58 -0400] Otterley: it's big, give yourself time
[2013-06-11 23:57:38 -0400] ccapndave: Otterley I promised to take a very large company's business and chef the lot in a few months time
[2013-06-11 23:57:42 -0400] ccapndave: So I have that long :)
[2013-06-11 23:59:39 -0400] Otterley: you must be a salesman. ;)
