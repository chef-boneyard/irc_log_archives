[2013-06-17 03:18:11 -0400] luke`: I am using Vagrant with a hand rolled Debian Wheezy 32 bit box and attempting to get chef to install oracle java. But chef fails claiming that it can't find the windows cookbook. Why is the windows cookbook required on debian?
[2013-06-17 03:20:46 -0400] coderanger: luke`: Chef doesn't (yet) have a concept of a platform-specific dependency
[2013-06-17 03:21:22 -0400] coderanger: luke`: So since the java cookbook includes a windows recipe that needs the windows cookbook, the whole cookbook has to depend
[2013-06-17 03:21:56 -0400] luke`: coderanger: got it. thanks for clarifying. I was losing hair over it.
[2013-06-17 03:22:19 -0400] coderanger: So the windows cookbook won't actually be run
[2013-06-17 03:22:22 -0400] coderanger: but you need it there
[2013-06-17 03:22:27 -0400] coderanger: We're still working on it :)
[2013-06-17 03:22:45 -0400] coderanger: I highly recommend you use berkshelf to manage your cookbooks, it takes care of these dependencies for you
[2013-06-17 03:24:45 -0400] luke`: coderanger: is there a recommended place to read up on berkshelf. I am devops newbie.
[2013-06-17 03:24:55 -0400] coderanger: berkshelf.com :)
[2013-06-17 03:25:12 -0400] coderanger: we also go over it in one of our learnchef.com tutorials
[2013-06-17 03:31:55 -0400] swedish_chef: Is there a foolproof pattern for using gems from library files? In my case, I'm having a problem with the activesupport gem from which I require 'active_support/core_ext'. RSpec (with chefspec) runs green for the same recipe Chef client fails on. The client debug output indicates that the library files are getting loaded *before* any recipe code can run the chef_gem and/or gem_package commands that would bring the gems in. I must 
[2013-06-17 03:33:50 -0400] coderanger: swedish_chef: Nope, delay the require until the lib is actually used
[2013-06-17 03:34:25 -0400] swedish_chef: git it, thanks
[2013-06-17 03:34:35 -0400] swedish_chef: git -> got
[2013-06-17 05:00:35 -0400] dyu: is there something like a --fake flag for knife? where it runs the recipe but doesn't do any writes
[2013-06-17 06:00:48 -0400] binamov: hey waerloga
[2013-06-17 06:00:52 -0400] binamov: hey Walid
[2013-06-17 06:01:21 -0400] Walid: heya the learnchef room is not responding
[2013-06-17 06:38:21 -0400] ssd7: Walid: Still around?  Have a question?
[2013-06-17 07:21:50 -0400] axyelp: hi!
[2013-06-17 07:21:50 -0400] axyelp: how can i use helper methods (in /cookbook/libraries) from a different cookbook in my recipes?
[2013-06-17 07:24:39 -0400] coderanger: axyelp: Just use it?
[2013-06-17 07:25:06 -0400] coderanger: library files are just exec'd as Ruby code, they are no scoped or processed in any way other than eval
[2013-06-17 07:25:44 -0400] axyelp: i mean, how do i call it!  '::Chef::Recipe.send(:include, cookbookname::helpername)' doesn't work
[2013-06-17 07:38:10 -0400] luke`: I am using Vagrant with a hand rolled Debian Wheezy 32 bit box and attempting to get chef to install oracle java. The output in the terminal shows that vagrant/chef insists on installing openjdk but also failing at it. http://pastebin.com/st3qfC2M
[2013-06-17 08:07:58 -0400] coderanger: axyelp: However you defined it? again, library files are just plain Ruby code, there is no special Chef-ishms in there
[2013-06-17 08:08:25 -0400] coderanger: axyelp: If you define a function in there, it is just defined globally, because Ruby is awful at namespaces
[2013-06-17 08:57:41 -0400] kreisys: hey I'm trying to fix a problem with the redis cookbook where the supplied init script doesn't support status. I added to the service resource:
[2013-06-17 08:57:42 -0400] kreisys: supports :reload => false, :restart => false, :status => false
[2013-06-17 08:57:45 -0400] kreisys: and still
[2013-06-17 08:58:00 -0400] kreisys:        [2013-06-17T08:50:51+00:00] INFO: Processing service[redis-server] action enable (/tmp/kitchen-chef-solo/cookbooks/redis/providers/instance.rb line 151)
[2013-06-17 08:58:00 -0400] kreisys:        [2013-06-17T08:50:51+00:00] DEBUG: service[redis-server] supports status, running
[2013-06-17 08:58:01 -0400] kreisys:        Please use start or stop as first argument
[2013-06-17 08:58:05 -0400] kreisys: why oh why! :(
[2013-06-17 09:51:49 -0400] ChefLemming: Hi there
[2013-06-17 09:52:07 -0400] m4rcu5: ohai ChefLemming
[2013-06-17 09:52:54 -0400] admin0: hello
[2013-06-17 09:53:07 -0400] ChefLemming: I'm looking for a little bit of help setting up a Chef system
[2013-06-17 09:53:56 -0400] ChefLemming: I've hit a problem that must be a config issue but I can't quite see where I'm going wrong
[2013-06-17 09:55:20 -0400] m4rcu5: ChefLemming: whats the problem?
[2013-06-17 09:55:41 -0400] ChefLemming: I've created an environment file in the environments directory (dev.rb)  and I can use this command to upload it too my server : knife environment from file environments/dev.rb  THIS WORKS.
[2013-06-17 09:56:12 -0400] ChefLemming: BUT : when I try and upload a cookbook  (knife cookbook upload apache)  I get this error : http.rb:762:in `initialize': getaddrinfo: Name or service not known (SocketError)
[2013-06-17 09:56:49 -0400] ChefLemming: So it would seem I can connect to the server to upload environments and roles, but not when I try to upload a cookbook.
[2013-06-17 09:57:55 -0400] ChefLemming: why can I connect for some tasks but not for others?
[2013-06-17 09:58:15 -0400] ChefLemming: I have my own open source Chef server running
[2013-06-17 09:58:48 -0400] ChefLemming: I can connect using the web interface and see the environments and roles that I have created on a separate workstation machine and uploaded
[2013-06-17 09:59:11 -0400] ChefLemming: I just can't get a cookbook to upload
[2013-06-17 09:59:15 -0400] ChefLemming: anyone have any ideas?
[2013-06-17 10:01:21 -0400] kreisys: Did you try to explicitly specify the chef server url with the -s option?
[2013-06-17 10:03:11 -0400] ChefLemming: I've just tried that and got exactly the same error.
[2013-06-17 10:04:34 -0400] kreisys: weird
[2013-06-17 10:04:34 -0400] kreisys: same when using the IP address?
[2013-06-17 10:04:35 -0400] kreisys: actually I don't think IP address would work with https
[2013-06-17 10:04:46 -0400] kreisys: but try it for kicks
[2013-06-17 10:05:52 -0400] admin0: ChefLemming, i had that issue when the hostname was internal ( chef-server is abc.com) and the workstation could not resolve it to abc.com
[2013-06-17 10:07:35 -0400] kreisys: how come it would upload the environment though?
[2013-06-17 10:07:46 -0400] ChefLemming: just what I was going to ask
[2013-06-17 10:08:02 -0400] ChefLemming: I have uploaded 3 environments, and 6 roles
[2013-06-17 10:09:44 -0400] ChefLemming: The Chef server is running on an EC2 instance that has a FQDN (DNS entry) and a fixed elastic IP address, which I've just pinged from the workstation machine and all looks good.
[2013-06-17 10:10:49 -0400] ChefLemming: are there extra steps (ports needing opened) when uploading a cookbook?
[2013-06-17 10:11:06 -0400] admin0: in my case, just 443
[2013-06-17 10:11:45 -0400] ChefLemming: yep, that's all I have open
[2013-06-17 10:12:29 -0400] miquel: hi, a small question... I'm writing a cookbook with two providers and I have a function that I want to use from both providers. I'm trying to write that function in an auxiliar file and then import that file from the two providers with a normal ruby require, but fails with a "cannot load such file"
[2013-06-17 10:12:40 -0400] miquel: is there any way to import a file of the same directory from a chef provider?
[2013-06-17 10:32:44 -0400] willejs: how does everyone run chef-client at boot?
[2013-06-17 10:33:21 -0400] willejs: I'm using the chef-client cookbook with cron, but don't want to run it in daemon mode, as it has undesired results when a chef run fails (leaves pidfile abandoned and breaks all later chef runs)
[2013-06-17 10:38:54 -0400] kreisys: ChefLemming: what does knife show when you use -VV?
[2013-06-17 10:43:14 -0400] ChefLemming: just checking that now
[2013-06-17 10:44:52 -0400] ChefLemming: kreisys, just reading through the debug
[2013-06-17 10:45:48 -0400] ChefLemming: Request signed
[2013-06-17 10:46:15 -0400] kreisys: Anything interesting? I looked at the source and it seems that both 'environment from file' and 'cookbook upload' ultimately use the same put_rest method to write to the server. although with cookbooks the logic is a bit more involved because they do some sort of sandboxing
[2013-06-17 10:50:24 -0400] ChefLemming: Ah, parts of the process that look to work use the chef.xxx.com URL, but the actual uploading of the files are using the AWS EC2 FQDN internal DNS.
[2013-06-17 10:51:33 -0400] kreisys: Looks like a bug to me I don't see why under any circumstances would it be desirable to stray from the explicitly configured url...
[2013-06-17 10:52:24 -0400] willejs: can anyone help me re running chef at boot?
[2013-06-17 10:52:50 -0400] admin0: ChefLemming, that was  what i was trying to say .. to map the internal FQDN from the workstation via hosts file
[2013-06-17 10:53:36 -0400] kreisys: modifying the hosts file is worth a shot but I think it would make ssl croak
[2013-06-17 10:54:02 -0400] ChefLemming: admin0, ah i see. the internal FQDN is only accessible to other EC2 instances, the workstation couldn't have resolved that, so it must have been returned by the server
[2013-06-17 10:55:54 -0400] kreisys: willejs: you want to run chef-client once at boot in addition to the cron runs?
[2013-06-17 10:56:04 -0400] willejs: yeah
[2013-06-17 10:56:12 -0400] willejs: i was just going to use @reboot
[2013-06-17 10:56:38 -0400] willejs: but i realised, actually i should just write an init script, because its for autoscaling, and i need to grab stuff like the run list from the tags
[2013-06-17 10:57:00 -0400] kreisys: I'm not sure it's supported
[2013-06-17 10:57:08 -0400] kreisys: @reboot that is
[2013-06-17 10:57:29 -0400] willejs: i was going to use @reboot in cron to trigger the run...
[2013-06-17 10:57:55 -0400] kreisys: This is for the initial bootstrap?
[2013-06-17 10:58:42 -0400] willejs: basically, I'm going to pre bake an AMI with chef installed, along with vital packages that will need to be compiled from source (collectd etc)
[2013-06-17 10:59:28 -0400] kreisys: So it's basically a bootstrap minus the omnibus installation
[2013-06-17 10:59:38 -0400] willejs: then when it boots i trigger a run, and it will parse options in from tags and run chef client
[2013-06-17 10:59:40 -0400] willejs: yeah exactly
[2013-06-17 11:00:06 -0400] kreisys: I'd use a user-data script
[2013-06-17 11:00:18 -0400] kreisys: Rather than tags
[2013-06-17 11:00:40 -0400] kreisys: but whatever floats your boat :>
[2013-06-17 11:02:08 -0400] willejs: hmm yeah, you could be right
[2013-06-17 11:04:59 -0400] ChefLemming: admin0, added an entry to the hosts file and I've uploaded a cookbook! Thanks for you help. The only problem will be remembering to update this if the server is ever restarted.
[2013-06-17 11:05:26 -0400] admin0: create a motd file :) .. should remind you in every login :)
[2013-06-17 11:05:53 -0400] kreisys: ChefLemming: or rather write a cookbook for it :>
[2013-06-17 11:07:04 -0400] ChefLemming: admin0 & kreisys, both good ideas :)
[2013-06-17 11:48:52 -0400] tnarik: ohai!
[2013-06-17 11:49:11 -0400] tnarik: I was trying to get my head around something
[2013-06-17 11:49:32 -0400] tnarik: I have several websites provisioned by Chef which are based on data bags
[2013-06-17 11:49:54 -0400] tnarik: but recently created a new cookbook to provision a new web site, which have slightly different requirements
[2013-06-17 11:50:24 -0400] tnarik: the thing is I like data bags as a way of keeping track of assets, and it would be great if they look as much alike as possible
[2013-06-17 11:51:29 -0400] tnarik: and I like the flexibility that data bags provide
[2013-06-17 11:51:56 -0400] tnarik: so I was thinking about specifying in the data bags themselves which cookbook or recipe should provision them
[2013-06-17 11:52:24 -0400] tnarik: that way having a common recipe that searches data bags, process the common ones
[2013-06-17 11:52:38 -0400] tnarik: and triggers the correct recipes for some exceptions
[2013-06-17 11:53:01 -0400] tnarik: but it seems really dirty and convoluted
[2013-06-17 11:53:50 -0400] tnarik: does it make more sense losing that flexibility by explicitly using the correct recipes that will look at the correct data_bags?
[2013-06-17 11:54:20 -0400] m4rcu5: tnarik: it sound like you are replacing run_lists and attributes with databags
[2013-06-17 11:54:53 -0400] tnarik: yes
[2013-06-17 11:56:21 -0400] tnarik: um... so I should try to see what is the  'application' provisioned, instead of considering the web site data bags part of the same 'application' ?
[2013-06-17 12:05:20 -0400] m4rcu5: tnarik: i would use the databags for the website data and config and then have a website cookbook which youc an either have it search fro all website databags of give it a attribute wich sites to install
[2013-06-17 12:11:04 -0400] tnarik: m4rcu5: I think I would do that, thanks
[2013-06-17 12:16:42 -0400] masterkorp: hello everyonr
[2013-06-17 12:49:32 -0400] jasonsmr: hello all in the wonderious chef world today
[2013-06-17 12:50:10 -0400] jasonsmr: well I have issues with my chef serv, its in a massive state of repeting ; here look at my pastebin of outut>> ps aux >> http://sprunge.us/FDXe
[2013-06-17 12:54:11 -0400] jasonsmr: anyone here?
[2013-06-17 12:54:25 -0400] jasonsmr: Network Error: Connection refused - Connection refused connecting to mothership.stollc.com:4000 for /users, giving up
[2013-06-17 12:54:38 -0400] jasonsmr: this is bad
[2013-06-17 13:15:06 -0400] jasonsmr: so does chef-server-ctl test have to be run as root
[2013-06-17 13:23:12 -0400] pixie79: Hi All - can i please check how with afw can I write the following so that it applies to one recipe and group of servers only rather than all servers ? - https://gist.github.com/pixie79/5796815
[2013-06-17 14:08:12 -0400] bleepbloop: Quick question, I have been trying to get ruby-block to run a cron job for me, it doesn't throw any errors, but nothing seems to happen either https://gist.github.com/rbclark/18adc7315bc89556b4ea
[2013-06-17 14:08:16 -0400] bleepbloop: am I missing something obvious?
[2013-06-17 14:26:34 -0400] gchristensen: is there a way to know the deployed hash with the application or application ruby LWRPs?
[2013-06-17 14:27:41 -0400] pixie79: how do i say dont apply this rule if the environment is 'Y'
[2013-06-17 14:28:07 -0400] gchristensen: it'd be better to apply the rule if attribute is 'Y', and set the attribute to 'Y' in the environment
[2013-06-17 14:33:38 -0400] pixie79: gchristensen: i already have a set of rules in my recipies, which i want to disable in a new environment i am setting up
[2013-06-17 14:34:00 -0400] pixie79: so i just need to be able to say if the env is 'X' then do this otherwise dont
[2013-06-17 15:08:11 -0400] bleepbloop: Damn guess nobody gets up this early hah :/
[2013-06-17 15:09:38 -0400] juliancdunn: bleepbloop: don't understand why you aren't just using the 'cron' resource?
[2013-06-17 15:11:08 -0400] bleepbloop: Because I have some environment variables to set some things which I need later on, and since the cron resource seems to get compiled the variables don't show up unless I wrap in a ruby block
[2013-06-17 15:12:15 -0400] bleepbloop: Its because I am using a file which is on the system to determine some information, and I know its not exactly ideal but it was the cleanest way I could figure out
[2013-06-17 15:14:25 -0400] bleepbloop: juliancdunn: sorry forgot to tag you in my reply
[2013-06-17 15:15:49 -0400] juliancdunn: bleepbloop: no problem. so the 'command' in your gist is what your cron command is?
[2013-06-17 15:17:07 -0400] bleepbloop: yep
[2013-06-17 15:18:27 -0400] juliancdunn: shouldn't it be "res.command" then?
[2013-06-17 15:18:42 -0400] bleepbloop: juliancdunn: I've dropped down to chef shell to see if I can get it work and it seems like it is all set fine its just I can't find like a run action or something
[2013-06-17 15:19:16 -0400] bleepbloop: oops, sorry I had that correct in my run
[2013-06-17 15:19:38 -0400] juliancdunn: I also still don't *quite* get what happens when you just use the cron resource directly
[2013-06-17 15:19:47 -0400] juliancdunn: as in, what variables aren't showing up
[2013-06-17 15:21:03 -0400] bleepbloop: juliancdunn: Thats the thing, all the variables show up fine, its just the cron never actually shows up in the crontab, it just never executes
[2013-06-17 15:21:46 -0400] juliancdunn: that's ... strange. I would drop to debug mode (while using the 'cron' resource directly) to figure out what's happening
[2013-06-17 15:22:01 -0400] bleepbloop: Yeah that's what I've been attempting in chef-shell
[2013-06-17 15:22:07 -0400] juliancdunn: the way you're doing it with calling the Chef classes directly is really painful :-)
[2013-06-17 15:24:03 -0400] bleepbloop: juliancdunn: yeah I can tell, I've done it with templates before and its been a pain there as well
[2013-06-17 15:24:51 -0400] juliancdunn: also, sometimes (always?) crontab doesn't like it if you don't have a command as the thing to run. try "env FOO=BAR && your_command"
[2013-06-17 15:25:25 -0400] juliancdunn: start with the cron resource directly is what I'd do... there's probably a reason why it's not showing up in the crontab.
[2013-06-17 15:25:34 -0400] juliancdunn: my money is on "crontab -e" rejecting your crontab line.
[2013-06-17 15:26:24 -0400] bleepbloop: Thats what I was doing originally, I was calling it straight without using the ruby block, the weird thing is it was originally working okay
[2013-06-17 15:31:34 -0400] sleepy1: got a recipe that has checks for environment using this  :  if node.chef_environment == "Production"
[2013-06-17 15:31:54 -0400] sleepy1: but the code within gets executed on other environments too
[2013-06-17 15:31:59 -0400] sleepy1: any clues?
[2013-06-17 15:33:46 -0400] theNetImp: having an issue with chef.  I have set up an EC2 instance using knife ec2, and have created a collection of cookbooks, but when I tried to tell knife to run chef-client on the ec2 server it errors out.
[2013-06-17 15:34:13 -0400] theNetImp: My error is "FATAL: 1 node found, but does not have the required attribute to establish the connection. Try setting another attribute to open the connection using --attribute."
[2013-06-17 15:34:27 -0400] theNetImp: the cli I am using is "knife ssh name:i-98a4fead -x ubuntu "sudo chef-client" -a ec2.public_dns"
[2013-06-17 15:34:45 -0400] theNetImp: thoughts?
[2013-06-17 15:34:50 -0400] sleepy1: http://community.opscode.com/questions/167
[2013-06-17 15:34:54 -0400] sleepy1: is worth a look
[2013-06-17 15:35:42 -0400] theNetImp: thanks I'll give that a looksie
[2013-06-17 15:36:33 -0400] dsteen: whats the best way to have a recipe run *only* if a file contains a specific string?
[2013-06-17 15:49:31 -0400] sleepy1: dsteen, this should get you started
[2013-06-17 15:49:32 -0400] sleepy1: http://docs.opscode.com/chef/resources.html
[2013-06-17 15:50:33 -0400] bleepbloop: juliancdunn: would it make sense to you if it wasn't working because I'm not calling the provider as well?
[2013-06-17 15:56:27 -0400] theNetImp: That link that was provided seems impractical since I'll never know what the IP address is until after I instantiate an EC2 instance.
[2013-06-17 15:56:44 -0400] theNetImp: I've been following this
[2013-06-17 15:56:45 -0400] theNetImp: http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide#EC2BootstrapFastStartGuide-Step6%3ARunchefclientonthenewclientnode
[2013-06-17 15:56:54 -0400] theNetImp: I get to step 6 and that's where it fails
[2013-06-17 15:57:03 -0400] theNetImp: I follow the solution given, but that seems to do nothing
[2013-06-17 16:04:35 -0400] sleepy1: can you knife ec2 server list
[2013-06-17 16:04:42 -0400] sleepy1: and use the ip address instead?
[2013-06-17 16:06:57 -0400] sleepy1: if you're not getting very far quickly, ssh into the new EC2 box and run chef client manually to see what is happening
[2013-06-17 16:10:19 -0400] theNetImp: "knife ec2 server list" does return information with the public ip address
[2013-06-17 16:11:04 -0400] theNetImp: the problem from what I can tell is that knife on my laptop can ssh into the node server, so it hasn't even gotten there to try and run the recipe
[2013-06-17 16:13:39 -0400] jbz_: nstielau: Promoted you on the graylog2 cookbook.  Thanks.
[2013-06-17 16:17:28 -0400] idlemichael: is there a way to test if a package already exists on teh system, or if it's already been defined in a previous resource?
[2013-06-17 16:33:04 -0400] Nysso: Hello everyone. I am new with Chef. Can you give me answers for two questions? 1. How to uninstall something installed by recipe? 2. How to ignore already installed/deployed recipe?
[2013-06-17 16:34:56 -0400] jbz_: Nysso: 1) Chef converges towards desired system state, but it won't uninstall things unless you specifically write code to tell it to do so.
[2013-06-17 16:35:24 -0400] jbz_: Nysso: 2) If the recipe in the runlist has already been converged, it'll process it but not make any changes to the node.
[2013-06-17 16:36:46 -0400] Nysso: jbz_, thanks for answers. about q2, when I run chef-client, recipe does all things again.
[2013-06-17 16:37:04 -0400] nstielau: thanks jbx! jbz_
[2013-06-17 16:37:10 -0400] nstielau: Uh. thanks jbz_!
[2013-06-17 16:37:22 -0400] Nysso: jbz_, how can I skip this?
[2013-06-17 16:37:23 -0400] jbz_: Nysso: Check carefully.  The log will tell you that it's actually checking each thingin the recipe, but it shouldn't be actually making changes.  It is, however, going over each thing to be sure that it's as it should be
[2013-06-17 16:37:49 -0400] jbz_: nstielau: No, thank you for taking on that mess I left you :-)
[2013-06-17 16:38:35 -0400] nstielau: jbz_: already transferred ;)
[2013-06-17 16:39:03 -0400] Nysso: jbz_: So, recipe will ignore some Ruby code which does changes. If I have direct scripts like a bash commands, it will run ?
[2013-06-17 16:39:48 -0400] jbz_: Nysso: It will not repeat *chef resources* that are specified if they're already converged.  If you have an execute resource, it will always do that unless you use a not_if or only_if check in the execute resource.
[2013-06-17 16:40:13 -0400] jbz_: It has to have a way to know if the resource is converged properly; with script code it has no way of knowing so it relies on the explicit tests in not_if or only_if
[2013-06-17 16:40:25 -0400] Nysso: jbz_, tnanks. Now I understand.
[2013-06-17 16:40:30 -0400] jbz_: note that if you are talking about code that is outside a resource, that will *always* run at compile time.
[2013-06-17 17:15:33 -0400] qhartman: So, the new opscode logo looks like morse code. If it is, from top to bottom it spells "kdurm". Any thoughts?
[2013-06-17 17:16:31 -0400] geggam: that you have too much time on your hands ?
[2013-06-17 17:16:46 -0400] qhartman: oh come on, it only took 30 seconds to look up and decode
[2013-06-17 17:16:52 -0400] qhartman: and puzzles are interesting
[2013-06-17 17:17:06 -0400] qhartman: it would be just like these guys to have something meaningful in there
[2013-06-17 17:17:19 -0400] geggam: there are many bugs in recipes ... can you find them and fix that puzzle ?
[2013-06-17 17:17:45 -0400] qhartman: well aren't you just a little black raincloud.
[2013-06-17 17:18:39 -0400] geggam: sorry.. its monday.. i have to tell mgmt they are stupid in a way they think they arent and convince them not to make my life hell and bring in cfengine because some nerds across the pond like it
[2013-06-17 17:18:50 -0400] geggam: how is your day ?
[2013-06-17 17:19:06 -0400] qhartman: wheee
[2013-06-17 17:19:20 -0400] geggam: might i add political nerds that suck at writing any recipes/promises ?
[2013-06-17 17:19:49 -0400] qhartman: decent so far. cfengine though? Really? Talk about going backwards....
[2013-06-17 17:20:25 -0400] geggam: welcome to large company politics
[2013-06-17 17:20:29 -0400] geggam: take a number
[2013-06-17 17:21:02 -0400] qhartman: yeah. One of the many reasons I avoid them, despite the fact it usually means lower pay/benefits.
[2013-06-17 17:21:25 -0400] geggam: when one has family one suffers so kids can eat
[2013-06-17 17:21:36 -0400] geggam: and damn do they
[2013-06-17 17:21:48 -0400] qhartman: indeed
[2013-06-17 17:22:08 -0400] qhartman: We keep joking that my oldest daughter is going to eat her college fund....
[2013-06-17 17:22:20 -0400] geggam: heh... girls dont eat
[2013-06-17 17:22:43 -0400] qhartman: compared to my nephew she does
[2013-06-17 17:22:55 -0400] geggam: we live in east bay... drive to the city to eat... before we get back the boys want to stop for a snack
[2013-06-17 17:23:06 -0400] qhartman: heh
[2013-06-17 17:38:31 -0400] superbenk: Anyone do anything with the service resource with Upstart running multiple instances of a service?
[2013-06-17 17:53:01 -0400] adamjk-dev: hey all, is anyone well versed in chefspec?
[2013-06-17 17:53:04 -0400] guix_: Hi, I am renaming a cookbook (php) and I am receiving this message: Cannot find a resource for php_pear_channel on centos version 6.3. Anyone seen this before?
[2013-06-17 17:53:26 -0400] adamjk-dev: https://github.com/acrmp/chefspec
[2013-06-17 17:53:38 -0400] coderanger: guix_: LWRPs form their name based on the cookbook name
[2013-06-17 17:53:51 -0400] coderanger: guix_: You will need to change every instance of any LWRP used from that cookbook
[2013-06-17 17:54:02 -0400] adamjk-dev: I am having an issue stubbing out a data bag retrieval while also setting node attributes. The data bag stubbing works when I don't set node attributes on the Runner
[2013-06-17 17:54:07 -0400] coderanger: In general we don't recommend this, better to make a wrapper cookbook than try to rename
[2013-06-17 17:54:32 -0400] guix_: Can you give more details how to do this? Do you mean the resources and providers?
[2013-06-17 17:54:58 -0400] coderanger: guix_: What are you trying to accomplish?
[2013-06-17 17:55:08 -0400] coderanger: Renaming a community cookbook is a big ol' recipe for pain :)
[2013-06-17 17:55:30 -0400] coderanger: but yeah, everywhere in any recipe code you see php_pear_channel you would need to change that to <namename>_pear_channel
[2013-06-17 17:55:40 -0400] coderanger: er <newname>
[2013-06-17 17:55:43 -0400] coderanger: too early for typing :(
[2013-06-17 17:56:07 -0400] guix_: well I already uploaded the php cookbook onto our chef-server. But I am trying to restructure our repository, by downloading the lateste php cookbook (from community) and renaming it opscode-php instead.
[2013-06-17 17:57:35 -0400] coderanger: Can  you use environment version restrictions instead?
[2013-06-17 17:57:58 -0400] guix_: I understand. I'm guessing I will hit an issue with the dash in opscode-php
[2013-06-17 17:58:00 -0400] coderanger: Lock your production severs down to the current version of your php cookbook and then upload ours and use it in staging
[2013-06-17 17:58:12 -0400] coderanger: No, dashes turn into underscores
[2013-06-17 17:58:16 -0400] coderanger: opscode_php_pear_channel
[2013-06-17 17:58:24 -0400] coderanger: but again, this will be painful to change around
[2013-06-17 17:58:34 -0400] coderanger: and means you need to fork the cookbook, and forking is evil
[2013-06-17 17:58:55 -0400] matti: nathenharvey: Ah ah ah, where is the stream!
[2013-06-17 17:58:58 -0400] matti: nathenharvey: Too excited ;p
[2013-06-17 17:59:20 -0400] guix_: hmmm. k
[2013-06-17 17:59:34 -0400] philsturgeon: hey, I have these items: http://d.pr/i/U9Nw
[2013-06-17 17:59:41 -0400] philsturgeon: for some reason they are not in crontab
[2013-06-17 18:00:11 -0400] guix_: hmmm. kWe've been using chef for the last two years and haven't used any version locking mechanism.  what is the best practices out there?
[2013-06-17 18:00:31 -0400] guix_: My ultimate goal is to have multi-tenancy on our chef server
[2013-06-17 18:00:46 -0400] coderanger: guix_: Multi-tennancy is not available in open-source chef
[2013-06-17 18:00:50 -0400] guix_: and I and putting naming conventions in place to help us with this
[2013-06-17 18:01:01 -0400] coderanger: guix_: That is a feature in Hosted and Private Chef :)
[2013-06-17 18:01:12 -0400] coderanger: As for version locking, check out "chef environments"
[2013-06-17 18:01:16 -0400] guix_: I know :(
[2013-06-17 18:01:19 -0400] coderanger: in a mtg so I can't grab the link right now
[2013-06-17 18:01:53 -0400] guix_: mtg ?
[2013-06-17 18:02:49 -0400] philsturgeon: guix_: meeting i guess
[2013-06-17 18:02:58 -0400] philsturgeon: its so important he has to "14yr old girl" it
[2013-06-17 18:03:07 -0400] guix_: ah ..
[2013-06-17 18:07:10 -0400] coderanger: Faster when typing with one hand :P
[2013-06-17 18:08:04 -0400] gzc: is chef-rewind still a 'preferred' way to get around forking external cookbook deps?
[2013-06-17 18:08:46 -0400] gzc: i'm using it in nearly an identical way to examples with no joy... it's unable to find the resource i'm referencing, even through the recipe that declares it was included the line before in my wrapper
[2013-06-17 18:10:02 -0400] coderanger: gzc: It depends on the use case, sometimes rewind is best, sometimes a wrapper cookbook is enough
[2013-06-17 18:10:33 -0400] philsturgeon: can anyone throw me a bone with this cron issue? Im using the cron resource in the documented way, but my /etc/crontab doesnt have a thing in it of any use.
[2013-06-17 18:10:49 -0400] philsturgeon: chef code: http://d.pr/i/U9Nw
[2013-06-17 18:10:55 -0400] philsturgeon: im on ubuntu 12.10
[2013-06-17 18:12:09 -0400] drrk: stuff in /etc/cron.d/ by any chance?
[2013-06-17 18:13:20 -0400] dysinger: what's the easiest way to use encrypted data bags with chef-solo ?
[2013-06-17 18:14:25 -0400] gzc: argh, I cannot get rewind to find my resource
[2013-06-17 18:14:42 -0400] philsturgeon: drrk: nothing useful
[2013-06-17 18:14:48 -0400] gzc: dysinger: https://github.com/Nordstrom/chef-vault
[2013-06-17 18:15:37 -0400] teukka: dysinger: https://github.com/thbishop/knife-solo_data_bag
[2013-06-17 18:16:34 -0400] philsturgeon: drrk: http://d.pr/i/LqaJ
[2013-06-17 18:16:46 -0400] drrk: not sure then philsturgeon sorry
[2013-06-17 18:19:14 -0400] philsturgeon: drrk: ahh, just me being a fool. cat /etc/crontab was nothing, sudo crontab -e gave me answers
[2013-06-17 18:19:54 -0400] drrk: ah
[2013-06-17 18:20:23 -0400] drrk: i'd use the cron cookbook on the community site which uses cron.d instead, which is a bite less hidden :)
[2013-06-17 18:24:17 -0400] guix_: Thx coderanger I managed to rename the cookbook. I will look how to lock versions down and use environments more effectively though
[2013-06-17 18:30:03 -0400] Otterley: +1 on the cron community cookbook
[2013-06-17 18:30:20 -0400] Otterley: "standard cron resource considered harmful"
[2013-06-17 18:30:49 -0400] Otterley: I should file a bug to have the standard one deprecated in Chef 12
[2013-06-17 18:31:15 -0400] Majost: is there some 'official' document for changing the ssl certificate for chef server with a chef 11 omnibus server install?
[2013-06-17 18:31:44 -0400] Otterley: Majost, look at http://docs.opscode.com/config_rb_chef_server.html#nginx
[2013-06-17 18:37:01 -0400] bleepbloop: juliancdunn: figured it out, wasn't specifying a run action
[2013-06-17 18:37:12 -0400] Majost: Otterley: thanks
[2013-06-17 18:38:33 -0400] deathdonut: Hey all
[2013-06-17 18:38:34 -0400] tabolario: Anyone here set up Postgres with some sort of replication via Chef?
[2013-06-17 18:38:39 -0400] deathdonut: quick question
[2013-06-17 18:38:46 -0400] deathdonut: I'm trying to use this cookbook:
[2013-06-17 18:38:47 -0400] deathdonut: https://github.com/hw-cookbooks/graphite
[2013-06-17 18:39:31 -0400] deathdonut: its got a line like: default['graphite']['user_account'] = node['apache']['user']
[2013-06-17 18:39:48 -0400] deathdonut: which doesn't work; node['apache'] is coming back nil.
[2013-06-17 18:40:17 -0400] deathdonut: I don't have explicit configuration on the node of apache attributes
[2013-06-17 18:40:26 -0400] deathdonut: but there should be defaults from the cookbook, which is included.
[2013-06-17 18:40:30 -0400] deathdonut: Any ideas?
[2013-06-17 18:40:49 -0400] tabolario: Have you checked the default attributes file in the apache cookbook?
[2013-06-17 18:40:56 -0400] deathdonut: I'm using chef 10 and am curious if this is relying on changes in chef 11.
[2013-06-17 18:42:26 -0400] deathdonut: huh...
[2013-06-17 18:42:36 -0400] deathdonut: no defaults.rb
[2013-06-17 18:42:37 -0400] Otterley: it's actually declaring a dependency on an apache2 cookbook
[2013-06-17 18:42:40 -0400] deathdonut: in the apache cookbook
[2013-06-17 18:43:24 -0400] Otterley: https://github.com/hw-cookbooks/graphite/blob/master/metadata.rb#L19
[2013-06-17 18:43:28 -0400] deathdonut: metadata.rb does contain 'depends "apache2"'
[2013-06-17 18:44:34 -0400] Otterley: apache2 does declare those defaults in most cases, unless you're on a rare platform
[2013-06-17 18:44:51 -0400] Otterley: n/m,it declares one for any platform
[2013-06-17 18:45:43 -0400] deathdonut: something was wrong with my apache cookbook.
[2013-06-17 18:45:48 -0400] deathdonut: got it from the wrong source or something.
[2013-06-17 18:45:52 -0400] deathdonut: Was missing defaults.r
[2013-06-17 18:46:28 -0400] deathdonut: cloned a new copy and I'm good.
[2013-06-17 18:46:30 -0400] deathdonut: Thanks!
[2013-06-17 18:46:36 -0400] tabolario: assuming it would've set that to nobody or www-data
[2013-06-17 19:06:35 -0400] btm: @opscode #opschef code review, join: https://plus.google.com/hangouts/_/6a4353cb85587910590c453bce71a76e8e89b63a, watch: http://youtu.be/HfIUGHeZ3sU
[2013-06-17 19:12:04 -0400] timsmith: is there a way to pass your encrypted databag secret file with knife bootstrap?
[2013-06-17 19:16:28 -0400] gkarekinian: timsmith: In recent versions (can't remember when it started but it's been a while), it's copied automatically if you set encrypted_data_bag_secret to the path if your file in your knife.rb
[2013-06-17 19:16:37 -0400] gkarekinian: http://docs.opscode.com/essentials_data_bags_encrypt.html
[2013-06-17 19:16:48 -0400] tabolario: timsmith: you can also reference it in your template file you use when bootstrapping
[2013-06-17 19:17:31 -0400] tabolario: @chef_config[:encrypted_data_bag_secret] will give you the contents of whatever file you have knife pointed to with the encrypted_data_bag_secret setting in knife.rb
[2013-06-17 19:17:50 -0400] timsmith: I actually didn't have it in my knife.rb
[2013-06-17 19:17:53 -0400] timsmith: so that would do it for sure
[2013-06-17 19:18:16 -0400] tabolario: speaking of encrypted data bag secrets, do you guys use one secret across all of your environments generally, or one per environment?
[2013-06-17 19:18:39 -0400] tabolario: obviously it would require a little bit of messing around to do a different one per environment
[2013-06-17 19:18:51 -0400] gkarekinian: Just make sure you're not using an old copy of a bootstrap template
[2013-06-17 19:19:12 -0400] gkarekinian: If it contains "encrypted_data_bag_secret" or you're using a default one you're safe
[2013-06-17 19:20:12 -0400] timsmith: works now
[2013-06-17 19:20:14 -0400] timsmith: thanks everyone
[2013-06-17 19:20:57 -0400] tabolario: great!
[2013-06-17 19:43:23 -0400] gems: Can anyone help me understand how to modify a role in dev, but avoid causing issues for it in prod?
[2013-06-17 19:46:35 -0400] DandyPandy: This sounds like a stupid question, but when I'm trying to upload a cookbook via knife, I'm getting "getaddrinfo: nodename nor servname provided, or not known (SocketError)". In my knife.rb, I have an IP for the address. Ideas?
[2013-06-17 19:47:56 -0400] DandyPandy: It's in the form https://ip_address/
[2013-06-17 19:49:21 -0400] jmartin: i am trying to create a wrapper cookbook and override an included recipe's attributes, but it seems to be ignoring my wrapper attributes entirely.
[2013-06-17 19:49:27 -0400] DandyPandy: nevermind. google to the rescue.
[2013-06-17 19:52:11 -0400] jgood: are there certain resources that do not work on windows clients?
[2013-06-17 19:52:40 -0400] gzc: yes indeedy
[2013-06-17 19:53:28 -0400] jgood: i'm guessing http_request is one of those
[2013-06-17 19:58:38 -0400] jgood: any way how i could easily get around that or will i just have to write my own script?
[2013-06-17 19:59:12 -0400] ianco: coderanger: im trying out the haproxy stuff, which is awesome, but im seeing a race condition me thinks
[2013-06-17 19:59:33 -0400] ianco: coderanger: any chance you have a sec to check something out
[2013-06-17 19:59:44 -0400] lazukars: I'm trying to install chef server on a centos box.  When I run the commands 'knife client list' on my local box, I get this error: Error connecting to http://my-server-ip-address/clients - Error connecting to https://my-server-internal-ip-address.ec2.internal/clients
[2013-06-17 20:00:16 -0400] lazukars: Someone mentioned that you have to change the host name, but I'm not sure what that exactly means.  Does it mean I have to add an entry in /etc/hosts?
[2013-06-17 20:01:20 -0400] coderanger: ianco: In about 15m
[2013-06-17 20:02:33 -0400] ianco: coderanger: cool!
[2013-06-17 20:05:03 -0400] DandyPandy: Anyone know when the omnibus installer will be updated to support installing on debian wheezy?
[2013-06-17 20:06:25 -0400] btm: @opscode no cookbook code review today (go bother @jtimberman at #velocityconf)
[2013-06-17 20:07:42 -0400] rava: hey guys, anyone using foodcritic ? can't find documentation on where to stick custom rules
[2013-06-17 20:11:42 -0400] lazukars: Can anyone help me out? :)
[2013-06-17 20:15:39 -0400] chef-user_43212: Hello there, I'm having trouble with a fresh install of chef-server and chef-client on 2 different machines. I'm trying to bootstrap a clean machine but it seems like knife bootstrap ignores the --bootstrap-version 11 and tries to install chef 10 which gives a Log leve must be one of xxxx error. Any ideas?
[2013-06-17 20:20:42 -0400] October: I'm working on getting Chef to push our code from svn to a smartos smart machine. do i need to create a full chef recipe for the smart machine (node w/ all modules) or can I start our with just pulling the code from svn to a local directory?
[2013-06-17 20:20:50 -0400] jgoodsen: when I try to regen an organization validation key, I'm getting "Organization not found. (Error 32033)"
[2013-06-17 20:21:06 -0400] jgoodsen: what's going on with that?
[2013-06-17 20:21:52 -0400] coderanger: DandyPandy: I think thats on hold until we can improve testing on the omnibus builds in general
[2013-06-17 20:22:19 -0400] coderanger: DandyPandy: The existing builds should work, but we don't want to expand our "official" support until we can actually verify it
[2013-06-17 20:23:11 -0400] ianco: coderanger: so, re: haproxyness
[2013-06-17 20:23:16 -0400] ianco: https://github.com/python/psf-chef/blob/master/cookbooks/psf-loadbalancer/recipes/haproxy.rb
[2013-06-17 20:23:40 -0400] ianco: the first include in your example would eventually lead to a haproxy start
[2013-06-17 20:24:03 -0400] ianco: which fails for me, due to not having run the second lwrp to create the actual config
[2013-06-17 20:24:28 -0400] ianco: eg: STDERR: [ALERT] 167/194332 (2971) : [/usr/sbin/haproxy.main()] No enabled listener found (check the <listen> keywords) ! Exiting.
[2013-06-17 20:24:50 -0400] ianco: coderanger: so, am i missing something or is that a race condition?
[2013-06-17 20:28:52 -0400] pwf: has anyone had problems with environments and the 'edit' page in chef 11?
[2013-06-17 20:29:11 -0400] pwf: environment seems to always be set to _default on the edit page of a node
[2013-06-17 20:29:21 -0400] pwf: it should default to the current environment for the node
[2013-06-17 20:29:41 -0400] pwf: e.g., node is in 'QA' environment on 'show' page, and '_default' on the 'edit' page
[2013-06-17 20:31:17 -0400] lazukars: @codranger:  Is there anyway you could help me?
[2013-06-17 20:31:37 -0400] AskSteve: webservers = search(:node, "role:web && environment:production") in a recipe returns 4 servers (all servers with role:web) - but knife search node "role:web && environment:production" returns 1 like it should any ideas?
[2013-06-17 20:31:43 -0400] coderanger: lazukars: Just ask your question
[2013-06-17 20:31:46 -0400] coderanger: ianco: Lookin
[2013-06-17 20:32:22 -0400] jessicab1: AskSteve: doesnt that need to be chef_environment instead? maybe knife just figures it out?
[2013-06-17 20:32:41 -0400] Otterley: depends on whether you've configured an attribute called "environment" or not
[2013-06-17 20:32:53 -0400] coderanger: ianco: So the signal from the haproxy_section resource to reload the haproxy instance is delayed, so it should happen at the end of the chef run
[2013-06-17 20:33:01 -0400] coderanger: ianco: Unless I'm missing something else
[2013-06-17 20:33:12 -0400] AskSteve: chef_environment also does not work
[2013-06-17 20:33:29 -0400] coderanger: pwf: Are your nodes resetting themselves?
[2013-06-17 20:33:34 -0400] Otterley: AskSteve, I didn't know && was an acceptable operator in solr syntax; I've always used "AND"
[2013-06-17 20:33:41 -0400] lazukars: @coderanger:  I did, above
[2013-06-17 20:33:48 -0400] coderanger: pwf: Some people incorrectly include the env name in client.rb, which causes each run to reset
[2013-06-17 20:34:01 -0400] lazukars: @coderanger: here's the error I'm getting: ERROR: Failed to authenticate to https://my-server-ip-adderes as lazukars with key /home/lazukars/Development/chef-repo/.chef/admin.pem Response:  Failed to authenticate as 'lazukars'. Ensure that your node_name and client key are correct.
[2013-06-17 20:34:20 -0400] coderanger: lazukars: And are your client name and key correct?
[2013-06-17 20:34:35 -0400] AskSteve: AND did the trick!  Thanks!!
[2013-06-17 20:35:00 -0400] pwf: coderanger: the environment stays just fine unless you visit the edit page and forget to switch it from '_default'
[2013-06-17 20:35:18 -0400] coderanger: pwf: Sigh, sounds like its a bug in the UI then
[2013-06-17 20:35:23 -0400] pwf: yup
[2013-06-17 20:35:24 -0400] lazukars: @coderanger: When I connect without https, I get this error Error connecting to http://my-server-ip-address/clients - Error connecting to https://my-server-internal-ip-address.ec2.internal/clients
[2013-06-17 20:35:27 -0400] Otterley: coderanger, is that documented behavior?  (the declaring an env in client.rb)
[2013-06-17 20:35:38 -0400] coderanger: pwf: The open source chef webui is kind of in limbo, we (opscode) no longer work on it
[2013-06-17 20:35:38 -0400] pwf: just wondering if anyone else is experiencing it before i report it
[2013-06-17 20:35:42 -0400] pwf: ooooh :/
[2013-06-17 20:35:49 -0400] lazukars: @coderanger: But you mentioned before you need to set up the correct hostname on the server. I'm using an ec2 instance, and not sure what you mean by that.
[2013-06-17 20:35:53 -0400] pwf: so i wouldn't even report it on the opscode jira
[2013-06-17 20:35:56 -0400] coderanger: pwf: We are happy to accept patches, but yeah
[2013-06-17 20:36:13 -0400] coderanger: pwf: You can report it, we just won't fix it unless someone offers a patch
[2013-06-17 20:36:22 -0400] pwf: :(
[2013-06-17 20:36:40 -0400] coderanger: lazukars: The error is unrelated to that, it is an authentication failure
[2013-06-17 20:37:04 -0400] coderanger: lazukars: Chef uses RSA signatures for API auth, and your username or signing key are wrong and so the API request is rejected
[2013-06-17 20:37:34 -0400] coderanger: pwf: Yeah, its still unclear how to proceed with it, my webdev team is entirely focussed on preview.opscode.com
[2013-06-17 20:37:40 -0400] lazukars: @coderanger: That's were I'm confused.  When I change the knife.rb file to the http://my-chef-server-ip ( not https ) authentication works fine.  I just get another error.
[2013-06-17 20:37:58 -0400] pwf: just wish i knew erlang
[2013-06-17 20:38:00 -0400] coderanger: lazukars: You get an error that happens before authentication :)
[2013-06-17 20:38:02 -0400] pwf: i guess i could learn...
[2013-06-17 20:38:05 -0400] coderanger: pwf: The ui is still Rails
[2013-06-17 20:38:12 -0400] coderanger: only the API service is Erlang
[2013-06-17 20:38:14 -0400] pwf: we may end up setting environment in client.rb like you mentioned
[2013-06-17 20:38:16 -0400] lazukars: @coderanger: which is this Error connecting to http://my-server-ip-address/clients - Error connecting to https://my-server-internal-ip-address.ec2.internal/clients
[2013-06-17 20:38:21 -0400] pwf: to stop people from accidentally messing with it
[2013-06-17 20:38:32 -0400] pwf: oh. well my ruby is pretty weak too :(
[2013-06-17 20:38:32 -0400] coderanger: lazukars: Yes, that redirect is happening before auth
[2013-06-17 20:38:44 -0400] lazukars: @codranger: gotcha
[2013-06-17 20:38:46 -0400] pwf: i will look at it though, if my users continue to complain
[2013-06-17 20:38:57 -0400] coderanger: pwf: Sorry, wish I had better news
[2013-06-17 20:39:07 -0400] pwf: np, it's not a showstopper
[2013-06-17 20:39:14 -0400] coderanger: pwf: You should definitely check out webui2 on preview.opscode.com though, its worlds better IMO
[2013-06-17 20:39:14 -0400] pwf: thanks for taking the time to inform me
[2013-06-17 20:39:23 -0400] coderanger: (granted its my project so I'm probably a tad biased :)
[2013-06-17 20:39:26 -0400] pwf: is that something i can install myself?
[2013-06-17 20:39:29 -0400] coderanger: No
[2013-06-17 20:39:37 -0400] coderanger: Hosted/Private Chef only
[2013-06-17 20:39:38 -0400] coderanger: :-/
[2013-06-17 20:39:41 -0400] pwf: :\
[2013-06-17 20:39:57 -0400] coderanger: (very dependent on multi-tennancy which isn't available in open-source Chef)
[2013-06-17 20:40:17 -0400] coderanger: Well, you can install Private Chef yourself, but non-free (which is what I would guess you meant too)
[2013-06-17 20:40:32 -0400] chef-user_43212: Hello there, I'm having trouble with a fresh install of chef-server and chef-client on 2 different machines. I'm trying to bootstrap a clean machine but it seems like knife bootstrap ignores the --bootstrap-version 11 and tries to install chef 10 which gives a Log leve must be one of xxxx error. Any ideas?
[2013-06-17 20:40:50 -0400] pwf: ah, right
[2013-06-17 20:41:22 -0400] jessicab1: chef-user_43212: using a custom bootstrap template?
[2013-06-17 20:42:25 -0400] coderanger: ianco: Yeah, not seeing a race condition per se, you just have to have a working HAProxy config before the run ends
[2013-06-17 20:42:43 -0400] ianco: coderanger, ok pardon
[2013-06-17 20:42:56 -0400] ianco: coderanger: thanks for looking though!
[2013-06-17 20:43:12 -0400] coderanger: ianco: As sections are added to the config it will just stack up the notifications (which are de-dup'd internally)
[2013-06-17 20:43:21 -0400] chef-user_43212: jessicab1: no :(
[2013-06-17 20:43:22 -0400] coderanger: and then at the very end it compiles the configs and restarts
[2013-06-17 20:44:13 -0400] coderanger: ianco: Related: haproxy can go to hell for not supporting an include-glob
[2013-06-17 20:44:24 -0400] ianco: yeah i just noticed that my config file exists, but is just empty
[2013-06-17 20:44:31 -0400] ianco: which is a me-problem
[2013-06-17 20:44:37 -0400] ianco: coderanger, hah, i agree
[2013-06-17 20:44:40 -0400] jessicab1: chef-user_43212: perhaps try not giving it a version? it should install 11 by default
[2013-06-17 20:44:51 -0400] ianco: i just read through mailing lists where the maintainers explained why
[2013-06-17 20:45:00 -0400] chef-user_43212: jessicab1: it installs 10.16.2 by default
[2013-06-17 20:45:04 -0400] chef-user_43212: it's really werid
[2013-06-17 20:45:05 -0400] coderanger: ianco: Its a not-very-good reason
[2013-06-17 20:45:35 -0400] coderanger: ianco: Basically they couldn't make it work in the most complex weird nested cases, so just having a top-level include statement was deemed impure
[2013-06-17 20:45:48 -0400] coderanger: ianco: That is called Bad Computering
[2013-06-17 20:46:09 -0400] ianco: haha
[2013-06-17 20:49:33 -0400] Otterley: I thought I saw a Chef cookbook that could help with this case
[2013-06-17 20:50:09 -0400] coderanger: Otterley: which case?
[2013-06-17 20:50:53 -0400] chef-user_43212: jessicab1: Just to let you know, I resolved it by installing with curl -L https://www.opscode.com/chef/install.sh | bash  on the target machine and then running knife boostrap again
[2013-06-17 20:52:03 -0400] pwf: coderanger: webui2 is stuck at 'Loading, please wait.'
[2013-06-17 20:52:14 -0400] pwf: chrome Version 27.0.1453.110
[2013-06-17 20:52:24 -0400] pwf: incognito though, if that makes a difference
[2013-06-17 20:53:17 -0400] coderanger: pwf: Do you use noscript?
[2013-06-17 20:54:55 -0400] Otterley: spheromak, what was that cookbook you mentioned last week that sysctl uses to construct config files from multiple cookbooks?
[2013-06-17 20:54:57 -0400] Otterley: or recipoes
[2013-06-17 20:56:36 -0400] pwf: coderanger: adblock, but no noscript
[2013-06-17 20:57:08 -0400] pwf: same thing with adblock disabled :/
[2013-06-17 20:57:09 -0400] coderanger: pwf: Could you open up the error console and see if there is anything visible there?
[2013-06-17 20:57:22 -0400] pwf: Refused to load 'https://d3bddmthcgqnqc.cloudfront.net/assets/locale/application_en-25e0bb5ecdcf5046a03a5a7d69df6b21.js' because it violates the following Content Security Policy directive: "script-nonce c25beb5e78edbee6510dc4e91aea3296".
[2013-06-17 20:57:24 -0400] coderanger: Not seeing any error reports from prod though
[2013-06-17 20:57:29 -0400] coderanger: Hah!
[2013-06-17 20:57:34 -0400] coderanger: Go Chrome :(
[2013-06-17 20:58:01 -0400] coderanger: When I added that security directive it didn't actually support it yet so it was a no-op
[2013-06-17 20:58:06 -0400] coderanger: should be easy enough to fix
[2013-06-17 20:58:16 -0400] coderanger: thanky
[2013-06-17 20:58:19 -0400] pwf: cool, np
[2013-06-17 20:58:32 -0400] coderanger: Now to check the chrome changelog and see when that went live
[2013-06-17 21:09:07 -0400] idlemichael: after a fresh chef-server install from these instructions: http://docs.opscode.com/install_server.html -- I cannot access the webui. I only got to step 7 before I tried.
[2013-06-17 21:10:54 -0400] rust: Does anyone have tips with using application_ruby with rvm? I seem to have quite a few problems. I am really new at this so I could be missing something obvious
[2013-06-17 21:11:55 -0400] coderanger: rust: I would wager there is a near 100% chance of that not working very well :)
[2013-06-17 21:14:31 -0400] coderanger: pwf: Hmm, are you super sure you aren't on a beta-channel Chrome build?
[2013-06-17 21:14:50 -0400] pwf: i linked the exact version, i don't think i'm on beta
[2013-06-17 21:15:04 -0400] rust: @coderanger: Yeah, it is driving me crazy. The cookbook finishes, but it is definitely not working correctly.
[2013-06-17 21:15:44 -0400] coderanger: pwf: Internets are hard :-(
[2013-06-17 21:15:55 -0400] pwf: word
[2013-06-17 21:16:04 -0400] pwf: would it have something to do with network policies here...?
[2013-06-17 21:16:12 -0400] pwf: OSX also, if that makes a difference
[2013-06-17 21:19:45 -0400] coderanger: pwf: Hmm, can you check what value you see for X-WebKit-CSP if it isn't too much trouble?
[2013-06-17 21:27:00 -0400] pwf: coderanger: X-WebKit-CSP:default-src 'self' https://d3bddmthcgqnqc.cloudfront.net:443 chrome-extension:; connect-src 'self' chrome-extension:; font-src 'self' https://d3bddmthcgqnqc.cloudfront.net:443 chrome-extension:; frame-src 'none' chrome-extension:; img-src 'self' https://d3bddmthcgqnqc.cloudfront.net:443 https://sentry.opscode.com:443 chrome-extension: data:; media-src 'none' chrome-extension:; object-src 'none' chrome-extension:; script-src 'self' https://
[2013-06-17 21:27:39 -0400] coderanger: Weird, is it really"script-src 'self' https://" or was that IRC cutting off?
[2013-06-17 21:27:47 -0400] coderanger: That would definitely break things
[2013-06-17 21:36:36 -0400] tabolario: coderanger: that looks sort of right
[2013-06-17 21:36:46 -0400] tabolario: isn't it supposed to be https://* though?
[2013-06-17 21:36:46 -0400] coderanger: tabolario: Hmm?
[2013-06-17 21:37:03 -0400] coderanger: No, its supposed to be long cloudfront URL like the others :)
[2013-06-17 21:37:19 -0400] coderanger: Looks like it is getting cut off
[2013-06-17 21:37:44 -0400] tabolario: ohh gotcha
[2013-06-17 21:37:54 -0400] tabolario: ah i see what you mean now
[2013-06-17 21:38:13 -0400] tabolario: don't mind me
[2013-06-17 21:49:08 -0400] pwf: coderanger: script-src 'self' https://d3bddmthcgqnqc.cloudfront.net:443 'unsafe-inline' chrome-extension:; style-src 'self' https://d3bddmthcgqnqc.cloudfront.net:443 'unsafe-inline' chrome-extension:; script-nonce 29d5e9eb54c49a612fbbbf744f3ad1b4;
[2013-06-17 21:49:15 -0400] pwf: sorry, it was irc cutting itoff
[2013-06-17 21:49:23 -0400] coderanger: pwf: Okay, thats a little less weird :-)
[2013-06-17 21:49:27 -0400] pwf: not sure how to set irssi auto-wrap, or what the value is for my servers
[2013-06-17 21:56:10 -0400] jmartin: when writing a wrapper cookbook, what is the best way to modify a template and its notifies line? my google-fu seems to be failing
[2013-06-17 22:02:28 -0400] siezer: wrapper cookbooks should really be setting/overriding attributes and doing include_recipes with MAYBE the occasional resource def.
[2013-06-17 22:03:02 -0400] siezer: reaching into the resource collection with and modifying items is a scary hack
[2013-06-17 22:03:03 -0400] siezer: but
[2013-06-17 22:03:13 -0400] siezer: chef_rewind is what you're looking for
[2013-06-17 22:03:39 -0400] jmartin: interesting
[2013-06-17 22:03:52 -0400] siezer: best thing to do would b to fork the cookbook you're using, edit it to be attribute driven, and use that (submitting patches upstream of course)
[2013-06-17 22:04:23 -0400] siezer: ^^ all that IMHO of course
[2013-06-17 22:07:30 -0400] webbower: how do I use `package` to install an RPM? I'm trying to install MySQL 5.5 from an RPM I downloaded from the MySQL site. It doesn't like `package "mysql" do source "relative/path/to/mysql.rpm"; action :install; end
[2013-06-17 22:07:57 -0400] siezer: webbower try rpm_package
[2013-06-17 22:07:57 -0400] coderanger: webbower: relative path to what?
[2013-06-17 22:08:08 -0400] webbower: relative to the cookbook I'm running in
[2013-06-17 22:08:09 -0400] siezer: and /full/path
[2013-06-17 22:08:22 -0400] coderanger: webbower: Ahh, you need to use a cookbook_file resource
[2013-06-17 22:08:23 -0400] siezer: don't stuff large binary files into cookbooks
[2013-06-17 22:08:34 -0400] webbower: ok
[2013-06-17 22:08:35 -0400] coderanger: or better yet, put it into a yum repo
[2013-06-17 22:08:38 -0400] siezer: host it on an http server somewhere and use remote_file
[2013-06-17 22:08:40 -0400] webbower: where should I stuff an RPM?
[2013-06-17 22:08:54 -0400] webbower: I have <project>/cookbooks/my-cookbook
[2013-06-17 22:09:03 -0400] coderanger: webbower: a S3 private bucket + yum's createrepo is an easy option
[2013-06-17 22:09:12 -0400] webbower: let's call that step 2
[2013-06-17 22:09:16 -0400] siezer: haha
[2013-06-17 22:09:25 -0400] webbower: how do I properly reference it to install from a local file?
[2013-06-17 22:09:43 -0400] webbower: Since yum doesn't seem to have mysql 5.5 available
[2013-06-17 22:10:04 -0400] idlemichael: are there any current guides on how to install chef-server, and the issues you may run into? opscode.com/chef/install is pretty minimal
[2013-06-17 22:10:16 -0400] idlemichael: compared to the 10.x documentation
[2013-06-17 22:10:16 -0400] coderanger: webbower: cookbook_file "/root/mysql.rpm" do source "mysql.rpm"; end
[2013-06-17 22:10:17 -0400] idlemichael: :<
[2013-06-17 22:10:20 -0400] siezer: for a local file, try rpm_package source "/full/path/on/filesystem"
[2013-06-17 22:10:33 -0400] coderanger: webbower: and then put the file in <project>/cookbooks/my-cookbook/files/default/mysql.rpm
[2013-06-17 22:10:50 -0400] coderanger: webbower: and then package "mysql" do source "/root/mysql.rpm" end
[2013-06-17 22:11:22 -0400] coderanger: idlemichael: http://docs.opscode.com/install_server.html
[2013-06-17 22:11:59 -0400] webbower: actually, first, I'm Linux n00b. Is there a way to get Yum on a CentOS 6.4 to discover MySQL 5.5 and save me the hassle of building from source?
[2013-06-17 22:12:48 -0400] idlemichael: ah coderanger, i think the workstation doc is what i was missing
[2013-06-17 22:13:21 -0400] coderanger: webbower: You would have to look through popular repos, I'm not a centos user though so I don't know off hand
[2013-06-17 22:14:07 -0400] siezer: webbower a centos repo is easy
[2013-06-17 22:15:00 -0400] siezer: try this https://www.gurulabs.com/goodies/guru-guides/YUM-automatic-local-mirror/
[2013-06-17 22:15:23 -0400] siezer: but really its just a directory being served by a webserver full of rpms
[2013-06-17 22:15:30 -0400] siezer: and an index file that you make with createrepo
[2013-06-17 22:15:51 -0400] webbower: Sure. So I should be able to have it discover another repo that would have mysql 5.5, right?
[2013-06-17 22:16:02 -0400] siezer: that's ideal
[2013-06-17 22:16:20 -0400] bluepojo: How can I fetch the raw value from a Chef::Node::Attribute instance for a node attribute without specifying the precedence level at which it was set?
[2013-06-17 22:16:47 -0400] siezer: but. the alternative design pattern is remote_file, the a local rpm_package
[2013-06-17 22:16:52 -0400] siezer: bluepojo what
[2013-06-17 22:16:56 -0400] bluepojo: for example, I have a key foo set to a string at the default level, I can get the raw value by saying node.default['foo'] and get a string back
[2013-06-17 22:17:13 -0400] bluepojo: if I say node['foo'], I get a Attribute object
[2013-06-17 22:17:14 -0400] webbower: So how might I go about doing that? I assume it involves finding a repo that lists mysql 5.5 and adding it to my yum repo list?
[2013-06-17 22:17:17 -0400] siezer: just node['foo']
[2013-06-17 22:17:25 -0400] siezer: um
[2013-06-17 22:17:28 -0400] siezer: whats weird
[2013-06-17 22:17:31 -0400] siezer: er, thats
[2013-06-17 22:17:41 -0400] bluepojo: I agree
[2013-06-17 22:17:51 -0400] coderanger: bluepojo: You can't
[2013-06-17 22:18:01 -0400] coderanger: Thats how nested lookups are implemented
[2013-06-17 22:18:12 -0400] coderanger: it should have all the correct methods though
[2013-06-17 22:18:15 -0400] bluepojo: hm... is there anyway for me to say "do the lookup and give me the raw object"?
[2013-06-17 22:18:24 -0400] bluepojo: the problem I'm having
[2013-06-17 22:18:32 -0400] coderanger: No? why do you need to raw object
[2013-06-17 22:18:45 -0400] bluepojo: is I want to concat an attribute to another attribute that contains an array
[2013-06-17 22:18:53 -0400] bluepojo: so it looks like
[2013-06-17 22:19:13 -0400] bluepojo: node.normal['foo'] = node['foo'] | [node['bar]]
[2013-06-17 22:19:31 -0400] coderanger: Obligatory: Don't use arrays in chef attrs https://coderanger.net/2013/06/arrays-and-chef
[2013-06-17 22:19:38 -0400] bluepojo: oh...
[2013-06-17 22:19:53 -0400] coderanger: But that should be possible
[2013-06-17 22:20:05 -0400] coderanger: you may just need an extra to_s on node['bar']
[2013-06-17 22:20:05 -0400] Otterley: hey, I use them
[2013-06-17 22:20:11 -0400] bluepojo: that's exactly the problem
[2013-06-17 22:20:16 -0400] bluepojo: Attribute#to_s
[2013-06-17 22:20:20 -0400] bluepojo: outputs #inspect
[2013-06-17 22:20:23 -0400] bluepojo: not the raw object
[2013-06-17 22:20:27 -0400] bluepojo: so I get in my array
[2013-06-17 22:20:27 -0400] coderanger: Hrmmm
[2013-06-17 22:20:40 -0400] bluepojo: ['foo', '#<Attribute:somehash>']
[2013-06-17 22:20:49 -0400] asharp: can i use a file on the host as a source for a cookbook file?
[2013-06-17 22:20:59 -0400] bluepojo: hence I want the raw object so I can put it in the array
[2013-06-17 22:21:08 -0400] siezer: hash all the things
[2013-06-17 22:21:35 -0400] coderanger: bluepojo: Trying to decode https://github.com/opscode/chef/blob/master/lib/chef/node/attribute.rb#L353-L366
[2013-06-17 22:21:46 -0400] coderanger: asharp: No, that would just be a file resource
[2013-06-17 22:22:24 -0400] asharp: coderanger: so i could use a host's file as the source of a file resource?
[2013-06-17 22:22:34 -0400] coderanger: asharp: You can use its content, sure
[2013-06-17 22:22:50 -0400] coderanger: bluepojo: to_s is indeed not delegated
[2013-06-17 22:23:04 -0400] coderanger: bluepojo: Try to_hash
[2013-06-17 22:23:14 -0400] bluepojo: that gives back an empty hash for a string value
[2013-06-17 22:23:15 -0400] asharp: coderanger: so i'd have to copy its content and put that in a string in the resource declaration?
[2013-06-17 22:23:24 -0400] asharp: coderanger: it's a binary file
[2013-06-17 22:23:48 -0400] coderanger: asharp: file "/foo" do content ::File.read('/bar', 'rb')
[2013-06-17 22:24:03 -0400] asharp: coderanger: alright i'll look into that thanks
[2013-06-17 22:24:04 -0400] bluepojo: coderanger: hilariously, this works nicely: node['riot_mysql'].to_hash['dba_group']
[2013-06-17 22:24:06 -0400] bluepojo: that'll work
[2013-06-17 22:24:50 -0400] coderanger: bluepojo: I'm confused about what kind of value is in that slot, but if it works :-)
[2013-06-17 22:24:56 -0400] bluepojo: it's the name of the user group
[2013-06-17 22:25:06 -0400] coderanger: So it isn't a nested lookup?
[2013-06-17 22:25:06 -0400] bluepojo: for dba user accounts
[2013-06-17 22:25:20 -0400] Otterley: This sounds baroque.  I wonder why you're having to do this; we've never run into this case
[2013-06-17 22:25:25 -0400] coderanger: Hmm, possible my understanding of this code is out of date since the chef 11 changes
[2013-06-17 22:25:28 -0400] bluepojo: that needs to be added to the list of sudoers
[2013-06-17 22:25:38 -0400] webbower: If I'm installing from an RPM, what is "name" supposed to be in package "name"?
[2013-06-17 22:25:51 -0400] webbower: How does it relate to the filename of the RPM
[2013-06-17 22:25:52 -0400] coderanger: when you hit a terminal value in the tree it should be just the plain object I thought
[2013-06-17 22:26:06 -0400] Otterley: coderanger, that's been my experience as well, hence my question
[2013-06-17 22:26:06 -0400] coderanger: webbower: it is the name of the RPM, this is not related to the filename
[2013-06-17 22:26:25 -0400] webbower: How do I determine the name of the RPM?
[2013-06-17 22:26:41 -0400] coderanger: webbower: use rpm -q
[2013-06-17 22:26:43 -0400] bluepojo: coderanger: https://gist.github.com/bluepojo/800597d907e9e9c93fad
[2013-06-17 22:26:43 -0400] Otterley: webbower, are you installing the RPM from the filesystem, or via yum?
[2013-06-17 22:26:58 -0400] webbower: filesystem. Yum doesn't see the version of the package I need
[2013-06-17 22:27:14 -0400] bluepojo: this is Chef 10.24, btw.
[2013-06-17 22:27:23 -0400] ssd7: Ohai Chefs
[2013-06-17 22:27:24 -0400] webbower: coderanger: let's assume the RPM is on a Mac
[2013-06-17 22:27:31 -0400] webbower: because it is
[2013-06-17 22:27:38 -0400] webbower: and I don't have the rpm rool
[2013-06-17 22:27:40 -0400] webbower: *too
[2013-06-17 22:27:43 -0400] webbower: *tool
[2013-06-17 22:27:56 -0400] coderanger: webbower: You need a system with rpm, I would spin up a VM and check :-) or look in the docs where you downloaded the RPM
[2013-06-17 22:27:59 -0400] Otterley: bluepojo, this is the correct output when running in shef
[2013-06-17 22:28:25 -0400] Otterley: when a recipe or template actually uses it, however, it Should Work()
[2013-06-17 22:28:30 -0400] webbower: Or I'll just install the rpm tool with MacPorts (ya, I know, who still uses MacPorts)
[2013-06-17 22:28:40 -0400] coderanger: bluepojo: Aha, thats a horse of a different color :-)
[2013-06-17 22:28:58 -0400] coderanger: bluepojo: If that trick works, go for it, but I would check how it behaves on chef 11
[2013-06-17 22:29:05 -0400] bluepojo: Otterley: when I concat a Node::Attribute on to an array of strings, it turns into '#<Attribute>'
[2013-06-17 22:29:17 -0400] siezer: don't try and install an rpm on any other system than the one it was intended for
[2013-06-17 22:29:38 -0400] coderanger: siezer: Yeah, he just needs the name field from the metadata
[2013-06-17 22:29:42 -0400] coderanger: I think thats -q
[2013-06-17 22:29:45 -0400] coderanger: its been a long time though
[2013-06-17 22:29:58 -0400] siezer: rpm -qa # to list
[2013-06-17 22:30:06 -0400] bluepojo: coderanger: thanks for the explanation, at least I have a better understanding of what's going on now
[2013-06-17 22:30:09 -0400] siezer: rpm -qa | grep whatever # see if whatever is installed
[2013-06-17 22:30:23 -0400] Otterley: Does the package resource even understand how to install rpms from the filesystem?
[2013-06-17 22:30:30 -0400] coderanger: siezer: Thats not helpful
[2013-06-17 22:30:50 -0400] coderanger: siezer: Given an rpm file, you need the name of _that rpm_ to give to the package resoruce :-)
[2013-06-17 22:30:56 -0400] coderanger: Otterley: Yep
[2013-06-17 22:31:02 -0400] siezer: oh.
[2013-06-17 22:31:19 -0400] siezer: groked the backscroll wrong
[2013-06-17 22:31:29 -0400] ssd7: webbower: Not completely caught up on backscroll, but homebrew has rpm2cpio (maybe macport does too).  I've used that with cpio to rip open rpms on non-rpm systems
[2013-06-17 22:31:31 -0400] coderanger: siezer: Too many conversations at once :-)
[2013-06-17 22:31:34 -0400] Otterley: then: rpm -qif <file>
[2013-06-17 22:31:52 -0400] coderanger: Yeah, qif sounds right :-)
[2013-06-17 22:32:04 -0400] webbower: No Homebrew
[2013-06-17 22:32:08 -0400] webbower: just MacPorts
[2013-06-17 22:32:13 -0400] webbower: Installing rpm from MacPorts
[2013-06-17 22:33:38 -0400] Otterley: webbower, are you trying to actually install said RPM on the Mac itself?
[2013-06-17 22:33:57 -0400] coderanger: No
[2013-06-17 22:34:04 -0400] coderanger: He just needs to get the name of the RPM
[2013-06-17 22:34:17 -0400] coderanger: since even for local installs, chef uses the name value to check if it is installed
[2013-06-17 22:34:25 -0400] Otterley: ah, ok.  he can, of course, also query it on the target system without bothering to install RPM on the Mac
[2013-06-17 22:34:46 -0400] coderanger: Yeah, I would just use a testing VM
[2013-06-17 22:35:09 -0400] coderanger: But whatevs :-) Granted I would probably just unpack the RPM and read the control file
[2013-06-17 22:35:18 -0400] siezer: wait what
[2013-06-17 22:36:02 -0400] Otterley: rpm -qif is probably less hairy :)
[2013-06-17 22:37:11 -0400] miah: ya, rpm -qa queries _all_ rpm's on the system. which is fine if you only have a clue about the name of a package. but if you _know_ the name then rpm -qif is perfect.
[2013-06-17 22:38:22 -0400] coderanger: Or if you have the file
[2013-06-17 22:39:28 -0400] webbower: Otterly no. Just pulling metadata from it
[2013-06-17 22:39:56 -0400] miah: well, you _have_ to have the rpm file if you're doing qif
[2013-06-17 22:40:04 -0400] miah: if you want to just query the rpm db then drop the 'f'
[2013-06-17 22:40:32 -0400] webbower: fuck it. I'm going back to Ubuntu
[2013-06-17 22:40:42 -0400] miah: heh
[2013-06-17 22:40:52 -0400] miah: just install 'rpm2cpio' or 'fpm' =)
[2013-06-17 22:40:57 -0400] webbower: There seems to be better Ubuntu/Deb support in Chef
[2013-06-17 22:41:23 -0400] miah: i think thats mostly because RHEL shops tend to be 'closed source' types of organizations so you see less code sharing come out of them naturally (of course this is an assumption)
[2013-06-17 22:42:25 -0400] webbower: perhaps so. I'm also waaaaay novice with Linux so if it's not in one of the package managers, I'm up the creek. Pair that with learning Vagrant/Chef and it makes things a little limiting
[2013-06-17 22:42:31 -0400] Otterley: I dunno, I don't want to get into a distro war but I do like RHEL because (a) they guarantee binary compatibility across major dot-rev releases, and (b) my hardware vendor has Tier-1 support for it
[2013-06-17 22:42:49 -0400] coderanger: EVERYONE SHOULD USE SMARTOS
[2013-06-17 22:42:53 -0400] Otterley: s/major/minor/
[2013-06-17 22:42:59 -0400] coderanger: Sorry, channeling jtimberman for a second there
[2013-06-17 22:43:21 -0400] Otterley: that said, we are using Ubuntu and eking by
[2013-06-17 22:43:44 -0400] Otterley: I'm not super thrilled about the amount of yak shaving I have to do with it though
[2013-06-17 22:44:12 -0400] miah: this is why i have the opinion that most linux distributions used today are somewhat fail when it comes to configuration management.
[2013-06-17 22:44:32 -0400] coderanger: miah: s/somewhat/oh god what were you thinking/
[2013-06-17 22:44:42 -0400] Otterley: yeah, they all suck - you just have to find the one that sucks the least for your use case
[2013-06-17 22:45:04 -0400] coderanger: I have this eternal long term plan to build an Ubuntu mirror that processes all packages are removes all pre/post hooks and all files from /etc
[2013-06-17 22:45:16 -0400] coderanger: sysbuntu or something
[2013-06-17 22:45:22 -0400] Otterley: can we get rid of upstart while we're at it?
[2013-06-17 22:45:37 -0400] coderanger: Otterley: Thats files in /etc, so would not be present :-)
[2013-06-17 22:45:44 -0400] Otterley: nice.
[2013-06-17 22:45:44 -0400] coderanger: or at least the configs wouldn't be
[2013-06-17 22:45:53 -0400] coderanger: I suppose upstart itself would be, but whatevs
[2013-06-17 22:46:23 -0400] Otterley: I had 99 problems with servers, but boot times weren't one of them
[2013-06-17 22:47:09 -0400] miah: srsly. boot time.. something i'm concerned with every now and then. and usually fdisk fucks any 'speed boost' your initsystem is going to give you anyways.
[2013-06-17 22:47:14 -0400] rafaelmagu: Hi guys
[2013-06-17 22:47:18 -0400] rafaelmagu: And girls
[2013-06-17 22:47:30 -0400] Otterley: miah, not only that, but my BIOS/firmware initialization takes more time than booting the kernel and userland
[2013-06-17 22:47:35 -0400] rafaelmagu: I'm having an issue with the recently-updated statsd cookbook from hectcastro
[2013-06-17 22:47:40 -0400] miah: "your filesystem has not been checked in 3287 days, prepare to watch a progress bar for 8 hours"
[2013-06-17 22:47:45 -0400] rafaelmagu: resource git[/usr/share/statsd] is configured to notify resource runit_service[statsd] with action restart, but runit_service[statsd] cannot be found in the resource collection
[2013-06-17 22:47:51 -0400] coderanger: miah: lmao if you don't use ephemeral disks
[2013-06-17 22:47:55 -0400] Otterley: miah, we're on XFS, that problem is solved for us now
[2013-06-17 22:47:59 -0400] miah: coderanger: oh. i do =)
[2013-06-17 22:48:07 -0400] rafaelmagu: But just before the git[...] resource, there is a block defining the runit_service
[2013-06-17 22:48:22 -0400] rafaelmagu: And include_recipe "runit" is sitting at the top of the recipe
[2013-06-17 22:48:34 -0400] coderanger: miah: http://xkcd.com/869/ except for mount
[2013-06-17 22:48:52 -0400] rafaelmagu: I understand runit_service is a custom service that is not provided by Chef itself
[2013-06-17 22:48:54 -0400] Otterley: rafaelmagu, can you gist/pastebin the relevant recipe?
[2013-06-17 22:49:00 -0400] rafaelmagu: Sure, gholdon
[2013-06-17 22:49:46 -0400] miah: coderanger: yup
[2013-06-17 22:49:52 -0400] rafaelmagu: Otterley: https://github.com/rafaelmagu/chef-statsd/blob/master/recipes/default.rb
[2013-06-17 22:50:25 -0400] rafaelmagu: Otterley: the above is my first attempt at fixing this issue. The original one is here: https://github.com/hectcastro/chef-statsd/blob/master/recipes/default.rb
[2013-06-17 22:50:34 -0400] coderanger: miah: Also because of that comic I now imagine all servers talking in the same voice as Randy the Bandicoot from QC
[2013-06-17 22:53:45 -0400] Otterley: seems right, rafaelmagu - BTW did you put a depends "runit" in the metadata.rb for the cookbook?
[2013-06-17 22:53:58 -0400] rafaelmagu: That's probably what it is
[2013-06-17 23:04:54 -0400] rafaelmagu: Otterley: didn't seem to fix it
[2013-06-17 23:10:53 -0400] Otterley: rafaelmagu, I'm as puzzled as you
[2013-06-17 23:11:00 -0400] rafaelmagu: It's the strangest thing
[2013-06-17 23:11:07 -0400] rafaelmagu: Chef 10
[2013-06-17 23:11:27 -0400] rafaelmagu: Does Chef 10 support custom services? I don't remember using them
[2013-06-17 23:11:33 -0400] Otterley: sure
[2013-06-17 23:11:40 -0400] rafaelmagu: Ok
[2013-06-17 23:12:22 -0400] rafaelmagu: I'm at a loss, then
[2013-06-17 23:17:21 -0400] rpcesar: is there a generally accepted process or cookbook in place for transmitting or working with hosts files?
[2013-06-17 23:18:06 -0400] Otterley: rpcesar, we use DNS nowadays, but before, we used search as a source of truth to build them, much like we do with ssh known_hosts files
[2013-06-17 23:18:34 -0400] Otterley: I assume there's a cookbook out there to build them
[2013-06-17 23:23:12 -0400] rpcesar: ok, so the general practice then, assuming not running a private DNS, is to build them on the client based on interaction with chef (i was actually about to simply have it copy around a file)
[2013-06-17 23:24:59 -0400] spicy: yeah, if you are using hosts then i think most people do it via search
[2013-06-17 23:25:12 -0400] spicy: you can do a combination of both if you have non-chef nodes you need in there too by templating
[2013-06-17 23:25:45 -0400] siezer: rpcesar use seth vargo's hostsfile from the community site
[2013-06-17 23:25:51 -0400] siezer: knife cookbook site download hostsfile
[2013-06-17 23:26:24 -0400] rpcesar: thanks siezer
[2013-06-17 23:27:36 -0400] siezer: or this: https://github.com/someara/hosts-cookbook/blob/master/recipes/default.rb
[2013-06-17 23:32:50 -0400] miketheman: did someone ever post anything on tracing where an attribute was set, either in shef/chef-shell or otherwise?
[2013-06-17 23:33:00 -0400] miketheman: been googling for a bit
[2013-06-17 23:33:10 -0400] miketheman: found http://tickets.opscode.com/browse/CHEF-2913
[2013-06-17 23:33:47 -0400] miah: yay attributes =)
[2013-06-17 23:34:20 -0400] miketheman: miah: hatersz gonna hate. :)
[2013-06-17 23:34:36 -0400] miah: global variables for fun and profit!
[2013-06-17 23:34:39 -0400] miketheman: it's all about disentangling the mess I inherited, you know.
[2013-06-17 23:34:43 -0400] miah: ya
[2013-06-17 23:34:56 -0400] miah: https://www.youtube.com/watch?v=YJLTn10E0OY
[2013-06-17 23:34:59 -0400] miah: will make it all better
[2013-06-17 23:36:06 -0400] miketheman: sweet ride
[2013-06-17 23:37:18 -0400] miketheman: cool riff too
[2013-06-17 23:38:06 -0400] miketheman: miah: do you ride?
[2013-06-17 23:38:09 -0400] miketheman: I used to
[2013-06-17 23:39:25 -0400] miah: nope
[2013-06-17 23:39:34 -0400] miah: i never got into riding on the road
[2013-06-17 23:39:39 -0400] ssd7: miketheman: So I have a very very hacking, probably broken from bit-rot, CHef 10-only knife plugin that kinda does attribute tracing
[2013-06-17 23:39:55 -0400] ssd7: but it likely doesn't work well on the "wrapper" cookbooks all the cool kids use now
[2013-06-17 23:39:59 -0400] miketheman: ssd7: sounds like I should run that in prod on every server I have
[2013-06-17 23:40:07 -0400] miketheman: eff the cool kids.
[2013-06-17 23:40:16 -0400] miketheman: I use roles and environments, and like them, dammit.
[2013-06-17 23:40:22 -0400] miketheman: oh, and stay offa my lawn!
[2013-06-17 23:40:47 -0400] ssd7: miketheman: https://github.com/stevendanna/knife-hacks/blob/master/plugins/node_attribute_explain.rb <- Anyway, I ripped the gus out of the old core chef code, stuck it in a plugin and then tracked changes along the way
[2013-06-17 23:40:50 -0400] miketheman: ssd7: so nobody's solved the "which levels set this attribute and where" during compile time?
[2013-06-17 23:41:54 -0400] ssd7: miketheman: If you are only looking for levels
[2013-06-17 23:42:02 -0400] ssd7: I think there is a function for that now
[2013-06-17 23:42:08 -0400] ssd7: but the "where" isn't solved
[2013-06-17 23:42:36 -0400] ssd7: https://github.com/opscode/chef/blob/master/lib/chef/node/attribute.rb#L223
[2013-06-17 23:42:58 -0400] miah: grep over all your cookbooks code?
[2013-06-17 23:43:13 -0400] ssd7: Usually debug_value is enough to get me down the correct path
[2013-06-17 23:43:34 -0400] ssd7: For my own cookbooks, I just grep since I stay away from "holy cow indirection" designs
[2013-06-17 23:44:08 -0400] miketheman: yeah, I'm finding that there's a certain amount of chaos that I'm dealing with
[2013-06-17 23:44:38 -0400] ssd7: indeed, that was hyperbole too.  Occasionally I find myself looking at my cookbooks chanting "You are not your code, it's ok"
[2013-06-17 23:45:08 -0400] miketheman: ha
[2013-06-17 23:45:17 -0400] miketheman: so where do you add your debug_value?
[2013-06-17 23:46:18 -0400] ssd7: miketheman: Typically right before the place that I am using it and it is breaking.  Either in a ruby_block or not depending on whether it is a compile time or converge time thing
[2013-06-17 23:47:31 -0400] miketheman: hm.
[2013-06-17 23:47:40 -0400] miketheman: it's a compile time thing
[2013-06-17 23:51:55 -0400] miketheman: ssd7, miah: I think I nailed it to a cookbook not being uploaded to the server. fml
[2013-06-17 23:55:09 -0400] Otterley: doesn't chef throw up at startup if it can't find a cookbook?
[2013-06-17 23:55:19 -0400] Otterley: chef-client does, anyway
