[2013-06-19 00:05:51 -0400] coderanger: Majost: That certainly helps
[2013-06-19 00:06:05 -0400] coderanger: derks: No
[2013-06-19 00:06:22 -0400] coderanger: derks: You can do something like "return if node[:notxxx]" at the top of that recipe though
[2013-06-19 00:06:26 -0400] coderanger: and then set that override
[2013-06-19 00:06:31 -0400] coderanger: That gets super messy though
[2013-06-19 00:06:32 -0400] derks: right on
[2013-06-19 00:06:41 -0400] derks: yeah, that is what i was avoiding
[2013-06-19 00:06:51 -0400] coderanger: "return" at the top level of a recipe file will just stop processing on that file and move on
[2013-06-19 00:07:08 -0400] derks: in this case, that should be fine... but i know its not idea
[2013-06-19 00:07:12 -0400] derks: ideal*
[2013-06-19 00:07:16 -0400] derks: thanks though
[2013-06-19 00:07:19 -0400] coderanger: :-)
[2013-06-19 00:07:48 -0400] coderanger: Just can lead to unexpected behavior "why isn't this installed?"
[2013-06-19 00:08:08 -0400] derks: i'm a python guy... my ruby is week.  what is the best way to say "if node.has_role?('some_role')"?
[2013-06-19 00:09:58 -0400] coderanger: if node['roles'].include?('some_role')
[2013-06-19 00:10:00 -0400] bluepojo: derks: node.role?("some_role")
[2013-06-19 00:10:05 -0400] derks: perfect
[2013-06-19 00:10:13 -0400] coderanger: role? will not handle recursive expansion
[2013-06-19 00:10:29 -0400] bluepojo: wow, how useful
[2013-06-19 00:10:50 -0400] derks: coderanger, should I do a search(:node, 'role:that_role') and then just filter that way?
[2013-06-19 00:10:59 -0400] coderanger: derks: No, use what I posted
[2013-06-19 00:11:22 -0400] derks: oh, sorry just saw that
[2013-06-19 00:11:26 -0400] coderanger: node['roles'] is an array of all roles including recursively expanded ones on the current node
[2013-06-19 00:11:35 -0400] coderanger: and Array#include? == in
[2013-06-19 00:11:45 -0400] Otterley: I'd suggest predicating on a node attribute rather than what roles it's in
[2013-06-19 00:11:52 -0400] coderanger: Yeah, thats probably better
[2013-06-19 00:12:19 -0400] coderanger: Using specific role names in recipes can get ugly, usually better to use node attrs
[2013-06-19 00:12:20 -0400] Otterley: i.e. put a feature flag attribute in the role definition
[2013-06-19 00:12:26 -0400] coderanger: ^^ what he said :)
[2013-06-19 00:12:51 -0400] Otterley: that say you don't encounter unexpected surprises if you change a role name (which happens more often than you might think)
[2013-06-19 00:15:08 -0400] coderanger: Its also handy when you realize you need a second role that also disables this thang
[2013-06-19 00:15:14 -0400] Otterley: aye
[2013-06-19 00:17:38 -0400] Otterley: who wants to work with me on a Chef Best Practices guide?
[2013-06-19 00:17:40 -0400] Otterley: :)
[2013-06-19 00:17:54 -0400] bluepojo: Can I write the part about why roles are bad?
[2013-06-19 00:18:00 -0400] bluepojo: :D
[2013-06-19 00:18:40 -0400] Otterley: sure, if I can write the part about why roles are good :D
[2013-06-19 00:18:55 -0400] awgross: Otterley: I have some input for that
[2013-06-19 00:24:37 -0400] bluepojo: Otterley: I'll be interested in reading it
[2013-06-19 00:25:05 -0400] bluepojo: once you're finished
[2013-06-19 00:26:02 -0400] Otterley: I'll work on it in my infinite spare time :)
[2013-06-19 00:26:28 -0400] coderanger: If anyone wants an earful about why you should be writing resources for everything I'll be at velocity and devopsdays :)
[2013-06-19 00:26:38 -0400] coderanger: Because seriously, stop writing recipes (mostly)
[2013-06-19 00:26:51 -0400] Otterley: I'll be there, picking on you ;)
[2013-06-19 00:28:10 -0400] coderanger: hopefully some Riot folks will be there, me + reset + bryanwb + fnichol == Chef voltron of crazy ideas
[2013-06-19 00:28:50 -0400] Otterley: I've been wanting to talk to fnichol about rvm
[2013-06-19 00:45:40 -0400] bluepojo: coderanger: I haven't heard that we'll be there
[2013-06-19 00:45:47 -0400] bluepojo: did reset say he was going?
[2013-06-19 00:46:34 -0400] coderanger: bluepojo: Nope
[2013-06-19 00:47:06 -0400] coderanger: I just tend to run into the same people at ops events :-)
[2013-06-19 00:48:33 -0400] bluepojo: he might
[2013-06-19 00:48:36 -0400] bluepojo: i just haven't heard
[2013-06-19 00:50:08 -0400] coderanger: I'm just crashing the expo hall and playing booth babe
[2013-06-19 00:50:19 -0400] Otterley: are you going to wear a bikini?
[2013-06-19 00:51:17 -0400] coderanger: Hmm, I do have a friend in SF that keeps a borat mankini for conferences ...
[2013-06-19 00:51:24 -0400] coderanger: But I would probably make sales sad
[2013-06-19 00:51:28 -0400] coderanger: I do have a silly hat though
[2013-06-19 00:54:10 -0400] Otterley: coderanger, do you know when the next cookbook feature review will be?
[2013-06-19 00:56:01 -0400] coderanger: No idea, probably next week some time thanks to velocity et al
[2013-06-19 00:56:29 -0400] ssd7: Hrm, we might consider going sans jtimberman on Friday to avoid falling too far behind.
[2013-06-19 00:56:48 -0400] ssd7: Otterley: Any bug in particular you want to get reviewed?
[2013-06-19 00:57:17 -0400] Otterley: ssd7, COOK-3175
[2013-06-19 00:57:56 -0400] Otterley: I'll be at Devops Days though so I won't be able to participate Friday
[2013-06-19 00:59:05 -0400] Otterley: also, I'd like to get a status update on COOK-2584
[2013-06-19 00:59:24 -0400] Otterley: it's been > 2 months since I submitted that one
[2013-06-19 01:00:01 -0400] ssd7: Otterley: I've made a note of both.  Need to do some meetup related stuff, but I'll check in on those tonight.
[2013-06-19 01:00:06 -0400] Otterley: awesome
[2013-06-19 01:00:52 -0400] Otterley: 2584 is probably more involved since I know partial_search is being integrated into the client as a first-class provider, but it would be nice to get that upstream without being blocked further
[2013-06-19 01:01:09 -0400] Otterley: people are using partial_search now and this provides some very good performance improvements
[2013-06-19 01:19:50 -0400] flaccid: hmm if i am doing a notifies in a resource to restart a service, but that service is named differently on platforms, how should i do that? value_for_platform or something in there
[2013-06-19 01:24:50 -0400] flaccid: like is it acceptable to do notifies :restart, "service[#{value_for_platform(["ubuntu","debian"] => { "default" => "cron" },"default" => "crond")}]", :immediately
[2013-06-19 01:25:18 -0400] coderanger: I would probably put it in a variable just to avoid a humungous single line, but sure
[2013-06-19 01:25:43 -0400] coderanger: If its in the same file, you can also just store the service resource object in a variable and use that instead of a string
[2013-06-19 01:25:59 -0400] coderanger: Also use value_for_platform_family :-)
[2013-06-19 01:27:02 -0400] flaccid: thanks coderanger. this does seem ok for the situation me thinks..
[2013-06-19 01:45:52 -0400] rkesters: I'm trying to use the chef-webui and am getting an odd error, in the webui log it is failing  rendering in app/views/layouts/application.html.haml because @environments is nil
[2013-06-19 01:46:01 -0400] rkesters: has anyone seen this problem
[2013-06-19 01:46:20 -0400] rkesters: I have not created any envirnoments
[2013-06-19 01:46:34 -0400] rkesters: I get the error when I first login
[2013-06-19 01:50:42 -0400] coderanger: rkesters: There should always be a _default environment
[2013-06-19 01:50:48 -0400] coderanger: Its created internally
[2013-06-19 01:51:38 -0400] rkesters: I that envirnoment exists, but the webui still did not find it
[2013-06-19 01:53:09 -0400] not_ssd7: Meetup: https://plus.google.com/hangouts/_/b8a90290a881fa08598cb6c9ac9702a0624460c0?authuser=0&hl=en
[2013-06-19 01:54:26 -0400] rkesters: coderanger: _default exists but the webui does not seem to include it in the @environments
[2013-06-19 01:55:23 -0400] flaccid: oo whats the meetup
[2013-06-19 01:55:46 -0400] flaccid: i'll spy
[2013-06-19 01:56:12 -0400] coderanger: rkesters: Sorry, gotta go cook dinner
[2013-06-19 01:57:12 -0400] coderanger: Finally got my selenium tests to fill out the signup form correctly :-)
[2013-06-19 01:57:22 -0400] coderanger: That means its quittin' time
[2013-06-19 02:00:47 -0400] Otterley: hey flaccid, why restart frond?
[2013-06-19 02:00:49 -0400] Otterley: crond
[2013-06-19 02:01:02 -0400] flaccid: Otterley: timezone change
[2013-06-19 02:01:34 -0400] Otterley: you're using UTC right? :D
[2013-06-19 02:03:50 -0400] flaccid: by default yes, but users can drift to another timezone. excuse the pun
[2013-06-19 02:04:40 -0400] Otterley: I don't follow
[2013-06-19 02:04:57 -0400] flaccid: bad joke. can change timezone
[2013-06-19 02:05:09 -0400] Otterley: they can change the system's timezone?
[2013-06-19 02:05:27 -0400] flaccid: Otterley: yeah https://github.com/flaccid/cookbooks/blob/master/cookbooks/system/providers/timezone.rb
[2013-06-19 02:05:41 -0400] Otterley: interesting
[2013-06-19 02:05:57 -0400] flaccid: you need to restart cron if you change timezone
[2013-06-19 02:06:44 -0400] Otterley: huh.  any reason why just putting TZ= in cron jobs and user shells isn't adequate?
[2013-06-19 02:07:10 -0400] flaccid: because that relies on dumb users doing so
[2013-06-19 02:09:01 -0400] Otterley: any idea why setting a hash value attribute in a role's default_attributes isn't taking precedence over the values in attributes/default.rb?
[2013-06-19 02:20:42 -0400] coderanger: Otterley: Pretty sure that it goes roles -> envs -> cookbooks
[2013-06-19 02:20:58 -0400] Otterley: http://docs.opscode.com/essentials_cookbook_attribute_files_attribute_precedence.html suggests otherwise
[2013-06-19 02:21:01 -0400] Otterley: unless I'm misreading it
[2013-06-19 02:21:23 -0400] coderanger: Hmm, I would have to double check in the loader code
[2013-06-19 02:21:38 -0400] coderanger: I would definitely consider merging on the same level to be undefined behavior though :-)
[2013-06-19 02:21:51 -0400] Otterley: eh, the problem was drum roll. using an array as a value
[2013-06-19 02:23:22 -0400] Otterley: hey, you guys are the ones who splice values into them :P
[2013-06-19 02:23:35 -0400] flaccid: ja ching
[2013-06-19 02:24:56 -0400] Otterley: also, you can't put normal attributes into roles
[2013-06-19 02:25:00 -0400] Otterley: your choice is default or override
[2013-06-19 02:26:44 -0400] coderanger: Yahr
[2013-06-19 02:27:24 -0400] coderanger: The only thing that can have a normal level is the node object itself via cookbook code or direct API calls
[2013-06-19 02:27:39 -0400] Otterley: I must say I find it surprising that the behavior differs depending on the type of the attribute
[2013-06-19 02:27:53 -0400] Otterley: that has bitten me in the ass so many times
[2013-06-19 02:27:56 -0400] coderanger: The array merge thing?
[2013-06-19 02:27:58 -0400] Otterley: yeah
[2013-06-19 02:28:09 -0400] coderanger: yeah, I think I've made it clear I'm not a fan of that
[2013-06-19 02:28:40 -0400] Otterley: it'd be nice to make the behavior switchable for those who don't need/want array merging at that price
[2013-06-19 02:31:57 -0400] coderanger: That would 1) be really complex and 2) would have to somehow per cookbook which isn't possible since there is no explicit link between cookbooks and attr namespaces, etc etc
[2013-06-19 02:32:19 -0400] coderanger: Better to have it broken than have it configurable, at least it is predictably broken
[2013-06-19 02:32:41 -0400] Otterley: I meant globally
[2013-06-19 02:37:50 -0400] coderanger: Right, run-time changing it globally means you need to either audit all community cookbooks you use for which setting they expect, or make it not global :)
[2013-06-19 03:11:37 -0400] rkesters: where is the private-chef.rb stored? I used the omnibus installer
[2013-06-19 03:15:00 -0400] rkesters: does anyone know where the private-chef.rb config is located for private chef installs?
[2013-06-19 03:19:33 -0400] coderanger: rkesters: I think either /etc/chef or etc/private-chef
[2013-06-19 03:19:39 -0400] coderanger: probably the latter
[2013-06-19 03:19:55 -0400] coderanger: Depends on the exactly build though
[2013-06-19 03:22:59 -0400] bradbeam: how can i include multiple cookbook paths for kitchen.yml?
[2013-06-19 03:24:28 -0400] bradbeam: is it just adding cookbooks_path under the suites?
[2013-06-19 03:45:40 -0400] ryker: anyone know of a good (and up to date) glusterfs cookbook?
[2013-06-19 04:38:22 -0400] tabolario: coderanger: that keynote was very insightful, thanks!
[2013-06-19 04:38:38 -0400] tabolario: so many videos from chefconf to watch
[2013-06-19 05:13:55 -0400] dyu: how do i download data bags from the chef server?
[2013-06-19 05:14:02 -0400] dyu: so i can edit it in my machine
[2013-06-19 05:15:32 -0400] dyu: knife data bag edit <bag> <item>
[2013-06-19 05:18:41 -0400] Otterley: knife data bag show -Fj <bag> <item>
[2013-06-19 05:19:21 -0400] Otterley: it's a good idea to keep data bags in your Chef repo
[2013-06-19 05:19:41 -0400] Otterley: that way your SCM remains your source of truth
[2013-06-19 05:27:53 -0400] coderanger: knife download data_bags/<bag>/<item>
[2013-06-19 05:27:56 -0400] coderanger: :)
[2013-06-19 05:56:47 -0400] monokrome: If chef solo part of the omnibus install?
[2013-06-19 06:04:16 -0400] coderanger: monokrome: yes
[2013-06-19 06:08:24 -0400] monokrome: coderanger: Oh, it's just an executable called chef-solo?
[2013-06-19 06:08:38 -0400] coderanger: Yep
[2013-06-19 06:12:20 -0400] cjerdonek: is there a way to set an attribute value on a node and prevent it from being written to chef server (e.g. a plain-text database password)?
[2013-06-19 06:12:55 -0400] dyu: Otterley and coderanger : thanks :-)
[2013-06-19 06:12:59 -0400] coderanger: cjerdonek: Technically yes but it isn't what you want to do :)
[2013-06-19 06:13:09 -0400] coderanger: cjerdonek: Check out encrypted data bags
[2013-06-19 06:13:42 -0400] cjerdonek: coderanger: i'm already using encrypted data bags
[2013-06-19 06:15:20 -0400] Otterley: cjerdonek, as long as you're not using node.set it shouldn't get sent back
[2013-06-19 06:15:28 -0400] swedish_chef: @coderanger v2 of LWRP subclassing https://gist.github.com/ssimeonov/5811992#file-02_resource_rake-rb-L57 Would love some feedback.
[2013-06-19 06:19:13 -0400] coderanger: yahr, just don't make them into node attrs and you'll be fine
[2013-06-19 06:19:38 -0400] coderanger: swedish_chef: will look in the AM, mostly asleep, just waiting for my tomatoes to finish in the oven :(
[2013-06-19 06:19:56 -0400] swedish_chef: slow-roasting?
[2013-06-19 06:20:35 -0400] coderanger: Normal roasting, making tomato sauce :)
[2013-06-19 06:20:54 -0400] swedish_chef: you are making me hungry
[2013-06-19 06:20:58 -0400] swedish_chef: :)
[2013-06-19 06:21:30 -0400] coderanger: I also made an insanely good steak for dinner with peppers and onions :)
[2013-06-19 06:21:51 -0400] coderanger: <3 my local butcher
[2013-06-19 06:22:30 -0400] swedish_chef: Sadly I'm a Chef (p/m)uppet: the diet here is not so good
[2013-06-19 06:22:50 -0400] cjerdonek: coderanger: the mysql cookbook for example expects the root password to be a node attribute. i'm setting that from an encrypted data bag. am i missing something?
[2013-06-19 06:23:07 -0400] swedish_chef: making friends with you butcher is a path to happy evenings
[2013-06-19 06:24:21 -0400] coderanger: cjerdonek: Yeah, no way around that other than not using that cookbook
[2013-06-19 06:24:44 -0400] coderanger: cjerdonek: You can look at the approach used in facebook's whitelist-attrs cookbook, but you'll want a blacklist instead
[2013-06-19 06:25:14 -0400] cjerdonek: coderanger: okay, great, thx. i'll check that out.
[2013-06-19 06:26:13 -0400] coderanger: And for everyone that asks why library resources are better than recipes, this is the use case right here :)
[2013-06-19 06:26:25 -0400] coderanger: Data flow decisions belong to the final author, not the lib
[2013-06-19 06:29:01 -0400] Otterley: cjerdonek, how are you setting it from the data bag?
[2013-06-19 06:31:03 -0400] cjerdonek: Otterley: early in my recipe i call a library function that reads the pass from an encrypted data bag and then does this: @node.normal[:mysql][:server_root_password] = root_pass
[2013-06-19 06:31:15 -0400] Otterley: oh, there's your problem
[2013-06-19 06:31:22 -0400] Otterley: normal attributes are returned to the server
[2013-06-19 06:32:11 -0400] coderanger: There is no way around it in this case
[2013-06-19 06:32:23 -0400] coderanger: The recipe doesn't have any way to pass the value in other that node attrs
[2013-06-19 06:32:26 -0400] cjerdonek: Otterley: the value didn't seem to "stick" when i used default. so do i use override or something?
[2013-06-19 06:32:35 -0400] coderanger: you could do something silly like set it, include_recipe, and then unset it
[2013-06-19 06:32:48 -0400] Otterley: how about override, coderanger ?
[2013-06-19 06:32:57 -0400] coderanger: Still sent back to the server
[2013-06-19 06:32:59 -0400] coderanger: all attrs are
[2013-06-19 06:32:59 -0400] cjerdonek: yeah, i thought about that. but then i have to worry about catching exceptions, etc
[2013-06-19 06:33:10 -0400] Otterley: oh, I thought only normal was
[2013-06-19 06:33:24 -0400] coderanger: cjerdonek: Well one saving grace is that unless you have a special handler, a failed run doesn't call node.save
[2013-06-19 06:33:39 -0400] coderanger: So you can worry slightly less about failure edge cases
[2013-06-19 06:33:47 -0400] cjerdonek: oh, good to know. then that solution isn't so bad
[2013-06-19 06:34:02 -0400] coderanger: But its still like saying "we'll only kinda sorta be handling a live grenade"
[2013-06-19 06:34:29 -0400] cjerdonek: right, it's still dangerous.
[2013-06-19 06:34:35 -0400] coderanger: :-)
[2013-06-19 06:34:51 -0400] Otterley: good thing we don't use said recipe then :)
[2013-06-19 06:34:55 -0400] Otterley: or encrypted databags
[2013-06-19 06:35:02 -0400] coderanger: Another alternative is to fork the cookbook and submit a patch to let it use something other than node attrs
[2013-06-19 06:35:10 -0400] coderanger: the run state hash would be a good option
[2013-06-19 06:35:18 -0400] Otterley: +1 on run_state
[2013-06-19 06:35:29 -0400] coderanger: run_state[:mysql_root_password] || node[:mysql][:root_password]
[2013-06-19 06:35:42 -0400] coderanger: that would keep the existing semantics while allowing other data sources if you wanted
[2013-06-19 06:36:08 -0400] coderanger: okay, gotta go finish cooking, back in a bit
[2013-06-19 06:36:43 -0400] cjerdonek: thanks a lot for your help and insight, Otterley and coderanger
[2013-06-19 06:36:56 -0400] dieend: Hello, I was trying to set php directives by setting the atributes of node.normal['php']['directives']
[2013-06-19 06:37:26 -0400] dieend: it is working, but only changing php.ini in /etc/php5/cli/php.ini, and not changing /etc/php5/apache2/php.ini
[2013-06-19 06:37:43 -0400] dieend: how to make it changes both, or how to define which php.ini file should be changed?
[2013-06-19 06:42:25 -0400] Otterley: whose cookbook are you using dieend ?
[2013-06-19 06:57:56 -0400] dieend: Otterley: I am using my own cookbook with dependency php cookbook from community
[2013-06-19 06:58:07 -0400] Otterley: there are multiple php cookbooks, whose?
[2013-06-19 07:06:04 -0400] Otterley: is it possible to override an attribute such that its value will be nil?  I can't seem to make it work in a role
[2013-06-19 07:06:44 -0400] Otterley: it seems like an assignment to null in a role seems to tell Chef that we're no longer overriding its value
[2013-06-19 07:16:31 -0400] dieend: Otterley: I don't know. I'm not using role but creating a new cookbook
[2013-06-19 07:16:55 -0400] dieend: Otterley: and I'm not assigning a null
[2013-06-19 07:16:57 -0400] Otterley: oh, I wasn't asking you
[2013-06-19 07:17:04 -0400] dieend: oh sorry
[2013-06-19 07:31:18 -0400] bcave: hi
[2013-06-19 07:31:50 -0400] bcave: wondering if anyone could have a look at a question regarding chef integration with AWS ec2
[2013-06-19 07:31:59 -0400] bcave: http://community.opscode.com/questions/406
[2013-06-19 07:38:50 -0400] cjerdonek: bcave: why would you want to register an ami from a server that you've already created with knife ec2?
[2013-06-19 07:42:03 -0400] bcave: because knife ec2 is used to bootstrap a default AMI with customized base packages
[2013-06-19 07:42:30 -0400] bcave: e.g. i use it to install nodejs / java / database server / etc
[2013-06-19 07:42:51 -0400] bcave: and load up some custom, internally developed libraries
[2013-06-19 07:43:32 -0400] cjerdonek: for example, do you want to do that because it's faster to deploy an ami than to run knife ec2 each time you want to deploy a new instance?
[2013-06-19 07:43:38 -0400] bcave: ya
[2013-06-19 07:44:02 -0400] bcave: optimized boot time when the customized ami is deployed as part of a cloudformation stack, for example
[2013-06-19 07:45:37 -0400] bcave: another factor in wanting that approach is that the bootstrap ami is configured in a less restrictive network environment (standard ec2), whereas when I register as AMI and then launch that as an instance in a stack, it doesn't have external access to yum / apt repos (vpc instances with restrictve outbound rules in security groups)
[2013-06-19 07:45:59 -0400] bcave: so security and time
[2013-06-19 07:46:36 -0400] bcave: and access
[2013-06-19 07:46:40 -0400] bcave: is also an issue
[2013-06-19 07:46:56 -0400] cjerdonek: bcave: yeah. seems like a pretty basic use-case. i'd be interested in the answer, too
[2013-06-19 07:46:56 -0400] bigbigbang: Hi ! Is it possible to make a rabbitMQ cluster with for example 2 erchefs running on the same database (postgre) ?
[2013-06-19 07:48:15 -0400] bigbigbang: when i do it i get error 500 undefined method for 'admin' .. I doesn't understand .. I think i've copy the good certificate in order to have the slave erchef working on the master erchef ..
[2013-06-19 07:48:42 -0400] bcave: i think i'm probably going to have to build a cookbook that de-registers from chef server and removes local config as part of the basenode role...
[2013-06-19 07:49:23 -0400] bcave: and then configure the system somehow to read user-data on startup to determine role, and then register with chef server with a new role.
[2013-06-19 07:49:57 -0400] cjerdonek: lots of options
[2013-06-19 07:55:31 -0400] bcave: yep. but being relatively new to chef, was hoping to at least get some ideas on the approach. best-practise considerations... anyway, cookbook #1, here we go
[2013-06-19 08:44:59 -0400] Nysso: Hello everyone. Does anybody know is "conflicts" in "metadata.rb" works?
[2013-06-19 08:45:44 -0400] m4rcu5: Nysso: yep, you can for example say that you cant use it together with some other cookbook, iirc
[2013-06-19 08:47:38 -0400] Nysso: @m4rcu5, I created 2 cookbooks. Cats and Dogs. For Dogs added ' conflicts "cats" ' into metadata.rb, assigned both cookbooks to node and run chef-client. Finally both cookbooks applied without warnings or any other notice. What I did wrong?
[2013-06-19 10:14:57 -0400] fishGoM00: how can you check that a server is a particular role before executing something?
[2013-06-19 10:15:05 -0400] fishGoM00: https://coderwall.com/p/yz-ngw doesn't seem to work
[2013-06-19 10:15:29 -0400] fishGoM00: is that correct or is there a different method?
[2013-06-19 10:16:47 -0400] pikesley: yo
[2013-06-19 10:16:51 -0400] laurent\: fishGoM00: nodes.roles.include? "vagrant"
[2013-06-19 10:17:08 -0400] pikesley: is ANYBODY able to make lusis's logstash cookbook work?
[2013-06-19 10:17:17 -0400] pikesley: it's exploding all over the place here
[2013-06-19 10:20:07 -0400] fishGoM00: laurent, how you I write that into an if statement?
[2013-06-19 10:20:17 -0400] fishGoM00: would I
[2013-06-19 10:21:46 -0400] fishGoM00: if node[:roles].include?('syslog_server')
[2013-06-19 10:22:56 -0400] laurent\: yeah for ex
[2013-06-19 10:23:13 -0400] fishGoM00: ex?
[2013-06-19 10:23:14 -0400] laurent\: or if node["roles"].include? "syslog_server"
[2013-06-19 10:23:19 -0400] laurent\: example
[2013-06-19 10:23:29 -0400] fishGoM00: many thanks, will give it a try
[2013-06-19 10:53:48 -0400] lewiz: Good morning.  Our Chef host suffered a power outage last night and it appears that the CouchDB chef database has become corrupted.  Can anybody offer any hints on recovery and/or how easy it would be to rebuild the Chef server from scratch given we have a few hundred hosts already out there?
[2013-06-19 10:58:23 -0400] mutombo: I've installed the chef-server yesterday with the omni installer
[2013-06-19 10:58:34 -0400] mutombo: pretty fast and easy
[2013-06-19 10:59:07 -0400] mutombo: but it uses postgresql not couchdb, so i dont know if this helps you lewiz
[2013-06-19 11:01:02 -0400] lewiz: mutombo: thanks.  our Chef was not set up by me but is using couch :/  everything I've read indicates couchdb strives for consistency so I think we've been unlucky
[2013-06-19 11:18:58 -0400] MerlinDMC: lewiz, recovery doesn't work on the couchdb databases?
[2013-06-19 11:19:26 -0400] lewiz: MerlinDMC: good question... I joined #couchdb as you asked the question :)
[2013-06-19 11:19:41 -0400] MerlinDMC: ^^
[2013-06-19 11:23:03 -0400] pixie79: Hi, - how can I retrieve node variables like the ip address of eth1:0 and use that in my recipies ?
[2013-06-19 11:31:05 -0400] pixie79: can i just do node['eth1:0'][addresses] in the recipie ?
[2013-06-19 11:37:41 -0400] shay-: Hi, I've got a realy strange error: This line "expiredate = data_bag_item('webserver', 'cache')[node.chef_environment]['expiredate']" throws: NoMethodError: undefined method `[]' for nil:NilClass; any ideas? The data bag + item + the correct value exists, i think it should also be a different error if it can't find the value. Serverversion: 11.0.8.-1; Client: 11.4.4
[2013-06-19 11:43:35 -0400] bigbigbang: re Hi, does someone know if I can "store" the bookshelf repository on a LAN stockage ? ( SAN, SMB..) ? I'm trying to make failover with 2 erchef , postgre is replicated on both, ( have tried cluster node with rabbitMQ but doesn't work as there is certificate problem i think..)
[2013-06-19 11:56:07 -0400] railsraider: i am using a service restart but seeing chef trying to do reload and fails cause reload: Not running
[2013-06-19 11:56:10 -0400] railsraider: why?
[2013-06-19 11:56:16 -0400] railsraider: i mean why reload?
[2013-06-19 11:57:34 -0400] railsraider: using chef 11.4
[2013-06-19 12:00:00 -0400] pixie79: :q
[2013-06-19 12:00:41 -0400] railsraider: http://pastebin.com/2HLL0dna
[2013-06-19 12:00:54 -0400] railsraider: can someone help with this upstart
[2013-06-19 12:03:20 -0400] gsreynolds: Got a bit of a problem with the application & application_ruby cookbooks. I'm deploying a rails app with passenger_apache2. It's all working except when I enable the migrations and asset pre-compilation options. They fail because the PATH environment variable has Omnibus chef embedded ruby bin in it. It works running manually (i.e. without the Omnibus embedded bin in the path).
[2013-06-19 12:04:39 -0400] gchristensen: gsreynolds: how did you install ruby?
[2013-06-19 12:05:13 -0400] gsreynolds: I've tried setting the environment variable hash in the application LWRP, environment "PATH" => "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin", but the PATH still remains as /opt/chef/embedded/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt/chef/embedded/bin:/opt/chef/embedded/bin
[2013-06-19 12:05:27 -0400] gsreynolds: gchristensen, yes Ruby is installed.
[2013-06-19 12:05:55 -0400] gchristensen: gsreynolds: *how* did you install it? with apt or yum? or with rbenv / rvm?
[2013-06-19 12:06:31 -0400] gsreynolds: Ah sorry, using ruby_build. If I run the migrations and asset precompilation as the application user manually it works fine and the app runs fine.
[2013-06-19 12:07:03 -0400] gsreynolds: Ruby is built in /usr/local/
[2013-06-19 12:07:32 -0400] pixie79: how do i reference the following field: {"00:25:33:AD:33:6B"=>{"family"=>"lladdr"}, "10.299.0.17"=>{"family"'..... I need just the answer '10.299.0.17'
[2013-06-19 12:07:35 -0400] gchristensen: gsreynolds: I'll provide a paste of what I do in a moment here.
[2013-06-19 12:09:06 -0400] gsreynolds: Specifically /usr/local/bin/ruby. Ohai picks it up and ruby_bin, gem_bin under languages, ruby it set correctly.
[2013-06-19 12:09:18 -0400] gsreynolds: gchristensen, thanks :)
[2013-06-19 12:13:03 -0400] gchristensen: gsreynolds: let me know if this makes any sense: https://gist.github.com/grahamc/0c4079e43b5f997a5bd6
[2013-06-19 12:14:57 -0400] gsreynolds: gchristensen: From what I can tell from reading the application cookbook, run_deploy in the provider merges the provided environment variables with Chef's environment variables, which is where I assume the provided PATH variable gets whacked & the Chef one wins.
[2013-06-19 12:15:17 -0400] gsreynolds: gchristensen: Will try that out now, thanks!
[2013-06-19 12:16:28 -0400] gchristensen: sure thing! perhaps it does merge it, but this will happen at the very last moment, and override anything Chef is doing.
[2013-06-19 12:17:33 -0400] gchristensen: gsreynolds: also, the exec on line 24 is crucial to this working properly.
[2013-06-19 12:19:21 -0400] gsreynolds: gchristensen: vagrant up! Fingers crossed ;)
[2013-06-19 12:20:04 -0400] gchristensen: honestly, deploying Ruby applications makes me pull my hair out. I've started transitioning to using Omnibus like Chef uses for packaging so I don't have to worry about building ruby all over the place.
[2013-06-19 12:24:08 -0400] gsreynolds: gchristensen: Yeah, this is the first time I've tried deploying RoR with Chef, had my fair share of hair pulling yesterday.
[2013-06-19 12:24:19 -0400] gchristensen: aye
[2013-06-19 12:25:22 -0400] gsreynolds: gchristensen: Looking like that wrapper has done the trick!
[2013-06-19 12:25:29 -0400] gchristensen: excellent :)
[2013-06-19 12:26:03 -0400] gchristensen: since it sets the rails_env and all, I don't usually have to change anythingabout the rest of my deployment files (or at least not many things)
[2013-06-19 12:26:08 -0400] gchristensen: makes it harder to mess things up.
[2013-06-19 12:29:37 -0400] gsreynolds: Aye, thanks for that. Much appreciated.
[2013-06-19 12:30:31 -0400] gchristensen: sure thing. good luck!
[2013-06-19 12:38:07 -0400] erchavar: Hi - I am noticing that I do bootstraps on the my nodes, the boostrapping process goes to opscode's website, should it not go to my local server?
[2013-06-19 12:38:30 -0400] erchavar: Am I missing something here?  Is Opscode assuming that all servers have internet connectivity?
[2013-06-19 12:40:00 -0400] proppen: Anyone using knife-spork? I get  "ERROR: knife encountered an unexpected error" when I try to run it. http://pastebin.com/PWnFeh7c
[2013-06-19 12:40:20 -0400] siezer: erchavar you can use a custom bootstrap script to point at an internally hosted Chef artifact
[2013-06-19 12:44:16 -0400] corentin__: Hello I am looking for an example of the difference between chef and puppet?
[2013-06-19 12:56:00 -0400] proppen: Does this has something to do with my ruby version (1.8.7)?
[2013-06-19 13:00:00 -0400] erchavar: siezer: Hi siezer, could you point me out to documentation on how to go about doing custom bootstrap script? - I was assuming that the chef-server had it all within to provision everything - new workstations and new nodes.
[2013-06-19 13:00:11 -0400] erchavar: siezer: not just cookbooks
[2013-06-19 13:01:37 -0400] siezer: http://docs.opscode.com/knife_bootstrap.html
[2013-06-19 13:01:49 -0400] siezer: search for the "examples" section, and use the -d flag
[2013-06-19 13:02:20 -0400] siezer: when you edit the script, there's a section there it curls form the internet. just replace that part with a curl from an internal webserver
[2013-06-19 13:13:40 -0400] yanc0: Hi, I have one question. With ec2 module for knife I launch an instance on Amazon AWS. The command is: knife ec2 server create -I ami-ce7b6fba --flavor t1.micro -x ubuntu -r "role[lbdb]" -G "chef-role-webserver" -N "chef_app2_mysql" -E "app2" -- I understand the global functionning but, when knife is setting the role to the new node? And where? Is this knife which tell to the new node what role(s) is it? Or knife telling chef server: "This node (name) is a lbdb 
[2013-06-19 13:16:44 -0400] Hildgrim: Knife is telling the chef server based on the roles what to set up. So chef is doing the work.
[2013-06-19 13:18:43 -0400] yanc0: Knife create the node on chef server and then apply a role to it?
[2013-06-19 13:20:06 -0400] yanc0: After, the client calls the server and then he says: "I'm chef_app2_mysql, what're my roles?"
[2013-06-19 13:20:15 -0400] yanc0: Is it that?
[2013-06-19 13:20:47 -0400] Hildgrim: Yep, knife is just your tool
[2013-06-19 13:21:29 -0400] Hildgrim: See http://docs.opscode.com/chef_overview.html
[2013-06-19 13:23:08 -0400] yanc0: Thanks
[2013-06-19 13:41:47 -0400] Dynom: A single cookbook is responsible for completely ignoring the order of the run_list. Both apt's initial apt-get update and the build-essentials are being skipped an certain packages are being installed right away. Can anyone point me in a direction why that is? ( https://github.com/inviqa/chef-xhprof-gui )
[2013-06-19 13:43:22 -0400] mutombo: Dynom: i guess it will try to install all the dependencies first
[2013-06-19 13:43:29 -0400] mutombo: look at https://github.com/inviqa/chef-xhprof-gui/blob/master/metadata.rb for that
[2013-06-19 13:43:29 -0400] Dynom: When I don't include chef-xhprof-gui, all goes as expected. When I do include it, mysql is being installed before an apt-get update is run and another package borks because certain build-essential packages aren't yet installed. I find this most puzzling
[2013-06-19 13:44:06 -0400] Dynom: mutombo; other cookbooks have dependencies too, yet they don't cause that behaviour
[2013-06-19 13:44:28 -0400] Dynom: hm odd, it has a dependency on itself
[2013-06-19 13:44:44 -0400] mutombo: just guessing ;)
[2013-06-19 13:45:06 -0400] Dynom: hm, maybe that's it, I'll try it once my chef run is completed
[2013-06-19 13:48:20 -0400] behemphi: Good Morning.  I am (finally) trying to adopt the Berkshelf Way.  I have run into a problem using Vagrant + Chef Solo + Data Bags.  I _think_ it is Ruby at its core.  When I included the chef-solo-search cookbook, I got an error saying Solo could not load 'search/overrides'
[2013-06-19 13:49:00 -0400] behemphi: When I looked for the `search` gem at rubygems.org it was placeholder for something that would do some things later (according to the doc)
[2013-06-19 13:49:46 -0400] behemphi: So my question is what gem do I need to install for the chef-solo-search cookbook to work?
[2013-06-19 14:19:45 -0400] ryker: anyone know of a good (and up to date) glusterfs cookbook?
[2013-06-19 14:19:47 -0400] chefuser: Hello
[2013-06-19 14:20:05 -0400] chefuser: i am using the application cookbook
[2013-06-19 14:20:10 -0400] chefuser: but i am getting the error
[2013-06-19 14:20:31 -0400] chefuser: You must supply a name when declaring a resource
[2013-06-19 14:20:35 -0400] chefuser: how to resolve it
[2013-06-19 14:33:04 -0400] Dynom: murphy_slaw_; removing the dependency didn't result in the desired result
[2013-06-19 14:46:26 -0400] DandyPandy: Anyone hear when the omnibus installer script will be updated with debian wheezy support? I'm not going to start this new project on squeeze and I refuse to use ubuntu on a server.
[2013-06-19 14:49:01 -0400] bigbigbang: Does someone know what I should do to have rabbitmq running in cluster with another erchef ?
[2013-06-19 14:49:11 -0400] gleam: i use the ubuntu 10.04 omnibus server deb on wheezy
[2013-06-19 14:49:20 -0400] runfromnowhere: DandyPandy: You can actually write your own installer scripts if it suits you as well
[2013-06-19 14:49:33 -0400] gleam: and the 11.x squeeze omnibus client debs on wheezy clients
[2013-06-19 14:49:36 -0400] gleam: with absolutely no problems
[2013-06-19 14:49:52 -0400] runfromnowhere: I wrote a bootstrap script for FreeBSD which was far more annoying than it should have been (LOL although that was mostly FreeBSD and csh's fault :) )
[2013-06-19 14:50:26 -0400] bigbigbang: I have 2 erchef , one master , one slave, the slave get his data by master db and I try to clusterize rabbitmq ...
[2013-06-19 14:50:49 -0400] DandyPandy: runfromnowhere: I'm using the knife-rackspace plugin and I'm don't really want to fork it
[2013-06-19 14:53:01 -0400] DandyPandy: When the cloud server finishes kicking, it ssh's in and does the wget for the opscode installer, but when the script runs, it has no match for wheezy.
[2013-06-19 14:53:49 -0400] DandyPandy: If it's not going to happen any time soon, I'll modify the script and throw it on another web server and modify the plugin to pull from the other url.
[2013-06-19 14:54:57 -0400] DandyPandy: I suppose that would be a viable option in the interim.
[2013-06-19 15:10:35 -0400] benner: hi
[2013-06-19 15:12:46 -0400] benner: what's the right way to rotate chef-client's logs?
[2013-06-19 15:13:18 -0400] Death_Syn: i run my chef-client through runit, and let svlogd do the rotation
[2013-06-19 15:14:06 -0400] Death_Syn: chef-client may also accept HUP for logrotatei see others send the init script a condrestart via logrotate
[2013-06-19 15:14:13 -0400] Death_Syn: something like this: https://github.com/frameos/rubygem-chef-rpm/blob/master/chef-client.logrotate
[2013-06-19 15:25:40 -0400] ianneub: Howdy all, could someone help me with an attributes load order issue? I'm not sure what the "right thing" to do is. https://gist.github.com/ianneub/1b088769cce92eb8f393
[2013-06-19 15:26:05 -0400] benner: Death_Syn: thanks
[2013-06-19 15:43:17 -0400] runfromnowhere: DandyPandy: I don't think you have to fork anything to get that working, hold on a minute and I'll take a look at what I did
[2013-06-19 15:44:45 -0400] runfromnowhere: DandyPandy: Yeah you can just create the new bootstrap .erb file and put it in .chef/bootstrap within your chef-repo directory.  Then you can reference it with knife as the appropriate bootstrap script to use without having to retool anything too crazy
[2013-06-19 15:56:22 -0400] gems: I have moved all my role attributes into a new environment, and applied that environment to a node.  The node still has the roles applied to it.  When I look at the node, it doesn't seem to be inheriting all the environment attributes so none of the role attributes moved over are being seen.  Any advice?
[2013-06-19 15:58:33 -0400] DandyPandy: runfromnowhere: fantastic! Thanks for catching that!
[2013-06-19 15:59:33 -0400] whilp: guten morgen!
[2013-06-19 15:59:57 -0400] whilp: we're developing a little internal doc about chef cookbook release engineering
[2013-06-19 16:00:00 -0400] haylon: Having some issues uploading a cookbook after I moved it, and made some changes. Googled the issue, but everyone's problems are different than mine I guess. I am trying to upload a cookbook, the same way I did before using 'knife cookbook upload COOKBOOK -o /path/to/cookbook' and I get this error: 'ERROR: Could not find cookbook zabbix_agent_corp in your cookbook path, skipping it' What does that mean, and what do i need to do to fix 
[2013-06-19 16:00:21 -0400] whilp: does anybody have a doc they like (or a summary of their expectations for community contributions)?
[2013-06-19 16:02:29 -0400] haylon: My error happens with Cygwin, Command Prompt, and Git Bash
[2013-06-19 16:05:41 -0400] runfromnowhere: DandyPandy: No problem, heh I like to find the least-impact way to customize things when I want to add something in.  I'm not sure if there's a bootstrap script out there already that'll do what you want, but there might be!
[2013-06-19 16:10:07 -0400] tabolario: hey all, so i'm writing a wrapper cookbook for the opscode postgresql cookbook and the main intent is to put the postgresql data in /srv/postgresql, which is a created with the aws cookbook as an ebs raid array
[2013-06-19 16:10:44 -0400] tabolario: any guidance on the best way i might accomplish this? i'm a bit stuck trying to figure it out, since the postgresql package appears to populate its default directory right away when it installs
[2013-06-19 16:11:18 -0400] gleam: create teh block device+directory+mount it before you include_recipe postgresql?
[2013-06-19 16:11:50 -0400] tabolario: and then just create postgresql's default data dir path as a symlink to that?
[2013-06-19 16:14:58 -0400] tabolario: haha i don't know why i didn't think of that, i'm doing exactly the same thing for my mongodb wrapper cookbook
[2013-06-19 16:15:02 -0400] tabolario: thanks for the burst of insight!
[2013-06-19 16:24:00 -0400] ianco: reharding test-kitchen, is there anyway to specify config.vm.provision in the vagrant driver_config?
[2013-06-19 16:24:18 -0400] ianco: lol. /reharding/regarding/
[2013-06-19 16:35:21 -0400] jtgiri_: ianco:  take a look at this : https://github.com/opscode/kitchen-vagrant, there is section for use_vagrant_provision
[2013-06-19 16:37:25 -0400] ianco: jtgiri_, yeah, it doesnt say how to specify an :inline attr there tho
[2013-06-19 17:04:35 -0400] gswallow: Any chef-on-windows types here?
[2013-06-19 17:06:02 -0400] jessicab1: gswallow: theres a few of us.. id just ask the question :P
[2013-06-19 17:19:19 -0400] zuhaib: Hey Any Omnibus guys online right now?
[2013-06-19 17:19:37 -0400] zuhaib: (not for Chef but the omnibus-ruby project)
[2013-06-19 17:47:20 -0400] nmeunier: Hello!
[2013-06-19 17:53:24 -0400] Otterley: I probably missed the answer since I fell asleep last night, but:
[2013-06-19 17:53:51 -0400] Otterley: is it possible to override an attribute such that its value will be nil?  I can't seem to make it work by setting an override for the attribute in question in a role.  the cookbook's default applies.
[2013-06-19 17:54:43 -0400] Otterley: It seems Chef treats nil values in node and role attributes as something other than "no, really set this to the value nil"
[2013-06-19 17:55:15 -0400] cwj: Otterley: values which are not set are nil
[2013-06-19 17:55:32 -0400] cwj: so theres no way to tell the difference between intentionally nil and nil because its unset
[2013-06-19 17:55:36 -0400] Otterley: cwj, I can only compare with perl, where undef != nil
[2013-06-19 17:55:55 -0400] cwj: can you make your cookbook deal with false instead of nil?
[2013-06-19 17:56:01 -0400] cwj: or whatever it is you're doing
[2013-06-19 17:56:43 -0400] Otterley: Ruby has something similar, where Hash#has_key? can test for a key's existence
[2013-06-19 17:56:55 -0400] Otterley: but Chef apparently is being naive about the difference
[2013-06-19 17:57:06 -0400] juliancdunn: it's better to override it to something that is the same data type as the cookbook's default (Otterley)
[2013-06-19 17:57:29 -0400] juliancdunn: so if it's a string, override to '', that sort of thing
[2013-06-19 17:57:33 -0400] Otterley: juliancdunn, I've done that for now, but it seems unsatisfying
[2013-06-19 17:58:01 -0400] juliancdunn: Otterley: personally I think it's correct... "nil" is like undefined
[2013-06-19 17:58:07 -0400] Otterley: but it's not!
[2013-06-19 17:58:25 -0400] Otterley: anyway, no point in arguing, it works like it works
[2013-06-19 17:58:46 -0400] juliancdunn: yeah, I guess you're right... because undefined would "raise NameError"
[2013-06-19 17:59:19 -0400] juliancdunn: it's just how Chef works. if you try to access some undefined part of the node object, it'll auto-vivify that to nil
[2013-06-19 17:59:29 -0400] juliancdunn: rather than blowing up with NameError
[2013-06-19 17:59:52 -0400] Otterley: the problem (or benefit) with Ruby (depending on how you look at it) is that referencing a Hash with an unset key returns nil
[2013-06-19 18:00:03 -0400] Otterley: irb(main):001:0> x = {}
[2013-06-19 18:00:03 -0400] Otterley: => {}
[2013-06-19 18:00:05 -0400] Otterley: irb(main):002:0> x[:foo]
[2013-06-19 18:00:07 -0400] Otterley: => nil
[2013-06-19 18:00:09 -0400] Otterley: irb(main):003:0>
[2013-06-19 18:00:17 -0400] nmeunier: Does anyone has a recommendation for a cookbook to create new deploy keys to github (for private repos)?
[2013-06-19 18:00:56 -0400] rracterr: so can I interocate the chef environment from a node?  more specifically, can I find out how many nodes are in a specific environment... for use say in hostnaming...
[2013-06-19 18:01:10 -0400] Otterley: rracterr, sure, use search.  we do that.
[2013-06-19 18:01:28 -0400] rracterr: any chance you have a code snippet to save me time?
[2013-06-19 18:01:54 -0400] rracterr: I'm spending the morning trying to come up with an eligant solution to FQDN and DDNS...
[2013-06-19 18:01:56 -0400] Otterley: search(:node, "role:myole").each do  end
[2013-06-19 18:02:47 -0400] rracterr: nothing nice like search(:node, "role:myrole").count() ?  nothing is every clean enough
[2013-06-19 18:03:13 -0400] Otterley: I believe search will return a Hash if you don't give a block
[2013-06-19 18:03:27 -0400] Otterley: not completely certain off the top of my head though
[2013-06-19 18:03:46 -0400] Otterley: if you want higher performance and you're using Chef 11 server, use partial_search
[2013-06-19 18:04:02 -0400] Otterley: partial_search will definitely return a Hash
[2013-06-19 18:04:11 -0400] rracterr: coolies
[2013-06-19 18:04:26 -0400] Otterley: it will also save a lot of heap space
[2013-06-19 18:11:39 -0400] rracterr: I've got the nodes registering with route53 as they come up finally... so like machine03.lab02.domain.com   so I can stamp out multiple copies of the labs without conflict and yet still nicely organized
[2013-06-19 18:12:04 -0400] rracterr: now I just need a strategy about decomissioning
[2013-06-19 18:13:49 -0400] gswallow: @schisamo are you around?  Could you tell me why commands I send via winrm are being mangled?
[2013-06-19 18:17:48 -0400] Otterley: I like to call Chef an entropy engine; it's easier to make a mess with it than to clean things up
[2013-06-19 18:18:11 -0400] gchristensen: +1
[2013-06-19 18:18:23 -0400] chris613: Otterley: I'm going to use that line :P
[2013-06-19 18:18:30 -0400] mconigliaro: hey guys, does this work for anyone? http://tickets.opscode.com/browse/CHEF-1946
[2013-06-19 18:18:38 -0400] rracterr: agree completly
[2013-06-19 18:18:53 -0400] mconigliaro: supposedly this was closed 2 years ago, but I've never seen it work
[2013-06-19 18:19:34 -0400] mconigliaro: I'm trying to do "attribute :foo, :kind_of => String, :default => node['foo']" in an lwrp
[2013-06-19 18:19:49 -0400] Otterley: mconigliaro, I've never had it work either, but I've worked around it in my provider code
[2013-06-19 18:19:51 -0400] mconigliaro: i always get oMethodError: undefined method `[]' for nil:NilClass
[2013-06-19 18:20:08 -0400] mconigliaro: hmm
[2013-06-19 18:20:47 -0400] mconigliaro: funny that this has been closed for 2 years, it doesn't work, but nobody reopened the ticket
[2013-06-19 18:20:48 -0400] idlemichael: how does the Chef::Config['chef_server_url'] field get populated on teh client side?
[2013-06-19 18:21:18 -0400] nmeunier: Does anyone has a recommendation for a cookbook to create new deploy keys to github (for private repos)?
[2013-06-19 18:21:34 -0400] Otterley: idlemichael, it's initialized from /etc/chef/client.rb
[2013-06-19 18:22:02 -0400] gchristensen: nmeunier: I have one that solves that problem, but not the cleanup problem: https://github.com/zippykid/chef-github-deploy-key
[2013-06-19 18:22:07 -0400] idlemichael: how you use the chef-client cookbook Otterley ?
[2013-06-19 18:22:25 -0400] GreatSUN: hi all
[2013-06-19 18:22:49 -0400] GreatSUN: can someone of you guys tell me how I can add a dependency within a recipe instead of metadata.rb
[2013-06-19 18:22:54 -0400] Otterley: we do use it, but you have to be super careful if you're using initscripts as your start method, because upon updating any config files chef will turn around and kill itself
[2013-06-19 18:23:02 -0400] Otterley: it's kind of  dumb
[2013-06-19 18:23:20 -0400] nmeunier: gchristensen: thanks, I'm gonna look into it. Not aware of the "cleanup problem" though?
[2013-06-19 18:23:58 -0400] gchristensen: nmeunier: well it creates the SSH keys, but doesn't delete them if your node get decomissioned.
[2013-06-19 18:24:15 -0400] gchristensen: nmeunier: so you may end up with many extra SSH keys registered (you can delete them all periodically and the node will re
[2013-06-19 18:24:20 -0400] gchristensen: -register the key, though.)
[2013-06-19 18:24:35 -0400] nmeunier: gchristensen: ok, this is good enough for me :)
[2013-06-19 18:24:46 -0400] gchristensen: cool.
[2013-06-19 18:24:51 -0400] nmeunier: I am new to chef
[2013-06-19 18:25:05 -0400] nmeunier: so right now just going through the learning curve...
[2013-06-19 18:25:11 -0400] nmeunier: fixing one problem at a time :)
[2013-06-19 18:25:39 -0400] Otterley: custom Rakefiles are super helpful too, if you can wrap all the cleanup in Rake tasks and avoid calling knife directly
[2013-06-19 18:25:46 -0400] nmeunier: right now apache2 complains that it cannot find the repo for the web app so integration with github is my last roadblock
[2013-06-19 18:26:17 -0400] Otterley: otherwise I hope Chef server will support custom web hooks/triggers some day
[2013-06-19 18:26:29 -0400] GreatSUN: no one that knows how to do that?
[2013-06-19 18:30:35 -0400] cwj: GreatSUN: you cant really do that. if you omit dependencies from metadata.rb and ensure that the dependencies are otherwise in the run list (e.g. via roles) but it will cause you problems down the road
[2013-06-19 18:31:40 -0400] GreatSUN: cwj: I just don't want the attributes of the dependency to be loaded
[2013-06-19 18:33:25 -0400] cwj: GreatSUN: i suggest that you consider explicitly overriding the attributes from the cookbook that you dont want
[2013-06-19 18:33:26 -0400] Otterley: what will happen if they are?
[2013-06-19 18:33:56 -0400] GreatSUN: cwj: it is not the attributes set, but the attributes file loaded
[2013-06-19 18:34:30 -0400] GreatSUN: it is about stuff that comes up with the cookbooks attributes not with the attributes themselves
[2013-06-19 18:34:38 -0400] cwj: what is the distinction? the attributes file contains code?
[2013-06-19 18:35:06 -0400] GreatSUN: cwj: there is some log-output I don't want to have if I don't need the cookbook itself
[2013-06-19 18:35:15 -0400] rracterr: Have I somehow missed the metadata that targets a recipe to a specific platform?  Having recipes that only work on windows blowing off on linux sucks... system should know enough to ignore them if they have a platform designation
[2013-06-19 18:35:18 -0400] ddyke: clear
[2013-06-19 18:36:08 -0400] GreatSUN: rracterr: or you have lwrp's that know how to handle stuff for each OS
[2013-06-19 18:36:15 -0400] GreatSUN: or code...
[2013-06-19 18:36:31 -0400] rracterr: yes, but that just leads to exception based coding... ugly stuff seeing those if's all around the code
[2013-06-19 18:36:34 -0400] cwj: GreatSUN: dunno what to recommend in that case, but i do think that trying to juke dependencies is a bad practice
[2013-06-19 18:36:55 -0400] runfromnowhere: rracterr: It should be viable to use the platform information ohai retrieves to target your cookbooks, no?
[2013-06-19 18:36:56 -0400] rracterr: and from what I can tell the LWRP's in the community tend to be fairly focused on specific platforms which also begs for a platform tag
[2013-06-19 18:36:59 -0400] GreatSUN: rracterr: exception based? an if platform = windows is an exception for you?
[2013-06-19 18:37:35 -0400] runfromnowhere: I think that right now cookbooks and LWRPs are still wild enough that you're gonna have to read them before you grab and use them
[2013-06-19 18:37:36 -0400] cwj: rracterr: chef's cookbook dependency system leaves something to be desired in the sense that a node shouldnt have to download the windows cookbook as a dependency if its never going to run that code (e.g. node's platform is something other than windows)
[2013-06-19 18:37:41 -0400] GreatSUN: cwj: kk
[2013-06-19 18:38:04 -0400] GreatSUN: cwj: do you know if I can check extended runlist within attributes?
[2013-06-19 18:38:21 -0400] cwj: but just because a cookbook depends on 'windows' and the node downloads it, doesn't necessarily mean that any code from the windows cookbook is going to run
[2013-06-19 18:38:40 -0400] GreatSUN: cwj: right
[2013-06-19 18:39:13 -0400] cwj: GreatSUN: expanded run list contents should be populated into node['roles'] and node['recipies']
[2013-06-19 18:39:27 -0400] gondoi: schisamo: I've never seen this search for users like this is that provided by the users cookbook? or is it built in to search local users?
[2013-06-19 18:39:44 -0400] gondoi: https://github.com/schisamo-cookbooks/znc/blob/master/recipes/default.rb#L62
[2013-06-19 18:40:13 -0400] cwj: gondoi: i think thats based on the pattern established by the 'users' cookbook
[2013-06-19 18:40:31 -0400] gondoi: okay
[2013-06-19 18:40:32 -0400] idlemichael: interesting, Otterley. I didn't know that. I'm curious though -- if you want to, say, update the server dns in a chef client via this cookbook would you just do that by 'overriding' it in the attributes, or in a wrapper to the cookbook or something?
[2013-06-19 18:40:39 -0400] cwj: in that case, its a databag called 'users'
[2013-06-19 18:40:42 -0400] idlemichael: woah, late question
[2013-06-19 18:40:42 -0400] GreatSUN: cwj: so node['recipies'].include?('cookbook::recipe') should work within attributes?
[2013-06-19 18:41:06 -0400] cwj: GreatSUN: i dont think it works within attributes, just recipes
[2013-06-19 18:41:26 -0400] cwj: but you can try it :)
[2013-06-19 18:44:09 -0400] Otterley: GreatSUN, I would advise against that kind of code
[2013-06-19 18:44:25 -0400] Otterley: setting attributes based on a run list is discouraged practice
[2013-06-19 18:44:53 -0400] GreatSUN: Otterley: this is nothing I would like to do
[2013-06-19 18:45:20 -0400] Otterley: well, what is the problem you're trying to solve?  maybe there's another way
[2013-06-19 18:45:35 -0400] cwj: GreatSUN: whats the purpose of outputting log entries based on the attributes?
[2013-06-19 18:45:42 -0400] cwj: seems like that belongs inside the recipe
[2013-06-19 18:45:50 -0400] cwj: since recipes can override attributes
[2013-06-19 18:46:01 -0400] GreatSUN: Otterley: there is some "LOG" output I don't want to see when there is no recipe from the cookbook
[2013-06-19 18:46:30 -0400] Otterley: afraid I can't help you there
[2013-06-19 18:46:55 -0400] GreatSUN: cwj: there is some log-output on how to change and add attributes and what to set
[2013-06-19 18:47:44 -0400] cwj: heh chef run seems like the wrong time to provide that info
[2013-06-19 18:47:57 -0400] cwj: like driving lessons at freeway speed
[2013-06-19 18:48:10 -0400] Otterley: which cookbook is doing this?
[2013-06-19 18:48:19 -0400] GreatSUN: cwj: might be, but adding that output to all recipes is against object orientation
[2013-06-19 18:48:58 -0400] GreatSUN: also if you add a recipe just to output log info onto attributes and add this to every recipe
[2013-06-19 18:49:10 -0400] rracterr: seems like a stretch... how is diagnostic output conflated with encapsulation?
[2013-06-19 18:49:23 -0400] GreatSUN: this is in my opinion not the right way
[2013-06-19 18:52:29 -0400] vaq: I have some problem registering clients, In my chef server I saw Failed to authenticate. Ensure that your client key is valid - So I deleted /etc/chef/validation.pem and restarted chef server so it would re-create it
[2013-06-19 18:52:38 -0400] vaq: now when I try to register a client through chef-client -K /etc/chef/validation.pem
[2013-06-19 18:52:40 -0400] mlen: What is the convention for naming attributes? Should it be 'very-long-name' or 'very_long_name'?
[2013-06-19 18:52:48 -0400] vaq: I still get HTTP Request Returned 401 Unauthorized: Failed to authenticate. Ensure that your client key is valid.
[2013-06-19 18:53:01 -0400] Otterley: mlen, best practice is to namespace by cookbook, and use underscores
[2013-06-19 18:53:11 -0400] Otterley: e.g. node["mycookbook"]["myattribute"]
[2013-06-19 18:53:58 -0400] mlen: Otterley: Thanks! And how about cookbook names? Should I also use underscores?
[2013-06-19 18:54:18 -0400] Otterley: no opinion there
[2013-06-19 18:54:22 -0400] Otterley: we have a mix of both
[2013-06-19 18:54:23 -0400] cwj: use underscores
[2013-06-19 18:54:25 -0400] cwj: imo
[2013-06-19 18:55:04 -0400] cwj: if you ever try to reference the attrs as symbols and they contain dashes, you will probably have a problem
[2013-06-19 18:57:37 -0400] vaq: http://pastebin.ca/2402527
[2013-06-19 18:57:54 -0400] vaq: This is what I did to generate a new validation and webui.pem
[2013-06-19 18:58:16 -0400] vaq: but it still fails
[2013-06-19 18:58:18 -0400] vaq: any idea?
[2013-06-19 18:59:05 -0400] jgood: is there a way i can have a resource run a notify if a file exists, and run a bash command if it does not?
[2013-06-19 18:59:22 -0400] monokrome: Does anyone know what version of Chef this will be / is in? https://github.com/opscode/chef/pull/595
[2013-06-19 19:01:11 -0400] jgood: can i simply just place the notify and command in a if/else conditional
[2013-06-19 19:01:43 -0400] jgood: based on File.exist?()
[2013-06-19 19:02:00 -0400] btm: @opscode #opschef code review, join: https://plus.google.com/hangouts/_/1dda9be168111fcf9ff23175d8f5ac61fd4427d6, watch: http://youtu.be/1udVjOmm_Fc
[2013-06-19 19:02:51 -0400] avi: hey there, which version is the last ?
[2013-06-19 19:03:02 -0400] avi: is 10.2 latest?
[2013-06-19 19:03:12 -0400] vaq: anyone??
[2013-06-19 19:03:40 -0400] Guest62889: vaq do u know whats the latest chef version ?
[2013-06-19 19:04:05 -0400] vaq: 11
[2013-06-19 19:04:48 -0400] Guest62889: thx
[2013-06-19 19:05:46 -0400] rracterr: anything that can be done to improve recipe syncronization times? seems horribly slow
[2013-06-19 19:06:27 -0400] monokrome: Get a coffee! :D
[2013-06-19 19:11:03 -0400] vaq: http://pastebin.ca/2402527 - is this a bug in debian wheezy using chef 10 ?
[2013-06-19 19:13:32 -0400] qhartman: vaq, if you can use a newer chef, like 10.24 or newer, give that a shot. I seem to remember seeing something like that and upgrading fixed it. Not sure though
[2013-06-19 19:14:16 -0400] vaq: qhartman: my sources.list has deb http://apt.opscode.com/ wheezy-0.10 main
[2013-06-19 19:15:15 -0400] vaq: qhartman: can I change it to 10.24 ^ ?
[2013-06-19 19:15:24 -0400] qhartman: hm, not sure then. I switched to omnibus installed ones so it's easier to keep up with current
[2013-06-19 19:15:40 -0400] vaq: I can't use the omnibus installer :(
[2013-06-19 19:15:41 -0400] qhartman: I don't know what's in the opscode repo
[2013-06-19 19:16:05 -0400] vaq: I can only select Ubuntu on the omnibus installer page
[2013-06-19 19:16:13 -0400] vaq: and if I use the ubuntu deb i get a GLIBC error
[2013-06-19 19:16:21 -0400] qhartman: It will probably work fine on wheezy
[2013-06-19 19:16:23 -0400] qhartman: ah
[2013-06-19 19:16:24 -0400] qhartman: nm
[2013-06-19 19:17:03 -0400] qhartman: are you sure the validation.pem you have there works?
[2013-06-19 19:17:12 -0400] vaq: I removed it
[2013-06-19 19:17:17 -0400] vaq: and let chef-server make it again
[2013-06-19 19:17:18 -0400] vaq: http://tickets.opscode.com/browse/CHEF-4077
[2013-06-19 19:17:25 -0400] vaq: he has the same issue with chef-solr as I do
[2013-06-19 19:17:38 -0400] vaq: chef-solr gives errors in the log file with SolrDispatchFilter
[2013-06-19 19:17:56 -0400] tabolario: anyone mind giving me some feedback on this? https://gist.github.com/tabolario/43d8233e904b1035aae0
[2013-06-19 19:18:03 -0400] qhartman: huh, yeah, sorry, I have to run to a meeting, I don't think I have any other ideas right off the top
[2013-06-19 19:18:11 -0400] tabolario: attempting to get postgresql running on an ebs raid array
[2013-06-19 19:19:07 -0400] perezd: hey, all trying to run the rabbitmq cookbook on AWS's chef/opsworks platform and getting error undefined method for "default_action"
[2013-06-19 19:19:18 -0400] perezd: is there a chef version conflict occurring? can I patch this myself?
[2013-06-19 19:23:33 -0400] CharlieSu: Best way to do a conditional include_recipe based on a nodes runlist?  I'd like to omit an include if a server has a certain role..
[2013-06-19 19:24:09 -0400] perezd: k
[2013-06-19 19:28:29 -0400] Otterley: CharlieSu, I would advise guarding on a boolean node attribute instead of checking the run list
[2013-06-19 19:28:47 -0400] CharlieSu: Otterley: just did that since I didn't get a reply.. thanks
[2013-06-19 19:36:37 -0400] juliancdunn: perezd: Opsworks runs a really old Chef version
[2013-06-19 19:36:52 -0400] juliancdunn: and things like "default_action" are only available in Chef 11
[2013-06-19 19:36:54 -0400] perezd: ah
[2013-06-19 19:36:58 -0400] juliancdunn: so complain to Amazon :-P
[2013-06-19 19:37:33 -0400] juliancdunn: (unless you want to fork & maintain the rabbitmq cookbook yourself)
[2013-06-19 19:38:12 -0400] perezd: wondering if in this case I can just comment out default_action
[2013-06-19 19:38:28 -0400] juliancdunn: perezd: no, but you can replace it with the old idiomatic way of doing things in chef 10
[2013-06-19 19:38:33 -0400] juliancdunn: let's see if I can find that for you
[2013-06-19 19:38:34 -0400] perezd: which was?
[2013-06-19 19:40:53 -0400] juliancdunn: perezd: have a look at https://github.com/opscode/chef-fundamentals/blob/master/slides/lwrp-introduction/01_slide.md#default-action
[2013-06-19 19:41:01 -0400] juliancdunn: that "def initialize" block was the old way of doing it
[2013-06-19 19:42:10 -0400] perezd: so just define that in say..plugin.rb?
[2013-06-19 19:42:50 -0400] perezd: juliancdunn: https://github.com/opscode-cookbooks/rabbitmq/blob/master/resources/plugin.rb
[2013-06-19 19:42:52 -0400] perezd: this is the file in question
[2013-06-19 19:43:18 -0400] juliancdunn: perezd: yes, replace line 21
[2013-06-19 19:43:28 -0400] perezd: with initialize etc..
[2013-06-19 19:43:32 -0400] juliancdunn: you got it
[2013-06-19 19:43:38 -0400] perezd: that seems weird, since this isn't actually a class file
[2013-06-19 19:43:58 -0400] juliancdunn: perezd: the LWRP framework generates classes for you
[2013-06-19 19:44:00 -0400] perezd: ah
[2013-06-19 19:44:18 -0400] perezd: lol damn it
[2013-06-19 19:44:25 -0400] perezd: one of the other files has this exact code
[2013-06-19 19:44:31 -0400] perezd: stupid me
[2013-06-19 19:47:16 -0400] perezd: thank you juliancdunn !
[2013-06-19 19:47:21 -0400] perezd: hopefully it works
[2013-06-19 19:47:45 -0400] juliancdunn: perezd: this part should - I can't guarantee there aren't other Chef 10 incompatibilities :-)
[2013-06-19 19:48:19 -0400] perezd: we'll see!
[2013-06-19 19:54:02 -0400] CharlieSu: stormerider: http://www.pagerduty.com/docs/guides/nagios-integration-guide/
[2013-06-19 19:55:02 -0400] stormerider: CharlieSu: thanks
[2013-06-19 19:55:10 -0400] CharlieSu: stormerider: no problem..  works great btw
[2013-06-19 20:05:04 -0400] perezd: juliancdunn: new one: undefined local variable or method `use_inline_resources' for xxx
[2013-06-19 20:05:09 -0400] perezd: apt cookbook :(
[2013-06-19 20:05:27 -0400] Majost: New hangout for cookbook review?
[2013-06-19 20:07:47 -0400] Majost: Or no cookbook code reviews today?
[2013-06-19 20:08:19 -0400] btm: Majost: trying to find opscode folks, jtimberman is away at velocity.
[2013-06-19 20:08:24 -0400] Majost: ahh
[2013-06-19 20:08:45 -0400] btm: Majost: was there a ticket you wanted to look at?
[2013-06-19 20:08:53 -0400] Majost: I have two
[2013-06-19 20:09:24 -0400] btm: Majost: which ones?
[2013-06-19 20:09:30 -0400] Majost: one sec
[2013-06-19 20:09:37 -0400] Majost: ccccccctdnvntunthtvjudvhtudkggienndfvrhgvcng
[2013-06-19 20:09:59 -0400] gchristensen: +1
[2013-06-19 20:10:05 -0400] Majost: oops
[2013-06-19 20:10:06 -0400] Majost: hah
[2013-06-19 20:10:28 -0400] Majost: welp... that otp is forever logged in history.
[2013-06-19 20:10:52 -0400] Majost: COOK-3203
[2013-06-19 20:10:57 -0400] Majost: and COOK-3204
[2013-06-19 20:12:04 -0400] Majost: there are really simple one-line changes
[2013-06-19 20:12:15 -0400] Majost: but I am just trying to get the pull request accepted.
[2013-06-19 20:14:04 -0400] Majost: also, COOK-3195 I think is an invalid issue
[2013-06-19 20:14:55 -0400] vaq: where do I upload new bootstrap erb files to
[2013-06-19 20:14:59 -0400] Majost: but I do not have a rhel instance, nor does the ticket describe how to reproduce it.
[2013-06-19 20:15:01 -0400] vaq: when installed from omnibus chef-server
[2013-06-19 20:15:50 -0400] btm: vaq: for use with knife bootstrap -d?
[2013-06-19 20:17:10 -0400] theNetImp: do we have any knife-ec2 experts hanging around?
[2013-06-19 20:17:12 -0400] btm: @opscode cookbook code review: join: https://plus.google.com/hangouts/_/ea2b94e6d8774909e4d90c4feddb155711a233e6, watch: http://youtu.be/qZDBMmdNszI
[2013-06-19 20:17:16 -0400] btm: Majost: --^
[2013-06-19 20:17:23 -0400] Majost: btm: thanks
[2013-06-19 20:19:18 -0400] theNetImp: using hosted chef knife-ec2 isn't setting the ec2 attribute for the node, which keeps me from being able to get ec2.public_hostname
[2013-06-19 20:19:30 -0400] theNetImp: anyone else have this problem and know how to get around it?
[2013-06-19 20:28:11 -0400] Majost: Has anyone encountered this: $ gem install test-kitchen --no-ri --no-rdoc
[2013-06-19 20:28:11 -0400] Majost: ERROR:  While executing gem ... (Gem::DependencyError)
[2013-06-19 20:28:11 -0400] Majost:     Unable to resolve dependencies: test-kitchen requires mixlib-cli (~> 1.2.2); vagrant requires net-ssh (~> 2.2.2), net-scp (~> 1.0.4)
[2013-06-19 20:29:46 -0400] perezd: any idea what this means? Source for package /opt/aws/opsworks/releases/20130613204540_123/conf/../rabbitmq-server_3.0.4-1_all.deb required for action install
[2013-06-19 20:29:56 -0400] perezd: does it anticipate that I am providing the deb?
[2013-06-19 20:31:07 -0400] vaq: https://github.com/spheromak/knife-xapi
[2013-06-19 20:31:13 -0400] jasonv_: Hey, I'm trying to setup a chef environment, but I need it to be fault tolerant, it's going to be contained inside of openstack. I'm starting from scratch here as I'm a chef newbie, so my basics are going to start with, what components currently make up a chef server (I'm assuming it's RabbitMQ, Postgres,  Solr, nginx, and the erlang pieces). If you have a link that can point me in the right direction that would help.
[2013-06-19 20:31:16 -0400] vaq: who do I install this gem into the omnibus chef installation?
[2013-06-19 20:31:22 -0400] vaq: if I use gem, it will install another copy of chef :(
[2013-06-19 20:31:51 -0400] spheromak: vaq on a client ?
[2013-06-19 20:32:01 -0400] vaq: spheromak: I use knife on the server
[2013-06-19 20:32:23 -0400] vaq: vaq: I need the knife xapi module on the same machine I have installed Chef-Server through the omnibus installer
[2013-06-19 20:32:26 -0400] spheromak: you could install it with chef_gem  in a recipe, or you can call the omni chef's gem from /opt/chef/bin
[2013-06-19 20:32:29 -0400] vaq: vaq: chef is located in /opt/chef
[2013-06-19 20:33:06 -0400] vaq: spheromak: how do I install it through opt/chef/bin ?
[2013-06-19 20:33:13 -0400] spheromak: with gem
[2013-06-19 20:33:21 -0400] sebastian: Hi guys, any one familiar with this? FATAL: Chef::Exceptions::RecipeNotFound: could not find recipe php5 for cookbook php
[2013-06-19 20:33:37 -0400] vaq: spheromak: but gem install knife-xapi will install chef and another knife cmd
[2013-06-19 20:33:42 -0400] sebastian: it was after trying to build a guest with sugarcrm cookbook
[2013-06-19 20:33:52 -0400] perezd: I just verified the .deb file is in the root of the repo...
[2013-06-19 20:33:53 -0400] spheromak: vaq,  use the gem bindary in the omni chef install
[2013-06-19 20:33:54 -0400] perezd: on chef
[2013-06-19 20:34:12 -0400] vaq: spheromak: sorry what?
[2013-06-19 20:34:27 -0400] vaq: ahh
[2013-06-19 20:34:39 -0400] vaq: spheromak: /opt/chef/embedded/bin/gem install knife-xapi ?
[2013-06-19 20:34:51 -0400] spheromak: vaq,  yes
[2013-06-19 20:35:06 -0400] tabolario: sebastian: are you using the opscode php cookbook? if so, there's no recipe called php5, just use the default recipe and it will install php from packages
[2013-06-19 20:35:10 -0400] spheromak: *binary :P sorry for typo
[2013-06-19 20:35:25 -0400] perezd: werid, the file_cache_path for AWS OpsWorks is odd
[2013-06-19 20:36:11 -0400] sebastian: tabolario: thanks for your attention, I've downloaded both cookbooks from the opsccode site
[2013-06-19 20:36:38 -0400] stormerider: perezd: my understanding is a lot of OpsWorks is odd :) since it's based on 9.x but has tweaks
[2013-06-19 20:36:48 -0400] sebastian: sounds to you that the php cookbook might be with an issue?
[2013-06-19 20:36:58 -0400] perezd: I think I'll just rewrite the paths to go to /tmp
[2013-06-19 20:37:04 -0400] perezd: its a deb file afterall :/
[2013-06-19 20:37:36 -0400] tabolario: sebastian: what are you using in your runlist? sounded from your question like you might've specified php::php5
[2013-06-19 20:37:53 -0400] sebastian: checking...
[2013-06-19 20:37:54 -0400] tabolario: should just be recipe[php::default] or recipe[php] with the opscode cookbook
[2013-06-19 20:43:10 -0400] sebastian: ok I've saw this in the log, gues it confirms your guess:  [2013-06-19T17:52:07+00:00] DEBUG: Loading Recipe php::php5 via include_recipe
[2013-06-19 20:43:36 -0400] sebastian: tabolario: I should find what file is specifying that code :/
[2013-06-19 20:43:43 -0400] sebastian: searching..
[2013-06-19 20:45:54 -0400] stormerider: hm. i'm defining a nagios service escalation as follows, but I'm still getting warnings every 10m... any ideas? https://gist.github.com/stormerider/5817835
[2013-06-19 20:58:04 -0400] vaq: Hi
[2013-06-19 20:58:16 -0400] vaq: I just created a empty cookbook and bootstrapped a VM with recipe: base
[2013-06-19 20:58:17 -0400] nmeunier: gchristensen: can I use a Personal API Access Token for your cookbook or do I have to register a fake app to get a client id and client_secret?
[2013-06-19 20:58:25 -0400] vaq: it exists with an error
[2013-06-19 20:58:26 -0400] vaq: http://pastebin.ca/2402579
[2013-06-19 20:58:50 -0400] vaq: knife cookbook test base says its fine
[2013-06-19 20:59:12 -0400] gchristensen: nmeunier: that should be fine.
[2013-06-19 20:59:39 -0400] nmeunier: gchristensen: didn't work for me
[2013-06-19 21:00:13 -0400] nmeunier: gchristensen: in the gh_repo, should I not put the full github url?
[2013-06-19 21:01:03 -0400] nmeunier: gchristensen: have you tried it with just a personal API Access token?
[2013-06-19 21:02:18 -0400] gems: Can anyone please give me advice how to handle a role that has a runlist that is slightly different between different environments, but everything else stays the same?  I don't want to have to create multiple roles...
[2013-06-19 21:02:20 -0400] perezd: ugh new one: [Wed, 19 Jun 2013 21:00:12 +0000] DEBUG: Re-raising exception: NoMethodError - undefined method `run_action' for "service[rabbitmq-server]":String
[2013-06-19 21:02:21 -0400] perezd: any ideas?
[2013-06-19 21:02:29 -0400] perezd: says chef/runner.rb:53 run_action
[2013-06-19 21:03:18 -0400] gchristensen: nmeunier: see the example, gh_repo is "mycompany/myrepo" not github.com/mycompany/myrepo.git"
[2013-06-19 21:03:33 -0400] nmeunier: gchristensen: constantly getting a ArgumentError: uncaught throw "Could not retrieve key list: {\"message\":\"Not Found\"}".
[2013-06-19 21:03:43 -0400] nmeunier: gchristensen: will look at it right away
[2013-06-19 21:03:57 -0400] nmeunier: gchristensen: yeah, I tried this as well
[2013-06-19 21:04:49 -0400] perezd: is there a particular version of the rabbitmq cookbook that can be trusted to work with Chef 0.8 ?
[2013-06-19 21:04:50 -0400] nmeunier: gchristensen:github_deploy_key "reponsive_home" do
[2013-06-19 21:04:51 -0400] nmeunier:   path "/home/app/apps/responsive_home"
[2013-06-19 21:04:53 -0400] nmeunier:   owner "app"
[2013-06-19 21:04:54 -0400] nmeunier:   gh_token "..."
[2013-06-19 21:04:55 -0400] nmeunier:   gh_repo "my_company/responsive_home.git"
[2013-06-19 21:04:56 -0400] nmeunier: end
[2013-06-19 21:05:13 -0400] gchristensen: nmeunier: remove the .git
[2013-06-19 21:05:21 -0400] gchristensen: also, use a pastebin or gist.github.com or something like it.
[2013-06-19 21:05:24 -0400] perezd: I'm assuming <2.0 ?
[2013-06-19 21:06:08 -0400] Majost: btm: I created a fresh rvm environment, and did a gem install for chef, berkshelf, and test-kitchen and got the same error
[2013-06-19 21:06:21 -0400] nmeunier: gchristensen: you're right sorry for that. trying again without the .git. Thanks
[2013-06-19 21:06:54 -0400] Majost: btm: correction -- fresh rvm gemset, not environment.
[2013-06-19 21:08:02 -0400] nmeunier: gchristensen: Thanks for catching the .git issue. Now, I'm getting a "key is invalid. It must begin with 'ssh-rsa' or 'ssh-dss'. Check that you're copying the public half of the key". At least, it's progress already :)
[2013-06-19 21:09:09 -0400] tabolario: should i feel weird/bad about the way i accomplished this? https://gist.github.com/tabolario/e9382fd726d2f673454f
[2013-06-19 21:11:42 -0400] Otterley: tabolario, it depends, it won't be atomic if the mv crosses filesystem boundaries
[2013-06-19 21:12:00 -0400] btm: Majost: what version of test-kitchen?
[2013-06-19 21:12:36 -0400] tabolario: Otterley: crap good point; the point of this was that i have another cookbook that i run in between psotgresql::server and this one that creates an ebs raid array
[2013-06-19 21:13:37 -0400] tabolario: this whole thing should only ever run once when a postgres box is created for the first time
[2013-06-19 21:14:35 -0400] tabolario: oh but hmm. is there a way to pass debian config in to a package resource? perhaps i could just run the raid array creation before postgres is even installed and then point it to that location when it's installing the package
[2013-06-19 21:14:47 -0400] Otterley: yes, there is
[2013-06-19 21:15:17 -0400] Majost: btm: 1.0.0.alpha.7 I think
[2013-06-19 21:15:28 -0400] Otterley: tabolario, http://docs.opscode.com/resource_apt_package.html
[2013-06-19 21:15:45 -0400] Majost: btm take that back
[2013-06-19 21:16:24 -0400] tabolario: Thank you!
[2013-06-19 21:16:36 -0400] Majost: ahh
[2013-06-19 21:16:47 -0400] Majost: it was 0.7.0 as that is what 'gem install test-kitchen' uses
[2013-06-19 21:19:28 -0400] btm: Majost: yeah, that's what I'm seeing, gotta use 'gem --pre'
[2013-06-19 21:19:59 -0400] Majost: or rtfm. heh
[2013-06-19 21:20:13 -0400] Majost: I just noticed the first line in the README.md for test-kitchen
[2013-06-19 21:20:14 -0400] Majost: hah
[2013-06-19 21:20:53 -0400] tabolario: crap there's no debconf setting for the data directory
[2013-06-19 21:21:42 -0400] Otterley: tabolario, can you mount the fs in the standard location before installing pg?
[2013-06-19 21:21:57 -0400] Otterley: that's what we do for mysql, it seems to cause the fewest hassles
[2013-06-19 21:23:22 -0400] tabolario: i was thinking of trying that i would need to create the postgres user though and i'm not sure if the packages will install if it's already there
[2013-06-19 21:23:28 -0400] tabolario: let me try that though...
[2013-06-19 21:26:42 -0400] kav_: hi, when i try to install rpm pkg from yum server using recipe. im gettin error " no candidate version for package name. pls advice.
[2013-06-19 21:28:01 -0400] aub: i just added a role for graphite whose run list is 'recipe[graphite]', and when I apply it to a node I'm getting a "Precondition Failed" error
[2013-06-19 21:28:25 -0400] aub: the cookbook is uploaded and visible in hosted chef's interface
[2013-06-19 21:28:39 -0400] aub: and in the error it has a section for "Missing Cookbooks" but it's empty
[2013-06-19 21:32:31 -0400] stormerider: anyone familiar with nagios service escalations using the nagios cookbook?
[2013-06-19 21:34:53 -0400] inconshreveable: is it possible to update an attribute of new_resource in lwrp?
[2013-06-19 21:34:56 -0400] inconshreveable: something like:
[2013-06-19 21:35:01 -0400] inconshreveable: new_resource.foo = "bar"
[2013-06-19 21:36:37 -0400] Otterley: inconshreveable, wouldn't you be controverting the user's intent by doing so?
[2013-06-19 21:37:26 -0400] inconshreveable: Otterley: what i really want is the ability to have a "return value" from a resource, but this seems like the closest i can get to it
[2013-06-19 21:37:36 -0400] Otterley:  for what purpose?
[2013-06-19 21:37:53 -0400] Otterley: that would defeat the purpose of Chef idempotency
[2013-06-19 21:38:28 -0400] Otterley: the outcome of a resource provision should not impact the behavior of subsequent actions
[2013-06-19 21:38:29 -0400] jessicab: inconshreveable: perhaps youre overthinking it? why not just have the lwrp set an attribute?
[2013-06-19 21:39:02 -0400] inconshreveable: jessicab: if i run the lwrp multiple times, wouldn't that cause the attribute to get clobbered?
[2013-06-19 21:39:24 -0400] Otterley: let's take a step back.  what problem are you trying to solve?
[2013-06-19 21:39:35 -0400] jessicab: no.. it would override whatever was set in the attribute, not add to it
[2013-06-19 21:39:42 -0400] inconshreveable: Otterley: i have a resource where you can pass it a file system path as an argument
[2013-06-19 21:39:47 -0400] inconshreveable: if you don't specify one
[2013-06-19 21:39:51 -0400] inconshreveable: it picks a default for you
[2013-06-19 21:40:03 -0400] inconshreveable: but that default is *calculated*
[2013-06-19 21:40:09 -0400] inconshreveable: perhaps this is a bad way to do things
[2013-06-19 21:40:25 -0400] inconshreveable: to be more concrete
[2013-06-19 21:41:02 -0400] inconshreveable: the resource has this:
[2013-06-19 21:41:05 -0400] inconshreveable: attribute :root_path, :kind_of => String, :default => nil
[2013-06-19 21:41:09 -0400] inconshreveable: and
[2013-06-19 21:41:10 -0400] inconshreveable: attribute :name, :kind_of => String, :name_attribute => true, :required => true
[2013-06-19 21:41:38 -0400] inconshreveable: if you don't set a root_path, i want it to set root path to "/var/foo/#{new_resource.name}"
[2013-06-19 21:41:54 -0400] inconshreveable: and i want you to know what root path it was set to
[2013-06-19 21:42:23 -0400] jessicab: you can do that down in initialize.. base attributes off other attributes
[2013-06-19 21:42:59 -0400] jessicab: just do a @root_path = "/var/foo/#{@name}"
[2013-06-19 21:43:01 -0400] Otterley: it was my understanding that resource provisioning should not have side effects with respect to the node's attributes, am I mistaken?
[2013-06-19 21:43:13 -0400] paulmooring: Otterley: you are correct that's the idea
[2013-06-19 21:43:35 -0400] Otterley: inconshreveable, I think to maintain consistent with Chef, you have to control the value from the top down
[2013-06-19 21:43:40 -0400] inconshreveable: okay, that's helpful
[2013-06-19 21:44:18 -0400] inconshreveable: there's never any notion of getting a value out of resource though, huh?
[2013-06-19 21:44:23 -0400] Otterley: IOW, declare a default value in the cookbook's attributes/default.rb file, then allow the user to override it
[2013-06-19 21:45:55 -0400] Otterley: inconshreveable, another option is to move this functionality into a library which would calculate the path for both the provider and other cookbooks, using the resource name as an input
[2013-06-19 21:46:03 -0400] jessicab: shrugs, i do that in a tomcat lwrp.. just set a node[cookbookname][nameattribute][tomcatbase] attribute at the end of a run so people can access it later.. sometimes i think it can be a good practice?
[2013-06-19 21:46:19 -0400] jessicab: like if they override it, then they can always get the value later on in a recipe dependably
[2013-06-19 21:46:37 -0400] jessicab: perhaps thats a bad practice though heh.. just makes life easier
[2013-06-19 21:46:39 -0400] inconshreveable: postgres does this for setting the password to your database
[2013-06-19 21:46:51 -0400] inconshreveable: but they do it at the recipe level
[2013-06-19 21:46:59 -0400] inconshreveable: and set a node attribute
[2013-06-19 21:47:07 -0400] Otterley: that sounds bad if you're using Chef server
[2013-06-19 21:47:13 -0400] Otterley: the cleartext will get stored in the node's attributes
[2013-06-19 21:47:42 -0400] Otterley: knife node show 'dbserver' <-- oops
[2013-06-19 21:56:21 -0400] piclez: anyone can help me to change the passenger_pre_start setting in the nginx::source recipe please?
[2013-06-19 22:12:53 -0400] ryanisna_: Hey all, I'm using the database/postgresql cookbooks and I'm trying to setup a db with tables having UTF8 encoding. I'm getting an error that I'm having a hard time understanding to fix, any pointers? FATAL: PG::Error: postgresql_database[sokanu] (baseconfig::createdb line 23) had an error: PG::Error: ERROR:  encoding UTF8 does not match locale en_US
[2013-06-19 22:12:53 -0400] ryanisna_: DETAIL:  The chosen LC_CTYPE setting requires encoding LATIN1.
[2013-06-19 22:19:33 -0400] scalp42: does anyone know what else should be done after signing CLA to have a PR reviewed in the hangout ?
[2013-06-19 22:19:34 -0400] scalp42: http://tickets.opscode.com/browse/COOK-3131
[2013-06-19 22:20:05 -0400] Otterley: mark the ticket as fix provided
[2013-06-19 22:20:13 -0400] scalp42: yeah already done
[2013-06-19 22:20:20 -0400] scalp42: could it be that there a lot of tickets or something?
[2013-06-19 22:20:25 -0400] Otterley: then you're good to go
[2013-06-19 22:20:47 -0400] Otterley: if you show up in the hangout and it doesn't get mentioned, bring it up, the guys there are pretty nice
[2013-06-19 22:20:55 -0400] tabolario: Otterley: success! my fears of having the user and home directory created before the package was installed were totally unfounded
[2013-06-19 22:20:55 -0400] scalp42: do you know what the time to expect to get reviewed?
[2013-06-19 22:21:14 -0400] scalp42: okay might do this, has been like almost 2 weeks gonna try next hangout
[2013-06-19 22:21:25 -0400] tabolario: i had to modify the aws cookbook to allow a different owner/group/mode for the mount point on ebs raid arrays though
[2013-06-19 22:21:28 -0400] scalp42: thanks for the heads up Otterley
[2013-06-19 22:24:33 -0400] invsblduck: anyone successfully using chef-shell 11.4.4?
[2013-06-19 22:25:43 -0400] Otterley:  somewhat
[2013-06-19 22:27:01 -0400] invsblduck: when i run in client mode (-z), i see the run_list is accurate and the cookbooks are downoladed to /var/chef/cache/cookbooks, but when I include_recipe i get a NameError: Cannot find a resource for apt_repository ...
[2013-06-19 22:27:52 -0400] invsblduck: Otterley: the cookbook that is using apt_repository lwrp correctly depends apt in its metadata, so not sure why it can't find it.  new to chef-shell/shef.
[2013-06-19 22:28:11 -0400] Otterley: that's beyond my ken, I haven't used chef-shell that way
[2013-06-19 22:29:06 -0400] invsblduck: Otterley: thanks
[2013-06-19 22:39:11 -0400] StDiluted: I didn't get an answer to this over at #learnchef, so maybe someone here can help? what would be the best method for a notify after a symbolic link is made, i.e.: link "/etc/nginx/sites-enabled/myapp" do \ to "/etc/nginx/sites-available/myapp"
[2013-06-19 22:39:24 -0400] StDiluted: (I want to restart nginx after)
[2013-06-19 22:41:12 -0400] Otterley: notifies :restart, "nginx"
[2013-06-19 22:41:18 -0400] Otterley: notifies :restart, "service[nginx]"
[2013-06-19 22:41:30 -0400] Otterley: however, :reload is probably better
[2013-06-19 22:42:37 -0400] StDiluted: sure, reload
[2013-06-19 22:43:00 -0400] StDiluted: however, where should I place that statement, just after the link statements?
[2013-06-19 22:43:22 -0400] StDiluted: seemed to me that most notifies statements were inside other blocks
[2013-06-19 22:43:37 -0400] tabolario: in the block
[2013-06-19 22:43:58 -0400] StDiluted: inside the link block?
[2013-06-19 22:44:05 -0400] tabolario: yup
[2013-06-19 22:49:48 -0400] StDiluted: Thanks tabolario, I asked because I didn't see that in the documentation anywhere
[2013-06-19 22:50:49 -0400] tabolario: No problem, the docs for it are actually here: http://docs.opscode.com/resource_common.html
[2013-06-19 22:51:09 -0400] tabolario: notifies is something that can be used with any resource
[2013-06-19 22:51:20 -0400] StDiluted: ah, makes sense. Thanks.
[2013-06-19 22:52:12 -0400] tabolario: Phew, finally got Postgres running on an EBS RAID10 array from scratch
[2013-06-19 22:52:15 -0400] tabolario: Now on to replication :)
[2013-06-19 22:52:27 -0400] StDiluted: how is performance with that?
[2013-06-19 22:52:35 -0400] tabolario: We shall see...
[2013-06-19 22:52:43 -0400] StDiluted: that's something I will be moving on to in the future for the app I'm working with
[2013-06-19 22:52:55 -0400] StDiluted: except with MySQL
[2013-06-19 22:53:20 -0400] tabolario: This is my first deployment on AWS and I've heard horror stories about EBS performance; i'll be using provisioned IOPS in production though so I imagine that will mitigate some of the issues people had in the past
[2013-06-19 22:53:46 -0400] StDiluted: we are using EBS volumes at the moment, but ust a single one
[2013-06-19 22:53:48 -0400] StDiluted: just*
[2013-06-19 22:53:58 -0400] StDiluted: and performance is... lacking.
[2013-06-19 22:54:07 -0400] StDiluted: XFS made it about 30% better
[2013-06-19 22:54:21 -0400] StDiluted: but we are still not liking the numbers
[2013-06-19 22:54:32 -0400] tabolario: Ah yep using XFS as well
[2013-06-19 22:55:00 -0400] tabolario: I'm not using PIOPs in my staging environment though atm so I'm not going to be able to get a good gauge on things until we get into production
[2013-06-19 22:55:12 -0400] tabolario: It'll probably be a bit before I have a clear picture
[2013-06-19 22:55:29 -0400] StDiluted: I might suggest that we use PIOPs once we start needing the performance
[2013-06-19 22:55:38 -0400] atomi: when I run knife solo cook me@ip it always asks me for a password even though I have my ssh keys in .ssh, how do I make chef use my ssh keys?
[2013-06-19 22:56:26 -0400] tabolario: atomi: First place I would check is your auth log on the server to see what's getting sent up
[2013-06-19 22:56:43 -0400] atomi: tabolario: good idea thanks
[2013-06-19 22:57:14 -0400] tabolario: Time for the commute...
[2013-06-19 23:22:03 -0400] Otterley: XFS is a Good Thing in general
[2013-06-19 23:22:19 -0400] Otterley: ext[2-4] have awful seek performance
[2013-06-19 23:22:44 -0400] Otterley: in large directories, even with dirhash enabled, and it gets worse as you delete files
[2013-06-19 23:24:20 -0400] rava`: hey guys, doing a knife upload to my chef 11 server keeps vailing with permission denied to /var/chef
[2013-06-19 23:24:39 -0400] rava`: i've set permissions on the filesystem to be owned by chef_server:chef_server, but no dice
[2013-06-19 23:24:42 -0400] rava`: any ideas?
[2013-06-19 23:24:52 -0400] Otterley: how did you install chef_server?  omnibus?
[2013-06-19 23:25:08 -0400] rava`: yes, via the 2.0 community cookbook
[2013-06-19 23:29:04 -0400] Otterley: that doesn't sound right.  omnibus chef_server doesn't use /var/chef
[2013-06-19 23:30:54 -0400] rava`: ERROR: Errno::EACCES: Permission denied - /var/chef
[2013-06-19 23:32:03 -0400] rava`: /opt/chef/embedded/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': Permission denied - /var/chef (Errno::EACCES)
[2013-06-19 23:32:31 -0400] Otterley: what does ~/.chef/knife.rb look like?
[2013-06-19 23:32:58 -0400] rava`: following this guide, the step for uploading: http://www.opscode.com/blog/2013/03/12/5106/
[2013-06-19 23:34:03 -0400] Otterley: hmm, that's not how we performed the upgrade. I wonder why he didn't use the knife backup plugin
[2013-06-19 23:34:20 -0400] rava`: how did you do your upgrade?
[2013-06-19 23:34:44 -0400] Otterley: https://github.com/mdxp/knife-backup
[2013-06-19 23:35:03 -0400] Otterley: just backup from chef 10 and restore to chef 11, it's that simple (tm)
[2013-06-19 23:35:11 -0400] rava`: i always used the knife-server plugin for backups
[2013-06-19 23:35:13 -0400] rava`: hrm
[2013-06-19 23:35:53 -0400] rava`: does it handle your client keys aswell?
[2013-06-19 23:36:03 -0400] Otterley: yes!
[2013-06-19 23:36:09 -0400] rava`: savvy
[2013-06-19 23:38:46 -0400] rava`: screw it, knife-backup install version now >.>
[2013-06-19 23:55:09 -0400] rb1980: ok, i can't find the answer anywhere, so will ask here... is it possible to "include" another erb template into a template?
[2013-06-19 23:59:06 -0400] rb1980: ah, yay just found it: tempate partials
