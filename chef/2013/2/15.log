[2013-02-15 00:01:09 -0500] fly9: calling the module recipe after nginx doesn't seem to recompile and calling it before fails because the folder structure is missing when it tries to add the conf
[2013-02-15 00:05:13 -0500] mmorris: Does anyone know the cause of systemexit errors?
[2013-02-15 00:05:24 -0500] mmorris: Error executing action `install` on resource 'java_ark[jdk]'
[2013-02-15 00:05:24 -0500] mmorris: ================================================================================
[2013-02-15 00:05:25 -0500] mmorris: SystemExit
[2013-02-15 00:05:26 -0500] mmorris: ----------
[2013-02-15 00:05:27 -0500] mmorris: exit
[2013-02-15 00:06:26 -0500] miah: please dont paste in the channel
[2013-02-15 00:07:19 -0500] tolland: ohai
[2013-02-15 00:09:09 -0500] fly9_: anyone familiar with nginx source install with modules? trying to install nginx with geoip and I'm not sure how to call the proper recipes in order to ensure it (re)compiles with geoip
[2013-02-15 00:09:19 -0500] fly9_: calling the module recipe after nginx doesn't seem to recompile and calling it before fails because the folder structure is missing when it tries to add the conf
[2013-02-15 00:10:05 -0500] tolland: ive got a node in aws that spun up about an hour ago, the log shows the "chef-client -j /tmp/firstrun.json" makes it all the way through to [2013-02-14T22:40:18+00:00] INFO: Chef Run complete in 128.287281 seconds
[2013-02-15 00:11:06 -0500] tolland: but i can see the chef-service that was configured by the run, also started [2013-02-14T22:40:18+00:00] INFO: Run List is []
[2013-02-15 00:12:03 -0500] tolland: looks like it clobbered the initial chef-client run_list
[2013-02-15 00:12:16 -0500] tolland: how to make that not happen?
[2013-02-15 00:13:11 -0500] miah: did you pass a runlist when you bootstrapped the node?
[2013-02-15 00:14:12 -0500] tolland: yes, so this is just one out of say 20 instances that has not run_list with the same initial invocation
[2013-02-15 00:14:24 -0500] tolland: its a json attribute
[2013-02-15 00:14:32 -0500] tolland: in that firstrun.json
[2013-02-15 00:15:28 -0500] tolland: so [2013-02-14T22:40:18+00:00] INFO: Run List is []
[2013-02-15 00:15:31 -0500] tolland: oops
[2013-02-15 00:15:45 -0500] tolland: Copy&Paste oops
[2013-02-15 00:17:59 -0500] tolland: the chef-client::service is at the begining of the run_list for the bootstrap, it looks like by the time the 128 seconds to complete the initial run has passed, the chef-service has started, and initiated a run
[2013-02-15 00:22:39 -0500] tolland: ok, i see there is a much newer chef-client cookbook available
[2013-02-15 00:31:49 -0500] svs_bbi: Anyone knows if when I retrieve various variables from the environment (in my recipe), using node [:environment][:variables], will I retrieve them in a JSON structure?
[2013-02-15 00:33:20 -0500] yfeldblum: svs_bbi, what is `node[:environment]`?
[2013-02-15 00:34:26 -0500] svs_bbi: it is an override attribute
[2013-02-15 00:34:55 -0500] svs_bbi: defined in my environment
[2013-02-15 00:36:09 -0500] tolland: is there a location to see which version of a cookbook was last run? the cache seems to contains a metadata.rb file from an old cookbook
[2013-02-15 00:37:07 -0500] tolland: even though its obviously run the new one
[2013-02-15 00:37:21 -0500] svs_bbi: yfeldblum: I am trying to retrieve a section of the environment attributes and create a JSON file in my node with them
[2013-02-15 00:39:14 -0500] yfeldblum: svs_bbi, `node[:some_key][:some_sub_key]` etc will return Ruby objects, not JSON
[2013-02-15 00:42:41 -0500] svs_bbi: yfeldblum: yes, I have tried creating a template to create the JSON. I use as a source an erb file that has the line <%= JSON.pretty_generate ((node[:some_key][:some_sub_key]).to_a) %> but the output formatting of the created file is not JSON
[2013-02-15 00:45:04 -0500] yfeldblum: svs_bbi, why are you calling #to_a ?
[2013-02-15 00:47:04 -0500] svs_bbi: yfeldblum: to convert the object to an array. However, if I take it out I get the same result
[2013-02-15 00:53:03 -0500] flaccid: i know this is likely non standard, but is there a way in an attributes file to override/merge/set attributes by bulk with json ?
[2013-02-15 00:56:12 -0500] svs_bbi: yfeldblum: I looked at that to_a again and it seems to be the problem. I am not sure what I did with it before but it has now created a JSON file with the correct formatting. Thank you very much
[2013-02-15 01:03:57 -0500] evxd: Does anyone know if there is a way to set the chef-client version when using the chef-client recipe? It looks like it installs 10.16.2 by default.
[2013-02-15 01:09:51 -0500] doomviking: evxd: doesn't look like it huh
[2013-02-15 01:10:21 -0500] timsmith: chef-client cookbook shouldn't be installing.  Just managing
[2013-02-15 01:52:26 -0500] tolland: why does the chef-client::service recipe have notifies :restart, "service[chef-client]", :delayed
[2013-02-15 01:52:34 -0500] tolland: when that is indeed, the default?
[2013-02-15 01:54:47 -0500] tolland: maybe i should try this, but does a service resource support a 'notifies :restart, "service[XXX]", :delayed' so it can startup delayed?
[2013-02-15 01:55:06 -0500] tolland: I mean notifying itself
[2013-02-15 02:27:34 -0500] bixu: I need to get the contents of a textfile that I curl from a service provider into a template.  Suggestions?
[2013-02-15 02:28:13 -0500] bixu: I think I need to create an array/hash as an attribute and do a .each in my template?
[2013-02-15 02:28:25 -0500] bixu: But I'm not very good at Ruby and I'm not sure how to do it :)
[2013-02-15 02:28:38 -0500] flaccid: bixu: remote_file resource
[2013-02-15 02:29:15 -0500] bixu: flaccid: I can't do that because I need to wrap the contents of the text file in other bits that I'm controlling in my template.
[2013-02-15 02:30:25 -0500] bixu: (I'm getting a list of IP ranges and turning them into ipfilter rules.)
[2013-02-15 02:30:52 -0500] flaccid: is the remote file variable?
[2013-02-15 02:34:06 -0500] bixu: It may change, yes.
[2013-02-15 02:34:10 -0500] bixu: I don't have any control over it.
[2013-02-15 02:34:17 -0500] flaccid: you probably need to learn ruby then
[2013-02-15 02:34:29 -0500] flaccid: the goal being to download that and assign it to a string, then process it
[2013-02-15 02:34:35 -0500] bixu: Yes.
[2013-02-15 02:34:41 -0500] flaccid: what format is it?
[2013-02-15 02:34:47 -0500] bixu: Plain text.
[2013-02-15 02:34:55 -0500] flaccid: what is the data structure?
[2013-02-15 02:35:23 -0500] bixu: Newline-separated strings?
[2013-02-15 02:35:47 -0500] flaccid: never heard of it. csv ?
[2013-02-15 02:35:50 -0500] flaccid: whichever way, thats more of a ruby question than chef
[2013-02-15 02:36:16 -0500] bixu: Each line is something like [IP address]/[Netmask]
[2013-02-15 02:37:58 -0500] bixu: I've been passing the string I'm curling to .gsub(/\n/," ") to get a clean array of values.
[2013-02-15 02:38:18 -0500] flaccid: well its pretty easy to do line by line in ruby and put it in a hash or array first etc. you just need to google and learn ruby
[2013-02-15 02:38:28 -0500] flaccid: also #ruby
[2013-02-15 02:38:38 -0500] bixu: Okay.
[2013-02-15 02:40:09 -0500] bixu: Is it even reasonable to pass an array to a single attribute in attributes/default.rb ?
[2013-02-15 02:42:55 -0500] flaccid: yes
[2013-02-15 02:43:06 -0500] flaccid: arrays and hashes are used for node attributes all the time
[2013-02-15 03:24:13 -0500] cheflevelramen: Quick question for anyone on. How do you pass variables between chef resources?
[2013-02-15 03:24:47 -0500] cheflevelramen: I have a ruby block that has variables that I want to pass to a template resource
[2013-02-15 03:25:12 -0500] flaccid: i don't think thats possible. likely wrong technique
[2013-02-15 03:33:37 -0500] cheflevelramen: flaccid: Dang. I use a ruby block to search for nodes in the server group, and those get added to a template.
[2013-02-15 03:33:49 -0500] cheflevelramen: *and add those
[2013-02-15 03:34:15 -0500] flaccid: i don't think thats the right way to do it
[2013-02-15 03:35:06 -0500] flaccid: search in the recipe as normal, then in a template resource use the variables option to export it to the template for rendering
[2013-02-15 03:35:19 -0500] btm: cheflevelramen: are you familiar with the compile phase and execute phase? you might be causing yourself grief
[2013-02-15 03:35:33 -0500] cheflevelramen: flaccid: Yea, that's what I'm doing
[2013-02-15 03:35:47 -0500] flaccid: i didn't mention ruby_block, cheflevelramen
[2013-02-15 03:36:32 -0500] cheflevelramen: @btm: I am, and if I understand correctly, the ruby_block and the template resources should both be executed at the execute phase
[2013-02-15 03:36:55 -0500] flaccid: they will and ruby_block typically last but what you do in the ruby block is not accessible outside of it
[2013-02-15 03:36:59 -0500] btm: cheflevelramen: https://gist.github.com/btm/de58e09d07ac762841d5
[2013-02-15 03:37:19 -0500] flaccid: no need to use ruby block
[2013-02-15 03:38:30 -0500] cheflevelramen: flaccid: Oh I see. Right. Ran into trouble when it's not in the ruby block, because some of the items aren't available yet at compile phase
[2013-02-15 03:38:51 -0500] flaccid: right, that problem is likely another issue in design..
[2013-02-15 03:40:29 -0500] cheflevelramen: Cool, thanks guys. I think I should reevaluate the problem. Good to know items in a ruby_block aren't accessible outside it
[2013-02-15 03:43:44 -0500] btm: cheflevelramen: it's not impossible, its just a scoping issue. but flaccid is right that there is probably a better way to do what you're trying.
[2013-02-15 03:45:48 -0500] jtimberman: win 17
[2013-02-15 03:45:50 -0500] jtimberman: bah!
[2013-02-15 03:47:14 -0500] flaccid: whats win 17
[2013-02-15 03:48:51 -0500] das120: hey there mates! I downloaded chef_11.4.0-1.ubuntu.11.04_amd64.deb and installed it but knife -v still reports Chef 10.16.2. what am I missing?
[2013-02-15 03:49:09 -0500] btm: das120: ls -l `which knife`
[2013-02-15 03:49:35 -0500] jtimberman: flaccid: me missing the / when attempting to switch to another window :)
[2013-02-15 03:49:44 -0500] flaccid: lol jtimberman
[2013-02-15 03:50:15 -0500] das120: @btm it returns /usr/local/bin/knife
[2013-02-15 03:50:42 -0500] jtimberman: das120: seems that you have a conflicting installation :)
[2013-02-15 03:50:57 -0500] jtimberman: and that /usr/local/bin appears in your path before /usr/bin (which is usually correct)
[2013-02-15 03:51:16 -0500] btm: das120: is that a symbolic link? I presume not. you probably still have a chef 10.16.2 gem installed somewhere. omnibus installs to /opt/chef and symlinks into /usr/bin.
[2013-02-15 03:51:30 -0500] btm: das120: gem list chef
[2013-02-15 03:51:54 -0500] btm: jtimberman: you following the tesla motors internet lolz?
[2013-02-15 03:52:12 -0500] spencerowen: Does anyone know how to set the client_key line in the knife.rb file so that it is system independent? Here is what I am trying: [client_key "#{current_dir}/client.pem"]
[2013-02-15 03:52:56 -0500] jtimberman: btm: i don't have time for internet lolz
[2013-02-15 03:53:28 -0500] btm: jtimberman: but tesla motors has charts and graphs.
[2013-02-15 03:53:42 -0500] jtimberman: yeah it just makes me sad that i don't have charts and graphs for my computers
[2013-02-15 03:53:43 -0500] btm: jtimberman: what do you do while test-kitchen is running?
[2013-02-15 03:53:47 -0500] jtimberman: btm: twitter
[2013-02-15 03:53:49 -0500] jtimberman: irc
[2013-02-15 03:53:50 -0500] jtimberman: hipchat
[2013-02-15 03:53:54 -0500] jtimberman: email
[2013-02-15 03:54:04 -0500] btm: but no lolz :(
[2013-02-15 03:54:07 -0500] jtimberman: nup
[2013-02-15 03:54:17 -0500] das120: btm: it isn't a symlink, and the gem list reports the old version. jtimberman /usr/local/bin is indeed before /usr/bin
[2013-02-15 03:54:40 -0500] das120: I updated the gem and knife reports the right version now. thanks!
[2013-02-15 03:54:43 -0500] jtimberman: :D
[2013-02-15 03:54:51 -0500] btm: das120: yup. use gem to uninstall chef and your omnibus install should work peachy.
[2013-02-15 03:55:14 -0500] btm: das120: careful. you've got two chef installs. you should use omnibus or rubygems, but not both.
[2013-02-15 03:55:57 -0500] das120: btm: thanks for the heads up. i'm guessing that omnibus is the recommended approach. am i right?
[2013-02-15 03:56:02 -0500] jtimberman: btm: I use both!
[2013-02-15 03:56:10 -0500] jtimberman: das120: yes
[2013-02-15 03:56:28 -0500] btm: jtimberman: you're a power user!
[2013-02-15 03:56:42 -0500] jtimberman: whoa whoa lets not get crazy
[2013-02-15 03:56:55 -0500] das120: jtimberman: cool, thanks. i'll uninstall the gem as btm suggested.
[2013-02-15 03:57:00 -0500] jtimberman: yeah
[2013-02-15 03:58:08 -0500] jtimberman: and with that i'm gonna run off
[2013-02-15 03:58:39 -0500] spencerowen: Hey All, I'm brand new to chef. If I have 10 users in my company, does that mean I need to make 10 knife.rb files and scp them all to their machines?
[2013-02-15 04:01:08 -0500] btm: spencerowen: you can use the same knife.rb if there's a little ruby in it and you make their chef users/clients the same name as their usernames.
[2013-02-15 04:02:40 -0500] spencerowen: @btm, could you point me to an example? I'm looking at this one http://pastebin.com/Jt1ixauT
[2013-02-15 04:02:48 -0500] btm: spencerowen: in the knife.rb put: node_name ENV['USER']
[2013-02-15 04:08:18 -0500] spencerowen: Thanks, Im testing it, but something doesn't seem right, do I need to change 'user'?
[2013-02-15 04:08:19 -0500] spencerowen: client_key               "ENV['USER']/.chef/spencer-macbook-pro.pem"
[2013-02-15 04:09:47 -0500] btm: spencerowen: if you use ENV['USER'] inside a string (double quotes) you've got to use string interpolation...: "#{ENV['USER']}/.chef/spencer-macbook-pro.pem"
[2013-02-15 04:10:32 -0500] btm: spencerowen: now, if your username was spencer, that above string would be "spencer/.chef/spencer-macbook-pro.pem" which probably isn't right.
[2013-02-15 04:11:11 -0500] btm: spencerowen: "/home/#{ENV['USER']}/.chef/#{ENV['USER']}.pem" => "/home/spencer/.chef/spencer.pem"
[2013-02-15 04:13:02 -0500] spencerowen: got it, I just left off everything in front of the .pem
[2013-02-15 04:13:25 -0500] spencerowen: client_key 'spencers-macbook-pro.pem' worked like a champ. Thanks
[2013-02-15 04:51:29 -0500] amagee: Hey I'm getting a strange "permission denied" error running a chef recipe: http://dpaste.com/930888/ .  The strange thing is that if I execute the exact same command from the output there under "code", as the "ubuntu" user, it works.
[2013-02-15 04:52:58 -0500] gchristensen: amagee: try running 'env' instead of your normal command, and run env in the terminal yourself and compare the output. sometimes you need to update the environment variables to make commands work properly.
[2013-02-15 04:54:23 -0500] amagee: oh ok i'll look into doing that
[2013-02-15 05:06:59 -0500] silk: You have a command and code defined. is that normal? Im guessing that the chef template in the command doesnt exist?
[2013-02-15 05:11:45 -0500] gchristensen: miah, mconigliaro, joonas - I just wanted to update y'all - I setup VeeWee and slightlymodified the 12.04 build to install with Omnibus, and it works without any real hassle... code: https://github.com/grahamc/vagrant-boxes-veewee box: https://s3.amazonaws.com/gsc-vagrant-boxes/ubuntu-12.04-omnibus-chef.box ... thank you :)
[2013-02-15 05:13:43 -0500] mconigliaro: gchristensen: great!
[2013-02-15 05:15:14 -0500] syst3ml00t: Whose going to SCALE 11x?!
[2013-02-15 05:16:02 -0500] spencerowen: Is the ORGANIZATION-validator client supposed to be an admin?
[2013-02-15 05:18:09 -0500] amagee: gchristensen: i can't see anything in either `env` output that would suggest it shouldn't work
[2013-02-15 05:18:45 -0500] silk: amagee can you try removing the command line from that resource?
[2013-02-15 05:18:57 -0500] amagee: silk: what do you mean?
[2013-02-15 05:19:02 -0500] silk: well, the "command" attribute
[2013-02-15 05:19:19 -0500] silk: you have command and code
[2013-02-15 05:19:30 -0500] amagee: oh
[2013-02-15 05:19:35 -0500] silk: I think that perhaps the command is mucking you up
[2013-02-15 05:19:52 -0500] amagee: there's no "command" attribute in my actual code, that seems to be auto-generated
[2013-02-15 05:19:52 -0500] silk: have a look at the examples here: http://docs.opscode.com/resource_script.html
[2013-02-15 05:19:59 -0500] silk: ok
[2013-02-15 05:20:22 -0500] amagee: the actual resource only has code and user
[2013-02-15 05:31:22 -0500] amagee: oh actually something is going wrong with the environment
[2013-02-15 05:31:32 -0500] amagee: the user isn't getting the groups i expected
[2013-02-15 05:35:12 -0500] amagee: if i don't use the `user` attribute and instead change the `code` to "su -u #[user} command" it works
[2013-02-15 05:55:57 -0500] gblazer: hi there, i'm pretty new to chef, and have a question about versioning packages
[2013-02-15 05:57:54 -0500] gblazer: i currently have a set of redis servers, and i'm spinning up another cluster of redis servers that needs to have a new version
[2013-02-15 05:58:06 -0500] gblazer: what's the right mechanism to write cookbooks so it's not super ugly
[2013-02-15 05:58:15 -0500] gblazer: is it a matter of introducing a new attribute?
[2013-02-15 05:58:23 -0500] gblazer: any help would be appreciated
[2013-02-15 06:06:19 -0500] crazysim: anybody familiar with the supervisor recipe? the example makes no sense
[2013-02-15 06:06:26 -0500] crazysim: the one with supervisor_service "celery" do
[2013-02-15 06:06:45 -0500] crazysim: it enables it to boot on startup but then says don't autostart with supervisord
[2013-02-15 06:06:49 -0500] crazysim: wtf?
[2013-02-15 06:08:01 -0500] coderanger: crazysim: At the point that I wrote that code, setting autostart would cause the service to be started immediately
[2013-02-15 06:08:23 -0500] crazysim: ah, i see
[2013-02-15 06:08:24 -0500] coderanger: and if you look the service def is created during the before_deploy phase, meaning that the first time it runs, it can't start
[2013-02-15 06:08:35 -0500] coderanger: now I think thats been fixed in supervisor now
[2013-02-15 06:08:42 -0500] coderanger: if you can verify, I can change it :)
[2013-02-15 06:08:59 -0500] crazysim: i'm not at the level of expertise where i can verify that at this point
[2013-02-15 06:09:13 -0500] crazysim: i use supervisor since i'm too lazy to write an init script haha
[2013-02-15 06:09:27 -0500] crazysim: though thanks for explaining
[2013-02-15 06:14:52 -0500] crazysim: ah, i see what you mean with the autostart thing
[2013-02-15 06:14:57 -0500] crazysim: yeah that would be bad
[2013-02-15 06:19:39 -0500] Chanlinux: I am new to chef can someone help me on the difference between enterprise chef and opensource chef
[2013-02-15 06:24:42 -0500] coderanger: Chanlinux: The biggest difference is more powerful ACLs
[2013-02-15 06:25:11 -0500] coderanger: Chanlinux: If you are comparing open source vs. private chef, there is also LDAP integration
[2013-02-15 06:27:15 -0500] crazysim: hmm, check the supervisor thing. looks like :enables starts unless you have autostart as false
[2013-02-15 06:27:19 -0500] crazysim: i mean
[2013-02-15 06:27:21 -0500] crazysim: i checked it
[2013-02-15 06:27:28 -0500] crazysim: oh well :D
[2013-02-15 06:27:28 -0500] coderanger: crazysim: :(
[2013-02-15 06:27:56 -0500] coderanger: crazysim: I'll poke the supervisor devs
[2013-02-15 06:28:01 -0500] crazysim: i may be wrong though
[2013-02-15 06:28:07 -0500] crazysim: my chef skills are still rather noob
[2013-02-15 06:28:41 -0500] coderanger: It shouldn't really be chef related, just depends on the behavior of supervisor itself
[2013-02-15 06:28:46 -0500] crazysim: i know
[2013-02-15 06:28:52 -0500] crazysim: i read the provider
[2013-02-15 06:30:00 -0500] crazysim: supervisorctl update has that effect
[2013-02-15 09:24:34 -0500] BryanWB__: is xabier de zuazo around?
[2013-02-15 09:24:41 -0500] BryanWB__: i don't know his irc nic
[2013-02-15 09:46:23 -0500] pixie79_: hi all - does anyone use the postfix cookbook? I have it working for relaying emails out - but i also want to introduce to aliases and I am not really sure on the format for the overides
[2013-02-15 10:25:32 -0500] dylst: I'm using the deploy resource, but having some issues connecting to a private github repo.  It seems like my ssh wrapper isn't being used perhaps?  Here is the relevant code:  https://gist.github.com/dylanz/fa4a68596911d9e2bda1
[2013-02-15 10:26:21 -0500] dylst: Any thoughts would definitely be welcomed, as I'm having a hard time figuring out how to dig deeper.
[2013-02-15 10:43:03 -0500] pixie79_: i dont understand what is meant by the following term:  Then specify a hash of aliases for the node['postfix']['aliases'] attribute.
[2013-02-15 10:44:01 -0500] mattt: pixie79_: which cookbook ?
[2013-02-15 10:44:06 -0500] mattt: https://github.com/opscode-cookbooks/postfix ?
[2013-02-15 10:44:08 -0500] pixie79_: yes
[2013-02-15 10:44:11 -0500] pixie79_: :)
[2013-02-15 10:45:04 -0500] pixie79_: I get a single alias, ie 'root' => 'root@example.com' but I have a whole file of them to map
[2013-02-15 10:45:32 -0500] pixie79_: so i am thinking it means something like
[2013-02-15 10:46:34 -0500] pixie79_: node['postfix']['alaises'] = [ "'root' => 'root@example.com'", "'test => 'test@foo.com'"]
[2013-02-15 10:47:50 -0500] mattt: mmm
[2013-02-15 10:47:59 -0500] mattt: try {"root1"=>"root@example.com", "root"=>"root@example.com"}
[2013-02-15 10:49:16 -0500] mattt: node['postfix']['alaises'] = {'root' => 'root@example.com', 'test => 'test@foo.com'}
[2013-02-15 10:49:25 -0500] mattt: typo, should be 'test'
[2013-02-15 10:59:10 -0500] mattt: pixie79_: work ?
[2013-02-15 10:59:37 -0500] pixie79_: oh - sorry i did not see the reply - i will have a try now :)
[2013-02-15 11:07:39 -0500] Aparna: how can i log error from a chef resource? I am using chef-solo
[2013-02-15 11:09:12 -0500] Aparna: can any one please direct pe to examples of log level:error
[2013-02-15 11:09:22 -0500] Aparna: i want to log error in a ruby block is that possible?
[2013-02-15 11:11:04 -0500] Aparna: Can any body please help..
[2013-02-15 11:11:07 -0500] Aparna: i need this urgently
[2013-02-15 11:22:59 -0500] denniswisnia: hi guys, I am new with chef and want to write my first "bigger one" cookbook. For an Firewall. I thinked about it whats the best practice, so I thinked that the best way is to create a set for each note with the open ports. A databag? :)
[2013-02-15 11:25:28 -0500] pixie79_: mattt: thanks works fine when i dont typo lol
[2013-02-15 11:25:55 -0500] mattt: pixie79_: great :)
[2013-02-15 11:26:04 -0500] Afterglow: denniswisnia: there is an opscode cookbook for iptables, if you don't want to use it fair enough but it might provide some ideas for you https://github.com/opscode-cookbooks/iptables
[2013-02-15 11:26:11 -0500] pixie79_: Aparna: i wrote to STDERR before but that was when bootstraping ?
[2013-02-15 11:26:20 -0500] mattt: Afterglow: also the firewall cookbook, that one is nice
[2013-02-15 11:26:46 -0500] Afterglow: so there is - https://github.com/opscode-cookbooks/firewall
[2013-02-15 11:27:27 -0500] mattt: that one sits on top of ubuntu's ufw i believe, so distro-specific
[2013-02-15 11:28:34 -0500] denniswisnia: Afterglow: looks pretty great!
[2013-02-15 11:28:47 -0500] denniswisnia: mattt: Afterglow: dont want to use ufw :(
[2013-02-15 11:29:17 -0500] denniswisnia: got some problems on some virtual machines at one hoster
[2013-02-15 11:29:21 -0500] mattt: denniswisnia: yeah, then don't use the 'firewall' cookbook :P
[2013-02-15 11:29:27 -0500] denniswisnia: :D
[2013-02-15 11:37:28 -0500] pikesley: Hey hey
[2013-02-15 11:37:42 -0500] pikesley: So I've been away from Chef for a while due to changing jobs
[2013-02-15 11:38:03 -0500] pikesley: What's the recommended way of configuring virtual hosts in nginx these days?
[2013-02-15 11:38:25 -0500] pikesley: I'me sure I used to use a cookbook that had the notion of 'webapps' or similar
[2013-02-15 11:51:00 -0500] siXy: pikesley: I'd suggest a master conf to set the global options then an include dir, with a file per vhost.  You can then use attributes to work out which vhost files to apply to which server.
[2013-02-15 11:54:55 -0500] ara_: #chef
[2013-02-15 11:56:48 -0500] ara_: Hi, i have a fresh installation of chef-server (10.20.2) on Centos 6.3. All services run OK, but the chef-server-webui does not start:
[2013-02-15 11:57:20 -0500] ara_: Error message: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/merb-haml-1.1.3/lib/merb-haml/template.rb:52:in `def_method': undefined method `precompiled_with_ambles' for #<Haml::Engine:0x000000027cf2e8>
[2013-02-15 11:58:27 -0500] denniswisnia: firewall?
[2013-02-15 11:59:06 -0500] ara_: firewall is off
[2013-02-15 12:01:46 -0500] pixie79_: ara_: I had that yesterday - but a fresh install of the rpm for chef-server 11.0.4 on a clean minimal centos install worked fine
[2013-02-15 12:14:37 -0500] mattt: pixie79_: so no joy getting chef-server going on OEL ?
[2013-02-15 12:15:45 -0500] pixie79_: mattt: nope - not sure why may be a clean fresh minimal install and it might have worked - but i am happy with the working one i have for now and the difference between OEL and CentOS is not enough for me to worry
[2013-02-15 12:19:42 -0500] mattt: pixie79_: do you pay to use OEL ?
[2013-02-15 12:19:57 -0500] pixie79_: mattt: lol nope
[2013-02-15 12:20:29 -0500] pixie79_: although that is the reason for choosing it, that if we get stuck we could pay for it and it is cheaper than others
[2013-02-15 12:20:55 -0500] mattt: pixie79_: fair enough :)
[2013-02-15 12:40:46 -0500] withnale: Will chef be officially compatible with ruby 2.0 when it gets officially released?
[2013-02-15 12:41:31 -0500] PierreO: Somebody has an idea why chef 11 broke nginx::source compatibility? http://tickets.opscode.com/browse/COOK-2417
[2013-02-15 12:50:11 -0500] mattt: so supports in metadata.rb is more advisory, nothing is enforced?
[2013-02-15 12:50:20 -0500] mattt: (ie. run bombs out if you're running on an unsupported distro for example?)
[2013-02-15 12:52:46 -0500] BryanWB__: mattt: it won't bomb out
[2013-02-15 12:54:33 -0500] mattt: BryanWB__: yeah, just tested, thanks
[2013-02-15 13:03:10 -0500] ara_: pixie79_: i cannot migrate to chef-server 11.0.4 right now. I have to find way to install chef-server 10.22.0 on minimal centos 6.3
[2013-02-15 13:03:32 -0500] ara_: pixie79_: I have done it previously, but never had problems
[2013-02-15 13:27:09 -0500] jfl0wers: I am trying to install the version of Chef my company is using at the moment, 10.14.4
[2013-02-15 13:27:24 -0500] jfl0wers: I get this error: Unable to resolve dependencies: chef requires net-ssh (~> 2.2.2); net-ssh-multi requires net-ssh (>= 2.1.4); net-ssh-gateway requires net-ssh (>= 2.6.5)
[2013-02-15 13:28:09 -0500] jfl0wers: is there something I can do to work around this issue or even resolve it?
[2013-02-15 13:34:05 -0500] erthad: hiall
[2013-02-15 13:34:21 -0500] erthad: is there a way to delete organization/account from Hosted Chef?
[2013-02-15 13:46:29 -0500] pixie79_: jfl0wers: use a later chef ? or pin to an earlier net-ssh-multi/ net-ssh-gateway
[2013-02-15 13:46:45 -0500] jfl0wers: pin
[2013-02-15 13:46:48 -0500] jfl0wers: okay
[2013-02-15 13:46:55 -0500] jfl0wers: that is new to me
[2013-02-15 13:47:00 -0500] jfl0wers: thank you
[2013-02-15 14:07:21 -0500] nicholasr-bf: One of the developers here hit an interesting error  ...  [Fri, 15 Feb 2013 13:19:45 +0000] DEBUG: Re-raising exception: NoMethodError -  undefined method `count' for #<Array:0x2b1ace3e4dd8>
[2013-02-15 14:08:35 -0500] nicholasr-bf: I couldn't find any reference to count in the recipe.  It looks like it actually is coming from the error inspector for CompilerErrorInspector
[2013-02-15 14:08:46 -0500] nicholasr-bf:         def filtered_bt
[2013-02-15 14:08:46 -0500] nicholasr-bf:           filters = Array(Chef::Config.cookbook_path).map {|p| /^#{Regexp.escape(p)}/ }
[2013-02-15 14:08:46 -0500] nicholasr-bf:           r = exception.backtrace.select {|line| filters.any? {|filter| line =~ filter }}
[2013-02-15 14:08:46 -0500] nicholasr-bf:           Chef::Log.debug("filtered backtrace of compile error: #{r.join(",")}")
[2013-02-15 14:08:47 -0500] nicholasr-bf:           return r.count > 0 ? r : exception.backtrace
[2013-02-15 14:08:47 -0500] nicholasr-bf:         end
[2013-02-15 14:08:59 -0500] nicholasr-bf: r.count should probably be r.size
[2013-02-15 14:25:05 -0500] deed02392: hi guys I want to contribute to the nginx cookbook
[2013-02-15 14:25:27 -0500] deed02392: i want to make it support adding your own site configurations just by dropping them into the template folder
[2013-02-15 14:25:47 -0500] deed02392: would that be a good idea?
[2013-02-15 14:26:11 -0500] deed02392: or should we just expect users to replace the default-site template with the one for their own app?
[2013-02-15 14:26:26 -0500] deed02392: but then you can't easily add multiple sites :)
[2013-02-15 14:26:27 -0500] PierreO: Hi deed02392
[2013-02-15 14:27:24 -0500] PierreO: deed02392, ok I wanted to say that it was almost supported but you added the mention to default-site, so I can't help much..sorry
[2013-02-15 14:27:59 -0500] PierreO: deed02392 how do you plan to do that?
[2013-02-15 14:29:19 -0500] PierreO: deed02392 I have the example of this recipe : https://github.com/heavywater/chef-jenkins
[2013-02-15 14:29:35 -0500] PierreO: deed02392 it had its own site conf
[2013-02-15 14:29:54 -0500] PierreO: s/had/add
[2013-02-15 14:30:44 -0500] deed02392: PierreO, I was thinking writing ruby script that processed and enabled all site config templates in a directory
[2013-02-15 14:31:01 -0500] deed02392: so move the default-site.conf.erb to /templates/default/sites
[2013-02-15 14:31:21 -0500] deed02392: and then make commons_script.rb loop through that directory and template |site| all of them
[2013-02-15 14:31:28 -0500] deed02392: then do the nginx_site |site| enable
[2013-02-15 14:31:38 -0500] deed02392: does that sound like a reasonable angle of attack?
[2013-02-15 14:34:22 -0500] PierreO: deed02392: I think, what you want to do is a LWRP
[2013-02-15 14:34:53 -0500] PierreO: deed02392: I saw this one for instance, is it what you're looking for? https://github.com/firebelly/chef-nginx_conf (I never tried..)
[2013-02-15 14:40:02 -0500] deed02392: oh. yeah. that looks good PierreO
[2013-02-15 14:40:09 -0500] deed02392: shouldn't that be in the community cookbook >_<
[2013-02-15 14:42:58 -0500] PierreO: deed02392: I don't know much about lwrp yet, this is the next topic I would digg into ;) Maybe it's a good idea, open an feature request in Jira : http://tickets.opscode.com/ and prepare a pull request in GitHub : http://wiki.opscode.com/display/chef/How+to+Contribute+to+Opscode+Cookbooks
[2013-02-15 14:53:50 -0500] deed02392: where did you find that PierreO ?
[2013-02-15 14:54:15 -0500] PierreO: deed02392 : what?
[2013-02-15 15:01:29 -0500] deed02392: that cookbook in git
[2013-02-15 15:02:37 -0500] PierreO: "lwrp site nginx " in google and I knew that lwrp was the way (more than a ruby script)
[2013-02-15 15:34:26 -0500] DilboBaggins: Can anybody help me understand why I am unable to upload cookbooks to my chef server? i am able to check things like knife node list but am unable to sucesfully use knife cookbook upload see here: http://fpaste.org/7Oiw/
[2013-02-15 15:36:28 -0500] maruq: DilboBaggins: which version of chef server?
[2013-02-15 15:36:47 -0500] maruq: sounds like it might be an underlying process that's not responding
[2013-02-15 15:37:09 -0500] DilboBaggins: maruq:  chef-server-11.0.4-1
[2013-02-15 15:39:15 -0500] maruq: DilboBaggins: hmm.. I've not used 11.x yet, but you may want to check all services are running
[2013-02-15 15:39:16 -0500] maruq: http://wiki.opscode.com/display/chef/Chef+Server
[2013-02-15 15:39:20 -0500] DilboBaggins: maruq: im not sure, but i have iptables and selinux disabled, like i said i can do knifenodelist (which i believe queries the server) the server is pingable, chef server is running...
[2013-02-15 15:40:11 -0500] maruq: DilboBaggins: yeah, doesn't sound like a desktop <=> server issue, more an internal one. but I don't know enough to confirm that
[2013-02-15 15:40:23 -0500] drvonnostren: sigh
[2013-02-15 15:40:35 -0500] drvonnostren: DilboBaggins: I am also having a similar issue
[2013-02-15 15:40:35 -0500] maruq: I'd check the services & the logs in /var/log/chef to see if there's more you can gather
[2013-02-15 15:41:31 -0500] DilboBaggins: maruq: I dont believe that a lot of that stuff is the same in 11, for instance i think port 4000 is no longer used
[2013-02-15 15:41:41 -0500] DilboBaggins: i will check those logs tho
[2013-02-15 15:42:25 -0500] maruq: DilboBaggins: yeah, sorry, wish I could offer more, but not had chance to play with Chef 11 yet
[2013-02-15 15:42:43 -0500] DilboBaggins: weird, on my workstation /var/log/chef does not exist
[2013-02-15 15:43:22 -0500] maruq: DilboBaggins: sorry, I meant on the server. It sounds like it's the server rejecting it, not the client
[2013-02-15 15:44:57 -0500] DilboBaggins: test
[2013-02-15 15:49:36 -0500] DilboBaggins: this is what my /var/log/chef-server/erchef/current file looks like : http://fpaste.org/8TpW/ seems to be an authentication error, but im not sure, can you make sense of that>
[2013-02-15 15:53:13 -0500] maruq: DilboBaggins: looks like it can't connect to the amqp server.
[2013-02-15 15:53:39 -0500] maruq: DilboBaggins: can you check `ps aux | grep rabbitmq` to see if it's running ?
[2013-02-15 15:55:15 -0500] albal: wow I have not been on IRC for like 20 years so apologies for being new again :-)
[2013-02-15 15:55:42 -0500] DilboBaggins: maruq: it appears to be: http://fpaste.org/dipN/
[2013-02-15 15:57:02 -0500] maruq: DilboBaggins: hmm anything interesting in the rabbitmq log?
[2013-02-15 15:57:29 -0500] maruq: DilboBaggins: will have to leave shortly, but hopefully I can point you to the problem before then ;)
[2013-02-15 15:57:39 -0500] albal: I'm trying to get chef server (opensrc) running on Centos 6.3 minimal at the end of the bootstrapping process the verfiy-system-status fails with 'expected 0 but received 22' anyone got a pointer to where I may look for more info about server deployment?
[2013-02-15 15:57:40 -0500] DilboBaggins: maruq: appreciated
[2013-02-15 15:58:49 -0500] DilboBaggins: current rabbitmq log: http://fpaste.org/8kWN/
[2013-02-15 15:59:12 -0500] maruq: DilboBaggins: hmm seems to be running
[2013-02-15 16:00:10 -0500] maruq: DilboBaggins: sorry, I think I've reached my limit there for now :(
[2013-02-15 16:00:18 -0500] DilboBaggins: thats okay
[2013-02-15 16:00:43 -0500] maruq: also got to run to a meeting.
[2013-02-15 16:01:20 -0500] maruq: good luck with solving though. The Americans should be online soon, so may get some help there ;)
[2013-02-15 16:02:35 -0500] albal: i see IRC hasn't changed still 300 people in a channel just hanging out 'to be cool'
[2013-02-15 16:03:43 -0500] DilboBaggins: maruq: can you elaborate on what rabbitmq does>?
[2013-02-15 16:04:19 -0500] paulmooring: albal: That sounds like a shell out command failed, not really enough context to be more specific though
[2013-02-15 16:04:31 -0500] paulmooring: do you have some surroding messages?
[2013-02-15 16:05:27 -0500] awgross: whats the recommended way to look for nested node attributes in library files? Trying some hacky things like node.has_key?['ec2'] && node['ec2'].has_key?...
[2013-02-15 16:05:35 -0500] awgross: which doesnt seem to be providing correct info
[2013-02-15 16:06:07 -0500] gswallow: While executing gem ... (Gem::DependencyError)
[2013-02-15 16:06:07 -0500] gswallow:     Unable to resolve dependencies: net-ssh-multi requires net-ssh (>= 2.1.4); chef requires net-ssh (~> 2.1.3); net-ssh-gateway requires net-ssh (>= 2.6.5).
[2013-02-15 16:06:42 -0500] awgross: gswallow: what version of Chef are you installing?  That was a bug with net-ssh, need to use omnibus to install or switch to Chef 10.20+ or Chef 11
[2013-02-15 16:06:55 -0500] gswallow: I'm trying 10.22.0 now
[2013-02-15 16:07:01 -0500] gswallow: we aren't ready for 11.0
[2013-02-15 16:07:17 -0500] albal: paulmooring: it's the error I get when runningin chef-server-ctl reconfigure        http://fpaste.org/CoSH/
[2013-02-15 16:09:02 -0500] awgross: gswallow: strange, maybe its a regression
[2013-02-15 16:09:18 -0500] awgross: gswallow: are you installing with omnibus or via gems
[2013-02-15 16:09:22 -0500] gswallow: I didn't specify no-rdoc no-ri so I'm waiting but I took a different approach.
[2013-02-15 16:09:25 -0500] gswallow: gems
[2013-02-15 16:09:29 -0500] gswallow: will pull up command history in a sec
[2013-02-15 16:09:33 -0500] pixie79_: albal: check you dont have your firewall up
[2013-02-15 16:09:46 -0500] pixie79_: it is complaining it cant talk to the localhost port 8000
[2013-02-15 16:10:18 -0500] paulmooring: albal: I think that's a 404 on $chef_url/_status
[2013-02-15 16:11:36 -0500] gswallow: I did this
[2013-02-15 16:11:37 -0500] gswallow: 595  gem install net-ssh-gateway --version "=1.1.0" --no-rdoc --no-ri
[2013-02-15 16:11:37 -0500] gswallow:   596  gem install net-ssh-multi --version "=1.1"
[2013-02-15 16:11:37 -0500] gswallow:   597  gem install net-ssh --version "=2.1.4"
[2013-02-15 16:11:37 -0500] gswallow:   598  gem install chef --version "=10.22.0"
[2013-02-15 16:12:17 -0500] matti: http://pastebin.com/CXykFr5x
[2013-02-15 16:12:20 -0500] gswallow: if I encounter this issue again (it's rare) I will just try to install 10.22.0
[2013-02-15 16:12:20 -0500] matti: What the heck?!
[2013-02-15 16:14:08 -0500] albal: oops http proxy in the way
[2013-02-15 16:14:17 -0500] matti: ?
[2013-02-15 16:14:26 -0500] paulmooring: albal: That definitely means some http error greater than 400 on http://localhost:8000/_status
[2013-02-15 16:14:46 -0500] albal: paulmooring: you are right it's a 502
[2013-02-15 16:16:12 -0500] paulmooring: albal: I would guess there's some other error that happened during the bootstrap where you can find why
[2013-02-15 16:16:31 -0500] paulmooring: either that or check the nginx logs to see what upstream is 500ing
[2013-02-15 16:16:43 -0500] user___: I'm attempting to perform an action like on this page (first run only resource), but am not able to query the node with the provided knife command...the attribute is present through the website, and is a 'normal' attribute...any ideas how to query for nodes with this attribute?  http://wiki.opscode.com/pages/viewpage.action?pageId=15728818
[2013-02-15 16:31:02 -0500] matti: Anyone had issues getting knife configure -i working?
[2013-02-15 16:33:47 -0500] DilboBaggins: guys, when i run knife upload using:  knife cookbook -VV upload apache2 I get the following: http://fpaste.org/yw3A/ which looks like it is trying to upload to the workstation itself and not the server. However, my knife.rb is specified with the chef_server correctly here: http://fpaste.org/dMAq/ why is it trying to upload to localhost and not the chef server. Thinks like knife node list work fine however
[2013-02-15 17:08:18 -0500] DilboBaggins: guys, when i run knife upload using:  knife cookbook -VV upload apache2 I get the following: http://fpaste.org/yw3A/ which looks like it is trying to upload to the workstation itself and not the server. However, my knife.rb is specified with the chef_server correctly here: http://fpaste.org/dMAq/ why is it trying to upload to localhost and not the chef server. Thinks like knife node list work fine however
[2013-02-15 17:09:08 -0500] pcn: ohai chefs.
[2013-02-15 17:09:22 -0500] pcn: On macos x, I'm seeing that ohai, run from the command line, will spit errors to stdout
[2013-02-15 17:09:31 -0500] pcn: INFO: [inet6] no default interface, picking the first ipaddress
[2013-02-15 17:09:32 -0500] pcn: etc.
[2013-02-15 17:09:35 -0500] pcn: This breaks json parsing.
[2013-02-15 17:10:02 -0500] pcn: The version I'm using is 6.16.0
[2013-02-15 17:12:57 -0500] pcn: Is there a reason that stdout is the default log location, rather than stderr?
[2013-02-15 17:15:17 -0500] qhartman: pcn, since most log messaging is not an error condition, sending it to stderr would be wrong
[2013-02-15 17:16:52 -0500] yfeldblum: pcn, https://github.com/opscode/ohai/blob/master/lib/ohai/application.rb#L35-L45
[2013-02-15 17:17:31 -0500] yfeldblum: qhartman, the theoretical unix way seeems to be to send all logging info, including at info & debug levels, to stderr; and to send the real program output to stdout
[2013-02-15 17:17:45 -0500] qhartman: yfeldblum, you knowledge of this codebase never ceases to amaze me
[2013-02-15 17:18:12 -0500] yfeldblum: qhartman, :D
[2013-02-15 17:21:33 -0500] kshep: Seems like there's a (growing?) group of folks who prefer to just have pretty much everything (e.g. logs) go to stdout, then use whatever process management and/or log aggregation service of your choice log/alert on it appropriately.
[2013-02-15 17:21:40 -0500] qhartman: yfeldblum, yeah, that is the "normal" thing, but in the case of chef-client, one could argue that the logging output is the "real" output. That was how I interpreted that seemingly weird decision when I found it.
[2013-02-15 17:21:49 -0500] stum: what version was :name_attribute added to in chef? i
[2013-02-15 17:22:07 -0500] kshep: "real program output" for unix services is... well... logs? ;-)
[2013-02-15 17:22:13 -0500] yfeldblum: qhartman, sure - it's not universally practiced
[2013-02-15 17:22:34 -0500] stum: i'm having a problem where i'm failing validation when a :required => true and :name_attribute => true resource is used in a recipe
[2013-02-15 17:22:43 -0500] kshep: qhartman +1 real program output = logs
[2013-02-15 17:22:44 -0500] yfeldblum: qhartman, in this case, i think the program in question is the ohai CLI, whose "real program output" is supposed to be a JSON-formatted description of the machine
[2013-02-15 17:22:44 -0500] pcn: yfeldblum: right, I am redirecting the log to /dev/null.
[2013-02-15 17:22:54 -0500] pcn: 2 questions, though.
[2013-02-15 17:23:03 -0500] qhartman: yfeldblum, gotcha
[2013-02-15 17:23:07 -0500] pcn: 1) I don't see a convention in the docs for directing the log to stdout
[2013-02-15 17:23:14 -0500] pcn: err... s/stdout/stderr
[2013-02-15 17:23:32 -0500] IanMalcolm: hey guys, is the community API offline?
[2013-02-15 17:23:44 -0500] IanMalcolm: I get a 404 on community.opscode.com/api/v1
[2013-02-15 17:23:50 -0500] pcn: 2) for a command-line tool, which is what ohai is, what log messages are important enough that it should break the parsability of the output?
[2013-02-15 17:24:06 -0500] matti: kshep: It is -- its called "developers who have no clue".
[2013-02-15 17:24:40 -0500] DilboBaggins: guys, when i run knife upload using:  knife cookbook -VV upload apache2 I get the following: http://fpaste.org/yw3A/ which looks like it is trying to upload to the workstation itself and not the server. However, my knife.rb is specified with the chef_server correctly here: http://fpaste.org/dMAq/ why is it trying to upload to localhost and not the chef server. Thinks like knife node list work fine however
[2013-02-15 17:25:18 -0500] yfeldblum: kshep, indeed - http://12factor.net/logs - and i'm a fan
[2013-02-15 17:25:27 -0500] pcn: IanMalcolm I don't get a 404
[2013-02-15 17:25:38 -0500] IanMalcolm: pcn well that's weird
[2013-02-15 17:26:09 -0500] yfeldblum: matti, no; this inverts the question of how are logs configured and collected from the domain of the application to the domain of the infrastructure
[2013-02-15 17:26:54 -0500] yfeldblum: matti, if, in your infrastructure, the extremely simple contract is that all applications log to stdout, then your infrastructure can use that very simple assumption and do complex things much more easily that could be done otherwise
[2013-02-15 17:27:07 -0500] matti: yfeldblum: Sorry, what?
[2013-02-15 17:27:13 -0500] pcn: IanMalcom I lie - I get a 404 wrapped in a very nice page that doesn't look like a 404
[2013-02-15 17:27:30 -0500] IanMalcolm: pcn now it makes sense
[2013-02-15 17:27:33 -0500] yfeldblum: matti, without any special need for configuring each application and without any special need for the infrastructure to know the configuration of each application
[2013-02-15 17:27:50 -0500] matti: yfeldblum: Sorry, again, what?
[2013-02-15 17:27:55 -0500] matti: yfeldblum: What are you talking about?
[2013-02-15 17:28:10 -0500] pcn: matti I think he means to talk to me?
[2013-02-15 17:28:20 -0500] mconigliaro: ok guys, what do you do when you have definitions that require a certain gem, but the gem isn't installed yet? you can't just use a recipe to install it, because recipes get loaded AFTER the definitions. So what do you do (other than running chef twice)?
[2013-02-15 17:28:21 -0500] matti: pcn: I think he is insane ;]
[2013-02-15 17:28:48 -0500] yfeldblum: matti, suppose you have 100 applications running on your infrastructure and you want to send all their logs to graylog2
[2013-02-15 17:28:56 -0500] matti: yfeldblum: I do not care ;d
[2013-02-15 17:28:57 -0500] yfeldblum: matti, what do you have to do?
[2013-02-15 17:29:01 -0500] Pushnell_: hey all, writing a cookbook where the default recipe includes some other recipes in the same cookbook.  however, I'm not seeing my default attributes (attributes/default.rb) in those other recipes.  They're just nil or empty.   (These attributes need to be available for all recipes in the cookbook)  This is under vagrant/chef-solo 10.14
[2013-02-15 17:29:22 -0500] matti: yfeldblum: Meaning, I do not care about this entire conversation ;p
[2013-02-15 17:30:53 -0500] matti: yfeldblum: Mind you, I am not upset or anything. I am about to spent second day on trying to get Chef 11 infrastructure up and running, and I'd rather not spent so much time on something like that, therefre I can't care less about any advocacy conversation right now ;)
[2013-02-15 17:31:02 -0500] pcn: yfeldblum the 12 factor app page makes sense for a running daemon.  For a tool that is used in a pipeline to print formatted output, logs to stdout that break that formatting, which breaks the parsability of the output, is applying the wrong solution to the wrong problem.
[2013-02-15 17:31:11 -0500] matti: yfeldblum: In other words -- I am a grumpy git now.
[2013-02-15 17:31:30 -0500] yfeldblum: pcn, the 12factor page is for network daemons
[2013-02-15 17:31:43 -0500] yfeldblum: pcn, or other types of long-running processes
[2013-02-15 17:32:03 -0500] yfeldblum: pcn, such as job queue workers
[2013-02-15 17:32:18 -0500] matti: yfeldblum: Mongodb was super inconsistent with log lines.
[2013-02-15 17:32:30 -0500] matti: yfeldblum: Some of them on stderr some of them on out.
[2013-02-15 17:33:01 -0500] matti: yfeldblum: And it is a "daemon" etc. They just had no clue.
[2013-02-15 17:33:06 -0500] pcn: yfeldblum yes, I agree with that.  I'll let you and matti shoot this out, then get back to "why does ohai log to stdout"
[2013-02-15 17:33:45 -0500] IanMalcolm: is there an API mirror?
[2013-02-15 17:34:23 -0500] JoelMcCracken: I'd like to specify that the deploy_key for my application resource be from a file. Is there a way to do this?
[2013-02-15 17:34:46 -0500] JoelMcCracken: I could do something like "deploy_key File.read(...)", but clearly i imagine there is something better
[2013-02-15 17:35:34 -0500] zuazo: mconigliaro: try with chef_gem or a library
[2013-02-15 17:35:57 -0500] mconigliaro: well, we have chef_gem in a recipe
[2013-02-15 17:36:08 -0500] mconigliaro: but definitions get loaded first, so it's too late
[2013-02-15 17:36:12 -0500] mconigliaro: maybe a library would work
[2013-02-15 17:39:16 -0500] zuazo: you can also try to install it in the definition, perhaps using chef_gem
[2013-02-15 17:39:22 -0500] zuazo: i'm not sure
[2013-02-15 17:39:43 -0500] c_t: ohai
[2013-02-15 17:40:12 -0500] mconigliaro: hmm, there are a bunch of definitions though
[2013-02-15 17:40:22 -0500] mconigliaro: i like the library idea since those get loaded first
[2013-02-15 17:45:04 -0500] beandip: Can I do per environment attributes in a role file?
[2013-02-15 17:46:09 -0500] chip-: No, the attributes would go in the environment itself.
[2013-02-15 17:46:22 -0500] cheeseplus: beandip: you can do only env_run_lists in roles
[2013-02-15 17:47:24 -0500] kammouflage: cheeseplus: that is not true
[2013-02-15 17:47:52 -0500] cheeseplus: do tell
[2013-02-15 17:48:26 -0500] yfeldblum: pcn, matti would prefer not to shoot it out, so i'll respect matti's wishes on that
[2013-02-15 17:48:52 -0500] yfeldblum: matti, except to say that yes, mongodb should choose one or the other to log to, but not log to both
[2013-02-15 17:49:35 -0500] yfeldblum: matti, so i agree on the need for consistency, and that logging to both stdout and stderr is something of a WTF
[2013-02-15 17:49:56 -0500] kammouflage: https://gist.github.com/kkenny/4962051
[2013-02-15 17:51:21 -0500] beandip: kammouflage: that's a non answer to my question
[2013-02-15 17:51:38 -0500] beandip: your gist does not show any sort of per environment attribute overrides
[2013-02-15 17:51:41 -0500] beandip: :)
[2013-02-15 17:51:57 -0500] kammouflage: beandip: you can do per role attributes, but for environment attributes, you should leave them in the environments
[2013-02-15 17:52:20 -0500] cheeseplus: kammouflage: I know you can put other attributes in a role, I was answering beandip's query as to the only thing env related in a role that can be set is env_run_lists
[2013-02-15 17:52:40 -0500] kammouflage: beandip: the example was not meant to be an answer to your question, but an example to show that more than just the run_list in the role
[2013-02-15 17:52:57 -0500] zuazo: beandip: http://tickets.opscode.com/browse/CHEF-3441
[2013-02-15 17:53:11 -0500] zuazo: that's what you want?
[2013-02-15 17:53:39 -0500] beandip: lol
[2013-02-15 17:54:00 -0500] beandip: zuazo: exactly
[2013-02-15 17:54:24 -0500] beandip: I was looking around for my bookmark to that ticket so I could see if it's been closed out
[2013-02-15 17:54:39 -0500] zuazo: seems to be no interest in implementing it
[2013-02-15 17:54:39 -0500] IanMalcolm: So, the API is not offline
[2013-02-15 17:54:47 -0500] IanMalcolm: but it does return 404 on /
[2013-02-15 17:54:53 -0500] beandip: wasn't sure if it was implimented
[2013-02-15 17:54:58 -0500] IanMalcolm: if you go to any endpoint, it works fine
[2013-02-15 17:54:58 -0500] zuazo: see the comments below
[2013-02-15 17:55:01 -0500] IanMalcolm: like http://community.opscode.com/api/v1/cookbooks/build-essential
[2013-02-15 17:55:10 -0500] IanMalcolm: just to let you guys know
[2013-02-15 17:56:19 -0500] beandip: Adam's point is pretty solid
[2013-02-15 17:56:26 -0500] beandip: :)
[2013-02-15 17:56:31 -0500] kammouflage: What would be the necessity to maintain environment attributes in a role vs. just keeping them in the environment?
[2013-02-15 17:56:35 -0500] mattupstate: anyone successfully use the rabbitmq cookbook to setup auto clustering?
[2013-02-15 17:56:50 -0500] zuazo: beandip: yes, it is
[2013-02-15 17:56:59 -0500] mattupstate: i keep getting "ERROR: node with name "rabbit" already running on "rabbit2" whenever i turn on clustering
[2013-02-15 17:58:16 -0500] zuazo: can be implemented without much problem, but only if the community believes it is interesting
[2013-02-15 17:59:24 -0500] beandip: kammouflage: I have an environment with several elasticsearch clusters.  I wanted to avoid having a cookbook to configure the attributes for these clusters and placed the override attributes in a role for each cluster.  It is clean in a single environment case and only requires the community cookbook.  However, I now have a requirement to spin up another environment with the same set of clusters.
[2013-02-15 18:00:11 -0500] kammouflage: The context makes it much more clear now.
[2013-02-15 18:00:18 -0500] beandip: So, because the role files contain a definition of the host IPs of each node in a unicast discovery, I need to break it up
[2013-02-15 18:00:56 -0500] beandip: I was wondering if there'd be a clean way to do so without having to create a cookbook to set such attributes per environment
[2013-02-15 18:00:57 -0500] kammouflage: I usually slightly modify the community cookbooks and add in an attribute called cluster_name
[2013-02-15 18:01:11 -0500] beandip: I guess it's a good enough time to impliment wrapper cookbooks
[2013-02-15 18:01:40 -0500] beandip: kammouflage: I prefer to stay on community cookbooks whenever possible rather than managing forks
[2013-02-15 18:01:44 -0500] beandip: :)
[2013-02-15 18:01:50 -0500] beandip: It can become messy
[2013-02-15 18:01:53 -0500] kammouflage: then do a search for for nodes in the same environment with the same cluster_name attribute and then set an array with the required attributes of each node (ex: ipaddres)
[2013-02-15 18:02:00 -0500] beandip: I think wrapper cookbooks will be fine for this
[2013-02-15 18:02:43 -0500] dkannan: was rackspace.com using Chef ? was looking at http://www.opscode.com/customers/
[2013-02-15 18:02:56 -0500] zuazo: beandip: yes, wrapper/application cookbooks is the solution you are looking for
[2013-02-15 18:03:39 -0500] beandip: dkannan: rackspace uses chef internally quite a bit
[2013-02-15 18:05:03 -0500] dkannan: beandip: do u know why is it not on the customers list ?
[2013-02-15 18:05:23 -0500] dkannan: asking because am going to give a presentation on chef at the local user group - and wanted a list of bigger customers
[2013-02-15 18:06:10 -0500] mattt: dkannan: how about facebook?  :P
[2013-02-15 18:06:11 -0500] gswallow: ExactTarget!
[2013-02-15 18:06:16 -0500] JoelMcCracken: ahh i might have to start contributing to chef
[2013-02-15 18:06:28 -0500] dkannan: mattt: :-) yes
[2013-02-15 18:06:38 -0500] mattt: dkannan: there are lots of press releases on that one
[2013-02-15 18:07:24 -0500] mmorris: has anyone had any luck specifying the jdk version with the java cookbook?
[2013-02-15 18:07:40 -0500] mmorris: node['java']['jdk']
[2013-02-15 18:11:10 -0500] mmorris: jtimberman: sorry to bug you, but how would i go about choosing jdk 7 using the java cookbook? what syntax is the node['java']['jdk'] wanting?
[2013-02-15 18:11:57 -0500] mmorris: or do i use node['java']['tarball']?
[2013-02-15 18:16:07 -0500] mmorris: jtimberman: never mind, I got it working with node['java']['jdk_version']. I think that's a typo in the README because for Attributes it lists node['java']['jdk'], but in the recipe it wants node['java']['jdk_version']
[2013-02-15 18:21:37 -0500] qhartman: just upgraded to 10.22, and I'm working on cleaning up our recipes in preparation for 11. Seeing a lot of warnings about "cloning resource attributes". I think I understand why this throws warnings now, which is nice to see. Do these need to be cleaned up before migrating to 11 as well?
[2013-02-15 18:28:24 -0500] DilboBaggins: guys, using chef 11 server + client. when i run knife upload using:  knife cookbook -VV upload apache2 I get the following: http://fpaste.org/yw3A/ which looks like it is trying to upload to the workstation itself and not the server. However, my knife.rb is specified with the chef_server correctly here: http://fpaste.org/dMAq/ why is it trying to upload to localhost and not the chef server. Thinks like knife node list work fine h
[2013-02-15 18:33:08 -0500] matti: yfeldblum: Yeah :)
[2013-02-15 18:33:13 -0500] matti: yfeldblum: I agree with you.
[2013-02-15 18:33:24 -0500] matti: yfeldblum: BTW, this web site you put URL to.
[2013-02-15 18:33:28 -0500] matti: yfeldblum: Quite nice, indeed.
[2013-02-15 18:34:12 -0500] matti: yfeldblum: Sorry for being passive-agressive qrumpy asshole. (I was bit furstrated... on Chef 11).
[2013-02-15 18:35:01 -0500] mattupstate: anyone happen to setup a rabbitmq cluster with vagrant?
[2013-02-15 18:45:09 -0500] beandip: dkannan: Big chef users? Riot Games, Rackspace, EngineYard, Facebook, Revinate, IGN, Splunk, Rapsody, Zumba, Fanhatten, Dreamhost, EA, Limelight, Brightcove, Elasticsearch, need more?
[2013-02-15 18:45:17 -0500] beandip: those are just off the top of my head
[2013-02-15 18:45:49 -0500] doomviking: Disney is on the list too, but they probably won't admit it
[2013-02-15 18:49:03 -0500] beandip: Opscode probably has a customer list somewhere on their website
[2013-02-15 18:52:11 -0500] drgage: geez $0.85/hr to store 2TB on amazon's new "redshift". that sounds high to me.
[2013-02-15 18:52:16 -0500] drgage: oops sorry, mischan
[2013-02-15 18:55:28 -0500] jtimberman: customer case studies: http://www.opscode.com/customers/
[2013-02-15 19:31:14 -0500] UForgotten: so here's a wierd one
[2013-02-15 19:31:52 -0500] UForgotten: chef-solo 10.20.0 - it's complaining that it wants ruby-shadow installed, but it already is... and this recipe worked when I ran it yesterday, nothing's changed...
[2013-02-15 19:47:15 -0500] UForgotten: I've googled and I have not found anything useful. :(
[2013-02-15 19:51:07 -0500] deathdonut: hey. Wondering if anyone can tell me the right way to do something.
[2013-02-15 19:51:16 -0500] deathdonut: trying to add a raid array with mdadm
[2013-02-15 19:51:31 -0500] deathdonut: have the resource creating the array
[2013-02-15 19:51:44 -0500] deathdonut: but then need to create the mdadm.conf config file
[2013-02-15 19:52:10 -0500] deathdonut: and need data for that config file that the mdadm command outputs
[2013-02-15 19:52:17 -0500] deathdonut: that is only there after the array is created
[2013-02-15 19:53:11 -0500] deathdonut: is there any way to get information from the node that's changed in the middle of a run?
[2013-02-15 19:53:12 -0500] DilboBaggins: Trying to install chef 11 on a fresh box and getting: "Error executing action `run` on resource 'execute[verify-system-status]'" When i use:  chef-server-ctl reconfigure. Whats happning here?
[2013-02-15 19:53:27 -0500] DilboBaggins: chef-server that is
[2013-02-15 20:04:53 -0500] yfeldblum: matti, i've found 12factor to be helpful to me when thinking about infrastructure and application and how to make them work with each other
[2013-02-15 20:06:15 -0500] yfeldblum: matti, especially its overriding philosophy, which is to create a very small, very simple interface that both sides have to agree to
[2013-02-15 20:07:07 -0500] yfeldblum: matti, that way, you don't have to have a separate cookbook for each separate application; you just have a single cookbook that implements its side of the contract, and expect any application - nodejs, java, rails - to implement the other side
[2013-02-15 20:15:00 -0500] yfeldblum:  Unsupported `json_class` type 'Chef::Checksum' - (JSON::ParserError)
[2013-02-15 20:15:06 -0500] yfeldblum: when uploading a cookbook
[2013-02-15 20:15:14 -0500] yfeldblum: is there something i need to upgrade?
[2013-02-15 20:15:19 -0500] matti: yfeldblum: 1.7.7 json gem
[2013-02-15 20:15:27 -0500] matti: yfeldblum: And Chef 10.22.0 or 11.4.0
[2013-02-15 20:15:54 -0500] yfeldblum: matti, this is with json-1.7.7 and chef-10.22.0
[2013-02-15 20:16:05 -0500] yfeldblum: this is in the chef-server-api
[2013-02-15 20:16:17 -0500] yfeldblum: from /var/log/chef/server.log
[2013-02-15 20:16:21 -0500] matti: Wooot.
[2013-02-15 20:17:05 -0500] matti: I really wish OpsCode would test better.
[2013-02-15 20:17:06 -0500] matti: ;]
[2013-02-15 20:17:20 -0500] yfeldblum: matti, they do
[2013-02-15 20:17:39 -0500] yfeldblum: matti, they're just using our production environments as their CI
[2013-02-15 20:17:44 -0500] yfeldblum: matti, because jenkins is hard
[2013-02-15 20:17:48 -0500] matti: LOL
[2013-02-15 20:17:53 -0500] matti: ;D
[2013-02-15 20:18:15 -0500] miah: they do a decent amount of testing
[2013-02-15 20:18:33 -0500] miah: managing dependencies can be a pain though
[2013-02-15 20:18:47 -0500] matti: miah: I am sure they do, but I wish they could do better ;]
[2013-02-15 20:18:48 -0500] miah: especially when breaking changes are introduced and you aren't doing hard version locks
[2013-02-15 20:19:25 -0500] miah: thankfully they at least react quickly.
[2013-02-15 20:19:31 -0500] matti: We are going to make an interesting decision at work.
[2013-02-15 20:19:35 -0500] matti: We went Puppet -> Chef.
[2013-02-15 20:19:48 -0500] matti: But today topic was Chef -> Puppet
[2013-02-15 20:19:49 -0500] matti: ;d
[2013-02-15 20:21:38 -0500] yfeldblum: jtimberman, Unsupported `json_class` type 'Chef::Checksum' - (JSON::ParserError)
[2013-02-15 20:23:00 -0500] mattupstate: anyone have any tips on using the rabbitmq cookbook? I can't seem to get clustering to work
[2013-02-15 20:23:03 -0500] jtimberman: matti: what's the tl;dr on "opscode should test better"?
[2013-02-15 20:23:40 -0500] yfeldblum: jtimberman, are there any other dependencies of chef-server 10.22 that need to be upgraded?
[2013-02-15 20:24:07 -0500] jtimberman: the incompatible changes in the json gem 1.7.6 -> 1.7.7 is not a thing we could have predicted for testing.
[2013-02-15 20:24:12 -0500] matti: jtimberman: Seen my message on Twitter?
[2013-02-15 20:24:22 -0500] jtimberman: matti: No?
[2013-02-15 20:24:25 -0500] matti: jtimberman: Knife does not work even following your very own blog post.
[2013-02-15 20:24:27 -0500] miah: url it up
[2013-02-15 20:24:29 -0500] jtimberman: yfeldblum: i don't know?
[2013-02-15 20:24:49 -0500] matti: jtimberman: One second.
[2013-02-15 20:25:16 -0500] yfeldblum: kallistec, btm, any ideas on that?
[2013-02-15 20:25:55 -0500] matti: jtimberman: http://pastebin.com/CXykFr5x
[2013-02-15 20:26:10 -0500] kallistec: yfeldblum: where?
[2013-02-15 20:26:19 -0500] matti: jtimberman: Chef Server 11 from Omnibus and Chef (client) 11.4.0.
[2013-02-15 20:26:21 -0500] btm: yfeldblum: you doing anything fancy/custom? I'm not paying much attention.
[2013-02-15 20:26:44 -0500] jtimberman: matti: Rerun with -VV?
[2013-02-15 20:26:51 -0500] yfeldblum: kallistec, `knife cookbook upload <whatever>` fails, and the exception in /var/log/chef/server.log is ` Unsupported `json_class` type 'Chef::Checksum' - (JSON::ParserError)`
[2013-02-15 20:27:10 -0500] matti: jtimberman: I used this as example: http://jtimberman.housepub.org/blog/2013/02/10/install-chef-11-server-on-centos-6/
[2013-02-15 20:27:16 -0500] yfeldblum: btm, no, apart from upgrading the chef-server and json gems in an elderly oss-chef-server
[2013-02-15 20:27:42 -0500] matti: jtimberman: -ctl stop leaves beam processes behind.
[2013-02-15 20:27:42 -0500] btm: yfeldblum: gem cleanup?
[2013-02-15 20:27:57 -0500] yfeldblum: kallistec, btm, i cleaned everything up
[2013-02-15 20:27:59 -0500] matti: jtimberman: -ctl kill does nothing to them :)
[2013-02-15 20:28:05 -0500] matti: jtimberman: -ctl int failes with exception ;p
[2013-02-15 20:28:38 -0500] yfeldblum: kallistec, btm, only one version of each gem is installed; including json-1.7.7 and the chef and chef-* gems all at 10.22.0
[2013-02-15 20:28:53 -0500] kallistec: probably a legit issue
[2013-02-15 20:28:55 -0500] glennpratt: anyone do anything special to protect chef client resources when your customers have shell access (not root)
[2013-02-15 20:29:01 -0500] jtimberman: matti: so if you rerun the knife configure command with -VV, what is the output?
[2013-02-15 20:29:09 -0500] matti: jtimberman: One second.
[2013-02-15 20:33:46 -0500] matti: jtimberman: http://pastebin.com/JXsQMTkL
[2013-02-15 20:34:02 -0500] matti: jtimberman: User admin is there. Its a vanilla Omnibus install.
[2013-02-15 20:34:03 -0500] btm: yfeldblum: could you file a bug with -V -V output, platform, platform_version, gem list?
[2013-02-15 20:40:33 -0500] matti: jtimberman: I can file a bug if needed, or something.
[2013-02-15 20:40:34 -0500] matti: ;]
[2013-02-15 20:50:34 -0500] btm: yfeldblum: can you grab the chef repo from github: git checkout 10-stable && cd chef && rake gem && gem install pkg/chef-*.gem --no-rdoc --no-ri
[2013-02-15 20:50:40 -0500] btm: yfeldblum: and let me know if that fixes for you?
[2013-02-15 20:50:53 -0500] timsmith: jtimberman: I have a meeting at 1 for work. If you guys could skip my tickets that would be great.  I'll be there for the 2nd half of the code review
[2013-02-15 20:51:47 -0500] yfeldblum: btm, "10.14.0.rc.0"? lulz
[2013-02-15 20:55:00 -0500] yfeldblum: you need cucumber to `rake gem`
[2013-02-15 20:55:29 -0500] UForgotten: matti: I thought json 1.7.7 had a bug in it?
[2013-02-15 20:55:51 -0500] matti: UForgotten: Isn't it 1.7.7 + >= 10.22.0?
[2013-02-15 20:55:52 -0500] btm: yfeldblum: yeah it's a typo in the commit message.
[2013-02-15 20:56:02 -0500] btm: yfeldblum: yeah, maybe a 'bundle install'
[2013-02-15 20:56:02 -0500] yfeldblum: btm, :D
[2013-02-15 20:56:25 -0500] btm: trying to fix a few issues at once here every day this week :P
[2013-02-15 20:56:44 -0500] jtimberman: matti: i can't reproduce your issue.
[2013-02-15 20:56:56 -0500] jtimberman: does "v7.b1-r4.sv2" resolve?
[2013-02-15 20:57:01 -0500] matti: jtimberman: Yes.
[2013-02-15 20:57:25 -0500] matti: jtimberman: As you can see form the top -- it works initially, redirect etc.
[2013-02-15 20:57:36 -0500] jtimberman: https://gist.github.com/jtimberman/7a2820cc10edaeb614d4
[2013-02-15 20:57:45 -0500] matti: jtimberman: I later works fine with a user, if I first add it via web UI
[2013-02-15 20:57:57 -0500] UForgotten: I duno.
[2013-02-15 20:58:18 -0500] UForgotten: all I know is that my chef 10.20.0 won't find ruby-shadow for some reason.
[2013-02-15 20:58:21 -0500] btm: Opscode Cookbook Code Review: join: http://bit.ly/VnkLa3, watch: http://youtu.be/pY7W6pzMAaY #opschef
[2013-02-15 20:58:25 -0500] btm: timsmith: +1
[2013-02-15 20:59:38 -0500] matti: jtimberman: Plus it got some data back, and fails immediately after decompressing it and reading the content -- so it would appear.
[2013-02-15 20:59:51 -0500] jtimberman: with -VV, https://gist.github.com/jtimberman/7a2820cc10edaeb614d4#file-vv
[2013-02-15 21:00:27 -0500] yfeldblum: btm, would i need to restart everything or just chef-server-api?
[2013-02-15 21:02:11 -0500] btm: yfeldblum: hrm. probably just the api server
[2013-02-15 21:02:31 -0500] matti: jtimberman: It is a proper IN A entry with reverse added.
[2013-02-15 21:05:04 -0500] yfeldblum: btm, i installed from the tip of 10-stable and uploading cookbooks worked
[2013-02-15 21:05:28 -0500] yfeldblum: btm, so the issue i described is no longer present in the tip of 10-stable
[2013-02-15 21:05:43 -0500] UForgotten: ok so wait, 1.22. is out and is OK with json 1.7.7  ? i must have missed that
[2013-02-15 21:05:49 -0500] UForgotten: 10.22 rather.
[2013-02-15 21:06:01 -0500] josephholsten: jtimberman: %PROGRAMFILES%
[2013-02-15 21:09:01 -0500] erratic: hi sorry, showing up late to the game as usual, I've got chef server 10.20, ubuntu 12.10 not sure what version of rabbitmq but someone here awhile ago mentioned something about a memory leak possibly?
[2013-02-15 21:09:38 -0500] erratic: was wondering if anybody had any information to point me to
[2013-02-15 21:10:26 -0500] erratic: rabbitmq chews through memory and cpu until its oom killed
[2013-02-15 21:11:07 -0500] erratic: my guess is the queues are filling up and never getting answered
[2013-02-15 21:12:23 -0500] erratic: I should turn on the webui for it
[2013-02-15 21:14:12 -0500] btm: yfeldblum: thanks.
[2013-02-15 21:19:41 -0500] mattupstate: erratic: have you had any success using the rabbitmq cookbook to setup a cluster?
[2013-02-15 21:20:37 -0500] erratic: mattupstate: sorta
[2013-02-15 21:20:48 -0500] erratic: I think I had to do some stuff by hand
[2013-02-15 21:21:00 -0500] erratic: including joining the cluster nodes together
[2013-02-15 21:21:10 -0500] erratic: the cookbook took care of some cookie
[2013-02-15 21:21:15 -0500] erratic: ant that was about it
[2013-02-15 21:21:41 -0500] erratic: im not constantly adding and removing nodes to the rabbitmq cluster so
[2013-02-15 21:21:52 -0500] erratic: haven't had much of a need? although its a cool idea
[2013-02-15 21:22:40 -0500] mattupstate: i see
[2013-02-15 21:22:47 -0500] mattupstate: i haven't had any success yet
[2013-02-15 21:22:57 -0500] mattupstate: trying to automate it
[2013-02-15 21:23:20 -0500] erratic: yeah you'll have to use rabbitmqctl to join the nodes together
[2013-02-15 21:23:34 -0500] erratic: and I think there's a concept of a primary although I can't remember
[2013-02-15 21:23:39 -0500] mattupstate: you're supposed to be able to do it in the config file
[2013-02-15 21:24:14 -0500] mattupstate: and the cookbook attempts that
[2013-02-15 21:24:42 -0500] mattupstate: but there is something fishy or there just isn't enough documentation on how to do it correctly
[2013-02-15 21:24:45 -0500] btm: yfeldblum: that'll be in a release soon.
[2013-02-15 21:25:18 -0500] yfeldblum: btm, awesome
[2013-02-15 21:25:46 -0500] yfeldblum: btm, do you have an ETA or should i just poll rubygems.org?
[2013-02-15 21:26:36 -0500] erratic: im going to need to go get something to eat soon
[2013-02-15 21:30:26 -0500] btm: yfeldblum: a few hours.
[2013-02-15 21:30:34 -0500] yfeldblum: btm, cool
[2013-02-15 21:35:33 -0500] jarosser06: this is going to be a dumb question but how do you use ohai attributes in recipes?
[2013-02-15 21:36:35 -0500] yfeldblum: jarosser06, the_value = node["some_ohai_key"]["some_ohai_subkey"]
[2013-02-15 21:37:12 -0500] yfeldblum: jarosser06, the ohai data is merged into the node attributes at the beginning of every chef-client run, and can be gotten at, in any recipe, from the node attributes
[2013-02-15 21:38:07 -0500] teukka: btm: does it ever make sense to give both -p and -v options to install.sh? or is there always only one pre-install package to be downloaded?
[2013-02-15 21:38:34 -0500] jarosser06: so to check the platform I should be able to use node['platform'] in a case statement right?
[2013-02-15 21:40:51 -0500] miah: yes
[2013-02-15 21:41:00 -0500] miah: or node['platform_family']
[2013-02-15 21:41:53 -0500] jarosser06: Im getting an error that I must supply a name when declaring a default resource
[2013-02-15 21:45:46 -0500] jarosser06: ahh thanks Im a moron
[2013-02-15 21:53:12 -0500] btm: teukka: there could be a 10.x prerelease and an 11.x prerelease at the same time. I usually just use -v with whatever prerelease version I want.
[2013-02-15 21:55:32 -0500] teukka: btm: OK, thanks. actually if -v does not support other that full version numbers the -p is not needed...
[2013-02-15 21:56:32 -0500] teukka: btm: but it would be nice to tell the installer "I want the latest 10.x version"
[2013-02-15 21:57:18 -0500] teukka: btm: e.g. https://www.opscode.com/chef/download?v=10&...
[2013-02-15 22:00:45 -0500] jaimef: in a script block can you use ruby variables?
[2013-02-15 22:01:08 -0500] yfeldblum: jaimef, yes, but not in an intuitive way
[2013-02-15 22:01:23 -0500] jaimef: looking for example
[2013-02-15 22:02:06 -0500] miah: script blocks are bad juju
[2013-02-15 22:02:16 -0500] jaimef: all ears for better recommendations
[2013-02-15 22:02:38 -0500] miah: in order to make recommendations we'd need to know what you're trying to accomplish.
[2013-02-15 22:04:26 -0500] doomviking: something to eat at a hockey game that isn't hotdog based, for instance.
[2013-02-15 22:04:36 -0500] jaimef: ice
[2013-02-15 22:04:44 -0500] doomviking: they put chemicals on that too.
[2013-02-15 22:05:10 -0500] miah: dont go to hockey games
[2013-02-15 22:05:33 -0500] doomviking: see, thats a valid recommendation.
[2013-02-15 22:05:51 -0500] miah: or, eat before you go.
[2013-02-15 22:05:57 -0500] doomviking: or just drink beer
[2013-02-15 22:06:04 -0500] miah: if you drink beer, sure.
[2013-02-15 22:06:22 -0500] miah: i'm personally found of my cognitive abilities
[2013-02-15 22:06:37 -0500] miah: even when i misspell words
[2013-02-15 22:07:17 -0500] miah: hot dogs are great, because almost no american would directly eat a cows ass.. but put in a bun with ketchup and they'll gobble that up.
[2013-02-15 22:07:18 -0500] doomviking: work is taking a backseat to hockey dogs and beers today.
[2013-02-15 22:08:05 -0500] jtimberman: josephholsten: :D
[2013-02-15 22:08:14 -0500] mattt: miah: i'm in the UK, we don't have quite the same hot dog culture here
[2013-02-15 22:08:32 -0500] mattt: mainly it's cheap burgers that are turning out to be horse meat
[2013-02-15 22:08:42 -0500] doomviking: I read about that
[2013-02-15 22:08:45 -0500] jtimberman: mattt: I'm not seeing a redirect on the knife configure -i.
[2013-02-15 22:08:51 -0500] doomviking: the French connection
[2013-02-15 22:09:02 -0500] jtimberman: mattt: are you putting another layer in front of the chef server, beyond the nginx that is already running?
[2013-02-15 22:09:04 -0500] reclaimer: I'm attempting to provision a VM with Vagrant and Chef-Solo with the elasticsearch cookbook. However, it appears the templates aren't being applied. I can see in the console output that it "updated content" but when I open the file on the VM, none of the ERB was interpolated. Any guidance would be appreciated.
[2013-02-15 22:09:19 -0500] gchristensen: miah: what about a butt steak?
[2013-02-15 22:09:24 -0500] gchristensen: or a rump roast?
[2013-02-15 22:09:30 -0500] doomviking: oh dear.
[2013-02-15 22:10:57 -0500] miah: rumproast is different because feces never actually passes through it.
[2013-02-15 22:11:17 -0500] miah: but its also delicious
[2013-02-15 22:11:31 -0500] miah: or maybe 'butt its also delicious'
[2013-02-15 22:12:28 -0500] mattupstate: ha
[2013-02-15 22:12:33 -0500] mattupstate: tube steak
[2013-02-15 22:13:01 -0500] miah: i would have no issues with eating a horse
[2013-02-15 22:13:19 -0500] miah: so long as its sold to me as 'horse' and not 'cow'
[2013-02-15 22:13:31 -0500] miah: because on principal i dont want to be lied to
[2013-02-15 22:13:49 -0500] mattupstate: horse is supposed to be pretty tastey
[2013-02-15 22:13:55 -0500] miah: indeed
[2013-02-15 22:14:13 -0500] graphex: secret's in the sauce
[2013-02-15 22:33:42 -0500] zts: is it just me, or is "speaker bio" the hardest thing to fill out in a conference session proposal?
[2013-02-15 22:34:03 -0500] jubilo: heh, it's not just you :)
[2013-02-15 22:35:05 -0500] zts: phew :)
[2013-02-15 22:45:46 -0500] david415: miah: oh hai!
[2013-02-15 22:47:02 -0500] miah: hi
[2013-02-15 22:47:53 -0500] zenloop: Hey what are people doing for backups?  Is it possible to use one solution to save node data and configuration data?
[2013-02-15 22:49:01 -0500] miah: who cares about node data
[2013-02-15 22:49:10 -0500] miah: infrastructure as code y0
[2013-02-15 22:50:21 -0500] luckymike: zenloop: can you clarify? your configuration should be entirely reproducible without backing up
[2013-02-15 22:50:34 -0500] doomviking: reboot? poop on that. redeploy.
[2013-02-15 22:51:05 -0500] mattt: doomviking: any relation to technoviking?
[2013-02-15 22:51:22 -0500] miah: i believe they're cousins
[2013-02-15 22:51:33 -0500] miah: or at least, both vikings
[2013-02-15 22:51:40 -0500] miah: maybe differing clans
[2013-02-15 22:52:11 -0500] doomviking: none
[2013-02-15 22:52:34 -0500] doomviking: I can't abide the bep beep electronics.
[2013-02-15 22:53:00 -0500] zenloop: @miah: yah makes sense.  I want to save node data to maintain state for systems integration.
[2013-02-15 22:53:33 -0500] zenloop: So I know that I have a database server in this ec2 zone, when application servers come up the search node data and point to appropriate databases.
[2013-02-15 22:54:16 -0500] miah: you dont need to do that to orchaestrate things correctly
[2013-02-15 22:54:28 -0500] doomviking: I use roles for that, but ymmv
[2013-02-15 22:54:41 -0500] zenloop: miah: do explain :-)
[2013-02-15 22:55:47 -0500] zts: zenloop: this tool's worth a look - http://fnichol.github.com/knife-server/
[2013-02-15 22:55:48 -0500] miah: roles, write RP that have the ability to search and test for functionality
[2013-02-15 22:56:01 -0500] miah: write code to do smart things
[2013-02-15 22:56:06 -0500] miah: rocks != hammer
[2013-02-15 22:56:53 -0500] zts: none of that obviates the need for server backups
[2013-02-15 22:57:11 -0500] doomviking: hammer = time
[2013-02-15 22:57:38 -0500] zts: even if the only piece of node data you care about is the run_list
[2013-02-15 23:02:19 -0500] miah: why? your run list should be stored in roles, which should be stored in git.
[2013-02-15 23:02:22 -0500] miah: backup git. you're set.
[2013-02-15 23:02:36 -0500] miah: stop thinking about individual snowflakes
[2013-02-15 23:02:53 -0500] zts: sure, so you have 200 servers, and your chef server blows up
[2013-02-15 23:02:59 -0500] zts: which node has which roles?
[2013-02-15 23:04:08 -0500] miah: good thing i have that data stored in a dvcs
[2013-02-15 23:04:25 -0500] miah: because you should be creating your roles in json or ruby and then uploading them to the server
[2013-02-15 23:04:36 -0500] miah: and never using chef-web-ui to do _any_ administrative work
[2013-02-15 23:05:18 -0500] jtimberman: zts: well, think of the things that your systems do, and create roles accordingly, right?
[2013-02-15 23:05:19 -0500] miah: only thing i care about backing up: database data, my git repos
[2013-02-15 23:06:20 -0500] zts: jtimberman: I'm clearly not explaining myself very well :)  Yes I have a set of roles, and I allocate roles to machines.  If a machine blew up, I'd assign those roles to its replacement.
[2013-02-15 23:06:39 -0500] jtimberman: right.
[2013-02-15 23:06:40 -0500] zts: jtimberman: at issue is where the mapping of roles to nodes occurs
[2013-02-15 23:06:50 -0500] jtimberman: spiceweasel
[2013-02-15 23:06:53 -0500] jtimberman: helps with that
[2013-02-15 23:08:23 -0500] zts: jtimberman: to be fair, I haven't used it (though I'm aware it exists).  However, I thought it solved a different use case
[2013-02-15 23:09:36 -0500] zts: to be honest, I'm a bit bewildered that "I want to backup my Chef server" can lead so quickly to "you're probably doing it wrong"
[2013-02-15 23:10:21 -0500] zts: hopefully there will be a session at ChefConf that shows me where I'm going wrong :)
[2013-02-15 23:10:22 -0500] bluepojo: schisamo: Any progress on the Hubot cookbook?
[2013-02-15 23:11:51 -0500] jtimberman: zts: well, arey ou using chef 10 or 11?
[2013-02-15 23:12:22 -0500] jtimberman: zts: if 11, your chef server's data store is in postgresql.
[2013-02-15 23:12:29 -0500] jtimberman: if 10, the data store is couchdb
[2013-02-15 23:12:49 -0500] zts: jtimberman: "yes" - note, however, I wasn't the one asking the original question :)
[2013-02-15 23:12:59 -0500] jtimberman: sure i didn't follow all the conversation in here :)
[2013-02-15 23:13:03 -0500] jtimberman: on this thread.
[2013-02-15 23:13:03 -0500] zts: it's cool :)
[2013-02-15 23:13:22 -0500] jtimberman: so if your chef server is 11, then you need to back up a postgresql database.
[2013-02-15 23:13:34 -0500] jtimberman: however it is you want to do that is up to you. it lives in /var/opt/chef-server.
[2013-02-15 23:13:54 -0500] jtimberman: there's also the matter of cookbook content on disk, which is stored by bookshelf, under that same directory
[2013-02-15 23:14:23 -0500] jtimberman: if the chef server is 10, then you need to back up the couchdb database. the location varies based on how couchdb and chef server were installed.
[2013-02-15 23:14:43 -0500] jtimberman: and you back that up with whatever tools folks use for couchdb backups :)
[2013-02-15 23:17:00 -0500] martinisoft: jtimberman: has the jamie-ci stuff been fully merged into test kitchen now?
[2013-02-15 23:17:13 -0500] miah: you can use spiceweasel or other workflow tools to manage the actual build out of your infrastructure. but generally i don't care about tieing a specific role to a specific node. i just spin up a new node with that role. i suppose this is a little less trivial when youre not in cloudland. but still, you should have something that handles the bootstraping, like razor or spiceweasel or kickstart etce etc
[2013-02-15 23:17:31 -0500] jtimberman: martinisoft: yeah
[2013-02-15 23:17:45 -0500] martinisoft: awesome
[2013-02-15 23:17:54 -0500] jtimberman: martinisoft: its in a branch
[2013-02-15 23:18:10 -0500] martinisoft: ah, so its not in master or a release yet?
[2013-02-15 23:19:41 -0500] mattt: zts: i do see your concern tho
[2013-02-15 23:19:54 -0500] mattt: if you have a crap ton of nodes and a crap ton of roles, that'd get hairy
[2013-02-15 23:24:55 -0500] miah: nodes shouldnt be unique enough that you care abuot them though
[2013-02-15 23:27:26 -0500] matti: jtimberman: It does not work on the same host as the server via lo.
[2013-02-15 23:27:33 -0500] matti: jtimberman: Same error.
[2013-02-15 23:39:36 -0500] matti: jtimberman: Solution found.
[2013-02-15 23:39:51 -0500] matti: jtimberman: When you use http:// it will make an re-direct to https://
[2013-02-15 23:40:29 -0500] matti: jtimberman: And then knife goes to follow, but will make request as GET not as PUT -- in case of uploading cookbook.
[2013-02-15 23:41:08 -0500] matti: jtimberman: Same thing with configure.
[2013-02-15 23:42:03 -0500] matti: jtimberman: Despite easy fix http -> https, I would consider this a bug in knife.
[2013-02-15 23:42:20 -0500] matti: jtimberman: As knife is changing its behaviour after following redirect.
[2013-02-15 23:46:38 -0500] matti: jtimberman: Upload cookbook -> refresh list in web UI -> delete cookbook -> refresh list in web UI => ERROR: undefined method `map' for nil:NilClass
[2013-02-15 23:47:35 -0500] p_mc: hello all.  I am getting started with vagrant and chef.  We use hosted chef.  What is the best way of working with vagrant?  Should have I vagrant file in each of our cookbooks?
[2013-02-15 23:48:48 -0500] matti: No.
[2013-02-15 23:50:20 -0500] p_mc: one vagrant file in our repo and we just edit the run list based on what we're doing?
[2013-02-15 23:51:27 -0500] chip-: p_mc: Depends on your cookbook, honestly.
[2013-02-15 23:52:54 -0500] tomdzk: p_mc: vagrant files generally describe one or more VMs, so unless you have a 1:1 relationship between VM and cookbook, you'd probably be better off having them separately
[2013-02-15 23:53:11 -0500] chip-: See, I think I disagree there too.
[2013-02-15 23:54:02 -0500] tomdzk: plus if you use the chef server provider, it will interact with the chef server, not the local cookbooks, so it might be confusing to have it in the same folder as a cookbook that it won't use (directly)
[2013-02-15 23:54:05 -0500] mattupstate: p_mc: i have a Vagrant file per project and either use git submodules to pull in the required cookbooks from out chef repo or create a symbolic link from the project folder to the chef repo on my local machine
[2013-02-15 23:54:53 -0500] mattupstate: and configure it like so: chef.cookbooks_path = ".chef/cookbooks"
[2013-02-15 23:55:01 -0500] mattupstate: where .chef is linked to the chef repo
[2013-02-15 23:55:02 -0500] tomdzk: we have vagrant files separately and read in the Chef::Config (knife.rb) and use the values from there to drive chef solo (e.g. get the cookbooks path from there)
[2013-02-15 23:58:24 -0500] p_mc: tomdzk: so when you are doing development you use chef solo and load the cookbooks from the local directory rather than the server.
