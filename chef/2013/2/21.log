[2013-02-21 00:03:00 -0500] kbennett: Does a node in chef refer to a single host?
[2013-02-21 00:04:08 -0500] lazyPower-Work: kbennett: correct
[2013-02-21 00:09:44 -0500] allaire: you cannot edit a ticket?
[2013-02-21 00:10:54 -0500] kbennett: I'm thinking of learning chef by first learning chef solo so I can learn about cookbooks & recipes without needing to know the multihost issues.  Good or bad idea?
[2013-02-21 00:11:18 -0500] kbennett: (Then I would do the hosted chef approach.)
[2013-02-21 00:11:36 -0500] allaire: kbennett: take a look at chef solo with knife solo gem
[2013-02-21 00:11:44 -0500] allaire: really a good mix IMO
[2013-02-21 00:11:47 -0500] lazyPower-Work: kbennett: Depends on what your goals are. I learned using vagrant and chef-solo - then i went buck wild and installed open-chef
[2013-02-21 00:11:49 -0500] allaire: took me a while to find out
[2013-02-21 00:11:50 -0500] miah: allaire: you can leave comments on a ticket once it has been created
[2013-02-21 00:12:17 -0500] allaire: lazyPower-Work: open-chef?
[2013-02-21 00:12:23 -0500] miah: open source chef server
[2013-02-21 00:12:28 -0500] allaire: ah
[2013-02-21 00:12:31 -0500] miah: rather than private chef server, or hosted chef server
[2013-02-21 00:12:43 -0500] allaire: private vs hosted?
[2013-02-21 00:13:19 -0500] allaire: whats the diff
[2013-02-21 00:13:44 -0500] BenP__: Whether you're buying SaaS or Software + Consulting.
[2013-02-21 00:15:25 -0500] miah: you're basically getting on premise hosted chef
[2013-02-21 00:15:31 -0500] miah: vs hosted chef
[2013-02-21 00:16:13 -0500] lazyPower-Work: allaire: It affords me the opportunity to run a chef-server without the added cost of going through opscode. They were nice enough to provide it so I'll use it and promote it among my friends - because i'd like to see chef take over the world.
[2013-02-21 00:16:17 -0500] lazyPower-Work: one server/workstation pair at a time.
[2013-02-21 00:16:55 -0500] allaire: miah: That's still not much clear for me, but w/e :P
[2013-02-21 00:17:07 -0500] allaire: lazyPower-Work: Yeah chef is nice so far! Never tried puppet though
[2013-02-21 00:17:08 -0500] miah: allaire: hosted chef = opscode hosts the chef server for you "
[2013-02-21 00:17:11 -0500] miah: "in the cloud"
[2013-02-21 00:17:27 -0500] miah: private chef means = opscode supports the chef server for you. on your hardware. in your data center.
[2013-02-21 00:17:34 -0500] allaire: but I bet as along as you have some kind of automatization, your miles ahead of most of the people
[2013-02-21 00:17:39 -0500] allaire: miah: Roger that!
[2013-02-21 00:17:40 -0500] miah: open source chef means, you deal with it
[2013-02-21 00:18:10 -0500] allaire: anyone pays here?
[2013-02-21 00:18:13 -0500] allaire: or mostly open-chef?
[2013-02-21 00:19:26 -0500] miah: i use hosted chef
[2013-02-21 00:19:52 -0500] log1kal: I run open-chef
[2013-02-21 00:20:09 -0500] allaire: miah: So you just tell them what setup you want and they install it for you?
[2013-02-21 00:20:47 -0500] miah: no
[2013-02-21 00:20:57 -0500] miah: they just provide me with api access to a chef server on the internet and i use it
[2013-02-21 00:21:32 -0500] miah: i'd recommend you read www.opscode.com
[2013-02-21 00:21:58 -0500] miah: opscode just makes sure i dont have to also manage a chef server
[2013-02-21 00:22:05 -0500] miah: because i'm already managing a bunch of other stuff
[2013-02-21 00:22:34 -0500] allaire: got it
[2013-02-21 00:22:51 -0500] allaire: anybody also have experiences with Puppet, how do they compare?
[2013-02-21 00:23:07 -0500] allaire: I'm pretty new to this Ops world :)
[2013-02-21 00:24:29 -0500] flaccid: allaire: not the right place to ask, try the www
[2013-02-21 00:24:49 -0500] allaire: true
[2013-02-21 00:26:20 -0500] miah: or a more agnostic channel =)
[2013-02-21 00:26:58 -0500] doomviking: haha
[2013-02-21 00:27:55 -0500] flaccid: ##devops exist
[2013-02-21 00:31:54 -0500] AdamAFlynn: what's the best way to migrate an existing node to a new physical node?
[2013-02-21 00:31:59 -0500] mhalligan: is there a good way to make berkshelf ignore syntax checking just on one directory? I've got a bunch of sensu plugins under sitecookbook/files/default and it pukes on some of them
[2013-02-21 00:32:12 -0500] mhalligan: well all of them
[2013-02-21 00:32:23 -0500] AdamAFlynn: trying to preserve the underlying node record but have a clean chef install on new hardware
[2013-02-21 00:32:35 -0500] mhalligan: I'd rather not always use --skip-syntax-check
[2013-02-21 00:33:06 -0500] AdamAFlynn: bootstrap doesn't like using an existing node... considering just copying /etc/chef/ to the target node and installing chef-client/ohai manually, but is there a better way?
[2013-02-21 00:39:16 -0500] flaccid: mhalligan: #berkshelf
[2013-02-21 00:40:41 -0500] stevenator: hi all, how is everyone getting around contrib space cookbooks that don't supply a node attribute for version on the package resource? Are contrib cookbooks always relying on the latest release of a package (through apt in my case)?
[2013-02-21 00:41:16 -0500] flaccid: stevenator: whats a contrib cookbook?
[2013-02-21 00:41:26 -0500] mhalligan: thanks
[2013-02-21 00:41:32 -0500] stevenator: flaccid: like apache2 or php
[2013-02-21 00:41:41 -0500] stevenator: flaccid: from the community site
[2013-02-21 00:42:02 -0500] flaccid: stevenator: i think those are opscode, but regardless it comes down to how the cookbook is designed. doesn't matter where its from
[2013-02-21 00:42:17 -0500] tomdzk: stevenator: you could provide a patch for the cookbook, or pin the package version on the apt level
[2013-02-21 00:42:33 -0500] flaccid: version shouldn't be a node attribute because non rolling release distros are used, you can't just supply a version
[2013-02-21 00:44:08 -0500] tomdzk: flaccid: what's a non-rolling release distro ?
[2013-02-21 00:44:26 -0500] stevenator: flaccid: so it sounds like I'm trying to solve a problem that I don't have
[2013-02-21 00:44:28 -0500] flaccid: tomdzk: when which does not update package versions within a release
[2013-02-21 00:44:37 -0500] flaccid: stevenator: do you have a problem?
[2013-02-21 00:47:20 -0500] stevenator: flaccid: Thanks for asking :). I am trying to be smart about my recipes when they use a community cookbook. If I a wrapping say apache2, I want to make sure that any recipe I write will work against the version that apt provisions.But you are saying that since the distro already pins to releases based on sources.list, I don't necessarily need to worry about the underlying package versioning.
[2013-02-21 00:47:55 -0500] flaccid: stevenator: what distro and release are you using?
[2013-02-21 00:48:12 -0500] stevenator: flaccid: currently looking at ubuntu 12.04 - Precise
[2013-02-21 00:48:23 -0500] flaccid: stevenator: http://packages.ubuntu.com/
[2013-02-21 00:48:30 -0500] flaccid: tells you what you get for each release
[2013-02-21 00:48:52 -0500] flaccid: you may also like to learn how to use apt cli
[2013-02-21 00:50:08 -0500] allaire: miah: added it in the medata.rb, didn't fix my issue, ah well :(
[2013-02-21 00:51:17 -0500] miah: did you upload your cookbook after making the change?
[2013-02-21 00:52:52 -0500] stevenator: flaccid: thank you. I am on the same page now. thanks
[2013-02-21 00:53:02 -0500] flaccid: kk
[2013-02-21 00:53:02 -0500] allaire: miah: yes
[2013-02-21 00:53:59 -0500] miah: did you do this?
[2013-02-21 00:53:59 -0500] miah: node['build_essential']['compiletime'] - Whether the resources in the default recipe should be configured at the "Compile" phase of the Chef run. Defaults to false, see Usage for more information.
[2013-02-21 00:55:36 -0500] allaire: miah: I'm adding it now in my node file, just to see if there is a difference, because the postgres gem should do it https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/ruby.rb#L29
[2013-02-21 00:56:47 -0500] zv470: Hi, I'm wondering does anyone know if there'll be a 32-bit version of Chef 11 Server?
[2013-02-21 00:57:10 -0500] flaccid: zv470: not sure but 32bit is being deprecated in linux 3.8 :)
[2013-02-21 00:58:18 -0500] zv470: I know it's old :) but when u have a spare box that's 32bit it's a shame I can't use it
[2013-02-21 00:59:48 -0500] miah: allaire: it sets it, but im not sure it would apply to that client run
[2013-02-21 01:00:57 -0500] allaire: miah: no luck again, abort.
[2013-02-21 01:03:08 -0500] miah: i havent used the postgres cookbook, so sorry i dont know the code that well
[2013-02-21 01:05:12 -0500] flaccid: zv470: you can with an earlier version of chef
[2013-02-21 01:07:45 -0500] zv470: Hmm @flaccid, haven't been able to. Spent all day yesterday trying to install server, it borked at so many roadblocks. Do u have a link to a tutorial that actually works, all te ones I saw failed at different points :P
[2013-02-21 01:07:58 -0500] jchackert: my org jhackert is running really slow. I'm in training with Sean. He thought y'all could help
[2013-02-21 01:08:21 -0500] flaccid: zv470: omnibus works. but i don't know what you are running and if you can't manage chef server, thats what hosted chef is for
[2013-02-21 01:08:36 -0500] lazyPower-Work: +1 on reference to hosted chef
[2013-02-21 01:08:45 -0500] flaccid: jchackert: wrong chan?
[2013-02-21 01:08:46 -0500] zv470: I'm not going to give up :)
[2013-02-21 01:09:06 -0500] flaccid: good luck. but we can't help with problems if we are not shown them..
[2013-02-21 01:09:20 -0500] jhackert: possible. Not the irc?
[2013-02-21 01:09:32 -0500] flaccid: jkeiser: whats teh irc
[2013-02-21 01:09:52 -0500] jhackert: thx & bye
[2013-02-21 01:10:01 -0500] flaccid: lol
[2013-02-21 01:11:32 -0500] zv470: Thanks flaccid I'll soldier on. :)
[2013-02-21 01:12:48 -0500] allaire: miah: WIN!
[2013-02-21 01:13:10 -0500] allaire: miah: had to add in to my run list too
[2013-02-21 01:13:17 -0500] allaire: and I had a typo
[2013-02-21 01:13:27 -0500] allaire: "recipe[build-essential::default]" use a dash
[2013-02-21 01:13:31 -0500] allaire:   "build_essential": {
[2013-02-21 01:13:31 -0500] allaire:     "compiletime": true
[2013-02-21 01:13:31 -0500] allaire:   },
[2013-02-21 01:13:36 -0500] allaire: use an underscore
[2013-02-21 01:13:37 -0500] allaire: duh
[2013-02-21 01:13:37 -0500] zv470: flaccid: I managed to get server 11 installed on a digitalocean droplet yesterday, 64bit server. Think I should just get an old 64bit box for home.
[2013-02-21 01:13:48 -0500] Loadx: qq regarding metadata dependancies.. I see the database cookbook requires mysql but I would prefer not to have to store the mysql cookbooks if possible. Without forking the database cookbook can I remove the dependancy or just bring in the libraries i'll use like provider_database_postgresql_user.rb?
[2013-02-21 01:14:42 -0500] allaire: Loadx: https://github.com/opscode-cookbooks/database/pull/28
[2013-02-21 01:15:14 -0500] allaire: Found that today
[2013-02-21 01:15:19 -0500] allaire: had the same question
[2013-02-21 01:15:39 -0500] Loadx: allaire: ta, checking it out now
[2013-02-21 01:17:00 -0500] Loadx: yeah my thoughts exactly
[2013-02-21 01:17:18 -0500] Loadx: and for the mean time there is no clear solution?
[2013-02-21 01:22:20 -0500] allaire: miah: Sorry to bug you again, but do you have an idea why I had to add it to my run_list, when it says in the usage only an include should do it: https://github.com/opscode-cookbooks/build-essential#usage
[2013-02-21 01:55:52 -0500] Loadx: allaire: I think i have a crazy idea. Create a wrapper cookbook add a bunch of providers and resources and just require 'databases/blah' . just thinking how i can get the requires to work though as obviously you cant upload cookbook to chef server without those dependancies.
[2013-02-21 01:56:14 -0500] allaire: personally I just deal with the unused packages :p
[2013-02-21 01:56:18 -0500] allaire: cookbooks*
[2013-02-21 01:56:34 -0500] Loadx: it is seeming thats 100% easier
[2013-02-21 01:56:42 -0500] Loadx: but seems wasteful
[2013-02-21 01:56:49 -0500] Loadx: confusing for other people also
[2013-02-21 01:57:21 -0500] allaire: Do you guys run aptitude upgrade somewhere in chef?
[2013-02-21 01:57:33 -0500] allaire: apt cookbook looks like is made to update, not upgrade
[2013-02-21 01:58:02 -0500] Loadx: allaire: Only after pining.
[2013-02-21 01:58:10 -0500] Loadx: otherwise it could be bad
[2013-02-21 01:58:18 -0500] allaire: pining?
[2013-02-21 01:58:30 -0500] Loadx: http://jaqque.sbih.org/kplug/apt-pinning.html
[2013-02-21 01:59:42 -0500] allaire: is there a cookbook for that%
[2013-02-21 01:59:43 -0500] Loadx: http://wiki.debian.org/AptPreferences - actually, much better info here.
[2013-02-21 01:59:57 -0500] Loadx: apt cookbook has pinning as a provider i think
[2013-02-21 02:01:04 -0500] Loadx: https://github.com/opscode-cookbooks/apt .. pin attribute
[2013-02-21 02:02:51 -0500] allaire: ok good
[2013-02-21 02:02:53 -0500] allaire: thx
[2013-02-21 02:03:03 -0500] allaire: but apt doesn't actually do the upgrade, correct?
[2013-02-21 02:03:15 -0500] allaire: apt cookbook *
[2013-02-21 02:03:24 -0500] allaire: it is only responsible for the update part
[2013-02-21 02:04:16 -0500] Loadx: yeah there is no recipe for upgrade.
[2013-02-21 02:04:26 -0500] Loadx: resource i should say
[2013-02-21 02:04:31 -0500] miah: the apt resource has the ability to version pin, and upgrade.
[2013-02-21 02:04:42 -0500] miah: or rather, the package resource does
[2013-02-21 02:04:57 -0500] Loadx: but package does..
[2013-02-21 02:05:02 -0500] Loadx: was about to say that
[2013-02-21 02:05:21 -0500] miah: but the apt/package resource is not the same as the apt cookbook
[2013-02-21 02:05:35 -0500] allaire: so what,s the point of the apt cookbook
[2013-02-21 02:05:47 -0500] miah: it adds a lwrp to add repositories
[2013-02-21 02:06:01 -0500] lazyPower-Work: plus it runs apt-get update on every run. <3 apt recipe
[2013-02-21 02:06:02 -0500] Loadx: exactly
[2013-02-21 02:06:13 -0500] lazyPower-Work: do my lazy work for me chef, why thank you
[2013-02-21 02:06:56 -0500] Loadx: Ive noticed it can be buggy when adding repos.. its supposed to apt get update straight after
[2013-02-21 02:06:56 -0500] allaire: but a simple execute block like this will do the same isn't? https://gist.github.com/allaire/5001365
[2013-02-21 02:07:04 -0500] mhalligan: any idea why chef would error out with cookbook "mhalligan has no directory files/default/plugin-configs"
[2013-02-21 02:07:06 -0500] mhalligan: when it surely does?
[2013-02-21 02:07:39 -0500] miah: mhalligan: can you show me the cookbook in question?
[2013-02-21 02:07:50 -0500] mhalligan: miah: it's just a recipe in my local cookbook
[2013-02-21 02:07:51 -0500] Loadx: bbs
[2013-02-21 02:07:55 -0500] miah: mhalligan: i know
[2013-02-21 02:08:00 -0500] miah: im me and share details
[2013-02-21 02:08:43 -0500] mhalligan: there's really nothing to show.
[2013-02-21 02:08:44 -0500] mhalligan: https://gist.github.com/anonymous/5001385
[2013-02-21 02:09:26 -0500] mhalligan: https://gist.github.com/anonymous/5001390 is output of find .
[2013-02-21 02:09:48 -0500] miah: ah
[2013-02-21 02:09:53 -0500] miah: remote_directory is the problem
[2013-02-21 02:10:04 -0500] miah: its not a remote directory because its in the cookbook
[2013-02-21 02:10:21 -0500] mhalligan: but those first 2 ones work
[2013-02-21 02:10:32 -0500] miah: ah i see. it can be used that way
[2013-02-21 02:11:45 -0500] mhalligan: oh. it's empty.
[2013-02-21 02:11:45 -0500] miah: no idea. i dont use that resource and i dont install plugins that way
[2013-02-21 02:11:52 -0500] miah: because you end up with unknown resources
[2013-02-21 02:12:05 -0500] miah: eg, chef doesn't create a file resource for each file it installs via remote_directory
[2013-02-21 02:12:15 -0500] mhalligan: right now I just want to get sensu working
[2013-02-21 02:12:19 -0500] mhalligan: I'll get shit less ugly later I guess
[2013-02-21 02:12:35 -0500] mhalligan: every step today has meant another hour of yak shaving
[2013-02-21 02:12:37 -0500] mhalligan: this is a yak even
[2013-02-21 02:12:57 -0500] mhalligan: fuck it. I'm going to go find some cute kittens to kill. really cute ones. maybe even pandas.
[2013-02-21 02:12:58 -0500] mhalligan: thanks!
[2013-02-21 02:21:46 -0500] allaire: miah: Saw what I wrote previously? Stupid typo of my part in my node file in the config
[2013-02-21 02:25:44 -0500] miah: doh
[2013-02-21 02:27:08 -0500] allaire: miah: I'm still struggling to understand why I had to add build-essential to my run list + adding the config, when my other cookbook was including the build-essential recipe and was setting it to true :O
[2013-02-21 02:27:55 -0500] jsegura: There is a way different than chef-rewind to change the templates of an included recipe?
[2013-02-21 02:47:52 -0500] trobrock: Trying to get test-kitchen 1.0 working on a brand new cookbook, but it seems that it cannot find the apt cookbook for the ubuntu vagrant image. Has anyone ran into this?
[2013-02-21 02:55:01 -0500] grobot: is this error (in stock apt recipe) something else - eg ruby misconfig? -- Expected process to exit with [0], but received ''
[2013-02-21 02:55:23 -0500] grobot: https://gist.github.com/xurizaemon/1283c0fdc2742501dad5
[2013-02-21 02:56:07 -0500] grobot: looks like it's happening in apt - same vagrant config runs OK on a nearby laptop, both OSX with same ruby -v
[2013-02-21 02:56:10 -0500] spheromak: grobot: look at the cmd its running
[2013-02-21 02:56:29 -0500] grobot: oh doh
[2013-02-21 02:56:33 -0500] spheromak: try and run that by hand in the vagrant box
[2013-02-21 02:56:39 -0500] spheromak: :)
[2013-02-21 02:56:51 -0500] grobot: apt-get-update don't look right  but why is one box even generating that as a command?
[2013-02-21 02:57:19 -0500] matschaffer: spheromak: that happens to me a lot
[2013-02-21 02:57:26 -0500] matschaffer: esp when I switch networks
[2013-02-21 02:57:56 -0500] spheromak: yea happens all the time
[2013-02-21 02:58:13 -0500] grobot: is apt-get-update a wrapper / alias of some form which should fire? (same cmd doesn't throw error on laptop)
[2013-02-21 02:58:36 -0500] grobot: strangely, it's the machine i've NOT taken in and out of the office which is misbehaving. perhaps it's jealous and wants to come out for coffee.
[2013-02-21 02:58:46 -0500] spheromak: grobot:  Ran apt-cache policy update-notifier-common returned
[2013-02-21 02:58:54 -0500] spheromak: ^^ what was run that didn't exit with status 0
[2013-02-21 02:59:14 -0500] spheromak: apt-get-update is a resource name in chef
[2013-02-21 02:59:46 -0500] spheromak: it would be more clear what was going on if the stdout/err for the command that was run had any output
[2013-02-21 02:59:50 -0500] grobot: output of apt-cache policy cmd is https://gist.github.com/xurizaemon/1283c0fdc2742501dad5/#comment-778549 (comment #1)
[2013-02-21 03:00:18 -0500] spheromak: and what does echo $?  report
[2013-02-21 03:00:22 -0500] spheromak: after you run it ?
[2013-02-21 03:00:28 -0500] grobot: 130
[2013-02-21 03:00:33 -0500] spheromak: thats not 0 :D
[2013-02-21 03:00:37 -0500] grobot: true
[2013-02-21 03:00:44 -0500] spheromak: might be a bug not sure whats the go there.
[2013-02-21 03:00:44 -0500] grobot: i have not met apt-cache policy before
[2013-02-21 03:01:52 -0500] grobot: ok, so same cmd on other box has 0, agreed
[2013-02-21 03:04:28 -0500] spheromak: grobot: cool least you know where the problem is :)
[2013-02-21 03:08:32 -0500] blackstar257: I can view clients when i do      knife client list
[2013-02-21 03:08:39 -0500] blackstar257: but when i try to do a search it says
[2013-02-21 03:08:44 -0500] blackstar257: server returened error for xxxxx
[2013-02-21 03:08:51 -0500] blackstar257: im running 11.4.0
[2013-02-21 03:09:14 -0500] blackstar257: i installed my server on ubuntu using the deb repo
[2013-02-21 03:09:23 -0500] blackstar257: and i installed the client on windows
[2013-02-21 03:09:36 -0500] blackstar257: it also fails when i try on my client on the ubuntu server
[2013-02-21 03:13:15 -0500] grobot: bah, i don't know what the problem was, and now it's gone
[2013-02-21 03:13:31 -0500] grobot: like glimpsing a beautiful fish in a river, and knowing you may never see it again
[2013-02-21 03:14:42 -0500] grobot: a decade of debian and i've basically just learned new ways to say dpkg -iGROEB
[2013-02-21 04:00:10 -0500] lazyPower-Work: exit
[2013-02-21 04:46:33 -0500] rchyla: hello, i have installed open source chef (11.06) on a virtual machine - could sb pls tell me from where chef reads config?
[2013-02-21 04:47:20 -0500] rchyla: it is now installed into /opt/chef and it works, but i need to change things and i can't find the right file
[2013-02-21 04:47:59 -0500] Loadx: what do you want to change?
[2013-02-21 04:48:12 -0500] rchyla: server name, url, port
[2013-02-21 04:49:57 -0500] Loadx: check /etc/chef
[2013-02-21 04:50:52 -0500] rchyla: i did - i even tried placing there /etc/chef/server.rb with examples found of web (but that was for 10.08)
[2013-02-21 04:51:26 -0500] rchyla: when i run chef-server-ctl reconfigure, it is loading defaults from somewhere - but not /etc/chef
[2013-02-21 04:51:33 -0500] rchyla: what am i missing?
[2013-02-21 04:52:00 -0500] Loadx: you read the comment right in server.rb?
[2013-02-21 04:52:10 -0500] Loadx: # the server listens on, modify /etc/default/chef-server.
[2013-02-21 04:52:54 -0500] jtimberman: rchyla: chef 11 server configuration is /etc/chef-server/chef-server.rb
[2013-02-21 04:53:24 -0500] rchyla: do you have exmples of the chef-server.rb?
[2013-02-21 04:53:26 -0500] jtimberman: rchyla: it's Ruby DSL config like /etc/chef/client.rb that gets translated to the attributes used for the chef-server-ctl reconfigure command.
[2013-02-21 04:53:49 -0500] rchyla: i am very new to ruby and it is much trial/error
[2013-02-21 04:54:00 -0500] jtimberman: all the attributes are in the embedded chef-server cookbook. https://github.com/opscode/omnibus-chef/blob/master/files/chef-server-cookbooks/chef-server/attributes/default.rb
[2013-02-21 04:54:03 -0500] rchyla: and i couldn't find st online
[2013-02-21 04:54:05 -0500] rchyla: thank you!
[2013-02-21 04:54:19 -0500] jtimberman: but if you're new
[2013-02-21 04:54:35 -0500] jtimberman: i recommend leaving the server alone and working with the nodes :)
[2013-02-21 04:54:42 -0500] jtimberman: write cookbooks and apply them to some test systems.
[2013-02-21 04:55:14 -0500] jtimberman: the server team is working on getting documentation for these and we'll have more information soon.
[2013-02-21 04:55:37 -0500] rchyla: all i wanted is to change server name - because when i do knife cookbook upload... it contacts server, then it tries to upload to localhost...and fails
[2013-02-21 04:56:01 -0500] Loadx: jtimberman: chef_gems are the first things execute in the run list right?
[2013-02-21 04:56:32 -0500] rchyla: debug shows it gets response from server, but i think server points it to 'localhost' and it fails
[2013-02-21 04:57:24 -0500] rchyla: i dont know how to check chef_gems being executed first (sorry, i am new to gems/ruby)
[2013-02-21 04:59:07 -0500] rchyla: so do i understand correctly i can create a new file /etc/chef-server/chef-server.rb and put inside *some* values and the rest will be read from default?
[2013-02-21 04:59:37 -0500] jtimberman: Loadx: the chef_gem resource installs the gem during chef's resource collection compilation phase.
[2013-02-21 05:00:17 -0500] Loadx: jtimberman: Thanks, i notice in the pgsql cookbook it will also cause an apt-get update
[2013-02-21 05:00:23 -0500] jtimberman: rchyla: does the server have a fqdn (hostname -f), and can it be resolved from the system you're running knife on?
[2013-02-21 05:00:34 -0500] rchyla: yes, it does
[2013-02-21 05:00:48 -0500] jtimberman: Loadx: yeah, because awkwardly people don't run apt-get update before running chef :)
[2013-02-21 05:00:56 -0500] jtimberman: so there's a recipe to do that
[2013-02-21 05:00:57 -0500] Loadx: jtimberman: What i was hoping to do is delay this because we use an apt caching server. I have a recipe that enabled it for the node but it triggers before my proxy recipe :(
[2013-02-21 05:01:25 -0500] Loadx: enables*
[2013-02-21 05:01:48 -0500] jtimberman: add the proxy to the bootstrapping process then?
[2013-02-21 05:01:56 -0500] Loadx: using vagrant.
[2013-02-21 05:02:03 -0500] Loadx: maybe i should stop using vagrant hah
[2013-02-21 05:02:20 -0500] Loadx: or atleast dont trigger the chef run from it
[2013-02-21 05:03:52 -0500] jtimberman: add a shell provisioner that is done before the chef one?
[2013-02-21 05:04:03 -0500] miah: hi
[2013-02-21 05:04:08 -0500] Loadx: oh snap.
[2013-02-21 05:04:10 -0500] jtimberman: handy enough i wrote words about this: http://jtimberman.housepub.org/blog/2012/08/10/vagrant-multiple-provisioners/
[2013-02-21 05:04:14 -0500] jtimberman: not the exact thing you're doing
[2013-02-21 05:04:24 -0500] Loadx: pi didnt even think of it
[2013-02-21 05:04:31 -0500] Loadx: but now that you mention it. that'll work perfectly
[2013-02-21 05:04:37 -0500] Loadx: Danke :)
[2013-02-21 05:05:00 -0500] jtimberman: :D
[2013-02-21 05:05:09 -0500] jtimberman: i mean, i get wanting everything possible related to configuration in chef.
[2013-02-21 05:05:47 -0500] Loadx: could trigger with chef_solo then chef_server if i want it to be all chefafied
[2013-02-21 05:05:59 -0500] jtimberman: :)
[2013-02-21 05:06:07 -0500] jtimberman: TITOWTDI
[2013-02-21 05:06:20 -0500] Loadx: always :)
[2013-02-21 05:06:55 -0500] Loadx: also i dont suppose there is a way without forking a cookbook to remove dependancies?
[2013-02-21 05:07:31 -0500] Loadx: the database cookbook seems to have many that dont make sense if you arent trying to do anythign with that particular database type.
[2013-02-21 05:07:37 -0500] rchyla: to change ports, can i just create /etc/chef-server/chef-server.rb  with: default['chef_server']['nginx']['ssl_port'] = 8443 default['chef_server']['nginx']['enable_non_ssl'] = false default['chef_server']['nginx']['non_ssl_port'] = 8080
[2013-02-21 05:07:53 -0500] rchyla: and run chef... reconfigure?
[2013-02-21 05:08:44 -0500] jtimberman: Loadx: nope, have to "fork" it.
[2013-02-21 05:08:50 -0500] Loadx: bugger
[2013-02-21 05:08:52 -0500] jtimberman: or, just let it be.
[2013-02-21 05:08:53 -0500] jtimberman: :)
[2013-02-21 05:09:00 -0500] Loadx: yeah thats also an option
[2013-02-21 05:09:10 -0500] jtimberman: http://tickets.opscode.com/browse/CHEF-3871 and http://tickets.opscode.com/browse/CHEF-3870
[2013-02-21 05:09:13 -0500] Loadx: considering im using env run_lists it might be clear enough
[2013-02-21 05:09:22 -0500] jtimberman: CHEF-3870 is most closely related
[2013-02-21 05:09:29 -0500] Loadx: we used to use solo before so it would of been confusing back then as we normally cut out any cookbook we didnt use
[2013-02-21 05:11:05 -0500] Loadx: Nice to see there a ticket
[2013-02-21 05:14:16 -0500] Loadx: jtimberman: Also you may not remember me tweeting about it ages ago but ive started an ember app to replace chef-web-ui  its going slowly but atm im doing all the crypto for auth in javascript hah
[2013-02-21 05:15:15 -0500] Loadx: jtimberman: Its actually not too bad speed wise. I have a bug in the signing atm so i'm going to switch the crypto lib to use http://polycrypt.net/
[2013-02-21 05:16:44 -0500] jtimberman: cool
[2013-02-21 05:17:12 -0500] Loadx: i should probably have a look at some other ui's for feature ideas
[2013-02-21 05:18:04 -0500] Loadx: i love the ideas in rundeck
[2013-02-21 05:18:32 -0500] Loadx: and some dependancy graphs would be interesting also
[2013-02-21 05:56:59 -0500] ryduh: hey there
[2013-02-21 07:16:50 -0500] GreatSUN: re
[2013-02-21 08:56:40 -0500] rohrer: So I've inherited a setup that has environments enabled, but cookbooks are not frozen or specified per environment. I'd like to lock all of the production environment nodes to the currently available cookbook version before testing some changes. Any suggestions on how to do so? I'm a bit cautious about using `knife upload -E production --freeze` as I'm not 100% sure the cookbooks on disk match the cookbooks on the server...
[2013-02-21 09:08:33 -0500] spheromak: rohrer: there was a post on various tools for validating local vs server. knife diff in the knife-utils package (included in chef11) can get you there. you can also simply pull all the server cooks latest versions local then re-upload those with frozen versions. can use some knife-exec foo to get that done.
[2013-02-21 09:08:58 -0500] spheromak: sorry post on the maillist recently
[2013-02-21 09:56:15 -0500] giorgian: hi. I need to create an RPM of chef (client) with a different install path and binary name. Can I do that using omnibus-chef?
[2013-02-21 10:20:47 -0500] halcyonCorsair: is there a 'requirements' page for chef 11?
[2013-02-21 10:20:53 -0500] halcyonCorsair: eg. ram, etc?
[2013-02-21 10:43:56 -0500] rohrer: spheromak: thanks
[2013-02-21 10:46:00 -0500] fooJBar: Trying to install chef 11 using the .deb I get an error during bootstrap that's hard to decrypt. STDOUT: error creating client <<"chef-validator">>: {badrpc, ... Any clues where to look next?
[2013-02-21 10:54:25 -0500] fooJBar: Nevermind was a port conflict combined with http_proxy that caused the recipe to think erchef was up.
[2013-02-21 11:12:34 -0500] jmara: hmm ... thats weird knife under rvm ruby-1.9.3 stopped working the ssh
[2013-02-21 11:12:48 -0500] jmara: s/the/with/
[2013-02-21 11:13:20 -0500] jmara: anyone seen this error before? WARNING: Failed to connect to  -- ArgumentError: Could not parse PKey: no start line
[2013-02-21 12:07:20 -0500] liku: Hello all. I have a node and need to bootstrap chef-client there. For connection I use user1 with key-based auth but problem is in that that I have a password for sudo execution. The question is how can I set in bootstrap command key for connection to the node and password for using sudo? Thank you in advance!
[2013-02-21 12:07:20 -0500] liku: using both -i and -P options gives:
[2013-02-21 12:07:21 -0500] liku: bash: /dev/fd/63: No such file or directory
[2013-02-21 12:07:22 -0500] liku: --2013-02-21 11:50:06--  http://opscode.com/chef/install.sh
[2013-02-21 12:07:24 -0500] liku: Resolving opscode.com...
[2013-02-21 12:07:26 -0500] liku: bash: line 74: chef-client: command not found
[2013-02-21 12:17:14 -0500] zuazo: /win 3
[2013-02-21 12:17:24 -0500] zuazo: ups, sorry :)
[2013-02-21 12:43:40 -0500] halcyonCorsair: how do I reconfigure the chef11 server url?
[2013-02-21 13:10:47 -0500] daxroc: Hey all
[2013-02-21 13:12:38 -0500] daxroc: Do service blocks require an init.d script ?
[2013-02-21 13:14:01 -0500] daxroc: I've to work with several third party app scripts that aren't standard init.d scripts, what would the best approach to integrating them with chef for notifies and subscribes ?
[2013-02-21 13:26:27 -0500] cheezo_: hello, i am looking to make several REST API calls from a recipe. All the parameters for those calls will be set in the URL itself eg. url?action=blah&startdate=blah etc. iiic, the http_request cannot help here?
[2013-02-21 13:27:27 -0500] cheezo_: because it uses message as a default paramet
[2013-02-21 13:44:26 -0500] Philipp_: any ideas how to fix OHAI-392?
[2013-02-21 13:48:41 -0500] justsee: ruby: deploy
[2013-02-21 13:51:12 -0500] wassy121: daxroc: http://wiki.opscode.com/display/chef/Resources#Resources-Service , check out the section on giving the provider for the service you are setting up
[2013-02-21 13:51:33 -0500] wassy121: daxroc: you may need to define your own provider in this case
[2013-02-21 14:11:14 -0500] Azrael808: Hey, I just ran an upgrade on a chef server instance (0.10.0 -> 10.20.0) and I now nodes and clients can't authenticate... I have a stack trace from running the chef-server command in a shell: https://gist.github.com/Azrael808/a0249f8d9e9ee028e1b5
[2013-02-21 14:12:30 -0500] Azrael808: I'm not an expert, but it seems as though that top error (unknown method public_key) is either caused by a missing gem/library, or the user object was simply not found (or the public_key attribute isn't picked up).
[2013-02-21 14:14:07 -0500] zts: Azrael808: upgrade to 10.22.0
[2013-02-21 14:14:34 -0500] zts: Azrael808: http://www.opscode.com/blog/2013/02/13/chef-client-11-4-0-10-22-0-released/
[2013-02-21 14:14:52 -0500] Azrael808: oh wow... I'll give that a go quickly
[2013-02-21 14:14:55 -0500] Azrael808: Thx
[2013-02-21 14:14:57 -0500] Azrael808: brbr
[2013-02-21 14:14:59 -0500] Azrael808: *brb
[2013-02-21 14:29:08 -0500] yfeldblum: upgrade to 10.24.0
[2013-02-21 14:29:26 -0500] yfeldblum: and run `gem outdated` to find what gems are outdated
[2013-02-21 14:30:19 -0500] GreatSUN: re
[2013-02-21 14:31:16 -0500] GreatSUN: is it possible to set a requirement for a recipe to run without calling it?
[2013-02-21 14:31:36 -0500] yfeldblum: GreatSUN, huh?
[2013-02-21 14:32:21 -0500] GreatSUN: means if someone should add a recipe to a runlist or a wrapper cookbook and I want to stop my recipe running if not done
[2013-02-21 14:32:58 -0500] GreatSUN: is that possible?
[2013-02-21 14:35:15 -0500] g2andi: Hi. I just installed chef on a naked debian wheezy. chef-client 10.18.2 fails with FATAL: NoMethodError: undefined method `run_list' for nil:NilClass On another machine chef-client 10.16.2-1 works as expected. Is this a known problem?
[2013-02-21 14:35:40 -0500] Azrael808: zts: that upgrade worked perfectly, thank you so much for pointing out an obvious upgrade! :D
[2013-02-21 14:36:00 -0500] Azrael808: seriously tho, thx, I had been beating my head off that for hours - was that a known issue with 10.20.0?
[2013-02-21 14:36:54 -0500] yfeldblum: Azrael808, yes, users should upgrade to chef-server 10.24.0 and friends because of a series of changes that were necessary to deal with problems in other libraries
[2013-02-21 14:39:01 -0500] Azrael808: OK... I'll look to go through that upgrade a bit later - have some other fires to put out first! Thanks again for the help peeps. :)
[2013-02-21 14:39:06 -0500] jhayden: a question about yum_package resource:
[2013-02-21 14:39:17 -0500] jhayden: upgrade action says this :   Upgrade a package to the latest available version
[2013-02-21 14:39:39 -0500] jhayden: the version attribute says this:  The version of the package to install/upgrade/remove. Must be a complete version-release
[2013-02-21 14:39:49 -0500] jmara: Anyone seen this error with "knife ssh"? WARNING: Failed to connect to  -- ArgumentError: Could not parse PKey: no start line
[2013-02-21 14:40:14 -0500] jhayden: it seems to me that version SHOULD constrain upgrade but it doesn't appear to be happening
[2013-02-21 14:40:41 -0500] jhayden: am I mistaken and should only use install?
[2013-02-21 14:42:24 -0500] GreatSUN: yfeldblum: could node.search(:node, 'recipes:apache::default') do the job?
[2013-02-21 14:48:33 -0500] gkarekinian: Does anyone know if Chef 11 does weird things to the Hash class? I'm turning attributes into a hash then deleting some keys and I'm getting an exception in the node/immutable_collections.rb file
[2013-02-21 14:48:36 -0500] gkarekinian: (Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"')
[2013-02-21 14:48:55 -0500] gkarekinian: I've made sure it has the Hash class, this is insane
[2013-02-21 14:51:08 -0500] gkarekinian: I'm making the old riak cookbook Chef 11 compatible, and it's deleting keys all over the place and turning the attributes into Erlang to create the config
[2013-02-21 14:51:28 -0500] yfeldblum: GreatSUN, i don't understand what you're trying to do
[2013-02-21 14:51:50 -0500] yfeldblum: GreatSUN, that search won't work because it's not valid Lucene syntax
[2013-02-21 14:52:05 -0500] yfeldblum: GreatSUN, i don't like searching for nodes by recipe name
[2013-02-21 14:56:37 -0500] jmara: had to downgrade to chef 10 :-/ on my workstation
[2013-02-21 15:03:10 -0500] GreatSUN: yfeldblum: I think, I got it now: node.recipe_list.include?('apache::default')
[2013-02-21 15:07:46 -0500] kbennett: Can someone please explain to me what the chef gem does and does not install?  Is it just management software but not the chef client?
[2013-02-21 15:12:24 -0500] gkarekinian: Answering my own question from above: turns out I've only turned the container into a Hash. All the nested stuff inside is still a Chef::Node::ImmutableMash
[2013-02-21 15:13:08 -0500] fooJBar: Anyone knows if Chef reporting is supposed to work? Had clients crash against a brand new Chef 11 server until i added enable_reporting false to all client.rb...
[2013-02-21 15:13:22 -0500] yfeldblum: kbennett, the `chef` gem includes the chef-client program
[2013-02-21 15:14:19 -0500] yfeldblum: kbennett, chef-client is the program that sets up servers based on configuration data and "cookbook" code stored in a chef-server database on another server
[2013-02-21 15:14:45 -0500] yfeldblum: kbennett, chef-solo, which is also included in the `chef` gem, sets up servers based on configuration data and "cookbook" code that is stored locally on the same server
[2013-02-21 15:16:23 -0500] yfeldblum: kbennett, the `chef` gem also includes the `knife` program, which is used by sysadmins on their own workstations (not on servers) as a CLI for the chef-server (storing configuration data and cookbooks in the chef-server) and to set up bare servers with chef-client and start the first chef-client run (this is done with knife from the sysadmin's workstation)
[2013-02-21 15:24:44 -0500] jmara: hmm anyone running the chef-11.4.0 gem under mac osx and ruby 1.9.3?
[2013-02-21 15:25:21 -0500] jmara: I think its a problem with net-ssh-2.6.x but I can't figure it out :-/
[2013-02-21 15:46:53 -0500] joel: http://pastebin.com/0ZfjB9xu - Anyone have thoughts on what I'm missing here?
[2013-02-21 15:48:03 -0500] cwj: joel: do you have recipe[mysql::ruby] in your run list anywhere? looks like you dont have the mysql gem in chef's path
[2013-02-21 15:49:07 -0500] joel: cwj no. does that come with the mysql recipe, and I just need to add it to the run list, or do I need to download a recipe for it too?
[2013-02-21 15:49:35 -0500] cwj: that recipe has been part of the opscode mysql cookbook for some time now
[2013-02-21 15:49:38 -0500] kbennett: yfeldblum: Thanks very much, that's good information for me.  So if I want to use chef-solo, all the software is installed by the chef gem and I only need to provide config and recipes?
[2013-02-21 15:49:41 -0500] joel: cwj ok, cool, thanks man.
[2013-02-21 15:50:14 -0500] yfeldblum: kbennett, yes
[2013-02-21 15:50:39 -0500] cwj: joel: if you are writing your own cookbook that uses the mysql/database lwrps, you probably want to "include_recipe "mysql::ruby" so you can be sure it is run without having to remember to have it in the run list
[2013-02-21 15:53:10 -0500] jarosser06: is anyone using the chef 11 server
[2013-02-21 15:55:40 -0500] joel: cwj hrm good idea, thanks!
[2013-02-21 16:02:45 -0500] fooJBar: I am jarosser06
[2013-02-21 16:03:30 -0500] jarosser06: fooJBar have you had any issues with creating environments using knife from a seperate workstation?
[2013-02-21 16:04:08 -0500] fooJBar: jarosser06: I'm only using the _default environment right now, let me give it a try
[2013-02-21 16:04:32 -0500] jarosser06: fooJBar: kk thanks
[2013-02-21 16:05:08 -0500] fooJBar: jarosser06: worked here, knife environment create foo, Created foo
[2013-02-21 16:05:28 -0500] jarosser06: fooJBar: and you can confirm that it is on your server?
[2013-02-21 16:05:49 -0500] fooJBar: Yes the Chef server is a different machine
[2013-02-21 16:06:14 -0500] fooJBar: jarosser06: did you set the listen IP to 0.0.0.0 for erchef?
[2013-02-21 16:06:35 -0500] fooJBar: jarosser06: the default is to only listen on localhost
[2013-02-21 16:08:57 -0500] joel: does chef have a resource for changing ownerships of files?
[2013-02-21 16:09:16 -0500] jarosser06: fooJBar: I didn't till you mentioned it but that didn't seem to work
[2013-02-21 16:10:37 -0500] jarosser06: fooJBar: the log shows a Get request which then just complains about the fact that the environment does not exist
[2013-02-21 16:10:54 -0500] zts: joel: you can use the File resource for that
[2013-02-21 16:16:24 -0500] joel: zts thanks
[2013-02-21 16:22:33 -0500] AikiLinux: Hello, has anyone used the new omnibus rpm to install chef server ?
[2013-02-21 16:28:04 -0500] jarosser06: fooJBar: is there anything else that you can think of that should be changed ?
[2013-02-21 16:32:32 -0500] aruntomar: AikiLinux: yes
[2013-02-21 16:32:33 -0500] dotslash: If I've created my own provider, how to I include it? include_recipe, doesn't seem to do it.
[2013-02-21 16:33:15 -0500] jtimberman: dotslash: make a dependency on the cookbook that has the provider, and the client will download the cookbook, and make it available to be used in recipes
[2013-02-21 16:33:49 -0500] jtimberman: dotslash: so e.g., if you wanted to use foo cookbook's foo_thing resource in bar, then bar's metadata should have depends "foo"
[2013-02-21 16:33:58 -0500] dotslash: So just: include_recipe "my_provider_cookbook"
[2013-02-21 16:34:11 -0500] jtimberman: No.
[2013-02-21 16:34:16 -0500] dotslash: Oh in the metadata. That may be what I was missing.
[2013-02-21 16:34:19 -0500] jtimberman: :)
[2013-02-21 16:34:25 -0500] dotslash: Thank you!
[2013-02-21 16:34:56 -0500] dotslash: Are there any special naming issues? I tried creating a provider called nexus_file and it gives me a 404 when I upload it to the chef server. It works if I call it something else.
[2013-02-21 16:38:20 -0500] spheromak: there any way to get more debug info outta erchef? getting server spinning cpu, and timingout requests  on some cookbooks when its trying to resolve deps.
[2013-02-21 16:38:54 -0500] AikiLinux: aruntomar, were you able to connect a work station to it - I attempted an install but the knife configuration was unsuccessful
[2013-02-21 16:41:07 -0500] aruntomar: AikiLinux: yes, i can
[2013-02-21 16:41:47 -0500] aruntomar: AikiLinux: i wrote a blog regarding the same http://www.linuxguy.in/how-to-configure-chef-workstation-with-chef-server-11/
[2013-02-21 16:46:05 -0500] AikiLinux: aruntomar, on what distro did you install your chef-server ?
[2013-02-21 16:46:16 -0500] aruntomar: AikiLinux: centos
[2013-02-21 16:46:43 -0500] aruntomar: AikiLinux: there's a blog about that also on the same site
[2013-02-21 16:51:50 -0500] tesmar: hi all, it seems to me that with chef you can specify server layouts in roles .rb files or in nodes .json files. Is it just a preference thing?
[2013-02-21 16:52:38 -0500] AikiLinux: odd , i am installing it on Centos 6 and it does not create the /etc/chef-server directory
[2013-02-21 16:52:58 -0500] matti: AikiLinux: Omnibus?
[2013-02-21 16:53:03 -0500] AikiLinux: also the knife tool fails to connect
[2013-02-21 16:53:17 -0500] matti: AikiLinux: If so, then before first run you need to mkdir -p /etc/chef-server
[2013-02-21 16:53:37 -0500] matti: AikiLinux: And for Knife, the URL is https://
[2013-02-21 16:53:46 -0500] matti: AikiLinux: No need for port 4000 with Chef 11.
[2013-02-21 16:53:56 -0500] AikiLinux: yes
[2013-02-21 16:54:58 -0500] AikiLinux: matti, first run of knife or the rpm ?
[2013-02-21 16:56:43 -0500] tesmar: AikiLinux: it seems to me that with chef you can specify server layouts in roles .rb files or in nodes .json files. Is it just a preference thing?
[2013-02-21 16:57:32 -0500] wdpro_kevin1: Thanks Steven in Opscode Support for un-borking my hosted account.
[2013-02-21 17:05:44 -0500] jarosser06: after the initial chef 11 server install b/c I can't get my knife commands to create environments to work correctly
[2013-02-21 17:05:49 -0500] matti: AikiLinux: ?
[2013-02-21 17:06:16 -0500] matti: tesmar: Some people prefer Ruby DSL for Roles.
[2013-02-21 17:06:22 -0500] matti: tesmar: Its simpler and cleaner.
[2013-02-21 17:06:48 -0500] matti: jarosser06: URL is https://?
[2013-02-21 17:06:56 -0500] matti: jarosser06: And no port 4000?
[2013-02-21 17:07:05 -0500] matti: jarosser06: Certificates OK?
[2013-02-21 17:08:04 -0500] jarosser06: matti: didn't realize it needed to be https
[2013-02-21 17:08:13 -0500] jarosser06: matti: that did the trick thanks
[2013-02-21 17:10:49 -0500] AikiLinux: matti,  you said "first run" you mean that the run of knife or the server crl ?
[2013-02-21 17:12:57 -0500] matti: AikiLinux: If you want to apply some custom settings to Chef 11 installed via Omnibus, then you need to manually create this directory.
[2013-02-21 17:13:43 -0500] matti: AikiLinux: As chef-server-ctl reconfiure will create it - but if you want custom settings then you need to create it first yourself and put chef-server.rb there with overrides.
[2013-02-21 17:14:01 -0500] matti: AikiLinux: Unless you are after something completely different - my assumption might be wrong.
[2013-02-21 17:14:35 -0500] AikiLinux: no, i want to install it "as-is" and then connect  a work station to it - and that it is where i am having the problem
[2013-02-21 17:15:15 -0500] AikiLinux: cause when i try to use the knife to configure a pem file it is trying to look up a file that does not exist
[2013-02-21 17:16:25 -0500] matti: AikiLinux: Right.
[2013-02-21 17:16:36 -0500] matti: AikiLinux: Read this http://jtimberman.housepub.org/blog/2013/02/10/install-chef-11-server-on-centos-6/
[2013-02-21 17:16:42 -0500] awgross: anyone have some pointers on how I can include a mixin in a chef recipe?  The mixin would modify the behavior of code inside the chef gem itself.
[2013-02-21 17:16:57 -0500] joel: I'm having an issue where the owner is root on the rails logging directory even though I have a call do the directory resource with recursive owner set, thoughts on wtf?
[2013-02-21 17:17:30 -0500] awgross: Would it be better to place it in a library file and send it in?
[2013-02-21 17:18:56 -0500] AikiLinux: Thanks matti this explain much as my clients are Ver 10.4
[2013-02-21 17:19:24 -0500] AikiLinux: I was wondering if the old clients are compatible with the new Ver 11 servers
[2013-02-21 17:19:37 -0500] AikiLinux: that article indicates that they are not.
[2013-02-21 17:20:00 -0500] AikiLinux: now i need to see if Ver 11 clients will be compatible with Ver 10 servers
[2013-02-21 17:32:35 -0500] pehlert: default attributes defined on a node take precedence over default attributes from a recipe, right?
[2013-02-21 17:34:44 -0500] fooJBar: Thanks matti for the pointer to jtimberman's blog :D
[2013-02-21 17:36:54 -0500] fooJBar: Yes pehlert, see http://docs.opscode.com/essentials_node_object_attributes_precedence.html
[2013-02-21 17:37:49 -0500] pehlert: fooJBar: I just realized that there are no default attributes on nodes (which makes sense ;-))
[2013-02-21 17:37:58 -0500] pehlert: That was my problem. I put it in the defaults namespace
[2013-02-21 17:38:00 -0500] pehlert: But thanks
[2013-02-21 17:38:03 -0500] fooJBar: Indeed pehlert, only normal persist
[2013-02-21 17:38:38 -0500] siris: quick question: what would be the best way to search for nodes on a Chef Server that have empty run lists?
[2013-02-21 17:39:31 -0500] jtimberman: AikiLinux: they *should* be.
[2013-02-21 17:40:15 -0500] matti: Ohai jtimberman
[2013-02-21 17:40:40 -0500] matti: AikiLinux: I had some old 10.x clients and they work fine.
[2013-02-21 17:40:55 -0500] fooJBar: AikiLinux, I am using 10.22 against a Chef 11 server without problems.
[2013-02-21 17:42:07 -0500] fooJBar: siris: http://wiki.opscode.com/display/chef/Search#Search-SearchforNodesBasedonRunListEntries
[2013-02-21 17:51:45 -0500] fooJBar: siris: I couldn't make knife search for empty run_list directly, but using this command on mix worked: knife search -r node name:* | grep -B1 "\[\]"
[2013-02-21 17:53:18 -0500] siris: fooJBar: thanks, I will give it a test run
[2013-02-21 17:56:26 -0500] shanlar: when creating an ec2 server with knife, is there a way to pass an attribute on the fly to be used in the templates?
[2013-02-21 17:56:55 -0500] shanlar: ie, i want to pass in a username that will be used as the replacement in all of the templates
[2013-02-21 18:00:53 -0500] tjordahl: Hello, updated my Workstation (on Windows) to chef 11.4.0 and a knife boostrap windows command that used to work now fails wth the error "WARNING: Failed to connect to toms-test -- ArgumentError: Could not parse PKey:no start line"
[2013-02-21 18:02:19 -0500] tjordahl: jmara also posted about this error earlier today on this channel
[2013-02-21 18:03:44 -0500] tjordahl: using username/password Auth against a freeSSHd server (on Windows)
[2013-02-21 18:06:01 -0500] tjordahl: is this a know or new issue?  workaround is to revert back to version 10.x client?
[2013-02-21 18:15:05 -0500] shanlar: is it possible to use ec2 tags in chef templates?
[2013-02-21 18:18:53 -0500] tjordahl: Backing off to chef-client version 10.24.0-1 did not fix my problem, so I have assume user error.
[2013-02-21 18:20:04 -0500] epta: How can I search node by it's name?
[2013-02-21 18:21:08 -0500] stormerider: ohai chefs
[2013-02-21 18:21:58 -0500] stormerider: i'm a little confused... looking for the recipe to auto-compact couchdb on the chef server. as far as i can tell, it's not in chef-server::default anymore, even though the docs claim it is.
[2013-02-21 18:28:31 -0500] stormerider: i see the old chef::server recipe had them, but not the chef-server::default.
[2013-02-21 18:31:49 -0500] stormerider: aha, i needed to switch to the chef10 branch, my bad.
[2013-02-21 19:01:42 -0500] aneto: is it possible to list ec2 tags on server in a recipe or even view them?
[2013-02-21 19:03:17 -0500] cwj: aneto: you can use a ruby gem like fog or rightaws to retrieve tags
[2013-02-21 19:05:39 -0500] cwj: maybe easier still, include the 'aws' cookbook and you can access Opscode::Aws::Ec2 module
[2013-02-21 19:05:42 -0500] cwj: https://github.com/opscode-cookbooks/aws/blob/master/libraries/ec2.rb
[2013-02-21 19:10:57 -0500] MrBIOS: hi folks, if I want to enforce a single-line change against /etc/anacrontab, (I want to change START_HOURS_RANGE=3-22 to START_HOURS_RANGE=16-18) what do you suggest might be the best way of doing so?
[2013-02-21 19:11:45 -0500] doomviking: maybe the "line" cookbook will be your friend
[2013-02-21 19:14:14 -0500] r3vamp: I'm trying to install chef server 11 on centos 6.3 using the RPM provided on the install page. However I'm encountering a rabbitmq problem when executing the command "sudo chef-server-ctl reconfigure"
[2013-02-21 19:14:46 -0500] MrBIOS: doomviking: Thanks, I can't find that cookbook, where should I be searching for it?
[2013-02-21 19:15:05 -0500] MrBIOS: I looked at https://github.com/opscode-cookbooks/
[2013-02-21 19:15:50 -0500] doomviking: http://community.opscode.com/cookbooks/line
[2013-02-21 19:17:23 -0500] doomviking: the README is a little easier to read from the repo itself
[2013-02-21 19:17:38 -0500] doomviking: s/repo/file
[2013-02-21 19:20:22 -0500] MrBIOS: Thanks
[2013-02-21 19:23:27 -0500] doomviking: np
[2013-02-21 19:40:11 -0500] tomdzk: so I just brought up a brand new chef server (10.24.0) using the chef-solo method and the web ui is not starting
[2013-02-21 19:40:21 -0500] tomdzk: getting 'Cannot load user admin' in the chef server log
[2013-02-21 19:41:12 -0500] tomdzk: that seems odd given this is a brand new chef server
[2013-02-21 19:42:19 -0500] yfeldblum: how can i debug "NRPE: Command 'check_nagios' not defined"?
[2013-02-21 19:42:49 -0500] shanlar: it means on the remote server, in the nrpe.conf file there is no command check_nagios
[2013-02-21 19:43:19 -0500] MrBIOS: doomviking: thanks, that worked, mostly, however the replace didn't work quite as I expected
[2013-02-21 19:43:36 -0500] yfeldblum: shanlar, this is on the nagios server itself
[2013-02-21 19:44:08 -0500] shanlar: there is a commands.conf file
[2013-02-21 19:44:13 -0500] shanlar: where check_nagios should be defined
[2013-02-21 19:44:20 -0500] yfeldblum: shanlar, and both /usr/lib/nagios/plugins/check_nagios and /etc/nagios/nrpe.d/check_nagios.cfg are in place
[2013-02-21 19:44:33 -0500] shanlar: still need to check commands.conf
[2013-02-21 19:45:03 -0500] doomviking: MrBIOS: I havent used the cookbook, so YMMV. but glad it mostly worked
[2013-02-21 19:45:05 -0500] shanlar: commands.cfg*
[2013-02-21 19:45:10 -0500] otterley: can anyone confirm whether the Chef 11 Server supports the Partial Search API?
[2013-02-21 19:45:36 -0500] otterley: the documentation is ... unclear
[2013-02-21 19:45:50 -0500] mattray: otterley: yes
[2013-02-21 19:46:25 -0500] otterley: @mattray, I assume the cookbook is needed to use it?
[2013-02-21 19:46:53 -0500] mattray: no, that was for Hosted Chef usage
[2013-02-21 19:47:00 -0500] mattray: with the Chef 10 client
[2013-02-21 19:47:14 -0500] mattray: Chef 11 client with Chef 11 server shouldn't need it
[2013-02-21 19:47:34 -0500] otterley: how do you use it with Chef 11?  just call partial_search?
[2013-02-21 19:47:46 -0500] otterley: i.e. http://www.opscode.com/blog/2012/10/31/introducing-partial-search-for-opscode-hosted-chef/
[2013-02-21 19:48:07 -0500] kallistec: I think you still need the cookbook for chef 11 client
[2013-02-21 19:48:34 -0500] yfeldblum: shanlar, it seems like it's there (https://github.com/opscode-cookbooks/nagios/blob/3.1.0/templates/default/commands.cfg.erb#L17-L20) barring the substitution of - for _
[2013-02-21 19:48:36 -0500] MrBIOS: doomviking: just had to get my regex right
[2013-02-21 19:50:18 -0500] doomviking: you know what they say about regex
[2013-02-21 19:50:47 -0500] yfeldblum: shanlar, the odd thing is: i've got two servers with that nagios::server recipe, but this is happening only on one
[2013-02-21 19:50:57 -0500] mattray: kallistec: is that something that's supposed to be eventually included in the 11 client?
[2013-02-21 19:51:29 -0500] kallistec: mattray: I don't think there's a reson not to, but I don't know that anyone is actively working on it
[2013-02-21 19:51:39 -0500] danryan: Ohai Chefs! I'm trying out v11 on some servers, and I keep encountering a strange "403 forbidden" error when creating files from templates: https://gist.github.com/danryan/027a28664f01cee3e372
[2013-02-21 19:53:36 -0500] otterley: danryan, smells like a file or directory permissions issue on your server
[2013-02-21 19:53:48 -0500] davidmz: Hello, I have used sudo chef-server-ctl reconfigure method to isntall chef on ubuntu 12.04 but knife command does't work and chef-server command also doesn't work, what did I do wrong?
[2013-02-21 19:53:56 -0500] yfeldblum: shanlar, any idea how i could pursue debugging this?
[2013-02-21 19:53:57 -0500] ranman: Hi
[2013-02-21 19:54:19 -0500] danryan: otterley: weird that it would throw an HTTP error. Plus, I'm running this as the root user to rule out perms issues.
[2013-02-21 19:54:41 -0500] ranman: Any ideas why I'm getting this error when I am running a bootstrap command? with boostrap version 10.10
[2013-02-21 19:54:41 -0500] ranman: bash: line 81: chef-client: command not found
[2013-02-21 19:54:44 -0500] otterley: danryan, are you running an nginx proxy in front of erchef?
[2013-02-21 19:54:59 -0500] ranman: platform: ubuntu 12.04
[2013-02-21 19:55:22 -0500] otterley: ranman, chef-client isn't in the PATH of the user you're sshing into the host as
[2013-02-21 19:55:38 -0500] danryan: otterley: indeed I am. It's just the default  omnibus install.
[2013-02-21 19:55:39 -0500] ranman: otterley:  yes because it's being bootstrapped.
[2013-02-21 19:56:06 -0500] otterley: ranman, do you have a systemwide rvm install on the host you're bootstrapping?
[2013-02-21 19:56:22 -0500] otterley: danryan, did you check the nginx error logs?
[2013-02-21 19:56:23 -0500] ranman: otterly it's being bootstrapped as in this is a blank machine
[2013-02-21 19:56:37 -0500] otterley: ranman, best if you provide gist output
[2013-02-21 19:58:02 -0500] mathewpeterson: I am having some issues with chef-solr. It seems that it will not retain any data. When I search for any nodes (e.g. knife search node "*:*") it returns 0 items. I've ran "knife index rebuild" and every thing returns success.  I've been using chef for about 2 full months not with out issue until now. Any suggestions on how I can troubleshoot this problem?
[2013-02-21 19:58:56 -0500] otterley: ranman, I think the issue is the --bootstrap-version=0.10.10 argument
[2013-02-21 19:59:36 -0500] ranman: otterley: I don't want to use the new version since a lot of backwards compatibility has been broken.
[2013-02-21 19:59:45 -0500] otterley: try --bootstrap-version=10.20.0
[2013-02-21 19:59:57 -0500] danryan: otterley: yep, and I see 403s in the logs but I'm not sure why
[2013-02-21 20:00:11 -0500] otterley: danryan, anything in the error log?
[2013-02-21 20:00:24 -0500] otterley: it could be emanating from erchef, in which case i'd check its logs.
[2013-02-21 20:00:46 -0500] ranman: otterley: that works thanks
[2013-02-21 20:00:54 -0500] otterley: chef-server in Chef 10 was a real pain to debug when this happens, as its error reporting was ... weak
[2013-02-21 20:03:55 -0500] davidmz: Hello, I have used sudo chef-server-ctl reconfigure method to install chef on Ubuntu 12.04 but knife command does't work and chef-server command also doesn't work, what did I do wrong?
[2013-02-21 20:04:06 -0500] yfeldblum: shanlar, restarting that nagios server apparently did the trick (after repeatedly removing and reinstalling every nagios-related package and rerunning chef)
[2013-02-21 20:04:06 -0500] danryan: otterley: no errors in erchef logs
[2013-02-21 20:04:20 -0500] otterley: speaking of the Omnibus Chef 11 installation, how the heck do you customize it?  chef-server-ctl reconfigure appears to run chef-local on the server, which generates lots of nice things like the solrconfig.xml file, but I have no idea how to increase the document size in said file
[2013-02-21 20:04:29 -0500] danryan: otterley: what's weirder is that the template was still created.
[2013-02-21 20:04:32 -0500] danryan: *shrug8
[2013-02-21 20:05:53 -0500] CharlieSu: Hi everyone.  Is anyone aware of an API call or tool that allows you to calculate total cost of a given instance by passing an instance ID?  (ec2)
[2013-02-21 20:06:07 -0500] otterley: danryan, interesting HTTP call there.  that must be a new Chef 11 thing?
[2013-02-21 20:06:31 -0500] mattupstate: anyone try out the latest nagios cookbook? there seems to be a template error
[2013-02-21 20:06:37 -0500] otterley: there's an AWSAccessKeyID in it
[2013-02-21 20:06:49 -0500] danryan: otterley: Aye, I can't duplicate it in v10. To further complicate things, a second run finishes successfully.
[2013-02-21 20:07:07 -0500] danryan: otterley: yeah, it's their s3-compatible bookshelf service.
[2013-02-21 20:07:40 -0500] otterley: danryan, I'm not familiar with it.  perhaps it's an S3 issue, maybe nginx is backposting to them?
[2013-02-21 20:08:03 -0500] otterley: puzzling
[2013-02-21 20:08:07 -0500] danryan: otterley: bookshelf is local to the chef server. I'm not sending anything to s3
[2013-02-21 20:08:33 -0500] danryan: I'm leaning toward it being a timing issue.
[2013-02-21 20:08:34 -0500] otterley: I'm afraid I'm out of ideas - I'm just getting started with Chef 11 myself.
[2013-02-21 20:09:13 -0500] tomdzk: ah, found my chef-server installation problem, CHEF-3898
[2013-02-21 20:09:15 -0500] otterley: I'm trying not to rush into it until there's better documentation
[2013-02-21 20:09:29 -0500] yfeldblum: otterley, you configure your chef-server by editing /etc/chef-server/chef-server.rb, and then running `chef-server-ctl reconfigure`
[2013-02-21 20:09:51 -0500] yfeldblum: otterley, the tunable attributes are listed here: https://github.com/opscode/omnibus-chef/blob/master/files/chef-server-cookbooks/chef-server/attributes/default.rb
[2013-02-21 20:10:01 -0500] danryan: CharlieSu: hey! This is not quite the right channel for your question but I'll answer anyway. There's no AWS API for billing. The closest you can get is this: http://docs.aws.amazon.com/awsaccountbilling/latest/about/programaccess.html
[2013-02-21 20:10:07 -0500] otterley: yfeldblum, an omnibus installation didn't create that file, should it have?
[2013-02-21 20:10:16 -0500] yfeldblum: otterley, no; you can create it if it's missing
[2013-02-21 20:10:40 -0500] yfeldblum: otterley, that file is evaluated in the standard Mixlib::Config.from_file way, and the class context within which it is evaluated is here: https://github.com/opscode/omnibus-chef/blob/master/files/chef-server-cookbooks/chef-server/libraries/chef_server.rb
[2013-02-21 20:10:47 -0500] otterley: blah, too much undocumented magic
[2013-02-21 20:10:59 -0500] yfeldblum: otterley, an example of a valid configuration line is like this: bookshelf["vip"] = node["ipaddress"]
[2013-02-21 20:11:56 -0500] rb1980: hi, can anyone help me out real quick to figure out how to query the installed chef-client version with knife search? I can't seem to figure out the attribute name (if there is one)
[2013-02-21 20:12:26 -0500] yfeldblum: otterley, that corresponds to setting up `node["chef_server"]["bookshelf"]["vip"]`, but you typically don't want to do <---- that; you typically want to do `bookshelf["vip"] = node["ipaddress"]` <--- that from your /etc/chef-server/chef-server.rb
[2013-02-21 20:12:31 -0500] danryan: man, this gets weirder yet. 7 different nodes, all brand new. Every one fails on bootstrap due to that "403 Forbidden" error on a template resource.
[2013-02-21 20:13:29 -0500] yfeldblum: otterley, hope that helps
[2013-02-21 20:13:32 -0500] otterley: thanks for your help yfeldblum
[2013-02-21 20:14:56 -0500] yfeldblum: otterley, unfortunately little of this is documented ...
[2013-02-21 20:15:13 -0500] otterley: yfeldblum, I feel like Chef 11 was released prematurely
[2013-02-21 20:15:26 -0500] yfeldblum: otterley, indeed someone else in this channel pointed me to these files
[2013-02-21 20:17:23 -0500] twissmueller: hi everyone, my third day with chef and trying to provision a vagrant box, but struggling with overriding attributes. I have a role defined in roles/sensu_dashboard.rb where I put the run_list and the override_attributes, the run_list will be picked up, but the override_attributes has no effect. When I put the override_attributes into the Vagrantfile the override works. Any ideas what that could be?
[2013-02-21 20:22:17 -0500] timsmith: anyone have hosted chef connectivity issues right now?
[2013-02-21 20:24:14 -0500] raygunsix: seeing some errors here
[2013-02-21 20:24:37 -0500] mathewpeterson: My chef-solr seems to have lost all of its information. Any query that I do returns 0 results.  I've ran knife index rebuild with all success. I'm running ubuntu 12.04 and chef 10.18.2
[2013-02-21 20:24:46 -0500] timsmith: it seems to be back to normal now
[2013-02-21 20:35:54 -0500] balgarath: im getting: Chef::EncryptedDataBagItem::DecryptionFailure: Error decrypting data bag value: 'bad decrypt'. Most likely the provided key is incorrect
[2013-02-21 20:35:55 -0500] balgarath: i looked at the keys used to create the cookbook and the key on the node, and they are both the same.  any idea whats wrong here?
[2013-02-21 20:42:25 -0500] tomdzk: balgarath: knife data bag show --secret-file <key path> <data bag coordinates> shows the contents correctly ?
[2013-02-21 20:45:17 -0500] balgarath: tomdzk: odd, I just user knife data bag edit like 2 hours ago and it worked.  now i cant show or edit the file
[2013-02-21 20:45:28 -0500] awgross: what are some good reasons why you wouldnt want to run apt-get update after a package fails to install due to a stale cache
[2013-02-21 20:46:01 -0500] mattupstate: is there a more recent nagios quickstart guide out in the wild?
[2013-02-21 20:49:20 -0500] awgross: also
[2013-02-21 20:54:52 -0500] sfalcon: balgarath: what versions of Chef are in play? Any chance you are hitting http://tickets.opscode.com/browse/CHEF-3393
[2013-02-21 20:56:09 -0500] balgarath: sfalcon: dont think so.  I just deleted the data bag & starting over
[2013-02-21 20:58:26 -0500] balgarath: seems to be working now that I remade it.  only conclusion is that I used a different key before
[2013-02-21 20:58:32 -0500] doomviking:  /join #gandi
[2013-02-21 20:58:34 -0500] doomviking: er
[2013-02-21 20:58:34 -0500] doomviking: hi
[2013-02-21 21:01:52 -0500] amccloud: How do I get an ip in in the webui node list to update?
[2013-02-21 21:04:16 -0500] epta: Could someone please take a look? http://tickets.opscode.com/browse/CHEF-3924
[2013-02-21 21:05:03 -0500] mathewpeterson: I'm getting a 500 internal error for solr when I run a chef-client update. Any ideas why this might happen? It looks to be a null pointer exception
[2013-02-21 21:31:15 -0500] andreacampi: hi all
[2013-02-21 21:31:40 -0500] balgarath: hello.
[2013-02-21 21:31:41 -0500] andreacampi: it looks like Chef 11 won't load attribute files for cookbooks that are not listed as dependencies of other cookbooks
[2013-02-21 21:31:51 -0500] andreacampi: is that on purpose?
[2013-02-21 21:32:02 -0500] gleam: i think that's intended yes
[2013-02-21 21:32:35 -0500] andreacampi: it's just that with Chef solo that may be confusing--include_recipe will just work, but the attributes are not there so you end up with exceptions calling [] on nil
[2013-02-21 21:32:49 -0500] andreacampi: not a big deal, but may stump a n00b
[2013-02-21 21:33:05 -0500] mathewpeterson: I'm really not sure what happened but, my chef server seems to be all sorts of broken. It's been working for the past two months flawlessly. I'm almost certain it has to do with the chef-solr component as I was having obvious issues with it (doing knife search anything yielded 0 results). I'm really not sure what to do at this point. my current issue is that one of my know does not have any attributes (specifically an ip address). I'm
[2013-02-21 21:33:06 -0500] mathewpeterson: running chef 10.18.2 on ubuntu 12.04. Any suggestions?
[2013-02-21 21:39:37 -0500] epta: Could someone please take a look? http://tickets.opscode.com/browse/CHEF-3923
[2013-02-21 21:45:30 -0500] andreacampi: epta: that sounds pretty easy to implement as a knife plugin
[2013-02-21 21:45:36 -0500] amccloud_: How do I get an ip in in the webui node list to update? Do I have to rerun ohai?
[2013-02-21 21:49:14 -0500] andreacampi: oh, it looks like foodcritic doesn't know that Chef 11 LWRPs notify automagically?
[2013-02-21 21:54:01 -0500] kallistec: andreacampi: http://docs.opscode.com/breaking_changes_chef_11.html#non-recipe-file-evaluation-includes-dependencies
[2013-02-21 21:55:30 -0500] kallistec: would've avoided the breakage if possible, but need the deps to make file eval order correct
[2013-02-21 21:55:31 -0500] andreacampi: kallistec: right, forgot it's mentioned quite explicitly. I just wonder if it could be more graceful
[2013-02-21 21:55:35 -0500] andreacampi: yeah
[2013-02-21 21:55:43 -0500] andreacampi: it's a nice feature BTW :)
[2013-02-21 21:56:02 -0500] andreacampi: oh BTW, I'm sort of back porting use_inline_resources to 10
[2013-02-21 21:56:24 -0500] kallistec: I could see adding warnings or something if you have extra cookbooks in chef-solo
[2013-02-21 21:56:30 -0500] andreacampi: or at least using as a monkey patch in one of my cookbooks, we'll see
[2013-02-21 21:56:53 -0500] andreacampi: ah, maybe--although that could mess up the workflow for some folks
[2013-02-21 21:57:08 -0500] andreacampi: e.g. if they have a big checkout and run different run lists at different times
[2013-02-21 21:58:44 -0500] kallistec: right, that's why it couldn't be a hard error
[2013-02-21 21:58:48 -0500] andreacampi: oh so there is https://github.com/acrmp/foodcritic/issues/90 for use_inline_resources in foodcritic
[2013-02-21 21:58:55 -0500] andreacampi: yeah
[2013-02-21 21:59:54 -0500] andreacampi: BTW was there any discussion about having "whiny nil" in attributes?
[2013-02-21 22:01:07 -0500] kallistec: I've thought about it quite a lot
[2013-02-21 22:01:26 -0500] kallistec: I'm not sure how much value you could get
[2013-02-21 22:01:38 -0500] mathewpeterson: Hey guys. I'm having quite a bit of difficulties with chef lately and have posted several questions in here with no responses. I really am at loss here. Is there a way to completely wipe out chef-sole, reinstall in, and reload the cores and data?
[2013-02-21 22:01:43 -0500] kallistec: unless maybe you did evil things like setting instance variables on nil
[2013-02-21 22:02:09 -0500] andreacampi: no, I'm thinking of node['foo']['bar'] and you mistype foo
[2013-02-21 22:02:21 -0500] andreacampi: now we get a "method [] called on nil"
[2013-02-21 22:02:46 -0500] kallistec: mathewpeterson: you're on 10.x right?
[2013-02-21 22:02:47 -0500] andreacampi: would be nicer to have "you tried to access 'bar' on attribute 'food' which is nil"
[2013-02-21 22:02:57 -0500] mathewpeterson: kallistec: yeah, 10.18.2
[2013-02-21 22:03:02 -0500] andreacampi: would give you something to search for
[2013-02-21 22:03:13 -0500] kallistec: andreacampi: yeah, but there's only ever 1 instance of nil in a ruby vm
[2013-02-21 22:03:31 -0500] andreacampi: unless you decorate it
[2013-02-21 22:03:52 -0500] kallistec: andreacampi: if you wrap it, it's no longer falsey
[2013-02-21 22:04:04 -0500] kallistec: mathewpeterson: chef-expander is running? anything in its logs?
[2013-02-21 22:05:06 -0500] awgross: btm:  jtimberman:  is using the status "Fix Provided" the optimal way to get changes reviewed in the weekly code review?  Some documentation states that the candidates for code review are tickets with "Resolved" which was the old way of contributing to Chef.
[2013-02-21 22:05:21 -0500] kallistec: andreacampi: and ruby doesn't let you make anything other than nil and false falsey
[2013-02-21 22:05:56 -0500] mathewpeterson: kallistec: chef-expander is running; expander log is empty. solr log shows a stack trace, the same with the server log
[2013-02-21 22:06:06 -0500] andreacampi: right
[2013-02-21 22:06:10 -0500] kallistec: which leaves you the option of setting instance variables on nil to say where it came from
[2013-02-21 22:06:28 -0500] andreacampi: or monkey patching NilClass which is not nice
[2013-02-21 22:06:44 -0500] andreacampi: yeah
[2013-02-21 22:06:58 -0500] andreacampi: what you said basically :D
[2013-02-21 22:07:09 -0500] kallistec: mathewpeterson: gist those logs? is solr running at all?
[2013-02-21 22:07:11 -0500] andreacampi: oh well :)
[2013-02-21 22:07:28 -0500] kallistec: mathewpeterson: port 8983 or something if you look in netstat
[2013-02-21 22:07:44 -0500] mathewpeterson: kallistec: solr is running, seems to somewhat work, I can do other searches on it
[2013-02-21 22:07:47 -0500] kallistec: andreacampi: yeah, it's pretty sucky
[2013-02-21 22:08:23 -0500] andreacampi: yeah although I have to say, it's pretty rare that the backtrace doesn't show you where the problem is
[2013-02-21 22:09:38 -0500] kallistec: mathewpeterson: rabbitmq is up as well
[2013-02-21 22:09:40 -0500] kallistec: ?
[2013-02-21 22:10:00 -0500] mathewpeterson: kallistec:  yes
[2013-02-21 22:10:40 -0500] andreacampi: kallistec: now that I'm playing with use_inline_resources, I find I'm trying to go further...
[2013-02-21 22:11:37 -0500] andreacampi: say inside an LWRP action I have resource A that notifies resource B, and of course if either is updated I want the resource to be updated
[2013-02-21 22:12:15 -0500] andreacampi: could I explicitly wrap resource A in a recipe_eval_with_update_check ? would that be bad style?
[2013-02-21 22:12:40 -0500] mathewpeterson: kallistec: solr.log gist: https://gist.github.com/mathewpeterson/5008822  last 1000 lines
[2013-02-21 22:12:42 -0500] kallistec: mathewpeterson: does your issue look like this: http://tickets.opscode.com/browse/CHEF-2346
[2013-02-21 22:13:44 -0500] kallistec: mathewpeterson: what's the query?
[2013-02-21 22:14:34 -0500] mathewpeterson: kallistec: there is nothing in my expander logs, its empty. The query is just above the stack trace
[2013-02-21 22:16:22 -0500] kallistec: mathewpeterson: query goes through a translation layer in chef-server, what are you searching w/ knife?
[2013-02-21 22:17:09 -0500] mathewpeterson: kallistec: It's seems to be the nagios cookbook is to blame
[2013-02-21 22:17:34 -0500] mathewpeterson: kallistec: i don't really know what query it runs when that dies
[2013-02-21 22:18:19 -0500] kallistec: mathewpeterson: seems somehow to be running a completely empty query: `q=`
[2013-02-21 22:19:12 -0500] kallistec: but it would be helpful to correlate with the chef-server logs to see if there's something odd in the translation or if the query is just bad
[2013-02-21 22:20:28 -0500] mathewpeterson: kallistec: ok, I'll post those as well
[2013-02-21 22:24:05 -0500] mathewpeterson: kallistec: I've updated the gist with the other files
[2013-02-21 22:25:43 -0500] Majost1: Can default attributes contain hashes?
[2013-02-21 22:25:51 -0500] juliancdunn: Majost1: yes
[2013-02-21 22:26:07 -0500] Majost1: juliancdunn: standard syntax applies?
[2013-02-21 22:26:11 -0500] kallistec: mathewpeterson: query is nil going in to the chef-server as well
[2013-02-21 22:26:53 -0500] awgross: Majost1: yes
[2013-02-21 22:27:09 -0500] kallistec: perhaps the cookbook is doing something like search("#{node[:thing_to_search]}:#{node[:thing_to_search_for]}") ?
[2013-02-21 22:27:17 -0500] kallistec: and both of those are nil somehow?
[2013-02-21 22:27:28 -0500] mathewpeterson: kallistec: Probably because the node information on one of the nodes is "broken?" When I run a knife node show <node>  all the attributes are empty
[2013-02-21 22:28:04 -0500] mathewpeterson: kallistec:  no fqdn, no ip, no roles, nothing.
[2013-02-21 22:28:19 -0500] kallistec: mathewpeterson: does deleting that node fix the issue?
[2013-02-21 22:28:47 -0500] kallistec: or a successful chef-client run on that host?
[2013-02-21 22:29:24 -0500] kallistec: also, there's been a ton of work done recently on the nagios cookbook, you might look through the tickets to see if your issue has been reported and fixed
[2013-02-21 22:29:25 -0500] mathewpeterson: kallistec: I've deleted the node and reloaded it. It did get those attributes back though, when I reran the chef-client it makes all of it go away
[2013-02-21 22:29:57 -0500] kallistec: what's the last "it" in that sentence?
[2013-02-21 22:30:28 -0500] mathewpeterson: kallistec: I don't believe the issues with the actually cookbook. I had some really weird issues with solr. E.G. any search queries yielded 0 results
[2013-02-21 22:30:34 -0500] mathewpeterson: kallistec: the attributes
[2013-02-21 22:31:30 -0500] kallistec: mathewpeterson: you might be having more than one issue at a time, but according to your logs you're doing a search with an empty query parameter
[2013-02-21 22:31:59 -0500] kallistec: {"controller"=>"search", "action"=>"show", "q"=>"", ...
[2013-02-21 22:33:56 -0500] mathewpeterson: kallistec: Alright. I'll go and update and see what happends
[2013-02-21 22:35:05 -0500] kallistec: mathewpeterson: you can also try doing `knife index rebuild` to re-dump your database into solr to see if that fixes anything
[2013-02-21 22:35:22 -0500] kallistec: you should see lots of activity from chef-expander while that runs
[2013-02-21 22:35:29 -0500] mathewpeterson: kallistec: I've done that many times with no changes
[2013-02-21 22:36:45 -0500] mathewpeterson: kallistec: oh, this is interesting.. I did a knife cookbook site install nagios3 and it went through and updated a bunch of cookbooks and removed all of my modifications. Thats neat.
[2013-02-21 22:37:26 -0500] miah: sounds like a oops
[2013-02-21 22:37:36 -0500] kallistec: mathewpeterson: changes should be made in git so you can git reset --hard COMMIT_ID to revert
[2013-02-21 22:40:47 -0500] mathewpeterson: kallistec: Ok, I think I'm just going to stop using chef for now. It's taking up way too much of my time. It's quite sad though. It was working so perfectly for the past few months. Then just all of a sudden it just decides not to work any meow.
[2013-02-21 22:40:52 -0500] mathewpeterson: more*
[2013-02-21 22:41:26 -0500] miah: doesnt sound like it 'just stopped working' though
[2013-02-21 22:41:31 -0500] miah: you applied a change without testing it
[2013-02-21 22:41:41 -0500] miah: and you didn't have a proper deployment process in place
[2013-02-21 22:42:39 -0500] mathewpeterson: miah: how do you mean?
[2013-02-21 22:42:50 -0500] kallistec: mathewpeterson: well, that's a bummer. If you're gonna throw the whole thing away, you might want to consider switching to Chef 11 which is a whole lot easier to manage
[2013-02-21 22:43:39 -0500] mathewpeterson: kallistec: yeah, when I get more free time. I've spent the past few days fighting with this. I only have 3 servers at the moment. It's just not worth the time right now.
[2013-02-21 22:47:36 -0500] andreacampi: kallistec: actually, scratch that: any notifications triggered inside recipe_eval_with_update_check will run before recipe_eval_with_update_check returns, correct?
[2013-02-21 22:47:51 -0500] kbennett: Shouldn't knife download be able to find the 'java' cookbook?  When I do: sudo knife cookbook download java, I get an error that the java cookbook cannot be found.  What am I doing wrong?  TIA.
[2013-02-21 22:48:51 -0500] josephholsten: kbennett: you probably want `knife cookbook site download java`, what you're doing is only talking to your chef server
[2013-02-21 22:49:04 -0500] josephholsten: which doesn't seem like what you want
[2013-02-21 22:51:30 -0500] danryan: I am deeply saddened by the lack of Spinal Tap references for the new Chef version.
[2013-02-21 22:51:42 -0500] kallistec: andreacampi: AFAICT notification stuff should work fine, it has its own Chef::Runner so even delayed notifications should "work" except they'll fire at the end of the lwrp action
[2013-02-21 22:51:50 -0500] andreacampi: yes, that seems to be the case. that's actually pretty damn awesome!
[2013-02-21 22:52:26 -0500] andreacampi: you should have been MVP just for that!
[2013-02-21 22:52:37 -0500] andreacampi: it makes things so much nicer
[2013-02-21 22:53:04 -0500] andreacampi: no more of that run_action sillyness
[2013-02-21 22:56:10 -0500] andreacampi: now if only you or somebody else could teach foodcritic about that ;)
[2013-02-21 23:12:10 -0500] andreacampi: kallistec: so given it's opt-in, any thoughts about back porting it?
[2013-02-21 23:15:40 -0500] kbennett: Sorry, I should have been using "sudo knife cookbook *site* download ..."
[2013-02-21 23:17:21 -0500] kbennett: Also, I noticed that after downloading a cookbook, I have to untar it.  I'm using chef solo.  Is this as it should be?  I'm specifying the directory (by not specifying -r at all).
[2013-02-21 23:22:07 -0500] kbennett: I just got this error when running chef solo and including the java task: "[2013-02-21T18:21:29-05:00] FATAL: NoMethodError: undefined method `[]' for nil:NilClass"
[2013-02-21 23:22:14 -0500] kbennett: I think you were just talking about this before.
[2013-02-21 23:22:29 -0500] kbennett: As a beginner, I haven't a clue what to do.
[2013-02-21 23:22:49 -0500] kallistec: andreacampi: I guess it's okay to backport, it's like any new feature in cookbooks where the author has to make a choice about whether to require newer chef, but I suppose it's easier if people can get it w/o chef 11.x
[2013-02-21 23:23:02 -0500] andreacampi: exactly
[2013-02-21 23:23:36 -0500] andreacampi: well I'll play with it some more and then file a ticket and let you guys figure out during a code review ;)
[2013-02-21 23:24:52 -0500] andreacampi: to me the fact that it makes things self-contained may matter even more than the updated?
[2013-02-21 23:27:35 -0500] kallistec: that bit is a tad controversial, some people would like to be able to notify the "outside world" even though they know it's ugly and wrong (/cc coderanger )
[2013-02-21 23:27:48 -0500] coderanger: kallistec: :P
[2013-02-21 23:27:55 -0500] coderanger: Important sometimes
[2013-02-21 23:28:31 -0500] coderanger: kallistec: Unless you have a better suggestion for how to handle that lb_vhost use case :)
[2013-02-21 23:28:47 -0500] andreacampi: sure--but having the option beats both of the alternatives :)
[2013-02-21 23:28:52 -0500] andreacampi: it's up to what you are trying to do
[2013-02-21 23:29:06 -0500] kallistec: coderanger: yeah, I can see it from a pragmatic standpoint, just wear your kevlar shoes. anyway, I think part of what I've proposed in https://gist.github.com/danielsdeleo/30a8719901eca6545488 would be a clean solution
[2013-02-21 23:31:12 -0500] coderanger: kallistec: Just have to figure out how to make it not super overkill for 99% of the cases
[2013-02-21 23:31:48 -0500] kallistec: coderanger: in particular, splitting the current resource collection into a resource set and ordered list of resource,action tuples
[2013-02-21 23:31:52 -0500] coderanger: as for the LWRP reaching, also helps that the alternative is always that it fails with exception, so don't have to worry about intent :)
[2013-02-21 23:32:15 -0500] kallistec: for backcompat we can wrap those two items in a facade that looks like the current array
[2013-02-21 23:32:24 -0500] andreacampi: coderanger: uh?
[2013-02-21 23:33:32 -0500] coderanger: andreacampi: https://gist.github.com/coderanger/4506662
[2013-02-21 23:34:47 -0500] andreacampi: ah
[2013-02-21 23:36:17 -0500] miah: kallistec: i think that gist makes tons of sense.
[2013-02-21 23:36:39 -0500] coderanger: andreacampi: We are using that internally at Opscode for some load-balancer code I write
[2013-02-21 23:37:56 -0500] andreacampi: I'm trying to grok the difference from InlineResources as we have in Chef 11
[2013-02-21 23:38:13 -0500] andreacampi: the lookup from parent?
[2013-02-21 23:38:59 -0500] coderanger: andreacampi: Yep
[2013-02-21 23:39:09 -0500] coderanger: Thats what kallistec was making fun of me over :)
[2013-02-21 23:39:55 -0500] andreacampi: the alternative to that would be to look up the resource before jumping into the sub run context
[2013-02-21 23:40:03 -0500] coderanger: http://hastebin.com/hawuvacayo.rb
[2013-02-21 23:40:19 -0500] coderanger: Yeah, but you can't easily do that while preserving the syntax abstraction
[2013-02-21 23:40:56 -0500] coderanger: Of note, nginx_site itself notifies service[nginx]
[2013-02-21 23:41:20 -0500] andreacampi: indeed
[2013-02-21 23:41:21 -0500] coderanger: So either it would have to be modified to work in the restricted context or you would need to copy over that entry, etc etc
[2013-02-21 23:41:25 -0500] coderanger: gets gross
[2013-02-21 23:41:37 -0500] andreacampi: yeah
[2013-02-21 23:42:29 -0500] coderanger: I just haven't gotten around to submitting this as a patch for core chef
[2013-02-21 23:42:39 -0500] coderanger: should be super easy to adapt
[2013-02-21 23:43:02 -0500] andreacampi: sure
[2013-02-21 23:44:20 -0500] andreacampi: I think I'm with you here, I don't really see anything wrong if it's to a good end...
[2013-02-21 23:44:44 -0500] andreacampi: the fact that a LWRP may want to notify some other resource (probably even from the same cookbook)
[2013-02-21 23:44:51 -0500] andreacampi: can lead to better encapsulation
[2013-02-21 23:45:10 -0500] andreacampi: of course the devil is in the details
[2013-02-21 23:46:36 -0500] miah: or one could fix nginx_site to not be derpy
[2013-02-21 23:47:41 -0500] coderanger: miah: How is it derpy? If used in a normal recipe I would expect it to handle reloads on state change
[2013-02-21 23:49:36 -0500] miah: well, up until recently. what if you were using nginx + runit. the service notification wouldn't really work afaict because runit_service != service.
[2013-02-21 23:49:54 -0500] miah: also. i can't recall. but is it at least doing the notifications in a delayed way?
[2013-02-21 23:50:01 -0500] miah: because i'd rather have my nginx restart once
[2013-02-21 23:50:05 -0500] miah: lastely
[2013-02-21 23:50:17 -0500] coderanger: miah: Thats a deeper issue of we need to resolve how services all work in a unified way
[2013-02-21 23:50:17 -0500] miah: /etc/nginx/nginx.conf = shit and i want the ability to overwrite that
[2013-02-21 23:50:30 -0500] tomdzk: miah: wouldn't you want to have a runit service provider for that ?
[2013-02-21 23:50:30 -0500] miah: nginx_site doesn't always fit
[2013-02-21 23:50:31 -0500] andreacampi: coderanger +1
[2013-02-21 23:50:58 -0500] coderanger: Because I have similar issues running stuff under supervisor, requires a lot of cookbook forks
[2013-02-21 23:50:58 -0500] andreacampi: we need to stop cookbooks from reinventing the wheel (and often not making it round)
[2013-02-21 23:51:01 -0500] miah: tomdzk: the point of chef is to abstract all that stuff to a common ground. so i can notify 'service[nginx]' and chef would know that its a runit_service and do the right thing
[2013-02-21 23:51:21 -0500] andreacampi: I should be able to choose the init style once and for all
[2013-02-21 23:51:21 -0500] miah: just as 'package' knows to do the right thing with rpm, yum, apt, etc.
[2013-02-21 23:51:33 -0500] tomdzk: miah: yes, and I thought the service provider mechanism is the way to do that (for services) ?
[2013-02-21 23:51:48 -0500] miah: yes. but until recently runit was a definition and not even a resource
[2013-02-21 23:51:51 -0500] andreacampi: but I agree, it's a different problem
[2013-02-21 23:52:10 -0500] coderanger: The service resource API doesn't offer a good way to support per-backend features and such
[2013-02-21 23:52:10 -0500] mlei: hey guys, i've got a chicken and the egg problem
[2013-02-21 23:52:13 -0500] tomdzk: miah: got it
[2013-02-21 23:52:31 -0500] mlei: i have some default attributes set in a role, but the attributes don't seem to get evaluated until chef has run once
[2013-02-21 23:52:56 -0500] mlei: so the first time, my cookbook which needs them ends up writing nothing into the template where the value is supposed to be
[2013-02-21 23:53:04 -0500] mlei: this is chef 10.18
[2013-02-21 23:53:16 -0500] miah: are your attributes defined as 'default_attributes' in your role
[2013-02-21 23:53:19 -0500] mlei: yes
[2013-02-21 23:53:23 -0500] miah: and your cookbook has defaults also set that are nil?
[2013-02-21 23:53:42 -0500] mlei: they are nil, or they are something else
[2013-02-21 23:54:08 -0500] miah: http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2013-02-21 23:54:08 -0500] mlei: the attributes become the right ones after the first chef run, so the second chef run works properly
[2013-02-21 23:54:36 -0500] robertd: I am trying to use ignore_failure with a custom resource. The issue is that it is not working. ignore_failure needs to be used / implemented in the provider?
[2013-02-21 23:54:56 -0500] mlei: it's not a question of precedence, i don't think. because the defaults from the role are higher precedence than ones from an attributes file, right?
[2013-02-21 23:55:30 -0500] mlei: it's also the same issue if i am setting attributes that aren't set in the cookbook
[2013-02-21 23:55:36 -0500] miah: no
[2013-02-21 23:56:06 -0500] mlei: then why after the first chef run, in the node information i get the role defaults?
[2013-02-21 23:56:19 -0500] mlei: not the cookbook defaults?
[2013-02-21 23:56:20 -0500] miah: are you doing node.set or something in your cookbooks?
[2013-02-21 23:56:23 -0500] mlei: no
[2013-02-21 23:56:27 -0500] mlei: only in attributes.rb
[2013-02-21 23:56:37 -0500] miah: how are you setting them in attributes.rb ?
[2013-02-21 23:56:54 -0500] miah: 'node.default['my']['attr'] = 'derp'
[2013-02-21 23:56:55 -0500] miah: ?
[2013-02-21 23:57:01 -0500] mlei: no
[2013-02-21 23:57:03 -0500] mlei: default['rabbitmq']['cluster'] = false
[2013-02-21 23:57:05 -0500] mlei: for example
[2013-02-21 23:57:43 -0500] mlei: on the second chef run, the values are what you'd expect
[2013-02-21 23:57:59 -0500] mlei: i.e. the ones that came from the role, not from the default in the cookbooks attributes.rb
[2013-02-21 23:58:16 -0500] mlei: my problem is that the ones from the role don't seem to apply until chef has run once
[2013-02-21 23:58:22 -0500] epta: Could someone help with knife plugin? I wanna get JSON representation of enviromnent like docs said http://wiki.opscode.com/display/chef/Server+API#ServerAPI-/environments/ENVIRONMENT_NAME . Here is my approach https://gist.github.com/dmalikov/65babe9abab66cb8f923 . It returns only environment name, not JSON. What am I doing wrong?
[2013-02-21 23:59:48 -0500] mlei: another piece of information, but not sure if this matters: the role with the recipe is before the role with the attributes in the runlist
