[2013-02-22 00:01:07 -0500] mlei: the only way i know of to get around this is to set the attributes directly in the node json
[2013-02-22 00:01:18 -0500] mlei: but that defeats the purpose of the role gathering the common attributes
[2013-02-22 00:12:06 -0500] mlei: okay, i have another problem
[2013-02-22 00:13:03 -0500] mlei: i want to launch three instances in ec2, and have them come up together... but the problem is that the configurations for each have to have the hostnames of the others
[2013-02-22 00:14:02 -0500] mlei: i can do a search in the cookbook, but it's not guaranteed to find the others depending on whether chef has run on it or not, if i'm searching on an attribute in the cookbook
[2013-02-22 00:14:33 -0500] mlei: anyone with experience with this sort of coordination problem?
[2013-02-22 00:15:45 -0500] josephholsten: mlei: you might find useful patterns for that in https://github.com/chef-workflow
[2013-02-22 00:17:23 -0500] log1kal: anyone know what might cause the following, or suggestions on how to address? Platform ubuntu not found, using all defaults. (Unsupported platform?)
[2013-02-22 00:17:44 -0500] log1kal: hoping it doesn't have to do with my using chef 0.10.10 (hangs head in shame)
[2013-02-22 00:18:52 -0500] spox: log1kal: i remember it (not the exact cause of the message off the top of my head) and it is likely nothing to be concerned about
[2013-02-22 00:19:04 -0500] andreaca_: yeah
[2013-02-22 00:19:12 -0500] log1kal: well, it's causing this tomcat cookbook to just skip installing tomcat.
[2013-02-22 00:19:16 -0500] andreaca_: logical why do you think it's a problem?
[2013-02-22 00:19:30 -0500] log1kal: I think.
[2013-02-22 00:20:25 -0500] atomic-penguin: Whatever happened to bawt?
[2013-02-22 00:20:32 -0500] andreacampi: that would be surprising methinks it's a red herring
[2013-02-22 00:20:55 -0500] log1kal: Darn.
[2013-02-22 00:21:49 -0500] log1kal: Odd thing is that this complains when running chef-solo. When I run via shef, this works like intended
[2013-02-22 00:22:01 -0500] log1kal: (er, chef-solo via vagrant provision)
[2013-02-22 00:23:40 -0500] aneto: can someone explain or point me a direction to where I can pass unique userdata to my node, so I don't have to make a change and keep uploading a cookbook.... I thought that's what userdata was for but it keeps tossing a \n at the end
[2013-02-22 00:25:34 -0500] log1kal: https://gist.github.com/skilgore/5009747 has some more details
[2013-02-22 00:25:49 -0500] log1kal: this'll learn me to use non-community cookbooks :(
[2013-02-22 00:29:43 -0500] kisoku: anyone have a clue what is happening here ?
[2013-02-22 00:29:45 -0500] kisoku: https://gist.github.com/kisoku/32faf28ee3b111d4651b
[2013-02-22 00:32:08 -0500] tomdzk: log1kal: put some logging statements in that recipe to see what value you actually get for node['platform']
[2013-02-22 00:33:17 -0500] tomdzk: kisoku: it mentions line 227 in recipe jenkins::default
[2013-02-22 00:33:26 -0500] tomdzk: I'd check that line
[2013-02-22 00:37:55 -0500] Reaper99: anyone facing issues with runsv on centos?
[2013-02-22 00:38:04 -0500] Reaper99: on chef 11?
[2013-02-22 00:39:58 -0500] Reaper99: I'm getting this error STDOUT: fail: rabbitmq: runsv not running
[2013-02-22 00:40:16 -0500] Reaper99: tried everything installed daemon tools, runit from source still no go
[2013-02-22 00:40:45 -0500] Reaper99: appreciate if anyone experienced the same issue can can shed some light on how to solve it
[2013-02-22 00:41:20 -0500] kisoku: uh yeah
[2013-02-22 00:41:20 -0500] tomdzk: Reaper99: maybe related to http://tickets.opscode.com/browse/CHEF-3838 ?
[2013-02-22 00:41:24 -0500] kisoku: the line is fine
[2013-02-22 00:41:37 -0500] kisoku: in fact the recipe worked very well up until 10.24.0
[2013-02-22 00:41:46 -0500] kisoku: now it throws errors in the provider
[2013-02-22 00:41:50 -0500] Reaper99: yes
[2013-02-22 00:42:10 -0500] Reaper99: i even tried the new version of runit cookbook but that breaks other stuff
[2013-02-22 00:43:34 -0500] Reaper99: kisoku I've been scratching my head all day with this
[2013-02-22 00:44:00 -0500] kisoku: um. I am not talking about your issue :-)
[2013-02-22 00:44:25 -0500] kisoku: I am talking about my issue that I posted before you entered the channel
[2013-02-22 00:44:33 -0500] Reaper99: oh lol
[2013-02-22 00:44:37 -0500] miah: kisoku: thats a fun one
[2013-02-22 00:44:39 -0500] Reaper99: yeah I'm in the same boat
[2013-02-22 00:44:45 -0500] miah: can we see the full stacktrace?
[2013-02-22 00:44:50 -0500] kisoku: yeah ok
[2013-02-22 00:44:55 -0500] kisoku: it's not much more informative
[2013-02-22 00:45:07 -0500] kisoku: give me a minute to dig it out
[2013-02-22 00:45:13 -0500] miah: np
[2013-02-22 00:46:29 -0500] Reaper99: @miah here you go
[2013-02-22 00:46:34 -0500] Reaper99: Mixlib::ShellOut::ShellCommandFailed: execute[/opt/chef-server/bin/chef-server-ctl start rabbitmq] (chef-server::rabbitmq line 76) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '1'
[2013-02-22 00:46:35 -0500] Reaper99: ---- Begin output of /opt/chef-server/bin/chef-server-ctl start rabbitmq ----
[2013-02-22 00:46:36 -0500] Reaper99: STDOUT: fail: rabbitmq: runsv not running
[2013-02-22 00:46:38 -0500] Reaper99: STDERR:
[2013-02-22 00:46:39 -0500] Reaper99: ---- End output of /opt/chef-server/bin/chef-server-ctl start rabbitmq ----
[2013-02-22 00:46:41 -0500] Reaper99: Ran /opt/chef-server/bin/chef-server-ctl start rabbitmq returned 1
[2013-02-22 00:47:05 -0500] miah: Reaper99: no pasting to the channel please
[2013-02-22 00:47:31 -0500] Reaper99: oh sorry
[2013-02-22 00:47:35 -0500] tomdzk: kisoku: what jenkins cookbook do you use, and what version ?
[2013-02-22 00:47:39 -0500] miah: how are you on centos with runsv?
[2013-02-22 00:48:39 -0500] kisoku: the heavywater one at whatever tag was the last tag
[2013-02-22 00:48:55 -0500] Reaper99: RHEL
[2013-02-22 00:49:44 -0500] Reaper99: 2.6.18-92.1.18.el5
[2013-02-22 00:52:13 -0500] tomdzk: kisoku: I don't see that cookbook use default_release anywhere, could you add the code around that line to your gist ?
[2013-02-22 00:53:05 -0500] miah: Reaper99: right. but do you have runit installed?
[2013-02-22 00:53:42 -0500] Reaper99: miah yes
[2013-02-22 00:53:49 -0500] Reaper99: whereis runit
[2013-02-22 00:53:49 -0500] Reaper99: runit: /usr/local/bin/runit
[2013-02-22 00:54:15 -0500] miah: is runsv running?
[2013-02-22 00:56:02 -0500] Reaper99: its suppose to be even if its not the included cookbook is suppose to take care of it right?
[2013-02-22 00:56:37 -0500] miah: not necessarily
[2013-02-22 00:57:07 -0500] miah: depends on if you have a cookbook running to manage/setup runit
[2013-02-22 00:57:31 -0500] Reaper99: I'm just trying to install chef-server using the chef-server-ctl script
[2013-02-22 00:58:05 -0500] kisoku: tomdzk: this is an issue with chef internals
[2013-02-22 00:58:10 -0500] kisoku: I'll work it out with miah
[2013-02-22 00:58:11 -0500] kisoku: thanks
[2013-02-22 00:58:30 -0500] Reaper99: and that includes runit cookbook by default I mean its a dependency
[2013-02-22 00:59:10 -0500] aboudreault: what is the way to distribute my cookbook with its dependencies? I used bershelf + vagrant for its development.
[2013-02-22 00:59:57 -0500] epta: Could someone please help with Chef::CookbookLoader? `cookbook_loader ||= Chef::CookbookLoader.new(config[:cookbook_path])` returns structure with valid @repo_paths list, but with empty @cookbooks_by_name. What am I doing wrong?
[2013-02-22 01:00:16 -0500] josephholsten: aboudreault: distribute? berks upload should push all your deps into the chef server
[2013-02-22 01:00:37 -0500] aboudreault: josephholsten, I use chef solo, no server
[2013-02-22 01:01:07 -0500] aboudreault: I want to push it in github and write a small todo to let users use it with vagrant
[2013-02-22 01:01:22 -0500] josephholsten: oh, then I'd run `berks install --path sandbox` and tarball it up
[2013-02-22 01:01:35 -0500] josephholsten: why can't they also use berks to install dependencies?
[2013-02-22 01:01:53 -0500] tomdzk: kisoku: erm, sure thing, just trying to help
[2013-02-22 01:03:03 -0500] aboudreault: josephholsten, honestly, I don't  know. I just want the tuto page be simple as  possible. So thought that removing bershelf from the process would be better. I might be wrong.
[2013-02-22 01:06:59 -0500] Reaper99: miah?
[2013-02-22 01:07:26 -0500] josephholsten: aboudreault: that case, you might use `bundler install --standalone` and `berks install --path vendor/cookbooks`. You'll get all your dependencies in one place. You should be able to point vagrant at your packaged cookbooks with a cookbook_path pointed at vendor/cookbooks
[2013-02-22 01:08:26 -0500] aboudreault:  I see that my berks install worked, and I see all dependencies. What is bundler for?
[2013-02-22 01:08:27 -0500] jhulten_: aboudreault: That is what I did. Each cookbook repo is in isolation from its neighbors.
[2013-02-22 01:08:45 -0500] jhulten_: bundler manages gems like berkshelf, chefspec, etc.
[2013-02-22 01:08:52 -0500] josephholsten: bundler installs gems
[2013-02-22 01:09:30 -0500] jhulten_: I do my best to install nothing but bundler and rake in my ruby common gem directories.
[2013-02-22 01:09:41 -0500] jhulten_: Makes it more likely that CI will work.
[2013-02-22 01:10:50 -0500] aboudreault: jhulten_, Are your work on github?
[2013-02-22 01:11:11 -0500] jhulten_: yup. private repos mostly.
[2013-02-22 01:11:58 -0500] mswart: should i use new_resource or @new_resource? i find both ways (in the wiki, too)
[2013-02-22 01:12:22 -0500] jhulten_: I put the following in ~/.bundler/config https://gist.github.com/jhulten/5009999
[2013-02-22 01:12:42 -0500] jhulten_: Airplane is boarding. Later.
[2013-02-22 01:13:00 -0500] aboudreault: kk. My initial Idea was a repo with this structure: http://www.bpaste.net/show/MMnT9GQU5S17ZKfnMpUD/
[2013-02-22 01:13:12 -0500] aboudreault: and I would have tell the user to do git clone, bla bla.
[2013-02-22 01:13:17 -0500] josephholsten: aboudreault: if you're doing a public cookbook, I'd encourage you not to bundle the deps there. Keep the reusable parts light, and then have one repo that packages all the things
[2013-02-22 01:13:48 -0500] josephholsten: oh, you're pretty much doing this
[2013-02-22 01:14:11 -0500] josephholsten: https://github.com/opscode/chef-repo
[2013-02-22 01:18:46 -0500] aboudreault: emm
[2013-02-22 01:21:18 -0500] aboudreault: josephholsten, I was not using knife for now
[2013-02-22 01:21:32 -0500] log1kal: Gah. My issue earlier was bad recipe ordering.
[2013-02-22 01:21:35 -0500] aboudreault: not sure if it's worth to modify my current git structure
[2013-02-22 01:21:51 -0500] josephholsten: aboudreault: there is nothing knife related in that
[2013-02-22 01:22:50 -0500] aboudreault: josephholsten, ok.. I've seen some knife mentions be it's just saying some command will be remove
[2013-02-22 01:24:23 -0500] aboudreault: will fork it try to push my things in that
[2013-02-22 01:29:41 -0500] ialexan: Hello I am new with Chef I am trying to figure out how can i do a vi inside a file and change something from disable to enable ??
[2013-02-22 01:30:31 -0500] doomviking: sounds like you're new with vi
[2013-02-22 01:30:40 -0500] aboudreault: :)
[2013-02-22 01:31:01 -0500] doomviking: and files
[2013-02-22 01:31:49 -0500] kallistec: ialexan: you want chef to edit a file?
[2013-02-22 01:32:55 -0500] ialexan: yes i want to edit a file
[2013-02-22 01:34:44 -0500] josephholsten: ialexan: usually it's best to manage the entire contents of a file, but I've heard of a plugin that edits
[2013-02-22 01:34:59 -0500] kallistec: ialexan: in general you should try to avoid editing files, because then you have to do a ton of work to make sure that a brand new system gets all the required edits applied to get to the desired state. Whenever possible, you want to manage the entire file: http://docs.opscode.com/resource_template.html
[2013-02-22 01:35:42 -0500] josephholsten: ialexan: if you're feeling daring, there is chef-rewind: https://github.com/bryanwb/chef-rewind
[2013-02-22 01:36:08 -0500] josephholsten: I strongly advise against it, but when you need a cannon, it's there
[2013-02-22 01:36:22 -0500] ialexan: okay thank you guys I will take a look
[2013-02-22 01:37:04 -0500] josephholsten: and someday, someone, somewhere will write a plugin to use augeas for the especially tricky changes
[2013-02-22 01:56:27 -0500] ialexan: kallistec: What exactly does the templae do. From what I understood you can have the new file saved under the template and then during the chef run you can just load the template and this will replace the old file ?
[2013-02-22 03:34:17 -0500] timothyfitz: Stupid question: If I have a resource in one cookbook, how do I reference it from another cookbook? (i.e. I have python/resources/pip.rb and python/providers/pip.rb and I want to use that from web/recipes/default.rb, but just saying "pip" gives me a NoMethodError)
[2013-02-22 03:34:39 -0500] timothyfitz: (Running on OpsWorks, so some weird Chef 9 fork or something)
[2013-02-22 03:37:15 -0500] yfeldblum: timothyfitz, the `metadata.rb` or the calling cookbook must declare a dependency on the callee cookbook
[2013-02-22 03:38:09 -0500] yfeldblum: timothyfitz, http://docs.opscode.com/config_rb_metadata.html
[2013-02-22 03:39:59 -0500] timothyfitz: yfeldblum: that was the last thing I tried before coming here. My metadata.rb is literally just one line: depends "python"; also note that OpsWorks is chef-solo, so I'm not actually sure what if anything depends does in that context.
[2013-02-22 03:40:40 -0500] yfeldblum: timothyfitz, ah, well, that's usually the first thing people miss
[2013-02-22 03:40:57 -0500] timothyfitz: yfeldblum: to be fair, it was! It was the last thing I tried after a half dozen other attempts.
[2013-02-22 03:41:01 -0500] yfeldblum: timothyfitz, looking at your question more closely, you may need to use the method `python_pip` rather than `pip`
[2013-02-22 03:50:15 -0500] timothyfitz: yfeldblum: sweet, the python_pip thing worked (or rather, got me to my next error), thanks!
[2013-02-22 03:50:37 -0500] timothyfitz: Also don't be so hard on yourself about dangling participles :) http://en.wikipedia.org/wiki/Linguistic_prescription
[2013-02-22 03:51:47 -0500] yfeldblum: timothyfitz, i prefer what i say to be grammatical
[2013-02-22 03:52:25 -0500] yfeldblum: timothyfitz, computers demand it; i should too
[2013-02-22 03:52:44 -0500] yfeldblum: timothyfitz, anyway, glad i could help
[2013-02-22 04:17:22 -0500] j^2: question, is opensource chef server been updated to 11 yet?
[2013-02-22 04:18:04 -0500] j^2: or even better, how do i tell the version of my opensource chef server?
[2013-02-22 04:20:33 -0500] j^2: http://docs.opscode.com/chef/install_server.html
[2013-02-22 04:21:08 -0500] mattray: j^2: http://www.opscode.com/chef/install/ click the server tab
[2013-02-22 04:21:34 -0500] j^2: mattray: does it update the 10.x version i _should_ be running?
[2013-02-22 04:21:45 -0500] mattray: most definitely not
[2013-02-22 04:21:52 -0500] j^2: ha
[2013-02-22 04:21:52 -0500] mattray: migration tools have not been released yet
[2013-02-22 04:21:55 -0500] j^2: awesome
[2013-02-22 04:21:56 -0500] j^2: ohh
[2013-02-22 04:22:08 -0500] j^2: i thought i read something about that but i'm glad i just confirmed that
[2013-02-22 04:22:32 -0500] mattray: you can migrate by hand, but we're working on automated migrations presently
[2013-02-22 04:22:51 -0500] j^2: so i'd have to migrate my chef infurstrucre to the _new_ chef 11 machine if i decide to build it?
[2013-02-22 04:23:12 -0500] mattray: yup
[2013-02-22 04:23:20 -0500] j^2: makes sense
[2013-02-22 04:23:22 -0500] mattray: until the migration tools are released
[2013-02-22 04:23:32 -0500] j^2: yep, awesome thanks for clearing that up
[2013-02-22 04:23:41 -0500] mattray: and then it'll slurp in the couch and push it into postgres
[2013-02-22 04:33:01 -0500] johnderr: .
[2013-02-22 04:33:49 -0500] senilegenius: mattray: do y'all have an idea of when those migration tools would be released? :)
[2013-02-22 04:35:39 -0500] mattray: there was a demo this week of the testing for it. Essentially the same sort of testing that goes into validating a working server has to go into before and after testing. We'll definitely dogfood it before we share it
[2013-02-22 04:36:32 -0500] mattray: and by dogfood I mean test it on paying customers :)
[2013-02-22 04:36:40 -0500] senilegenius: so sounds like a couple of months-ish
[2013-02-22 04:36:56 -0500] senilegenius: that's the best way to dogfood! ;)
[2013-02-22 04:38:34 -0500] mattray: senilegenius: yeah, it may be awhile before we feel like handing out a tool that could break things really badly
[2013-02-22 04:38:52 -0500] mattray: but it's being worked on
[2013-02-22 04:39:06 -0500] mattray: because we want to get everyone to Chef 11
[2013-02-22 04:40:01 -0500] senilegenius: yeah, understood.
[2013-02-22 04:40:24 -0500] senilegenius: mattray: would you have a good link for migrating manually fromsay0.10.8 to 11?
[2013-02-22 04:40:45 -0500] mattray: senilegenius: 1 sec
[2013-02-22 04:41:20 -0500] mattray: senilegenius: it would be very similar to this: http://docs.opscode.com/chef/migrate_to_hosted.html
[2013-02-22 04:42:45 -0500] mattray: senilegenius: in fact, it would be super awesome dope if that were tested and pull requests made back to https://github.com/opscode/chef-docs to say "or Open Source Chef 11" ;)
[2013-02-22 04:45:15 -0500] senilegenius: mattray: thanks! and duly noted! if i can get to the migration task in my environment i'll do my best to make updates in chef-docs
[2013-02-22 04:45:29 -0500] mattray: senilegenius: thanks!
[2013-02-22 04:45:47 -0500] mattray: senilegenius: PRs get turned around into live docs really fast
[2013-02-22 04:46:19 -0500] senilegenius: it's pretty rad you all handle documentation this way. me likes. :)
[2013-02-22 04:47:09 -0500] mattray: our doc writer's also on twitter, @chefdocs
[2013-02-22 04:50:31 -0500] johnderr: Is there a way to determine if a template file is available during the chef run before trying to source it?
[2013-02-22 05:12:25 -0500] clundquist: I have a noob question as I struggle with Chef 11.2
[2013-02-22 05:12:33 -0500] clundquist: I have resources A and B
[2013-02-22 05:13:00 -0500] clundquist: resource A downloads crap, and then does node.normal.foo.bar = "baz"
[2013-02-22 05:13:37 -0500] clundquist: then resource B looks at node.foo.bar and it is nil because chef 11 dies if I don't have it as nil in attributes/default.rb
[2013-02-22 05:13:52 -0500] clundquist: I want resource B to see "baz" and not nil
[2013-02-22 05:13:56 -0500] clundquist: I also tried override to no avail
[2013-02-22 05:14:06 -0500] clundquist: am I missing something really obvious?
[2013-02-22 05:17:02 -0500] mwhooker: clundquist not sure if this changed since 10 but I've always used node.default[:foo][:bar] = "baz"
[2013-02-22 05:17:23 -0500] clundquist: right, and that worked in chef 10
[2013-02-22 05:17:40 -0500] clundquist: well, I was naughty and said, node[:foo][:bar] = "baz"
[2013-02-22 05:18:00 -0500] clundquist: which breaks chef 11
[2013-02-22 05:18:29 -0500] mwhooker: hmm
[2013-02-22 05:18:33 -0500] clundquist: http://docs.opscode.com/breaking_changes_chef_11.html
[2013-02-22 05:18:39 -0500] clundquist: as I am sure you have read
[2013-02-22 05:18:53 -0500] mwhooker: I've run in to the same problem where recipes are evaluated before they're run
[2013-02-22 05:19:20 -0500] clundquist: I've wrapped those parts in ruby_block and bash resources
[2013-02-22 05:19:30 -0500] mwhooker: can't say I know much about 11
[2013-02-22 05:19:39 -0500] mwhooker: makes sense
[2013-02-22 05:20:06 -0500] DeadZen: chef11 +1
[2013-02-22 05:20:07 -0500] yfeldblum: clundquist, i would suggest setting node attributes only at the top-level
[2013-02-22 05:20:32 -0500] clundquist: yfeldblum: could you elaborate on that?
[2013-02-22 05:20:49 -0500] yfeldblum: clundquist, don't set node attributes from within ruby_block resources or any other esources
[2013-02-22 05:21:21 -0500] clundquist: the downloaded file contents affect my chef run
[2013-02-22 05:21:30 -0500] clundquist: it contains network configuration info, and this sets up networking
[2013-02-22 05:22:06 -0500] clundquist: there were 500 bad decisions made for this recipe exist, but here we are
[2013-02-22 05:22:57 -0500] yfeldblum: clundquist, then fetch the file immediately; don't use a resource to fetch the file
[2013-02-22 05:23:25 -0500] yfeldblum: clundquist, i wouldn't say that's bad design per se without knowing more; it's just a normal database query, effectively, like any other
[2013-02-22 05:23:28 -0500] clundquist: basically the recipe reads /proc/cmdline on first PXE boot to search for options passed via the pxe boot command line, then queries a server to figure out where on the network it is supposed to live
[2013-02-22 05:23:47 -0500] yfeldblum: clundquist, but database queries should be done at the top-level, not from within ruby_block resources or any other resources
[2013-02-22 05:24:42 -0500] clundquist: so you're thinking that the resources are evaluated in the compilation phase?
[2013-02-22 05:25:45 -0500] yfeldblum: clundquist, no, i'm saying change how the recipe works; when fetching this networking config, don't use resources to fetch it; just fetch it
[2013-02-22 05:25:59 -0500] yfeldblum: clundquist, for example, if it's via HTTP, just use straight-up net/http to fetch it
[2013-02-22 05:26:24 -0500] clundquist: will give that a go
[2013-02-22 05:27:03 -0500] clundquist: thank you
[2013-02-22 05:53:13 -0500] clundquist: yfeldblum: that seems to have worked. Thank you. Now I am left with philosophical questions of why.
[2013-02-22 06:19:48 -0500] threetee: hi everyone, any thoughts on how to best write chefspec/minitest tests for cookbooks that add report handlers with chef_handler?
[2013-02-22 06:20:39 -0500] clundquist: test kitchen 1.0, bats, chef-spec
[2013-02-22 06:21:58 -0500] threetee: clundquist: I'm not familiar with bats
[2013-02-22 06:23:05 -0500] clundquist: well, to be fair, those things don't really answer your question, but they are things you should look at if you are thinking about testings
[2013-02-22 06:23:16 -0500] clundquist: https://github.com/sstephenson/bats
[2013-02-22 06:23:38 -0500] clundquist: jamie / test kitchen 1.0 have plugins for bats and some other things
[2013-02-22 06:24:01 -0500] threetee: https://github.com/opscode/kb-bats
[2013-02-22 06:24:07 -0500] clundquist: that too
[2013-02-22 06:25:30 -0500] threetee: for context, I have a simple recipe that 1) installs prerequisite gems, 2) drops off the handler code, and 3) installs the handler via chef_handler
[2013-02-22 06:25:48 -0500] threetee: 1 and 2 are no problem to test
[2013-02-22 06:25:54 -0500] threetee: I'm just having trouble grokking how to test 3
[2013-02-22 06:30:03 -0500] threetee: I suppose I could use chefspec to check that the handler has been added to the resource list
[2013-02-22 06:31:06 -0500] clundquist: does it make a file on disk?
[2013-02-22 06:31:51 -0500] threetee: no, it makes a call to an external API to report run status
[2013-02-22 06:32:01 -0500] clundquist: hmm
[2013-02-22 06:32:30 -0500] clundquist: then looking for the resource sounds like the best bet
[2013-02-22 06:33:37 -0500] threetee: let's see if chefspec has a generic resource matcher
[2013-02-22 06:34:20 -0500] clundquist: crump is pretty good about pull requests in my experience
[2013-02-22 06:34:23 -0500] clundquist: worst case
[2013-02-22 06:41:15 -0500] threetee: clundquist: thanks for the input
[2013-02-22 06:41:40 -0500] threetee: I bet sethvargo might have something to say about my handler testing question :)
[2013-02-22 06:42:59 -0500] threetee: heh, or not
[2013-02-22 07:19:59 -0500] rava: hey all, anyone know how to make the subversion resource export a single file to a non empty directory?
[2013-02-22 07:24:02 -0500] rava: it keeps checking the directory, seeing it's not empty, and then bails
[2013-02-22 07:24:23 -0500] rava: the force_export action tries to move the file to the path name for some reason
[2013-02-22 07:24:51 -0500] rava: or rather, tries to name it the path given
[2013-02-22 07:33:57 -0500] johnderr: Is there away to query the chef-server for the templates that a cookbook contains from a receipe?
[2013-02-22 09:08:59 -0500] kampfschlaefer: Hello everybody! Can someone here help me with a little chefspec-problem? I want to mock a list of recipes but its not doing what I want...
[2013-02-22 09:17:09 -0500] rava: does an index rebuild affect node attributes?
[2013-02-22 09:17:26 -0500] rava: or rather, the attributes inhereted from environment override attr?
[2013-02-22 09:22:08 -0500] rava: guess not, just did it. trying to monkey out why the node, which is in the right environment, isn't getting the environment attributes
[2013-02-22 09:25:29 -0500] rava: the environment shows hte proper attroibute values in chef, but the node in that environment isn't getting them
[2013-02-22 09:26:09 -0500] rava: any ideas on what to look at after confirming the node is in right env and that the env has said attr?
[2013-02-22 09:34:13 -0500] fooJBar: rava: environment attributes have a relatively low precedence, does the node have the said attributes with the wrong value or is it missing them altogether?
[2013-02-22 09:41:53 -0500] rava: i thought env override attributes were pretty high on the prio list
[2013-02-22 09:42:09 -0500] rava: the value it should be overriding is a default value declared in the attributes/default.rb file
[2013-02-22 09:42:43 -0500] rava: also, dumb ruby newb question, but what does unpack? check?
[2013-02-22 09:45:02 -0500] fooJBar: rava: indeed an override attribute in environment is much stronger than a default one in an attribute file (the lowest)... it should definitely work
[2013-02-22 09:45:20 -0500] fooJBar: rava: unpack in what context?
[2013-02-22 09:45:44 -0500] fooJBar: ::String?
[2013-02-22 10:00:23 -0500] kisoku: anyone have an example cookbook that uses the opscode ohai plugins ?
[2013-02-22 10:05:03 -0500] laurent\: what do you mean ?
[2013-02-22 10:07:52 -0500] kisoku: anything that actually uses the ohai cookbook to ship custom plugins
[2013-02-22 10:08:00 -0500] kisoku: usage examples
[2013-02-22 10:08:15 -0500] laurent\: ah ok
[2013-02-22 10:08:38 -0500] laurent\: sorry i'm a bit a slow, it's a bit early in the morning (11am) ;-)
[2013-02-22 10:12:27 -0500] laurent\: kisoku: have you looked at http://wiki.opscode.com/display/chef/Distributing+Ohai+Plugins ? there's also a very simmple sample here http://wiki.opscode.com/display/chef/Writing+Ohai+Plugins
[2013-02-22 11:05:45 -0500] alex___: hey is it possible to use a function of a other module inside a module
[2013-02-22 11:06:30 -0500] alex___: like test::code.test needs test::coding.testing
[2013-02-22 11:06:35 -0500] alex___: ?
[2013-02-22 11:07:07 -0500] alex___: anybody online ?:P
[2013-02-22 11:12:09 -0500] Aparna: is it possible to have a while loop in chef?
[2013-02-22 11:13:07 -0500] Aparna: Can i call 2 resources back to back based on any condition? or is there some mechanism as GOTO?
[2013-02-22 11:14:19 -0500] Aparna: CAn anybody please help?
[2013-02-22 11:17:00 -0500] Aparna: is it possible to have a conditional loop in chef
[2013-02-22 11:17:57 -0500] smdahlen: Aparna: you can use all the control statements of ruby within your recipes
[2013-02-22 11:22:00 -0500] Aparna: smdahlen: So can i create afile resource in a while loop inside a recipe?
[2013-02-22 11:22:25 -0500] Aparna: smdahlen: Or can i recall a file resource in a while loop?
[2013-02-22 11:22:50 -0500] smdahlen: yes
[2013-02-22 11:26:02 -0500] Aparna: smdahlen: so shall i use ruby block resource or direclty create while loop in my recipe? Could you please provide links to some examples.. that would be great help
[2013-02-22 11:36:07 -0500] Aparna: Can I create a file resource inside a while loop in a recipe ??
[2013-02-22 11:37:59 -0500] a_a_g: Aparna: sure
[2013-02-22 11:40:08 -0500] laurent\: the conditions for the loop will be evaluated at compile time tho. depending on what you really want to achieve it might be tricky. just tell us ! :-)
[2013-02-22 11:41:01 -0500] Aparna: a_a_g: can you please point me to any such example or link?
[2013-02-22 11:41:20 -0500] a_a_g: its just a while loop. like any while loop in ruby
[2013-02-22 11:42:08 -0500] Aparna: actually I am getting compilation error
[2013-02-22 11:42:09 -0500] a_a_g: while <condition>; file "" do  end; end
[2013-02-22 11:42:25 -0500] Aparna: I have created a file resource which creates a batch file
[2013-02-22 11:42:47 -0500] a_a_g: can you post the error on pastebin and give the link here?
[2013-02-22 11:42:49 -0500] Aparna: and tehn an execute resource which executes the batch file
[2013-02-22 11:43:11 -0500] Aparna: and then a while loop which has an if condition and then the execute resource
[2013-02-22 11:43:22 -0500] Aparna: but it is giving compile error
[2013-02-22 11:43:34 -0500] a_a_g: please post your code and the error in pastebin and give is a link here
[2013-02-22 11:43:38 -0500] a_a_g: pastebin.com
[2013-02-22 11:57:26 -0500] Xiol: Do you need to do anything to use LWRPs from another cookbook? I've added it into my depends in metadata.rb but I've done nothing inside the recipe itself?
[2013-02-22 13:42:59 -0500] alex___: hey is it possible to use a function of a other module inside a module
[2013-02-22 13:43:03 -0500] alex___: like test::code.test needs test::coding.testing
[2013-02-22 13:44:31 -0500] Xiol: Answered my own question: you also need to use include_recipe
[2013-02-22 14:35:56 -0500] itwasntandy: hrm. hey
[2013-02-22 14:42:09 -0500] fabiomm: hi all, there's someone active?
[2013-02-22 14:44:13 -0500] fabiomm: can someone help me with a vagrant / chef-solo error?I posted it there http://stackoverflow.com/questions/15025610/provisioning-error-with-vagrant-chef-and-a-veewee-box
[2013-02-22 14:45:07 -0500] cwj: fabiomm: did you remove the existing box of the same name after building your most recent version of the box?
[2013-02-22 14:46:06 -0500] fabiomm: yes 'vagrant destroy' then 'vagrant up'
[2013-02-22 14:46:31 -0500] cwj: e.g. if i have a box file "foo.box" which represents box named "foo" i run "vagrant box add foo.box foo" to add it
[2013-02-22 14:46:51 -0500] fabiomm: yes, i also do that
[2013-02-22 14:46:55 -0500] cwj: but if i rebuild box foo, i have to run "vagrant box remove foo" and then add it again using the new foo.box
[2013-02-22 14:47:33 -0500] fabiomm: yes, i did it
[2013-02-22 14:48:17 -0500] cwj: gist your networking_basic cookbook
[2013-02-22 14:48:30 -0500] fabiomm: i think there's a compatibility problem between chef 10.x and 11.x
[2013-02-22 14:48:47 -0500] fabiomm: ok, wait 1 second :)
[2013-02-22 14:48:50 -0500] cwj: more likely a gem version problem
[2013-02-22 14:49:09 -0500] cwj: the stack trace looks like what people have been seeing with "bad" version of json gem
[2013-02-22 14:49:27 -0500] fabiomm: i used this repo https://github.com/simshaun/vagrant-cookbooks/tree/master/networking_basic
[2013-02-22 14:50:05 -0500] cwj: how is chef installed on your box image?
[2013-02-22 14:50:46 -0500] cwj: e.g. from gems, via omnibus or from distribution packages?
[2013-02-22 14:51:15 -0500] fabiomm: via veewee using this template https://github.com/jedi4ever/veewee/blob/master/templates/ubuntu-12.04.2-server-amd64/postinstall.sh
[2013-02-22 14:51:34 -0500] fabiomm: RUBY_VERSION=1.9.3-p385, RUBY_VERSION=1.9.3-p385
[2013-02-22 14:51:36 -0500] cwj: ok so its installed via gems
[2013-02-22 14:51:41 -0500] cwj: https://github.com/jedi4ever/veewee/blob/master/templates/ubuntu-12.04.2-server-amd64/postinstall.sh#L60
[2013-02-22 14:51:48 -0500] fabiomm: sorry was RubyGems 1.7.2
[2013-02-22 14:52:05 -0500] fabiomm: :)
[2013-02-22 14:52:07 -0500] vilts: How do I tell Omnibus chef11 to use external database, not the one it installs itself? I tried to use override attribs for reconfigure, but didn't seem to work
[2013-02-22 14:52:22 -0500] cwj: fabiomm: ssh into your box and run 'gem list | grep json'
[2013-02-22 14:52:45 -0500] fabiomm: it returns...
[2013-02-22 14:52:46 -0500] fabiomm: vagrant@web-php54-precise:~$ gem list | grep json
[2013-02-22 14:52:47 -0500] fabiomm: json (1.5.4)
[2013-02-22 14:52:48 -0500] fabiomm: json_pure (1.7.7)
[2013-02-22 14:53:06 -0500] cwj: ok, that looks alright
[2013-02-22 14:53:54 -0500] fabiomm: note that if i add the same recipe ('networking_basic') to Vagrantfile, it works fine
[2013-02-22 14:54:04 -0500] fabiomm:  I think that the provisioner doesn't recognize the file networking_basic/attributes/default.rb
[2013-02-22 14:54:28 -0500] fabiomm: and so node['networking']['packages'] results in []
[2013-02-22 14:54:51 -0500] cwj: does your 'vagrant_main' cookbook specify a dependency on the 'networking_basic' cookbook?
[2013-02-22 14:55:10 -0500] cwj: and does your 'vagrant_main' cookbook specify include_recipe 'networking_basic' ?
[2013-02-22 14:55:36 -0500] cwj: you will need to either have both cookbooks in the run list, or have your vagrant_main cookbook depend on and include the networking_basic cookbook
[2013-02-22 14:55:55 -0500] fabiomm: config.vm.provision :chef_solo do |chef|
[2013-02-22 14:55:56 -0500] fabiomm:     chef.cookbooks_path = "cookbooks"
[2013-02-22 14:55:56 -0500] fabiomm:     chef.add_recipe "vagrant_main"
[2013-02-22 14:55:57 -0500] fabiomm: end
[2013-02-22 14:56:23 -0500] cwj: thats not really germane to what im asking
[2013-02-22 14:56:43 -0500] cwj: cookbooks have a metadata.rb which is used to specify dependencies
[2013-02-22 14:56:57 -0500] cwj: and your vagrant_main is trying to access attributes which are set up in networking_basic
[2013-02-22 14:56:58 -0500] fabiomm: ok, so I need to check metadata.rb?
[2013-02-22 14:57:04 -0500] cwj: but networking_basic is not in your run list
[2013-02-22 14:57:45 -0500] fabiomm: i think no
[2013-02-22 14:58:02 -0500] fabiomm: there is the vagrant_main recipe: https://github.com/simshaun/vagrant-cookbooks/tree/master/vagrant_main
[2013-02-22 14:58:04 -0500] cwj: you need to either a) include both cookbooks in your run list, or b) configure your vagrant_main cookbook to depend on networking_basic and use include_recipe "networking_basic" in its default recipe
[2013-02-22 14:58:34 -0500] cwj: and if "vagrant_main" is going to fail without "networking_basic", i would recommend the latter course of action
[2013-02-22 14:59:42 -0500] fabiomm: but 'networking_basic' is required by vagrant_main/recipe/default.rb (https://github.com/simshaun/vagrant-cookbooks/blob/master/vagrant_main/recipes/default.rb#L10)
[2013-02-22 15:00:55 -0500] cwj: ok, the stack traces you've provided indicate that 'require_recipe' is depreciated, maybe it doesnt work in chef 11?
[2013-02-22 15:01:01 -0500] cwj: include_recipe does work
[2013-02-22 15:01:31 -0500] fabiomm: i tried it, but it doesn't work
[2013-02-22 15:01:37 -0500] cwj: ive never used 'require_recipe' so i dont know how it differs from 'include_recipe'
[2013-02-22 15:01:42 -0500] leifmadsen: even in Chef 10 I've seen that require_recipe is deprecated and that you should just use include_recipe
[2013-02-22 15:01:51 -0500] leifmadsen: the metadata also requires the appropriate "depends"
[2013-02-22 15:01:53 -0500] fabiomm: ok, i changed it
[2013-02-22 15:01:54 -0500] leifmadsen: depend*
[2013-02-22 15:02:02 -0500] cwj: [2013-02-22T13:10:03+00:00] INFO: Run List expands to [vagrant_main]
[2013-02-22 15:02:10 -0500] cwj: er mis paste
[2013-02-22 15:02:28 -0500] fabiomm: you're right but how can i specify this dependance?
[2013-02-22 15:02:36 -0500] jtimberman: don't use require_recipe, use include_recipe
[2013-02-22 15:02:58 -0500] cwj: https://github.com/simshaun/vagrant-cookbooks/tree/master/vagrant_main << i dont see a metadata.rb
[2013-02-22 15:03:02 -0500] fabiomm: now I'm using include_ but, it doesn't work
[2013-02-22 15:03:10 -0500] cwj: so it seems like it would fail to include_recipe
[2013-02-22 15:03:36 -0500] cwj: or maybe not since you are using solo and it has all the recipes ahead of time
[2013-02-22 15:04:52 -0500] cwj: sorry, i dunno
[2013-02-22 15:04:54 -0500] cwj: gotta commute :)
[2013-02-22 15:05:04 -0500] fabiomm: :)
[2013-02-22 15:05:15 -0500] ralphie: warning this is a newbie talking
[2013-02-22 15:05:27 -0500] jtimberman: node['networking']['packages'] - node['networking'] is nil.
[2013-02-22 15:05:39 -0500] ralphie: can anyone tell me what the best way is in a recipe to copy a folder on a client to a different location
[2013-02-22 15:05:43 -0500] fabiomm: yes, sorry, i'm a newbie
[2013-02-22 15:05:52 -0500] ralphie: not remote, just normal fs on the client
[2013-02-22 15:06:16 -0500] jtimberman: undefined method `[]' for nil:NilClass
[2013-02-22 15:06:17 -0500] ralphie: is it just to use plain ruby or bash or is there something more suffisicated
[2013-02-22 15:06:44 -0500] fabiomm: jtimberman: i know, but i don't know how to fix it
[2013-02-22 15:07:00 -0500] jtimberman: Ruby tried to send the [] method to the object. in this case the object is likely node['networking'], which should be a Mash (node attribute hashes are mashes).
[2013-02-22 15:07:32 -0500] jtimberman: i believe if you do VAGRANT_LOG=INFO vagrant up
[2013-02-22 15:07:43 -0500] jtimberman: it will run chef with debug output
[2013-02-22 15:08:21 -0500] fabiomm: yes, i got the debug output
[2013-02-22 15:08:25 -0500] jtimberman: ok :)
[2013-02-22 15:08:31 -0500] jtimberman: did you gist that anywhere?
[2013-02-22 15:08:59 -0500] fabiomm: i can do it, wait one second :)
[2013-02-22 15:10:30 -0500] jtimberman: cool, brb
[2013-02-22 15:12:39 -0500] fabiomm: jtimberman: done, https://gist.github.com/morafabio/fb6c19807ceecb9989cf
[2013-02-22 15:19:43 -0500] geekbri: If you set an attribute in an attributes file to a hash, and then you set that attribute equal to a different hash in a role file, does it deep merge those hashes or does the hash in the role file overwrite the hash in the attributes file
[2013-02-22 15:22:57 -0500] jtimberman: fabiomm: that's not debug output, i mean rerunning chef with -l debug
[2013-02-22 15:25:21 -0500] fabiomm: hmm should be this? https://gist.github.com/morafabio/fb6c19807ceecb9989cf#file-vagrant-provision_log-info
[2013-02-22 15:26:19 -0500] jtimberman: that's info-level logs.
[2013-02-22 15:26:22 -0500] jtimberman: vagrant ssh
[2013-02-22 15:26:30 -0500] fabiomm: ok
[2013-02-22 15:26:32 -0500] fabiomm: done
[2013-02-22 15:26:49 -0500] jtimberman: then: sudo chef-solo -c /tmp/vagrant-chef-1/chef-solo-1/solo.rb -j /tmp/vagrant-chef-1/chef-solo-1/dna.json
[2013-02-22 15:26:52 -0500] jtimberman: er
[2013-02-22 15:26:54 -0500] jtimberman: then: sudo chef-solo -c /tmp/vagrant-chef-1/chef-solo-1/solo.rb -j /tmp/vagrant-chef-1/chef-solo-1/dna.json -l debug
[2013-02-22 15:27:49 -0500] fabiomm: is out of scope, can i try /opt/ruby/bin/chef-solo?
[2013-02-22 15:28:41 -0500] geekbri: Question: With chef11 is there a way to get my output from Chef::Log to appear within a normal run.  As in I want it to always show up and not just when i do chef-client -l info
[2013-02-22 15:28:58 -0500] jtimberman: wherever the chef-solo program is
[2013-02-22 15:29:20 -0500] fabiomm: ok, should be
[2013-02-22 15:29:21 -0500] fabiomm: root@web-php54-precise:~# sudo /opt/ruby/bin/chef-solo -c /tmp/vagrant-chef-1/chef-solo-1/solo.rb -j /tmp/vagrant-chef-1/chef-solo-1/dna.json -l debug
[2013-02-22 15:29:30 -0500] jtimberman: sure :)
[2013-02-22 15:29:31 -0500] ashp: this opswork thing is kind of neat
[2013-02-22 15:29:36 -0500] ashp: my first real chef exposure
[2013-02-22 15:29:39 -0500] jtimberman: ashp: yeah :)
[2013-02-22 15:30:29 -0500] ashp: jtimberman: We were looking at beanstalk before so this is the alternative for us
[2013-02-22 15:30:47 -0500] fabiomm: jtimberman: here's the output https://gist.github.com/morafabio/fb6c19807ceecb9989cf#file-chef-solo-on-vm
[2013-02-22 15:30:49 -0500] jtimberman: ashp: i've not used beanstalk
[2013-02-22 15:31:21 -0500] jtimberman: ahhh yep
[2013-02-22 15:32:35 -0500] fabiomm: i think that i need a way to include networking_basic's attribute file
[2013-02-22 15:32:45 -0500] jtimberman: fabiomm: https://gist.github.com/jtimberman/ca2f062095471689438d
[2013-02-22 15:32:58 -0500] fabiomm: but it's my first time with chef
[2013-02-22 15:33:31 -0500] fabiomm: ok, so i need to copy the metadata file
[2013-02-22 15:33:44 -0500] jtimberman: yeah, create that metadata.rb file
[2013-02-22 15:33:49 -0500] jtimberman: with the content in that gist
[2013-02-22 15:34:06 -0500] jtimberman: in earlier versions of chef, the components of cookbooks were loaded in a nondeterministic order. which meant that attributes weren't loaded and available when they were often expected, which was "run list" order.
[2013-02-22 15:34:10 -0500] jtimberman: so we fixed that
[2013-02-22 15:34:33 -0500] jtimberman: but the side effect of fixing that is you need to ensure that the dependencies are declared properly for all the cookbooks you're using in each one.
[2013-02-22 15:34:54 -0500] geekbri: I would argue a positive side effect :)
[2013-02-22 15:35:19 -0500] jtimberman: http://tickets.opscode.com/browse/CHEF-2903
[2013-02-22 15:35:20 -0500] jtimberman: Yes.
[2013-02-22 15:35:25 -0500] fabiomm: ohh hooray :)
[2013-02-22 15:35:30 -0500] jtimberman: in chef-solo
[2013-02-22 15:35:38 -0500] fabiomm: it works!
[2013-02-22 15:35:39 -0500] fabiomm: [2013-02-22T15:34:39+00:00] FATAL: Chef::Exceptions::CookbookNotFound: Cookbook openssl not found. If you're loading openssl from another cookbook, make sure you configure the dependency in your metadata
[2013-02-22 15:35:40 -0500] jtimberman: you have to put all the cookbooks you need on the system running chef
[2013-02-22 15:35:49 -0500] fabiomm: almost it runs :)
[2013-02-22 15:35:50 -0500] jtimberman: fabiomm: well, now you need the openssl cookbook :)
[2013-02-22 15:36:00 -0500] fabiomm: that's another story
[2013-02-22 15:36:06 -0500] fabiomm: i can deal with it :D
[2013-02-22 15:36:09 -0500] jtimberman: so solo in the past didn't require dependencies be declared. now it does.
[2013-02-22 15:36:10 -0500] fabiomm: alone
[2013-02-22 15:36:12 -0500] fabiomm: thanks!
[2013-02-22 15:36:18 -0500] fabiomm: really!
[2013-02-22 15:36:29 -0500] jtimberman: which is annoying to some people because the dependency resolution is generally chef client/server side
[2013-02-22 15:36:45 -0500] fabiomm: you're great!
[2013-02-22 15:36:50 -0500] jtimberman: but it does make cookbooks more sharable for others who don't want to use solo :)
[2013-02-22 15:36:56 -0500] jtimberman: cwj got you on the right track :)
[2013-02-22 15:37:12 -0500] jtimberman: i remember him saying something about metadata :)
[2013-02-22 15:37:13 -0500] fabiomm: i understand
[2013-02-22 15:38:17 -0500] fabiomm: jtimberman: really thx! i leave, goodbye!
[2013-02-22 15:39:25 -0500] jtimberman: fabiomm: i'll post an answer on the stackoverflow question so others can benefit :)
[2013-02-22 15:39:54 -0500] fabiomm: i'll up vote and confirm you
[2013-02-22 15:41:02 -0500] fabiomm: bye!
[2013-02-22 15:43:39 -0500] jtimberman: :D
[2013-02-22 15:43:40 -0500] jtimberman: cheers
[2013-02-22 15:56:25 -0500] ashp: Hmm, this opswork thing is confusing.  I don't see how you provide custom attributes at all :/
[2013-02-22 15:57:16 -0500] ashp: oh a custom json file
[2013-02-22 15:57:39 -0500] johnderr: Good morning All. I want to query the Chef server in a recipe to determine whether it contains a template (.erb file) but have not found an easy way to do this. Do you know where I should look to do something like this?
[2013-02-22 16:02:45 -0500] johnderr: anybody out there ..
[2013-02-22 16:03:11 -0500] qhartman: johnderr, Is it a template in a cookbook on the running node? If so, you could look in /var/chef/cache
[2013-02-22 16:03:46 -0500] qhartman: otherwise, I don't think there is an easy way to do that. In my experience, that just not a thing tha tone does.
[2013-02-22 16:03:59 -0500] johnderr: @qhartman I don't want to check the node itself, I need to check the server.
[2013-02-22 16:04:11 -0500] qhartman: where is this template stored?
[2013-02-22 16:04:52 -0500] johnderr: In the templates directory of the cookbook
[2013-02-22 16:05:07 -0500] qhartman: well, if it gets copied down to the node that implies it's on the server, if it does not, that implies it is not on the server
[2013-02-22 16:05:56 -0500] qhartman: Yeah, I don't know of a way to do what you are trying to do directly. What problem are you trying to actually solve by doing this? Maybe there's another more direct way.
[2013-02-22 16:05:57 -0500] kallistec: qhartman: templates are fetched lazily so you won't necessarily have it even if it's available
[2013-02-22 16:06:07 -0500] johnderr: By the time that it is copied down, it is too late to query it in the recipe.
[2013-02-22 16:06:35 -0500] kallistec: there's a way to look in the run_context for the cookbook collection and poke around in there
[2013-02-22 16:07:42 -0500] kallistec: but generally I'd recommend switching on some other piece of data to decide whether to use a template or not
[2013-02-22 16:07:45 -0500] johnderr: I have multiple templates that I want to choose from a cookbook, but if none of them are available, I want to pick a default template
[2013-02-22 16:12:50 -0500] qhartman: In this case I'd be inclined to store the templates outside the cookbook in some other remote source that you can poke around with more easily, keeping only the default in the cookbook.
[2013-02-22 16:13:33 -0500] qhartman: or as kallistec pointed out, use some other info to decide which template to use, not just existence.
[2013-02-22 16:15:40 -0500] jtimberman: ashp: yeah it's really focused around a chef-solo workflow.
[2013-02-22 16:16:12 -0500] ashp: jtimberman: We're just experimenting, primarily we want all the autoscaling nonsense and a switch to playing with chef is just a side benefit
[2013-02-22 16:17:07 -0500] jtimberman: :)
[2013-02-22 16:30:42 -0500] mattupstate: anyone familiar with the nagios cookbook? wondering how to start using a plugin on a client
[2013-02-22 16:32:51 -0500] drrk: my boss is but he's just disappeared
[2013-02-22 16:33:50 -0500] ashp: in related news drrk just got promoted to be the manager and do you mind if he burns this shovel out back?
[2013-02-22 16:34:18 -0500] drrk: lol
[2013-02-22 16:36:14 -0500] drrk: trilitheus: <- my bosss
[2013-02-22 16:38:10 -0500] trilitheus: mattupstate, i believe you were asking about nagios?
[2013-02-22 16:40:07 -0500] mattupstate: trilitheus: yeah, i'm just curious what the steps are to get a plugin working on a client
[2013-02-22 16:40:53 -0500] ashp: OK, this is probably an idiot question but I assume if I have a cookbook s3fs-fuse i have to call it that in my git repo? the default was cookbook-s3fs-fuse
[2013-02-22 16:41:01 -0500] ashp: and i wasn't sure if that was convention and it would look in the right place
[2013-02-22 16:41:45 -0500] mattupstate: i added the plugin into the files/plugins folder and updated the nagios_services data bag
[2013-02-22 16:42:32 -0500] mattupstate: ran chef-client on the server, do i then need to add the check on the client?
[2013-02-22 16:42:55 -0500] trilitheus: have you set the server up as in the readme in the monitoring role?
[2013-02-22 16:43:04 -0500] mattupstate: the server is up and running fine
[2013-02-22 16:43:06 -0500] trilitheus: and is the client in the same environment as the server?
[2013-02-22 16:43:27 -0500] mattupstate: the client is communicating fine with the default services
[2013-02-22 16:43:46 -0500] trilitheus: ah OK - so you have default services monitored fine - its just a custom check you are trying to add?
[2013-02-22 16:43:52 -0500] mattupstate: yeah
[2013-02-22 16:44:30 -0500] trilitheus: OK - on your server, in /etc/nagios3/conf.d/services, any services you add via the nagios_services data bag should appear at the bottom
[2013-02-22 16:44:37 -0500] trilitheus: has it appeared there?
[2013-02-22 16:46:47 -0500] mattupstate: yup
[2013-02-22 16:46:54 -0500] trilitheus: ok
[2013-02-22 16:47:01 -0500] trilitheus: one sec
[2013-02-22 16:47:20 -0500] mattupstate: no sweat
[2013-02-22 16:48:23 -0500] trilitheus: can you pastebin/gist your services.cfg from "# Services defined by data bags" onwards
[2013-02-22 16:49:53 -0500] mattupstate: http://pastebin.com/K0XT3yVk
[2013-02-22 16:50:43 -0500] trilitheus: OK, that looks spot on to me - is your client in the api-webapp hostgroup?
[2013-02-22 16:50:51 -0500] mattupstate: yup
[2013-02-22 16:52:28 -0500] trilitheus: ok - so is the check showing up against the node at all?
[2013-02-22 16:52:33 -0500] trilitheus: in nagios gui
[2013-02-22 16:52:40 -0500] geekbri: in chef11 if you use node['blah'] in your attributes file, that now is the calculated attribute AFTER roles right?
[2013-02-22 16:52:43 -0500] mattupstate: yes
[2013-02-22 16:52:50 -0500] trilitheus: and what is the result?
[2013-02-22 16:53:14 -0500] mattupstate: `CRITICAL: Could not get status of api-webapp`
[2013-02-22 16:53:33 -0500] trilitheus: ok, the check works if you run it manually on the client?
[2013-02-22 16:53:34 -0500] mattupstate: the check command is using a python script to get info from supervisorctl
[2013-02-22 16:53:38 -0500] mattupstate: yup
[2013-02-22 16:53:57 -0500] trilitheus: ok so it is defined to be checked on the server - it is in the correct location and runs on the client
[2013-02-22 16:54:22 -0500] trilitheus: last piece of the puzzle is.... is the check defined in /etc/nagios/nrpe.conf on the client
[2013-02-22 16:54:23 -0500] Xiol: How can you use an SSH key with a passphrase on it with 'knife ssh'? When I run knife ssh, it prompts me for the key passphrase once for every node I'm connecting to, all at the same time?
[2013-02-22 16:54:42 -0500] mattupstate: does the plugin need to be on the client or just the server?
[2013-02-22 16:55:11 -0500] trilitheus: the plugin needs to be on the client
[2013-02-22 16:56:08 -0500] jtimberman: trilitheus: have you by chance used the jtimberman/v4 branch of the nagios cookbook? :)
[2013-02-22 16:56:35 -0500] trilitheus: jtimberman, no - I think I'm just using the offical opscode one
[2013-02-22 16:56:52 -0500] mattupstate: trilitheus: its not in npre.conf, i assumed i need to use nagios_nrpecheck LWRP
[2013-02-22 16:57:05 -0500] mattupstate: and i added that to my app's deploy recipe
[2013-02-22 16:58:22 -0500] trilitheus: mattupstate, let me try to add a new check and see what happens
[2013-02-22 16:58:30 -0500] Doc_X: is there an easy way to get readable json output using shef?  "require 'json'" doesn't seem to be helping, even after i alter $LOAD_PATH to point to the right location(s)
[2013-02-22 16:59:01 -0500] trilitheus: jtimberman, are there major differences?  have you got a link?
[2013-02-22 16:59:05 -0500] jtimberman: trilitheus: the released one on the site you mean/
[2013-02-22 16:59:18 -0500] jtimberman: https://github.com/opscode-cookbooks/nagios/tree/jtimberman/v4
[2013-02-22 17:00:25 -0500] trilitheus: ah - im using http://community.opscode.com/cookbooks/nagios
[2013-02-22 17:00:45 -0500] trilitheus: https://github.com/opscode-cookbooks/nagios
[2013-02-22 17:01:41 -0500] mattupstate: feel like this is a bit nuanced
[2013-02-22 17:01:43 -0500] mattupstate: he
[2013-02-22 17:01:46 -0500] mattupstate: oops
[2013-02-22 17:01:57 -0500] trilitheus: is jtimberman/v4 the default branch?  I'm pretty new to git and chef
[2013-02-22 17:08:07 -0500] trilitheus: hey mattupstate, sorry, check_api_application, how is it defined on the nagios server in /etc/nagios3/conf.d/commands.cfg
[2013-02-22 17:09:48 -0500] mattupstate: i followed the cookbook readme
[2013-02-22 17:10:22 -0500] mattupstate: looks like so: http://pastebin.com/GZx1B6AZ
[2013-02-22 17:10:39 -0500] mattupstate: nevermind the -p arg
[2013-02-22 17:10:57 -0500] mattupstate: i just tried changing it to the full path
[2013-02-22 17:11:46 -0500] mattupstate: and i just realized there's a declaration on the client's nrpe.conf file that includes files in /etc/nagios/nrpe.d folder
[2013-02-22 17:13:51 -0500] trilitheus: yeah, what that will do is run the command check_supervisord.py on the nagios server, which I'm sure you know,  and you said you had copied it to tghe /usr/lib/nagios/plugins folder on the nagios server?
[2013-02-22 17:14:07 -0500] mattupstate: i added it to the cookbooks files
[2013-02-22 17:14:16 -0500] mattupstate: and the server recipe uploads them
[2013-02-22 17:15:27 -0500] trilitheus: ah, cool, OK
[2013-02-22 17:15:59 -0500] trilitheus: So, another question sorry, when the python script runs, should it run on the nagios server, or should it run on the nagios client?
[2013-02-22 17:16:12 -0500] mattupstate: client
[2013-02-22 17:16:16 -0500] mattupstate: i think i'm onto it now
[2013-02-22 17:16:24 -0500] trilitheus: ok - the way you have it set up is to run on the server
[2013-02-22 17:17:00 -0500] trilitheus: you need to change your change the data bag
[2013-02-22 17:17:07 -0500] trilitheus: can you past that and I'll look and paste back?
[2013-02-22 17:18:06 -0500] trilitheus: but basically, I think in your data bag, your command_line should read along the lines of
[2013-02-22 17:18:32 -0500] trilitheus: "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_api_application"
[2013-02-22 17:19:17 -0500] mattupstate: ohhhh
[2013-02-22 17:19:20 -0500] mattupstate: it looks like this http://pastebin.com/YvH8cn8r
[2013-02-22 17:19:25 -0500] mattupstate: thats not very obvious
[2013-02-22 17:20:01 -0500] trilitheus: no :)
[2013-02-22 17:20:22 -0500] mattupstate: ha
[2013-02-22 17:20:32 -0500] mattupstate: i also don't know a whole lot about nagios yet
[2013-02-22 17:20:34 -0500] mattupstate: so that doesn't help
[2013-02-22 17:20:47 -0500] mattupstate: that makes sense now though
[2013-02-22 17:22:08 -0500] trilitheus: mattupstate, hope I've helped and not made it worse lol
[2013-02-22 17:22:42 -0500] mattupstate: not at all, thanks for taking the time
[2013-02-22 17:22:57 -0500] trilitheus: np
[2013-02-22 17:29:29 -0500] r3vamp: Is it completely bonkers to turn my roles into wrapper cookbooks? I'm at the point where I need to be able to version my roles (similar to my cookbooks) for integration/production. Does anyone have alternate solutions to this?
[2013-02-22 17:33:41 -0500] abetterlie:  That's actually a pretty popular sentiment
[2013-02-22 17:33:51 -0500] mattupstate: trilitheus: i've verified is running on the client now, thanks again
[2013-02-22 17:34:35 -0500] abetterlie: r3vamp: reset loves talking about that.
[2013-02-22 17:35:21 -0500] abetterlie: r3vamp: http://realityforge.org/code/2012/11/19/role-cookbooks-and-wrapper-cookbooks.html
[2013-02-22 17:35:45 -0500] r3vamp: It just seems odd, it'd be great to have roles versioned like cookbooks and have environments have role version constraints
[2013-02-22 17:36:28 -0500] jtimberman: trilitheus: it's not the default branch, it's what will become the master branch as soon as i finish testing ALLTHETHINGS :)
[2013-02-22 17:36:30 -0500] r3vamp: abetterlie: Ah that looks great, thank you
[2013-02-22 17:36:41 -0500] jtimberman: and it will be released as version 4.
[2013-02-22 17:37:31 -0500] jtimberman: mhalligan: this is a little higher bandwidth than tweeting :)
[2013-02-22 17:37:59 -0500] abetterlie: r3vamp: no problem. One thing that is suggested is that if you work in a big environment with lots of people touching your chef stuff, put the wrapper cookbook into a role 'for claritys sake', or just pretend they don't exist at all.
[2013-02-22 17:37:59 -0500] jtimberman: mhalligan: so the sensu plugins, are you distributing them with the upstream sensu cookbook, or are they in a custom cookbook?
[2013-02-22 17:38:52 -0500] r3vamp: abetterlie:  So the role just points at the cookbook, and that role should NEVER change. When wanting to make changes to the "role" you update the wrapper cookbook?
[2013-02-22 17:39:17 -0500] mhalligan: jtimberman: they're in a custom cookbok
[2013-02-22 17:39:52 -0500] abetterlie: r3vamp: Exactly right.
[2013-02-22 17:40:20 -0500] r3vamp: abetterlie: I like that as well, might be a better transition from I already have. Thanks for your  input!
[2013-02-22 17:40:22 -0500] mhalligan: plus the whole berks install && berks upload process is super slow, and gets in my way when I'm trying to iterate quickly
[2013-02-22 17:40:45 -0500] mhalligan: skipping syntax checking on the upload seems to save me about a minute.. which means a lot when I do it 30 times in a day while goofing with stuff.
[2013-02-22 17:43:22 -0500] r3vamp: abetterlie: Think I could do a similar thing for data bags? Have a wrapper cookbook?
[2013-02-22 17:45:04 -0500] abetterlie: I haven't tried that yet, as I don't use data bags too frequently.
[2013-02-22 17:46:02 -0500] jtimberman: mhalligan: how about making the plugins a tar.gz that you deliver with cookbook_file and then untar it?
[2013-02-22 17:46:11 -0500] jtimberman: mhalligan: so there aren't a bunch of ruby files in the dir to syntax check
[2013-02-22 17:46:58 -0500] mhalligan: hrm I guess that could work
[2013-02-22 17:47:24 -0500] mhalligan: that's a different type of lazy too. the right thing would probably be to distribute them with chef as files so that they're tracked resources.
[2013-02-22 17:47:33 -0500] mhalligan: which is in v02 of this setup
[2013-02-22 17:48:00 -0500] jtimberman: https://gist.github.com/jtimberman/a1569b4cc0db928fd950
[2013-02-22 17:48:14 -0500] jtimberman: :)
[2013-02-22 17:48:23 -0500] jtimberman: optionally add a -C /path/to/where/sensu/plugins/go
[2013-02-22 17:48:44 -0500] jtimberman: gotta run, prepping for a LIVE DEMO
[2013-02-22 17:51:18 -0500] mhalligan: tech recruiters are lame. http://www.reddit.com/r/recruiting/comments/1914cp/deceitful_tech_recruiting_pitch_of_the_day_from/
[2013-02-22 17:52:01 -0500] mhalligan: hah thanks for the snippet. I feel like I've done something wrong whenever I use an exec, so I'll just bite the bullet and turn these all into tracked files.
[2013-02-22 17:53:53 -0500] atomic-penguin: mhalligan, I've only had one good experience with one headhunter.
[2013-02-22 17:54:50 -0500] mhalligan: that's one more than me
[2013-02-22 17:55:04 -0500] atomic-penguin: mhalligan, they happened to be a local IT contract company, and I was in-between jobs.  I was floored when I found out they were local.
[2013-02-22 17:55:11 -0500] mhalligan: where is local?
[2013-02-22 17:55:23 -0500] atomic-penguin: For me, Charleston, WV
[2013-02-22 17:55:43 -0500] atomic-penguin: CDI was the company
[2013-02-22 17:55:55 -0500] cTIDE: how do i root out a problem where i've deleted a node from the web UI, but i still get 403 errors when trying to create a new node with that name?
[2013-02-22 17:56:12 -0500] paulmooring: cTIDE: did you delete the client too?
[2013-02-22 17:56:14 -0500] mhalligan: aye. is there much of a tech industry in WV?
[2013-02-22 17:56:22 -0500] atomic-penguin: mhalligan, no
[2013-02-22 17:56:30 -0500] cTIDE: ah
[2013-02-22 17:56:34 -0500] mhalligan: :(
[2013-02-22 17:56:35 -0500] cTIDE: is there a command that kills both the node and the client?
[2013-02-22 17:56:44 -0500] cTIDE: vs. knife node delete?
[2013-02-22 17:57:40 -0500] paulmooring: cTIDE: I just use bash aliases around `knife node delete $NODE_NAME -y && knife client delete $NODE_NAME -y`
[2013-02-22 17:57:45 -0500] cTIDE: ok, cool
[2013-02-22 17:57:47 -0500] cTIDE: thanks
[2013-02-22 18:00:06 -0500] mhalligan: what's a good way to manage gem requirements in cookbooks?
[2013-02-22 18:22:56 -0500] mconigliaro: ok, how do i tell chef to NOT deep merge an array?
[2013-02-22 18:23:16 -0500] mconigliaro: i don't want to append, i want to overwrite the whole thing
[2013-02-22 18:28:52 -0500] robbkidd: How can I set an environment variable during a service start? Trying to set my Rails app's Resque workers to run. I'm using an Upstart job that look like http://jasonroelofs.com/2012/03/12/manage-and-monitor-resque-with-upstart-and-monit/  Need to loop through n 1..num_workers and set ID=n for the job start.
[2013-02-22 18:30:04 -0500] Litex1: mconigliaro: I think the way to handle that is to empty the array before you override it.
[2013-02-22 18:30:22 -0500] mconigliaro: Litex: yeah, that's what i trying now
[2013-02-22 18:30:31 -0500] Litex: (This was discussed on a recent Food Fight Show, I haven't actually had to do it myself yet)  :)
[2013-02-22 18:38:38 -0500] dopacki: ohai.. trying to install chef-server omnibus 11.0.6 on ubuntu 12.04LTS, inside EC2. All of the install feedback is green, but verify-system status is failing when it gets a 500 error back from curl -sf http://localhost:8000/_status. I don't see anything obvious in the logs. Any suggestions?
[2013-02-22 18:59:07 -0500] jtgiri_: I noticed that knife-spork has easy way to bump the cookbook version, is there a plugin which automatically pushes the code to git when you upload a cookbook ?
[2013-02-22 18:59:18 -0500] ashp: Argh so close.  This s3fs fuse cookbook fails when run via chef but lets me mount things by hand so I can't work out what it's doing. :(
[2013-02-22 19:00:33 -0500] ashp: before I do anything crazy can anyone see anything obviously bad in http://fpaste.org/RNuP/
[2013-02-22 19:00:57 -0500] ashp: line 3 in that paste is actually the default.rb:26 it complains about
[2013-02-22 19:01:07 -0500] ashp: if I mount s3fs#edx-mktg-sandbox-files by hand it's happy
[2013-02-22 19:06:01 -0500] miah: why ## ?
[2013-02-22 19:06:07 -0500] miah:       device "s3fs##{dir_info[:bucket]}"
[2013-02-22 19:06:23 -0500] miah: try, device "s3fs#{ dir_info[:bucket }"
[2013-02-22 19:06:45 -0500] ashp: On the command line you actually mount it as s3fs#blah
[2013-02-22 19:06:47 -0500] miah: or does the mount _require_ a # ?
[2013-02-22 19:06:49 -0500] ashp: so they needed the ## to get it working
[2013-02-22 19:06:50 -0500] miah: ah
[2013-02-22 19:07:02 -0500] ashp: I'm just using some guys s3fs module, so I'm probably using it wrong somehow, first time using chef
[2013-02-22 19:07:09 -0500] ashp: https://github.com/chrisroberts/cookbook-s3fs-fuse this one
[2013-02-22 19:07:24 -0500] miah: hrm. that actually does work
[2013-02-22 19:07:36 -0500] spox: :)
[2013-02-22 19:07:40 -0500] barefoot: is it possible to include attributes from another role? Dont want to include it because of the run_list, guess I could break them out a bit further
[2013-02-22 19:07:42 -0500] ashp: the error is just odd, chef doesn't see the device but I can
[2013-02-22 19:10:12 -0500] miah: that code is funky
[2013-02-22 19:10:25 -0500] miah: it sets ['s3fs-fuse'][:mounts] to a array by default
[2013-02-22 19:10:28 -0500] miah: then does hash checks
[2013-02-22 19:10:48 -0500] miah: so, how are you setting your attribute for node.s3fs-fuse.mounts ?
[2013-02-22 19:12:18 -0500] spox: miah: it's just allowing a hash to be defined, but it expects an array
[2013-02-22 19:12:21 -0500] spox: an array of hashes
[2013-02-22 19:14:38 -0500] spox: hrm chef 0.9?
[2013-02-22 19:15:23 -0500] miah: https://github.com/chrisroberts/cookbook-s3fs-fuse/blob/master/recipes/default.rb#L7
[2013-02-22 19:15:35 -0500] miah: i hope nobody has duplicate entries in their array of mounts
[2013-02-22 19:17:25 -0500] spox: i'm sure they would find out quickly if they did
[2013-02-22 19:18:36 -0500] spox: ashp: you said a manual mount worked successfully?
[2013-02-22 19:18:46 -0500] ashp: spox: yes
[2013-02-22 19:18:54 -0500] ashp: i am just trying a different, slightly more simple, module
[2013-02-22 19:19:04 -0500] ashp: I was passing in the node.s3fs-fuse.mounts via a json in this opswork console
[2013-02-22 19:19:19 -0500] ashp: I am trying one called just s3fs which internally seems to be much more simple
[2013-02-22 19:19:48 -0500] miah: opsworks.. ya. good luck.
[2013-02-22 19:20:05 -0500] ashp: I dunno, it's definitely nicer than elastic beanstalk!
[2013-02-22 19:20:13 -0500] ashp: plus it's like a gentle intro to chef
[2013-02-22 19:20:33 -0500] ashp: I wanted it for the autoscaling and all the other automation built in, and because getting my coworkers into puppet was bad enough, yet alone real ruby in chef
[2013-02-22 19:25:40 -0500] dopacki: has anyone been able to get 11.0.6 server to install and work?
[2013-02-22 19:26:30 -0500] panque: dopacki: i managed to install it and get it working, but it wasn't easy
[2013-02-22 19:26:57 -0500] dopacki: did you encounter the 500 / internal server error I am seeing with the health check stuff?
[2013-02-22 19:27:01 -0500] dopacki: and nothing in the logs?
[2013-02-22 19:27:17 -0500] dopacki: I basically just followed the two step directions and it blow-ed up
[2013-02-22 19:27:31 -0500] dopacki: maybe I'll try 11.0.4 and see if it works better
[2013-02-22 19:28:18 -0500] panque: dopacki: nope, didn't see that
[2013-02-22 19:28:56 -0500] dopacki: yeah, the omnibus install shows all green until the validation step.. then fails when it gets an internal server error back from the health check service
[2013-02-22 19:29:13 -0500] dopacki: no obvious errors in the logs. lulzy
[2013-02-22 19:29:50 -0500] panque: dopacki: did you have a another chef server installation? chef 10.x?
[2013-02-22 19:29:58 -0500] dopacki: nope
[2013-02-22 19:30:12 -0500] dopacki: that's a fresh, vanilla 12.04LTS ec2 instance
[2013-02-22 19:30:32 -0500] spox: hrm, i just did two fresh installs yesterday with no issues
[2013-02-22 19:30:58 -0500] dopacki: I'll flatten and try again.. but 10.x looks like the money release for now
[2013-02-22 19:32:07 -0500] spox: are you bootstrapping things with latest chef-server cookbook + solo or doing a direct package install?
[2013-02-22 19:32:19 -0500] dopacki: using dpkg -i
[2013-02-22 19:32:55 -0500] dopacki: omnibus install, then running sudo chef-server-ctl reconfigure
[2013-02-22 19:33:02 -0500] spox: maybe that's the difference then? i've been bootstrapping with solo and have not been seeing any issues.
[2013-02-22 19:33:28 -0500] dopacki: cool. just weird that it throws no errors, then blows up
[2013-02-22 19:33:40 -0500] spox: yeah
[2013-02-22 19:34:11 -0500] timsmith: jtimberman:  Thanks for merging that nagios fix before the pitchforks came out
[2013-02-22 19:35:46 -0500] jubilo: all this conversation makes me wonder what the official stable release is vs what people are actually using when installing for the first time.
[2013-02-22 19:36:55 -0500] jtimberman: timsmith: lol
[2013-02-22 19:36:58 -0500] jtimberman: the syntax one?
[2013-02-22 19:37:18 -0500] jtimberman: or the ssl one?
[2013-02-22 19:37:23 -0500] jubilo: and why the opscode site doesn't explicitly list just plain old Chef on their products page.
[2013-02-22 19:38:38 -0500] miah: jubilo: they do. its called 'open source chef'
[2013-02-22 19:39:16 -0500] jubilo: well, currently if you go to opscode.com and look at the "products & services" drop-down, open source chef isn't listed
[2013-02-22 19:39:23 -0500] jubilo: which is what made me wonder that
[2013-02-22 19:39:54 -0500] gleam: if you click on "chef" it's on the right side of the page when /chef/ loads
[2013-02-22 19:39:55 -0500] jubilo: there's a little blurb in the sidebar of the "Chef" page that points to open source chef
[2013-02-22 19:39:59 -0500] jubilo: it's just weird
[2013-02-22 19:40:00 -0500] jubilo: that's all
[2013-02-22 19:40:07 -0500] dopacki: you have to find the community link
[2013-02-22 19:40:52 -0500] dopacki: yeah.. 11.0.6 failed on another fresh ec2 12.0.4LTS instance in the same way
[2013-02-22 19:41:01 -0500] dopacki: going to spin up another box and try 11.0.4
[2013-02-22 19:41:11 -0500] timsmith: jtimberman: Syntax.  I realized last night I had the fix for that.  It just didn't push because I didn't force push my rebase
[2013-02-22 19:41:50 -0500] jtimberman: timsmith: yeah, i had the fix in my local system for like three days :/
[2013-02-22 19:41:58 -0500] jtimberman: so I'm a terrible person for fixing it and not pushing ;)
[2013-02-22 19:42:17 -0500] timsmith: jtimberman: It looks like a lot of people are using that v4 branch for at least testing.  That's good I guess
[2013-02-22 19:45:16 -0500] j^2: so i'm trying to upload a cookbook to my new chef11 server, and i'm getting this: https://gist.github.com/jjasghar/0b3ca5e0e7bf2267d738 any advice?
[2013-02-22 19:45:39 -0500] jtimberman: timsmith: indeed
[2013-02-22 19:46:04 -0500] jtimberman: j^2: on the chef server, chef-server-ctl tail bookshelf
[2013-02-22 19:46:12 -0500] j^2: kk
[2013-02-22 19:46:15 -0500] jtimberman: j^2: then try the upload again. also use -VV with the knife command
[2013-02-22 19:46:53 -0500] j^2: adding to that gist, one sec
[2013-02-22 19:49:47 -0500] j^2: jtimberman: updated
[2013-02-22 19:49:50 -0500] j^2: https://gist.github.com/jjasghar/0b3ca5e0e7bf2267d738
[2013-02-22 19:52:03 -0500] j^2: the ops cookbook is just one recipe that basicly installs screen :-/
[2013-02-22 19:53:31 -0500] j^2: same thing with another cookbook
[2013-02-22 19:55:36 -0500] j^2: opps
[2013-02-22 19:55:41 -0500] j^2: forgot a -V
[2013-02-22 19:55:44 -0500] j^2: https://gist.github.com/jjasghar/4f26ab8f9f68748b3dd2
[2013-02-22 19:55:45 -0500] j^2: that's more like it
[2013-02-22 19:57:29 -0500] j^2: i think it's because it's rerouting to https://chef
[2013-02-22 19:59:40 -0500] j^2: http://www.checkupdown.com/status/E405.html
[2013-02-22 20:03:28 -0500] jtimberman: j^2: do you have an fqdn? is it in DNS?
[2013-02-22 20:03:29 -0500] j^2: it seems emillien had the same problem -->
[2013-02-22 20:03:31 -0500] j^2: http://community.opscode.com/chat/chef/2013-02-06
[2013-02-22 20:03:49 -0500] j^2: that's what i'm trying to get done, i have a cookbook to get it into DNS
[2013-02-22 20:03:53 -0500] jtimberman: nginx is in front of the API and bookshelf and handles redirecting the requests to the appropriate backend.
[2013-02-22 20:03:57 -0500] jtimberman: hah :)
[2013-02-22 20:04:11 -0500] jtimberman: well, that's a bit of the chicken/egg problem w/ automation :)
[2013-02-22 20:04:20 -0500] j^2: is there a place i can hack nginx to go to the IP instead of "chef"
[2013-02-22 20:04:22 -0500] j^2: ?
[2013-02-22 20:04:29 -0500] j^2: oh
[2013-02-22 20:04:33 -0500] j^2: i should say bookshelf
[2013-02-22 20:05:12 -0500] j^2: i am running it on the local box, so /etc/hosts should have "chef" in the hosts file
[2013-02-22 20:05:24 -0500] j^2: ah
[2013-02-22 20:05:37 -0500] j^2: yeah that's not what i though scratch that
[2013-02-22 20:06:52 -0500] j^2: yeah i'm still getting the same error
[2013-02-22 20:08:59 -0500] jtimberman: j^2: what is your chef_server_url in knife.rb?
[2013-02-22 20:09:04 -0500] jtimberman: http://chef or https://chef
[2013-02-22 20:09:19 -0500] j^2: chef_server_url          'http://localhost'
[2013-02-22 20:09:51 -0500] j^2: NICE
[2013-02-22 20:09:56 -0500] j^2: changed it to https :D
[2013-02-22 20:09:58 -0500] j^2: thanks!
[2013-02-22 20:10:11 -0500] jtimberman: hattip to btm :)
[2013-02-22 20:11:29 -0500] j^2: that's gonna be a problem with alot of people, i'd strongly suggest adding it to a FAQ
[2013-02-22 20:11:42 -0500] j^2: breaks the client.rb too
[2013-02-22 20:32:41 -0500] dopacki: I miss ruby chef-server :(
[2013-02-22 20:33:40 -0500] dopacki: where do I even go to start debugging why http://localhost:8000/_status is returning a 500?
[2013-02-22 20:42:31 -0500] jtimberman: dopacki: chef-server-ctl tail will tail log files
[2013-02-22 20:42:39 -0500] jtimberman: dopacki: each service has its own logs
[2013-02-22 20:42:50 -0500] jtimberman: dopacki: chef-server-ctl tail erchef, for example
[2013-02-22 20:43:01 -0500] jtimberman: chef-server-ctl service-list will give you a list of all the services in the chef server.
[2013-02-22 20:45:31 -0500] r3vamp: for chef-server 11, how do you change the default values for the chef-server? I'm installing via the the deb file from the install page. I tried changing chef-server-running.json but executing "chef-server-ctl reconfigure" overwrites this...
[2013-02-22 20:47:02 -0500] jtimberman: timsmith: nagios jtimberman/v4 branch is now master :)
[2013-02-22 20:47:49 -0500] timsmith: cool
[2013-02-22 20:48:06 -0500] timsmith: it's pretty close to ready
[2013-02-22 20:48:12 -0500] timsmith: if not ready enough for 4.0
[2013-02-22 20:48:15 -0500] timsmith: there's always more stuff
[2013-02-22 20:48:37 -0500] Joel: ekfjkasjfsdf. I have a scenario where I can get at files I need via smbclient, or scp, I don't see scp listed as a resource for chef, please dear god tell me I'm missing it?
[2013-02-22 20:49:00 -0500] jtimberman: timsmith: i was thinking of shipping 4.0 today
[2013-02-22 20:49:14 -0500] jtimberman: the mailing list post was what, two weeks ago?
[2013-02-22 20:49:17 -0500] Joel: getting smbclient running sounds like a hell I do not want to dive into.
[2013-02-22 20:49:47 -0500] c_t: Joel: does remote_file not support scp?
[2013-02-22 20:50:06 -0500] Joel: c_t remote_file I thought pulled from within the cookbook crap? I might have ksimmed a little too fast.
[2013-02-22 20:51:12 -0500] Joel: c_t: hmm it'll do http, need read more.
[2013-02-22 20:51:18 -0500] timsmith: jtimberman: take a look at http://tickets.opscode.com/browse/COOK-2433 first
[2013-02-22 20:52:44 -0500] Joel: c_t: negative. you have to call http_request to get it into your cookbook space, then you use remote file to pull it in from there
[2013-02-22 20:53:02 -0500] Joel: c_t: but that's not to say I can't just use a script block to call scp I guess.
[2013-02-22 20:54:14 -0500] mattupstate: anyone experience this with the aws_elastic_ip LWRP? http://pastebin.com/pPzfjapi
[2013-02-22 20:54:31 -0500] mattupstate: "can't covert symbol to interger"
[2013-02-22 21:00:46 -0500] btm: @opscode Cookbook Code Review: join http://bit.ly/YIDAAK watch: http://youtu.be/JoU0DEAjjxI #opschef
[2013-02-22 21:10:51 -0500] jtimberman: timsmith: You're not in the COOK review!
[2013-02-22 21:11:21 -0500] bougyman: does ohai store cached data anywhere?
[2013-02-22 21:12:17 -0500] timsmith: I had a meeting
[2013-02-22 21:18:03 -0500] log1kal: In case anyone else is in here, using irssi, and wants to deal with the join/part spam:
[2013-02-22 21:18:12 -0500] log1kal: /ignore #chef joins quits
[2013-02-22 21:18:28 -0500] miah: i just have that set globally
[2013-02-22 21:18:31 -0500] ctracey`: jtimberman: total nit here, but thoughts on bumping the version of openssl cookbook so that the metadata.rb name is incorporated?  already checked in, just not in 1.0.0.
[2013-02-22 21:52:38 -0500] segv: with a template on chef 11 can you create a file w/out using a physical template file?
[2013-02-22 21:53:10 -0500] robbkidd: segv: Like you've got some simple string contents to put into a file?
[2013-02-22 21:53:25 -0500] kallistec: segv: there's been a content parameter to file resource for quite some time
[2013-02-22 21:53:37 -0500] segv: kallistec: ah, contents, cool
[2013-02-22 21:53:40 -0500] Kzim: hi
[2013-02-22 21:54:03 -0500] robbkidd: segv: http://docs.opscode.com/chef/resources.html#file -> Attributes section -> content
[2013-02-22 21:54:18 -0500] segv: was just there
[2013-02-22 21:54:31 -0500] segv: literally just loaded it before the link haha
[2013-02-22 21:54:31 -0500] yfeldblum: segv, http://pastie.org/private/bxmbajagwpir8uzmywejww
[2013-02-22 21:54:36 -0500] Kzim: anyone know a tool or a knife plugin or somthing to keep chef-server in sync with the chef-repo git ? so that my devs need to commit in git to have something in chef-server and i can keep a track ?
[2013-02-22 21:54:46 -0500] segv: yfeldblum: yep that's exactly what I was looking for.
[2013-02-22 21:55:05 -0500] yfeldblum: segv, cheers
[2013-02-22 21:56:11 -0500] josephholsten: Kzim: I've got a rake task that lints and uploads, but I think jhulten_ had a better one he was showing me
[2013-02-22 21:56:48 -0500] Kzim: josephholsten, so you manage this in a knife plugin ?
[2013-02-22 21:57:38 -0500] mattupstate: with the aws_elastic_ip LWRP, chef-server doesn't get notified of the change in IP address...
[2013-02-22 21:57:49 -0500] mattupstate: is there something I'm missing?
[2013-02-22 21:58:56 -0500] josephholsten: I add these to my chef repo's Rakefile: https://gist.github.com/josephholsten/5016869
[2013-02-22 21:59:08 -0500] josephholsten: Kzim: ^^
[2013-02-22 21:59:28 -0500] josephholsten: default already includes a knife test pass also
[2013-02-22 21:59:50 -0500] Kzim: josephholsten, i just started ruby i have to figure out what is a rake :)
[2013-02-22 22:00:11 -0500] josephholsten: "ruby make"
[2013-02-22 22:00:27 -0500] josephholsten: it's one of the two most popular automation libs
[2013-02-22 22:00:52 -0500] josephholsten: are you using a chef repo derived from https://github.com/opscode/chef-repo?
[2013-02-22 22:01:05 -0500] Kzim: yes
[2013-02-22 22:01:20 -0500] josephholsten: if so, you should be able to go to your chef repo and run `rake -T` to show all available rake tasks
[2013-02-22 22:02:24 -0500] segv: yfeldblum: thanks for the example too, just wanted to generate it dynamically w/out having to have a flat file on disk every run
[2013-02-22 22:02:53 -0500] Kzim: i think i deleted the config and Rakefile :) but this is task that are optional on your workstation right ? the thing is that i want to force my team to commit to git. perhaps prevend them to use the chef api even :)
[2013-02-22 22:03:50 -0500] josephholsten: that's what the upload_all task does.
[2013-02-22 22:04:35 -0500] josephholsten: if you only have a valid chef client key on the build box, the only way for them to upload is via a passing build in jenkins/travis
[2013-02-22 22:05:00 -0500] Kzim: josephholsten, i htink i have to read more because in https://gist.github.com/josephholsten/5016869 i see action on the chef-server and no commit on git
[2013-02-22 22:05:15 -0500] josephholsten: ah
[2013-02-22 22:06:11 -0500] Kzim: oh sorry i mean i want them to push their change before they are taken into chef-server perhaps i wasn't clear
[2013-02-22 22:06:28 -0500] josephholsten: so how it works is you have the dev push to git, the git repo triggers a build in your build server, you have the build action for the project be something like `bundle install; bundle exec rake`
[2013-02-22 22:07:04 -0500] josephholsten: so it only gets pushed to the chef-server from your build automation server
[2013-02-22 22:07:27 -0500] Kzim: that would be great
[2013-02-22 22:07:41 -0500] josephholsten: that's how my entire dev team pushes changes: via git commits
[2013-02-22 22:09:08 -0500] Kzim: Nice ! so just to be sure i understand: you used the rake update_all as git hook on the build server right ?
[2013-02-22 22:09:53 -0500] Kzim: josephholsten, and how do you team modify the environments and nodes attributes ?
[2013-02-22 22:10:34 -0500] jtimberman: ctracey`: you mean in the released version on the community site?
[2013-02-22 22:11:24 -0500] josephholsten: Kzim: we only use node attributes through roles, and both environments and roles are uploaded through the upload_all task
[2013-02-22 22:13:00 -0500] Kzim: josephholsten, so you never go on the chef-server to set a normal attributes ? if you need a node to have a cluster name you create a role like dev_redis_mycluster.json ?
[2013-02-22 22:13:47 -0500] josephholsten: we've got a few nodes that have hand tuned attributes, but we try to avoid that as much as possible
[2013-02-22 22:14:00 -0500] josephholsten: and only the ops team can make those changes
[2013-02-22 22:15:26 -0500] miah: hand tuned roles are easily forgotten. roles are much more obvious.
[2013-02-22 22:15:31 -0500] miah: er
[2013-02-22 22:15:36 -0500] miah: hand tuned attributes
[2013-02-22 22:16:10 -0500] Kzim: josephholsten, miah, thanks you very much
[2013-02-22 22:19:59 -0500] miah: np
[2013-02-22 22:35:58 -0500] epta: How can I get THIS node chef_environment using chef API inside knife plugin?
[2013-02-22 22:36:29 -0500] epta: `THIS node' means node where knife running from
[2013-02-22 22:52:24 -0500] mihir: hello
[2013-02-22 22:52:31 -0500] mihir: got a quick question
[2013-02-22 22:53:07 -0500] programmerq: anyone know if gmiranda23 ever comes in to freenode?
[2013-02-22 22:53:17 -0500] mihir: am unable to upload cookbooks to the chef-server
[2013-02-22 22:53:50 -0500] mihir: error: No connection could be made because the target machine actively refused
[2013-02-22 22:55:59 -0500] ecarey: Is there way to list available recipes in a recipe? The closest thing I've found is: `rest.get_rest('cookbooks/_recipes')`
[2013-02-22 22:59:04 -0500] tjadmin_: Question for someone .... probably/maybe someone at opscode.... As I reading thru the documentation at http://private-chef-docs.opscode.com/installation/prereqs.html , I'm seeing some things that seem to be errors.... Who's the mainter?
[2013-02-22 22:59:25 -0500] tjadmin_: mantainer?
[2013-02-22 22:59:27 -0500] ecarey: mihir: That doesn't look like a chef error
[2013-02-22 22:59:57 -0500] mihir: hmm...what could it be?
[2013-02-22 23:00:03 -0500] mihir: the iptables are shutoff
[2013-02-22 23:00:13 -0500] mihir: the chef server url is working
[2013-02-22 23:00:25 -0500] mihir: since i can create and delete nodes, users etc
[2013-02-22 23:00:40 -0500] ranjibd: tjadmin_, drop a mail to support,
[2013-02-22 23:01:16 -0500] ranjibd: mihir, are you using an admin client?
[2013-02-22 23:01:23 -0500] tjadmin_: I'd like to submit or change as I go along.... I reading the details as I go thru a second learning of Chef.....
[2013-02-22 23:01:32 -0500] mihir: nope
[2013-02-22 23:01:56 -0500] mihir: yes i am
[2013-02-22 23:02:16 -0500] mihir: am using a client/user with admin previlages
[2013-02-22 23:05:30 -0500] sprack: what should I use if I want to build and regress cookbooks on local vm's intended for ec2 instances?
[2013-02-22 23:06:01 -0500] mihir: is the url correct ? https://10.0.0.6? for version 11.06
[2013-02-22 23:17:22 -0500] Majost1: someara: hello
[2013-02-22 23:17:35 -0500] sprack: is vagrant still the best choice for this kind of dev or is there a new hotness?
[2013-02-22 23:17:44 -0500] Majost1: someara: is your pki cookbook on github somewhere?
[2013-02-22 23:23:44 -0500] abetterlie: sprack: if you're near a linux box, lxc is pretty awesome, but not as handy as vagrant
[2013-02-22 23:24:07 -0500] abetterlie: sprack: but the vagrant/berkshelf flow is pretty much where it's at.
[2013-02-22 23:25:17 -0500] sprack: abetterlie: cool. I was asking because at the last devops meeting mattray mentioned some new ones they were moving to and the opscode wiki makes it sound like vagrant is legacy.
[2013-02-22 23:26:01 -0500] mattray: sprack: not legacy, just that you don't have to tie yourself to it
[2013-02-22 23:27:38 -0500] sprack: mattray: if you don't mind repeating yourself. what were some others you'd suggest?
[2013-02-22 23:28:31 -0500] mattray: sprack: with Test Kitchen?
[2013-02-22 23:28:38 -0500] mattray: or just in general?
[2013-02-22 23:29:10 -0500] mattray: there are knife plugins for just about every virtualization and public and private cloud option
[2013-02-22 23:29:22 -0500] mattray: so I lean on lxc and openstack a lot
[2013-02-22 23:30:14 -0500] tjadmin_: I'm setting up a new Private Chef Server for orientation and learn of how to set one up.... The link I recieved is for private-chef_1.4.4-1.ubuntu.11.04_amd64.deb . Is this a Chef 11 ( i.e. the newest best since sliced bread ) Omnibus installer? I'm guessing not.
[2013-02-22 23:34:57 -0500] tjadmin_: OK. Let's try this. Does anyone know where to find the version history as it translates to release packages? for Private CHef Server.
[2013-02-22 23:42:14 -0500] tjadmin_: Never mind.... Got it. For Future reference: http://www.opscode.com/chef/install/ gives >> chef-server_11.0.6-1.ubuntu.12.04_amd64.deb
