[2012-04-20 00:56:14 -0400] github-bawt: [chef] marcparadise pushed 2 new commits to whyrun: http://git.io/qeI_kw
[2012-04-20 00:56:14 -0400] github-bawt: [chef/whyrun] whyrun for ohai provider - Marc Paradise
[2012-04-20 00:56:14 -0400] github-bawt: [chef/whyrun] whyrun for subversion provider - Marc Paradise
[2012-04-20 00:57:05 -0400] mparadise: sooner or later, I need to refactor subversion and git providers into a common base class
[2012-04-20 01:25:25 -0400] github-bawt: [chef] marcparadise pushed 1 new commit to whyrun: http://git.io/u3AcyA
[2012-04-20 01:25:26 -0400] github-bawt: [chef/whyrun] Added whyrun for mount provider - Marc Paradise
[2012-04-20 01:56:39 -0400] jtimberman: mparadise: and add mercurial/hg :)
[2012-04-20 01:56:44 -0400] jtimberman: then coderanger will smile.
[2012-04-20 01:56:52 -0400] jtimberman: though there was a mercurial cookbook pull request for an lwrp
[2012-04-20 02:00:40 -0400] coderanger: mparadise: And then the git and svn resources themselves should get punted to the relevant cookbooks
[2012-04-20 02:10:25 -0400] mparadise: coderanger: +1
[2012-04-20 02:10:43 -0400] coderanger: Also needed, a way for LWRPs to subclass something :)
[2012-04-20 02:11:53 -0400] mparadise: they can't today? interesting
[2012-04-20 02:12:23 -0400] coderanger: No, you have to go back to a lib/ file with a real class in it
[2012-04-20 02:12:30 -0400] coderanger: Or you can use include or extend
[2012-04-20 02:12:34 -0400] coderanger: but you can't subclass
[2012-04-20 02:12:56 -0400] coderanger: If we setup the "base" as a module to include it would work fine though
[2012-04-20 02:13:19 -0400] coderanger: (thats what the new app cookbook does, for example)
[2012-04-20 02:13:24 -0400] josephholsten: extend is subclass
[2012-04-20 02:13:36 -0400] josephholsten: shows up in ancestors and everything
[2012-04-20 02:13:59 -0400] coderanger: josephholsten: Um, what?
[2012-04-20 02:14:11 -0400] coderanger: TypeError: wrong argument type Class (expected Module)
[2012-04-20 02:14:36 -0400] coderanger: Unless I'm missing something
[2012-04-20 02:15:12 -0400] josephholsten: it injects an anonymous class into the hierarchy of the instance's singleton class
[2012-04-20 02:15:47 -0400] coderanger: josephholsten: Right, but you can't use it to subclass an actual class
[2012-04-20 02:15:49 -0400] josephholsten: jeg2 has an awesome presentation on it
[2012-04-20 02:16:02 -0400] josephholsten: true
[2012-04-20 02:16:05 -0400] coderanger: this means that LWRPs can't subclass other resources or providers directly
[2012-04-20 02:16:10 -0400] coderanger: So it isn't actually the same thing ...
[2012-04-20 02:16:32 -0400] coderanger: The common case is, for example, want to subclass execute or file
[2012-04-20 02:17:38 -0400] coderanger: The only way to do this is to execute the LWRP twice, the first in a dummy context that looks for a single method call like "subclass ClassName" which becomes the parent for the class object which is the context for the second exec
[2012-04-20 02:17:57 -0400] coderanger: But it would mean that any file-level code would be run twice
[2012-04-20 02:17:59 -0400] coderanger: which sucks
[2012-04-20 02:18:13 -0400] coderanger: alternaitvely it could be some kind of text tag and use a regex
[2012-04-20 02:18:20 -0400] josephholsten: nah
[2012-04-20 02:19:20 -0400] josephholsten: I can think of a solution, but it would be impossible to understand without a whiteboard and arrows
[2012-04-20 02:19:54 -0400] coderanger: Well feel free to draw it and submit a photo :)
[2012-04-20 02:21:03 -0400] jtimberman: coderanger: i totally want to subclass service.
[2012-04-20 02:21:15 -0400] coderanger: Yeah, thats another common one
[2012-04-20 02:21:25 -0400] jtimberman: coderanger: runit lwrp doesn't give you a "real" service resource thaty ou can notify
[2012-04-20 02:21:32 -0400] jtimberman: which is *lame*
[2012-04-20 02:22:07 -0400] jtimberman: i'm probably going to reimplement that in a regular library
[2012-04-20 02:22:11 -0400] coderanger: I love how in Ruby makes almost everything mutable, including things that have no right being mutable like instance vars on Fixnums, but you can't rewrite a classes parenting
[2012-04-20 02:23:09 -0400] josephholsten: I am so going to wreck this subclassing issue
[2012-04-20 02:24:51 -0400] mparadise: of course, sublcassed LWRP might do Weird Things in why-run
[2012-04-20 02:25:10 -0400] josephholsten: so what's the interface that needs to be stable? action(sum, &blk), what else?
[2012-04-20 02:25:43 -0400] mparadise: lwrp is going to have be something we work though cautiously anyway, even wihout subclassing
[2012-04-20 02:26:50 -0400] mparadise: that's pretty much it josephholsten, that and assertions
[2012-04-20 02:29:44 -0400] josephholsten: ah, found the spec/data/lwrp's
[2012-04-20 02:35:25 -0400] jtimberman: mparadise: yeah i was talking to dan yesterday about it. seems that whyrun will be fine if you only have resources in your action methods.
[2012-04-20 02:35:37 -0400] jtimberman: but if you're writing ruby you'd want to implement the converge_by()
[2012-04-20 02:35:52 -0400] jtimberman: i'll leave that to you guys to sort out and document before I go nuts in our cookbooks :)
[2012-04-20 02:39:18 -0400] mparadise: jtimberman: yes that.  I'm worried too about recipes with side effects in not_if/only_if blocks
[2012-04-20 02:40:40 -0400] jtimberman: mparadise: WHYRUN: HERE BE DRAGONS
[2012-04-20 02:43:00 -0400] jtimberman: Also, SEDD: Side Effect Driven Development.
[2012-04-20 02:43:18 -0400] jtimberman: oh hhmmm.
[2012-04-20 02:43:37 -0400] jtimberman: mparadise: has the fact that things like "node.save" can be called, bare, in a recipe been addressed?
[2012-04-20 02:43:55 -0400] jtimberman: people don't always put that in a ruby_block
[2012-04-20 02:44:08 -0400] mparadise: hmm, no.
[2012-04-20 02:45:08 -0400] jtimberman: since we don't save the node when a run fails (because we don't want to save potentially bad data), should we guard against that, or let people know in the documentation about whyrun that they'll need to move those kinds of statements to rubyblocks?
[2012-04-20 02:45:36 -0400] mparadise: I'd like to guard against it if we can
[2012-04-20 02:45:45 -0400] mparadise: I'll add it to the "look into" list
[2012-04-20 02:45:53 -0400] jtimberman: thanks
[2012-04-20 02:51:13 -0400] josephholsten: coderanger: theory: lwrp drops the file into a module instead of a class, then asks the module who the module wants to be its parent defaulting to Chef::Provider/Resource, then mixing the lwrp into the appropriate parent
[2012-04-20 02:52:36 -0400] josephholsten: if there are lwrps that are trying to set class methods, this will esspload! but otherwise stands a chance of working
[2012-04-20 02:56:17 -0400] coderanger: josephholsten: Sounds reasonable :)
[2012-04-20 02:57:09 -0400] coderanger: The DSL methods used for LWRPs themselves with have to be moved into base modules that get included into the new module before the exec
[2012-04-20 02:57:45 -0400] coderanger: but that shouldn't be a problem
[2012-04-20 02:58:57 -0400] josephholsten: module << mod; extend Chef::Mixin::FromFile; def action(*args, &blk);; end; end
[2012-04-20 02:59:59 -0400] josephholsten: like the perl^H^H^Harty never stopped
[2012-04-20 03:00:11 -0400] coderanger: Or that
[2012-04-20 03:07:03 -0400] github-bawt: [chef] marcparadise pushed 1 new commit to whyrun: http://git.io/GTDhvQ
[2012-04-20 03:07:04 -0400] github-bawt: [chef/whyrun] why-run for http_request - Marc Paradise
[2012-04-20 03:08:04 -0400] mparadise: up tomorrow: directory, remote-directory, remote-file, cookbook-file and whatever else I can plow through
[2012-04-20 03:10:26 -0400] josephholsten: aww, chef specs don't pass in ruby 2.0, guess I'll try 1.9.3
[2012-04-20 03:10:28 -0400] mparadise: probably will revisit the cron provider, I think it can be tweaked to provide more useful information than it would produce right now
[2012-04-20 03:11:37 -0400] jtimberman: mparadise: you're on a tear :D
[2012-04-20 03:12:24 -0400] jtimberman: looks relatively straightforward to port providers to whyrun though
[2012-04-20 03:12:31 -0400] jtimberman: stuff em under the converge_by()
[2012-04-20 03:12:35 -0400] jtimberman: give it a nice message.
[2012-04-20 03:12:36 -0400] mparadise: jtimberman: at least until I reach deploy.  that one scares me
[2012-04-20 03:12:45 -0400] jtimberman: mparadise: that one scares me too.
[2012-04-20 03:12:59 -0400] jtimberman: mparadise: and what coderanger + andreacampi did with the application recipes :O
[2012-04-20 03:13:02 -0400] mparadise: yeah, the assertions are a bit trickier; and re-tweaking the tests back into working state can be a headache
[2012-04-20 03:13:06 -0400] mparadise: but it's not too bad
[2012-04-20 03:14:00 -0400] mparadise: deploy will be a full-day effort on its own, I suspect
[2012-04-20 03:14:17 -0400] mparadise: and even then I reserve the right to break things :D
[2012-04-20 03:15:50 -0400] jtimberman: hahaha
[2012-04-20 03:16:01 -0400] jtimberman: mparadise: swear at dan while you're pairing! :D
[2012-04-20 03:16:36 -0400] mparadise: well sure, but that wouldn't be anything *new*...
[2012-04-20 03:16:57 -0400] jtimberman: hahahaha
[2012-04-20 03:17:37 -0400] mparadise: and on that note, have a good night folks. time to put the computer down before I hurt myself.
[2012-04-20 03:19:47 -0400] jtimberman: nite mparadise :D
[2012-04-20 03:34:07 -0400] josephholsten: kk, got it not breaking tests
[2012-04-20 03:35:02 -0400] josephholsten: what's the most awesome provider to subclass?
[2012-04-20 03:35:17 -0400] jtimberman: josephholsten: service
[2012-04-20 03:35:31 -0400] jtimberman: github.com/jtimberman/tree/CHEF-154 :D
[2012-04-20 03:35:42 -0400] jtimberman: here's some paint, a brush and my fence.
[2012-04-20 03:36:07 -0400] josephholsten: man, whitewashing is so much fun!
[2012-04-20 03:36:31 -0400] jtimberman: ;)
[2012-04-20 03:38:32 -0400] josephholsten: https://github.com/jtimberman/runit/blob/CHEF-154/providers/service.rb ?
[2012-04-20 03:38:40 -0400] josephholsten: owww
[2012-04-20 03:39:31 -0400] jtimberman: implement all the things!
[2012-04-20 03:39:34 -0400] jtimberman: hahahaha
[2012-04-20 03:39:45 -0400] jtimberman: if runit's sv can send the command, i action'd it
[2012-04-20 03:48:46 -0400] josephholsten: ah, the meat
[2012-04-20 03:49:21 -0400] josephholsten: Cannot find a resource for ancestors, (lib/chef/resource_platform_map.rb:129)
[2012-04-20 03:51:30 -0400] josephholsten: you should definitely work on a spec for this in unit/lwrp.rb
[2012-04-20 03:53:03 -0400] jtimberman: josephholsten: unit testing my code?
[2012-04-20 03:53:09 -0400] jtimberman: pshaw.
[2012-04-20 03:53:10 -0400] jtimberman: :)
[2012-04-20 03:53:18 -0400] josephholsten: no mine!
[2012-04-20 03:54:10 -0400] josephholsten: meh, if I can get ancestors right I'll be happy
[2012-04-20 04:12:21 -0400] josephholsten: jtimberman: hit it: https://github.com/josephholsten/chef/tree/subclass-lwrp
[2012-04-20 04:13:31 -0400] jtimberman: josephholsten: neat!
[2012-04-20 04:14:04 -0400] josephholsten: also in my pipeline: https://github.com/josephholsten/chef/tree/yaml-support
[2012-04-20 04:14:30 -0400] josephholsten: because data bags as json makes me cry just a little
[2012-04-20 04:16:34 -0400] josephholsten: ok, sleep
[2012-04-20 04:16:53 -0400] jtimberman: lol
[2012-04-20 04:16:54 -0400] jtimberman: cheers
[2012-04-20 04:19:08 -0400] josephholsten: coderanger: please do code review for legibility. If it isn't reasonably obvious what I'm doing, it's a bug.
[2012-04-20 04:19:17 -0400] josephholsten: Also, docs changes.
[2012-04-20 18:34:21 -0400] github-bawt: [chef] btm pushed 1 new commit to master: http://git.io/5vj9Kw
[2012-04-20 18:34:21 -0400] github-bawt: [chef/master] stub out Tempfile in solaris cron spec - Bryan McLellan
[2012-04-20 19:22:39 -0400] mparadise: jtimberman: I was looking a bit at node, node.save nad it seems that the 'risky' operations are going to be save, create_design_document, create, and cdb_save. Are those last three likely to be used in a recipe?
[2012-04-20 19:23:07 -0400] github-bawt: [chef] marcparadise pushed 1 new commit to whyrun: http://git.io/ri6-cA
[2012-04-20 19:23:07 -0400] github-bawt: [chef/whyrun] whyrun for mdadm - Marc Paradise
[2012-04-20 19:23:52 -0400] jtimberman: mparadise: save most certainly is.
[2012-04-20 19:24:47 -0400] mparadise: it would be easy enough to add a whyrun check there, and simply talk about saving instead of actually doing it - I don't thikn we'll need our action queuing structure like we do for providers.
[2012-04-20 19:25:34 -0400] jtimberman: mparadise: https://gist.github.com/2431179
[2012-04-20 19:26:12 -0400] mparadise: mrph
[2012-04-20 19:26:13 -0400] jtimberman: yeah like, in the save method, just check if Chef::Conf[:why_run] and log instad of actually saving
[2012-04-20 19:26:20 -0400] jtimberman: some of those are in rubyblocks
[2012-04-20 19:26:41 -0400] jtimberman: And I *can* refactor them :)
[2012-04-20 19:27:18 -0400] jtimberman: mparadise: what about resources that are created at compile time instead of when executing the resource collection? doesn't matter?
[2012-04-20 19:27:48 -0400] mparadise: True, but no guarantee that folks don't have it in their own recipes - handling it in save is the safest /least potentially damaging route
[2012-04-20 19:28:07 -0400] mparadise: it *shouldn't* matter though we have some testing to do to prove that
[2012-04-20 19:29:08 -0400] jtimberman: :)
[2012-04-20 19:29:18 -0400] jtimberman: yeah, we should totally be nice in the save method itself.
[2012-04-20 19:29:46 -0400] jtimberman: since recipes == ruby, there's all kinds of things that we can't imagine people are doign :)
[2012-04-20 19:30:07 -0400] mparadise: yep
[2012-04-20 19:30:16 -0400] mparadise: and more importantly, don't *want* to imagine...
[2012-04-20 19:31:37 -0400] jtimberman: hahahah
[2012-04-20 20:05:14 -0400] laurent\: i've been using the msi to install chef on windows lately, how do you play with master or other development branches on windows ?
[2012-04-20 20:06:17 -0400] jtimberman: laurent\: i've had success just installing the chef gem with the gem command in c:\opscode\embedded\bin
[2012-04-20 20:07:02 -0400] laurent\: ok, i just tried gem install bundler, i've got some network issues to handle with my vm first :)
[2012-04-20 20:08:04 -0400] hoover_damn: laurent\, oh you want to do development work in it?
[2012-04-20 20:08:12 -0400] hoover_damn: or just run different versions of chef?
[2012-04-20 20:08:41 -0400] laurent\: i just want to test dev branches in it
[2012-04-20 20:08:42 -0400] hoover_damn: laurent\, you should be able to just gem install chef-otherbranch.gem --local with the msi to just install a different gem
[2012-04-20 20:08:59 -0400] hoover_damn: you won't need network activity for that, just your git repo with the branches
[2012-04-20 20:09:08 -0400] hoover_damn: and gem build chef.gemspec
[2012-04-20 20:09:15 -0400] hoover_damn: gem install chef-whatever.gem --local
[2012-04-20 20:11:33 -0400] laurent\: :) first of all i need to find out where the windows gemrc is supposed to be :) need to add proxy
[2012-04-20 20:14:17 -0400] laurent\: going to share c$ and do all the file management from my linux wrkstation :-)
[2012-04-20 20:25:04 -0400] btm: 403?
[2012-04-20 20:32:36 -0400] hoover_damn: 202
[2012-04-20 21:32:36 -0400] bemu: jtimberman, coderanger: In an effort to be loyal to the group I started, I'm going to have the pre-ChefConf hack evening in SF. Most people won't go to the south bay on weekdays for meetups, which means it really would not be an SF DevOps meetup. However, if you guys are intent on having one in Burlingame during the same time, I would probably move mine to post-ChefConf, and attend the Opscode one.
[2012-04-20 21:33:19 -0400] bemu: Just let me know what works, and I'll do the meetup page crap. :)
[2012-04-20 21:34:17 -0400] bemu: Obviously always happy to cross post, and there are two other orgs in the south bay who would probably co-host with you guys: SV DevOps and BACUG.
[2012-04-20 21:36:59 -0400] bemu: Also happy to help arrange transport for you guys if you do want to come up.
[2012-04-20 21:37:11 -0400] jtimberman: bemu: its cool
[2012-04-20 21:38:29 -0400] bemu: Uber around 8pm would probably take less than 30 minutes.
[2012-04-20 21:41:32 -0400] jtimberman: cool
[2012-04-20 21:45:10 -0400] kallistec: bemu: my only input on the matter is that I like the acronym ChUG
[2012-04-20 21:45:25 -0400] bemu: SF ChUG? :D
[2012-04-20 21:45:38 -0400] kallistec: precisely.
[2012-04-20 21:45:58 -0400] bemu: I tried to make it agnostic, but practically, we have a pretty small puppet contingent.
[2012-04-20 21:46:33 -0400] bemu: But things like fog, and some of the other talks we've had were definitely not Chef specific.
[2012-04-20 21:47:00 -0400] bemu: I was a bit torn on that, really. A Chef User Group definitely has a better acronym..
[2012-04-20 21:47:30 -0400] bemu: First step: Have more meetings
[2012-04-20 21:47:38 -0400] kallistec: how can you argue with, "don't worry, I'm just going to the ChUG"
[2012-04-20 21:48:04 -0400] bemu: Plus, the signs we can put up downstairs Twilio will feel right at home.
[2012-04-20 21:48:19 -0400] bemu: (They have ridiculously raucuos parties)
[2012-04-20 21:49:15 -0400] bemu: Any requests on beverages or food?
[2012-04-20 21:49:32 -0400] kallistec: I won't be in town yet
[2012-04-20 21:49:46 -0400] bemu: aw. I heard you love licorice flavored liquors :B
[2012-04-20 21:50:12 -0400] lnxchk: kallistec only drinks jaeger bombs. in large quantities.
[2012-04-20 21:50:30 -0400] bemu: So gross. ahha.
[2012-04-20 21:50:52 -0400] bemu: but anything that makes btm drink jaegar, I'm for.
[2012-04-20 21:51:08 -0400] kallistec: hehe, not my favorite of all time by any means, but when peer pressure demands....
[2012-04-20 21:51:41 -0400] kallistec: getting skeptomai drinking with us was quite a victory
[2012-04-20 21:52:24 -0400] bemu: Sorry i was such a spoil sport that night, was just exhausted/overwhelmed. Had an outage basically the whole day and was trying to deal with it over crappy conference interwebs.
[2012-04-20 21:53:19 -0400] bemu: jtimberman sat down with us at one point and just stared. I'm pretty bad at small talk anyway, but that was the highlight of the evening. :D
[2012-04-20 21:53:49 -0400] bemu: nah, actually, meeting/talking to Jesse/Adam more, spending time with btm/damm, and hearing everyone's stories and what they're working on was awesome.
[2012-04-20 21:53:53 -0400] bemu: Can't wait for ChefConf.
[2012-04-20 21:54:06 -0400] bemu: I had a great time, despite the poor circumstances.
[2012-04-20 21:59:37 -0400] jtimberman: kallistec: when do you arrive
[2012-04-20 22:03:22 -0400] kallistec: jtimberman: afternoon on 15th
[2012-04-20 22:06:59 -0400] jtimberman: kallistec: ah, you're not going to attend Chef 101 for sysadmins?
[2012-04-20 22:07:04 -0400] jtimberman: (workshop)
[2012-04-20 22:16:41 -0400] kallistec: I think I've got most of the material down already
[2012-04-20 22:19:09 -0400] hoover_damn: didn't he write it?
[2012-04-20 22:19:38 -0400] hoover_damn: either way it would end bad
[2012-04-20 22:24:21 -0400] bemu: Then we'd have three speakers, because you know fujin is going to be speaking up too :)
[2012-04-20 22:25:27 -0400] hoover_damn: seriously
[2012-04-20 22:26:34 -0400] hoover_damn: and there really is more then one way to do it
[2012-04-20 22:26:39 -0400] hoover_damn: so in a way we're all wrong
[2012-04-20 22:27:46 -0400] bemu: Yeah, I hate ruby. I'm writing a new CM system in perl and clojure.
[2012-04-20 22:28:22 -0400] hoover_damn: i've seen so meny people say 'I hate this i'm going to rewrite it in x...' but it really don't serve any point
[2012-04-20 22:28:31 -0400] hoover_damn: and there is value with being able to share what you do with others
[2012-04-20 22:28:59 -0400] hoover_damn: doing your own thing just because your a selfish prick who thinks the world of yourself is just... not worth hearing about
[2012-04-20 22:29:21 -0400] bemu: (and not getting any contribution back)
[2012-04-20 22:30:51 -0400] hoover_damn: well the whole point is contribution and sharing
[2012-04-20 22:31:07 -0400] hoover_damn: because the moment you specialize it into you... you take on the ownership of the whole problem
[2012-04-20 22:31:18 -0400] hoover_damn: we don't need to specialize everything
[2012-04-20 22:31:32 -0400] hoover_damn: just another level of work smarter... not harder
[2012-04-20 22:31:49 -0400] hoover_damn: that stupid statement can go pretty darn far
[2012-04-20 22:33:39 -0400] z: jtimberman: I'm getting in about 7pm on Monday 14th - want me to come heckle you in Chef 101 on Tuesday? :)
[2012-04-20 22:34:28 -0400] jtimberman: z: no.
[2012-04-20 22:34:29 -0400] jtimberman: :P
[2012-04-20 22:34:30 -0400] z: kallistec: Are you doing the Diablo BoF on Tuesday by any chance?
[2012-04-20 22:37:16 -0400] bemu: BoF?
[2012-04-20 22:37:35 -0400] z: Birds of a Feather
[2012-04-20 22:43:03 -0400] z: https://twitter.com/#!/nixgeek/status/193469374357700609
[2012-04-20 22:46:11 -0400] jtimberman: https://img.skitch.com/20120420-85iqn31sj58q5g4xruiawk9ag2.png
