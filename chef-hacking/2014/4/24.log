[2014-04-24 02:23:16 -0400] github-bawt: [chef] jkeiser force-pushed jk/require_me from 8173787 to 6cc7f56: http://git.io/OwLtGA
[2014-04-24 02:23:17 -0400] github-bawt: chef/jk/require_me 6cc7f56 John Keiser: Make it possible to include Chef::Provider / Chef::Resource...
[2014-04-24 02:30:39 -0400] github-bawt: [chef] jkeiser force-pushed jk/require_me from 6cc7f56 to a9955c6: http://git.io/OwLtGA
[2014-04-24 02:30:39 -0400] github-bawt: chef/jk/require_me a9955c6 John Keiser: Make it possible to include Chef::Provider / Chef::Resource...
[2014-04-24 04:13:39 -0400] github-bawt: [ohai] adamedx created adamed/7-stable (+3 new commits): http://git.io/FfGirg
[2014-04-24 04:13:39 -0400] github-bawt: ohai/adamed/7-stable 7ca09d2 adamedx: Merge remote-tracking branch 'origin/master' into 7-stable...
[2014-04-24 04:13:40 -0400] github-bawt: ohai/adamed/7-stable f796fa6 adamedx: Update changelog to include OHAI-558, add missing details
[2014-04-24 04:13:40 -0400] github-bawt: ohai/adamed/7-stable cf456d3 adamedx: Bump version for 7.0.4.rc.0
[2014-04-24 04:50:34 -0400] github-bawt: [omnibus-chef] adamedx created rel-chef-11.12.4 (+2 new commits): http://git.io/KCOAhg
[2014-04-24 04:50:34 -0400] github-bawt: omnibus-chef/rel-chef-11.12.4 56dc0f5 sersut: Temporarily disable dmg building for 11.12.0 release.
[2014-04-24 04:50:35 -0400] github-bawt: omnibus-chef/rel-chef-11.12.4 c9ed2d0 adamedx: Chef & Ohai version overrides
[2014-04-24 14:09:59 -0400] kamaradclimber: hi, I am trying to run a chef recipe on my workstation without being registered on the chef server (I am an admin client though) and can't run chef-solo/zero because I do searches in the recipe. Is there some hacky way to do it ?
[2014-04-24 15:53:51 -0400] github-bawt: [chef] jkeiser force-pushed jk/require_me from a9955c6 to a84653e: http://git.io/OwLtGA
[2014-04-24 15:53:52 -0400] github-bawt: chef/jk/require_me a84653e John Keiser: Make it possible to include Chef::Provider / Chef::Resource...
[2014-04-24 16:02:33 -0400] github-bawt: [chef] jkeiser merged jk/require_me into master: http://git.io/-Dsl_Q
[2014-04-24 16:29:04 -0400] github-bawt: [chef] danielsdeleo deleted jk/require_me at a84653e: http://git.io/UBKVRg
[2014-04-24 16:46:32 -0400] renchap: i have a very weird behaviour with latest chef on freebsd
[2014-04-24 16:46:36 -0400] renchap: maybe related to ohai 7
[2014-04-24 16:46:51 -0400] renchap: all works fine, except when i close the shell i used to start the daemon
[2014-04-24 16:46:53 -0400] renchap: then i get
[2014-04-24 16:46:59 -0400] renchap: WARN: unable to detect ipaddress
[2014-04-24 16:47:04 -0400] renchap: ERROR: Unable to determine node name: configure node_name or configure the system's hostname and fqdn
[2014-04-24 16:57:44 -0400] renchap: any ideas ?
[2014-04-24 16:58:25 -0400] whiteadam: Does anyone know if there's a bootstrap command to make chef-client a daemon by default?
[2014-04-24 17:00:04 -0400] whiteadam: renchap: what happens when you run $ohai hostname
[2014-04-24 17:00:15 -0400] renchap: works fine
[2014-04-24 17:00:26 -0400] renchap: the problem only occurs when i close the ssh session i used to start the client
[2014-04-24 17:00:56 -0400] whiteadam: renchap: what about $ohai ipaddress
[2014-04-24 17:01:35 -0400] renchap: works too...
[2014-04-24 17:01:44 -0400] renchap: as i said, this is not as simple as ohai not working
[2014-04-24 17:02:29 -0400] whiteadam: How are you starting the daemon?
[2014-04-24 17:02:47 -0400] renchap: /usr/local/bin/ruby19 /usr/local/bin/chef-client -c /usr/local/etc/chef/client.rb -d -i 10 -s 0 -l info
[2014-04-24 17:02:51 -0400] renchap: nothing unusual
[2014-04-24 17:03:10 -0400] whiteadam: well if you close the session, it closes the job
[2014-04-24 17:03:20 -0400] renchap: worked fine with 11.6
[2014-04-24 17:03:21 -0400] renchap: nope
[2014-04-24 17:03:28 -0400] whiteadam: Have you tried $nohup /usr/local/bin/ruby19 /usr/local/bin/chef-client -c /usr/local/etc/chef/client.rb -d -i 10 -s 0 -l info
[2014-04-24 17:03:29 -0400] renchap: because -d, daemonize
[2014-04-24 17:03:30 -0400] github-bawt: [chef] danielsdeleo force-pushed tidy-tests from d4d5f43 to f3a436d: http://git.io/Sc5kmQ
[2014-04-24 17:03:30 -0400] github-bawt: chef/tidy-tests bfc0b5a danielsdeleo: Prevent tests from overriding rspec's trap handler...
[2014-04-24 17:03:31 -0400] github-bawt: chef/tidy-tests 03db320 danielsdeleo: Fix rspec warnings
[2014-04-24 17:03:31 -0400] github-bawt: chef/tidy-tests 597ce7f danielsdeleo: Fix constant redefinition warnings in config tests
[2014-04-24 17:03:34 -0400] whiteadam: ahhh, i see
[2014-04-24 17:03:45 -0400] github-bawt: [chef] danielsdeleo merged tidy-tests into master: http://git.io/EE3flw
[2014-04-24 17:04:41 -0400] renchap: this is probable a problem with chef using a filedscriptor tied to the shell
[2014-04-24 17:05:19 -0400] whiteadam: yeah... how about putting bash in front of it to see if it will keep that?
[2014-04-24 17:05:29 -0400] whiteadam: that might sound insane though
[2014-04-24 17:06:39 -0400] renchap: Plugin Networkroutes threw exception #<LoadError: cannot load such file -- sigar>
[2014-04-24 17:06:48 -0400] renchap: mmmh
[2014-04-24 17:07:13 -0400] whiteadam: oooh
[2014-04-24 17:10:38 -0400] renchap: same thing with --no-fork
[2014-04-24 17:25:31 -0400] renchap: ok, so that is not the problem, as sigar is not installed
[2014-04-24 17:26:32 -0400] whiteadam: I guess that explains part of it
[2014-04-24 17:32:55 -0400] renchap: ok found the problem
[2014-04-24 17:34:14 -0400] renchap: http://paste.rottenbytes.info/?fcac58576facc344#WzfJRYAF4xR6+VILz6/NYOCyw0YArmo5A0mwewbHeE8=
[2014-04-24 17:34:55 -0400] whiteadam: ah, isn't a BUG something that exits other than 0 or 1 ?
[2014-04-24 17:36:56 -0400] renchap: kallistec: ping
[2014-04-24 17:38:28 -0400] kallistec: renchap: yo
[2014-04-24 17:38:38 -0400] renchap: got a nice error on freebsd
[2014-04-24 17:38:43 -0400] renchap: http://paste.rottenbytes.info/?fcac58576facc344#WzfJRYAF4xR6+VILz6/NYOCyw0YArmo5A0mwewbHeE8=
[2014-04-24 17:38:55 -0400] renchap: occurs with ohai 7, when i close the shell used to launch chef
[2014-04-24 17:39:00 -0400] kallistec: renchap: looking at that
[2014-04-24 17:39:02 -0400] renchap: you might have an idea about this
[2014-04-24 17:39:34 -0400] renchap: ruby 1.9.3p484, freebsd 9.2
[2014-04-24 17:41:13 -0400] kallistec: points to here: https://github.com/opscode/mixlib-shellout/blob/master/lib/mixlib/shellout/unix.rb#L214
[2014-04-24 17:41:20 -0400] renchap: yup
[2014-04-24 17:41:32 -0400] renchap: but i am not familiar with mixlib-shellout
[2014-04-24 17:41:39 -0400] renchap: and how it handles fds
[2014-04-24 17:41:52 -0400] kallistec: renchap: so that part of the code
[2014-04-24 17:42:18 -0400] kallistec: just looks for any fds that the parent process (chef) might have access to that the child should not
[2014-04-24 17:42:25 -0400] renchap: well
[2014-04-24 17:42:35 -0400] renchap: i assume that chef inherits fds from the shell
[2014-04-24 17:42:40 -0400] kallistec: like if you did File.open("blah") in chef and just left that open
[2014-04-24 17:42:45 -0400] renchap: when i close the shell
[2014-04-24 17:42:51 -0400] renchap: those fd no longer exists
[2014-04-24 17:42:52 -0400] renchap: => boom
[2014-04-24 17:43:19 -0400] renchap: this only occurs when i close the ssh session used to launch chef-client -d
[2014-04-24 17:43:23 -0400] kallistec: yeah, this is some ruby bug
[2014-04-24 17:43:26 -0400] renchap: if i keep the ssh session open, it works fine
[2014-04-24 17:43:59 -0400] renchap: you already encountered this ?
[2014-04-24 17:44:04 -0400] kallistec: ruby's behavior is supposed to be that it creates a ruby IO object for the fd if it exists, or raises a ruby error otherwise
[2014-04-24 17:44:13 -0400] kallistec: nope, I haven't seen this one
[2014-04-24 17:44:20 -0400] renchap: is it fixed with ruby 2.0 or 2.1 ?
[2014-04-24 17:44:40 -0400] renchap: i can try to update
[2014-04-24 17:45:23 -0400] kallistec: maybe it's this: https://bugs.ruby-lang.org/issues/8594
[2014-04-24 17:45:29 -0400] kallistec: which isn't resolved :(
[2014-04-24 17:46:07 -0400] renchap: mmmh
[2014-04-24 17:46:14 -0400] renchap: why does it only occurs on freebsd ?
[2014-04-24 17:46:30 -0400] kallistec: the reporter of the bug was on windows I guess
[2014-04-24 17:48:02 -0400] renchap: might not be related
[2014-04-24 17:48:06 -0400] renchap: as the provided test script works
[2014-04-24 17:48:16 -0400] renchap: i will setup a freebsd box with ruby 2.0 and 2.1
[2014-04-24 17:48:20 -0400] renchap: and try again
[2014-04-24 17:48:34 -0400] kallistec: that'd be helpful information
[2014-04-24 17:49:05 -0400] renchap: any way to run chef-client without a server and still trigerring this ?
[2014-04-24 17:49:28 -0400] github-bawt: [chef] danielsdeleo deleted tidy-tests at f3a436d: http://git.io/tX_4qQ
[2014-04-24 17:50:42 -0400] renchap: -z seems to work
[2014-04-24 18:00:31 -0400] renchap: kallistec: cant reproduce it on linux
[2014-04-24 18:00:50 -0400] renchap: can reproduce it with ruby 2.0.0p353 + freebsd
[2014-04-24 18:07:10 -0400] github-bawt: [ohai] lamont-granquist created lcg/python-parens (+1 new commit): http://git.io/f2PqYw
[2014-04-24 18:07:11 -0400] github-bawt: ohai/lcg/python-parens 17799bb Lamont Granquist: Encapsulate print command in function...
[2014-04-24 18:08:03 -0400] kallistec: renchap: looks like that error message at least got added here: https://github.com/ruby/ruby/commit/2bcd502a71bc0a140f3b78ed0d148745fb648555
[2014-04-24 18:09:19 -0400] renchap: mmmh
[2014-04-24 18:09:29 -0400] renchap: any idea on how to workaround this in mixlib-shellout ?
[2014-04-24 18:09:56 -0400] renchap: as i understand it, it will be triggered on any osx/freebsd
[2014-04-24 18:10:02 -0400] renchap: which might be a problem for you :)
[2014-04-24 18:23:43 -0400] kallistec: renchap: I haven't heard anything from mac os users
[2014-04-24 18:24:10 -0400] renchap: damn
[2014-04-24 18:24:14 -0400] kallistec: I suppose if any of them are running daemonized, they might be running it via the init system
[2014-04-24 18:24:19 -0400] renchap: yup
[2014-04-24 18:24:41 -0400] renchap: maybe if i find a way to close shell's FDs before running chef
[2014-04-24 18:24:44 -0400] kallistec: which I guess would be the best workaround for you for now?
[2014-04-24 18:25:32 -0400] renchap: which means rebooting the server to restart chef
[2014-04-24 18:27:20 -0400] kallistec: ah right, unless you used a different init service that managed the process on its own
[2014-04-24 18:27:43 -0400] whiteadam: Does anyone know if a port can be specified for the gateway in $knife bootstrap ip --ssh-gateway IP
[2014-04-24 18:29:29 -0400] renchap: kallistec: not the case, good old rc.d :)
[2014-04-24 18:34:38 -0400] kallistec: renchap: maybe this will workaround? https://gist.github.com/danielsdeleo/11264766
[2014-04-24 18:37:16 -0400] renchap: mmmh
[2014-04-24 18:38:04 -0400] github-bawt: [omnibus-chef] danielsdeleo pushed 1 new commit to master: http://git.io/7hYu5g
[2014-04-24 18:38:05 -0400] github-bawt: omnibus-chef/master 7947fe1 danielsdeleo: Update omnibus dependencies to latest
[2014-04-24 18:38:49 -0400] github-bawt: [omnibus-chef] adamedx pushed 1 new commit to rel-chef-11.12.4: http://git.io/e9TbWg
[2014-04-24 18:38:49 -0400] github-bawt: omnibus-chef/rel-chef-11.12.4 3b39a25 adamedx: Use rc versionining for release candidate build
[2014-04-24 18:40:55 -0400] renchap: kallistec: nope :x
[2014-04-24 18:43:56 -0400] github-bawt: [ohai] adamedx merged adamed/7-stable into 7-stable: http://git.io/gujyMQ
[2014-04-24 18:44:16 -0400] whiteadam: So I'm trying to bootstrap through an SSH gateway and the internal IP uses the same key, but it's asking for a password
[2014-04-24 18:44:30 -0400] whiteadam: Should I have some sort of forwarding on in the gateway?
[2014-04-24 19:01:07 -0400] kallistec: renchap: does this reproduce the issue for you? https://gist.github.com/danielsdeleo/73d2f9cc3cae73e5034b
[2014-04-24 19:02:49 -0400] renchap: mmh
[2014-04-24 19:02:55 -0400] renchap: where should i see the output ?
[2014-04-24 19:03:24 -0400] kallistec: renchap: should create a result.txt file in the directory where you start the program
[2014-04-24 19:03:40 -0400] renchap: ho yes, sorry
[2014-04-24 19:04:36 -0400] kallistec: If that is a minimal repro case, then it would be good to update that bug with that script and instructions for how to repro
[2014-04-24 19:05:33 -0400] renchap: nope, seems to work fine
[2014-04-24 19:05:39 -0400] kallistec: hrm
[2014-04-24 19:06:38 -0400] renchap: got the ruby process to run for 100s
[2014-04-24 19:06:40 -0400] renchap: no errors
[2014-04-24 19:06:54 -0400] kallistec: renchap: after you logged out and everything?
[2014-04-24 19:07:45 -0400] renchap: launched it, logged out
[2014-04-24 19:07:47 -0400] renchap: still running
[2014-04-24 21:06:36 -0400] github-bawt: [ohai] lamont-granquist pushed 2 new commits to lcg/python-parens: http://git.io/ALT9xA
[2014-04-24 21:06:36 -0400] github-bawt: ohai/lcg/python-parens af4bf5c Lamont Granquist: fix specs
[2014-04-24 21:06:37 -0400] github-bawt: ohai/lcg/python-parens 9250952 Lamont Granquist: modernize specs with expect()
[2014-04-24 22:21:24 -0400] github-bawt: [omnibus-chef] adamedx pushed 1 new commit to rel-chef-11.12.4: http://git.io/dHLqmA
[2014-04-24 22:21:25 -0400] github-bawt: omnibus-chef/rel-chef-11.12.4 98002a3 adamedx: Add Ohai dependency so correct ohai build takes place
[2014-04-24 23:24:46 -0400] github-bawt: [omnibus-chef] adamedx pushed 1 new commit to rel-chef-11.12.4: http://git.io/3G3flA
[2014-04-24 23:24:47 -0400] github-bawt: omnibus-chef/rel-chef-11.12.4 ca77f5c adamedx: Add devkit prior to build step that builds native gems for Ohai
