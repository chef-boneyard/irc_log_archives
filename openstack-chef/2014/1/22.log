[2014-01-22 00:03:15 -0500] ctracey: we got some weird recipes man
[2014-01-22 00:03:18 -0500] ctracey: :)
[2014-01-22 00:03:58 -0500] ctracey: what is this? https://github.com/stackforge/cookbook-openstack-compute/blob/master/recipes/compute.rb#L26
[2014-01-22 00:04:12 -0500] ctracey: we should not be including metadata with compute
[2014-01-22 01:24:32 -0500] spheromak: ctracey: yea
[2014-01-22 01:24:35 -0500] spheromak: theeres some wonk
[2014-01-22 01:24:44 -0500] spheromak: I could just go through evewhere we have rewind atm
[2014-01-22 01:24:55 -0500] spheromak: and prob generate some issues
[2014-01-22 01:30:43 -0500] openstackgerrit: David Geng proposed a change to stackforge/cookbook-openstack-network: Creating symbolic link for plugin.ini  https://review.openstack.org/67009
[2014-01-22 01:33:23 -0500] openstackgerrit: David Geng proposed a change to stackforge/cookbook-openstack-network: Creating symbolic link for plugin.ini  https://review.openstack.org/67009
[2014-01-22 01:46:50 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-image: Refactor specs  https://review.openstack.org/67682
[2014-01-22 02:09:51 -0500] claco: ^ woo
[2014-01-22 04:59:00 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-compute: Remote inclusion of api-metadata recipe  https://review.openstack.org/68320
[2014-01-22 05:04:17 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-identity: keystone-manage should be run by keystone user  https://review.openstack.org/68322
[2014-01-22 05:09:26 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-identity: There is no need to bash boostrap keystone  https://review.openstack.org/68324
[2014-01-22 05:10:38 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-identity: Rubocop last pass on spec/**.rb  https://review.openstack.org/67934
[2014-01-22 05:13:21 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-identity: Rubocop support for recipes/*.rb  https://review.openstack.org/67931
[2014-01-22 05:13:58 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-compute: Remove inclusion of api-metadata recipe  https://review.openstack.org/68320
[2014-01-22 05:17:32 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-compute: Add explicit start to vncproxy_service  https://review.openstack.org/67841
[2014-01-22 06:06:43 -0500] openstackgerrit: David Geng proposed a change to stackforge/openstack-chef-repo: Change the role order in os-network  https://review.openstack.org/67808
[2014-01-22 07:10:34 -0500] genggjh_: hi, who can help to look at this error? http://logs.openstack.org/09/67009/17/check/gate-cookbook-openstack-network-chef-unit/64883e1/console.html, how to fix it in my chefspec?
[2014-01-22 07:56:42 -0500] openstackgerrit: Eric Zhou proposed a change to stackforge/cookbook-openstack-common: Configure multiple OpenStack yum repositories.  https://review.openstack.org/66803
[2014-01-22 09:41:20 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-compute: Update recipes to be rubocop compliant  https://review.openstack.org/68094
[2014-01-22 10:05:06 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-image: Complete Rubocop compliancy  https://review.openstack.org/67871
[2014-01-22 10:56:14 -0500] openstackgerrit: Feng Ju proposed a change to stackforge/cookbook-openstack-common: Fix issue: Access denied when access mysql database  https://review.openstack.org/68351
[2014-01-22 11:31:18 -0500] hughsaunders: andymccr: https://review.openstack.org/#/q/status:open+%28project:^stackforge/cookbook-.*+OR+project:stackforge/openstack-chef-repo%29,n,z
[2014-01-22 12:42:59 -0500] openstackgerrit: Darren Birkett proposed a change to stackforge/cookbook-openstack-dashboard: creates openstack-dashboard site properly on centos/rhel  https://review.openstack.org/68367
[2014-01-22 13:26:01 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-block-storage: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68376
[2014-01-22 13:37:58 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-identity: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68378
[2014-01-22 13:41:28 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-image: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68379
[2014-01-22 13:44:31 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-metering: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68380
[2014-01-22 13:51:49 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-network: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68383
[2014-01-22 13:53:31 -0500] nacer_: it's weird that block storage service depend on image service
[2014-01-22 14:49:20 -0500] claco: andymccr: just comments on some of your spec patches. minor nit across the patchsets.
[2014-01-22 16:18:42 -0500] mrodden1: https://review.openstack.org/#/c/66803/ << i think that we should be setting up OpenStack, not RDO
[2014-01-22 16:20:30 -0500] ctracey: mrodden, I am with ya
[2014-01-22 16:20:45 -0500] ctracey: i dont know why our cookbooks need to set this up
[2014-01-22 16:21:48 -0500] mrodden: right, i have another recipe that is 10 lines that happily runs before everything else in my runlists that takes care of the repos
[2014-01-22 16:22:03 -0500] mrodden: there could be an RDO recipe that does the same
[2014-01-22 16:22:14 -0500] claco: right. could be recpies we include.. could be corp local mirrors
[2014-01-22 16:22:25 -0500] mrodden: exactly
[2014-01-22 16:22:26 -0500] claco: w/o messing w/o attribute merging...because that sucks.
[2014-01-22 16:22:31 -0500] mrodden: yes
[2014-01-22 16:22:34 -0500] ctracey: yes
[2014-01-22 16:22:48 -0500] mrodden: plus that is just emulating the yum_repo resource at this point anyways
[2014-01-22 16:22:51 -0500] ctracey: i am also not really in favor of including recipes
[2014-01-22 16:22:57 -0500] claco: aka, ever tried appening to the hba.conf in postrgres? /me smacks head on desk
[2014-01-22 16:22:59 -0500] ctracey: seems a recipe should be able to live on its own
[2014-01-22 16:23:14 -0500] ctracey: including recipes quickly becomes spaghetti
[2014-01-22 16:23:29 -0500] mrodden: thats true
[2014-01-22 16:23:37 -0500] mrodden: i'm not sure what a good solution would be there
[2014-01-22 16:23:42 -0500] claco: I don't mind having recipes so much.. kinda like nginx and the various repo recipes
[2014-01-22 16:23:43 -0500] ctracey: last night I called nova scheduler, compute and conductor
[2014-01-22 16:24:03 -0500] ctracey: ended up getting all of those plus metadata api and nova network
[2014-01-22 16:24:06 -0500] ctracey: that is just broken
[2014-01-22 16:24:15 -0500] mrodden: yeah that needs to be cleaned up...
[2014-01-22 16:24:22 -0500] mrodden: :/
[2014-01-22 16:24:43 -0500] ctracey: i get that changing that now will break people who have deployed, but it is just wrong
[2014-01-22 16:24:46 -0500] mrodden: can you add your comments to that patch review?
[2014-01-22 16:24:59 -0500] ctracey: yum?
[2014-01-22 16:25:22 -0500] mrodden: yea
[2014-01-22 16:25:24 -0500] mrodden: https://review.openstack.org/#/c/66803/
[2014-01-22 16:25:44 -0500] mrodden: not sure who Darren Birkett is in chat
[2014-01-22 16:25:59 -0500] mrodden: he seems to think we should have this repo stuff in the cookbooks though
[2014-01-22 16:26:51 -0500] claco: he's mancdaz
[2014-01-22 16:27:04 -0500] ctracey: i have commented
[2014-01-22 16:27:08 -0500] mrodden: thanks
[2014-01-22 16:27:26 -0500] mrodden: i need to stay on top of reviews better
[2014-01-22 16:28:04 -0500] mrodden: its tough when heads down hacking on issues all day though
[2014-01-22 16:28:05 -0500] ctracey: was it me or didnt jenkins used to show you your failures?
[2014-01-22 16:28:11 -0500] ctracey: me too
[2014-01-22 16:28:30 -0500] mrodden: jenkins should show failures...
[2014-01-22 16:28:43 -0500] ctracey: it marks it a failure but no logs
[2014-01-22 16:28:53 -0500] ctracey: oh...forget that
[2014-01-22 16:28:54 -0500] ctracey: i got it
[2014-01-22 16:29:04 -0500] ctracey: maybe my phone wasnt showing it
[2014-01-22 16:29:46 -0500] ctracey: i pushed my wrong branches last night...the ones that were not complete....fixing now
[2014-01-22 16:31:24 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-block-storage: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68376
[2014-01-22 16:31:54 -0500] mancdaz: ctracey / claco / mrodden hi
[2014-01-22 16:32:15 -0500] claco: elo!
[2014-01-22 16:32:18 -0500] mancdaz: so maybe I'm missing something wrt that yum repo stuff
[2014-01-22 16:32:18 -0500] ctracey: ehlo
[2014-01-22 16:32:23 -0500] mrodden: hi
[2014-01-22 16:32:51 -0500] ctracey: we should have a daily "standup" in here
[2014-01-22 16:32:55 -0500] mancdaz: Don't understand why it's a bad thing to give you the option of configuring openstack repo as part of the openstack cookbooks
[2014-01-22 16:32:59 -0500] ctracey: great when there are people workin in the room
[2014-01-22 16:33:23 -0500] claco: mancdaz: I think it's the attributes part _in_ to the default recipes that's the issue
[2014-01-22 16:33:32 -0500] claco: no change to not do it
[2014-01-22 16:33:38 -0500] claco: for people doing mirrors, etc
[2014-01-22 16:33:59 -0500] claco: mancdaz: or.. appending to attributes arrays and such is a pita..
[2014-01-22 16:34:03 -0500] claco: just my take..
[2014-01-22 16:35:10 -0500] mrodden: i think handling the repos in a recipe pre openstack recipes is the best way right now
[2014-01-22 16:35:20 -0500] mrodden: everyone can drop in the repos they want
[2014-01-22 16:35:22 -0500] mrodden: at runtime
[2014-01-22 16:35:31 -0500] mrodden: without screwing around with attributes
[2014-01-22 16:35:33 -0500] ctracey: my take is just that this is easy enough to do in one's own specific way.  somewhat like how we have elected to leave messaging/database up to the user, i feel like this kinda thing falls in a similar camp.
[2014-01-22 16:35:51 -0500] mrodden: ctracey: yes +2
[2014-01-22 16:35:52 -0500] mancdaz: hmm. I must be having a stupid(er) day, but why would we want to enforce that users have to have a separate recipe to add openstack repos
[2014-01-22 16:35:55 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-identity: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68378
[2014-01-22 16:36:07 -0500] mrodden: doesn't need to be enforced
[2014-01-22 16:36:09 -0500] mancdaz: when it can be handled
[2014-01-22 16:36:13 -0500] mrodden: i think an RDO recipe would make sense
[2014-01-22 16:36:34 -0500] mancdaz: so you mean a separate recipe in the common cookbook?
[2014-01-22 16:36:35 -0500] ctracey: this could be a good candidate for our reference repo
[2014-01-22 16:36:45 -0500] mrodden: but i can't imagine we are the only ones with our own openstack package set and do not want the RDO repo installed on a system
[2014-01-22 16:37:02 -0500] mancdaz: mrodden but this patch set addresses that
[2014-01-22 16:37:13 -0500] ctracey: that would really suck for those on ubuntu ;)
[2014-01-22 16:37:16 -0500] ctracey: JK! :)
[2014-01-22 16:37:27 -0500] mrodden: yes it does
[2014-01-22 16:37:39 -0500] mrodden: but it is essentially just abstracting the yum_repo resource
[2014-01-22 16:37:45 -0500] mrodden: and putting it in openstack-common
[2014-01-22 16:38:03 -0500] mrodden: we can control all that outside of common easily enough
[2014-01-22 16:38:49 -0500] ctracey: yes - separation of concerns
[2014-01-22 16:39:24 -0500] mancdaz: I understand that we CAN do a lot of stuff outside these cookbooks, it just seems to me that one of the basic things we should be able to do with openstack cookbooks is install the correct packages without needing some separate recipe to be run first
[2014-01-22 16:39:43 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-network: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68383
[2014-01-22 16:39:55 -0500] mrodden: i think that with RHEL its a bit different, but i understand that works for ubuntu with the ppas
[2014-01-22 16:40:01 -0500] claco: mancdaz: or both?  repos recipe.. in _our_ default shipped roles...
[2014-01-22 16:40:13 -0500] claco: but people can choose to run_list without them in their own roles
[2014-01-22 16:40:21 -0500] ctracey: mancdaz, we already need separate recipes for things like messaging and database
[2014-01-22 16:40:24 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-block-storage: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68376
[2014-01-22 16:40:48 -0500] mattt: iartarisi: ping
[2014-01-22 16:40:52 -0500] iartarisi: mattt: pong
[2014-01-22 16:40:54 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-network: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68383
[2014-01-22 16:41:26 -0500] mattt: iartarisi: https://review.openstack.org/#/c/66873/14/attributes/messaging.rb
[2014-01-22 16:41:27 -0500] mancdaz: just so I'm clear - what is proposed? To remove the RDO yum repo setup altogether from common?
[2014-01-22 16:41:27 -0500] mrodden: i would be fine with a patch that disables the current RDO repo resource
[2014-01-22 16:41:38 -0500] mrodden: sorry
[2014-01-22 16:41:43 -0500] mancdaz: mrodden ok
[2014-01-22 16:41:51 -0500] mrodden: patch that adds some attribute that disables the RDO repo resource
[2014-01-22 16:41:59 -0500] mrodden: an only_if line
[2014-01-22 16:42:10 -0500] ctracey: :)
[2014-01-22 16:42:10 -0500] mancdaz: so leave the default rdo setup there, but allow it to be disabled, but do not provide the ability to specify any other repo?
[2014-01-22 16:42:19 -0500] mattt: iartarisi: are you saying i should change the openstack.mq.SERVICE.username attribute to openstack.mq.SERVICE.user, or openstack.mq.user attribute to openstack.mq.username?  or something else entirely?  :P
[2014-01-22 16:42:24 -0500] claco: that all seems just as broken
[2014-01-22 16:42:25 -0500] mrodden: yes
[2014-01-22 16:42:35 -0500] andymccr: iartarisi: does changing from Partial Bug to Partial-Bug actually change anything? At the moment they do seem linked to the launchpad bug.
[2014-01-22 16:42:46 -0500] mrodden: claco: yes
[2014-01-22 16:42:53 -0500] mrodden: but the RDO patch is in
[2014-01-22 16:43:01 -0500] iartarisi: andymccr: well i didn't see the link in gerrit, that's why i made that comment
[2014-01-22 16:43:07 -0500] claco: rather then enable/disable... why not move it to a recipe...that people can choose, or not, to run_list..
[2014-01-22 16:43:08 -0500] mancdaz: you're welcome :)
[2014-01-22 16:43:14 -0500] claco: and we ship a default role with it in the run list?
[2014-01-22 16:43:19 -0500] mrodden: claco: i would be ok with that too
[2014-01-22 16:43:29 -0500] claco: well... how 'required' is the RDO stuff for CentOS now?
[2014-01-22 16:43:29 -0500] andymccr: iartarisi: thats weird, mine seems to work - can you double check? I can easily change it but it seems to work fine for me
[2014-01-22 16:43:29 -0500] mancdaz: claco where would that recipe live?
[2014-01-22 16:43:31 -0500] iartarisi: mattt: openstack.mq.service.rabbit.username to ...rabbit.userid
[2014-01-22 16:43:47 -0500] mancdaz: claco: if we don't enable that repo, we can't install havana
[2014-01-22 16:43:50 -0500] claco: mancdaz: common... dropping the repos is a common task before running other recipes
[2014-01-22 16:44:10 -0500] mancdaz: claco: so you're arguing separately to mrodden and ctracey
[2014-01-22 16:44:12 -0500] andymccr: iartarisi: actually nm that, its not working - i'll fix
[2014-01-22 16:44:20 -0500] mancdaz: who are advocating it not live in common at all
[2014-01-22 16:44:20 -0500] iartarisi: :)
[2014-01-22 16:44:34 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-identity: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68378
[2014-01-22 16:44:47 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-network: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68383
[2014-01-22 16:44:54 -0500] mancdaz: I would be ok with separating it into a recipe in common, which could be implemented in the parent repo by including it in a role
[2014-01-22 16:45:15 -0500] mancdaz: ultimately, though, the functonality would be the same right?
[2014-01-22 16:45:15 -0500] ctracey: +1 on separation of concerns
[2014-01-22 16:45:24 -0500] claco: mancdaz: sounds like it
[2014-01-22 16:45:27 -0500] iartarisi: andymccr: cool, thanks
[2014-01-22 16:45:27 -0500] mattt: iartarisi: ah, you're referring to rabbit_userid in the openstack confs?
[2014-01-22 16:45:41 -0500] claco: I think on this we all agree: repo dropping vi attributes pile on in default seems wrongly
[2014-01-22 16:45:42 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-image: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68379
[2014-01-22 16:45:44 -0500] mrodden: i wouldn't be against an RDO recipe in common
[2014-01-22 16:45:50 -0500] mrodden: i wouldn't be using it obviously
[2014-01-22 16:45:59 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-metering: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68380
[2014-01-22 16:46:01 -0500] iartarisi: mattt: right, i think the attribute name should match the one in the config. Right now it's userid in the configs and username in our recipes.
[2014-01-22 16:46:09 -0500] iartarisi: wow, this channel is getting too busy
[2014-01-22 16:46:16 -0500] claco: ha
[2014-01-22 16:46:21 -0500] claco: 0 to 60 in about 10 minutes
[2014-01-22 16:46:37 -0500] iartarisi: I'll just buy a bigger monitor
[2014-01-22 16:46:40 -0500] mancdaz: mrodden: but not a generic 'repo' recipe that could be used to drop in any yum repo, since that is essentially just abstracting the yum_repo resource
[2014-01-22 16:46:58 -0500] ctracey: i still really dont think it belongs in common...but...thats me
[2014-01-22 16:47:01 -0500] ctracey: common, for me, was always meant for openstack common bits and that is it
[2014-01-22 16:47:04 -0500] mattt: iartarisi: yeah, i understand now ... my fear is that i keep having to make minor changes (and this would touch a lot of cookbooks) meaning this mq/db change will never go through
[2014-01-22 16:47:08 -0500] ctracey: it is now eveolving to become a reference cookbook
[2014-01-22 16:47:31 -0500] iartarisi: mattt: I thought this was the first change in the series :)
[2014-01-22 16:47:33 -0500] mrodden: right... i mean my recipe right now consists of 10 lines of yum_repo block
[2014-01-22 16:47:48 -0500] mattt: iartarisi: that's what i was aiming for, but this change has been sitting for a week now :P
[2014-01-22 16:47:59 -0500] mattt: iartarisi: i was hoping to do an initial pass and then tweak later
[2014-01-22 16:47:59 -0500] mancdaz: ctracey: it seems to me that common is really for stuff that overarches all the other cookbooks. setting up the right package repos for them to use seems like it should live in common
[2014-01-22 16:48:16 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-image: Complete Rubocop compliancy  https://review.openstack.org/67871
[2014-01-22 16:48:35 -0500] iartarisi: mattt: ok, ok :)
[2014-01-22 16:48:48 -0500] mancdaz: mrodden: I understand, but the yum repo block has to live in some recipe somewhere
[2014-01-22 16:48:58 -0500] mancdaz: I mean someone has to call it to install the repos
[2014-01-22 16:49:06 -0500] mancdaz: so why not in our openstack cookbooks?
[2014-01-22 16:49:07 -0500] mrodden: yes
[2014-01-22 16:49:23 -0500] mrodden: its easily doable in a pluggable recipe?
[2014-01-22 16:49:27 -0500] mattt: iartarisi: i have a couple of other changes that i was going to do in subsequent passes -- i can make them all now and we just keep rebasing until this series goes through :)
[2014-01-22 16:49:37 -0500] mrodden: and you dont have to write new attributes that wrap the things that go into it
[2014-01-22 16:49:49 -0500] ctracey: fwiw...i dont think any of this should be in comon
[2014-01-22 16:49:57 -0500] ctracey: yum, apt, whatever
[2014-01-22 16:50:01 -0500] hughsaunders: where would you add the repos ctracey?
[2014-01-22 16:50:20 -0500] ctracey: i would add them early ina  runlist
[2014-01-22 16:50:22 -0500] iartarisi: mattt: right, I think the problem with fixing things later in this is that we're going to have to change all the other cookbooks later
[2014-01-22 16:50:26 -0500] claco: how can it NOT be in common, if it's required for a functioning havana deploy?
[2014-01-22 16:50:31 -0500] ctracey: by any number of means
[2014-01-22 16:50:37 -0500] ctracey: chef-openstack-repo?
[2014-01-22 16:50:40 -0500] iartarisi: mattt: whereas right now there's only one place to fix AFAICS
[2014-01-22 16:50:41 -0500] ctracey: my own recipe?
[2014-01-22 16:50:51 -0500] mattt: iartarisi: that is true, but we'd have to do it in a way that deprecates attributes etc ...
[2014-01-22 16:50:57 -0500] hughsaunders: will each end user have to write their own recipe to add repos?
[2014-01-22 16:51:01 -0500] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-compute: Update recipes to be rubocop compliant  https://review.openstack.org/68094
[2014-01-22 16:51:06 -0500] mancdaz: claco: that's my argument. Why do we want to require users of the cookbooks to have to write additional recipes to use the cookbooks in a functional manner
[2014-01-22 16:51:08 -0500] mattt: iartarisi: ok, let me mark these changes as a work in progress
[2014-01-22 16:51:15 -0500] mattt: iartarisi: and i'll get the rest of the work done tomorrow
[2014-01-22 16:51:17 -0500] ctracey: hughsaunders, this is already the case for db and messaging
[2014-01-22 16:51:23 -0500] mattt: iartarisi: and if someone then asks me to do something further, i'll just abort all the changes
[2014-01-22 16:51:26 -0500] mattt: :P
[2014-01-22 16:51:36 -0500] mrodden: there are plenty of shared yum_repo type recipes out on github
[2014-01-22 16:51:40 -0500] mrodden: no one would have to write their own
[2014-01-22 16:52:14 -0500] claco: can we just move the repo stuff from default to a recipe... and rehave this argument again after that? :-)
[2014-01-22 16:52:16 -0500] mrodden: they were all recently split out of the yum cookbook itself i believe
[2014-01-22 16:52:26 -0500] mancdaz: mrodden: ok but my point is that personally I'd want to see this all self contained
[2014-01-22 16:52:47 -0500] ctracey: but it is already not self-contained
[2014-01-22 16:52:50 -0500] mrodden: yes
[2014-01-22 16:52:55 -0500] ctracey: by design
[2014-01-22 16:52:55 -0500] mrodden: mysql, rabbitmq, erlang
[2014-01-22 16:52:58 -0500] mrodden: you pull all that in
[2014-01-22 16:53:30 -0500] mrodden: cookbooks and recipes are supposed to be modular
[2014-01-22 16:53:58 -0500] mrodden: but i think the most practical solution at the moment is what claco is suggesting
[2014-01-22 16:54:46 -0500] ctracey: yes...though i would personally prefer that an RDO, apt, whatever recipe land in openstack-repo
[2014-01-22 16:54:56 -0500] ctracey: as a reference
[2014-01-22 16:55:12 -0500] mattt: iartarisi: all marked WIP, going to get some more requested changes in tomorrow and then see how we fare :)
[2014-01-22 16:55:17 -0500] mrodden: so that would be another cookbook?
[2014-01-22 16:55:26 -0500] ctracey: we already have that cookbook
[2014-01-22 16:55:43 -0500] mrodden: we do?....
[2014-01-22 16:55:47 -0500] mancdaz: to be fair, whilst I accept that the openstack-repo, and the -ops- cookbooks are technically external to the core cookbooks for the openstack services, they are really part of the self-contained world that I was talking about
[2014-01-22 16:55:47 -0500] ctracey: https://github.com/stackforge/openstack-chef-repo
[2014-01-22 16:56:05 -0500] ctracey: "This repository contains examples of the roles, environments and other supporting files for deploying an OpenStack Havana reference architecture using Chef."
[2014-01-22 16:56:13 -0500] mrodden: oh but that is a chef/knife repo
[2014-01-22 16:56:16 -0500] mancdaz: ctracey that is not a cookbook
[2014-01-22 16:56:33 -0500] mrodden: i was thinking you would have another entry in the berksfile that points to a new cookbook...
[2014-01-22 16:56:35 -0500] ctracey: indeed it is not
[2014-01-22 16:56:53 -0500] iartarisi: mattt: cool
[2014-01-22 16:56:56 -0500] ctracey: i stand corrected re:cookbook vs chef repo
[2014-01-22 16:57:26 -0500] mancdaz: so within that repo, to hold a 'yum, apt, we' repo recipe, we'd need a new cookbook
[2014-01-22 16:57:35 -0500] mancdaz: or at least to reference a new cookbook
[2014-01-22 16:57:41 -0500] mancdaz: not 'within' that repo
[2014-01-22 16:57:46 -0500] ctracey: why dont we just do this...
[2014-01-22 16:57:52 -0500] claco: I propose this...
[2014-01-22 16:57:54 -0500] mancdaz: cookbook-openstack-ops-packages
[2014-01-22 16:57:56 -0500] ctracey: though i dont love it, i can live with it
[2014-01-22 16:58:16 -0500] ctracey: just drop it in common as a stand-alone recipe
[2014-01-22 16:58:23 -0500] hughsaunders: +1
[2014-01-22 16:58:29 -0500] claco: send an email to the list with pros/cons of the 3 ways: attributes munging, repo recipe, do nothing(end user problem...
[2014-01-22 16:58:32 -0500] ctracey: same should go for apt
[2014-01-22 16:58:43 -0500] ctracey: if we find that it is not good, we can always move it later
[2014-01-22 16:58:48 -0500] hughsaunders: why not one recipe that does the right thing for different distros?
[2014-01-22 16:59:07 -0500] ctracey: that would not be good, imo
[2014-01-22 16:59:22 -0500] mrodden: hughsaunders: i think the "right thing" is dependent upon context
[2014-01-22 16:59:26 -0500] ctracey: we already have separation of concerns issues with these cookbook
[2014-01-22 16:59:33 -0500] mancdaz: ok so that patch as it stands needs to only allow disabling of the RDO repo drop
[2014-01-22 16:59:51 -0500] mancdaz: which to be fair was what was originally proposed 13 patchsets ago :)
[2014-01-22 17:00:06 -0500] ctracey: mancdaz, that is not what i am saying
[2014-01-22 17:00:27 -0500] ctracey: if it is an RDO recipe, i need to call it in the runlist to make it work
[2014-01-22 17:00:56 -0500] mancdaz: ctracey: I just talking about step one of the work - before we create the new recipes in common
[2014-01-22 17:00:59 -0500] ctracey: i am not a fan of this "if something then include_recipe" stuff
[2014-01-22 17:01:03 -0500] mancdaz: the existing patch
[2014-01-22 17:01:24 -0500] hughsaunders: why can't a single recipe do this: if ~redhat setup sensible public openstack yum repo, if ~debian, setup sensible public openstack apt repo
[2014-01-22 17:01:54 -0500] mancdaz: the original point of the patch was "I don't want the RDO repo since I manually configured my own"
[2014-01-22 17:02:36 -0500] mancdaz: I think we should probably let that happen as it was originally proposed, and then in  separate work move all the repo stuff (ubuntu, centos etc) into the new recipe(s)
[2014-01-22 17:02:56 -0500] mancdaz: if that's the general consensus
[2014-01-22 17:03:51 -0500] mrodden: so you are suggesting merge this https://review.openstack.org/#/c/66803/ as is, and then do the work to move repo stuff later?
[2014-01-22 17:04:55 -0500] ctracey: hah: https://github.com/stackforge/cookbook-openstack-common/blob/master/recipes/default.rb#L85
[2014-01-22 17:04:58 -0500] mancdaz: mrodden actually I was suggesting reverting to the original patchset which was just to allow turning off the rdo repo drop
[2014-01-22 17:05:02 -0500] ctracey: iartarisi, is a prophet
[2014-01-22 17:05:09 -0500] mrodden: i'm lagging again... sigh
[2014-01-22 17:05:17 -0500] hughsaunders: haha
[2014-01-22 17:05:39 -0500] mancdaz: personally I would allow the current patch in, but general consensus seems to not like that
[2014-01-22 17:05:57 -0500] mancdaz: so for now we at least need to allow a user to NOT have the RDO repo droppedin
[2014-01-22 17:06:01 -0500] iartarisi: ctracey: I always tell people that, but no one ever takes me seriously.
[2014-01-22 17:06:07 -0500] mrodden: lol
[2014-01-22 17:06:19 -0500] ctracey: iartarisi, if you really are, it will happen one day :)
[2014-01-22 17:06:21 -0500] mrodden: mancdaz: i would be alright with that
[2014-01-22 17:07:07 -0500] mancdaz: for my edification though, what are the arguments of separate recipes, vs a single recipe with if/else blocks?
[2014-01-22 17:07:47 -0500] ctracey: attributes require intimate knowledge of how the recipe is written
[2014-01-22 17:07:49 -0500] mancdaz: eg: monilithic recipe: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/repo.rb
[2014-01-22 17:08:06 -0500] ctracey: miss an attribute, get undesirable config
[2014-01-22 17:08:36 -0500] claco: ctracey: then curse :immediately in your wrapper cbook :-)
[2014-01-22 17:08:59 -0500] mancdaz: ctracey: no, regardless of whether you're using attrs or hardcoding values, why not have an if else block wrapping platform_family?
[2014-01-22 17:09:03 -0500] ctracey: claco, thats a whole nother issue :)
[2014-01-22 17:10:05 -0500] ctracey: mancdaz, if youre keying off of platform_family, my only downside is that the recipe becomes unwieldy
[2014-01-22 17:10:21 -0500] ctracey: but that is just my prefernce
[2014-01-22 17:10:21 -0500] mancdaz: see example recipe above - it's tiny
[2014-01-22 17:10:40 -0500] ctracey: yeah...that is fine
[2014-01-22 17:10:52 -0500] ctracey: i am getting at the case when attrs are involved
[2014-01-22 17:10:58 -0500] mancdaz: so then in theory, our 'package' recipe in common could cover all platform_families, rather than a recipe per platform
[2014-01-22 17:11:12 -0500] mancdaz: ctracey: ok so you'd not have any repo stuff set by attr?
[2014-01-22 17:11:23 -0500] mancdaz: it would all be hardcoded in recipe?
[2014-01-22 17:11:24 -0500] ctracey: ie. here: https://github.com/stackforge/cookbook-openstack-compute/blob/master/recipes/compute.rb#L27
[2014-01-22 17:11:48 -0500] ctracey: mancdaz, come on
[2014-01-22 17:11:58 -0500] mattray: greetings
[2014-01-22 17:12:24 -0500] mancdaz: ctracey: sorry I wasn't being awkward - it was a genuine question. I'm obviously missing the point
[2014-01-22 17:12:46 -0500] ctracey: mancdaz, in that example I just posted....
[2014-01-22 17:12:59 -0500] ctracey: there is no reason why compute should decide to include network
[2014-01-22 17:13:07 -0500] ctracey: likewise, the line above it
[2014-01-22 17:13:32 -0500] mrodden: yeah... why api-metadata?
[2014-01-22 17:13:39 -0500] ctracey: recipes should be able to stand on their own
[2014-01-22 17:13:43 -0500] mancdaz: ctracey: ha, yes, that stuff is messy
[2014-01-22 17:13:44 -0500] ctracey: that is what makes them composable
[2014-01-22 17:14:04 -0500] claco: I think that's the current struggle... recipes that yield a working end result...vs forcing that up to roles.
[2014-01-22 17:14:06 -0500] ctracey: mixing attrs in there makes it harder to compose easily
[2014-01-22 17:14:18 -0500] claco: and recipes the do 1 thing and 1 thing well.
[2014-01-22 17:14:25 -0500] ctracey: claco, yes ++
[2014-01-22 17:14:27 -0500] mrodden: claco: ++
[2014-01-22 17:14:33 -0500] ctracey: you want it, you include the recipe
[2014-01-22 17:14:34 -0500] mancdaz: claco --
[2014-01-22 17:14:37 -0500] mancdaz: just kidding :)
[2014-01-22 17:14:39 -0500] ctracey: not key off an attr
[2014-01-22 17:14:47 -0500] claco: and honestly, that's tough here, esp when you starting doing HA on everything
[2014-01-22 17:15:13 -0500] mancdaz: so ok we move the packages stuff into a single(?) recipe in common
[2014-01-22 17:15:31 -0500] mancdaz: but we still allow the repo details to be defined in attrs
[2014-01-22 17:16:39 -0500] mancdaz: ??
[2014-01-22 17:17:31 -0500] ctracey: mattray, jump in to the fun :)
[2014-01-22 17:17:37 -0500] mancdaz: weeeee
[2014-01-22 17:17:58 -0500] claco: mattray: before you get lost in that...
[2014-01-22 17:18:07 -0500] mrodden: i am not sure how packaging is getting involved
[2014-01-22 17:18:11 -0500] mattray: just got here whut?
[2014-01-22 17:18:17 -0500] claco: can you elab on Seths comments on $4/5 in the spec refactor BP?
[2014-01-22 17:18:26 -0500] ctracey: that is better than it is now, still not in love with the attrs in common, but we can tackle that later
[2014-01-22 17:18:32 -0500] claco: going to hit a nother book if we're ok w/it
[2014-01-22 17:19:12 -0500] ctracey: fwiw - i like that we can have these lively discussions...makes us a strong community
[2014-01-22 17:19:27 -0500] mancdaz: ctracey: the collective mind of the hive :)
[2014-01-22 17:19:57 -0500] mrodden: i think we just need to be able to better define the pluggable points and what should be common/shared but optional
[2014-01-22 17:19:57 -0500] claco: or collective crackheadedness. for science!
[2014-01-22 17:20:03 -0500] ctracey: in other news, haproxy doesnt support conf.d
[2014-01-22 17:20:03 -0500] mancdaz: ok ctracey claco mrodden see my comment in https://review.openstack.org/#/c/66803/.  I think i succinctly summarised what we almost kind of agreed on
[2014-01-22 17:20:06 -0500] ctracey: that is FAIL
[2014-01-22 17:20:19 -0500] mancdaz: ctracey: yeah we had to drop a modified intifile
[2014-01-22 17:20:24 -0500] mrodden: ctracey: srsly?
[2014-01-22 17:20:35 -0500] ctracey: srsly
[2014-01-22 17:20:39 -0500] mrodden: wow
[2014-01-22 17:20:48 -0500] mancdaz: the haproxy author has made strong arguments for why he will never support conf.d
[2014-01-22 17:20:53 -0500] ctracey: yes
[2014-01-22 17:20:55 -0500] mattray: claco: he essentially said he wasn't a fan of refactoring to shared_contexts and shared_examples because most people over-consolidate without documenting enough what they are testing. So you end up with more testing black boxes
[2014-01-22 17:21:13 -0500] mancdaz: ctracey: I know this, as I did this work for our cookbooks :(
[2014-01-22 17:21:42 -0500] ctracey: mancdaz, thinking I might be able to hack /etc/default/haproxy
[2014-01-22 17:21:58 -0500] ctracey: still lame
[2014-01-22 17:22:01 -0500] mancdaz: ctracey: https://github.com/rcbops-cookbooks/haproxy/blob/master/files/default/haproxy-init-rhel
[2014-01-22 17:22:24 -0500] ctracey: mancdaz, got this for ansible?
[2014-01-22 17:22:26 -0500] ctracey: haha
[2014-01-22 17:22:33 -0500] mancdaz: ctracey sorry
[2014-01-22 17:22:42 -0500] claco: don't get me started on dist init file shanigans
[2014-01-22 17:22:43 -0500] ctracey: yeah me too
[2014-01-22 17:22:44 -0500] claco: :-)
[2014-01-22 17:23:12 -0500] mancdaz: claco: actually redhat/centos etc are generally much much better these days at conf.d stuff, which they never used to support at all
[2014-01-22 17:23:28 -0500] mancdaz: I think as of around 6.3
[2014-01-22 17:23:39 -0500] mancdaz: makes it so much easier with multi-platofmr cookbooks
[2014-01-22 17:23:50 -0500] ctracey: only took them a decade :)
[2014-01-22 17:23:59 -0500] claco: rhel7 will fix that for you
[2014-01-22 17:24:02 -0500] claco: :-)
[2014-01-22 17:24:10 -0500] claco: ok, breaks over.
[2014-01-22 17:25:28 -0500] mrodden: mancdaz: i will fix up that patch back to patchset 1 with some better naming of the attribute to reflect what it does in a bit
[2014-01-22 17:25:48 -0500] mrodden: i haven't even had time to shower yet today :(
[2014-01-22 17:26:09 -0500] mrodden: claco: yes thats probably smart
[2014-01-22 17:26:11 -0500] mrodden: :)
[2014-01-22 17:28:55 -0500] ctracey: i havent had one this month
[2014-01-22 17:30:39 -0500] mancdaz: k thanks all. Time to away
[2014-01-22 17:30:46 -0500] mancdaz: see you on the morrow
[2014-01-22 17:36:25 -0500] openstackgerrit: git-harry proposed a change to stackforge/cookbook-openstack-dashboard: Fix dashboard login errors  https://review.openstack.org/68446
[2014-01-22 17:42:32 -0500] ctracey: before I go ripping code out, can I get a consensus?
[2014-01-22 17:42:53 -0500] ctracey: https://github.com/stackforge/cookbook-openstack-compute/blob/master/recipes/compute.rb#L26
[2014-01-22 17:43:08 -0500] ctracey: are we cool with removing line 26 and 27-29?
[2014-01-22 17:43:33 -0500] ctracey: i do not think that network nor metadata should be pulled in this way
[2014-01-22 17:46:18 -0500] markvan: ctracey: hi
[2014-01-22 17:46:41 -0500] markvan: I like the idea, but would'nt that have a ripple effect on the role?
[2014-01-22 17:52:11 -0500] ctracey: markvan, how so?
[2014-01-22 17:52:19 -0500] ctracey: oh...the role?
[2014-01-22 17:52:27 -0500] mrodden: yeah that would be my concern too
[2014-01-22 17:52:30 -0500] ctracey: you mean in the chef repo?
[2014-01-22 17:52:31 -0500] mrodden: roles might need updating
[2014-01-22 17:52:41 -0500] ctracey: they def would
[2014-01-22 17:52:46 -0500] ctracey: but it is the right thing to do
[2014-01-22 17:52:50 -0500] mrodden: agreed
[2014-01-22 17:52:54 -0500] markvan: Yup, not a big deal, just something that would be needed along with this.
[2014-01-22 17:53:05 -0500] ctracey: and this is the right time to do the painful things :)
[2014-01-22 17:53:36 -0500] ctracey: i will update my review accordingly
[2014-01-22 17:53:48 -0500] ctracey: unfortunately, we cannot link between cookbooks
[2014-01-22 17:54:26 -0500] mrodden: we have the same issue with changes in oslo-incubator in openstack
[2014-01-22 17:54:48 -0500] mrodden: usually i post the change and ask someone to -2 it with a link to the dependent patch in Gerrit
[2014-01-22 17:55:18 -0500] mrodden: -2, do not merge until this is in
[2014-01-22 17:55:42 -0500] ctracey: yeah...can do
[2014-01-22 17:58:06 -0500] ctracey: or I could just make sure tests dont pass :)
[2014-01-22 17:58:11 -0500] ctracey: thats the easy part
[2014-01-22 18:17:46 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-compute: Remove inclusion of metadata and network recipes  https://review.openstack.org/68320
[2014-01-22 18:21:00 -0500] markvan: ctracey: good catch on https://review.openstack.org/#/c/68322/.  A quick grep shows that compute, image, dashboard, block-stor and metering might all suffer from same issue.
[2014-01-22 18:21:41 -0500] markvan: Looks like might need to review all executes for correct owner/group...
[2014-01-22 18:24:19 -0500] openstackgerrit: craigtracey proposed a change to stackforge/openstack-chef-repo: Add an os-compute-network role  https://review.openstack.org/68455
[2014-01-22 18:24:58 -0500] claco: markvan: *cough* :-)
[2014-01-22 18:25:31 -0500] claco: markvan: that moment.. where you grep the codebase for a patter..and omgs
[2014-01-22 18:25:36 -0500] ctracey: markvan, I will tackle those as I move through them
[2014-01-22 18:25:53 -0500] ctracey: i will also add group
[2014-01-22 18:26:34 -0500] markvan: ctracey: cool.
[2014-01-22 19:04:32 -0500] galstrom: ctracey: https://review.openstack.org/#/c/68320/3 are the removed recipes already in the run lists on the deployment roles?
[2014-01-22 19:14:45 -0500] galstrom: claco: https://review.openstack.org/#/c/68094/3
[2014-01-22 19:15:14 -0500] galstrom: claco: the <if condition> && <action> changes just look wrong
[2014-01-22 19:15:19 -0500] ctracey: galstrom, you mean in openstack-chef-repo?
[2014-01-22 19:15:24 -0500] galstrom: ctracey: yes?
[2014-01-22 19:15:30 -0500] galstrom: ctracey: sorry.. i meant yes
[2014-01-22 19:15:37 -0500] ctracey: https://review.openstack.org/#/c/68455/
[2014-01-22 19:15:48 -0500] ctracey: api-metadata is already in there
[2014-01-22 19:16:38 -0500] claco: galstrom: file?
[2014-01-22 19:16:55 -0500] galstrom: claco: nova-common, nova-setup
[2014-01-22 19:17:03 -0500] galstrom: ctracey: ok..
[2014-01-22 19:17:10 -0500] ctracey: galstrom, hold on
[2014-01-22 19:17:13 -0500] galstrom: ctracey: i just wanted to check that we had the right role
[2014-01-22 19:17:35 -0500] galstrom: ctracey: i was more asking if you had another patch going in against the chef-repo to add a meta-role
[2014-01-22 19:18:18 -0500] ctracey: that other review needs an update
[2014-01-22 19:18:19 -0500] ctracey: heh
[2014-01-22 19:18:46 -0500] galstrom: ctracey: :)
[2014-01-22 19:19:07 -0500] ctracey: spiceweasel
[2014-01-22 19:19:08 -0500] ctracey: heh
[2014-01-22 19:19:56 -0500] openstackgerrit: craigtracey proposed a change to stackforge/openstack-chef-repo: Add an os-compute-network role  https://review.openstack.org/68455
[2014-01-22 19:20:03 -0500] ctracey: galstrom, there ya go
[2014-01-22 19:20:34 -0500] galstrom: ctracey: thanks
[2014-01-22 19:23:14 -0500] ctracey: no thank you
[2014-01-22 19:26:23 -0500] mattray: paulczar: I mentioned earlier I had launched the vagrant instance nodes don't come up
[2014-01-22 19:26:32 -0500] paulczar: orly
[2014-01-22 19:26:38 -0500] paulczar: i can have a play
[2014-01-22 19:26:48 -0500] paulczar: from master ?
[2014-01-22 19:30:23 -0500] ctracey: galstrom, i have it prepped to add group
[2014-01-22 19:30:27 -0500] ctracey: just in rebase hell
[2014-01-22 19:31:33 -0500] claco: ctracey: is there any other kind?
[2014-01-22 19:31:46 -0500] galstrom: ctracey: cool
[2014-01-22 19:31:53 -0500] ctracey: claco, npe
[2014-01-22 19:36:56 -0500] mattray: paulczar: yeah, master late yesterday
[2014-01-22 19:37:22 -0500] mattray: paulczar: re-syncing for latest then digging into errors
[2014-01-22 19:38:55 -0500] mattray: openstack-infra/config Rubocop gating review here: https://review.openstack.org/#/c/67964/
[2014-01-22 19:38:59 -0500] mattray: jenkins is finally happy
[2014-01-22 19:41:47 -0500] paulczar: ctracey: https://review.openstack.org/#/c/68320/3 might mess with vagrant working
[2014-01-22 19:42:26 -0500] paulczar: from memory there's logic in compute and network to determine whether or not to use nova-network or neutron based on attribute
[2014-01-22 19:42:52 -0500] paulczar: otherwise there are circumstances where both get installed
[2014-01-22 19:44:16 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-identity: keystone-manage to be run by keystone user/group  https://review.openstack.org/68322
[2014-01-22 19:44:45 -0500] ctracey: ignore that
[2014-01-22 19:44:53 -0500] ctracey: goddamn rebase
[2014-01-22 19:45:03 -0500] claco: Race to Rebase!
[2014-01-22 19:45:49 -0500] ctracey: pulled the rubocop failures back in
[2014-01-22 19:45:51 -0500] ctracey: bastids
[2014-01-22 19:45:55 -0500] ctracey: fixing now
[2014-01-22 19:50:10 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-identity: keystone-manage to be run by keystone user/group  https://review.openstack.org/68322
[2014-01-22 19:51:09 -0500] paulczar: mattray: I've found a bug with the nova.conf:scheduler_default_filters
[2014-01-22 19:51:19 -0500] paulczar: mattray: which is breaking nova boots
[2014-01-22 19:51:24 -0500] mattray: paulczar: sweet
[2014-01-22 19:51:44 -0500] paulczar: manually fixing the config file and trying again  if that's all that's wrong should be an easy fix
[2014-01-22 19:51:45 -0500] mattray: paulczar: I'll be happy to help push the reviews faster
[2014-01-22 19:52:07 -0500] mattray: ~5 hours until I'm presenting on this stuff
[2014-01-22 19:52:14 -0500] mattray: maybe Vagrant will work ;)
[2014-01-22 19:52:18 -0500] paulczar: okay I'll have a patch in 6 hours
[2014-01-22 19:52:24 -0500] mattray: Grizzly it is
[2014-01-22 19:52:35 -0500] galstrom: mattray: you will need an old priest and a young priest
[2014-01-22 19:52:41 -0500] claco: lol
[2014-01-22 19:52:41 -0500] paulczar: vmstate: Active
[2014-01-22 19:52:57 -0500] claco: mattray: LIVE DEMO!
[2014-01-22 19:53:29 -0500] paulczar: sometimes I think I should just have ~/ open in sublimetext
[2014-01-22 19:53:31 -0500] mattray: galstrom: the power of Chef compels you!
[2014-01-22 19:53:43 -0500] galstrom: haha
[2014-01-22 19:53:47 -0500] galstrom: exactly
[2014-01-22 19:53:54 -0500] mattray: claco: I've walked through failed demos plenty of times
[2014-01-22 19:54:07 -0500] mattray: I'M STILL HERE TO TELL THE TALE
[2014-01-22 19:54:10 -0500] paulczar: it's not a mattray demo if shit doesn't explode
[2014-01-22 19:54:13 -0500] galstrom: bonus points.. if you had a mental image of Dr. Evil on a rotating chair saying that quote
[2014-01-22 19:54:14 -0500] ctracey: so why does Jenkins not tell me what failed?
[2014-01-22 19:54:14 -0500] claco: mattray: "live troubleshooting exercises" sir
[2014-01-22 19:54:15 -0500] ctracey: https://review.openstack.org/#/c/68324/
[2014-01-22 19:54:27 -0500] mattray: claco: that's where I draw the line
[2014-01-22 19:54:33 -0500] galstrom: ctracey: not rebased..
[2014-01-22 19:54:35 -0500] mattray: claco: "shit's broke, patches welcome"
[2014-01-22 19:54:39 -0500] galstrom: you are welcome?
[2014-01-22 19:54:44 -0500] claco: lol
[2014-01-22 19:54:55 -0500] galstrom: does not cleanly merge.. it is right there in the error message
[2014-01-22 19:55:01 -0500] claco: smells like Friday in here
[2014-01-22 19:55:05 -0500] galstrom: Oh!! you were looking for something helpful.. nope
[2014-01-22 19:55:07 -0500] mattray: hah
[2014-01-22 19:55:15 -0500] ctracey: galstrom, heh
[2014-01-22 19:55:23 -0500] ctracey: that is stupid
[2014-01-22 19:55:30 -0500] galstrom: ctracey: agreed
[2014-01-22 19:56:32 -0500] claco: wait.. are we talking about jenkins, or me?
[2014-01-22 19:56:37 -0500] claco: :-)
[2014-01-22 20:00:12 -0500] openstackgerrit: craigtracey proposed a change to stackforge/cookbook-openstack-identity: There is no need to bash boostrap keystone  https://review.openstack.org/68324
[2014-01-22 20:01:12 -0500] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-compute: bugfix: word list with quotes and commas? FAIL!  https://review.openstack.org/68468
[2014-01-22 20:01:48 -0500] paulczar: happy vagrantday mattray!
[2014-01-22 20:02:05 -0500] claco: paulczar: that patch is in another outstanding review iirc
[2014-01-22 20:02:31 -0500] claco: https://review.openstack.org/#/c/68081/
[2014-01-22 20:03:14 -0500] mattray: claco: I thought that looked familiar
[2014-01-22 20:03:26 -0500] paulczar: well now you get to choose the implementation you prefer! ;)
[2014-01-22 20:03:31 -0500] claco: welcome to the repository of worthless rememgerings
[2014-01-22 20:03:50 -0500] paulczar: fuck wordlists
[2014-01-22 20:03:56 -0500] claco: gerrit needs a dupe button
[2014-01-22 20:04:04 -0500] mattray: paulczar: I've already given my +2 to 68081, I cannot share my love
[2014-01-22 20:04:13 -0500] claco: lol
[2014-01-22 20:04:16 -0500] mattray: :)
[2014-01-22 20:05:02 -0500] mattray: galstrom: ctracey: spheromak: one of you want to push this bad boy through? https://review.openstack.org/#/c/68081/
[2014-01-22 20:05:38 -0500] paulczar: Abandoned!
[2014-01-22 20:05:42 -0500] claco: https://www.youtube.com/watch?v=vCadcBR95oU
[2014-01-22 20:05:47 -0500] mattray: paulczar: mattrayfailboat? awww
[2014-01-22 20:06:28 -0500] claco: thank the productivity gods that ruenrable.fm is dead.
[2014-01-22 20:06:34 -0500] claco: er turntable
[2014-01-22 20:08:43 -0500] mattray: claco: I've always thought more talks need to have sing-alongs http://www.youtube.com/watch?v=eCCRhMdQGkY
[2014-01-22 20:09:21 -0500] claco: nice, with the outfit even.
[2014-01-22 20:09:36 -0500] ctracey: mattray, done
[2014-01-22 20:09:48 -0500] mattray: ctracey: appreciated
[2014-01-22 20:10:02 -0500] ctracey: np man
[2014-01-22 20:10:26 -0500] ctracey: heh
[2014-01-22 20:11:53 -0500] paulczar: mattray: I tested through doing sec-group, add-key,  boot instance,  ssh into instance
[2014-01-22 20:11:55 -0500] paulczar: all worked fine
[2014-01-22 20:12:04 -0500] mattray: paulczar: cool, that's what I did
[2014-01-22 20:12:08 -0500] paulczar: will test again once the review gates
[2014-01-22 20:13:05 -0500] mattray: paulczar: yeah, me too
[2014-01-22 20:13:48 -0500] paulczar: k will leave you to test it then   if it fails ping me again   I'll go work on something that $JOB actually cares about :)
[2014-01-22 20:14:42 -0500] mattray: paulczar: danke!
[2014-01-22 20:31:13 -0500] spheromak: ctracey: you ubilding libvirt in your omni build ?
[2014-01-22 20:31:18 -0500] spheromak: we are hesitant to do this.
[2014-01-22 20:31:36 -0500] spheromak: since distroy kernel + libvirt are so interleaved
[2014-01-22 20:34:27 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-compute: Fix bug with %W formatting in attributes.rb  https://review.openstack.org/68081
[2014-01-22 20:34:27 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-dashboard: Delete openstack-dashboard.conf before start httpd service  https://review.openstack.org/67847
[2014-01-22 20:48:49 -0500] ctracey: spheromak, no
[2014-01-22 20:49:08 -0500] ctracey: spheromak, only openstack components themselves
[2014-01-22 21:03:23 -0500] spheromak: ctracey: problem we had was that libvirt-python wants libvirt. so linking to libvirt outside of omni for that is being problematic
[2014-01-22 21:16:58 -0500] ctracey: am I even pulling that in?
[2014-01-22 21:18:00 -0500] ctracey: spheromak, I am not including libvirt-python
[2014-01-22 21:18:17 -0500] ctracey: afaict
[2014-01-22 21:20:46 -0500] spheromak: ah
[2014-01-22 21:20:50 -0500] aspiers: any idea how I can place test-only recipes anywhere other than recipes/ ?
[2014-01-22 21:20:52 -0500] spheromak: could be the way around it I guess
[2014-01-22 21:21:07 -0500] aspiers: and still have them located by the normal recipe loading code?
[2014-01-22 21:21:43 -0500] spheromak: aspiers: for strianer you might be able to make a test/cookbooks *for kitchen compat* and work some strainer magic to get it loaded wihtout kitchen
[2014-01-22 21:21:46 -0500] spheromak: oh
[2014-01-22 21:21:54 -0500] spheromak: if its supporting berks, then you can just use berks
[2014-01-22 21:21:56 -0500] spheromak: to point at it there
[2014-01-22 21:22:09 -0500] aspiers: ok, I didn't understand any of that :)
[2014-01-22 21:22:15 -0500] spheromak: cookbook 'test_foo', path: test/cookbooks/test_foo
[2014-01-22 21:22:42 -0500] aspiers: I'm talking about recipes not cookbooks
[2014-01-22 21:22:45 -0500] spheromak: aspiers: im not 100% familliar with whats going on in the gates right now, but i know how to do that with other setups.
[2014-01-22 21:22:50 -0500] aspiers: it's all within a single cookbook
[2014-01-22 21:22:55 -0500] aspiers: I'm using chefspec
[2014-01-22 21:22:57 -0500] spheromak: well then i misunderstand
[2014-01-22 21:23:05 -0500] spheromak: thought you wanted a test recipe
[2014-01-22 21:23:06 -0500] aspiers: phew :)
[2014-01-22 21:23:11 -0500] aspiers: I do
[2014-01-22 21:23:14 -0500] spheromak: something that exercises the things that are used
[2014-01-22 21:23:18 -0500] aspiers: yes
[2014-01-22 21:23:29 -0500] spheromak: well that IMO should be a test cook, not in this cooks recipes. it's not something you want others to use
[2014-01-22 21:23:34 -0500] spheromak: the patter in kitchen land
[2014-01-22 21:23:40 -0500] spheromak: is to use test/cookbooks/foo
[2014-01-22 21:23:49 -0500] spheromak: and add that cook to your berksfile
[2014-01-22 21:23:52 -0500] spheromak: or cheffile
[2014-01-22 21:24:06 -0500] spheromak: er librarian thinggy
[2014-01-22 21:24:23 -0500] aspiers: I don't have a Berksfile / Cheffile / librarian thingy
[2014-01-22 21:24:26 -0500] spheromak: but for chef-spec you want it to be available
[2014-01-22 21:24:27 -0500] aspiers: it's a standalone cookbook
[2014-01-22 21:24:31 -0500] spheromak: yeap
[2014-01-22 21:24:51 -0500] spheromak: again i think maybe im not comminicating my point. That test recipe doesn't belong in recipes IMO
[2014-01-22 21:24:59 -0500] aspiers: that's exactly the point
[2014-01-22 21:25:02 -0500] spheromak: it belongs in a test cookbook that your testing stuff slurps up and uses
[2014-01-22 21:25:03 -0500] aspiers: I don't want to put it in recipes/
[2014-01-22 21:25:08 -0500] aspiers: I want to put it in spec/recipes/
[2014-01-22 21:25:19 -0500] spheromak: well test/cookbooks is what is used in kitchen but yea
[2014-01-22 21:25:34 -0500] spheromak: so then you need strainer.. are you using strainer ?
[2014-01-22 21:25:39 -0500] aspiers: no
[2014-01-22 21:25:43 -0500] spheromak: or whatever you are using to prep the test area...
[2014-01-22 21:25:45 -0500] aspiers: never heard of it
[2014-01-22 21:25:46 -0500] spheromak: well then
[2014-01-22 21:25:54 -0500] spheromak: so you are chefspec and nothing else
[2014-01-22 21:25:56 -0500] spheromak: ;)
[2014-01-22 21:26:04 -0500] aspiers: right
[2014-01-22 21:26:37 -0500] spheromak: chefspec does understand berks
[2014-01-22 21:26:38 -0500] aspiers: I'd really prefer not to have to pull in a bunch of extra dependencies just so that my cookbook can test itself ;-)
[2014-01-22 21:26:47 -0500] spheromak: well
[2014-01-22 21:26:57 -0500] spheromak: chefspec isn't sufficient to test a cookbook
[2014-01-22 21:26:58 -0500] spheromak: IMO
[2014-01-22 21:27:06 -0500] spheromak: so you end up needing alot more if you really want to test that thing
[2014-01-22 21:27:10 -0500] spheromak: i.e. kitchen
[2014-01-22 21:27:14 -0500] spheromak: but reguardless
[2014-01-22 21:27:33 -0500] spheromak: chefspec understand Berkshelfs syntax, and you could use that to tell the loader that there is another cookbook you want loaded
[2014-01-22 21:27:37 -0500] spheromak: and converge on that.
[2014-01-22 21:27:41 -0500] aspiers: hrmph
[2014-01-22 21:27:52 -0500] spheromak: if you don't want to do that
[2014-01-22 21:28:00 -0500] spheromak: look ad that loader in chefspec source
[2014-01-22 21:28:09 -0500] spheromak: and see how you can tell chefspec to look someplace else
[2014-01-22 21:28:15 -0500] aspiers: I'm already quite happily testing my LWRPs without anything else
[2014-01-22 21:28:22 -0500] aspiers: I just thought it might be cleaner to test them via recipes
[2014-01-22 21:28:29 -0500] spheromak:  @tmpdir
[2014-01-22 21:28:38 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-image: Complete Rubocop compliancy  https://review.openstack.org/67871
[2014-01-22 21:28:41 -0500] spheromak: aspiers: the way i do that is with kitchen
[2014-01-22 21:28:59 -0500] aspiers: spheromak: got an example I can look at?
[2014-01-22 21:29:53 -0500] spheromak: aspiers: gimme a sec
[2014-01-22 21:29:59 -0500] spheromak: looking for somethign public
[2014-01-22 21:30:29 -0500] spheromak: https://github.com/spheromak/sysctl-cookbook/blob/master/Berksfile
[2014-01-22 21:30:40 -0500] spheromak: thats the berks file that points at the test cook in the integration group
[2014-01-22 21:30:57 -0500] aspiers: thanks, I'll take a look!
[2014-01-22 21:31:05 -0500] aspiers: this is my spec https://github.com/aspiers/barclamp-pacemaker/blob/release/roxy/master/chef/cookbooks/pacemaker/spec/providers/primitive_spec.rb
[2014-01-22 21:31:24 -0500] aspiers: as you can see it currently just instantiates the LWRP provider directly
[2014-01-22 21:33:26 -0500] spheromak: https://github.com/cloudware-cookbooks/ktc-utils
[2014-01-22 21:33:29 -0500] spheromak: might be better
[2014-01-22 21:33:52 -0500] aspiers: I have no idea what those .bats files are
[2014-01-22 21:34:03 -0500] spheromak: dont worry
[2014-01-22 21:34:05 -0500] spheromak: ;)
[2014-01-22 21:34:09 -0500] spheromak: thats bats tests
[2014-01-22 21:34:24 -0500] spheromak: that ktc-utils is using kitchen and a tester cook
[2014-01-22 21:34:28 -0500] spheromak: since its a library cook
[2014-01-22 21:34:38 -0500] spheromak: prob the better example
[2014-01-22 21:34:48 -0500] spheromak: but its not using spec to do the lwrp/provider testing
[2014-01-22 21:35:00 -0500] spheromak: i think in chefspec 3 don't you wnat to write a matcher for your lwrp ?
[2014-01-22 21:36:01 -0500] spheromak: aspiers: i think you could tell chefspec to parse your other recipe too without all teh kitchen and berks and stuff. which seems to be what you want to do
[2014-01-22 21:36:20 -0500] aspiers: yeah, but how? :)
[2014-01-22 21:36:30 -0500] spheromak: im thinking/looking
[2014-01-22 21:36:37 -0500] aspiers: I really don't need a whole test cookbook - I just wanna unit-test my LWRP provider
[2014-01-22 21:36:54 -0500] aspiers: like I'm already doing
[2014-01-22 21:37:21 -0500] spheromak: well
[2014-01-22 21:37:22 -0500] aspiers: I should write a matcher too, yes
[2014-01-22 21:37:26 -0500] spheromak: if you do Chef::Node.new
[2014-01-22 21:37:27 -0500] aspiers: but that's a level up
[2014-01-22 21:37:31 -0500] spheromak: you may be able to run the recipe loader
[2014-01-22 21:37:33 -0500] spheromak: into that instance
[2014-01-22 21:37:38 -0500] spheromak: foo = Chef::Node.new
[2014-01-22 21:38:00 -0500] aspiers: I get my node from the Runner
[2014-01-22 21:38:15 -0500] spheromak: yea but you sorta want to fake that don't ya
[2014-01-22 21:38:27 -0500] spheromak: or hand it a run_context with your recipe loaded
[2014-01-22 21:38:30 -0500] spheromak: 'test recipe'
[2014-01-22 21:38:46 -0500] aspiers: that's actually sorta what I was doing before
[2014-01-22 21:38:56 -0500] aspiers: copied that code from somewhere else
[2014-01-22 21:39:10 -0500] aspiers: but ended up with two run_contexts which screwed it up massively
[2014-01-22 21:39:26 -0500] spheromak: https://github.com/sethvargo/chefspec/blob/master/lib/chefspec/runner.rb#L65-L73
[2014-01-22 21:39:27 -0500] aspiers: basically broke chefspec's ACTION_RESOURCE matchers
[2014-01-22 21:39:33 -0500] spheromak: you can hand it a path to ythe cookbook
[2014-01-22 21:39:47 -0500] aspiers: I already tried that
[2014-01-22 21:39:57 -0500] spheromak: has to be a test cook tho
[2014-01-22 21:40:00 -0500] spheromak: right
[2014-01-22 21:40:10 -0500] aspiers: yeah
[2014-01-22 21:40:25 -0500] aspiers: well I suppose I could live with wrapping my test recipe in a test cookbook
[2014-01-22 21:40:32 -0500] aspiers: actually that sounds cleanest
[2014-01-22 21:40:37 -0500] spheromak: thgats what im saying
[2014-01-22 21:40:39 -0500] spheromak: ;)
[2014-01-22 21:40:45 -0500] aspiers: no need to create a run_context though
[2014-01-22 21:40:47 -0500] spheromak: test/cookbooks/foo_tester/recipes
[2014-01-22 21:40:55 -0500] spheromak: or spec/cookbooks
[2014-01-22 21:40:57 -0500] spheromak: w/e
[2014-01-22 21:41:00 -0500] aspiers: just config.cookbook_path = [ ... ]
[2014-01-22 21:41:03 -0500] aspiers: in RSpec.configure
[2014-01-22 21:41:08 -0500] spheromak: yea could do that too on that set of tests
[2014-01-22 21:41:20 -0500] spheromak: and what i originally was saying
[2014-01-22 21:41:28 -0500] spheromak: but it doesn't really mater.
[2014-01-22 21:41:37 -0500] aspiers: ok we got there in the end
[2014-01-22 21:41:40 -0500] aspiers: :)
[2014-01-22 21:41:48 -0500] spheromak: :D
[2014-01-22 21:42:08 -0500] aspiers: if I had any control over it I would get my company to pay you for your time
[2014-01-22 21:42:14 -0500] aspiers: really appreciate your help
[2014-01-22 21:42:15 -0500] spheromak: lol
[2014-01-22 21:42:26 -0500] mattray: by Crom it worked.
[2014-01-22 21:42:43 -0500] mattray: Chef Run complete in 1565.360675548 seconds
[2014-01-22 21:42:53 -0500] spheromak: are you now the thief king ?
[2014-01-22 21:42:55 -0500] spheromak: oh
[2014-01-22 21:43:07 -0500] spheromak: long ass run
[2014-01-22 21:43:12 -0500] mattray: spheromak: paulczar: vagrant works
[2014-01-22 21:43:18 -0500] spheromak: nice
[2014-01-22 21:43:29 -0500] mattray: node created and ssh'd in
[2014-01-22 21:43:40 -0500] paulczar: hi5
[2014-01-22 21:43:43 -0500] mattray: sure it's nova_network, but it's Havana
[2014-01-22 21:43:47 -0500] spheromak: mattray: does it model complex networking ?
[2014-01-22 21:43:52 -0500] spheromak: :D
[2014-01-22 21:44:06 -0500] mattray: spheromak: at this point I don't care
[2014-01-22 21:44:21 -0500] spheromak: yea right
[2014-01-22 21:44:25 -0500] spheromak: its a start
[2014-01-22 21:44:37 -0500] paulczar: Havana is short for Havana run neutron already
[2014-01-22 21:44:45 -0500] mattray: paulczar: lol
[2014-01-22 21:44:53 -0500] aspiers: is there a knife command I can use to create a skeleton test cookbook?
[2014-01-22 21:45:04 -0500] paulczar: knife init
[2014-01-22 21:45:30 -0500] paulczar: or you can be hella cool and use meez
[2014-01-22 21:45:40 -0500] aspiers: knife init just shows me help
[2014-01-22 21:45:48 -0500] mattray: paulczar: I expected you to lead with meez
[2014-01-22 21:46:10 -0500] spheromak: aspiers: i wish
[2014-01-22 21:46:18 -0500] paulczar: if knife fails for him first, then meez looks slightly less shit than it really is
[2014-01-22 21:46:20 -0500] spheromak: aspiers: its a plugin i've thought of writing
[2014-01-22 21:46:40 -0500] spheromak: https://github.com/spheromak/test_cook_skeleton
[2014-01-22 21:46:43 -0500] spheromak: is a bit dated
[2014-01-22 21:46:48 -0500] spheromak: I got some stuff i need to push into it
[2014-01-22 21:46:55 -0500] paulczar: gem install meez && meez -o /tmp cookbook-name
[2014-01-22 21:47:06 -0500] spheromak: oh meez is a thing ?
[2014-01-22 21:47:10 -0500] aspiers: paulczar: do you really mean knife init? that subcommand doesn't exist here
[2014-01-22 21:47:13 -0500] paulczar: https://github.com/paulczar/meez
[2014-01-22 21:47:33 -0500] spheromak: oh
[2014-01-22 21:47:37 -0500] paulczar: DONT LOOK AT THE CODE
[2014-01-22 21:47:50 -0500] spheromak: paulczar: can i customize the template ?
[2014-01-22 21:48:32 -0500] spheromak: :|
[2014-01-22 21:48:39 -0500] paulczar: spheromak: not yet  but I have plans   but no time, and less skills
[2014-01-22 21:48:47 -0500] spheromak: paulczar: man I feel ya
[2014-01-22 21:48:50 -0500] spheromak: on all accounts
[2014-01-22 21:48:52 -0500] spheromak: hahah
[2014-01-22 21:49:10 -0500] spheromak: onlyt hing that meez doens't have is my rake:ci task :)
[2014-01-22 21:49:24 -0500] spheromak: might just rip this off
[2014-01-22 21:49:39 -0500] paulczar: yeah, plan to add a rake task and then a .travis.yml
[2014-01-22 21:49:46 -0500] aspiers: bad response Gateway Time-out 504
[2014-01-22 21:49:54 -0500] aspiers: awesome
[2014-01-22 21:50:05 -0500] aspiers: quicker to create by hand I think
[2014-01-22 21:50:07 -0500] ctracey: anybody have experience with vagrant and variables in the Vagrantfile?
[2014-01-22 21:50:12 -0500] spheromak: ctracey: heaps
[2014-01-22 21:50:35 -0500] ctracey: spheromak, so  what I would think to be local variables seem not to be
[2014-01-22 21:50:43 -0500] ctracey: is this a thing?
[2014-01-22 21:50:50 -0500] paulczar: ctracey: yeah, I use env variables all through my vagrantfiles
[2014-01-22 21:51:09 -0500] paulczar: I even push and pull from vagrant's ARGV to inject my own help
[2014-01-22 21:51:25 -0500] ctracey: i am looping over NUM_SWIFT_NODES and trying to use the index for that loop as a variable
[2014-01-22 21:51:30 -0500] ctracey: seems to bork
[2014-01-22 21:52:37 -0500] paulczar: okay,  so you can spin up an arbitrary number of the same node ?
[2014-01-22 21:53:09 -0500] ctracey: thats the goal
[2014-01-22 21:53:14 -0500] ctracey: but not the result
[2014-01-22 21:53:17 -0500] spheromak: ctracey: https://gist.github.com/spheromak/315355a6e20af5419709
[2014-01-22 21:53:25 -0500] spheromak: you will have to use procs
[2014-01-22 21:53:34 -0500] spheromak: look @  config.rb
[2014-01-22 21:54:38 -0500] ctracey: heh
[2014-01-22 21:54:47 -0500] ctracey: yes...i think this is what i may need
[2014-01-22 21:54:53 -0500] spheromak: probably
[2014-01-22 21:54:54 -0500] spheromak: ;)
[2014-01-22 21:54:59 -0500] spheromak: thats our repo Vagrant setup
[2014-01-22 21:55:23 -0500] ctracey: let me give this a whirl
[2014-01-22 21:56:03 -0500] aspiers: spheromak: now I think I need to somehow specify a dependency on the test cookbook at test run-time only
[2014-01-22 21:56:12 -0500] aspiers: spheromak: without polluting the main metadata.rb
[2014-01-22 21:56:29 -0500] mattray: 28 minutes chef-client run for the Vagrant build means no live demo tonight, that's brutal
[2014-01-22 21:56:32 -0500] spheromak: aspiers: yea thats why the kitchen is good. its a test-only run_list, but meh
[2014-01-22 21:56:55 -0500] spheromak: aspiers: the other way is to use something that copies your test cook and source cook into a tmpdir and then uses that as a repo
[2014-01-22 21:56:59 -0500] spheromak: right
[2014-01-22 21:57:03 -0500] spheromak: thats what strainer does
[2014-01-22 21:57:16 -0500] spheromak: or use a Berksfile
[2014-01-22 21:57:32 -0500] spheromak: and the chefspec/berksfile loader
[2014-01-22 21:58:06 -0500] spheromak: # spec_helper.rb
[2014-01-22 21:58:08 -0500] spheromak: require 'chefspec'
[2014-01-22 21:58:10 -0500] spheromak: require 'chefspec/berkshelf'
[2014-01-22 21:58:20 -0500] aspiers: *sigh*
[2014-01-22 21:58:22 -0500] spheromak: or
[2014-01-22 21:58:24 -0500] aspiers: I guess I'll have to give in
[2014-01-22 21:58:25 -0500] spheromak: you can do it all by hand
[2014-01-22 21:58:35 -0500] spheromak: having a Berksfile or cheffile
[2014-01-22 21:58:41 -0500] spheromak: doens't mean you need berks :D
[2014-01-22 21:59:00 -0500] aspiers: chefspec/berkshelf.rb requires berkshelf
[2014-01-22 21:59:00 -0500] spheromak: by hand you would creete a dir. copy your cooks into that dir, and then set the cookbook_path to that dir
[2014-01-22 21:59:04 -0500] spheromak: yea
[2014-01-22 21:59:17 -0500] spheromak: so you just ahve to do the steps by hand... '
[2014-01-22 21:59:17 -0500] aspiers: I don't see what that gives me over where I am right now
[2014-01-22 21:59:22 -0500] spheromak: which is reinventing wheeels
[2014-01-22 21:59:26 -0500] aspiers: cookbook_path already points to the right place
[2014-01-22 21:59:31 -0500] aspiers: but the dependency isn't modelled
[2014-01-22 21:59:35 -0500] spheromak: does that place have 2 cooks ?
[2014-01-22 21:59:39 -0500] aspiers: no
[2014-01-22 21:59:42 -0500] spheromak: then no its not right
[2014-01-22 21:59:46 -0500] aspiers: ?
[2014-01-22 21:59:50 -0500] spheromak:  /tmp/sandbox/mycook
[2014-01-22 21:59:54 -0500] spheromak:  /tmp/sandbox/mycook_tester
[2014-01-22 22:00:01 -0500] spheromak: path = /tmp/sandbox
[2014-01-22 22:00:18 -0500] aspiers: spec/spec_helper.rb just sets cookbook_path to File.join(File.dirname(__FILE__), 'cookbooks')
[2014-01-22 22:00:38 -0500] spheromak: right but that doesn't include your source cook
[2014-01-22 22:00:46 -0500] spheromak: im working on 'hotsauce' cook
[2014-01-22 22:00:52 -0500] aspiers: it can be an array
[2014-01-22 22:00:54 -0500] spheromak: so pwd: ~/hotsauce
[2014-01-22 22:01:06 -0500] spheromak: ok did that not work ?
[2014-01-22 22:02:22 -0500] spheromak: when I did this ages ago by hand. I had to coalesce all cooks into a repo-esq cookboks dir. this was in like chefspec 1.0 times tho when it was chef-solo under the hood
[2014-01-22 22:02:43 -0500] spheromak: aspiers: highly resillient to adding any other tools eh
[2014-01-22 22:02:49 -0500] spheromak: *resistant
[2014-01-22 22:05:44 -0500] ctracey: spheromak, looks like i just had some crap state around
[2014-01-22 22:05:47 -0500] ctracey: got it to work
[2014-01-22 22:05:52 -0500] ctracey: thanks!
[2014-01-22 22:12:15 -0500] ctracey: if anyone is feeling generous: https://review.openstack.org/#/c/68324/
[2014-01-22 22:12:34 -0500] ctracey: also: https://review.openstack.org/#/c/68322/
[2014-01-22 22:12:51 -0500] ctracey: and: https://review.openstack.org/#/c/68320/
[2014-01-22 22:12:52 -0500] ctracey: :)
[2014-01-22 22:19:05 -0500] paulczar: I refuse to +1 anything that removes bash
[2014-01-22 22:21:07 -0500] ctracey: hah
[2014-01-22 22:23:19 -0500] paulczar: mattray:  pre-load vagrant and then just shut it down and reload, reprovision
[2014-01-22 22:23:34 -0500] mattray: paulczar: maybe :)
[2014-01-22 22:23:46 -0500] paulczar: or save the box from the first run and load that instead of the regular base box
[2014-01-22 22:23:52 -0500] mattray: paulczar: I've already grabbed all the shell and put it in a .txt file
[2014-01-22 22:31:14 -0500] ctracey: paulczar, not sure I understand your concern on removing networks
[2014-01-22 22:31:59 -0500] ctracey: this is specifically removing the possibility that network be included
[2014-01-22 22:33:40 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-image: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68379
[2014-01-22 22:34:14 -0500] aspiers: spheromak: I think this is going to work https://github.com/aspiers/barclamp-pacemaker/commit/3bc4f704adce41b6ebd80c72bfd8a83003436bc0
[2014-01-22 22:36:34 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-block-storage: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68376
[2014-01-22 22:36:43 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-network: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68383
[2014-01-22 22:36:49 -0500] openstackgerrit: A change was merged to stackforge/cookbook-openstack-identity: Remove ambiguity in stubbed methods in spec_helper  https://review.openstack.org/68378
[2014-01-22 22:55:28 -0500] paulczar: mattray: my machine converges openstack on vagrant in 400secs
[2014-01-22 22:55:41 -0500] mattray: paulczar: fusion?
[2014-01-22 22:55:49 -0500] paulczar: mattray: nope vbox
[2014-01-22 22:56:10 -0500] mattray: crazy. My new machine will have fusion, which is supposed to be substantially faster
[2014-01-22 22:57:59 -0500] paulczar: ctracey: found this on the vagrant installs  even if you didn't include neutron some other cookbook was including it for me and causing both nova-networks and neutron to install and try to run     setting a network attribute of nova or quantum and then running or skipping those recipes based on that made sure that didn't happen.    pretty sure the lines you remove were involved in that safety logic
[2014-01-22 22:58:48 -0500] paulczar: mattray: welcome to use my laptop for the demo if you want to try and do it live
[2014-01-22 22:59:15 -0500] mattray: well, I could kick it off at the beginning, talk for 25 minutes and switch back
[2014-01-22 22:59:38 -0500] paulczar: ctracey: see this line in the various network cookbooks - https://github.com/stackforge/cookbook-openstack-network/blob/master/recipes/openvswitch.rb#L21
[2014-01-22 22:59:46 -0500] spheromak: mattray: i found less fuckage with fusion but not really faster
[2014-01-22 23:00:21 -0500] mattray: spheromak: new laptop will be faster all around, cpu, ssd and more memory
[2014-01-22 23:00:21 -0500] paulczar: mitchel did a good benchmark a week or so ago  the main difference iirc was shared folder speeds
[2014-01-22 23:00:29 -0500] mattray: paulczar: yeah, saw that
[2014-01-22 23:01:28 -0500] claco: spheromak: technical term. :-)
[2014-01-22 23:02:11 -0500] spheromak: claco: the most acedemic technical term indeed
[2014-01-22 23:02:26 -0500] spheromak: *academic
[2014-01-22 23:05:18 -0500] ctracey: paulczar, but i am removing the possibility of that recipe running
[2014-01-22 23:05:38 -0500] ctracey: whether or not it is being pulled from somewhere is is another issue
[2014-01-22 23:06:12 -0500] paulczar: ctracey: but we want it to run!  if the attribute is set
[2014-01-22 23:06:19 -0500] ctracey: s/is/else/
[2014-01-22 23:06:21 -0500] ctracey: no we dont
[2014-01-22 23:06:34 -0500] paulczar: because if that attribute is set to nova, and we don't run that recipe  then we get no networking
[2014-01-22 23:06:34 -0500] ctracey: there is no reason why compute should include networks
[2014-01-22 23:06:50 -0500] ctracey: this is why we have a network recipe
[2014-01-22 23:07:45 -0500] ctracey: the point here is that we have *way* too much spaghetti attribute inclusion code
[2014-01-22 23:07:53 -0500] ctracey: a recipe should be OK to stand on its own
[2014-01-22 23:08:06 -0500] claco: and once it's a recipe.. no need for a toggle attr
[2014-01-22 23:08:14 -0500] ctracey: correct
[2014-01-22 23:08:43 -0500] ctracey: this kind of logic makes it difficult to cleanly compose recipes
[2014-01-22 23:08:45 -0500] paulczar: okay
[2014-01-22 23:09:30 -0500] ctracey: i can agree when its something like include_recipe <something>:common
[2014-01-22 23:09:33 -0500] ctracey: that makes sense
[2014-01-22 23:09:53 -0500] ctracey: but we need separation of concerns when it comes to a specific recipe
[2014-01-22 23:11:22 -0500] paulczar: ctracey: okay,  I'm on board with this now  but I think we'll need to split out the allinone role to be allinone_nova_network and allinone_neutron
[2014-01-22 23:12:02 -0500] ctracey: ok, can do
[2014-01-22 23:12:06 -0500] mattray: paulczar: works for me
[2014-01-22 23:12:18 -0500] ctracey: we can -2 until that is done
[2014-01-22 23:12:23 -0500] mattray: paulczar: I'd _really_ like to drop nova-network
[2014-01-22 23:12:31 -0500] ctracey: + 1 million
[2014-01-22 23:12:35 -0500] claco: ha
[2014-01-22 23:12:40 -0500] paulczar: mattray: give me a redundant HA neutron first pls
[2014-01-22 23:12:46 -0500] ctracey: does anyone use that anyhoo?
[2014-01-22 23:12:46 -0500] mattray: paulczar: I know...
[2014-01-22 23:13:04 -0500] mattray: ctracey: I went down the OVS rathole with Grizzly, failed
[2014-01-22 23:13:13 -0500] ctracey: do you have redundant nova-net?
[2014-01-22 23:13:25 -0500] claco: the official nova-net deprecation is icehouse right?
[2014-01-22 23:13:28 -0500] ctracey: multi_host = True? :)
[2014-01-22 23:13:45 -0500] mattray: claco: it keeps getting reprieves, I have no idea
[2014-01-22 23:13:53 -0500] paulczar: claco: I'll believe it when I see it
[2014-01-22 23:14:10 -0500] ctracey: paulczar, delaying the inevitable :)
[2014-01-22 23:14:16 -0500] claco: ha ha
[2014-01-22 23:14:25 -0500] ctracey: get on the OVS bandwagon man
[2014-01-22 23:14:32 -0500] claco: are we there yet papa smurf?
[2014-01-22 23:14:33 -0500] ctracey: oh wait...that is going away too :)
[2014-01-22 23:14:42 -0500] paulczar: OVS is going away ?
[2014-01-22 23:14:48 -0500] ctracey: the plugin is
[2014-01-22 23:14:58 -0500] ctracey: deprecated in havana for ML2
[2014-01-22 23:15:26 -0500] paulczar: personally I really like the simplicity of flat_dhcp nova network with floating IPs
[2014-01-22 23:15:36 -0500] claco: then we can rename something, just for nostalgia sake.
[2014-01-22 23:15:39 -0500] ctracey: "Starting with Havana release, openvswitch and linuxbridge plugins are deprecated. Modular Layer 2 (ML2) plugin replaces these plugins. L2 agents work with ML2 plugin and continue to work with the deprecated monolithic plugins."
[2014-01-22 23:16:00 -0500] ctracey: paulczar, tell that to an enterprise customer :)
[2014-01-22 23:16:44 -0500] paulczar: ctracey: since when has openstack cared about customers? :)
[2014-01-22 23:16:48 -0500] mattray: zing!
[2014-01-22 23:17:22 -0500] ctracey: kapow!
[2014-01-22 23:17:23 -0500] ctracey: :)
[2014-01-22 23:17:28 -0500] mattray: https://dl.dropboxusercontent.com/u/14483515/openstack.jpg
[2014-01-22 23:17:29 -0500] ctracey: i know right?
[2014-01-22 23:17:54 -0500] ctracey: mattray, was that littleidea's campaign poster?
[2014-01-22 23:18:02 -0500] ctracey: :)
[2014-01-22 23:18:19 -0500] mattray: ctracey: I've been known to put that in my OpenStack presentations
[2014-01-22 23:18:26 -0500] ctracey: haha
[2014-01-22 23:18:31 -0500] ctracey: #ChefConf
[2014-01-22 23:19:39 -0500] paulczar: too much shiny object syndrome!  just give me a fucking ha network
[2014-01-22 23:19:42 -0500] claco: mattray: instigator. :-)
[2014-01-22 23:19:53 -0500] ctracey: paulczar, we gots one
[2014-01-22 23:19:54 -0500] paulczar: (says the guy who works on Solum )
[2014-01-22 23:19:55 -0500] claco: paulczar: or anything HA in core OpenStack
[2014-01-22 23:19:57 -0500] mattray: lol
[2014-01-22 23:20:22 -0500] claco: along with shooting rabbitmq
[2014-01-22 23:21:03 -0500] paulczar: qpid seems to be getting some good attention   is anyone using that?  or is it just redhat jumping up and down
[2014-01-22 23:21:21 -0500] ctracey: they do that?
[2014-01-22 23:22:21 -0500] paulczar: well they gotta trick people into paying microsoft prices for free software somehow
[2014-01-22 23:25:24 -0500] mattray: 0mq seems to have disappeared from discussion
[2014-01-22 23:37:59 -0500] retr0h: if you run rabbit 3.2.2 in cluster mode your in pretty good shape
[2014-01-22 23:38:06 -0500] retr0h: granted I know not everyone likes rabbit
[2014-01-22 23:38:14 -0500] retr0h: qpid's deployment looks much more complicated
[2014-01-22 23:39:04 -0500] retr0h: the only reason I was interested in 0mq and others is the issues we were having with clustered rabbit.. would run into issues when killing the master and how cliens would not reconnect properly
[2014-01-22 23:39:53 -0500] claco: ^
[2014-01-22 23:39:55 -0500] retr0h: 3.2.2 + erlang-esl and you are golden
[2014-01-22 23:40:15 -0500] claco: always with the reconnect/tcp/restart hitches it seemed
[2014-01-22 23:40:20 -0500] retr0h: yeah
[2014-01-22 23:40:45 -0500] retr0h: it took us a month to find he bug was with the way openstack clients would handle the failure
[2014-01-22 23:40:58 -0500] retr0h: the connection was not reset but the control channel was
[2014-01-22 23:41:02 -0500] retr0h: they woudl not detect that
[2014-01-22 23:41:51 -0500] retr0h: another benefit to rabbit 3.x you can set the ha flag on the server... no longer controlled by client
[2014-01-22 23:50:39 -0500] claco: time to pick up a more simple hobby, like basket weaving
[2014-01-22 23:55:53 -0500] paulczar: nepalese or mongolian basket weaving?
[2014-01-22 23:56:13 -0500] claco: sir, please.
[2014-01-22 23:56:15 -0500] claco: :-)
[2014-01-22 23:59:28 -0500] mattray: good day gents, I'm off to spread the good word
