[2014-05-01 02:56:27 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-identity: Use right PKI defaults  https://review.openstack.org/90487
[2014-05-01 02:58:10 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-common: Move openrc to Common from Compute  https://review.openstack.org/87385
[2014-05-01 12:34:33 -0400] openstackgerrit: Andy McCrae proposed a change to stackforge/cookbook-openstack-identity: Only manage the keystone-paste.ini if specified  https://review.openstack.org/90898
[2014-05-01 14:08:18 -0400] openstackgerrit: Matt Thompson proposed a change to stackforge/cookbook-openstack-identity: Allow token signing key/cert/cacert to be pulled in remotely  https://review.openstack.org/91572
[2014-05-01 14:34:27 -0400] lrr: let me try this again. If i set the db host to not be 127.0.0.1, on an initial chef run, the chef run fails trying to connect to the db saying "access denied". if I leave the db as 127.0.0.1, then the db stuff works, but then I won't be able to have a controller + n compute node setup.
[2014-05-01 14:34:38 -0400] lrr: what should I do db wise for this?
[2014-05-01 14:37:47 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-network: Allow data network openvswitch bridge to be created  https://review.openstack.org/88088
[2014-05-01 14:59:11 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-object-storage: Storage services need keystoneclient not keystone  https://review.openstack.org/91471
[2014-05-01 14:59:48 -0400] mattt: lrr: it shouldn't ......
[2014-05-01 15:00:01 -0400] mattt: lrr: you should be able to set it to a non-localhost IP and have it provision everything correctly
[2014-05-01 15:00:28 -0400] mattt: lrr: there were a few bugs relating to this, but i thought they were all resolved -- are you on latest cookbooks ?
[2014-05-01 15:01:36 -0400] lrr: mattt: i'm on the stable/havana cookbooks
[2014-05-01 15:04:07 -0400] markvan: mancdaz: knock knock
[2014-05-01 15:04:16 -0400] mancdaz: markvan: who's there?
[2014-05-01 15:05:04 -0400] mancdaz: markvan: so yeah I was looking at all the ml2 plugin shenanigans this morning
[2014-05-01 15:05:29 -0400] markvan: mancdaz: howdy, about the package updates. I totally agree with your point.  But I would like to handle this in two parts, first getting some consistentcy, then got after the blueprint with your suggestion.
[2014-05-01 15:05:58 -0400] mancdaz: markvan: ok fair enough
[2014-05-01 15:06:17 -0400] mancdaz: I will remove my -1
[2014-05-01 15:06:24 -0400] markvan: bp allow-package-updates     I'll add your idea to that, since I think it's what we will need.  But would like to get more eyes on the blueprint first.
[2014-05-01 15:08:31 -0400] mancdaz: markvan: regards the ml2 stuff, I think ubuntu/redhat can be boiled down to the same solution
[2014-05-01 15:08:44 -0400] mancdaz: add the ovs attrs to ml2 ini
[2014-05-01 15:09:04 -0400] mancdaz: and then load the correct inifile with the server - either by symlink on rhel, or by the defaults file on ubuntu
[2014-05-01 15:09:23 -0400] mancdaz: seems like there is an issue with the rhel initscript that needs to be patched
[2014-05-01 15:09:53 -0400] markvan: mancdaz: yes, that would work for the server, but the agents are different, they hard code to ovsxxx.ini.
[2014-05-01 15:10:31 -0400] markvan: whereas on the ubuntu side, it's inconsistent, the ovs one goes to ml2xxx.ini and linuxbridge goes to linuxbridge.ini
[2014-05-01 15:11:03 -0400] markvan: Nothing seems to fit well between ubuntu and redhat for server and agent conf files.
[2014-05-01 15:12:13 -0400] markvan: So, as you saw I created a bug for the ubuntu side that can be done after we agree on the current ml2 patch.
[2014-05-01 15:13:14 -0400] mattt: lrr: yeah i'm not sure, i know there was a bug here a while back but it's been fixed
[2014-05-01 15:13:17 -0400] markvan: It would be nice if neutron would just use one file, neutron.conf and just have sections.
[2014-05-01 15:13:31 -0400] mattt: lrr: out of curiosity which roles are you running on the controller?
[2014-05-01 15:14:59 -0400] markvan: mancdaz: The other issue to keep in mind is for the "old" monolithic plugins for openvswitch/linux bridge, they are depreacted but still available in icehouse.
[2014-05-01 15:16:55 -0400] markvan: And it appears that only the ovs agent needs those added fields, not the ml2/server.  So, that's why I think keeping them in ovsxxx.ini is more logical.
[2014-05-01 15:17:38 -0400] markvan: I also tried to find out why they switch the ubuntu ovs agent init to point to ml2, but did not find that commit or reason anywhere.  Seems like a bug.
[2014-05-01 15:17:41 -0400] mancdaz: markvan: but adding them into ml2 ini doesn't harm - those options will just get ignored
[2014-05-01 15:18:07 -0400] mancdaz: markvan: ok I've been looking mostly at the server, not the agents
[2014-05-01 15:18:44 -0400] markvan: mancdaz: yup, agree, having them in there is not a big deal.  Just kinda messy having same values in two templates.
[2014-05-01 15:19:35 -0400] markvan: And the ovs agent also runs on the controller along side the server.  I think that's why they made the ubuntu change, but it's controller specific logic and does not work well on compute nodes.
[2014-05-01 15:21:48 -0400] mancdaz: this is horrible
[2014-05-01 15:22:31 -0400] markvan: mancdaz: yeah, I don't like our options....nothing seems clean across the platforms.
[2014-05-01 15:22:44 -0400] mancdaz: markvan: what is the issue with having the agent use the ml2 ini
[2014-05-01 15:23:00 -0400] mancdaz: given tjhat our approach would be to drop the agent options into the ml2 inifile anyway
[2014-05-01 15:23:29 -0400] markvan: for redhat, it's agent ini it hardcoded to ovs.ini  (and linux bridge to it lb.ini)
[2014-05-01 15:23:48 -0400] mancdaz: oh yes - sorry you keep telling me that!
[2014-05-01 15:25:35 -0400] markvan: so that would require another sym link,   we already have the plugin.ini sym link.   Seems like more hassle to maintain sym links.
[2014-05-01 15:25:56 -0400] mancdaz: symlinking ovs ini to ml2 ini?
[2014-05-01 15:26:05 -0400] mancdaz: that sounds awful
[2014-05-01 15:26:20 -0400] markvan: yup, plain ugly.
[2014-05-01 15:27:11 -0400] mancdaz: I saw some bugs reported in pre icehouse RDO where they were aware of the server initscript  hardcoding ovs ini
[2014-05-01 15:27:13 -0400] markvan: I was thinking about switching the template resource on ubuntu such that the ovs values would become ml2 on ubuntu.  That would be the one ugly special case.
[2014-05-01 15:27:56 -0400] mancdaz: hrm
[2014-05-01 15:28:00 -0400] markvan: mancdaz: current init script goes after ml2 (if exists) and then neutron.conf and plugin.ini  (sym link).
[2014-05-01 15:28:29 -0400] mancdaz: abd loads them all if they all exist
[2014-05-01 15:29:10 -0400] mancdaz: though I suppose if your symlink was pointing at ml2 it would only load it once
[2014-05-01 15:29:36 -0400] markvan: yeah I think it can handle that.
[2014-05-01 15:30:33 -0400] markvan: so with my patch, we still have separate templates for ml2, ovs and lb.   If we put that in, and then simply dup'd the 3 from ovs into ml2, we should be ok on ubuntu then.
[2014-05-01 15:31:21 -0400] mancdaz: personally I think our focus should be trying to make the cookbooks force everything to work as designed - and as consistently across platforms as possible
[2014-05-01 15:31:30 -0400] mancdaz: the symlinking on redhat being the obvious difference
[2014-05-01 15:31:30 -0400] markvan: I guess I like dup'ing 3 entries, vs more sym link/conf files.
[2014-05-01 15:31:56 -0400] markvan: and the agent init script differences
[2014-05-01 15:32:09 -0400] markvan: those are the basic 2 differences
[2014-05-01 15:32:14 -0400] mancdaz: yeah is there not some easy patch to fix that, versus all the other shenanigans?
[2014-05-01 15:32:24 -0400] mancdaz: I mean the ahrdcoding in the initscript
[2014-05-01 15:32:52 -0400] mancdaz: so that we force the agents to use the correct (ml2) plugin ini (where we correctly put the ovs options)
[2014-05-01 15:33:13 -0400] mancdaz: rather than them hard loading the monolithic plugin named ini file
[2014-05-01 15:34:05 -0400] markvan: humm, not sure were going to get any distro changes now for icehouse....
[2014-05-01 15:34:28 -0400] mancdaz: but it's a packaging bug surely
[2014-05-01 15:34:46 -0400] mancdaz: the package is deplying in a way that is not how ml2/ovs was designed to run
[2014-05-01 15:34:59 -0400] markvan: and maybe looking at this differently, I see the agents having their own ini as more correct then using ml2, they don't care what the server is doing.
[2014-05-01 15:35:40 -0400] markvan: so, you could have ml2 or ovs server, and ovs agent is independent of that.
[2014-05-01 15:36:44 -0400] mancdaz: markvan: yeah, I see the logic, it's just there is confusion because of the legacy monolithic plugin ini versus the config file you'd actually need for an ml2 mechanism/executor or w/e you call it
[2014-05-01 15:36:49 -0400] markvan: but if we decide to make the default ml2 path the cleanest, then I would maybe agree that the old ovs server path can have the ugly tweaks.
[2014-05-01 15:37:23 -0400] mancdaz: it seems to me like the expected way, if using ml2, is for everything to use the ml2 ini, and there be sections in there for the specific mechanism
[2014-05-01 15:37:25 -0400] markvan: yup, that's where icehouse sits....between newer ml2 and older mono design
[2014-05-01 15:37:56 -0400] mancdaz: maybe we can make the decision in our icehouse cookbooks to not necessarily suport the old monolithic plugin architecture
[2014-05-01 15:38:03 -0400] mancdaz: since it's being deprecated in juno anyway
[2014-05-01 15:38:19 -0400] markvan: yup, that's one way to go.
[2014-05-01 15:38:26 -0400] mancdaz: as a new user, deploying icehouse, I'd just get to use/learn tthe ml2 way of doing it
[2014-05-01 15:38:33 -0400] markvan: humm, are there options for the mech's that are different from the agents?
[2014-05-01 15:38:38 -0400] mancdaz: and then there's no 'miggration' needed
[2014-05-01 15:38:58 -0400] mancdaz: erm I was using mechanism and agent interchangably, kind of
[2014-05-01 15:39:33 -0400] mancdaz: at the end of the day it doesn't mater where options sit
[2014-05-01 15:39:39 -0400] markvan: I'm not sure that is always true
[2014-05-01 15:39:41 -0400] mancdaz: as long as they are under the correct section
[2014-05-01 15:39:47 -0400] markvan: yup, agreed.
[2014-05-01 15:40:21 -0400] markvan: So, my other patch was to basically pull ALL the ovs options into ml2 template
[2014-05-01 15:40:25 -0400] mancdaz: so ovs options can be anywhere. It seems tidiest to me to force use of ml2
[2014-05-01 15:40:32 -0400] mancdaz: yep that's what I'd advocate
[2014-05-01 15:40:49 -0400] mancdaz: all ovs options in the ovs section in ml2
[2014-05-01 15:40:49 -0400] markvan: now there are some that are already handled with ml2, do maybe we can widdle that down.
[2014-05-01 15:41:06 -0400] mancdaz: exactly - there are generic ml2 optinos that are applicable to all mechanisms
[2014-05-01 15:41:09 -0400] markvan: For linux bridge, I see options all over the place, in different sections.
[2014-05-01 15:42:06 -0400] mancdaz: peronally I'd want to go with put all ovs (minus those that are covered in the ml2 section) options in the ml2 ini
[2014-05-01 15:42:19 -0400] mancdaz: and patch up the various problems to make everything use the ml2 ini
[2014-05-01 15:42:30 -0400] openstackgerrit: Matt Thompson proposed a change to stackforge/cookbook-openstack-identity: Allow token signing key/cert/cacert to be pulled in remotely  https://review.openstack.org/91572
[2014-05-01 15:43:36 -0400] markvan: mancdaz: I basically agree, but that would require another sym link on redhat.  and maybe one on ubuntu for linux bridge.
[2014-05-01 15:43:56 -0400] mancdaz: or patching the initscripts
[2014-05-01 15:44:51 -0400] markvan: not sure a patch like that will ever get in for icehouse, so that means we need to handle the dirty work.
[2014-05-01 15:45:38 -0400] markvan: at best I think we could get a bug on the books to help push it for juno
[2014-05-01 15:45:41 -0400] mancdaz: yeah I meant patch it in the cookbooks.  It's dirty, but at least that kind of patch would make everything work as intended. versus other equally dirty patches that have ini files linked all over the place
[2014-05-01 15:46:22 -0400] mancdaz: if it's a packaging bug it's not an icehouse thing anyway - it's a distro thing
[2014-05-01 15:46:29 -0400] markvan: oh, patching initscripts....humm, I know for sure the rdo and ibm ones are a bit different, that would be interesting.
[2014-05-01 15:47:01 -0400] mancdaz: yeah - just to stop them hardcoding, if that's why we're having to try and ensure we drop in both the ml2 and ovs ini files
[2014-05-01 15:47:27 -0400] mancdaz: I'd rather patch that brokenness and make the setup look/behave as (I think) it was intended
[2014-05-01 15:47:33 -0400] mancdaz: with all the options in the ml2 ini
[2014-05-01 15:47:44 -0400] mancdaz: under relevant sections for the consumer
[2014-05-01 15:48:18 -0400] markvan: I guess I would like to try to confirm that assumption for ml2.ini....for server/mechs and agents
[2014-05-01 15:48:28 -0400] mancdaz: markvan: yeah fair point
[2014-05-01 15:48:37 -0400] mancdaz: documentation on this is hard to come by
[2014-05-01 15:49:41 -0400] markvan: yeah, I suppose asking this on the ML is where to start, but that might turn into a opinionated war instead of the facts.
[2014-05-01 15:51:36 -0400] markvan: And I believe when I read the rdo vs ubuntu doc, they are both written to how the current init scripts work.
[2014-05-01 15:52:32 -0400] markvan: that's the part that hurts now, since it's doc'd one way, and then we code the cookbooks to be what we think the base wanted.
[2014-05-01 15:52:34 -0400] lrr: mattt: right now it's just the os-compute-single-controller role on the controller node
[2014-05-01 15:54:38 -0400] lrr: anyone else up for helping me to debug the database error on stable/havana?
[2014-05-01 15:54:40 -0400] markvan: mancdaz: I hate to say it, but for icehouse, I'm leaning a bit the other direction right now, meaning having the ml2.ini AND ovs.ini  for server and agent.   Then go after some distro bug fixes/doc'd archecture in Juno
[2014-05-01 15:59:40 -0400] lrr: i just went through and tried to allow root access remotely, but no dice. still the access denied error
[2014-05-01 16:00:38 -0400] markvan: luis: does not seem like you reverify for https://review.openstack.org/#/c/90467/  happened.  I tried it again
[2014-05-01 16:03:04 -0400] markvan: luisg_: recheck went thru.  not sure why reverify does not work anymore.
[2014-05-01 16:03:51 -0400] galstrom: they killed reverify
[2014-05-01 16:04:00 -0400] luisg_: markvan, thanks for recheckiing it
[2014-05-01 16:04:04 -0400] luisg_: galstrom, ah i didn't know
[2014-05-01 16:04:29 -0400] galstrom: yeah.. i dont remember their reasoning..
[2014-05-01 16:14:41 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-identity: Allow packages to be updatable  https://review.openstack.org/91476
[2014-05-01 16:16:52 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-dashboard: Add the ability to install a remote certificate  https://review.openstack.org/90467
[2014-05-01 16:34:57 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-compute: Remove openrc  https://review.openstack.org/87693
[2014-05-01 16:50:21 -0400] lrr: mattt: explicitly adding a wildcard to the root user in the mysql db allowed me to finish my testing. I know this isn't an actual fix, but this was only so i could finish building up an environment for it.
[2014-05-01 16:50:58 -0400] lrr: mattt: the next step would be to figure out setting up with a remote mysql db.
[2014-05-01 16:51:02 -0400] lrr: :)
[2014-05-01 20:09:59 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-compute: Allow packages to be updatable  https://review.openstack.org/91662
[2014-05-01 21:08:46 -0400] retr0h: anyone know how to get rubocop to ignore reporting comments as long?
[2014-05-01 21:49:48 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-block-storage: Allow packages to be updatable  https://review.openstack.org/91687
[2014-05-01 21:57:39 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-common: Allow packages to be updatable  https://review.openstack.org/91691
[2014-05-01 22:05:07 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-common: Allow packages to be updatable  https://review.openstack.org/91691
[2014-05-01 22:06:28 -0400] mattray: If you're using knife-openstack, I've got patches going in for the next release here: https://github.com/mattray/knife-openstack/tree/0.10.0
[2014-05-01 22:06:38 -0400] mattray: 4 tickets closed so far, 4 or 5 more
[2014-05-01 22:36:11 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-image: Allow packages to be updatable  https://review.openstack.org/91694
[2014-05-01 22:41:39 -0400] openstackgerrit: Mark Vanderwiel proposed a change to stackforge/cookbook-openstack-network: Allow data network openvswitch bridge to be created  https://review.openstack.org/88088
