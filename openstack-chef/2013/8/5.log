[2013-08-05 03:52:44 -0400] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-compute: Check if local node has identity role before searching  https://review.openstack.org/39411
[2013-08-05 04:36:48 -0400] openstackgerrit: Wil Reichert proposed a change to stackforge/cookbook-openstack-common: change search_for method to search for roles or recipes  https://review.openstack.org/40155
[2013-08-05 10:57:29 -0400] openstackgerrit: Ionut Artarisi proposed a change to stackforge/cookbook-openstack-network: make quantum plugin configurable on SUSE  https://review.openstack.org/38480
[2013-08-05 12:20:53 -0400] openstackgerrit: Ionut Artarisi proposed a change to stackforge/cookbook-openstack-network: make quantum plugin configurable on SUSE  https://review.openstack.org/38480
[2013-08-05 12:52:48 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-network: General template cleanup  https://review.openstack.org/38970
[2013-08-05 13:10:38 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-common: change search_for method to search for roles or recipes  https://review.openstack.org/40155
[2013-08-05 13:52:34 -0400] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-network: bugfix - messaging role was specified incorrectly  https://review.openstack.org/38045
[2013-08-05 13:55:04 -0400] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-network: bugfix - messaging role was specified incorrectly  https://review.openstack.org/38045
[2013-08-05 14:24:39 -0400] jaypipes: iartarisi, ctracey, galstrom: if you have a momento, pls :) https://review.openstack.org/#/c/40024/
[2013-08-05 15:14:59 -0400] jaypipes: iartarisi: this auth_token middleware configuration is so convoluted :(
[2013-08-05 15:16:52 -0400] iartarisi: I can sympathize :)
[2013-08-05 15:17:33 -0400] openstackgerrit: Jay Pipes proposed a change to stackforge/cookbook-openstack-image: Fixes auth token config settings  https://review.openstack.org/40024
[2013-08-05 15:17:40 -0400] jaypipes: iartarisi: ^^
[2013-08-05 15:17:50 -0400] jaypipes: iartarisi: lemme know if that's what you were thinking...
[2013-08-05 15:19:14 -0400] iartarisi: you've got a typo :P
[2013-08-05 15:20:08 -0400] iartarisi: but I was actually thinking of leaving it set to nil in the config and then just having the if block in the config template
[2013-08-05 15:23:20 -0400] openstackgerrit: Jay Pipes proposed a change to stackforge/cookbook-openstack-image: Fixes auth token config settings  https://review.openstack.org/40024
[2013-08-05 15:23:23 -0400] jaypipes: iartarisi: guh, nice catch. fixed...
[2013-08-05 15:23:35 -0400] jaypipes: iartarisi: oh...
[2013-08-05 15:23:40 -0400] jaypipes: iartarisi: what would you prefer?
[2013-08-05 15:24:55 -0400] iartarisi: well I'm not sure what Dolph meant with his comment, but this is good enough I guess
[2013-08-05 15:25:25 -0400] jaypipes: iartarisi: yeah, same here... I think he was hedging his bets for future changes. ;)
[2013-08-05 15:26:01 -0400] iartarisi: does the auth_uri work without the version_path though?
[2013-08-05 15:26:17 -0400] iartarisi: actually there's an easy way to test that...
[2013-08-05 15:32:33 -0400] iartarisi: meh, AFAICS it just ignores the auth_uri
[2013-08-05 15:39:30 -0400] openstackgerrit: Alan Meadows proposed a change to stackforge/cookbook-openstack-network: Add high availability tool for neutron networking  https://review.openstack.org/39095
[2013-08-05 15:39:30 -0400] openstackgerrit: Alan Meadows proposed a change to stackforge/cookbook-openstack-network: Add metadata_agent recipe  https://review.openstack.org/38973
[2013-08-05 15:39:31 -0400] openstackgerrit: Alan Meadows proposed a change to stackforge/cookbook-openstack-network: Support standalone services  https://review.openstack.org/38993
[2013-08-05 15:44:43 -0400] jaypipes: iartarisi: what just ignores the auth_uri?
[2013-08-05 15:45:02 -0400] iartarisi: my glance install
[2013-08-05 15:45:12 -0400] iartarisi: but maybe that's because it's a one-node setup?
[2013-08-05 15:48:24 -0400] jaypipes: iartarisi: auth_uri is provided back to the calling *client* of the Glance API endpoint when the initial request does not contain a token...
[2013-08-05 15:49:05 -0400] iartarisi: ah, alright
[2013-08-05 15:49:09 -0400] jaypipes: iartarisi: if the calling client cannot talk to the admin endpoint (which is what is returned for the auth_uri if none is specified), you get a 401.
[2013-08-05 15:49:15 -0400] iartarisi: I just tested with glance image-list
[2013-08-05 15:49:39 -0400] jaypipes: iartarisi: so, I'm not following your last review comment...
[2013-08-05 15:50:17 -0400] jaypipes: iartarisi: that is referring to auth_uri needing a version path only in the case of auth_version being 2.0. If auth version is 3.0, the auth_uri should leave off the version path entirely.
[2013-08-05 15:51:10 -0400] jaypipes: iartarisi: the reason is because the root endpoint for a Keystone V3 server returns version information that the client can use to negotiate the URL paths.
[2013-08-05 15:51:19 -0400] jaypipes: iartarisi: again, completely convoluted.
[2013-08-05 15:51:54 -0400] iartarisi: ah, so it's the opposite of the auth_version which we have to set only on 3.0 :)
[2013-08-05 15:51:55 -0400] iartarisi: wow
[2013-08-05 15:51:57 -0400] iartarisi: ok :)
[2013-08-05 15:52:12 -0400] jaypipes: iartarisi: see here for more information on the auth_uri defaulting to admin endpoints... :( https://review.openstack.org/#/c/39796/
[2013-08-05 15:53:32 -0400] iartarisi: wait, but then the code is wrong:
[2013-08-05 15:53:36 -0400] iartarisi: auth_uri = auth_uri.gsub('/v2.0', '')
[2013-08-05 15:53:41 -0400] iartarisi: should be v3.0
[2013-08-05 15:53:49 -0400] iartarisi: or something
[2013-08-05 15:54:09 -0400] iartarisi: maybe the if block should also say == "v3.0" instead?
[2013-08-05 15:56:57 -0400] jaypipes: iartarisi: no... see this is where it's really weird....
[2013-08-05 15:57:33 -0400] jaypipes: iartarisi: in the case when the Keystone endpoint is set to https://localhost:5000/v2.0 (still the default in openstack-common)
[2013-08-05 15:58:05 -0400] jaypipes: iartarisi: and if auth_version is set to v3.0 in the node attributes, then this block would make auth_uri = https://localhost:5000/
[2013-08-05 15:58:37 -0400] jaypipes: iartarisi: which would allow v3 Keystone non-default-domain tokens to be understood by the Keystone endpoint, but would set the v2.0 auth endpoint as the default for the service catalog.
[2013-08-05 15:58:51 -0400] jaypipes: iartarisi: and again, I point out how silly and convoluted this all is :(
[2013-08-05 15:58:52 -0400] iartarisi: aaah
[2013-08-05 15:59:04 -0400] iartarisi: it took me a while to understand
[2013-08-05 15:59:33 -0400] iartarisi: we should put an additional comment line above saying:
[2013-08-05 15:59:33 -0400] iartarisi: # THIS IS RIGHT, EVEN IF IT LOOKS WRONG
[2013-08-05 16:04:52 -0400] openstackgerrit: Alan Meadows proposed a change to stackforge/cookbook-openstack-network: Add high availability tool for neutron networking  https://review.openstack.org/39095
[2013-08-05 16:04:53 -0400] openstackgerrit: Alan Meadows proposed a change to stackforge/cookbook-openstack-network: Add metadata_agent recipe  https://review.openstack.org/38973
[2013-08-05 16:04:53 -0400] openstackgerrit: Alan Meadows proposed a change to stackforge/cookbook-openstack-network: Support standalone services  https://review.openstack.org/38993
[2013-08-05 16:14:08 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-network: Add metadata_agent recipe  https://review.openstack.org/38973
