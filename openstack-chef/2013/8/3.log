[2013-08-03 01:31:03 -0400] kisoku: ugh. please don't pepper these cookbooks with search_fir
[2013-08-03 01:31:08 -0400] kisoku: search_for
[2013-08-03 01:31:39 -0400] kisoku: searching by role is an extremely opinionated way of doing things
[2013-08-03 01:31:43 -0400] kisoku: it assumes you use roles
[2013-08-03 01:32:05 -0400] kisoku: it also assumes you are using chef-server
[2013-08-03 01:32:10 -0400] kisoku: currently we are using neither
[2013-08-03 01:37:36 -0400] kisoku: search is esecially nasty when it fails because it is compile time
[2013-08-03 03:53:06 -0400] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-network: bugfix - messaging role was specified incorrectly  https://review.openstack.org/38045
[2013-08-03 04:02:31 -0400] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-network: bugfix - messaging role was specified incorrectly  https://review.openstack.org/38045
[2013-08-03 06:48:03 -0400] carlp: kisoku: It was decided a while back that the cookbooks are written under the assumption that you are using chef server or hosted chef. We all found chef-solo to be an un-necessary edge case.
[2013-08-03 06:48:22 -0400] carlp: Roles, on the other hand, need to die.
[2013-08-03 07:18:00 -0400] spheromak: carlp, yea were working on it
[2013-08-03 07:18:10 -0400] spheromak: carlp, was thinking using tags for some things might make sense
[2013-08-03 07:18:26 -0400] spheromak: easier to search for when a recipe is included vs being on the run_list
[2013-08-03 07:22:36 -0400] carlp: spheromak: works for me :)
[2013-08-03 07:23:16 -0400] carlp: I was going to get down and dirty in all of this over the next week as well. I need a test environment at the office, and I have a bunch of changes planned for networking to make it pluggable.
[2013-08-03 07:23:52 -0400] carlp: Since my company makes a networking plug-in for openstack, I figure I can develop on their dime
[2013-08-03 08:14:03 -0400] kisoku: search in an app cookbook is a smell
[2013-08-03 08:14:17 -0400] kisoku: and I have a full openstack deploying in TK with chef-solo now
[2013-08-03 08:14:52 -0400] kisoku: the onlyrecipe I needed to mod was openstack-compute::nova-common
[2013-08-03 08:18:11 -0400] kisoku: if you really need search for your env you can always perform the search in wrapper cookbooks
[2013-08-03 08:28:16 -0400] kisoku: s/app cookbook/library cookbook/
[2013-08-03 08:28:40 -0400] kisoku: imo everyone is going to deploy openstack differently
[2013-08-03 08:29:29 -0400] kisoku: the cookbooks should be as unopinionated about how you manage your repo as possible
[2013-08-03 08:54:57 -0400] carlp: To an extent, I agree. But search is a major part of Chef. Sometimes you need to find what machines other things are installed on.
[2013-08-03 08:56:19 -0400] kisoku: yes, but that sometimes is almost always 100% a local need
[2013-08-03 08:56:43 -0400] kisoku: the base library cookbooks should be building blocks
[2013-08-03 08:57:00 -0400] kisoku: the roles or role cookbooks you use should be the glue
[2013-08-03 08:57:04 -0400] kisoku: search is glue
[2013-08-03 08:57:40 -0400] carlp: So what you are saying is assume local node and if that fails search?
[2013-08-03 08:58:13 -0400] kisoku: search and if that fails use local node
[2013-08-03 08:58:25 -0400] carlp: OK, that seems reasonable
[2013-08-03 08:58:25 -0400] kisoku: you have to rescue from failed searches, it's compile time
[2013-08-03 08:59:05 -0400] carlp: In most of my environments, search is critical. Everything is spread out. Very few things occupy the same box.
[2013-08-03 08:59:08 -0400] kisoku: the search for a role thing is especially bad
[2013-08-03 08:59:15 -0400] kisoku: what if I don't use roles at all ?
[2013-08-03 08:59:41 -0400] kisoku: I'm trying to eleminate search
[2013-08-03 08:59:42 -0400] kisoku: :-P
[2013-08-03 08:59:51 -0400] kisoku: our env doesn't need it
[2013-08-03 09:00:00 -0400] carlp: I agree: roles are bad
[2013-08-03 09:00:26 -0400] kisoku: and I am not saying you shouldn't use search
[2013-08-03 09:00:48 -0400] kisoku: I'm saying your search should go in carlps_super_awesome_ostack_wrapper_cookbook
[2013-08-03 09:00:57 -0400] carlp: you said earlier you are not using chef server, so I assume you are running chef-solo
[2013-08-03 09:01:24 -0400] kisoku: we using chef-solo and tk to do integration right now
[2013-08-03 09:01:30 -0400] kisoku: our staging and prod is with chef-server
[2013-08-03 09:01:34 -0400] carlp: and we as a group decided that targeting chef-solo was not our target
[2013-08-03 09:01:49 -0400] carlp: We're focusing on depolyments against a chef server
[2013-08-03 09:01:53 -0400] kisoku: well the good news is that it works under solo :-)
[2013-08-03 09:02:02 -0400] kisoku: yexcept for the one place search is being used
[2013-08-03 09:02:25 -0400] carlp: I don't think that search is going away, and I'm betting more will be added
[2013-08-03 09:05:03 -0400] kisoku: if it goes in in a way that where people can't decide not to use it then that will lead to forks
[2013-08-03 09:06:43 -0400] carlp: yep, that's true
[2013-08-03 09:07:24 -0400] kisoku: anyways. my argument is evolving :-P
[2013-08-03 09:07:39 -0400] kisoku: hoping perhaps there could be a broader discussion of it
[2013-08-03 09:07:46 -0400] kisoku: perhaps a post to the mailing list is in order
[2013-08-03 09:08:31 -0400] carlp: You're welcome to post, but as I said: when we formed this project we decided that search was acceptable and that we would not target chef-solo. I don't really see that changing.
[2013-08-03 09:10:50 -0400] carlp: Besides, there are much better tools for a stand-alone single node install of OpenStack (devstack)
[2013-08-03 09:12:01 -0400] carlp: The goal of this project was to focus on real-world production deployments, which means many, many nodes
[2013-08-03 09:12:33 -0400] spheromak: carlp, we have -compute converted to role cooks internally Wil R.  submitted a change for openstack-common to support the search by role or recipe
[2013-08-03 09:13:46 -0400] spheromak: yea I think using tags might make sense here
[2013-08-03 09:13:53 -0400] spheromak: cause then you could tag however you wanted too
[2013-08-03 09:14:15 -0400] spheromak: seating on tags seems a bit more straight forward, and less opinions about how those tags get there.
[2013-08-03 09:14:33 -0400] spheromak: target was chef-server yea
[2013-08-03 09:14:54 -0400] spheromak: many nodes might fare better with solo than server/search :P
[2013-08-03 09:19:59 -0400] kisoku: single node with the cookbooks is essential for doing cookbook integration
[2013-08-03 09:21:51 -0400] carlp: spheromak: now you're just trying to get me started :) All the scaling problems I had with 2000+ nodes went away with Chef 11.
[2013-08-03 09:23:17 -0400] carlp: kisoku: I don't agree with that. Part of the pain in running a production OpenStack environment is that everyone tests with only a single node. The real problems occur when things are spread out.
[2013-08-03 09:27:18 -0400] kisoku: I hear you, I'm not there yet
[2013-08-03 09:27:37 -0400] kisoku: with openstack anyways
[2013-08-03 09:27:55 -0400] kisoku: we do harge large hairy deployments of stuff that have grown over time
[2013-08-03 09:27:58 -0400] kisoku: do have
[2013-08-03 09:28:36 -0400] kisoku: and where single node testing does really prepare us for how things interact when we roll them onto systems that have converged incrementally
[2013-08-03 09:28:47 -0400] kisoku: err doesn't prepare us
[2013-08-03 09:41:50 -0400] kisoku: actually. now that I have thought about it some more
[2013-08-03 09:42:25 -0400] kisoku: as long as we fix search for to be able to support either local or search then there should be no problem
[2013-08-03 10:14:34 -0400] spheromak: carlp, yea chef11 is ++ compared to < 11
[2013-08-03 14:22:47 -0400] openstackgerrit: Paul Czarkowski proposed a change to stackforge/cookbook-openstack-network: bugfix - messaging role was specified incorrectly  https://review.openstack.org/38045
[2013-08-03 18:41:51 -0400] openstackgerrit: Jay Pipes proposed a change to stackforge/cookbook-openstack-image: Fixes auth token config settings  https://review.openstack.org/40024
[2013-08-03 20:34:01 -0400] openstackgerrit: Jay Pipes proposed a change to stackforge/cookbook-openstack-image: Fixes auth token config settings  https://review.openstack.org/40024
