[2013-09-23 06:14:40 -0400] openstackgerrit: John Tran proposed a change to stackforge/cookbook-openstack-block-storage: cronjob binary path depends on platform  https://review.openstack.org/47710
[2013-09-23 07:53:39 -0400] openstackgerrit: John Tran proposed a change to stackforge/cookbook-openstack-block-storage: cronjob binary path depends on platform  https://review.openstack.org/47710
[2013-09-23 16:37:05 -0400] mattray: jaypipes: how do we add spiceweasel as a gate for the openstack-chef-repo?
[2013-09-23 16:37:16 -0400] mattray: it can validate the roles and cookbooks to make sure everything lines up
[2013-09-23 16:38:31 -0400] jaypipes: mattray: we'd need to add a JJB macro similar to this:
[2013-09-23 16:38:32 -0400] jaypipes: https://github.com/openstack-infra/config/blob/master/modules/openstack_project/files/jenkins_job_builder/config/macros.yaml#L117
[2013-09-23 16:39:04 -0400] mattray: jaypipes: ok, I'll put that on my real soon TODO list
[2013-09-23 16:39:05 -0400] mattray: thanks
[2013-09-23 16:39:30 -0400] mattray: paulczar_ and I are straightening out the roles for Vagrant/Vagabond
[2013-09-23 16:39:39 -0400] jaypipes: mattray: I can do it if you want me to.
[2013-09-23 16:39:52 -0400] mattray: jaypipes: if you don't mind
[2013-09-23 16:40:10 -0400] mattray: just 'spiceweasel infrastructure.yml' and it'll complain if it can't find the pieces
[2013-09-23 16:40:48 -0400] mattray: and if it doesn't catch enough, I'll keep updating it :)
[2013-09-23 16:41:13 -0400] jaypipes: mattray: it returns a non-zone return code if any errors, yes?
[2013-09-23 16:41:20 -0400] mattray: yes
[2013-09-23 16:41:44 -0400] jaypipes: mattray: k, no problemo. will get that in shortly.
[2013-09-23 16:41:57 -0400] mattray: thanks, lots of exit(-1)'s all over the code for validation
[2013-09-23 16:46:48 -0400] jaypipes: mattray: --dry-run is fine, right? still exit(-1)s?
[2013-09-23 16:46:58 -0400] mattray: yes
[2013-09-23 16:47:34 -0400] jaypipes: mattray: worth --debug?
[2013-09-23 16:47:38 -0400] mattray: yes
[2013-09-23 16:47:42 -0400] jaypipes: k
[2013-09-23 16:47:50 -0400] mattray: that'll dump more logging
[2013-09-23 16:48:04 -0400] mattray: the dry-run is still the default
[2013-09-23 16:48:20 -0400] mattray: -e is to actually execute against a chef server
[2013-09-23 16:49:38 -0400] jaypipes: kk
[2013-09-23 16:53:51 -0400] jaypipes: mattray: this is what I have... make sense to you?
[2013-09-23 16:53:52 -0400] jaypipes:           #!/bin/bash -xe
[2013-09-23 16:53:52 -0400] jaypipes:           mkdir -p .cookbooks .bundle
[2013-09-23 16:53:52 -0400] jaypipes:           ruby1.9.1 /usr/bin/bundle install --path=.bundle
[2013-09-23 16:53:52 -0400] jaypipes:           # Validates cookbooks
[2013-09-23 16:53:53 -0400] jaypipes:           ruby1.9.1 /usr/bin/bundle exec berks install --path=.cookbooks
[2013-09-23 16:53:54 -0400] jaypipes:           # Validates roles
[2013-09-23 16:53:56 -0400] jaypipes:           ruby1.9.1 /usr/bin/bundle exec spiceweasel infrastructure.yml --debug
[2013-09-23 16:54:11 -0400] jaypipes: (and you would make sure spiceweasel is included in openstack-chef-repo/Gemfile...
[2013-09-23 16:54:50 -0400] mattray: that should work
[2013-09-23 16:56:04 -0400] jaypipes: mattray: k, submitting now...
[2013-09-23 16:56:10 -0400] mattray: thanks
[2013-09-23 16:56:36 -0400] mattray: paulczar_ appears to be able to login to a cirros node with Vagrant now, so that should be coming together
[2013-09-23 16:57:04 -0400] jaypipes: ok
[2013-09-23 16:57:18 -0400] mattray: and my patch to vagrant-chef-zero seems to work, so we can get roles and environments from .rb files once it goes through :)
[2013-09-23 16:57:19 -0400] jaypipes: though Vagrant is so dirt slow for me it's really unusable :(
[2013-09-23 16:57:36 -0400] mattray: yeah, it's still slow
[2013-09-23 16:57:46 -0400] mattray: but the vagrant-cachier and chef-zero seem to help
[2013-09-23 16:58:11 -0400] mattray: laying groundwork for a better Vagabond experience
[2013-09-23 16:58:44 -0400] mattray: or a different testing backend from VirtualBox
[2013-09-23 17:00:25 -0400] paulczar_: just pushed the review for my change that gets a working cirrus
[2013-09-23 17:04:39 -0400] jaypipes: mattray: done: https://review.openstack.org/47880
[2013-09-23 17:05:00 -0400] mattray: jaypipes: thanks!
[2013-09-23 17:05:11 -0400] jaypipes: any time ;)
[2013-09-23 17:05:18 -0400] jaypipes: :) not ;)
[2013-09-23 17:08:23 -0400] mattray: sending this patch over to vagrant-chef-zero: https://gist.github.com/6673731
[2013-09-23 17:08:46 -0400] mattray: that'll straighten up some of the wonkiness in the Vagrantfile
[2013-09-23 17:26:46 -0400] mattray: https://github.com/andrewgross/vagrant-chef-zero/pull/22
[2013-09-23 17:30:13 -0400] mattray: Someone want to give this another review so we can move on to just cookbook issues? https://review.openstack.org/#/c/47878/
[2013-09-23 17:30:23 -0400] mattray: jaypipes: retr0h: galstrom: ^^
[2013-09-23 17:31:22 -0400] galstrom: mattray: ++A
[2013-09-23 17:34:40 -0400] mattray: galstrom: the Workshop was accepted for Hong Kong, so we need that Vagrant stuff :)
[2013-09-23 17:34:49 -0400] galstrom: :)
[2013-09-23 17:34:51 -0400] galstrom: np
[2013-09-23 17:43:46 -0400] openstackgerrit: John Tran proposed a change to stackforge/cookbook-openstack-block-storage: cronjob binary path depends on platform  https://review.openstack.org/47710
[2013-09-23 20:48:39 -0400] retr0h: mattray: sorry missed that
[2013-09-23 20:48:56 -0400] mattray: no worries, it's all in now
[2013-09-23 20:49:01 -0400] retr0h: ya
[2013-09-23 20:49:04 -0400] mattray: vagrant is working for allinone
[2013-09-23 20:49:11 -0400] retr0h: sweet
[2013-09-23 20:49:12 -0400] mattray: so now I'm moving it to hardware and documentation
[2013-09-23 20:50:52 -0400] retr0h: awesome
[2013-09-23 21:21:35 -0400] paulczar_: sweet, looks like the vagrant stuff passed review..    hi5 to mattray
[2013-09-23 21:22:25 -0400] mattray: trying to boot this on hardware now, not sure who deserves the blame when a machine gets different NIC ordering
[2013-09-23 21:22:39 -0400] mattray: cold boot mb0 nic comes up as eth1 and no DHCP
[2013-09-23 21:22:51 -0400] mattray: warm reboot from that failed install and it's back as eth0 and DHCP works
[2013-09-23 21:24:41 -0400] paulczar_: that's why I have a stack of e1000s lying around ... generally they work as advertised when it comes to that kinda stuff
[2013-09-23 21:25:03 -0400] mattray: I have stacks of mismatched hardware :)
[2013-09-23 21:45:29 -0400] lbragstad: hey all, quick question. I am testing out the cookbooks for each service and I have successfully been able to install keystone and I've added glance cookbooks/recipes to the run list. After the run list completes Chef says it's successfully completed, but I am unable to authenticate glance with keystone. Glance seems to be installed fine (services/configs/db) but it just can't authenticate. Am I missing something blatantly obvious?
[2013-09-23 21:46:10 -0400] lbragstad: I have a suspicious feeling I missed a tweak somewhere
[2013-09-23 21:47:33 -0400] paulczar_: lbragstad:  perhaps need to call the identity_registeration recipe in glance ?
[2013-09-23 21:48:55 -0400] lbragstad: paulczar_: yep, I have that recipe last in the run list after image-api and image-registry.
[2013-09-23 21:50:27 -0400] lbragstad: I am running openstack-image::api, openstack-image::registry, and then finally openstack-image::identity_registration.
[2013-09-23 21:51:37 -0400] paulczar_: are you doing that in a role?   or calling the recipes individually?   a bunch of the recipes use chef search based on roles for hooking services together
[2013-09-23 21:51:44 -0400] paulczar_: but should hard fail if that doesn't work
[2013-09-23 21:52:08 -0400] lbragstad: paulczar_:  I am using the recipes individually at the moment
[2013-09-23 21:52:15 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-network: Correct typo and a wrong value in nvp.ini.erb  https://review.openstack.org/47572
[2013-09-23 21:52:17 -0400] lbragstad: and chef doesn't seem to mind running them that way
[2013-09-23 21:52:49 -0400] lbragstad: paulczar_: would you suggest using the roles here -> https://github.com/stackforge/openstack-chef-repo/tree/master/roles instead?
[2013-09-23 21:53:27 -0400] paulczar_: yessir!
[2013-09-23 21:53:46 -0400] paulczar_: see this role - https://github.com/stackforge/openstack-chef-repo/blob/master/roles/os-compute-single-controller.rb
[2013-09-23 21:53:54 -0400] lbragstad: paulczar_: gotcha, sounds good! and just assign the role instead?
[2013-09-23 21:54:10 -0400] paulczar_: can probably take everything out below image
[2013-09-23 21:54:30 -0400] lbragstad: paulczar_: ok, and then add the others in as I go?
[2013-09-23 21:54:33 -0400] paulczar_: also look at the included environment/vagrant.json ... that should help with settings attributes
[2013-09-23 21:57:00 -0400] lbragstad: paulczar_: so roles are still planned to be used for services? For some reason I thought roles were going to be rolled over to all cookbooks?
[2013-09-23 21:57:26 -0400] mattray: lbragstad: that was the goal
[2013-09-23 21:57:37 -0400] mattray: still a wip
[2013-09-23 21:57:50 -0400] lbragstad: mattray: so that is still out a bit?
[2013-09-23 21:59:31 -0400] mattray: yeah, I thought the recipes should work, but the Vagrant testing found that you still need the roles
[2013-09-23 21:59:38 -0400] mattray: so it'll get fixed eventually
[2013-09-23 21:59:46 -0400] mattray: but for now, the roles are the safest route
[2013-09-23 22:00:15 -0400] lbragstad: paulczar_:  mattray: gotcha, good to know. I'll give that a shot, thanks guys!
[2013-09-23 22:01:06 -0400] openstackgerrit: A change was merged to stackforge/cookbook-openstack-network: Allow building OVS from souce  https://review.openstack.org/46776
