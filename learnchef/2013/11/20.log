[2013-11-20 00:41:17 -0500] ec9999_: Hi, I'm trying to add a node by running chef-client on the host, I keep getting this error
[2013-11-20 00:41:19 -0500] ec9999_: HTTP Request Returned 409 Conflict: Client already exists
[2013-11-20 00:41:28 -0500] ec9999_: HTTP Request Returned 403 Forbidden: error
[2013-11-20 00:41:53 -0500] jbz: ec9999_: that means that you already have a client record on the chef server with that node's name
[2013-11-20 00:42:04 -0500] ec9999_: but the client doesn't exist
[2013-11-20 00:42:29 -0500] jbz: ec9999_: the client might not be named the same as the node
[2013-11-20 00:42:36 -0500] ec9999_: when i run knife node list, it's not there
[2013-11-20 00:42:43 -0500] jbz: ec9999_: Not node.  Client.  Different thing.
[2013-11-20 00:43:11 -0500] jbz: use 'knife clien tlist'
[2013-11-20 00:43:13 -0500] jbz: er, 'knife client list'
[2013-11-20 00:44:22 -0500] ec9999_: ok, knife client list has ops-chef-node-1, which is the one i'm trying to add
[2013-11-20 00:44:29 -0500] jbz: so delete that client
[2013-11-20 00:44:36 -0500] jbz: and that will let the node re-register.
[2013-11-20 00:44:51 -0500] jbz: Each time a new node registers, it creates a node record *and* a client record for it.
[2013-11-20 00:45:35 -0500] ec9999_: ahh.  That works!
[2013-11-20 00:45:38 -0500] ec9999_: thank you jbz
[2013-11-20 00:45:46 -0500] jbz: Most welcome. L:-)
[2013-11-20 00:46:28 -0500] ec9999_: i was googling for 30mins.  next time i will come to this channel first!
[2013-11-20 00:46:58 -0500] jbz: :-)
[2013-11-20 03:40:15 -0500] vine: Is this where I should be to re-learn chef?
[2013-11-20 03:40:18 -0500] vine: :)
[2013-11-20 03:43:51 -0500] vine: knife solo prepare target # works just fine
[2013-11-20 03:44:38 -0500] vine: knife solo cook target nodes/yummy.json # complains it can't find cookbook in /var/chef/cookbooks
[2013-11-20 03:45:30 -0500] vine: up until recently, it would just put them all in/tmp and be happy, after reading the upgrade guide, I don't see how the overall structure should change as I don't care where it puts them remotely, I just want it to copy my local ones.
[2013-11-20 04:21:59 -0500] Guest30952: turns out this is the whole -z flag thing, basic cookbooks work, site-cookbooks still fails to converge
[2013-11-20 04:22:16 -0500] Guest30952: guidance would be appreciated!
[2013-11-20 08:24:01 -0500] robwatkin: Hi, I have followed the istructions for setting up a Vagrant Lab in "Chef Fundamentals Webinar - Training Lab Setup" prior doing "Chef Fundamentals Module 3". When I run chef-client to install the "apache" cookbook I get ...
[2013-11-20 08:24:12 -0500] robwatkin: Err http://us.archive.ubuntu.com/ubuntu/ precise-updates/main apache2.2-bin i386 2.2.22-1ubuntu1.3
[2013-11-20 08:24:12 -0500] robwatkin:   404  Not Found [IP: 91.189.91.14 80]
[2013-11-20 08:25:32 -0500] robwatkin: It seems to be the image config.vm.box_url = "https://opscode-vm.s3.amazonaws.com/vagrant/opscode_ubuntu-12.04-i386_provisionerless.box" which is causing the problem because if I run ...
[2013-11-20 08:25:35 -0500] robwatkin: root@robvirsatel-starter:~# apt-get install apache2
[2013-11-20 08:25:59 -0500] robwatkin: I get ...
[2013-11-20 08:26:03 -0500] robwatkin: Err http://us.archive.ubuntu.com/ubuntu/ precise-updates/main apache2.2-bin i386 2.2.22-1ubuntu1.3
[2013-11-20 08:26:04 -0500] robwatkin:   404  Not Found [IP: 91.189.91.15 80]
[2013-11-20 08:26:04 -0500] robwatkin: Err http://security.ubuntu.com/ubuntu/ precise-security/main apache2.2-bin i386 2.2.22-1ubuntu1.3
[2013-11-20 08:26:05 -0500] robwatkin:   404  Not Found [IP: 91.189.92.200 80]
[2013-11-20 08:27:18 -0500] robwatkin: I have looked at http://us.archive.ubuntu.com/ubuntu/ and it seems it should be going to http://us.archive.ubuntu.com/ubuntu/dists.
[2013-11-20 08:28:01 -0500] robwatkin: Any ideas on how I can go about fixing this so I can get on with the training webinar.
[2013-11-20 08:28:26 -0500] robwatkin: Sorry This is a bit long ... mayby I should post to the forum instead :)
[2013-11-20 15:10:38 -0500] robwatkin: I'm running "Chef Fundamentals Module 4" but when I "knife create cookbook apt" it gets the official 'apt' cookbook from somewhere. Any ideas what I have broken?
[2013-11-20 18:30:11 -0500] bobbywilson0: hey all, anyone around?
[2013-11-20 18:32:57 -0500] jbz: cheers
[2013-11-20 18:35:10 -0500] bobbywilson0: what do the permissions need to be on a file owned by root for the chef runner user to be able to execute it?
[2013-11-20 19:03:28 -0500] jbz: I'm sorry bobbywilson0 I got called into a meeting, did your question get answered?
[2013-11-20 19:05:55 -0500] bobbywilson0: jbz: no
[2013-11-20 19:06:13 -0500] jbz: bobbywilson0 Sorry.  What was it?
[2013-11-20 19:06:23 -0500] bobbywilson0: what do the permissions need to be on a file owned by root for the chef runner user to be able to execute it?
[2013-11-20 19:06:36 -0500] jbz: chef-client is run as root.
[2013-11-20 19:06:46 -0500] jbz: At least, it should be, otherwise it won't be able to do what it needs to do. :-)
[2013-11-20 19:07:36 -0500] jbz: So it needs u+x if it's an executable you want chef-client to run as part of the convergence.
[2013-11-20 19:09:22 -0500] bobbywilson0: jbz: ah ok, it is chef solo
[2013-11-20 19:09:25 -0500] bobbywilson0: does that make a diff?
[2013-11-20 19:09:54 -0500] jbz: bobbywilson0: don't think so, it should still run as root as far as I know, but I don't use chef-solo much.
[2013-11-20 19:10:03 -0500] bobbywilson0: ok
[2013-11-20 19:10:26 -0500] bobbywilson0: jbz: STDOUT: STDERR: sh: 1: source: Permission denied
[2013-11-20 19:10:47 -0500] bobbywilson0: that is my error, I am trying to run `source /etc/profile.d/env.sh` which just exports env vars
[2013-11-20 19:11:18 -0500] jbz: bobbywilson0: can you pastie/gist the resource you're trying to execute it with?
[2013-11-20 19:12:45 -0500] bobbywilson0: jbz: https://github.com/aws/opsworks-cookbooks/blob/122a978eaa7be1de944426ce8d9a8daff5312fc6/deploy/definitions/opsworks_deploy.rb#L71
[2013-11-20 19:13:26 -0500] bobbywilson0: jbz: where deploy[:migrate_command] is `source /etc/profile.d/env.sh && bundle exec rake db:migrate`
[2013-11-20 19:14:02 -0500] jbz: bobbywilson0: Oh, the deploy resource. :-(  OK, I have to say I'm not sure - the deploy resource is complex, and executes some steps as the 'deploy user' not as root.
[2013-11-20 19:14:19 -0500] bobbywilson0: jbz: ah that would make sense
[2013-11-20 19:14:52 -0500] bobbywilson0: jbz: although I have the permissions on 755, which should make this possible
[2013-11-20 19:15:08 -0500] jbz: hm yeah
[2013-11-20 19:15:44 -0500] bobbywilson0: jbz: maybe I should use sh instead of source?
[2013-11-20 19:16:39 -0500] jbz: ohyes, that would make sense
[2013-11-20 19:16:59 -0500] jbz: but I'm not sure how those env vars will work in relation to the rest of the deploy process, I don't know enough about how that's done.
[2013-11-20 19:18:20 -0500] bobbywilson0: well I only need them for the command that follows
[2013-11-20 19:18:41 -0500] bobbywilson0: which is `bundle exec rake db:migrate`
[2013-11-20 19:20:35 -0500] jbz: oh indeed, right, that should work so long as they're the same command string separated by ;, right.
[2013-11-20 19:20:58 -0500] bobbywilson0: ah, so that ran cleanly but as you were thinking they aren't available
[2013-11-20 19:21:06 -0500] jbz: hmmm
[2013-11-20 19:21:40 -0500] jbz: try 'bash source' as source is a built-in bash command
[2013-11-20 19:22:04 -0500] jbz: if chef isn't using a bash shell to execute those commands, it might not work?
[2013-11-20 19:22:51 -0500] bobbywilson0: source works but the command fails because of permissions
[2013-11-20 19:23:28 -0500] bobbywilson0: which is odd because 755 means rwx rx rx right?
[2013-11-20 19:23:33 -0500] jbz: yes, it does
[2013-11-20 19:24:44 -0500] bobbywilson0: dude! so the '.' command worked, haha
[2013-11-20 19:25:02 -0500] jbz: hahaha
[2013-11-20 19:25:04 -0500] bobbywilson0: `. /etc/profile.d/env.sh`
[2013-11-20 19:27:42 -0500] ss1523: Does anyone know how to rename a cookbook properly?? is there a knife command or just renaming the cookbook  folder should be fine ??Thanks
[2013-11-20 19:32:03 -0500] jbz: ss1523: you have to rename the cookbook inside its metadata.rb file
[2013-11-20 19:32:09 -0500] jbz: the field "name" must be changed.
[2013-11-20 19:32:36 -0500] jbz: ss1523: and of course, the usual warnings about other cookbooks referencing it by name apply.
[2013-11-20 19:33:15 -0500] ss1523: jbz: so just rename the cookbook folder and update the metadata should be fine right ?
[2013-11-20 19:34:00 -0500] jbz: that will rename the cookbook, yes.  It won't fix any problems that might arise from other cookbooks referencing it. :-)  If you're not presently using it, then that's all you need.
[2013-11-20 19:35:00 -0500] ss1523: ya no other cookbook is referencing the one that I want to rename. So I think I should be fine..Thanks for the help :-)
[2013-11-20 19:35:17 -0500] jbz: yw
