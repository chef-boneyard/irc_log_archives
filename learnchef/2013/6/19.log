[2013-06-19 04:37:48 -0400] huckphin: I am going through the tutorial on https://learnchef.opscode.com/quickstart/chef-repo/, and I am having troubles uploading my cookbooks to my chef server.  I am doing the development on my laptop, and my Chef Server that I have installed is in Amazon's EC2.  The behavior I am noticing is that the uploading of cookbooks hangs indefinitely.  I tried running it with -VV and found a curious issue.  The request from my client is trying to us
[2013-06-19 04:38:38 -0400] huckphin: Here are a couple of lines from the output of the command with the -VV flags:
[2013-06-19 04:38:43 -0400] huckphin: INFO: Uploading /Users/chad/Coding/chef-repo/cookbooks/magic_shell/resources/alias.rb (checksum hex = e204afe686b669747d1ca47c72507a7d) to https://ip-10-250-57-169.us-west-2.compute.internal:443/bookshelf/organization-00000000000000000000000000000000/checksum-e204afe686b669747d1ca47c72507a7d?AWSAccessKeyId=be109f5f7314018e2a83875a5323188ae999789f&Expires=1371617045&Signature=fcunu%2BN%2BXt6f1A4ny1dy51DE6og%3D
[2013-06-19 04:38:43 -0400] huckphin: INFO: Uploading /Users/chad/Coding/chef-repo/cookbooks/apache2/recipes/mod_authz_default.rb (checksum hex = e395be129fbf6e72ef050365f7124960) to https://ip-10-250-57-169.us-west-2.compute.internal:443/bookshelf/organization-00000000000000000000000000000000/checksum-e395be129fbf6e72ef050365f7124960?AWSAccessKeyId=be109f5f7314018e2a83875a5323188ae999789f&Expires=1371617045&Signature=Ri/MGI%2BKOicwz7ETM2FHJx7tgKg%3D
[2013-06-19 04:38:44 -0400] huckphin: INFO: Uploading /Users/chad/Coding/chef-repo/cookbooks/apt/templates/default/01proxy.erb (checksum hex = e4a9e94fce67b2c1ec07ac4f087a3cb4) to https://ip-10-250-57-169.us-west-2.compute.internal:443/bookshelf/organization-00000000000000000000000000000000/checksum-e4a9e94fce67b2c1ec07ac4f087a3cb4?AWSAccessKeyId=be109f5f7314018e2a83875a5323188ae999789f&Expires=1371617045&Signature=0R7wx4qR8f/IBx4fTSIr%2BA9XTR4%3D
[2013-06-19 04:40:18 -0400] huckphin: the domain of "ip-10-250-57-169.us-west-2.compute.internal" is correct for my internal DNS (inside of AWS), but does not resolve correctly outside of AWS due to it resolving to an internal IP.  Any ideas what I am doing wrong?
[2013-06-19 05:22:55 -0400] huckphin: Well, I got it to work.  I created a Chef Workstation in my EC2 environment, and I was able to upload the cookbooks that way.  It is not ideal, and it is not what I was looking for.  Why does it resolve to my internal DNS?
[2013-06-19 05:50:43 -0400] jeffrey3234: can chef-solo be run completly solo, eg without running any remote knife prepare commands?
[2013-06-19 05:51:07 -0400] jeffrey3234: just ssh into box, pull down recipe, and run it all locally?
[2013-06-19 07:19:58 -0400] biswa: Hi. I need a help on cookbook develeopment
[2013-06-19 07:20:08 -0400] biswa: can anybody help me?
[2013-06-19 07:20:43 -0400] biswa: i need to write a cookbook where I need to download a folder from remote location.
[2013-06-19 07:22:50 -0400] biswa: is there any example avialble?
[2013-06-19 07:23:54 -0400] biswa: #openstack-chef
[2013-06-19 08:40:04 -0400] jeffrey3234: how do you tell knife which recipe to cook? does it automatically use /recipe/default.rb?
[2013-06-19 13:53:19 -0400] proppen: jeffrey3234: yes by default, but you can also specify for example "recipe[chef-client::service] if you want to run cookbooks/chef-client/recipes/service.rb
[2013-06-19 15:18:15 -0400] StDiluted: can someone help me understand something fairly simple, there are so many ways to do things that I'm a bit confused.
[2013-06-19 15:18:43 -0400] behemphi: ask away
[2013-06-19 15:19:20 -0400] StDiluted: I want a server with nginx, apache2, and a few other bits and pieces. I don't want to modify(fork) the community cookbooks, so what is the best practice way to put in the config files for the services?
[2013-06-19 15:20:09 -0400] StDiluted: i can easily get the recipes up and running on the nodes
[2013-06-19 15:20:28 -0400] StDiluted: (using private chef)
[2013-06-19 15:21:56 -0400] StDiluted: There seem to be about 25 ways to do it but I don't wan tto do it a stupid way and then pay for it later
[2013-06-19 15:23:22 -0400] StDiluted: for reference, I have both vagrant and ec2 ability, I'm working locally with vagrant and then I will get those run lists up on ec2
[2013-06-19 15:24:25 -0400] behemphi: Since you are asking about _how_ to work rather than a specific question I am going to ramble a bit
[2013-06-19 15:24:33 -0400] StDiluted: that's fine
[2013-06-19 15:24:38 -0400] behemphi: the application cookbook pattern is what most are following these days
[2013-06-19 15:24:47 -0400] behemphi: I work for Feedmagnet
[2013-06-19 15:24:51 -0400] behemphi: so we have an fm_nginx cookbook
[2013-06-19 15:25:04 -0400] behemphi: in the attributes file of the cookbook I override the attributes in nginx
[2013-06-19 15:25:08 -0400] behemphi: cookbook
[2013-06-19 15:25:20 -0400] behemphi: do any layout and and any custom server blocks
[2013-06-19 15:25:50 -0400] behemphi: Today, I am working on using the users cookbook by creating an fm_users cookbook to  create our users specifically
[2013-06-19 15:25:59 -0400] StDiluted: ok, so you have /cookbooks/nginx and /cookbooks/fm_nginx
[2013-06-19 15:26:21 -0400] StDiluted: and in /cookbooks/fm_nginx you have attributes/default.rb
[2013-06-19 15:26:34 -0400] behemphi: THis is a great blog post explaining the idea
[2013-06-19 15:26:35 -0400] behemphi: http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-06-19 15:26:40 -0400] StDiluted: I read that
[2013-06-19 15:26:49 -0400] behemphi: this is also a great resource
[2013-06-19 15:26:49 -0400] StDiluted: I'm having trouble wrapping my head around it for some reason
[2013-06-19 15:26:49 -0400] behemphi: http://berkshelf.com/
[2013-06-19 15:26:53 -0400] behemphi: np
[2013-06-19 15:26:56 -0400] StDiluted: yeah, using berkshelf as well
[2013-06-19 15:26:58 -0400] behemphi: sec I have one more
[2013-06-19 15:27:19 -0400] StDiluted: I'm an old school sysadmin, having troubl with the conceptual ideas
[2013-06-19 15:27:22 -0400] behemphi: http://www.youtube.com/watch?v=hYt0E84kYUI
[2013-06-19 15:27:31 -0400] StDiluted: ah, that may help
[2013-06-19 15:27:35 -0400] StDiluted: let me watch that
[2013-06-19 15:27:41 -0400] behemphi: That is a video of Jamie Windsor talking through the Berkshelf way
[2013-06-19 15:27:55 -0400] behemphi: my collegue (new to chef) watched that and said "aha"
[2013-06-19 15:28:22 -0400] behemphi: btw, I am in the same boat in that I was a dba (old school) when I started my chef journey
[2013-06-19 15:28:28 -0400] behemphi: So I feel you man :-)
[2013-06-19 15:28:59 -0400] behemphi: Note on the video.   There is some foul language, so if you are in a '"stiff" environmetn you might want to put on some headphones
[2013-06-19 15:29:22 -0400] StDiluted: not at all 'stiff' but headphones anyway
[2013-06-19 15:30:23 -0400] behemphi: Iam really just working out the BS way myself
[2013-06-19 15:30:35 -0400] behemphi: so happy to keep going when you are done watching
[2013-06-19 15:30:56 -0400] ianneub: howdy all
[2013-06-19 15:31:44 -0400] ianneub: sorry to cross post, but could anyone help me with an attributes issue?
[2013-06-19 15:31:51 -0400] ianneub: (i also posted this on #chef)
[2013-06-19 15:34:53 -0400] behemphi: It is hard to tell but assuming that you have all the attrib files in teh same directory
[2013-06-19 15:35:03 -0400] behemphi: attribute_zapp.rb will load last
[2013-06-19 15:35:27 -0400] behemphi: and overwrite the value previously set b/c the attrs all have the same precedents
[2013-06-19 15:36:19 -0400] ianneub: behemphi: thanks! i figured that was what is going on. what do you think the best solution is? put the custom attributes for the specific recipe inside each specific recipe?
[2013-06-19 15:36:35 -0400] behemphi: I am not sure why you have multiple files
[2013-06-19 15:36:57 -0400] behemphi: but if you say `override['app_name'] = "zapplication"
[2013-06-19 15:37:24 -0400] behemphi: that will change the precedence 
[2013-06-19 15:37:31 -0400] behemphi: and force what you want
[2013-06-19 15:37:32 -0400] ianneub: i have multiple recipes, one for each of the different applications that we run here, that are basically only there to set some attributes and then run the default recipe
[2013-06-19 15:37:43 -0400] behemphi: ah
[2013-06-19 15:37:47 -0400] behemphi: then I would suggest this
[2013-06-19 15:38:13 -0400] behemphi: default['app1']['app_name']
[2013-06-19 15:38:26 -0400] behemphi: default['app2']['app_name']
[2013-06-19 15:40:01 -0400] ianneub: that makes sense. inside the default recipe, how would I tell it which variables to use?
[2013-06-19 15:40:30 -0400] behemphi: node[app1][app_name]
[2013-06-19 15:40:43 -0400] behemphi: or node.app1.app_name (but this is falling out of favor)
[2013-06-19 15:41:03 -0400] ianneub: i guess i guess set a variable in the recipe_myapp something like node.default['app_name_to_use'] = 'app1'
[2013-06-19 15:42:11 -0400] ianneub: i think i would need 'app1' inside another variable right? so that my recipe_default.rb would work for both of the other application recipes?
[2013-06-19 15:43:40 -0400] behemphi: I am not sure what your app looks like
[2013-06-19 15:43:43 -0400] behemphi: as I think about it more
[2013-06-19 15:43:56 -0400] behemphi: if they are different apps the should have different cookbooks
[2013-06-19 15:44:03 -0400] behemphi: example 
[2013-06-19 15:44:13 -0400] behemphi: we ahve three apps on a server and use Python virtual env
[2013-06-19 15:45:49 -0400] behemphi: we install venv in a cookbook that comes before the others
[2013-06-19 15:45:53 -0400] behemphi: then install apps after that
[2013-06-19 15:46:17 -0400] behemphi: this is important b/c it gives us the ability to scale by moving the apps to different machines if necessary
[2013-06-19 15:46:55 -0400] ianneub: in your different app cookbooks do you rewrite a lot of the same stuff? i actually had two cookbooks at first, but found they were identical except for a couple attributes
[2013-06-19 15:47:24 -0400] behemphi: I factor out the common stuff (like venv) 
[2013-06-19 15:47:41 -0400] behemphi: some of our cookbooks have only 10 lines of code
[2013-06-19 15:48:01 -0400] behemphi: but the modularity means simplicity ni the resulting topology
[2013-06-19 15:49:18 -0400] ianneub: in my default app recipe i have something like 6 blocks that do things. those same blocks are used in both of the app recipes. what do you think the best way is to factor out that common stuff? LWRP?
[2013-06-19 15:49:32 -0400] behemphi: yes
[2013-06-19 15:49:40 -0400] behemphi: lwrp is the ideal way
[2013-06-19 15:49:44 -0400] behemphi: b/c then very reusable
[2013-06-19 15:50:25 -0400] ianneub: maybe i could put together a cookbook example on github that shows more about what i'm doing. 
[2013-06-19 15:50:49 -0400] behemphi: that might be a good idea
[2013-06-19 15:51:36 -0400] ianneub: so i might have 3 cookbooks, 1 that contains only the lwrp. and then 2 others, one for each app. the app cookbooks would only set some attributes (using attribute files), and their recipe would run the lwrp
[2013-06-19 15:52:02 -0400] behemphi: that sounds right to me
[2013-06-19 15:53:34 -0400] ianneub: thanks for your help behemphi. i think i'm getting the hang of chef, but I still have a hard time with "doing the right thing"
[2013-06-19 15:54:05 -0400] behemphi: Opscode actively avoids declaring what is right in many cases
[2013-06-19 15:54:12 -0400] ianneub: hard time knowing what the right thing is anyway :)
[2013-06-19 15:54:14 -0400] behemphi: so it makes it hard for those who are new
[2013-06-19 15:55:10 -0400] ianneub: i'm trying to follow the berkshelf pattern and the "gangnam style" pattern i found in this blog - http://devopsanywhere.blogspot.com/2012/11/how-to-write-reusable-chef-cookbooks.html
[2013-06-19 15:55:56 -0400] ianneub: honestly it feels like a ton of extra work to maintain all these different repositories (one for each cookbook) and manage the versions. but i see the value in it
[2013-06-19 15:56:15 -0400] behemphi: that is a great blog post
[2013-06-19 15:56:19 -0400] behemphi: what this
[2013-06-19 15:56:19 -0400] behemphi: http://www.youtube.com/watch?v=hYt0E84kYUI
[2013-06-19 15:56:30 -0400] behemphi: (warning defn an R for language)
[2013-06-19 15:57:01 -0400] ianneub: i actually watched that yesterday :)
[2013-06-19 15:57:07 -0400] behemphi: good deal
[2013-06-19 15:57:19 -0400] behemphi: we are moving to that workflow as I type this
[2013-06-19 15:57:36 -0400] behemphi: running into all sorts of hell with chef-solo-search cookbook
[2013-06-19 15:58:42 -0400] ianneub: are you not using a chef-server?
[2013-06-19 15:59:32 -0400] behemphi: most defn
[2013-06-19 15:59:42 -0400] behemphi: but for deving a cookbook it is a pain (we used Hosted Chef)
[2013-06-19 15:59:48 -0400] behemphi: so trying use solo
[2013-06-19 16:00:34 -0400] ianneub: ah i see. are you using vagrant?
[2013-06-19 16:01:32 -0400] behemphi: yes
[2013-06-19 16:01:42 -0400] behemphi: it is truly wonderful way to work
[2013-06-19 16:02:06 -0400] gems: can anyone give me an idea why attributes in an environment I created are not being applied to a node that I set to that environment?
[2013-06-19 16:02:10 -0400] ianneub: no doubt. i'm still trying to get the perfect workflow going. and then i'd like to add testing
[2013-06-19 16:02:23 -0400] behemphi: that is next week @ianneub
[2013-06-19 16:04:09 -0400] ianneub: gems: are you setting those attrbitues in any recipes or attribute files as well? maybe one of those are overriding your environment setting?
[2013-06-19 16:05:54 -0400] gems: no i'm not.  I moved the attributes from the roles, into an environment that I created.  When I visit the web interface and click on the node-> show and look at the attributes, none of them are listed there.  When I go to the environment, they are all listed there.  The node is set to that environment.
[2013-06-19 16:06:30 -0400] ianneub: gems: i assume you ran the chef-client after you moved the attributes?
[2013-06-19 16:07:00 -0400] gems: it is actually failing after moving the attributes over, that's what I'm trying to look into. :)
[2013-06-19 16:07:13 -0400] gems: That's when I noticed the missing attributes...because it appears it failed because of missing attributes.
[2013-06-19 16:10:23 -0400] ianneub: hmm. double check that the names of the attributes in the env are identical to what you call in the recipe? sorry i'm not an expert, not sure why it wouldn't work :(
[2013-06-19 16:14:11 -0400] behemphi: If an attr is named the same in role, env, attr file or recipe
[2013-06-19 16:14:17 -0400] behemphi: it is globally the same 
[2013-06-19 16:14:24 -0400] behemphi: the rules of precedence then take over
[2013-06-19 16:15:07 -0400] behemphi: This might help
[2013-06-19 16:15:07 -0400] behemphi: http://docs.opscode.com/essentials_cookbook_attribute_files.html#attribute-precedence
[2013-06-19 19:15:49 -0400] StDiluted: behemphi, are you still about?
[2013-06-19 19:23:26 -0400] behemphi: I am 
[2013-06-19 19:28:35 -0400] StDiluted: running into a couple errors with berkshelf, a 404 on uploading a cookbook, have you seen that?
[2013-06-19 19:31:14 -0400] atyz: Hi there, I feel rather dumb. I'm trying to set an ENV variable in chef solo. I did env "DATABASE_URL" do; value "blar"; end and got Chef::Exceptions::Env: env[ComSpec] (contentvu::default line 40) had an error: Chef::Exceptions::Env: #<Chef::Provider::Env:0x000000021296f0> provider does not implement env_value! on the chef run
[2013-06-19 19:31:26 -0400] atyz: I copied almost directly from http://docs.opscode.com/resource_env.html
[2013-06-19 19:34:09 -0400] behemphi: @StDiluted I have not b/c we are trying to use Chef Solo for dev
[2013-06-19 19:34:33 -0400] behemphi: We wil use chef-server/client when we go to staging and prod
[2013-06-19 19:34:43 -0400] behemphi: but chef-solo really eases the iterations of dev
[2013-06-19 19:44:45 -0400] StDiluted: Ah, thanks behemphi
[2013-06-19 20:35:58 -0400] StDiluted: behemphi, if you are still here, are you using the 'edit "template[/etc/whatever.conf]" do' way of doing things that was in that 'gangnam style' article?
[2013-06-19 20:36:18 -0400] behemphi: @StDiluted not sure what that refers too
[2013-06-19 20:36:34 -0400] StDiluted: http://2.bp.blogspot.com/-1NQTb3vxQnA/UJ6SrYEafHI/AAAAAAAAEy4/_dZjl8rEWtM/s1600/library_app.png
[2013-06-19 20:36:42 -0400] StDiluted: in the lower right quadrant
[2013-06-19 20:37:32 -0400] behemphi: I am not familiar with the edit resource
[2013-06-19 20:37:54 -0400] behemphi: I use the template resource all the time
[2013-06-19 20:39:18 -0400] StDiluted: yeah, not sure what that edit resource is
[2013-06-19 20:49:24 -0400] ianneub: StDiluted: i think that was from here: http://devopsanywhere.blogspot.com/2012/11/editing-chef-resources.html
[2013-06-19 20:49:50 -0400] ianneub: i just happened to use that gem about 3 minutes ago :) it was renamed to "rewind"
[2013-06-19 21:06:50 -0400] gems: Can anyone please give me advice how to handle a role that has a runlist that is slightly different between different environments, but everything else stays the same?  I don't want to have to create multiple roles...
[2013-06-19 21:09:00 -0400] ianneub: hopefully someone else can chime in, but what I keep reading lately is that its best to avoid roles altogether. and instead use a cookbook that includes other recipes
[2013-06-19 21:10:21 -0400] ianneub: in your situation you could create a role-name cookbook and include different recipes depending on the attributes set in the env
[2013-06-19 21:10:40 -0400] ianneub: that is a cookbook named "role-yournamehere"
[2013-06-19 21:12:45 -0400] gems: i'm reading a little bit about env_run_list but that exists in both Roles and Environments and I'm a bit confused on their use
[2013-06-19 21:15:44 -0400] ianneub: i haven't read/used that before
[2013-06-19 21:15:52 -0400] ianneub: theres a lot to chef :)
[2013-06-19 21:21:32 -0400] StDiluted: ah, chef-rewind
[2013-06-19 21:21:34 -0400] StDiluted: got it
[2013-06-19 21:43:50 -0400] StDiluted: what would be the best method for a notify after a symbolic link is made
[2013-06-19 21:45:00 -0400] StDiluted: i.e.: link "/etc/nginx/sites-enabled/myapp" do \ to "/etc/nginx/sites-available/myapp"
