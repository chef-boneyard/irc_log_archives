[2013-04-08 07:03:17 -0400] smt: where can I find doc for learning creating cookbook ? 
[2013-04-08 13:39:19 -0400] droy: hi all, i have a scenario for you...we use CloudFormation and shell scripts to configure our app servers.  Recently we had to add some rewrite rules to Apache, and we had to do this manually on multiple deployed machines.  Would Chef save us that time by pushing those rewrite rules to Apache automatically?
[2013-04-08 13:41:19 -0400] droy: how do the chef clients know that something has changed?
[2013-04-08 13:43:33 -0400] behemphi: Hi Droy
[2013-04-08 13:43:36 -0400] behemphi: they don't
[2013-04-08 13:43:55 -0400] droy: so yo push to the clients
[2013-04-08 13:43:56 -0400] behemphi: If you mean in the context of "I want to upgrade apache" 
[2013-04-08 13:44:10 -0400] behemphi: then the answer is you either run the chef-client manually like I do
[2013-04-08 13:44:11 -0400] droy: i mean more "I want to add a vhost to all deployed servers"
[2013-04-08 13:44:32 -0400] behemphi: from my workstation I run knife ssh "role:web_host" 'sudo chef-client'
[2013-04-08 13:44:37 -0400] behemphi: and it runs on my web servers
[2013-04-08 13:44:52 -0400] behemphi: or you set up the chef-client as a process or cron job and let it run every 30 min
[2013-04-08 13:45:13 -0400] behemphi: setting up in this way is, IMO, a better way to go in the end and I am slowly working my way there.
[2013-04-08 13:45:22 -0400] droy: and in the role you define the vhosts you want configured?
[2013-04-08 13:45:53 -0400] behemphi: LOL when you say "in the role" that is quite a can of worms in the community and there are a number of opinions
[2013-04-08 13:46:01 -0400] behemphi: The way I do that is in a data bag
[2013-04-08 13:46:19 -0400] droy: ok
[2013-04-08 13:46:21 -0400] behemphi: however if it goes on _all_ your web servers I would argue it likely belongs in a receip
[2013-04-08 13:46:36 -0400] droy: i see i have more reading to do!
[2013-04-08 13:46:41 -0400] behemphi: maybe its own recipe in the cookbook that wraps the community apache or nginx cookbook
[2013-04-08 13:46:55 -0400] droy: our current method usese shell scripts for setup
[2013-04-08 13:46:56 -0400] behemphi: I am trying to remain faithful to the idea of more than one way to do it
[2013-04-08 13:47:05 -0400] droy: but that doesn't work very well when there are updates to existing configs
[2013-04-08 13:47:35 -0400] droy: we are heavily AWS based, and will likely move to OpsWorks when they support VPC
[2013-04-08 13:47:41 -0400] behemphi: We have the occasional custom (one-off) vhost for a customer that goes on a specific box, thus I use data bags b/c they are a nice global structure
[2013-04-08 13:47:50 -0400] droy: so I figured I should embrace Chef as it is integrated into the OpsWorks idea
[2013-04-08 13:48:14 -0400] behemphi: I have been at it almost 2 years now.  It is a great way to go.
[2013-04-08 13:48:42 -0400] droy: i'm not going to get into the Puppet vs Chef debate, there's plenty to read on that subject
[2013-04-08 13:49:01 -0400] droy: i just need something that will help with updates to existing deployments and server configurations
[2013-04-08 13:49:08 -0400] behemphi: Like MySQL v Postgres or Vi vs eMacs
[2013-04-08 13:49:20 -0400] behemphi: I suspect the answer is "right tool for right job"
[2013-04-08 13:49:23 -0400] behemphi: for me it was Chef
[2013-04-08 13:49:38 -0400] droy: i gather i can define custom recipies for our application server deployments and updates?  
[2013-04-08 13:50:07 -0400] droy: as in "Build 234 is now ready, so update the app servers with that version"
[2013-04-08 13:50:21 -0400] behemphi: If you are just getting started may I recommend the use of Hosted Chef.  We are running as many as 180 nodes.  It is a great service for our small company.  
[2013-04-08 13:50:35 -0400] droy: ok thanks
[2013-04-08 13:50:48 -0400] behemphi: The next thing I would tell you is to grab the user community cookbook and get a handle on the users with access to your machine
[2013-04-08 13:51:01 -0400] behemphi: that is low hanging fruit and gets you in the "chef mode"
[2013-04-08 13:51:15 -0400] behemphi: from there it will be easier to reason about web servers and the like
[2013-04-08 13:51:50 -0400] droy: ok thanks very much behemphi
[2013-04-08 13:52:16 -0400] behemphi: sure, droy, good luck to you
[2013-04-08 16:07:43 -0400] rep0st: behemphi: im curious. Do you guys utilize chef_environments?
[2013-04-08 16:09:23 -0400] behemphi: hi rep0st yes we do  heavily
[2013-04-08 16:10:42 -0400] behemphi: We keep uwsgi and nginx config in them
[2013-04-08 16:10:42 -0400] behemphi: https://gist.github.com/behemphi/5338031
[2013-04-08 16:10:48 -0400] rep0st: behemphi: yea where i'm at we have multiple products that essentially utilize the same cookbooks. But we plug in different values via chef_environments. Thus resulting in multiple chef_environments. 
[2013-04-08 16:11:19 -0400] behemphi: as they describe not only the level of importants (dev vs prod say) but also the size of the customers clusters as well
[2013-04-08 16:12:35 -0400] rep0st: behemphi: i'm in the school of thought that roles are just as important. For each product we have a role and within that role we define different chef envrironments. Is that something you do as well? Of course in your case it would be a a role per customer. 
[2013-04-08 16:12:48 -0400] behemphi: I was previously creating data bags and then using an if chef_environment == "prod_tiny"  (do stuff) end construct.  Having recently factored that out, I like the way my cookbooks read better
[2013-04-08 16:13:12 -0400] behemphi: no we have role per machine type
[2013-04-08 16:13:24 -0400] behemphi: web-host, db-host, console-host, and a couple of thers
[2013-04-08 16:13:29 -0400] behemphi: *others
[2013-04-08 16:13:39 -0400] behemphi: I see the role as an alias for a run list only
[2013-04-08 16:14:05 -0400] behemphi: I try to keep data off it.  But then our cookbooks are pretty specific to a role in most cases
[2013-04-08 16:14:08 -0400] rep0st: behemphi: and not setting attributes in them right? 
[2013-04-08 16:14:16 -0400] behemphi: yes
[2013-04-08 16:14:17 -0400] behemphi: sec
[2013-04-08 16:14:41 -0400] rep0st: behemphi: yea i'm trying to keep data off of it for now and keeping them in chef_environments. Although, in our case sometimes a product requires a certain parameter across all server types. 
[2013-04-08 16:15:07 -0400] behemphi: https://gist.github.com/behemphi/5338064
[2013-04-08 16:15:26 -0400] behemphi: Note that the community ntp cookbook demands the role level attribute data
[2013-04-08 16:15:29 -0400] behemphi: alas
[2013-04-08 16:15:53 -0400] behemphi: So really this is just a container for a run list
[2013-04-08 16:16:19 -0400] behemphi: it also makes searching my infrastructure easier as I can think in terms of the machine role
[2013-04-08 16:16:51 -0400] rep0st: behemphi: gotcha. It all ties back to the cliche of it really depending on the business requirements. 
[2013-04-08 16:18:02 -0400] behemphi: I think that is really true @rep0st
[2013-04-08 16:20:32 -0400] rep0st: behemphi: i have a top level role that sets things like the chef-client values, and organization specific cookbooks  that get set everywhere no matter what the product or machine role. Then i have location roles that include that top level role in a run list and in that location role i set that locations specifici values i.e dns ntp etc. from there each node will get the location role and then product role which define the chef_environment. Thoughts?
[2013-04-08 16:24:21 -0400] behemphi: that seems to make alot of sense based on what you describe above
[2013-04-08 16:25:26 -0400] gmr: Hi there, I've got a working setup and such, going well other than some minor issues. On one of my cookbooks, everything installs right but my service does not start on install, even though I have action [:start, :enable]. It's CentOS 6.4, the init.d script is fine, works as expected.
[2013-04-08 16:25:34 -0400] gmr: Does anyone have any suggestions to hunt down what th eproblem may be?
[2013-04-08 16:26:18 -0400] behemphi: gmr, if you are in a homogenous environment (i.e all Ubuntu) you might try specifying the provider
[2013-04-08 16:26:22 -0400] behemphi: that has worked for me
[2013-04-08 16:26:33 -0400] rep0st: behemphi: awesome. It's good to share notes. 
[2013-04-08 16:26:41 -0400] rep0st: behemphi: thank you
[2013-04-08 16:26:45 -0400] gmr: ok, will do, for now it's all centos, but it will be mixed when it all is said and done
[2013-04-08 16:27:22 -0400] behemphi: @rep0st:  NP, just remember  I am certainly not an expert (yet :-) )
[2013-04-08 16:28:07 -0400] rep0st: behemphi: as neither am i. But it's good to share notes to see where the community is going
[2013-04-08 16:33:53 -0400] gmr: also on the service resource, is the pattern attribute a regex or substring or the whole process name?
[2013-04-08 16:34:49 -0400] rep0st: http://docs.opscode.com/resource_service.html
[2013-04-08 16:35:12 -0400] rep0st: i can imagine you can throw a regex in there and it'll pick it up. Hvaen't tried though
[2013-04-08 16:43:48 -0400] gmr: yeah I was on that page, it just says "The pattern to look for in the process table. "
[2013-04-08 16:45:31 -0400] gmr: hmm so specifying the platform didn not help -- when the cookbook is run, the init.d script is installed in the right spot, etc. Maybe I'm looking past an obvious problem... does this look right to anyone? https://gist.github.com/gmr/bfc26415f0e7fe61eb2b
[2013-04-08 16:45:45 -0400] gmr: (for my original issue of a process not starting on install)
[2013-04-08 19:37:11 -0400] samukasmk: hi guys, anybody can help me with data bag concepts ?
[2013-04-08 19:48:14 -0400] behemphi: what is your question @samuksmk?
