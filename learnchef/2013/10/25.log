[2013-10-25 12:42:23 -0400] caseydriscoll: Hello, I have a noob question if anyone is around to help
[2013-10-25 12:45:43 -0400] GeoffC_: depends how noob but I'm around
[2013-10-25 12:47:18 -0400] caseydriscoll: https://github.com/caseypatrickdriscoll/vagrant_wheezy
[2013-10-25 12:47:28 -0400] caseydriscoll: learning vagrant/chef
[2013-10-25 12:47:33 -0400] caseydriscoll: can get vagrant up and loaded
[2013-10-25 12:47:36 -0400] caseydriscoll: and ssh just fine
[2013-10-25 12:47:44 -0400] caseydriscoll: cannot get anything provisioned though
[2013-10-25 12:47:48 -0400] caseydriscoll: kcMacPro:wheezy$ v provision
[2013-10-25 12:47:49 -0400] caseydriscoll: [default] Chef 11.6.2 Omnibus package is already installed.
[2013-10-25 12:47:49 -0400] caseydriscoll: [default] Running provisioner: chef_solo...
[2013-10-25 12:47:49 -0400] caseydriscoll: No error message
[2013-10-25 12:48:02 -0400] caseydriscoll: it just says "No error message" in red
[2013-10-25 12:48:14 -0400] caseydriscoll: using opscode's vim and git cookbooks
[2013-10-25 12:48:17 -0400] caseydriscoll: should be super simple
[2013-10-25 12:48:30 -0400] caseydriscoll: on OSX 10.8
[2013-10-25 12:49:27 -0400] GeoffC_: oh ya you're way ahead of me, I just finished the quickstart guide on their site
[2013-10-25 12:50:06 -0400] GeoffC_: I presume you have already gone through that and now are trying some new cookbooks?
[2013-10-25 12:52:45 -0400] caseydriscoll: ive been using this one https://gist.github.com/dergachev/3866825
[2013-10-25 12:52:51 -0400] caseydriscoll: but they all seem very similar
[2013-10-25 12:55:16 -0400] caseydriscoll: at this point i would just be happy to run *any* cookbook through vagrant
[2013-10-25 12:56:58 -0400] GeoffC_: well this guide you are using doesn't seem to say anything about configuring knife and your PEM files, are you sure those are setup correctly and in the correct directory?  I suggest following this guide which uses vagrant/chef and makes sure the workstation is setup properly https://learnchef.opscode.com/quickstart/workstation-setup/
[2013-10-25 13:08:59 -0400] GeoffC_: Can anyone help me connect my windows chef workstation to an open source chef ubuntu server?  I keep getting permission denied when trying to scp the admin.pem file
[2013-10-25 13:40:10 -0400] CPS: GeoffC_: that's probably a permissions problem on the ubuntu side
[2013-10-25 13:40:30 -0400] CPS: copy the file somewhere else and chmod 777 it to scp it over
[2013-10-25 13:40:37 -0400] GeoffC_: CPS I think you are right, yes I am working on that now
[2013-10-25 13:40:47 -0400] GeoffC_: although I followed some dumb guide using the web interface and now my keys are messed up
[2013-10-25 13:40:52 -0400] GeoffC_: !
[2013-10-25 13:41:28 -0400] CPS: i have a similar setup, it's a pain but once you get it sorted it works pretty well
[2013-10-25 13:41:49 -0400] GeoffC_: nice, when you have some time I'd like to discuss the nagios setup
[2013-10-25 13:44:03 -0400] CPS: afraid i probably won't be much help there
[2013-10-25 13:44:15 -0400] CPS: i'm still just a beginner
[2013-10-25 13:45:37 -0400] GeoffC_: oh ok
[2013-10-25 13:47:46 -0400] UForgotten: we all gotta start somewhere :)
[2013-10-25 13:49:32 -0400] GeoffC_: CPS I cp the files to my home folder then chmoded them and scp them to my ~/chef-repo/.chef
[2013-10-25 13:49:46 -0400] GeoffC_: then I run the knife configure -initial using the correct locations for the pem files
[2013-10-25 13:50:04 -0400] GeoffC_: I get Failed to authenticate as admin with key (key path) invalid signature
[2013-10-25 13:50:24 -0400] GeoffC_: now I did try to reset the keys using the web interface
[2013-10-25 13:50:33 -0400] GeoffC_: but I copied the new key into the pem files on the ubuntu server
[2013-10-25 13:51:06 -0400] CPS: well it's not liking something about the credentials you're using
[2013-10-25 13:51:15 -0400] CPS: what do you have in client.rb?
[2013-10-25 13:53:26 -0400] UForgotten: did you chmod them back properly on both sides? 
[2013-10-25 13:53:33 -0400] UForgotten: theyy probably need to be chmod 0600 
[2013-10-25 13:53:43 -0400] UForgotten: pem files need to be secure permissions-wise
[2013-10-25 13:53:48 -0400] CPS: client is on windows
[2013-10-25 13:54:10 -0400] CPS: and i believe he copied the pem to another location in order to copy it to the client
[2013-10-25 14:40:00 -0400] GeoffC_: I still don't have that client.rb file CPS
[2013-10-25 14:40:11 -0400] CPS: it's in c:\chef
[2013-10-25 14:40:21 -0400] GeoffC_: I know remember this whole game
[2013-10-25 14:40:27 -0400] GeoffC_: I install the thing, my c:\chef is empty
[2013-10-25 14:40:35 -0400] GeoffC_: this is on a different computer even
[2013-10-25 14:41:07 -0400] CPS: that might be created by knife config initial
[2013-10-25 14:41:12 -0400] CPS: just guessing
[2013-10-25 14:41:20 -0400] GeoffC_: ya could be
[2013-10-25 14:41:24 -0400] CPS: what's in knife.rb then?
[2013-10-25 14:42:08 -0400] GeoffC_: looks like it changed itself at some point to have the correct information
[2013-10-25 14:42:45 -0400] dyaitskov: Why does tutorial say to put absolute static path to cookbooks into the knife.rb file? I'd like to put something like File.dirname(__FILE__).
[2013-10-25 14:43:21 -0400] CPS: try it, it may work dyaitskov 
[2013-10-25 15:18:43 -0400] CPS: i've created a role using the web interface. how do i get the json file to my workstation?
[2013-10-25 15:20:52 -0400] GeoffC_: mmzyk you around?
[2013-10-25 15:21:25 -0400] mmzyk: I am. Have been looking at other stuff though and not this channel so far today.
[2013-10-25 15:21:31 -0400] mmzyk: What's up?
[2013-10-25 15:21:52 -0400] GeoffC_: I'm having some difficulty connecting my chef workstation to my open chef server
[2013-10-25 15:22:11 -0400] GeoffC_: I was wondering if you have some knowledge on that, pem files I think is the issue
[2013-10-25 15:22:21 -0400] GeoffC_: really I'm stuck at the knife configure command
[2013-10-25 15:22:25 -0400] mmzyk: mostly likely it's pem files, yeah.
[2013-10-25 15:22:47 -0400] GeoffC_: so if I reset the keys for the admin.pem and the chef-validator.pem is there a way to reinstall those on the server
[2013-10-25 15:22:56 -0400] GeoffC_: or do I just open the existing with vim and copy and past
[2013-10-25 15:22:58 -0400] GeoffC_: paste
[2013-10-25 15:23:59 -0400] mmzyk: So the server keeps a copy of your public key I believe - when you reset the keys, it has the copy it needs and now assumes that is your new key. It gives you a copy of the private key, which you need to put in place (copy/paste or move the file into place)
[2013-10-25 15:24:46 -0400] mmzyk: Where you put the keys is actually up to you, you just need to ensure your knife.rb and client.rb config files point to the proper keys.
[2013-10-25 15:26:43 -0400] mmzyk: These docs might be helpful on explaining the keys: http://docs.opscode.com/chef_private_keys.html
[2013-10-25 15:27:26 -0400] mmzyk: In short, if you've regained the keys but didn't copy/save the keys that the server gave back to you you're going to need to regen them again GeoffC_.
[2013-10-25 15:27:39 -0400] mmzyk: The server doesn't keep a copy of the private key for security purposes.
[2013-10-25 15:31:39 -0400] mmzyk: To dyaitskov's point, even though he's left the room, the tutorial is just taking the path of least resistance. You can absolutely use ruby constructs like File.dirname(__FILE__) in the configs, since they are just ruby files.
[2013-10-25 15:33:09 -0400] mmzyk: CPS knife download will get the role onto your workstation. http://docs.opscode.com/knife_download.html
[2013-10-25 15:34:10 -0400] CPS: "knife download" prints a help message
[2013-10-25 15:34:16 -0400] CPS: does this mean something in the config is incorrect?
[2013-10-25 15:34:52 -0400] CPS: oh, need "knife download ."
[2013-10-25 15:35:10 -0400] mmzyk: ah - what version of the client are you running?
[2013-10-25 15:35:27 -0400] CPS: 11.6.2
[2013-10-25 15:35:40 -0400] mmzyk: hmm. I would expect it to be there.
[2013-10-25 15:36:27 -0400] GeoffC_: so mmzyk can I reset my keys on the server, by that I mean can I just start from scratch on everything?
[2013-10-25 15:36:47 -0400] mmzyk: In the webui on the server you can reset your keys.
[2013-10-25 15:37:03 -0400] GeoffC_: but it doesn't change the ones in /etc/chef-server/
[2013-10-25 15:37:57 -0400] mmzyk: CPS you can install the knife-essentials gem to get knife download if it's not there for some reason. https://github.com/jkeiser/knife-essentials
[2013-10-25 15:38:13 -0400] CPS: it was just missing a parameter
[2013-10-25 15:38:24 -0400] CPS: unless that wasn't expected
[2013-10-25 15:38:26 -0400] jkeiser: 11.6.2 has it, yep
[2013-10-25 15:38:29 -0400] mmzyk: ah, okay. I was confused for a minute there. :)
[2013-10-25 15:38:46 -0400] CPS: the period is important
[2013-10-25 15:39:33 -0400] mmzyk: GeoffC_ Even if you reset the keys the server handles the management on it's side, so you shouldn't need to worry about the server keys.
[2013-10-25 15:39:47 -0400] GeoffC_: oh ok
[2013-10-25 15:39:58 -0400] mmzyk: It will regen new key pairs, keeping the public key it needs and giving you the private key for you to put on the client/workstation.
[2013-10-25 15:40:21 -0400] mmzyk: So no need to start over or reinstall stuff, you just have to put the keys in the right places.
[2013-10-25 15:41:00 -0400] GeoffC_: I think it's some mismatch in credentials maybe
[2013-10-25 15:41:01 -0400] mmzyk: Random note CPS - jkeiser wrote knife-essentials (which included knife download) that is now just folded into knife. You can tell you a lot about it. :)
[2013-10-25 15:41:05 -0400] GeoffC_: it doesn't like admin.pem for some reason
[2013-10-25 15:42:07 -0400] mmzyk: Can you walk me thought what you've done and are trying to do GeoffC_? I want to make sure I fully understand so I give you the right advice.
[2013-10-25 15:42:29 -0400] GeoffC_: ok so I have installed the opensource server on ubuntu with a local account
[2013-10-25 15:42:52 -0400] GeoffC_: then I installed the chef software and git the chef-repo folder
[2013-10-25 15:43:38 -0400] GeoffC_: then I copied the pem keys from /etc/chef-server/ to /home/*****/ and chmod and chowned them to the local admin account
[2013-10-25 15:43:50 -0400] GeoffC_: then I scp over to my ~/chef-repo/.chef folder
[2013-10-25 15:44:56 -0400] GeoffC_: then I ran the knife configure --initial using the server url and the local workstation directories for the pem files
[2013-10-25 15:45:08 -0400] mmzyk: Let me drop you our official docs on this part so you can compare with those - might be helpfull: http://docs.opscode.com/install_workstation.html#get-the-pem-files-and-knife-rb-files
[2013-10-25 15:46:16 -0400] mmzyk: That hopefully clears up confusion around the various files as well. I think you're on the right track GeoffC_.
[2013-10-25 15:46:23 -0400] GeoffC_: ok thanks for that
[2013-10-25 15:48:07 -0400] mmzyk: If you still run into trouble, certainly ask more questions and I'll answer them. If the docs are confusing/not clear, let me know that too and I'll pass along that info to our tech writer.
[2013-10-25 15:50:50 -0400] GeoffC_: ERROR: Failed to authenticate to https://****:443 as admin with key H:/chef-repo/.chef/admin.pem Response:  Invalid signature for user or client 'admin'
[2013-10-25 15:51:13 -0400] GeoffC_: admin I assume is the default user of chef, not the actual user I created when building the ubuntu vm?
[2013-10-25 15:52:37 -0400] mmzyk: Not sure, but it seems like it thinks that is your client key, so it seems to be thinking that is the client it should use. 
[2013-10-25 15:53:56 -0400] GeoffC_: well it is I copied it from the server
[2013-10-25 15:54:02 -0400] mmzyk: If you do a knife client list and a knife user list, do you see the clients and users you expect to see?
[2013-10-25 15:54:56 -0400] GeoffC_: knife client list yeilds chef-validator and chef-webui
[2013-10-25 15:55:11 -0400] GeoffC_: knife user list yields admin and my username
[2013-10-25 15:55:25 -0400] GeoffC_: maybe its working?
[2013-10-25 15:57:11 -0400] mmzyk: Sounds like we're on the right track - what did you do when you got the error?
[2013-10-25 15:57:22 -0400] mmzyk: what command were you running?
[2013-10-25 15:57:32 -0400] GeoffC_: tried rerunning the knife configure --initial
[2013-10-25 15:58:29 -0400] mmzyk: gotcha.
[2013-10-25 15:58:56 -0400] mmzyk: So it looks like in that case it tried to use the default admin user that exists.
[2013-10-25 15:59:02 -0400] GeoffC_: yes it did
[2013-10-25 15:59:11 -0400] mmzyk: Which, if you haven't done so, you should change their password on the server: http://docs.opscode.com/chef/manage_server_open_source.html#log-in
[2013-10-25 15:59:24 -0400] mmzyk: But since knife is working, it looks like you're user is okay.
[2013-10-25 15:59:39 -0400] mmzyk: I assume you have your knife.rb file set to use your user.
[2013-10-25 15:59:40 -0400] GeoffC_: oh ok
[2013-10-25 15:59:50 -0400] GeoffC_: yea that looks like it took all the appropriate settings
[2013-10-25 15:59:58 -0400] GeoffC_: well I'll press on
[2013-10-25 16:00:00 -0400] mmzyk: so I think you're keys are okay, other than you must have changed the admin one and that keys is now wrong on your workstation.
[2013-10-25 16:00:52 -0400] GeoffC_: but knife client list should return my workstation and the server I thought
[2013-10-25 16:00:52 -0400] mmzyk: but your workstation is going to use the username key pair set in knife.rb and client.rb in general.
[2013-10-25 16:00:56 -0400] GeoffC_: according to the article
[2013-10-25 16:01:12 -0400] mmzyk: What did it return?
[2013-10-25 16:01:18 -0400] GeoffC_: chef-validator and chef-webui
[2013-10-25 16:01:28 -0400] GeoffC_: I guess I was expecting my dns names
[2013-10-25 16:02:42 -0400] mmzyk: Yeah, I think everything is okay. It's going to return you the names of the clients it knows about, but it's going to give you the client names, not the dns names.
[2013-10-25 16:03:43 -0400] mmzyk: Looks like you have your workstations setup for your user, but it's not yet setup as a client., since it doesn't show in that list (which is fine - your workstation doesn't have to be a chef-client)
[2013-10-25 16:04:38 -0400] GeoffC_: ah I see
[2013-10-25 16:04:40 -0400] GeoffC_: makes sense
[2013-10-25 16:17:42 -0400] GeoffC_: I may have figured out the issue mmzyk with the error
[2013-10-25 16:17:53 -0400] mmzyk: cool.
[2013-10-25 17:32:17 -0400] GeoffC_: CPS did you ever find the json for nagios?
[2013-10-25 17:34:47 -0400] CPS: nagios isn't really on my todo list
[2013-10-25 17:35:11 -0400] CPS: i'm focused on setting up install scripts and getting our nodes broken down by role and environment
[2013-10-25 17:35:37 -0400] GeoffC_: I see
[2013-10-25 17:35:48 -0400] GeoffC_: you were asking about a json earlier though
[2013-10-25 17:35:56 -0400] GeoffC_: assumed it could be a related issue
[2013-10-25 17:36:14 -0400] CPS: chef stores just about everything in json format
[2013-10-25 17:36:39 -0400] CPS: i was asking about a role and getting it from the server to the workstation
[2013-10-25 17:36:49 -0400] GeoffC_: oic
[2013-10-25 17:41:34 -0400] CPS: maybe look at http://community.opscode.com/cookbooks/nagios
[2013-10-25 18:21:18 -0400] grepory: getting SSL connection errors when running chef-server-ctl test (new chef install).. http-traffic.log shows Conn close because of connect error Connection reset by peer - SSL_connect
[2013-10-25 18:27:03 -0400] grepory: reboot instance. works. yay 
[2013-10-25 18:28:09 -0400] binamov: :)
[2013-10-25 18:28:23 -0400] grepory: it's like windows.
[2013-10-25 18:28:41 -0400] binamov: hahaha noooooooo :) perhaps you already had something on 443?
[2013-10-25 18:29:09 -0400] binamov: chef-server-ctl reconfigure worked?
[2013-10-25 18:53:03 -0400] grepory: binamov: yeah it worked
[2013-10-25 18:53:37 -0400] grepory: i have no reasonable explanation for why the reboot fixed it, but i finally found a thread on google and the guy had the exact same problem i did. restarted his vm. worked like a charm.
[2013-10-25 19:25:44 -0400] CPS: how do I use " characters in templates?
[2013-10-25 19:26:16 -0400] CPS: for something like <%= "field="value"" %>
[2013-10-25 19:28:30 -0400] bean: CPS: I think something like 'field = "<%= #{value} %>"'
[2013-10-25 19:29:12 -0400] CPS: i'll give that a go
[2013-10-25 19:36:31 -0400] mmzyk: CPS So templates are just ruby ERB templates.
[2013-10-25 19:36:59 -0400] mmzyk: So some searching can turn up tutorials and the like to show you how to use  it, since it's a part of core ruby. 
[2013-10-25 19:37:09 -0400] mmzyk: http://www.stuartellis.eu/articles/erb/ A quick search found that for example.
[2013-10-25 20:14:22 -0400] CPS: in this json snippet, i'm passing in the root to a template and iterating over each mesh. how do i access the clients and servers inside each mesh? https://gist.github.com/anonymous/7161018
[2013-10-25 20:16:45 -0400] CPS: i've got <% @meshes.each_with_index do |mesh, index| %><% mesh[0].each do |name| %>
[2013-10-25 20:16:47 -0400] CPS: that doesn't work
[2013-10-25 20:30:53 -0400] UForgotten: CPS: that sounds like a fairly complicated hash you have there :) 
[2013-10-25 20:31:31 -0400] CPS: yeah but once i get this sorted maintenance will be a breeze
[2013-10-25 20:31:38 -0400] UForgotten: maybe try not closing  the tag  %><% in between?
[2013-10-25 20:31:41 -0400] CPS: and i think mesh["clients"] gets it
[2013-10-25 20:37:08 -0400] CPS: it's also the only way i could think to generate an arbitrary number of xml tags
[2013-10-25 20:39:51 -0400] UForgotten: hmm, if you're not using the index why do you need with index? Have you tried this inside an irb console to see if it's getting the right object elements? 
[2013-10-25 20:49:39 -0400] CPS: i'm using it elsewhere
[2013-10-25 20:49:44 -0400] CPS: i figured it out
[2013-10-25 20:50:03 -0400] CPS: mesh["clients"].each gets me what i want
[2013-10-25 20:50:20 -0400] CPS: and now i'm going home
