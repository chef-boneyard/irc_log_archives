[2013-10-23 12:53:18 -0400] robvirsatel: Hi, is anyone here who can help me with setup on a Macbook?
[2013-10-23 13:09:30 -0400] beantown2013: I just noticed a bunch of tools installed with chef-solo (under C:\opscode\chef\embedded\bin on Windows). Are these tools that are officially bundled and available for recipe development? I want to use the windows sed.exe.
[2013-10-23 13:37:43 -0400] aj_: Looking for some advise on the best way to deploy a WAR file to tomcat when I need to modify the system.properties based on node attributes from Chef - any pointers?
[2013-10-23 13:41:07 -0400] JamesBelchamber: Hey all
[2013-10-23 13:41:26 -0400] JamesBelchamber: trying to get chef installed on Fedora 19, seems like it's not something people.. do
[2013-10-23 13:42:25 -0400] aj_: interesting - looks like lots of questions here but few answers.
[2013-10-23 14:10:53 -0400] joe_k: is there a special syntax for referring to a role from a runlist?
[2013-10-23 14:11:03 -0400] joe_k: when we add the role name, it says "cookbook X not found"
[2013-10-23 14:11:12 -0400] joe_k: as though it thinks we're referring to a cookbook instead of a role
[2013-10-23 14:26:31 -0400] robvirsatel: i'm looking for help to install chef client on osx 10.8
[2013-10-23 14:28:10 -0400] mmzyk: robvirsatel What do you need?
[2013-10-23 14:28:17 -0400] mmzyk: Just looking where to get started? 
[2013-10-23 14:28:48 -0400] mmzyk: The install page where you can download the packaged installers is your best bet, if that is what you are looking for: http://www.opscode.com/chef/install/
[2013-10-23 14:28:57 -0400] mmzyk: It includes os x
[2013-10-23 14:29:26 -0400] robvirsatel: Just trying to follow https://learnchef.opscode.com/quickstart/workstation-setup/ ...
[2013-10-23 14:29:56 -0400] robvirsatel: I already have ruby with rvm so in the Advanced tab ...
[2013-10-23 14:30:45 -0400] robvirsatel: I have ruby 2.0.0p247 (2013-06-27 revision 41674) [x86_64-darwin12.3.0]  ...
[2013-10-23 14:31:32 -0400] mmzyk: joe_k These docs might give you an answer: http://docs.opscode.com/knife_node.html#run-list-add
[2013-10-23 14:31:37 -0400] robvirsatel: so I got chef-repo from Github but 'knife client list' fails.
[2013-10-23 14:32:19 -0400] mmzyk: ah. Did you download the start kit at all, robvirsatel?
[2013-10-23 14:33:17 -0400] mmzyk: You said you pulled it off of github earlier - but the key is the one on github isn't tied to to your hosted account in anyway.
[2013-10-23 14:33:20 -0400] robvirsatel: I couldn't find a link to it which is why I took it from Github.
[2013-10-23 14:33:43 -0400] mmzyk: gotcha - it's much easier with it. on second while I tell you where to go to get it.
[2013-10-23 14:33:53 -0400] robvirsatel: Ah, hence no pem files :-)
[2013-10-23 14:34:07 -0400] mmzyk: there is a link when you first sign up, but if you miss it we don't make it easy to find again.
[2013-10-23 14:34:17 -0400] mmzyk: an over site we're working on.
[2013-10-23 14:34:33 -0400] joe_k: mmzyk: interesting that syntax isnt anywhere on http://docs.opscode.com/knife_role.html
[2013-10-23 14:35:02 -0400] joe_k: i am trying NOT to use knife to mutate the server without changing the repo
[2013-10-23 14:35:21 -0400] joe_k: so i wasnt looking at knife mutation commands
[2013-10-23 14:35:48 -0400] joe_k: but thanks!
[2013-10-23 14:36:28 -0400] robvirsatel: I looked in the sign-up email but didn't see anything
[2013-10-23 14:36:58 -0400] joe_k: and this is still correct? http://stackoverflow.com/questions/18260991/why-doesnt-knife-upload-roles-upload-any-roles
[2013-10-23 14:37:05 -0400] joe_k: i need to use a different workflow to upload roles?
[2013-10-23 14:38:23 -0400] mmzyk: robvirsatel yeah, I don't think it's in there. It's entirely our fault we don't make it easy to find.
[2013-10-23 14:38:53 -0400] mmzyk: joe_k I used the search the docs function to find that, and I have no idea if that role info is still correct.
[2013-10-23 14:39:05 -0400] robvirsatel: That's ok :-) Did you paste the link here yet?
[2013-10-23 14:39:08 -0400] mmzyk: I saw jkeiser come in - do you know the answer to the role question John?
[2013-10-23 14:39:22 -0400] mmzyk: no, got distracted, one more minute robvirsatel
[2013-10-23 14:39:29 -0400] robvirsatel: Ta
[2013-10-23 14:39:45 -0400] mmzyk: You're going to want to go to preview.opscode.com and log in robvirsatel.
[2013-10-23 14:39:52 -0400] mmzyk: Same login as what you use at manage.opscode.com
[2013-10-23 14:40:03 -0400] mmzyk: preview is, naturally, a preview of things to come.
[2013-10-23 14:40:13 -0400] mmzyk: but it's currently the only place you can get the start kit if you miss it.
[2013-10-23 14:41:29 -0400] mmzyk: Once you're logged in, click on your organization name in the upper right hand corner.
[2013-10-23 14:41:53 -0400] mmzyk: On the page that comes up, click the gear under actions on the right hand side and you'll see a link that says starter kit.
[2013-10-23 14:42:10 -0400] mmzyk: That will get you a new starter kit, robvirsatel, will make your life easier.
[2013-10-23 14:42:28 -0400] mmzyk: Beware that it will regen your keys, but if you've got nothing setup, that won't matter.
[2013-10-23 14:44:10 -0400] robvirsatel: Links are; Invite, Change Password, Reset Key, 'Remove Organisation' ?
[2013-10-23 14:45:14 -0400] mmzyk: robvirsatel Are you on preview.opscode.com?
[2013-10-23 14:45:26 -0400] mmzyk: It's important you be on preview and not on manage.
[2013-10-23 14:45:33 -0400] robvirsatel: https://preview.opscode.com/organizations/robvirsatel/users/robvirsatel
[2013-10-23 14:46:10 -0400] mmzyk: ah. okay.
[2013-10-23 14:46:29 -0400] mmzyk: You're in the user section - on the left, click where it says organization to bring that section up
[2013-10-23 14:47:23 -0400] robvirsatel: Ah, found a bug for you :-)
[2013-10-23 14:47:52 -0400] mmzyk: Awesome. What is it?
[2013-10-23 14:48:35 -0400] mmzyk: joe_k On the roles question, I believe that is still true, re: the stack overflow link, but jkeiser (whom I've poked through company chat) would likely know for sure.
[2013-10-23 14:48:37 -0400] robvirsatel: When I select Organisation robvirsatel then Manage Organisations, there is no gear icon under actions but if I mouse-over the area under actions it appears :-)
[2013-10-23 14:49:14 -0400] mmzyk: gotcha. well, it's preview for a reason. :)
[2013-10-23 14:49:33 -0400] robvirsatel: Found the Starter kit link now. Thanks
[2013-10-23 14:49:35 -0400] mmzyk: You'll also see if you select an org that the starter kit link will be active on the right in nav menu
[2013-10-23 14:49:52 -0400] mmzyk: excellent, just post here if you have any more issues.
[2013-10-23 14:50:02 -0400] robvirsatel: Thanks again
[2013-10-23 14:50:17 -0400] mmzyk: no problem, sorry it's not the most intuitive thing to find.
[2013-10-23 14:50:30 -0400] jkeiser: mmzyk, robvirsatel: knife upload only supports roles in .json format at the moment, unfortunately
[2013-10-23 14:51:19 -0400] jkeiser: So if you convert the role to a .json file, knife upload will upload it
[2013-10-23 14:51:49 -0400] mmzyk: joe_k is who you want to reply to jkeiser. :)
[2013-10-23 14:51:57 -0400] robvirsatel: Should I be understanding the meaning of this .json stuff?
[2013-10-23 14:51:58 -0400] mmzyk: I imagine robvirsatel is very confused now.
[2013-10-23 14:52:07 -0400] jkeiser: oh sorry
[2013-10-23 14:52:22 -0400] robvirsatel: I was confused before :)
[2013-10-23 14:52:25 -0400] jkeiser: My head is still fuzzy from the waking of the up
[2013-10-23 14:52:42 -0400] mmzyk: No worries robvirsatel. We'll help you sort it out.
[2013-10-23 14:54:04 -0400] joe_k: i definite like "documents" and "values" rather than "imperative code" in my cookbooks... i might have to move to json
[2013-10-23 14:54:10 -0400] joe_k: any support for yaml? its a lot easier to write by hand
[2013-10-23 14:55:38 -0400] robvirsatel: Must chef-repo be under ~? Will I only have one or one per project?
[2013-10-23 14:57:25 -0400] mmzyk: joe_k currently only json is supported.
[2013-10-23 14:57:51 -0400] mmzyk: well, I know yaml isn't supported anyway. I believe json is currently the only option.
[2013-10-23 14:58:49 -0400] mmzyk: robvirsatel It can live where ever you want it to live, so long as you tell the configs for knife and chef-client where to find it.
[2013-10-23 14:58:51 -0400] jkeiser: Yeah, only json at the moment.  yaml and rb formats are things people would like to support, but it'll take time
[2013-10-23 14:59:16 -0400] robvirsatel: Ah so only one at a time.
[2013-10-23 14:59:42 -0400] mmzyk: robvirsatel it isn't strictly needed, but for purposes of the quick start it makes life easier.
[2013-10-23 15:01:21 -0400] jkeiser: robvirsatel: one chef_repo per organization generally.  Basically one per project, depending on what you mean by project :)  Generally if two projects aren't related at all and you don't want to share cookbooks and such, that's a good reason to split into two chef repositories
[2013-10-23 15:02:55 -0400] jkeiser: And yes, it is absolutely one chef_repo at a time.  Two different directories can be two different repos, but you can only work with one of them at a time using knife.
[2013-10-23 16:23:39 -0400] joe_k: somehow this happened
[2013-10-23 16:23:43 -0400] joe_k: ec2-54-211-74-147.compute-1.amazonaws.com [2013-10-23T15:22:59+00:00] INFO: Run List is [recipe[roles]]
[2013-10-23 16:23:45 -0400] joe_k: ec2-54-211-74-147.compute-1.amazonaws.com [2013-10-23T15:22:59+00:00] INFO: Run List expands to [roles]
[2013-10-23 16:23:57 -0400] joe_k: my run list is "visualstudio" and i have a role named that
[2013-10-23 16:24:09 -0400] joe_k: err, role[visualstudio]
[2013-10-23 16:24:20 -0400] joe_k: dont understand why that went wrong
[2013-10-23 16:25:17 -0400] joe_k: so if a role has run list items, in what order are they executed?
[2013-10-23 16:25:36 -0400] joe_k: depth first I presume?
[2013-10-23 16:58:09 -0400] mmzyk: not sure I'm following joe_k
[2013-10-23 16:58:20 -0400] mmzyk: other than something didn't happen right with the run list
[2013-10-23 17:00:29 -0400] joe_k: run list says "role[visualstudio]"
[2013-10-23 17:00:36 -0400] mmzyk: A run list is run in the order specified by you, fyi.
[2013-10-23 17:00:37 -0400] joe_k: chef client expanded it to "roles"
[2013-10-23 17:00:38 -0400] joe_k: i dont get that
[2013-10-23 17:00:47 -0400] mmzyk: But see here: http://docs.opscode.com/essentials_nodes_chef_run.html 
[2013-10-23 17:00:52 -0400] mmzyk: the expand the run-list step
[2013-10-23 17:01:03 -0400] joe_k: right an a role can specify more run lists. so theres a tree of run list items
[2013-10-23 17:01:12 -0400] mmzyk: where it looks at the other roles and cookbooks specified to figure out what the run list should be.
[2013-10-23 17:01:40 -0400] mmzyk: right - should all be depth first, as you said, now that I think about it more deeply.
[2013-10-23 17:04:37 -0400] mmzyk: joe_k I'm trying to think what went wrong.
[2013-10-23 17:05:55 -0400] mmzyk: joe_k what do you see if you do a knife node show NODE_NAME --run-list ?
[2013-10-23 17:07:18 -0400] joe_k: i-cf6a30ab:
[2013-10-23 17:07:20 -0400] joe_k:   run_list:
[2013-10-23 17:07:30 -0400] joe_k: run list was specified with -r option to knife ec2 server create
[2013-10-23 17:08:13 -0400] joe_k: chef needs a way to converge _its own_ configuration. too many pieces that are manually touched
[2013-10-23 17:08:48 -0400] joe_k: and one piece doesnt know the details you give the other piece
[2013-10-23 17:12:44 -0400] mmzyk: we do our best to handle the complexity and we're always trying to improve. lots of pieces to manage is always hard.
[2013-10-23 17:14:31 -0400] binamov: hm still not clear what's going on here :)
[2013-10-23 17:15:29 -0400] binamov: joe_k run list items get executed in order that they appear in the run list 
[2013-10-23 17:16:13 -0400] joe_k: so does a role add items to the end of the run list or does it insert items after itself (essentially)
[2013-10-23 17:16:38 -0400] joe_k: (seems like depth-first is logical)
[2013-10-23 17:16:46 -0400] nathenharvey: @joe_k are you up for a google hangout?  I might be able to help with your run list questions
[2013-10-23 17:17:05 -0400] joe_k: cant now, booked up with meetings
[2013-10-23 17:17:11 -0400] joe_k: but yes
[2013-10-23 17:18:06 -0400] nathenharvey: can you do a 'knife node show NODE_NAME' (replacing NODE_NAME with your node's name) and past the result here, at least the 'Run List:' line.
[2013-10-23 17:18:30 -0400] someara: joe_k a run_list is expanded depth first
[2013-10-23 17:18:32 -0400] nathenharvey: sorry, jumping in late and don't have the full backscroll but will definitely help you over this roadblock
[2013-10-23 17:18:51 -0400] binamov: run_list showed empty from previous paste 
[2013-10-23 17:19:14 -0400] binamov: [10:07:19] joe_k: i-cf6a30ab:
[2013-10-23 17:19:15 -0400] binamov: [10:07:21] joe_k:   run_list:
[2013-10-23 17:19:15 -0400] binamov: [10:07:31] joe_k: run list was specified with -r option to knife ec2 server create
[2013-10-23 17:19:21 -0400] joe_k: command to start server was
[2013-10-23 17:19:36 -0400] someara: roles are nodes and recipes are leaves
[2013-10-23 17:19:57 -0400] joe_k: http://pastebin.com/8rNTUjcz
[2013-10-23 17:20:49 -0400] binamov: joe_k did you create role visualstudio yourself?
[2013-10-23 17:20:52 -0400] joe_k: yes
[2013-10-23 17:21:00 -0400] binamov: pastebin please?
[2013-10-23 17:21:19 -0400] joe_k: role/visualstudio.rb:
[2013-10-23 17:21:21 -0400] joe_k: http://pastebin.com/DF6mhrCi\
[2013-10-23 17:21:23 -0400] joe_k: http://pastebin.com/DF6mhrCi
[2013-10-23 17:22:02 -0400] joe_k: err, roles/ not role
[2013-10-23 17:23:09 -0400] ssd7_: This likely doesn't have to do with the role definition and is a result of shell expansion and escaping when you pass the -r parameter on the command line.
[2013-10-23 17:23:32 -0400] joe_k: cookbooks/versionone/recipies/visualstudio.rb:
[2013-10-23 17:23:39 -0400] joe_k: http://pastebin.com/ZrfUGTXp
[2013-10-23 17:23:53 -0400] joe_k: single quotes prevent shell expansion
[2013-10-23 17:24:17 -0400] ssd7_: joe_k: are you on windows?
[2013-10-23 17:24:39 -0400] joe_k: i am but this command is issued with bash
[2013-10-23 17:24:44 -0400] joe_k: JKOBERG1 ~/devops/chef-repo/roles $ echo 'role[visualstudio]'
[2013-10-23 17:24:46 -0400] joe_k: role[visualstudio]
[2013-10-23 17:25:00 -0400] ssd7_: We've seen odd issues with bash on windows and escaping not working like you would think when dealing with arguments to knife
[2013-10-23 17:25:46 -0400] joe_k: great
[2013-10-23 17:26:45 -0400] ssd7_: joe_k: trying to find what I've done to work around it in the past
[2013-10-23 17:27:17 -0400] binamov: joe_k tried doublequotes around -r "role[blabla]" ?
[2013-10-23 17:32:31 -0400] ssd7_: joe_k: OK, found it. 
[2013-10-23 17:32:31 -0400] ssd7_: knife bootstrap FQDN --run-list '"role[test]"'
[2013-10-23 17:32:43 -0400] ssd7_: https://tickets.opscode.com/browse/CHEF-4277
[2013-10-23 17:32:49 -0400] binamov: woah triple quotes :)
[2013-10-23 17:35:06 -0400] joe_k: attempting. 
[2013-10-23 17:35:27 -0400] ssd7_: That is definitely sub-optimal, but if I remember our investigation it is an upstream issue in how mingw handles arguments
[2013-10-23 17:38:16 -0400] ssd7_: upstream bug: http://sourceforge.net/p/mingw/bugs/1621/
[2013-10-23 17:48:57 -0400] robvirsatel: Hi, I'm looking for help with https://learnchef.opscode.com/quickstart/converge/
[2013-10-23 17:50:14 -0400] nathenharvey: @robvirsatel what's up?
[2013-10-23 17:52:34 -0400] robvirsatel: I've just tried  "Bootstrap the node" knife bootstrap localhost etc and I get Error: Connection refused
[2013-10-23 17:53:03 -0400] joe_k: is it running sshd ?
[2013-10-23 17:53:12 -0400] joe_k: what os?
[2013-10-23 17:54:38 -0400] nathenharvey: @robvirsatel can you try 'vagrant ssh' and see if that works?
[2013-10-23 17:55:48 -0400] robvirsatel: OSX 10.8. I've just noticed "If you've used Vagrant before, please make sure all instances but this one are turned off (vagrant halt) before bootstrapping." the words 'but this one" so I've got it now. Thanks anyway :)
[2013-10-23 17:56:51 -0400] nathenharvey: that's what I suspected.  Alternatively, you can run 'vagrant ssh-config' to find out what port that particular vagrant is listening on (it's likely not 2222)
[2013-10-23 17:57:04 -0400] ssd7_: joe_k: Did that end up working for you?
[2013-10-23 17:57:20 -0400] nathenharvey: so you either need to stop all the other vagrants or use a different ssh-port
[2013-10-23 17:58:59 -0400] joe_k: waiting for bootstrap. windows ec2 images take about 25 minutes
[2013-10-23 18:01:12 -0400] robvirsatel: How come the docs say "18 resources updated" while I got 28?
[2013-10-23 18:02:40 -0400] joe_k: ssd7_: ec2-23-20-111-215.compute-1.amazonaws.com [2013-10-23T18:02:15+00:00] FATAL: ArgumentError: Unable to create Chef::RunList::RunListItem from String:"\"role[visualstudio]\"": must be recipe[] or role[]
[2013-10-23 18:02:49 -0400] joe_k: the quotes made it all the way through
[2013-10-23 18:03:12 -0400] joe_k: probably would be good to define a syntax that doesn't include metacharacters instead of being "kind of like ruby"
[2013-10-23 18:03:37 -0400] joe_k: similarity to ruby, while not being ruby, is not a goal to me
[2013-10-23 18:03:54 -0400] joe_k: ill see if I can issue a patch :)
[2013-10-23 18:04:21 -0400] joe_k: one day
[2013-10-23 18:05:59 -0400] joe_k: i dont know where to specify the run list unless i hand-tweak it on the chef server, but that doesn't work with my workflow - I am spawning totally new instances from cli
[2013-10-23 18:06:07 -0400] joe_k: they dont hang around
[2013-10-23 18:06:33 -0400] joe_k: is there a way to make machine templates?
[2013-10-23 18:06:45 -0400] ssd7_: joe_k: Uff. :( You could maybe specify it in json that you pass using -j
[2013-10-23 18:07:10 -0400] joe_k: is the implication that it would work from powershell or cmd?
[2013-10-23 18:07:20 -0400] joe_k: i can try that
[2013-10-23 18:09:41 -0400] mirey: Hi everyone, having trouble debugging a chef recipe, rvm_passenger. It appears to be putting mod_passenger.so in the incorrect location, then apache fails to start
[2013-10-23 18:11:15 -0400] mirey: I created an issue here: https://github.com/fnichol/chef-rvm_passenger/issues/27 but I am stuck...
[2013-10-23 18:29:07 -0400] mmzyk: joe_k Yes, I think it would work in that case. You're in a fun place of using a linux system to fire up a windows machine and something is being lost in translation.
[2013-10-23 18:30:18 -0400] joe_k: i am using a windows machine to fire up a windows machine
[2013-10-23 18:30:20 -0400] mmzyk: mirey I recommend asking your question in #chef. More people are likely to have used that cookbook there.
[2013-10-23 18:30:49 -0400] mmzyk: joe_k well, by linux I mean the ec2 stuff, since I saw you were using the knife ec2 bit.
[2013-10-23 18:30:56 -0400] mmzyk: maybe I misunderstood.
[2013-10-23 18:32:34 -0400] mmzyk: by the way, we appreciate all the feedback joe_k. It shows us where we're weak w/ windows.
[2013-10-23 18:33:25 -0400] joe_k: thanks i dont want to just bitch but i do want this to work
[2013-10-23 18:33:42 -0400] mmzyk: yup, we want it to work too. :)
[2013-10-23 18:34:03 -0400] mmzyk: there's still conversation going on internally to figure out what's going on and the work around to get it to work.
[2013-10-23 18:36:15 -0400] joe_k: same issue with powershell. it's not mingw
[2013-10-23 18:36:19 -0400] joe_k: unless ruby is using mingw
[2013-10-23 18:37:10 -0400] mmzyk: When you say you used powershell, what command did you run?
[2013-10-23 18:37:32 -0400] joe_k: http://pastebin.com/EaGCbLv7
[2013-10-23 18:38:05 -0400] mmzyk: ah yeah, I think knife is pulling in mingw under the hood. 
[2013-10-23 18:38:19 -0400] joe_k: good lord why? its a ruby package
[2013-10-23 18:38:48 -0400] joe_k: so there's no way to communicate roles in the run list on the knife command line in windows? 
[2013-10-23 18:38:50 -0400] joe_k: wow
[2013-10-23 18:39:20 -0400] mmzyk: well, you can use the -j option and always pass in the json direction, which is what ssd7 suggested earlier.
[2013-10-23 18:39:33 -0400] joe_k: not sure what json would go there?
[2013-10-23 18:39:47 -0400] joe_k: {"role":
[2013-10-23 18:40:00 -0400] joe_k: ["visualstudio"]} ?
[2013-10-23 18:40:26 -0400] mmzyk: well. under the hood this is all being converted to json to get sent to the chef server. (by the way, I might be wrong on the mingw points I stated above. I'm not sure how it all gets put together w/o looking at it.)
[2013-10-23 18:41:12 -0400] joe_k: can you suggest a -j value and i'll try it
[2013-10-23 18:41:56 -0400] mmzyk: yeah, I'm asking a question to make sure I get the syntax right - one minute.
[2013-10-23 18:42:28 -0400] joe_k: this is on the "knife ec2 server create" command, right?
[2013-10-23 18:48:05 -0400] mmzyk: joe_k yeah, it's an option to knife-ec2, based on what I've been told (I haven't used knife-ec2 personally)
[2013-10-23 18:48:07 -0400] mmzyk: -j '{ run_list: "role[something]"}'
[2013-10-23 18:48:16 -0400] mmzyk: that's the syntax you want.
[2013-10-23 18:50:13 -0400] joe_k: how about -j '{"run_list":"role[visualstudio]"}'
[2013-10-23 18:50:22 -0400] joe_k: or should it be
[2013-10-23 18:50:29 -0400] joe_k: how about -j '{"run_list":["role[visualstudio]"]}'
[2013-10-23 18:50:45 -0400] joe_k: (is the run list space-separated or is it a json list)
[2013-10-23 18:53:56 -0400] mmzyk: the latter, I think. Then just add items by adding to the array, but I'm not certain w/o trying it.
[2013-10-23 19:00:51 -0400] joe_k: PS C:\Users\JKoberg\devops\chef-repo> echo '{"run_list":["role[visualstudio]"]}'
[2013-10-23 19:00:53 -0400] joe_k: {"run_list":["role[visualstudio]"]}
[2013-10-23 19:00:59 -0400] joe_k: ^^^ thus powershell quoting handles this
[2013-10-23 19:01:03 -0400] joe_k: but
[2013-10-23 19:01:39 -0400] joe_k: C:/Ruby193/lib/ruby/gems/1.9.1/gems/json-1.7.7/lib/json/common.rb:155:in `parse': 757: unexpected token at '{run_list:[role[visualstudio]]}' (JSON::ParserError)
[2013-10-23 19:01:47 -0400] joe_k: something somewhere took them out
[2013-10-23 19:02:02 -0400] mmzyk: gotcha.
[2013-10-23 19:02:27 -0400] joe_k: why do i feel like the first person to do this
[2013-10-23 19:02:35 -0400] joe_k: (get chef running under windows)
[2013-10-23 19:02:53 -0400] mmzyk: you're not, but I'd be lying if I said it was perfect.
[2013-10-23 19:03:21 -0400] mmzyk: One suggestion told me was to try escaping the brackets, but that might be a shot in the dark.
[2013-10-23 19:03:38 -0400] mmzyk: --run-list "role\[foo]"
[2013-10-23 19:06:19 -0400] joe_k: the brackets aren't the issue
[2013-10-23 19:06:23 -0400] joe_k: the brackets are making it through
[2013-10-23 19:06:37 -0400] joe_k: the brackets aren't metacharacters for anything but bash, and there's no bash here
[2013-10-23 19:08:21 -0400] mmzyk: okay.
[2013-10-23 19:08:47 -0400] mmzyk: From what I know then, -j sounds like the best option for now.
[2013-10-23 19:09:24 -0400] mmzyk: Would you be willing to open a bug ticket on this?
[2013-10-23 19:09:40 -0400] mmzyk: You're right in that it shouldn't be this hard.
[2013-10-23 19:12:03 -0400] joe_k: if i open a bug ticket and there's no fix, im going to have to start seeking another solution
[2013-10-23 19:12:17 -0400] joe_k: its getting to be every single step here
[2013-10-23 19:13:10 -0400] mmzyk: We're making a point to fix as many of the chef client bugs as we can (and this qualifies). I can't promise a time frame though.
[2013-10-23 19:13:21 -0400] mmzyk: Did -j pan out, or are you waiting on that?
[2013-10-23 19:13:28 -0400] joe_k: no, that's what I just pasted you
[2013-10-23 19:13:32 -0400] joe_k: it doesn't even start to launch
[2013-10-23 19:13:34 -0400] joe_k: its not a client issue
[2013-10-23 19:13:46 -0400] joe_k: its a knife issue
[2013-10-23 19:14:06 -0400] mmzyk: knife is considered part of chef-client - they ship together.
[2013-10-23 19:14:11 -0400] joe_k: suggestion: make knife have a "knife shell" command that gives you a knife> prompt
[2013-10-23 19:14:19 -0400] joe_k: then no one has to worry about their shell
[2013-10-23 19:14:21 -0400] joe_k: and ruby
[2013-10-23 19:14:41 -0400] joe_k: or make knife take a "command file"
[2013-10-23 19:14:42 -0400] mmzyk: not sure I entirely follow, but chef-shell does exist.
[2013-10-23 19:15:03 -0400] mmzyk: It's intended to be a repl where you can play with commands.
[2013-10-23 19:15:39 -0400] mmzyk: I'd honestly forgotten about it until you mentioned knife shell. http://docs.opscode.com/chef_shell.html
[2013-10-23 19:15:59 -0400] joe_k: well it wont be much good for me unless I can pipe in stdin, so we'll see how I can do that
[2013-10-23 19:16:14 -0400] joe_k: (goal is run from script to create provisioned ec2 node)
[2013-10-23 19:16:50 -0400] mmzyk: right.
[2013-10-23 19:17:22 -0400] joe_k: oh geez its slow. what's it loading?
[2013-10-23 19:17:39 -0400] mmzyk: windows is obviously not my strong suite. I'm going to see if I can get one of the engineers who knows windows better in here.
[2013-10-23 19:18:07 -0400] mmzyk: I don't know, actually, joe_k.
[2013-10-23 19:18:21 -0400] joe_k: i dont think this is what i want
[2013-10-23 19:18:27 -0400] joe_k: i want to issue commands to knife
[2013-10-23 19:18:33 -0400] joe_k: not manipulate the internals of the client run
[2013-10-23 19:18:50 -0400] mmzyk: right - chef-shell is really for exploration, you wouldn't use it to issue commands from the command line.
[2013-10-23 19:19:08 -0400] mmzyk: I thought it might be useful for debugging, but it's not going to solve your issue.
[2013-10-23 19:19:40 -0400] joe_k: and typically for opscode, the doc page falls just short of showing enough context
[2013-10-23 19:19:51 -0400] joe_k: how is the command launched? exactly what shows up and where do you type commands?
[2013-10-23 19:20:24 -0400] joe_k: it has examples with a shell prompt "$" but chef-shell gives me "chef >"
[2013-10-23 19:20:41 -0400] joe_k: you guys needs to capture entire sessions where you use the thing
[2013-10-23 19:20:44 -0400] joe_k: fully worked examples
[2013-10-23 19:21:04 -0400] joe_k: not "once you know everything, here's the minimal command name. you should know where to put it"
[2013-10-23 19:21:32 -0400] mmzyk: yes, we're fully aware. We hired a tech writer about a year ago and his first task was get the current docs up. The next step is get in much better examples.
[2013-10-23 19:21:36 -0400] joe_k: $ chef (preprod) > nodes.list
[2013-10-23 19:21:40 -0400] joe_k: what does this mean?
[2013-10-23 19:21:43 -0400] mmzyk: I pass on a lot of what we talk about here to him.
[2013-10-23 19:21:45 -0400] joe_k: issue this at the shell prompt?
[2013-10-23 19:21:52 -0400] joe_k: and redirect to a file?
[2013-10-23 19:22:26 -0400] mmzyk: right. It actually means just type nodes.list, b/c the first part is your prompt.
[2013-10-23 19:23:17 -0400] joe_k: $ means "type this at a shell prompt" 
[2013-10-23 19:23:19 -0400] joe_k: for many years now
[2013-10-23 19:24:03 -0400] mmzyk: yeah, it isn't formatted the best, I agree.
[2013-10-23 19:25:24 -0400] joe_k: i am at a loss for what to try next
[2013-10-23 19:25:30 -0400] membrainx: joe_k, trying to catch up on your issue
[2013-10-23 19:25:35 -0400] membrainx: which command is failing?
[2013-10-23 19:26:11 -0400] mmzyk: joe_k at this point you probably hate me for being the bearer of bad news, but we've tracked down the bug ticket related to this issue: https://tickets.opscode.com/browse/CHEF-2486
[2013-10-23 19:26:26 -0400] joe_k: membrainx: from powershell, http://pastebin.com/gbSnYPjxm
[2013-10-23 19:26:34 -0400] mmzyk: give it a read, it contains workarounds - I'm told the last one, with the comma might be your best bet.
[2013-10-23 19:26:49 -0400] joe_k: before -j "..." we tried  -r '"role[...]"', -r 'role[...']. etc
[2013-10-23 19:27:04 -0400] mmzyk: very janky, I know. It appears to be something specific to adding roles to a run list.
[2013-10-23 19:27:20 -0400] joe_k: this issue is 2 years old?
[2013-10-23 19:29:27 -0400] membrainx: it is old
[2013-10-23 19:29:33 -0400] membrainx: I'm still trying to understand it fully
[2013-10-23 19:30:01 -0400] membrainx: so outside of powershell, adding quotes always works?
[2013-10-23 19:30:09 -0400] joe_k: nothing has worked yet
[2013-10-23 19:30:17 -0400] membrainx: but inside powershell, some role names work, some don't?
[2013-10-23 19:30:25 -0400] joe_k: bash, powershell, single quotes, double inside single, 
[2013-10-23 19:30:31 -0400] membrainx: k
[2013-10-23 19:30:36 -0400] mmzyk: joe_k, membrainx helps with a lot of our windows work - he understands it all much more fully than I do.
[2013-10-23 19:30:53 -0400] membrainx: well, I haven't hit this particular issue yet
[2013-10-23 19:31:10 -0400] mmzyk: also, yes, the bug is old. we let a lot of bugs languish and have recently focused on trying to close out as many as possible, but we let the backlog get large, unfortunately.
[2013-10-23 19:31:16 -0400] membrainx: which is why I'd like to narrow it down and get you past this joe_k
[2013-10-23 19:32:24 -0400] membrainx: so joe_k, good old cmd.exe didn't work either, right?
[2013-10-23 19:32:53 -0400] membrainx: so a workaround could be knife node edit
[2013-10-23 19:33:22 -0400] mmzyk: membrainx He wants to be able to do it all programatically from a single command.
[2013-10-23 19:34:29 -0400] joe_k: keeping machines up over time and then playing with the chef server till they're right isnt the goal i'm looking for
[2013-10-23 19:34:41 -0400] joe_k: goal is having e.g. jenkins bring a new instance up for a test run
[2013-10-23 19:35:01 -0400] joe_k: if I could create a machine template and then reference it, that'd be good
[2013-10-23 19:35:27 -0400] joe_k: which i presume is what a role is supposed to be, but knife ec2 takes all this metadata that isn't otherwise written down
[2013-10-23 19:35:43 -0400] joe_k: (at least in the chef object model, i have to check in a .sh file to git)
[2013-10-23 19:36:26 -0400] joe_k: also knife ... edit doesnt work for me
[2013-10-23 19:36:33 -0400] joe_k: vim in path, editor set to vim. nada
[2013-10-23 19:37:31 -0400] joe_k: i may just be using chef wrong; it may be designed to keep a persistent set of servers that are always up, in sync
[2013-10-23 19:38:56 -0400] joe_k: membrainx: rather than poking around at my config, tell me how you specify a run list including a role on the knife command line
[2013-10-23 19:38:58 -0400] membrainx: I think your goals in using knife are in line with Chef joe_k
[2013-10-23 19:39:07 -0400] membrainx: you shouldn't be hitting the problems you're encountering
[2013-10-23 19:39:23 -0400] membrainx: for the role issue
[2013-10-23 19:39:29 -0400] joe_k: like try it and tell me if it works for you
[2013-10-23 19:39:48 -0400] membrainx: can you give me exact command line?
[2013-10-23 19:39:54 -0400] joe_k: do you guys execute a test suite on multiple platforms ?
[2013-10-23 19:39:56 -0400] membrainx: I am using roles and haven't hit a problem yet
[2013-10-23 19:40:04 -0400] joe_k: i have copied in the pastebin link twice now. 
[2013-10-23 19:40:08 -0400] membrainx: absolutely joe_k
[2013-10-23 19:40:16 -0400] membrainx: k, I just came in the chat and didn't see it, sorry
[2013-10-23 19:40:42 -0400] membrainx: hmm, it says it has been removed
[2013-10-23 19:40:52 -0400] joe_k: so how do you write them down when you use them?
[2013-10-23 19:41:00 -0400] joe_k: just type out how you'd do it
[2013-10-23 19:41:04 -0400] membrainx: I'll run an example and paste it
[2013-10-23 19:41:07 -0400] membrainx: hold on
[2013-10-23 19:41:38 -0400] joe_k: btw i am waiting for the most recent suggestion with the comma
[2013-10-23 19:41:42 -0400] joe_k: 25 minute cycle time :(
[2013-10-23 19:41:50 -0400] membrainx: assuming you're doing knife node run_list add ?
[2013-10-23 19:42:15 -0400] membrainx: or is it knife-bootstrap?
[2013-10-23 19:42:43 -0400] joe_k: http://pastebin.com/D8SChcB6
[2013-10-23 19:42:46 -0400] mmzyk: membrainx It's this: http://pastebin.com/EaGCbLv7
[2013-10-23 19:43:20 -0400] mmzyk: well, that was the past bin I still had open in my tabs. joe_k pasted the same thing it appears.
[2013-10-23 19:43:26 -0400] joe_k: i have tried that command line from bash, from powershell, with -r '"..."', -r '...', -r "...", with -j '(some json)'
[2013-10-23 19:46:07 -0400] joe_k: the bootstrap.ps1 file named on the command line just enables WinRM upon boot. then bootstrap hits the machine with winrm to do the rest
[2013-10-23 19:48:40 -0400] membrainx: so I'm running knife bootstrap to see if I can repro while I get ec2 set up
[2013-10-23 19:49:18 -0400] joe_k: i can give you everything but my AMI id if you want to try with my setup
[2013-10-23 19:49:54 -0400] joe_k: but might have to head out here in a second (carpooling back into town before traffic)
[2013-10-23 19:50:19 -0400] membrainx: so the ami in the paste bin is private then?
[2013-10-23 19:50:24 -0400] joe_k: no
[2013-10-23 19:50:29 -0400] joe_k: its the stock AWS windows 2012 ami
[2013-10-23 19:50:36 -0400] membrainx: cool, I will use that
[2013-10-23 19:50:46 -0400] joe_k: you might want the bootstrapwindows.ps1
[2013-10-23 19:51:05 -0400] membrainx: I have one of those, so should be set there
[2013-10-23 19:51:21 -0400] joe_k: http://pastebin.com/kW2udGGn just for completeness
[2013-10-23 19:51:58 -0400] joe_k: looks like the comma worked. but why??????????
[2013-10-23 19:53:19 -0400] mmzyk: ah, so it's a bit weird and gets into how chef is doing things, but under the hood there is a roles file
[2013-10-23 19:53:35 -0400] joe_k: and why does -r "recipe[whatever]" work and -r "role[visualstudio]" doesn't?????
[2013-10-23 19:53:44 -0400] mmzyk: and what is happening when you say role[foo] is that in our windows setup it sees that file and globs it.
[2013-10-23 19:53:50 -0400] mmzyk: the comma stops that.
[2013-10-23 19:53:54 -0400] joe_k: sounds like theres a lot of mix up between contexts and what strings mean and what syntax and laguage is where
[2013-10-23 19:54:09 -0400] joe_k: like people are just splicing strings together without meaning and whatnot
[2013-10-23 19:54:26 -0400] mmzyk: It has to do with the existence of that roles file (or it might be a directory, not sure, but I know one of those exists)
[2013-10-23 19:54:28 -0400] joe_k: why does it echo out then? windows isn't globbing it then
[2013-10-23 19:54:36 -0400] joe_k: i dont have a roles file
[2013-10-23 19:54:47 -0400] mmzyk: sorry, I only know the issue superficially and can't fully answer that.
[2013-10-23 19:54:56 -0400] mmzyk: not without doing a deep dive on the code.
[2013-10-23 19:56:13 -0400] joe_k: here's a suggestion: get the shell metacharacters out of your option syntax
[2013-10-23 19:56:18 -0400] joe_k: quit trying to "look like" ruby
[2013-10-23 19:56:36 -0400] membrainx:  so the question I'd like to solve is this one: why does -r "recipe[whatever]" work and -r "role[visualstudio]" doesn't?????
[2013-10-23 19:56:37 -0400] jkeiser: joe_k: a run_list is a series of recipes or roles, separated by commas
[2013-10-23 19:56:40 -0400] mmzyk: well, the reason it looks like ruby is b/c it is ruby joe_k.
[2013-10-23 19:57:07 -0400] mmzyk: chef at it's heart is a ruby DSL.
[2013-10-23 19:57:11 -0400] joe_k: pretty sure something[somethingelse] is not valid ruby. are those atoms? strings?
[2013-10-23 19:57:39 -0400] jkeiser: When you say run_list = recipe[blah],recipe[foo] you are saying "please run the recipes blah and foo".
[2013-10-23 19:57:44 -0400] joe_k: name refernces that get inserted into a runtime space?
[2013-10-23 19:58:06 -0400] jkeiser: Now, if you happen to have a comma at the end, like -r "recipe[blah]," it just ignores the thing after the trailing comma
[2013-10-23 19:58:32 -0400] joe_k: jkeiser: we're beyond that, but thanks
[2013-10-23 19:58:41 -0400] jkeiser: So when you say "knife node run_list add recipe[blah]," you are saying "add recipe[blah] and empty string (the stuff after the comma)"
[2013-10-23 19:58:51 -0400] jkeiser: joe_k: I heard you wanted to know why it worked, just trying to explain :)
[2013-10-23 19:59:23 -0400] joe_k: in what language is that evaluated? is it just split on ",", is it eval'ed?
[2013-10-23 19:59:35 -0400] joe_k: whats the grammar
[2013-10-23 19:59:59 -0400] jkeiser: joe_k: Some ruby code splits on comma and then parses each piece.
[2013-10-23 20:00:04 -0400] joe_k: because from your description, leaving the comma off shouldn't break anything
[2013-10-23 20:00:17 -0400] jkeiser:  joe_k: on to the reason knife node run_list add recipe[blah], works, while knife node run_list add recipe[blah] does not
[2013-10-23 20:00:21 -0400] jkeiser: This is correct
[2013-10-23 20:00:36 -0400] joe_k: i am not running "knife node run_list add"
[2013-10-23 20:01:06 -0400] jkeiser: What's the command?  Sorry, I'm in here late but I promise this will make sense.
[2013-10-23 20:01:16 -0400] membrainx: i will paste it jkeiser
[2013-10-23 20:01:24 -0400] joe_k: http://pastebin.com/D8SChcB6
[2013-10-23 20:01:26 -0400] membrainx: http://pastebin.com/EaGCbLv7
[2013-10-23 20:01:33 -0400] jkeiser: Either way, the problem is the shell you're typing the command in.  (It sucks that we don't work with the shell, but that's a different story.)
[2013-10-23 20:01:33 -0400] membrainx: ok, do his command
[2013-10-23 20:01:42 -0400] joe_k: no, thats not the problem at all
[2013-10-23 20:01:47 -0400] joe_k: i think you've misidentified it
[2013-10-23 20:02:12 -0400] joe_k: i've tried multiplle shells, and the issue isn't that the shell is fucking up the brackets when i issue my command line
[2013-10-23 20:02:46 -0400] joe_k: it MIGHT be because whatever is internal to chef is putting "role[whatever]" in a place where windows expands it to "roles" because it sees a file "
[2013-10-23 20:02:47 -0400] jkeiser: I'll have another thing for you to try that will prove or disprove that in a second.
[2013-10-23 20:02:48 -0400] joe_k: "roles"
[2013-10-23 20:02:55 -0400] jkeiser: bundle exec knife ec2 server create  -r 'role[visualstudio]'
[2013-10-23 20:03:31 -0400] joe_k: but then again, why the confusion between what a string means? is someone just banging strings together on the command line? or actually parsing and dealing with the input as defined syntax user input
[2013-10-23 20:03:37 -0400] jkeiser: The shell, or mingw, or SOMEONE, is expanding that to roles because it treats [] as a regex and there is a directory named roles in your currentdir, before we ever get to look at the command line argument.
[2013-10-23 20:04:15 -0400] jkeiser: The reason the extra comma works is, the shell is like "there is no directory named 'roles,' with a comma, so I can't expand this thingy.  I'll just pass it on verbatim"
[2013-10-23 20:04:35 -0400] joe_k: understood. but realize its internal to your run, not the shell i'm running
[2013-10-23 20:04:36 -0400] jkeiser: Another way to prove this out is to move the "roles" directory out of the way.  Call it something else, anything else.  And try the command again
[2013-10-23 20:04:49 -0400] joe_k: there is a "roles" directory in my chef-repo, as I assume there is in all 
[2013-10-23 20:05:03 -0400] joe_k: i understood this to be the standard format of chef-repos
[2013-10-23 20:05:07 -0400] jkeiser: It is.
[2013-10-23 20:05:16 -0400] jkeiser: Just do what I'm suggesting, and we'll know for sure whether this is the issue
[2013-10-23 20:05:24 -0400] jkeiser: I'm not suggesting at all that you move it permanently :)
[2013-10-23 20:05:52 -0400] joe_k: but you get my thrust: where are you putting that string that its even considered a filename????
[2013-10-23 20:05:59 -0400] joe_k: total confusion of type and intent of user input
[2013-10-23 20:06:05 -0400] jkeiser: We don't ever personally treat this as a filename.
[2013-10-23 20:06:06 -0400] jkeiser: Ever
[2013-10-23 20:06:47 -0400] jkeiser: There is software in front of us that does that.  Don't get me wrong, it is really shitty of us to choose a format that is prone to this error
[2013-10-23 20:07:07 -0400] joe_k: proof its not bash:
[2013-10-23 20:07:08 -0400] jkeiser: Right now I'd like to get you past your issue, and I think we should file a bug that this is a Bad Thing.
[2013-10-23 20:07:19 -0400] joe_k: JKOBERG1 ~/devops/chef-repo $ ls -d roles
[2013-10-23 20:07:21 -0400] joe_k: roles
[2013-10-23 20:07:23 -0400] joe_k: JKOBERG1 ~/devops/chef-repo $ echo "role[visualstudio]"
[2013-10-23 20:07:25 -0400] joe_k: role[visualstudio]
[2013-10-23 20:07:27 -0400] joe_k: proof its not powershell:
[2013-10-23 20:07:57 -0400] joe_k: PS C:\Users\JKoberg\devops\chef-repo> echo "role[visualstudio]"
[2013-10-23 20:07:59 -0400] joe_k: role[visualstudio]
[2013-10-23 20:08:04 -0400] joe_k: ^^^^ not globbed in either case
[2013-10-23 20:08:22 -0400] joe_k: i dont know _what_ you're doing inside to have it treated as a glob.
[2013-10-23 20:08:37 -0400] joe_k: im using the comma for now, i understand why you'd say it would work if I renamed "roles" 
[2013-10-23 20:08:47 -0400] joe_k: but i dont think it's the fault of the shell I am issuing the commmand to
[2013-10-23 20:09:00 -0400] mmzyk: completely tangential question: were you at devopsday atl joe_k?
[2013-10-23 20:09:10 -0400] joe_k: if I could specify the run list WITHOUT naming it on the command line we could test that
[2013-10-23 20:09:12 -0400] joe_k: i was
[2013-10-23 20:09:16 -0400] joe_k: i was bitching hard about windows oto
[2013-10-23 20:09:18 -0400] joe_k: otoo
[2013-10-23 20:09:25 -0400] jkeiser: joe_k: actually, you are correct.  in Windows, a lot of the glob expansion happens automatically as part of the executable
[2013-10-23 20:09:38 -0400] jkeiser: joe_k: like, you get passed ro*s verbatim
[2013-10-23 20:09:38 -0400] mmzyk: Yeah, I know. I was the opscode employee who sat in on that session. Hi. :)
[2013-10-23 20:09:48 -0400] joe_k: hi :) thanks for your attention and time
[2013-10-23 20:09:50 -0400] joe_k: i appreciate it
[2013-10-23 20:10:02 -0400] mmzyk: I just put two and two together.
[2013-10-23 20:10:02 -0400] jkeiser: joe_k: but there is still a library in front of us somewhere (ruby maybe?) that does that before we mess with it
[2013-10-23 20:10:29 -0400] joe_k: there is still the case where you're putting the string in a place where windows thinks its a filename.  To me that seems odd
[2013-10-23 20:10:47 -0400] jkeiser: joe_k: there is argument parsing going on somewhere in the stack before we look at them
[2013-10-23 20:10:52 -0400] jkeiser: joe_k: I just can't tell you where offhand :)
[2013-10-23 20:10:59 -0400] joe_k: (in my language of choice I'd type alias string to Pathname or Option and let the type system stop me from making intent errors)
[2013-10-23 20:11:39 -0400] jkeiser: joe_k: suffice it to say: your intuition is correct.  run lists do NOT have globs or files in them, nothing like it.  This is a bug or misfeature.
[2013-10-23 20:12:10 -0400] joe_k: ok im going to have to run but I have a working solution for now. mmzyk, thanks again for calling help, jkeiser and membrainx thanks much for jumping in
[2013-10-23 20:12:33 -0400] jkeiser: Either way, it is total crap and we need to find ways to let you specify run lists on the command line without dancing drunk on bearback
[2013-10-23 20:12:42 -0400] jkeiser: Sorry for the trouble.
[2013-10-23 20:12:56 -0400] joe_k: heh. rewrite in haskell. you'll find a lot of stuff :)
[2013-10-23 20:13:02 -0400] joe_k: its also WAY better for dsls
[2013-10-23 20:13:10 -0400] joe_k: look up quasiquoters
[2013-10-23 20:13:23 -0400] mmzyk: I don't actually think you'd get much argument from many Opscode people on that.
[2013-10-23 20:13:45 -0400] mmzyk: But we're in ruby for now. :)
[2013-10-23 20:13:53 -0400] joe_k: thanks guys I'll try to publish all the details for reference
[2013-10-23 20:14:06 -0400] mmzyk: I'm sure we'll chat again tomorrow and thanks for pushing us to get better.
[2013-10-23 20:14:22 -0400] joe_k: thanks for putting up with my intensity :) lots of coffee today
[2013-10-23 20:16:44 -0400] mmzyk: Since it might not be widely know, there are irc logs of this room available: http://community.opscode.com/chat/learnchef
[2013-10-23 20:32:57 -0400] CPS: i'm seeing an issue in chef server 11.4.0 that this ticket addresses: https://tickets.opscode.com/browse/CHEF-4040?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel
[2013-10-23 20:33:18 -0400] CPS: the fix version says 11.0.10, which I'm after. shouldn't this issue not be there?
[2013-10-23 20:42:23 -0400] mmzyk: CPS no, it shouldn't.
[2013-10-23 20:59:16 -0400] mmzyk: CPS just realized my know it shouldn't answer was wrong - yeah, it's there, as I said in #chef, b/c that fix is coming in the next release.
[2013-10-23 20:59:28 -0400] mmzyk: Chef server is currently release 11.0.8 and 11.0.10 is next.
[2013-10-23 21:00:00 -0400] CPS: how do i check which version i'm running? i just ran knife --version and i realize that's not the number i need
[2013-10-23 21:00:09 -0400] CPS: (ran it on the server)
[2013-10-23 21:01:41 -0400] nlloyds: CPS on ubuntu you can do `dpkg -l | grep chef-server`
[2013-10-23 21:01:56 -0400] CPS: centos
[2013-10-23 21:02:38 -0400] nlloyds: rpm -qa | grep chef-server maybe
[2013-10-23 21:02:44 -0400] CPS: yeah, found that, thanks
[2013-10-23 21:02:59 -0400] CPS: 11.0.8-1.e16.x86_64
[2013-10-23 21:03:14 -0400] CPS: mmzyk: why isn't the version number somewhere in the webui?
[2013-10-23 21:03:56 -0400] mmzyk: Likely b/c we haven't thought about it. 
[2013-10-23 21:04:14 -0400] mmzyk: Internally the webui is versioned separately from the backend server, even though we ship them together.
[2013-10-23 21:04:41 -0400] mmzyk: You should also be able to check opt/chef-server/version-manifest.txt for the server version, assuming I got that path right.
[2013-10-23 21:05:16 -0400] nlloyds: CPS the actual files are in /opt/chef-server/embedded/service/chef-server-webui/, so you could apply the changes from https://github.com/opscode/chef-server-webui/pull/13/files manually and restart.
[2013-10-23 21:06:23 -0400] gclark85: anyone around able to help a noob?
[2013-10-23 21:06:52 -0400] CPS: thanks nlloyds. seems like it'd be handy to have a link in the webui that just presents the version manifest
[2013-10-23 21:07:42 -0400] mmzyk: gclark85 That's the point of this channel. Throw the question out there and we'll try to answer it.
[2013-10-23 21:09:04 -0400] gclark85: I'm trying to converge my first node using the Quickstart guide.  When I am running the knife bootstrap localhost command I receive some errors starting with "Error resolving cookbooks for run list" then ending with a childconvergeerror
[2013-10-23 21:10:57 -0400] gclark85: I should note that I am running the environment from a windows 7 64bit machine, I found this ticket which might indicate some sort of configuration issue? https://tickets.opscode.com/browse/CHEF-4519?focusedCommentId=39169&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel
[2013-10-23 21:11:56 -0400] mmzyk: gclarke85 Can you pastebin or gist the command you're running?
[2013-10-23 21:12:59 -0400] gclark85: I'm not sure what that is, you want me to just copy and paste the command here?
[2013-10-23 21:13:16 -0400] CPS: gist is github's version of pastebin
[2013-10-23 21:13:27 -0400] CPS: paste and share logs of your crap breaking
[2013-10-23 21:13:55 -0400] CPS: gist.github.com
[2013-10-23 21:14:21 -0400] mmzyk: thanks CPS. :) yeah, gclark85, I'm just asking you to paste the command, but irc has a tendency to mange commands to just to put the command in one of the paste services that keeps the formatting nice.
[2013-10-23 21:14:36 -0400] mmzyk: then you just put the link to it here so everyone can see it.
[2013-10-23 21:15:17 -0400] CPS: mmzyk: eta on the next release?
[2013-10-23 21:16:26 -0400] gclark85: https://gist.github.com/anonymous/7126900
[2013-10-23 21:16:45 -0400] mmzyk: CPS I'm not sure of that.
[2013-10-23 21:17:05 -0400] mmzyk: Before the end of the year, I think, but don't hold me too that.
[2013-10-23 21:17:29 -0400] CPS: ughh
[2013-10-23 21:18:26 -0400] CPS: alright thanks
[2013-10-23 21:18:36 -0400] gclark85: basically I am following this verbatim https://learnchef.opscode.com/quickstart/converge/
[2013-10-23 21:18:47 -0400] mmzyk: yup, just saw that gclark85.
[2013-10-23 21:19:01 -0400] CPS: gclark85: gist the output
[2013-10-23 21:19:15 -0400] mmzyk: CPS is this wanting that issue fixed? Did you see nlloyds point you how to apply the fix right now?
[2013-10-23 21:20:29 -0400] gclark85: https://gist.github.com/anonymous/7126971
[2013-10-23 21:20:31 -0400] mmzyk: gclark85 I can actually tell you the bug you pasted is not what you're seeing. 
[2013-10-23 21:21:03 -0400] CPS: mmzyk: yeah, i might need to do that. i'll need clarification on my timeline for this
[2013-10-23 21:22:01 -0400] CPS: but that's a question for tomorrow
[2013-10-23 21:22:03 -0400] CPS: thanks guys
[2013-10-23 21:22:39 -0400] mmzyk: gclark85 Based on that output, it feels like you missed a step.
[2013-10-23 21:23:05 -0400] gclark85: ok, I can go do it over again or do you know of a place I can go back to
[2013-10-23 21:23:46 -0400] mmzyk: gclark85 back one page in the guide https://learnchef.opscode.com/quickstart/chef-repo/
[2013-10-23 21:24:09 -0400] mmzyk: Did you do the knife cookbook site install apt, etc?
[2013-10-23 21:24:16 -0400] mmzyk: step 2 under setup your chef-repo?
[2013-10-23 21:24:34 -0400] mmzyk: If yes, then did you do the last line on that page, knife cookbook upload --all ?
[2013-10-23 21:24:48 -0400] mmzyk: What is happening is the chef-client isn't finding any of those cookbooks on the server.
[2013-10-23 21:24:57 -0400] mmzyk: So they never got uploaded for some reason.
[2013-10-23 21:26:06 -0400] mmzyk: gclark85 ^ just pinging to make sure you see my more specific directions than just go back one page. :)
[2013-10-23 21:26:57 -0400] gclark85: I must have missed the last line but I am starting from square one on that page, redoing the cookbooks....good practice anyhow :)
[2013-10-23 21:27:24 -0400] gclark85: getting a new error on the cookbook site install though
[2013-10-23 21:27:59 -0400] mmzyk: all right, sounds good. If you hit any more issues, just ask here. It's nearing the end of day for those of us on the US East Coast, but we try to be around when we can to help out. If no one answers here, you can also try the #chef room.
[2013-10-23 21:28:12 -0400] mmzyk: what's the error?
[2013-10-23 21:28:14 -0400] gclark85: great, thanks mm
[2013-10-23 21:29:23 -0400] mmzyk: gclark85 I'm not out the door yet, what error are you seeing?
[2013-10-23 21:30:51 -0400] gclark85: I think it's cause I went directly to the folder for the cookbooks and deleted the tar balls
[2013-10-23 21:31:54 -0400] gclark85: https://gist.github.com/anonymous/7127130
[2013-10-23 21:32:22 -0400] mmzyk: could be. Once you've done a knife cookbook site install you don't have to install it again. I believe then you can do a knife cookbook site download to pull down the latest.
[2013-10-23 21:33:07 -0400] mmzyk: What you might want to do is delete that cookbook entirely
[2013-10-23 21:33:29 -0400] mmzyk: so delete everything under the cookbooks dir.
[2013-10-23 21:35:29 -0400] gclark85: it's weird, I delete the whole chef-repo directory and copy it from the starter kit, redownload the cookbook, same error
[2013-10-23 21:35:35 -0400] gclark85: but the tar.gz file is there
[2013-10-23 21:35:41 -0400] gclark85: where it's supposed to be
[2013-10-23 21:37:17 -0400] mmzyk: huh.
[2013-10-23 21:37:29 -0400] gclark85: maybe it's not zxvf'ing the file
[2013-10-23 21:37:30 -0400] mmzyk: permissions off?
[2013-10-23 21:37:37 -0400] gclark85: idk I'm an admin
[2013-10-23 21:38:21 -0400] mmzyk: if you try to untar the file by hand does it work?
[2013-10-23 21:40:12 -0400] gclark85: it's supposed to be extracted right in the cookbook folder, correct?
[2013-10-23 21:40:19 -0400] mmzyk: yup.
[2013-10-23 21:40:48 -0400] mmzyk: The command knife cookbook site install is just downloading the tar ball and extracting it into the cookbooks folder.
[2013-10-23 21:41:37 -0400] mmzyk: You can always go to community.opscode.com and download the files yourself and extract them there - same process, just automated. Not sure why you're seeing this error. It's failing the extract command on your system for some reason.
[2013-10-23 21:42:12 -0400] gclark85: got it, could it be that the extract commands dont work in the powershell prompt?  Either way I just run winrar and they seem to extract without an issue
[2013-10-23 21:42:25 -0400] gclark85: I'm not sure how to run tar in powershell, it just gives me the same errors
[2013-10-23 21:42:46 -0400] gclark85: I'll continue, see if it works better
[2013-10-23 21:46:42 -0400] mmzyk: gclark85 this all should work on windows, although maybe there is something with win 7, 64 bit, I don't know.
[2013-10-23 21:46:52 -0400] mmzyk: at least you appear to have gotten past that.
[2013-10-23 21:47:09 -0400] gclark85: I bet these never extracted before and I just didn't notice
[2013-10-23 21:47:11 -0400] mmzyk: I did work the first time though, correct?
[2013-10-23 21:47:18 -0400] gclark85: which lead to the issue I started with
[2013-10-23 21:47:21 -0400] mmzyk: oh, okay. :)
[2013-10-23 21:47:26 -0400] gclark85: thanks for your help!
[2013-10-23 21:47:43 -0400] mmzyk: yeah, sorry for the issue. I'm not sure if it's a bug or not.
[2013-10-23 21:54:58 -0400] gclark85: lol another error
[2013-10-23 21:56:22 -0400] mmzyk: dish it up. I'm about to get off, but I'll take a look before I do.
[2013-10-23 21:57:17 -0400] gclark85: when I do upload cookbook --all
[2013-10-23 21:57:18 -0400] gclark85: Uploading aliases      [0.1.0] ERROR: Cookbook aliases depends on cookbook 'magic_shell' version '>= 0.0.0', ERROR: which is not currently being uploaded and cannot be found on the server.
[2013-10-23 21:57:38 -0400] gclark85: manually extracted magic_shell and it looks ok
[2013-10-23 21:57:58 -0400] mmzyk: Yeah, that's failing b/c magic_shell isn't uploaded to the server.
[2013-10-23 21:58:21 -0400] mmzyk: Do a knife cookbook upload magic_shell
[2013-10-23 21:58:33 -0400] mmzyk: and then try uploading the aliases cookbook again.
[2013-10-23 21:59:04 -0400] gclark85: could not find path, skipping
[2013-10-23 21:59:28 -0400] mmzyk: well. that explains why it wasn't uploaded.
[2013-10-23 21:59:39 -0400] mmzyk: cookbook/magic_shell exists?
[2013-10-23 21:59:40 -0400] gclark85: lol
[2013-10-23 21:59:52 -0400] gclark85: ya
[2013-10-23 22:00:39 -0400] gclark85: probably has to do with the extracting
[2013-10-23 22:00:48 -0400] gclark85: cause when I try to do any of them it says it can't find the path
[2013-10-23 22:00:50 -0400] gclark85: apach2, apt
[2013-10-23 22:01:03 -0400] gclark85: I'll work on it
[2013-10-23 22:01:05 -0400] mmzyk: actually, that should be cookbooks, not cookbook in the path.
[2013-10-23 22:01:10 -0400] mmzyk: I mistyped.
[2013-10-23 22:01:27 -0400] mmzyk: Do you have cookbooks?
[2013-10-23 22:01:31 -0400] gclark85: ya, I tabbed it out
[2013-10-23 22:01:51 -0400] mmzyk: This is getting somewhat into the details, but the config it uses is in a .chef folder that should be in your chef-repo.
[2013-10-23 22:01:59 -0400] gclark85: ya its all there, all the files look good, the aliases folder gets created like it should, etc
[2013-10-23 22:02:06 -0400] mmzyk: er, well, you're on windows, maybe that isn't true on the config location.
[2013-10-23 22:02:27 -0400] mmzyk: okay, sounds like the config is okay.
[2013-10-23 22:02:36 -0400] mmzyk: And the cookbooks/magic_shell folder has stuff in it?
[2013-10-23 22:03:14 -0400] gclark85: yep good stuff, checked the default.rb which has a line it, not corrupt or anything
[2013-10-23 22:03:42 -0400] mmzyk: and what is the exact error you get doing a knife cookbook upload magic_shell ?
[2013-10-23 22:04:18 -0400] gclark85: ERROR: Could not find cookbook magic_shell in your cookbook path, skipping it ERROR: Failed to upload 1 cookbook.
[2013-10-23 22:04:54 -0400] gclark85: and I tried tabbing it out so like .\cookbooks\apache2 and I get the same message
[2013-10-23 22:04:56 -0400] mmzyk: But it found the alias cookbook just fine?
[2013-10-23 22:05:17 -0400] mmzyk: What does your cookbooks directory listing look like? Can you gist that?
[2013-10-23 22:05:46 -0400] gclark85: It's almost definitely something to do with the extraction failure from earlier
[2013-10-23 22:05:59 -0400] gclark85: because if I remove the aliases .rb dependancy of magic_shell, it uploads fine
[2013-10-23 22:06:05 -0400] gclark85: I should say, aliases uploads fine
[2013-10-23 22:06:29 -0400] mmzyk: right.
[2013-10-23 22:06:39 -0400] mmzyk: well, you can try doing it manually and see if that works
[2013-10-23 22:06:48 -0400] mmzyk: delete the magic shell dir.
[2013-10-23 22:06:57 -0400] gclark85: I'm going to go back and work on the extraction
[2013-10-23 22:07:02 -0400] mmzyk: redownload the cookbook from here: http://community.opscode.com/cookbooks/magic_shell
[2013-10-23 22:07:05 -0400] gclark85: see if I can get it working with the powershell
[2013-10-23 22:07:07 -0400] gclark85: ok
[2013-10-23 22:07:07 -0400] mmzyk: and extract it into place.
[2013-10-23 22:07:23 -0400] gclark85: alright that's all I have time for now, thanks for your help
[2013-10-23 22:09:27 -0400] joe_k: not super familiar with ruby. is there a way to know where bundler put my chef lib
[2013-10-23 22:09:40 -0400] joe_k: im going to try to trace down where this option is getting globbed
[2013-10-23 22:11:20 -0400] mmzyk: yeah, bundler is just a ruby tool, so what it is doing is tool specific, not ruby specific.
[2013-10-23 22:11:32 -0400] joe_k: yeah i just dont know where it stashes the gems
[2013-10-23 22:11:37 -0400] mmzyk: although this gets into fun complicated territory. I'm sure you're happy to hear that. :)
[2013-10-23 22:11:38 -0400] joe_k: i need to edit ruby source there
[2013-10-23 22:12:46 -0400] joe_k: like i just want to print out the equivalent of python's sys.path or module.__file__ to see where the code is coming from
[2013-10-23 22:13:26 -0400] joe_k: sounds like c:\ruby*\...
[2013-10-23 22:13:57 -0400] joe_k: C:\Ruby193\lib\ruby\gems\1.9.1
[2013-10-23 22:14:20 -0400] mmzyk: I don't know off the top of my head, but what happens is gems getting installed to a folder under your ruby, but then bundler does some magic on top of that, so that location won't be exactly right.
[2013-10-23 22:14:41 -0400] joe_k: in initial research it seems its deeper than knife-ec2 or even knife-bootstrap; those just pass the option on
[2013-10-23 22:15:24 -0400] mmzyk: yeah, internally I heard that it's handled by something in the system before knife gets it. (might be one of our dependencies)
[2013-10-23 22:15:49 -0400] mmzyk: I need to log off, but let me see if I can give you some resources.
[2013-10-23 22:16:31 -0400] joe_k: np, you can take off, I have what I need for now
[2013-10-23 22:16:31 -0400] mmzyk: The chef client and knife source code lives here: https://github.com/opscode/chef
[2013-10-23 22:16:38 -0400] joe_k: already been through it :)
[2013-10-23 22:16:50 -0400] mmzyk: gotcha. 
[2013-10-23 22:17:34 -0400] mmzyk: So we create our packages with our omnibus projects
[2013-10-23 22:17:44 -0400] mmzyk: Here is the one for the client/knife: https://github.com/opscode/omnibus-chef
[2013-10-23 22:18:08 -0400] mmzyk: If you're willing to go through that you can see how it builds for windows, joe_k. Might show you more than what the chef code is giving you.
[2013-10-23 22:18:31 -0400] mmzyk: er wait, maybe we don't use that for windows.
[2013-10-23 22:18:52 -0400] mmzyk: blah, I'll look into it and try to get back to you on it tomorrow joe_k.
[2013-10-23 22:19:45 -0400] joe_k: cool :) thanks
[2013-10-23 22:19:59 -0400] joe_k: have a great evening. where are you guys located again?
[2013-10-23 22:20:17 -0400] mmzyk: All over. I live in Raleigh, but hq is in Seattle.
[2013-10-23 22:20:34 -0400] joe_k: roger. later
[2013-10-23 22:20:36 -0400] mmzyk: by the way, google __FILE__ in Ruby, that might help you out.
