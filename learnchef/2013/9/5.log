[2013-09-05 09:08:44 -0400] neku: hi guys, I'm testing chef and I don't uderstand when a node will converge
[2013-09-05 09:08:52 -0400] neku: I bootstrapped it with knife
[2013-09-05 09:09:03 -0400] neku: and the modified is run_list on the chef server
[2013-09-05 09:09:26 -0400] neku: but I don't actually see the chef_client running on the node
[2013-09-05 09:37:20 -0400] fishGoM00: Teh chef-client cookbook has to be in the run list
[2013-09-05 09:37:49 -0400] fishGoM00: you can bootstrap nodes and include this automatically
[2013-09-05 09:38:08 -0400] fishGoM00: after that is will run every 30 minutes by default (with some splay)
[2013-09-05 09:38:42 -0400] fishGoM00: check if it is running with ps perhaps?
[2013-09-05 09:42:27 -0400] arussel``: fishGoM00: is there any reason chef-client is not in by default in opscode ami and vagrant box ?
[2013-09-05 09:44:17 -0400] arussel``: here: https://learnchef.opscode.com/starter-use-cases/multi-node-ec2/ , I don't see teh chef-client cookbook being included, but it tells to run 'sudo chef-client'
[2013-09-05 11:44:25 -0400] fishGoM00: arussel``: you can add the chef-client when bootstrapping the node
[2013-09-05 11:44:31 -0400] fishGoM00: knife bootstrap IP_ADDRESS -r 'recipe[chef-client]' -x username -P PASSWORD --sudo
[2013-09-05 12:19:57 -0400] arussel``: fishGoM00: thanks. So if I fail to install the chef-client, the node I've created can't be updated ?
[2013-09-05 12:22:35 -0400] fishGoM00: it can be updated by running chef-client manually on the node
[2013-09-05 12:24:19 -0400] fishGoM00: or you can add the chef-client to the run list of the node so it runs automatically in the future (although you will need to manually run chef-client once after the run list has been updated... to take advantage of the change)
[2013-09-05 12:33:41 -0400] neku: fishGoM00
[2013-09-05 12:33:43 -0400] neku: thanks
[2013-09-05 12:34:55 -0400] fishGoM00: no worries :)
[2013-09-05 15:10:20 -0400] PleasureTown: Hey Guys, I am a newish user of Puppet and am interested in Chef. Are there any books I can look to?
[2013-09-05 15:23:18 -0400] clakeb: @PleasureTown I would just read the docs and download the free training materials
[2013-09-05 15:23:51 -0400] PleasureTown: clakeb: Yeah, they mostly confused me. I'll try to give it another go then
[2013-09-05 15:23:58 -0400] clakeb: That is just me though. I learn by doing. Also, I would Google Berkshelf and see how that is now integrating with Chef.
[2013-09-05 15:29:20 -0400] mattray: There are a couple of books, not sure how good each is
[2013-09-05 15:37:32 -0400] clakeb: mattray: does the advance install method for os x on learnchef.opscode.com require sudo anywhere?
[2013-09-05 15:38:03 -0400] mattray: clakeb: I would assume yes
[2013-09-05 15:38:29 -0400] mattray: wait advance? like gems? then no
[2013-09-05 15:38:30 -0400] clakeb: It just doesn't explicitly state it and I was wondering.
[2013-09-05 15:38:41 -0400] clakeb: ahh
[2013-09-05 15:38:42 -0400] clakeb: ok
[2013-09-05 15:38:45 -0400] clakeb: Why is that/
[2013-09-05 15:38:53 -0400] clakeb: ?
[2013-09-05 15:41:00 -0400] mattray: so the standard installer is a shell script wrapping omnibus
[2013-09-05 15:41:08 -0400] clakeb: right
[2013-09-05 15:41:16 -0400] mattray: and omnibus just installs to /opt/chef
[2013-09-05 15:41:22 -0400] mattray: and adds symlinks in /usr/bin/
[2013-09-05 15:41:24 -0400] clakeb: right
[2013-09-05 15:41:31 -0400] clakeb: I'm following
[2013-09-05 15:41:36 -0400] mattray: so that would require sudo
[2013-09-05 15:42:21 -0400] clakeb: Oh ok. I thought chef required root for some processes?
[2013-09-05 15:42:23 -0400] mattray: I just ran it
[2013-09-05 15:42:23 -0400] mattray: rm: /opt/chef/bin: Permission denied
[2013-09-05 15:42:23 -0400] mattray: rm: /opt/chef/embedded: Permission denied
[2013-09-05 15:42:24 -0400] mattray: makeselfinst: Cannot remove contents of /opt/chef
[2013-09-05 15:42:46 -0400] mattray: clakeb: definitely. Lots of stuff you would need root/sudo to manage
[2013-09-05 15:42:56 -0400] mattray: you can use Chef on unprivileged things of course
[2013-09-05 15:43:11 -0400] mattray: but most people just use sudo or root because they're managing everything
[2013-09-05 15:43:37 -0400] mattray: and most of the resources support running as a particular user or setting permissions accordingly
[2013-09-05 15:43:45 -0400] mattray: like "execute"
[2013-09-05 15:44:15 -0400] clakeb: Does vagrant need root? I could look it up but just wondering if you knew off the top.
[2013-09-05 15:44:18 -0400] mattray: but if you're a savvy Ruby user, you understand managing ruby gems as non-root (ie. rvm or rbenv)
[2013-09-05 15:44:55 -0400] mattray: same thing really, vagrant probably needs root to be installed, but doesn't need it to run
[2013-09-05 15:44:55 -0400] clakeb: And that is the whole thing. OS X ruby environment is just screwy
[2013-09-05 15:45:12 -0400] clakeb: or outdated really
[2013-09-05 15:45:16 -0400] mattray: clakeb: totally, which is why we push people to use the full-stack omnibus Chef installers
[2013-09-05 15:45:27 -0400] mattray: they come with ruby in /opt/chef/embedded
[2013-09-05 15:45:32 -0400] mattray: 1.9.3 lates
[2013-09-05 15:45:33 -0400] mattray: t
[2013-09-05 15:45:48 -0400] clakeb: I've been using it for a while now and haven't really had a problem.
[2013-09-05 15:45:51 -0400] mattray: so Chef is "safe" from the underlying OS version of Ruby
[2013-09-05 15:46:54 -0400] clakeb: And as I've done more and more Ruby development I've looked into the gem install under rbenv
[2013-09-05 15:47:52 -0400] mattray: clakeb: in that case, you can probably handle using Chef from rubygems
[2013-09-05 15:48:17 -0400] mattray: we steer people away from that because Ruby
[2013-09-05 15:48:56 -0400] clakeb: anything I would need to be careful about?
[2013-09-05 15:52:05 -0400] clakeb: And thank you for your help.
[2013-09-05 16:12:10 -0400] mattray: clakeb: nothing jumps to mind, you're probably used to fighting with gem versions and whatnot
[2013-09-05 16:12:52 -0400] clakeb: mattray: I'm getting there for sure.
[2013-09-05 18:18:10 -0400] mindlace: i still need the old virtualbox
[2013-09-05 18:18:11 -0400] mindlace: ?
[2013-09-05 18:42:55 -0400] redfive_: I'm working through a tutorial from opscode that sets up mysql on a Ubuntu 12.04 vagrant box and I'm getting a failure in the minitest that does | service('mysqld').must_be_enabled |  It appears that mysqld is running, although the init.d entry is for mysql
[2013-09-05 18:43:12 -0400] redfive_: I was wondering if anyone has run into this.
[2013-09-05 18:43:41 -0400] redfive_: I figure I'm just missing some setting, but perhaps there is a known issue.
[2013-09-05 18:44:14 -0400] binamov: redfive_ can you show me which tutorial?
[2013-09-05 18:44:20 -0400] redfive_: It's odd because the must_be_running check succeeds.
[2013-09-05 18:44:39 -0400] redfive_: binamov: it's a slide deck from a session a coworked attended.
[2013-09-05 18:44:51 -0400] redfive_: So, I don't have a public url, sorry.
[2013-09-05 18:44:59 -0400] binamov: redfive_ what's the deck title?
[2013-09-05 18:45:35 -0400] redfive_: Test-Driven Development for Chef Cookbooks with Berkshelf and Vagrant (OSX Edition
[2013-09-05 18:45:58 -0400] binamov: ok and what slide are you on?
[2013-09-05 18:49:13 -0400] redfive_: binamov: one sec... gettin gthe number....
[2013-09-05 18:49:42 -0400] redfive_: 185
[2013-09-05 18:50:14 -0400] binamov: is that where you do rspec myspace?
[2013-09-05 18:50:21 -0400] binamov: myface
[2013-09-05 18:51:29 -0400] redfive_: That's just a | vagrant destroy && vagrant up |, but it's the minitest defined in slide 174 that is failing. THis is for the myface app though, yes.
[2013-09-05 18:53:33 -0400] binamov: redfive_ i haven't played with this deck a lot, but have you tried replacing mysqld with just mysql in the default_test.rb ?
[2013-09-05 18:53:55 -0400] binamov: so service("mysqld").must_be_running will say service("mysql").must_be_running
[2013-09-05 18:53:57 -0400] redfive_: binamov: Yeah, no change. And the service('mysqld').must_be_running succeeds.
[2013-09-05 18:54:10 -0400] redfive_: it's just the must_be_enabled that fails.
[2013-09-05 18:54:35 -0400] redfive_: When I see a line like this in a cookbook: if node['mysql']['use_upstart']
[2013-09-05 18:55:16 -0400] redfive_: Should that be defined in my Vagrantfile?
[2013-09-05 18:55:41 -0400] binamov: don't think so
[2013-09-05 18:55:56 -0400] binamov: gimme a sec
[2013-09-05 18:55:57 -0400] redfive_: I have a chef.json = { :mysql => { :server_root_password => 'pass' ... }}
[2013-09-05 18:56:13 -0400] redfive_: And those appear to get pulled in in a similar way.
[2013-09-05 18:57:46 -0400] binamov: redfive_ if that test fails means mysqld is not enabled as a service on startup, that's different from mysqld running
[2013-09-05 18:59:07 -0400] redfive_: binamov: that's what I assumed, good to get confirmation. I'm just wondering how to make sure it gets enabled, when the cookbook looks like it should do that.
[2013-09-05 19:00:00 -0400] binamov: redfive_ the service resource in the mysql recipe should have an action :enable in and of itself, or get notified by another resource to get enabled
[2013-09-05 19:01:03 -0400] binamov: im trying to find that myface cookbook
[2013-09-05 19:01:10 -0400] redfive_: Yeah, mysql::server has:  service "mysql" do <snip> action :enable end
[2013-09-05 19:01:43 -0400] binamov: what platform is your test node?
[2013-09-05 19:01:46 -0400] redfive_: Is there a way to add dump/debug output that will show up on reload so I can see if it's hitting this code?
[2013-09-05 19:01:54 -0400] redfive_: The node is Ubuntu 12.04 64 bit
[2013-09-05 19:02:19 -0400] binamov: the service resource is idempotent, which means that if it already enabled the service, it won't be repeating that action
[2013-09-05 19:04:25 -0400] binamov: does chkconfig show mysqld as enabled?
[2013-09-05 19:06:29 -0400] redfive_: Nope, says off.
[2013-09-05 19:06:43 -0400] binamov: so it's not enabled then, the test works :)
[2013-09-05 19:07:29 -0400] redfive_: Yes, good to know it's working.
[2013-09-05 19:09:16 -0400] binamov: so do you get the screen from slide 176?
[2013-09-05 19:09:49 -0400] redfive_: the updated metadata.rb? yup.
[2013-09-05 19:10:39 -0400] binamov: and you added include_recipe "mysql::server" to default myface recipe?
[2013-09-05 19:10:51 -0400] redfive_: Yup.
[2013-09-05 19:11:57 -0400] redfive_: And mysql is running after an 'up'. not sure how to simulate a shutdown/restart that doesn't run the chef provisioning. Oh, I recall a --no-provision flag or something.
[2013-09-05 19:13:33 -0400] binamov: give it a shot doesn't sound like the mysqld service gets enabled though. it's supposed to be not enabled from slide 176 and the next few slides fix that. go through them again?
[2013-09-05 19:16:19 -0400] redfive_: I'm expecting it to hit this line: https://github.com/opscode-cookbooks/mysql/blob/master/recipes/server.rb#L160
[2013-09-05 19:16:24 -0400] redfive_: but it doesn't appear to
[2013-09-05 19:19:39 -0400] binamov: weird have you tried converging more than once?
[2013-09-05 19:24:18 -0400] redfive_: converging being a destroy/up cycle?
[2013-09-05 19:25:45 -0400] binamov: if you destroy then up it's only one converge
[2013-09-05 19:26:03 -0400] binamov: so like vagrant up for first converge, and then vagrant provision for 2nd...
[2013-09-05 19:26:16 -0400] binamov: very curious why it doesn't take that enable actiomn
[2013-09-05 19:26:29 -0400] binamov: you didn't modify that recipe, right?
[2013-09-05 19:26:45 -0400] redfive_: Yeah, I've run provision after the initial up and it doesn't enable that service.
[2013-09-05 19:27:51 -0400] binamov: when you provision/up you see the chef-client run output on the screen, right?
[2013-09-05 19:28:28 -0400] redfive_: correct.
[2013-09-05 19:29:12 -0400] binamov: try destroy and up again and watch/save/review/grep that screendump for the service resource?
[2013-09-05 19:29:54 -0400] binamov: something is wrong there's only one action :enable in that recipe and the conditional says pretty much run on anything other than osx
[2013-09-05 19:31:28 -0400] redfive_: Yeah, makes me wonder if the execution of that files exits earlier for some reason, but I have output for the statements above and below that particular set of conditionals
[2013-09-05 19:32:01 -0400] binamov: i'm going to be back and forth at my desk here; mention my name and i'll review when i'm back, otherwise switch to #chef; there's more action there
[2013-09-05 19:33:02 -0400] redfive_: Sure, thanks for all your help. I'm going to get some lunch so will be afk for 30 or so.
[2013-09-05 19:33:09 -0400] binamov: cool
[2013-09-05 20:21:04 -0400] ryanbubinski: started having trouble with an "Invalid signature for user or client" error when running knife. i've since regenerated the validator.pem, knife.rb, and my individual account .pem, but i'm still getting this error. anyone think they here help me out?
[2013-09-05 20:29:59 -0400] redfive_: ryanbubinski: Are you using chef server or solo?
[2013-09-05 20:32:33 -0400] redfive_: I had something like that when I was using server and I had to fix the name of the validator.pem  key somewhere...
[2013-09-05 20:33:10 -0400] redfive_: But that was a 401 error, so different.
[2013-09-05 20:34:58 -0400] ryanbubinski: chef server, hosted on opscode
[2013-09-05 20:35:17 -0400] ryanbubinski: i've also filed a support ticket with them
[2013-09-05 20:42:40 -0400] ryanbubinski: their support team has picked up the ticket, will continue the conversation with them. thanks redfive_
[2013-09-05 21:47:10 -0400] redfive_: Aha, it appears that for some reason I need to *not* use_upstart to do the enabling of the service. I set use_upstart to false in my Vagrant file and I now get mysql enabled for restart.
[2013-09-05 21:47:36 -0400] redfive_: The test is still failing though, so I need to figure out if the mysql/mysqld difference is causing that.
[2013-09-05 21:50:35 -0400] redfive_: Bingo, that looks like the issue.
[2013-09-05 21:58:57 -0400] binamov: redfive_it's an issue with the mysql cookbook?
[2013-09-05 21:59:10 -0400] binamov: did you have to rename the service resource to mysql ?
[2013-09-05 22:48:39 -0400] redfive_: binamov: it looks like 2 things to me so far: 1) for my setup, for some reason, upstart is not working to correctly enable the service to start on boot, which it should -- could be an issue in chef::provider::service::upstart and 2) the tests should be written to use the attributes instead of hardcoding 'mysql' 
[2013-09-05 22:49:23 -0400] redfive_: Because once I fixed #1 (by setting use_upstart to false) I had to change the hardcoded 'mysql' to service(node['mysql']['service_name']).must_be_enabled
[2013-09-05 22:52:14 -0400] redfive_: I'm using chef-solo 11.6 on my workstation and installing chef-client 11.2.0 on the node
[2013-09-05 23:59:07 -0400] diogotozzi: hey guys, how can I delete an organization at Opscode Management page?
