[2014-05-19 13:27:33 -0400] urbanmonk: can you make a chef-server a node as well .. so the chef-server can be managed by chef
[2014-05-19 13:51:11 -0400] CPS: urbanmonk: probably?
[2014-05-19 13:51:27 -0400] CPS: try it, see what happens
[2014-05-19 13:56:45 -0400] ErebusBat: urbanmonk: if this is for a production system you need to be careful if you only have one chef server.  otherwise you will get into the chicken and egg problem.  
[2014-05-19 13:58:08 -0400] ErebusBat: there is a way to install chef-server using chef-solo. I would use that to get a solid foundation and yes your backup/restore.  also keep in mind that when you do this that it will probably be an oh-sh*t moment so the more complex the worse you will be
[2014-05-19 13:59:27 -0400] urbanmonk: ErebusBat: so i guess it is not a best practice for a chef server to be managed by chef?
[2014-05-19 14:00:00 -0400] ErebusBat: I wouldn't say that per say.  
[2014-05-19 14:00:41 -0400] ErebusBat: I was just saying that whatever process you use make sure you know how to recover from it
[2014-05-19 14:01:27 -0400] ErebusBat: Otherwise you will but up sh*t creek if your chef server is down AND your nodes are having issues and you have no way to easily recover.  
[2014-05-19 14:01:40 -0400] ErebusBat: How many nodes do you have urbanmonk ?
[2014-05-19 14:02:56 -0400] urbanmonk: ErebusBat: not that many .. i'm just starting out learning chef.. at the moment i'm planning 3 right now
[2014-05-19 14:03:11 -0400] ErebusBat: Have you looked at hosted Chef?
[2014-05-19 14:04:05 -0400] urbanmonk: ErebusBat:  I have but I'm using open source chef server ...
[2014-05-19 14:04:06 -0400] ErebusBat: A benefit to that is that you get all of the enterprise features.  It is free for <=5 nodes: http://www.getchef.com/enterprise-chef/
[2014-05-19 14:04:28 -0400] urbanmonk: are there any enterprise features I care about for managing only 3 nodes?
[2014-05-19 14:04:48 -0400] ErebusBat: Not having to manage your server and worry about not being able to get it back up is a good one ;)
[2014-05-19 14:05:08 -0400] ErebusBat: Unless you have compelling reason (trade secrets or whatnot) why introduce the complexity to a production system?
[2014-05-19 14:05:26 -0400] ErebusBat: If you are learning then you can try your backup/restore from HostedChef => YourServer
[2014-05-19 14:05:39 -0400] ErebusBat: But you can set your production systems to rely on hosted chef
[2014-05-19 14:05:44 -0400] ErebusBat: Best of both worlds
[2014-05-19 14:06:37 -0400] ErebusBat: That is what I would do anyway, but I guess it all depends on what those three nodes are going to be doing
[2014-05-19 14:09:47 -0400] urbanmonk: I think I will be exceeding the 5 nodes very soon ... the 3 nodes are for chef-server, 1 webserver and a server for hosting an atlassian stack ... I've already got a few clients (needing websites) in the works and I'd like to use chef to deploy their servers ... is the migration path from enterprise to open-source hosted seamless?  I'm just worried about any extra work that I'd have to do when I convert (I can't afford the $120/month fee)
[2014-05-19 14:16:02 -0400] ErebusBat: Ah I understand.  I work for a non profit and I am in a similar situation (can't afford the $120/month fee) ... I also use an atlassian stack... Prepare to spend some time on those cookbooks, but it is well worth it ... I honestly do not know about the migration (I was going to play with that this weekend, but Hitman Absolution for Mac finally came out) , as long as you are not using enterprise features I don't see a
[2014-05-19 14:16:03 -0400] ErebusBat:  reason why the knife backup/restore solutions wouldn't work ... Have you thought about using either a separate account for each client (for isolation) or having a chef-solo bundle as part of the deliverable?  Berkshelf if very good at doing this
[2014-05-19 14:19:49 -0400] urbanmonk: ErebusBat: what do you mean separate account for each client?
[2014-05-19 14:20:28 -0400] CPS: urbanmonk: the client/pem specified in client.rb, i believe he means
[2014-05-19 14:21:06 -0400] urbanmonk: ErebusBat: this is the client/pem used for the knife command?
[2014-05-19 14:21:15 -0400] urbanmonk: CPS: sorry that was meant for you
[2014-05-19 14:21:17 -0400] ErebusBat: You said that you have a few clients needing websites.   Why not set them up with their own account (Hosted Chef)  
[2014-05-19 14:22:25 -0400] ErebusBat: urbanmonk: Yes, the PEM is how you authenticate, so if you do indeed setup multiple accounts then you will need to make sure you have the correct one set when you are doing client work.  Depending on your workflow this may or maynot be reasonable
[2014-05-19 14:24:28 -0400] urbanmonk: ErebusBat: please excuse my ignorance .. still trying to understand the chef system .. currently the only account I'm aware of is the one used to login to the chef-server (admin) and one that I created for knife ... I can use knife to bootstrap the nodes ... does that also setup the nodes to use the same account as what I used with knife?
[2014-05-19 14:26:30 -0400] ErebusBat: urbanmonk: My fault for not being clear.  There are actually two files: your client (which is literally YOUR machine/node) and the validator: the validator is used during bootstrap to authenticate to the chef server (hosted or FOSS) and is what allows it to create an additional node/client account.
[2014-05-19 14:27:37 -0400] ErebusBat: When I was speaking of separate accounts I was suggesting creating a Hosted Chef account for each of your clients, and one for yourself; however this would require that you update your knife.rb config whenever you wanted to context switch between them
[2014-05-19 14:27:58 -0400] ErebusBat: I am thinking now that may be additional complexity that you do not need/want while learning
[2014-05-19 14:31:05 -0400] ErebusBat: Here is an idea that you could use to manage your knife.rb along those lines; however like I said it is maybe not what you want at this point:  Using environment vars in knife.rb: https://coderwall.com/p/dt1idw 
[2014-05-19 14:34:56 -0400] urbanmonk: is that right?
[2014-05-19 14:41:33 -0400] urbanmonk: ErebusBat:  what would be the advantage of creating a different hosted chef account for each of my clients?  they don't ever plan on deploying anything with chef themselves ... only I will ever have full control of their servers ... the link you sent makes sense for a vagrant/production environments but I'm not sure about the advantage of different accounts for my clients
[2014-05-19 14:44:24 -0400] ErebusBat: urbanmonk: It depends on your clients/situation.  When I was consulting I would try to give my clients everything they needed from me to make their systems work (never underestimate the bus factor).  I was just brainstorming ideas of how you could make hosted chef work for your situation; however by attempting to remove the complexity of managing your own chef server (by using hosted chef) we quickly added more
[2014-05-19 14:44:25 -0400] ErebusBat:  obscure complexities.   My fault, gorget I mentioned it, I was jsut thinking out loud :P
[2014-05-19 14:45:51 -0400] urbanmonk: ErebusBat: no problem .. on another note you metioned you also use an atlassian stack ... do you manage that with chef as well?  do you update jira, confluence using chef?
[2014-05-19 14:47:46 -0400] ErebusBat: urbanmonk: I have been using chef on and off at home (yes I have servers to manage at home :) ) and I am just getting our work infrastructure onto chef.  I was able to get Fisheye up and running, mostly with Chef.
[2014-05-19 14:48:40 -0400] ErebusBat: The problem, as I am sure you are aware, is how much of the atlassian config is in the DB, so it is very difficult to manage with chef unless you start doing raw DB changes which are not suppored by atlassian
[2014-05-19 14:50:02 -0400] ErebusBat: Also atlassian updates tend to do DB schema changes so you would have a mismatch beween your Chef/App version and the DB restore
[2014-05-19 14:50:14 -0400] ErebusBat: Unless you do alot of empty JIRA setups
[2014-05-19 14:53:16 -0400] urbanmonk: I'm just trying to figure out an easy way to automate upgrading jira, confluence etc.  Invariably the proess for me has been to unpack the new distribution and copy a few files from the old distribution into the new one and restart the server ... maybe that's not something I should manage with chef ... just create a script to do that
[2014-05-19 14:55:18 -0400] ErebusBat: urbanmonk: How many people do you have using your instances?  I am a little parinoid because not only our development but also our helpdesk runs on JIRA, so if an upgrade fails then IT is basically at a standstill
[2014-05-19 14:55:57 -0400] ErebusBat: If that process has been working for you then there is no reason you can't manage it that way, even with pre-backups.  It all depends on your situation.
[2014-05-19 14:56:14 -0400] ErebusBat: My ultimate goal is to get our server setup to intall JIRA and create the DB/user
[2014-05-19 14:56:28 -0400] ErebusBat: I would then restore the DB (for recovery)
[2014-05-19 15:03:16 -0400] urbanmonk: ErebusBat: I see .. I'll have to figure out something for my situation ... thanks for answering my questions!
[2014-05-19 15:03:52 -0400] ErebusBat: No problem, I hope I didn't confuse you too much!, just make sure you test your backup/restore.
[2014-05-19 15:05:43 -0400] urbanmonk: ErebusBat: No you didn't confuse me .. too much ;) .. will definitely test backup restoring
[2014-05-19 15:15:57 -0400] urbanmonk: when I run "knife bootstrap node_hostname -x root -p password -N node" I get the error: ERROR: Errno::EADDRNOTAVAIL: Can't assign requested address - connect(2) for "node_hostname" port 0
[2014-05-19 15:16:17 -0400] urbanmonk: I can connect to the server over ssh using the username/password no problem
[2014-05-19 15:16:29 -0400] urbanmonk: i mean node
[2014-05-19 15:17:18 -0400] ErebusBat: That looks like an OS error
[2014-05-19 15:17:31 -0400] ErebusBat: Rather than a Chef error.  What OS are you on urbanmonk ?
[2014-05-19 15:17:49 -0400] urbanmonk: my workstation is os x ... my node is linux
[2014-05-19 15:17:57 -0400] urbanmonk: the chef server is linux
[2014-05-19 15:18:44 -0400] ErebusBat: I am thinking that is coming from OSX, I assume it comes up pretty quick?
[2014-05-19 15:18:54 -0400] urbanmonk: instantly
[2014-05-19 15:19:22 -0400] ErebusBat: Yes, certainly from OSX then
[2014-05-19 15:20:04 -0400] ErebusBat: Are you using an IP or hostname in your kinfe bootstrap command urbanmonk ?
[2014-05-19 15:20:09 -0400] urbanmonk: hostname
[2014-05-19 15:21:08 -0400] ErebusBat: Do you get the same errors with the IP?
[2014-05-19 15:21:28 -0400] urbanmonk: yeah
[2014-05-19 15:21:41 -0400] ErebusBat: Also this very sparse chat log zack_ had the same issue, he said that it was actually a Can not connect to port error: http://community.opscode.com/chat/learnchef/2014-01-10
[2014-05-19 15:22:09 -0400] ErebusBat: However you said that you can SSH, so it should not be a firewall on the node
[2014-05-19 15:23:35 -0400] urbanmonk: strange .. i'm gonna reboot my machine ... brb
[2014-05-19 15:23:38 -0400] ErebusBat: urbanmonk: I have to run to a previous commitment; however you can try running knife if verbose mode (knife -V) and that might give you more info
[2014-05-19 15:23:51 -0400] urbanmonk: ok i'll try that first
[2014-05-19 15:24:05 -0400] ErebusBat: Please post what you find, I will check later
[2014-05-19 15:37:51 -0400] urbanmonk: ErebusBat: I specified the ssh port in knife.rb and it's working fine ... the clue was at the end of the error message the text "port 0"
[2014-05-19 15:40:42 -0400] urbanmonk: I've now created a node using the knife command ... I was expecting there to be a corresponding update (a new node configuration) in my chef-repo (the version controlled directory that contains my infrastructure as code).  Nothing has changed in my chef-repo, so how do I make sure that the conifguration on my chef-server is reflected in my chef-repo?
[2014-05-19 15:47:23 -0400] icebourg: What's the best way to download all the cookbooks (and each version) from one Chef server and upload them to another? Knife download/upload process will only do the latest version of each cookbook.
[2014-05-19 16:21:26 -0400] jonlives: icebourg: https://github.com/jkeiser/knife-essentials
[2014-05-19 16:22:59 -0400] icebourg: @jonlives unless I've missed something from the docs, there's no way to get all versions in one shot. I have to download each version individually...
[2014-05-19 16:24:31 -0400] jonlives: icebourg: check out https://github.com/jkeiser/knife-essentials#versioned_cookbooks :)
[2014-05-19 16:25:13 -0400] icebourg: jonlives: derp. I totally missed that. Thank you! :)
[2014-05-19 16:25:21 -0400] jonlives: no worries!
[2014-05-19 17:47:59 -0400] urbanmonk: where is chef node data stored?  for example when I run "knife node edit node1" where does that data come from?  Is that data only on the chef server?  I can't seem to find any reference to the node metadata in chef-repo ... if it's not in chef-repo then it looks like I need to backup more than chef-repo to reconstruct my infrastructure
[2014-05-19 18:02:46 -0400] urbanmonk: I've added a recipe to a nodes run list .. is there a way for me to immediately force the run list to apply?
[2014-05-19 18:30:58 -0400] ErebusBat: urbanmonk: You can use the SSH knife command to run chef-client on a node from your workstation: http://docs.opscode.com/chef/knife.html#ssh
[2014-05-19 22:13:01 -0400] cygoonda: Hi. I see a template Ive inherited has this line:
[2014-05-19 22:13:02 -0400] cygoonda: timestamp="$(date -I)"
[2014-05-19 22:13:30 -0400] cygoonda: Any idea where I can find the doc on that date function? Id like to see date and time and maybe other formats as well
[2014-05-19 22:13:32 -0400] cygoonda: Thanks
[2014-05-19 22:40:53 -0400] urbanmonk: trying to set the attribute node["chef_client"]["interval"] .. do I do that by editing the node and modifying the json itself or does knife have an easier way for me to do this?
